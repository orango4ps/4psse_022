OBJECT Page 189 Incoming Document
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.04;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Incoming Document;
               NOR=InngÜende dokument;
               SVE=Inkommande dokument];
    SourceTable=Table130;
    PageType=Document;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Release,Status,Incoming Document,OCR,Approve,Request Approval;
                                NOR=Ny,Prosess,Rapport,Frigivelse,Status,InngÜende dokument,OCR,Godkjenne,Be om godkjenning;
                                SVE=Ny,Process,Rapport,SlÑpp,Status,Inkommande dokument,OCR,GodkÑnn,BegÑr godkÑnnande];
    OnInit=BEGIN
             IsDataExchTypeEditable := TRUE;
             EnableReceiveFromOCR := WaitingToReceiveFromOCR;
           END;

    OnOpenPage=BEGIN
                 HasCamera := CameraProvider.IsAvailable;
                 IF HasCamera THEN
                   CameraProvider := CameraProvider.Create;

                 UpdateOCRSetupVisibility;
               END;

    OnAfterGetRecord=BEGIN
                       URL := GetURL;
                       ShowErrors;
                       EnableReceiveFromOCR := WaitingToReceiveFromOCR;
                       CurrPage.EDITABLE(NOT Processed);
                     END;

    OnNewRecord=BEGIN
                  URL := '';
                END;

    OnInsertRecord=BEGIN
                     AttachEnabled := TRUE;
                   END;

    OnModifyRecord=VAR
                     IncomingDocumentAttachment@1000 : Record 133;
                   BEGIN
                     OCRDataCorrectionEnabled := GetGeneratedFromOCRAttachment(IncomingDocumentAttachment);
                     RecordHasAttachment := HasAttachment;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           IsDataExchTypeEditable := NOT (Status IN [Status::Created,Status::Posted]);
                           ShowErrors;
                           SetCalculatedFields;
                           RecordHasAttachment := HasAttachment;
                           SetControlVisibility;
                           AttachEnabled := "Entry No." <> 0;
                         END;

    ActionList=ACTIONS
    {
      { 52      ;    ;ActionContainer;
                      CaptionML=[ENU=New;
                                 NOR=Ny;
                                 SVE=Ny];
                      ActionContainerType=NewDocumentItems }
      { 46      ;    ;ActionContainer;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon;
                                 SVE=Relaterad information];
                      ActionContainerType=RelatedInformation }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=Setup;
                                 NOR=Oppsett;
                                 SVE=Konfiguration] }
      { 44      ;2   ;Action    ;
                      Name=Setup;
                      CaptionML=[ENU=Setup;
                                 NOR=Oppsett;
                                 SVE=InstÑllning];
                      ToolTipML=[ENU=Define the general journal type to use when creating journal lines. You can also specify whether it requires approval to create documents and journal lines.;
                                 NOR=Definerer hvilken type finanskladd som brukes ved oppretting av kladdelinjer. Du kan ogsÜ angi om det kreves godkjenning for Ü opprette dokumenter og kladdelinjer.;
                                 SVE=Definierar redovisningsjournaltypen som anvÑnds nÑr du skapar journalrader. Det gÜr Ñven att ange om den mÜste godkÑnnas innan det gÜr att skapa dokument och journalrader.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 191;
                      Image=Setup }
      { 22      ;2   ;Action    ;
                      Name=DataExchangeTypes;
                      CaptionML=[ENU=Data Exchange Types;
                                 NOR=Datautvekslingstyper;
                                 SVE=Typer av dataintegration];
                      ToolTipML=[ENU=View the data exchange types that are available to convert electronic documents to documents in Dynamics 365.;
                                 NOR=Viser datautvekslingstypene som er tilgjengelige for Ü konvertere elektroniske dokumenter til dokumenter i Dynamics 365.;
                                 SVE=Visa dataintegrationstyperna som finns tillgÑngliga fîr att konvertera elektroniska dokument till dokument i Dynamics 365.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1213;
                      Promoted=Yes;
                      Image=Entries;
                      PromotedCategory=Category6 }
      { 73      ;2   ;Action    ;
                      Name=ActivityLog;
                      CaptionML=[ENU=Activity Log;
                                 NOR=Aktivitetslogg;
                                 SVE=Aktivitetslogg];
                      ToolTipML=[ENU=View the status and any errors if the document was sent as an electronic document or OCR file through the document exchange service.;
                                 NOR=Vis statusen og eventuelle feilmeldinger hvis dokumentet ble sendt som et elektronisk dokument eller OCR-fil via dokumentutvekslingstjenesten.;
                                 SVE=Visa status och eventuella fel om dokumentet skickades som ett elektroniskt dokument eller som OCR-fil med dokumentutbytestjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Log;
                      OnAction=VAR
                                 ActivityLog@1002 : Record 710;
                               BEGIN
                                 ActivityLog.ShowEntries(RECORDID);
                               END;
                                }
      { 69      ;2   ;Action    ;
                      Name=OCRSetup;
                      CaptionML=[ENU=OCR Setup;
                                 NOR=OCR-oppsett;
                                 SVE=OCR-instÑllningar];
                      ToolTipML=[ENU=Open the OCR Service Setup window, for example to change credentials or enable the service.;
                                 NOR=èpner vinduet Oppsett for OCR-tjeneste, for eksempel for Ü endre legitimasjon eller aktivere tjenesten.;
                                 SVE=ôppna fînstret OCR-serviceinstÑllningar fîr att till exempel Ñndra autentiseringsuppgifter eller aktivera tjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=ShowOCRSetup;
                      PromotedIsBig=Yes;
                      Image=ServiceSetup;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"OCR Service Setup");
                                 CurrPage.UPDATE;
                                 IF ClientTypeManagement.GetCurrentClientType = CLIENTTYPE::Web THEN
                                   IF OCRIsEnabled THEN BEGIN
                                     OnCloseIncomingDocumentFromAction(Rec);
                                     CurrPage.CLOSE;
                                   END;
                               END;
                                }
      { 91      ;2   ;Action    ;
                      Name=ApprovalEntries;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OpenApprovalEntriesPage(RECORDID);
                               END;
                                }
      { 43      ;    ;ActionContainer;
                      CaptionML=[ENU=Process;
                                 NOR=Prosess;
                                 SVE=Process];
                      ActionContainerType=ActionItems }
      { 121     ;1   ;Action    ;
                      Name=CreateDocument;
                      CaptionML=[ENU=Create Document;
                                 NOR=Opprett dokument;
                                 SVE=Skapa dokument];
                      ToolTipML=[ENU=Create a document, such as a purchase invoice, automatically by converting the electronic document that is attached to the incoming document record.;
                                 NOR=Opprette et dokument automatisk, for eksempel en kjõpsfaktura, ved Ü konvertere det elektroniske dokumentet som er vedlagt posten for det innkommende dokumentet.;
                                 SVE=Skapa ett dokument, till exempel en inkîpsfaktura, automatiskt genom att konvertera det elektroniska dokumentet som Ñr bifogat till den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=AutomaticCreationActionsAreEnabled;
                      PromotedIsBig=Yes;
                      Image=CreateDocument;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 "Created Doc. Error Msg. Type" := "Created Doc. Error Msg. Type"::Warning;
                                 MODIFY;
                                 CreateDocumentWithDataExchange;
                               END;
                                }
      { 31      ;1   ;Action    ;
                      Name=CreateGenJnlLine;
                      CaptionML=[ENU=Create Journal Line;
                                 NOR=Opprett kladdelinje;
                                 SVE=Skapa journalrad];
                      ToolTipML=[ENU=Create a journal line automatically by converting the electronic document that is attached to the incoming document record.;
                                 NOR=Oppretter en kladdelinje automatisk ved Ü konvertere det elektroniske dokumentet som er vedlagt posten for det innkommende dokumentet.;
                                 SVE=Skapa en journalrad automatiskt genom att konvertera det elektroniska dokumentet som Ñr bifogat till den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=AutomaticCreationActionsAreEnabled;
                      PromotedIsBig=Yes;
                      Image=TransferToGeneralJournal;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 CreateGeneralJournalLineWithDataExchange;
                               END;
                                }
      { 285     ;1   ;Action    ;
                      Name=CreateManually;
                      CaptionML=[ENU=Create Manually;
                                 NOR=Opprett manuelt;
                                 SVE=Skapa manuellt];
                      ToolTipML=[ENU=Create a document, such as a purchase invoice, manually from information in the file that is attached to the incoming document record.;
                                 NOR=Oppretter et dokument manuelt, for eksempel en kjõpsfaktura, fra informasjonen i filen som er vedlagt posten for det innkommende dokumentet.;
                                 SVE=Skapa ett dokument, till exempel en inkîpsfaktura, manuellt frÜn information i filen som Ñr bifogad till den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CreateCreditMemo;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 IF NOT AskUserPermission THEN
                                   EXIT;

                                 CreateManually;
                               END;
                                }
      { 21      ;1   ;Action    ;
                      Name=AttachFile;
                      CaptionML=[ENU=Attach File;
                                 NOR=Tilknytt fil;
                                 SVE=Bifoga fil];
                      ToolTipML=[ENU=Attach a file to the incoming document record.;
                                 NOR=Legger ved en fil i posten for det innkommende dokumentet.;
                                 SVE=Bifoga du en fil till den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Attach;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ImportAttachment(Rec);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 85      ;1   ;Action    ;
                      Name=ReplaceMainAttachment;
                      CaptionML=[ENU=Replace Main Attachment;
                                 NOR=Erstatt hovedvedlegg;
                                 SVE=ErsÑtt huvudbilaga];
                      ToolTipML=[ENU=Attach another file to be used as the main file attachment on the incoming document record.;
                                 NOR=Legger ved en annen fil som skal brukes som hovedfilvedlegg i posten for det innkommende dokumentet.;
                                 SVE=Bifoga en annan fil som anvÑnds som huvudbilaga pÜ den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=ReplaceMainAttachmentEnabled;
                      Image=Interaction;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ReplaceOrInsertMainAttachment;
                                 CLEAR("Data Exchange Type");
                               END;
                                }
      { 30      ;1   ;Action    ;
                      Name=AttachFromCamera;
                      CaptionML=[ENU=Attach Image from Camera;
                                 NOR=Legg ved bilde fra kamera;
                                 SVE=Bifoga bild frÜn kamera];
                      ToolTipML=[ENU=Add a picture from your device camera to the document.;
                                 NOR=Legger ved et bilde fra enhetskamerat i dokumentet.;
                                 SVE=LÑgg till en bild frÜn enhetens kamera i dokumentet.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=HasCamera;
                      Enabled=AttachEnabled;
                      PromotedIsBig=Yes;
                      Image=Camera;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 CameraOptions@1000 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraOptions";
                               BEGIN
                                 IF NOT HasCamera THEN
                                   EXIT;
                                 CameraOptions := CameraOptions.CameraOptions;
                                 CameraOptions.Quality := 100; // 100%
                                 CameraProvider.RequestPictureAsync(CameraOptions);
                               END;
                                }
      { 64      ;1   ;Action    ;
                      Name=TextToAccountMapping;
                      CaptionML=[ENU=Map Text to Account;
                                 NOR=Tilordne tekst til konto;
                                 SVE=Mappa text till konto];
                      ToolTipML=[ENU=Create a mapping of text on incoming documents to identical text on specific debit, credit, and balancing accounts in the general ledger or on bank accounts so that the resulting document or journal lines are prefilled with the specified information.;
                                 NOR=Oppretter en tilordning av tekst pÜ inngÜende dokumenter til identisk tekst pÜ bestemte debet-, kredit- og motkonti i Finans eller pÜ bankkonti, slik at de resulterende dokument- eller kladdelinjene forhÜndsutfylles med den angitte informasjonen.;
                                 SVE=Skapa en mappning av text i inkommande dokument till identisk text pÜ vissa debet-, kredit- och balanskonton i redovisningen eller pÜ bankkonton, sÜ att de resulterande dokument- eller journalraderna fylls i automatiskt med den angivna informationen.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1254;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MapAccounts;
                      PromotedCategory=Process;
                      PromotedOnly=Yes }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑppa] }
      { 12      ;2   ;Action    ;
                      Name=Release;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑppa];
                      ToolTipML=[ENU=Release the incoming document to indicate that it has been approved by the incoming document approver. Note that this is not related to approval workflows.;
                                 NOR=Frigir det innkommende dokumentet for Ü angi at det er godkjent av godkjenner av innkommende dokument. Legg merke til at dette ikke er knyttet til arbeidsflyter for godkjenning.;
                                 SVE=SlÑpp det inkommande dokumentet fîr att indikera att det har godkÑnts av godkÑnnaren fîr inkommande dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=RecordHasAttachment;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleaseIncomingDocument@1000 : Codeunit 132;
                               BEGIN
                                 ReleaseIncomingDocument.PerformManualRelease(Rec);
                               END;
                                }
      { 82      ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Reopen;
                                 NOR=èpne pÜ nytt;
                                 SVE=ôppna igen];
                      ToolTipML=[ENU=Reopen the incoming document record after it has been approved by the incoming document approver. Note that this is not related to approval workflows.;
                                 NOR=èpner posten for det innkommende dokumentet pÜ nytt etter at det er godkjent av godkjenner av innkommende dokument. Legg merke til at dette ikke er knyttet til arbeidsflyter for godkjenning.;
                                 SVE=ôppna den inkommande dokumentposten pÜ nytt nÑr den har godkÑnts av godkÑnnaren fîr inkommande dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=RecordHasAttachment;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleaseIncomingDocument@1000 : Codeunit 132;
                               BEGIN
                                 ReleaseIncomingDocument.PerformManualReopen(Rec);
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      ToolTipML=[ENU=Reject to approve the incoming document. Note that this is not related to approval workflows.;
                                 NOR=Avviser Ü godkjenne det innkommende dokumentet. Legg merke til at dette ikke er knyttet til arbeidsflyter for godkjenning.;
                                 SVE=Avvisa fîr att godkÑnna det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=RecordHasAttachment;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleaseIncomingDocument@1000 : Codeunit 132;
                               BEGIN
                                 ReleaseIncomingDocument.PerformManualReject(Rec);
                               END;
                                }
      { 92      ;1   ;ActionGroup;
                      CaptionML=[ENU=Status;
                                 NOR=Status;
                                 SVE=Status] }
      { 88      ;2   ;Action    ;
                      Name=SetToProcessed;
                      CaptionML=[ENU=Set To Processed;
                                 NOR=Satt til Behandlet;
                                 SVE=Ange som bearbetad];
                      ToolTipML=[ENU=Set the incoming document to processed. It will then be moved to the Processed Incoming Documents window.;
                                 NOR=Setter det innkommende dokumentet til behandlet. Dette flyttes deretter til vinduet Behandlede innkommende dokumenter.;
                                 SVE=StÑll in det inkommande dokumentet som bearbetat. Det flyttas sedan till fînstret Bearbetade inkommande dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=NOT Processed;
                      PromotedIsBig=Yes;
                      Image=Archive;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VALIDATE(Processed,TRUE);
                                 MODIFY(TRUE);
                               END;
                                }
      { 89      ;2   ;Action    ;
                      Name=SetToUnprocessed;
                      CaptionML=[ENU=Set To Unprocessed;
                                 NOR=Satt til Ubehandlet;
                                 SVE=Ange som obearbetad];
                      ToolTipML=[ENU=Set the incoming document to unprocessed. This allows you to edit information or perform actions for the incoming document.;
                                 NOR=Setter det innkommende dokumentet til ubehandlet. Dette lar deg redigere informasjon eller utfõre handlinger for det innkommende dokumentet.;
                                 SVE=StÑll in det inkommande dokumentet som obearbetat. Det hÑr gîr det mîjligt att redigera information eller utfîra ÜtgÑrder fîr det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=Processed;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VALIDATE(Processed,FALSE);
                                 MODIFY(TRUE);
                               END;
                                }
      { 74      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning;
                                 SVE=GodkÑnnande] }
      { 75      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn;
                                 SVE=GodkÑnn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.;
                                 SVE=GodkÑnn de begÑrda fîrÑndringarna.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 TestReadyForApproval;
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 76      ;2   ;Action    ;
                      Name=RejectApproval;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      ToolTipML=[ENU=Reject to approve the incoming document. Note that this is not related to approval workflows.;
                                 NOR=Avviser Ü godkjenne det innkommende dokumentet. Legg merke til at dette ikke er knyttet til arbeidsflyter for godkjenning.;
                                 SVE=Avvisa fîr att godkÑnna det inkommande dokumentet.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 77      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger;
                                 SVE=Delegera];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.;
                                 SVE=Delegera godkÑnnandet till en ersÑttare.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 78      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader;
                                 SVE=Kommentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 81      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning;
                                 SVE=BegÑr godkÑnnande];
                      Image=SendApprovalRequest }
      { 80      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforespõrsel;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      ToolTipML=[ENU=Request approval of the incoming document. You can send an approval request as part of a workflow if this has been set up in your organization.;
                                 NOR=Ber om godkjenning for det innkommende dokumentet. Du kan sende en godkjenningsforespõrsel som en del av en arbeidsflyt hvis dette er konfigurert i organisasjonen.;
                                 SVE=BegÑr godkÑnnande av det inkommande dokumentet. Det gÜr att skicka begÑran om godkÑnnande som en del av ett arbetsflîde om det Ñr konfigurerat i organisationen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 TestReadyForApproval;
                                 IF ApprovalsMgmt.CheckIncomingDocApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendIncomingDocForApproval(Rec);
                               END;
                                }
      { 79      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforespõrsel;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      ToolTipML=[ENU=Cancel requesting approval of the incoming document.;
                                 NOR=Avbryter godkjenningsforespõrsel for det innkommende dokumentet.;
                                 SVE=Avbryt begÑran om godkÑnnande av det inkommande dokumentet.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelIncomingDocApprovalRequest(Rec);
                               END;
                                }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument] }
      { 67      ;2   ;Action    ;
                      Name=OpenDocument;
                      CaptionML=[ENU=Open Record;
                                 NOR=èpne post;
                                 SVE=ôppna post];
                      ToolTipML=[ENU=Open the document, journal line, or entry that the incoming document is linked to.;
                                 NOR=èpner dokumentet, kladdelinjen eller posten som er det innkommende dokumentet er knyttet til.;
                                 SVE=ôppna dokumentet, journalraden eller transaktionen som det inkommande dokumentet Ñr lÑnkat till.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=RecordLinkExists;
                      PromotedIsBig=Yes;
                      Image=ViewDetails;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ShowRecord;
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=RemoveReferencedRecord;
                      CaptionML=[ENU=Remove Reference to Record;
                                 NOR=Fjern referanse til post;
                                 SVE=Ta bort referens till post];
                      ToolTipML=[ENU=Remove the link that exists from the incoming document to a document, journal line, or entry.;
                                 NOR=Fjerner koblingen som finnes mellom det innkommende dokumentet til et dokument, en kladdelinje eller en post.;
                                 SVE=Ta bort lÑnken frÜn det inkommande dokumentet till ett dokument, en journalrad eller en transaktion.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=RecordLinkExists;
                      PromotedIsBig=Yes;
                      Image=ClearLog;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 RemoveReferencedRecords;
                               END;
                                }
      { 68      ;2   ;Action    ;
                      Name=Navigate;
                      CaptionML=[ENU=Navigate;
                                 NOR=Naviger;
                                 SVE=Analysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppfõringer og dokumenter som finnes for dokumentnummeret og bokfõringsdatoen i den valgte oppfõringen eller dokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet fîr den valda transaktionen eller det valda dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Navigate;
                      OnAction=VAR
                                 NavigatePage@1000 : Page 344;
                               BEGIN
                                 IF NOT Posted THEN
                                   ERROR(NoPostedDocumentsErr);
                                 NavigatePage.SetDoc("Posting Date","Document No.");
                                 NavigatePage.RUN;
                               END;
                                }
      { 51      ;2   ;ActionGroup;
                      CaptionML=[ENU=Record;
                                 NOR=Post;
                                 SVE=Post];
                      Visible=FALSE;
                      Enabled=FALSE;
                      Image=Document }
      { 65      ;3   ;Action    ;
                      Name=Journal;
                      CaptionML=[ENU=Journal Line;
                                 NOR=Kladdelinje;
                                 SVE=Journalrad];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Journal;
                      OnAction=VAR
                                 GenJournalBatch@1001 : Record 232;
                                 GenJnlManagement@1002 : Codeunit 230;
                               BEGIN
                                 IF NOT AskUserPermission THEN
                                   EXIT;

                                 CreateGenJnlLine;
                                 IncomingDocumentsSetup.Fetch;
                                 GenJournalBatch.GET(IncomingDocumentsSetup."General Journal Template Name",IncomingDocumentsSetup."General Journal Batch Name");
                                 GenJnlManagement.TemplateSelectionFromBatch(GenJournalBatch);
                               END;
                                }
      { 49      ;3   ;Action    ;
                      Name=PurchaseInvoice;
                      CaptionML=[ENU=Purchase Invoice;
                                 NOR=Kjõpsfaktura;
                                 SVE=Inkîpsfaktura];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Purchase;
                      OnAction=BEGIN
                                 IF NOT AskUserPermission THEN
                                   EXIT;

                                 CreatePurchInvoice;
                               END;
                                }
      { 50      ;3   ;Action    ;
                      Name=PurchaseCreditMemo;
                      CaptionML=[ENU=Purchase Credit Memo;
                                 NOR=Kjõpskreditnota;
                                 SVE=Inkîpskreditnota];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF NOT AskUserPermission THEN
                                   EXIT;

                                 CreatePurchCreditMemo;
                               END;
                                }
      { 47      ;3   ;Action    ;
                      Name=SalesInvoice;
                      CaptionML=[ENU=Sales Invoice;
                                 NOR=Salgsfaktura;
                                 SVE=FîrsÑljningsfaktura];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Sales;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF NOT AskUserPermission THEN
                                   EXIT;

                                 CreateSalesInvoice;
                               END;
                                }
      { 48      ;3   ;Action    ;
                      Name=SalesCreditMemo;
                      CaptionML=[ENU=Sales Credit Memo;
                                 NOR=Salgskreditnota;
                                 SVE=FîrsÑljningskreditnota];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF NOT AskUserPermission THEN
                                   EXIT;

                                 CreateSalesCreditMemo;
                               END;
                                }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=OCR;
                                 NOR=OCR;
                                 SVE=OCR] }
      { 42      ;2   ;Action    ;
                      Name=SendToJobQueue;
                      CaptionML=[ENU=Send to Job Queue;
                                 NOR=Send til jobbkõ;
                                 SVE=Skicka till jobbkî];
                      ToolTipML=[ENU=Send the attached PDF or image file to the OCR service by the job queue according to the schedule, provided that no errors exist.;
                                 NOR=Sender den vedlagte PDF- eller bildefilen til OCR-tjenesten av jobbkõen i henhold til tidsplanen, forutsatt at det ikke finnes feil.;
                                 SVE=Skicka bifogad PDF eller bildfil till OCR-tjÑnsten med jobbkîn enligt schemat, fîrutsatt att inga fel finns.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=OCRServiceIsEnabled;
                      Enabled=RecordHasAttachment;
                      Image=Translation;
                      OnAction=BEGIN
                                 SendToJobQueue(TRUE);
                               END;
                                }
      { 56      ;2   ;Action    ;
                      Name=RemoveFromJobQueue;
                      CaptionML=[ENU=Remove from Job Queue;
                                 NOR=Fjern fra jobbkõ;
                                 SVE=Ta bort frÜn jobbkî];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektkõen.;
                                 SVE=Ta bort den schemalagda bearbetningen av den hÑr rapporten frÜn jobbkîn.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=OCRServiceIsEnabled;
                      Enabled=RecordHasAttachment;
                      Image=Translation;
                      OnAction=BEGIN
                                 RemoveFromJobQueue(TRUE);
                               END;
                                }
      { 54      ;2   ;Action    ;
                      Name=SendToOcr;
                      CaptionML=[ENU=Send to OCR Service;
                                 NOR=Send til OCR-tjeneste;
                                 SVE=Skicka till OCR-tjÑnst];
                      ToolTipML=[ENU=Send the attached PDF or image file to the OCR service immediately.;
                                 NOR=Sender umiddelbart den vedlagte PDF- eller bildefilen til OCR-tjenesten.;
                                 SVE=Skicka omedelbart bifogad PDF eller bildfil till OCR-tjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=OCRServiceIsEnabled;
                      Enabled=CanBeSentToOCR;
                      PromotedIsBig=Yes;
                      Image=Translations;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 SendToOCR(TRUE);
                               END;
                                }
      { 55      ;2   ;Action    ;
                      Name=ReceiveFromOCR;
                      CaptionML=[ENU=Receive from OCR Service;
                                 NOR=Motta fra OCR-tjeneste;
                                 SVE=Ta emot frÜn OCR-tjÑnst];
                      ToolTipML=[ENU=Get any electronic documents that are ready to receive from the OCR service.;
                                 NOR=Henter elektroniske dokumenter som er klare til Ü motta fra OCR-tjenesten.;
                                 SVE=HÑmta klara elektroniska dokument frÜn OCR-tjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=OCRServiceIsEnabled;
                      Enabled=EnableReceiveFromOCR;
                      PromotedIsBig=Yes;
                      Image=Translations;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 RetrieveFromOCR(TRUE);
                               END;
                                }
      { 35      ;2   ;Action    ;
                      Name=CorrectOCRData;
                      CaptionML=[ENU=Correct OCR Data;
                                 NOR=Korriger OCR-data;
                                 SVE=Korrigera OCR-data];
                      ToolTipML=[ENU=Open a window where you can teach the OCR service how to interpret data on PDF and image files so that future documents created by the OCR service are more correct.;
                                 NOR=èpner et vindu der du kan lëre OCR-tjenesten hvordan data i PDF- og bildefiler skal tolkes, slik at fremtidige dokumenter som opprettes av OCR-tjenesten, er riktigere.;
                                 SVE=ôppna ett fînster dÑr du lÑr OCR-tjÑnsten att tolka data i PDF- och bildfiler sÜ att OCR-tjÑnsten i framtiden skapar mer korrekta dokument.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1272;
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      Visible=OCRServiceIsEnabled;
                      Enabled=OCRDataCorrectionEnabled;
                      PromotedIsBig=Yes;
                      Image=EditAttachment;
                      PromotedCategory=Category7 }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=General;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt];
                GroupType=Group }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the incoming document. You must enter the description manually.;
                           NOR=Angir beskrivelsen av innkommende dokumenter. Du mÜ angi beskrivelsen manuelt.;
                           SVE=Anger beskrivningen av det inkommande dokumentet. Du mÜste ange beskrivningen manuellt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                Importance=Promoted }

    { 53  ;2   ;Field     ;
                Name=URL;
                ExtendedDatatype=URL;
                CaptionML=[ENU=Link to Document;
                           NOR=Koble til dokument;
                           SVE=LÑnk till dokument];
                ToolTipML=[ENU=Specifies a link to the attached file.;
                           NOR=Angir en kobling til den vedlagte filen.;
                           SVE=Anger en lÑnk till den bifogade filen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=URL;
                Importance=Additional;
                OnValidate=BEGIN
                             SetURL(URL);
                             CurrPage.UPDATE;
                           END;
                            }

    { 90  ;2   ;Field     ;
                Name=MainAttachment;
                CaptionML=[ENU=Main Attachment;
                           NOR=Hovedvedlegg;
                           SVE=Huvudbilaga];
                ToolTipML=[ENU=Specifies the main attachment. Only this attachment is processed by the OCR and document exchange services.;
                           NOR=Angir hovedvedlegget. Bare dette vedlegget behandles av OCR- og dokumentutvekslingstjenesten.;
                           SVE=Anger huvudbilagan. Endast den bilagan bearbetas av OCR- och dokumentutbytestjÑnsterna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AttachmentFileName;
                Enabled=RecordHasAttachment;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              MainAttachmentDrillDown;
                              CurrPage.UPDATE;
                            END;
                             }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the data exchange type that is used to process the incoming document when it is an electronic document.;
                           NOR=Angir datautvekslingstypen som brukes til Ü behandle det innkommende dokumentet nÜr det er et elektronisk dokument.;
                           SVE=Anger typen av dataintegration som anvÑnds fîr att behandla det inkommande dokument, nÑr det Ñr ett elektroniskt dokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Data Exchange Type";
                Importance=Additional;
                Editable=IsDataExchTypeEditable;
                OnValidate=BEGIN
                             IF NOT DefaultAttachmentIsXML THEN
                               ERROR(InvalidTypeErr);
                           END;
                            }

    { 58  ;2   ;Field     ;
                Name=Record;
                CaptionML=[ENU=Record;
                           NOR=Post;
                           SVE=Post];
                ToolTipML=[ENU=Specifies the record, document, journal line, or ledger entry, that is linked to the incoming document.;
                           NOR=Angir posten, dokumentet, kladdelinjen eller finansposten som er knyttet til det innkommende dokumentet.;
                           SVE=Anger posten, dokumentet, journalraden eller transaktionen som Ñr lÑnkad till det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=RecordLinkTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ShowRecord;
                              CurrPage.UPDATE;
                            END;
                             }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of document or journal that the incoming document can be connected to.;
                           NOR=Angir hvilken type dokument eller kladd det innkommende dokumentet kan kobles til.;
                           SVE=Anger vilken typ av dokument eller journal som det inkommande dokumentet gÜr att koppla till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Type";
                Importance=Promoted;
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the related document or journal line that is created for the incoming document.;
                           NOR=Angir nummeret pÜ tilknyttet dokument eller kladdelinje som opprettes for det innkommende dokumentet.;
                           SVE=Anger numret pÜ relaterat dokument eller journalrad som skapas fîr det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document No.";
                Importance=Promoted;
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the incoming document record.;
                           NOR=Angir statusen for den innkommende dokumentposten.;
                           SVE=Anger status fîr den inkommande dokumentposten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Status;
                Importance=Promoted }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the incoming document record when it takes part in the OCR process.;
                           NOR=Angir statusen for den innkommende dokumentposten nÜr den tar del i OCR-prosessen.;
                           SVE=Anger status fîr den inkommande dokumentposten nÑr den ingÜr i OCR-processen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OCR Status";
                OnDrillDown=VAR
                              OCRServiceSetup@1000 : Record 1270;
                              OCRServiceMgt@1001 : Codeunit 1294;
                            BEGIN
                              IF NOT OCRServiceSetup.ISEMPTY THEN
                                HYPERLINK(OCRServiceMgt.GetStatusHyperLink(Rec));
                            END;
                             }

    { 93  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the process stage of the track ID in relation to the OCR service.;
                           NOR=Angir prosessfasen for feltspor-ID-en i forhold til OCR-tjenesten.;
                           SVE=Anger processtadiet fîr spÜrnings-ID i relation till OCR-tjÑnsten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OCR Track ID";
                Editable=FALSE }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the job queue entry that is processing the incoming document.;
                           NOR=Angir statusen for jobbkõposten som behandler det innkommende dokumentet.;
                           SVE=Anger status fîr inkommande jobbkîtransaktion som bearbetar det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Job Queue Status" }

    { 71  ;2   ;Group     ;
                GroupType=Group }

    { 29  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the document template that you want the OCR service provider to use when they convert the incoming-document file to an electronic document. Chose the field to pick a supported document template from the OCR Service Setup window.;
                           NOR=Angir koden for dokumentmalen du vil at OCR-leverandõren skal bruke nÜr de konverterer den innkommende dokumentfilen til et elektronisk dokument. Merk feltet for Ü velge en stõttet dokumentmal fra vinduet Oppsett for OCR-tjeneste.;
                           SVE=Anger koden fîr dokumentmallen som du vill att OCR-tjÑnsteleverantîren anvÑnder nÑr den konverterar den inkommande dokumentfilen till ett elektroniskt dokument. Markera fÑltet fîr att vÑlja en dokumentmall som stîds i fînstret OCR-serviceinstÑllningar.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OCR Service Doc. Template Code";
                Importance=Additional }

    { 41  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the document template that you want the OCR service provider to use when they convert the incoming-document file to an electronic document. Chose the field to pick a supported document template from the OCR Service Setup window.;
                           NOR=Angir navnet pÜ dokumentmalen du vil at OCR-leverandõren skal bruke nÜr de konverterer den innkommende dokumentfilen til et elektronisk dokument. Merk feltet for Ü velge en stõttet dokumentmal fra vinduet Oppsett for OCR-tjeneste.;
                           SVE=Anger namnet pÜ dokumentmallen som du vill att OCR-tjÑnsteleverantîren anvÑnder nÑr den konverterar den inkommande dokumentfilen till ett elektroniskt dokument. Markera fÑltet fîr att vÑlja en dokumentmall som stîds i fînstret OCR-serviceinstÑllningar.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OCR Service Doc. Template Name";
                Importance=Additional }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=OCR Result;
                           NOR=OCR-resultat;
                           SVE=OCR-resultat];
                ToolTipML=[ENU=Specifies what process stage the attached PDF or image file is in relation to the OCR service.;
                           NOR=Angir prosessfasen for den vedlagte PDF- eller bildefilen i forhold til OCR-tjenesten.;
                           SVE=Anger i vilken etapp bifogad PDF- eller bildfil befinner sig i fîrhÜllande till OCR-tjÑnsten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=OCRResultFileName;
                Importance=Additional;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              OCRResultDrillDown;
                              CurrPage.UPDATE;
                            END;
                             }

    { 72  ;2   ;Group     ;
                GroupType=Group }

    { 4   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies when the incoming document line was created.;
                           NOR=Angir nÜr den innkommende dokumentlinjen ble opprettet.;
                           SVE=Anger nÑr den inkommande dokumentraden skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Created Date-Time";
                Importance=Additional }

    { 6   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the user who created the incoming document line.;
                           NOR=Angir navnet til brukeren som opprettet den innkommende dokumentlinjen.;
                           SVE=Anger namnet pÜ anvÑndaren som skapade den inkommande dokumentraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Created By User Name";
                Importance=Additional }

    { 7   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies if the incoming document has been approved.;
                           NOR=Angir om det innkommende dokumentet er godkjent.;
                           SVE=Anger om det inkommande dokument har godkÑnts.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Released;
                Visible=FALSE }

    { 8   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies when the incoming document was approved.;
                           NOR=Angir nÜr det innkommende dokumentet ble godkjent.;
                           SVE=Anger nÑr det inkommande dokument godkÑndes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Released Date-Time";
                Importance=Additional }

    { 10  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the user who approved the incoming document.;
                           NOR=Angir navnet til brukeren som godkjente det innkommende dokumentet.;
                           SVE=Anger namnet pÜ anvÑndaren som godkÑnde den inkommande dokumentraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Released By User Name";
                Importance=Additional }

    { 11  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies when the incoming document line was last modified.;
                           NOR=Angir nÜr den innkommende dokumentlinjen sist ble endret.;
                           SVE=Anger nÑr den inkommande dokumentraden senast Ñndrades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Date-Time Modified";
                Importance=Additional }

    { 13  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the user who last modified the incoming document line.;
                           NOR=Angir navnet til brukeren som sist endret den innkommende dokumentlinjen.;
                           SVE=Anger namnet pÜ anvÑndaren som senast Ñndrade den inkommande dokumentraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Modified By User Name";
                Importance=Additional }

    { 14  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies if the document or journal line that was created for this incoming document has been posted.;
                           NOR=Angir om dokumentet eller kladdelinjen som ble opprettet for dette innkommende dokumentet, er bokfõrt.;
                           SVE=Anger om dokumentet eller journalraden som skapades fîr det inkommande dokumentet har bokfîrts.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Posted }

    { 15  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies when the related document or journal line was posted.;
                           NOR=Angir nÜr det tilknyttede dokumentet eller kladdelinjen ble bokfõrt.;
                           SVE=Anger nÑr den relaterade dokument- eller journalraden bokfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posted Date-Time";
                Importance=Additional }

    { 18  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies when the document or journal line that relates to the incoming document was posted.;
                           NOR=Angir nÜr dokumentet eller kladdelinjen som er knyttet til det innkommende dokumentet, ble bokfõrt.;
                           SVE=Anger nÑr dokument eller journalraden som relaterar till det inkommande dokument bokfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 37  ;1   ;Part      ;
                Name=SupportingAttachments;
                CaptionML=[ENU=Supporting Attachments;
                           NOR=Stõttevedlegg;
                           SVE=Stîdbilagor];
                ApplicationArea=#All;
                PagePartID=Page194;
                Visible=AdditionalAttachmentsPresent;
                PartType=Page;
                ShowFilter=No }

    { 70  ;1   ;Group     ;
                Name=FinancialInformation;
                CaptionML=[ENU=Financial Information;
                           NOR=ùkonomisk informasjon;
                           SVE=Ekonomisk information];
                GroupType=Group }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor on the incoming document. The field may be filled automatically.;
                           NOR=Angir navnet pÜ leverandõren pÜ det innkommende dokumentet. Feltet kan fylles ut automatisk.;
                           SVE=Anger namnet pÜ leverantîren i det inkommande dokumentet. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Name";
                Importance=Promoted;
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT registration number of the vendor, if the document contains that number. The field may be filled automatically.;
                           NOR=Angir organisasjonsnummeret for leverandõren hvis dokumentet inneholder dette nummeret. Feltet kan fylles ut automatisk.;
                           SVE=Anger leverantîrens momsregistreringsnummer om dokumentet innehÜller det numret. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor VAT Registration No.";
                Editable=FALSE }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the IBAN of the vendor on the incoming document.;
                           NOR=Angir IBAN for leverandõren pÜ det innkommende dokumentet.;
                           SVE=Anger IBAN fîr leverantîren i det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor IBAN";
                Editable=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bank branch number of the vendor on the incoming document.;
                           NOR=Angir bankregistreringsnummeret til leverandõren pÜ det innkommende dokumentet.;
                           SVE=Anger bankkontorets nummer fîr leverantîren i det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Bank Branch No.";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bank account number of the vendor on the incoming document.;
                           NOR=Angir bankkontonummeret til leverandõren pÜ det innkommende dokumentet.;
                           SVE=Anger leverantîrens bankkontonummer i det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Bank Account No.";
                Editable=FALSE }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the phone number of the vendor on the incoming document.;
                           NOR=Angir telefonnummeret til leverandõren pÜ det innkommende dokumentet.;
                           SVE=Anger telefonnumret till leverantîren i det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Phone No.";
                Editable=FALSE }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the original document you received from the vendor. You can require the document number for posting, or let it be optional. By default, it's required, so that this document references the original. Making document numbers optional removes a step from the posting process. For example, if you attach the original invoice as a PDF, you might not need to enter the document number. To specify whether document numbers are required, in the Purchases & Payables Setup window, select or clear the Ext. Doc. No. Mandatory field.;
                           NOR=Angir dokumentnummeret for det opprinnelige dokumentet du mottok fra leverandõren. Du kan kreve dokumentnummeret for bokfõring eller la det vëre valgfritt. Det er obligatorisk som standard, slik at dette dokumentet refererer til originalen. Hvis dokumentnumre gjõres valgfrie, fjernes et trinn fra bokfõringsprosessen. Hvis du for eksempel legger ved den opprinnelige fakturaen som en PDF-fil, kan det hende du ikke behõver Ü angi dokumentnummeret. Hvis du vil angi om dokumentnummeret er obligatorisk, gÜr du til vinduet for kjõpsoppsett, og merker av for eller fjerner merket for feltet Eksternt dokumentnr. obligatorisk.;
                           SVE=Anger dokumentnumret fîr det ursprungliga dokumentet som du har fÜtt frÜn leverantîren. Du kan krÑva dokumentnumret fîr bokfîring eller lÜta det vara frivilligt. Som standard krÑvs det i syfte att lÜta detta dokument referera till det ursprungliga. Vid valfria dokumentnummer fîrsvinner ett steg frÜn bokfîringsprocessen. Om du till exempel bifogar den ursprungliga fakturan som en PDF kanske du inte behîver ange dokumentnumret. Fîr att ange om dokumentnummer krÑvs, vÑlj eller rensa fÑltet Externt dok.nr obligatoriskt i fînstret Inkîp & InkîpsinstÑllningar.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Invoice No.";
                Editable=FALSE }

    { 33  ;2   ;Field     ;
                CaptionML=[ENU=Vendor Order No.;
                           NOR=Leverandõrs bestillingsnr.;
                           SVE=Leverantîrens ordernr];
                ToolTipML=[ENU=Specifies the order number, if the document contains that number. The field may be filled automatically.;
                           NOR=Angir ordrenummeret hvis dokumentet inneholder dette nummeret. Feltet kan fylles ut automatisk.;
                           SVE=Anger ordernumret om dokumentet innehÜller det numret. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order No.";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that is printed on the incoming document. This is the date when the vendor created the invoice, for example. The field may be filled automatically.;
                           NOR=Angir datoen som skrives pÜ det innkommende dokumentet. Dette er for eksempel datoen da leverandõren opprettet fakturaen. Feltet kan fylles ut automatisk.;
                           SVE=Anger datumet som skrivs ut pÜ det inkommande dokumentet. Det hÑr Ñr till exempel datumet nÑr leverantîren skapade fakturan. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Promoted;
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the vendor document must be paid. The field may be filled automatically.;
                           NOR=Angir datoen da leverandõrdokumentet mÜ betales. Feltet kan fylles ut automatisk.;
                           SVE=Anger datumet nÑr leverantîrsdokumentet mÜste betalas. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code, if the document contains that code. The field may be filled automatically.;
                           NOR=Angir valutakoden hvis dokumentet inneholder denne koden. Feltet kan fylles ut automatisk.;
                           SVE=Anger valutakoden om dokumentet innehÜller den koden. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Editable=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount excluding VAT for the whole document. The field may be filled automatically.;
                           NOR=Angir belõpet eks. mva for hele dokumentet. Feltet kan fylles ut automatisk.;
                           SVE=Anger beloppet exklusive moms fîr hela dokumentet. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Excl. VAT";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount including VAT for the whole document. The field may be filled automatically.;
                           NOR=Angir belõpet inkl. mva for hele dokumentet. Feltet kan fylles ut automatisk.;
                           SVE=Anger beloppet inklusive moms fîr hela dokumentet. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Incl. VAT";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of VAT that is included in the total amount.;
                           NOR=Angir mva-belõpet som er inkludert i totalbelõpet.;
                           SVE=Anger momsbeloppet som ingÜr i det totala beloppet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Amount";
                Editable=FALSE }

    { 20  ;1   ;Part      ;
                Name=ErrorMessagesPart;
                CaptionML=[ENU=Errors and Warnings;
                           NOR=Feil og advarsler;
                           SVE=Fel och varningar];
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page701;
                PartType=Page;
                ShowFilter=No }

    { 36  ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 83  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 38  ;1   ;Part      ;
                ApplicationArea=#RecordLinks;
                PartType=System;
                SystemPartID=RecordLinks }

    { 39  ;1   ;Part      ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      IncomingDocumentsSetup@1000 : Record 131;
      AutomaticProcessingQst@1004 : TextConst '@@@=%1 is Data Exchange Type;ENU=The Data Exchange Type field is filled on at least one of the selected Incoming Documents.\\Are you sure you want to create documents manually?;NOR=Feltet Datautvekslingstype er utfylt pÜ minst ett av de valgte inngÜende dokumentene.\\Er du sikker pÜ at du vil opprette dokumenter manuelt?;SVE=FÑltet Typ av dataintegration Ñr ifyllt i minst ett av de valda Inkommande dokumenten.\\Vill du skapa dokument manuellt?';
      ClientTypeManagement@1025 : Codeunit 4030;
      CameraProvider@1005 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraProvider" WITHEVENTS RUNONCLIENT;
      HasCamera@1001 : Boolean;
      URL@1003 : Text;
      AttachmentFileName@1008 : Text;
      RecordLinkTxt@1007 : Text;
      OCRResultFileName@1009 : Text;
      IsDataExchTypeEditable@1002 : Boolean;
      OCRDataCorrectionEnabled@1006 : Boolean;
      AdditionalAttachmentsPresent@1010 : Boolean;
      InvalidTypeErr@1013 : TextConst 'ENU=The default attachment is not an XML document.;NOR=Standardvedlegget er ikke et XML-dokument.;SVE=Standardbilagan Ñr inte ett XML-dokument.';
      OpenApprovalEntriesExistForCurrUser@1012 : Boolean;
      OpenApprovalEntriesExist@1015 : Boolean;
      ShowWorkflowStatus@1014 : Boolean;
      EnableReceiveFromOCR@1011 : Boolean;
      CanCancelApprovalForRecord@1016 : Boolean;
      OCRServiceIsEnabled@1017 : Boolean;
      ShowOCRSetup@1018 : Boolean;
      AutomaticCreationActionsAreEnabled@1019 : Boolean;
      RecordHasAttachment@1020 : Boolean;
      RecordLinkExists@1021 : Boolean;
      NoPostedDocumentsErr@1022 : TextConst 'ENU=There are no posted documents.;NOR=Det finnes ingen bokfõrte dokumenter.;SVE=Det finns inga bokfîrda dokument.';
      CanBeSentToOCR@1023 : Boolean;
      AttachEnabled@1026 : Boolean;
      ReplaceMainAttachmentEnabled@1024 : Boolean;

    LOCAL PROCEDURE AskUserPermission@1() : Boolean;
    BEGIN
      IF "Data Exchange Type" = '' THEN
        EXIT(TRUE);

      IF Status <> Status::New THEN
        EXIT(TRUE);

      EXIT(CONFIRM(AutomaticProcessingQst));
    END;

    LOCAL PROCEDURE ShowErrors@2();
    VAR
      ErrorMessage@1001 : Record 700;
      TempErrorMessage@1000 : TEMPORARY Record 700;
    BEGIN
      ErrorMessage.SETRANGE("Context Record ID",RECORDID);
      ErrorMessage.CopyToTemp(TempErrorMessage);
      CurrPage.ErrorMessagesPart.PAGE.SetRecords(TempErrorMessage);
      CurrPage.ErrorMessagesPart.PAGE.UPDATE;
    END;

    LOCAL PROCEDURE SetCalculatedFields@6();
    VAR
      IncomingDocumentAttachment@1000 : Record 133;
    BEGIN
      OCRDataCorrectionEnabled := GetGeneratedFromOCRAttachment(IncomingDocumentAttachment);
      AttachmentFileName := GetMainAttachmentFileName;
      RecordLinkTxt := GetRecordLinkText;
      OCRResultFileName := GetOCRResutlFileName;
      AdditionalAttachmentsPresent := GetAdditionalAttachments(IncomingDocumentAttachment);
      IF AdditionalAttachmentsPresent THEN
        CurrPage.SupportingAttachments.PAGE.LoadDataIntoPart(Rec);
    END;

    LOCAL PROCEDURE SetControlVisibility@9();
    VAR
      ApprovalsMgmt@1000 : Codeunit 1535;
      RelatedRecord@1002 : Variant;
    BEGIN
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
      UpdateOCRSetupVisibility;
      AutomaticCreationActionsAreEnabled := "Data Exchange Type" <> '';
      RecordLinkExists := GetRecord(RelatedRecord);
      CanBeSentToOCR := VerifyCanBeSentToOCR;
      ReplaceMainAttachmentEnabled := CanReplaceMainAttachment;
    END;

    [Integration(TRUE,TRUE)]
    LOCAL PROCEDURE OnCloseIncomingDocumentFromAction@3(VAR IncomingDocument@1000 : Record 130);
    BEGIN
    END;

    LOCAL PROCEDURE VerifyCanBeSentToOCR@4() : Boolean;
    BEGIN
      IF NOT RecordHasAttachment THEN
        EXIT(FALSE);

      EXIT(NOT ("OCR Status" IN
                ["OCR Status"::Sent,"OCR Status"::Success,"OCR Status"::"Awaiting Verification"]));
    END;

    LOCAL PROCEDURE UpdateOCRSetupVisibility@5();
    BEGIN
      OCRServiceIsEnabled := OCRIsEnabled;
      ShowOCRSetup := NOT OCRServiceIsEnabled;
    END;

    EVENT CameraProvider@1005::PictureAvailable@11(PictureName@1001 : Text;PictureFilePath@1000 : Text);
    BEGIN
      AddAttachmentFromServerFile(PictureName,PictureFilePath);
    END;

    BEGIN
    END.
  }
}

