OBJECT Table 91 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00,NAVNO,4PSSE,PE4.06;
  }
  PROPERTIES
  {
    OnInsert=VAR
               User@1000 : Record 2000000120;
             BEGIN
               IF "E-Mail" <> '' THEN
                 EXIT;
               IF "User ID" <> '' THEN
                 EXIT;
               User.SETRANGE("User Name","User ID");
               IF User.FINDFIRST THEN
                 "E-Mail" := COPYSTR(User."Contact Email",1,MAXSTRLEN("E-Mail"));
             END;

    OnDelete=VAR
               NotificationSetup@1000 : Record 1512;
             BEGIN
               NotificationSetup.SETRANGE("User ID","User ID");
               NotificationSetup.DELETEALL(TRUE);
             END;

    ReplicateData=No;
    CaptionML=[ENU=User Setup;
               NOR=Brukeroppsett;
               SVE=AnvÑndarinstÑllningar];
    LookupPageID=Page119;
    DrillDownPageID=Page119;
  }
  FIELDS
  {
    { 1   ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnValidate=VAR
                                                                UserMgt@1000 : Codeunit 418;
                                                              BEGIN
                                                                UserMgt.ValidateUserID("User ID");
                                                              END;

                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=User ID;
                                                              NOR=Bruker-ID;
                                                              SVE=AnvÑndar-ID];
                                                   NotBlank=Yes }
    { 2   ;   ;Allow Posting From  ;Date          ;OnValidate=BEGIN
                                                                CheckAllowedPostingDates(0);
                                                              END;

                                                   CaptionML=[ENU=Allow Posting From;
                                                              NOR=Bokf. tillatt fra;
                                                              SVE=TillÜt bokfîring fr.o.m.] }
    { 3   ;   ;Allow Posting To    ;Date          ;OnValidate=BEGIN
                                                                CheckAllowedPostingDates(0);
                                                              END;

                                                   CaptionML=[ENU=Allow Posting To;
                                                              NOR=Bokf. tillatt til;
                                                              SVE=TillÜt bokfîring t.o.m.] }
    { 4   ;   ;Register Time       ;Boolean       ;CaptionML=[ENU=Register Time;
                                                              NOR=Registrer tid;
                                                              SVE=Reg. av anvÑndartid] }
    { 10  ;   ;Salespers./Purch. Code;Code20      ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Salespers./Purch. Code" <> '' THEN BEGIN
                                                                  ValidateSalesPersonPurchOnUserSetup(Rec);
                                                                  UserSetup.SETCURRENTKEY("Salespers./Purch. Code");
                                                                  UserSetup.SETRANGE("Salespers./Purch. Code","Salespers./Purch. Code");
                                                                  IF UserSetup.FINDFIRST THEN
                                                                    ERROR(Text001,"Salespers./Purch. Code",UserSetup."User ID");
                                                                  UpdateSalesPerson;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Salespers./Purch. Code;
                                                              NOR=Selger/innkjõper - kode;
                                                              SVE=SÑljare/inkîpare kod] }
    { 11  ;   ;Approver ID         ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                //**4PS.so
                                                                //IF "Approver ID" = "User ID" THEN
                                                                //  FIELDERROR("Approver ID");
                                                                //**4PS.eo
                                                              END;

                                                   OnLookup=VAR
                                                              UserSetup@1000 : Record 91;
                                                            BEGIN
                                                              //UserSetup.SETFILTER("User ID",'<>%1',"User ID"); //**4PS.o
                                                              IF PAGE.RUNMODAL(PAGE::"Approval User Setup",UserSetup) = ACTION::LookupOK THEN
                                                                VALIDATE("Approver ID",UserSetup."User ID");
                                                            END;

                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=Approver ID;
                                                              NOR=Godkjenner-ID;
                                                              SVE=GodkÑnnar-ID] }
    { 12  ;   ;Sales Amount Approval Limit;Integer;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" AND ("Sales Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Sales Amount Approval Limit"),FIELDCAPTION("Unlimited Sales Approval"));
                                                                IF "Sales Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Sales Amount Approval Limit;
                                                              NOR=Godkjenningsgrense salg;
                                                              SVE=max. fîrs.belopp att godkÑnna];
                                                   BlankZero=Yes }
    { 13  ;   ;Purchase Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" AND ("Purchase Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Purchase Amount Approval Limit"),FIELDCAPTION("Unlimited Purchase Approval"));
                                                                IF "Purchase Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Purchase Amount Approval Limit;
                                                              NOR=Godkjenningsgrense kjõp;
                                                              SVE=max. inkîpsbelopp som kan godkÑnnas];
                                                   BlankZero=Yes }
    { 14  ;   ;Unlimited Sales Approval;Boolean   ;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" THEN
                                                                  "Sales Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Sales Approval;
                                                              NOR=Ubegrenset salgsgodkjenning;
                                                              SVE=ObegrÑnsad godkÑnnande fîrsÑljning] }
    { 15  ;   ;Unlimited Purchase Approval;Boolean;OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" THEN
                                                                  "Purchase Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Purchase Approval;
                                                              NOR=Ubegrenset kjõpsgodkjenning;
                                                              SVE=ObegrÑnsad godkÑnnande fîr inkîp] }
    { 16  ;   ;Substitute          ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                IF Substitute = "User ID" THEN
                                                                  FIELDERROR(Substitute);
                                                              END;

                                                   OnLookup=VAR
                                                              UserSetup@1000 : Record 91;
                                                            BEGIN
                                                              UserSetup.SETFILTER("User ID",'<>%1',"User ID");
                                                              IF PAGE.RUNMODAL(PAGE::"Approval User Setup",UserSetup) = ACTION::LookupOK THEN
                                                                VALIDATE(Substitute,UserSetup."User ID");
                                                            END;

                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=Substitute;
                                                              NOR=Stedfortreder;
                                                              SVE=ErsÑttare] }
    { 17  ;   ;E-Mail              ;Text100       ;OnValidate=VAR
                                                                MailManagement@1000 : Codeunit 9520;
                                                              BEGIN
                                                                UpdateSalesPerson;
                                                                MailManagement.ValidateEmailAddressField("E-Mail");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 19  ;   ;Request Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" AND ("Request Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Request Amount Approval Limit"),FIELDCAPTION("Unlimited Request Approval"));
                                                                IF "Request Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Request Amount Approval Limit;
                                                              NOR=Godkjenningsgrense forespõrsel;
                                                              SVE=Max.bel godkÑnna ink.begÑran];
                                                   BlankZero=Yes }
    { 20  ;   ;Unlimited Request Approval;Boolean ;OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" THEN
                                                                  "Request Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Request Approval;
                                                              NOR=Ubegrenset forespõrselsgodkjenning;
                                                              SVE=ObegrÑnsad godkÑnnande inkîpsbeg.] }
    { 21  ;   ;Approval Administrator;Boolean     ;OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Approval Administrator" THEN BEGIN
                                                                  UserSetup.SETRANGE("Approval Administrator",TRUE);
                                                                  IF NOT UserSetup.ISEMPTY THEN
                                                                    FIELDERROR("Approval Administrator");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Approval Administrator;
                                                              NOR=Godkjenningsansvarlig;
                                                              SVE=Administratîr fîr godkÑnnande] }
    { 31  ;   ;License Type        ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."License Type" WHERE (User Name=FIELD(User ID)));
                                                   CaptionML=[ENU=License Type;
                                                              NOR=Lisenstype;
                                                              SVE=Licenstyp];
                                                   OptionCaptionML=[ENU=Full User,Limited User,Device Only User,Windows Group,External User;
                                                                    NOR=Fullstendig bruker,Begrenset bruker,Bruker bare for enhet,Windows-gruppe,Ekstern bruker;
                                                                    SVE=FullstÑndig anvÑndare,BegrÑnsad anvÑndare,Enhetsspecifik anvÑndare,Windows-grupp,Extern anvÑndare];
                                                   OptionString=Full User,Limited User,Device Only User,Windows Group,External User }
    { 950 ;   ;Time Sheet Admin.   ;Boolean       ;CaptionML=[ENU=Time Sheet Admin.;
                                                              NOR=Administrasjon av timeliste;
                                                              SVE=Tidrapportadmin.] }
    { 5600;   ;Allow FA Posting From;Date         ;CaptionML=[ENU=Allow FA Posting From;
                                                              NOR=Aktivabokf. tillatt fra;
                                                              SVE=TillÜt anl.bokfîring fr.o.m.] }
    { 5601;   ;Allow FA Posting To ;Date          ;CaptionML=[ENU=Allow FA Posting To;
                                                              NOR=Aktivabokf. tillatt til;
                                                              SVE=TillÜt anl.bokfîring t.o.m.] }
    { 5700;   ;Sales Resp. Ctr. Filter;Code10     ;TableRelation="Responsibility Center".Code;
                                                   CaptionML=[ENU=Sales Resp. Ctr. Filter;
                                                              NOR=Filter for ansv.senter - salg;
                                                              SVE=Fîrs.ansvarsenhet filter] }
    { 5701;   ;Purchase Resp. Ctr. Filter;Code10  ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                CheckPurchDefaultWithinFilter; //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Purchase Resp. Ctr. Filter;
                                                              NOR=Filter for ansv.senter - kjõp;
                                                              SVE=Inkîpsansvarsenhet filter] }
    { 5900;   ;Service Resp. Ctr. Filter;Code10   ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Service Resp. Ctr. Filter;
                                                              NOR=Filter for ansv.sent - service;
                                                              SVE=Serviceansvarsenhet filter] }
    { 10600;  ;Application always Allowed;Boolean ;CaptionML=[ENU=Application always Allowed;
                                                              NOR=Utligning alltid tillatt];
                                                   Description=NAVNO }
    { 11012000;;No Access Ext. Contract Fixed;Boolean;
                                                   CaptionML=[ENU=No Access Extension Contract Fixed;
                                                              NOR=Ingen tilgang til fast ETA-kontrakt;
                                                              SVE=Ingen Ütkomst till lÜst éTA-kontrakt] }
    { 11012005;;No Access Budget Adjustm Fixed;Boolean;
                                                   CaptionML=[ENU=No Access Budget Adjustment Fixed;
                                                              NOR=Ingen tilgang til fast budsjettjustering;
                                                              SVE=Ingen Ütkomst till lÜst budgetjustering] }
    { 11012007;;No Access Budget Fixed;Boolean    ;CaptionML=[ENU=No Access Budget Fixed;
                                                              NOR=Ingen tilgang til fast budsjett;
                                                              SVE=Ingen Ütkomst till lÜst budget] }
    { 11012009;;No Access Requisition Fixed;Boolean;
                                                   CaptionML=ENU=No Access Requisition Fixed;
                                                   Description=DP01137 }
    { 11012010;;Employee No.       ;Code20        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF "Employee No." = '' THEN BEGIN
                                                                  TESTFIELD("Access own Hours only",FALSE);
                                                                  "Planner (Resources)" := FALSE;  //DP00465.n
                                                                  TESTFIELD("Plant Order Picker", FALSE);  //DP00688
                                                                END ELSE BEGIN
                                                                  IF "Plant Order Picker" THEN  //DP00688
                                                                    VALIDATE("OP Filter Arrival Plant Orders");
                                                                END;
                                                                CALCFIELDS("Name Employee");
                                                              END;

                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Employee No.;
                                                              NOR=Ansattnr;
                                                              SVE=AnstÑllningsnr] }
    { 11012020;;Access own Hours only;Boolean     ;OnValidate=BEGIN
                                                                //**4PS
                                                                IF "Access own Hours only" THEN
                                                                  TESTFIELD("Employee No.")
                                                                ELSE
                                                                  "Posting Hours allowed" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=No Access another ones Hours;
                                                              NOR=Ingen tilgang til andres timer;
                                                              SVE=Ingen Ütkomst till nÜgon annans timmar] }
    { 11012025;;Posting Hours allowed;Boolean     ;OnValidate=BEGIN
                                                                //**4PS
                                                                TESTFIELD("Access own Hours only", TRUE)
                                                              END;

                                                   CaptionML=[ENU=Posting Hours allowed;
                                                              NOR=Bokfõring av timer er tillatt;
                                                              SVE=Bokfîring av timmar Ñr tillÜtet] }
    { 11012030;;Text Editor Path   ;Text250       ;CaptionML=[ENU=Text Editor Path;
                                                              NOR=Bane for teksteditor;
                                                              SVE=SîkvÑg fîr texteditor] }
    { 11012035;;PDF Reader Path    ;Text250       ;CaptionML=[ENU=PDF Reader Path;
                                                              SVE=SîkvÑg PDF-lÑsare] }
    { 11012040;;Search Directory   ;BLOB          ;CaptionML=[ENU=Search Directory;
                                                              NOR=Sõk katalog;
                                                              SVE=Sîkkatalog];
                                                   SubType=User-Defined }
    { 11012050;;Purchaser          ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Purchaser;
                                                              NOR=Innkjõper;
                                                              SVE=Inkîpare] }
    { 11012055;;Salesperson        ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson;
                                                              NOR=Selger;
                                                              SVE=SÑljare] }
    { 11012060;;Department Code    ;Code20        ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Avdelingskode;
                                                              SVE=Avdelningskod];
                                                   CaptionClass='1,1,1' }
    { 11012065;;Department Code Filter;Text245    ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                "Department Code Filter" := UPPERCASE("Department Code Filter");
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              NOR=Avdelingskode, filter:;
                                                              SVE=Avdelningskod, filter];
                                                   Description=ENH-017: 100 -> 245 Characters, last 5 Characters for |' ' set !!;
                                                   CaptionClass='1,3,1' }
    { 11012066;;Department Authoriz. Active;Boolean;
                                                   CaptionML=[ENU=Department Authorization Active;
                                                              NOR=Avdelingsgodkjenning aktiv;
                                                              SVE=Avdelningsbehîrighet Ñr aktiv] }
    { 11012067;;Name Employee      ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Employee No.)));
                                                   CaptionML=[ENU=Name Employee;
                                                              NOR=Navn pÜ ansatt.;
                                                              SVE=Namn pÜ anstÑlld.];
                                                   Editable=No }
    { 11012080;;Password           ;BLOB          ;CaptionML=[ENU=Password;
                                                              NOR=Passord;
                                                              SVE=Lîsenord] }
    { 11012090;;Service Authorization Active;Boolean;
                                                   CaptionML=[ENU=Service Authorization Active;
                                                              SVE=Behîrighet aktiv fîr serviceorder] }
    { 11012100;;Project Authoriz. Active;Boolean  ;CaptionML=[ENU=Project Authorization Active;
                                                              NOR=Prosjektgodkjenning aktiv;
                                                              SVE=Aktiv projektbehîrighet] }
    { 11012110;;Reopen Purch. Order Allowed;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=[ENU=Reopen Purch. Order Allowed;
                                                              NOR=GjenÜpne innkjõpsordre tillatt;
                                                              SVE=SlÑpp inkîpsorder tillÜts] }
    { 11012112;;Reopen Project Delivery Note;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=[ENU=Reopen Project Delivery Note;
                                                              SVE=èterîppna Projektleveransbesked] }
    { 11012115;;Planner (Resources);Boolean       ;OnValidate=BEGIN
                                                                //DP00465
                                                                IF "Planner (Resources)" THEN
                                                                  TESTFIELD("Employee No.");
                                                              END;

                                                   CaptionML=[ENU=Planner (Resources);
                                                              SVE=Planerare (Resurser)] }
    { 11012120;;Estimator          ;Code20        ;TableRelation=Employee.No.;
                                                   CaptionML=[ENU=Estimator;
                                                              NOR=Kalkylatõr;
                                                              SVE=Kalkylator] }
    { 11012125;;No Access Estimate Fixed;Boolean  ;CaptionML=[ENU=No Access Estimate Fixed;
                                                              SVE=Ingen Ütkomst till lÜst kalkyl] }
    { 11012126;;No Access Recipe Fixed;Boolean    ;CaptionML=[ENU=No Access Recipe Fixed;
                                                              SVE=Ingen Ütkomst till lÜst mall] }
    { 11012130;;Transfer Entries Allowed;Boolean  ;CaptionML=[ENU=Transfer Entries Allowed;
                                                              SVE=ôverfîring tillÜts] }
    { 11012135;;Activate Full Cost Price;Boolean  ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Activate Full Cost Price;
                                                   Description=C057346 }
    { 11012140;;Hide Zero Lines    ;Boolean       ;CaptionML=[ENU=Hide Zero Lines;
                                                              NOR=Gjem Nullrader;
                                                              SVE=Dîlj nollrader];
                                                   Description=C025240 }
    { 11012150;;Autom. Get Project Inspections;Boolean;
                                                   OnValidate=VAR
                                                                SiteManagerFormSetup@1100525000 : Record 11125525;
                                                              BEGIN
                                                                //**4PS C024523
                                                                IF "Autom. Get Project Inspections" THEN BEGIN
                                                                  IF NOT SiteManagerFormSetup.GET THEN
                                                                    FIELDERROR("Autom. Get Project Inspections");
                                                                  SiteManagerFormSetup.TESTFIELD("Site Mgt. Active", TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Automaticaly Get Project Inspections;
                                                              NOR=Hent prosjektinspeksjoner automatisk;
                                                              SVE=HÑmta projektinspektioner automatiskt];
                                                   Description=Inspections Site Manager Form }
    { 11012160;;Answer Change CO in Budget;Option ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Answer Change Cost Object in Budget Line;
                                                   OptionCaptionML=ENU=Ask question every time,Complete with Cost Object Data,Copy Cost Object Data,Don't Copy Cost Object Data;
                                                   OptionString=Ask Question,Complete With Cost Object Data,Copy Cost Object,Do not Copy Cost Object }
    { 11012540;;Plant Category Filter (Rem.PO);Code100;
                                                   TableRelation="Plant Category";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Plant Category Filter (Removal Order);
                                                              NOR=Kategorifilter for maskin (fjerningsordre);
                                                              SVE=Maskinkategorifilter (Uttagsorder)] }
    { 11012550;;Access Plant Cost Objects;Boolean ;CaptionML=[ENU=Access Plant Cost Object;
                                                              NOR=Tilgang til maskinens kostnadsobjekt;
                                                              SVE=HÑmta Maskinens kostnadsobjekt] }
    { 11012551;;Access Plant Requests;Option      ;CaptionML=[ENU=Access Plant Requests;
                                                              SVE=TillgÜng till MaskinbegÑran];
                                                   OptionCaptionML=[ENU=" ,Yes,Request,Process";
                                                                    NOR=" ,Ja,Forespõrsel,Prosess";
                                                                    SVE=" ,Ja,FîrfrÜgan,Process"];
                                                   OptionString=No,Yes,Request,Process }
    { 11012552;;Plant Order Picker ;Boolean       ;OnValidate=BEGIN
                                                                //**4PS DP00688
                                                                IF "Plant Order Picker" THEN BEGIN
                                                                  TESTFIELD("Employee No.");
                                                                  IF "OP Filter Arrival Plant Orders" = '' THEN
                                                                    "OP Filter Arrival Plant Orders" := "Employee No.";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Plant Order Picker;
                                                              SVE=Maskinorderplockare] }
    { 11012553;;OP Filter Arrival Plant Orders;Code100;
                                                   TableRelation=Employee;
                                                   OnValidate=VAR
                                                                Empl@1100529000 : Record 5200;
                                                              BEGIN
                                                                //**4PS DP00688
                                                                IF "Plant Order Picker" THEN BEGIN
                                                                  TESTFIELD("OP Filter Arrival Plant Orders");
                                                                  Empl.FILTERGROUP(2);
                                                                  Empl.SETFILTER("No.", "OP Filter Arrival Plant Orders");
                                                                  Empl.FILTERGROUP(0);
                                                                  Empl.SETRANGE("No.", "Employee No.");
                                                                  IF Empl.ISEMPTY THEN
                                                                    MESSAGE(Text11012003, FIELDCAPTION("Plant Order Picker"),
                                                                      FIELDCAPTION("Employee No."), "Employee No.", FIELDCAPTION("OP Filter Arrival Plant Orders"));
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              EmplNo@1100529000 : Code[20];
                                                            BEGIN
                                                              //**4PS DP00688
                                                              EmplNo := LookupOPFilterArrivalPlantOrder();
                                                              IF EmplNo <> '' THEN
                                                                "OP Filter Arrival Plant Orders" := EmplNo;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Order Picker Filter Arrival Plant Orders;
                                                              SVE=Orderplockares filter fîr Maskinordermottagning] }
    { 11012554;;Access Plant Transport Status;Boolean;
                                                   CaptionML=[ENU=Access Plant Transport Statuss;
                                                              SVE=TillgÜng till Maskintransportstatus];
                                                   Description=External Transport Planning }
    { 11012555;;Access Close PO Receipt;Boolean   ;CaptionML=[ENU=Access Close Plant Order Receipt;
                                                              SVE=TillgÜng till stÑngd Maskinorderinleverans] }
    { 11012560;;Default Document Filter;Code10    ;TableRelation="Document Filter"."Document Filter" WHERE (User ID=FIELD(User ID));
                                                   CaptionML=[ENU=Default Document Filter;
                                                              NOR=Standarddokumentfilter;
                                                              SVE=Standarddokumentfilter] }
    { 11012570;;Approvement Initials;Code10       ;TableRelation="Invoice Approval Initials".Code;
                                                   CaptionML=[ENU=Approvement Initials;
                                                              NOR=Godkjenningsinitialer;
                                                              SVE=GodkÑnnandeinitialer] }
    { 11012580;;Resp.Pers.Closing.Proc.Project;Boolean;
                                                   CaptionML=[ENU=Resp.Person Closing Procedure Projects;
                                                              NOR=Ansvarlig person Õ lukkeprosedyre for prosjekt;
                                                              SVE=StÑngningsprocedur fîr projekt av ansvarig person] }
    { 11012590;;Resp.Pers.Closing.Proc.Service;Boolean;
                                                   CaptionML=[ENU=Resp.Person Closing Procedure Service;
                                                              NOR=Ansvarlig person Õ lukkeprosedyre for service;
                                                              SVE=StÑngningsprocedur fîr service av ansvarig person] }
    { 11012600;;Purchase Resp. Ctr. Default;Code10;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                CheckPurchDefaultWithinFilter; //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Purchase Resp. Ctr. Default;
                                                              NOR=Innkjõpsansvarsenhet standard;
                                                              SVE=Inkîpsansvarsenhet standard] }
    { 11012610;;Use Phone Integration;Boolean     ;CaptionML=[ENU=Use Phone Integration;
                                                              NOR=Bruk telefonintegrering;
                                                              SVE=AnvÑnd telefonintegration] }
    { 11012620;;Access Job Blocking Code;Boolean  ;CaptionML=[ENU=Access Job Blocking Code;
                                                              NOR=Tilgang til jobbsperrekode;
                                                              SVE=HÑmta jobbspÑrrkod] }
    { 11012630;;Ignore Vendor Filter;Boolean      ;CaptionML=[ENU=Ignore Vendor Filter;
                                                              NOR=Ignorer leverandõrfilter;
                                                              SVE=Ignorera leverantîrsfilter] }
    { 11012660;;Buyers Mgt. Exchange;Option       ;CaptionML=[ENU=Buyers Mgt. Exchange;
                                                              SVE=Kîparhantering byte];
                                                   OptionCaptionML=ENU=No,Project Level,Company Level,Both Levels;
                                                   OptionString=No,Project Level,Company Level,Both Levels }
    { 11012670;;No Access S&O Frozen Prognosis;Boolean;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=No Access S&O Frozen Prognosis }
    { 11012680;;No Access Proj. Frozen Progn.;Boolean;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=No Access Project Frozen Prognosis }
    { 11012700;;Skip Approval E-mail;Boolean      ;CaptionML=ENU=Skip Approval E-mail;
                                                   Description=IDYN DC }
    { 11012710;;Ignore Source Code Filter;Boolean ;CaptionML=[ENU=Ignore Source Code Filter on G/L Entries/Bank Entries;
                                                              SVE=Ignorera kÑllkodsfilter pÜ red.transaktioner] }
    { 11012720;;Ignore Bank Account Filter;Boolean;CaptionML=[ENU=Ignore Bank Account Filter In Telebank;
                                                              SVE=Ignorera bankkontofilter i Telebank] }
    { 11012730;;Recipe Group       ;Code10        ;TableRelation="Recipe Group".No.;
                                                   CaptionML=[ENU=Recipe Group;
                                                              NOR=Maltype;
                                                              SVE=Malltyp] }
    { 11012735;;GRP Edit Permission;Boolean       ;CaptionML=ENU=Resource Planning Edit Permission }
    { 11012740;;Week of Hour Accounting;Option    ;CaptionML=ENU=Week of Hour Accounting;
                                                   OptionCaptionML=ENU=Current Week,Last Week;
                                                   OptionString=Current Week,Last Week }
    { 11012750;;No Access Pl. Rec. Matrix Fix.;Boolean;
                                                   CaptionML=ENU=No Access Plot Recording Matrix Fixed }
    { 11012760;;IBIS-TRAD Import Permission;Option;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Collectivized Import Option Budget;
                                                   OptionCaptionML=ENU=No,Project,Company,Both;
                                                   OptionString=No,Project,Company,Both }
    { 11012770;;Access Proj.Info. on Serv.Loc.;Boolean;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Change Project Information on Service Location }
    { 11012780;;Post Final Inst Purch Order;Boolean;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Post final installment purchase order }
    { 11128000;;Show amounts in HourAcc;Boolean   ;CaptionML=[ENU=Show Amounts in HourAccounting;
                                                              NOR=Vis belõp i Timerapportering;
                                                              SVE=Visa belopp i tidredovisningen];
                                                   Description=RFC256 }
    { 11128001;;Allow Symbrio Export Date;Boolean ;CaptionML=[ENU=Allow changing Symbrio Export Date;
                                                              NOR=Tillat endring av Symbrio Export Date;
                                                              SVE=TillÜt Ñndra Symbrio Exportdatum];
                                                   Description=RFC-1220 }
    { 11128050;;Department Code Filter 2;Text245  ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                //190320
                                                                "Department Code Filter 2" := UPPERCASE("Department Code Filter 2");
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Department Code Filter;
                                                              NOR=Avdelingskode, filter:;
                                                              SVE=Avdelningskod, filter] }
    { 11128051;;Allow Change Profile;Boolean      ;DataClassification=ToBeClassified;
                                                   CaptionML=SVE=TillÜt Ñndra profil;
                                                   Description=Certego GAP 44 }
    { 12047958;;Allow Posting <> Today;Boolean    ;OnValidate=BEGIN
                                                                CLEAR("Allow Posting From");
                                                                CLEAR("Allow Posting To");
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Allow Posting <> Today;
                                                              SVE=TillÜt bokfîring <> dagens datum];
                                                   Description=PEB0034 (12047958) }
  }
  KEYS
  {
    {    ;User ID                                 ;Clustered=Yes }
    {    ;Salespers./Purch. Code                   }
    {    ;Employee No.                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=The %1 Salesperson/Purchaser code is already assigned to another User ID %2.;NOR=Selger-/innkjõperkoden %1 er allerede tilordnet en annen bruker-ID %2.;SVE=SÑljar-/inkîparkoden %1 har redan tilldelats en annan anvÑndare (ID: %2).';
      Text003@1002 : TextConst 'ENU="You cannot have both a %1 and %2. ";NOR="Du kan ikke ha bÜde %1 og %2. ";SVE="Du kan inte ha bÜde %1 och %2. "';
      Text005@1004 : TextConst 'ENU=You cannot have approval limits less than zero.;NOR=Du kan ikke ha godkjenningsgrenser som er mindre enn null.;SVE=GodkÑnnandegrÑnserna fÜr inte vara lÑgre Ñn noll.';
      SalesPersonPurchaser@1011 : Record 13;
      PrivacyBlockedGenericErr@1013 : TextConst '@@@="%1 = salesperson / purchaser code.";ENU=Privacy Blocked must not be true for Salesperson / Purchaser %1.;NOR=Personvern sperret mÜ ikke vëre oppfylt forˇselger/innkjõper %1.';
      UserSetupManagement@1001 : Codeunit 5700;
      Text11012000@1100485000 : TextConst 'ENU=%1 lays outside %2.;NOR=%1 ligger utenfor %2.;SVE=%1 ligger utanfîr %2.';
      Text11012001@1100529000 : TextConst 'ENU=Anonymous (To Plan)';
      Text11012002@1100529001 : TextConst 'ENU=All;NOR=All;SVE=Alla';
      Text11012003@1100529002 : TextConst 'ENU=Attention: %1 - %2 ''%3'' not in %4;SVE=OBSERVERA: %1 - %2 ''%3'' finns inte i %4';

    [External]
    PROCEDURE CreateApprovalUserSetup@3(User@1000 : Record 2000000120);
    VAR
      UserSetup@1001 : Record 91;
      ApprovalUserSetup@1002 : Record 91;
    BEGIN
      ApprovalUserSetup.INIT;
      ApprovalUserSetup.VALIDATE("User ID",User."User Name");
      ApprovalUserSetup.VALIDATE("Sales Amount Approval Limit",GetDefaultSalesAmountApprovalLimit);
      ApprovalUserSetup.VALIDATE("Purchase Amount Approval Limit",GetDefaultPurchaseAmountApprovalLimit);
      ApprovalUserSetup.VALIDATE("E-Mail",User."Contact Email");
      UserSetup.SETRANGE("Sales Amount Approval Limit",UserSetup.GetDefaultSalesAmountApprovalLimit);
      IF UserSetup.FINDFIRST THEN
        ApprovalUserSetup.VALIDATE("Approver ID",UserSetup."Approver ID");
      IF ApprovalUserSetup.INSERT THEN;
    END;

    [External]
    PROCEDURE GetDefaultSalesAmountApprovalLimit@1() : Integer;
    VAR
      UserSetup@1001 : Record 91;
      DefaultApprovalLimit@1000 : Integer;
      LimitedApprovers@1002 : Integer;
    BEGIN
      UserSetup.SETRANGE("Unlimited Sales Approval",FALSE);

      IF UserSetup.FINDFIRST THEN BEGIN
        DefaultApprovalLimit := UserSetup."Sales Amount Approval Limit";
        LimitedApprovers := UserSetup.COUNT;
        UserSetup.SETRANGE("Sales Amount Approval Limit",DefaultApprovalLimit);
        IF LimitedApprovers = UserSetup.COUNT THEN
          EXIT(DefaultApprovalLimit);
      END;

      // Return 0 if no user setup exists or no default value is found
      EXIT(0);
    END;

    [External]
    PROCEDURE GetDefaultPurchaseAmountApprovalLimit@2() : Integer;
    VAR
      UserSetup@1002 : Record 91;
      DefaultApprovalLimit@1001 : Integer;
      LimitedApprovers@1000 : Integer;
    BEGIN
      UserSetup.SETRANGE("Unlimited Purchase Approval",FALSE);

      IF UserSetup.FINDFIRST THEN BEGIN
        DefaultApprovalLimit := UserSetup."Purchase Amount Approval Limit";
        LimitedApprovers := UserSetup.COUNT;
        UserSetup.SETRANGE("Purchase Amount Approval Limit",DefaultApprovalLimit);
        IF LimitedApprovers = UserSetup.COUNT THEN
          EXIT(DefaultApprovalLimit);
      END;

      // Return 0 if no user setup exists or no default value is found
      EXIT(0);
    END;

    [External]
    PROCEDURE HideExternalUsers@5();
    VAR
      PermissionManager@1001 : Codeunit 9002;
      OriginalFilterGroup@1000 : Integer;
    BEGIN
      IF NOT PermissionManager.SoftwareAsAService THEN
        EXIT;

      OriginalFilterGroup := FILTERGROUP;
      FILTERGROUP := 2;
      CALCFIELDS("License Type");
      SETFILTER("License Type",'<>%1',"License Type"::"External User");
      FILTERGROUP := OriginalFilterGroup;
    END;

    LOCAL PROCEDURE UpdateSalesPerson@4();
    VAR
      SalespersonPurchaser@1000 : Record 13;
    BEGIN
      IF ("E-Mail" <> '') AND SalespersonPurchaser.GET("Salespers./Purch. Code") THEN BEGIN
        SalespersonPurchaser."E-Mail" := COPYSTR("E-Mail",1,MAXSTRLEN(SalespersonPurchaser."E-Mail"));
        SalespersonPurchaser.MODIFY;
      END;
    END;

    LOCAL PROCEDURE ValidateSalesPersonPurchOnUserSetup@298(UserSetup2@1000 : Record 91);
    BEGIN
      IF UserSetup2."Salespers./Purch. Code" <> '' THEN
        IF SalesPersonPurchaser.GET(UserSetup2."Salespers./Purch. Code") THEN
          IF SalesPersonPurchaser.VerifySalesPersonPurchaserPrivacyBlocked(SalesPersonPurchaser) THEN
            ERROR(PrivacyBlockedGenericErr,UserSetup2."Salespers./Purch. Code")
    END;

    [External]
    PROCEDURE CheckAllowedPostingDates@6(NotificationType@1000 : 'Error,Notification');
    BEGIN
      UserSetupManagement.CheckAllowedPostingDatesRange(
        "Allow Posting From","Allow Posting To",NotificationType,DATABASE::"User Setup");
    END;

    PROCEDURE CheckPurchDefaultWithinFilter@1100485000();
    VAR
      TempRespCenterRec@1100485000 : TEMPORARY Record 5714;
    BEGIN
      //**4PS
      TempRespCenterRec.Code := "Purchase Resp. Ctr. Default";
      TempRespCenterRec.INSERT;
      TempRespCenterRec.SETFILTER(Code, "Purchase Resp. Ctr. Filter");
      IF NOT TempRespCenterRec.FIND('-') THEN
        ERROR(Text11012000, FIELDCAPTION("Purchase Resp. Ctr. Default"), FIELDCAPTION("Purchase Resp. Ctr. Filter"));
    END;

    PROCEDURE GetPassword@1100485001() : Text[30];
    VAR
      lTxtPassword@1100485001 : Text[30];
      lInStream@1100485000 : InStream;
    BEGIN
      //**4PS
      CALCFIELDS(Password);
      IF NOT Password.HASVALUE THEN
        EXIT('');

      Password.CREATEINSTREAM(lInStream);
      lInStream.READTEXT(lTxtPassword);
      EXIT(lTxtPassword);
    END;

    PROCEDURE SetPassword@1100485002(iTxtPassword@1100485000 : Text[30]);
    VAR
      lOutStream@1100485001 : OutStream;
    BEGIN
      //**4PS
      IF iTxtPassword <> '' THEN BEGIN
        Rec.Password.CREATEOUTSTREAM(lOutStream);
        lOutStream.WRITETEXT(iTxtPassword);
      END ELSE
        CLEAR(Password);
    END;

    PROCEDURE IsHourController@1100525000() : Boolean;
    VAR
      HourController@1100525000 : Record 11012008;
    BEGIN
      //**4PS
      IF "Employee No." <> '' THEN BEGIN
        HourController.SETCURRENTKEY("Controller No.");
        HourController.SETRANGE("Controller No.", "Employee No.");
        EXIT(NOT HourController.ISEMPTY);
      END;
    END;

    PROCEDURE CurrentUserIsSuperApprover@1100528401() : Boolean;
    VAR
      UserSetup@1100528402 : Record 91;
      Employee@1100528401 : Record 5200;
    BEGIN
      //**4PS
      UserSetup.GET(USERID);
      UserSetup.TESTFIELD("Employee No.");
      Employee.GET(UserSetup."Employee No.");
      EXIT(Employee."Super Approver");
    END;

    PROCEDURE LookupOPFilterArrivalPlantOrder@1100529000() : Code[20];
    VAR
      UserSetup@1100529002 : Record 91;
      Empl@1100529001 : Record 5200;
      TmpEmpl@1100529000 : TEMPORARY Record 5200;
    BEGIN
      //**4PS DP00688
      TmpEmpl."No." := '''''';
      TmpEmpl."Last Name" := Text11012001;
      TmpEmpl."Full Name" := TmpEmpl."Last Name";
      TmpEmpl.INSERT;
      TmpEmpl."No." := '*';
      TmpEmpl."Last Name" := Text11012002;
      TmpEmpl."Full Name" := TmpEmpl."Last Name";
      TmpEmpl.INSERT;
      IF "Plant Order Picker" THEN BEGIN   // Current record (may not updated yet)
        IF Empl.GET("Employee No.") THEN BEGIN
          TmpEmpl := Empl;
          TmpEmpl.INSERT;
        END;
      END;
      UserSetup.SETRANGE("Plant Order Picker", TRUE);
      UserSetup.SETFILTER("User ID", '<>%1', "User ID");  //Skip current
      UserSetup.SETFILTER("Employee No.", '<>%1', '');
      IF UserSetup.FINDSET THEN BEGIN
        REPEAT
          IF Empl.GET(UserSetup."Employee No.") AND (NOT TmpEmpl.GET(UserSetup."Employee No.")) THEN BEGIN
            TmpEmpl := Empl;
            TmpEmpl.INSERT;
          END;
        UNTIL UserSetup.NEXT =0;
      END;
      TmpEmpl.FINDFIRST;
      IF PAGE.RUNMODAL(0, TmpEmpl) = ACTION::LookupOK THEN
        EXIT(TmpEmpl."No.");
      EXIT('');
    END;

    PROCEDURE GetUserEmail@1100528000(UserID@1100528000 : Code[50]) : Text;
    VAR
      UserSetup@1100528001 : Record 91;
      Employee@1100528002 : Record 5200;
    BEGIN
      //**4PS
      IF UserID <> '' THEN BEGIN
        IF UserSetup.GET(UserID) THEN BEGIN
          IF UserSetup."E-Mail" <> '' THEN
            EXIT(UserSetup."E-Mail");
          IF UserSetup."Employee No." <> '' THEN BEGIN
            IF Employee.GET(UserSetup."Employee No.") THEN
              EXIT(Employee."Company E-Mail");
          END;
        END;
      END;
      EXIT('');
    END;

    PROCEDURE GetEmployeeNoOrSalespersPurchCode@1100525001() : Code[20];
    BEGIN
      //**4PS
      IF "Employee No." <> '' THEN
        EXIT("Employee No.")
      ELSE
        EXIT("Salespers./Purch. Code");
    END;

    PROCEDURE GetDepartmentCodeFilter@1100285100() : Text;
    BEGIN
      EXIT("Department Code Filter"+"Department Code Filter 2");
    END;

    PROCEDURE SetDepartmentCodeFilter@1100285101(FilterText@1100285100 : Text);
    VAR
      maxLen@1100285101 : Integer;
    BEGIN
      maxLen := MAXSTRLEN("Department Code Filter");
      "Department Code Filter" := UPPERCASE(COPYSTR(FilterText,1,maxLen));
      IF STRLEN(FilterText) > maxLen THEN
        "Department Code Filter 2" := UPPERCASE(COPYSTR(FilterText,maxLen+1));
    END;

    BEGIN
    {
      ENH017  140321  ITERO.GH Field Department Code Filter 100 -> 245 Characters, last 5 Characters for |' ' set !!
      PEB *** Begin ***
      PEB0034 Set Allow Posting From and Allow Posting To
      PEB
      PEB *** End ***
      190320 ORANGO.DL #22909 "Department Code Filter" too short
      190117 ORANGO.DL RFC256 new field "Show amounts in HourAcc", normally hidden if type=hours
      190510 ORANGO.PR RFC-1220 New field "Allow Symbrio Export Date"
      200109 ORANGO.PR GAP-44 Certego, New Field "Allow Change Profile"
    }
    END.
  }
}

