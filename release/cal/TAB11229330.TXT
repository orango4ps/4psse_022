OBJECT Table 11229330 Purchase Requisition
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF "No." = '' THEN BEGIN
                 IF "No. Series" = '' THEN BEGIN
                   PurchaseSetup.GET;
                   PurchaseSetup.TESTFIELD("Requisition Nos.");
                   "No. Series" := PurchaseSetup."Requisition Nos.";
                 END;
                 NoSeriesMgt.InitSeries("No. Series", xRec."No. Series", 0D, "No.", "No. Series");
               END;
               TESTFIELD("No.");
               "Created by" := USERID;
               "Date Created" := TODAY;
               "Modified by" := USERID;
               "Last Date Modified" := TODAY;
             END;

    OnModify=BEGIN
               "Modified by" := USERID;
               "Last Date Modified" := TODAY;
             END;

    OnDelete=VAR
               PurchaseRequisitionLine@1100529400 : Record 11229331;
               VendorbyPurchaseRequisition@1100529401 : Record 11229332;
               PurchaserbyPurchRequisition@1100528900 : Record 11229337;
               PurchaseText@1100528901 : Record 11012067;
               ApprovalsMgmt@1100529600 : Codeunit 1535;
             BEGIN
               ApprovalsMgmt.DeleteApprovalEntries(RECORDID);

               PurchaseRequisitionLine.SETRANGE("Purchase Requisition No.", "No.");
               PurchaseRequisitionLine.DELETEALL(TRUE);

               VendorbyPurchaseRequisition.SETRANGE("Purchase Requisition No.", "No.");
               VendorbyPurchaseRequisition.DELETEALL(TRUE);

               PurchaserbyPurchRequisition.SETRANGE("Purchase Requisition No.", "No.");
               PurchaserbyPurchRequisition.DELETEALL(TRUE);

               PurchaseText.SETRANGE("Line Type", PurchaseText."Line Type"::Requisition);
               PurchaseText.SETRANGE("No.", "No.");
               PurchaseText.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Purchase Requisition;
               SVE=Inkîpsrekvisition];
    LookupPageID=Page11126652;
    DrillDownPageID=Page11126652;
  }
  FIELDS
  {
    { 10  ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  PurchaseSetup.GET;
                                                                  NoSeriesMgt.TestManual(PurchaseSetup."Requisition Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.;
                                                              SVE=Nr] }
    { 11  ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 20  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 30  ;   ;Project No.         ;Code20        ;TableRelation=Job;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Service Order No.", '');
                                                                GetDefaultsFromProject;  //DP01314
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr.;
                                                              SVE=Projektnr] }
    { 31  ;   ;Project Description ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Job.Description WHERE (No.=FIELD(Project No.)));
                                                   CaptionML=[ENU=Project Description;
                                                              SVE=Projektbeskrivning];
                                                   Editable=No }
    { 40  ;   ;Purchase Action     ;Code10        ;TableRelation="Project Purchase Action".Code WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                GetDefaultsFromPurchaseAction;
                                                              END;

                                                   CaptionML=[ENU=Purchase Action;
                                                              NOR=Innkjõpshandling;
                                                              SVE=InkîpsÜtgÑrd] }
    { 50  ;   ;Status              ;Option        ;OnValidate=VAR
                                                                PurchaseRequisitionMgt@1100525000 : Codeunit 11229287;
                                                                ApprovalManagement4PSConstr@1100528202 : Codeunit 11125349;
                                                                ApprovalsMgmt@1100528201 : Codeunit 1535;
                                                                OpenApprovalEntriesExist@1100528200 : Boolean;
                                                              BEGIN
                                                                OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
                                                                IF OpenApprovalEntriesExist OR ApprovalManagement4PSConstr.IsPurchaseRequisitionApprovalsWorkflowEnabled(Rec) THEN BEGIN
                                                                  CASE Status OF
                                                                    Status::Open:
                                                                      BEGIN
                                                                        //No checks because event onreject wil send reopen action before the status of approval entry is set to rejected.
                                                                      END;
                                                                    Status::Released:
                                                                      BEGIN
                                                                        IF (xRec.Status <> xRec.Status::Open) OR OpenApprovalEntriesExist THEN
                                                                          ERROR(Text022)
                                                                      END;
                                                                    Status::Approved:
                                                                      BEGIN
                                                                        IF (xRec.Status <> xRec.Status::Released) OR OpenApprovalEntriesExist THEN
                                                                        ERROR(Text022)
                                                                      END;
                                                                    Status::Definitive:
                                                                      BEGIN
                                                                        IF (xRec.Status <> xRec.Status::Approved) THEN
                                                                          ERROR(Text022)
                                                                      END;
                                                                    Status::Closed, Status::Cancelled:
                                                                      BEGIN
                                                                        IF OpenApprovalEntriesExist THEN
                                                                          ERROR(Text022)
                                                                      END;
                                                                  END;
                                                                END;

                                                                Fixed := (Status <> Status::Open);  //db, 27-09-16
                                                                PurchaseRequisitionMgt.CheckStatusAndMandatoryFields(Rec);  //db, 06-02-17
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=ENU=Open,Released,Approved,Definitive,Closed,Cancelled;
                                                   OptionString=Open,Released,Approved,Definitive,Closed,Cancelled }
    { 60  ;   ;Purchaser Code      ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                ValidatePurchaser;
                                                              END;

                                                   CaptionML=[ENU=Purchaser Code;
                                                              NOR=Innkjõperkode;
                                                              SVE=Inkîparkod] }
    { 61  ;   ;Name Purchaser      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Purchaser Code)));
                                                   CaptionML=[ENU=Name Purchaser;
                                                              NOR=Navn pÜ Innkjõper;
                                                              SVE=Namn pÜ inkîpare];
                                                   Editable=No }
    { 70  ;   ;Created by          ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=BEGIN
                                                              UserCode := "Created by";
                                                              UserMgt.LookupUserID(UserCode);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Created by;
                                                              NOR=Opprettet av;
                                                              SVE=Skapades av];
                                                   Editable=No }
    { 71  ;   ;Date Created        ;Date          ;CaptionML=[ENU=Date Created;
                                                              NOR=Opprettet;
                                                              SVE=Skapat datum];
                                                   Editable=No }
    { 75  ;   ;Modified by         ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=BEGIN
                                                              UserCode := "Modified by";
                                                              UserMgt.LookupUserID(UserCode);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Modified by;
                                                              NOR=Endret av;
                                                              SVE=éndrad av];
                                                   Editable=No }
    { 76  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den;
                                                              SVE=Uppdateringsdatum];
                                                   Editable=No }
    { 80  ;   ;Amounts only        ;Boolean       ;CaptionML=[ENU=Amounts only;
                                                              NOR=Kun belõp;
                                                              SVE=Endast belopp] }
    { 90  ;   ;Quote only          ;Boolean       ;CaptionML=ENU=Quote only }
    { 100 ;No ;Requested by        ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Requested by;
                                                              NOR=Forespurt av;
                                                              SVE=BegÑrd av];
                                                   Description=Expired;
                                                   Editable=No }
    { 105 ;   ;Requested Quote Receipt Date;Date  ;CaptionML=[ENU=Requested Quote Receipt Date;
                                                              NOR=Kvitteringsdato for anmodet tilbud;
                                                              SVE=Inleveransdatum fîr begÑrd offert] }
    { 106 ;   ;Vendors react before;Date          ;CaptionML=[ENU=Vendors react before;
                                                              SVE=Leverantîrer reagerar innan] }
    { 110 ;   ;Requested Receipt Date;Date        ;OnValidate=BEGIN
                                                                UpdateLinesFromHeader(FIELDCAPTION("Requested Receipt Date"),CurrFieldNo <> 0);  //DP01314
                                                              END;

                                                   CaptionML=[ENU=Requested Receipt Date;
                                                              NOR=ùnsket mottaksdato;
                                                              SVE=BegÑrt inleveransdatum] }
    { 115 ;   ;Required on Site Date;Date         ;OnValidate=BEGIN
                                                                UpdateLinesFromHeader(FIELDCAPTION("Required on Site Date"),CurrFieldNo <> 0);  //DP01314
                                                              END;

                                                   CaptionML=ENU=Required on Site Date }
    { 120 ;   ;Deliver             ;Option        ;OnValidate=BEGIN
                                                                //db, 27-09-16: synchronise options (not available for Requisition: Order Address)
                                                                //Requision: ,Location,Project Location,Service Location,Contact Address,Plant Location
                                                                //Purchase:  ,Location,Project Location,Service Location,Contact Address,Plant Location,,,Order Address
                                                                IF NOT ValidateShipToLocation(FALSE) THEN
                                                                  IF Deliver <> xRec.Deliver THEN
                                                                    GetDefaultShipToLocation;
                                                              END;

                                                   CaptionML=[ENU=Deliver;
                                                              NOR=Lever;
                                                              SVE=Leverera];
                                                   OptionCaptionML=ENU=" ,Location,Project Location,Service Location,Contact Address,Plant Location";
                                                   OptionString=[ ,Location,Project Location,Service Location,Contact Address,Plant Location] }
    { 125 ;   ;Ship To Location    ;Code20        ;TableRelation=IF (Deliver=CONST(Project Location)) "Project Location".Code WHERE (Project No.=FIELD(Project No.))
                                                                 ELSE IF (Deliver=CONST(Location)) Location.Code
                                                                 ELSE IF (Deliver=CONST(Plant Location)) "Plant Location".Code
                                                                 ELSE IF (Deliver=CONST(Contact Address)) Contact.No.
                                                                 ELSE IF (Deliver=CONST(Service Location)) "Service Order Location".Code WHERE (Service Order No.=FIELD(Service Order No.));
                                                   OnValidate=BEGIN
                                                                ValidateShipToLocation(TRUE);
                                                              END;

                                                   CaptionML=[ENU=Ship To Location;
                                                              NOR=Lever til lokasjon;
                                                              SVE=Leverera till lagerstÑlle] }
    { 130 ;   ;Comment             ;Text50        ;CaptionML=[ENU=Comment;
                                                              NOR=Kommentar;
                                                              SVE=Kommentar] }
    { 140 ;   ;Target Amount (LCY) ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD(Fixed,FALSE);
                                                              END;

                                                   CaptionML=ENU=Target Amount (LCY);
                                                   AutoFormatType=1 }
    { 150 ;   ;Purchase Action Budget (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Budget Line"."Amount (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                       Purchase Action=FIELD(Purchase Action)));
                                                   CaptionML=ENU=Purchase Action Budget (LCY);
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 155 ;   ;AllocatedBudget PurchAct (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Requisition Line"."Amount (LCY)" WHERE (Purchase Requisition No.=FILTER(<>''),
                                                                                                                     Project No.=FIELD(Project No.),
                                                                                                                     Purchase Action=FIELD(Purchase Action)));
                                                   CaptionML=ENU=Allocated Budget Purchase Action (LCY);
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 160 ;   ;Requisition Amount (LCY);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Requisition Line"."Amount (LCY)" WHERE (Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=ENU=Requisition Amount (LCY);
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 170 ;   ;Fixed               ;Boolean       ;OnValidate=VAR
                                                                UserSetup@1100529400 : Record 91;
                                                              BEGIN
                                                                //db, 27-09-16: field not available on page; set to fixed by status (released) and reset by function (Reopen)
                                                                IF Fixed <> xRec.Fixed THEN
                                                                  IF UserSetup.GET(USERID) THEN
                                                                    IF UserSetup."No Access Requisition Fixed" THEN
                                                                      ERROR(Text009,FIELDCAPTION(Fixed));
                                                              END;

                                                   CaptionML=[ENU=Fixed;
                                                              NOR=Fast;
                                                              SVE=Fast] }
    { 180 ;   ;No. of Quotes       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Quote),
                                                                                              Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Quotes;
                                                              NOR=Antall forespõrsler;
                                                              SVE=Antal offerter];
                                                   Editable=No }
    { 185 ;   ;No. of Orders       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Order),
                                                                                              Purchase Requisition No.=FIELD(No.)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=No. of Orders;
                                                              NOR=Antall bestillinger;
                                                              SVE=Antal order];
                                                   Editable=No }
    { 190 ;   ;No. of Pstd. Receipts;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Rcpt. Header" WHERE (Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Receipts;
                                                              NOR=Antall bokfõrte mottak;
                                                              SVE=Antal bokfîrda inleveranser];
                                                   Editable=No }
    { 195 ;   ;No. of Pstd. Invoices;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Inv. Header" WHERE (Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Invoices;
                                                              NOR=Antall bokfõrte fakturaer;
                                                              SVE=Antal bokfîrda fakturor];
                                                   Editable=No }
    { 200 ;   ;Document Template   ;Code20        ;TableRelation="Document Template"."Template Code" WHERE (Type=CONST(Purchase Quote));
                                                   CaptionML=[ENU=Document Template;
                                                              NOR=Dokumentmal;
                                                              SVE=Dokumentmall] }
    { 205 ;   ;Document Fysical Template;BLOB     ;CaptionML=[ENU=Document Fysical Template;
                                                              NOR=Dokument, fysisk mal;
                                                              SVE=Dokument, fysisk mall] }
    { 210 ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1, "Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 - kode;
                                                              SVE=Global dimension 1 kod];
                                                   Description=DP01314;
                                                   CaptionClass='1,1,1' }
    { 220 ;   ;Service Order No.   ;Code20        ;TableRelation="Service Order";
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Project No.", '');
                                                                GetDefaultsFromServiceOrder;  //DP01314
                                                              END;

                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr] }
    { 221 ;   ;Service Order Description;Text50   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Order".Description WHERE (No.=FIELD(Service Order No.)));
                                                   CaptionML=[ENU=Service Order Description;
                                                              SVE=Serviceorder beskrivning];
                                                   Editable=No }
    { 300 ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=[ENU=Shipment Method/Incoterm Code;
                                                              NOR=LeveringsmÜtekode;
                                                              SVE=Utleveransvillkorskod];
                                                   Description=BI006 }
    { 301 ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=TransportmÜte;
                                                              SVE=TransportsÑtt];
                                                   Description=BI006 }
    { 302 ;   ;Destination         ;Text50        ;CaptionML=[ENU=Destination;
                                                              NOR=Mottaker;
                                                              SVE=Destination];
                                                   Description=BI006 }
    { 500 ;   ;Back-to-back        ;Boolean       ;CaptionML=ENU=Back-to-back;
                                                   Description=BI032 }
    { 510 ;   ;No. of Plant Orders ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Plant Order" WHERE (Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=ENU=No. of Plant Orders;
                                                   Editable=No }
    { 520 ;   ;No. of Plant Requests;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Plant Request" WHERE (Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=ENU=No. of Plant Requests;
                                                   Editable=No }
    { 530 ;   ;No. of Inventory Orders;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Item Journal Line" WHERE (Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=ENU=No. of Inventory Orders;
                                                   Editable=No }
    { 540 ;   ;No. of Blanket Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                              Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Blanket Orders;
                                                              SVE=Antal avropsorder];
                                                   Editable=No }
    { 550 ;   ;Ready for Procurement;Boolean      ;CaptionML=ENU=Ready for Procurement }
    { 560 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              SVE=DimensionsuppsÑttnings-ID];
                                                   Editable=No }
    { 570 ;   ;Requisition Amount (FCY);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Requisition Line"."Amount (FCY)" WHERE (Purchase Requisition No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount;
                                                              SVE=Belopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      PurchaseSetup@1100529401 : Record 312;
      PurchaseHeader@1100525000 : Record 38;
      NoSeriesMgt@1100529400 : Codeunit 396;
      UserMgt@1100529403 : Codeunit 418;
      UserCode@1100529402 : Code[50];
      Text000@1100528908 : TextConst 'ENU=%1 not filled.;NOR=%1 er ikke fylt ut.;SVE=%1 har inte fyllts i.';
      Text002@1100528905 : TextConst 'ENU=The Template is empty.;NOR=Malen er tom.;SVE=Mallen Ñr tom.';
      Text003@1100528907 : TextConst 'ENU=Attachment is already in use on this machine.;NOR=Vedlegg er allerede i bruk pÜ denne maskinen.;SVE=Bilaga anvÑnds redan pÜ denna maskin.';
      Text004@1100528906 : TextConst 'ENU=When you have saved and closed your document, click Yes to import the document.;NOR=NÜr du har lagret og lukket ditt dokument klikker du pÜ Ja for Ü importere dokumentet.;SVE=NÑr du har sparat och stÑngt ditt dokument klickar du pÜ Ja fîr att importera dokumentet.';
      Text005@1100528909 : TextConst 'ENU=Export Attachment;NOR=Eksporter Vedlegg;SVE=Exportera bilaga';
      Text006@1100528700 : TextConst 'ENU=When you have downloaded and saved your document, click Yes to upload the document.';
      Text009@1100529406 : TextConst 'ENU=You have no permission to change %1;NOR=Du mangler tillatelse til Ü endre %1;SVE=Du saknar behîrighet att Ñndra %1';
      Text012@1100528903 : TextConst 'ENU=Doc;NOR=\Doc;SVE=\Doc';
      WordAutomationCU@1100528902 : Codeunit 11012400;
      FileMgt@1100528904 : Codeunit 419;
      Text032@1100529501 : TextConst 'ENU=You have modified %1.\\;NOR=Du har endret %1.\\;SVE=Du har Ñndrat %1.\\';
      Text033@1100529500 : TextConst 'ENU=Do you want to update the lines?;NOR=Vil du oppdatere radene?;SVE=Vill du uppdatera raderna?';
      Text022@1100528200 : TextConst 'ENU=The status can only be modified when the approval process is complete.';
      DimMgt@1100529600 : Codeunit 408;

    PROCEDURE AssistEdit@2(OldRequisition@1000 : Record 11229330) : Boolean;
    VAR
      PurchaseRequisition@1100529400 : Record 11229330;
    BEGIN
      WITH PurchaseRequisition DO BEGIN
        PurchaseRequisition := Rec;
        PurchaseSetup.GET;
        PurchaseSetup.TESTFIELD("Requisition Nos.");
        IF NoSeriesMgt.SelectSeries(PurchaseSetup."Requisition Nos.",OldRequisition."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := PurchaseRequisition;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE ValidateShipToLocation@1100528000(GiveMessage@1100528000 : Boolean) ShipToLocIsValid : Boolean;
    VAR
      ProjLocRec@1100529400 : Record 11012011;
      LocRec@1100529402 : Record 14;
      PlantLocRec@1100528900 : Record 11012554;
      ContactRec@1100528901 : Record 5050;
      ServOrderLocRec@1100525000 : Record 11071688;
      ServiceOrder@1100528400 : Record 11012823;
    BEGIN
      ShipToLocIsValid := TRUE;
      CASE Deliver OF
        Deliver::" ":
          BEGIN
            IF "Ship To Location" <> '' THEN
              IF GiveMessage THEN
                ERROR(Text000, FIELDCAPTION(Deliver))
              ELSE
                ShipToLocIsValid := FALSE;
          END;
        Deliver::Location:
          BEGIN
            IF "Ship To Location" = '' THEN
              IF GiveMessage THEN
                ERROR(Text000, FIELDCAPTION("Ship To Location"))
              ELSE
                ShipToLocIsValid := FALSE
            ELSE
              IF GiveMessage THEN
                LocRec.GET("Ship To Location")
              ELSE
                ShipToLocIsValid := LocRec.GET("Ship To Location");
          END;
        Deliver::"Project Location":
          BEGIN
            IF "Ship To Location" = '' THEN
              IF GiveMessage THEN
                ERROR(Text000, FIELDCAPTION("Ship To Location"))
              ELSE
                ShipToLocIsValid := FALSE
            ELSE
              IF GiveMessage THEN
                ProjLocRec.GET("Project No.", "Ship To Location")
              ELSE
                ShipToLocIsValid := ProjLocRec.GET("Project No.", "Ship To Location");
          END;
       Deliver::"Service Location":  //DP01314
          BEGIN
            IF ServiceOrder.GET("Service Order No.") THEN;
            IF ("Ship To Location" <> '') OR
               ServiceOrder.ServiceLocationHasDefaultShipToAddress
            THEN
              IF GiveMessage THEN
                ServOrderLocRec.GET("Service Order No.", "Ship To Location")
              ELSE
                ShipToLocIsValid := ServOrderLocRec.GET("Service Order No.", "Ship To Location");
          END;
        Deliver::"Plant Location":
          BEGIN
            IF "Ship To Location" = '' THEN
              IF GiveMessage THEN
                ERROR(Text000, FIELDCAPTION("Ship To Location"))
              ELSE
                ShipToLocIsValid := FALSE
            ELSE
              IF GiveMessage THEN
                PlantLocRec.GET("Ship To Location")
              ELSE
                ShipToLocIsValid := PlantLocRec.GET("Ship To Location");
          END;
        Deliver::"Contact Address":
          BEGIN
            IF "Ship To Location" = '' THEN
              IF GiveMessage THEN
                ERROR(Text000, FIELDCAPTION("Ship To Location"))
              ELSE
                ShipToLocIsValid := FALSE
            ELSE
              IF GiveMessage THEN
                ContactRec.GET("Ship To Location")
              ELSE
                ShipToLocIsValid := ContactRec.GET("Ship To Location");
          END;
      END;
    END;

    LOCAL PROCEDURE GetDefaultShipToLocation@1100528004();
    VAR
      ProjRec@1100529401 : Record 11072003;
      ProjLocRec@1100529400 : Record 11012011;
      ServOrderRec@1100525002 : Record 11012823;
      ServLocRec@1100525001 : Record 11012801;
      ProjSetup@1100525003 : Record 315;
    BEGIN
      //DP01314: synchronise with same function for Advice Order Line
      "Ship To Location" := '';

      CASE Deliver OF
        Deliver::Location:
          BEGIN
            IF "Project No."<> '' THEN BEGIN
              ProjRec.GET("Project No.");
              IF ProjRec.Deliver = ProjRec.Deliver::Location THEN
                "Ship To Location" := ProjRec."Ship To Location";
            END;
            IF "Service Order No." <> '' THEN BEGIN
              ServOrderRec.GET("Service Order No.");
              IF NOT ServLocRec.GET(ServOrderRec."Service Location No.") THEN
                ServLocRec.INIT;
              IF ServLocRec.Deliver = ServLocRec.Deliver::Location THEN
                "Ship To Location" := ServLocRec."Ship To Location";
            END;
            IF "Ship To Location" = '' THEN BEGIN
              ProjSetup.GET;
              IF ProjSetup.Deliver = ProjSetup.Deliver::Location THEN
                "Ship To Location" := ProjSetup."Ship To Location";
            END;
          END;
        Deliver::"Project Location":
          BEGIN
            ProjRec.GET("Project No.");
            IF ProjRec.Deliver = ProjRec.Deliver::"Project Location" THEN BEGIN
              IF ProjRec."Ship To Location" <> '' THEN
                "Ship To Location" := ProjRec."Ship To Location"
              ELSE BEGIN
                ProjLocRec.SETRANGE("Project No.", "Project No.");
                IF ProjLocRec.FINDFIRST THEN
                  IF ProjLocRec.NEXT = 0 THEN
                    "Ship To Location" := ProjLocRec.Code;
              END;
            END;
          END;
        Deliver::"Service Location":  //DP01314
          IF ServOrderRec.GET("Service Order No.") THEN
            "Ship To Location" := ServOrderRec.GetDefaultServiceOrderLocationCode;
      END;
    END;

    PROCEDURE CopyPurchActionToRequisition@1100529402();
    VAR
      BudgetLine@1100529400 : Record 11012001;
      PurchaseRequisitionLine@1100529401 : Record 11229331;
      ProjectPurchaseAction@1100528900 : Record 11012026;
      ProjectNo@1100529404 : Code[20];
      ActionCode@1100529403 : Code[20];
    BEGIN
      ProjectNo := "Project No.";
      ActionCode := "Purchase Action";
      IF "Purchase Action" = '' THEN BEGIN
        ProjectPurchaseAction.SETFILTER("Project No.", "Project No.");
        IF PAGE.RUNMODAL(0, ProjectPurchaseAction) = ACTION::LookupOK THEN BEGIN
          ProjectNo := ProjectPurchaseAction."Project No.";
          ActionCode := ProjectPurchaseAction.Code;
        END;
      END;

      BudgetLine.SETRANGE("Project No.", ProjectNo);
      BudgetLine.SETRANGE("Purchase Action", ActionCode);
      PurchaseRequisitionLine."Purchase Requisition No." := "No.";
      PurchaseRequisitionLine.AssignBudgetToRequisition(BudgetLine,FALSE);
    END;

    PROCEDURE GetDefaultsFromPurchaseAction@1100528900();
    VAR
      ProjectPurchaseAction@1100528900 : Record 11012026;
      PurchaseAction@1100528901 : Record 11012025;
    BEGIN
      IF ("Purchase Action" <> '') THEN BEGIN
        IF ("Project No." <> '') THEN BEGIN
          ProjectPurchaseAction.GET("Project No.", "Purchase Action");
          Description := ProjectPurchaseAction.Description;
          "Document Template" := ProjectPurchaseAction."Document Template";
        END ELSE BEGIN
          PurchaseAction.GET("Purchase Action");
          Description := PurchaseAction.Description;
          "Document Template" := PurchaseAction."Document Template";
        END;
      END;
    END;

    PROCEDURE GetDefaultsFromProject@1100529500();
    VAR
      ProjRec@1100529500 : Record 11072003;
    BEGIN
      //DP01314
      IF ProjRec.GET("Project No.") THEN BEGIN
        Deliver := ProjRec.Deliver;
        "Ship To Location" := ProjRec."Ship To Location";
        VALIDATE("Global Dimension 1 Code", ProjRec."Global Dimension 1 Code");  //C060832
      END;

      CopyDimensions(DATABASE::Job, "Project No.", xRec."Project No.");
    END;

    PROCEDURE GetDefaultsFromServiceOrder@1100525000();
    VAR
      ServiceOrder@1100525000 : Record 11012823;
    BEGIN
      //DP01314
      IF ServiceOrder.GET("Service Order No.") THEN BEGIN
        VALIDATE("Global Dimension 1 Code", ServiceOrder."Global Dimension 1 Code");  //C060832
      END;

      CopyDimensions(DATABASE::"Service Order", "Service Order No.", xRec."Service Order No.");
    END;

    PROCEDURE GetFirstTextLine@1100528901() : Text[250];
    VAR
      PurchaseText@1100528900 : Record 11012067;
    BEGIN
      PurchaseText.SETRANGE("Line Type", PurchaseText."Line Type"::Requisition);
      PurchaseText.SETRANGE("No.", "No.");
      PurchaseText.SETFILTER(Text, '<>%1', '');
      IF PurchaseText.FINDFIRST THEN
        EXIT(PurchaseText.Text);
    END;

    PROCEDURE GetPreferredVendor@1100528902(IncludingName@1100528901 : Boolean) PreferredVendor : Text[250];
    VAR
      VendorbyPurchaseRequisition@1100528900 : Record 11229332;
      VendorbyPurchaseRequisition2@1100529500 : Record 11229332;
    BEGIN
      WITH VendorbyPurchaseRequisition DO BEGIN
        SETRANGE("Purchase Requisition No.", Rec."No.");
        SETRANGE("Preferred Vendor", TRUE);
        IF FINDFIRST THEN BEGIN
          PreferredVendor := "Vendor No.";
        END ELSE BEGIN
          SETRANGE("Preferred Vendor", FALSE);
          IF FINDFIRST THEN BEGIN
            PreferredVendor := "Vendor No.";
            //DP01314.sn
            VendorbyPurchaseRequisition2.COPY(VendorbyPurchaseRequisition);
            VendorbyPurchaseRequisition2.SETFILTER("Vendor No.", '<>%1', "Vendor No.");
            IF VendorbyPurchaseRequisition2.FINDFIRST THEN
              PreferredVendor := '';  //if more then 1 unmarked Vendor present, show nothing
            //DP01314.en
          END;
        END;
        IF PreferredVendor <> '' THEN BEGIN
          IF IncludingName THEN BEGIN
            IF Type = Type::Vendor THEN BEGIN
              CALCFIELDS("Vendor Name");
              PreferredVendor := PreferredVendor + ' ' + "Vendor Name";
            END ELSE BEGIN
              CALCFIELDS("Contact Name");
              PreferredVendor := PreferredVendor + ' ' + "Contact Name"
            END;
          END;
        END;
      END;
      EXIT(PreferredVendor);
    END;

    PROCEDURE LookupPurchaser@1100528407();
    VAR
      Purchaser@1100525002 : Record 13;
      PurchaserList@1100525003 : Page 14;
      PurchaserbyPurchRequisition@1100525004 : Record 11229337;
      PurchaserbyPurchRequisitionList@1100525000 : Page 11126668;
    BEGIN
      PurchaserbyPurchRequisition.SETRANGE("Purchase Requisition No.","No.");
      IF PurchaserbyPurchRequisition.FINDFIRST THEN BEGIN
        PurchaserbyPurchRequisition.SETRANGE("Purchase Requisition No.","No.");
        PurchaserbyPurchRequisition."Purchase Requisition No." := "No.";
        PurchaserbyPurchRequisition."Purchaser Code" := "Purchaser Code";
        PurchaserbyPurchRequisitionList.SETTABLEVIEW(PurchaserbyPurchRequisition);
        PurchaserbyPurchRequisitionList.SETRECORD(PurchaserbyPurchRequisition);
        PurchaserbyPurchRequisitionList.LOOKUPMODE(TRUE);
        IF PurchaserbyPurchRequisitionList.RUNMODAL = ACTION::LookupOK THEN BEGIN
          GET("No.");
          PurchaserbyPurchRequisitionList.GETRECORD(PurchaserbyPurchRequisition);
          VALIDATE("Purchaser Code", PurchaserbyPurchRequisition."Purchaser Code");
        END;
      END ELSE BEGIN
        Purchaser.Code := "Purchaser Code";
        PurchaserList.SETRECORD(Purchaser);
        PurchaserList.LOOKUPMODE(TRUE);
        IF PurchaserList.RUNMODAL = ACTION::LookupOK THEN BEGIN
          PurchaserList.GETRECORD(Purchaser);
          VALIDATE("Purchaser Code", Purchaser.Code);
        END;
      END;
    END;

    PROCEDURE ValidatePurchaser@1100528903();
    VAR
      PurchaserbyPurchRequisition@1100528900 : Record 11229337;
    BEGIN
      IF "Purchaser Code" = '' THEN EXIT;
      //PurchaserbyPurchRequisition.SETRANGE("Purchase Requisition No.","No.");
      //IF PurchaserbyPurchRequisition.FINDFIRST THEN BEGIN
      //  PurchaserbyPurchRequisition.GET("No.","Purchaser Code");
      //END ELSE BEGIN
      //  Purchaser.GET("Purchaser Code");
      //END;
      PurchaserbyPurchRequisition."Purchase Requisition No." := "No.";
      PurchaserbyPurchRequisition."Purchaser Code" := "Purchaser Code";
      IF PurchaserbyPurchRequisition.INSERT THEN;
    END;

    PROCEDURE GetNumberOfShipmentOrders@1100528904() NumOrder : Integer;
    VAR
      ShippingOrderLine@1100528900 : Record 11071885;
    BEGIN
      IF "No." = '' THEN
        EXIT(0);

      ShippingOrderLine.SETCURRENTKEY("Purchase Requisition No.", "Document No.");
      ShippingOrderLine.SETRANGE("Purchase Requisition No.", "No.");
      IF ShippingOrderLine.ISEMPTY THEN
        EXIT(0);

      ShippingOrderLine.FINDSET;
      REPEAT
        NumOrder += 1;
        ShippingOrderLine.SETRANGE("Document No.", ShippingOrderLine."Document No.");
        ShippingOrderLine.FINDLAST;
        ShippingOrderLine.SETRANGE("Document No.");
      UNTIL ShippingOrderLine.NEXT = 0;

      EXIT(NumOrder);
    END;

    PROCEDURE GetNumberOfPostedShipmentOrders@1100527000() NumOrder : Integer;
    VAR
      PostedShippingOrderLine@1100528900 : Record 11071886;
    BEGIN
      IF "No." = '' THEN
        EXIT(0);

      PostedShippingOrderLine.SETCURRENTKEY("Purchase Requisition No.", "Document No.");
      PostedShippingOrderLine.SETRANGE("Purchase Requisition No.", "No.");
      IF PostedShippingOrderLine.ISEMPTY THEN
        EXIT(0);

      PostedShippingOrderLine.FINDSET;
      REPEAT
        NumOrder += 1;
        PostedShippingOrderLine.SETRANGE("Document No.", PostedShippingOrderLine."Document No.");
        PostedShippingOrderLine.FINDLAST;
        PostedShippingOrderLine.SETRANGE("Document No.");
      UNTIL PostedShippingOrderLine.NEXT = 0;

      EXIT(NumOrder);
    END;

    PROCEDURE GetUniqueFilename@9(Directory@1100528400 : Text[250];VAR FileName@1100528401 : Text[260];VAR ShortFileName@1100528402 : Text[250]);
    VAR
      I@1001 : Integer;
      DocNo@1002 : Text[30];
      FileExtension@1100485000 : Text[250];
    BEGIN
      FileExtension := WordAutomationCU.DocfromDot(Comment);
      REPEAT
        IF I <> 0 THEN
          DocNo := FORMAT(I);
        ShortFileName := Text012 + DocNo + FileExtension;
        FileName := DELCHR(Directory, '>', '\') + '\' + ShortFileName;
        IF NOT FileMgt.ClientFileExists(FileName) THEN
          EXIT;
        I := I +1;
      UNTIL I=999;
    END;

    PROCEDURE DeleteFile@10(FileName@1001 : Text[260]) : Boolean;
    VAR
      I@1002 : Integer;
    BEGIN
      IF FileName = '' THEN
        EXIT(FALSE);

      IF NOT FileMgt.ClientFileExists(FileName) THEN
        EXIT(TRUE);

      REPEAT
        SLEEP(250);
        I := I + 1;
      UNTIL FileMgt.DeleteClientFile4PS(FileName, FALSE) OR (I = 25);
      EXIT(NOT FileMgt.ClientFileExists(FileName));
    END;

    PROCEDURE ImportDocTemplate@5(ImportFromFile@1000 : Text[260]) : Boolean;
    VAR
      TempBlob@1100525500 : Record 99008535;
      WordAutomation@1100528700 : Codeunit 11012400;
      FileName@1005 : Text[260];
      FileExtension@1100485000 : Text[250];
    BEGIN
      FileName := ImportFromFile;
      IF FileName <> '' THEN BEGIN
        WordAutomation.BLOBImportWordTemplateClientFileAsWordDocument(TempBlob, FileName);
        "Document Fysical Template" := TempBlob.Blob;
        FileExtension := '.' + COPYSTR(UPPERCASE(FileMgt.GetExtension(FileName)),1,250);
        IF NOT WordAutomationCU.ApplicableExtension(FileExtension, TRUE, TRUE) THEN BEGIN
          CLEAR("Document Fysical Template");
          EXIT(FALSE);
        END;
        IF Comment = '' THEN
          Comment :=  FileExtension;
        IF MODIFY(TRUE) THEN
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE OpenDocTemplate@1100485000(Directory@1000 : Text[250]);
    VAR
      FileName@1004 : Text[260];
      ShortFileName@1100528400 : Text[250];
      FileExtension@1100485000 : Text[250];
      ServerTempFileName@1100528700 : Text;
      WordManagement@1100409000 : Codeunit 11072023;
    BEGIN
      CALCFIELDS("Document Fysical Template");
      IF NOT "Document Fysical Template".HASVALUE THEN
        ERROR(Text002);

      GetUniqueFilename(Directory, FileName, ShortFileName);
      IF FileMgt.ClientFileExists(FileName) THEN
        IF NOT DeleteFile(FileName) THEN
          ERROR(Text003);

      ExportDocTemplate(FileName);

      IF FileMgt.IsWindowsClient THEN BEGIN
        FileExtension := WordAutomationCU.DocfromDot(Comment);

        IF WordManagement.IsWordDocumentExtension(FileExtension) THEN
          EditWordDocument(FileName)
        ELSE
          HYPERLINK(FileName);

        IF CONFIRM(Text004,TRUE) THEN BEGIN
          ImportDocTemplate(FileName);
          MODIFY(TRUE);
        END;
      END ELSE BEGIN
        FileMgt.DownloadHandler(FileName, '', '', '', ShortFileName);
        IF CONFIRM(Text006, TRUE) THEN BEGIN
          ServerTempFileName := FileMgt.UploadFile('', '');
          IF ServerTempFileName <> '' THEN BEGIN
            ImportDocTemplate(ServerTempFileName);
            MODIFY(TRUE);
            ERASE(ServerTempFileName);
          END;
        END;
      END;

      DeleteFile(FileName);
    END;

    PROCEDURE ExportDocTemplate@1100528905(ExportToFile@1000 : Text[260]) : Boolean;
    VAR
      TempBlob@1100525500 : Record 99008535;
      FileName@1002 : Text[260];
      FileFilter@1003 : Text[260];
      FileExtension@1100485000 : Text[250];
    BEGIN
      FileExtension := WordAutomationCU.DocfromDot(Comment);

      CALCFIELDS("Document Fysical Template");
      IF "Document Fysical Template".HASVALUE THEN BEGIN
        IF ExportToFile = '' THEN BEGIN
          FileFilter := FileMgt.GetToFilterText('', FileExtension);
          FileName := FileMgt.SaveFileDialog(Text005, '', FileFilter);
        END ELSE
          FileName := ExportToFile;
        IF FileName <> '' THEN BEGIN
          TempBlob.Blob := "Document Fysical Template";
          FileMgt.BLOBExport4PS(TempBlob, FileName, FALSE, FALSE);
          EXIT(TRUE);
        END ELSE
          EXIT(FALSE)
      END ELSE
        EXIT(FALSE)
    END;

    PROCEDURE EditWordDocument@1100485001(iFileName@1100485000 : Text[250]);
    VAR
      lCduWord@1210190000 : Codeunit 11012400;
    BEGIN
      IF iFileName = '' THEN EXIT;
      lCduWord.Display(iFileName, '');
    END;

    LOCAL PROCEDURE UpdateLinesFromHeader@1100529501(ChangedFieldName@1100529504 : Text[100];AskQuestion@1100529503 : Boolean);
    VAR
      PurchaseRequisitionLine@1100529501 : Record 11229331;
      Question@1100529502 : Text[250];
      Confirmed@1100529505 : Boolean;
    BEGIN
      //DP01314
      PurchaseRequisitionLine.SETRANGE("Purchase Requisition No.", "No.");
      IF PurchaseRequisitionLine.ISEMPTY THEN EXIT;

      IF AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
          Text032 +
          Text033,ChangedFieldName);
        IF GUIALLOWED THEN BEGIN
          IF DIALOG.CONFIRM(Question,TRUE) THEN BEGIN
            CASE ChangedFieldName OF
              FIELDCAPTION("Requested Receipt Date"),
              FIELDCAPTION("Required on Site Date"):
                Confirmed := TRUE;
            END;
          END;
        END;
      END;

      IF NOT Confirmed THEN EXIT;

      IF PurchaseRequisitionLine.FINDSET THEN BEGIN
        REPEAT
          CASE ChangedFieldName OF
            FIELDCAPTION("Requested Receipt Date"): PurchaseRequisitionLine."Requested Receipt Date" := "Requested Receipt Date";
            FIELDCAPTION("Required on Site Date"): PurchaseRequisitionLine."Required on Site Date" := "Required on Site Date";
          END;
          PurchaseRequisitionLine.MODIFY;
        UNTIL PurchaseRequisitionLine.NEXT = 0;
      END;
    END;

    PROCEDURE EditCommentLines@1100529400();
    VAR
      CommentLine@1100529800 : Record 11020634;
      RecRef@1100529801 : RecordRef;
      RID@1100529802 : RecordID;
    BEGIN
      RecRef.GETTABLE(Rec);
      RID := RecRef.RECORDID();
      CommentLine.EditCommentLines(CommentLine."Table Name"::"Purchase Requisition", RID);  //DP01314
    END;

    PROCEDURE CheckIfReleasingIsAllowed@1100528400(PreviousStatus@1100528401 : Integer);
    VAR
      ApprovalManagement4PSConstr@1100528400 : Codeunit 11125349;
    BEGIN
      IF PreviousStatus = Status::Open THEN
        IF ApprovalManagement4PSConstr.IsPurchaseRequisitionApprovalsWorkflowEnabled(Rec) THEN
          ERROR(Text022);
    END;

    PROCEDURE CheckIfReopenIsAllowed@1100528200(PreviousStatus@1100528401 : Integer);
    VAR
      ApprovalsMgmt@1100528400 : Codeunit 1535;
      OpenApprovalEntriesExist@1100528200 : Boolean;
    BEGIN
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      IF OpenApprovalEntriesExist THEN
        ERROR(Text022);
    END;

    LOCAL PROCEDURE CopyDimensions@1100529601(FromTableID@1100529800 : Integer;FromNo@1100529801 : Code[20];PrevNo@1100529601 : Code[20]);
    VAR
      TableID@1100529804 : ARRAY [10] OF Integer;
      No@1100529803 : ARRAY [10] OF Code[20];
      OldInheritDimSetID@1100529600 : Integer;
      NewInheritDimSetID@1100529603 : Integer;
      DummyCode@1100529602 : Code[20];
    BEGIN
      TableID[1] := FromTableID;
      No[1] := FromNo;
      NewInheritDimSetID := DimMgt.GetDefaultDimID(TableID, No, '', DummyCode, DummyCode, 0, 0);
      No[1] := PrevNo;
      OldInheritDimSetID := DimMgt.GetDefaultDimID(TableID, No, '', DummyCode, DummyCode, 0, 0);

      "Dimension Set ID" := DimMgt.GetDeltaDimSetID("Dimension Set ID", NewInheritDimSetID, OldInheritDimSetID);
      DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Global Dimension 1 Code", DummyCode);
    END;

    PROCEDURE ShowDimensions@1100529600();
    VAR
      PurchaseRequisition@1100529600 : Record 11229330;
      DimMgt@1100529800 : Codeunit 408;
      GlobalDim2@1100529801 : Code[20];
    BEGIN
      DimMgt.SetTableID(DATABASE::"Purchase Requisition");
      IF Fixed THEN
        DimMgt.ShowDimensionSet("Dimension Set ID", STRSUBSTNO('%1 %2',
                                                    PurchaseRequisition.TABLECAPTION, "No."))
      ELSE BEGIN
        "Dimension Set ID" := DimMgt.EditDimensionSet("Dimension Set ID", STRSUBSTNO('%1 %2',
                                                      PurchaseRequisition.TABLECAPTION, "No."));
        DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID", "Global Dimension 1 Code", GlobalDim2);
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@1100529602(FieldNumber@1100529600 : Integer;VAR ShortcutDimCode@1100529601 : Code[20]);
    VAR
      DimMgt@1100529800 : Codeunit 408;
    BEGIN
      IF FieldNumber = 1 THEN
        DimMgt.CheckDepartmentAuthorization(DATABASE::"Purchase Requisition", ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber, ShortcutDimCode, "Dimension Set ID");
    END;

    PROCEDURE DrillDownNoOfOrders@1100525001();
    BEGIN
      PurchaseHeader.SETRANGE("Purchase Requisition No.", "No.");
      PAGE.RUN(PAGE::"Purchase Order List", PurchaseHeader);
    END;

    PROCEDURE DrillDownNoOfQuotes@1100525002();
    BEGIN
      PurchaseHeader.SETRANGE("Purchase Requisition No.", "No.");
      PAGE.RUN(PAGE::"Purchase Quotes", PurchaseHeader);
    END;

    PROCEDURE DrillDownNoOfBlanketOrders@1100525003();
    BEGIN
      PurchaseHeader.SETRANGE("Purchase Requisition No.", "No.");
      PAGE.RUN(PAGE::"Blanket Purchase Orders", PurchaseHeader);
    END;

    BEGIN
    {
      4PS 20-09-16 UKR-C27159 VAKAT: BI032 checkbox Back-to-back - Added field
      4PS 07-11-16 UKR-C21173 KD: New project inventory screen (BI006) - Added fields "Shipment Method/Incoterm", "Transport Method", Destination
    }
    END.
  }
}

