OBJECT Page 6086317 Expenses
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EMW16.00.10.3.00.07;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Ausgaben;
               ENU=Expenses;
               NLD=Uitgaven;
               SVE=Kostnader];
    SourceTable=Table6086320;
    SourceTableView=SORTING(Posted)
                    WHERE(Posted=CONST(No),
                          Settlement No.=FILTER(''));
    PageType=List;
    UsageCategory=Lists;
    CardPageID=Expense Card;
    PromotedActionCategoriesML=[DEU=Neu, Prozess, Bericht, Ausgaben, Verwaltung;
                                ENU=New,Process,Report,Expense,Administration;
                                NLD=Nieuw,Verwerk,Rapport,Uitgave,Administratie];
    ShowFilter=Yes;
    OnInit=BEGIN
             EnableActions := COUNT > 0;
           END;

    OnOpenPage=VAR
                 UserResp@1160040001 : Record 6086379;
                 EMOnlineMgt@1160040002 : Codeunit 6086305;
                 EMNavVersionMgt@6086300 : Codeunit 6086319;
                 UpgradeMgt@1160040000 : Codeunit 6086334;
               BEGIN
                 EMOnlineMgt.IsCompanyActive(FALSE);
                 UpgradeMgt.CheckDataVersion;
                 EnableFields;
                 CheckUnProcessedInbox;
                 ShowBankIntegration := BankIntegrationExists;
                 EnablePostingPreview := EMNavVersionMgt.CheckPreviewAllowed(FALSE);

                 IF UserResp.GetResponsibilityFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETFILTER("Continia User ID",UserResp.GetResponsibilityFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       EnableActions := TRUE;
                       HasComments := HasApprovalComment OR HasExpenseComment;
                       ShortcutFieldFunctions.ShowShortcutFieldValues(ShortcutFieldValues,DATABASE::Expense,0,'',"Entry No.");

                       //DO NOT FORMAT DIFFERENTLY. SEARCH/REPLACE FOR COMPATIBILITY
                       CASE Status OF
                         Status::Open: StyleFormat := 'Attention';
                         Status::Released: StyleFormat := 'Favorable';
                         ELSE StyleFormat := 'None';
                       END;
                     END;

    OnInsertRecord=BEGIN
                     "Cash/Private Card" := TRUE;
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=RelatedInformation;
                      CaptionML=;
                      ActionContainerType=RelatedInformation }
      { 1160040028;1 ;ActionGroup;
                      Name=Expense;
                      CaptionML=[DEU=A&usgaben;
                                 ENU=E&xpense;
                                 NLD=Uitgave] }
      { 1160040033;2 ;Action    ;
                      Name=Expense Inbox;
                      CaptionML=[DEU=Eingangsfach fÅr Ausgaben;
                                 ENU=Expense Inbox;
                                 NLD=Uitgave inbox];
                      Promoted=Yes;
                      Image=ErrorLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Expense Inbox");
                               END;
                                }
      { 1160040056;2 ;Action    ;
                      Name=Attachments;
                      ShortCutKey=Shift+Ctrl+T;
                      CaptionML=[DEU=Dateianhang;
                                 ENU=Attachments;
                                 NLD=Bijlagen;
                                 SVE=Bilagor];
                      Promoted=Yes;
                      Enabled=EnableActions;
                      Image=Attachments;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowAttachments;
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040032;2 ;Action    ;
                      Name=Dimensions;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions;
                                 NLD=Dimensies;
                                 SVE=Dimensioner];
                      Promoted=Yes;
                      Enabled=EnableActions;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 LookupDimensions(TRUE);
                               END;
                                }
      { 1160040046;2 ;Action    ;
                      Name=Extra Fields;
                      CaptionML=[DEU=ZusÑtzliche Felder;
                                 ENU=Extra Fields;
                                 NLD=Extra velden];
                      Enabled=EnableActions;
                      Image=SelectField;
                      OnAction=BEGIN
                                 LookupExtraFields(TRUE);
                               END;
                                }
      { 1160040073;2 ;Action    ;
                      Name=Attendees;
                      CaptionML=[DEU=Statusfilter;
                                 ENU=Attendees;
                                 NLD=Deelnemers];
                      Enabled=EnableActions;
                      Image=Users;
                      OnAction=BEGIN
                                 DrillDownAttendees;
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1160040070;2 ;Separator  }
      { 1160040022;2 ;Action    ;
                      Name=Approvals;
                      CaptionML=[DEU=Genehmigungen;
                                 ENU=Approvals;
                                 NLD=Goedkeuringen;
                                 SVE=GodkÑnnanden];
                      Enabled=EnableActions;
                      Image=Approvals;
                      OnAction=BEGIN
                                 EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Expense,FORMAT("Entry No."));
                               END;
                                }
      { 1160040025;  ;ActionContainer;
                      Name=ActionItems;
                      CaptionML=[DEU=&Bank;
                                 ENU=&Bank;
                                 NLD=Bank];
                      ActionContainerType=ActionItems }
      { 1160040036;1 ;ActionGroup;
                      Name=Bank;
                      CaptionML=[DEU=&Bank;
                                 ENU=&Bank;
                                 NLD=Bank] }
      { 1160040027;2 ;Action    ;
                      Name=Bank Transaction Inbox;
                      CaptionML=[DEU=Eingangsfach fÅr Banktransaktionen;
                                 ENU=Bank Transaction Inbox;
                                 NLD=Banktransactieinbox];
                      Promoted=Yes;
                      Visible=ShowBankIntegration;
                      PromotedIsBig=No;
                      Image=ErrorLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Bank Transaction Inbox");
                               END;
                                }
      { 1160040029;2 ;Action    ;
                      Name=Bank Transaction;
                      CaptionML=[DEU=Banktransaktion;
                                 ENU=Bank Transaction;
                                 NLD=Banktransactie];
                      Visible=ShowBankIntegration;
                      Image=BankAccount;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BankTransaction@1160040001 : Record 6086330;
                               BEGIN
                                 BankTransaction.SETRANGE("Matched to Expense",FALSE);
                                 PAGE.RUN(6086332,BankTransaction);
                               END;
                                }
      { 1160040021;1 ;ActionGroup;
                      Name=Functions;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions;
                                 NLD=F&unctie;
                                 SVE=F&unktion] }
      { 1160040066;2 ;Action    ;
                      Name=Reopen;
                      CaptionML=[DEU=Stat&us zurÅcksetzen;
                                 ENU=Re&open;
                                 NLD=Heropenen;
                                 SVE=ôppna &igen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                                 Expense2@1160040003 : Record 6086320;
                                 Question@1160040001 : Text[1024];
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);
                                 IF Expense.COUNT = 1 THEN
                                   Question := STRSUBSTNO(ConfirmReopenSingle,1)
                                 ELSE
                                   Question := STRSUBSTNO(ConfirmReopenMultiple,Expense.COUNT);

                                 IF NOT CONFIRM(Question,TRUE) THEN
                                   EXIT;

                                 IF Expense.FINDSET(TRUE,FALSE) THEN
                                   REPEAT
                                     Expense2 := Expense;
                                     CODEUNIT.RUN(CODEUNIT::"Expense - Complete",Expense2);
                                   UNTIL Expense.NEXT = 0;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040060;2 ;Action    ;
                      Name=Send to Expense User;
                      ShortCutKey=Shift+Ctrl+X;
                      CaptionML=[DEU=An &Ausgabenbenutzer senden;
                                 ENU=Send to E&xpense User;
                                 NLD=Verzenden naar gebruiker];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendTo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                                 Expense2@1160040004 : Record 6086320;
                                 EmOnlineMgt@1160040005 : Codeunit 6086305;
                                 NoOfExpSelected@1160040001 : Integer;
                                 NoOfExpSent@1160040003 : Integer;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);
                                 NoOfExpSelected := Expense.COUNT;
                                 IF Expense.COUNT > 1 THEN
                                   IF NOT CONFIRM(ConfirmSendToMultipleUsers,TRUE,Expense.COUNT) THEN
                                     EXIT;

                                 IF Expense.COUNT = 1 THEN BEGIN
                                   IF Status = Status::Open THEN
                                     IF IsSyncRequired THEN
                                       IF CONFIRM(SyncRequired,TRUE) THEN
                                         EmOnlineMgt.SetupCloud
                                       ELSE
                                         ERROR('');
                                   CODEUNIT.RUN(CODEUNIT::"Expense - Send to Expense User",Rec);
                                 END ELSE BEGIN
                                   Expense.FINDSET(TRUE,FALSE);
                                   REPEAT
                                     COMMIT;
                                     Expense2 := Expense;
                                     IF CODEUNIT.RUN(CODEUNIT::"Expense - Send to Expense User",Expense2) THEN
                                       NoOfExpSent += 1;
                                   UNTIL Expense.NEXT = 0;

                                   MESSAGE(NoOfExpSentToExpUserMsg,NoOfExpSent,NoOfExpSelected);
                                 END;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040057;2 ;Action    ;
                      Name=Send for Approval;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[DEU=Zur &Genehmigung senden;
                                 ENU=Send for &Approval;
                                 NLD=Verzend ter goedkeuring;
                                 SVE=Skicka fîr godkÑnnande];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);
                                 EMApprovalsBridge.SendExpApprovalRequest(Expense);
                                 SetStatusFilter;
                               END;
                                }
      { 1160040055;2 ;Action    ;
                      Name=Force Approval;
                      CaptionML=[DEU=G&enehmigung erzwingen;
                                 ENU=&Force Approval;
                                 NLD=&Forceer goedkeuring;
                                 SVE=Tvinga godkÑnnande];
                      Promoted=Yes;
                      Image=Approval;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040003 : Record 6086320;
                                 Question@1160040002 : Text[1024];
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);

                                 IF Expense.COUNT = 1 THEN
                                   Question := STRSUBSTNO(ContForceReleaselSingle)
                                 ELSE
                                   Question := STRSUBSTNO(ConfirmForceReleaseMultiple,Expense.COUNT);

                                 IF NOT CONFIRM(Question,TRUE) THEN
                                   EXIT;

                                 IF Expense.FINDSET(TRUE,FALSE) THEN
                                   REPEAT
                                     Expense.TESTFIELD(Status,Expense.Status::Open);
                                     EMApprovalsBridge.CancelApprovalRequest(DATABASE::Expense,FORMAT(Expense."Entry No."));
                                     EMApprovalsBridge.ForceApproval(DATABASE::Expense,FORMAT(Expense."Entry No."));
                                   UNTIL Expense.NEXT = 0;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040038;2 ;Separator  }
      { 1160040031;2 ;Action    ;
                      Name=Forward Approval;
                      Ellipsis=Yes;
                      CaptionML=[DEU=&Genehmigung weiterleiten;
                                 ENU=&Forward Approval;
                                 NLD=Doorsturen goedkeuring;
                                 SVE=Vidarebefordra godkÑnnande];
                      Image=Delegate;
                      OnAction=BEGIN
                                 EMApprovalsBridge.Forward(DATABASE::Expense,FORMAT("Entry No."));
                                 SetStatusFilter;
                               END;
                                }
      { 1160040062;2 ;Separator  }
      { 1160040079;2 ;Action    ;
                      Name=Add to Settlement;
                      CaptionML=[DEU=Dem Ausgleich hinzufÅgen;
                                 ENU=Add to Settlement;
                                 NLD=Voeg toe aan afrekening];
                      Image=Add;
                      OnAction=VAR
                                 Expense@1160040000 : Record 6086320;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense);
                                 AttachExpenseToSettlement(Expense);
                               END;
                                }
      { 1160040078;2 ;Separator  }
      { 1160040043;2 ;Action    ;
                      Name=Expense Split and Allocation;
                      ShortCutKey=Shift+Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Trennen und Zuweisen von Ausgaben;
                                 ENU=Expense Split and Allocation;
                                 NLD=Uitgavensplitsing en allocatie];
                      Promoted=Yes;
                      Image=Split;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ExpAllocation@1160040001 : Record 6086321;
                                 ExpSplitAndAllocationPage@1160040000 : Page 6086320;
                               BEGIN
                                 ExpAllocation.SETRANGE("Expense Entry No.","Entry No.");
                                 ExpSplitAndAllocationPage.SETTABLEVIEW(ExpAllocation);
                                 ExpSplitAndAllocationPage.RUNMODAL;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1160040035;2 ;Action    ;
                      Name=Merge Expenses;
                      CaptionML=[DEU=Ausgaben zusammenfÅhren;
                                 ENU=Merge Expenses;
                                 NLD=Uitgave samenvoeging];
                      Promoted=Yes;
                      Image=GetSourceDoc;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Expense1@1160040000 : Record 6086320;
                                 Expense2@1160040001 : Record 6086320;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Expense1);
                                 IF Expense1.COUNT <> 2 THEN
                                   ERROR(Select2ExpToMergeErr);
                                 Expense1.FINDSET;
                                 Expense2.GET(Expense1."Entry No.");
                                 Expense1.NEXT;
                                 MergeExpenses(Expense1,Expense2);

                                 SetStatusFilter;
                               END;
                                }
      { 1160040063;2 ;Action    ;
                      Name=Match Bank Transaction;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Banktransaktion abgleichen;
                                 ENU=Match Bank Transaction;
                                 NLD=Match banktransactie];
                      Promoted=Yes;
                      Visible=ShowBankIntegration;
                      Image=SettleOpenTransactions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 MatchToBankTrans;
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040067;2 ;Separator ;
                      CaptionML=[DEU=Banktransaktionen abgleichen;
                                 ENU=Match Banktransactions;
                                 NLD=Match banktransacties] }
      { 1160040068;2 ;Action    ;
                      Name=Synchronize;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[DEU=Synchronisieren;
                                 ENU=Synchronize;
                                 NLD=Synchroniseer;
                                 SVE=Synkronisera];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"EM Online Mgt.");

                                 CheckUnProcessedInbox;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1160040053;2 ;Separator  }
      { 1160040050;2 ;Action    ;
                      Name=Send Reminder E-mail;
                      CaptionML=[DEU=Erinnerungs-E-Mail senden;
                                 ENU=Send Reminder &E-mail;
                                 NLD=Verzend herinneringse-mail];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendConfirmation;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                                 ReminderEmail@1160040003 : Codeunit 6086314;
                                 OptionNo@1160040001 : Integer;
                               BEGIN
                                 OptionNo := STRMENU(Options,1,Instructions);

                                 IF OptionNo = 0 THEN
                                   EXIT;

                                 IF OptionNo = 2 THEN
                                   CurrPage.SETSELECTIONFILTER(Expense)
                                 ELSE
                                   Expense.RESET;
                                 ReminderEmail.SendExpNotificationEmails(Expense,OptionNo = 2);
                               END;
                                }
      { 1160040020;2 ;Action    ;
                      Name=Move to another company;
                      CaptionML=[DEU=Zu anderem Unternehmen verschieben;
                                 ENU=Move to another company;
                                 NLD=Verplaats naar een ander bedrijf];
                      Image=Intercompany;
                      OnAction=VAR
                                 MoveToCompany@1160040000 : Codeunit 6086359;
                                 RecRef@1160040002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 MoveToCompany.HandleMovement(RecRef);
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040058;1 ;ActionGroup;
                      Name=Posting;
                      CaptionML=[DEU=Bu&chung;
                                 ENU=P&osting;
                                 NLD=Boeken;
                                 SVE=B&okfîring] }
      { 1160040059;2 ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[DEU=Buchungsvorschlag erstellen;
                                 ENU=P&ost;
                                 NLD=B&oeken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewInvoice;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040000 : Record 6086320;
                               BEGIN
                                 Expense := Rec;
                                 CODEUNIT.RUN(CODEUNIT::"Expense-Post (Yes/No)",Expense);
                                 CurrPage.UPDATE(FALSE);

                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040030;2 ;Action    ;
                      Name=Post Batch;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Batch-Erstellung Buchungsvorschlag;
                                 ENU=Post &Batch;
                                 NLD=B&atchboeken];
                      Promoted=Yes;
                      Image=PostBatch;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Expenses",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 6086300 ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[DEU=Buchungsvorschau;
                                 ENU=Preview Posting;
                                 NLD=Boekingsvoorbeeld];
                      Promoted=No;
                      Enabled=EnablePostingPreview;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 Expense@6086301 : Record 6086320;
                                 ExpensePostYesNo@6086300 : Codeunit 6086331;
                               BEGIN
                                 Expense := Rec;
                                 ExpensePostYesNo.Preview(Expense);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 1160040000;1;Group  ;
                GroupType=Repeater }

    { 1160040024;2;Field  ;
                Name=Entry No.;
                SourceExpr="Entry No.";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040042;2;Field  ;
                Name=HasComments;
                CaptionML=[DEU=Bemerkung;
                           ENU=Comment;
                           NLD=Opmerking;
                           SVE=Kommentar];
                SourceExpr=HasComments;
                Editable=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040003;2;Field  ;
                Name=Continia User ID;
                SourceExpr="Continia User ID";
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           UserResp@1160040002 : Record 6086379;
                         BEGIN
                           EXIT(UserResp.LookupUser(Text));
                         END;
                          }

    { 1160040045;2;Field  ;
                Name=Continia User Name;
                SourceExpr="Continia User Name";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040011;2;Field  ;
                Name=Document Date;
                SourceExpr="Document Date";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040074;2;Field  ;
                Name=Settlement No.;
                SourceExpr="Settlement No.";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040034;2;Field  ;
                Name=Expense Type;
                SourceExpr="Expense Type";
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040072;2;Field  ;
                Name=Description;
                SourceExpr=Description;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040007;2;Field  ;
                Name=Description 2;
                SourceExpr="Description 2";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040049;2;Field  ;
                Name=No. of Attachments;
                SourceExpr="No. of Attachments";
                Visible=false }

    { 1160040052;2;Field  ;
                Name=AttendeesDisplayText;
                CaptionML=[DEU=Statusfilter;
                           ENU=Attendees;
                           NLD=Deelnemers];
                SourceExpr=GetAttendeesForDisplay;
                Importance=Additional;
                OnDrillDown=BEGIN
                              DrillDownAttendees;
                              CurrPage.UPDATE(TRUE);
                            END;
                             }

    { 1160040083;2;Field  ;
                Name=Business Description;
                SourceExpr="Business Description";
                Visible=false }

    { 1160040069;2;Field  ;
                Name=Status;
                SourceExpr=Status;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040037;2;Field  ;
                Name=On Hold;
                SourceExpr="On Hold";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040075;2;Field  ;
                Name=Approval by;
                CaptionML=[DEU=Genehmigung durch;
                           ENU=Approval by;
                           NLD=Goedkeuring door;
                           SVE=GodkÑnnande av];
                SourceExpr=EMApprovalMgt.GetNextApproverName(DATABASE::Expense,FORMAT("Entry No."));
                Style=Attention;
                StyleExpr=StyleFormat;
                OnDrillDown=BEGIN
                              EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Expense,FORMAT("Entry No."));
                            END;
                             }

    { 1160040015;2;Field  ;
                Name=Country/Region Code;
                SourceExpr="Country/Region Code";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040017;2;Field  ;
                Name=Currency Code;
                SourceExpr="Currency Code";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040013;2;Field  ;
                Name=Amount;
                SourceExpr=Amount;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040005;2;Field  ;
                Name=Amount (LCY);
                SourceExpr="Amount (LCY)";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040084;2;Field  ;
                Name=Allocated Amount (LCY);
                SourceExpr="Allocated Amount (LCY)";
                Visible=False;
                OnDrillDown=VAR
                              ExpenseAllocation@1160040000 : Record 6086321;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;

                              ExpenseAllocation.SETCURRENTKEY("Expense Entry No.");
                              ExpenseAllocation.SETRANGE("Expense Entry No.","Entry No.");
                              PAGE.RUNMODAL(PAGE::"Expense Split and Allocation",ExpenseAllocation);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 1160040071;2;Field  ;
                Name=Bank-Currency Amount;
                SourceExpr="Bank-Currency Amount";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040026;2;Field  ;
                Name=Bank Currency Code;
                SourceExpr="Bank Currency Code";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040061;2;Field  ;
                Name=Cash/Private Card;
                SourceExpr="Cash/Private Card";
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040048;2;Field  ;
                Name=Matched to Bank Transaction;
                SourceExpr="Matched to Bank Transaction";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040040;2;Field  ;
                Name=No Refund;
                SourceExpr="No Refund";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040009;2;Field  ;
                Name=Attendees;
                CaptionML=[DEU=Statusfilter;
                           ENU=Attendees;
                           NLD=Deelnemers];
                SourceExpr=GetAttendeesForDisplay;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnDrillDown=BEGIN
                              DrillDownAttendees;
                              CurrPage.UPDATE;
                            END;
                             }

    { 1160040039;2;Field  ;
                Name=Current Reminder Level;
                SourceExpr="Current Reminder Level";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040001;2;Field  ;
                Name=Global Dimension 1 Code;
                SourceExpr="Global Dimension 1 Code";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040002;2;Field  ;
                Name=Global Dimension 2 Code;
                SourceExpr="Global Dimension 2 Code";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040064;2;Field  ;
                Name=Job No.;
                SourceExpr="Job No.";
                Visible=JobNoVisible;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040065;2;Field  ;
                Name=Job Task No.;
                SourceExpr="Job Task No.";
                Visible=JobNoVisible;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040076;2;Field  ;
                Name=Billable;
                SourceExpr=Billable;
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040077;2;Field  ;
                Name=Job Line Type;
                SourceExpr="Job Line Type";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040054;2;Field  ;
                Name=Admin Comment;
                SourceExpr="Admin Comment";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040004;2;Field  ;
                Name=ShortcutFieldValues1;
                SourceExpr=ShortcutFieldValues[1];
                CaptionClass=GetShortcutFieldCaption(1);
                Visible=CustomfieldVisible1;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(1,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[1]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(1,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040006;2;Field  ;
                Name=ShortcutFieldValues2;
                SourceExpr=ShortcutFieldValues[2];
                CaptionClass=GetShortcutFieldCaption(2);
                Visible=CustomfieldVisible2;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(2,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[2]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(2,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040008;2;Field  ;
                Name=ShortcutFieldValues3;
                SourceExpr=ShortcutFieldValues[3];
                CaptionClass=GetShortcutFieldCaption(3);
                Visible=CustomfieldVisible3;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(3,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[3]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(3,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040010;2;Field  ;
                Name=ShortcutFieldValues4;
                SourceExpr=ShortcutFieldValues[4];
                CaptionClass=GetShortcutFieldCaption(4);
                Visible=CustomfieldVisible4;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(4,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[4]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(4,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040012;2;Field  ;
                Name=ShortcutFieldValues5;
                SourceExpr=ShortcutFieldValues[5];
                CaptionClass=GetShortcutFieldCaption(5);
                Visible=CustomfieldVisible5;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(5,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[5]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(5,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040014;2;Field  ;
                Name=ShortcutFieldValues6;
                SourceExpr=ShortcutFieldValues[6];
                CaptionClass=GetShortcutFieldCaption(6);
                Visible=CustomfieldVisible6;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(6,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[6]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(6,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040016;2;Field  ;
                Name=ShortcutFieldValues7;
                SourceExpr=ShortcutFieldValues[7];
                CaptionClass=GetShortcutFieldCaption(7);
                Visible=CustomfieldVisible7;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(7,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[7]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(7,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040018;2;Field  ;
                Name=ShortcutFieldValues8;
                SourceExpr=ShortcutFieldValues[8];
                CaptionClass=GetShortcutFieldCaption(8);
                Visible=CustomfieldVisible8;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(8,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[8]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(8,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040019;2;Field  ;
                Name=ShortcutFieldValues9;
                SourceExpr=ShortcutFieldValues[9];
                CaptionClass=GetShortcutFieldCaption(9);
                Visible=CustomfieldVisible9;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(9,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[9]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(9,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040023;2;Field  ;
                Name=ShortcutFieldValues10;
                SourceExpr=ShortcutFieldValues[10];
                CaptionClass=GetShortcutFieldCaption(10);
                Visible=CustomfieldVisible10;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(10,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[10]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(10,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040085;2;Field  ;
                Name=Expense Account Type;
                SourceExpr="Expense Account Type";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 12  ;2   ;Field     ;
                Name=Expense Account;
                Lookup=Yes;
                SourceExpr="Expense Account";
                Visible=False;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnLookup=BEGIN
                           EXIT(LookupPostingAccount(Text));
                         END;
                          }

    { 1160040044;2;Field  ;
                Name=Gen. Prod. Posting Group;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040047;2;Field  ;
                Name=VAT Prod. Posting Group;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040080;2;Field  ;
                Name=Gen. Bus. Posting Group;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040081;2;Field  ;
                Name=VAT Bus. Posting Group;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040082;2;Field  ;
                Name=Exp. Account Manually Changed;
                SourceExpr="Exp. Account Manually Changed";
                Visible=False;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040051;2;Field  ;
                Name=Next Reminder;
                CaptionML=[DEU=NÑchste Erinnerung;
                           ENU=Next Reminder;
                           NLD=Volgende herinnering];
                SourceExpr=NextReminderDate;
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnDrillDown=BEGIN
                              ShowReminders;
                            END;
                             }

    { 1160040041;1;Part   ;
                Name=Expense Comment Subpage;
                SubPageLink=Doc. Ref. No.=FIELD(Entry No.),
                            Table ID=CONST(6086320);
                PagePartID=Page6086361;
                Editable=false;
                PartType=Page }

    { 2   ;    ;Container ;
                Name=FactBoxArea;
                ContainerType=FactBoxArea }

    { 1   ;1   ;Part      ;
                Name=CaptureUI;
                CaptionML=[DEU=Dateianhang;
                           ENU=Attachments;
                           NLD=Bijlagen;
                           SVE=Bilagor];
                SubPageLink=Entry No.=FIELD(Entry No.);
                PagePartID=Page6086339;
                PartType=Page }

  }
  CODE
  {
    VAR
      ShortcutFieldFunctions@1160040010 : Codeunit 6086304;
      EMApprovalMgt@1160040000 : Codeunit 6086312;
      EMApprovalsBridge@1000 : Codeunit 6086369;
      CustomFieldNames@1160040006 : ARRAY [10] OF Text[50];
      ShortcutFieldCaptions@1160040001 : ARRAY [10] OF Text[250];
      ShortcutFieldValues@1160040002 : ARRAY [10] OF Text[250];
      StatusFilter@1160040003 : 'All,Open,PendingExpUser,PendingApproval,Released,ReadyToInvoice';
      CustomFieldVisible1@1160040005 : Boolean INDATASET;
      CustomFieldVisible10@1009 : Boolean INDATASET;
      CustomFieldVisible2@1001 : Boolean INDATASET;
      CustomFieldVisible3@1002 : Boolean INDATASET;
      CustomFieldVisible4@1003 : Boolean INDATASET;
      CustomFieldVisible5@1004 : Boolean INDATASET;
      CustomFieldVisible6@1005 : Boolean INDATASET;
      CustomFieldVisible7@1006 : Boolean INDATASET;
      CustomFieldVisible8@1007 : Boolean INDATASET;
      CustomFieldVisible9@1008 : Boolean INDATASET;
      EnableActions@1010 : Boolean INDATASET;
      EnablePostingPreview@6086301 : Boolean INDATASET;
      HasComments@1160040019 : Boolean;
      JobNoVisible@1160040004 : Boolean INDATASET;
      ShowBankIntegration@1160040008 : Boolean INDATASET;
      StyleFormat@1160040011 : Text[30] INDATASET;
      ConfirmForceReleaseMultiple@1160040027 : TextConst 'DEU=Dies erzwingt die Genehmigung von %1 Ausgaben.\\Mîchten Sie fortfahren?;ENU=This will force the approval of %1 expenses.\\Do you want to continue?;NLD=%1 uitgaven worden geforceerd goedgekeurd.\\Wilt u doorgaan?';
      ConfirmReopenMultiple@1160040025 : TextConst 'DEU=Dadurch werden %1 Ausgaben erneut geîffnet.\\Mîchten Sie fortfahren?;ENU=This will reopen %1 expenses.\\Do you want to continue?;NLD=%1 uitgaven worden heropend.\\Wilt u doorgaan?';
      ConfirmReopenSingle@1160040026 : TextConst 'DEU=Mîchten Sie diese Ausgabe erneut îffnen?;ENU=Do you want to reopen this expense?;NLD=Wilt u de uitgave heropenen?';
      ConfirmSendToMultipleUsers@1160040023 : TextConst 'DEU=Dies sendet %1 Ausgaben an den Ausgabenbenutzer.\\Mîchten Sie fortfahren?;ENU=This will send %1 expenses to the expense user.\\Do you want to continue?;NLD=%1 uitgaven worden verzonden naar de gebruiker.\\Wilt u doorgaan?';
      ContForceReleaselSingle@1160040024 : TextConst 'DEU=Mîchten Sie die Genehmigung dieser Ausgabe erzwingen?;ENU=Do you want to force the approval of this expense?;NLD=Wilt u de goedkeuring van deze uitgave forceren?';
      Instructions@1160040009 : TextConst 'DEU=Mîchten Sie eine Status-E-Mail an alle oder nur an die ausgewÑhlten Benutzer senden?;ENU=Do you want to send a status e-mail to all the Users or only to the selected ones?;NLD=Wilt u een status e-mail verzenden aan alle gebruikers of alleen aan de geselecteerde gebruikers?';
      NoOfExpSentToExpUserMsg@1160040017 : TextConst 'DEU=%1 von %2 an Ausgabenbenutzer gesendet.;ENU=%1 out of %2 sent to expense users.;NLD=%1 van %2 verzonden naar gebruikers.';
      Options@1160040015 : TextConst 'DEU=An alle Benutzer senden, Nur an ausgewÑhlte Benutzer senden (erzwungen);ENU=Send to All Users,Send to Selected Users only (forced);NLD=Verzend naar alle gebruikers,Verzend naar geselecteerde gebruikers (geforceerd)';
      Select2ExpToMergeErr@1160040007 : TextConst 'DEU=WÑhlen Sie zwei Ausgaben, um sie zusammenzufÅhren.;ENU=Please select two expenses to merge them.;NLD=Selecteer 2 uitgaven om samen te voegen.';
      SyncRequired@1160040012 : TextConst 'DEU=Diese Ausgabe enthÑlt Werte, die nicht zu Continia Online synchronisiert wurden. Dies ist erforderlich, bevor die Ausgabe an den Ausgabenbenutzer gesendet werden kann.\\Mîchten Sie die Werte mit Continia Online synchronisieren?;ENU=This expense contains values that have not been synchronized to Continia Online. This is required before this expense can be sent to the expense user.\\Would you like to synchronize values with Continia Online?;NLD=Deze uitgave bevat waarden die niet met Continia Online gesynchroniseerd zijn. Dit is een verplicht voordat u de uitgave naar de gebruiker kunt verzenden.\\Wilt u met Continia Online synchroniseren?';

    LOCAL PROCEDURE SetStatusFilter@5();
    VAR
      PrevEntryNo@1160040000 : Integer;
    BEGIN
      PrevEntryNo := "Entry No.";

      FILTERGROUP(2);

      SETRANGE(Posted,FALSE);

      CASE StatusFilter OF
        StatusFilter::All:
          SETRANGE(Status);
        StatusFilter::ReadyToInvoice:
          BEGIN
            SETRANGE(Status,Status::Released);
            SETRANGE(Posted,FALSE);
          END
        ELSE
          SETRANGE(Status,StatusFilter - 1);
      END;

      FILTERGROUP(0);

      SETRANGE("Entry No.",PrevEntryNo);
      IF FINDFIRST THEN;
      SETRANGE("Entry No.");

      CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE EnableFields@1160040003();
    VAR
      EMSetup@1160040000 : Record 6086300;
    BEGIN
      EMSetup.GET;
      CustomFieldNames[1] := EMSetup."Shortcut Field 1 Code (Exp.)";
      CustomFieldNames[2] := EMSetup."Shortcut Field 2 Code (Exp.)";
      CustomFieldNames[3] := EMSetup."Shortcut Field 3 Code (Exp.)";
      CustomFieldNames[4] := EMSetup."Shortcut Field 4 Code (Exp.)";
      CustomFieldNames[5] := EMSetup."Shortcut Field 5 Code (Exp.)";
      CustomFieldNames[6] := EMSetup."Shortcut Field 6 Code (Exp.)";
      CustomFieldNames[7] := EMSetup."Shortcut Field 7 Code (Exp.)";
      CustomFieldNames[8] := EMSetup."Shortcut Field 8 Code (Exp.)";
      CustomFieldNames[9] := EMSetup."Shortcut Field 9 Code (Exp.)";
      CustomFieldNames[10] := EMSetup."Shortcut Field 10 Code (Exp.)";

      CustomFieldVisible1 := CustomFieldNames[1] <> '';
      CustomFieldVisible2 := CustomFieldNames[2] <> '';
      CustomFieldVisible3 := CustomFieldNames[3] <> '';
      CustomFieldVisible4 := CustomFieldNames[4] <> '';
      CustomFieldVisible5 := CustomFieldNames[5] <> '';
      CustomFieldVisible6 := CustomFieldNames[6] <> '';
      CustomFieldVisible7 := CustomFieldNames[7] <> '';
      CustomFieldVisible8 := CustomFieldNames[8] <> '';
      CustomFieldVisible9 := CustomFieldNames[9] <> '';
      CustomFieldVisible10 := CustomFieldNames[10] <> '';

      JobNoVisible := ShortcutFieldFunctions.JobNoVisible(DATABASE::Expense);
    END;

    LOCAL PROCEDURE GetShortcutFieldCaption@1160040001(ShortcutFieldNo@1160040000 : Integer) : Text[250];
    BEGIN
      IF ShortcutFieldCaptions[1] = '' THEN
        ShortcutFieldFunctions.GetShortcutFieldCaptionsArray(ShortcutFieldCaptions,DATABASE::Expense);

      EXIT(ShortcutFieldCaptions[ShortcutFieldNo]);
    END;

    PROCEDURE GetSelectionFilter@1160040004(VAR Expense@1160040000 : Record 6086320);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Expense);
    END;

    BEGIN
    END.
  }
}

