OBJECT Codeunit 5845 Get Inventory Report
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW113.00;
  }
  PROPERTIES
  {
    TableNo=5846;
    OnRun=BEGIN
            WindowUpdateDateTime := CURRENTDATETIME;
            WindowIsOpen := FALSE;

            RESET;
            DELETEALL;
            Calculate(Rec);

            IF WindowIsOpen THEN
              Window.CLOSE;
          END;

  }
  CODE
  {
    VAR
      InvtReportHeader@1000 : Record 5845;
      Item@1002 : Record 27;
      GLAcc@1001 : Record 15;
      ValueEntry@1003 : Record 5802;
      Text000@1009 : TextConst 'ENU=Calculating...\;NOR=Beregner...\;SVE=Ber„knar...\';
      Text001@1008 : TextConst 'ENU=Type         #1######\;NOR=Type         #1######\;SVE=Typ           #1######\';
      Text002@1007 : TextConst 'ENU=No.          #2######\;NOR=Nr.          #2######\;SVE=Nr            #2######\';
      Text003@1006 : TextConst 'ENU=Posting Type #3######;NOR=Bokf›r.type  #3######;SVE=Bokf”ringstyp #3######';
      Window@1004 : Dialog;
      WindowIsOpen@1005 : Boolean;
      WindowType@1010 : Text[80];
      WindowNo@1011 : Text[20];
      WindowPostingType@1012 : Text[80];
      WindowUpdateDateTime@1013 : DateTime;
      Text004@1014 : TextConst 'ENU=Show Item Direct Costs,Show Assembly Direct Cost,Show Revaluations,Show Roundings;NOR=Vis direkte kostnad for vare,Vis direkte kostnad for montering,Vis revalueringer,Vis avrundinger;SVE=Visa direkta artikelkostnader,Visa direkta monteringskostnader,Visa omv„rderingar,Visa avrundningar';
      Text005@1015 : TextConst 'ENU=Show WIP Consumption,Show WIP Capacity,Show WIP Output;NOR=Vis VIA-forbruk,Vis VIA-kapasitet,Vis VIA-utdata;SVE=Visa PIA-f”rbrukning,Visa PIA-kapacitet,Visa PIA-utfl”de';
      Text006@1016 : TextConst 'ENU=Show Item Direct Costs,Show Assembly Direct Costs;NOR=Vis direkte kostnad for vare,Vis direkte kostnad for montering;SVE=Visa direkta artikelkostnader,Visa direkta monteringskostnader';
      Text007@1017 : TextConst 'ENU=Show Item Indirect Costs,Show Assembly Indirect Costs;NOR=Vis indirekte kostnad for vare,Vis indirekte kostnad for montering;SVE=Visa indirekta artikelkostnader,Visa indirekta monteringskostnader';

    LOCAL PROCEDURE Calculate@4(VAR InventoryReportLine@1000 : Record 5846);
    BEGIN
      CalcGLPostings(InventoryReportLine);
      CalcInvtPostings(InventoryReportLine);
      InsertDiffReportEntry(InventoryReportLine);

      IF InvtReportHeader."Show Warning" THEN
        DetermineDiffError(InventoryReportLine);
    END;

    LOCAL PROCEDURE CalcGLPostings@30(VAR InventoryReportLine@1000 : Record 5846);
    BEGIN
      CalcGenPostingSetup(InventoryReportLine);
      CalcInvtPostingSetup(InventoryReportLine);
    END;

    LOCAL PROCEDURE CalcInvtPostings@33(VAR InventoryReportLine@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        RESET;
        CLEAR(InventoryReportLine);
        SETCURRENTKEY(
          "Item No.","Posting Date","Item Ledger Entry Type","Entry Type","Variance Type",
          "Item Charge No.","Location Code","Variant Code");
        SETFILTER("Item No.",InvtReportHeader.GETFILTER("Item Filter"));
        IF FIND('-') THEN
          REPEAT
            UpDateWindow(Item.TABLECAPTION,"Item No.",'');
            SETRANGE("Item No.","Item No.");
            IF NOT Item.GET("Item No.") THEN
              CLEAR(Item);
            IF Item.Type = Item.Type::Inventory THEN
              InsertItemInvtReportEntry(InventoryReportLine);

            SETFILTER("Item No.",InvtReportHeader.GETFILTER("Item Filter"));
          UNTIL NEXT = 0;
      END
    END;

    LOCAL PROCEDURE InsertDiffReportEntry@62(VAR InventoryReportLine@1000 : Record 5846);
    BEGIN
      WITH InventoryReportLine DO BEGIN
        INIT;
        CalcDiff(InventoryReportLine);
        Type := Type::" ";
        "No." := '';
        Description := '';
        "Entry No." := "Entry No." + 1;
        INSERT;
      END;
    END;

    LOCAL PROCEDURE DetermineDiffError@63(VAR InventoryReportLine@1000 : Record 5846);
    BEGIN
      InventoryReportLine.SETRANGE(Type,InventoryReportLine.Type::" ");
      IF NOT InventoryReportLine.FINDFIRST THEN
        EXIT;

      CheckExpectedCostPosting(InventoryReportLine);
      CASE TRUE OF
        CheckIfNoDifference(InventoryReportLine):
          ;
        CheckCostIsPostedToGL(InventoryReportLine):
          ;
        CheckValueGLCompression(InventoryReportLine):
          ;
        CheckGLClosingOverlaps(InventoryReportLine):
          ;
        CheckDeletedGLAcc(InventoryReportLine):
          ;
        CheckPostingDateToGLNotTheSame(InventoryReportLine):
          ;
        CheckDirectPostings(InventoryReportLine):
          ;
      END;
    END;

    LOCAL PROCEDURE CalcInvtPostingSetup@22(VAR InventoryReportLine@1002 : Record 5846);
    VAR
      InvtPostingSetup@1001 : Record 5813;
      TempInvtPostingSetup@1000 : TEMPORARY Record 5813;
    BEGIN
      WITH InvtPostingSetup DO BEGIN
        IF FIND('-') THEN
          REPEAT
            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("Inventory Account","Inventory Account");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Inventory Account"));
              InsertGLInvtReportEntry(InventoryReportLine,"Inventory Account",InventoryReportLine.Inventory);
            END;

            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("Inventory Account (Interim)","Inventory Account (Interim)");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Inventory Account (Interim)"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Inventory Account (Interim)",InventoryReportLine."Inventory (Interim)");
            END;

            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("Material Variance Account","Material Variance Account");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Material Variance Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Material Variance Account",InventoryReportLine."Material Variance");
            END;

            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("Capacity Variance Account","Capacity Variance Account");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Capacity Variance Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Capacity Variance Account",InventoryReportLine."Capacity Variance");
            END;

            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("Mfg. Overhead Variance Account","Mfg. Overhead Variance Account");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Mfg. Overhead Variance Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Mfg. Overhead Variance Account",InventoryReportLine."Mfg. Overhead Variance");
            END;

            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("Cap. Overhead Variance Account","Cap. Overhead Variance Account");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Cap. Overhead Variance Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Cap. Overhead Variance Account",InventoryReportLine."Capacity Overhead Variance");
            END;

            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("Subcontracted Variance Account","Subcontracted Variance Account");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Subcontracted Variance Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Subcontracted Variance Account",InventoryReportLine."Subcontracted Variance");
            END;

            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("WIP Account","WIP Account");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("WIP Account"));
              InsertGLInvtReportEntry(InventoryReportLine,"WIP Account",InventoryReportLine."WIP Inventory");
            END;

            TempInvtPostingSetup := InvtPostingSetup;
            TempInvtPostingSetup.INSERT;
          UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CalcGenPostingSetup@23(VAR InventoryReportLine@1002 : Record 5846);
    VAR
      GenPostingSetup@1001 : Record 252;
      TempGenPostingSetup@1000 : TEMPORARY Record 252;
    BEGIN
      WITH GenPostingSetup DO BEGIN
        IF FIND('-') THEN
          REPEAT
            TempGenPostingSetup.RESET;
            TempGenPostingSetup.SETRANGE("COGS Account","COGS Account");
            IF NOT TempGenPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("COGS Account"));
              InsertGLInvtReportEntry(InventoryReportLine,"COGS Account",InventoryReportLine.COGS);
            END;

            TempGenPostingSetup.RESET;
            TempGenPostingSetup.SETRANGE("Inventory Adjmt. Account","Inventory Adjmt. Account");
            IF NOT TempGenPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Inventory Adjmt. Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Inventory Adjmt. Account",InventoryReportLine."Inventory Adjmt.");
            END;

            TempGenPostingSetup.RESET;
            TempGenPostingSetup.SETRANGE("Invt. Accrual Acc. (Interim)","Invt. Accrual Acc. (Interim)");
            IF NOT TempGenPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Invt. Accrual Acc. (Interim)"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Invt. Accrual Acc. (Interim)",InventoryReportLine."Invt. Accrual (Interim)");
            END;

            TempGenPostingSetup.RESET;
            TempGenPostingSetup.SETRANGE("COGS Account (Interim)","COGS Account (Interim)");
            IF NOT TempGenPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("COGS Account (Interim)"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"COGS Account (Interim)",InventoryReportLine."COGS (Interim)");
            END;

            TempGenPostingSetup.RESET;
            TempGenPostingSetup.SETRANGE("Direct Cost Applied Account","Direct Cost Applied Account");
            IF NOT TempGenPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Direct Cost Applied Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Direct Cost Applied Account",InventoryReportLine."Direct Cost Applied");
            END;

            TempGenPostingSetup.RESET;
            TempGenPostingSetup.SETRANGE("Overhead Applied Account","Overhead Applied Account");
            IF NOT TempGenPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Overhead Applied Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Overhead Applied Account",InventoryReportLine."Overhead Applied");
            END;

            TempGenPostingSetup.RESET;
            TempGenPostingSetup.SETRANGE("Purchase Variance Account","Purchase Variance Account");
            IF NOT TempGenPostingSetup.FINDFIRST THEN BEGIN
              UpDateWindow(WindowType,WindowNo,FIELDCAPTION("Purchase Variance Account"));
              InsertGLInvtReportEntry(
                InventoryReportLine,"Purchase Variance Account",InventoryReportLine."Purchase Variance");
            END;

            TempGenPostingSetup := GenPostingSetup;
            TempGenPostingSetup.INSERT;
          UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE InsertGLInvtReportEntry@58(VAR InventoryReportLine@1000 : Record 5846;GLAccNo@1001 : Code[20];VAR CostAmount@1002 : Decimal);
    BEGIN
      WITH InventoryReportLine DO BEGIN
        INIT;
        IF NOT GLAcc.GET(GLAccNo) THEN
          EXIT;
        GLAcc.SETFILTER("Date Filter",InvtReportHeader.GETFILTER("Posting Date Filter"));
        CostAmount := CalcGLAccount(GLAcc);

        IF CostAmount = 0 THEN
          EXIT;
        Type := Type::"G/L Account";
        "No." := GLAcc."No.";
        Description := GLAcc.Name;
        "Entry No." := "Entry No." + 1;
        INSERT;
      END;
    END;

    LOCAL PROCEDURE InsertItemInvtReportEntry@57(VAR InventoryReportLine@1000 : Record 5846);
    BEGIN
      WITH InventoryReportLine DO BEGIN
        INIT;
        CalcItem(InventoryReportLine);
        "No." := ValueEntry."Item No.";
        Description := Item.Description;
        Type := Type::Item;
        "Entry No." := "Entry No." + 1;
        INSERT;
      END;
    END;

    LOCAL PROCEDURE CalcItem@2(VAR InventoryReportLine@1001 : Record 5846);
    BEGIN
      WITH ValueEntry DO
        REPEAT
          SETRANGE("Posting Date","Posting Date");
          REPEAT
            IF ValueEntryInFilteredSet(ValueEntry,InvtReportHeader,FALSE) THEN BEGIN
              IF Item."No." <> "Item No." THEN
                IF NOT Item.GET("Item No.") THEN
                  Item.INIT;
              SETRANGE("Entry Type","Entry Type");
              SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type");
              SETRANGE("Location Code","Location Code");
              SETRANGE("Variance Type","Variance Type");
              SETRANGE("Item Charge No.","Item Charge No.");

              IF ValueEntryInFilteredSet(ValueEntry,InvtReportHeader,TRUE) THEN
                CalcValueEntries(InventoryReportLine);

              FINDLAST;
              SETRANGE("Entry Type");
              SETRANGE("Item Ledger Entry Type");
              SETRANGE("Location Code");
              SETRANGE("Variance Type");
              SETRANGE("Item Charge No.");
            END ELSE
              FINDLAST;
          UNTIL NEXT = 0;

          FINDLAST;
          SETFILTER("Posting Date",InvtReportHeader.GETFILTER("Posting Date Filter"));
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE ValueEntryInFilteredSet@21(VAR ValueEntry@1000 : Record 5802;VAR InvtReportHeader@1001 : Record 5845;Detailed@1003 : Boolean) : Boolean;
    VAR
      TempValueEntry@1002 : TEMPORARY Record 5802;
    BEGIN
      WITH TempValueEntry DO BEGIN
        SETFILTER("Item No.",InvtReportHeader.GETFILTER("Item Filter"));
        SETFILTER("Posting Date",InvtReportHeader.GETFILTER("Posting Date Filter"));
        IF Detailed THEN
          SETFILTER("Location Code",InvtReportHeader.GETFILTER("Location Filter"));

        TempValueEntry := ValueEntry;
        INSERT;
        EXIT(NOT ISEMPTY);
      END;
    END;

    LOCAL PROCEDURE CalcValueEntries@10(VAR InventoryReportLine@1002 : Record 5846);
    BEGIN
      WITH InventoryReportLine DO BEGIN
        UpDateWindow(WindowType,WindowNo,FORMAT(ValueEntry."Entry Type"));
        "Direct Cost Applied Actual" := "Direct Cost Applied Actual" + CalcDirectCostAppliedActual(ValueEntry);
        "Overhead Applied Actual" := "Overhead Applied Actual" + CalcOverheadAppliedActual(ValueEntry);
        "Purchase Variance" := "Purchase Variance" + CalcPurchaseVariance(ValueEntry);
        "Inventory Adjmt." := "Inventory Adjmt." + CalcInventoryAdjmt(ValueEntry);
        "Invt. Accrual (Interim)" := "Invt. Accrual (Interim)" + CalcInvtAccrualInterim(ValueEntry);
        COGS := COGS + CalcCOGS(ValueEntry);
        "COGS (Interim)" := "COGS (Interim)" + CalcCOGSInterim(ValueEntry);
        "WIP Inventory" := "WIP Inventory" + CalcWIPInventory(ValueEntry);
        "Material Variance" := "Material Variance" + CalcMaterialVariance(ValueEntry);
        "Capacity Variance" := "Capacity Variance" + CalcCapVariance(ValueEntry);
        "Subcontracted Variance" := "Subcontracted Variance" + CalcSubcontractedVariance(ValueEntry);
        "Capacity Overhead Variance" := "Capacity Overhead Variance" + CalcCapOverheadVariance(ValueEntry);
        "Mfg. Overhead Variance" := "Mfg. Overhead Variance" + CalcMfgOverheadVariance(ValueEntry);
        "Inventory (Interim)" := "Inventory (Interim)" + CalcInventoryInterim(ValueEntry);
        "Direct Cost Applied WIP" := "Direct Cost Applied WIP" + CalcDirectCostAppliedToWIP(ValueEntry);
        "Overhead Applied WIP" := "Overhead Applied WIP" + CalcOverheadAppliedToWIP(ValueEntry);
        "Inventory To WIP" := "Inventory To WIP" + CalcInvtToWIP(ValueEntry);
        "WIP To Interim" := "WIP To Interim" + CalcWIPToInvtInterim(ValueEntry);
        Inventory := Inventory + CalcInventory(ValueEntry);
        "Direct Cost Applied" := "Direct Cost Applied" + CalcDirectCostApplied(ValueEntry);
        "Overhead Applied" := "Overhead Applied" + CalcOverheadApplied(ValueEntry);
      END;
    END;

    LOCAL PROCEDURE CalcGLAccount@28(VAR GLAcc@1000 : Record 15) : Decimal;
    BEGIN
      WITH GLAcc DO BEGIN
        UpDateWindow(TABLECAPTION,"No.",WindowPostingType);
        CALCFIELDS("Net Change");
        EXIT("Net Change");
      END;
    END;

    LOCAL PROCEDURE CalcDiff@60(VAR InventoryReportLine@1000 : Record 5846);
    VAR
      CalcInventoryReportLine@1001 : Record 5846;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        CalcInventoryReportLine.COPY(InventoryReportLine);
        RESET;

        SETRANGE(Type,Type::"G/L Account");
        CALCSUMS(
          Inventory,"Inventory (Interim)","WIP Inventory",
          "Direct Cost Applied Actual","Overhead Applied Actual","Purchase Variance",
          "Inventory Adjmt.","Invt. Accrual (Interim)",COGS,
          "COGS (Interim)","Material Variance");
        CALCSUMS(
          "Capacity Variance","Subcontracted Variance","Capacity Overhead Variance",
          "Mfg. Overhead Variance","Direct Cost Applied WIP","Overhead Applied WIP",
          "Inventory To WIP","WIP To Interim","Direct Cost Applied","Overhead Applied");
        CalcInventoryReportLine := InventoryReportLine;

        SETRANGE(Type,Type::Item);
        CALCSUMS(
          Inventory,"Inventory (Interim)","WIP Inventory",
          "Direct Cost Applied Actual","Overhead Applied Actual","Purchase Variance",
          "Inventory Adjmt.","Invt. Accrual (Interim)",COGS,
          "COGS (Interim)","Material Variance");
        CALCSUMS(
          "Capacity Variance","Subcontracted Variance","Capacity Overhead Variance",
          "Mfg. Overhead Variance","Direct Cost Applied WIP","Overhead Applied WIP",
          "Inventory To WIP","WIP To Interim","Direct Cost Applied","Overhead Applied");
      END;

      WITH CalcInventoryReportLine DO BEGIN
        Inventory := Inventory - InventoryReportLine.Inventory;
        "Inventory (Interim)" := "Inventory (Interim)" - InventoryReportLine."Inventory (Interim)";
        "WIP Inventory" := "WIP Inventory" - InventoryReportLine."WIP Inventory";
        "Direct Cost Applied Actual" := "Direct Cost Applied Actual" - InventoryReportLine."Direct Cost Applied Actual";
        "Overhead Applied Actual" := "Overhead Applied Actual" - InventoryReportLine."Overhead Applied Actual";
        "Purchase Variance" := "Purchase Variance" - InventoryReportLine."Purchase Variance";
        "Inventory Adjmt." := "Inventory Adjmt." - InventoryReportLine."Inventory Adjmt.";
        "Invt. Accrual (Interim)" := "Invt. Accrual (Interim)" - InventoryReportLine."Invt. Accrual (Interim)";
        COGS := COGS - InventoryReportLine.COGS;
        "COGS (Interim)" := "COGS (Interim)" - InventoryReportLine."COGS (Interim)";
        "Material Variance" := "Material Variance" - InventoryReportLine."Material Variance";
        "Capacity Variance" := "Capacity Variance" - InventoryReportLine."Capacity Variance";
        "Subcontracted Variance" := "Subcontracted Variance" - InventoryReportLine."Subcontracted Variance";
        "Capacity Overhead Variance" := "Capacity Overhead Variance" - InventoryReportLine."Capacity Overhead Variance";
        "Mfg. Overhead Variance" := "Mfg. Overhead Variance" - InventoryReportLine."Mfg. Overhead Variance";
        "Direct Cost Applied WIP" := "Direct Cost Applied WIP" - InventoryReportLine."Direct Cost Applied WIP";
        "Overhead Applied WIP" := "Overhead Applied WIP" - InventoryReportLine."Overhead Applied WIP";
        "Inventory To WIP" := "Inventory To WIP" - InventoryReportLine."Inventory To WIP";
        "WIP To Interim" := "WIP To Interim" - InventoryReportLine."WIP To Interim";
        "Direct Cost Applied" := "Direct Cost Applied" - InventoryReportLine."Direct Cost Applied";
        "Overhead Applied" := "Overhead Applied" - InventoryReportLine."Overhead Applied";
        InventoryReportLine.COPY(CalcInventoryReportLine);
      END;
    END;

    LOCAL PROCEDURE DrillDownGL@55(VAR InvtReportEntry@1000 : Record 5846);
    VAR
      GLEntry@1001 : Record 17;
    BEGIN
      WITH GLEntry DO BEGIN
        SETRANGE("G/L Account No.",InvtReportEntry."No.");
        SETFILTER("Posting Date",InvtReportEntry.GETFILTER("Posting Date Filter"));
        PAGE.RUN(0,GLEntry,Amount);
      END;
    END;

    LOCAL PROCEDURE CalcDirectCostAppliedActual@1(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF "Entry Type" = "Entry Type"::"Direct Cost" THEN
          CASE "Item Ledger Entry Type" OF
            "Item Ledger Entry Type"::Purchase:
              BEGIN
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
            "Item Ledger Entry Type"::" ":
              IF "Order Type" = "Order Type"::Assembly THEN BEGIN
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
          END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcOverheadAppliedActual@3(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF "Entry Type" = "Entry Type"::"Indirect Cost" THEN
          CASE "Item Ledger Entry Type" OF
            "Item Ledger Entry Type"::Purchase,
            "Item Ledger Entry Type"::Output,
            "Item Ledger Entry Type"::"Assembly Output":
              BEGIN
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
            "Item Ledger Entry Type"::" ":
              IF "Order Type" = "Order Type"::Assembly THEN BEGIN
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
          END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcPurchaseVariance@5(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::Variance) AND
           ("Item Ledger Entry Type" = "Item Ledger Entry Type"::Purchase)
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcInventoryAdjmt@6(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO
        CASE "Entry Type" OF
          "Entry Type"::Rounding,
          "Entry Type"::Revaluation:
            BEGIN
              CALCSUMS("Cost Amount (Actual)");
              EXIT(-"Cost Amount (Actual)");
            END;
          "Entry Type"::"Direct Cost":
            CASE "Item Ledger Entry Type" OF
              "Item Ledger Entry Type"::"Positive Adjmt.",
              "Item Ledger Entry Type"::"Negative Adjmt.",
              "Item Ledger Entry Type"::"Assembly Output",
              "Item Ledger Entry Type"::"Assembly Consumption",
              "Item Ledger Entry Type"::Transfer:
                BEGIN
                  CALCSUMS("Cost Amount (Actual)");
                  EXIT(-"Cost Amount (Actual)");
                END;
              "Item Ledger Entry Type"::" ":
                IF "Order Type" = "Order Type"::Assembly THEN BEGIN
                  CALCSUMS("Cost Amount (Actual)");
                  EXIT(-"Cost Amount (Actual)");
                END;
            END;
        END;
      EXIT(0);
    END;

    LOCAL PROCEDURE CalcInvtAccrualInterim@8(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::"Direct Cost") AND
           ("Item Ledger Entry Type" = "Item Ledger Entry Type"::Purchase)
        THEN BEGIN
          CALCSUMS("Cost Amount (Expected)");
          EXIT(-"Cost Amount (Expected)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcCOGS@9(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::"Direct Cost") AND
           ("Item Ledger Entry Type" = "Item Ledger Entry Type"::Sale)
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcCOGSInterim@11(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" IN ["Entry Type"::"Direct Cost","Entry Type"::Revaluation]) AND
           ("Item Ledger Entry Type" = "Item Ledger Entry Type"::Sale)
        THEN BEGIN
          CALCSUMS("Cost Amount (Expected)");
          EXIT(-"Cost Amount (Expected)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcWIPInventory@12(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF "Order Type" = "Order Type"::Production THEN
          CASE "Item Ledger Entry Type" OF
            "Item Ledger Entry Type"::Consumption:
              IF "Entry Type" = "Entry Type"::"Direct Cost" THEN BEGIN
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
            "Item Ledger Entry Type"::Output:
              CASE "Entry Type" OF
                "Entry Type"::"Direct Cost":
                  BEGIN
                    CALCSUMS("Cost Amount (Actual)","Cost Amount (Expected)");
                    EXIT(-"Cost Amount (Actual)" - "Cost Amount (Expected)");
                  END;
                "Entry Type"::Revaluation:
                  BEGIN
                    CALCSUMS("Cost Amount (Expected)");
                    EXIT(-"Cost Amount (Expected)");
                  END;
              END;
            "Item Ledger Entry Type"::" ":
              IF "Entry Type" IN ["Entry Type"::"Direct Cost","Entry Type"::"Indirect Cost"] THEN BEGIN
                CALCSUMS("Cost Amount (Actual)");
                EXIT("Cost Amount (Actual)");
              END;
          END;
      END;
    END;

    LOCAL PROCEDURE CalcMaterialVariance@14(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::Variance) AND
           ("Item Ledger Entry Type" IN ["Item Ledger Entry Type"::Output,
                                         "Item Ledger Entry Type"::"Assembly Output"]) AND
           ("Variance Type" = "Variance Type"::Material)
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcCapVariance@15(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::Variance) AND
           ("Item Ledger Entry Type" IN ["Item Ledger Entry Type"::Output,
                                         "Item Ledger Entry Type"::"Assembly Output"]) AND
           ("Variance Type" = "Variance Type"::Capacity)
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcSubcontractedVariance@16(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::Variance) AND
           ("Item Ledger Entry Type" IN ["Item Ledger Entry Type"::Output,
                                         "Item Ledger Entry Type"::"Assembly Output"]) AND
           ("Variance Type" = "Variance Type"::Subcontracted)
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcCapOverheadVariance@17(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::Variance) AND
           ("Item Ledger Entry Type" IN ["Item Ledger Entry Type"::Output,
                                         "Item Ledger Entry Type"::"Assembly Output"]) AND
           ("Variance Type" = "Variance Type"::"Capacity Overhead")
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcMfgOverheadVariance@18(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::Variance) AND
           ("Item Ledger Entry Type" IN ["Item Ledger Entry Type"::Output,
                                         "Item Ledger Entry Type"::"Assembly Output"]) AND
           ("Variance Type" = "Variance Type"::"Manufacturing Overhead")
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcInventoryInterim@19(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" IN ["Entry Type"::"Direct Cost","Entry Type"::Revaluation]) AND
           ("Item Ledger Entry Type" IN
            ["Item Ledger Entry Type"::Purchase,
             "Item Ledger Entry Type"::Sale,
             "Item Ledger Entry Type"::Output])
        THEN BEGIN
          CALCSUMS("Cost Amount (Expected)");
          EXIT("Cost Amount (Expected)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcOverheadAppliedToWIP@24(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::"Indirect Cost") AND
           ("Item Ledger Entry Type" = "Item Ledger Entry Type"::" ") AND
           ("Order Type" = "Order Type"::Production)
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcDirectCostAppliedToWIP@25(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" = "Entry Type"::"Direct Cost") AND
           ("Item Ledger Entry Type" = "Item Ledger Entry Type"::" ") AND
           ("Order Type" = "Order Type"::Production)
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT(-"Cost Amount (Actual)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcWIPToInvtInterim@26(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF ("Entry Type" IN ["Entry Type"::"Direct Cost","Entry Type"::Revaluation]) AND
           ("Item Ledger Entry Type" = "Item Ledger Entry Type"::Output)
        THEN BEGIN
          CALCSUMS("Cost Amount (Expected)");
          EXIT(-"Cost Amount (Expected)");
        END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcInvtToWIP@29(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO
        IF ("Entry Type" = "Entry Type"::"Direct Cost") AND
           ("Item Ledger Entry Type" IN
            ["Item Ledger Entry Type"::Output,"Item Ledger Entry Type"::Consumption])
        THEN BEGIN
          CALCSUMS("Cost Amount (Actual)");
          EXIT("Cost Amount (Actual)");
        END;
    END;

    LOCAL PROCEDURE CalcInventory@20(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF "Item Ledger Entry Type" = "Item Ledger Entry Type"::" " THEN
          EXIT(0);
        CALCSUMS("Cost Amount (Actual)");
        EXIT("Cost Amount (Actual)");
      END;
    END;

    LOCAL PROCEDURE CalcDirectCostApplied@32(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF "Entry Type" = "Entry Type"::"Direct Cost" THEN
          CASE "Item Ledger Entry Type" OF
            "Item Ledger Entry Type"::Purchase:
              BEGIN
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
            "Item Ledger Entry Type"::" ":
              BEGIN
                IF "Order Type" = "Order Type"::Assembly THEN BEGIN
                  CALCSUMS("Cost Amount (Actual)");
                  EXIT(-"Cost Amount (Actual)");
                END;
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
          END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CalcOverheadApplied@31(VAR ValueEntry@1000 : Record 5802) : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        IF "Entry Type" = "Entry Type"::"Indirect Cost" THEN
          CASE "Item Ledger Entry Type" OF
            "Item Ledger Entry Type"::Purchase,
            "Item Ledger Entry Type"::Output,
            "Item Ledger Entry Type"::"Assembly Output":
              BEGIN
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
            "Item Ledger Entry Type"::" ":
              BEGIN
                IF "Order Type" = "Order Type"::Assembly THEN BEGIN
                  CALCSUMS("Cost Amount (Actual)");
                  EXIT(-"Cost Amount (Actual)");
                END;
                CALCSUMS("Cost Amount (Actual)");
                EXIT(-"Cost Amount (Actual)");
              END;
          END;
        EXIT(0);
      END;
    END;

    LOCAL PROCEDURE CopyFiltersFronInventoryReportLine@73(VAR ValueEntry@1000 : Record 5802;VAR InventoryReportEntry@1001 : Record 5846);
    BEGIN
      ValueEntry.SETCURRENTKEY("Item No.","Posting Date","Item Ledger Entry Type","Entry Type");
      ValueEntry.SETRANGE("Item No.",InventoryReportEntry."No.");
      ValueEntry.SETFILTER("Posting Date",InventoryReportEntry.GETFILTER("Posting Date Filter"));
      ValueEntry.SETFILTER("Location Code",InventoryReportEntry.GETFILTER("Location Filter"));
    END;

    [External]
    PROCEDURE DrillDownDirectCostApplActual@54(VAR InvtReportEntry@1002 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Direct Cost Applied Actual"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersDirectCostApplActual@78(VAR ValueEntry@1003 : Record 5802;VAR InvtReportEntry@1002 : Record 5846);
    VAR
      Selection@1000 : Integer;
    BEGIN
      Selection := STRMENU(Text006,2);
      CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
      WITH ValueEntry DO BEGIN
        SETRANGE("Entry Type","Entry Type"::"Direct Cost");
        SETRANGE("Variance Type");
        CASE Selection OF
          1:
            SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::Purchase);
          2:
            BEGIN
              SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::" ");
              SETRANGE("Order Type","Order Type"::Assembly);
            END;
        END;
      END;
    END;

    [External]
    PROCEDURE DrillDownOverheadAppliedActual@53(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Overhead Applied Actual"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersOverheadAppliedActual@79(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1002 : Record 5846);
    VAR
      Selection@1000 : Integer;
    BEGIN
      Selection := STRMENU(Text007,2);
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::"Indirect Cost");
        SETRANGE("Variance Type");
        CASE Selection OF
          1:
            SETFILTER("Item Ledger Entry Type",'%1|%2|%3',
              "Item Ledger Entry Type"::Purchase,
              "Item Ledger Entry Type"::Output,
              "Item Ledger Entry Type"::"Assembly Output");
          2:
            BEGIN
              SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::" ");
              SETRANGE("Order Type","Order Type"::Assembly);
            END;
        END;
      END;
    END;

    [External]
    PROCEDURE DrillDownPurchaseVariance@52(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Purchase Variance"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersPurchaseVariance@80(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::Variance);
        SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::Purchase);
      END;
    END;

    [External]
    PROCEDURE DrillDownInventoryAdjmt@51(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Inventory Adjmt."),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersInventoryAdjmt@81(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1002 : Record 5846);
    VAR
      Selection@1000 : Integer;
    BEGIN
      Selection := STRMENU(Text004,3);
      IF Selection = 0 THEN
        EXIT;

      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);

        CASE Selection OF
          1:
            BEGIN
              SETRANGE("Entry Type","Entry Type"::"Direct Cost");
              SETFILTER("Item Ledger Entry Type",'%1|%2|%3|%4|%5',
                "Item Ledger Entry Type"::"Positive Adjmt.",
                "Item Ledger Entry Type"::"Negative Adjmt.",
                "Item Ledger Entry Type"::"Assembly Output",
                "Item Ledger Entry Type"::"Assembly Consumption",
                "Item Ledger Entry Type"::Transfer);
            END;
          2:
            BEGIN
              SETRANGE("Entry Type","Entry Type"::"Direct Cost");
              SETRANGE("Order Type","Order Type"::Assembly);
              SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::" ");
            END;
          3:
            SETRANGE("Entry Type","Entry Type"::Revaluation);
          4:
            SETRANGE("Entry Type","Entry Type"::Rounding);
        END;
      END;
    END;

    [External]
    PROCEDURE DrillDownInvtAccrualInterim@49(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Invt. Accrual (Interim)"),ValueEntry.FIELDNO("Cost Amount (Expected)"));
    END;

    LOCAL PROCEDURE SetFiltersInvtAccrualInterim@82(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::"Direct Cost");
        SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::Purchase);
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownCOGS@48(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(InvtReportEntry,InvtReportEntry.FIELDNO(COGS),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersCOGS@83(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::"Direct Cost");
        SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::Sale);
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownCOGSInterim@47(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("COGS (Interim)"),ValueEntry.FIELDNO("Cost Amount (Expected)"));
    END;

    LOCAL PROCEDURE SetFiltersCOGSInterim@84(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETFILTER("Entry Type",'%1|%2',"Entry Type"::"Direct Cost","Entry Type"::Revaluation);
        SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::Sale);
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownWIPInventory@46(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("WIP Inventory"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersWIPInventory@85(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1002 : Record 5846);
    VAR
      Selection@1000 : Integer;
    BEGIN
      Selection := STRMENU(Text005,3);
      IF Selection = 0 THEN
        EXIT;

      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Order Type","Order Type"::Production);

        CASE Selection OF
          1:
            BEGIN
              SETRANGE("Entry Type","Entry Type"::"Direct Cost");
              SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::Consumption);
            END;
          2:
            BEGIN
              SETFILTER("Entry Type",'%1|%2',"Entry Type"::"Direct Cost","Entry Type"::"Indirect Cost");
              SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::" ");
            END;
          3:
            BEGIN
              SETFILTER("Entry Type",'%1|%2',"Entry Type"::"Direct Cost","Entry Type"::Revaluation);
              SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::Output);
            END;
        END;
      END;
    END;

    [External]
    PROCEDURE DrillDownMaterialVariance@45(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Material Variance"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersMaterialVariance@86(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::Variance);
        SETRANGE("Variance Type","Variance Type"::Material);
        SETFILTER("Item Ledger Entry Type",'%1|%2',
          "Item Ledger Entry Type"::Output,
          "Item Ledger Entry Type"::"Assembly Output");
      END;
    END;

    [External]
    PROCEDURE DrillDownCapVariance@44(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Capacity Variance"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersCapVariance@87(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::Variance);
        SETRANGE("Variance Type","Variance Type"::Capacity);
        SETFILTER("Item Ledger Entry Type",'%1|%2',
          "Item Ledger Entry Type"::Output,
          "Item Ledger Entry Type"::"Assembly Output");
      END;
    END;

    [External]
    PROCEDURE DrillDownSubcontractedVariance@43(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Subcontracted Variance"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersSubcontractedVariance@88(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::Variance);
        SETRANGE("Variance Type","Variance Type"::Subcontracted);
        SETFILTER("Item Ledger Entry Type",'%1|%2',
          "Item Ledger Entry Type"::Output,
          "Item Ledger Entry Type"::"Assembly Output");
      END;
    END;

    [External]
    PROCEDURE DrillDownCapOverheadVariance@42(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Capacity Overhead Variance"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersCapOverheadVariance@89(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::Variance);
        SETRANGE("Variance Type","Variance Type"::"Capacity Overhead");
        SETFILTER("Item Ledger Entry Type",'%1|%2',
          "Item Ledger Entry Type"::Output,
          "Item Ledger Entry Type"::"Assembly Output");
      END;
    END;

    [External]
    PROCEDURE DrillDownMfgOverheadVariance@41(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Mfg. Overhead Variance"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersMfgOverheadVariance@90(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::Variance);
        SETRANGE("Variance Type","Variance Type"::"Manufacturing Overhead");
        SETFILTER("Item Ledger Entry Type",'%1|%2',
          "Item Ledger Entry Type"::Output,
          "Item Ledger Entry Type"::"Assembly Output");
      END;
    END;

    [External]
    PROCEDURE DrillDownInventoryInterim@40(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Inventory (Interim)"),ValueEntry.FIELDNO("Cost Amount (Expected)"));
    END;

    LOCAL PROCEDURE SetFiltersInventoryInterim@91(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETFILTER("Entry Type",'%1|%2',"Entry Type"::"Direct Cost","Entry Type"::Revaluation);
        SETFILTER("Item Ledger Entry Type",'%1|%2|%3',
          "Item Ledger Entry Type"::Output,
          "Item Ledger Entry Type"::Purchase,
          "Item Ledger Entry Type"::Sale);
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownOverheadAppliedToWIP@39(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Overhead Applied WIP"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersOverheadAppliedToWIP@92(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::"Indirect Cost");
        SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::" ");
        SETRANGE("Order Type","Order Type"::Production);
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownDirectCostApplToWIP@38(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Direct Cost Applied WIP"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersDirectCostApplToWIP@93(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::"Direct Cost");
        SETRANGE("Order Type","Order Type"::Production);
        SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::" ");
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownWIPToInvtInterim@37(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("WIP To Interim"),ValueEntry.FIELDNO("Cost Amount (Expected)"));
    END;

    LOCAL PROCEDURE SetFiltersWIPToInvtInterim@94(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETFILTER("Entry Type",'%1|%2',"Entry Type"::"Direct Cost","Entry Type"::Revaluation);
        SETRANGE("Item Ledger Entry Type","Item Ledger Entry Type"::Output);
        SETRANGE("Order Type","Order Type"::Production);
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownInvtToWIP@36(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Inventory To WIP"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersInvtToWIP@95(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::"Direct Cost");
        SETRANGE("Order Type","Order Type"::Production);
        SETFILTER("Item Ledger Entry Type",'%1|%2',
          "Item Ledger Entry Type"::Output,
          "Item Ledger Entry Type"::Consumption);
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownInventory@35(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO(Inventory),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersInventory@96(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type");
        SETFILTER("Item Ledger Entry Type",'<>%1',"Item Ledger Entry Type"::" ");
        SETRANGE("Variance Type");
        SETFILTER("Item Ledger Entry Type",'<>%1',"Item Ledger Entry Type"::" ");
      END;
    END;

    [External]
    PROCEDURE DrillDownDirectCostApplied@34(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Direct Cost Applied"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersDirectCostApplied@97(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::"Direct Cost");
        SETFILTER("Item Ledger Entry Type",'%1|%2',
          "Item Ledger Entry Type"::Purchase,
          "Item Ledger Entry Type"::" ");
        SETRANGE("Variance Type");
      END;
    END;

    [External]
    PROCEDURE DrillDownOverheadApplied@27(VAR InvtReportEntry@1001 : Record 5846);
    BEGIN
      DrillDownInventoryReportEntryAmount(
        InvtReportEntry,InvtReportEntry.FIELDNO("Overhead Applied"),ValueEntry.FIELDNO("Cost Amount (Actual)"));
    END;

    LOCAL PROCEDURE SetFiltersOverheadApplied@98(VAR ValueEntry@1001 : Record 5802;VAR InvtReportEntry@1000 : Record 5846);
    BEGIN
      WITH ValueEntry DO BEGIN
        CopyFiltersFronInventoryReportLine(ValueEntry,InvtReportEntry);
        SETRANGE("Entry Type","Entry Type"::"Indirect Cost");
        SETFILTER("Item Ledger Entry Type",'%1|%2|%3|%4',
          "Item Ledger Entry Type"::Purchase,
          "Item Ledger Entry Type"::Output,
          "Item Ledger Entry Type"::"Assembly Output",
          "Item Ledger Entry Type"::" ");
        SETRANGE("Variance Type");
      END;
    END;

    LOCAL PROCEDURE DrillDownInventoryReportEntryAmount@72(VAR InvtReportEntry@1001 : Record 5846;DrillDownFieldNo@1000 : Integer;ActiveFieldNo@1002 : Integer);
    BEGIN
      IF InvtReportEntry.Type = InvtReportEntry.Type::"G/L Account" THEN
        DrillDownGL(InvtReportEntry)
      ELSE
        DrillDownInventoryReportValueEntry(InvtReportEntry,DrillDownFieldNo,ActiveFieldNo);
    END;

    LOCAL PROCEDURE DrillDownInventoryReportValueEntry@76(VAR InvtReportEntry@1001 : Record 5846;DrillDownFieldNo@1000 : Integer;ActiveFieldNo@1003 : Integer);
    VAR
      ValueEntry@1002 : Record 5802;
    BEGIN
      CASE DrillDownFieldNo OF
        InvtReportEntry.FIELDNO("Direct Cost Applied Actual"):
          SetFiltersDirectCostApplActual(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Overhead Applied Actual"):
          SetFiltersOverheadAppliedActual(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Purchase Variance"):
          SetFiltersPurchaseVariance(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Inventory Adjmt."):
          SetFiltersInventoryAdjmt(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Invt. Accrual (Interim)"):
          SetFiltersInvtAccrualInterim(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO(COGS):
          SetFiltersCOGS(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("COGS (Interim)"):
          SetFiltersCOGSInterim(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("WIP Inventory"):
          SetFiltersWIPInventory(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Material Variance"):
          SetFiltersMaterialVariance(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Capacity Variance"):
          SetFiltersCapVariance(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Subcontracted Variance"):
          SetFiltersSubcontractedVariance(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Capacity Overhead Variance"):
          SetFiltersCapOverheadVariance(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Mfg. Overhead Variance"):
          SetFiltersMfgOverheadVariance(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Inventory (Interim)"):
          SetFiltersInventoryInterim(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Overhead Applied WIP"):
          SetFiltersOverheadAppliedToWIP(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Direct Cost Applied WIP"):
          SetFiltersDirectCostApplToWIP(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("WIP To Interim"):
          SetFiltersWIPToInvtInterim(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Inventory To WIP"):
          SetFiltersInvtToWIP(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO(Inventory):
          SetFiltersInventory(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Direct Cost Applied"):
          SetFiltersDirectCostApplied(ValueEntry,InvtReportEntry);
        InvtReportEntry.FIELDNO("Overhead Applied"):
          SetFiltersOverheadApplied(ValueEntry,InvtReportEntry);
      END;

      PAGE.RUN(0,ValueEntry,ActiveFieldNo);
    END;

    [External]
    PROCEDURE SetReportHeader@13(VAR InvtReportHeader2@1000 : Record 5845);
    BEGIN
      InvtReportHeader.COPY(InvtReportHeader2);
    END;

    LOCAL PROCEDURE OpenWindow@59();
    BEGIN
      Window.OPEN(
        Text000 +
        Text001 +
        Text002 +
        Text003);
      WindowIsOpen := TRUE;
      WindowUpdateDateTime := CURRENTDATETIME;
    END;

    LOCAL PROCEDURE UpDateWindow@56(NewWindowType@1002 : Text[80];NewWindowNo@1001 : Code[20];NewWindowPostingType@1000 : Text[80]);
    BEGIN
      WindowType := NewWindowType;
      WindowNo := NewWindowNo;
      WindowPostingType := NewWindowPostingType;

      IF IsTimeForUpdate THEN BEGIN
        IF NOT WindowIsOpen THEN
          OpenWindow;
        Window.UPDATE(1,WindowType);
        Window.UPDATE(2,WindowNo);
        Window.UPDATE(3,WindowPostingType);
      END;
    END;

    LOCAL PROCEDURE IsTimeForUpdate@69() : Boolean;
    BEGIN
      IF CURRENTDATETIME - WindowUpdateDateTime >= 1000 THEN BEGIN
        WindowUpdateDateTime := CURRENTDATETIME;
        EXIT(TRUE);
      END;
      EXIT(FALSE);
    END;

    LOCAL PROCEDURE CheckExpectedCostPosting@61(VAR InventoryReportLine@1000 : Record 5846) : Boolean;
    VAR
      InvtSetup@1012 : Record 313;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        IF ("Inventory (Interim)" <> 0) OR
           ("WIP Inventory" <> 0) OR
           ("Invt. Accrual (Interim)" <> 0) OR
           ("COGS (Interim)" <> 0)
        THEN BEGIN
          InvtSetup.GET;
          "Expected Cost Posting Warning" := NOT InvtSetup."Expected Cost Posting to G/L";
          MODIFY;
          EXIT(TRUE);
        END;
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE CheckIfNoDifference@64(VAR InventoryReportLine@1000 : Record 5846) : Boolean;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        IF (Inventory = 0) AND
           ("WIP Inventory" = 0) AND
           ("Direct Cost Applied Actual" = 0) AND
           ("Overhead Applied Actual" = 0) AND
           ("Purchase Variance" = 0) AND
           ("Inventory Adjmt." = 0) AND
           ("Invt. Accrual (Interim)" = 0) AND
           (COGS = 0) AND
           ("COGS (Interim)" = 0) AND
           ("Material Variance" = 0) AND
           ("Capacity Variance" = 0) AND
           ("Subcontracted Variance" = 0) AND
           ("Capacity Overhead Variance" = 0) AND
           ("Mfg. Overhead Variance" = 0) AND
           ("Direct Cost Applied WIP" = 0) AND
           ("Overhead Applied WIP" = 0) AND
           ("Inventory To WIP" = 0) AND
           ("WIP To Interim" = 0) AND
           ("Direct Cost Applied" = 0) AND
           ("Overhead Applied" = 0)
        THEN
          EXIT(TRUE);
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE CheckCostIsPostedToGL@65(VAR InventoryReportLine@1000 : Record 5846) : Boolean;
    VAR
      ValueEntry@1001 : Record 5802;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        ValueEntry.SETCURRENTKEY("Item No.","Posting Date");
        IF ValueEntry.FINDFIRST THEN
          REPEAT
            ValueEntry.SETRANGE("Item No.",ValueEntry."Item No.");
            ValueEntry.SETRANGE("Posting Date",ValueEntry."Posting Date");
            IF ValueEntryInFilteredSet(ValueEntry,InvtReportHeader,FALSE) THEN
              REPEAT
                ValueEntry.SETRANGE("Entry Type",ValueEntry."Entry Type");
                ValueEntry.SETRANGE("Item Ledger Entry Type",ValueEntry."Item Ledger Entry Type");
                ValueEntry.SETRANGE("Location Code",ValueEntry."Location Code");
                ValueEntry.SETRANGE("Variance Type",ValueEntry."Variance Type");

                IF ValueEntryInFilteredSet(ValueEntry,InvtReportHeader,TRUE) THEN BEGIN
                  ValueEntry.SETRANGE("Cost Posted to G/L",0);
                  ValueEntry.SETFILTER("Cost Amount (Actual)",'<>%1',0);
                  IF ValueEntry.FINDLAST THEN BEGIN
                    "Cost is Posted to G/L Warning" := TRUE;
                    MODIFY;
                    EXIT(TRUE);
                  END;
                  ValueEntry.SETRANGE("Cost Posted to G/L");
                  ValueEntry.SETRANGE("Cost Amount (Actual)");
                END;
                ValueEntry.FINDLAST;
                ValueEntry.SETRANGE("Entry Type");
                ValueEntry.SETRANGE("Item Ledger Entry Type");
                ValueEntry.SETRANGE("Location Code");
                ValueEntry.SETRANGE("Variance Type");
              UNTIL ValueEntry.NEXT = 0;

            IF ValueEntry.FINDLAST THEN;
            ValueEntry.SETRANGE("Item No.");
            ValueEntry.SETRANGE("Posting Date");
          UNTIL ValueEntry.NEXT = 0;
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE CheckValueGLCompression@66(VAR InventoryReportLine@1000 : Record 5846) : Boolean;
    VAR
      DateComprRegister@1010 : Record 87;
      InStartDateCompr@1003 : Boolean;
      InEndDateCompr@1002 : Boolean;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        DateComprRegister.SETCURRENTKEY("Table ID");
        DateComprRegister.SETFILTER("Table ID",'%1|%2',DATABASE::"Value Entry",DATABASE::"G/L Entry");
        DateComprRegister.SETFILTER("Starting Date",InvtReportHeader.GETFILTER("Posting Date Filter"));
        InStartDateCompr := DateComprRegister.FINDFIRST;
        DateComprRegister.SETFILTER("Ending Date",InvtReportHeader.GETFILTER("Posting Date Filter"));
        InEndDateCompr := DateComprRegister.FINDFIRST;
        IF InEndDateCompr OR InStartDateCompr THEN BEGIN
          "Compression Warning" := TRUE;
          MODIFY;
          EXIT(TRUE);
        END;
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE CheckGLClosingOverlaps@67(VAR InventoryReportLine@1000 : Record 5846) : Boolean;
    VAR
      AccountingPeriod@1006 : Record 50;
      GLEntry@1005 : Record 17;
      MinDate@1001 : Date;
      found@1002 : Boolean;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        IF NOT (("Direct Cost Applied Actual" = 0) AND
                ("Overhead Applied Actual" = 0) AND
                ("Purchase Variance" = 0) AND
                ("Inventory Adjmt." = 0) AND
                (COGS = 0) AND
                ("Material Variance" = 0) AND
                ("Capacity Variance" = 0) AND
                ("Subcontracted Variance" = 0) AND
                ("Capacity Overhead Variance" = 0) AND
                ("Mfg. Overhead Variance" = 0) AND
                ("Direct Cost Applied WIP" = 0) AND
                ("Overhead Applied WIP" = 0) AND
                ("Inventory To WIP" = 0) AND
                ("Direct Cost Applied" = 0) AND
                ("Overhead Applied" = 0))
        THEN BEGIN
          IF AccountingPeriod.ISEMPTY THEN
            EXIT(FALSE);

          AccountingPeriod.SETFILTER("Starting Date",InvtReportHeader.GETFILTER("Posting Date Filter"));
          IF InvtReportHeader.GETFILTER("Posting Date Filter") <> '' THEN
            MinDate := InvtReportHeader.GETRANGEMIN("Posting Date Filter")
          ELSE
            MinDate := 0D;

          found :=
            AccountingPeriod.FIND('-') AND AccountingPeriod.Closed AND
            (AccountingPeriod."Starting Date" <= MinDate);
          IF AccountingPeriod."Starting Date" > MinDate THEN BEGIN
            AccountingPeriod.SETRANGE("Starting Date");
            IF NOT found THEN
              found :=
                AccountingPeriod.NEXT(-1) <> 0;
            IF NOT found THEN
              found := AccountingPeriod.Closed;
          END;
          IF found THEN
            REPEAT
              REPEAT
              UNTIL (AccountingPeriod.NEXT = 0) OR AccountingPeriod."New Fiscal Year";
              IF AccountingPeriod."New Fiscal Year" THEN
                AccountingPeriod."Starting Date" := CLOSINGDATE(CALCDATE('<-1D>',AccountingPeriod."Starting Date"))
              ELSE
                AccountingPeriod."Starting Date" := CLOSINGDATE(AccountingPeriod."Starting Date");
              AccountingPeriod.SETFILTER("Starting Date",InvtReportHeader.GETFILTER("Posting Date Filter"));
              GLEntry.SETRANGE("Posting Date",AccountingPeriod."Starting Date");
              IF NOT GLEntry.ISEMPTY THEN BEGIN
                "Closing Period Overlap Warning" := TRUE;
                MODIFY;
                EXIT(TRUE);
              END;
              AccountingPeriod.SETRANGE(Closed,TRUE);
            UNTIL AccountingPeriod.NEXT = 0;
        END;
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE CheckDeletedGLAcc@68(VAR InventoryReportLine@1000 : Record 5846) : Boolean;
    VAR
      GLEntry@1004 : Record 17;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        GLEntry.RESET;
        GLEntry.SETCURRENTKEY("G/L Account No.","Posting Date");
        GLEntry.SETRANGE("G/L Account No.",'');
        GLEntry.SETFILTER("Posting Date",InvtReportHeader.GETFILTER("Posting Date Filter"));
        IF GLEntry.FINDFIRST THEN BEGIN
          "Deleted G/L Accounts Warning" := TRUE;
          MODIFY;
          EXIT(TRUE);
        END;
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE CheckPostingDateToGLNotTheSame@70(VAR InventoryReportLine@1000 : Record 5846) : Boolean;
    VAR
      ValueEntry@1002 : Record 5802;
      InvtPostingSetup@1003 : Record 5813;
      TempInvtPostingSetup@1004 : TEMPORARY Record 5813;
      TotalInventory@1001 : Decimal;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        ValueEntry.RESET;
        ValueEntry.SETCURRENTKEY("Item No.");
        IF ValueEntry.FINDFIRST THEN
          REPEAT
            ValueEntry.SETRANGE("Item No.",ValueEntry."Item No.");
            IF ValueEntry."Item No." <> '' THEN
              TotalInventory := TotalInventory + CalcInventory(ValueEntry);
            ValueEntry.FINDLAST;
            ValueEntry.SETRANGE("Item No.");
          UNTIL ValueEntry.NEXT = 0;

        IF InvtPostingSetup.FIND('-') THEN
          REPEAT
            TempInvtPostingSetup.RESET;
            TempInvtPostingSetup.SETRANGE("Inventory Account",InvtPostingSetup."Inventory Account");
            IF NOT TempInvtPostingSetup.FINDFIRST THEN
              IF GLAcc.GET(InvtPostingSetup."Inventory Account") THEN
                TotalInventory := TotalInventory - CalcGLAccount(GLAcc);
            TempInvtPostingSetup := InvtPostingSetup;
            TempInvtPostingSetup.INSERT;
          UNTIL InvtPostingSetup.NEXT = 0;
        IF TotalInventory = 0 THEN BEGIN
          "Posting Date Warning" := TRUE;
          MODIFY;
          EXIT(TRUE);
        END;
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE CheckDirectPostings@71(VAR InventoryReportLine@1000 : Record 5846) : Boolean;
    BEGIN
      WITH InventoryReportLine DO BEGIN
        IF Inventory +
           "Inventory (Interim)" +
           "WIP Inventory" +
           "Direct Cost Applied Actual" +
           "Overhead Applied Actual" +
           "Purchase Variance" +
           "Inventory Adjmt." +
           "Invt. Accrual (Interim)" +
           COGS +
           "COGS (Interim)" +
           "Material Variance" +
           "Capacity Variance" +
           "Subcontracted Variance" +
           "Capacity Overhead Variance" +
           "Mfg. Overhead Variance" +
           "Direct Cost Applied WIP" +
           "Overhead Applied WIP" +
           "Direct Cost Applied" +
           "Overhead Applied" <>
           0
        THEN BEGIN
          "Direct Postings Warning" := TRUE;
          MODIFY;
          EXIT(TRUE);
        END;
        EXIT(FALSE);
      END;
    END;

    BEGIN
    END.
  }
}

