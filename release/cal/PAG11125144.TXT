OBJECT Page 11125144 Service Object
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Object;
               NOR=Objekt;
               SVE=Objekt];
    SourceTable=Table11071691;
    PageType=Card;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Object;
                                NOR=Ny,Prosesser,Rapporter,Objekt;
                                SVE=Ny,Behandla,Rapport,Objekt];
    OnInit=VAR
             ServiceSetup@1100528600 : Record 11012800;
           BEGIN
             ServiceSetup.GET;
             BrandCodeEditable := NOT ServiceSetup."Sync. Object Brand/Model/Type";
             ModelCodeEditable := NOT ServiceSetup."Sync. Object Brand/Model/Type";
             TypeCodeEditable := NOT ServiceSetup."Sync. Object Brand/Model/Type";
           END;

    OnOpenPage=BEGIN
                 CurrPage.ObjSpecLinesCompressedPage.PAGE.SetSelection("No.");
               END;

    OnAfterGetRecord=VAR
                       lvRelObjRec@1100526200 : Record 11071704;
                       ServiceObjectInfoMgt@1100525000 : Codeunit 11012840;
                       lvNoRecordsInt@1100526201 : Integer;
                       Source@1100528800 : 'ServiceLocation,ServiceObject';
                     BEGIN
                       CurrPage.PurchaseLineServiceObjectFactbox.PAGE.SetSource(Source::ServiceObject, "No.");
                       MaintenanceManagementCU.GetNextStartingDateByObject(Rec, gvNextDate, gvNextOrderCde);

                       lvRelObjRec.SETRANGE("Object No.","No.");
                       lvNoRecordsInt := lvRelObjRec.COUNT;
                       IF lvNoRecordsInt = 1 THEN BEGIN
                         lvRelObjRec.FINDFIRST;
                         gvNoRelationsCde := lvRelObjRec."Related Object";
                         lvRelObjRec.CALCFIELDS("Related Standard Object","Standard Object Description");
                         gvRelationNameTxt := lvRelObjRec."Standard Object Description";
                       END ELSE BEGIN
                         IF lvNoRecordsInt = 0 THEN BEGIN
                           gvRelationNameTxt := '';
                           gvNoRelationsCde := '';
                         END ELSE BEGIN
                           gvRelationNameTxt := Text000;
                           gvNoRelationsCde := STRSUBSTNO('[%1]', lvNoRecordsInt);
                         END;
                       END;
                       CurrPage.ObjSpecLinesCompressedPage.PAGE.SetSelection("No.");

                       ServiceObjectInfoMgt.GetBuildingInfo("No.", BuildingCode, BuildingDescription);
                       SetFieldsEditable;

                       ConditionMeasurementDate := TODAY;
                       ConditionScore := NEN2767Management.GetObjectConditionScore("No.", ConditionMeasurementDate);

                       PreferredBuildingCode := GetPreferredBuildingCode;
                       IF NOT BuildingRec.GET(PreferredBuildingCode) THEN
                         BuildingRec.INIT;

                       ComplexCode := GetComplexCode(PreferredBuildingCode);
                       IF NOT Complex.GET(ComplexCode) THEN
                         CLEAR(Complex);

                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  IF gvLocCde <> '' THEN
                    "Service Location No." := gvLocCde;
                  SetFieldsEditable;
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525015;1 ;ActionGroup;
                      CaptionML=[ENU=Object;
                                 NOR=Objekt;
                                 SVE=Objekt] }
      { 1100528604;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(ServObject),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1100526202;2 ;Action    ;
                      CaptionML=[ENU=Related Objects;
                                 NOR=Relaterte objekter;
                                 SVE=Relaterade objekt];
                      RunObject=Page 11125170;
                      RunPageLink=Object No.=FIELD(No.);
                      Visible=false;
                      Image=SuggestCapacity }
      { 1100525008;2 ;Action    ;
                      CaptionML=[ENU=Building Relations;
                                 NOR=Byggrelasjoner;
                                 SVE=Byggrelationer];
                      Visible=false;
                      Image=Relationship;
                      OnAction=BEGIN
                                 ShowBuildingRelations;
                               END;
                                }
      { 1100528623;2 ;Action    ;
                      CaptionML=[ENU=Subcontractors;
                                 NOR=Underentrepenõrer;
                                 SVE=Underentreprenîrer];
                      RunObject=Page 11126097;
                      RunPageLink=Service Contract No.=CONST(),
                                  Service Location No.=CONST(),
                                  Object No.=FIELD(No.),
                                  Maintenance Scheme Code=CONST();
                      Image=SubcontractingWorksheet }
      { 1100526214;2 ;Action    ;
                      CaptionML=[ENU=Replacement Activitities;
                                 NOR=Erstatningsaktiviteter;
                                 SVE=ErsÑttningsaktiviteter];
                      Visible=false;
                      Image=MaintenanceRegistrations;
                      OnAction=VAR
                                 MaintenanceSchemeVersion@1100528602 : Record 11071743;
                               BEGIN
                                 MaintenanceSchemeVersion.SETRANGE("Line Type", MaintenanceSchemeVersion."Line Type"::"Object Installation");
                                 MaintenanceSchemeVersion.SETRANGE(Code,"No.");
                                 PAGE.RUNMODAL(0, MaintenanceSchemeVersion);
                               END;
                                }
      { 1100528627;2 ;Action    ;
                      CaptionML=[ENU=Do&cuments;
                                 NOR=Do&kumenter;
                                 SVE=Do&kument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowDocuments;
                               END;
                                }
      { 1100526220;2 ;Action    ;
                      CaptionML=[ENU=Material Inventory;
                                 NOR=Materialelager;
                                 SVE=Materiallager];
                      RunObject=Page 11125181;
                      RunPageLink=Code=FIELD(No.);
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Components;
                      PromotedCategory=Category4 }
      { 1100528613;2 ;Action    ;
                      CaptionML=[ENU=&Inspection (Calls);
                                 NOR=&Inspeksjon (Samtaler);
                                 SVE=&Inspektion (samtal)];
                      RunObject=Page 11125257;
                      RunPageView=SORTING(Inspection Type,Service Contract No.,Code,Belongs to Scheme,Belongs to Base Insp. List,Index Date);
                      RunPageLink=Inspection Type=CONST("Object (Calls)"),
                                  Service Contract No.=CONST(''),
                                  Code=FIELD(No.),
                                  Belongs to Scheme=CONST(''),
                                  Belongs to Base Insp. List=CONST('');
                      Image=CheckRulesSyntax }
      { 1210190002;2 ;Action    ;
                      CaptionML=[ENU=Object Specifications;
                                 NOR=Objektspesifikasjoner;
                                 SVE=Objektspecifikationer];
                      Promoted=Yes;
                      Image=LotInfo;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ObjectSpecificationLine@1210190000 : Record 11071781;
                               BEGIN
                                 ObjectSpecificationLine.SETRANGE("Specification Type", ObjectSpecificationLine."Specification Type"::Object);
                                 ObjectSpecificationLine.SETRANGE(Code, "No.");
                                 PAGE.RUNMODAL(0, ObjectSpecificationLine);
                               END;
                                }
      { 1100528800;2 ;Action    ;
                      CaptionML=[ENU=&Meter Reading;
                                 SVE=MÑtarstÑllning];
                      RunObject=Page 11126475;
                      RunPageOnRec=Yes;
                      Visible=false;
                      Image=WorkCenterLoad }
      { 1100528801;2 ;Action    ;
                      CaptionML=[ENU=Object Consumption Components;
                                 SVE=Objektets fîrbrukningskomponenter];
                      Visible=false;
                      Image=MachineCenter;
                      OnAction=VAR
                                 ObjectConsumptionComponent@1100528800 : Record 11071969;
                                 ObjectConsumptionComponents@1100528801 : Page 11126476;
                               BEGIN
                                 TESTFIELD("No.");
                                 ObjectConsumptionComponent.FILTERGROUP(9);
                                 ObjectConsumptionComponent.SETRANGE("Standard Object", '');
                                 ObjectConsumptionComponent.SETRANGE("Service Object Group", '');
                                 ObjectConsumptionComponent.FILTERGROUP(0);
                                 ObjectConsumptionComponent.SETRANGE("Object No.", "No.");
                                 ObjectConsumptionComponents.SETTABLEVIEW(ObjectConsumptionComponent);
                                 ObjectConsumptionComponent."Object No." := "No.";
                                 ObjectConsumptionComponents.SETRECORD(ObjectConsumptionComponent);
                                 ObjectConsumptionComponents.SetCalledFromPage(11125144);
                                 ObjectConsumptionComponents.RUNMODAL;
                               END;
                                }
      { 1100528803;2 ;Action    ;
                      Name=IoT Thresholds;
                      CaptionML=[ENU=IoT Thresholds;
                                 SVE=IoT-trîskel];
                      RunObject=Page 11130765;
                      RunPageLink=Service Object=FIELD(No.);
                      Visible=false;
                      Image=AdjustEntries }
      { 1100528500;2 ;Action    ;
                      CaptionML=[ENU=Defects and Measures;
                                 SVE=Defekter och mÜtt];
                      RunObject=Page 11128796;
                      RunPageLink=Object No.=FIELD(No.),
                                  Location Type=CONST(Service Location);
                      Visible=false;
                      Image=ServiceLines }
      { 1100528300;2 ;Action    ;
                      CaptionML=ENU=Reference Points;
                      Promoted=Yes;
                      Image=EntriesList;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 DocumentReferencePointsFRM@1100528600 : Page 11020345;
                               BEGIN
                                 DocumentReferencePointsFRM.SetServiceObjectNo("No.");
                                 DocumentReferencePointsFRM.RUN;
                               END;
                                }
      { 1100525022;1 ;ActionGroup;
                      CaptionML=[ENU=Bing Maps;
                                 NOR=Bing-kart;
                                 SVE=Bing Maps];
                      Visible=FALSE }
      { 1100525018;2 ;Action    ;
                      Name=Show Object on Map;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=[ENU=Show Object on Map;
                                 SVE=Visa objektet pÜ kartan];
                      Visible=(Latitude <> '') AND (Longitude <> '');
                      Image=Map;
                      OnAction=VAR
                                 BingMaps@1100525000 : Page 11229927;
                               BEGIN
                                 BingMaps.setServiceObject(Rec);
                                 BingMaps.RUNMODAL;
                               END;
                                }
      { 1100525019;2 ;Action    ;
                      Name=Set GPS Coordinates;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=[ENU=Set GPS Coordinates;
                                 SVE=SÑtt GPS-kordinater];
                      Visible=(Latitude = '') OR (Longitude = '');
                      Image=MapSetup;
                      OnAction=VAR
                                 BingMapsHandler@1100525002 : Codeunit 11012485;
                                 TempLatitude@1100525001 : Text[255];
                                 TempLongitude@1100525000 : Text[255];
                               BEGIN
                                 CALCFIELDS("Location Address", "Location City", "Location Post Code");
                                 IF BingMapsHandler.GetLatLngFromAddress(TempLatitude, TempLongitude, "Location Address", "Location City", "Location Post Code") THEN BEGIN
                                   Latitude := TempLatitude;
                                   Longitude := TempLongitude;
                                   MODIFY;
                                   CurrPage.UPDATE;
                                 END
                                 ELSE
                                   MESSAGE(Text001);
                               END;
                                }
      { 1100525020;2 ;Action    ;
                      Name=Add Object Manually on Map;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=[ENU=Add Object Manually on Map;
                                 SVE=LÑgg till objekt pÜ kartan manuellt];
                      Visible=(Latitude = '') OR (Longitude = '');
                      Image=MapSetup;
                      OnAction=VAR
                                 BingMaps@1100525000 : Page 11229937;
                               BEGIN
                                 BingMaps.setInformation("No.", Description, DATABASE::"Service-Object", '');
                                 BingMaps.RUNMODAL;
                               END;
                                }
      { 1100525023;2 ;Action    ;
                      Name=Show Objects on Map;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=[ENU=Show Location and Objects on Map;
                                 SVE=Visa platser och objektet pÜ kartan];
                      Visible=(Latitude <> '') AND (Longitude <> '');
                      Image=Map;
                      OnAction=VAR
                                 BingMapsLocationObjects@1100525000 : Page 11229929;
                                 ServiceLocation@1100525001 : Record 11012801;
                               BEGIN
                                 IF ServiceLocation.GET("Service Location No.") THEN BEGIN
                                   BingMapsLocationObjects.SetServiceLocation(ServiceLocation);
                                   BingMapsLocationObjects.UseRelatedServiceObjects;
                                   BingMapsLocationObjects.RUNMODAL;
                                 END
                                 ELSE
                                   MESSAGE(Text002);
                               END;
                                }
      { 1210190003;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100525037;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=Fu&nksjon;
                                 SVE=F&unktioner] }
      { 1100528645;2 ;ActionGroup;
                      CaptionML=[ENU=Picture;
                                 NOR=Bilde;
                                 SVE=Bild];
                      Image=Picture }
      { 1100528628;3 ;Action    ;
                      CaptionML=[ENU=Change;
                                 SVE=éndra];
                      Image=Change;
                      OnAction=BEGIN
                                 SelectAndAddPicture;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100528646;3 ;Action    ;
                      CaptionML=[ENU=Delete;
                                 NOR=Fjern;
                                 SVE=Ta bort];
                      Image=Delete;
                      OnAction=BEGIN
                                 RemovePicture;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100525038;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Maintenance Proposal;
                                 NOR=Opprett vedlikeholdsforslag;
                                 SVE=Skapa underhÜllsfîrslag];
                      Promoted=Yes;
                      Image=MaintenanceRegistrations;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lvObjectRec@1100525000 : Record 11071691;
                                 lvCreateMaintRep@1100525001 : Report 11012865;
                               BEGIN
                                 lvObjectRec.SETRANGE("No.","No.");
                                 lvCreateMaintRep.SETTABLEVIEW(lvObjectRec);
                                 lvCreateMaintRep.RUNMODAL;
                               END;
                                }
      { 1100528641;2 ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NOR=KOPIER;
                                 SVE=Kopiera];
                      Image=Copy;
                      OnAction=VAR
                                 CopyServiceObject@1100528600 : Page 11229254;
                               BEGIN
                                 CopyServiceObject.SetDefaults("No.");
                                 CopyServiceObject.StdDialogRunModal;
                               END;
                                }
      { 1100528605;2 ;Action    ;
                      ShortCutKey=Ctrl+K;
                      CaptionML=[ENU=Completeness Check;
                                 NOR=Fullstendighetskontroll;
                                 SVE=FullstÑndighetskontroll];
                      Image=CheckList;
                      OnAction=VAR
                                 CompletionCheckManagement@1100528600 : Codeunit 11012252;
                                 RecRef@1100528601 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 CompletionCheckManagement.ShowIncompleteFields(RecRef);
                               END;
                                }
      { 1100529603;2 ;Action    ;
                      Name=Replace Object;
                      CaptionML=ENU=Replace Object;
                      Visible=FALSE;
                      Image=CopyFromTask;
                      OnAction=VAR
                                 LocServiceObject@1100529600 : Record 11071691;
                                 PageReplaceObject@1100529601 : Page 11127082;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(LocServiceObject);
                                 PageReplaceObject.SetServiceObject(LocServiceObject);
                                 PageReplaceObject.RUNMODAL;
                               END;
                                }
      { 1100525013;1 ;Action    ;
                      CaptionML=[ENU=&Print;
                                 NOR=Skriv &ut;
                                 SVE=Skriv &ut];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 DocumentPrint@1100525000 : Codeunit 229;
                               BEGIN
                                 DocumentPrint.PrintServiceObjectList(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100525000;1;Group  ;
                CaptionML=[ENU=General;
                           NOR=Generell;
                           SVE=AllmÑnt] }

    { 1100525001;2;Field  ;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1100525003;2;Field  ;
                SourceExpr="Standard Object No.";
                OnValidate=BEGIN
                             StandardObjectNoOnAfterValidat;
                           END;
                            }

    { 1100525011;2;Field  ;
                DrillDown=No;
                SourceExpr="Standard Object Description" }

    { 1100528643;2;Field  ;
                DrillDown=No;
                SourceExpr="Standard Object Description 2";
                Importance=Additional;
                Visible=FALSE }

    { 1100528615;2;Field  ;
                SourceExpr=Description }

    { 1100528642;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE }

    { 1100525012;2;Field  ;
                SourceExpr="Service Location No.";
                Editable=ServiceLocationNoEditable;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             SetFieldsEditable;
                           END;
                            }

    { 1210190007;2;Field  ;
                SourceExpr="Location Description" }

    { 1100526223;2;Field  ;
                SourceExpr="Location Address" }

    { 1100526225;2;Field  ;
                SourceExpr="Location Address 2";
                Importance=Additional;
                Visible=FALSE }

    { 1100526231;2;Field  ;
                SourceExpr="Location Post Code" }

    { 1100526227;2;Field  ;
                SourceExpr="Location City" }

    { 1100529400;2;Field  ;
                SourceExpr=Latitude;
                Importance=Additional;
                Visible=FALSE }

    { 1100529401;2;Field  ;
                SourceExpr=Longitude;
                Importance=Additional;
                Visible=FALSE }

    { 1100526229;2;Field  ;
                SourceExpr="Location Contact Name";
                Importance=Additional;
                Visible=FALSE }

    { 1100525052;2;Field  ;
                SourceExpr="Customer Feature";
                Visible=FALse }

    { 1100525039;2;Field  ;
                Lookup=No;
                CaptionML=[ENU=Preferred Employee;
                           NOR=Foretrukket Ansatt;
                           SVE=Fîrvald &anstÑlld];
                SourceExpr=PreferredEmployeeNo;
                Visible=FALSE;
                Editable=FALSE;
                OnAssistEdit=VAR
                               PreferredEmployee@1100525000 : Record 11012843;
                             BEGIN
                               PreferredEmployee.AssistEditPreferredEmployee('', '', "No.", '', '');
                               CurrPage.UPDATE(TRUE);
                             END;
                              }

    { 1100525041;2;Field  ;
                CaptionML=[ENU=Name Preferred Employee;
                           NOR=Navn pÜ Foretrukket Ansatt;
                           SVE=Namn pÂ fˆrvald anst‰lld];
                SourceExpr=PreferredEmployeeName;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528624;2;Field  ;
                CaptionML=[ENU=Subcontractor;
                           NOR=Underentreprenõr;
                           SVE=Underentreprenîr];
                SourceExpr=SubcontractorCode;
                Visible=FALSE;
                Editable=FALSE;
                OnAssistEdit=VAR
                               SubcontractorService@1100528601 : Record 11071789;
                             BEGIN
                               SubcontractorService.AssistEditSubcontractors('', '', "No.", '');
                               SubcontractorCode := SubcontractorService.GetSubcontractorForDisplay('', '', "No.", '', SubcontractorName);
                             END;
                              }

    { 1100528626;2;Field  ;
                CaptionML=[ENU=Subcontractor Name;
                           NOR=Underentreprenõrens navn;
                           SVE=Underentreprenîrens namn];
                SourceExpr=SubcontractorName;
                Visible=FALSE;
                Editable=FALSE }

    { 1100526203;2;Field  ;
                CaptionML=[ENU=Related Objects;
                           NOR=Relaterte objekter;
                           SVE=Relaterade objekt];
                SourceExpr=gvNoRelationsCde;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE;
                OnDrillDown=VAR
                              RelatedObject@1100526200 : Record 11071704;
                            BEGIN
                              //mg.sn, 06-01-11: M24867
                              RelatedObject.SETRANGE("Object No.", "No.");
                              PAGE.RUNMODAL(PAGE::"Related Objects", RelatedObject);
                              CurrPage.UPDATE;
                              //mg.en, 06-01-11: M24867
                            END;
                             }

    { 1100526205;2;Field  ;
                CaptionML=[ENU=Object Relation Name;
                           NOR=Objektrelasjonsnavn;
                           SVE=Objektrelationsnamn];
                SourceExpr=gvRelationNameTxt;
                Visible=FALSE;
                Editable=FALSE }

    { 1100525005;2;Field  ;
                CaptionML=[ENU=Building;
                           NOR=Byggning;
                           SVE=Byggnad];
                SourceExpr=BuildingCode;
                Visible=FALSE;
                Editable=FALSE;
                OnValidate=BEGIN
                             SetFieldsEditable;
                           END;

                OnDrillDown=BEGIN
                              ShowBuildingRelations;
                              CurrPage.UPDATE;
                            END;
                             }

    { 1100525006;2;Field  ;
                CaptionML=[ENU=Building Description;
                           NOR=Beskrivelse Bygning;
                           SVE=Beskrivning Byggnad];
                SourceExpr=BuildingDescription;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528637;2;Field  ;
                SourceExpr="Brand Code";
                Importance=Additional;
                Editable=BrandCodeEditable }

    { 1100525007;2;Field  ;
                DrillDown=No;
                SourceExpr="Brand Description";
                Importance=Additional }

    { 1100528638;2;Field  ;
                SourceExpr="Model Code";
                Importance=Additional;
                Editable=ModelCodeEditable }

    { 1100525027;2;Field  ;
                DrillDown=No;
                SourceExpr="Model Description";
                Importance=Additional }

    { 1100528639;2;Field  ;
                SourceExpr="Type Code";
                Importance=Additional;
                Editable=TypeCodeEditable }

    { 1100525025;2;Field  ;
                DrillDown=No;
                SourceExpr="Type Description";
                Importance=Additional }

    { 1100525042;2;Field  ;
                SourceExpr=Building;
                Visible=FALSE }

    { 1100525044;2;Field  ;
                SourceExpr=Floor }

    { 1100525046;2;Field  ;
                SourceExpr=Room }

    { 1100526206;2;Field  ;
                CaptionML=[ENU=Actual Contract;
                           NOR=Reell kontrakt;
                           SVE=Verkligt kontrakt];
                SourceExpr=MaintenanceManagementCU.GetActualContractsForObject("No.",TODAY);
                OnDrillDown=BEGIN
                              MaintenanceManagementCU.ShowActualContractsForObject("No.", '', TODAY(), FALSE, '');
                            END;
                             }

    { 1100528600;2;Field  ;
                Lookup=No;
                DrillDown=No;
                SourceExpr=Discipline }

    { 1100528602;2;Field  ;
                Lookup=No;
                DrillDown=No;
                SourceExpr="Trade Speciality";
                Visible=FALSE }

    { 1100525009;2;Field  ;
                SourceExpr="In use since" }

    { 1210190000;2;Field  ;
                SourceExpr="Object Customer" }

    { 1100528647;2;Field  ;
                SourceExpr="Quantity Based on";
                Importance=Additional }

    { 1100528617;2;Field  ;
                SourceExpr=Quantity;
                Editable="Quantity Based on" = "Quantity Based on"::"Service Object" }

    { 1100525016;2;Field  ;
                SourceExpr=Subcontracting;
                Visible=FALSE }

    { 1100528621;2;Field  ;
                SourceExpr=Blocked }

    { 1100528618;2;Field  ;
                SourceExpr="Ending Date" }

    { 1100528612;2;Field  ;
                SourceExpr=Status;
                Visible=FALSE }

    { 1100529600;2;Field  ;
                Name=Complex;
                CaptionML=[ENU=Complex Code;
                           NOR=Komplekskode;
                           SVE=Servicekomplexkod];
                SourceExpr=ComplexCode;
                TableRelation=Complex;
                Visible=FALSE;
                Editable=FALSE }

    { 1100529602;2;Field  ;
                Name=ComplexDescription;
                CaptionML=[ENU=Complex Description;
                           NOR=Kompleksbeskrivelse;
                           SVE=Komplexbeskrivning];
                SourceExpr=Complex.Description;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528620;1;Part   ;
                Name=ObjSpecLinesCompressedPage;
                CaptionML=[ENU=All Specification Lines;
                           NOR=Alle spesifikasjonsrader;
                           SVE=Alla specifikationsrader];
                SubPageView=SORTING(Service Order No.,Service Object No.,Specification Group Code,Line No.)
                            ORDER(Ascending);
                PagePartID=Page11126089;
                PartType=Page }

    { 1100528614;1;Group  ;
                CaptionML=[ENU=Building;
                           NOR=Byggning;
                           SVE=Byggnad];
                GroupType=Group }

    { 1100528629;2;Field  ;
                CaptionML=[ENU=Preferred Building Code;
                           SVE=Serviceplatsnr];
                SourceExpr=PreferredBuildingCode;
                TableRelation=Building;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528630;2;Field  ;
                CaptionML=[ENU=Description (Building);
                           SVE=Serviceplatsbeskrivning];
                SourceExpr=BuildingRec.Description;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528632;2;Field  ;
                CaptionML=[ENU=Address (Building);
                           NOR=Adresse (bygning);
                           SVE=Adress];
                SourceExpr=BuildingRec.Address;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528634;2;Field  ;
                CaptionML=[ENU=Address 2 (Building);
                           NOR=Adresse 2 (bygning);
                           SVE=Adress 2];
                SourceExpr=BuildingRec."Address 2";
                Visible=FALSE;
                Editable=FALSE }

    { 1100528635;2;Field  ;
                CaptionML=[ENU=Post Code (Building);
                           NOR=Postnummer (bygning);
                           SVE=Postnr];
                SourceExpr=BuildingRec."Post Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1100528636;2;Field  ;
                CaptionML=[ENU=City (Building);
                           NOR=Poststed (bygning);
                           SVE=Ort];
                SourceExpr=BuildingRec.City;
                Visible=FALSE;
                Editable=FALSE }

    { 1907507401;1;Group  ;
                CaptionML=[ENU=Warranty;
                           NOR=Garanti;
                           SVE=Garanti] }

    { 1100525021;2;Field  ;
                SourceExpr="Warranty Code Customer";
                OnValidate=BEGIN
                             WarrantyCodeOnAfterValidate;
                           END;
                            }

    { 1100525017;2;Field  ;
                SourceExpr="Warranty Starting Date Cust.";
                OnValidate=BEGIN
                             WarrantyCodeOnAfterValidate;
                           END;
                            }

    { 1101528603;2;Field  ;
                SourceExpr="Warranty Exp. Date Customer" }

    { 1100409000;2;Field  ;
                SourceExpr="Warranty Code Vendor";
                Visible=FALSE }

    { 1100409001;2;Field  ;
                SourceExpr="Warranty Starting Date Vendor";
                Visible=FALSE }

    { 1101528605;2;Field  ;
                SourceExpr="Warranty Exp. Date Vendor";
                Visible=FALSE }

    { 1100528640;2;Field  ;
                SourceExpr="Vendor No.";
                Visible=FALSE }

    { 1101528601;2;Field  ;
                SourceExpr="Bill-to Vendor No.";
                Visible=FALSE }

    { 1902811901;1;Group  ;
                CaptionML=[ENU=Replacement;
                           NOR=Erstatning;
                           SVE=ErsÑttning];
                GroupType=Group }

    { 1100526210;2;Field  ;
                SourceExpr="Replace from";
                Visible=FALSE }

    { 1100526212;2;Field  ;
                SourceExpr="Replace with Standard Object";
                Visible=FALSE }

    { 1100526217;2;Field  ;
                SourceExpr="Replaced by";
                Visible=FALSE }

    { 1210190005;2;Field  ;
                SourceExpr=Replaces;
                Visible=FALSE }

    { 1100528601;1;Group  ;
                CaptionML=[ENU=NEN2767;
                           NOR=NEN2767;
                           SVE=NEN2767];
                GroupType=Group }

    { 1100528603;2;Field  ;
                SourceExpr="NEN2767 Element Code";
                Visible=FALSE }

    { 1100528607;2;Field  ;
                CaptionML=[ENU=Replacement Value;
                           NOR=Erstatningsverdi;
                           SVE=ErsÑttningsvÑrde];
                SourceExpr=NEN2767Management.GetReplacementValue("No.", TODAY, ReplacementValueDate);
                Visible=FALSE;
                OnLookup=BEGIN
                           NEN2767Management.ShowReplacementValues("No.");
                         END;
                          }

    { 1100528609;2;Field  ;
                SourceExpr="Desired Condition Score";
                Visible=FALSE }

    { 1100528611;2;Field  ;
                CaptionML=[ENU=Current Condition Score;
                           NOR=Gjeldende tilstandspoengsum;
                           SVE=Nuvarande tillstÜndspoÑng];
                OptionCaptionML=[ENU=" ,1,2,3,4,5,6";
                                 NOR=" ,1,2,3,4,5,6";
                                 SVE=" ,1,2,3,4,5,6"];
                SourceExpr=ConditionScore;
                Visible=FALSE;
                Editable=false }

    { 1100528616;2;Field  ;
                CaptionML=[ENU=Condition Measurement Date;
                           NOR=TilstandsmÜlingsdato;
                           SVE=MÑtdatum fîr tillstÜndspoÑng];
                SourceExpr=ConditionMeasurementDate;
                Visible=FALSE;
                Editable=false }

    { 1100528625;2;Field  ;
                SourceExpr="Measure Quantity";
                Visible=FALSE }

    { 1100528622;2;Field  ;
                SourceExpr="Unit Of Measure";
                Visible=FALSE }

    { 1903880701;1;Group  ;
                CaptionML=[ENU=Other;
                           NOR=ùvrige;
                           SVE=ôvriga] }

    { 1100525033;2;Field  ;
                SourceExpr="Input by";
                Importance=Additional }

    { 1100525035;2;Field  ;
                SourceExpr="Input Date";
                Importance=Additional }

    { 1100525029;2;Field  ;
                SourceExpr="Modified by";
                Importance=Additional }

    { 1100525031;2;Field  ;
                SourceExpr="Last date modified";
                Importance=Additional }

    { 1100526208;2;Field  ;
                SourceExpr=Text;
                Importance=Additional;
                Visible=false;
                MultiLine=Yes }

    { 1100526257;2;Field  ;
                SourceExpr="Tender Code System 1";
                Importance=Promoted;
                Visible=false }

    { 1100526259;2;Field  ;
                SourceExpr="Tender Code 1";
                Importance=Promoted;
                Visible=false }

    { 1100528631;2;Field  ;
                SourceExpr="Tender Code System 2";
                Visible=false }

    { 1100528633;2;Field  ;
                SourceExpr="Tender Code 2";
                Visible=false }

    { 1100528606;2;Field  ;
                SourceExpr="Company Name";
                Visible=FALSE }

    { 1100528608;2;Field  ;
                SourceExpr="Project No.";
                Visible=FALSE;
                OnLookup=VAR
                           Job@1100528600 : Record 11072003;
                         BEGIN
                           IF "Company Name" <> '' THEN
                             Job.CHANGECOMPANY("Company Name");
                           Job."No." := "Project No.";
                           IF PAGE.RUNMODAL(0, Job) = ACTION::LookupOK THEN
                             VALIDATE("Project No.", Job."No.");
                           CurrPage.UPDATE;
                         END;
                          }

    { 1100528610;2;Field  ;
                SourceExpr="Plot No.";
                Visible=FALSE;
                OnLookup=VAR
                           Plot@1100528600 : Record 11012500;
                         BEGIN
                           IF "Company Name" <> '' THEN
                             Plot.CHANGECOMPANY("Company Name");
                           Plot.SETRANGE("Project No.", "Project No.");
                           IF Plot.GET("Project No.", "Plot No.") THEN;
                           IF PAGE.RUNMODAL(0, Plot) = ACTION::LookupOK THEN
                             VALIDATE("Plot No.", Plot."Plot No.");
                           CurrPage.UPDATE;
                         END;
                          }

    { 1100528301;2;Field  ;
                SourceExpr="Yard No. (AYNO)";
                Visible=FALSE }

    { 1100528302;2;Field  ;
                SourceExpr="Entity Type (AYNO)";
                Visible=FALSE }

    { 1100528303;2;Field  ;
                SourceExpr="System No. (AYNO)";
                Visible=FALSE }

    { 1100528304;2;Field  ;
                SourceExpr="Entity No. (AYNO)";
                Visible=FALSE }

    { 1100529000;2;Field  ;
                SourceExpr="Fixed Asset No.";
                Visible=FALSE }

    { 1100409002;2;Field  ;
                SourceExpr="Hide in Service Portal";
                Importance=Additional;
                Visible=false }

    { 1100529601;2;Field  ;
                DrillDown=No;
                SourceExpr="Standard Object Checklist URL";
                Visible=FALSE }

    { 1100528309;2;Field  ;
                SourceExpr="Dsp Cluster Id";
                Visible=false }

    { 1100528310;2;Field  ;
                SourceExpr="Dsp Connection Object Id";
                Visible=false }

    { 1100528311;2;Field  ;
                SourceExpr="Dsp Assignment Id";
                Visible=false }

    { 1100528305;2;Field  ;
                SourceExpr="Dsp Origin";
                Visible=false }

    { 1100528306;2;Field  ;
                SourceExpr="Dsp Version No.";
                Visible=false }

    { 1100528307;2;Field  ;
                SourceExpr="Dsp Operator";
                Visible=false }

    { 1100528308;2;Field  ;
                SourceExpr="Dsp Discipline";
                Visible=false }

    { 1100525002;0;Container;
                ContainerType=FactBoxArea }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100525004;1;Part   ;
                CaptionML=[ENU=Totals;
                           NOR=Totaler;
                           SVE=Totaler];
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130476;
                PartType=Page }

    { 1100528802;1;Part   ;
                Name=PurchaseLineServiceObjectFactbox;
                SubPageLink=Service Object No.=FIELD(No.);
                PagePartID=Page11229357;
                PartType=Page }

    { 1100528644;1;Part   ;
                CaptionML=[ENU=Item Information;
                           NOR=Artikkelinformasjon;
                           SVE=Artikelinformation];
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11229404;
                PartType=Page }

    { 1100528619;1;Part   ;
                CaptionML=[ENU=Picture;
                           NOR=Bilde;
                           SVE=Bild];
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11126448;
                PartType=Page }

    { 1100525014;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100525010;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      BuildingRec@1100528606 : Record 11071819;
      Complex@1100529601 : Record 11071816;
      MaintenanceManagementCU@1100526203 : Codeunit 11012829;
      NEN2767Management@1100528605 : Codeunit 11012863;
      gvNextDate@1100525000 : Date;
      gvNextOrderCde@1100525001 : Code[20];
      gvLocCde@1100526200 : Code[20];
      gvNoRelationsCde@1100526201 : Code[20];
      gvRelationNameTxt@1100526202 : Text[100];
      Text000@1100528600 : TextConst 'ENU=Multiple Relations;NOR=Multiple relasjoner;SVE=Flera samband';
      SubcontractorCode@1100528602 : Code[20];
      SubcontractorName@1100528603 : Text[100];
      PreferredEmployeeNo@1100528611 : Code[20];
      PreferredEmployeeName@1100528612 : Text[100];
      BuildingCode@1100525002 : Code[20];
      PreferredBuildingCode@1100528607 : Code[20];
      ComplexCode@1100529600 : Code[20];
      BuildingDescription@1100525003 : Text[50];
      ServiceLocationNoEditable@1100525005 : Boolean INDATASET;
      ServiceLocation@1100529900 : Record 11012801;
      ConditionScore@1100528604 : ' ,1,2,3,4,5,6';
      ConditionMeasurementDate@1100528601 : Date;
      BrandCodeEditable@1100528608 : Boolean INDATASET;
      ModelCodeEditable@1100528609 : Boolean INDATASET;
      TypeCodeEditable@1100528610 : Boolean INDATASET;
      ReplacementValueDate@1100528613 : Date;
      Text001@1100525004 : TextConst 'ENU=GPS Coordinates can''t be calculated with current address data.;SVE=GPS-koordinater kan inte berÑknas med den aktuella adressdatan';
      Text002@1100525006 : TextConst 'ENU=Object has no service location.;SVE=Objektet har ingen serviceplats';

    PROCEDURE SetLocation@1100526200(lvLocCde@1100526200 : Code[20]);
    BEGIN
      gvLocCde := lvLocCde;
    END;

    PROCEDURE ShowServiceOrder@1100526201(IServiceOrderNo@1100526201 : Code[20]);
    VAR
      ServiceOrder@1100526200 : Record 11012823;
    BEGIN
      IF NOT ServiceOrder.GET(IServiceOrderNo) THEN
        EXIT;
      PAGE.RUN(PAGE::"Service Order (General)", ServiceOrder);
    END;

    PROCEDURE ShowDocuments@1100525001();
    VAR
      RecRef@1100525002 : RecordRef;
      DocumentFilters@1100525003 : Codeunit 11012432;
    BEGIN
      IF "Service Location No." = '' THEN
        EXIT;
      ServiceLocation.GET("Service Location No.");

      RecRef.GETTABLE(Rec);
      DocumentFilters.CreateTempFilterAndExecute1(RecRef, ServiceLocation."Global Dimension 1 Code", FALSE, TRUE);
    END;

    LOCAL PROCEDURE StandardObjectNoOnAfterValidat@19017398();
    BEGIN
      CurrPage.ObjSpecLinesCompressedPage.PAGE.SetSelection("No.");
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE WarrantyCodeOnAfterValidate@19071592();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      SubcontractorService@1100528600 : Record 11071789;
      PreferredEmployee@1100528800 : Record 11012843;
      RecRef@1100529900 : RecordRef;
    BEGIN
      xRec := Rec;
      SubcontractorCode := SubcontractorService.GetSubcontractorForDisplay('', '', "No.", '', SubcontractorName);
      CALCFIELDS(Discipline, "Trade Speciality");
      PreferredEmployeeNo :=
        PreferredEmployee.GetPreferredEmployeeForDisplay('', '', "No.", '', '', Discipline, "Trade Speciality", 0D, PreferredEmployeeName);

      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode(ServiceLocation."Global Dimension 1 Code");
    END;

    PROCEDURE SetFieldsEditable@1100525000();
    BEGIN
      ServiceLocationNoEditable := BuildingCode = '';
    END;

    BEGIN
    END.
  }
}

