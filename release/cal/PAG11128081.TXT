OBJECT Page 11128081 Projects - Summary
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSSE;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Projects - Summary;
               NOR=Prosjekt Í liste;
               SVE=Projekt Í lista];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table11072003;
    SourceTableView=SORTING(No.);
    PageType=List;
    UsageCategory=Lists;
    CardPageID=Job Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Commission & Invoicing,Budget & Structure,Project control,Engineering & Purchase,Documents;
                                NOR=Nytt,Behandle,Rapport,Oppdragsgiver & Fakturering,Budsjett & Strukturer,Prosjektkontroll,Prosjektering & Kj›p,Dokumenter;
                                SVE=Nytt,Behandla,Rapport,Uppdragsgivare & Fakturering,Budget & Strukturer,Projektkontroll,Engineering & Purchase,Dokument];
    ShowFilter=Yes;
    OnInit=BEGIN
             CopyButtonEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 //**4PS.sn
                 ProjSetup.GET;
                 IF NOT gCopyServLoc THEN
                   CopyButtonEnable := FALSE;

                 CustButtonsVisible1 := CustomSelectedbuttons.GET(11128081,1);
                 CustButtonsVisible2 := CustomSelectedbuttons.GET(11128081,2);
                 CustButtonsVisible3 := CustomSelectedbuttons.GET(11128081,3);


                 //>> 170905 ITERO.SB
                 CLEAR(SESetup);
                 SESetup.SETRANGE("Line type",SESetup."Line type"::Setup);
                 SESetup.SETRANGE(Code,'PROJLIST');
                 //SESetup.SETRANGE("Code 2",'FILTER');
                 SESetup.SETRANGE(Description,USERID);
                 //>>191209
                 SESetup.SETRANGE("Value (bool)",TRUE);
                 SESetup.SETFILTER("Value (txt)",'<>%1','');
                 // IF SESetup.FINDFIRST THEN BEGIN
                 IF SESetup.FINDSET THEN BEGIN
                 //<<191209
                   FILTERGROUP(27);
                 //>>191209
                 //  SETFILTER("No.",SESetup."Value (txt)");
                   SETRANGE("No.");
                   REPEAT
                     SETFILTER("No.",GETFILTER("No.")+SESetup."Value (txt)");
                   UNTIL SESetup.NEXT=0;
                 //<<191209
                   FILTERGROUP(0);
                 END;
                 //<<
               END;

    OnAfterGetRecord=BEGIN
                       //**4PS.sn
                       NameHideValue := FALSE;

                       IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
                         SETRANGE("Project Filter", "No.")
                       ELSE
                         SETRANGE("Project Filter");
                       //140612 CALCFIELDS(Revenues);
                       NameOnFormat;
                       //**4PS.en

                       CalculateProjectValues; // 150326 ITERO.KP
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525069;1 ;ActionGroup;
                      CaptionML=[ENU=Project;
                                 NOR=Prosjekt;
                                 SVE=Projekt] }
      { 1100525006;2 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=&Dokumenter;
                                 SVE=&Dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //C011191
                                 OpenCard;
                               END;
                                }
      { 1100525042;1 ;ActionGroup;
                      CaptionML=[ENU=Commission & Invoicing;
                                 NOR=Oppdragsgiver & Fakturering;
                                 SVE=Uppdragsgivare & Fakturering] }
      { 1101200005;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+P;
                      CaptionML=[ENU=Principals;
                                 NOR=oppdragsgiver;
                                 SVE=Uppdragsgivare];
                      Promoted=Yes;
                      Image=TeamSales;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 //**4PS
                                 ProjPrincipRec.RESET;
                                 ProjPrincipRec.SETRANGE("Project No.","No.");
                                 IF "Bill-to Customer No." <> '' THEN
                                   IF NOT ProjPrincipRec.GET("No.","Bill-to Customer No.") THEN
                                     ProjPrincipRec.SETRANGE(Principal,"Bill-to Customer No.");
                                 PAGE.RUN(PAGE::"Project Principal List",ProjPrincipRec);
                               END;
                                }
      { 1101200023;2 ;Action    ;
                      CaptionML=[ENU=&Installments;
                                 NOR=&Betalingsplaner;
                                 SVE=&Betalplaner];
                      RunObject=Page 11012025;
                      RunPageView=SORTING(Project No.,Principal,Installment No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=AmountByPeriod;
                      PromotedCategory=Category4 }
      { 1101200017;2 ;Action    ;
                      ShortCutKey=Ctrl+M;
                      CaptionML=[ENU=&Extensions;
                                 NOR=&ETA;
                                 SVE=&ŽTA];
                      RunObject=Page 11012014;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=TransferFunds;
                      PromotedCategory=Category4 }
      { 1100525043;2 ;ActionGroup;
                      CaptionML=[ENU=Cost plus & Unit Prices;
                                 NOR=Selvkoster og Enhetspriser;
                                 SVE=Sj„lvkostnader & Enhetspriser];
                      Image=CostAccounting }
      { 1101200024;3 ;Action    ;
                      CaptionML=[ENU=&Cost Plus Entries;
                                 NOR=&Rapporterte selvkoster;
                                 SVE=&Redovisade sj„lvkostnader];
                      RunObject=Page 11012043;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=ApplyEntries }
      { 1100525036;3 ;Action    ;
                      CaptionML=[ENU=Project &Unit Prices;
                                 NOR=Prosjekt&enhetspriser;
                                 SVE=Projekt&enhetspriser];
                      RunObject=Page 11072519;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostCenter }
      { 1100525037;3 ;Action    ;
                      CaptionML=[ENU=Production Motivation;
                                 NOR=Produksjonsmotivasjon;
                                 SVE=Produktionsorsak];
                      Image=Production;
                      OnAction=VAR
                                 ProdMot@1100525000 : Record 11020425;
                               BEGIN
                                 ProdMot.RunUnitPriceProdMotList("No.", '', 0);  //* Level 0=Project
                               END;
                                }
      { 1100525029;2 ;ActionGroup;
                      CaptionML=[ENU=Sales rates;
                                 NOR=Salgsrater;
                                 SVE=F”rs„ljningspriser];
                      Image=Sales }
      { 1100525030;3 ;Action    ;
                      CaptionML=[ENU=Project - &Employee Sales Prices;
                                 NOR=Prosjekt Í &salgspriser for ansatt;
                                 SVE=Projekt Í &f”rs„ljningspriser f”r anst„lld];
                      RunObject=Page 11072469;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPerson }
      { 1100525031;3 ;Action    ;
                      CaptionML=[ENU=Project - Employee - &Cost Object Sales Prices;
                                 NOR=Prosjekt Í ansatt Í &salgspriser for kostobjekt;
                                 SVE=Projekt Í anst„lld Í &f”rs„ljningspriser f”r kostnadsobjekt];
                      RunObject=Page 11072497;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100525032;3 ;Action    ;
                      CaptionML=[ENU=Project - Employee - Cost Object - &Wage Component Sales Prices;
                                 NOR=Prosjekt Í ansatt Í kostobjekt Í &salgspriser for l›nnsart;
                                 SVE=Projekt Í anst„lld Í kostnadsobjekt Í &f”rs„ljningspriser f”r l”neart];
                      RunObject=Page 11072498;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ItemTrackingLedger }
      { 1100525033;3 ;Action    ;
                      CaptionML=[ENU=Project - Cost &Object Sales Prices;
                                 NOR=Prosjekt Í salgspriser for kost&objekt;
                                 SVE=Projekt Í f”rs„ljningspriser f”r kostnads&objekt];
                      RunObject=Page 11072467;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Item }
      { 1100525034;3 ;Action    ;
                      CaptionML=[ENU=Project - Cost Object - Wage Component Sales Prices;
                                 NOR=Prosjekt Í kostobjekt Í salgspriser for l›nnsart;
                                 SVE=Projekt Í kostnadsobjekt Í f”rs„ljningspriser f”r l”neart];
                      RunObject=Page 11072468;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525044;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1101200002;3 ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer;
                                 SVE=Fakturor];
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowPostedInvoices;
                               END;
                                }
      { 1101200003;3 ;Action    ;
                      CaptionML=[ENU=Credit &Memos;
                                 NOR=Kredit&notaer;
                                 SVE=Kredit&notor];
                      Promoted=No;
                      Image=CreditMemo;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowPostedCreditMemos;
                               END;
                                }
      { 1100285003;3 ;Action    ;
                      CaptionML=[ENU=Credit Memos, not posted;
                                 NOR=Fakturaer;
                                 SVE=Kreditnotor, ej bokf”rda];
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 SalesLine@1100285000 : Record 37;
                                 SalesHeader@1100285001 : Record 36;
                               BEGIN
                                 //**4PS
                                 //ShowPostedInvoices;


                                 SalesLine.SETCURRENTKEY("Job No.");
                                 SalesLine.SETRANGE("Job No.","No.");
                                 SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::"Credit Memo");
                                 IF SalesLine.FINDSET THEN
                                   REPEAT
                                     IF SalesHeader.GET(SalesLine."Document Type",SalesLine."Document No.") THEN
                                       SalesHeader.MARK(TRUE);
                                   UNTIL SalesLine.NEXT = 0;

                                 SalesHeader.MARKEDONLY(TRUE);
                                 PAGE.RUNMODAL(PAGE::"Sales List",SalesHeader);
                               END;
                                }
      { 1100285004;3 ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer;
                                 SVE=Fakturor, ej bokf”rda];
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 SalesLine@1100285000 : Record 37;
                                 SalesHeader@1100285001 : Record 36;
                               BEGIN
                                 //**4PS
                                 //ShowPostedInvoices;


                                 SalesLine.SETCURRENTKEY("Job No.");
                                 SalesLine.SETRANGE("Job No.","No.");
                                 SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Invoice);
                                 IF SalesLine.FINDSET THEN
                                   REPEAT
                                     IF SalesHeader.GET(SalesLine."Document Type",SalesLine."Document No.") THEN
                                       SalesHeader.MARK(TRUE);
                                   UNTIL SalesLine.NEXT = 0;

                                 SalesHeader.MARKEDONLY(TRUE);
                                 PAGE.RUNMODAL(PAGE::"Sales List",SalesHeader);
                               END;
                                }
      { 1210190027;3 ;Action    ;
                      CaptionML=[ENU=Rental Units;
                                 NOR=Leieenheter;
                                 SVE=Uthyrningsenheter];
                      Image=BlanketOrder;
                      OnAction=VAR
                                 RentalUnitRec@1100485000 : Record 11012940;
                               BEGIN
                                 //**4PS
                                 ProjSetup.TESTFIELD("Rental Units active");
                                 RentalUnitRec.SETRANGE("Project No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Rental Unit",RentalUnitRec);
                               END;
                                }
      { 1100525068;3 ;Action    ;
                      CaptionML=[ENU=Exchange Rates;
                                 NOR=Valutakurser;
                                 SVE=Byt avgifter];
                      Image=CurrencyExchangeRates;
                      OnAction=BEGIN
                                 ShowCurrencyExchangeRates;
                               END;
                                }
      { 1100525017;1 ;ActionGroup;
                      CaptionML=[ENU=Budget & Structure;
                                 NOR=Budsjett & Struktur;
                                 SVE=Budget & Struktur];
                      Image=Administration }
      { 1210190032;2 ;Action    ;
                      CaptionML=[ENU=Sub Projects;
                                 NOR=Underprosjekter;
                                 SVE=Underprojekt];
                      Promoted=Yes;
                      Image=Splitlines;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 JobRec@1100485000 : Record 11072003;
                               BEGIN
                                 //**4PS
                                 JobRec.SETRANGE("Single/Main/Sub Project", "Single/Main/Sub Project"::"Sub Project");
                                 JobRec.SETRANGE("Main Project", "No.");
                                 IF JobRec.FIND('-') THEN
                                   PAGE.RUNMODAL(PAGE::"Job List", JobRec)
                                 ELSE
                                   MESSAGE(Text11012000);
                               END;
                                }
      { 1101200015;2 ;Action    ;
                      CaptionML=[ENU=Elemen&ts;
                                 NOR=Elemen&t;
                                 SVE=Elemen&t];
                      RunObject=Page 11012028;
                      RunPageView=SORTING(Project No.,Element);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=BOMVersions;
                      PromotedCategory=Category5 }
      { 1101200016;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=&Budget;
                                 NOR=&Budsjett;
                                 SVE=&Budget];
                      RunObject=Page 11012003;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=LedgerBudget;
                      PromotedCategory=Category5 }
      { 1101200018;2 ;Action    ;
                      CaptionML=[ENU=Budget &Adjustments;
                                 NOR=Budsjett&justeringer;
                                 SVE=Budget&justeringar];
                      Promoted=Yes;
                      Image=Balance;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BudgetAdjustment@1100525000 : Record 11012003;
                               BEGIN
                                 BudgetAdjustment.SETRANGE("Project No.", "No.");
                                 IF BudgetAdjustment.FINDLAST THEN;
                                   PAGE.RUNMODAL(PAGE::"Budget Adjustment List", BudgetAdjustment);
                               END;
                                }
      { 1100525023;2 ;ActionGroup;
                      CaptionML=[ENU=Rates Cost Prices;
                                 NOR=Selvkoster;
                                 SVE=Sj„lvkostnadspriser];
                      Image=CostAccounting }
      { 1100525021;3 ;Action    ;
                      CaptionML=[ENU=Project &Budget Rates;
                                 NOR=Prosjektets &Budsjettsatser;
                                 SVE=Projektets &budgetavgifter];
                      RunObject=Page 11020264;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=LedgerBudget }
      { 1100525024;3 ;Action    ;
                      CaptionML=[ENU=Project - &Employee Cost Prices;
                                 NOR=Prosjekt Í &selvkoster for ansatt;
                                 SVE=Projekt Í &sj„lvkostnadspriser f”r anst„lld];
                      RunObject=Page 11020300;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Employee }
      { 1100525025;3 ;Action    ;
                      CaptionML=[ENU=Project - Employee - &Wage Component Cost Prices;
                                 NOR=Prosjekt Í ansatt Í &Selvkoster for l›nnsart;
                                 SVE=Projekt Í anst„lld Í &sj„lvkostnadspriser f”r l”neart];
                      RunObject=Page 11072435;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525026;3 ;Action    ;
                      CaptionML=[ENU=Project - &Cost Object Cost Prices;
                                 NOR=Prosjekt Í &selvkoster for kostobjekt;
                                 SVE=Projekt Í &sj„lvkostnadspriser f”r kostnadsobjekt];
                      RunObject=Page 11072434;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostAccountingDimensions }
      { 1100525027;3 ;Action    ;
                      CaptionML=[ENU=Project - &Trade Association Cost Prices;
                                 NOR=Prosjekt Í &selvkoster for bransjeorganisasjoner;
                                 SVE=Projekt Í &sj„lvkostnadspriser f”r branschorganisationer];
                      RunObject=Page 11072432;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Union }
      { 1100525028;3 ;Action    ;
                      CaptionML=[ENU=Project - Trade Association - Wage Co&mponent Cost Prices;
                                 NOR=Prosjekt Í bransjeorganisasjon Í &selvkoster for l›nnsart;
                                 SVE=Projekt Í branschorganisation Í sj„lv&sj„lvkostnadspriser f”r l”neart];
                      RunObject=Page 11072433;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525045;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1210190035;3 ;Action    ;
                      CaptionML=[ENU=Project Cost Objects;
                                 NOR=Prosjekt Í kostobjekt;
                                 SVE=Projekt Í kostnadsobjekt];
                      RunObject=Page 11012128;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Dimensions }
      { 1100525012;1 ;ActionGroup;
                      CaptionML=[ENU=Project Control;
                                 NOR=Prosjektkontroll;
                                 SVE=Projektkontroll];
                      Image=SNInfo }
      { 1100525013;2 ;Action    ;
                      CaptionML=[ENU=Project Control;
                                 NOR=Prosjektkontroll;
                                 SVE=Projektkontroll];
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100525000 : Record 11072003;
                               BEGIN
                                 OpenProjectControl;
                               END;
                                }
      { 1100285502;2 ;Action    ;
                      CaptionML=[ENU=Project Control Overview;
                                 NOR=Prosjektstyring oversikt;
                                 SVE=Projektkontroll ”versikt];
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100285500 : Record 11072003;
                               BEGIN
                                 OpenProjectControlOverview;
                               END;
                                }
      { 1100285501;2 ;Action    ;
                      CaptionML=[ENU=Project Control Summarized;
                                 NOR=Prosjektstyring oppsummert;
                                 SVE=Projektkontroll sammandrag];
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100285500 : Record 11072003;
                               BEGIN
                                 OpenProjectControlSummarized;
                               END;
                                }
      { 32      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 NOR=&Transaksjoner;
                                 SVE=&Transaktioner];
                      RunObject=Page 11072005;
                      RunPageView=SORTING(Job No.,Posting Date);
                      RunPageLink=Job No.=FIELD(No.);
                      Promoted=Yes;
                      Image=LedgerEntries;
                      PromotedCategory=Category6 }
      { 1100525014;2 ;Action    ;
                      CaptionML=[ENU=P&rogress;
                                 NOR=F&remdrift;
                                 SVE=F”&rlopp];
                      RunObject=Page 11012079;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=EditLines;
                      PromotedCategory=Category6 }
      { 1100525015;2 ;Action    ;
                      CaptionML=[ENU=Pr&ognosis;
                                 NOR=Pr&ognose;
                                 SVE=Pr&ognos];
                      Promoted=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 LaunchPrognosisList;
                               END;
                                }
      { 1101285001;2 ;Action    ;
                      CaptionML=[ENU=Prognosis Overview;
                                 SVE=Prognos”versikt];
                      RunObject=Page 11128290;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Worksheet2;
                      PromotedCategory=Category6 }
      { 1100285002;2 ;Action    ;
                      CaptionML=[ENU=Project Control;
                                 SVE=Projektkontroll];
                      Promoted=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 MgtProjdetails@1100285000 : Codeunit 11128091;
                               BEGIN
                                 MgtProjdetails.MgtProjDetail(USERID,"No.");
                               END;
                                }
      { 1100285101;2 ;Action    ;
                      CaptionML=[ENU=Project Details;
                                 SVE=Projektdetaljer];
                      Promoted=Yes;
                      Image=CalculateRemainingUsage;
                      OnAction=VAR
                                 MgtProjdetails@1100285100 : Codeunit 11128091;
                               BEGIN
                                 //200514 4PS.SE
                                 MgtProjdetails.MgtProjDetailSelectedValues(USERID, "No.");
                               END;
                                }
      { 1101285004;2 ;Action    ;
                      CaptionML=[ENU=Show ExflowDocs by project;
                                 SVE=Visa Attestdokument per projekt];
                      Promoted=Yes;
                      Image=CoupledPurchaseInvoice;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 ProjectDetails@1101285000 : Codeunit 11128091;
                               BEGIN
                                 TESTFIELD("No.");
                                 ProjectDetails.ShowPostedExfPurchaseInvoices("No.");
                               END;
                                }
      { 1100285100;2 ;Action    ;
                      Name=GetPrognosisFromSubPrognosis;
                      CaptionML=[ENU=Create Prognosis From Sub Prognosis;
                                 SVE=Skapa prognos fr†n underprojekt];
                      Image=CopyForecast;
                      OnAction=VAR
                                 lJob@1100285102 : Record 11072003;
                                 lPrognosis@1100285100 : Record 11012034;
                                 DeterminePrognosisDate@1100285101 : Codeunit 11012029;
                                 ProjectDetails@1100285103 : Codeunit 11128091;
                                 EndDate@1100285104 : Date;
                               BEGIN
                                 IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
                                   EXIT;
                                 lJob := Rec;
                                 // lJob.COPYFILTERS(Rec);
                                 // lJob.SETRECFILTER;
                                 // // lJob.SETRANGE("Period Filter",0D,WORKDATE);
                                 // // DeterminePrognosisDate.DetermineBothDates(lJob);
                                 // lPrognosis.SETFILTER("Project No.",'<>%1',lJob."No.");
                                 // lPrognosis.SETRANGE("Main Project No.","No.");
                                 // lPrognosis.SETRANGE("Prognosis Date",0D,WORKDATE);
                                 // EndDate:=0D;
                                 // IF lPrognosis.FINDSET(FALSE) THEN REPEAT
                                 //  IF lPrognosis."Prognosis Date">EndDate THEN BEGIN
                                 //    EndDate := lPrognosis."Prognosis Date";
                                 //  END;
                                 // UNTIL lPrognosis.NEXT=0;
                                 // lJob.SETRANGE("Prognosis Filter",0D,EndDate);
                                 // ProjectDetails.GetAndComputeSubPrognosis(lJob,EndDate);
                                 ProjectDetails.GetAndComputeSubPrognosis(lJob,ProjectDetails.GetLastSubPrognosisDate(lJob));
                               END;
                                }
      { 1100525046;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1100525066;3 ;Action    ;
                      CaptionML=[ENU=Snapshot;
                                 NOR=Snapshot;
                                 SVE=Snapshot];
                      RunObject=Page 11124895;
                      RunPageView=SORTING(Project No.,Snapshot Date);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SuggestCapacity }
      { 1100525067;3 ;Action    ;
                      CaptionML=[ENU=&Forecast;
                                 NOR=&Forecast;
                                 SVE=&Prognos];
                      Image=Forecast }
      { 1100525016;3 ;Action    ;
                      CaptionML=[ENU=Liquidity Prognosis;
                                 NOR=Likviditetsprognose;
                                 SVE=Likviditetsprognos];
                      Image=PaymentForecast;
                      OnAction=VAR
                                 LiqProgProjHead@1100525000 : Record 11020603;
                               BEGIN
                                 TESTFIELD("Liquidity Prognosis", "Liquidity Prognosis"::"Specific Division");

                                 LiqProgProjHead.SETRANGE("Project No.", "No.");
                                 PAGE.RUNMODAL(PAGE::"Liquidity Prognosis Proj Head", LiqProgProjHead);
                               END;
                                }
      { 1100525051;1 ;ActionGroup;
                      CaptionML=[ENU=Engineering & Purchase;
                                 NOR=Ingeni›rkunst & Innkj›p;
                                 SVE=Ingenj”rskonst & Ink”p];
                      Image=Purchasing }
      { 1100525058;2 ;Action    ;
                      CaptionML=[ENU=Advice Orders;
                                 NOR=Bestillingsunderlag;
                                 SVE=Best„llningsunderlag];
                      RunObject=Page 11012102;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=OrderReminder;
                      PromotedCategory=Category7 }
      { 1101200021;2 ;Action    ;
                      CaptionML=[ENU=Purchase Actions;
                                 NOR=Innkj›pshandlinger;
                                 SVE=Ink”ps†tg„rder];
                      RunObject=Page 11012034;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=OrderTracking;
                      PromotedCategory=Category7 }
      { 1210190000;2 ;Action    ;
                      CaptionML=[ENU=Purchase Orders;
                                 NOR=Innkj›psordre;
                                 SVE=Ink”psorder];
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 ShowPurchaseOrdersForProject;
                               END;
                                }
      { 1100525059;2 ;Action    ;
                      CaptionML=[ENU=Purchase Quotes;
                                 NOR=Innkj›pstilbud;
                                 SVE=Ink”psofferter];
                      Image=Purchase;
                      OnAction=BEGIN
                                 ShowPurchaseQuotesForProject;
                               END;
                                }
      { 1100525041;2 ;Action    ;
                      CaptionML=[ENU=Planning Activities;
                                 NOR=Planleggingsaktiviteter;
                                 SVE=Planeringsaktiviteter];
                      RunObject=Page 11072310;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=JobTimeSheet;
                      PromotedCategory=Category7 }
      { 1100525056;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1100525040;3 ;Action    ;
                      CaptionML=[ENU=Activities;
                                 NOR=Aktiviteter;
                                 SVE=Aktiviteter];
                      Image=Task;
                      OnAction=BEGIN
                                 ShowTodos;
                               END;
                                }
      { 1100525005;3 ;Action    ;
                      CaptionML=[ENU=Matrix Purchase Actions &Document Relations;
                                 NOR=Matrise for &dokumentrelasjoner (Innkj›pshandling);
                                 SVE=Matrisink”ps†tg„rd f”r &dokumentrelationer];
                      Image=Document;
                      OnAction=VAR
                                 MatrixPurchActDocRelations@1100525000 : Page 11071829;
                               BEGIN
                                 TESTFIELD("No.");
                                 MatrixPurchActDocRelations.SetProjectNo("No.");
                                 MatrixPurchActDocRelations.RUNMODAL;
                               END;
                                }
      { 1210190030;1 ;ActionGroup;
                      CaptionML=[ENU=Buyer Management;
                                 NOR=Kj›perh†ndtering;
                                 SVE=K”parhantering];
                      Image=AdministrationSalesPurchases }
      { 1101200011;2 ;Action    ;
                      CaptionML=[ENU=Plots;
                                 NOR=Tegningnr;
                                 SVE=Ritningar];
                      RunObject=Page 11012506;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=AddToHome }
      { 1100525048;2 ;Action    ;
                      CaptionML=[ENU=Option Quotes;
                                 NOR=Alternativtilbud;
                                 SVE=Alternativofferter];
                      RunObject=Page 11012546;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Quote }
      { 1100525047;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1101200010;3 ;Action    ;
                      CaptionML=[ENU=House Types;
                                 NOR=Hustyper;
                                 SVE=Hustyper];
                      Promoted=No;
                      Image=NewWarehouse;
                      OnAction=VAR
                                 lvHouseModelRec@1210190000 : Record 11012501;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 lvHouseModelRec.FILTERGROUP(9);
                                 lvHouseModelRec.SETRANGE("Project No.", "No.");
                                 lvHouseModelRec.FILTERGROUP(0);
                                 PAGE.RUNMODAL(PAGE::"House Models by Project List", lvHouseModelRec);
                               END;
                                }
      { 1100525049;3 ;Action    ;
                      CaptionML=[ENU=Delivery;
                                 NOR=Leveranse;
                                 SVE=LEVERANS];
                      RunObject=Page 11012528;
                      RunPageView=WHERE(Plot No.=FILTER(''));
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Delivery }
      { 1210190028;3 ;Action    ;
                      CaptionML=[ENU=Project Options;
                                 NOR=Prosjektalternativer;
                                 SVE=Projektalternativ];
                      Image=Quote;
                      OnAction=BEGIN
                                 //**4PS
                                 OptionList();
                               END;
                                }
      { 1210190046;3 ;Action    ;
                      CaptionML=[ENU=Main Groups;
                                 NOR=Hovedgrupper;
                                 SVE=Huvudgrupper];
                      RunObject=Page 11012543;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1101200013;3 ;Action    ;
                      CaptionML=[ENU=Groups;
                                 NOR=Grupper;
                                 SVE=Grupper];
                      RunObject=Page 11012518;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1210190047;3 ;Action    ;
                      CaptionML=[ENU=Sub Groups;
                                 NOR=Undergrupper;
                                 SVE=Undergrupper];
                      RunObject=Page 11012542;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1100525002;1 ;ActionGroup;
                      CaptionML=[ENU=&Civil Engineering;
                                 NOR=&Sivilingeni›r;
                                 SVE=&V„g- och vattenbyggnad];
                      Image=Travel }
      { 1100525022;2 ;Action    ;
                      CaptionML=[ENU=Project &Tender Paragraphs;
                                 NOR=Prosjekt&Tilbudsavsnitt;
                                 SVE=Projekt&anbudsstycken];
                      RunObject=Page 11020346;
                      RunPageLink=No.=FIELD(No.);
                      Image=Job }
      { 1100525003;2 ;Action    ;
                      CaptionML=[ENU=Tender Paragraphs;
                                 NOR=Tilbudsavsnitt;
                                 SVE=AMA koder];
                      RunObject=Page 11020553;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CalculateCost }
      { 1100525035;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1100525004;3 ;Action    ;
                      CaptionML=[ENU=Tender Paragraph &Parts;
                                 NOR=Tilbudsavsnitts&deler;
                                 SVE=Anbudsstycke&delar];
                      RunObject=Page 11020554;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CalculateCrossDock }
      { 1100525052;3 ;Action    ;
                      CaptionML=[ENU=Project Inspections (Site Mgt.);
                                 NOR=Prosjektinspeksjoner (byggeledelse);
                                 SVE=Projektinspektioner (byggledning)];
                      RunObject=Page 11125538;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Check }
      { 1100525053;1 ;ActionGroup;
                      CaptionML=[ENU=Site Manager Form;
                                 NOR=Prosjektlederskjema;
                                 SVE=Byggledarformul„r] }
      { 1100525054;2 ;Action    ;
                      CaptionML=[ENU=Project Working Hours;
                                 NOR=Prosjektarbeidstimer;
                                 SVE=Projektarbetstimmar];
                      RunObject=Page 11125541;
                      RunPageLink=No.=FIELD(No.);
                      Image=JobTimeSheet }
      { 1100525055;2 ;Action    ;
                      CaptionML=[ENU=Project Inspections;
                                 NOR=Prosjektinspeksjoner;
                                 SVE=Projektinspektioner];
                      RunObject=Page 11125538;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CheckRulesSyntax }
      { 1100525018;1 ;ActionGroup;
                      CaptionML=[ENU=&Project Tables;
                                 NOR=&Prosjekttabeller;
                                 SVE=&Projekttabeller];
                      Image=Worksheets }
      { 34      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Job),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1210190034;2 ;Action    ;
                      CaptionML=[ENU=Do&cuments;
                                 NOR=Do&kumenter;
                                 SVE=Do&kument];
                      Promoted=No;
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                                 DocumentFilters@1100525002 : Codeunit 11012432;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 // ByCompany changed to FALSE, otherwise documents are not showed in the archive company
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, FALSE);
                               END;
                                }
      { 1100525057;2 ;ActionGroup;
                      CaptionML=[ENU=Locations;
                                 NOR=Plasseringer;
                                 SVE=Lagerst„llen];
                      Image=Addresses }
      { 1210190031;3 ;Action    ;
                      CaptionML=[ENU=Project Locations;
                                 NOR=Prosjektplasseringer;
                                 SVE=Etableringar];
                      RunObject=Page 11012020;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Job }
      { 1100525020;3 ;Action    ;
                      CaptionML=[ENU=Job Preferred &Locations;
                                 NOR=Foretrukne &Plasseringer for jobb;
                                 SVE=F”rvalda &lagerst„llen f”r jobb];
                      RunObject=Page 11072043;
                      RunPageView=SORTING(Priority);
                      RunPageLink=Type=CONST(Job),
                                  No.=FIELD(No.);
                      Image=RoutingVersions }
      { 1100525060;2 ;ActionGroup;
                      CaptionML=[ENU=QA;
                                 NOR=Kvalitetssikring;
                                 SVE=Kvalitetss„kring];
                      Image=AnalysisView }
      { 1100525050;3 ;Action    ;
                      CaptionML=[ENU=Complaint Management;
                                 NOR=Klageh†ndtering;
                                 SVE=Klagom†lshantering];
                      RunObject=Page 11012468;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=EditReminder }
      { 1100525061;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1101200007;3 ;Action    ;
                      CaptionML=[ENU=Responsible Persons;
                                 NOR=Ansvarlige personer;
                                 SVE=Ansvariga personer];
                      RunObject=Page 11012017;
                      RunPageView=SORTING(Project No.,Line No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=PersonInCharge }
      { 1100525011;3 ;Action    ;
                      CaptionML=[ENU=Project &Inventory;
                                 NOR=Prosjekt&lager;
                                 SVE=Projekt&lager];
                      RunObject=Page 11012673;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=LedgerBook }
      { 1100525019;3 ;Action    ;
                      CaptionML=[ENU=Project &Authorities;
                                 NOR=Prosjekt&myndigheter;
                                 SVE=Projekt&myndigheter];
                      RunObject=Page 11020231;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=IndustryGroups }
      { 13      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(11072003),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 1100525038;3 ;Action    ;
                      CaptionML=[ENU=Features;
                                 NOR=Funksjoner;
                                 SVE=Funktioner];
                      Image=QualificationOverview;
                      OnAction=BEGIN
                                 ShowFeatures;
                               END;
                                }
      { 1101200008;3 ;Action    ;
                      CaptionML=[ENU=Picture;
                                 NOR=Bilde;
                                 SVE=Bild];
                      RunObject=Page 11012030;
                      RunPageLink=No.=FIELD(No.);
                      Image=Picture }
      { 1100525039;3 ;Action    ;
                      CaptionML=[ENU=Exchange Rates;
                                 NOR=Valutakurser;
                                 SVE=Byt avgifter];
                      RunObject=Page 11124939;
                      RunPageLink=Project Filter=FIELD(No.);
                      Image=CurrencyExchangeRates }
      { 1100525062;1 ;ActionGroup;
                      CaptionML=[ENU=Sales & &Marketing;
                                 NOR=Salg og &markedsf›ring;
                                 SVE=F”rs„ljning och &marknadsf”ring] }
      { 1100525063;2 ;Action    ;
                      CaptionML=[ENU=Try-out;
                                 NOR=Prospekt;
                                 SVE=Anbud];
                      Image=Quote;
                      OnAction=BEGIN
                                 ShowTryOut(1);
                               END;
                                }
      { 1100525064;2 ;Action    ;
                      CaptionML=[ENU=Try-out &Quote;
                                 NOR=T&ilbudsforesp›rsel;
                                 SVE=A&nbudsf”rfr†gan];
                      Image=Quote;
                      OnAction=BEGIN
                                 ShowTryOut(2);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1900979604;1 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Project;
                                 NOR=Kopier prosjekt;
                                 SVE=Kopiera projekt];
                      Promoted=No;
                      Image=Copy;
                      PromotedCategory=New;
                      OnAction=VAR
                                 CopyProject@1100528400 : Page 11012106;
                               BEGIN
                                 //**4PS
                                 CopyProject.FillDefaults("No.");
                                 CopyProject.StdDialogRunModal;
                               END;
                                }
      { 1210190036;1 ;Action    ;
                      Name=CopyButton;
                      CaptionML=[ENU=&Copy;
                                 NOR=&Kopier;
                                 SVE=&Kopiera];
                      Enabled=CopyButtonEnable;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 CopyServiceLocation;
                                 COMMIT;
                                 CurrPage.CLOSE;
                               END;
                                }
      { 1100285000;1 ;Action    ;
                      Name=<Action1100285000>;
                      ShortCutKey=Ctrl+U;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Sub Project;
                                 NOR=Opprette underprosjekt;
                                 SVE=Skapa underprojekt];
                      Promoted=Yes;
                      Image=Splitlines;
                      PromotedCategory=New;
                      OnAction=VAR
                                 Job@1100285003 : Record 11072003;
                                 CreateSubProjFrm@1100285002 : Page 11128005;
                                 CreatedProjNo@1100285001 : Code[20];
                               BEGIN
                                 //**4PSSE
                                 IF CONFIRM(STRSUBSTNO(Text50000,"No.")) THEN BEGIN
                                   CreateSubProjFrm.FillDefaults("No.");
                                   CreateSubProjFrm.CopyProject();
                                   CreateSubProjFrm.GetCreatedProjectNo(CreatedProjNo);
                                   Job.GET(CreatedProjNo);
                                   PAGE.RUN(11072003,Job);
                                   CLEAR(CreateSubProjFrm);
                                 END;
                               END;
                                }
      { 1100285302;1 ;Action    ;
                      Name=button1;
                      CaptionML=[ENU=Programmable button 1;
                                 NOR=Programmerbar knapp 1;
                                 SVE=Inst„llningsbar knapp 1];
                      Visible=CustButtonsVisible1;
                      OnAction=VAR
                                 RecRef@1100525000 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,29,1);
                               END;
                                }
      { 1100285301;1 ;Action    ;
                      Name=button2;
                      CaptionML=[ENU=Programmable button 2;
                                 NOR=Programmerbar knapp 2;
                                 SVE=Inst„llningsbar knapp 2];
                      Visible=CustButtonsVisible2;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,29,2);
                               END;
                                }
      { 1100285300;1 ;Action    ;
                      Name=button3;
                      CaptionML=[ENU=Programmable button 3;
                                 NOR=Programmerbar knapp 3;
                                 SVE=Inst„llningsbar knapp 3];
                      Visible=CustButtonsVisible3;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,29,3);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 10  ;1   ;Field     ;
                CaptionML=[ENU=Date Filter;
                           NOR=Dato filter;
                           SVE=Datumfilter];
                SourceExpr=DateFilter;
                Enabled=TRUE;
                Editable=TRUE;
                OnValidate=BEGIN
                             TextManagement.MakeDateFilter(DateFilter);
                             CurrPage.UPDATE;
                           END;
                            }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1100528800;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE }

    { 1100485008;2;Field  ;
                SourceExpr="Project Address Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 3   ;2   ;Field     ;
                SourceExpr="Principal Name" }

    { 1100485019;2;Field  ;
                CaptionML=[ENU=Name (Small Project);
                           NOR=Navn (lite prosjekt);
                           SVE=Namn (mindre projekt)];
                SourceExpr=Name;
                Visible=FALSE;
                HideValue=NameHideValue }

    { 1210190013;2;Field  ;
                SourceExpr=Address;
                Visible=FALSE }

    { 1210190019;2;Field  ;
                SourceExpr="Address 2";
                Visible=FALSE }

    { 1210190021;2;Field  ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 1210190011;2;Field  ;
                SourceExpr=City;
                Visible=FALSE }

    { 1210190015;2;Field  ;
                SourceExpr="Phone No.";
                Visible=FALSE }

    { 1210190017;2;Field  ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr="Project Type";
                Visible=FALSE }

    { 1100485006;2;Field  ;
                SourceExpr="Territory Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1210190005;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1210190023;2;Field  ;
                SourceExpr=Type;
                Visible=FALSE }

    { 1210190007;2;Field  ;
                SourceExpr="Project Manager" }

    { 11  ;2   ;Field     ;
                SourceExpr="Name Project Manager" }

    { 1101285000;2;Field  ;
                SourceExpr="Site Manager";
                Visible=FALSE }

    { 1101285002;2;Field  ;
                SourceExpr="Name Site Manager";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Search Description";
                Visible=FALSE }

    { 1101200000;2;Field  ;
                SourceExpr="Project Status" }

    { 1100485000;2;Field  ;
                SourceExpr="Small Project Status";
                Visible=FALSE }

    { 1100525008;2;Field  ;
                SourceExpr="Urgency Code";
                Visible=FALSE }

    { 1100485004;2;Field  ;
                SourceExpr="Action by";
                Visible=FALSE }

    { 1100525000;2;Field  ;
                SourceExpr="Single/Main/Sub Project";
                Visible=FALSE }

    { 1210190037;2;Field  ;
                SourceExpr="Main Project";
                Visible=FALSE }

    { 1100525065;2;Field  ;
                SourceExpr="Prognosis Level";
                Visible=FALSE }

    { 1100285001;2;Field  ;
                SourceExpr="Forecast Level";
                Visible=FALSE }

    { 1210190009;2;Field  ;
                CaptionML=[ENU=Try-Out No.;
                           NOR=Prospektnr;
                           SVE=Anbudsnr];
                SourceExpr=GetTryOut(1);
                Visible=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowTryOut(1);
                         END;
                          }

    { 1210190025;2;Field  ;
                CaptionML=[ENU=Try-Out Quote;
                           NOR=Tilbudsforesp›rsel;
                           SVE=Anbudsf”rfr†gan];
                SourceExpr=GetTryOut(2);
                Visible=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowTryOut(2);
                         END;
                          }

    { 1100485015;2;Field  ;
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 1100485023;2;Field  ;
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 1100485017;2;Field  ;
                SourceExpr="Requested Starting Time";
                Visible=FALSE }

    { 1100485002;2;Field  ;
                SourceExpr="Order No. Customer";
                Visible=FALSE }

    { 1100485010;2;Field  ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 1210190056;2;Field  ;
                SourceExpr="Offers Expired";
                Visible=FALSE }

    { 1210190043;2;Field  ;
                SourceExpr=Text;
                Visible=FALSE }

    { 1100285500;2;Field  ;
                SourceExpr="Settlement Method";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                CaptionML=[ENU=Profit %;
                           NOR=Bruttofortjeneste-%;
                           SVE=T„ckningsgrad %];
                SourceExpr=ProfitPct;
                Style=Attention;
                StyleExpr=NegBal }

    { 7   ;2   ;Field     ;
                CaptionML=[ENU=Profit/ Hour;
                           SVE=Projektsaldo/ tim];
                SourceExpr=ProfitHour;
                Style=Attention;
                StyleExpr=NegBal2 }

    { 9   ;2   ;Field     ;
                CaptionML=[ENU=Project Balance;
                           SVE=Projektsaldo];
                SourceExpr=ProjBalance;
                Style=Attention;
                StyleExpr=NegBal3 }

    { 1100285005;2;Field  ;
                CaptionML=SVE=Senaste prognos;
                SourceExpr=PrognosisRec."Prognosis Date";
                StyleExpr=PrognNotInPeriod }

    { 1100285006;2;Field  ;
                CaptionML=SVE=Senaste prognos (fast);
                SourceExpr=PrognosisRec.Fixed;
                Visible=false }

    { 1100285007;2;Field  ;
                CaptionML=[ENU=Prognosis margin %;
                           SVE=T„ckningsgrad prognos %];
                SourceExpr=GetPrognosisTB }

  }
  CODE
  {
    VAR
      ProjSetup@1100485000 : Record 315;
      ProjPrincipRec@11012000 : Record 11012005;
      TryOutRelationRec@1210190001 : Record 11012761;
      TryOutRelation@1210190008 : Code[20];
      TryOutQuoteRelation@1210190002 : Code[20];
      Text11012000@1210190004 : TextConst 'ENU=For this Project are no Sub Projects present;NOR=Det finnes ingen underprosjekt for dette prosjektet;SVE=Det finns inga underprojekt f”r det h„r projektet';
      gCopyServLoc@1210190000 : Boolean;
      DPA_IsHardFilter@1100000999 : Boolean;
      CopyButtonEnable@19014618 : Boolean INDATASET;
      NameHideValue@19054415 : Boolean INDATASET;
      Text11012001@1100525001 : TextConst 'ENU=Select Records First;NOR=Velg poster f›rst;SVE=V„lj poster f”rst';
      "*** 4PSSE"@1100285001 : TextConst;
      Text50000@1100285000 : TextConst 'ENU=Do you want create a sub project to project %1?;NOR=Vil du opprette ett underprosjekt til prosjekt %1?;SVE=Vill du skapa ett underprojekt till projekt %1?';
      ProfitPct@1000 : Decimal;
      ProfitHour@1001 : Decimal;
      ProjBalance@1002 : Decimal;
      DateFilter@1003 : Text[30];
      TextManagement@1004 : Codeunit 41;
      TestFieldCaption@1005 : Text;
      NegBal@1100285002 : Boolean INDATASET;
      NegBal2@1100285003 : Boolean INDATASET;
      NegBal3@1100285004 : Boolean INDATASET;
      Prognosis@1100285005 : Record 11012034;
      PrognosisRec@1100285006 : Record 11012034;
      PrognNotInPeriod@1100285300 : Text;
      SESetup@1100285301 : Record 11128004;
      CustButtonsVisible1@1100285305 : Boolean INDATASET;
      CustButtonsVisible2@1100285304 : Boolean INDATASET;
      CustButtonsVisible3@1100285303 : Boolean INDATASET;
      CustomSelectedbuttons@1100285302 : Record 11128006;

    PROCEDURE InitSelectionCopyServLoc@1210190001(lvCompName@1210190000 : Text[50]);
    BEGIN
      //**4PS
      gCopyServLoc := TRUE;
      CHANGECOMPANY(lvCompName);
    END;

    PROCEDURE CopyServiceLocation@1210190000();
    VAR
      Job@1100525000 : Record 11072003;
      ImexRec@1210190010 : Record 11012056;
      ProcID@1210190007 : Code[20];
      Text000@1210190009 : TextConst 'ENU=First select records.;NOR=Marker poster f›rst;SVE=Markera f”rst poster';
    BEGIN
      //**4PS
      CurrPage.SETSELECTIONFILTER(Job);
      IF NOT Job.FINDFIRST THEN BEGIN
        ERROR(Text000);
        EXIT;
      END;

      ProcID := 'GENSERVLOC_0';

      REPEAT
        ProcID := INCSTR(ProcID);
        ImexRec.INIT;
        ImexRec."User ID" := USERID;
        ImexRec."Process ID" := ProcID;
        ImexRec.Type := ImexRec.Type::Export;
        ImexRec.Description := 'Job';
        ImexRec.Condition := Job."No.";
        ImexRec.INSERT;
      UNTIL Job.NEXT = 0;
    END;

    PROCEDURE OptionList@1210190006();
    VAR
      lvOptionRec@1210190000 : Record 11012502;
    BEGIN
      //**4PS
      lvOptionRec.FILTERGROUP(9);
      lvOptionRec.SETRANGE("Project No.", "No.");
      lvOptionRec.FILTERGROUP(0);
      lvOptionRec.SETRANGE("Plot No.", '');

      PAGE.RUNMODAL(PAGE::"Project Option List", lvOptionRec);
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      IF NOT "Small Project" THEN
        NameHideValue := TRUE;
    END;

    PROCEDURE GetRecordSet@1100528601(VAR Job@1100528600 : Record 11072003);
    BEGIN
      //**4PS
      CurrPage.SETSELECTIONFILTER(Job);
    END;

    PROCEDURE CalculateProjectValues@2();
    VAR
      JobLedgerEntry@1000 : Record 11072005;
      Hours@1001 : Decimal;
      Revenue@1002 : Decimal;
    BEGIN
      ProfitPct :=0;
      ProfitHour := 0;
      ProjBalance :=0;
      Hours := 0;
      Revenue :=0;
      // JobLedgerEntry.RESET;
      // JobLedgerEntry.SETCURRENTKEY("Job No.","Posting Date");
      //JobLedgerEntry.SETRANGE("Job No.","No.");
      //Job.GET(ProjNo);
      IF "Single/Main/Sub Project"="Single/Main/Sub Project"::"Main Project" THEN BEGIN
        JobLedgerEntry.SETCURRENTKEY("Main Project No.","Entry Type","Cost Type","Posting Date");
        JobLedgerEntry.SETRANGE("Main Project No.","No.");
      END
      ELSE BEGIN
        JobLedgerEntry.SETCURRENTKEY("Job No.","Entry Type","Cost Type","Extension Contract","Posting Date");
        JobLedgerEntry.SETRANGE("Job No.","No.");
      END;

      IF DateFilter <> '' THEN
        JobLedgerEntry.SETFILTER("Posting Date",DateFilter);

      // IF JobLedgerEntry.FIND('-') THEN REPEAT
      //  ProjBalance -= JobLedgerEntry."Total Cost (LCY)" + JobLedgerEntry."Total Price (LCY)";
      //  IF JobLedgerEntry."Cost Type" = JobLedgerEntry."Cost Type"::Labor THEN
      //    Hours += JobLedgerEntry.Quantity;
      //  IF JobLedgerEntry."Cost Type" = JobLedgerEntry."Cost Type"::Revenues THEN
      //    Revenue -= JobLedgerEntry."Total Price (LCY)";
      // UNTIL JobLedgerEntry.NEXT=0;
      IF JobLedgerEntry.FINDSET THEN BEGIN
        JobLedgerEntry.CALCSUMS("Total Cost (LCY)" ,"Total Price (LCY)");
        ProjBalance -= JobLedgerEntry."Total Cost (LCY)" + JobLedgerEntry."Total Price (LCY)";
      END;
      JobLedgerEntry.SETRANGE("Cost Type", JobLedgerEntry."Cost Type"::Labor );
      IF JobLedgerEntry.FINDSET THEN BEGIN
        JobLedgerEntry.CALCSUMS(Quantity);
        Hours += JobLedgerEntry.Quantity;
      END;
      JobLedgerEntry.SETRANGE("Cost Type", JobLedgerEntry."Cost Type"::Revenues);
      IF JobLedgerEntry.FINDSET THEN BEGIN
        JobLedgerEntry.CALCSUMS("Total Price (LCY)");
        Revenue -= JobLedgerEntry."Total Price (LCY)";
      END;
      JobLedgerEntry.SETRANGE("Cost Type");

      IF Hours <> 0 THEN
        ProfitHour := ROUND(ProjBalance / Hours,1,'=');

      IF Revenue <> 0 THEN
        ProfitPct:=ROUND((100 * (ProjBalance / Revenue)),0.01,'=');

      // IF ProfitPct<0 THEN
      //  NegBal:=TRUE
      // ELSE
      //  NegBal:=FALSE;
      //
      // IF ProfitHour<0 THEN
      //  NegBal2:=TRUE
      // ELSE
      //  NegBal2:=FALSE;
      //
      // IF ProjBalance<0 THEN
      //  NegBal3:=TRUE
      // ELSE
      //  NegBal3:=FALSE;
      NegBal:= ProfitPct<0;
      NegBal2:=ProfitHour<0;
      NegBal3:=ProjBalance<0;

      PrognosisRec.SETRANGE("Project No.","No.");
      IF PrognosisRec.FINDLAST THEN BEGIN
      END ELSE
        CLEAR(PrognosisRec);

      //>> 170215 ITERO.SB RAD-053
      CLEAR(SESetup);
      SESetup.SETRANGE("Line type",SESetup."Line type"::Setup);
      SESetup.SETRANGE(Code,'PROJLIST');
      SESetup.SETRANGE("Code 2",'COLOR');
      IF SESetup.FINDFIRST THEN BEGIN
        IF (PrognosisRec."Prognosis Date" >=  CALCDATE(SESetup."Value (txt)",DMY2DATE(1,DATE2DMY(TODAY,2),DATE2DMY(TODAY,3)))) AND (PrognosisRec."Prognosis Date" <= CALCDATE('<CM>',TODAY))THEN
          PrognNotInPeriod:= 'Favorable'
        ELSE
          PrognNotInPeriod:= 'Attention';

        IF "Project Status" > "Project Status"::"Technical Finished" THEN
          PrognNotInPeriod:= 'Favorable'
      END;
      //<<
    END;

    LOCAL PROCEDURE GetPrognosisTB@1100285000() : Decimal;
    VAR
      Prognosis@1100285000 : Record 11012034;
      FinRes@1101285000 : Decimal;
    BEGIN
      //>> 171205 Fix calc. in GetPrognosisTB
      //>>160607 ITERO.SB RAD-005 Added function GetPrognosisTB (show prognosis margin in project list)

      Prognosis.SETRANGE("Project No.", "No.");
      IF Prognosis.FINDLAST THEN BEGIN
        Prognosis.CALCFIELDS("Prognosis Revenue","Prognosis Total Cost");
        FinRes := (Prognosis."Prognosis Revenue" + Prognosis."Project Invoiced") - Prognosis."Prognosis Total Cost";
        IF Prognosis."Prognosis Revenue" + Prognosis."Project Invoiced" <> 0 THEN
          EXIT((FinRes/(Prognosis."Prognosis Revenue" + Prognosis."Project Invoiced"))*100)
        ELSE
          EXIT(0);
      END ELSE
        EXIT(0);

      //<<
    END;

    BEGIN
    {
      4PS
      - two buttons (Prices and Planning) removed.
      - 23-02-10 DocumentButton added for intercompany projects
      4PS01 MMA 20100412
        Function added GetSelectionFilter
      4PS, 02-01-2014, C011191, Action 'Card' added.
      IMSE-041  -Itero
      LP 130704 4PSSE Added new action for "Create Sub Project".
      140325, ITERO.DL, ENH-025, added "Settlement Method", visible =no
      140612, ITERO.DL, removed all FlowFields due to performance and 1 CALCFIELDS(Revenues)
            (Re)Print Option List
            Budgetted Options in Order
            Contract Amount
            Invoiced Price
            Name Buyer Contact
            Name Estimator
            Name Project Engineer
            Name Project Manager
            Name Purchaser
            Name Site Manager
            Number of Options in Order
            Number of Options Open
            Principal Name
            Urgency Description
            Revenues
      ITERO.WG 4PS-042 140711 Added page acion OpenProjectControlSummarized and OpenProjectControlOverview
      160607 ITERO.SB RAD-005 Added function GetPrognosisTB (show prognosis margin in project list)
      160921 ITERO.SB RAD-029, RAD-030, RAD-030
      162212 ITERO.FH RAD-049 Change in Swedish CaptionML
      170215 ITERO.SB RAD-053 Highlight prognosis date if not in period (act. month)
      170905 ITERO.SB Added filtergroups
      171205 Fix calc. in GetPrognosisTB
      190604 ORANGO.EE Added fields "Site Manager" and "Name Site Manager"
      190819 ORANGO.DL performance issues in CalculateProjectValues
      191209 ORANGO.DL BYGG #25624 all PDFs to one PDF, new button
      191209 ORANGO.DL BYGG #27004 extend filter for external users
      200430 ORANGO.EE Added CaptionML to "Projektkontroll" button
    }
    END.
  }
}

