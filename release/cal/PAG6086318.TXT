OBJECT Page 6086318 Expense Card
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EMW16.00.10.3.00.07;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Ausgaben;
               ENU=Expenses;
               NLD=Uitgaven];
    SourceTable=Table6086320;
    PopulateAllFields=Yes;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[DEU=Neu, Prozess, Bericht, Ausgaben, Verwaltung;
                                ENU=New,Process,Report,Expense,Administration;
                                NLD=Nieuw,Verwerk,Rapport,Uitgave,Administratie];
    OnOpenPage=VAR
                 UserResp@1160040001 : Record 6086379;
                 EMOnlineMgt@6086300 : Codeunit 6086305;
                 EMNavVersionMgt@6086301 : Codeunit 6086319;
                 UpgradeMgt@1160040000 : Codeunit 6086334;
               BEGIN
                 EMOnlineMgt.IsCompanyActive(FALSE);
                 UpgradeMgt.CheckDataVersion;
                 EnableFields;
                 ShowBankIntegration := BankIntegrationExists;
                 EnablePostingPreview := EMNavVersionMgt.CheckPreviewAllowed(FALSE);

                 IF UserResp.GetResponsibilityFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETFILTER("Continia User ID",UserResp.GetResponsibilityFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       HasComments := HasApprovalComment OR HasExpenseComment;
                       ShortcutFieldFunctions.ShowShortcutFieldValues(ShortcutFieldValues,DATABASE::Expense,0,'',"Entry No.");
                     END;

    OnInsertRecord=VAR
                     Rec2@1160040000 : Record 6086320;
                   BEGIN
                     IF Rec2.FINDLAST THEN;
                     "Entry No." := Rec2."Entry No." + 1;
                     "Created By User ID" := USERID;
                     IF "Document Date" = 0D THEN
                       "Document Date" := TODAY;
                     IF NOT "Matched to Bank Transaction" THEN
                       "Cash/Private Card" := TRUE;
                   END;

    OnModifyRecord=BEGIN
                     SendToExpenseUser;
                   END;

    ActionList=ACTIONS
    {
      { 1160040074;  ;ActionContainer;
                      Name=RelatedInformation;
                      CaptionML=;
                      ActionContainerType=RelatedInformation }
      { 1160040071;1 ;ActionGroup;
                      Name=Expense;
                      CaptionML=[DEU=A&usgaben;
                                 ENU=E&xpense;
                                 NLD=Uitgave] }
      { 1160040070;2 ;Action    ;
                      Name=Expense Inbox;
                      CaptionML=[DEU=Eingangsfach fÅr Ausgaben;
                                 ENU=Expense Inbox;
                                 NLD=Uitgave inbox];
                      Promoted=Yes;
                      Image=ErrorLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Expense Inbox");
                               END;
                                }
      { 1160040069;2 ;Action    ;
                      Name=Attachments;
                      ShortCutKey=Shift+Ctrl+T;
                      CaptionML=[DEU=AnhÑnge;
                                 ENU=Attachments;
                                 NLD=Bijlagen];
                      Promoted=Yes;
                      Image=Attachments;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowAttachments;
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040068;2 ;Action    ;
                      Name=Dimensions;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions;
                                 NLD=Dimensies];
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 LookupDimensions(TRUE);
                               END;
                                }
      { 1160040067;2 ;Action    ;
                      Name=Extra Fields;
                      CaptionML=[DEU=ZusÑtzliche Felder;
                                 ENU=Extra Fields;
                                 NLD=Extra velden];
                      Image=SelectField;
                      OnAction=BEGIN
                                 LookupExtraFields(TRUE);
                               END;
                                }
      { 1160040066;2 ;Action    ;
                      Name=Attendees;
                      CaptionML=[DEU=Statusfilter;
                                 ENU=Attendees;
                                 NLD=Deelnemers];
                      Image=Users;
                      OnAction=BEGIN
                                 DrillDownAttendees;
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1160040063;2 ;Separator  }
      { 1160040059;2 ;Action    ;
                      Name=Approvals;
                      CaptionML=[DEU=Genehmigungen;
                                 ENU=Approvals;
                                 NLD=Goedkeuringen];
                      Image=Approvals;
                      OnAction=BEGIN
                                 EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Expense,FORMAT("Entry No."));
                               END;
                                }
      { 1160040058;  ;ActionContainer;
                      Name=ActionItems;
                      CaptionML=[DEU=&Bank;
                                 ENU=&Bank;
                                 NLD=Bank];
                      ActionContainerType=ActionItems }
      { 1160040055;1 ;ActionGroup;
                      Name=Bank;
                      CaptionML=[DEU=&Bank;
                                 ENU=&Bank;
                                 NLD=Bank] }
      { 1160040054;2 ;Action    ;
                      Name=Bank Transaction Inbox;
                      CaptionML=[DEU=Eingangsfach fÅr Banktransaktionen;
                                 ENU=Bank Transaction Inbox;
                                 NLD=Banktransactieinbox];
                      Promoted=Yes;
                      Visible=ShowBankIntegration;
                      PromotedIsBig=No;
                      Image=ErrorLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Bank Transaction Inbox");
                               END;
                                }
      { 1160040052;2 ;Action    ;
                      Name=Bank Transaction;
                      CaptionML=[DEU=Banktransaktion;
                                 ENU=Bank Transaction;
                                 NLD=Banktransactie];
                      Visible=ShowBankIntegration;
                      Image=BankAccount;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BankTransaction@1160040001 : Record 6086330;
                               BEGIN
                                 BankTransaction.SETRANGE("Matched to Expense",FALSE);
                                 PAGE.RUN(6086332,BankTransaction);
                               END;
                                }
      { 1160040051;1 ;ActionGroup;
                      Name=Functions;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions;
                                 NLD=F&unctie] }
      { 1160040050;2 ;Action    ;
                      Name=Reopen;
                      CaptionML=[DEU=Stat&us zurÅcksetzen;
                                 ENU=Re&open;
                                 NLD=Heropenen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense2@1160040003 : Record 6086320;
                               BEGIN
                                 TESTFIELD("Settlement No.",'');
                                 TESTFIELD(Posted,FALSE);
                                 IF NOT CONFIRM(ConfirmReopen,TRUE,1) THEN
                                   EXIT;

                                 Expense2 := Rec;
                                 IF NOT Posted THEN
                                   CODEUNIT.RUN(CODEUNIT::"Expense - Complete",Expense2);

                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040049;2 ;Action    ;
                      Name=Send to Expense User;
                      ShortCutKey=Shift+Ctrl+X;
                      CaptionML=[DEU=An &Ausgabenbenutzer senden;
                                 ENU=Send to E&xpense User;
                                 NLD=Verzenden naar gebruiker];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendTo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 EmOnlineMgt@1160040005 : Codeunit 6086305;
                               BEGIN
                                 TESTFIELD("Settlement No.",'');
                                 TESTFIELD(Posted,FALSE);
                                 IF Status = Status::Open THEN
                                   IF IsSyncRequired THEN
                                     IF CONFIRM(SyncRequired,TRUE) THEN
                                       EmOnlineMgt.SetupCloud
                                     ELSE
                                       ERROR('');

                                 CODEUNIT.RUN(CODEUNIT::"Expense - Send to Expense User",Rec);
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040048;2 ;Action    ;
                      Name=Send for Approval;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[DEU=Zur &Genehmigung senden;
                                 ENU=Send for &Approval;
                                 NLD=Verzend ter goedkeuring];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                               BEGIN
                                 TESTFIELD(Posted,FALSE);

                                 Expense := Rec;
                                 Expense.TESTFIELD("Settlement No.",'');
                                 Expense.SETRANGE("Entry No.",Expense."Entry No.");
                                 EMApprovalsBridge.SendExpApprovalRequest(Expense);
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040047;2 ;Action    ;
                      Name=Force Approval;
                      CaptionML=[DEU=&Genehmigung erzwingen;
                                 ENU=&Force Approval;
                                 NLD=&Forceer goedkeuring];
                      Promoted=Yes;
                      Image=Approval;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040003 : Record 6086320;
                               BEGIN
                                 Expense := Rec;
                                 TESTFIELD("Settlement No.",'');
                                 TESTFIELD(Posted,FALSE);

                                 IF NOT CONFIRM(ContForceRelease,TRUE) THEN
                                   EXIT;

                                 Expense.TESTFIELD(Status,Expense.Status::Open);
                                 EMApprovalsBridge.CancelApprovalRequest(DATABASE::Expense,FORMAT(Expense."Entry No."));
                                 EMApprovalsBridge.ForceApproval(DATABASE::Expense,FORMAT(Expense."Entry No."));

                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040042;2 ;Separator  }
      { 1160040040;2 ;Action    ;
                      Name=Forward Approval;
                      Ellipsis=Yes;
                      CaptionML=[DEU=&Genehmigung weiterleiten;
                                 ENU=&Forward Approval;
                                 NLD=Doorsturen goedkeuring];
                      Image=Delegate;
                      OnAction=BEGIN
                                 TESTFIELD("Settlement No.",'');
                                 TESTFIELD(Posted,FALSE);

                                 EMApprovalsBridge.Forward(DATABASE::Expense,FORMAT("Entry No."));
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040039;2 ;Separator  }
      { 1160040038;2 ;Action    ;
                      Name=Expense Split and Allocation;
                      ShortCutKey=Shift+Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Trennen und Zuweisen von Ausgaben;
                                 ENU=Expense Split and Allocation;
                                 NLD=Uitgavensplitsing en allocatie];
                      Promoted=Yes;
                      Image=Split;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ExpAllocation@1160040001 : Record 6086321;
                                 ExpSplitAndAllocationPage@1160040000 : Page 6086320;
                               BEGIN
                                 TESTFIELD(Posted,FALSE);

                                 ExpAllocation.SETRANGE("Expense Entry No.","Entry No.");
                                 ExpSplitAndAllocationPage.SETTABLEVIEW(ExpAllocation);
                                 ExpSplitAndAllocationPage.RUNMODAL;

                                 CurrPage.UPDATE;
                               END;
                                }
      { 1160040036;2 ;Action    ;
                      Name=Match Bank Transaction;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Banktransaktion abgleichen;
                                 ENU=Match Bank Transaction;
                                 NLD=Match banktransactie];
                      Promoted=Yes;
                      Visible=ShowBankIntegration;
                      Image=SettleOpenTransactions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 TESTFIELD(Posted,FALSE);
                                 MatchToBankTrans;

                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040035;2 ;Separator  }
      { 1160040033;2 ;Action    ;
                      Name=Synchronize;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[DEU=Synchronisieren;
                                 ENU=Synchronize;
                                 NLD=Synchroniseer];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"EM Online Mgt.");

                                 CheckUnProcessedInbox;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1160040031;2 ;Separator  }
      { 1160040030;2 ;Action    ;
                      Name=Send Reminder E-mail;
                      CaptionML=[DEU=Erinnerungs-E-Mail senden;
                                 ENU=Send Reminder &E-mail;
                                 NLD=Verzend herinneringse-mail];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendConfirmation;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 Expense@1160040002 : Record 6086320;
                                 ReminderEmail@1160040003 : Codeunit 6086314;
                                 OptionNo@1160040001 : Integer;
                               BEGIN
                                 OptionNo := STRMENU(Options,1,Instructions);

                                 IF OptionNo = 0 THEN
                                   EXIT;

                                 IF OptionNo = 2 THEN
                                   CurrPage.SETSELECTIONFILTER(Expense)
                                 ELSE
                                   Expense.RESET;
                                 ReminderEmail.SendExpNotificationEmails(Expense,OptionNo = 2);
                               END;
                                }
      { 1160040027;2 ;Action    ;
                      Name=Move to another company;
                      CaptionML=[DEU=Zu anderem Unternehmen verschieben;
                                 ENU=Move to another company;
                                 NLD=Verplaats naar een ander bedrijf];
                      Image=Intercompany;
                      OnAction=VAR
                                 MoveToCompany@1160040000 : Codeunit 6086359;
                                 RecRef@1160040002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 MoveToCompany.HandleMovement(RecRef);

                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040026;1 ;ActionGroup;
                      Name=Posting;
                      CaptionML=[DEU=Bu&chung;
                                 ENU=P&osting;
                                 NLD=Boeken] }
      { 1160040024;2 ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[DEU=Bu&chen;
                                 ENU=P&ost;
                                 NLD=B&oeken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewInvoice;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Expense@1160040000 : Record 6086320;
                               BEGIN
                                 Expense := Rec;
                                 CODEUNIT.RUN(CODEUNIT::"Expense-Post (Yes/No)",Expense);
                                 CurrPage.UPDATE(FALSE);

                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040022;2 ;Action    ;
                      Name=Post Batch;
                      Ellipsis=Yes;
                      CaptionML=[DEU=&Stapelbuchen;
                                 ENU=Post &Batch;
                                 NLD=B&atchboeken];
                      Promoted=Yes;
                      Image=PostBatch;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Expenses",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);

                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 6086301 ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[DEU=Buchungsvorschau;
                                 ENU=Preview Posting;
                                 NLD=Boekingsvoorbeeld];
                      Promoted=No;
                      Enabled=EnablePostingPreview;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 Expense@6086301 : Record 6086320;
                                 ExpensePostYesNo@6086300 : Codeunit 6086331;
                               BEGIN
                                 Expense := Rec;
                                 ExpensePostYesNo.Preview(Expense);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 1160040000;1;Group  ;
                CaptionML=[DEU=Allgemein;
                           ENU=General;
                           NLD=Algemeen];
                GroupType=Group }

    { 1160040003;2;Field  ;
                Name=Continia User ID;
                SourceExpr="Continia User ID" }

    { 1160040045;2;Field  ;
                Name=Continia User Name;
                SourceExpr="Continia User Name";
                Visible=FALSE;
                OnLookup=VAR
                           UserResp@1160040002 : Record 6086379;
                         BEGIN
                           EXIT(UserResp.LookupUser(Text));
                         END;
                          }

    { 1160040007;2;Field  ;
                Name=Description;
                SourceExpr=Description }

    { 1160040046;2;Field  ;
                Name=Description 2;
                SourceExpr="Description 2";
                Visible=FALSE }

    { 1160040009;2;Field  ;
                Name=Admin Comment;
                SourceExpr="Admin Comment" }

    { 1160040061;2;Field  ;
                Name=AttendeesDisplayText;
                CaptionML=[DEU=Statusfilter;
                           ENU=Attendees;
                           NLD=Deelnemers];
                SourceExpr=GetAttendeesForDisplay;
                Importance=Additional;
                OnDrillDown=BEGIN
                              DrillDownAttendees;
                              CurrPage.UPDATE(TRUE);
                            END;
                             }

    { 1160040072;2;Field  ;
                Name=Business Description;
                SourceExpr="Business Description";
                Importance=Additional }

    { 1160040011;2;Field  ;
                Name=Document Date;
                SourceExpr="Document Date" }

    { 1160040034;2;Field  ;
                Name=Expense Type;
                SourceExpr="Expense Type";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040053;2;Field  ;
                Name=Currency Code;
                SourceExpr="Currency Code" }

    { 1160040005;2;Field  ;
                Name=Amount;
                SourceExpr=Amount }

    { 1160040013;2;Field  ;
                Name=Amount (LCY);
                SourceExpr="Amount (LCY)" }

    { 1160040017;2;Field  ;
                Name=Cash/Private Card;
                SourceExpr="Cash/Private Card";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040056;2;Field  ;
                Name=Job No.;
                SourceExpr="Job No.";
                Visible=JobNoVisible }

    { 1160040057;2;Field  ;
                Name=Job Task No.;
                SourceExpr="Job Task No.";
                Visible=JobNoVisible }

    { 1160040037;2;Field  ;
                Name=Billable;
                SourceExpr=Billable }

    { 1160040029;2;Field  ;
                Name=Job Line Type;
                SourceExpr="Job Line Type" }

    { 1160040025;2;Field  ;
                Name=On Hold;
                SourceExpr="On Hold" }

    { 1160040023;2;Field  ;
                Name=ApprovalEntries;
                CaptionML=[DEU=Genehmigungsposten;
                           ENU=Approval Entries;
                           NLD=Goedkeuringsposten];
                BlankZero=Yes;
                SourceExpr=EMApprovalMgt.GetNoOfApprovalEntries(DATABASE::Expense,FORMAT("Entry No."));
                OnDrillDown=BEGIN
                              EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Expense,FORMAT("Entry No."));
                            END;
                             }

    { 1160040020;2;Field  ;
                Name=ApprovalComments;
                CaptionML=[DEU=Genehmigungskommentare;
                           ENU=Approval Comments;
                           NLD=Goedkeuringsopmerkingen];
                BlankZero=Yes;
                SourceExpr=EMApprovalMgt.GetNoOfApprovalComments(DATABASE::Expense,FORMAT("Entry No."));
                OnDrillDown=BEGIN
                              EMApprovalMgt.DrillDownExpenseAppCmts(Rec);
                            END;
                             }

    { 1160040073;2;Field  ;
                Name=Status;
                SourceExpr=Status }

    { 1160040087;2;Field  ;
                Name=ApprovalBy;
                CaptionML=[DEU=Genehmigung durch;
                           ENU=Approval by;
                           NLD=Goedkeuring door];
                SourceExpr=EMApprovalMgt.GetNextApproverName(DATABASE::Expense,FORMAT("Entry No."));
                OnDrillDown=BEGIN
                              EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Expense,FORMAT("Entry No."));
                            END;
                             }

    { 1160040064;2;Field  ;
                Name=No. of Attachments;
                SourceExpr="No. of Attachments";
                Importance=Additional }

    { 1160040021;1;Group  ;
                CaptionML=[DEU=Dimensionen;
                           ENU=Dimensions;
                           NLD=Dimensies];
                GroupType=Group }

    { 1160040019;2;Field  ;
                Name=Global Dimension 1 Code;
                SourceExpr="Global Dimension 1 Code" }

    { 1160040018;2;Field  ;
                Name=Global Dimension 2 Code;
                SourceExpr="Global Dimension 2 Code" }

    { 1160040016;2;Field  ;
                Name=ShortcutFieldValues1;
                SourceExpr=ShortcutFieldValues[1];
                CaptionClass=GetShortcutFieldCaption(1);
                Visible=CustomfieldVisible1;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(1,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[1]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(1,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040015;2;Field  ;
                Name=ShortcutFieldValues2;
                SourceExpr=ShortcutFieldValues[2];
                CaptionClass=GetShortcutFieldCaption(2);
                Visible=CustomfieldVisible2;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(2,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[2]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(2,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040014;2;Field  ;
                Name=ShortcutFieldValues3;
                SourceExpr=ShortcutFieldValues[3];
                CaptionClass=GetShortcutFieldCaption(3);
                Visible=CustomfieldVisible3;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(3,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[3]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(3,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040012;2;Field  ;
                Name=ShortcutFieldValues4;
                SourceExpr=ShortcutFieldValues[4];
                CaptionClass=GetShortcutFieldCaption(4);
                Visible=CustomfieldVisible4;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(4,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[4]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(4,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040010;2;Field  ;
                Name=ShortcutFieldValues5;
                SourceExpr=ShortcutFieldValues[5];
                CaptionClass=GetShortcutFieldCaption(5);
                Visible=CustomfieldVisible5;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(5,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[5]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(5,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040008;2;Field  ;
                Name=ShortcutFieldValues6;
                SourceExpr=ShortcutFieldValues[6];
                CaptionClass=GetShortcutFieldCaption(6);
                Visible=CustomfieldVisible6;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(6,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[6]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(6,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040006;2;Field  ;
                Name=ShortcutFieldValues7;
                SourceExpr=ShortcutFieldValues[7];
                CaptionClass=GetShortcutFieldCaption(7);
                Visible=CustomfieldVisible7;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(7,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[7]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(7,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040004;2;Field  ;
                Name=ShortcutFieldValues8;
                SourceExpr=ShortcutFieldValues[8];
                CaptionClass=GetShortcutFieldCaption(8);
                Visible=CustomfieldVisible8;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(8,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[8]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(8,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040002;2;Field  ;
                Name=ShortcutFieldValues9;
                SourceExpr=ShortcutFieldValues[9];
                CaptionClass=GetShortcutFieldCaption(9);
                Visible=CustomfieldVisible9;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(9,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[9]);
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(9,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                           SendToExpenseUser;
                         END;
                          }

    { 1160040001;2;Field  ;
                Name=ShortcutFieldValues10;
                SourceExpr=ShortcutFieldValues[10];
                CaptionClass=GetShortcutFieldCaption(10);
                Visible=CustomfieldVisible10;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(10,DATABASE::Expense,0,'',"Entry No.",ShortcutFieldValues[10]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(10,DATABASE::Expense,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040028;1;Group  ;
                CaptionML=[DEU=Buchung;
                           ENU=Posting;
                           NLD=Boeken];
                GroupType=Group }

    { 1160040032;2;Field  ;
                Name=Gen. Prod. Posting Group;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1160040043;2;Field  ;
                Name=VAT Prod. Posting Group;
                SourceExpr="VAT Prod. Posting Group" }

    { 1160040044;2;Field  ;
                Name=Gen. Bus. Posting Group;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=false }

    { 1160040062;2;Field  ;
                Name=VAT Bus. Posting Group;
                SourceExpr="VAT Bus. Posting Group";
                Visible=false }

    { 1160040076;2;Field  ;
                Name=No Refund;
                SourceExpr="No Refund" }

    { 1160040075;2;Field  ;
                Name=Country/Region Code;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 1160040065;2;Field  ;
                Name=Expense Account Type;
                SourceExpr="Expense Account Type";
                OnLookup=BEGIN
                           EXIT(LookupPostingAccount(Text));
                         END;
                          }

    { 1160040060;2;Field  ;
                Name=Expense Account;
                SourceExpr="Expense Account";
                OnLookup=BEGIN
                           EXIT(LookupPostingAccount(Text));
                         END;
                          }

    { 1160040089;2;Field  ;
                Name=Matched to Bank Transaction;
                SourceExpr="Matched to Bank Transaction" }

    { 1160040090;2;Field  ;
                Name=Bank-Currency Amount;
                SourceExpr="Bank-Currency Amount" }

    { 1160040091;2;Field  ;
                Name=Bank Currency Code;
                SourceExpr="Bank Currency Code" }

    { 1160040092;2;Field  ;
                Name=Allocated Amount (LCY);
                SourceExpr="Allocated Amount (LCY)" }

    { 1160040093;2;Field  ;
                Name=Posted;
                SourceExpr=Posted }

    { 1160040094;2;Field  ;
                Name=Posted Date/Time;
                SourceExpr="Posted Date/Time" }

    { 1160040095;2;Field  ;
                Name=Posted by User ID;
                SourceExpr="Posted by User ID" }

    { 1160040041;1;Part   ;
                Name=Expense Comment Subpage;
                SubPageLink=Doc. Ref. No.=FIELD(Entry No.),
                            Table ID=CONST(6086320);
                PagePartID=Page6086361;
                Editable=false;
                PartType=Page }

    { 2   ;    ;Container ;
                Name=FactBoxArea;
                ContainerType=FactBoxArea }

    { 1   ;1   ;Part      ;
                Name=CaptureUI;
                CaptionML=[DEU=AnhÑnge;
                           ENU=Attachments;
                           NLD=Bijlagen];
                SubPageLink=Entry No.=FIELD(Entry No.);
                PagePartID=Page6086339;
                PartType=Page }

  }
  CODE
  {
    VAR
      ShortcutFieldFunctions@1160040010 : Codeunit 6086304;
      EMApprovalMgt@1160040000 : Codeunit 6086312;
      EMApprovalsBridge@1000 : Codeunit 6086369;
      CustomFieldNames@1160040006 : ARRAY [10] OF Text[50];
      ShortcutFieldCaptions@1160040001 : ARRAY [10] OF Text[250];
      ShortcutFieldValues@1160040002 : ARRAY [10] OF Text[250];
      CustomFieldVisible1@1160040005 : Boolean INDATASET;
      CustomFieldVisible10@1009 : Boolean INDATASET;
      CustomFieldVisible2@1001 : Boolean INDATASET;
      CustomFieldVisible3@1002 : Boolean INDATASET;
      CustomFieldVisible4@1003 : Boolean INDATASET;
      CustomFieldVisible5@1004 : Boolean INDATASET;
      CustomFieldVisible6@1005 : Boolean INDATASET;
      CustomFieldVisible7@1006 : Boolean INDATASET;
      CustomFieldVisible8@1007 : Boolean INDATASET;
      CustomFieldVisible9@1008 : Boolean INDATASET;
      EnablePostingPreview@6086300 : Boolean INDATASET;
      HasComments@1160040019 : Boolean;
      JobNoVisible@1160040003 : Boolean INDATASET;
      ShowBankIntegration@1160040008 : Boolean INDATASET;
      ConfirmReopen@1160040026 : TextConst 'DEU=Mîchten Sie diese Ausgabe erneut îffnen?;ENU=Do you want to reopen this expense?;NLD=Wilt u de uitgave heropenen?';
      ContForceRelease@1160040021 : TextConst 'DEU=Mîchten Sie die Genehmigung dieser Ausgabe erzwingen?;ENU=Do you want to force the approval of this expense?;NLD=Wilt u de goedkeuring van deze uitgave forceren?';
      Instructions@1160040009 : TextConst 'DEU=Mîchten Sie eine Status-E-Mail an alle oder nur an die ausgewÑhlten Benutzer senden?;ENU=Do you want to send a status e-mail to all the Users or only to the selected ones?;NLD=Wilt u een status e-mail verzenden aan alle gebruikers of alleen aan de geselecteerde gebruikers?';
      Options@1160040015 : TextConst 'DEU=An alle Benutzer senden, Nur an ausgewÑhlte Benutzer senden (erzwungen);ENU=Send to All Users,Send to Selected Users only (forced);NLD=Verzend naar alle gebruikers,Verzend naar geselecteerde gebruikers (geforceerd)';
      SyncRequired@1160040012 : TextConst 'DEU=Diese Ausgabe enthÑlt Werte, die nicht zu Continia Online synchronisiert wurden. Dies ist erforderlich, bevor die Ausgabe an den Ausgabenbenutzer gesendet werden kann.\\Mîchten Sie die Werte mit Continia Online synchronisieren?;ENU=This expense contains values that have not been synchronized to Continia Online. This is required before this expense can be sent to the expense user.\\Would you like to synchronize values with Continia Online?;NLD=Deze uitgave bevat waarden die niet met Continia Online gesynchroniseerd zijn. Dit is een verplicht voordat u de uitgave naar de gebruiker kunt verzenden.\\Wilt u met Continia Online synchroniseren?';

    LOCAL PROCEDURE EnableFields@1160040003();
    VAR
      EMSetup@1160040000 : Record 6086300;
    BEGIN
      EMSetup.GET;
      CustomFieldNames[1] := EMSetup."Shortcut Field 1 Code (Exp.)";
      CustomFieldNames[2] := EMSetup."Shortcut Field 2 Code (Exp.)";
      CustomFieldNames[3] := EMSetup."Shortcut Field 3 Code (Exp.)";
      CustomFieldNames[4] := EMSetup."Shortcut Field 4 Code (Exp.)";
      CustomFieldNames[5] := EMSetup."Shortcut Field 5 Code (Exp.)";
      CustomFieldNames[6] := EMSetup."Shortcut Field 6 Code (Exp.)";
      CustomFieldNames[7] := EMSetup."Shortcut Field 7 Code (Exp.)";
      CustomFieldNames[8] := EMSetup."Shortcut Field 8 Code (Exp.)";
      CustomFieldNames[9] := EMSetup."Shortcut Field 9 Code (Exp.)";
      CustomFieldNames[10] := EMSetup."Shortcut Field 10 Code (Exp.)";

      CustomFieldVisible1 := CustomFieldNames[1] <> '';
      CustomFieldVisible2 := CustomFieldNames[2] <> '';
      CustomFieldVisible3 := CustomFieldNames[3] <> '';
      CustomFieldVisible4 := CustomFieldNames[4] <> '';
      CustomFieldVisible5 := CustomFieldNames[5] <> '';
      CustomFieldVisible6 := CustomFieldNames[6] <> '';
      CustomFieldVisible7 := CustomFieldNames[7] <> '';
      CustomFieldVisible8 := CustomFieldNames[8] <> '';
      CustomFieldVisible9 := CustomFieldNames[9] <> '';
      CustomFieldVisible10 := CustomFieldNames[10] <> '';

      JobNoVisible := ShortcutFieldFunctions.JobNoVisible(DATABASE::Expense);
    END;

    LOCAL PROCEDURE GetShortcutFieldCaption@1160040001(ShortcutFieldNo@1160040000 : Integer) : Text[250];
    BEGIN
      IF ShortcutFieldCaptions[1] = '' THEN
        ShortcutFieldFunctions.GetShortcutFieldCaptionsArray(ShortcutFieldCaptions,DATABASE::Expense);

      EXIT(ShortcutFieldCaptions[ShortcutFieldNo]);
    END;

    BEGIN
    END.
  }
}

