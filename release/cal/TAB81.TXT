OBJECT Table 81 Gen. Journal Line
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.04,4PS14.00,NAVSE.FI.DK.NO,4PSSE;
  }
  PROPERTIES
  {
    Permissions=TableData 17=rm,
                TableData 112=r,
                TableData 1221=rimd;
    OnInsert=BEGIN
               GenJnlAlloc.LOCKTABLE;
               LOCKTABLE;

               SetLastModifiedDateTime;

               GenJnlTemplate.GET("Journal Template Name");
               GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
               "Copy VAT Setup to Jnl. Lines" := GenJnlBatch."Copy VAT Setup to Jnl. Lines";
               "Posting No. Series" := GenJnlBatch."Posting No. Series";
               "Check Printed" := FALSE;

               ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
               ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
             END;

    OnModify=VAR
               IsHandled@1000 : Boolean;
             BEGIN
               SetLastModifiedDateTime;

               IsHandled := FALSE;
               OnModifyOnBeforeTestCheckPrinted(Rec,IsHandled);
               IF NOT IsHandled THEN
                 TESTFIELD("Check Printed",FALSE);

               IF ("Applies-to ID" = '') AND (xRec."Applies-to ID" <> '') THEN
                 ClearCustVendApplnEntry;

               //**4PS.sn
               IF xRec."Additional Cost (Service)" = "Additional Cost (Service)" THEN
                 CheckAdditionalCostService(0);

               IF ("Deferral Code" <> '') AND (GetDeferralAmount <> 0) AND (Description <> xRec.Description) THEN
                 DeferralUtilities.DeferralCodeOnValidate(
                   "Deferral Code",DeferralDocType::"G/L","Journal Template Name","Journal Batch Name",
                   0,'',"Line No.",GetDeferralAmount,"Posting Date",Description,"Currency Code");
               //**4PS.en
             END;

    OnDelete=VAR
               GenJournalBatch@1001 : Record 232;
               GenJournalLine@1002 : Record 81;
             BEGIN
               ApprovalsMgmt.OnCancelGeneralJournalLineApprovalRequest(Rec);

               // Lines are deleted 1 by 1, this actually check if this is the last line in the General journal Bach
               GenJournalLine.SETRANGE("Journal Template Name","Journal Template Name");
               GenJournalLine.SETRANGE("Journal Batch Name","Journal Batch Name");
               IF GenJournalLine.COUNT = 1 THEN
                 IF GenJournalBatch.GET("Journal Template Name","Journal Batch Name") THEN
                   ApprovalsMgmt.OnCancelGeneralJournalBatchApprovalRequest(GenJournalBatch);

               TESTFIELD("Check Printed",FALSE);

               ClearCustVendApplnEntry;
               ClearAppliedGenJnlLine;
               DeletePaymentFileErrors;
               ClearDataExchangeEntries(FALSE);

               GenJnlAlloc.SETRANGE("Journal Template Name","Journal Template Name");
               GenJnlAlloc.SETRANGE("Journal Batch Name","Journal Batch Name");
               GenJnlAlloc.SETRANGE("Journal Line No.","Line No.");
               IF NOT GenJnlAlloc.ISEMPTY THEN
                 GenJnlAlloc.DELETEALL;

               DeferralUtilities.DeferralCodeOnDelete(
                 DeferralDocType::"G/L",
                 "Journal Template Name",
                 "Journal Batch Name",0,'',"Line No.");

               VALIDATE("Incoming Document Entry No.",0);

               //**4PS.sn
               ResetDeleteInteresLinesICAcc(Rec);
               ClearICApplicationFields;
               //**4PS.en

               IF xRec."Additional Cost (Service)" = "Additional Cost (Service)" THEN
                 CheckAdditionalCostService(0);
               // PEB0065
               gBaseTables.DeleteTexLineEntrys(Rec);
               // 0065

               //>>4PSSE
               GenJnlLineExt.SETRANGE("Journal Template Name","Journal Template Name");
               GenJnlLineExt.SETRANGE("Journal Batch Name","Journal Batch Name");
               GenJnlLineExt.SETRANGE("Line No.","Line No.");
               GenJnlLineExt.DELETEALL;
               //<<4PSSE
             END;

    OnRename=BEGIN
               ApprovalsMgmt.OnRenameRecordInApprovalRequest(xRec.RECORDID,RECORDID);

               TESTFIELD("Check Printed",FALSE);
             END;

    CaptionML=[ENU=Gen. Journal Line;
               NOR=Finanskladdelinje;
               SVE=Redovisningsjournalrad];
  }
  FIELDS
  {
    { 1   ;   ;Journal Template Name;Code10       ;TableRelation="Gen. Journal Template";
                                                   CaptionML=[ENU=Journal Template Name;
                                                              NOR=Kladdemalnavn;
                                                              SVE=Mallnamn fîr journal] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.;
                                                              SVE=Radnr] }
    { 3   ;   ;Account Type        ;Option        ;OnValidate=BEGIN
                                                                IF ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Fixed Asset",
                                                                                       "Account Type"::"IC Partner","Account Type"::Employee]) AND
                                                                   ("Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Fixed Asset",
                                                                                            "Bal. Account Type"::"IC Partner","Bal. Account Type"::Employee])
                                                                THEN
                                                                  ERROR(
                                                                    Text000,
                                                                    FIELDCAPTION("Account Type"),FIELDCAPTION("Bal. Account Type"));

                                                                IF ("Account Type" = "Account Type"::Employee) AND ("Currency Code" <> '') THEN
                                                                  ERROR(OnlyLocalCurrencyForEmployeeErr);

                                                                VALIDATE("Account No.",'');
                                                                VALIDATE(Description,'');
                                                                VALIDATE("IC Partner G/L Acc. No.",'');
                                                                IF "Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Bank Account","Account Type"::Employee] THEN BEGIN
                                                                  VALIDATE("Gen. Posting Type","Gen. Posting Type"::" ");
                                                                  VALIDATE("Gen. Bus. Posting Group",'');
                                                                  VALIDATE("Gen. Prod. Posting Group",'');
                                                                END ELSE
                                                                  IF "Bal. Account Type" IN [
                                                                                             "Bal. Account Type"::"G/L Account","Account Type"::"Bank Account","Bal. Account Type"::"Fixed Asset"]
                                                                  THEN
                                                                    VALIDATE("Payment Terms Code",'');
                                                                UpdateSource;

                                                                IF ("Account Type" <> "Account Type"::"Fixed Asset") AND
                                                                   ("Bal. Account Type" <> "Bal. Account Type"::"Fixed Asset")
                                                                THEN BEGIN
                                                                  "Depreciation Book Code" := '';
                                                                  VALIDATE("FA Posting Type","FA Posting Type"::" ");
                                                                END;
                                                                IF xRec."Account Type" IN
                                                                   [xRec."Account Type"::Customer,xRec."Account Type"::Vendor]
                                                                THEN BEGIN
                                                                  "Bill-to/Pay-to No." := '';
                                                                  "Ship-to/Order Address Code" := '';
                                                                  "Sell-to/Buy-from No." := '';
                                                                  "VAT Registration No." := '';
                                                                END;

                                                                IF "Journal Template Name" <> '' THEN
                                                                  IF "Account Type" = "Account Type"::"IC Partner" THEN BEGIN
                                                                    GetTemplate;
                                                                    IF GenJnlTemplate.Type <> GenJnlTemplate.Type::Intercompany THEN
                                                                      FIELDERROR("Account Type");
                                                                  END;

                                                                VALIDATE("Deferral Code",'');
                                                              END;

                                                   CaptionML=[ENU=Account Type;
                                                              NOR=Kontotype;
                                                              SVE=Kontotyp];
                                                   OptionCaptionML=[ENU=G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee;
                                                                    NOR=Finans,Kunde,Leverandõr,Bank,Aktiva,KI-partner,Ansatt;
                                                                    SVE=Redov.konto,Kund,Leverantîr,Bankkonto,AnlÑggningstillgÜng,Konc.int. partner,AnstÑlld];
                                                   OptionString=G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee }
    { 4   ;   ;Account No.         ;Code20        ;TableRelation=IF (Account Type=CONST(G/L Account),
                                                                     Receiving Company=FILTER('')) "G/L Account" WHERE (Account Type=CONST(Posting),
                                                                                                                        Blocked=CONST(No))
                                                                                                                        ELSE IF (Account Type=CONST(Customer),
                                                                                                                                 Receiving Company=FILTER('')) Customer
                                                                                                                                 ELSE IF (Account Type=CONST(Vendor),
                                                                                                                                          Receiving Company=FILTER('')) Vendor
                                                                                                                                          ELSE IF (Account Type=CONST(Bank Account),
                                                                                                                                                   Receiving Company=FILTER('')) "Bank Account"
                                                                                                                                                   ELSE IF (Account Type=CONST(Fixed Asset),
                                                                                                                                                            Receiving Company=FILTER('')) "Fixed Asset"
                                                                                                                                                            ELSE IF (Account Type=CONST(IC Partner),
                                                                                                                                                                     Receiving Company=FILTER('')) "IC Partner"
                                                                                                                                                                     ELSE IF (Account Type=CONST(Employee),
                                                                                                                                                                              Receiving Company=FILTER('')) Employee;
                                                   OnValidate=BEGIN
                                                                IF "Account No." <> xRec."Account No." THEN BEGIN
                                                                  ClearAppliedAutomatically;
                                                                  //VALIDATE("Job No.",''); //**4PS.o
                                                                END;

                                                                IF xRec."Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"IC Partner"] THEN
                                                                  "IC Partner Code" := '';

                                                                CheckCompanyIC;  //**4PS.n
                                                                IF "Account No." = '' THEN BEGIN
                                                                  CleanLine;
                                                                  EXIT;
                                                                END;

                                                                OnValidateAccountNoOnBeforeAssignValue(Rec,xRec);
                                                                //**4PS.sn
                                                                IF ("Account No." <> xRec."Account No.") AND (xRec."Account No." <> '') AND (CurrFieldNo <> 0) THEN
                                                                  ClearICApplicationFields;
                                                                //**4PS.en

                                                                CASE "Account Type" OF
                                                                  "Account Type"::"G/L Account":
                                                                    GetGLAccount;
                                                                  "Account Type"::Customer:
                                                                    GetCustomerAccount;
                                                                  "Account Type"::Vendor:
                                                                    GetVendorAccount;
                                                                  "Account Type"::Employee:
                                                                    GetEmployeeAccount;
                                                                  "Account Type"::"Bank Account":
                                                                    GetBankAccount;
                                                                  "Account Type"::"Fixed Asset":
                                                                    GetFAAccount;
                                                                  "Account Type"::"IC Partner":
                                                                    GetICPartnerAccount;
                                                                END;

                                                                OnValidateAccountNoOnAfterAssignValue(Rec,xRec);

                                                                VALIDATE("Currency Code");
                                                                VALIDATE("VAT Prod. Posting Group");
                                                                UpdateLineBalance;
                                                                UpdateSource;
                                                                CreateDim(
                                                                  DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                  DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                  DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."), //**4PS.n
                                                                  DATABASE::"Plant Type", "Plant Type", //**4PS.n
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                  DATABASE::Campaign,"Campaign No.");

                                                                VALIDATE("IC Partner G/L Acc. No.",GetDefaultICPartnerGLAccNo);
                                                                ValidateApplyRequirements(Rec);

                                                                CASE "Account Type" OF
                                                                  "Account Type"::"G/L Account":
                                                                    UpdateAccountID;
                                                                  "Account Type"::Customer:
                                                                    UpdateCustomerID;
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              GLAcc@1100525000 : Record 15;
                                                              Cust@1100525001 : Record 18;
                                                              Vend@1100525002 : Record 23;
                                                              BankAcc@1100525003 : Record 270;
                                                              FixedAsset@1100525004 : Record 5600;
                                                            BEGIN
                                                              //**4PS.sn
                                                              CheckCompanyIC;
                                                              CASE "Account Type" OF
                                                                "Account Type"::"G/L Account":
                                                                  BEGIN
                                                                    GLAcc.CHANGECOMPANY("Receiving Company");
                                                                    GLAcc."No." := "Account No.";
                                                                    IF PAGE.RUNMODAL(0, GLAcc) = ACTION::LookupOK THEN
                                                                      IF ("Job No." = '') AND ("Service Order No." = '') AND ("Plant Type" = '') AND ("Loan Code" = '') THEN
                                                                        VALIDATE("Account No.", GLAcc."No.");
                                                                  END;
                                                                "Account Type"::Customer:
                                                                  BEGIN
                                                                    Cust.CHANGECOMPANY("Receiving Company");
                                                                    Cust."No." := "Account No.";
                                                                    IF PAGE.RUNMODAL(0, Cust) = ACTION::LookupOK THEN
                                                                      VALIDATE("Account No.", Cust."No.");
                                                                  END;
                                                                "Account Type"::Vendor:
                                                                  BEGIN
                                                                    Vend."No." := "Account No.";
                                                                    IF PAGE.RUNMODAL(0, Vend) = ACTION::LookupOK THEN
                                                                      VALIDATE("Account No.", Vend."No.");
                                                                  END;
                                                                "Account Type"::"Bank Account":
                                                                  BEGIN
                                                                    BankAcc."No." := "Account No.";
                                                                    IF PAGE.RUNMODAL(0, BankAcc) = ACTION::LookupOK THEN
                                                                      VALIDATE("Account No.", BankAcc."No.");
                                                                  END;
                                                                "Account Type"::"Fixed Asset":
                                                                  BEGIN
                                                                    FixedAsset."No." := "Account No.";
                                                                    IF PAGE.RUNMODAL(0,FixedAsset) = ACTION::LookupOK THEN
                                                                      VALIDATE("Account No.",FixedAsset."No.");
                                                                  END;
                                                              END;
                                                              //**4PS.en
                                                            END;

                                                   CaptionML=[ENU=Account No.;
                                                              NOR=Kontonr.;
                                                              SVE=Nr] }
    { 5   ;   ;Posting Date        ;Date          ;OnValidate=BEGIN
                                                                TESTFIELD("Posting Date");
                                                                VALIDATE("Document Date","Posting Date");
                                                                VALIDATE("Currency Code");
                                                                VALIDATE("Interest Date"); //**4PS.n

                                                                IF ("Posting Date" <> xRec."Posting Date") AND (Amount <> 0) THEN
                                                                  PaymentToleranceMgt.PmtTolGenJnl(Rec);

                                                                ValidateApplyRequirements(Rec);

                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;

                                                                IF "Deferral Code" <> '' THEN
                                                                  VALIDATE("Deferral Code");
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              NOR=Bokfõringsdato;
                                                              SVE=Bokfîringsdatum];
                                                   ClosingDates=Yes }
    { 6   ;   ;Document Type       ;Option        ;OnValidate=VAR
                                                                Cust@1000 : Record 18;
                                                                Vend@1001 : Record 23;
                                                              BEGIN
                                                                VALIDATE("Payment Terms Code");
                                                                IF "Account No." <> '' THEN
                                                                  CASE "Account Type" OF
                                                                    "Account Type"::Customer:
                                                                      BEGIN
                                                                        Cust.CHANGECOMPANY("Receiving Company"); //**4PS.n
                                                                        Cust.GET("Account No.");
                                                                        Cust.CheckBlockedCustOnJnls(Cust,"Document Type",FALSE);
                                                                      END;
                                                                    "Account Type"::Vendor:
                                                                      BEGIN
                                                                        Vend.GET("Account No.");
                                                                        Vend.CheckBlockedVendOnJnls(Vend,"Document Type",FALSE);
                                                                      END;
                                                                  END;
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Account Type"::Customer:
                                                                      BEGIN
                                                                        Cust.CHANGECOMPANY("Receiving Company"); //**4PS.n
                                                                        Cust.GET("Bal. Account No.");
                                                                        Cust.CheckBlockedCustOnJnls(Cust,"Document Type",FALSE);
                                                                      END;
                                                                    "Account Type"::Vendor:
                                                                      BEGIN
                                                                        Vend.GET("Bal. Account No.");
                                                                        Vend.CheckBlockedVendOnJnls(Vend,"Document Type",FALSE);
                                                                      END;
                                                                  END;
                                                                UpdateSalesPurchLCY;
                                                                ValidateApplyRequirements(Rec);
                                                              END;

                                                   CaptionML=[ENU=Document Type;
                                                              NOR=Bilagstype;
                                                              SVE=Dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    NOR=" ,Betaling,Faktura,Kreditnota,Rentenota,Purring,Refusjon";
                                                                    SVE=" ,Betalning,Faktura,Kreditnota,RÑntefaktura,BetalningspÜminnelse,èterbetalning"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 7   ;   ;Document No.        ;Code20        ;CaptionML=[ENU=Document No.;
                                                              NOR=Bilagsnr.;
                                                              SVE=Dokumentnr] }
    { 8   ;   ;Description         ;Text100       ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 10  ;   ;VAT %               ;Decimal       ;OnValidate=BEGIN
                                                                GetCurrency;
                                                                IF "VAT Posting" = "VAT Posting"::"Automatic VAT Entry" THEN   //**4PS.n
                                                                CASE "VAT Calculation Type" OF
                                                                  "VAT Calculation Type"::"Normal VAT",
                                                                  "VAT Calculation Type"::"Reverse Charge VAT":
                                                                    BEGIN
                                                                      "VAT Amount" :=
                                                                        ROUND(Amount * "VAT %" / (100 + "VAT %"),Currency."Amount Rounding Precision",Currency.VATRoundingDirection);
                                                                      "VAT Base Amount" :=
                                                                        ROUND(Amount - "VAT Amount",Currency."Amount Rounding Precision");
                                                                    END;
                                                                  "VAT Calculation Type"::"Full VAT":
                                                                    "VAT Amount" := Amount;
                                                                  "VAT Calculation Type"::"Sales Tax":
                                                                    IF ("Gen. Posting Type" = "Gen. Posting Type"::Purchase) AND
                                                                       "Use Tax"
                                                                    THEN BEGIN
                                                                      "VAT Amount" := 0;
                                                                      "VAT %" := 0;
                                                                    END ELSE BEGIN
                                                                      "VAT Amount" :=
                                                                        Amount -
                                                                        SalesTaxCalculate.ReverseCalculateTax(
                                                                          "Tax Area Code","Tax Group Code","Tax Liable",
                                                                          "Posting Date",Amount,Quantity,"Currency Factor");
                                                                      OnAfterSalesTaxCalculateReverseCalculateTax(Rec,CurrFieldNo);
                                                                      IF Amount - "VAT Amount" <> 0 THEN
                                                                        "VAT %" := ROUND(100 * "VAT Amount" / (Amount - "VAT Amount"),0.00001)
                                                                      ELSE
                                                                        "VAT %" := 0;
                                                                      "VAT Amount" :=
                                                                        ROUND("VAT Amount",Currency."Amount Rounding Precision");
                                                                    END;
                                                                END;
                                                                "VAT Base Amount" := Amount - "VAT Amount";
                                                                "VAT Difference" := 0;

                                                                IF "Currency Code" = '' THEN
                                                                  "VAT Amount (LCY)" := "VAT Amount"
                                                                ELSE
                                                                  "VAT Amount (LCY)" :=
                                                                    ROUND(
                                                                      CurrExchRate.ExchangeAmtFCYToLCY(
                                                                        //**4PS.so
                                                                        //"Posting Date","Currency Code",
                                                                        //"VAT Amount","Currency Factor"));
                                                                        //**4PS.eo
                                                                        //**4PS.sn
                                                                        1, "Job No.", "Posting Date", "Currency Code",
                                                                        "VAT Amount", "Currency Factor", "Account Type" = "Account Type"::Customer));
                                                                        //**4PS.en
                                                                "VAT Base Amount (LCY)" := "Amount (LCY)" - "VAT Amount (LCY)";

                                                                OnValidateVATPctOnBeforeUpdateSalesPurchLCY(Rec,Currency);
                                                                UpdateSalesPurchLCY;

                                                                IF "Deferral Code" <> '' THEN
                                                                  VALIDATE("Deferral Code");
                                                              END;

                                                   CaptionML=[ENU=VAT %;
                                                              NOR=Mva-%;
                                                              SVE=Momssats %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Editable=No }
    { 11  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account" WHERE (Account Type=CONST(Posting),
                                                                                                                                Blocked=CONST(No))
                                                                                                                                ELSE IF (Bal. Account Type=CONST(Customer)) Customer
                                                                                                                                ELSE IF (Bal. Account Type=CONST(Vendor)) Vendor
                                                                                                                                ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account"
                                                                                                                                ELSE IF (Bal. Account Type=CONST(Fixed Asset)) "Fixed Asset"
                                                                                                                                ELSE IF (Bal. Account Type=CONST(IC Partner)) "IC Partner"
                                                                                                                                ELSE IF (Bal. Account Type=CONST(Employee)) Employee;
                                                   OnValidate=BEGIN
                                                                //VALIDATE("Job No.",''); //**4PS.o

                                                                IF xRec."Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,
                                                                                                "Bal. Account Type"::"IC Partner"]
                                                                THEN
                                                                  "IC Partner Code" := '';

                                                                //**4PS.sn
                                                                IF ("Bal. Account No." <> xRec."Bal. Account No.") AND (CurrFieldNo <> 0) THEN
                                                                  ClearICApplicationFields;
                                                                //**4PS.en

                                                                IF "Bal. Account No." = '' THEN BEGIN
                                                                  UpdateLineBalance;
                                                                  UpdateSource;
                                                                  CreateDim(
                                                                    DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                    DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                    DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."), //**4PS.n
                                                                    DATABASE::"Plant Type", "Plant Type", //**4PS.n
                                                                    DATABASE::Job,"Job No.",
                                                                    DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
                                                                    DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                    DATABASE::Campaign,"Campaign No.");
                                                                  IF NOT ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor]) THEN
                                                                    "Recipient Bank Account" := '';
                                                                  IF xRec."Bal. Account No." <> '' THEN BEGIN
                                                                    ClearBalancePostingGroups;
                                                                    "Bal. Tax Area Code" := '';
                                                                    "Bal. Tax Liable" := FALSE;
                                                                    "Bal. Tax Group Code" := '';
                                                                    ClearCurrencyCode;
                                                                    //**4PS.sn
                                                                    "Bal. VAT Amount" := 0;
                                                                    "Bal. VAT Posting" := "Bal. VAT Posting"::"Automatic VAT Entry";
                                                                    //**4PS.en
                                                                  END;
                                                                  EXIT;
                                                                END;

                                                                OnValidateBalAccountNoOnBeforeAssignValue(Rec,xRec);

                                                                CASE "Bal. Account Type" OF
                                                                  "Bal. Account Type"::"G/L Account":
                                                                    GetGLBalAccount;
                                                                  "Bal. Account Type"::Customer:
                                                                    GetCustomerBalAccount;
                                                                  "Bal. Account Type"::Vendor:
                                                                    GetVendorBalAccount;
                                                                  "Bal. Account Type"::Employee:
                                                                    GetEmployeeBalAccount;
                                                                  "Bal. Account Type"::"Bank Account":
                                                                    GetBankBalAccount;
                                                                  "Bal. Account Type"::"Fixed Asset":
                                                                    GetFABalAccount;
                                                                  "Bal. Account Type"::"IC Partner":
                                                                    GetICPartnerBalAccount;
                                                                END;

                                                                OnValidateBalAccountNoOnAfterAssignValue(Rec,xRec);

                                                                VALIDATE("Currency Code");
                                                                VALIDATE("Bal. VAT Prod. Posting Group");
                                                                UpdateLineBalance;
                                                                UpdateSource;
                                                                CreateDim(
                                                                  DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                  DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                  DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."), //**4PS.n
                                                                  DATABASE::"Plant Type", "Plant Type", //**4PS.n
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                  DATABASE::Campaign,"Campaign No.");

                                                                VALIDATE("IC Partner G/L Acc. No.",GetDefaultICPartnerGLAccNo);
                                                                ValidateApplyRequirements(Rec);
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              NOR=Motkontonr.;
                                                              SVE=Motkonto] }
    { 12  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=VAR
                                                                BankAcc@1000 : Record 270;
                                                              BEGIN
                                                                IF "Bal. Account Type" = "Bal. Account Type"::"Bank Account" THEN BEGIN
                                                                  IF BankAcc.GET("Bal. Account No.") AND (BankAcc."Currency Code" <> '')THEN
                                                                    BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                END;
                                                                IF "Account Type" = "Account Type"::"Bank Account" THEN BEGIN
                                                                  IF BankAcc.GET("Account No.") AND (BankAcc."Currency Code" <> '') THEN
                                                                    BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                END;
                                                                IF ("Recurring Method" IN
                                                                    ["Recurring Method"::"B  Balance","Recurring Method"::"RB Reversing Balance"]) AND
                                                                   ("Currency Code" <> '')
                                                                THEN
                                                                  ERROR(
                                                                    Text001,
                                                                    FIELDCAPTION("Currency Code"),FIELDCAPTION("Recurring Method"),"Recurring Method");

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  IF ("Bal. Account Type" = "Bal. Account Type"::Employee) OR ("Account Type" = "Account Type"::Employee) THEN
                                                                    ERROR(OnlyLocalCurrencyForEmployeeErr);
                                                                  GetCurrency;
                                                                  IF ("Currency Code" <> xRec."Currency Code") OR
                                                                     ("Posting Date" <> xRec."Posting Date") OR
                                                                     (CurrFieldNo = FIELDNO("Currency Code")) OR
                                                                     ("Currency Factor" = 0)
                                                                  THEN
                                                                    "Currency Factor" :=
                                                                      //CurrExchRate.ExchangeRate("Posting Date","Currency Code"); //**4PS.o
                                                                      CurrExchRate.ExchangeRate(1, "Job No.", "Posting Date", "Currency Code", FALSE); //**4PS.n
                                                                END ELSE
                                                                  "Currency Factor" := 0;
                                                                VALIDATE("Currency Factor");

                                                                IF NOT CustVendAccountNosModified THEN
                                                                  IF ("Currency Code" <> xRec."Currency Code") AND (Amount <> 0) THEN
                                                                    PaymentToleranceMgt.PmtTolGenJnl(Rec);
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod] }
    { 13  ;   ;Amount              ;Decimal       ;OnValidate=BEGIN
                                                                ValidateAmount(TRUE);
                                                              END;

                                                   CaptionML=[ENU=Amount;
                                                              NOR=Belõp;
                                                              SVE=Belopp];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 14  ;   ;Debit Amount        ;Decimal       ;OnValidate=BEGIN
                                                                GetCurrency;
                                                                "Debit Amount" := ROUND("Debit Amount",Currency."Amount Rounding Precision");
                                                                Correction := "Debit Amount" < 0;
                                                                IF ("Credit Amount" = 0) OR ("Debit Amount" <> 0) THEN BEGIN
                                                                  Amount := "Debit Amount";
                                                                  VALIDATE(Amount);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Debit Amount;
                                                              NOR=Debetbelõp;
                                                              SVE=Debetbelopp];
                                                   BlankZero=Yes;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 15  ;   ;Credit Amount       ;Decimal       ;OnValidate=BEGIN
                                                                GetCurrency;
                                                                "Credit Amount" := ROUND("Credit Amount",Currency."Amount Rounding Precision");
                                                                Correction := "Credit Amount" < 0;
                                                                IF ("Debit Amount" = 0) OR ("Credit Amount" <> 0) THEN BEGIN
                                                                  Amount := -"Credit Amount";
                                                                  VALIDATE(Amount);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Credit Amount;
                                                              NOR=Kreditbelõp;
                                                              SVE=Kreditbelopp];
                                                   BlankZero=Yes;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 16  ;   ;Amount (LCY)        ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Code" = '' THEN BEGIN
                                                                  Amount := "Amount (LCY)";
                                                                  VALIDATE(Amount);
                                                                END ELSE BEGIN
                                                                  IF CheckFixedCurrency THEN BEGIN
                                                                    GetCurrency;
                                                                    Amount := ROUND(
                                                                      CurrExchRate.ExchangeAmtLCYToFCY(
                                                                        //**4PS.so
                                                                        //"Posting Date","Currency Code",
                                                                        //"Amount (LCY)","Currency Factor"),
                                                                        //**4PS.eo
                                                                        //**4PS.sn
                                                                        1, "Job No.", "Posting Date", "Currency Code",
                                                                        "Amount (LCY)", "Currency Factor", "Account Type" = "Account Type"::Customer ),
                                                                        //**4PS.en
                                                                      Currency."Amount Rounding Precision")
                                                                  END ELSE BEGIN
                                                                    TESTFIELD("Amount (LCY)");
                                                                    TESTFIELD(Amount);
                                                                    "Currency Factor" := Amount / "Amount (LCY)";
                                                                  END;

                                                                  VALIDATE("VAT %");
                                                                  VALIDATE("Bal. VAT %");
                                                                  UpdateLineBalance;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Amount (LCY);
                                                              NOR=Belõp (NOK);
                                                              SVE=Belopp (BVA)];
                                                   AutoFormatType=1 }
    { 17  ;   ;Balance (LCY)       ;Decimal       ;CaptionML=[ENU=Balance (LCY);
                                                              NOR=Saldo (NOK);
                                                              SVE=Saldo (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 18  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF ("Currency Code" = '') AND ("Currency Factor" <> 0) THEN
                                                                  FIELDERROR("Currency Factor",STRSUBSTNO(Text002,FIELDCAPTION("Currency Code")));
                                                                VALIDATE(Amount);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              NOR=Valutafaktor;
                                                              SVE=Valutafaktor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 19  ;   ;Sales/Purch. (LCY)  ;Decimal       ;CaptionML=[ENU=Sales/Purch. (LCY);
                                                              NOR=Salg/kjõp (NOK);
                                                              SVE=Fîrs./Inkîp (BVA)];
                                                   AutoFormatType=1 }
    { 20  ;   ;Profit (LCY)        ;Decimal       ;CaptionML=[ENU=Profit (LCY);
                                                              NOR=Bruttofortjeneste (NOK);
                                                              SVE=Vinst (BVA)];
                                                   AutoFormatType=1 }
    { 21  ;   ;Inv. Discount (LCY) ;Decimal       ;CaptionML=[ENU=Inv. Discount (LCY);
                                                              NOR=Fakturarabatt (NOK);
                                                              SVE=Fakturarabatt (BVA)];
                                                   AutoFormatType=1 }
    { 22  ;   ;Bill-to/Pay-to No.  ;Code20        ;TableRelation=IF (Account Type=CONST(Customer)) Customer
                                                                 ELSE IF (Bal. Account Type=CONST(Customer)) Customer
                                                                 ELSE IF (Account Type=CONST(Vendor)) Vendor
                                                                 ELSE IF (Bal. Account Type=CONST(Vendor)) Vendor;
                                                   OnValidate=BEGIN
                                                                IF "Bill-to/Pay-to No." <> xRec."Bill-to/Pay-to No." THEN
                                                                  "Ship-to/Order Address Code" := '';
                                                                ReadGLSetup;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN
                                                                  UpdateCountryCodeAndVATRegNo("Bill-to/Pay-to No.");
                                                              END;

                                                   CaptionML=[ENU=Bill-to/Pay-to No.;
                                                              NOR=Fakt. til/bet. til-nr.;
                                                              SVE=Faktureras/Betalas nr];
                                                   Editable=No }
    { 23  ;   ;Posting Group       ;Code20        ;TableRelation=IF (Account Type=CONST(Customer)) "Customer Posting Group"
                                                                 ELSE IF (Account Type=CONST(Vendor)) "Vendor Posting Group"
                                                                 ELSE IF (Account Type=CONST(Fixed Asset)) "FA Posting Group"
                                                                 ELSE IF (Account Type=CONST(G/L Account),
                                                                          Plant Type=FILTER(<>'')) "Plant Posting Group";
                                                   CaptionML=[ENU=Posting Group;
                                                              NOR=Bokfõringsgruppe;
                                                              SVE=Bokfîringsmall];
                                                   Editable=No }
    { 24  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation=IF (Receiving Company=FILTER('')) "Dimension Value".Code WHERE (Global Dimension No.=CONST(1),
                                                                                                                                 Blocked=CONST(No));
                                                   OnValidate=BEGIN
                                                                //**4PS.sn
                                                                CheckCompanyIC;
                                                                IF "Shortcut Dimension 1 Code" <> '' THEN
                                                                  DimMgt.GetDimValueRec(1, "Shortcut Dimension 1 Code", DimValRec, TRUE,'');
                                                                CheckDim1JobService;  //db, 19-05-15: C015449
                                                                //**4PS.en

                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS.sn
                                                              CheckCompanyIC;
                                                              DimValRec.RESET;
                                                              DimValRec.Code := "Shortcut Dimension 1 Code";
                                                              DimValRec.SETRANGE("Global Dimension No.", 1);
                                                              IF PAGE.RUNMODAL(0, DimValRec) = ACTION::LookupOK THEN
                                                                VALIDATE("Shortcut Dimension 1 Code", DimValRec.Code);
                                                              //**4PS.en
                                                            END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode;
                                                              SVE=GenvÑg dimension 1 kod];
                                                   CaptionClass='1,2,1' }
    { 25  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation=IF (Receiving Company=FILTER('')) "Dimension Value".Code WHERE (Global Dimension No.=CONST(2),
                                                                                                                                 Blocked=CONST(No));
                                                   OnValidate=VAR
                                                                lDimValRec@1100485002 : Record 349;
                                                                xDimValRec@1100485001 : Record 349;
                                                                lvCompName@1100485000 : Text[50];
                                                                lvPostingSetup@1100525002 : Record 11020565;
                                                                lvVendorPostingGroup@1100525001 : Code[20];
                                                                ICRec@1100525000 : Record 11012057;
                                                                lvVendorCde@1100525004 : Code[20];
                                                                lvCustomerPostingGroup@1100528201 : Code[20];
                                                                ICHoursPosting@1100528200 : 'NotApplicable,ReceiverSide,Supplierside';
                                                              BEGIN
                                                                //**4PS.sn
                                                                IF "Shortcut Dimension 2 Code" <> '' THEN BEGIN
                                                                  CheckCompanyIC;
                                                                  lDimValRec.CHANGECOMPANY("Receiving Company");
                                                                  DimMgt.GetDimValueRec(2, "Shortcut Dimension 2 Code", lDimValRec, TRUE, "Job No.");
                                                                  lDimValRec.TESTFIELD(Blocked, FALSE);
                                                                  lDimValRec.TESTFIELD("Proj. Rel. Cost Object Blocked", FALSE);

                                                                  IF CurrFieldNo = FIELDNO("Shortcut Dimension 2 Code") THEN
                                                                    "Cost Type Cost Plus Line" := lDimValRec."Cost Type";

                                                                  IF "Receiving Company" <> '' THEN
                                                                    lvCompName := "Receiving Company"
                                                                  ELSE
                                                                    lvCompName := COMPANYNAME;

                                                                  IF "Service Order No." <> '' THEN BEGIN
                                                                    "Origin Type" := "Origin Type"::Service;
                                                                    ServOrderRec.GET("Service Order No.");
                                                                    CheckAdditionalCostService(CurrFieldNo);  //db, 03-02-10
                                                                    IF "Additional Cost (Service)" = TRUE THEN BEGIN
                                                                      ServOrderRec.TESTFIELD("Service Type (Other)");
                                                                      ServTypeRec.GET(ServOrderRec."Service Type (Other)");
                                                                    END ELSE BEGIN
                                                                      ServOrderRec.TESTFIELD("Service Type");
                                                                      ServTypeRec.GET(ServOrderRec."Service Type");
                                                                    END;

                                                                    "Account No." := ServTypeRec.GetWipAccByPostingGrp(ServTypeRec.Code, lDimValRec."Cost Type",
                                                                        lvCompName,"Cost Type Cost Plus Line",lvVendorCde,ICHoursPosting::Supplierside,"Vendor Posting Group","Customer Posting Group");

                                                                    VALIDATE("Account No.");
                                                                    IF "Additional Cost (Service)" THEN
                                                                      VALIDATE("Shortcut Dimension 1 Code", ServOrderRec."Department Code (Other)")
                                                                    ELSE
                                                                      VALIDATE("Shortcut Dimension 1 Code", ServOrderRec."Global Dimension 1 Code");
                                                                  END ELSE BEGIN
                                                                    //db.sn, 15-04-11
                                                                    IF "Service Contract No." <> '' THEN BEGIN
                                                                      IF CurrFieldNo <> 0 THEN
                                                                        lDimValRec.TESTFIELD("Cost Type", lDimValRec."Cost Type"::Revenue);
                                                                      "Origin Type" := "Origin Type"::Service;
                                                                      ServContrRec.GET("Service Contract No.");
                                                                      ServContrRec.TESTFIELD("Service Type");
                                                                      ServTypeRec.GET(ServContrRec."Service Type");

                                                                      "Account No." := ServTypeRec.GetWipAccByPostingGrp(
                                                                        ServTypeRec.Code, lDimValRec."Cost Type", lvCompName, -1, lvVendorCde, ICHoursPosting::Supplierside,"Vendor Posting Group","Customer Posting Group");

                                                                      VALIDATE("Account No.");
                                                                      VALIDATE("Shortcut Dimension 1 Code", ServContrRec."Global Dimension 1 Code");
                                                                    END;
                                                                    //db.en, 15-04-11
                                                                    IF "Job No." <> '' THEN BEGIN
                                                                      "Origin Type" := "Origin Type"::Project;
                                                                      ProjRec.GET("Job No.");
                                                                      ProjTypeRec.GET(ProjRec."Project Type");
                                                                      ProjectTypeExtension.GetProjectTypeExtension(ProjTypeRec.Code);

                                                                      GLSetup.GET;
                                                                      IF ("Receiving Company" <> COMPANYNAME) AND ("Receiving Company" <> '') THEN
                                                                      BEGIN
                                                                        IF lvPostingSetup.GET("Source Code", COMPANYNAME, "Receiving Company") THEN
                                                                        BEGIN
                                                                          IF (lvPostingSetup."Prod. Account Credit" <> '') AND
                                                                             (lvPostingSetup."Prod. Account Debit" <> '') THEN
                                                                          BEGIN
                                                                            ICRec.GET(COMPANYNAME, "Receiving Company");
                                                                            lvVendorPostingGroup := ICRec."Vendor Posting Group";
                                                                            // IcEntryRec."Use IC Vendor Posting Group" := TRUE;
                                                                          END;
                                                                        END;
                                                                      END;

                                                                      lvVendorCde := ExternalEmployeeVendor; //**4PS Call Call C006691

                                                                      "Account No." :=
                                                                        WipAccountProject(
                                                                          ProjRec,ProjTypeRec,lDimValRec,ICProjSetupRec."Provisions at Closure",lvCompName,lvVendorCde,lvVendorPostingGroup,lvCustomerPostingGroup);
                                                                        //ProjTypeRec.GetWipAccByVendorPostingGrp(ProjRec."Project Type",
                                                                        //                                        lDimValRec."Cost Type",
                                                                        //                                        ProjRec."Project Status",
                                                                        //                                        ICProjSetupRec."Provisions at Closure",
                                                                        //                                        lvCompName,
                                                                        //                                        "Cost Type Cost Plus Line",
                                                                        //                                        lvVendorCde,  //** 4PS Call Call C006691 changed
                                                                        //                                        lvICHoursPosting::Supplierside,
                                                                        //                                        lvVendorPostingGroup);
                                                                      VALIDATE("Account No.");
                                                                    END;
                                                                  END;

                                                                  IF ("Service Order No." <> '') OR ("Service Contract No." <> '') OR ("Job No." <> '') THEN BEGIN
                                                                    IF ("Item No." = '') AND (Manufacturer = '') AND ("Vendor (Trade Item)" = '') THEN BEGIN
                                                                      IF "Shortcut Dimension 2 Code" <> xRec."Shortcut Dimension 2 Code" THEN BEGIN
                                                                        IF Description = '' THEN
                                                                          Description := lDimValRec.Name
                                                                        ELSE BEGIN
                                                                          xDimValRec.CHANGECOMPANY(xRec."Receiving Company");
                                                                          DimMgt.GetDimValueRec(2, xRec."Shortcut Dimension 2 Code", xDimValRec, FALSE, xRec."Job No.");
                                                                          IF (lDimValRec.Name <> '') AND ((Description = xDimValRec.Name) OR (xDimValRec.Name = '')) THEN
                                                                            Description := lDimValRec.Name;
                                                                        END;
                                                                      END;
                                                                    END;
                                                                  END;

                                                                  IF ("Item No." + "Basic Item" + "Trade Item" = '') THEN
                                                                    IF "Shortcut Dimension 2 Code" <> xRec."Shortcut Dimension 2 Code" THEN
                                                                      "Cost Component" := lDimValRec."Cost Component";

                                                                END;
                                                                CheckCostCompServOrderType;                        //** 4PS01.n
                                                                //**4PS.en

                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS.sn
                                                              CheckCompanyIC;
                                                              DimValRec.RESET;
                                                              DimValRec.Code := "Shortcut Dimension 2 Code";
                                                              DimValRec.SETRANGE("Global Dimension No.", 2);
                                                              DimValRec.SETRANGE("Project Filter", "Job No.");
                                                              IF "Receiving Company" = '' THEN
                                                                DimValRec.SETRANGE("Company Filter")
                                                              ELSE
                                                                DimValRec.SETRANGE("Company Filter", "Receiving Company");
                                                              IF ("Service Order No." = '') AND ("Service Contract No." <> '') THEN
                                                                DimValRec.SETRANGE("Cost Type", DimValRec."Cost Type"::Revenue);
                                                              IF PAGE.RUNMODAL(PAGE::"Cost Object List", DimValRec) = ACTION::LookupOK THEN
                                                                VALIDATE("Shortcut Dimension 2 Code", DimValRec.Code);
                                                              DimValRec.SETRANGE("Project Filter");
                                                              DimValRec.SETRANGE("Cost Type");
                                                              //**4PS.en
                                                            END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode;
                                                              SVE=GenvÑg dimension 2 kod];
                                                   CaptionClass='1,2,2' }
    { 26  ;   ;Salespers./Purch. Code;Code20      ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                ValidateSalesPersonPurchaserCode(Rec);

                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                  DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                  DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                  DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."), //**4PS.n
                                                                  DATABASE::"Plant Type", "Plant Type", //**4PS.n
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
                                                                  DATABASE::Campaign,"Campaign No.");
                                                              END;

                                                   CaptionML=[ENU=Salespers./Purch. Code;
                                                              NOR=Selger/innkjõper - kode;
                                                              SVE=SÑljare/inkîpare kod] }
    { 29  ;   ;Source Code         ;Code10        ;TableRelation="Source Code";
                                                   CaptionML=[ENU=Source Code;
                                                              NOR=Kildespor;
                                                              SVE=Ursprungskod];
                                                   Editable=No }
    { 30  ;   ;System-Created Entry;Boolean       ;CaptionML=[ENU=System-Created Entry;
                                                              NOR=Opprettet automatisk;
                                                              SVE=Systemkreerad trans.];
                                                   Editable=No }
    { 34  ;   ;On Hold             ;Code3         ;OnLookup=VAR
                                                              OnHoldCode@1100528200 : Record 11012031;
                                                            BEGIN
                                                              IF "On Hold" <> '' THEN
                                                                IF OnHoldCode.GET("On Hold") THEN;
                                                              IF PAGE.RUNMODAL(0, OnHoldCode) = ACTION::LookupOK THEN
                                                                VALIDATE("On Hold", OnHoldCode.Code);
                                                            END;

                                                   CaptionML=[ENU=On Hold;
                                                              NOR=Avvent;
                                                              SVE=Stoppad] }
    { 35  ;   ;Applies-to Doc. Type;Option        ;OnValidate=BEGIN
                                                                IF "Applies-to Doc. Type" <> xRec."Applies-to Doc. Type" THEN
                                                                  VALIDATE("Applies-to Doc. No.",'');
                                                              END;

                                                   CaptionML=[ENU=Applies-to Doc. Type;
                                                              NOR=Utligningsbilagstype;
                                                              SVE=Kopplas till dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    NOR=" ,Betaling,Faktura,Kreditnota,Rentenota,Purring,Refusjon";
                                                                    SVE=" ,Betalning,Faktura,Kreditnota,RÑntefaktura,BetalningspÜminnelse,èterbetalning"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 36  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=VAR
                                                                ValidateBln@1210190000 : Boolean;
                                                                CustLedgEntry@1000 : Record 21;
                                                                VendLedgEntry@1003 : Record 25;
                                                                TempGenJnlLine@1001 : TEMPORARY Record 81;
                                                                lvCustEntryEditCU@1100485000 : Codeunit 103;
                                                                SEPaymentImport@1101285000 : Codeunit 11128001;
                                                              BEGIN
                                                                IF SuppressCommit THEN
                                                                  PaymentToleranceMgt.SetSuppressCommit(TRUE);

                                                                IF "Applies-to Doc. No." <> xRec."Applies-to Doc. No." THEN
                                                                  ClearCustVendApplnEntry;
                                                                //**4PS.sn
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  CheckAppiesToDocNoAllowedForIC(TRUE, FIELDNO("Applies-to Doc. No."));  //* C-017223
                                                                ValidateAppliesToDocNo(FALSE);

                                                                //**4PS.en

                                                                IF ("Applies-to Doc. No." = '') AND (xRec."Applies-to Doc. No." <> '') THEN BEGIN
                                                                  PaymentToleranceMgt.DelPmtTolApllnDocNo(Rec,xRec."Applies-to Doc. No.");

                                                                  TempGenJnlLine := Rec;
                                                                  IF (TempGenJnlLine."Bal. Account Type" = TempGenJnlLine."Bal. Account Type"::Customer) OR
                                                                     (TempGenJnlLine."Bal. Account Type" = TempGenJnlLine."Bal. Account Type"::Vendor) OR
                                                                     (TempGenJnlLine."Bal. Account Type" = TempGenJnlLine."Bal. Account Type"::Employee)
                                                                  THEN
                                                                    CODEUNIT.RUN(CODEUNIT::"Exchange Acc. G/L Journal Line",TempGenJnlLine);

                                                                  CASE TempGenJnlLine."Account Type" OF
                                                                    TempGenJnlLine."Account Type"::Customer:
                                                                      BEGIN
                                                                        CustLedgEntry.CHANGECOMPANY("Receiving Company"); //**4PS.n
                                                                        CustLedgEntry.SETCURRENTKEY("Document No.");
                                                                        CustLedgEntry.SETRANGE("Document No.",xRec."Applies-to Doc. No.");
                                                                        IF NOT (xRec."Applies-to Doc. Type" = "Document Type"::" ") THEN
                                                                          CustLedgEntry.SETRANGE("Document Type",xRec."Applies-to Doc. Type");
                                                                        CustLedgEntry.SETRANGE("Customer No.",TempGenJnlLine."Account No.");
                                                                        CustLedgEntry.SETRANGE(Open,TRUE);
                                                                        IF CustLedgEntry.FINDFIRST THEN BEGIN
                                                                          IF CustLedgEntry."Amount to Apply" <> 0 THEN  BEGIN
                                                                            CustLedgEntry."Amount to Apply" := 0;
                                                                            //CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry);  //**4PS.o
                                                                            //**4PS.sn
                                                                            IF ("Receiving Company" <> '') AND ("Receiving Company" <> COMPANYNAME) THEN
                                                                              lvCustEntryEditCU.SetCompany("Receiving Company");
                                                                            lvCustEntryEditCU.RUN(CustLedgEntry);
                                                                            //**4PS.en
                                                                          END;
                                                                          "Exported to Payment File" := CustLedgEntry."Exported to Payment File";
                                                                          "Applies-to Ext. Doc. No." := '';
                                                                        END;
                                                                      END;
                                                                    TempGenJnlLine."Account Type"::Vendor:
                                                                      BEGIN
                                                                        VendLedgEntry.SETCURRENTKEY("Document No.");
                                                                        VendLedgEntry.SETRANGE("Document No.",xRec."Applies-to Doc. No.");
                                                                        IF NOT (xRec."Applies-to Doc. Type" = "Document Type"::" ") THEN
                                                                          VendLedgEntry.SETRANGE("Document Type",xRec."Applies-to Doc. Type");
                                                                        VendLedgEntry.SETRANGE("Vendor No.",TempGenJnlLine."Account No.");
                                                                        VendLedgEntry.SETRANGE(Open,TRUE);
                                                                        IF VendLedgEntry.FINDFIRST THEN BEGIN
                                                                          IF VendLedgEntry."Amount to Apply" <> 0 THEN  BEGIN
                                                                            VendLedgEntry."Amount to Apply" := 0;
                                                                            CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",VendLedgEntry);
                                                                          END;
                                                                          "Exported to Payment File" := VendLedgEntry."Exported to Payment File";
                                                                        END;
                                                                        "Applies-to Ext. Doc. No." := '';
                                                                      END;
                                                                    TempGenJnlLine."Account Type"::Employee:
                                                                      BEGIN
                                                                        EmplLedgEntry.SETCURRENTKEY("Document No.");
                                                                        EmplLedgEntry.SETRANGE("Document No.",xRec."Applies-to Doc. No.");
                                                                        IF NOT (xRec."Applies-to Doc. Type" = "Document Type"::" ") THEN
                                                                          EmplLedgEntry.SETRANGE("Document Type",xRec."Applies-to Doc. Type");
                                                                        EmplLedgEntry.SETRANGE("Employee No.",TempGenJnlLine."Account No.");
                                                                        EmplLedgEntry.SETRANGE(Open,TRUE);
                                                                        IF EmplLedgEntry.FINDFIRST THEN BEGIN
                                                                          IF EmplLedgEntry."Amount to Apply" <> 0 THEN BEGIN
                                                                            EmplLedgEntry."Amount to Apply" := 0;
                                                                            CODEUNIT.RUN(CODEUNIT::"Empl. Entry-Edit",EmplLedgEntry);
                                                                          END;
                                                                          "Exported to Payment File" := EmplLedgEntry."Exported to Payment File";
                                                                        END;
                                                                      END;
                                                                  END;
                                                                END;

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (Amount <> 0) THEN BEGIN
                                                                  IF xRec."Applies-to Doc. No." <> '' THEN
                                                                    PaymentToleranceMgt.DelPmtTolApllnDocNo(Rec,xRec."Applies-to Doc. No.");
                                                                  SetApplyToAmount;
                                                                  PaymentToleranceMgt.PmtTolGenJnl(Rec);
                                                                  xRec.ClearAppliedGenJnlLine;
                                                                END;

                                                                CASE "Account Type" OF
                                                                  "Account Type"::Customer:
                                                                    GetCustLedgerEntry;
                                                                  "Account Type"::Vendor:
                                                                    GetVendLedgerEntry;
                                                                  "Account Type"::Employee:
                                                                    GetEmplLedgerEntry;
                                                                END;

                                                                ValidateApplyRequirements(Rec);
                                                                SetJournalLineFieldsFromApplication;

                                                                IF "Applies-to Doc. Type" = "Applies-to Doc. Type"::Invoice THEN
                                                                  UpdateAppliesToInvoiceID;
                                                                //150128, SS002177
                                                                SEPaymentImport.ValidateAppliesToDocNo(Rec,CurrFieldNo,DontWarnValidateAppliesToDocNoBool);
                                                                // PEB0026
                                                                gBaseTables.T81_GetDescription(Rec);
                                                                // 0026

                                                                //>>180918, moved to event
                                                                //>>180912,Support #15413
                                                                // SEPaymentImport.VerifySetNotMatched(Rec,"Applies-to Doc. No.");
                                                                OnAfterValidateAppliestoDocNo(Rec);
                                                                //<<180918

                                                                //4PSSE, ORANGO.EE 181011 RFC1081
                                                                CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                                CustLedgEntry.SETRANGE("Sent to Collection", TRUE);
                                                                IF CustLedgEntry.FINDSET THEN
                                                                  "Sent to Collection" := TRUE;
                                                                //4PSSE
                                                              END;

                                                   OnLookup=VAR
                                                              PaymentToleranceMgt@1001 : Codeunit 426;
                                                              AccType@1002 : 'G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee';
                                                              AccNo@1003 : Code[20];
                                                            BEGIN
                                                              CheckAppiesToDocNoAllowedForIC(TRUE, 0);  //* C-017223
                                                              xRec.Amount := Amount;
                                                              xRec."Currency Code" := "Currency Code";
                                                              xRec."Posting Date" := "Posting Date";

                                                              GetAccTypeAndNo(Rec,AccType,AccNo);
                                                              CLEAR(CustLedgEntry);
                                                              CLEAR(VendLedgEntry);

                                                              CASE AccType OF
                                                                AccType::Customer:
                                                                  LookUpAppliesToDocCust(AccNo);
                                                                AccType::Vendor:
                                                                  LookUpAppliesToDocVend(AccNo);
                                                                AccType::Employee:
                                                                  LookUpAppliesToDocEmpl(AccNo);
                                                              END;
                                                              SetJournalLineFieldsFromApplication;

                                                              ValidateAppliesToDocNo(FALSE); //**4PS.n

                                                              IF xRec.Amount <> 0 THEN
                                                                IF NOT PaymentToleranceMgt.PmtTolGenJnl(Rec) THEN
                                                                  EXIT;

                                                              IF "Applies-to Doc. Type" = "Applies-to Doc. Type"::Invoice THEN
                                                                UpdateAppliesToInvoiceID;
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              NOR=Utligningsbilagsnr.;
                                                              SVE=Kopplas till ver.nr] }
    { 38  ;   ;Due Date            ;Date          ;OnValidate=BEGIN
                                                                //>>NAVFI
                                                                GLSetup.GET;
                                                                GenJnlLineExt.InitGetLine(Rec);//4PSSE
                                                                IF GLSetup."Finnish localization active" AND (GenJnlLineExt."Payment date" = 0D) THEN BEGIN
                                                                  GenJnlLineExt."Payment date" := "Due Date";
                                                                  GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE
                                                                END;
                                                                //<<NAVFI
                                                              END;

                                                   CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato;
                                                              SVE=Fîrfallodatum] }
    { 39  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              NOR=Kont.rabattdato;
                                                              SVE=Kassarabattsdatum] }
    { 40  ;   ;Payment Discount %  ;Decimal       ;CaptionML=[ENU=Payment Discount %;
                                                              NOR=Kontantrabatt-%;
                                                              SVE=Kassarabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 42  ;   ;Job No.             ;Code20        ;TableRelation=IF (Receiving Company=FILTER('')) Job;
                                                   OnValidate=VAR
                                                                lvBlockingCodeRec@1100485000 : Record 11012027;
                                                              BEGIN
                                                                IF "Job No." = xRec."Job No." THEN
                                                                  EXIT;

                                                                SourceCodeSetup.GET;
                                                                IF "Source Code" <> SourceCodeSetup."Job G/L WIP" THEN
                                                                  VALIDATE("Job Task No.",'');
                                                                //**4PS.so
                                                                //IF "Job No." = '' THEN BEGIN
                                                                //  CreateDim(
                                                                //    DATABASE::Job,"Job No.",
                                                                //    DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                //    DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                //    DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                //    DATABASE::Campaign,"Campaign No.");
                                                                //  EXIT;
                                                                //END;
                                                                //**4PS.eo
                                                                //**4PS.sn
                                                                CheckProjServPlantLoanAllowed(FIELDNO("Job No."));
                                                                CheckCompanyIC;
                                                                IF "Job No." <> '' THEN BEGIN
                                                                  Job.CHANGECOMPANY("Receiving Company");
                                                                //**4PS.en
                                                                  TESTFIELD("Account Type","Account Type"::"G/L Account");

                                                                  IF "Bal. Account No." <> '' THEN
                                                                    IF NOT ("Bal. Account Type" IN ["Bal. Account Type"::"G/L Account","Bal. Account Type"::"Bank Account"]) THEN
                                                                      ERROR(Text016,FIELDCAPTION("Bal. Account Type"));

                                                                  Job.GET("Job No.");
                                                                  Job.TestBlocked;
                                                                  "Job Currency Code" := Job."Currency Code";
                                                                //**4PS.sn
                                                                  "Job Description" := Job.Description;

                                                                  IF(Job."Blocking Code" <> '') AND
                                                                     ((Job."Project Status" = Job."Project Status"::"Technical Finished") OR
                                                                      (Job."Project Status" = Job."Project Status"::"Administrative Finished") OR
                                                                      ((Job."Project Status" = Job."Project Status"::Finished) AND ICProjSetupRec."Provisions at Closure")
                                                                     ) THEN
                                                                  BEGIN
                                                                    lvBlockingCodeRec.CheckBlocked(Job."Blocking Code", lvBlockingCodeRec.Switch::"General Journal", Job, TRUE);
                                                                  END ELSE BEGIN
                                                                    IF (ICProjSetupRec."Provisions at Closure") THEN BEGIN
                                                                      Job.CheckProjectStatus(-1);
                                                                    END ELSE BEGIN
                                                                      IF CurrFieldNo <> 0 THEN
                                                                        Job.CheckProjectStatus(1)
                                                                      ELSE
                                                                        Job.CheckProjectStatus(0);
                                                                    END;
                                                                  END;
                                                                  "Account Type" := "Account Type"::"G/L Account";
                                                                END ELSE BEGIN;
                                                                  "Account No." := '';
                                                                  "Rental Unit" := '';
                                                                END;
                                                                FillSystemCreatedEntry;

                                                                IF ("Shortcut Dimension 1 Code" <> '') AND ("Job No." <> '') AND
                                                                   (CurrFieldNo = FIELDNO("Job No.")) AND ("Job No." <> xRec."Job No.") THEN
                                                                  "Shortcut Dimension 1 Code" := '';
                                                                //**4PS.en


                                                                CreateDim(
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."), //**4PS.n
                                                                  DATABASE::"Plant Type", "Plant Type", //**4PS.n
                                                                  DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                  DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                  DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                  DATABASE::Campaign,"Campaign No.");

                                                                //**4PS.sn
                                                                IF "Shortcut Dimension 2 Code" <> '' THEN
                                                                  VALIDATE("Shortcut Dimension 2 Code");  //Also determine WIP Account

                                                                //**4PS.sn, idea of JR, see if this will be to all satisfaction.
                                                                IF ("Receiving Company" <> '') AND
                                                                   ("Receiving Company" <> COMPANYNAME) AND
                                                                   (Job."Global Dimension 1 Code" <> '') AND
                                                                   ("Shortcut Dimension 1 Code" = '') THEN
                                                                BEGIN
                                                                  VALIDATE("Shortcut Dimension 1 Code", Job."Global Dimension 1 Code");
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS.sn
                                                              OnLookupJobNo(TRUE);
                                                            END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr.;
                                                              SVE=Projektnr] }
    { 43  ;   ;Quantity            ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE(Amount);
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall;
                                                              SVE=Antal];
                                                   DecimalPlaces=0:5 }
    { 44  ;   ;VAT Amount          ;Decimal       ;OnValidate=BEGIN
                                                                GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
                                                                //GenJnlBatch.TESTFIELD("Allow VAT Difference",TRUE); //**4PS.o
                                                                IF NOT ("VAT Calculation Type" IN
                                                                        ["VAT Calculation Type"::"Normal VAT","VAT Calculation Type"::"Reverse Charge VAT"])
                                                                THEN
                                                                  ERROR(
                                                                    Text010,FIELDCAPTION("VAT Calculation Type"),
                                                                    "VAT Calculation Type"::"Normal VAT","VAT Calculation Type"::"Reverse Charge VAT");
                                                                IF "VAT Posting" = "VAT Posting"::"Automatic VAT Entry" THEN //**4PS.n
                                                                  IF "VAT Amount" <> 0 THEN BEGIN
                                                                    TESTFIELD("VAT %");
                                                                    TESTFIELD(Amount);
                                                                  END;

                                                                GetCurrency;
                                                                "VAT Amount" := ROUND("VAT Amount",Currency."Amount Rounding Precision",Currency.VATRoundingDirection);

                                                                IF "VAT Amount" * Amount < 0 THEN
                                                                  IF "VAT Amount" > 0 THEN
                                                                    ERROR(Text011,FIELDCAPTION("VAT Amount"))
                                                                  ELSE
                                                                    ERROR(Text012,FIELDCAPTION("VAT Amount"));

                                                                "VAT Base Amount" := Amount - "VAT Amount";

                                                                "VAT Difference" :=
                                                                  "VAT Amount" -
                                                                  ROUND(
                                                                    Amount * "VAT %" / (100 + "VAT %"),
                                                                    Currency."Amount Rounding Precision",Currency.VATRoundingDirection);
                                                                //**4PS.sn
                                                                IF "VAT Posting" = "VAT Posting"::"Automatic VAT Entry" THEN BEGIN
                                                                  IF ABS("VAT Difference") > 0 THEN
                                                                    GenJnlBatch.TESTFIELD("Allow VAT Difference",TRUE);
                                                                //**4PS.en
                                                                  IF ABS("VAT Difference") > Currency."Max. VAT Difference Allowed" THEN
                                                                    ERROR(Text013,FIELDCAPTION("VAT Difference"),Currency."Max. VAT Difference Allowed");
                                                                END; //**4PS.n

                                                                IF "Currency Code" = '' THEN
                                                                  "VAT Amount (LCY)" := "VAT Amount"
                                                                ELSE
                                                                  "VAT Amount (LCY)" :=
                                                                    ROUND(
                                                                      CurrExchRate.ExchangeAmtFCYToLCY(
                                                                        //**4PS.so
                                                                        //"Posting Date","Currency Code",
                                                                        //"VAT Amount","Currency Factor"));
                                                                        //**4PS.eo
                                                                        //**4PS.sn
                                                                        1, "Job No.", "Posting Date", "Currency Code",
                                                                        "VAT Amount", "Currency Factor", "Account Type" = "Account Type"::Customer));
                                                                        //**4PS.en
                                                                "VAT Base Amount (LCY)" := "Amount (LCY)" - "VAT Amount (LCY)";

                                                                UpdateSalesPurchLCY;

                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;

                                                                IF "Deferral Code" <> '' THEN
                                                                  VALIDATE("Deferral Code");
                                                              END;

                                                   CaptionML=[ENU=VAT Amount;
                                                              NOR=Mva-belõp;
                                                              SVE=Momsbelopp];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 45  ;   ;VAT Posting         ;Option        ;CaptionML=[ENU=VAT Posting;
                                                              NOR=Mva-bokfõring;
                                                              SVE=Momsbokfîring];
                                                   OptionCaptionML=[ENU=Automatic VAT Entry,Manual VAT Entry;
                                                                    NOR=Automatisk mva-post,Manuell mva-post;
                                                                    SVE=Automatisk,Manuell];
                                                   OptionString=Automatic VAT Entry,Manual VAT Entry;
                                                   Editable=No }
    { 47  ;   ;Payment Terms Code  ;Code10        ;TableRelation=IF (Receiving Company=FILTER('')) "Payment Terms";
                                                   OnValidate=VAR
                                                                IsHandled@1000 : Boolean;
                                                              BEGIN
                                                                CheckCompanyIC; //**4PS.n

                                                                "Due Date" := 0D;
                                                                "Pmt. Discount Date" := 0D;
                                                                "Payment Discount %" := 0;
                                                                IF ("Account Type" <> "Account Type"::"G/L Account") OR
                                                                   ("Bal. Account Type" <> "Bal. Account Type"::"G/L Account")
                                                                THEN
                                                                  CASE "Document Type" OF
                                                                    "Document Type"::Invoice:
                                                                      IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                        PaymentTerms.GET("Payment Terms Code");
                                                                        IsHandled := FALSE;
                                                                        OnValidatePaymentTermsCodeOnBeforeCalculateDueDate(Rec,PaymentTerms,IsHandled);
                                                                        IF NOT IsHandled THEN
                                                                          "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                        IsHandled := FALSE;
                                                                        OnValidatePaymentTermsCodeOnBeforeCalculatePmtDiscountDate(Rec,PaymentTerms,IsHandled);
                                                                        IF NOT IsHandled THEN
                                                                          "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                        "Payment Discount %" := PaymentTerms."Discount %";
                                                                      END ELSE
                                                                        "Due Date" := "Document Date";
                                                                    "Document Type"::"Credit Memo":
                                                                      IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                        PaymentTerms.GET("Payment Terms Code");
                                                                        IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN BEGIN
                                                                          "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                          "Pmt. Discount Date" :=
                                                                            CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                          "Payment Discount %" := PaymentTerms."Discount %";
                                                                        END ELSE
                                                                          "Due Date" := "Document Date";
                                                                      END ELSE
                                                                        "Due Date" := "Document Date";
                                                                    ELSE
                                                                      "Due Date" := "Document Date";
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              NOR=Betalingsbet.kode;
                                                              SVE=Betalningsvillkorskod];
                                                   Description=4PS: TableRelation changed }
    { 48  ;   ;Applies-to ID       ;Code50        ;OnValidate=BEGIN
                                                                //**4PS.sn
                                                                IF "Applies-to ID" <> '' THEN BEGIN
                                                                  CheckAppiesToDocNoAllowedForIC(TRUE, FIELDNO("Applies-to ID"));  //* C-017223
                                                                  ClearICApplicationFields;
                                                                END;
                                                                //**4PS.en

                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN
                                                                  ClearCustVendApplnEntry;
                                                                SetJournalLineFieldsFromApplication;
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              NOR=Utlignings-ID;
                                                              SVE=Koppla till ID] }
    { 50  ;   ;Business Unit Code  ;Code20        ;TableRelation="Business Unit";
                                                   CaptionML=[ENU=Business Unit Code;
                                                              NOR=Konsernkode;
                                                              SVE=AffÑrsenhetskod] }
    { 51  ;   ;Journal Batch Name  ;Code10        ;TableRelation="Gen. Journal Batch".Name WHERE (Journal Template Name=FIELD(Journal Template Name));
                                                   OnValidate=BEGIN
                                                                UpdateJournalBatchID;
                                                              END;

                                                   CaptionML=[ENU=Journal Batch Name;
                                                              NOR=Kladdenavn;
                                                              SVE=Journalnamn] }
    { 52  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              NOR=èrsaksspor;
                                                              SVE=Uppfîljningskod] }
    { 53  ;   ;Recurring Method    ;Option        ;OnValidate=BEGIN
                                                                IF "Recurring Method" IN
                                                                   ["Recurring Method"::"B  Balance","Recurring Method"::"RB Reversing Balance"]
                                                                THEN
                                                                  TESTFIELD("Currency Code",'');
                                                                UpdateSalesPurchLCY;

                                                                //**4PS.sn
                                                                IF "Recurring Method" IN ["Recurring Method"::"RF Reversing Fixed",
                                                                   "Recurring Method"::"RV Reversing Variable", "Recurring Method"::"RB Reversing Balance"]
                                                                THEN
                                                                  "Receiving Company" := '';
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Recurring Method;
                                                              NOR=Gjentakelsesprinsipp;
                                                              SVE=Metod fîr Üterkommande trans.];
                                                   OptionCaptionML=[ENU=" ,F  Fixed,V  Variable,B  Balance,RF Reversing Fixed,RV Reversing Variable,RB Reversing Balance";
                                                                    NOR=" ,F  Fast,V  Variabel,S  Saldo,FT Fast med tilbakefõring,VT Variabel med tilbakefõring,ST Saldo med tilbakefõring";
                                                                    SVE=" ,F  Fast,V  Variabel,B  Balansering,èF èterfîring fast,èV èterfîring variabel,èB èterfîring balansering"];
                                                   OptionString=[ ,F  Fixed,V  Variable,B  Balance,RF Reversing Fixed,RV Reversing Variable,RB Reversing Balance];
                                                   BlankZero=Yes }
    { 54  ;   ;Expiration Date     ;Date          ;CaptionML=[ENU=Expiration Date;
                                                              NOR=UtgÜr den;
                                                              SVE=UtgÜngsdatum] }
    { 55  ;   ;Recurring Frequency ;DateFormula   ;CaptionML=[ENU=Recurring Frequency;
                                                              NOR=Gjentakelsesintervall;
                                                              SVE=èterkommande frekvens] }
    { 56  ;   ;Allocated Amt. (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Gen. Jnl. Allocation".Amount WHERE (Journal Template Name=FIELD(Journal Template Name),
                                                                                                        Journal Batch Name=FIELD(Journal Batch Name),
                                                                                                        Journal Line No.=FIELD(Line No.)));
                                                   CaptionML=[ENU=Allocated Amt. (LCY);
                                                              NOR=Fordelt belõp (NOK);
                                                              SVE=Fîrdelat belopp (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 57  ;   ;Gen. Posting Type   ;Option        ;OnValidate=VAR
                                                                CheckIfFieldIsEmpty@1000 : Boolean;
                                                              BEGIN
                                                                CheckIfFieldIsEmpty := "Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Bank Account"];
                                                                OnBeforeValidateGenPostingType(Rec,CheckIfFieldIsEmpty);
                                                                IF CheckIfFieldIsEmpty THEN
                                                                  TESTFIELD("Gen. Posting Type","Gen. Posting Type"::" ");
                                                                IF ("Gen. Posting Type" = "Gen. Posting Type"::Settlement) AND (CurrFieldNo <> 0) THEN
                                                                  ERROR(Text006,"Gen. Posting Type");
                                                                CheckVATInAlloc;
                                                                IF "Gen. Posting Type" > 0 THEN
                                                                  VALIDATE("VAT Prod. Posting Group");
                                                                IF "Gen. Posting Type" <> "Gen. Posting Type"::Purchase THEN
                                                                  VALIDATE("Use Tax",FALSE)
                                                              END;

                                                   CaptionML=[ENU=Gen. Posting Type;
                                                              NOR=Bokfõringstype;
                                                              SVE=Typ av bokfîring];
                                                   OptionCaptionML=[ENU=" ,Purchase,Sale,Settlement";
                                                                    NOR=" ,Inng.,Utg.,Avregning";
                                                                    SVE=" ,Inkîp,FîrsÑljning,AvrÑkning"];
                                                   OptionString=[ ,Purchase,Sale,Settlement] }
    { 58  ;   ;Gen. Bus. Posting Group;Code20     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=VAR
                                                                CheckIfFieldIsEmpty@1000 : Boolean;
                                                              BEGIN
                                                                CheckIfFieldIsEmpty := "Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Bank Account"];
                                                                OnBeforeValidateGenBusPostingGroup(Rec,CheckIfFieldIsEmpty);
                                                                IF CheckIfFieldIsEmpty THEN
                                                                  TESTFIELD("Gen. Bus. Posting Group",'');
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokfõringsgruppe - firma;
                                                              SVE=Gen. rîrelsebokfîringsmall] }
    { 59  ;   ;Gen. Prod. Posting Group;Code20    ;TableRelation="Gen. Product Posting Group";
                                                   OnValidate=VAR
                                                                CheckIfFieldIsEmpty@1000 : Boolean;
                                                              BEGIN
                                                                CheckIfFieldIsEmpty := "Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Bank Account"];
                                                                OnBeforeValidateGenProdPostingGroup(Rec,CheckIfFieldIsEmpty);
                                                                IF CheckIfFieldIsEmpty THEN
                                                                  TESTFIELD("Gen. Prod. Posting Group",'');
                                                                IF xRec."Gen. Prod. Posting Group" <> "Gen. Prod. Posting Group" THEN
                                                                  IF GenProdPostingGrp.ValidateVatProdPostingGroup(GenProdPostingGrp,"Gen. Prod. Posting Group") THEN
                                                                    VALIDATE("VAT Prod. Posting Group",GenProdPostingGrp."Def. VAT Prod. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokfõringsgruppe - vare;
                                                              SVE=Produktbokfîringsmall] }
    { 60  ;   ;VAT Calculation Type;Option        ;CaptionML=[ENU=VAT Calculation Type;
                                                              NOR=Mva-beregningstype;
                                                              SVE=MomsberÑkningstyp];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NOR=Normal mva.,Snudd avregning,Full mva.,Salgsmva.;
                                                                    SVE=Normal moms,OmvÑnd EG-moms,Enbart moms,OmsÑttningsskatt];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                   Editable=No }
    { 61  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              NOR=Trekanthandel;
                                                              SVE=EU trepartshandel];
                                                   Editable=No }
    { 62  ;   ;Allow Application   ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Allow Application;
                                                              NOR=Tillat utligning;
                                                              SVE=TillÜt att koppla] }
    { 63  ;   ;Bal. Account Type   ;Option        ;OnValidate=BEGIN
                                                                IF ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Fixed Asset",
                                                                                       "Account Type"::"IC Partner","Account Type"::Employee]) AND
                                                                   ("Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Fixed Asset",
                                                                                            "Bal. Account Type"::"IC Partner","Bal. Account Type"::Employee])
                                                                THEN
                                                                  ERROR(
                                                                    Text000,
                                                                    FIELDCAPTION("Account Type"),FIELDCAPTION("Bal. Account Type"));

                                                                IF ("Bal. Account Type" = "Bal. Account Type"::Employee) AND ("Currency Code" <> '') THEN
                                                                  ERROR(OnlyLocalCurrencyForEmployeeErr);

                                                                VALIDATE("Bal. Account No.",'');
                                                                VALIDATE("IC Partner G/L Acc. No.",'');
                                                                IF "Bal. Account Type" IN
                                                                   ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Bank Account","Bal. Account Type"::Employee]
                                                                THEN BEGIN
                                                                  VALIDATE("Bal. Gen. Posting Type","Bal. Gen. Posting Type"::" ");
                                                                  VALIDATE("Bal. Gen. Bus. Posting Group",'');
                                                                  VALIDATE("Bal. Gen. Prod. Posting Group",'');
                                                                END ELSE
                                                                  IF "Account Type" IN [
                                                                                        "Bal. Account Type"::"G/L Account","Account Type"::"Bank Account","Account Type"::"Fixed Asset"]
                                                                  THEN
                                                                    VALIDATE("Payment Terms Code",'');

                                                                UpdateSource;
                                                                IF ("Account Type" <> "Account Type"::"Fixed Asset") AND
                                                                   ("Bal. Account Type" <> "Bal. Account Type"::"Fixed Asset")
                                                                THEN BEGIN
                                                                  "Depreciation Book Code" := '';
                                                                  VALIDATE("FA Posting Type","FA Posting Type"::" ");
                                                                END;
                                                                IF xRec."Bal. Account Type" IN
                                                                   [xRec."Bal. Account Type"::Customer,xRec."Bal. Account Type"::Vendor]
                                                                THEN BEGIN
                                                                  "Bill-to/Pay-to No." := '';
                                                                  "Ship-to/Order Address Code" := '';
                                                                  "Sell-to/Buy-from No." := '';
                                                                  "VAT Registration No." := '';
                                                                END;
                                                                IF ("Account Type" IN [
                                                                                       "Account Type"::"G/L Account","Account Type"::"Bank Account","Account Type"::"Fixed Asset"]) AND
                                                                   ("Bal. Account Type" IN [
                                                                                            "Bal. Account Type"::"G/L Account","Bal. Account Type"::"Bank Account","Bal. Account Type"::"Fixed Asset"])
                                                                THEN
                                                                  VALIDATE("Payment Terms Code",'');

                                                                IF "Bal. Account Type" = "Bal. Account Type"::"IC Partner" THEN BEGIN
                                                                  GetTemplate;
                                                                  IF GenJnlTemplate.Type <> GenJnlTemplate.Type::Intercompany THEN
                                                                    FIELDERROR("Bal. Account Type");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Bal. Account Type;
                                                              NOR=Motkontotype;
                                                              SVE=Motkontotyp];
                                                   OptionCaptionML=[ENU=G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee;
                                                                    NOR=Finans,Kunde,Leverandõr,Bank,Aktiva,KI-partner,Ansatt;
                                                                    SVE=Redov.konto,Kund,Leverantîr,Bankkonto,AnlÑggningstillgÜng,Konc.int. partner,AnstÑlld];
                                                   OptionString=G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee }
    { 64  ;   ;Bal. Gen. Posting Type;Option      ;OnValidate=VAR
                                                                CheckIfFieldIsEmpty@1000 : Boolean;
                                                              BEGIN
                                                                CheckIfFieldIsEmpty :=
                                                                  "Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Bank Account"];
                                                                OnBeforeValidateBalGenPostingType(Rec,CheckIfFieldIsEmpty);
                                                                IF CheckIfFieldIsEmpty THEN
                                                                  TESTFIELD("Bal. Gen. Posting Type","Bal. Gen. Posting Type"::" ");
                                                                IF ("Bal. Gen. Posting Type" = "Gen. Posting Type"::Settlement) AND (CurrFieldNo <> 0) THEN
                                                                  ERROR(Text006,"Bal. Gen. Posting Type");
                                                                IF "Bal. Gen. Posting Type" > 0 THEN
                                                                  VALIDATE("Bal. VAT Prod. Posting Group");

                                                                IF ("Account Type" <> "Account Type"::"Fixed Asset") AND
                                                                   ("Bal. Account Type" <> "Bal. Account Type"::"Fixed Asset")
                                                                THEN BEGIN
                                                                  "Depreciation Book Code" := '';
                                                                  VALIDATE("FA Posting Type","FA Posting Type"::" ");
                                                                END;
                                                                IF "Bal. Gen. Posting Type" <> "Bal. Gen. Posting Type"::Purchase THEN
                                                                  VALIDATE("Bal. Use Tax",FALSE);
                                                              END;

                                                   CaptionML=[ENU=Bal. Gen. Posting Type;
                                                              NOR=Motkonto-bokfõringstype;
                                                              SVE=Radtyp balansering];
                                                   OptionCaptionML=[ENU=" ,Purchase,Sale,Settlement";
                                                                    NOR=" ,Inng.,Utg.,Avregning";
                                                                    SVE=" ,Inkîp,FîrsÑljning,AvrÑkning"];
                                                   OptionString=[ ,Purchase,Sale,Settlement] }
    { 65  ;   ;Bal. Gen. Bus. Posting Group;Code20;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=VAR
                                                                CheckIfFieldIsEmpty@1000 : Boolean;
                                                              BEGIN
                                                                CheckIfFieldIsEmpty :=
                                                                  "Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Bank Account"];
                                                                OnBeforeValidateBalGenBusPostingGroup(Rec,CheckIfFieldIsEmpty);
                                                                IF CheckIfFieldIsEmpty THEN
                                                                  TESTFIELD("Bal. Gen. Bus. Posting Group",'');
                                                                IF xRec."Bal. Gen. Bus. Posting Group" <> "Bal. Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Bal. Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("Bal. VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Bal. Gen. Bus. Posting Group;
                                                              NOR=Motkontobokfõringsgrp - firma;
                                                              SVE=Bal. gen. rîrelsebokf.mall] }
    { 66  ;   ;Bal. Gen. Prod. Posting Group;Code20;
                                                   TableRelation="Gen. Product Posting Group";
                                                   OnValidate=VAR
                                                                CheckIfFieldIsEmpty@1000 : Boolean;
                                                              BEGIN
                                                                CheckIfFieldIsEmpty :=
                                                                  "Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Bank Account"];
                                                                OnBeforeValidateBalGenProdPostingGroup(Rec,CheckIfFieldIsEmpty);
                                                                IF CheckIfFieldIsEmpty THEN
                                                                  TESTFIELD("Bal. Gen. Prod. Posting Group",'');
                                                                IF xRec."Bal. Gen. Prod. Posting Group" <> "Bal. Gen. Prod. Posting Group" THEN
                                                                  IF GenProdPostingGrp.ValidateVatProdPostingGroup(GenProdPostingGrp,"Bal. Gen. Prod. Posting Group") THEN
                                                                    VALIDATE("Bal. VAT Prod. Posting Group",GenProdPostingGrp."Def. VAT Prod. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Bal. Gen. Prod. Posting Group;
                                                              NOR=Motkontobokfõringsgruppe - vare;
                                                              SVE=Produktbokfîringsmall bal.] }
    { 67  ;   ;Bal. VAT Calculation Type;Option   ;CaptionML=[ENU=Bal. VAT Calculation Type;
                                                              NOR=Motkto-mva. -  beregningstype;
                                                              SVE=MomsberÑkningstyp motkonto];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NOR=Normal mva.,Snudd avregning,Full mva.,Salgsmva.;
                                                                    SVE=Normal moms,OmvÑnd EG-moms,Enbart moms,OmsÑttningsskatt];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                   Editable=No }
    { 68  ;   ;Bal. VAT %          ;Decimal       ;OnValidate=BEGIN
                                                                GetCurrency;
                                                                IF "Bal. VAT Posting" = "Bal. VAT Posting"::"Automatic VAT Entry" THEN  //**4PS.n
                                                                CASE "Bal. VAT Calculation Type" OF
                                                                  "Bal. VAT Calculation Type"::"Normal VAT",
                                                                  "Bal. VAT Calculation Type"::"Reverse Charge VAT":
                                                                    BEGIN
                                                                      "Bal. VAT Amount" :=
                                                                        ROUND(-Amount * "Bal. VAT %" / (100 + "Bal. VAT %"),Currency."Amount Rounding Precision",Currency.VATRoundingDirection);
                                                                      "Bal. VAT Base Amount" :=
                                                                        ROUND(-Amount - "Bal. VAT Amount",Currency."Amount Rounding Precision");
                                                                    END;
                                                                  "Bal. VAT Calculation Type"::"Full VAT":
                                                                    "Bal. VAT Amount" := -Amount;
                                                                  "Bal. VAT Calculation Type"::"Sales Tax":
                                                                    IF ("Bal. Gen. Posting Type" = "Bal. Gen. Posting Type"::Purchase) AND
                                                                       "Bal. Use Tax"
                                                                    THEN BEGIN
                                                                      "Bal. VAT Amount" := 0;
                                                                      "Bal. VAT %" := 0;
                                                                    END ELSE BEGIN
                                                                      "Bal. VAT Amount" :=
                                                                        -(Amount -
                                                                          SalesTaxCalculate.ReverseCalculateTax(
                                                                            "Bal. Tax Area Code","Bal. Tax Group Code","Bal. Tax Liable",
                                                                            "Posting Date",Amount,Quantity,"Currency Factor"));
                                                                      OnAfterSalesTaxCalculateReverseCalculateTax(Rec,CurrFieldNo);
                                                                      IF Amount + "Bal. VAT Amount" <> 0 THEN
                                                                        "Bal. VAT %" := ROUND(100 * -"Bal. VAT Amount" / (Amount + "Bal. VAT Amount"),0.00001)
                                                                      ELSE
                                                                        "Bal. VAT %" := 0;
                                                                      "Bal. VAT Amount" :=
                                                                        ROUND("Bal. VAT Amount",Currency."Amount Rounding Precision");
                                                                    END;
                                                                END;
                                                                "Bal. VAT Base Amount" := -(Amount + "Bal. VAT Amount");
                                                                "Bal. VAT Difference" := 0;

                                                                IF "Currency Code" = '' THEN
                                                                  "Bal. VAT Amount (LCY)" := "Bal. VAT Amount"
                                                                ELSE
                                                                  "Bal. VAT Amount (LCY)" :=
                                                                    ROUND(
                                                                    //CurrExchRate.ExchangeAmtFCYToLCY("Posting Date","Currency Code","Bal. VAT Amount","Currency Factor")); //**4PS.o
                                                                      CurrExchRate.ExchangeAmtFCYToLCY(1,"Job No.","Posting Date","Currency Code","Bal. VAT Amount","Currency Factor","Account Type" = "Account Type"::Customer)); //**4PS.n
                                                                OnValidateBalVATPctOnAfterAssignBalVATAmountLCY("Bal. VAT Amount (LCY)");
                                                                "Bal. VAT Base Amount (LCY)" := -("Amount (LCY)" + "Bal. VAT Amount (LCY)");

                                                                OnValidateVATPctOnBeforeUpdateSalesPurchLCY(Rec,Currency);
                                                                UpdateSalesPurchLCY;
                                                              END;

                                                   CaptionML=[ENU=Bal. VAT %;
                                                              NOR=Motkonto-mva-%;
                                                              SVE=Momssats % motkonto];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Editable=No }
    { 69  ;   ;Bal. VAT Amount     ;Decimal       ;OnValidate=BEGIN
                                                                GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
                                                                GenJnlBatch.TESTFIELD("Allow VAT Difference",TRUE);
                                                                IF NOT ("Bal. VAT Calculation Type" IN
                                                                        ["Bal. VAT Calculation Type"::"Normal VAT","Bal. VAT Calculation Type"::"Reverse Charge VAT"])
                                                                THEN
                                                                  ERROR(
                                                                    Text010,FIELDCAPTION("Bal. VAT Calculation Type"),
                                                                    "Bal. VAT Calculation Type"::"Normal VAT","Bal. VAT Calculation Type"::"Reverse Charge VAT");
                                                                IF "Bal. VAT Posting" = "Bal. VAT Posting"::"Automatic VAT Entry" THEN //**4PS.n
                                                                IF "Bal. VAT Amount" <> 0 THEN BEGIN
                                                                  TESTFIELD("Bal. VAT %");
                                                                  TESTFIELD(Amount);
                                                                END;

                                                                GetCurrency;
                                                                "Bal. VAT Amount" :=
                                                                  ROUND("Bal. VAT Amount",Currency."Amount Rounding Precision",Currency.VATRoundingDirection);

                                                                IF "Bal. VAT Amount" * Amount > 0 THEN
                                                                  IF "Bal. VAT Amount" > 0 THEN
                                                                    ERROR(Text011,FIELDCAPTION("Bal. VAT Amount"))
                                                                  ELSE
                                                                    ERROR(Text012,FIELDCAPTION("Bal. VAT Amount"));

                                                                "Bal. VAT Base Amount" := -(Amount + "Bal. VAT Amount");

                                                                "Bal. VAT Difference" :=
                                                                  "Bal. VAT Amount" -
                                                                  ROUND(
                                                                    -Amount * "Bal. VAT %" / (100 + "Bal. VAT %"),
                                                                    Currency."Amount Rounding Precision",Currency.VATRoundingDirection);
                                                                IF "Bal. VAT Posting" = "Bal. VAT Posting"::"Automatic VAT Entry" THEN //**4PS.n
                                                                IF ABS("Bal. VAT Difference") > Currency."Max. VAT Difference Allowed" THEN
                                                                  ERROR(
                                                                    Text013,FIELDCAPTION("Bal. VAT Difference"),Currency."Max. VAT Difference Allowed");

                                                                IF "Currency Code" = '' THEN
                                                                  "Bal. VAT Amount (LCY)" := "Bal. VAT Amount"
                                                                ELSE
                                                                  "Bal. VAT Amount (LCY)" :=
                                                                    ROUND(
                                                                      CurrExchRate.ExchangeAmtFCYToLCY(
                                                                        //**4PS.so
                                                                        //"Posting Date","Currency Code",
                                                                        //"Bal. VAT Amount","Currency Factor"));
                                                                        //**4PS.eo
                                                                        //**4PS.sn
                                                                        1, "Job No.", "Posting Date","Currency Code",
                                                                        "Bal. VAT Amount", "Currency Factor", "Account Type" = "Account Type"::Customer));
                                                                        //**4PS.en
                                                                "Bal. VAT Base Amount (LCY)" := -("Amount (LCY)" + "Bal. VAT Amount (LCY)");

                                                                UpdateSalesPurchLCY;
                                                              END;

                                                   CaptionML=[ENU=Bal. VAT Amount;
                                                              NOR=Motkonto-mva. - belõp;
                                                              SVE=Momsbelopp bal.];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 70  ;   ;Bank Payment Type   ;Option        ;OnValidate=BEGIN
                                                                IF ("Bank Payment Type" <> "Bank Payment Type"::" ") AND
                                                                   ("Account Type" <> "Account Type"::"Bank Account") AND
                                                                   ("Bal. Account Type" <> "Bal. Account Type"::"Bank Account")
                                                                THEN
                                                                  ERROR(
                                                                    Text007,
                                                                    FIELDCAPTION("Account Type"),FIELDCAPTION("Bal. Account Type"));
                                                                IF ("Account Type" = "Account Type"::"Fixed Asset") AND
                                                                   ("Bank Payment Type" <> "Bank Payment Type"::" ")
                                                                THEN
                                                                  FIELDERROR("Account Type");
                                                              END;

                                                   AccessByPermission=TableData 270=R;
                                                   CaptionML=[ENU=Bank Payment Type;
                                                              NOR=Bankbetalingstype;
                                                              SVE=Bankbetalningstyp];
                                                   OptionCaptionML=[ENU=" ,Computer Check,Manual Check,Electronic Payment,Electronic Payment-IAT";
                                                                    NOR=" ,Maskinell sjekk,Manuell sjekk,Elektronisk betaling,Elektronisk betaling-IAT";
                                                                    SVE=" ,Datorcheck,Handskriven check,Elektronisk betalning,Elektronisk betalning - IAT"];
                                                   OptionString=[ ,Computer Check,Manual Check,Electronic Payment,Electronic Payment-IAT] }
    { 71  ;   ;VAT Base Amount     ;Decimal       ;OnValidate=BEGIN
                                                                GetCurrency;
                                                                "VAT Base Amount" := ROUND("VAT Base Amount",Currency."Amount Rounding Precision");
                                                                CASE "VAT Calculation Type" OF
                                                                  "VAT Calculation Type"::"Normal VAT",
                                                                  "VAT Calculation Type"::"Reverse Charge VAT":
                                                                    Amount :=
                                                                      ROUND(
                                                                        "VAT Base Amount" * (1 + "VAT %" / 100),
                                                                        Currency."Amount Rounding Precision",Currency.VATRoundingDirection);
                                                                  "VAT Calculation Type"::"Full VAT":
                                                                    IF "VAT Base Amount" <> 0 THEN
                                                                      FIELDERROR(
                                                                        "VAT Base Amount",
                                                                        STRSUBSTNO(
                                                                          Text008,FIELDCAPTION("VAT Calculation Type"),
                                                                          "VAT Calculation Type"));
                                                                  "VAT Calculation Type"::"Sales Tax":
                                                                    IF ("Gen. Posting Type" = "Gen. Posting Type"::Purchase) AND
                                                                       "Use Tax"
                                                                    THEN BEGIN
                                                                      "VAT Amount" := 0;
                                                                      "VAT %" := 0;
                                                                      Amount := "VAT Base Amount" + "VAT Amount";
                                                                    END ELSE BEGIN
                                                                      "VAT Amount" :=
                                                                        SalesTaxCalculate.CalculateTax(
                                                                          "Tax Area Code","Tax Group Code","Tax Liable","Posting Date",
                                                                          "VAT Base Amount",Quantity,"Currency Factor");
                                                                      OnAfterSalesTaxCalculateCalculateTax(Rec,CurrFieldNo);
                                                                      IF "VAT Base Amount" <> 0 THEN
                                                                        "VAT %" := ROUND(100 * "VAT Amount" / "VAT Base Amount",0.00001)
                                                                      ELSE
                                                                        "VAT %" := 0;
                                                                      "VAT Amount" :=
                                                                        ROUND("VAT Amount",Currency."Amount Rounding Precision");
                                                                      Amount := "VAT Base Amount" + "VAT Amount";
                                                                    END;
                                                                END;
                                                                OnValidateVATBaseAmountOnBeforeValidateAmount(Rec,Currency);
                                                                VALIDATE(Amount);
                                                              END;

                                                   CaptionML=[ENU=VAT Base Amount;
                                                              NOR=Mva-grunnlagsbelõp;
                                                              SVE=Nettobelopp];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 72  ;   ;Bal. VAT Base Amount;Decimal       ;OnValidate=BEGIN
                                                                GetCurrency;
                                                                "Bal. VAT Base Amount" := ROUND("Bal. VAT Base Amount",Currency."Amount Rounding Precision");
                                                                CASE "Bal. VAT Calculation Type" OF
                                                                  "Bal. VAT Calculation Type"::"Normal VAT",
                                                                  "Bal. VAT Calculation Type"::"Reverse Charge VAT":
                                                                    Amount :=
                                                                      ROUND(
                                                                        -"Bal. VAT Base Amount" * (1 + "Bal. VAT %" / 100),
                                                                        Currency."Amount Rounding Precision",Currency.VATRoundingDirection);
                                                                  "Bal. VAT Calculation Type"::"Full VAT":
                                                                    IF "Bal. VAT Base Amount" <> 0 THEN
                                                                      FIELDERROR(
                                                                        "Bal. VAT Base Amount",
                                                                        STRSUBSTNO(
                                                                          Text008,FIELDCAPTION("Bal. VAT Calculation Type"),
                                                                          "Bal. VAT Calculation Type"));
                                                                  "Bal. VAT Calculation Type"::"Sales Tax":
                                                                    IF ("Bal. Gen. Posting Type" = "Bal. Gen. Posting Type"::Purchase) AND
                                                                       "Bal. Use Tax"
                                                                    THEN BEGIN
                                                                      "Bal. VAT Amount" := 0;
                                                                      "Bal. VAT %" := 0;
                                                                      Amount := -"Bal. VAT Base Amount" - "Bal. VAT Amount";
                                                                    END ELSE BEGIN
                                                                      "Bal. VAT Amount" :=
                                                                        SalesTaxCalculate.CalculateTax(
                                                                          "Bal. Tax Area Code","Bal. Tax Group Code","Bal. Tax Liable",
                                                                          "Posting Date","Bal. VAT Base Amount",Quantity,"Currency Factor");
                                                                      OnAfterSalesTaxCalculateCalculateTax(Rec,CurrFieldNo);
                                                                      IF "Bal. VAT Base Amount" <> 0 THEN
                                                                        "Bal. VAT %" := ROUND(100 * "Bal. VAT Amount" / "Bal. VAT Base Amount",0.00001)
                                                                      ELSE
                                                                        "Bal. VAT %" := 0;
                                                                      "Bal. VAT Amount" :=
                                                                        ROUND("Bal. VAT Amount",Currency."Amount Rounding Precision");
                                                                      Amount := -"Bal. VAT Base Amount" - "Bal. VAT Amount";
                                                                    END;
                                                                END;
                                                                VALIDATE(Amount);
                                                              END;

                                                   CaptionML=[ENU=Bal. VAT Base Amount;
                                                              NOR=Motkonto-mva-grunnlag - belõp;
                                                              SVE=Nettobelopp motkonto];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 73  ;   ;Correction          ;Boolean       ;OnValidate=BEGIN
                                                                VALIDATE(Amount);
                                                              END;

                                                   CaptionML=[ENU=Correction;
                                                              NOR=Korreksjon;
                                                              SVE=RÑttningstransaktion] }
    { 75  ;   ;Check Printed       ;Boolean       ;AccessByPermission=TableData 272=R;
                                                   CaptionML=[ENU=Check Printed;
                                                              NOR=Sjekk utskrevet;
                                                              SVE=Check utskriven];
                                                   Editable=No }
    { 76  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum];
                                                   ClosingDates=Yes }
    { 77  ;   ;External Document No.;Code35       ;OnValidate=BEGIN
                                                                //NAVNO
                                                                SetStructuredPayment;
                                                                // PEB0026
                                                                gBaseTables.ValidateExternalDocumentNo(Rec);
                                                                // 0026
                                                              END;

                                                   CaptionML=[ENU=External Document No.;
                                                              NOR=Eksterndokumentnr.;
                                                              SVE=Externt dokumentnr] }
    { 78  ;   ;Source Type         ;Option        ;OnValidate=BEGIN
                                                                IF ("Account Type" <> "Account Type"::"G/L Account") AND ("Account No." <> '') OR
                                                                   ("Bal. Account Type" <> "Bal. Account Type"::"G/L Account") AND ("Bal. Account No." <> '')
                                                                THEN
                                                                  UpdateSource
                                                                ELSE
                                                                  "Source No." := '';
                                                              END;

                                                   CaptionML=[ENU=Source Type;
                                                              NOR=Kildetype;
                                                              SVE=Ursprungstyp];
                                                   OptionCaptionML=[ENU=" ,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee";
                                                                    NOR=" ,Kunde,Leverandõr,Bankkonto,Aktiva,KI-partner,Ansatt";
                                                                    SVE=" ,Kund,Leverantîr,Bankkonto,AnlÑggningstillgÜng,Konc.int. partner,AnstÑlld"];
                                                   OptionString=[ ,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee] }
    { 79  ;   ;Source No.          ;Code20        ;TableRelation=IF (Source Type=CONST(Customer)) Customer
                                                                 ELSE IF (Source Type=CONST(Vendor)) Vendor
                                                                 ELSE IF (Source Type=CONST(Bank Account)) "Bank Account"
                                                                 ELSE IF (Source Type=CONST(Fixed Asset)) "Fixed Asset"
                                                                 ELSE IF (Source Type=CONST(Employee)) Employee;
                                                   OnValidate=BEGIN
                                                                IF ("Account Type" <> "Account Type"::"G/L Account") AND ("Account No." <> '') OR
                                                                   ("Bal. Account Type" <> "Bal. Account Type"::"G/L Account") AND ("Bal. Account No." <> '')
                                                                THEN
                                                                  UpdateSource;
                                                              END;

                                                   CaptionML=[ENU=Source No.;
                                                              NOR=Kildenr.;
                                                              SVE=Ursprungsnr] }
    { 80  ;   ;Posting No. Series  ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Posting No. Series;
                                                              NOR=Bokfõringsnr.serie;
                                                              SVE=Bokfîringsnr-serie] }
    { 82  ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                VALIDATE("VAT %");
                                                              END;

                                                   CaptionML=[ENU=Tax Area Code;
                                                              NOR=Mva-omrÜdekode;
                                                              SVE=SkatteomrÜdeskod] }
    { 83  ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                VALIDATE("VAT %");
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              NOR=Skyldig mva.;
                                                              SVE=Skattepliktig] }
    { 84  ;   ;Tax Group Code      ;Code20        ;TableRelation="Tax Group";
                                                   OnValidate=BEGIN
                                                                VALIDATE("VAT %");
                                                              END;

                                                   CaptionML=[ENU=Tax Group Code;
                                                              NOR=Mva-gruppekode;
                                                              SVE=Skattegruppskod] }
    { 85  ;   ;Use Tax             ;Boolean       ;OnValidate=BEGIN
                                                                IF NOT "Use Tax" THEN
                                                                  EXIT;
                                                                TESTFIELD("Gen. Posting Type","Gen. Posting Type"::Purchase);
                                                                VALIDATE("VAT %");
                                                              END;

                                                   CaptionML=[ENU=Use Tax;
                                                              NOR=Amerikansk mva.;
                                                              SVE=AnvÑnd skatt] }
    { 86  ;   ;Bal. Tax Area Code  ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                VALIDATE("Bal. VAT %");
                                                              END;

                                                   CaptionML=[ENU=Bal. Tax Area Code;
                                                              NOR=Motkonto-mva. - omrÜdekode;
                                                              SVE=SkatteomrÜdeskod motkonto] }
    { 87  ;   ;Bal. Tax Liable     ;Boolean       ;OnValidate=BEGIN
                                                                VALIDATE("Bal. VAT %");
                                                              END;

                                                   CaptionML=[ENU=Bal. Tax Liable;
                                                              NOR=Motkonto skyldig mva.;
                                                              SVE=Skattepliktig motkonto] }
    { 88  ;   ;Bal. Tax Group Code ;Code20        ;TableRelation="Tax Group";
                                                   OnValidate=BEGIN
                                                                VALIDATE("Bal. VAT %");
                                                              END;

                                                   CaptionML=[ENU=Bal. Tax Group Code;
                                                              NOR=Motkonto-mva-gruppe - kode;
                                                              SVE=Skattegruppskod motkonto] }
    { 89  ;   ;Bal. Use Tax        ;Boolean       ;OnValidate=BEGIN
                                                                IF NOT "Bal. Use Tax" THEN
                                                                  EXIT;
                                                                TESTFIELD("Bal. Gen. Posting Type","Bal. Gen. Posting Type"::Purchase);
                                                                VALIDATE("Bal. VAT %");
                                                              END;

                                                   CaptionML=[ENU=Bal. Use Tax;
                                                              NOR=Amerikansk mva. - motpost;
                                                              SVE=AnvÑnd skatt motkonto] }
    { 90  ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Bank Account"] THEN
                                                                  TESTFIELD("VAT Bus. Posting Group",'');

                                                                VALIDATE("VAT Prod. Posting Group");

                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;

                                                                ReadGLSetup;
                                                                IF GLSetup."Norwegian Localization Active" THEN
                                                                  NorwegianVATTools.InitVATCode_GenJnlLine(Rec,FALSE);  //NAVNO
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokfõringsgruppe - firma;
                                                              SVE=Moms rîrelsebokfîringsmall] }
    { 91  ;   ;VAT Prod. Posting Group;Code20     ;TableRelation="VAT Product Posting Group";
                                                   OnValidate=VAR
                                                                IsHandled@1000 : Boolean;
                                                              BEGIN
                                                                IF "Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Bank Account"] THEN
                                                                  TESTFIELD("VAT Prod. Posting Group",'');

                                                                CheckVATInAlloc;

                                                                "VAT %" := 0;
                                                                "VAT Calculation Type" := "VAT Calculation Type"::"Normal VAT";
                                                                IsHandled := FALSE;
                                                                OnValidateVATProdPostingGroupOnBeforeVATCalculationCheck(Rec,VATPostingSetup,IsHandled);
                                                                IF NOT IsHandled THEN
                                                                  IF "Gen. Posting Type" <> 0 THEN BEGIN
                                                                    GetVATPostingSetup("VAT Bus. Posting Group","VAT Prod. Posting Group");
                                                                    "VAT Calculation Type" := VATPostingSetup."VAT Calculation Type";
                                                                    //**4PS.sn
                                                                    IF VATPostingSetup.Manually THEN
                                                                      "VAT Posting" := "VAT Posting"::"Manual VAT Entry"
                                                                    ELSE
                                                                      "VAT Posting" := "VAT Posting"::"Automatic VAT Entry";
                                                                    IF "VAT Posting" = "VAT Posting"::"Automatic VAT Entry" THEN
                                                                    //**4PS.en
                                                                    CASE "VAT Calculation Type" OF
                                                                      "VAT Calculation Type"::"Normal VAT":
                                                                        "VAT %" := VATPostingSetup."VAT %";
                                                                      "VAT Calculation Type"::"Full VAT":
                                                                        CASE "Gen. Posting Type" OF
                                                                          "Gen. Posting Type"::Sale:
                                                                            TESTFIELD("Account No.",VATPostingSetup.GetSalesAccount(FALSE));
                                                                          "Gen. Posting Type"::Purchase:
                                                                            TESTFIELD("Account No.",VATPostingSetup.GetPurchAccount(FALSE));
                                                                        END;
                                                                    END;
                                                                  END;
                                                                VALIDATE("VAT %");

                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;

                                                                ReadGLSetup;
                                                                IF GLSetup."Norwegian Localization Active" THEN
                                                                  NorwegianVATTools.InitVATCode_GenJnlLine(Rec,FALSE);  //NAVNO
                                                              END;

                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Mva-bokfõringsgruppe - vare;
                                                              SVE=Moms produktbokfîringsmall] }
    { 92  ;   ;Bal. VAT Bus. Posting Group;Code20 ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account Type" IN
                                                                   ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Bank Account"]
                                                                THEN
                                                                  TESTFIELD("Bal. VAT Bus. Posting Group",'');

                                                                VALIDATE("Bal. VAT Prod. Posting Group");

                                                                ReadGLSetup;
                                                                IF GLSetup."Norwegian Localization Active" THEN
                                                                  NorwegianVATTools.InitVATCode_GenJnlLine(Rec,TRUE);  //NAVNO
                                                              END;

                                                   CaptionML=[ENU=Bal. VAT Bus. Posting Group;
                                                              NOR=Motkonto-mva.bokf.grp. - firma;
                                                              SVE=Moms rîrelsebokf.mall motkonto] }
    { 93  ;   ;Bal. VAT Prod. Posting Group;Code20;TableRelation="VAT Product Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account Type" IN
                                                                   ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Bank Account"]
                                                                THEN
                                                                  TESTFIELD("Bal. VAT Prod. Posting Group",'');

                                                                "Bal. VAT %" := 0;
                                                                "Bal. VAT Calculation Type" := "Bal. VAT Calculation Type"::"Normal VAT";
                                                                IF "Bal. Gen. Posting Type" <> 0 THEN BEGIN
                                                                  GetVATPostingSetup("Bal. VAT Bus. Posting Group","Bal. VAT Prod. Posting Group");
                                                                  "Bal. VAT Calculation Type" := VATPostingSetup."VAT Calculation Type";
                                                                  //**4PS.sn
                                                                  IF VATPostingSetup.Manually THEN
                                                                    "Bal. VAT Posting" := "Bal. VAT Posting"::"Manual VAT Entry"
                                                                  ELSE
                                                                    "Bal. VAT Posting" := "Bal. VAT Posting"::"Automatic VAT Entry";
                                                                  IF "Bal. VAT Posting" = "Bal. VAT Posting"::"Automatic VAT Entry" THEN
                                                                  //**4PS.en
                                                                  CASE "Bal. VAT Calculation Type" OF
                                                                    "Bal. VAT Calculation Type"::"Normal VAT":
                                                                      "Bal. VAT %" := VATPostingSetup."VAT %";
                                                                    "Bal. VAT Calculation Type"::"Full VAT":
                                                                      CASE "Bal. Gen. Posting Type" OF
                                                                        "Bal. Gen. Posting Type"::Sale:
                                                                          TESTFIELD("Bal. Account No.",VATPostingSetup.GetSalesAccount(FALSE));
                                                                        "Bal. Gen. Posting Type"::Purchase:
                                                                          TESTFIELD("Bal. Account No.",VATPostingSetup.GetPurchAccount(FALSE));
                                                                      END;
                                                                  END;
                                                                END;
                                                                VALIDATE("Bal. VAT %");

                                                                ReadGLSetup;
                                                                IF GLSetup."Norwegian Localization Active" THEN
                                                                  NorwegianVATTools.InitVATCode_GenJnlLine(Rec,TRUE);  //NAVNO
                                                              END;

                                                   CaptionML=[ENU=Bal. VAT Prod. Posting Group;
                                                              NOR=Motkonto-mva.bokf.grp. - vare;
                                                              SVE=Moms produktbokf.mall motkonto] }
    { 95  ;   ;Additional-Currency Posting;Option ;CaptionML=[ENU=Additional-Currency Posting;
                                                              NOR=Tilleggsvalutabokfõring;
                                                              SVE=Alt. valuta bokfîring];
                                                   OptionCaptionML=[ENU=None,Amount Only,Additional-Currency Amount Only;
                                                                    NOR=Ingen,Bare belõp,Bare tilleggsvalutabelõp;
                                                                    SVE=Ingen,Endast belopp,Endast alt. valutabelopp];
                                                   OptionString=None,Amount Only,Additional-Currency Amount Only;
                                                   Editable=No }
    { 98  ;   ;FA Add.-Currency Factor;Decimal    ;CaptionML=[ENU=FA Add.-Currency Factor;
                                                              NOR=Aktivatilleggsvalutafaktor;
                                                              SVE=Anl. alt. valutafaktor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0 }
    { 99  ;   ;Source Currency Code;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Source Currency Code;
                                                              NOR=Kildevalutakode;
                                                              SVE=Ursprungsvalutakod];
                                                   Editable=No }
    { 100 ;   ;Source Currency Amount;Decimal     ;AccessByPermission=TableData 4=R;
                                                   CaptionML=[ENU=Source Currency Amount;
                                                              NOR=Kildevalutabelõp;
                                                              SVE=Ursprungsvaluta belopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 101 ;   ;Source Curr. VAT Base Amount;Decimal;
                                                   AccessByPermission=TableData 4=R;
                                                   CaptionML=[ENU=Source Curr. VAT Base Amount;
                                                              NOR=Kildevaluta - mva.gr.lagsbelõp;
                                                              SVE=Ursprungsvaluta nettobelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 102 ;   ;Source Curr. VAT Amount;Decimal    ;AccessByPermission=TableData 4=R;
                                                   CaptionML=[ENU=Source Curr. VAT Amount;
                                                              NOR=Kildevaluta - mva.belõp;
                                                              SVE=Ursprungsvaluta momsbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 103 ;   ;VAT Base Discount % ;Decimal       ;CaptionML=[ENU=VAT Base Discount %;
                                                              NOR=Mva-gr.lagsrabatt-%;
                                                              SVE=Nettobelopprabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Editable=No }
    { 104 ;   ;VAT Amount (LCY)    ;Decimal       ;CaptionML=[ENU=VAT Amount (LCY);
                                                              NOR=Mva-belõp (NOK);
                                                              SVE=Momsbelopp (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 105 ;   ;VAT Base Amount (LCY);Decimal      ;CaptionML=[ENU=VAT Base Amount (LCY);
                                                              NOR=Mva-grunnlag (NOK);
                                                              SVE=Nettobelopp (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 106 ;   ;Bal. VAT Amount (LCY);Decimal      ;CaptionML=[ENU=Bal. VAT Amount (LCY);
                                                              NOR=Motkonto-mva. - belõp (NOK);
                                                              SVE=Momsbelopp motkonto (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 107 ;   ;Bal. VAT Base Amount (LCY);Decimal ;CaptionML=[ENU=Bal. VAT Base Amount (LCY);
                                                              NOR=Motkonto-mva-gr.lag (NOK);
                                                              SVE=Nettobelopp motkonto (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 108 ;   ;Reversing Entry     ;Boolean       ;CaptionML=[ENU=Reversing Entry;
                                                              NOR=Reverserer post;
                                                              SVE=èterfîring transaktion];
                                                   Editable=No }
    { 109 ;   ;Allow Zero-Amount Posting;Boolean  ;CaptionML=[ENU=Allow Zero-Amount Posting;
                                                              NOR=Tillat null-belõpsbokfõring;
                                                              SVE=TillÜt bokf. av nollbelopp];
                                                   Editable=No }
    { 110 ;   ;Ship-to/Order Address Code;Code10  ;TableRelation=IF (Account Type=CONST(Customer)) "Ship-to Address".Code WHERE (Customer No.=FIELD(Bill-to/Pay-to No.))
                                                                 ELSE IF (Account Type=CONST(Vendor)) "Order Address".Code WHERE (Vendor No.=FIELD(Bill-to/Pay-to No.))
                                                                 ELSE IF (Bal. Account Type=CONST(Customer)) "Ship-to Address".Code WHERE (Customer No.=FIELD(Bill-to/Pay-to No.))
                                                                 ELSE IF (Bal. Account Type=CONST(Vendor)) "Order Address".Code WHERE (Vendor No.=FIELD(Bill-to/Pay-to No.));
                                                   CaptionML=[ENU=Ship-to/Order Address Code;
                                                              NOR=Lever til-/ordreadressekode;
                                                              SVE=Leverans/order adresskod] }
    { 111 ;   ;VAT Difference      ;Decimal       ;CaptionML=[ENU=VAT Difference;
                                                              NOR=Mva-differanse;
                                                              SVE=Momsdifferens];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 112 ;   ;Bal. VAT Difference ;Decimal       ;CaptionML=[ENU=Bal. VAT Difference;
                                                              NOR=Mva-differanse - motpost;
                                                              SVE=Bal. momsdifferens];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 113 ;   ;IC Partner Code     ;Code20        ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=IC Partner Code;
                                                              NOR=KI-partnerkode;
                                                              SVE=Konc.int. partnerkod];
                                                   Editable=No }
    { 114 ;   ;IC Direction        ;Option        ;CaptionML=[ENU=IC Direction;
                                                              NOR=KI-retning;
                                                              SVE=Konc.int. riktning];
                                                   OptionCaptionML=[ENU=Outgoing,Incoming;
                                                                    NOR=UtgÜende,InngÜende;
                                                                    SVE=UtgÜende,IngÜende];
                                                   OptionString=Outgoing,Incoming }
    { 116 ;   ;IC Partner G/L Acc. No.;Code20     ;TableRelation="IC G/L Account";
                                                   OnValidate=VAR
                                                                ICGLAccount@1000 : Record 410;
                                                              BEGIN
                                                                IF "Journal Template Name" <> '' THEN
                                                                  IF "IC Partner G/L Acc. No." <> '' THEN BEGIN
                                                                    GetTemplate;
                                                                    GenJnlTemplate.TESTFIELD(Type,GenJnlTemplate.Type::Intercompany);
                                                                    IF ICGLAccount.GET("IC Partner G/L Acc. No.") THEN
                                                                      ICGLAccount.TESTFIELD(Blocked,FALSE);
                                                                  END
                                                              END;

                                                   CaptionML=[ENU=IC Partner G/L Acc. No.;
                                                              NOR=Finanskontonr. for KI-partner;
                                                              SVE=Redov.ktonr konc.int. partner] }
    { 117 ;   ;IC Partner Transaction No.;Integer ;CaptionML=[ENU=IC Partner Transaction No.;
                                                              NOR=Transaksjonsnr. for KI-partner;
                                                              SVE=Trans.nr fîr konc.int. partner];
                                                   Editable=No }
    { 118 ;   ;Sell-to/Buy-from No.;Code20        ;TableRelation=IF (Account Type=CONST(Customer)) Customer
                                                                 ELSE IF (Bal. Account Type=CONST(Customer)) Customer
                                                                 ELSE IF (Account Type=CONST(Vendor)) Vendor
                                                                 ELSE IF (Bal. Account Type=CONST(Vendor)) Vendor;
                                                   OnValidate=BEGIN
                                                                ReadGLSetup;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Sell-to/Buy-from No." THEN
                                                                  UpdateCountryCodeAndVATRegNo("Sell-to/Buy-from No.");
                                                              END;

                                                   CaptionML=[ENU=Sell-to/Buy-from No.;
                                                              NOR=Salg til-/kjõp fra-nr.;
                                                              SVE=Kund-/Leverantîrsnr] }
    { 119 ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                              BEGIN
                                                                VATRegNoFormat.Test("VAT Registration No.","Country/Region Code",'',0);
                                                              END;

                                                   CaptionML=[ENU=VAT Registration No.;
                                                              NOR=Organisasjonsnr.;
                                                              SVE=Momsregistreringsnr] }
    { 120 ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                VALIDATE("VAT Registration No.");
                                                              END;

                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/omrÜdekode;
                                                              SVE=Lands-/regionkod] }
    { 121 ;   ;Prepayment          ;Boolean       ;CaptionML=[ENU=Prepayment;
                                                              NOR=Forskudd;
                                                              SVE=Fîrskottsbetalning] }
    { 122 ;   ;Financial Void      ;Boolean       ;CaptionML=[ENU=Financial Void;
                                                              NOR=ùkonomisk kansellering;
                                                              SVE=Annullera];
                                                   Editable=No }
    { 123 ;   ;Copy VAT Setup to Jnl. Lines;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=[ENU=Copy VAT Setup to Jnl. Lines;
                                                              NOR=Kopier mva-oppsett til kladdelinjer;
                                                              SVE=Kopiera momsinst. Üt jnlrader];
                                                   Editable=No }
    { 125 ;   ;VAT Base Before Pmt. Disc.;Decimal ;CaptionML=[ENU=VAT Base Before Pmt. Disc.;
                                                              NOR=Mva-grunnlag fõr kont.rab.];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 165 ;   ;Incoming Document Entry No.;Integer;TableRelation="Incoming Document";
                                                   OnValidate=VAR
                                                                IncomingDocument@1000 : Record 130;
                                                              BEGIN
                                                                IF Description = '' THEN
                                                                  Description := COPYSTR(IncomingDocument.Description,1,MAXSTRLEN(Description));
                                                                IF "Incoming Document Entry No." = xRec."Incoming Document Entry No." THEN
                                                                  EXIT;

                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  IncomingDocument.RemoveReferenceToWorkingDocument(xRec."Incoming Document Entry No.")
                                                                ELSE
                                                                  IncomingDocument.SetGenJournalLine(Rec);
                                                              END;

                                                   CaptionML=[ENU=Incoming Document Entry No.;
                                                              NOR=Lõpenummer for inngÜende dokument;
                                                              SVE=Lîpnr fîr inkommande dokument] }
    { 170 ;   ;Creditor No.        ;Code20        ;OnValidate=BEGIN
                                                                //>>NAVDK
                                                                ReadGLSetup;
                                                                IF GLSetup."Danish Localization Active" THEN BEGIN
                                                                  IF NOT IsForExportToPaymentFile THEN
                                                                    EXIT;

                                                                  IF "Creditor No." <> '' THEN BEGIN
                                                                    IF "Recipient Bank Account" <> '' THEN
                                                                      FIELDERROR("Recipient Bank Account",
                                                                          STRSUBSTNO(FieldIsNotEmptyErr,FIELDCAPTION("Creditor No."),FIELDCAPTION("Recipient Bank Account")));

                                                                    "Creditor No." := PADSTR('',MAXSTRLEN("Creditor No.") - STRLEN("Creditor No."),'0') + "Creditor No.";
                                                                  END;
                                                                END;
                                                                //<<NAVDK
                                                              END;

                                                   CaptionML=[ENU=Creditor No.;
                                                              NOR=Kreditornr.;
                                                              SVE=FordringsÑgarenr.];
                                                   Numeric=Yes }
    { 171 ;   ;Payment Reference   ;Code50        ;OnValidate=VAR
                                                                PaymentMethod@1060001 : Record 289;
                                                                FIKManagement@1060000 : Codeunit 11128589;
                                                              BEGIN
                                                                // IF "Payment Reference" <> '' THEN
                                                                //  TESTFIELD("Creditor No.");

                                                                //>>NAVDK
                                                                ReadGLSetup;
                                                                IF GLSetup."Danish Localization Active" THEN
                                                                BEGIN
                                                                  IF "Payment Reference" <> '' THEN BEGIN
                                                                    TESTFIELD("Payment Method Code");
                                                                    PaymentMethod.GET("Payment Method Code");
                                                                    BEGIN
                                                                      PaymentMethod.TESTFIELD("Payment Type Validation");
                                                                      CASE PaymentMethod."Payment Type Validation" OF
                                                                        PaymentMethod."Payment Type Validation"::"FIK 01",
                                                                        PaymentMethod."Payment Type Validation"::"FIK 73":
                                                                          ERROR(PmtReferenceErr,FIELDCAPTION("Payment Reference"),PaymentMethod.TABLECAPTION,"Payment Method Code");
                                                                      END;
                                                                      "Payment Reference" := FIKManagement.EvaluateFIK("Payment Reference","Payment Method Code");
                                                                    END;
                                                                  END;
                                                                END;
                                                                //<<NAVDK
                                                              END;

                                                   CaptionML=[ENU=Payment Reference;
                                                              NOR=Betalingsreferanse;
                                                              SVE=Betalningsreferens];
                                                   Numeric=Yes }
    { 172 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=VAR
                                                                PaymentMethod@1060000 : Record 289;
                                                                BankAccount@1060002 : Record 270;
                                                                VendBankAcc@1060001 : Record 288;
                                                                FIKManagement@1060003 : Codeunit 11128589;
                                                                CustBankAcc@1060004 : Record 287;
                                                                PmtExportMgt@1060005 : Codeunit 1210;
                                                              BEGIN
                                                                //>>NAVDK
                                                                ReadGLSetup;
                                                                IF GLSetup."Danish Localization Active" AND ("Bal. Account Type" = "Bal. Account Type"::"Bank Account") THEN
                                                                //IF "Bal. Account Type" = "Bal. Account Type"::"Bank Account" THEN
                                                                  IF PaymentMethod.GET("Payment Method Code") THEN BEGIN
                                                                    IF PaymentMethod."Payment Type Validation" = PaymentMethod."Payment Type Validation"::" " THEN
                                                                      EXIT;
                                                                    BankAccount.GET("Bal. Account No.");
                                                                    CASE "Account Type" OF
                                                                      "Account Type"::Customer:
                                                                        BEGIN
                                                                          PmtExportMgt.CheckCustRefundPaymentTypeValidation(PaymentMethod);
                                                                          IF CustBankAcc.GET("Account No.","Recipient Bank Account") THEN
                                                                            PmtExportMgt.CheckBankTransferCountryRegion(BankAccount."Country/Region Code",CustBankAcc."Country/Region Code",PaymentMethod);
                                                                        END;
                                                                      "Account Type"::Vendor:
                                                                        BEGIN
                                                                          IF VendBankAcc.GET("Account No.","Recipient Bank Account") THEN
                                                                            PmtExportMgt.CheckBankTransferCountryRegion(BankAccount."Country/Region Code",VendBankAcc."Country/Region Code",PaymentMethod);
                                                                          CASE PaymentMethod."Payment Type Validation" OF
                                                                            PaymentMethod."Payment Type Validation"::"FIK 01",PaymentMethod."Payment Type Validation"::"FIK 73":
                                                                              "Payment Reference" := '';
                                                                            PaymentMethod."Payment Type Validation"::"FIK 04",PaymentMethod."Payment Type Validation"::"FIK 71":
                                                                              "Payment Reference" := FIKManagement.EvaluateFIK("Payment Reference","Payment Method Code");
                                                                          END;
                                                                          UpdateVendorPaymentDetails;
                                                                        END;
                                                                    END;
                                                                  END;
                                                                //<<NAVDK

                                                                UpdatePaymentMethodId;
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              NOR=BetalingsmÜte - kode;
                                                              SVE=BetalningssÑtt] }
    { 173 ;   ;Applies-to Ext. Doc. No.;Code35    ;CaptionML=[ENU=Applies-to Ext. Doc. No.;
                                                              NOR=Ekst. utligningsdok.nr.;
                                                              SVE=Kopplas till externt dok.nr] }
    { 288 ;   ;Recipient Bank Account;Code20      ;TableRelation=IF (Account Type=CONST(Customer)) "Customer Bank Account".Code WHERE (Customer No.=FIELD(Account No.))
                                                                 ELSE IF (Account Type=CONST(Vendor)) "Vendor Bank Account".Code WHERE (Vendor No.=FIELD(Account No.))
                                                                 ELSE IF (Account Type=CONST(Employee)) Employee.No. WHERE (Employee No. Filter=FIELD(Account No.))
                                                                 ELSE IF (Bal. Account Type=CONST(Customer)) "Customer Bank Account".Code WHERE (Customer No.=FIELD(Bal. Account No.))
                                                                 ELSE IF (Bal. Account Type=CONST(Vendor)) "Vendor Bank Account".Code WHERE (Vendor No.=FIELD(Bal. Account No.))
                                                                 ELSE IF (Bal. Account Type=CONST(Employee)) Employee.No. WHERE (Employee No. Filter=FIELD(Bal. Account No.));
                                                   OnValidate=BEGIN
                                                                //>>NAVDK
                                                                ReadGLSetup;
                                                                IF GLSetup."Danish Localization Active" THEN BEGIN
                                                                  IF IsForExportToPaymentFile THEN BEGIN
                                                                    UpdateVendorPaymentDetails;
                                                                    IF ("Recipient Bank Account" <> '') AND ("Creditor No." <> '') THEN
                                                                      FIELDERROR("Creditor No.",
                                                                        STRSUBSTNO(FieldIsNotEmptyErr,FIELDCAPTION("Recipient Bank Account"),FIELDCAPTION("Creditor No.")));
                                                                    EXIT;
                                                                  END;
                                                                END;
                                                                //<<NAVDK
                                                                //IF "Recipient Bank Account" = '' THEN
                                                                //  EXIT;
                                                                //IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::" ","Document Type"::"Credit Memo"]) AND
                                                                //   (("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor]) OR
                                                                //    ("Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor]))
                                                                //THEN
                                                                //  "Recipient Bank Account" := '';
                                                                //**4PS.eo
                                                                //>>NAVDK
                                                                IF GLSetup."Danish Localization Active" THEN BEGIN
                                                                  IF NOT IsForExportToPaymentFile THEN
                                                                    EXIT;
                                                                  UpdateVendorPaymentDetails;
                                                                  IF ("Recipient Bank Account" <> '') AND ("Creditor No." <> '') THEN
                                                                    FIELDERROR("Creditor No.",
                                                                      STRSUBSTNO(FieldIsNotEmptyErr,FIELDCAPTION("Recipient Bank Account"),FIELDCAPTION("Creditor No.")));
                                                                END;
                                                                //<<NAVDK
                                                              END;

                                                   CaptionML=[ENU=Recipient Bank Account;
                                                              NOR=Mottakerbankkonto;
                                                              SVE=Mottagarens bankkonto] }
    { 289 ;   ;Message to Recipient;Text140       ;CaptionML=[ENU=Message to Recipient;
                                                              NOR=Melding til mottaker;
                                                              SVE=Meddelande till mottagare] }
    { 290 ;   ;Exported to Payment File;Boolean   ;CaptionML=[ENU=Exported to Payment File;
                                                              NOR=Lest ut til betalingsfil;
                                                              SVE=Exporterat till betalningsfil];
                                                   Editable=No }
    { 291 ;   ;Has Payment Export Error;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Payment Jnl. Export Error Text" WHERE (Journal Template Name=FIELD(Journal Template Name),
                                                                                                             Journal Batch Name=FIELD(Journal Batch Name),
                                                                                                             Journal Line No.=FIELD(Line No.)));
                                                   CaptionML=[ENU=Has Payment Export Error;
                                                              NOR=Har betalingseksportfeil;
                                                              SVE=Har betalningsexportfel];
                                                   Editable=No }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation=IF (Receiving Company=FILTER('')) "Dimension Set Entry";
                                                   OnValidate=BEGIN
                                                                //**4PS.n Tablerelation changed, only for current company
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID;
                                                              SVE=DimensionsuppsÑttnings-ID];
                                                   Editable=No }
    { 827 ;   ;Credit Card No.     ;Code20        ;ObsoleteState=Removed;
                                                   ObsoleteReason=This field is not needed and it is not used anymore.;
                                                   CaptionML=[ENU=Credit Card No.;
                                                              NOR=Kredittkortnummer;
                                                              SVE=Kreditkortsnr] }
    { 1001;   ;Job Task No.        ;Code20        ;TableRelation="Job Task"."Job Task No." WHERE (Job No.=FIELD(Job No.));
                                                   OnValidate=BEGIN
                                                                IF "Job Task No." <> xRec."Job Task No." THEN
                                                                  VALIDATE("Job Planning Line No.",0);
                                                                IF "Job Task No." = '' THEN BEGIN
                                                                  "Job Quantity" := 0;
                                                                  "Job Currency Factor" := 0;
                                                                  "Job Currency Code" := '';
                                                                  "Job Unit Price" := 0;
                                                                  "Job Total Price" := 0;
                                                                  "Job Line Amount" := 0;
                                                                  "Job Line Discount Amount" := 0;
                                                                  "Job Unit Cost" := 0;
                                                                  "Job Total Cost" := 0;
                                                                  "Job Line Discount %" := 0;

                                                                  "Job Unit Price (LCY)" := 0;
                                                                  "Job Total Price (LCY)" := 0;
                                                                  "Job Line Amount (LCY)" := 0;
                                                                  "Job Line Disc. Amount (LCY)" := 0;
                                                                  "Job Unit Cost (LCY)" := 0;
                                                                  "Job Total Cost (LCY)" := 0;
                                                                  EXIT;
                                                                END;

                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  CopyDimensionsFromJobTaskLine;
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Job Task No.;
                                                              NOR=Prosjektoppgavenr.;
                                                              SVE=Projektaktivitetsnr] }
    { 1002;   ;Job Unit Price (LCY);Decimal       ;AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Unit Price (LCY);
                                                              NOR=Salgspris for prosjekt (NOK);
                                                              SVE=Projektenhetspris (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 1003;   ;Job Total Price (LCY);Decimal      ;AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Total Price (LCY);
                                                              NOR=Salgsbelõp for prosjekt (NOK);
                                                              SVE=Projekttotalpris (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1004;   ;Job Quantity        ;Decimal       ;OnValidate=BEGIN
                                                                IF JobTaskIsSet THEN BEGIN
                                                                  IF "Job Planning Line No." <> 0 THEN
                                                                    VALIDATE("Job Planning Line No.");
                                                                  CreateTempJobJnlLine;
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Quantity;
                                                              NOR=Prosjektantall;
                                                              SVE=Projektantal];
                                                   DecimalPlaces=0:5 }
    { 1005;   ;Job Unit Cost (LCY) ;Decimal       ;AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Unit Cost (LCY);
                                                              NOR=Enhetskost for prosjekt (NOK);
                                                              SVE=Projektstyckkostnad (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 1006;   ;Job Line Discount % ;Decimal       ;OnValidate=BEGIN
                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  TempJobJnlLine.VALIDATE("Line Discount %","Job Line Discount %");
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Line Discount %;
                                                              NOR=Rabattprosent for prosjektlinje;
                                                              SVE=Projektradrabatt %];
                                                   AutoFormatType=1 }
    { 1007;   ;Job Line Disc. Amount (LCY);Decimal;OnValidate=BEGIN
                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  TempJobJnlLine.VALIDATE("Line Discount Amount (LCY)","Job Line Disc. Amount (LCY)");
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Job Line Disc. Amount (LCY);
                                                              NOR=Rabattbelõp for prosjektlinje (NOK);
                                                              SVE=Rabattbelopp fîr projektrad (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1008;   ;Job Unit Of Measure Code;Code10    ;TableRelation="Unit of Measure";
                                                   CaptionML=[ENU=Job Unit Of Measure Code;
                                                              NOR=Enhetskode for prosjekt;
                                                              SVE=Enhetskod fîr projekt] }
    { 1009;   ;Job Line Type       ;Option        ;OnValidate=BEGIN
                                                                IF "Job Planning Line No." <> 0 THEN
                                                                  ERROR(Text019,FIELDCAPTION("Job Line Type"),FIELDCAPTION("Job Planning Line No."));
                                                              END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Line Type;
                                                              NOR=Prosjektlinjetype;
                                                              SVE=Projektradtyp];
                                                   OptionCaptionML=[ENU=" ,Budget,Billable,Both Budget and Billable";
                                                                    NOR=" ,Budsjett,Fakturerbar,BÜde Budsjett og Fakturerbar";
                                                                    SVE=" ,Budget,Fakturerbart,BÜde budget och fakturerbart"];
                                                   OptionString=[ ,Budget,Billable,Both Budget and Billable] }
    { 1010;   ;Job Unit Price      ;Decimal       ;OnValidate=BEGIN
                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  TempJobJnlLine.VALIDATE("Unit Price","Job Unit Price");
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Unit Price;
                                                              NOR=Salgspris for prosjekt;
                                                              SVE=Projektenhetspris];
                                                   AutoFormatType=2;
                                                   AutoFormatExpr="Job Currency Code" }
    { 1011;   ;Job Total Price     ;Decimal       ;AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Total Price;
                                                              NOR=Salgsbelõp for prosjekt;
                                                              SVE=Projekttotalpris];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Job Currency Code" }
    { 1012;   ;Job Unit Cost       ;Decimal       ;AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Unit Cost;
                                                              NOR=Enhetskost for prosjekt;
                                                              SVE=Projektstyckkostnad];
                                                   Editable=No;
                                                   AutoFormatType=2;
                                                   AutoFormatExpr="Job Currency Code" }
    { 1013;   ;Job Total Cost      ;Decimal       ;AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Total Cost;
                                                              NOR=Kostbelõp for prosjekt;
                                                              SVE=Projekttotalkostnad];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Job Currency Code" }
    { 1014;   ;Job Line Discount Amount;Decimal   ;OnValidate=BEGIN
                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  TempJobJnlLine.VALIDATE("Line Discount Amount","Job Line Discount Amount");
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Line Discount Amount;
                                                              NOR=Rabattbelõp for prosjektlinje;
                                                              SVE=Projektradrabatt];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Job Currency Code" }
    { 1015;   ;Job Line Amount     ;Decimal       ;OnValidate=BEGIN
                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  TempJobJnlLine.VALIDATE("Line Amount","Job Line Amount");
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Line Amount;
                                                              NOR=Belõp for prosjektlinje;
                                                              SVE=Projektradbelopp];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Job Currency Code" }
    { 1016;   ;Job Total Cost (LCY);Decimal       ;AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Total Cost (LCY);
                                                              NOR=Kostbelõp for prosjekt (NOK);
                                                              SVE=Projekttotalkostnad (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1017;   ;Job Line Amount (LCY);Decimal      ;OnValidate=BEGIN
                                                                IF JobTaskIsSet THEN BEGIN
                                                                  CreateTempJobJnlLine;
                                                                  TempJobJnlLine.VALIDATE("Line Amount (LCY)","Job Line Amount (LCY)");
                                                                  UpdatePricesFromJobJnlLine;
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Line Amount (LCY);
                                                              NOR=Belõp for prosjektlinje (NOK);
                                                              SVE=Projektradbelopp (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1018;   ;Job Currency Factor ;Decimal       ;CaptionML=[ENU=Job Currency Factor;
                                                              NOR=Valutafaktor for prosjekt;
                                                              SVE=Projektvalutafaktor] }
    { 1019;   ;Job Currency Code   ;Code10        ;OnValidate=BEGIN
                                                                IF ("Job Currency Code" <> xRec."Job Currency Code") OR ("Job Currency Code" <> '') THEN
                                                                  IF JobTaskIsSet THEN BEGIN
                                                                    CreateTempJobJnlLine;
                                                                    UpdatePricesFromJobJnlLine;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Job Currency Code;
                                                              NOR=Valutakode for prosjekt;
                                                              SVE=Projektvalutakod] }
    { 1020;   ;Job Planning Line No.;Integer      ;OnValidate=VAR
                                                                JobPlanningLine@1000 : Record 11020401;
                                                              BEGIN
                                                                IF "Job Planning Line No." <> 0 THEN BEGIN
                                                                  JobPlanningLine.GET("Job No.","Job Task No.","Job Planning Line No.");
                                                                  JobPlanningLine.TESTFIELD("Job No.","Job No.");
                                                                  JobPlanningLine.TESTFIELD("Job Task No.","Job Task No.");
                                                                  JobPlanningLine.TESTFIELD(Type,JobPlanningLine.Type::"G/L Account");
                                                                  JobPlanningLine.TESTFIELD("No.","Account No.");
                                                                  JobPlanningLine.TESTFIELD("Usage Link",TRUE);
                                                                  JobPlanningLine.TESTFIELD("System-Created Entry",FALSE);
                                                                  "Job Line Type" := JobPlanningLine."Line Type" + 1;
                                                                  VALIDATE("Job Remaining Qty.",JobPlanningLine."Remaining Qty." - "Job Quantity");
                                                                END ELSE
                                                                  VALIDATE("Job Remaining Qty.",0);
                                                              END;

                                                   OnLookup=VAR
                                                              JobPlanningLine@1000 : Record 11020401;
                                                            BEGIN
                                                              JobPlanningLine.SETRANGE("Job No.","Job No.");
                                                              JobPlanningLine.SETRANGE("Job Task No.","Job Task No.");
                                                              JobPlanningLine.SETRANGE(Type,JobPlanningLine.Type::"G/L Account");
                                                              JobPlanningLine.SETRANGE("No.","Account No.");
                                                              JobPlanningLine.SETRANGE("Usage Link",TRUE);
                                                              JobPlanningLine.SETRANGE("System-Created Entry",FALSE);

                                                              IF PAGE.RUNMODAL(0,JobPlanningLine) = ACTION::LookupOK THEN
                                                                VALIDATE("Job Planning Line No.",JobPlanningLine."Line No.");
                                                            END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Planning Line No.;
                                                              NOR=Prosjektplanleggingslinjenr.;
                                                              SVE=Projektplaneringsradnr];
                                                   BlankZero=Yes }
    { 1030;   ;Job Remaining Qty.  ;Decimal       ;OnValidate=VAR
                                                                JobPlanningLine@1000 : Record 11020401;
                                                              BEGIN
                                                                IF ("Job Remaining Qty." <> 0) AND ("Job Planning Line No." = 0) THEN
                                                                  ERROR(Text018,FIELDCAPTION("Job Remaining Qty."),FIELDCAPTION("Job Planning Line No."));

                                                                IF "Job Planning Line No." <> 0 THEN BEGIN
                                                                  JobPlanningLine.GET("Job No.","Job Task No.","Job Planning Line No.");
                                                                  IF JobPlanningLine.Quantity >= 0 THEN BEGIN
                                                                    IF "Job Remaining Qty." < 0 THEN
                                                                      "Job Remaining Qty." := 0;
                                                                  END ELSE BEGIN
                                                                    IF "Job Remaining Qty." > 0 THEN
                                                                      "Job Remaining Qty." := 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 11072003=R;
                                                   CaptionML=[ENU=Job Remaining Qty.;
                                                              NOR=Jobbrestantall;
                                                              SVE=KvarstÜende projektkvantitet];
                                                   DecimalPlaces=0:5 }
    { 1200;   ;Direct Debit Mandate ID;Code35     ;TableRelation=IF (Account Type=CONST(Customer)) "SEPA Direct Debit Mandate" WHERE (Customer No.=FIELD(Account No.));
                                                   OnValidate=VAR
                                                                SEPADirectDebitMandate@1000 : Record 1230;
                                                              BEGIN
                                                                IF "Direct Debit Mandate ID" = '' THEN
                                                                  EXIT;
                                                                TESTFIELD("Account Type","Account Type"::Customer);
                                                                SEPADirectDebitMandate.GET("Direct Debit Mandate ID");
                                                                SEPADirectDebitMandate.TESTFIELD("Customer No.","Account No.");
                                                                "Recipient Bank Account" := SEPADirectDebitMandate."Customer Bank Account Code";
                                                              END;

                                                   CaptionML=[ENU=Direct Debit Mandate ID;
                                                              NOR=ID for Direct Debit-belastningsfullmakt;
                                                              SVE=Medgivande-ID fîr autogiro] }
    { 1220;   ;Data Exch. Entry No.;Integer       ;TableRelation="Data Exch.";
                                                   CaptionML=[ENU=Data Exch. Entry No.;
                                                              NOR=Lõpenummer for datautveksl.;
                                                              SVE=Trans.nr pÜ dataintegration];
                                                   Editable=No }
    { 1221;   ;Payer Information   ;Text50        ;CaptionML=[ENU=Payer Information;
                                                              NOR=Informasjon om betaler;
                                                              SVE=Information om betalare] }
    { 1222;   ;Transaction Information;Text100    ;CaptionML=[ENU=Transaction Information;
                                                              NOR=Transaksjonsinformasjon;
                                                              SVE=Transaktionsinformation] }
    { 1223;   ;Data Exch. Line No. ;Integer       ;CaptionML=[ENU=Data Exch. Line No.;
                                                              NOR=Linjenummer for datautveksling;
                                                              SVE=Radnr pÜ dataintegration];
                                                   Editable=No }
    { 1224;   ;Applied Automatically;Boolean      ;CaptionML=[ENU=Applied Automatically;
                                                              NOR=Utlignet automatisk;
                                                              SVE=AnvÑnds automatiskt] }
    { 1700;   ;Deferral Code       ;Code10        ;TableRelation="Deferral Template"."Deferral Code";
                                                   OnValidate=VAR
                                                                DeferralUtilities@1002 : Codeunit 1720;
                                                              BEGIN
                                                                IF "Deferral Code" <> '' THEN BEGIN
                                                                  TESTFIELD("Account Type","Account Type"::"G/L Account");
                                                                  TESTFIELD("Receiving Company", ''); //**4PS.n
                                                                END;

                                                                DeferralUtilities.DeferralCodeOnValidate("Deferral Code",DeferralDocType::"G/L","Journal Template Name","Journal Batch Name",
                                                                  0,'',"Line No.",GetDeferralAmount,"Posting Date",Description,"Currency Code");
                                                              END;

                                                   CaptionML=[ENU=Deferral Code;
                                                              NOR=Periodiseringskode;
                                                              SVE=Periodiseringskod] }
    { 1701;   ;Deferral Line No.   ;Integer       ;CaptionML=[ENU=Deferral Line No.;
                                                              NOR=Periodiseringslinjenr.;
                                                              SVE=Periodiseringsradnr] }
    { 5050;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                  DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
                                                                  DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."), //**4PS.n
                                                                  DATABASE::"Plant Type", "Plant Type", //**4PS.n
                                                                  DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code");
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              NOR=Kampanjenr.;
                                                              SVE=Kampanjnr] }
    { 5400;   ;Prod. Order No.     ;Code20        ;CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.;
                                                              SVE=Prod.ordernr];
                                                   Editable=No }
    { 5600;   ;FA Posting Date     ;Date          ;AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=FA Posting Date;
                                                              NOR=Aktivabokf.dato;
                                                              SVE=Anl. bokfîringsdatum] }
    { 5601;   ;FA Posting Type     ;Option        ;OnValidate=BEGIN
                                                                IF  NOT (("Account Type" = "Account Type"::"Fixed Asset") OR
                                                                         ("Bal. Account Type" = "Bal. Account Type"::"Fixed Asset")) AND
                                                                   ("FA Posting Type" = "FA Posting Type"::" ")
                                                                THEN BEGIN
                                                                  "FA Posting Date" := 0D;
                                                                  "Salvage Value" := 0;
                                                                  "No. of Depreciation Days" := 0;
                                                                  "Depr. until FA Posting Date" := FALSE;
                                                                  "Depr. Acquisition Cost" := FALSE;
                                                                  "Maintenance Code" := '';
                                                                  "Insurance No." := '';
                                                                  "Budgeted FA No." := '';
                                                                  "Duplicate in Depreciation Book" := '';
                                                                  "Use Duplication List" := FALSE;
                                                                  "FA Reclassification Entry" := FALSE;
                                                                  "FA Error Entry No." := 0;
                                                                END;

                                                                IF "FA Posting Type" <> "FA Posting Type"::"Acquisition Cost" THEN
                                                                  TESTFIELD("Insurance No.",'');
                                                                IF "FA Posting Type" <> "FA Posting Type"::Maintenance THEN
                                                                  TESTFIELD("Maintenance Code",'');
                                                                GetFAVATSetup;
                                                                GetFAAddCurrExchRate;
                                                              END;

                                                   AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=FA Posting Type;
                                                              NOR=Aktivabokf.type;
                                                              SVE=Anl. bokfîringstyp];
                                                   OptionCaptionML=[ENU=" ,Acquisition Cost,Depreciation,Write-Down,Appreciation,Custom 1,Custom 2,Disposal,Maintenance";
                                                                    NOR=" ,Anskaffelseskost,Avskrivning,Nedskrivning,Oppskrivning,Egendef. 1,Egendef. 2,Salg,Vedlikehold";
                                                                    SVE=" ,Anskaffningskostnad,Avskrivning,Nedskrivning,Uppskrivning,Val 1,Val 2,Avyttring,UnderhÜll"];
                                                   OptionString=[ ,Acquisition Cost,Depreciation,Write-Down,Appreciation,Custom 1,Custom 2,Disposal,Maintenance] }
    { 5602;   ;Depreciation Book Code;Code10      ;TableRelation="Depreciation Book";
                                                   OnValidate=VAR
                                                                FADeprBook@1000 : Record 5612;
                                                              BEGIN
                                                                IF "Depreciation Book Code" = '' THEN
                                                                  EXIT;

                                                                IF ("Account No." <> '') AND
                                                                   ("Account Type" = "Account Type"::"Fixed Asset")
                                                                THEN BEGIN
                                                                  FADeprBook.GET("Account No.","Depreciation Book Code");
                                                                  "Posting Group" := FADeprBook."FA Posting Group";
                                                                  CreateDimForFAPostingGroup; //**4PS call C-026623
                                                                END;

                                                                IF ("Bal. Account No." <> '') AND
                                                                   ("Bal. Account Type" = "Bal. Account Type"::"Fixed Asset")
                                                                THEN BEGIN
                                                                  FADeprBook.GET("Bal. Account No.","Depreciation Book Code");
                                                                  "Posting Group" := FADeprBook."FA Posting Group";
                                                                  CreateDimForFAPostingGroup; //**4PS call C-026623
                                                                END;
                                                                GetFAVATSetup;
                                                                GetFAAddCurrExchRate;
                                                              END;

                                                   CaptionML=[ENU=Depreciation Book Code;
                                                              NOR=AvskrivningstablÜkode;
                                                              SVE=Avskrivningsregelkod] }
    { 5603;   ;Salvage Value       ;Decimal       ;AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=Salvage Value;
                                                              NOR=Skrapverdi;
                                                              SVE=èteranskaffningsvÑrde];
                                                   AutoFormatType=1 }
    { 5604;   ;No. of Depreciation Days;Integer   ;AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=No. of Depreciation Days;
                                                              NOR=Antall avskrivningsdager;
                                                              SVE=Antal avskrivningsdagar];
                                                   BlankZero=Yes }
    { 5605;   ;Depr. until FA Posting Date;Boolean;AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=Depr. until FA Posting Date;
                                                              NOR=Avskr. frem til aktivabokf.dato;
                                                              SVE=Avskr. till anl. bokf.datum] }
    { 5606;   ;Depr. Acquisition Cost;Boolean     ;AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=Depr. Acquisition Cost;
                                                              NOR=Avskr.anskaffelseskost;
                                                              SVE=Avskr. anskaffningskostnad] }
    { 5609;   ;Maintenance Code    ;Code10        ;TableRelation=Maintenance;
                                                   OnValidate=BEGIN
                                                                IF "Maintenance Code" <> '' THEN
                                                                  TESTFIELD("FA Posting Type","FA Posting Type"::Maintenance);
                                                              END;

                                                   CaptionML=[ENU=Maintenance Code;
                                                              NOR=Vedlikeholdskode;
                                                              SVE=UnderhÜllskod] }
    { 5610;   ;Insurance No.       ;Code20        ;TableRelation=Insurance;
                                                   OnValidate=BEGIN
                                                                IF "Insurance No." <> '' THEN
                                                                  TESTFIELD("FA Posting Type","FA Posting Type"::"Acquisition Cost");
                                                              END;

                                                   CaptionML=[ENU=Insurance No.;
                                                              NOR=Forsikringsnr.;
                                                              SVE=FîrsÑkringsnr] }
    { 5611;   ;Budgeted FA No.     ;Code20        ;TableRelation="Fixed Asset";
                                                   OnValidate=VAR
                                                                FA@1000 : Record 5600;
                                                              BEGIN
                                                                IF "Budgeted FA No." <> '' THEN BEGIN
                                                                  FA.GET("Budgeted FA No.");
                                                                  FA.TESTFIELD("Budgeted Asset",TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Budgeted FA No.;
                                                              NOR=Budsjettert aktivanr.;
                                                              SVE=Budgeterat anl.nr] }
    { 5612;   ;Duplicate in Depreciation Book;Code10;
                                                   TableRelation="Depreciation Book";
                                                   OnValidate=BEGIN
                                                                "Use Duplication List" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=Duplicate in Depreciation Book;
                                                              NOR=Duplikat i avskrivningstablÜ;
                                                              SVE=Dubblett i avskrivningsregel] }
    { 5613;   ;Use Duplication List;Boolean       ;OnValidate=BEGIN
                                                                "Duplicate in Depreciation Book" := '';
                                                              END;

                                                   AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=Use Duplication List;
                                                              NOR=Bruk duplikatoversikt;
                                                              SVE=AnvÑnd dubblettlista] }
    { 5614;   ;FA Reclassification Entry;Boolean  ;AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=FA Reclassification Entry;
                                                              NOR=Aktivareklassifiseringspost;
                                                              SVE=Anl. grupperingstransaktion] }
    { 5615;   ;FA Error Entry No.  ;Integer       ;TableRelation="FA Ledger Entry";
                                                   CaptionML=[ENU=FA Error Entry No.;
                                                              NOR=Aktiva - feillõpenr.;
                                                              SVE=Anl. lîpnr med fel];
                                                   BlankZero=Yes }
    { 5616;   ;Index Entry         ;Boolean       ;CaptionML=[ENU=Index Entry;
                                                              NOR=Indeksreg.post;
                                                              SVE=Indextrans.] }
    { 5617;   ;Source Line No.     ;Integer       ;CaptionML=[ENU=Source Line No.;
                                                              NOR=Kildelinjenr.;
                                                              SVE=Ursprungsradnr] }
    { 5618;   ;Comment             ;Text250       ;CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar] }
    { 5701;   ;Check Exported      ;Boolean       ;CaptionML=[ENU=Check Exported;
                                                              NOR=Sjekk eksportert] }
    { 5702;   ;Check Transmitted   ;Boolean       ;CaptionML=[ENU=Check Transmitted;
                                                              NOR=Sjekk sendt] }
    { 8000;   ;Id                  ;GUID          ;CaptionML=[ENU=Id;
                                                              NOR=Id;
                                                              SVE=ID] }
    { 8001;   ;Account Id          ;GUID          ;TableRelation="G/L Account".Id;
                                                   OnValidate=BEGIN
                                                                UpdateAccountNo;
                                                              END;

                                                   CaptionML=[ENU=Account Id;
                                                              NOR=Konto-ID;
                                                              SVE=Konto-ID] }
    { 8002;   ;Customer Id         ;GUID          ;TableRelation=Customer.Id;
                                                   OnValidate=BEGIN
                                                                UpdateCustomerNo;
                                                              END;

                                                   CaptionML=[ENU=Customer Id;
                                                              NOR=Kunde-ID;
                                                              SVE=Kund ID] }
    { 8003;   ;Applies-to Invoice Id;GUID         ;TableRelation="Sales Invoice Header".Id;
                                                   OnValidate=BEGIN
                                                                UpdateAppliesToInvoiceNo;
                                                              END;

                                                   CaptionML=[ENU=Applies-to Invoice Id;
                                                              NOR=ID for utligningsfaktura] }
    { 8004;   ;Contact Graph Id    ;Text250       ;CaptionML=[ENU=Contact Graph Id;
                                                              NOR=Graph-ID for kontakt] }
    { 8005;   ;Last Modified DateTime;DateTime    ;CaptionML=[ENU=Last Modified DateTime;
                                                              NOR=Dato/klokkeslett for siste endring;
                                                              SVE=Senast Ñndrad, DatumTid] }
    { 8006;   ;Journal Batch Id    ;GUID          ;TableRelation="Gen. Journal Batch".Id;
                                                   OnValidate=BEGIN
                                                                UpdateJournalBatchName;
                                                              END;

                                                   CaptionML=[ENU=Journal Batch Id;
                                                              NOR=Kjõrsels-ID for kladd] }
    { 8007;   ;Payment Method Id   ;GUID          ;TableRelation="Payment Method".Id;
                                                   OnValidate=BEGIN
                                                                UpdatePaymentMethodCode;
                                                              END;

                                                   CaptionML=[ENU=Payment Method Id;
                                                              NOR=ID for betalingsmÜte] }
    { 11200;  ;Source Posting Date ;Date          ;CaptionML=ENU=Source Posting Date;
                                                   Description=NAVSE }
    { 11201;  ;Auto. Acc. Group    ;Code10        ;TableRelation="Automatic Acc. Header";
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Account Type","Account Type"::"G/L Account")
                                                              END;

                                                   CaptionML=[ENU=Auto. Acc. Group;
                                                              SVE=Automatkonteringsmall];
                                                   Description=NAVSE,NAVFI }
    { 11202;  ;Periodic Template Code;Code10      ;CaptionML=[ENU=Periodic Template Code;
                                                              SVE=Periodisk mallkod];
                                                   Description=NAVSE11202 }
    { 11203;  ;Periodic Starting Date;Date        ;CaptionML=[ENU=Periodic Starting Date;
                                                              SVE=Periodiskt startdatum];
                                                   Description=NAVSE11203 }
    { 13650;  ;Giro Acc. No.       ;Code8         ;OnValidate=BEGIN
                                                                IF NOT IsForExportToPaymentFile THEN
                                                                  EXIT;

                                                                IF "Giro Acc. No." <> '' THEN BEGIN
                                                                  IF "Recipient Bank Account" <> '' THEN
                                                                    FIELDERROR("Recipient Bank Account",
                                                                      STRSUBSTNO(FieldIsNotEmptyErr,FIELDCAPTION("Giro Acc. No."),FIELDCAPTION("Recipient Bank Account")));

                                                                  "Giro Acc. No." := PADSTR('',MAXSTRLEN("Giro Acc. No.") - STRLEN("Giro Acc. No."),'0') + "Giro Acc. No.";
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Giro Acc. No.;
                                                   Description=NAVDK (13650) }
    { 11012000;;Subcontracting Invoice;Boolean    ;CaptionML=[ENU=Subcontracting Invoice;
                                                              NOR=Underentrepenõrsfaktura;
                                                              SVE=Underentreprenadsfaktura] }
    { 11012010;;Payment Agreement  ;Code20        ;CaptionML=[ENU=Payment Agreement;
                                                              NOR=BetalingsvilkÜr;
                                                              SVE=Betalningsvillkor] }
    { 11012020;;Expected Effective Date;Date      ;CaptionML=[ENU=Expected Effective Date;
                                                              NOR=Forventet ikrafttredelsesdato;
                                                              SVE=FîrvÑntat ikrafttrÑdandedatum] }
    { 11012030;;Expected Enddate   ;Date          ;CaptionML=[ENU=Expected Enddate;
                                                              NOR=Forventet sluttdato;
                                                              SVE=FîrvÑntat slutdatum] }
    { 11012040;;Number of Hours    ;Decimal       ;CaptionML=[ENU=Number of Hours;
                                                              NOR=Antall timer;
                                                              SVE=Antal timmar];
                                                   MinValue=0 }
    { 11012045;;Bal. VAT Posting   ;Option        ;CaptionML=[ENU=Bal. VAT Posting;
                                                              NOR=Mva.-bokfõring Õ motpost;
                                                              SVE=Bal. Momsbokfîring];
                                                   OptionCaptionML=[ENU=Automatic VAT Entry,Manual VAT Entry;
                                                                    NOR=Automatisk mva.-postering,Manuell mva.-postering;
                                                                    SVE=Automatisk,Manuell];
                                                   OptionString=Automatic VAT Entry,Manual VAT Entry;
                                                   Editable=No }
    { 11012050;;Avg. Wage Rate     ;Decimal       ;CaptionML=[ENU=Avg. Wage Rate;
                                                              NOR=Gjennomsnitlig lõnnssats;
                                                              SVE=Gen. Lîneavgift];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 11012060;;Labor Amount       ;Decimal       ;CaptionML=[ENU=Labor Amount;
                                                              NOR=Arbeidskraftsbelõp;
                                                              SVE=Arbetskraftsbelopp];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 11012070;;Contribution Percentage Labor;Decimal;
                                                   CaptionML=[ENU=Contribution Percentage Labor;
                                                              NOR=Dekningsbidrag, arbeidskraft;
                                                              SVE=TÑckningsbidrag, arbetskraft];
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 11012071;;Contribution Percentage Total;Decimal;
                                                   CaptionML=[ENU=Contribution Percentage Invoice Total;
                                                              NOR=Dekningsbidrag, faktura totalt;
                                                              SVE=TÑckningsbidrag, faktura totalt];
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 11012073;;Fixed B Amount per Hour;Decimal   ;CaptionML=[ENU=Fixed B Amount per Hour;
                                                              SVE=Fast B-belopp per timme] }
    { 11012075;;Pay To Tax Authority;Boolean      ;CaptionML=[ENU=Pay To Tax Authority;
                                                              NOR=Betal til skattemyndighet;
                                                              SVE=Betala till skattemyndighet] }
    { 11012080;;Wage Charge (to B Account);Decimal;CaptionML=[ENU=Wage Charge (to B Account);
                                                              NOR=Lõnnsgebyr (til B-konto);
                                                              SVE=Lîneavgift (till B-konto)];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 11012090;;Wage Charge (to Tax Authority);Decimal;
                                                   CaptionML=[ENU=Wage Charge (to Tax Authority);
                                                              NOR=Lõnnsgebyr (til skattemyndighet);
                                                              SVE=Lîneavgift (till skattemyndigheten)];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 11012100;;Nat.Ins.Contr.     ;Decimal       ;CaptionML=[ENU=Nat.Ins.Contr.;
                                                              NOR=Nat.Ins.Contr.;
                                                              SVE=Sociala lînefîrmÜner];
                                                   MinValue=0;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 11012110;;Memo               ;Text250       ;CaptionML=[ENU=Memo;
                                                              NOR=Merknad;
                                                              SVE=PM] }
    { 11012120;;Transaction Mode B Payments;Code20;CaptionML=[ENU=Transaction Mode Code B Payments;
                                                              NOR=Transaksjonsmodus for Kode B-betalninger;
                                                              SVE=TransaktionslÑge fîr kod B-betalningar] }
    { 11012130;;Bank Account Code B Payments;Code20;
                                                   TableRelation=IF (Account Type=CONST(Vendor)) "Vendor Bank Account".Code WHERE (Vendor No.=FIELD(Account No.),
                                                                                                                                   B-Account=CONST(Yes));
                                                   CaptionML=[ENU=Bank Account Code B Payments;
                                                              NOR=Bankkontokode B-betalinger;
                                                              SVE=Bankkontokod B-betalningar] }
    { 11012140;;Approved           ;Boolean       ;CaptionML=[ENU=Approved;
                                                              NOR=Godkjent;
                                                              SVE=GodkÑnda] }
    { 11012150;;Unit of Measure Code;Code10       ;TableRelation="Unit of Measure".Code;
                                                   OnLookup=BEGIN
                                                              HandleLookupUnit;  //**4PS.n
                                                            END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=MÜleenhetskode;
                                                              SVE=Enhetskod] }
    { 11012160;;Approvement Initials;Code10       ;CaptionML=[ENU=Approvement Initials;
                                                              NOR=Godkjenningsinitialer;
                                                              SVE=GodkÑnnandeinitialer] }
    { 11012170;;Employee No.       ;Code20        ;TableRelation=Employee;
                                                   CaptionML=[ENU=Employee No.;
                                                              NOR=Ansattnr.;
                                                              SVE=AnstÑllningsnr] }
    { 11012180;;Wage Component     ;Code10        ;TableRelation="Wage Component";
                                                   CaptionML=[ENU=Wage Component;
                                                              NOR=Lõnnsart;
                                                              SVE=Lîneart] }
    { 11012190;;Element            ;Code20        ;TableRelation=IF (Receiving Company=FILTER('')) "Project Element".Element WHERE (Project No.=FIELD(Job No.));
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                CheckCompanyIC;
                                                                ElementFormat.FormatElem(Element,2,"Receiving Company");
                                                                IF Element <> '' THEN BEGIN
                                                                  ProjElemRec.GET("Job No.",Element);
                                                                  ProjElemRec.CheckProjectElementBlocked;  //call: 6564
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS
                                                              CheckCompanyIC;
                                                              ProjElemRec."Project No." := "Job No.";
                                                              ProjElemRec.Element := Element;
                                                              ProjElemRec.SETRANGE("Project No.", "Job No.");
                                                              IF PAGE.RUNMODAL(0, ProjElemRec) = ACTION::LookupOK THEN
                                                                VALIDATE(Element, ProjElemRec.Element);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 11012195;;Extension Contract ;Code10        ;TableRelation=IF (Receiving Company=FILTER('')) "Extension Contract"."Contract No." WHERE (Project No.=FIELD(Job No.));
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                CheckCompanyIC;
                                                                ExtRec.GET("Job No.", "Extension Contract");
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS
                                                              CheckCompanyIC;
                                                              ExtRec."Project No." := "Job No.";
                                                              ExtRec."Contract No." := "Extension Contract";
                                                              ExtRec.SETRANGE("Project No.", "Job No.");
                                                              IF PAGE.RUNMODAL(0, ExtRec) = ACTION::LookupOK THEN
                                                                VALIDATE("Extension Contract", ExtRec."Contract No.");
                                                            END;

                                                   CaptionML=[ENU=Extension Contract;
                                                              NOR=ETA;
                                                              SVE=éTA] }
    { 11012200;;Item No.           ;Code20        ;TableRelation=Item;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF ("Item No." <> xRec."Item No.") AND ("Item No." <> '') THEN BEGIN
                                                                  ValidateItem(ItemTypeOpt::Item);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.;
                                                              SVE=Artikelnr] }
    { 11012201;;Basic Item         ;Code20        ;TableRelation="Basic Item"."Product Code" WHERE (Manufacturer=FIELD(Manufacturer));
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF ("Basic Item" <> xRec."Basic Item") AND ("Basic Item" <> '') THEN BEGIN
                                                                  ValidateItem(ItemTypeOpt::"Basic Item");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Basic Item;
                                                              NOR=Fabrikantartikkel;
                                                              SVE=Basartikel] }
    { 11012202;;Trade Item         ;Code20        ;TableRelation="Trade Item"."Item Code" WHERE (Vendor=FIELD("Vendor (Trade Item)"));
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF ("Trade Item" <> xRec."Trade Item") AND ("Trade Item" <> '') THEN BEGIN
                                                                  ValidateItem(ItemTypeOpt::"Trade Item");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Trade Item;
                                                              NOR=Katalogartikkel;
                                                              SVE=Anskaffningsartikel] }
    { 11012204;;Vendor (Trade Item);Code15        ;TableRelation="ETIM Vendor - Central Mgt";
                                                   OnValidate=VAR
                                                                TradeItemRec@1100525000 : Record 11012317;
                                                                lvExecValidate@1100485000 : Boolean;
                                                              BEGIN
                                                                //**4PS
                                                                IF ("Vendor (Trade Item)" <> xRec."Vendor (Trade Item)") AND ("Vendor (Trade Item)" <> '') THEN BEGIN
                                                                  IF "Basic Item" <> '' THEN BEGIN
                                                                    "Trade Item" := '';
                                                                    lvExecValidate := TRUE;
                                                                  END;
                                                                  IF "Trade Item" <> '' THEN BEGIN
                                                                    VALIDATE("Trade Item");
                                                                    lvExecValidate := TRUE;
                                                                  END;
                                                                  //db.sn, 17-12-10: M18021
                                                                  IF lvExecValidate THEN BEGIN
                                                                    IF TradeItemRec.CheckReplaceVendor(
                                                                      xRec."Vendor (Trade Item)", xRec."Trade Item",
                                                                      "Vendor (Trade Item)", "Trade Item") THEN
                                                                      ValidateItem(ItemTypeOpt::"Trade Item")
                                                                    ELSE
                                                                      ValidateItem(ItemTypeOpt::"Trade Vendor");
                                                                  END;
                                                                  //db.en, 17-12-10: M18021
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Vendor (Trade Item);
                                                              NOR=Leverandõr (katalogartikkel);
                                                              SVE=Leverantîr (skaffningsartikel)] }
    { 11012205;;Manufacturer       ;Code15        ;TableRelation="ETIM Vendor - Central Mgt";
                                                   CaptionML=[ENU=Manufacturer;
                                                              NOR=Fabrikant;
                                                              SVE=Tillverkare] }
    { 11012210;;Memo Posting       ;Boolean       ;CaptionML=[ENU=Memo Posting;
                                                              NOR=Kreditnotabokfõring;
                                                              SVE=Anteckningsbokfîring] }
    { 11012220;;Receiving Company  ;Text30        ;TableRelation=Company;
                                                   OnValidate=VAR
                                                                ICLicenceCu@1210190000 : Codeunit 11012780;
                                                              BEGIN
                                                                //**4PS
                                                                IF "Receiving Company" <> '' THEN BEGIN
                                                                  TESTFIELD("Deferral Code", '');
                                                                  TESTFIELD("Loan Code",'');
                                                                  ICLicenceCu.CheckICEntry("Receiving Company");   //db, 01-07-04
                                                                  IF "Account Type" <> "Account Type"::Customer THEN  //* C-017223
                                                                    TESTFIELD("Applies-to Doc. No.", '');
                                                                  ClearICApplicationFields;
                                                                  "Rental Unit" := '';
                                                                  "Plant Location" := '';
                                                                END;

                                                                "Intercompany Transaction" := ("Receiving Company" <> '');
                                                                VALIDATE("Dimension Set ID", DimMgt.GetDimSetInCompany("Dimension Set ID",xRec."Receiving Company", "Receiving Company"));
                                                              END;

                                                   CaptionML=[ENU=Receiving Company;
                                                              NOR=Mottakselskap;
                                                              SVE=Mottagningsfîretag] }
    { 11012225;;Supplying Company  ;Text30        ;TableRelation=Company;
                                                   OnValidate=VAR
                                                                ICLicenceCu@1210190000 : Codeunit 11012780;
                                                              BEGIN
                                                                //**4PS
                                                                IF "Receiving Company" <> '' THEN
                                                                  ICLicenceCu.CheckICEntry("Receiving Company");   //db, 01-07-04

                                                                IF "Supplying Company" <> '' THEN
                                                                  ClearICApplicationFields;

                                                                IF ("Receiving Company" <> '') AND ("Account Type" <> "Account Type"::Customer) THEN  //* C-017223
                                                                  TESTFIELD("Applies-to Doc. No.", '');

                                                                IF "Receiving Company" <> '' THEN
                                                                  "Rental Unit" := '';

                                                                "Intercompany Transaction" := ("Receiving Company" <> '');
                                                              END;

                                                   CaptionML=[ENU=Supplying Company;
                                                              NOR=Leverende  selskap;
                                                              SVE=Levererande fîretag] }
    { 11012230;;Purchase Action    ;Code10        ;TableRelation="Project Purchase Action".Code WHERE (Project No.=FIELD(Job No.),
                                                                                                       Status=FILTER(>=Approved));
                                                   CaptionML=[ENU=Purchase Action;
                                                              NOR=Innkjõpshandling;
                                                              SVE=InkîpsÜtgÑrd] }
    { 11012240;;Payment Our Bank   ;Code20        ;CaptionML=[ENU=Payment Run No.;
                                                              NOR=Betalingslõpsnr;
                                                              SVE=BetalningsomgÜngsnr];
                                                   Editable=No }
    { 11012250;;Payment Runno.     ;Code20        ;CaptionML=[ENU=Runno.;
                                                              NOR=Kjõring nr.;
                                                              SVE=Kîrningsnr];
                                                   Editable=No }
    { 11012260;;Payment Line No.   ;Integer       ;CaptionML=[ENU=Payment Line No.;
                                                              NOR=Betalingsradnr;
                                                              SVE=Betalningsradnr];
                                                   Editable=No }
    { 11012270;;Skip WIP Check     ;Boolean       ;CaptionML=[ENU=Skip WIP Check;
                                                              NOR=Hopp over arbeidskapital-kontroll;
                                                              SVE=Hoppa îver kontroll av pÜgÜende arbeten] }
    { 11012280;;Interest Date      ;Date          ;OnValidate=BEGIN
                                                                //**4PS.n
                                                                IF ("Interest Date" > "Posting Date") THEN
                                                                  FIELDERROR("Interest Date",STRSUBSTNO(Text11012007, "Interest Date", FIELDCAPTION("Posting Date"),"Posting Date"));
                                                              END;

                                                   CaptionML=[ENU=Interest Date;
                                                              NOR=Rentedato;
                                                              SVE=RÑntedatum];
                                                   ClosingDates=Yes }
    { 11012290;;Labor Amount (Subcontracting);Decimal;
                                                   CaptionML=[ENU=Labor Amount (Subcontracting);
                                                              NOR=Arbeidskraftsbelõp (Underentrepenõr);
                                                              SVE=Arbetskraftsbelopp (Underentreprenad)];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012291;;Plot No.           ;Code10        ;TableRelation=Plot."Plot No." WHERE (Project No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Plot No.;
                                                              NOR=Tegningnr;
                                                              SVE=Ritningnr] }
    { 11012300;;Blocked Amount (Subcontracting;Decimal;
                                                   CaptionML=[ENU=Blocked Amount (Subcontracting);
                                                              NOR=Sperret belõp (Underentrepenõr);
                                                              SVE=SpÑrrat belopp (underentreprenad)];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012310;;Project Interest   ;Boolean       ;CaptionML=[ENU=Project Interest;
                                                              NOR=Prosjektrente;
                                                              SVE=ProjektrÑnta];
                                                   Editable=No }
    { 11012320;;Closed Project No. ;Code20        ;CaptionML=[ENU=Closed Project No.;
                                                              NOR=Lukket prosjektnr.;
                                                              SVE=Upparbetat projekt nr] }
    { 11012321;;Closed Service Contract No.;Code20;CaptionML=[ENU=Closed Service Contract No.;
                                                              NOR=Lukket servicekontrakt nr.;
                                                              SVE=Upparbetat servicekontrakt nr] }
    { 11012322;;Closed Service Order No.;Code20   ;CaptionML=[ENU=Closed Service Order No.;
                                                              NOR=Lukket serviceordrenr.;
                                                              SVE=Upparbetad serviceorder nr] }
    { 11012330;;Origin Salary Application;Boolean ;CaptionML=[ENU=Origin Salary Application;
                                                              NOR=Opprinnelig Lõnnsprogram;
                                                              SVE=Ursprungligt lîneprogram];
                                                   Editable=No }
    { 11012340;;Retention Amount   ;Decimal       ;CaptionML=[ENU=Retention Amount;
                                                              NOR=Tilbakeholdt belõp;
                                                              SVE=KvarstÜende belopp];
                                                   Description=Retention;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 11012345;;Source Curr. Retention Amount;Decimal;
                                                   CaptionML=[ENU=Source Curr. Retention Amount;
                                                              NOR=Kildevaluta gjenvërende belõp;
                                                              SVE=Ursprungsvaluta KvarstÜende belopp];
                                                   Description=Retention;
                                                   Editable=No }
    { 11012350;;Retention Entry Type;Option       ;CaptionML=[ENU=Retention Entry Type;
                                                              NOR=Gjenvërende posttype;
                                                              SVE=Typ av kvarstÜende transaktion];
                                                   OptionCaptionML=[ENU=" ,Purchase,Sales";
                                                                    NOR=" ,Innkjõp,Salg";
                                                                    SVE=" ,Inkîp,FîrsÑljning"];
                                                   OptionString=[ ,Purchase,Sales];
                                                   Description=Retention;
                                                   Editable=No }
    { 11012360;;Retention Entry Document Type;Option;
                                                   CaptionML=[ENU=Retention Entry Document Type;
                                                              NOR=Gjenvërende post, dokumenttype;
                                                              SVE=KvarstÜende transaktion, dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Closure,Invoice,Credit Memo";
                                                                    NOR=" ,Stenging,Faktura,Keditnota";
                                                                    SVE=" ,Avslut,Faktura,Keditnota"];
                                                   OptionString=[ ,Closure,Invoice,Credit Memo];
                                                   Description=Retention;
                                                   Editable=No }
    { 11012370;;Subcontract No.    ;Code20        ;TableRelation=IF (Account Type=CONST(Vendor)) "Subcontractor Contract".No. WHERE (Vendor No.=FIELD(Account No.),
                                                                                                                                     Project No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Subcontract No.;
                                                              NOR=Underentreprenõrnr.;
                                                              SVE=Underentreprenîrsnr];
                                                   Description=Retention }
    { 11012380;;Applies-to Retention ID;Integer   ;CaptionML=[ENU=Applies-to Retention ID;
                                                              NOR=Utlignings-gjenvërende-ID;
                                                              SVE=GÑller kvarstÜende ID];
                                                   Description=Retention;
                                                   Editable=No }
    { 11012390;;Purchase Order     ;Code20        ;TableRelation="Purchase Header";
                                                   CaptionML=[ENU=Purchase Order;
                                                              NOR=Innkjõpsordre;
                                                              SVE=Inkîpsorder] }
    { 11012391;;Purchase Order Line No.;Integer   ;TableRelation="Purchase Line"."Line No." WHERE (Document Type=CONST(Order),
                                                                                                   Document No.=FIELD(Purchase Order));
                                                   CaptionML=[ENU=Purchase Order Line No.;
                                                              SVE=Inkîpsorderradnr] }
    { 11012395;;Warranty Object    ;Code10        ;CaptionML=[ENU=Warranty Object;
                                                              NOR=Garantiobjekt;
                                                              SVE=Garantiobjekt] }
    { 11012400;;FSC Type Code      ;Code10        ;TableRelation="FSC Type";
                                                   CaptionML=[ENU=FSC Type Code;
                                                              NOR=FSC Typekode;
                                                              SVE=FSC typkod] }
    { 11012410;;Advance Payment    ;Boolean       ;CaptionML=ENU=Advance Payment }
    { 11012420;;Pay VAT Amt. on B-Acc. Vendor;Boolean;
                                                   CaptionML=ENU=Pay VAT Amount on B-Account Vendor }
    { 11012430;;Loan Code          ;Code10        ;TableRelation="Loan Header";
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                GetAndValidateLoanAccount;
                                                              END;

                                                   CaptionML=ENU=Loan Code }
    { 11012440;;Loan Type          ;Option        ;OnValidate=BEGIN
                                                                //**4PS
                                                                GetAndValidateLoanAccount;
                                                              END;

                                                   CaptionML=ENU=Loan Type;
                                                   OptionCaptionML=ENU=" ,Granted/Received,Depreciation/Capital Appreciation,Repayment,Loan Provision,Interest Payment,Interest Payment Provision,Interest";
                                                   OptionString=[ ,Granted/Received,Depreciation/Capital Appreciation,Repayment,Loan Provision,Interest Payment,Interest Payment Provision,Interest] }
    { 11012450;;Exchange Rate From ;Option        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Exchange Rate From;
                                                   OptionCaptionML=ENU=Exchange Rate,Project Exchange Rate;
                                                   OptionString=Exchange Rate,Project Exchange Rate }
    { 11012550;;Plant Invoice      ;Boolean       ;CaptionML=[ENU=Plant Invoice;
                                                              NOR=Maskinfaktura;
                                                              SVE=Maskinfaktura];
                                                   Editable=No }
    { 11012551;;Plant Type         ;Code20        ;TableRelation=IF (Receiving Company=FILTER('')) "Plant Type";
                                                   OnValidate=BEGIN
                                                                CheckProjServPlantLoanAllowed(FIELDNO("Plant Type"));

                                                                FillSystemCreatedEntry;
                                                                FillFixedAssetPlantRelation();
                                                                IF "Plant Type" = '' THEN BEGIN
                                                                  "Plant No." := '';
                                                                  "Cost Component Plant" := '';
                                                                  EXIT;
                                                                END;

                                                                CheckCompanyIC;
                                                                PlantTypeRec.GET("Plant Type");

                                                                VALIDATE("Plant No.");
                                                                IF "Plant No." = '' THEN
                                                                  Description := PlantTypeRec.Description;

                                                                CreateDim(
                                                                  DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."),
                                                                  DATABASE::"Plant Type", "Plant Type",
                                                                  DATABASE::Job,"Job No.",
                                                                  DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                  DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                  DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                  DATABASE::Campaign,"Campaign No.");

                                                                //**4PS.sn, idea of JR, see if this will be to all satisfaction.
                                                                IF ("Receiving Company" <> '') AND
                                                                   ("Receiving Company" <> COMPANYNAME) AND
                                                                   (PlantTypeRec."Department Code" <> '') AND
                                                                   ("Shortcut Dimension 1 Code" = '') THEN
                                                                BEGIN
                                                                  VALIDATE("Shortcut Dimension 1 Code", PlantTypeRec."Department Code");
                                                                END;

                                                                IF ("Receiving Company" <> '') AND
                                                                   ("Receiving Company" <> COMPANYNAME) AND
                                                                   (PlantTypeRec."Cost Object" <> '') AND
                                                                   ("Shortcut Dimension 2 Code" = '') THEN
                                                                BEGIN
                                                                  VALIDATE("Shortcut Dimension 2 Code", PlantTypeRec."Cost Object");
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS
                                                              OnLookupPlantType(TRUE);
                                                            END;

                                                   CaptionML=[ENU=Plant Type;
                                                              NOR=Maskintype;
                                                              SVE=Maskintyp] }
    { 11012552;;Plant No.          ;Code10        ;TableRelation=IF (Receiving Company=FILTER('')) "Plant Number".No. WHERE (Plant Type=FIELD(Plant Type));
                                                   OnValidate=BEGIN
                                                                FillFixedAssetPlantRelation();

                                                                IF "Plant No." = '' THEN BEGIN
                                                                  VALIDATE("Cost Component Plant");
                                                                  EXIT;
                                                                END;

                                                                TESTFIELD("Plant Type");
                                                                CheckCompanyIC;
                                                                PlantNoRec.GET("Plant Type", "Plant No.");
                                                                Description := PlantNoRec.Description;

                                                                VALIDATE("Cost Component Plant");

                                                                CreateDim(
                                                                  DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."),
                                                                  DATABASE::"Plant Type", "Plant Type",
                                                                  DATABASE::Job,"Job No.",
                                                                  DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                  DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                  DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                  DATABASE::Campaign,"Campaign No.");
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS.sn
                                                              CheckCompanyIC;
                                                              PlantNoRec.SETRANGE("Plant Type", "Plant Type");
                                                              PlantNoRec."Plant Type" := "Plant Type";
                                                              PlantNoRec."No." := "Plant No.";
                                                              IF PAGE.RUNMODAL(0,PlantNoRec) = ACTION::LookupOK THEN
                                                                VALIDATE("Plant No.", PlantNoRec."No.");
                                                              //**4PS.en
                                                            END;

                                                   CaptionML=[ENU=Plant No.;
                                                              NOR=Maskinnr.;
                                                              SVE=Maskinnr] }
    { 11012553;;Bulk               ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Plant Type".Bulk WHERE (Code=FIELD(Plant Type)));
                                                   CaptionML=[ENU=Bulk;
                                                              NOR=Bulk;
                                                              SVE=Bulk];
                                                   Editable=No }
    { 11012554;;Cost Component Plant;Code10       ;TableRelation=IF (Receiving Company=FILTER('')) "Cost Component Plant";
                                                   OnValidate=VAR
                                                                lvPlantSetupRec@1100485000 : Record 11012550;
                                                                ICRec@1100525001 : Record 11012057;
                                                                lvTypeNo@1100485001 : Integer;
                                                                lvModeInEx@1100485002 : Code[1];
                                                                lvVendorPostingGroup@1100525000 : Code[20];
                                                                lvPostingSetup@1100525002 : Record 11020565;
                                                              BEGIN
                                                                IF "Cost Component Plant" = '' THEN BEGIN
                                                                  "Plant Location" := '';
                                                                  EXIT;
                                                                END;

                                                                TESTFIELD("Plant Type");
                                                                CheckCompanyIC;
                                                                CostCompPlantRec.GET("Cost Component Plant");

                                                                PlantTypeRec.GET("Plant Type");

                                                                lvTypeNo := CheckPlantAcqOrRent();
                                                                IF (lvTypeNo = 1) THEN
                                                                  TESTFIELD("Plant No.");
                                                                IF (lvTypeNo <> 0) THEN BEGIN
                                                                  IF ("Plant No." = '') THEN BEGIN
                                                                    IF PlantTypeRec.Bulk THEN BEGIN
                                                                      IF ("Receiving Company" <> '') THEN
                                                                        lvPlantSetupRec.CHANGECOMPANY("Receiving Company");
                                                                      lvPlantSetupRec.GET;
                                                                      IF (lvTypeNo = 1) THEN
                                                                        PlantTypeRec.TESTFIELD(External, FALSE);
                                                                      IF (lvTypeNo = 2) AND (NOT lvPlantSetupRec."Ext Bulk Plant with No. in Inv") THEN
                                                                        PlantTypeRec.TESTFIELD(External, TRUE);
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    PlantNoRec.GET("Plant Type", "Plant No.");
                                                                    IF (lvTypeNo = 1) THEN
                                                                      PlantNoRec.TESTFIELD(External, FALSE);
                                                                    IF (lvTypeNo = 2) THEN
                                                                      PlantNoRec.TESTFIELD(External, TRUE);
                                                                  END;
                                                                END;

                                                                IF NOT FillFixedAssetPlantRelation() THEN BEGIN
                                                                  IF ("Plant No." = '') AND (lvTypeNo <> 0) THEN
                                                                    lvModeInEx := COPYSTR('IE', lvTypeNo, 1);  //* Internal/External
                                                                  //**4PS-JTH 30-03-2010 sn
                                                                  lvVendorPostingGroup := '';
                                                                  IF ("Receiving Company" <> '') AND ("Receiving Company" <> COMPANYNAME) THEN BEGIN
                                                                    IF lvPostingSetup.GET("Source Code", COMPANYNAME, "Receiving Company") THEN
                                                                      BEGIN
                                                                        IF (lvPostingSetup."Prod. Account Credit" <> '') AND
                                                                           (lvPostingSetup."Prod. Account Debit" <> '') THEN
                                                                        BEGIN
                                                                          ICRec.GET(COMPANYNAME, "Receiving Company");
                                                                          lvVendorPostingGroup := ICRec."Vendor Posting Group";
                                                                        END;
                                                                    END;
                                                                  END;
                                                                 //**4PS-JTH 30-03-2010 en
                                                                  PlantPostingSetup.GET(PlantTypeRec.PlantPostingGrp("Plant No.","Receiving Company",lvModeInEx),
                                                                                        lvVendorPostingGroup, //field for Vendor Posting Group  //**4PS-JTH 30-03-2010
                                                                                        "Cost Component Plant");
                                                                  "Account Type" := "Account Type"::"G/L Account";
                                                                  "Account No." := PlantPostingSetup."Plant Cost Account";
                                                                //  Description := CostCompPlantRec.Description;
                                                                END;

                                                                VALIDATE("Account No.");
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS.sn
                                                              CheckCompanyIC;
                                                              CostCompPlantRec.Code := "Cost Component Plant";
                                                              IF PAGE.RUNMODAL(0,CostCompPlantRec) = ACTION::LookupOK THEN
                                                                VALIDATE("Cost Component Plant", CostCompPlantRec.Code);
                                                              //**4PS.en
                                                            END;

                                                   CaptionML=[ENU=Cost Component Plant;
                                                              NOR=Kostdel, maskin;
                                                              SVE=Kostnadsdel, Maskin] }
    { 11012555;;Plant Location     ;Code20        ;TableRelation="Plant Location" WHERE (Depot=CONST(No));
                                                   OnValidate=VAR
                                                                PlantCostComp@1100409000 : Record 11012575;
                                                              BEGIN
                                                                //**4PS (C001519)
                                                                IF "Plant Location" <> '' THEN BEGIN
                                                                  TESTFIELD("Receiving Company", '');
                                                                  TESTFIELD("Cost Component Plant");
                                                                  PlantCostComp.GET("Cost Component Plant");
                                                                  PlantCostComp.TESTFIELD("Charge Purchase");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Plant Location;
                                                              NOR=Maskinplassering;
                                                              SVE=Maskinplats] }
    { 11012790;;Vendor Posting Group;Code20       ;TableRelation="Vendor Posting Group";
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF "Vendor Posting Group" = '' THEN BEGIN
                                                                  "Account No." := '';
                                                                  "Rental Unit" := '';
                                                                END;
                                                                IF "Shortcut Dimension 2 Code" <> '' THEN
                                                                  VALIDATE("Shortcut Dimension 2 Code");
                                                              END;

                                                   ValidateTableRelation=Yes;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Vendor Posting Group;
                                                              SVE=Leverantîrsbokfîringsmall] }
    { 11012791;;Customer Posting Group;Code20     ;TableRelation="Customer Posting Group";
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF "Customer Posting Group" = '' THEN BEGIN
                                                                  "Account No." := '';
                                                                  "Rental Unit" := '';
                                                                END;
                                                                IF "Shortcut Dimension 2 Code" <> '' THEN
                                                                  VALIDATE("Shortcut Dimension 2 Code");
                                                              END;

                                                   ValidateTableRelation=Yes;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Customer Posting Group;
                                                              SVE=Kundbokfîringsmall] }
    { 11012800;;Service Order No.  ;Code20        ;TableRelation=IF (Receiving Company=FILTER('')) "Service Order".No.;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                CheckProjServPlantLoanAllowed(FIELDNO("Service Order No."));
                                                                IF "Service Order No." = '' THEN BEGIN
                                                                  "Service Location No." := '';
                                                                  "Service Contract No." := '';
                                                                  "Service Category" := '';
                                                                  VALIDATE("Job No.");
                                                                END ELSE BEGIN
                                                                  CheckCompanyIC;
                                                                  ServOrderRec.GET("Service Order No.");
                                                                  ServOrderRec.TestServiceContractMandatory;
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    ServOrderRec.CheckStatus(1)
                                                                  ELSE
                                                                    ServOrderRec.CheckStatus(0);
                                                                  "Service Location No." := ServOrderRec."Service Location No.";
                                                                  "Service Contract No." := ServOrderRec."Service Contract No.";
                                                                  "Service Category" := ServOrderRec.GetServiceCategory;
                                                                  "Account Type" := "Account Type"::"G/L Account";

                                                                  CheckAdditionalCostService(CurrFieldNo);  //db, 03-02-10
                                                                  IF "Additional Cost (Service)" = TRUE THEN
                                                                    VALIDATE("Shortcut Dimension 1 Code", ServOrderRec."Department Code (Other)")
                                                                  ELSE
                                                                    VALIDATE("Shortcut Dimension 1 Code", ServOrderRec."Global Dimension 1 Code");

                                                                  VALIDATE("Shortcut Dimension 2 Code");

                                                                END;
                                                                FillSystemCreatedEntry;
                                                                CheckCostCompServOrderType;                        //** 4PS041n

                                                                //** 4PS 09-06-2010 sn
                                                                CreateDim(
                                                                  DATABASE::"Service Order","Service Order No.",
                                                                  DimMgt.TypeToTableID1("Account Type"),"Account No.",
                                                                  DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
                                                                  DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."), //**4PS.n
                                                                  DATABASE::"Plant Type", "Plant Type", //**4PS.n
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                  DATABASE::Campaign,"Campaign No.");
                                                                //** 4PS 09-06-2010 en
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS
                                                              OnLookupServiceOrderNo(TRUE);
                                                            END;

                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr;
                                                              SVE=Serviceordernr] }
    { 11012801;;Service Location No.;Code20       ;TableRelation="Service Location".No.;
                                                   CaptionML=[ENU=Service Location No.;
                                                              NOR=Servicelokasjon Nr.;
                                                              SVE=Serviceplatsnr];
                                                   Editable=No }
    { 11012804;;Service Contract No.;Code20       ;TableRelation=IF (Receiving Company=FILTER('')) Service-Contract.No.;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF (CurrFieldNo = FIELDNO("Service Contract No.")) AND ("Service Contract No." <> xRec."Service Contract No.") THEN
                                                                  TESTFIELD("Service Order No.", '');

                                                                IF "Service Contract No." = '' THEN
                                                                  "Service Category" := ''
                                                                ELSE BEGIN
                                                                  CheckProjServPlantLoanAllowed(CurrFieldNo);
                                                                  CheckCompanyIC;
                                                                  ServContrRec.GET("Service Contract No.");
                                                                  VALIDATE("Shortcut Dimension 1 Code", ServContrRec."Global Dimension 1 Code");
                                                                  VALIDATE("Shortcut Dimension 2 Code");
                                                                  IF "Service Category" <> '' THEN
                                                                    IF NOT ServiceCategory.GET("Service Contract No.", "Service Category") THEN
                                                                      "Service Category" := '';
                                                                  FillSystemCreatedEntry;

                                                                  CreateDim(
                                                                    DATABASE::"Service Order", "Service Order No.",
                                                                    DimMgt.TypeToTableID1("Account Type"), "Account No.",
                                                                    DimMgt.TypeToTableID1("Bal. Account Type"), "Bal. Account No.",
                                                                    DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type", "Plant No."),
                                                                    DATABASE::"Plant Type", "Plant Type",
                                                                    DATABASE::Job, "Job No.",
                                                                    DATABASE::"Salesperson/Purchaser", "Salespers./Purch. Code",
                                                                    DATABASE::Campaign, "Campaign No.");
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS
                                                              LookupServiceContract(FALSE);
                                                            END;

                                                   CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr] }
    { 11012805;;Additional Cost (Service);Boolean ;OnValidate=BEGIN
                                                                //**4PS
                                                                ValidateAdditionalCost;
                                                              END;

                                                   CaptionML=[ENU=Additional Cost (Service);
                                                              NOR=Tilleggskoster (service);
                                                              SVE=TillÑggskostnader (service)] }
    { 11012806;;Add. Cost Changed Manually;Boolean;CaptionML=ENU=Add. Cost Changed Manually }
    { 11012807;;Service Category   ;Code10        ;TableRelation=IF (Service Contract No.=FILTER(<>'')) "Service Category".Code WHERE (Service Contract No.=FIELD(Service Contract No.));
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                TESTFIELD("Service Contract No.");
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Service Category;
                                                              SVE=Servicekategori] }
    { 11012810;;Origin Type        ;Option        ;CaptionML=[ENU=Origin Type;
                                                              NOR=Opprinnelig type;
                                                              SVE=Ursprunglig typ];
                                                   OptionCaptionML=[ENU=" ,Project,Service,Plant";
                                                                    NOR=" ,Prosjekt,Service,Maskin";
                                                                    SVE=" ,Projekt,Service,Maskin"];
                                                   OptionString=[ ,Project,Service,Plant] }
    { 11012820;;Rental Unit        ;Code20        ;TableRelation="Rental Unit"."Rental Unit" WHERE (Project No.=FIELD(Job No.));
                                                   OnValidate=BEGIN
                                                                IF "Rental Unit" = '' THEN
                                                                  "Rental Unit Line Type" := 0;
                                                                IF "Shortcut Dimension 2 Code" <> '' THEN
                                                                  VALIDATE("Shortcut Dimension 2 Code");  //Determine Account (see also field JobNo)
                                                              END;

                                                   CaptionML=[ENU=Rental Unit;
                                                              NOR=Leieenhet;
                                                              SVE=Uthyrningsenhet] }
    { 11012821;;Rental Unit Line Type;Option      ;OnValidate=BEGIN
                                                                IF "Rental Unit Line Type" <> 0 THEN
                                                                  TESTFIELD("Rental Unit");
                                                                IF "Shortcut Dimension 2 Code" <> '' THEN
                                                                  VALIDATE("Shortcut Dimension 2 Code");  //Determine Account (see also field JobNo)
                                                              END;

                                                   CaptionML=[ENU=Rental Unit Line Type;
                                                              NOR=Leieenhetsradtype;
                                                              SVE=Uthyrningsenhetsradtyp];
                                                   OptionCaptionML=[ENU=" ,Rent,Service Cost,Utilities,One-off Costs,Deposit";
                                                                    NOR=" ,Leie,Servicekost,Verktõy";
                                                                    SVE=" ,Hyra,Servicekostnad,Verktyg,EngÜngskostnad,Deposition"];
                                                   OptionString=[ ,Rent,ServiceCost,Utilities,One-off Costs,Deposit] }
    { 11012830;;Alternative Bill-to Address;Code10;CaptionML=[ENU=Alternative Bill-to Address;
                                                              NOR=Alternativ Faktureringsadresse;
                                                              SVE=Alternativ faktureringsadress] }
    { 11012840;;Cost Component     ;Code20        ;TableRelation="Cost Component".Code;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                ValidateCostComponent;
                                                              END;

                                                   CaptionML=[ENU=Cost Component;
                                                              NOR=Kostnadskomponent;
                                                              SVE=Kostnadskomponent] }
    { 11012845;;Cost Type          ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Dimension Value"."Cost Type" WHERE (Code=FIELD(Shortcut Dimension 2 Code),
                                                                                                           Global Dimension No.=CONST(2)));
                                                   CaptionML=[ENU=Cost Type;
                                                              NOR=Kostnadstype;
                                                              SVE=Kostnadstyp];
                                                   OptionCaptionML=[ENU=Labor,Material,Subcontracting,Plant,Sundry,Revenue;
                                                                    NOR=Arbeidskraft,Materiale,Underentrepenõr,Maskin,Diverse,Inntekt;
                                                                    SVE=Arbetskraft,Material,Underentreprenad,Maskin,Diverse,IntÑkt];
                                                   OptionString=Labor,Material,Subcontracting,Plant,Sundry,Revenue;
                                                   Editable=No }
    { 11012850;;Cost Type Cost Plus Line;Option   ;OnValidate=VAR
                                                                ProjRec@1100485000 : Record 11072003;
                                                                ProjTypeRec@1100485001 : Record 11012009;
                                                                DimValRec@1100485002 : Record 349;
                                                                lvCompName@1100485003 : Text[30];
                                                                lvPostingSetup@1100525003 : Record 11020565;
                                                                lvVendorPostingGroup@1100525002 : Code[20];
                                                                ICRec@1100525001 : Record 11012057;
                                                                lvVendorCde@1100525004 : Code[20];
                                                                lvCustomerPostingGroup@1100528200 : Code[20];
                                                              BEGIN
                                                                //**4PS
                                                                IF "Job No." <> '' THEN BEGIN
                                                                  DimMgt.GetDimValueRec(2, "Shortcut Dimension 2 Code", DimValRec, TRUE, "Job No.");

                                                                  "Origin Type" := "Origin Type"::Project;
                                                                  ProjRec.GET("Job No.");
                                                                  ProjTypeRec.GET(ProjRec."Project Type");
                                                                  ProjectTypeExtension.GetProjectTypeExtension(ProjTypeRec.Code);

                                                                  IF "Receiving Company" <> '' THEN
                                                                    lvCompName := "Receiving Company"
                                                                  ELSE
                                                                    lvCompName := COMPANYNAME;

                                                                  GLSetup.GET;
                                                                  IF ("Receiving Company" <> COMPANYNAME) AND ("Receiving Company" <> '') THEN
                                                                  BEGIN
                                                                    IF lvPostingSetup.GET("Source Code", COMPANYNAME, "Receiving Company") THEN
                                                                    BEGIN
                                                                      IF (lvPostingSetup."Prod. Account Credit" <> '') AND
                                                                         (lvPostingSetup."Prod. Account Debit" <> '') THEN
                                                                      BEGIN
                                                                        ICRec.GET(COMPANYNAME, "Receiving Company");
                                                                        lvVendorPostingGroup := ICRec."Vendor Posting Group";
                                                                        // IcEntryRec."Use IC Vendor Posting Group" := TRUE;
                                                                      END;
                                                                    END;
                                                                  END;

                                                                  lvVendorCde := ExternalEmployeeVendor; //**4PS Call Call C006691

                                                                  "Account No." :=
                                                                    WipAccountProject(
                                                                      ProjRec,ProjTypeRec,DimValRec,ICProjSetupRec."Provisions at Closure",lvCompName,lvVendorCde,lvVendorPostingGroup,lvCustomerPostingGroup);
                                                                    //ProjTypeRec.GetWipAccByVendorPostingGrp(ProjRec."Project Type",
                                                                    //                                        DimValRec."Cost Type",
                                                                    //                                        ProjRec."Project Status",
                                                                    //                                        ICProjSetupRec."Provisions at Closure",
                                                                    //                                        lvCompName,
                                                                    //                                        "Cost Type Cost Plus Line",
                                                                    //                                        lvVendorCde,  //** 4PS Call Call C006691 changed
                                                                    //                                        lvICHoursPosting::Supplierside,
                                                                    //                                        lvVendorPostingGroup);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Cost Type Cost Plus Line;
                                                              NOR=Kostnadstype, selvkostrad;
                                                              SVE=Kostnadstyp, sjÑlvkostnadsrad];
                                                   OptionCaptionML=[ENU=Labor,Material,Subcontracting,Plant,Sundry,Revenue;
                                                                    NOR=Arbeidskraft,Materiale,Underentrepenõr,Maskin,Diverse,Inntekt;
                                                                    SVE=Arbetskraft,Material,Underentreprenad,Maskin,Diverse,IntÑkt];
                                                   OptionString=Labor,Material,Subcontracting,Plant,Sundry,Revenue;
                                                   Editable=No }
    { 11012860;;Your Reference     ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              NOR=Din referanse;
                                                              SVE=Er referens] }
    { 11012870;;Intercompany Transaction;Boolean  ;CaptionML=[ENU=Intercompany Transaction;
                                                              NOR=Konsernintern transaksjon;
                                                              SVE=Koncernintern transaktion] }
    { 11012880;;Description 2      ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2;
                                                              SVE=Beskrivning 2] }
    { 11012890;;Block VAT Posting  ;Boolean       ;CaptionML=[ENU=Block VAT Posting;
                                                              NOR=Sperr mva-bokfõring;
                                                              SVE=SpÑrra momsbokfîring] }
    { 11012891;;VAT-Indication     ;Boolean       ;CaptionML=[ENU=VAT-Indication;
                                                              NOR=Mva-indikasjon;
                                                              SVE=Momsangivelse] }
    { 11012900;;SEPA Return Code   ;Code10        ;CaptionML=ENU=SEPA Return Code }
    { 11012910;;Cost Plus Line No. ;Integer       ;CaptionML=[ENU=Cost Plus Line No.;
                                                              SVE=Radnr fîr redovisag sjÑlvkostnad];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 11012997;;Line Type          ;Code10        ;TableRelation="Line Type"."Line Type" WHERE (Document Type=CONST(General Journal));
                                                   CaptionML=[ENU=Line Type;
                                                              NOR=Radtype;
                                                              SVE=Radtyp] }
    { 11020254;;Credit Restriction ;Code20        ;TableRelation="Credit Restriction";
                                                   CaptionML=[ENU=Credit Restriction;
                                                              NOR=Kreditrestriksjon;
                                                              SVE=Kreditrestriktion];
                                                   Description=4PS out of 11012000 range }
    { 11020255;;Credit Restriction %;Decimal      ;OnValidate=BEGIN
                                                                //**4PS.sn
                                                                IF "Credit Restriction %" <> 0 THEN BEGIN
                                                                  "Credit Restriction Amount" := ROUND(Amount * ("Credit Restriction %" / 100));
                                                                  "Credit Restriction VAT Amount" := ROUND("VAT Amount" * ("Credit Restriction %" / 100));
                                                                  "Cr. Restriction Amt (LCY)" := ROUND("Amount (LCY)" * ("Credit Restriction %" / 100));
                                                                  "Cr. Restriction VAT Amt (LCY)" := ROUND("VAT Amount (LCY)" * ("Credit Restriction %" / 100));
                                                                END;
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Credit Restriction %;
                                                              NOR=Kreditrestriksjon %;
                                                              SVE=Kreditrestriktion %];
                                                   DecimalPlaces=0:2;
                                                   Description=4PS }
    { 11020256;;Credit Restriction Date;Date      ;CaptionML=[ENU=Credit Restriction Date;
                                                              NOR=Kreditrestriksjonsdato;
                                                              SVE=Kreditrestriktionsdatum];
                                                   Description=4PS }
    { 11020257;;Credit Restriction Amount;Decimal ;OnValidate=BEGIN
                                                                //**4PS
                                                                IF Amount = 0 THEN
                                                                  "Cr. Restriction Amt (LCY)" := "Credit Restriction Amount"
                                                                ELSE
                                                                  "Cr. Restriction Amt (LCY)" := ROUND(("Amount (LCY)"/Amount) * "Credit Restriction Amount");
                                                              END;

                                                   CaptionML=[ENU=Credit Restriction Amount;
                                                              NOR=Kreditrestriksjonsbelõp;
                                                              SVE=Kreditrestriktionsbelopp];
                                                   DecimalPlaces=2:2;
                                                   Description=4PS }
    { 11020258;;Credit Restriction VAT Amount;Decimal;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF Amount = 0 THEN
                                                                  "Cr. Restriction VAT Amt (LCY)" := "Credit Restriction VAT Amount"
                                                                ELSE
                                                                  "Cr. Restriction VAT Amt (LCY)" := ROUND(("Amount (LCY)"/Amount) * "Credit Restriction VAT Amount");
                                                              END;

                                                   CaptionML=[ENU=Credit Restriction VAT Amount;
                                                              NOR=Kreditrestriksjon, mva-belõp;
                                                              SVE=Kreditrestriktion, momsbelopp];
                                                   DecimalPlaces=2:2;
                                                   Description=4PS }
    { 11020259;;Cr. Restriction Amt (LCY);Decimal ;CaptionML=[ENU=Cr. Restriction Amt (LCY);
                                                              NOR=Kredittrestriksjon - belõp (NOK);
                                                              SVE=Kr Restriktion fîr belopp (BVA)];
                                                   DecimalPlaces=2:2;
                                                   Description=4PS }
    { 11020260;;Cr. Restriction VAT Amt (LCY);Decimal;
                                                   CaptionML=[ENU=Cr. Restriction VAT Amt (LCY);
                                                              NOR=Kredittrestriksjon for mva. (NOK);
                                                              SVE=Kr Restriktion fîr momsbelopp (BVA)];
                                                   DecimalPlaces=2:2;
                                                   Description=4PS }
    { 11020261;;Apply Credit Restriction;Boolean  ;CaptionML=[ENU=Apply Credit Restriction;
                                                              NOR=Utlign kreditrestriksjon;
                                                              SVE=TillÑmpa kreditrestriktion];
                                                   Description=4PS }
    { 11020262;;Job Description    ;Text100       ;CaptionML=[ENU=Job Description;
                                                              NOR=Prosjektbeskrivelse;
                                                              SVE=Projektbeskrivning];
                                                   Description=4PS }
    { 11020263;;Pmt. Discount Date 2;Date         ;CaptionML=[ENU=Pmt. Discount Date 2;
                                                              NOR=Kontantrabattdato 2;
                                                              SVE=Kassa Rabattdatum 2];
                                                   Description=4PS }
    { 11020264;;Payment Discount % 2;Decimal      ;CaptionML=[ENU=Payment Discount % 2;
                                                              NOR=Kontantrabatt % 2;
                                                              SVE=Kassarabatt % 2];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PS }
    { 11020265;;Pmt. Discount Date 3;Date         ;CaptionML=[ENU=Pmt. Discount Date 3;
                                                              NOR=Kontantrabattdato 3;
                                                              SVE=Kassa Rabattdatum 3];
                                                   Description=4PS }
    { 11020266;;Payment Discount % 3;Decimal      ;CaptionML=[ENU=Payment Discount % 3;
                                                              NOR=Kontantrabatt % 3;
                                                              SVE=Kassarabatt % 3];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PS }
    { 11020270;;Batch Seq. No.     ;Code20        ;TableRelation="Invoice Proposal Batch Seq.";
                                                   CaptionML=ENU=Batch Seq. No.;
                                                   Description=4PS;
                                                   Editable=No }
    { 11020280;;IC Application     ;Boolean       ;CaptionML=ENU=IC Application;
                                                   Description=4PS }
    { 11128018;;Due Date Next Payment;Date        ;CaptionML=[ENU=Due Date Next Payment;
                                                              NOR=Forf.dato for neste betaling;
                                                              SVE=Fîrfallodatum nÑsta betalning] }
    { 11128020;;Amount ROT         ;Decimal       ;CaptionML=[ENU=Amount ROT;
                                                              NOR=Belõp, ROT-avdrag;
                                                              SVE=Belopp ROT];
                                                   Description=I.012 }
    { 11128021;;Not Matched        ;Boolean       ;CaptionML=[ENU=Not Matched;
                                                              NOR=Ikke Matchet;
                                                              SVE=Ej matchad];
                                                   Description=ENH-005 }
    { 11128022;;Received amount    ;Decimal       ;OnValidate=BEGIN
                                                                OnValidateReceivedAmount(Rec,xRec);  //RFC1127
                                                              END;

                                                   CaptionML=[ENU=Received amount;
                                                              NOR=Mottatt belõp;
                                                              SVE=Mottaget belopp];
                                                   Description=IME201;
                                                   Editable=No }
    { 11128030;;Amount RUT         ;Decimal       ;CaptionML=[ENU=Amount RUT;
                                                              NOR=Belõp, RUT avdrag;
                                                              SVE=RUT belopp];
                                                   Description=RFC188 }
    { 11128126;;Sent to Collection ;Boolean       ;CaptionML=[ENU=Sent to Collection;
                                                              NOR=Sendt til inkasso;
                                                              SVE=Skickad till inkasso];
                                                   Description=RFC1081 }
    { 12047959;;Information Type   ;Option        ;CaptionML=ENU=Information Type;
                                                   OptionCaptionML=ENU=" ,Error";
                                                   OptionString=[ ,Error];
                                                   Description=PEB0065 (12047959) }
    { 12047960;;Last GL Entry No.  ;Integer       ;CaptionML=ENU=Last GL Entry No.;
                                                   Description=PEB0076 }
    { 12047961;;Last GL Reg. Entry No.;Integer    ;CaptionML=ENU=Last GL Reg. Entry No.;
                                                   Description=PEB0076 }
    { 12047962;No;Information      ;Text50        ;CaptionML=[ENU="Information ";
                                                              SVE=Information];
                                                   Description=PEB0065 (12047962) }
    { 12048858;;VP Pack No.        ;Integer       ;TableRelation="VP Pack";
                                                   CaptionML=ENU=VP Pack No.;
                                                   Description=PEB0091 (12048858);
                                                   Editable=No }
    { 12048859;;OCR No.            ;Code30        ;CaptionML=[ENU=OCR No.;
                                                              SVE=OCR nr];
                                                   Description=PEB0091 (12048859) }
    { 12048860;;Ext. Doc. No. not Mandatory;Boolean;
                                                   CaptionML=ENU=Ext. Doc. No. not Mandatory;
                                                   Description=PEB0091 (12048860);
                                                   Editable=No }
    { 12048865;;Merging No.        ;Integer       ;CaptionML=[ENU=Merging No.;
                                                              SVE=Samsorteringsnr];
                                                   Description=PEB0091 (11128065.25) RFC149 }
  }
  KEYS
  {
    {    ;Journal Template Name,Journal Batch Name,Line No.;
                                                   Clustered=Yes }
    {    ;Journal Template Name,Journal Batch Name,Posting Date,Document No.;
                                                   MaintainSQLIndex=No }
    {    ;Account Type,Account No.,Applies-to Doc. Type,Applies-to Doc. No. }
    {    ;Document No.                             }
    {    ;Incoming Document Entry No.              }
    {    ;Document No.,Posting Date,Source Code   ;SumIndexFields=VAT Amount (LCY),Bal. VAT Amount (LCY);
                                                   MaintainSQLIndex=No }
    {    ;Data Exch. Entry No.                     }
    {    ;Journal Batch Name,Journal Template Name;SumIndexFields=Balance (LCY) }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst '@@@="%1=Account Type,%2=Balance Account Type";ENU=%1 or %2 must be a G/L Account or Bank Account.;NOR=%1 eller %2 mÜ vëre en finanskonto eller bankkonto.;SVE=%1 eller %2 mÜste vara ett redovisnings- eller bankkonto.';
      Text001@1001 : TextConst 'ENU=You must not specify %1 when %2 is %3.;NOR=Du kan ikke angi %1 nÜr %2 er %3.;SVE=Du ska inte specificera %1 nÑr %2 Ñr %3.';
      Text002@1002 : TextConst 'ENU=cannot be specified without %1;NOR=kan ikke angis uten %1;SVE=kan inte specificeras utan %1';
      ChangeCurrencyQst@1003 : TextConst '@@@="%1=FromCurrencyCode, %2=ToCurrencyCode";ENU=The Currency Code in the Gen. Journal Line will be changed from %1 to %2.\\Do you want to continue?;NOR=Valutakoden i finanskladdelinjen endres fra %1 til %2.\\Vil du fortsette?;SVE=%1 i %2 kommer att Ñndras frÜn %3 till %4.\\Vill du fortsÑtta?';
      UpdateInterruptedErr@1005 : TextConst 'ENU=The update has been interrupted to respect the warning.;NOR=Oppdateringen er avbrutt som en reaksjon pÜ advarselen.;SVE=Avbryten uppdatering pÜ grund av varning.';
      Text006@1006 : TextConst 'ENU=The %1 option can only be used internally in the system.;NOR=Alternativet %1 kan bare brukes internt i systemet.;SVE=Optionen %1 kan endast anvÑndas internt i systemet.';
      Text007@1007 : TextConst '@@@="%1=Account Type,%2=Balance Account Type";ENU=%1 or %2 must be a bank account.;NOR=%1 eller %2 mÜ vëre en bankkonto.;SVE=%1 eller %2 mÜste vara ett bankkonto.';
      Text008@1008 : TextConst 'ENU=" must be 0 when %1 is %2.";NOR=" mÜ vëre 0 nÜr %1 er %2.";SVE=" mÜste vara 0 nÑr %1 Ñr %2."';
      Text009@1009 : TextConst 'ENU=LCY;NOR=NOK;SVE=BVA';
      Text010@1010 : TextConst 'ENU=%1 must be %2 or %3.;NOR=%1 mÜ vëre %2 eller %3.;SVE=%1 mÜste vara %2 eller %3.';
      Text011@1011 : TextConst 'ENU=%1 must be negative.;NOR=%1 mÜ vëre negativ.;SVE=%1 mÜste vara negativt.';
      Text012@1012 : TextConst 'ENU=%1 must be positive.;NOR=%1 mÜ vëre positiv.;SVE=%1 mÜste vara positivt.';
      Text013@1013 : TextConst 'ENU=The %1 must not be more than %2.;NOR=%1 skal ikke vëre mer enn %2.;SVE=%1 fÜr inte vara mera Ñn %2.';
      GenJnlTemplate@1014 : Record 80;
      GenJnlBatch@1015 : Record 232;
      GenJnlLine@1016 : Record 81;
      Currency@1022 : Record 4;
      CurrExchRate@1023 : Record 330;
      PaymentTerms@1024 : Record 3;
      CustLedgEntry@1025 : Record 21;
      VendLedgEntry@1026 : Record 25;
      EmplLedgEntry@1020 : Record 5222;
      GenJnlAlloc@1027 : Record 221;
      VATPostingSetup@1028 : Record 325;
      GenBusPostingGrp@1035 : Record 250;
      GenProdPostingGrp@1036 : Record 251;
      GLSetup@1037 : Record 98;
      Job@1060 : Record 11072003;
      SourceCodeSetup@1017 : Record 242;
      TempJobJnlLine@1059 : TEMPORARY Record 11072008;
      SalespersonPurchaser@1932 : Record 13;
      ICProjSetupRec@1210190013 : Record 315;
      ProjRec@11012004 : Record 11072003;
      ProjTypeRec@11012026 : Record 11012009;
      ProjectTypeExtension@1100529600 : Record 11229469;
      ProjElemRec@11012027 : Record 11012010;
      ExtRec@1210190022 : Record 11012004;
      DimValRec@11012005 : Record 349;
      PlantTypeRec@1210190002 : Record 11012551;
      PlantNoRec@1210190003 : Record 11012552;
      CostCompPlantRec@1210190001 : Record 11012575;
      PlantPostingSetup@1210190000 : Record 11012570;
      ServTypeRec@1210190021 : Record 11012814;
      ServContrRec@1210190010 : Record 11012812;
      ServOrderRec@1210190005 : Record 11012823;
      CostCompRec@1100409000 : Record 11012012;
      ServiceCategory@1100529601 : Record 11071985;
      NoSeriesMgt@1040 : Codeunit 396;
      CustCheckCreditLimit@1041 : Codeunit 312;
      SalesTaxCalculate@1042 : Codeunit 398;
      GenJnlApply@1043 : Codeunit 225;
      GenJnlShowCTEntries@1039 : Codeunit 16;
      CustEntrySetApplID@1044 : Codeunit 101;
      VendEntrySetApplID@1045 : Codeunit 111;
      EmplEntrySetApplID@1029 : Codeunit 112;
      DimMgt@1046 : Codeunit 408;
      PaymentToleranceMgt@1053 : Codeunit 426;
      NorwegianVATTools@1080001 : Codeunit 11128500;
      DeferralUtilities@1051 : Codeunit 1720;
      ApprovalsMgmt@1069 : Codeunit 1535;
      Window@1004 : Dialog;
      DeferralDocType@1050 : 'Purchase,Sales,G/L';
      CurrencyCode@1052 : Code[10];
      Text014@1054 : TextConst '@@@="%1=Caption of Table Customer, %2=Customer No, %3=Caption of field Bill-to Customer No, %4=Value of Bill-to customer no.";ENU=The %1 %2 has a %3 %4.\\Do you still want to use %1 %2 in this journal line?;NOR=%1 %2 har en %3 %4.\\Vil du fremdeles bruke %1 %2 pÜ denne kladdelinjen?;SVE=%1 %2 har %3 %4.\\Vill du fortfarande anvÑnda %1 %2 pÜ denna journalrad?';
      TemplateFound@1056 : Boolean;
      Text015@1058 : TextConst 'ENU=You are not allowed to apply and post an entry to an entry with an earlier posting date.\\Instead, post %1 %2 and then apply it to %3 %4.;NOR=Du kan ikke utligne og bokfõre en post mot en post med en tidligere bokfõringsdato.\\I stedet mÜ du bokfõre %1 %2 og deretter utligne den mot %3 %4.;SVE=Det gÜr inte att koppla och bokfîra en transaktion till en transaktion med ett tidigare bokfîringsdatum.\\Bokfîr i stÑllet %1 %2 och koppla den sedan till %3 %4.';
      DoSkipModify@1100525001 : Boolean;
      CurrencyDate@1061 : Date;
      Text016@1062 : TextConst 'ENU=%1 must be G/L Account or Bank Account.;NOR=%1 mÜ vëre en finans- eller bankkonto.;SVE=%1 mÜste vara ett redovisningskonto eller ett bankkonto.';
      HideValidationDialog@1064 : Boolean;
      Text018@1066 : TextConst 'ENU=%1 can only be set when %2 is set.;NOR=%1 kan bare angis nÜr %2 er angitt.;SVE=%1 kan endast stÑllas in nÑr %2 har stÑllts in.';
      Text019@1067 : TextConst 'ENU=%1 cannot be changed when %2 is set.;NOR=%1 kan ikke endres nÜr %2 er angitt.;SVE=%1 kan inte Ñndras nÑr %2 har stÑllts in.';
      GLSetupRead@1019 : Boolean;
      ExportAgainQst@1038 : TextConst 'ENU=One or more of the selected lines have already been exported. Do you want to export them again?;NOR=ên eller flere av de valgte linjene er allerede eksportert. Vil du eksportere dem pÜ nytt?;SVE=En eller flera av de valda raderna har redan exporterats. Vill du exportera dem igen?';
      NothingToExportErr@1021 : TextConst 'ENU=There is nothing to export.;NOR=Det finnes ingenting Ü eksportere.;SVE=Det finns inget att exportera.';
      NotExistErr@1068 : TextConst '@@@="%1=Document number";ENU=Document number %1 does not exist or is already closed.;NOR=Bilagsnummer %1 finnes ikke eller er allerede lukket.;SVE=Dokumentnumret %1 finns inte eller har redan stÑngts.';
      PmtReferenceErr@1060000 : TextConst '@@@="%1=Field;%2=Table;%3=Field";ENU=%1 should be blank for %2 %3.';
      DocNoFilterErr@1047 : TextConst 'ENU=The document numbers cannot be renumbered while there is an active filter on the Document No. field.;NOR=Dokumentnumrene kan ikke nummereres pÜ nytt mens det er et aktivt filter pÜ feltet Bilagsnr.;SVE=Dokumentnummer kan inte omnumreras nÑr det finns ett aktivt filter i fÑltet Dokumentnr.';
      DueDateMsg@1150 : TextConst 'ENU=This posting date will cause an overdue payment.;NOR=Denne bokfõringsdatoen vil fõre til en forfalt betaling.;SVE=Det hÑr bokfîringsdatumet orsakar en fîrfallen betalning.';
      CalcPostDateMsg@1169 : TextConst 'ENU=Processing payment journal lines #1##########;NOR=Behandler betalingskladdelinjene #1##########;SVE=Bearbetar utbetalningsjournalrader #1##########';
      NoEntriesToVoidErr@1018 : TextConst 'ENU=There are no entries to void.;NOR=Ingen poster Ü annullere.';
      SuppressCommit@1170 : Boolean;
      OnlyLocalCurrencyForEmployeeErr@1030 : TextConst 'ENU=The value of the Currency Code field must be empty. General journal lines in foreign currency are not supported for employee account type.;NOR=Valutaen for feltet Valutakode mÜ vëre tom. Finanskladdelinjer i fremmed valuta stõttes ikke for kontotypen Ansatt.';
      AccTypeNotSupportedErr@1031 : TextConst 'ENU=You cannot specify a deferral code for this type of account.;NOR=Du kan ikke angi en periodiseringskode for denne kontotypen.';
      SalespersonPurchPrivacyBlockErr@1933 : TextConst '@@@="%1 = salesperson / purchaser code.";ENU=Privacy Blocked must not be true for Salesperson / Purchaser %1.;NOR=Personvern sperret mÜ ikke vëre oppfylt forˇselger/innkjõper %1.';
      BlockedErr@1033 : TextConst '@@@="%1=Blocked field value,%2=Account Type,%3=Account No.";ENU=The Blocked field must not be %1 for %2 %3.;NOR=Feltet Sperret mÜ ikke vëre %1 for %2 %3.';
      BlockedEmplErr@1032 : TextConst '@@@="%1 = Employee no. ";ENU=You cannot export file because employee %1 is blocked due to privacy.;NOR=Du kan ikkeˇeksportere filenˇfordi ansatt %1 er sperret pÜ grunn av personvern.';
      ElementFormat@1210190007 : Codeunit 11012022;
      ValidateCu@1210190006 : Codeunit 11012033;
      Dim1@1210190009 : Code[20];
      Dim2@1210190008 : Code[20];
      ItemTypeOpt@1000000000 : 'Item,Basic Item,Trade Item,Trade Vendor';
      Text11012000@1100528400 : TextConst 'ENU=Surcharge %1;NOR=Tilleggsgebyr %1;SVE=TillÑggsavgift %1';
      Text11012004@1210190020 : TextConst 'ENU=%1 %2 is fully applied;NOR=%1 %2 er utlignet.;SVE=%1 %2 har tillÑmpats helt.';
      Text11012005@1210190019 : TextConst 'ENU=%1 %2 does not exist;NOR=%1 %2 finnes ikke;SVE=%1 %2 finns inte.';
      Text11012006@1210190018 : TextConst 'ENU=%1 %2 is already existing as a Proposal Entry;NOR=%1 %2 finnes allerede som forslagspost;SVE=%1 %2 finns redan som fîrslagstransaktion';
      Text11012007@1210190011 : TextConst 'ENU=(%1) may not be greater than the de %2 (%3);NOR=(%1) kan ikke vëre mer enn %2 (%3);SVE=(%1) fÜr inte vara mer Ñn %2 (%3)';
      Text11012008@1100485000 : TextConst 'ENU=Watch out, %1 %2 has an earlier posting date than %3 %4.;NOR=Observer at %1 %2 har tidligere bokfõringsdato enn %3 %4.;SVE=Observera att %1 %2 har ett tidigare bokfîringsdatum Ñn %3 %4.';
      DPA_Management@1100000999 : Codeunit 11012783;
      WhileHoursPostNoDPACheck@1100525000 : Boolean;
      Text11012009@1100528500 : TextConst 'ENU=If you want to do a refund, fill the Debit Amount first.';
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
      FieldIsNotEmptyErr@1100583000 : TextConst '@@@="%1=Field;%2=Field";ENU=%1 cannot be used while %2 has a value.;SVE=%1 kan inte anvÑndas medan %2 har ett vÑrde.';
      DontWarnValidateAppliesToDocNoBool@1100285500 : Boolean;
      "*** PEB ***"@12047959 : Integer;
      gBaseTables@12047958 : Codeunit 11128080;
      GenJnlLineExt@111280000 : Record 11128091;
      VendorExt@111280001 : Record 11128090;

    [External]
    PROCEDURE EmptyLine@5() Result : Boolean;
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      OnBeforeEmptyLine(Rec,Result,IsHandled);
      IF IsHandled THEN
        EXIT(Result);
      EXIT(
        ("Account No." = '') AND (Amount = 0) AND
        (("Bal. Account No." = '') OR NOT "System-Created Entry"));
    END;

    [External]
    PROCEDURE UpdateLineBalance@2();
    BEGIN
      "Debit Amount" := 0;
      "Credit Amount" := 0;

      IF ((Amount > 0) AND (NOT Correction)) OR
         ((Amount < 0) AND Correction)
      THEN
        "Debit Amount" := Amount
      ELSE
        IF Amount <> 0 THEN
          "Credit Amount" := -Amount;

      IF "Currency Code" = '' THEN
        "Amount (LCY)" := Amount;
      CASE TRUE OF
        ("Account No." <> '') AND ("Bal. Account No." <> ''):
          "Balance (LCY)" := 0;
        "Bal. Account No." <> '':
          "Balance (LCY)" := -"Amount (LCY)";
        ELSE
          "Balance (LCY)" := "Amount (LCY)";
      END;

      OnUpdateLineBalanceOnAfterAssignBalanceLCY("Balance (LCY)");

      CLEAR(GenJnlAlloc);
      GenJnlAlloc.UpdateAllocations(Rec);

      UpdateSalesPurchLCY;

      IF ("Deferral Code" <> '') AND (Amount <> xRec.Amount) AND ((Amount <> 0) AND (xRec.Amount <> 0)) THEN
        VALIDATE("Deferral Code");
    END;

    [External]
    PROCEDURE SetUpNewLine@9(LastGenJnlLine@1000 : Record 81;Balance@1001 : Decimal;BottomLine@1002 : Boolean);
    BEGIN
      GenJnlTemplate.GET("Journal Template Name");
      GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
      GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
      GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
      IF GenJnlLine.FINDFIRST THEN BEGIN
        "Posting Date" := LastGenJnlLine."Posting Date";
        "Document Date" := LastGenJnlLine."Posting Date";
        "Document No." := LastGenJnlLine."Document No.";
        OnSetUpNewLineOnBeforeIncrDocNo(GenJnlLine,LastGenJnlLine);
        IF BottomLine AND
           (Balance - LastGenJnlLine."Balance (LCY)" = 0) AND
           NOT LastGenJnlLine.EmptyLine
        THEN
          IncrementDocumentNo(GenJnlBatch,"Document No.");
      END ELSE BEGIN
        "Posting Date" := WORKDATE;
        "Document Date" := WORKDATE;
        IF GenJnlBatch."No. Series" <> '' THEN BEGIN
          CLEAR(NoSeriesMgt);
          "Document No." := NoSeriesMgt.TryGetNextNo(GenJnlBatch."No. Series","Posting Date");
        END;
      END;
      IF GenJnlTemplate.Recurring THEN
        "Recurring Method" := LastGenJnlLine."Recurring Method";
      CASE GenJnlTemplate.Type OF
        GenJnlTemplate.Type::Payments:
          BEGIN
            "Account Type" := "Account Type"::Vendor;
            "Document Type" := "Document Type"::Payment;
          END;
        ELSE BEGIN
          "Account Type" := LastGenJnlLine."Account Type";
          "Document Type" := LastGenJnlLine."Document Type";
        END;
      END;
      "Source Code" := GenJnlTemplate."Source Code";
      "Reason Code" := GenJnlBatch."Reason Code";
      "Posting No. Series" := GenJnlBatch."Posting No. Series";
      "Bal. Account Type" := GenJnlBatch."Bal. Account Type";
      IF ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"Fixed Asset"]) AND
         ("Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor,"Bal. Account Type"::"Fixed Asset"])
      THEN
        "Account Type" := "Account Type"::"G/L Account";
      VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
      Description := '';
      IF GenJnlBatch."Suggest Balancing Amount" THEN
        SuggestBalancingAmount(LastGenJnlLine,BottomLine);

      UpdateJournalBatchID;

      OnAfterSetupNewLine(Rec,GenJnlTemplate,GenJnlBatch,LastGenJnlLine,Balance,BottomLine);
    END;

    [External]
    PROCEDURE InitNewLine@94(PostingDate@1000 : Date;DocumentDate@1001 : Date;PostingDescription@1002 : Text[100];ShortcutDim1Code@1003 : Code[20];ShortcutDim2Code@1004 : Code[20];DimSetID@1005 : Integer;ReasonCode@1006 : Code[10]);
    BEGIN
      INIT;
      "Posting Date" := PostingDate;
      "Document Date" := DocumentDate;
      Description := PostingDescription;
      "Shortcut Dimension 1 Code" := ShortcutDim1Code;
      "Shortcut Dimension 2 Code" := ShortcutDim2Code;
      "Dimension Set ID" := DimSetID;
      "Reason Code" := ReasonCode;
      OnAfterInitNewLine(Rec);
    END;

    [External]
    PROCEDURE CheckDocNoOnLines@78();
    VAR
      GenJnlBatch@1002 : Record 232;
      GenJnlLine@1001 : Record 81;
      LastDocNo@1003 : Code[20];
    BEGIN
      GenJnlLine.COPYFILTERS(Rec);

      IF NOT GenJnlLine.FINDSET THEN
        EXIT;
      GenJnlBatch.GET(GenJnlLine."Journal Template Name",GenJnlLine."Journal Batch Name");
      IF GenJnlBatch."No. Series" = '' THEN
        EXIT;

      CLEAR(NoSeriesMgt);
      REPEAT
        GenJnlLine.CheckDocNoBasedOnNoSeries(LastDocNo,GenJnlBatch."No. Series",NoSeriesMgt);
        LastDocNo := GenJnlLine."Document No.";
      UNTIL GenJnlLine.NEXT = 0;
    END;

    [External]
    PROCEDURE CheckDocNoBasedOnNoSeries@74(LastDocNo@1002 : Code[20];NoSeriesCode@1000 : Code[20];VAR NoSeriesMgtInstance@1001 : Codeunit 396);
    VAR
      IsHandled@1003 : Boolean;
      NoSeries@1100528500 : Record 308;
    BEGIN
      IsHandled := FALSE;
      OnBeforeCheckDocNoBasedOnNoSeries(Rec,LastDocNo,NoSeriesCode,NoSeriesMgtInstance,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF NoSeriesCode = '' THEN
        EXIT;

      IF (LastDocNo = '') OR ("Document No." <> LastDocNo) THEN
        //**4PS.sn
        BEGIN
          NoSeries.GET(NoSeriesCode);
          IF (NOT NoSeries."Manual Nos.") OR
             (CheckDocNoInDefaultNoSeries(NoSeriesCode,"Document No.","Posting Date")) THEN
        //**4PS.en
            IF "Document No." <> NoSeriesMgtInstance.GetNextNo(NoSeriesCode,"Posting Date",FALSE) THEN
              NoSeriesMgtInstance.TestManualWithDocumentNo(NoSeriesCode,"Document No.");  // allow use of manual document numbers.
        END; //**4PS.n
    END;

    [External]
    PROCEDURE RenumberDocumentNo@68();
    VAR
      GenJnlLine2@1006 : Record 81;
      DocNo@1003 : Code[20];
      FirstDocNo@1008 : Code[20];
      FirstTempDocNo@1009 : Code[20];
      LastTempDocNo@1010 : Code[20];
    BEGIN
      TESTFIELD("Check Printed",FALSE);

      GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
      IF GenJnlBatch."No. Series" = '' THEN
        EXIT;
      IF GETFILTER("Document No.") <> '' THEN
        ERROR(DocNoFilterErr);
      CLEAR(NoSeriesMgt);
      FirstDocNo := NoSeriesMgt.TryGetNextNo(GenJnlBatch."No. Series","Posting Date");
      FirstTempDocNo := 'RENUMBERED-000000001';
      // step1 - renumber to non-existing document number
      DocNo := FirstTempDocNo;
      GenJnlLine2 := Rec;
      GenJnlLine2.RESET;
      RenumberDocNoOnLines(DocNo,GenJnlLine2);
      LastTempDocNo := DocNo;

      // step2 - renumber to real document number (within Filter)
      DocNo := FirstDocNo;
      GenJnlLine2.COPYFILTERS(Rec);
      GenJnlLine2 := Rec;
      RenumberDocNoOnLines(DocNo,GenJnlLine2);

      // step3 - renumber to real document number (outside filter)
      DocNo := INCSTR(DocNo);
      GenJnlLine2.RESET;
      GenJnlLine2.SETRANGE("Document No.",FirstTempDocNo,LastTempDocNo);
      RenumberDocNoOnLines(DocNo,GenJnlLine2);

      GET("Journal Template Name","Journal Batch Name","Line No.");
    END;

    LOCAL PROCEDURE RenumberDocNoOnLines@69(VAR DocNo@1000 : Code[20];VAR GenJnlLine2@1001 : Record 81);
    VAR
      LastGenJnlLine@1002 : Record 81;
      GenJnlLine3@1005 : Record 81;
      PrevDocNo@1004 : Code[20];
      FirstDocNo@1006 : Code[20];
      First@1003 : Boolean;
    BEGIN
      FirstDocNo := DocNo;
      WITH GenJnlLine2 DO BEGIN
        SETCURRENTKEY("Journal Template Name","Journal Batch Name","Document No.");
        SETRANGE("Journal Template Name","Journal Template Name");
        SETRANGE("Journal Batch Name","Journal Batch Name");
        LastGenJnlLine.INIT;
        First := TRUE;
        IF FINDSET THEN BEGIN
          REPEAT
            IF "Document No." = FirstDocNo THEN
              EXIT;
            IF NOT First AND (("Document No." <> PrevDocNo) OR ("Bal. Account No." <> '')) AND NOT LastGenJnlLine.EmptyLine THEN
              DocNo := INCSTR(DocNo);
            PrevDocNo := "Document No.";
            IF "Document No." <> '' THEN BEGIN
              IF "Applies-to ID" = "Document No." THEN
                RenumberAppliesToID(GenJnlLine2,"Document No.",DocNo);
              RenumberAppliesToDocNo(GenJnlLine2,"Document No.",DocNo);
            END;
            GenJnlLine3.GET("Journal Template Name","Journal Batch Name","Line No.");
            GenJnlLine3."Document No." := DocNo;
            GenJnlLine3.MODIFY;
            First := FALSE;
            LastGenJnlLine := GenJnlLine2
          UNTIL NEXT = 0
        END
      END
    END;

    LOCAL PROCEDURE RenumberAppliesToID@70(GenJnlLine2@1002 : Record 81;OriginalAppliesToID@1000 : Code[50];NewAppliesToID@1001 : Code[50]);
    VAR
      CustLedgEntry@1003 : Record 21;
      CustLedgEntry2@1009 : Record 21;
      VendLedgEntry@1004 : Record 25;
      VendLedgEntry2@1010 : Record 25;
      AccType@1005 : Option;
      AccNo@1006 : Code[20];
    BEGIN
      GetAccTypeAndNo(GenJnlLine2,AccType,AccNo);
      CASE AccType OF
        "Account Type"::Customer:
          BEGIN
            CustLedgEntry.SETRANGE("Customer No.",AccNo);
            CustLedgEntry.SETRANGE("Applies-to ID",OriginalAppliesToID);
            IF CustLedgEntry.FINDSET THEN
              REPEAT
                CustLedgEntry2.GET(CustLedgEntry."Entry No.");
                CustLedgEntry2."Applies-to ID" := NewAppliesToID;
                CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry2);
              UNTIL CustLedgEntry.NEXT = 0;
          END;
        "Account Type"::Vendor:
          BEGIN
            VendLedgEntry.SETRANGE("Vendor No.",AccNo);
            VendLedgEntry.SETRANGE("Applies-to ID",OriginalAppliesToID);
            IF VendLedgEntry.FINDSET THEN
              REPEAT
                VendLedgEntry2.GET(VendLedgEntry."Entry No.");
                VendLedgEntry2."Applies-to ID" := NewAppliesToID;
                CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",VendLedgEntry2);
              UNTIL VendLedgEntry.NEXT = 0;
          END;
        ELSE
          EXIT
      END;
      GenJnlLine2."Applies-to ID" := NewAppliesToID;
      GenJnlLine2.MODIFY;
    END;

    LOCAL PROCEDURE RenumberAppliesToDocNo@71(GenJnlLine2@1002 : Record 81;OriginalAppliesToDocNo@1001 : Code[20];NewAppliesToDocNo@1000 : Code[20]);
    BEGIN
      GenJnlLine2.RESET;
      GenJnlLine2.SETRANGE("Journal Template Name",GenJnlLine2."Journal Template Name");
      GenJnlLine2.SETRANGE("Journal Batch Name",GenJnlLine2."Journal Batch Name");
      GenJnlLine2.SETRANGE("Applies-to Doc. Type",GenJnlLine2."Document Type");
      GenJnlLine2.SETRANGE("Applies-to Doc. No.",OriginalAppliesToDocNo);
      GenJnlLine2.MODIFYALL("Applies-to Doc. No.",NewAppliesToDocNo);
    END;

    LOCAL PROCEDURE CheckVATInAlloc@1();
    BEGIN
      IF "Gen. Posting Type" <> 0 THEN BEGIN
        GenJnlAlloc.RESET;
        GenJnlAlloc.SETRANGE("Journal Template Name","Journal Template Name");
        GenJnlAlloc.SETRANGE("Journal Batch Name","Journal Batch Name");
        GenJnlAlloc.SETRANGE("Journal Line No.","Line No.");
        IF GenJnlAlloc.FINDSET THEN
          REPEAT
            GenJnlAlloc.CheckVAT(Rec);
          UNTIL GenJnlAlloc.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE SetCurrencyCode@4(AccType2@1000 : 'G/L Account,Customer,Vendor,Bank Account';AccNo2@1001 : Code[20]) : Boolean;
    VAR
      BankAcc@1002 : Record 270;
    BEGIN
      "Currency Code" := '';
      IF AccNo2 <> '' THEN
        IF AccType2 = AccType2::"Bank Account" THEN
          IF BankAcc.GET(AccNo2) THEN
            "Currency Code" := BankAcc."Currency Code";
      EXIT("Currency Code" <> '');
    END;

    [External]
    PROCEDURE SetCurrencyFactor@130(CurrencyCode@1000 : Code[10];CurrencyFactor@1001 : Decimal);
    BEGIN
      "Currency Code" := CurrencyCode;
      IF "Currency Code" = '' THEN
        "Currency Factor" := 1
      ELSE
        "Currency Factor" := CurrencyFactor;
    END;

    LOCAL PROCEDURE GetCurrency@3();
    BEGIN
      IF "Additional-Currency Posting" =
         "Additional-Currency Posting"::"Additional-Currency Amount Only"
      THEN BEGIN
        IF GLSetup."Additional Reporting Currency" = '' THEN
          ReadGLSetup;
        CurrencyCode := GLSetup."Additional Reporting Currency";
      END ELSE
        CurrencyCode := "Currency Code";

      IF CurrencyCode = '' THEN BEGIN
        CLEAR(Currency);
        Currency.InitRoundingPrecision
      END ELSE
        IF CurrencyCode <> Currency.Code THEN BEGIN
          Currency.GET(CurrencyCode);
          Currency.TESTFIELD("Amount Rounding Precision");
        END;
    END;

    [External]
    PROCEDURE UpdateSource@6();
    VAR
      SourceExists1@1000 : Boolean;
      SourceExists2@1001 : Boolean;
    BEGIN
      SourceExists1 := ("Account Type" <> "Account Type"::"G/L Account") AND ("Account No." <> '');
      SourceExists2 := ("Bal. Account Type" <> "Bal. Account Type"::"G/L Account") AND ("Bal. Account No." <> '');
      CASE TRUE OF
        SourceExists1 AND NOT SourceExists2:
          BEGIN
            "Source Type" := "Account Type";
            "Source No." := "Account No.";
          END;
        SourceExists2 AND NOT SourceExists1:
          BEGIN
            "Source Type" := "Bal. Account Type";
            "Source No." := "Bal. Account No.";
          END;
        ELSE BEGIN
          "Source Type" := "Source Type"::" ";
          "Source No." := '';
        END;
      END;
    END;

    LOCAL PROCEDURE CheckGLAcc@7(GLAcc@1000 : Record 15);
    BEGIN
      GLAcc.CHANGECOMPANY("Receiving Company");  //**4PS.n
      GLAcc.CheckGLAcc;
      //**4PS.s  //call 32872
      //IF GLAcc."Direct Posting" OR ("Journal Template Name" = '') OR "System-Created Entry" THEN
      IF GLAcc."Direct Posting" OR ("Journal Template Name" = '') THEN
        EXIT;
      IF "System-Created Entry" AND NOT (CurrFieldNo = FIELDNO("Bal. Account No.")) THEN
      //**4PS.e
        EXIT;

      IF "Posting Date" <> 0D THEN
        IF "Posting Date" = CLOSINGDATE("Posting Date") THEN
          EXIT;
      //**4PS.sn
      IF (("Job No." = '') AND ("Service Order No." = '') AND ("Service Contract No." = '') AND ("Plant Type" = '') AND ("Loan Code" = '')) OR
         (CurrFieldNo = FIELDNO("Bal. Account No.")) THEN //call 32872
      //**4PS.en
        GLAcc.TESTFIELD("Direct Posting",TRUE);
    END;

    LOCAL PROCEDURE CheckBalanceAcc@1100525004(GLAcc@1100525000 : Record 15);
    BEGIN
      //**4PS
      GLAcc.CHANGECOMPANY("Receiving Company");
      IF ("Closed Project No." = '') AND ("Closed Service Order No." = '') AND ("Closed Service Contract No." = '') THEN //C019579
        GLAcc.TESTFIELD("WIP Account",FALSE);  //C016580
      //MC-026430
      IF GLAcc."Direct Posting" OR ("Journal Template Name" = '') OR "System-Created Entry" THEN  //db, 16-12-10: M24619
        EXIT;
      IF "Posting Date" <> 0D THEN
        IF "Posting Date" = CLOSINGDATE("Posting Date") THEN
          EXIT;

      CheckDirectPosting(GLAcc);
    END;

    LOCAL PROCEDURE CheckICPartner@128(ICPartnerCode@1000 : Code[20];AccountType@1001 : 'G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner';AccountNo@1002 : Code[20]);
    VAR
      ICPartner@1003 : Record 413;
    BEGIN
      IF ICPartnerCode <> '' THEN BEGIN
        IF GenJnlTemplate.GET("Journal Template Name") THEN;
        IF (ICPartnerCode <> '') AND ICPartner.GET(ICPartnerCode) THEN BEGIN
          ICPartner.CheckICPartnerIndirect(FORMAT(AccountType),AccountNo);
          "IC Partner Code" := ICPartnerCode;
        END;
      END;
    END;

    LOCAL PROCEDURE CheckDirectPosting@217(VAR GLAccount@1001 : Record 15);
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeCheckDirectPosting(GLAccount,IsHandled,Rec);
      IF IsHandled THEN
        EXIT;

      GLAccount.TESTFIELD("Direct Posting",TRUE);

      OnAfterCheckDirectPosting(GLAccount,Rec);
    END;

    [External]
    PROCEDURE GetFAAddCurrExchRate@8();
    VAR
      DeprBook@1000 : Record 5611;
      FADeprBook@1003 : Record 5612;
      FANo@1001 : Code[20];
      UseFAAddCurrExchRate@1002 : Boolean;
    BEGIN
      "FA Add.-Currency Factor" := 0;
      IF ("FA Posting Type" <> "FA Posting Type"::" ") AND
         ("Depreciation Book Code" <> '')
      THEN BEGIN
        IF "Account Type" = "Account Type"::"Fixed Asset" THEN
          FANo := "Account No.";
        IF "Bal. Account Type" = "Bal. Account Type"::"Fixed Asset" THEN
          FANo := "Bal. Account No.";
        IF FANo <> '' THEN BEGIN
          DeprBook.GET("Depreciation Book Code");
          CASE "FA Posting Type" OF
            "FA Posting Type"::"Acquisition Cost":
              UseFAAddCurrExchRate := DeprBook."Add-Curr Exch Rate - Acq. Cost";
            "FA Posting Type"::Depreciation:
              UseFAAddCurrExchRate := DeprBook."Add.-Curr. Exch. Rate - Depr.";
            "FA Posting Type"::"Write-Down":
              UseFAAddCurrExchRate := DeprBook."Add-Curr Exch Rate -Write-Down";
            "FA Posting Type"::Appreciation:
              UseFAAddCurrExchRate := DeprBook."Add-Curr. Exch. Rate - Apprec.";
            "FA Posting Type"::"Custom 1":
              UseFAAddCurrExchRate := DeprBook."Add-Curr. Exch Rate - Custom 1";
            "FA Posting Type"::"Custom 2":
              UseFAAddCurrExchRate := DeprBook."Add-Curr. Exch Rate - Custom 2";
            "FA Posting Type"::Disposal:
              UseFAAddCurrExchRate := DeprBook."Add.-Curr. Exch. Rate - Disp.";
            "FA Posting Type"::Maintenance:
              UseFAAddCurrExchRate := DeprBook."Add.-Curr. Exch. Rate - Maint.";
          END;
          IF UseFAAddCurrExchRate THEN BEGIN
            FADeprBook.GET(FANo,"Depreciation Book Code");
            FADeprBook.TESTFIELD("FA Add.-Currency Factor");
            "FA Add.-Currency Factor" := FADeprBook."FA Add.-Currency Factor";
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE GetShowCurrencyCode@10(CurrencyCode@1000 : Code[10]) : Code[10];
    BEGIN
      IF CurrencyCode <> '' THEN
        EXIT(CurrencyCode);

      EXIT(Text009);
    END;

    LOCAL PROCEDURE GetVATPostingSetup@268(VATBusPostingGroup@1000 : Code[20];VATProdPostingGroup@1001 : Code[20]);
    BEGIN
      IF NOT VATPostingSetup.GET(VATBusPostingGroup,VATProdPostingGroup) THEN
        VATPostingSetup.INIT;
      OnAfterGetVATPostingSetup(VATPostingSetup);
    END;

    [External]
    PROCEDURE ClearCustVendApplnEntry@11();
    VAR
      TempCustLedgEntry@1000 : TEMPORARY Record 21;
      TempVendLedgEntry@1001 : TEMPORARY Record 25;
      TempEmplLedgEntry@1002 : TEMPORARY Record 5222;
      AccType@1004 : 'G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee';
      AccNo@1005 : Code[20];
      CustEntryEdit@11012000 : Codeunit 103;
    BEGIN
      GetAccTypeAndNo(Rec,AccType,AccNo);
      CASE AccType OF
        AccType::Customer:
          IF xRec."Applies-to ID" <> '' THEN BEGIN
            IF FindFirstCustLedgEntryWithAppliesToID(AccNo,xRec."Applies-to ID") THEN BEGIN
              ClearCustApplnEntryFields;
              TempCustLedgEntry.DELETEALL;
              CustEntrySetApplID.SetApplId(CustLedgEntry,TempCustLedgEntry,'');
            END
          END ELSE
            IF xRec."Applies-to Doc. No." <> '' THEN
              IF FindFirstCustLedgEntryWithAppliesToDocNo(AccNo,xRec."Applies-to Doc. No.") THEN BEGIN
                ClearCustApplnEntryFields;
                //CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry); //**4PS.o
                //**4PS.sn
                IF ("Receiving Company" <> '') AND ("Receiving Company" <> COMPANYNAME) THEN
                  CustEntryEdit.SetCompany("Receiving Company");
                CustEntryEdit.RUN(CustLedgEntry);
                //**4PS.en
              END;
        AccType::Vendor:
          IF xRec."Applies-to ID" <> '' THEN BEGIN
            IF FindFirstVendLedgEntryWithAppliesToID(AccNo,xRec."Applies-to ID") THEN BEGIN
              ClearVendApplnEntryFields;
              TempVendLedgEntry.DELETEALL;
              VendEntrySetApplID.SetApplId(VendLedgEntry,TempVendLedgEntry,'');
            END
          END ELSE
            IF xRec."Applies-to Doc. No." <> '' THEN
              IF FindFirstVendLedgEntryWithAppliesToDocNo(AccNo,xRec."Applies-to Doc. No.") THEN BEGIN
                ClearVendApplnEntryFields;
                CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",VendLedgEntry);
              END;
        AccType::Employee:
          IF xRec."Applies-to ID" <> '' THEN BEGIN
            IF FindFirstEmplLedgEntryWithAppliesToID(AccNo,xRec."Applies-to ID") THEN BEGIN
              ClearEmplApplnEntryFields;
              TempEmplLedgEntry.DELETEALL;
              EmplEntrySetApplID.SetApplId(EmplLedgEntry,TempEmplLedgEntry,'');
            END
          END ELSE
            IF xRec."Applies-to Doc. No." <> '' THEN
              IF FindFirstEmplLedgEntryWithAppliesToDocNo(AccNo,xRec."Applies-to Doc. No.") THEN BEGIN
                ClearEmplApplnEntryFields;
                CODEUNIT.RUN(CODEUNIT::"Empl. Entry-Edit",EmplLedgEntry);
              END;
      END;
    END;

    LOCAL PROCEDURE ClearCustApplnEntryFields@56();
    BEGIN
      CustLedgEntry."Accepted Pmt. Disc. Tolerance" := FALSE;
      CustLedgEntry."Accepted Payment Tolerance" := 0;
      CustLedgEntry."Amount to Apply" := 0;

      OnAfterClearCustApplnEntryFields(CustLedgEntry);
    END;

    LOCAL PROCEDURE ClearVendApplnEntryFields@57();
    BEGIN
      VendLedgEntry."Accepted Pmt. Disc. Tolerance" := FALSE;
      VendLedgEntry."Accepted Payment Tolerance" := 0;
      VendLedgEntry."Amount to Apply" := 0;

      OnAfterClearVendApplnEntryFields(VendLedgEntry);
    END;

    LOCAL PROCEDURE ClearEmplApplnEntryFields@193();
    BEGIN
      EmplLedgEntry."Amount to Apply" := 0;

      OnAfterClearEmplApplnEntryFields(EmplLedgEntry);
    END;

    [External]
    PROCEDURE CheckFixedCurrency@12() : Boolean;
    VAR
      CurrExchRate@1000 : Record 330;
    BEGIN
      CurrExchRate.SETRANGE("Currency Code","Currency Code");
      CurrExchRate.SETRANGE("Starting Date",0D,"Posting Date");

      IF NOT CurrExchRate.FINDLAST THEN
        EXIT(FALSE);

      IF CurrExchRate."Relational Currency Code" = '' THEN
        EXIT(
          CurrExchRate."Fix Exchange Rate Amount" =
          CurrExchRate."Fix Exchange Rate Amount"::Both);

      IF CurrExchRate."Fix Exchange Rate Amount" <>
         CurrExchRate."Fix Exchange Rate Amount"::Both
      THEN
        EXIT(FALSE);

      CurrExchRate.SETRANGE("Currency Code",CurrExchRate."Relational Currency Code");
      IF CurrExchRate.FINDLAST THEN
        EXIT(
          CurrExchRate."Fix Exchange Rate Amount" =
          CurrExchRate."Fix Exchange Rate Amount"::Both);

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE CreateDim@13(Type1@1000 : Integer;No1@1001 : Code[40];Type2@1002 : Integer;No2@1003 : Code[40];Type3@1004 : Integer;No3@1005 : Code[40];Type4@1006 : Integer;No4@1007 : Code[40];Type5@1008 : Integer;No5@1009 : Code[40];Type6@1100485001 : Integer;No6@1100485000 : Code[40];Type7@1100525002 : Integer;No7@1100525001 : Code[40];Type8@1100525004 : Integer;No8@1100525003 : Code[40]);
    VAR
      lDimValRec@1100525000 : Record 349;
      TableID@1010 : ARRAY [10] OF Integer;
      No@1011 : ARRAY [10] OF Code[40];
      FAPostingGr@1100525005 : Record 5606;
    BEGIN
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      TableID[5] := Type5;
      No[5] := No5;
      OnAfterCreateDimTableIDs(Rec,CurrFieldNo,TableID,No);

      //**4PS.sn
      TableID[6] := Type6;
      No[6] := No6;
      TableID[7] := Type7;
      No[7] := No7;
      TableID[8] := Type8; //** 4PS 09-06-2010
      No[8] := No8;        //** 4PS 09-06-2010

      //**4PS.sn call C-026623
      IF ("Account Type" = "Account Type"::"Fixed Asset") AND
         ("FA Posting Type" = "FA Posting Type"::Depreciation) THEN
        IF FAPostingGr.GET("Posting Group") THEN BEGIN
          TableID[9] := DATABASE::"G/L Account";
          No[9] := FAPostingGr."Accum. Depreciation Account";
        END;
      //**4PS.en call C-026623

      Dim1 := "Shortcut Dimension 1 Code";
      Dim2 := "Shortcut Dimension 2 Code";
      DimMgt.SetCompany("Receiving Company"); //**4PS.n
      //**4PS.en

      //"Shortcut Dimension 1 Code" := ''; //**4PS.o Must be kept for Department Authorization
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" :=
        DimMgt.GetRecDefaultDimID(
          Rec,CurrFieldNo,TableID,No,"Source Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      //**4PS.sn
      IF (Dim1 <> '') AND ("Shortcut Dimension 1 Code" = '') THEN BEGIN
        "Shortcut Dimension 1 Code" := Dim1;
      END;
      ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");

      IF (Dim2 <> '') AND
         (("Shortcut Dimension 2 Code" = '') OR
          (CurrFieldNo = FIELDNO("Shortcut Dimension 2 Code")))
      THEN BEGIN
        "Shortcut Dimension 2 Code" := Dim2;
        ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
      END;

      // 20-11-2008
      IF (Dim2 <> "Shortcut Dimension 2 Code") AND
         ("Shortcut Dimension 2 Code" <> '') AND
         (CurrFieldNo <> FIELDNO("Shortcut Dimension 2 Code"))
      THEN BEGIN
        IF ("Item No." + "Basic Item" + "Trade Item" = '') THEN BEGIN
          lDimValRec.CHANGECOMPANY("Receiving Company");
          DimMgt.GetDimValueRec(2, "Shortcut Dimension 2 Code", lDimValRec, TRUE, "Job No.");
          "Cost Component" := lDimValRec."Cost Component";
        END;
      END;
      //**4PS.en
    END;

    [External]
    PROCEDURE ValidateShortcutDimCode@14(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      OnBeforeValidateShortcutDimCode(Rec,FieldNumber,ShortcutDimCode);

      TESTFIELD("Check Printed",FALSE);
      //**4PS.sn
      IF (FieldNumber = 1) AND (NOT WhileHoursPostNoDPACheck) THEN  //** CALL C006343 changed
        DimMgt.CheckDepartmentAuthorization(DATABASE::"Gen. Journal Line", ShortcutDimCode);
      DimMgt.SetCompany("Receiving Company"); //**4PS.n
      //**4PS.en
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");

      OnAfterValidateShortcutDimCode(Rec,FieldNumber,ShortcutDimCode);
    END;

    LOCAL PROCEDURE ValidateAmount@223(ShouldCheckPaymentTolerance@1000 : Boolean);
    BEGIN
      //**4PS.sn
      IF (Amount <> xRec.Amount) AND (CurrFieldNo <> 0) THEN
        ClearICApplicationFields;
      //**4PS.en

      GetCurrency;
      IF "Currency Code" = '' THEN
        "Amount (LCY)" := Amount
      ELSE
        "Amount (LCY)" := ROUND(
      //    CurrExchRate.ExchangeAmtFCYToLCY("Posting Date","Currency Code",Amount,"Currency Factor")); //**4PS.o
            CurrExchRate.ExchangeAmtFCYToLCY(1,"Job No.","Posting Date","Currency Code",Amount,"Currency Factor","Account Type" = "Account Type"::Customer)); //**4PS.n

      OnValidateAmountOnAfterAssignAmountLCY("Amount (LCY)");

      Amount := ROUND(Amount,Currency."Amount Rounding Precision");
      IF (CurrFieldNo <> 0) AND
         (CurrFieldNo <> FIELDNO("Applies-to Doc. No.")) AND
         ((("Account Type" = "Account Type"::Customer) AND
           ("Account No." <> '') AND (Amount > 0) AND
           (CurrFieldNo <> FIELDNO("Bal. Account No."))) OR
          (("Bal. Account Type" = "Bal. Account Type"::Customer) AND
           ("Bal. Account No." <> '') AND (Amount < 0) AND
           (CurrFieldNo <> FIELDNO("Account No."))))
      THEN
        IF "Receiving Company" = '' THEN  //**4PS.n
          CustCheckCreditLimit.GenJnlLineCheck(Rec);

      VALIDATE("VAT %");
      VALIDATE("Bal. VAT %");
      UpdateLineBalance;
      IF "Deferral Code" <> '' THEN
        VALIDATE("Deferral Code");

      IF Amount <> xRec.Amount THEN BEGIN
        IF ("Applies-to Doc. No." <> '') OR ("Applies-to ID" <> '') THEN
          SetApplyToAmount;
        IF ShouldCheckPaymentTolerance THEN
          IF (xRec.Amount <> 0) OR (xRec."Applies-to Doc. No." <> '') OR (xRec."Applies-to ID" <> '') THEN
            PaymentToleranceMgt.PmtTolGenJnl(Rec);
      END;

      IF JobTaskIsSet THEN BEGIN
        CreateTempJobJnlLine;
        UpdatePricesFromJobJnlLine;
      END;

      //RFC1127
      VALIDATE("Received amount");
    END;

    PROCEDURE LookupShortcutDimCode@18(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      TESTFIELD("Check Printed",FALSE);
      DimMgt.SetCompany("Receiving Company"); //**4PS.n
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    [External]
    PROCEDURE ShowShortcutDimCode@15(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.SetCompany("Receiving Company"); //**4PS.n T005462
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    [External]
    PROCEDURE ShowDimensions@26();
    BEGIN
      DimMgt.SetTableID(DATABASE::"Gen. Journal Line"); //**4PS.n
      DimMgt.SetCompany("Receiving Company"); //**4PS.n
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Journal Template Name","Journal Batch Name","Line No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    [External]
    PROCEDURE GetFAVATSetup@17();
    VAR
      LocalGLAcc@1000 : Record 15;
      FAPostingGr@1001 : Record 5606;
      FABalAcc@1002 : Boolean;
    BEGIN
      IF CurrFieldNo = 0 THEN
        EXIT;
      IF ("Account Type" <> "Account Type"::"Fixed Asset") AND
         ("Bal. Account Type" <> "Bal. Account Type"::"Fixed Asset")
      THEN
        EXIT;
      FABalAcc := ("Bal. Account Type" = "Bal. Account Type"::"Fixed Asset");
      IF NOT FABalAcc THEN BEGIN
        ClearPostingGroups;
        "Tax Group Code" := '';
        VALIDATE("VAT Prod. Posting Group");
      END;
      IF FABalAcc THEN BEGIN
        ClearBalancePostingGroups;
        "Bal. Tax Group Code" := '';
        VALIDATE("Bal. VAT Prod. Posting Group");
      END;
      IF CopyVATSetupToJnlLines THEN
        IF (("FA Posting Type" = "FA Posting Type"::"Acquisition Cost") OR
            ("FA Posting Type" = "FA Posting Type"::Disposal) OR
            ("FA Posting Type" = "FA Posting Type"::Maintenance)) AND
           ("Posting Group" <> '')
        THEN
          IF FAPostingGr.GET("Posting Group") THEN BEGIN
            CASE "FA Posting Type" OF
              "FA Posting Type"::"Acquisition Cost":
                LocalGLAcc.GET(FAPostingGr.GetAcquisitionCostAccount);
              "FA Posting Type"::Disposal:
                LocalGLAcc.GET(FAPostingGr.GetAcquisitionCostAccountOnDisposal);
              "FA Posting Type"::Maintenance:
                LocalGLAcc.GET(FAPostingGr.GetMaintenanceExpenseAccount);
            END;
            OnGetFAVATSetupOnBeforeCheckGLAcc(Rec,LocalGLAcc);
            LocalGLAcc.CheckGLAcc;
            IF NOT FABalAcc THEN BEGIN
              "Gen. Posting Type" := LocalGLAcc."Gen. Posting Type";
              "Gen. Bus. Posting Group" := LocalGLAcc."Gen. Bus. Posting Group";
              "Gen. Prod. Posting Group" := LocalGLAcc."Gen. Prod. Posting Group";
              "VAT Bus. Posting Group" := LocalGLAcc."VAT Bus. Posting Group";
              "VAT Prod. Posting Group" := LocalGLAcc."VAT Prod. Posting Group";
              "Tax Group Code" := LocalGLAcc."Tax Group Code";
              VALIDATE("VAT Prod. Posting Group");
            END ELSE BEGIN;
              "Bal. Gen. Posting Type" := LocalGLAcc."Gen. Posting Type";
              "Bal. Gen. Bus. Posting Group" := LocalGLAcc."Gen. Bus. Posting Group";
              "Bal. Gen. Prod. Posting Group" := LocalGLAcc."Gen. Prod. Posting Group";
              "Bal. VAT Bus. Posting Group" := LocalGLAcc."VAT Bus. Posting Group";
              "Bal. VAT Prod. Posting Group" := LocalGLAcc."VAT Prod. Posting Group";
              "Bal. Tax Group Code" := LocalGLAcc."Tax Group Code";
              VALIDATE("Bal. VAT Prod. Posting Group");
            END;
          END;
    END;

    LOCAL PROCEDURE GetFADeprBook@114(FANo@1003 : Code[20]);
    VAR
      FASetup@1000 : Record 5603;
      FADeprBook@1001 : Record 5612;
      DefaultFADeprBook@1002 : Record 5612;
    BEGIN
      IF "Depreciation Book Code" = '' THEN BEGIN
        FASetup.GET;

        DefaultFADeprBook.SETRANGE("FA No.",FANo);
        DefaultFADeprBook.SETRANGE("Default FA Depreciation Book",TRUE);

        CASE TRUE OF
          DefaultFADeprBook.FINDFIRST:
            "Depreciation Book Code" := DefaultFADeprBook."Depreciation Book Code";
          FADeprBook.GET(FANo,FASetup."Default Depr. Book"):
            "Depreciation Book Code" := FASetup."Default Depr. Book";
          ELSE
            "Depreciation Book Code" := '';
        END;
      END;

      IF "Depreciation Book Code" <> '' THEN BEGIN
        FADeprBook.GET(FANo,"Depreciation Book Code");
        "Posting Group" := FADeprBook."FA Posting Group";
      END;
    END;

    [External]
    PROCEDURE GetTemplate@16();
    BEGIN
      IF NOT TemplateFound THEN
        GenJnlTemplate.GET("Journal Template Name");
      TemplateFound := TRUE;
    END;

    LOCAL PROCEDURE UpdateSalesPurchLCY@19();
    BEGIN
      "Sales/Purch. (LCY)" := 0;
      IF (NOT "System-Created Entry") AND ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) THEN BEGIN
        IF ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor]) AND
           (("Bal. Account No." <> '') OR ("Recurring Method" <> "Recurring Method"::" "))
        THEN
          "Sales/Purch. (LCY)" := "Amount (LCY)" + "Bal. VAT Amount (LCY)";
        IF ("Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor]) AND ("Account No." <> '') THEN
          "Sales/Purch. (LCY)" := -("Amount (LCY)" - "VAT Amount (LCY)");
      END;
    END;

    [External]
    PROCEDURE LookUpAppliesToDocCust@35(AccNo@1000 : Code[20]);
    VAR
      ApplyCustEntries@1002 : Page 232;
      IsHandled@1001 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeLookUpAppliesToDocCust(Rec,AccNo,IsHandled);
      IF IsHandled THEN
        EXIT;

      CLEAR(CustLedgEntry);
      CustLedgEntry.CHANGECOMPANY("Receiving Company"); //**4PS.n
      CustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive,"Due Date");
      IF AccNo <> '' THEN
        CustLedgEntry.SETRANGE("Customer No.",AccNo);
      // PEB0026
      IF AccNo = '' THEN
        CustLedgEntry.SETCURRENTKEY(Open);
      // 0026
      CustLedgEntry.SETRANGE(Open,TRUE);
      IF "Applies-to Doc. No." <> '' THEN BEGIN
        CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        IF CustLedgEntry.ISEMPTY THEN BEGIN
          CustLedgEntry.SETRANGE("Document Type");
          CustLedgEntry.SETRANGE("Document No.");
        END;
      END;
      IF "Applies-to ID" <> '' THEN BEGIN
        CustLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
        IF CustLedgEntry.ISEMPTY THEN
          CustLedgEntry.SETRANGE("Applies-to ID");
      END;
      IF "Applies-to Doc. Type" <> "Applies-to Doc. Type"::" " THEN BEGIN
        CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        IF CustLedgEntry.ISEMPTY THEN
          CustLedgEntry.SETRANGE("Document Type");
      END;
      IF Amount <> 0 THEN BEGIN
        CustLedgEntry.SETRANGE(Positive,Amount < 0);
        IF CustLedgEntry.ISEMPTY THEN
          CustLedgEntry.SETRANGE(Positive);
      END;
      OnLookUpAppliesToDocCustOnAfterSetFilters(CustLedgEntry,Rec);

      ApplyCustEntries.SetGenJnlLine(Rec,GenJnlLine.FIELDNO("Applies-to Doc. No."));
      ApplyCustEntries.SETTABLEVIEW(CustLedgEntry);
      ApplyCustEntries.SETRECORD(CustLedgEntry);
      ApplyCustEntries.LOOKUPMODE(TRUE);
      IF ApplyCustEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ApplyCustEntries.GETRECORD(CustLedgEntry);
        IF AccNo = '' THEN BEGIN
          AccNo := CustLedgEntry."Customer No.";
          IF "Bal. Account Type" = "Bal. Account Type"::Customer THEN
            VALIDATE("Bal. Account No.",AccNo)
          ELSE
            VALIDATE("Account No.",AccNo);
        END;
        // PEB0026
        VALIDATE("Currency Code",CustLedgEntry."Currency Code");
        // 0026
        SetAmountWithCustLedgEntry;
        UpdateDocumentTypeAndAppliesTo(CustLedgEntry."Document Type",CustLedgEntry."Document No.");
        OnLookUpAppliesToDocCustOnAfterUpdateDocumentTypeAndAppliesTo(Rec,CustLedgEntry);
        GenJnlLineExt.InitGetLine(Rec);//4PSSE
        GenJnlLineExt."Reference No." := CustLedgEntry."Reference No.";       //NAVFI
        GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE

        VALIDATE("Shortcut Dimension 1 Code", CustLedgEntry."Global Dimension 1 Code"); //**4PS.n
        // PEB0026
        VALIDATE("Applies-to Doc. No.");
        // 0026
      END;
    END;

    [External]
    PROCEDURE LookUpAppliesToDocVend@36(AccNo@1000 : Code[20]);
    VAR
      ApplyVendEntries@1001 : Page 233;
      IsHandled@1002 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeLookUpAppliesToDocVend(Rec,AccNo,IsHandled);
      IF IsHandled THEN
        EXIT;

      CLEAR(VendLedgEntry);
      VendLedgEntry.SETCURRENTKEY("Vendor No.",Open,Positive,"Due Date");
      IF AccNo <> '' THEN
        VendLedgEntry.SETRANGE("Vendor No.",AccNo);
      // PEB0026
      IF AccNo = '' THEN
        VendLedgEntry.SETCURRENTKEY(Open);
      // 0026
      VendLedgEntry.SETRANGE(Open,TRUE);
      IF "Applies-to Doc. No." <> '' THEN BEGIN
        VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        IF VendLedgEntry.ISEMPTY THEN BEGIN
          VendLedgEntry.SETRANGE("Document Type");
          VendLedgEntry.SETRANGE("Document No.");
        END;
      END;
      IF "Applies-to ID" <> '' THEN BEGIN
        VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
        IF VendLedgEntry.ISEMPTY THEN
          VendLedgEntry.SETRANGE("Applies-to ID");
      END;
      IF "Applies-to Doc. Type" <> "Applies-to Doc. Type"::" " THEN BEGIN
        VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        IF VendLedgEntry.ISEMPTY THEN
          VendLedgEntry.SETRANGE("Document Type");
      END;
      IF  "Applies-to Doc. No." <> ''THEN BEGIN
        VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        IF VendLedgEntry.ISEMPTY THEN
          VendLedgEntry.SETRANGE("Document No.");
      END;
      IF Amount <> 0 THEN BEGIN
        VendLedgEntry.SETRANGE(Positive,Amount < 0);
        IF VendLedgEntry.ISEMPTY THEN;
        VendLedgEntry.SETRANGE(Positive);
      END;
      OnLookUpAppliesToDocVendOnAfterSetFilters(VendLedgEntry,Rec);

      ApplyVendEntries.SetGenJnlLine(Rec,GenJnlLine.FIELDNO("Applies-to Doc. No."));
      ApplyVendEntries.SETTABLEVIEW(VendLedgEntry);
      ApplyVendEntries.SETRECORD(VendLedgEntry);
      ApplyVendEntries.LOOKUPMODE(TRUE);
      IF ApplyVendEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ApplyVendEntries.GETRECORD(VendLedgEntry);
        IF AccNo = '' THEN BEGIN
          AccNo := VendLedgEntry."Vendor No.";
          IF "Bal. Account Type" = "Bal. Account Type"::Vendor THEN
            VALIDATE("Bal. Account No.",AccNo)
          ELSE
            VALIDATE("Account No.",AccNo);
        END;
        // PEB0026
        VALIDATE("Currency Code",VendLedgEntry."Currency Code");
        // 0026
        SetAmountWithVendLedgEntry;
        UpdateDocumentTypeAndAppliesTo(VendLedgEntry."Document Type",VendLedgEntry."Document No.");
        OnLookUpAppliesToDocVendOnAfterUpdateDocumentTypeAndAppliesTo(Rec,VendLedgEntry);

        VALIDATE("Shortcut Dimension 1 Code", VendLedgEntry."Global Dimension 1 Code"); //**4PS.n
      END;
    END;

    [External]
    PROCEDURE LookUpAppliesToDocEmpl@171(AccNo@1000 : Code[20]);
    VAR
      ApplyEmplEntries@1001 : Page 234;
      IsHandled@1002 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeLookUpAppliesToDocEmpl(Rec,AccNo,IsHandled);
      IF IsHandled THEN
        EXIT;

      CLEAR(EmplLedgEntry);
      EmplLedgEntry.SETCURRENTKEY("Employee No.",Open,Positive);
      IF AccNo <> '' THEN
        EmplLedgEntry.SETRANGE("Employee No.",AccNo);
      EmplLedgEntry.SETRANGE(Open,TRUE);
      IF "Applies-to Doc. No." <> '' THEN BEGIN
        EmplLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        EmplLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        IF EmplLedgEntry.ISEMPTY THEN BEGIN
          EmplLedgEntry.SETRANGE("Document Type");
          EmplLedgEntry.SETRANGE("Document No.");
        END;
      END;
      IF "Applies-to ID" <> '' THEN BEGIN
        EmplLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
        IF EmplLedgEntry.ISEMPTY THEN
          EmplLedgEntry.SETRANGE("Applies-to ID");
      END;
      IF "Applies-to Doc. Type" <> "Applies-to Doc. Type"::" " THEN BEGIN
        EmplLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        IF EmplLedgEntry.ISEMPTY THEN
          EmplLedgEntry.SETRANGE("Document Type");
      END;
      IF  "Applies-to Doc. No." <> '' THEN BEGIN
        EmplLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        IF EmplLedgEntry.ISEMPTY THEN
          EmplLedgEntry.SETRANGE("Document No.");
      END;
      IF Amount <> 0 THEN BEGIN
        EmplLedgEntry.SETRANGE(Positive,Amount < 0);
        IF EmplLedgEntry.ISEMPTY THEN;
        EmplLedgEntry.SETRANGE(Positive);
      END;
      OnLookUpAppliesToDocEmplOnAfterSetFilters(EmplLedgEntry,Rec);

      ApplyEmplEntries.SetGenJnlLine(Rec,GenJnlLine.FIELDNO("Applies-to Doc. No."));
      ApplyEmplEntries.SETTABLEVIEW(EmplLedgEntry);
      ApplyEmplEntries.SETRECORD(EmplLedgEntry);
      ApplyEmplEntries.LOOKUPMODE(TRUE);
      IF ApplyEmplEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ApplyEmplEntries.GETRECORD(EmplLedgEntry);
        IF AccNo = '' THEN BEGIN
          AccNo := EmplLedgEntry."Employee No.";
          IF "Bal. Account Type" = "Bal. Account Type"::Employee THEN
            VALIDATE("Bal. Account No.",AccNo)
          ELSE
            VALIDATE("Account No.",AccNo);
        END;
        SetAmountWithEmplLedgEntry;

        VALIDATE("Shortcut Dimension 1 Code", VendLedgEntry."Global Dimension 1 Code"); //**4PS.n

        UpdateDocumentTypeAndAppliesTo(EmplLedgEntry."Document Type",EmplLedgEntry."Document No.");
        OnLookUpAppliesToDocEmplOnAfterUpdateDocumentTypeAndAppliesTo(Rec,EmplLedgEntry);

        // ***4PSSE.sn Call SYM912
        VALIDATE("External Document No.", VendLedgEntry."External Document No."); //
        // ***4PSSE.en Call SYM912

        //>>NAVNO
        GenJnlLineExt.InitGetLine(Rec);//4PSSE
        GenJnlLineExt."Payment Type Code Abroad" := VendLedgEntry."Payment Type Code Abroad";
        GenJnlLineExt."Specification (Norges Bank)" := VendLedgEntry."Specification (Norges Bank)";
        //<<NAVNO
        //>>NAVFI
      //  CALCFIELDS("Message Type","Invoice Message");//180507 bugg, was missing //180613 ej flowfields
        GenJnlLineExt."Message Type" := VendLedgEntry."Message Type";
        GenJnlLineExt."Invoice Message" := VendLedgEntry."Invoice Message";
        GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE
        //<<NAVFI
        // PEB0026
        VALIDATE("Applies-to Doc. No.");
        // 0026

      END;
    END;

    [External]
    PROCEDURE SetApplyToAmount@20();
    VAR
      lvCustEntryEditCU@1100485000 : Codeunit 103;
    BEGIN
      CASE "Account Type" OF
        "Account Type"::Customer:
          BEGIN
            CustLedgEntry.CHANGECOMPANY("Receiving Company"); //**4PS.n
            CustLedgEntry.SETCURRENTKEY("Document No.");
            CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
            CustLedgEntry.SETRANGE("Customer No.","Account No.");
            CustLedgEntry.SETRANGE(Open,TRUE);
            IF CustLedgEntry.FINDFIRST THEN
              IF CustLedgEntry."Amount to Apply" = 0 THEN BEGIN
                CustLedgEntry.CALCFIELDS("Remaining Amount");
                CustLedgEntry."Amount to Apply" := CustLedgEntry."Remaining Amount";
                //CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry);  //**4PS.o
                //**4PS.sn
                IF ("Receiving Company" <> '') AND ("Receiving Company" <> COMPANYNAME) THEN
                  lvCustEntryEditCU.SetCompany("Receiving Company");
                lvCustEntryEditCU.RUN(CustLedgEntry);
                //**4PS.en
              END;
          END;
        "Account Type"::Vendor:
          BEGIN
            VendLedgEntry.SETCURRENTKEY("Document No.");
            VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
            VendLedgEntry.SETRANGE("Vendor No.","Account No.");
            VendLedgEntry.SETRANGE(Open,TRUE);
            IF VendLedgEntry.FINDFIRST THEN
              IF VendLedgEntry."Amount to Apply" = 0 THEN  BEGIN
                VendLedgEntry.CALCFIELDS("Remaining Amount");
                VendLedgEntry."Amount to Apply" := VendLedgEntry."Remaining Amount";
                CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",VendLedgEntry);
              END;
          END;
        "Account Type"::Employee:
          BEGIN
            EmplLedgEntry.SETCURRENTKEY("Document No.");
            EmplLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
            EmplLedgEntry.SETRANGE("Employee No.","Account No.");
            EmplLedgEntry.SETRANGE(Open,TRUE);
            IF EmplLedgEntry.FINDFIRST THEN
              IF EmplLedgEntry."Amount to Apply" = 0 THEN BEGIN
                EmplLedgEntry.CALCFIELDS("Remaining Amount");
                EmplLedgEntry."Amount to Apply" := EmplLedgEntry."Remaining Amount";
                CODEUNIT.RUN(CODEUNIT::"Empl. Entry-Edit",EmplLedgEntry);
              END;
          END;
      END;
    END;

    [External]
    PROCEDURE ValidateApplyRequirements@21(TempGenJnlLine@1000 : TEMPORARY Record 81);
    VAR
      IsHandled@1001 : Boolean;
    BEGIN
      IF (TempGenJnlLine."Bal. Account Type" = TempGenJnlLine."Bal. Account Type"::Customer) OR
         (TempGenJnlLine."Bal. Account Type" = TempGenJnlLine."Bal. Account Type"::Vendor) OR
         (TempGenJnlLine."Bal. Account Type" = TempGenJnlLine."Bal. Account Type"::Employee)
      THEN
        CODEUNIT.RUN(CODEUNIT::"Exchange Acc. G/L Journal Line",TempGenJnlLine);

      OnBeforeValidateApplyRequirements(TempGenJnlLine,IsHandled);
      IF IsHandled THEN
        EXIT;

      CASE TempGenJnlLine."Account Type" OF
        TempGenJnlLine."Account Type"::Customer:
          IF TempGenJnlLine."Applies-to ID" <> '' THEN BEGIN
            CustLedgEntry.CHANGECOMPANY("Receiving Company"); //**4PS.n
            CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open);
            CustLedgEntry.SETRANGE("Customer No.",TempGenJnlLine."Account No.");
            CustLedgEntry.SETRANGE("Applies-to ID",TempGenJnlLine."Applies-to ID");
            CustLedgEntry.SETRANGE(Open,TRUE);
            IF CustLedgEntry.FINDSET THEN
              REPEAT
                CheckIfPostingDateIsEarlier(
                  TempGenJnlLine,CustLedgEntry."Posting Date",CustLedgEntry."Document Type",CustLedgEntry."Document No.");
              UNTIL CustLedgEntry.NEXT = 0;
          END ELSE
            IF TempGenJnlLine."Applies-to Doc. No." <> '' THEN BEGIN
              CustLedgEntry.SETCURRENTKEY("Document No.");
              CustLedgEntry.SETRANGE("Document No.",TempGenJnlLine."Applies-to Doc. No.");
              IF TempGenJnlLine."Applies-to Doc. Type" <> TempGenJnlLine."Applies-to Doc. Type"::" " THEN
                CustLedgEntry.SETRANGE("Document Type",TempGenJnlLine."Applies-to Doc. Type");
              CustLedgEntry.SETRANGE("Customer No.",TempGenJnlLine."Account No.");
              CustLedgEntry.SETRANGE(Open,TRUE);
              IF CustLedgEntry.FINDFIRST THEN
                CheckIfPostingDateIsEarlier(
                  TempGenJnlLine,CustLedgEntry."Posting Date",CustLedgEntry."Document Type",CustLedgEntry."Document No.");
            END;
        TempGenJnlLine."Account Type"::Vendor:
          IF TempGenJnlLine."Applies-to ID" <> '' THEN BEGIN
            VendLedgEntry.SETCURRENTKEY("Vendor No.","Applies-to ID",Open);
            VendLedgEntry.SETRANGE("Vendor No.",TempGenJnlLine."Account No.");
            VendLedgEntry.SETRANGE("Applies-to ID",TempGenJnlLine."Applies-to ID");
            VendLedgEntry.SETRANGE(Open,TRUE);
            IF VendLedgEntry.FINDSET THEN
              REPEAT
                CheckIfPostingDateIsEarlier(
                  TempGenJnlLine,VendLedgEntry."Posting Date",VendLedgEntry."Document Type",VendLedgEntry."Document No.");
              UNTIL VendLedgEntry.NEXT = 0;
          END ELSE
            IF TempGenJnlLine."Applies-to Doc. No." <> '' THEN BEGIN
              VendLedgEntry.SETCURRENTKEY("Document No.");
              VendLedgEntry.SETRANGE("Document No.",TempGenJnlLine."Applies-to Doc. No.");
              IF TempGenJnlLine."Applies-to Doc. Type" <> TempGenJnlLine."Applies-to Doc. Type"::" " THEN
                VendLedgEntry.SETRANGE("Document Type",TempGenJnlLine."Applies-to Doc. Type");
              VendLedgEntry.SETRANGE("Vendor No.",TempGenJnlLine."Account No.");
              VendLedgEntry.SETRANGE(Open,TRUE);
              IF VendLedgEntry.FINDFIRST THEN
                CheckIfPostingDateIsEarlier(
                  TempGenJnlLine,VendLedgEntry."Posting Date",VendLedgEntry."Document Type",VendLedgEntry."Document No.");
            END;
        TempGenJnlLine."Account Type"::Employee:
          IF TempGenJnlLine."Applies-to ID" <> '' THEN BEGIN
            EmplLedgEntry.SETCURRENTKEY("Employee No.","Applies-to ID",Open);
            EmplLedgEntry.SETRANGE("Employee No.",TempGenJnlLine."Account No.");
            EmplLedgEntry.SETRANGE("Applies-to ID",TempGenJnlLine."Applies-to ID");
            EmplLedgEntry.SETRANGE(Open,TRUE);
            IF EmplLedgEntry.FINDSET THEN
              REPEAT
                CheckIfPostingDateIsEarlier(
                  TempGenJnlLine,EmplLedgEntry."Posting Date",EmplLedgEntry."Document Type",EmplLedgEntry."Document No.");
              UNTIL EmplLedgEntry.NEXT = 0;
          END ELSE
            IF TempGenJnlLine."Applies-to Doc. No." <> '' THEN BEGIN
              EmplLedgEntry.SETCURRENTKEY("Document No.");
              EmplLedgEntry.SETRANGE("Document No.",TempGenJnlLine."Applies-to Doc. No.");
              IF TempGenJnlLine."Applies-to Doc. Type" <> EmplLedgEntry."Applies-to Doc. Type"::" " THEN
                EmplLedgEntry.SETRANGE("Document Type",TempGenJnlLine."Applies-to Doc. Type");
              EmplLedgEntry.SETRANGE("Employee No.",TempGenJnlLine."Account No.");
              EmplLedgEntry.SETRANGE(Open,TRUE);
              IF EmplLedgEntry.FINDFIRST THEN
                CheckIfPostingDateIsEarlier(
                  TempGenJnlLine,EmplLedgEntry."Posting Date",EmplLedgEntry."Document Type",EmplLedgEntry."Document No.");
            END;
      END;

      OnAfterValidateApplyRequirements(TempGenJnlLine);
    END;

    LOCAL PROCEDURE UpdateCountryCodeAndVATRegNo@25(No@1000 : Code[20]);
    VAR
      Cust@1001 : Record 18;
      Vend@1002 : Record 23;
    BEGIN
      IF No = '' THEN BEGIN
        "Country/Region Code" := '';
        "VAT Registration No." := '';
        EXIT;
      END;

      ReadGLSetup;
      CASE TRUE OF
        ("Account Type" = "Account Type"::Customer) OR ("Bal. Account Type" = "Bal. Account Type"::Customer):
          BEGIN
            Cust.CHANGECOMPANY("Receiving Company"); //**4PS.n
            Cust.GET(No);
            "Country/Region Code" := Cust."Country/Region Code";
            "VAT Registration No." := Cust."VAT Registration No.";
          END;
        ("Account Type" = "Account Type"::Vendor) OR ("Bal. Account Type" = "Bal. Account Type"::Vendor):
          BEGIN
            Vend.GET(No);
            "Country/Region Code" := Vend."Country/Region Code";
            "VAT Registration No." := Vend."VAT Registration No.";
          END;
      END;
    END;

    [External]
    PROCEDURE JobTaskIsSet@28() : Boolean;
    BEGIN
      EXIT(("Job No." <> '') AND ("Job Task No." <> '') AND ("Account Type" = "Account Type"::"G/L Account"));
    END;

    [External]
    PROCEDURE CreateTempJobJnlLine@27();
    VAR
      TmpJobJnlOverallCurrencyFactor@1001 : Decimal;
    BEGIN
      OnBeforeCreateTempJobJnlLine(TempJobJnlLine,Rec,xRec,CurrFieldNo);

      TESTFIELD("Posting Date");
      CLEAR(TempJobJnlLine);
      TempJobJnlLine.DontCheckStdCost;
      TempJobJnlLine.VALIDATE("Job No.","Job No.");
      TempJobJnlLine.VALIDATE("Job Task No.","Job Task No.");
      IF CurrFieldNo <> FIELDNO("Posting Date") THEN
        TempJobJnlLine.VALIDATE("Posting Date","Posting Date")
      ELSE
        TempJobJnlLine.VALIDATE("Posting Date",xRec."Posting Date");
      TempJobJnlLine.VALIDATE(Type,TempJobJnlLine.Type::"G/L Account");
      IF "Job Currency Code" <> '' THEN BEGIN
        IF "Posting Date" = 0D THEN
          CurrencyDate := WORKDATE
        ELSE
          CurrencyDate := "Posting Date";

        IF "Currency Code" = "Job Currency Code" THEN
          "Job Currency Factor" := "Currency Factor"
        ELSE
        //"Job Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Job Currency Code"); //**4PS.o
          "Job Currency Factor" := CurrExchRate.ExchangeRate(0, '', CurrencyDate,"Job Currency Code",FALSE); //**4PS.n
        TempJobJnlLine.SetCurrencyFactor("Job Currency Factor");
      END;
      TempJobJnlLine.VALIDATE("No.","Account No.");
      TempJobJnlLine.VALIDATE(Quantity,"Job Quantity");

      IF "Currency Factor" = 0 THEN BEGIN
        IF "Job Currency Factor" = 0 THEN
          TmpJobJnlOverallCurrencyFactor := 1
        ELSE
          TmpJobJnlOverallCurrencyFactor := "Job Currency Factor";
      END ELSE BEGIN
        IF "Job Currency Factor" = 0 THEN
          TmpJobJnlOverallCurrencyFactor := 1 / "Currency Factor"
        ELSE
          TmpJobJnlOverallCurrencyFactor := "Job Currency Factor" / "Currency Factor"
      END;

      IF "Job Quantity" <> 0 THEN
        TempJobJnlLine.VALIDATE("Unit Cost",((Amount - "VAT Amount") * TmpJobJnlOverallCurrencyFactor) / "Job Quantity");

      IF (xRec."Account No." = "Account No.") AND (xRec."Job Task No." = "Job Task No.") AND ("Job Unit Price" <> 0) THEN BEGIN
        IF TempJobJnlLine."Cost Factor" = 0 THEN
          TempJobJnlLine."Unit Price" := xRec."Job Unit Price";
        TempJobJnlLine."Line Amount" := xRec."Job Line Amount";
        TempJobJnlLine."Line Discount %" := xRec."Job Line Discount %";
        TempJobJnlLine."Line Discount Amount" := xRec."Job Line Discount Amount";
        TempJobJnlLine.VALIDATE("Unit Price");
      END;

      OnAfterCreateTempJobJnlLine(TempJobJnlLine,Rec,xRec,CurrFieldNo);
    END;

    [External]
    PROCEDURE UpdatePricesFromJobJnlLine@22();
    BEGIN
      "Job Unit Price" := TempJobJnlLine."Unit Price";
      "Job Total Price" := TempJobJnlLine."Total Price";
      "Job Line Amount" := TempJobJnlLine."Line Amount";
      "Job Line Discount Amount" := TempJobJnlLine."Line Discount Amount";
      "Job Unit Cost" := TempJobJnlLine."Unit Cost";
      "Job Total Cost" := TempJobJnlLine."Total Cost";
      "Job Line Discount %" := TempJobJnlLine."Line Discount %";

      "Job Unit Price (LCY)" := TempJobJnlLine."Unit Price (LCY)";
      "Job Total Price (LCY)" := TempJobJnlLine."Total Price (LCY)";
      "Job Line Amount (LCY)" := TempJobJnlLine."Line Amount (LCY)";
      "Job Line Disc. Amount (LCY)" := TempJobJnlLine."Line Discount Amount (LCY)";
      "Job Unit Cost (LCY)" := TempJobJnlLine."Unit Cost (LCY)";
      "Job Total Cost (LCY)" := TempJobJnlLine."Total Cost (LCY)";

      OnAfterUpdatePricesFromJobJnlLine(Rec,TempJobJnlLine);
    END;

    [External]
    PROCEDURE SetHideValidation@23(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    LOCAL PROCEDURE GetDefaultICPartnerGLAccNo@1058() : Code[20];
    VAR
      GLAcc@1001 : Record 15;
      GLAccNo@1002 : Code[20];
    BEGIN
      IF "IC Partner Code" <> '' THEN BEGIN
        IF "Account Type" = "Account Type"::"G/L Account" THEN
          GLAccNo := "Account No."
        ELSE
          GLAccNo := "Bal. Account No.";
        IF GLAcc.GET(GLAccNo) THEN
          EXIT(GLAcc."Default IC Partner G/L Acc. No")
      END;
    END;

    [External]
    PROCEDURE IsApplied@30() : Boolean;
    BEGIN
      IF "Applies-to Doc. No." <> '' THEN
        EXIT(TRUE);
      IF "Applies-to ID" <> '' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    [External]
    PROCEDURE DataCaption@29() : Text[250];
    VAR
      GenJnlBatch@1000 : Record 232;
    BEGIN
      IF GenJnlBatch.GET("Journal Template Name","Journal Batch Name") THEN
        EXIT(GenJnlBatch.Name + '-' + GenJnlBatch.Description);
    END;

    LOCAL PROCEDURE ReadGLSetup@31();
    BEGIN
      IF NOT GLSetupRead THEN BEGIN
        GLSetup.GET;
        GLSetupRead := TRUE;
      END;
    END;

    [External]
    PROCEDURE GetCustLedgerEntry@33();
    BEGIN
      IF ("Account Type" = "Account Type"::Customer) AND ("Account No." = '') AND
         ("Applies-to Doc. No." <> '') AND (Amount = 0)
      THEN BEGIN
        CustLedgEntry.RESET;
        CustLedgEntry.SETRANGE("Document Type","Document Type"::Invoice);
        // PEB0026
        gBaseTables.T81_AppliesCustomerCredit(Rec,CustLedgEntry);
        // 0026
        CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        CustLedgEntry.SETRANGE(Open,TRUE);
        IF NOT CustLedgEntry.FINDFIRST THEN
          ERROR(NotExistErr,"Applies-to Doc. No.");

        VALIDATE("Account No.",CustLedgEntry."Customer No.");
        OnGetCustLedgerEntryOnAfterAssignCustomerNo(Rec,CustLedgEntry);

        CustLedgEntry.CALCFIELDS("Remaining Amount");

        IF "Posting Date" <= CustLedgEntry."Pmt. Discount Date" THEN
          Amount := -(CustLedgEntry."Remaining Amount" - CustLedgEntry."Remaining Pmt. Disc. Possible")
        ELSE
          Amount := -CustLedgEntry."Remaining Amount";

        IF "Currency Code" <> CustLedgEntry."Currency Code" THEN
          UpdateCurrencyCode(CustLedgEntry."Currency Code");

        SetAppliesToFields(
          CustLedgEntry."Document Type",CustLedgEntry."Document No.",CustLedgEntry."External Document No.");

        GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
        IF GenJnlBatch."Bal. Account No." <> '' THEN BEGIN
          "Bal. Account Type" := GenJnlBatch."Bal. Account Type";
          VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
        END ELSE
          VALIDATE(Amount);

        OnAfterGetCustLedgerEntry(Rec,CustLedgEntry);
      END;
    END;

    [External]
    PROCEDURE GetVendLedgerEntry@37();
    BEGIN
      IF ("Account Type" = "Account Type"::Vendor) AND ("Account No." = '') AND
         ("Applies-to Doc. No." <> '') AND (Amount = 0)
      THEN BEGIN
        VendLedgEntry.RESET;
        VendLedgEntry.SETRANGE("Document Type","Document Type"::Invoice);
        // PEB0026
        gBaseTables.T81_AppliesVendorCredit(Rec,VendLedgEntry);
        // 0026
        VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        VendLedgEntry.SETRANGE(Open,TRUE);
        IF NOT VendLedgEntry.FINDFIRST THEN
          ERROR(NotExistErr,"Applies-to Doc. No.");

        VALIDATE("Account No.",VendLedgEntry."Vendor No.");
        OnGetVendLedgerEntryOnAfterAssignVendorNo(Rec,VendLedgEntry);

        VendLedgEntry.CALCFIELDS("Remaining Amount");

        IF "Posting Date" <= VendLedgEntry."Pmt. Discount Date" THEN
          Amount := -(VendLedgEntry."Remaining Amount" - VendLedgEntry."Remaining Pmt. Disc. Possible")
        ELSE
          Amount := -VendLedgEntry."Remaining Amount";

        IF "Currency Code" <> VendLedgEntry."Currency Code" THEN
          UpdateCurrencyCode(VendLedgEntry."Currency Code");

        SetAppliesToFields(
          VendLedgEntry."Document Type",VendLedgEntry."Document No.",VendLedgEntry."External Document No.");

        GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
        IF GenJnlBatch."Bal. Account No." <> '' THEN BEGIN
          "Bal. Account Type" := GenJnlBatch."Bal. Account Type";
          VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
        END ELSE
          VALIDATE(Amount);

        OnAfterGetVendLedgerEntry(Rec,VendLedgEntry);
      END;
    END;

    [External]
    PROCEDURE GetEmplLedgerEntry@183();
    BEGIN
      IF ("Account Type" = "Account Type"::Employee) AND ("Account No." = '') AND
         ("Applies-to Doc. No." <> '') AND (Amount = 0)
      THEN BEGIN
        EmplLedgEntry.RESET;
        EmplLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        EmplLedgEntry.SETRANGE(Open,TRUE);
        IF NOT EmplLedgEntry.FINDFIRST THEN
          ERROR(NotExistErr,"Applies-to Doc. No.");

        VALIDATE("Account No.",EmplLedgEntry."Employee No.");
        EmplLedgEntry.CALCFIELDS("Remaining Amount");

        Amount := -EmplLedgEntry."Remaining Amount";

        SetAppliesToFields(EmplLedgEntry."Document Type",EmplLedgEntry."Document No.",'');

        GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
        IF GenJnlBatch."Bal. Account No." <> '' THEN BEGIN
          "Bal. Account Type" := GenJnlBatch."Bal. Account Type";
          VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
        END ELSE
          VALIDATE(Amount);
      END;

      OnAfterGetEmplLedgerEntry(Rec,EmplLedgEntry);
    END;

    LOCAL PROCEDURE UpdateCurrencyCode@143(NewCurrencyCode@1000 : Code[10]);
    VAR
      ConfirmManagement@1003 : Codeunit 27;
      FromCurrencyCode@1002 : Code[10];
      ToCurrencyCode@1001 : Code[10];
    BEGIN
      FromCurrencyCode := GetShowCurrencyCode("Currency Code");
      ToCurrencyCode := GetShowCurrencyCode(NewCurrencyCode);
      IF NOT ConfirmManagement.ConfirmProcess(
           STRSUBSTNO(ChangeCurrencyQst,FromCurrencyCode,ToCurrencyCode),TRUE)
      THEN
        ERROR(UpdateInterruptedErr);
      VALIDATE("Currency Code",NewCurrencyCode);
    END;

    LOCAL PROCEDURE SetAppliesToFields@140(DocType@1000 : Option;DocNo@1001 : Code[20];ExtDocNo@1002 : Code[35]);
    BEGIN
      UpdateDocumentTypeAndAppliesTo(DocType,DocNo);

      IF ("Applies-to Doc. Type" = "Applies-to Doc. Type"::Invoice) AND
         ("Document Type" = "Document Type"::Payment)
      THEN
        "Applies-to Ext. Doc. No." := ExtDocNo;
    END;

    LOCAL PROCEDURE CustVendAccountNosModified@32() : Boolean;
    BEGIN
      EXIT(
        (("Bal. Account No." <> xRec."Bal. Account No.") AND
         ("Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor])) OR
        (("Account No." <> xRec."Account No.") AND
         ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor])))
    END;

    LOCAL PROCEDURE CheckPaymentTolerance@34();
    BEGIN
      IF Amount <> 0 THEN
        IF ("Bal. Account No." <> xRec."Bal. Account No.") OR ("Account No." <> xRec."Account No.") THEN
          PaymentToleranceMgt.PmtTolGenJnl(Rec);
    END;

    [External]
    PROCEDURE IncludeVATAmount@38() : Boolean;
    BEGIN
      EXIT(
        ("VAT Posting" = "VAT Posting"::"Manual VAT Entry") AND
        ("VAT Calculation Type" <> "VAT Calculation Type"::"Reverse Charge VAT"));
    END;

    [External]
    PROCEDURE ConvertAmtFCYToLCYForSourceCurrency@39(Amount@1000 : Decimal) : Decimal;
    VAR
      Currency@1001 : Record 4;
      CurrExchRate@1003 : Record 330;
      CurrencyFactor@1002 : Decimal;
    BEGIN
      IF (Amount = 0) OR ("Source Currency Code" = '') THEN
        EXIT(Amount);

      Currency.GET("Source Currency Code");
      //CurrencyFactor := CurrExchRate.ExchangeRate("Posting Date","Source Currency Code"); //**4PS.o
      CurrencyFactor := CurrExchRate.ExchangeRate(0,'',"Posting Date","Source Currency Code",FALSE); //**4PS.n
      EXIT(
        ROUND(
          CurrExchRate.ExchangeAmtFCYToLCY(
          //"Posting Date","Source Currency Code",Amount,CurrencyFactor), //**4PS.o
            0,'',"Posting Date","Source Currency Code",Amount,CurrencyFactor,FALSE), //**4PS.n
          Currency."Amount Rounding Precision"));
    END;

    PROCEDURE CopyDimensionFromAutoAccLine@1070000(AutoAccLine@1070002 : Record 11128014);
    VAR
      DimMgt@1070000 : Codeunit 408;
      DimensionSetIDArr@1070001 : ARRAY [10] OF Integer;
    BEGIN
      //NAVSE
      IF AutoAccLine."Dimension Set ID" <> 0 THEN
        IF "Dimension Set ID" = 0 THEN BEGIN
          "Dimension Set ID" := AutoAccLine."Dimension Set ID";
          DimMgt.UpdateGlobalDimFromDimSetID(
            "Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
        END ELSE BEGIN
          DimensionSetIDArr[1] := "Dimension Set ID";
          DimensionSetIDArr[2] := AutoAccLine."Dimension Set ID";
          "Dimension Set ID" :=
            DimMgt.GetCombinedDimensionSetID(
              DimensionSetIDArr,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
        END;
    END;

    [External]
    PROCEDURE MatchSingleLedgerEntry@40();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Match General Journal Lines",Rec);
    END;

    [External]
    PROCEDURE GetStyle@41() : Text;
    BEGIN
      IF "Applied Automatically" THEN
        EXIT('Favorable')
    END;

    [External]
    PROCEDURE GetOverdueDateInteractions@75(VAR OverdueWarningText@1001 : Text) : Text;
    VAR
      DueDate@1000 : Date;
    BEGIN
      DueDate := GetAppliesToDocDueDate;
      OverdueWarningText := '';
      IF (DueDate <> 0D) AND (DueDate < "Posting Date") THEN BEGIN
        OverdueWarningText := DueDateMsg;
        EXIT('Unfavorable');
      END;
      EXIT('');
    END;

    [External]
    PROCEDURE ClearDataExchangeEntries@42(DeleteHeaderEntries@1002 : Boolean);
    VAR
      DataExchField@1001 : Record 1221;
      GenJournalLine@1000 : Record 81;
    BEGIN
      IF "Data Exch. Entry No." = 0 THEN
        EXIT;

      DataExchField.DeleteRelatedRecords("Data Exch. Entry No.","Data Exch. Line No.");

      GenJournalLine.SETRANGE("Journal Template Name","Journal Template Name");
      GenJournalLine.SETRANGE("Journal Batch Name","Journal Batch Name");
      GenJournalLine.SETRANGE("Data Exch. Entry No.","Data Exch. Entry No.");
      GenJournalLine.SETFILTER("Line No.",'<>%1',"Line No.");
      IF GenJournalLine.ISEMPTY OR DeleteHeaderEntries THEN
        DataExchField.DeleteRelatedRecords("Data Exch. Entry No.",0);
    END;

    [External]
    PROCEDURE ClearAppliedGenJnlLine@49();
    VAR
      GenJournalLine@1000 : Record 81;
    BEGIN
      IF "Applies-to Doc. No." = '' THEN
        EXIT;
      GenJournalLine.SETRANGE("Journal Template Name","Journal Template Name");
      GenJournalLine.SETRANGE("Journal Batch Name","Journal Batch Name");
      GenJournalLine.SETFILTER("Line No.",'<>%1',"Line No.");
      GenJournalLine.SETRANGE("Document Type","Applies-to Doc. Type");
      GenJournalLine.SETRANGE("Document No.","Applies-to Doc. No.");
      IF NOT GenJournalLine.ISEMPTY THEN BEGIN
        GenJournalLine.MODIFYALL("Applied Automatically",FALSE);
        GenJournalLine.MODIFYALL("Account Type",GenJournalLine."Account Type"::"G/L Account");
        GenJournalLine.MODIFYALL("Account No.",'');
      END;
    END;

    [External]
    PROCEDURE GetIncomingDocumentURL@50() : Text[1000];
    VAR
      IncomingDocument@1000 : Record 130;
    BEGIN
      IF "Incoming Document Entry No." = 0 THEN
        EXIT('');

      IncomingDocument.GET("Incoming Document Entry No.");
      EXIT(IncomingDocument.GetURL);
    END;

    [External]
    PROCEDURE InsertPaymentFileError@64(Text@1001 : Text);
    VAR
      PaymentJnlExportErrorText@1000 : Record 1228;
    BEGIN
      PaymentJnlExportErrorText.CreateNew(Rec,Text,'','');
    END;

    [External]
    PROCEDURE InsertPaymentFileErrorWithDetails@83(ErrorText@1001 : Text;AddnlInfo@1002 : Text;ExtSupportInfo@1003 : Text);
    VAR
      PaymentJnlExportErrorText@1000 : Record 1228;
    BEGIN
      PaymentJnlExportErrorText.CreateNew(Rec,ErrorText,AddnlInfo,ExtSupportInfo);
    END;

    [External]
    PROCEDURE DeletePaymentFileBatchErrors@67();
    VAR
      PaymentJnlExportErrorText@1000 : Record 1228;
    BEGIN
      PaymentJnlExportErrorText.DeleteJnlBatchErrors(Rec);
    END;

    [External]
    PROCEDURE DeletePaymentFileErrors@61();
    VAR
      PaymentJnlExportErrorText@1000 : Record 1228;
    BEGIN
      PaymentJnlExportErrorText.DeleteJnlLineErrors(Rec);
    END;

    [External]
    PROCEDURE HasPaymentFileErrors@24() : Boolean;
    VAR
      PaymentJnlExportErrorText@1000 : Record 1228;
    BEGIN
      EXIT(PaymentJnlExportErrorText.JnlLineHasErrors(Rec));
    END;

    [External]
    PROCEDURE HasPaymentFileErrorsInBatch@65() : Boolean;
    VAR
      PaymentJnlExportErrorText@1000 : Record 1228;
    BEGIN
      EXIT(PaymentJnlExportErrorText.JnlBatchHasErrors(Rec));
    END;

    LOCAL PROCEDURE UpdateDescription@43(Name@1000 : Text[100]);
    BEGIN
      IF NOT IsAdHocDescription THEN
        Description := Name;
    END;

    LOCAL PROCEDURE IsAdHocDescription@44() : Boolean;
    VAR
      GLAccount@1000 : Record 15;
      Customer@1001 : Record 18;
      Vendor@1002 : Record 23;
      BankAccount@1003 : Record 270;
      FixedAsset@1004 : Record 5600;
      ICPartner@1005 : Record 413;
      Employee@1006 : Record 5200;
    BEGIN
      IF Description = '' THEN
        EXIT(FALSE);
      IF xRec."Account No." = '' THEN
        EXIT(TRUE);

      CASE xRec."Account Type" OF
        xRec."Account Type"::"G/L Account":
          EXIT(GLAccount.GET(xRec."Account No.") AND (GLAccount.Name <> Description));
        xRec."Account Type"::Customer:
          EXIT(Customer.GET(xRec."Account No.") AND (Customer.Name <> Description));
        xRec."Account Type"::Vendor:
          EXIT(Vendor.GET(xRec."Account No.") AND (Vendor.Name <> Description));
        xRec."Account Type"::"Bank Account":
          EXIT(BankAccount.GET(xRec."Account No.") AND (BankAccount.Name <> Description));
        xRec."Account Type"::"Fixed Asset":
          EXIT(FixedAsset.GET(xRec."Account No.") AND (FixedAsset.Description <> Description));
        xRec."Account Type"::"IC Partner":
          EXIT(ICPartner.GET(xRec."Account No.") AND (ICPartner.Name <> Description));
        xRec."Account Type"::Employee:
          EXIT(Employee.GET(xRec."Account No.") AND (Employee.FullName <> Description));
      END;
      EXIT(FALSE);
    END;

    [External]
    PROCEDURE GetAppliesToDocEntryNo@63() : Integer;
    VAR
      CustLedgEntry@1000 : Record 21;
      VendLedgEntry@1001 : Record 25;
      AccType@1003 : 'G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee';
      AccNo@1002 : Code[20];
    BEGIN
      GetAccTypeAndNo(Rec,AccType,AccNo);
      CASE AccType OF
        AccType::Customer:
          BEGIN
            GetAppliesToDocCustLedgEntry(CustLedgEntry,AccNo);
            EXIT(CustLedgEntry."Entry No.");
          END;
        AccType::Vendor:
          BEGIN
            GetAppliesToDocVendLedgEntry(VendLedgEntry,AccNo);
            EXIT(VendLedgEntry."Entry No.");
          END;
        AccType::Employee:
          BEGIN
            GetAppliesToDocEmplLedgEntry(EmplLedgEntry,AccNo);
            EXIT(EmplLedgEntry."Entry No.");
          END;
      END;
    END;

    [External]
    PROCEDURE GetAppliesToDocDueDate@62() : Date;
    VAR
      CustLedgEntry@1000 : Record 21;
      VendLedgEntry@1001 : Record 25;
      AccType@1003 : 'G/L Account,Customer,Vendor,Bank Account,Fixed Asset';
      AccNo@1002 : Code[20];
    BEGIN
      GetAccTypeAndNo(Rec,AccType,AccNo);
      CASE AccType OF
        AccType::Customer:
          BEGIN
            GetAppliesToDocCustLedgEntry(CustLedgEntry,AccNo);
            EXIT(CustLedgEntry."Due Date");
          END;
        AccType::Vendor:
          BEGIN
            GetAppliesToDocVendLedgEntry(VendLedgEntry,AccNo);
            EXIT(VendLedgEntry."Due Date");
          END;
      END;
    END;

    LOCAL PROCEDURE GetAppliesToDocCustLedgEntry@60(VAR CustLedgEntry@1000 : Record 21;AccNo@1001 : Code[20]);
    BEGIN
      CustLedgEntry.SETRANGE("Customer No.",AccNo);
      CustLedgEntry.SETRANGE(Open,TRUE);
      IF "Applies-to Doc. No." <> '' THEN BEGIN
        CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        IF CustLedgEntry.FINDFIRST THEN;
      END ELSE
        IF "Applies-to ID" <> '' THEN BEGIN
          CustLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
          IF CustLedgEntry.FINDFIRST THEN;
        END;
    END;

    LOCAL PROCEDURE GetAppliesToDocVendLedgEntry@53(VAR VendLedgEntry@1000 : Record 25;AccNo@1001 : Code[20]);
    BEGIN
      //>>4PSSE 130926
      VendLedgEntry.SETRANGE("Vendor No.");
      VendLedgEntry.SETRANGE("Document Type");
      VendLedgEntry.SETRANGE("Document No.");
      VendLedgEntry.SETRANGE("Applies-to ID");
      VendLedgEntry.SETRANGE(Positive);
      //<<4PSSE

      VendLedgEntry.SETCURRENTKEY("Document No.");
      VendLedgEntry.SETRANGE("Vendor No.",AccNo);
      VendLedgEntry.SETRANGE(Open,TRUE);
      IF "Applies-to Doc. No." <> '' THEN BEGIN
        VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        IF VendLedgEntry.FINDFIRST THEN;
      END ELSE
        IF "Applies-to ID" <> '' THEN BEGIN
          VendLedgEntry.SETCURRENTKEY("Vendor No.","Applies-to ID",Open,Positive,"Due Date");
          VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
          IF VendLedgEntry.FINDFIRST THEN;
        END;
    END;

    LOCAL PROCEDURE GetAppliesToDocEmplLedgEntry@180(VAR EmplLedgEntry@1000 : Record 5222;AccNo@1001 : Code[20]);
    BEGIN
      EmplLedgEntry.SETRANGE("Employee No.",AccNo);
      EmplLedgEntry.SETRANGE(Open,TRUE);
      IF "Applies-to Doc. No." <> '' THEN BEGIN
        EmplLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
        EmplLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
        IF EmplLedgEntry.FINDFIRST THEN;
      END ELSE
        IF "Applies-to ID" <> '' THEN BEGIN
          EmplLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
          IF EmplLedgEntry.FINDFIRST THEN;
        END;
    END;

    LOCAL PROCEDURE SetJournalLineFieldsFromApplication@51();
    VAR
      AccType@1005 : 'G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee';
      AccNo@1004 : Code[20];
    BEGIN
      "Exported to Payment File" := FALSE;
      GetAccTypeAndNo(Rec,AccType,AccNo);
      CASE AccType OF
        AccType::Customer:
          IF "Applies-to ID" <> '' THEN BEGIN
            IF FindFirstCustLedgEntryWithAppliesToID(AccNo,"Applies-to ID") THEN BEGIN
              CustLedgEntry.SETRANGE("Exported to Payment File",TRUE);
              "Exported to Payment File" := CustLedgEntry.FINDFIRST;
            END
          END ELSE
            IF "Applies-to Doc. No." <> '' THEN
              IF FindFirstCustLedgEntryWithAppliesToDocNo(AccNo,"Applies-to Doc. No.") THEN BEGIN
                "Exported to Payment File" := CustLedgEntry."Exported to Payment File";
                "Applies-to Ext. Doc. No." := CustLedgEntry."External Document No.";
              END;
        AccType::Vendor:
          IF "Applies-to ID" <> '' THEN BEGIN
            IF FindFirstVendLedgEntryWithAppliesToID(AccNo,"Applies-to ID") THEN BEGIN
              VendLedgEntry.SETRANGE("Exported to Payment File",TRUE);
              "Exported to Payment File" := VendLedgEntry.FINDFIRST;
            END
          END ELSE
            IF "Applies-to Doc. No." <> '' THEN
              IF FindFirstVendLedgEntryWithAppliesToDocNo(AccNo,"Applies-to Doc. No.") THEN BEGIN
                "Exported to Payment File" := VendLedgEntry."Exported to Payment File";
                "Applies-to Ext. Doc. No." := VendLedgEntry."External Document No.";
              END;
        AccType::Employee:
          IF "Applies-to ID" <> '' THEN BEGIN
            IF FindFirstEmplLedgEntryWithAppliesToID(AccNo,"Applies-to ID") THEN BEGIN
              EmplLedgEntry.SETRANGE("Exported to Payment File",TRUE);
              "Exported to Payment File" := EmplLedgEntry.FINDFIRST;
            END
          END ELSE
            IF "Applies-to Doc. No." <> '' THEN
              IF FindFirstEmplLedgEntryWithAppliesToDocNo(AccNo,"Applies-to Doc. No.") THEN
                "Exported to Payment File" := EmplLedgEntry."Exported to Payment File";
      END;

      OnAfterSetJournalLineFieldsFromApplication(Rec,AccType,AccNo,xRec);
    END;

    LOCAL PROCEDURE GetAccTypeAndNo@52(GenJnlLine2@1002 : Record 81;VAR AccType@1000 : Option;VAR AccNo@1001 : Code[20]);
    BEGIN
      IF GenJnlLine2."Bal. Account Type" IN
         [GenJnlLine2."Bal. Account Type"::Customer,GenJnlLine2."Bal. Account Type"::Vendor,GenJnlLine2."Bal. Account Type"::Employee]
      THEN BEGIN
        AccType := GenJnlLine2."Bal. Account Type";
        AccNo := GenJnlLine2."Bal. Account No.";
      END ELSE BEGIN
        AccType := GenJnlLine2."Account Type";
        AccNo := GenJnlLine2."Account No.";
      END;
    END;

    LOCAL PROCEDURE FindFirstCustLedgEntryWithAppliesToID@54(AccNo@1000 : Code[20];AppliesToID@1001 : Code[50]) : Boolean;
    BEGIN
      CustLedgEntry.RESET;
      CustLedgEntry.CHANGECOMPANY("Receiving Company"); //**4PS.n
      CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open);
      CustLedgEntry.SETRANGE("Customer No.",AccNo);
      CustLedgEntry.SETRANGE("Applies-to ID",AppliesToID);
      CustLedgEntry.SETRANGE(Open,TRUE);
      EXIT(CustLedgEntry.FINDFIRST)
    END;

    LOCAL PROCEDURE FindFirstCustLedgEntryWithAppliesToDocNo@55(AccNo@1000 : Code[20];AppliestoDocNo@1001 : Code[20]) : Boolean;
    BEGIN
      CustLedgEntry.RESET;
      CustLedgEntry.CHANGECOMPANY("Receiving Company"); //**4PS.n
      CustLedgEntry.SETCURRENTKEY("Document No.");
      CustLedgEntry.SETRANGE("Document No.",AppliestoDocNo);
      CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
      CustLedgEntry.SETRANGE("Customer No.",AccNo);
      CustLedgEntry.SETRANGE(Open,TRUE);
      EXIT(CustLedgEntry.FINDFIRST)
    END;

    LOCAL PROCEDURE FindFirstVendLedgEntryWithAppliesToID@58(AccNo@1000 : Code[20];AppliesToID@1001 : Code[50]) : Boolean;
    BEGIN
      VendLedgEntry.RESET;
      VendLedgEntry.SETCURRENTKEY("Vendor No.","Applies-to ID",Open);
      VendLedgEntry.SETRANGE("Vendor No.",AccNo);
      VendLedgEntry.SETRANGE("Applies-to ID",AppliesToID);
      VendLedgEntry.SETRANGE(Open,TRUE);
      EXIT(VendLedgEntry.FINDFIRST)
    END;

    LOCAL PROCEDURE FindFirstVendLedgEntryWithAppliesToDocNo@59(AccNo@1000 : Code[20];AppliestoDocNo@1001 : Code[20]) : Boolean;
    BEGIN
      VendLedgEntry.RESET;
      VendLedgEntry.SETCURRENTKEY("Document No.");
      VendLedgEntry.SETRANGE("Document No.",AppliestoDocNo);
      VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
      VendLedgEntry.SETRANGE("Vendor No.",AccNo);
      VendLedgEntry.SETRANGE(Open,TRUE);
      EXIT(VendLedgEntry.FINDFIRST)
    END;

    LOCAL PROCEDURE FindFirstEmplLedgEntryWithAppliesToID@191(AccNo@1000 : Code[20];AppliesToID@1001 : Code[50]) : Boolean;
    BEGIN
      EmplLedgEntry.RESET;
      EmplLedgEntry.SETCURRENTKEY("Employee No.","Applies-to ID",Open);
      EmplLedgEntry.SETRANGE("Employee No.",AccNo);
      EmplLedgEntry.SETRANGE("Applies-to ID",AppliesToID);
      EmplLedgEntry.SETRANGE(Open,TRUE);
      EXIT(EmplLedgEntry.FINDFIRST)
    END;

    LOCAL PROCEDURE FindFirstEmplLedgEntryWithAppliesToDocNo@190(AccNo@1000 : Code[20];AppliestoDocNo@1001 : Code[20]) : Boolean;
    BEGIN
      EmplLedgEntry.RESET;
      EmplLedgEntry.SETCURRENTKEY("Document No.");
      EmplLedgEntry.SETRANGE("Document No.",AppliestoDocNo);
      EmplLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
      EmplLedgEntry.SETRANGE("Employee No.",AccNo);
      EmplLedgEntry.SETRANGE(Open,TRUE);
      EXIT(EmplLedgEntry.FINDFIRST)
    END;

    PROCEDURE UpdateVendorPaymentDetails@1060000();
    VAR
      PaymentMethod@1060000 : Record 289;
    BEGIN
      //NAVDK
      GetGLSetup;
      IF PaymentMethod.GET("Payment Method Code") AND GLSetup."Danish Localization Active" THEN
        CASE PaymentMethod."Payment Type Validation" OF
          PaymentMethod."Payment Type Validation"::"FIK 01",PaymentMethod."Payment Type Validation"::"FIK 04": BEGIN
            "Creditor No." := '';
            "Recipient Bank Account" := '';
          END;
          PaymentMethod."Payment Type Validation"::"FIK 71",PaymentMethod."Payment Type Validation"::"FIK 73": BEGIN
            "Giro Acc. No." := '';
            "Recipient Bank Account" := '';
          END;
          PaymentMethod."Payment Type Validation"::Domestic,PaymentMethod."Payment Type Validation"::International: BEGIN
            "Creditor No." := '';
            "Giro Acc. No." := '';
          END;
        END;
    END;

    LOCAL PROCEDURE IsForExportToPaymentFile@1060001() : Boolean;
    VAR
      PaymentMethod@1060000 : Record 289;
    BEGIN
      //NAVDK
      IF PaymentMethod.GET("Payment Method Code") THEN
        EXIT(PaymentMethod."Payment Type Validation" <> PaymentMethod."Payment Type Validation"::" ");

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE ClearPostingGroups@45();
    BEGIN
      "Gen. Posting Type" := "Gen. Posting Type"::" ";
      "Gen. Bus. Posting Group" := '';
      "Gen. Prod. Posting Group" := '';
      "VAT Bus. Posting Group" := '';
      "VAT Prod. Posting Group" := '';

      "Auto. Acc. Group" := '';  //NAVSE
      GenJnlLineExt.InitGetLine(Rec);//4PSSE
      GenJnlLineExt."VAT Code" := ''; //NAVNO
      GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE

      OnAfterClearPostingGroups(Rec);
    END;

    LOCAL PROCEDURE ClearBalancePostingGroups@48();
    BEGIN
      "Bal. Gen. Posting Type" := "Bal. Gen. Posting Type"::" ";
      "Bal. Gen. Bus. Posting Group" := '';
      "Bal. Gen. Prod. Posting Group" := '';
      "Bal. VAT Bus. Posting Group" := '';
      "Bal. VAT Prod. Posting Group" := '';

      GenJnlLineExt.InitGetLine(Rec);//4PSSE
      GenJnlLineExt."Bal. VAT Code" := '';  //NAVNO
      GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE

      OnAfterClearBalPostingGroups(Rec);
    END;

    LOCAL PROCEDURE CleanLine@66();
    BEGIN
      UpdateLineBalance;
      UpdateSource;
      ClearICApplicationFields; //**4PS.n
      CreateDim(
        DimMgt.TypeToTableID1("Account Type"),"Account No.",
        DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
        DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."), //**4PS.n
        DATABASE::"Plant Type", "Plant Type", //**4PS.n
        DATABASE::Job,"Job No.",
        DATABASE::"Service Order","Service Order No.", //** 4PS 09-06-2010
        DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
        DATABASE::Campaign,"Campaign No.");
      IF NOT ("Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor]) THEN
        "Recipient Bank Account" := '';
      IF xRec."Account No." <> '' THEN BEGIN
        ClearPostingGroups;
        "Tax Area Code" := '';
        "Tax Liable" := FALSE;
        "Tax Group Code" := '';
        "Bill-to/Pay-to No." := '';
        "Ship-to/Order Address Code" := '';
        "Sell-to/Buy-from No." := '';
        UpdateCountryCodeAndVATRegNo('');
      END;

      CASE "Account Type" OF
        "Account Type"::"G/L Account":
          UpdateAccountID;
        "Account Type"::Customer:
          UpdateCustomerID;
      END;
    END;

    LOCAL PROCEDURE ReplaceDescription@84() : Boolean;
    BEGIN
      IF "Bal. Account No." = '' THEN
        EXIT(TRUE);
      GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
      EXIT(GenJnlBatch."Bal. Account No." <> '');
    END;

    LOCAL PROCEDURE AddCustVendIC@228(AccountType@1000 : Option;AccountNo@1001 : Code[20]) : Boolean;
    BEGIN
      SETRANGE("Account Type",AccountType);
      SETRANGE("Account No.",AccountNo);
      IF NOT ISEMPTY THEN
        EXIT(FALSE);

      RESET;
      IF FINDLAST THEN;
      "Line No." += 10000;

      "Account Type" := AccountType;
      "Account No." := AccountNo;
      INSERT;
      EXIT(TRUE);
    END;

    [External]
    PROCEDURE IsCustVendICAdded@209(GenJournalLine@1000 : Record 81) : Boolean;
    BEGIN
      IF (GenJournalLine."Account No." <> '') AND
         (GenJournalLine."Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::"IC Partner"])
      THEN
        EXIT(AddCustVendIC(GenJournalLine."Account Type",GenJournalLine."Account No."));

      IF (GenJournalLine."Bal. Account No." <> '') AND
         (GenJournalLine."Bal. Account Type" IN ["Bal. Account Type"::Customer,
                                                 "Bal. Account Type"::Vendor,
                                                 "Bal. Account Type"::"IC Partner"])
      THEN
        EXIT(AddCustVendIC(GenJournalLine."Bal. Account Type",GenJournalLine."Bal. Account No."));

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE IsExportedToPaymentFile@1020() : Boolean;
    BEGIN
      EXIT(IsPaymentJournallLineExported OR IsAppliedToVendorLedgerEntryExported);
    END;

    [External]
    PROCEDURE IsPaymentJournallLineExported@80() : Boolean;
    VAR
      GenJnlLine@1001 : Record 81;
      OldFilterGroup@1000 : Integer;
      HasExportedLines@1002 : Boolean;
    BEGIN
      WITH GenJnlLine DO BEGIN
        COPYFILTERS(Rec);
        OldFilterGroup := FILTERGROUP;
        FILTERGROUP := 10;
        SETRANGE("Exported to Payment File",TRUE);
        HasExportedLines := NOT ISEMPTY;
        SETRANGE("Exported to Payment File");
        FILTERGROUP := OldFilterGroup;
      END;
      EXIT(HasExportedLines);
    END;

    [External]
    PROCEDURE IsAppliedToVendorLedgerEntryExported@79() : Boolean;
    VAR
      GenJnlLine@1001 : Record 81;
      VendLedgerEntry@1002 : Record 25;
    BEGIN
      GenJnlLine.COPYFILTERS(Rec);

      IF GenJnlLine.FINDSET THEN
        REPEAT
          IF GenJnlLine.IsApplied THEN BEGIN
            VendLedgerEntry.SETRANGE("Vendor No.",GenJnlLine."Account No.");
            IF GenJnlLine."Applies-to Doc. No." <> '' THEN BEGIN
              VendLedgerEntry.SETRANGE("Document Type",GenJnlLine."Applies-to Doc. Type");
              VendLedgerEntry.SETRANGE("Document No.",GenJnlLine."Applies-to Doc. No.");
            END;
            IF GenJnlLine."Applies-to ID" <> '' THEN
              VendLedgerEntry.SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID");
            VendLedgerEntry.SETRANGE("Exported to Payment File",TRUE);
            IF NOT VendLedgerEntry.ISEMPTY THEN
              EXIT(TRUE);
          END;

          VendLedgerEntry.RESET;
          VendLedgerEntry.SETRANGE("Vendor No.",GenJnlLine."Account No.");
          VendLedgerEntry.SETRANGE("Applies-to Doc. Type",GenJnlLine."Document Type");
          VendLedgerEntry.SETRANGE("Applies-to Doc. No.",GenJnlLine."Document No.");
          VendLedgerEntry.SETRANGE("Exported to Payment File",TRUE);
          IF NOT VendLedgerEntry.ISEMPTY THEN
            EXIT(TRUE);
        UNTIL GenJnlLine.NEXT = 0;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE ClearAppliedAutomatically@72();
    BEGIN
      IF CurrFieldNo <> 0 THEN
        "Applied Automatically" := FALSE;
    END;

    [External]
    PROCEDURE SetPostingDateAsDueDate@77(DueDate@1002 : Date;DateOffset@1000 : DateFormula) : Boolean;
    VAR
      NewPostingDate@1001 : Date;
    BEGIN
      IF DueDate = 0D THEN
        EXIT(FALSE);

      NewPostingDate := CALCDATE(DateOffset,DueDate);
      IF NewPostingDate < WORKDATE THEN BEGIN
        VALIDATE("Posting Date",WORKDATE);
        EXIT(TRUE);
      END;

      VALIDATE("Posting Date",NewPostingDate);
      EXIT(FALSE);
    END;

    [External]
    PROCEDURE CalculatePostingDate@76();
    VAR
      GenJnlLine@1000 : Record 81;
      EmptyDateFormula@1001 : DateFormula;
    BEGIN
      GenJnlLine.COPY(Rec);
      GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
      GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");

      IF GenJnlLine.FINDSET THEN BEGIN
        Window.OPEN(CalcPostDateMsg);
        REPEAT
          EVALUATE(EmptyDateFormula,'<0D>');
          GenJnlLine.SetPostingDateAsDueDate(GenJnlLine.GetAppliesToDocDueDate,EmptyDateFormula);
          GenJnlLine.MODIFY(TRUE);
          Window.UPDATE(1,GenJnlLine."Document No.");
        UNTIL GenJnlLine.NEXT = 0;
        Window.CLOSE;
      END;
    END;

    [External]
    PROCEDURE ImportBankStatement@73();
    VAR
      ProcessGenJnlLines@1000 : Codeunit 1247;
    BEGIN
      ProcessGenJnlLines.ImportBankStatement(Rec);
    END;

    PROCEDURE ImportFIK@1060002();
    VAR
      ProcessGenJnlLines@1060000 : Codeunit 1247;
    BEGIN
      //NAVDK
      ProcessGenJnlLines.ImportFIK(Rec);
    END;

    [External]
    PROCEDURE ExportPaymentFile@81();
    VAR
      BankAcc@1000 : Record 270;
      ConfirmManagement@1001 : Codeunit 27;
    BEGIN
      IF NOT FINDSET THEN
        ERROR(NothingToExportErr);
      SETRANGE("Journal Template Name","Journal Template Name");
      SETRANGE("Journal Batch Name","Journal Batch Name");
      TESTFIELD("Check Printed",FALSE);

      CheckDocNoOnLines;
      IF IsExportedToPaymentFile THEN
        IF NOT ConfirmManagement.ConfirmProcess(ExportAgainQst,TRUE) THEN
          EXIT;
      BankAcc.GET("Bal. Account No.");
      IF BankAcc.GetPaymentExportCodeunitID > 0 THEN
        CODEUNIT.RUN(BankAcc.GetPaymentExportCodeunitID,Rec)
      ELSE
        CODEUNIT.RUN(CODEUNIT::"Exp. Launcher Gen. Jnl.",Rec);
    END;

    PROCEDURE SetSuppressCommit@299(NewSuppressCommit@1000 : Boolean);
    BEGIN
      SuppressCommit := NewSuppressCommit;
      PaymentToleranceMgt.SetSuppressCommit(SuppressCommit);
    END;

    [External]
    PROCEDURE TotalExportedAmount@85() : Decimal;
    VAR
      CreditTransferEntry@1000 : Record 1206;
    BEGIN
      IF NOT ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::Employee]) THEN
        EXIT(0);
      GenJnlShowCTEntries.SetFiltersOnCreditTransferEntry(Rec,CreditTransferEntry);
      CreditTransferEntry.CALCSUMS("Transfer Amount");
      EXIT(CreditTransferEntry."Transfer Amount");
    END;

    [External]
    PROCEDURE DrillDownExportedAmount@95();
    VAR
      CreditTransferEntry@1000 : Record 1206;
    BEGIN
      IF NOT ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor,"Account Type"::Employee]) THEN
        EXIT;
      GenJnlShowCTEntries.SetFiltersOnCreditTransferEntry(Rec,CreditTransferEntry);
      PAGE.RUN(PAGE::"Credit Transfer Reg. Entries",CreditTransferEntry);
    END;

    LOCAL PROCEDURE CopyDimensionsFromJobTaskLine@82();
    BEGIN
      "Dimension Set ID" := TempJobJnlLine."Dimension Set ID";
      "Shortcut Dimension 1 Code" := TempJobJnlLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := TempJobJnlLine."Shortcut Dimension 2 Code";
    END;

    [External]
    PROCEDURE CopyDocumentFields@129(DocType@1004 : Option;DocNo@1003 : Code[20];ExtDocNo@1002 : Text[35];SourceCode@1001 : Code[10];NoSeriesCode@1000 : Code[20]);
    BEGIN
      "Document Type" := DocType;
      "Document No." := DocNo;
      "External Document No." := ExtDocNo;
      "Source Code" := SourceCode;
      IF NoSeriesCode <> '' THEN
        "Posting No. Series" := NoSeriesCode;
    END;

    [External]
    PROCEDURE CopyCustLedgEntry@134(CustLedgerEntry@1000 : Record 21);
    BEGIN
      "Document Type" := CustLedgerEntry."Document Type";
      Description := CustLedgerEntry.Description;
      "Shortcut Dimension 1 Code" := CustLedgerEntry."Global Dimension 1 Code";
      "Shortcut Dimension 2 Code" := CustLedgerEntry."Global Dimension 2 Code";
      "Dimension Set ID" := CustLedgerEntry."Dimension Set ID";
      "Posting Group" := CustLedgerEntry."Customer Posting Group";
      "Source Type" := "Source Type"::Customer;
      "Source No." := CustLedgerEntry."Customer No.";

      OnAfterCopyGenJnlLineFromCustLedgEntry(CustLedgEntry,Rec);
    END;

    [External]
    PROCEDURE CopyFromGenJnlAllocation@113(GenJnlAlloc@1000 : Record 221);
    BEGIN
      "Account No." := GenJnlAlloc."Account No.";
      "Shortcut Dimension 1 Code" := GenJnlAlloc."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := GenJnlAlloc."Shortcut Dimension 2 Code";
      "Dimension Set ID" := GenJnlAlloc."Dimension Set ID";
      "Gen. Posting Type" := GenJnlAlloc."Gen. Posting Type";
      "Gen. Bus. Posting Group" := GenJnlAlloc."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := GenJnlAlloc."Gen. Prod. Posting Group";
      "VAT Bus. Posting Group" := GenJnlAlloc."VAT Bus. Posting Group";
      "VAT Prod. Posting Group" := GenJnlAlloc."VAT Prod. Posting Group";
      "Tax Area Code" := GenJnlAlloc."Tax Area Code";
      "Tax Liable" := GenJnlAlloc."Tax Liable";
      "Tax Group Code" := GenJnlAlloc."Tax Group Code";
      "Use Tax" := GenJnlAlloc."Use Tax";
      "VAT Calculation Type" := GenJnlAlloc."VAT Calculation Type";
      "VAT Amount" := GenJnlAlloc."VAT Amount";
      "VAT Base Amount" := GenJnlAlloc.Amount - GenJnlAlloc."VAT Amount";
      "VAT %" := GenJnlAlloc."VAT %";
      "Source Currency Amount" := GenJnlAlloc."Additional-Currency Amount";
      Amount := GenJnlAlloc.Amount;
      "Amount (LCY)" := GenJnlAlloc.Amount;

      OnAfterCopyGenJnlLineFromGenJnlAllocation(GenJnlAlloc,Rec);
    END;

    [External]
    PROCEDURE CopyFromInvoicePostBuffer@112(InvoicePostBuffer@1001 : Record 49);
    BEGIN
      "Account No." := InvoicePostBuffer."G/L Account";
      "System-Created Entry" := InvoicePostBuffer."System-Created Entry";
      //**4PS.sn
      IF InvoicePostBuffer."Block VAT Posting" THEN
        "Gen. Posting Type" := 0
      ELSE
      //**4PS.en
        "Gen. Bus. Posting Group" := InvoicePostBuffer."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := InvoicePostBuffer."Gen. Prod. Posting Group";
      "VAT Bus. Posting Group" := InvoicePostBuffer."VAT Bus. Posting Group";
      "VAT Prod. Posting Group" := InvoicePostBuffer."VAT Prod. Posting Group";
      "Tax Area Code" := InvoicePostBuffer."Tax Area Code";
      "Tax Liable" := InvoicePostBuffer."Tax Liable";
      "Tax Group Code" := InvoicePostBuffer."Tax Group Code";
      "Use Tax" := InvoicePostBuffer."Use Tax";
      Quantity := InvoicePostBuffer.Quantity;
      "VAT %" := InvoicePostBuffer."VAT %";
      "VAT Calculation Type" := InvoicePostBuffer."VAT Calculation Type";
      "VAT Posting" := "VAT Posting"::"Manual VAT Entry";
      "Job No." := InvoicePostBuffer."Job No.";
      "Deferral Code" := InvoicePostBuffer."Deferral Code";
      "Deferral Line No." := InvoicePostBuffer."Deferral Line No.";
      Amount := InvoicePostBuffer.Amount;
      "Source Currency Amount" := InvoicePostBuffer."Amount (ACY)";
      "VAT Base Amount" := InvoicePostBuffer."VAT Base Amount";
      "Source Curr. VAT Base Amount" := InvoicePostBuffer."VAT Base Amount (ACY)";
      "VAT Amount" := InvoicePostBuffer."VAT Amount";
      "Source Curr. VAT Amount" := InvoicePostBuffer."VAT Amount (ACY)";
      "VAT Difference" := InvoicePostBuffer."VAT Difference";
      "VAT Base Before Pmt. Disc." := InvoicePostBuffer."VAT Base Before Pmt. Disc.";
      "Auto. Acc. Group" := InvoicePostBuffer."Auto. Acc. Group";  //NAVSE
      //**4PS.sn
      //This overrides some of the fields above
      Description := InvoicePostBuffer.Description;
      "Description 2" := InvoicePostBuffer."Description 2";
      Amount := InvoicePostBuffer.Amount + InvoicePostBuffer."Retention Amount";
      "Source Currency Amount" := InvoicePostBuffer."Amount (ACY)" + InvoicePostBuffer."Retention Amount (ACY)";
      "Retention Amount" := InvoicePostBuffer."Retention Amount";
      "Source Curr. Retention Amount"  := InvoicePostBuffer."Retention Amount (ACY)";
      "Cost Component" := InvoicePostBuffer."Cost Component";
      Element := InvoicePostBuffer.Element;
      "Extension Contract" := InvoicePostBuffer."Extension Contract";
      "Service Order No." := InvoicePostBuffer."Service Order No.";
      GetServiceCategory;
      "Service Contract No." := InvoicePostBuffer."Service Contract No.";
      "Service Location No." := InvoicePostBuffer."Service Location No.";
      "Origin Type" := InvoicePostBuffer."Origin Type";
      "Interest Date" := "Interest Date";
      "Intercompany Transaction" := InvoicePostBuffer."Intercompany Transaction";
      "Receiving Company" := InvoicePostBuffer."Receiving Company";
      "Employee No." := InvoicePostBuffer."Employee No.";
      "Block VAT Posting" := InvoicePostBuffer."Block VAT Posting";
      "Plant Invoice" := InvoicePostBuffer."Plant Invoice";
      "Rental Unit" := InvoicePostBuffer."Rental Unit";
      "Rental Unit Line Type" := InvoicePostBuffer."Rental Unit Line Type";
      "Alternative Bill-to Address" := "Alternative Bill-to Address";
      "Cost Type Cost Plus Line" := InvoicePostBuffer."Cost Type Cost Plus Line";
      //**4PS.en

      //>>NAVSE
      //NTR Start
      "Auto. Acc. Group" := InvoicePostBuffer."Auto. Acc. Group";  //NAVSE
      "Periodic Template Code" := InvoicePostBuffer."Periodic Template Code";
      "Periodic Starting Date" := InvoicePostBuffer."Periodic Starting Date";
      //NTR End
      //<<NAVSE

      OnAfterCopyGenJnlLineFromInvPostBuffer(InvoicePostBuffer,Rec);
    END;

    [External]
    PROCEDURE CopyFromInvoicePostBufferFA@111(InvoicePostBuffer@1001 : Record 49);
    VAR
      PlantSetup@1100525000 : Record 11012550;
    BEGIN
      "Account Type" := "Account Type"::"Fixed Asset";
      "FA Posting Date" := InvoicePostBuffer."FA Posting Date";
      "Depreciation Book Code" := InvoicePostBuffer."Depreciation Book Code";
      "Salvage Value" := InvoicePostBuffer."Salvage Value";
      "Depr. until FA Posting Date" := InvoicePostBuffer."Depr. until FA Posting Date";
      "Depr. Acquisition Cost" := InvoicePostBuffer."Depr. Acquisition Cost";
      "Maintenance Code" := InvoicePostBuffer."Maintenance Code";
      "Insurance No." := InvoicePostBuffer."Insurance No.";
      "Budgeted FA No." := InvoicePostBuffer."Budgeted FA No.";
      "Duplicate in Depreciation Book" := InvoicePostBuffer."Duplicate in Depreciation Book";
      "Use Duplication List" := InvoicePostBuffer."Use Duplication List";

       //**4PS.sn Pass quantity for use with FA ledger entries
       IF FPSLicenseManagement.LicenseAndReadPermissionForTable(PlantSetup) THEN
         IF (PlantSetup.GET AND PlantSetup."Integration Fixed Assets") THEN
           Quantity :=  InvoicePostBuffer.Quantity;
      //**4PS.en

      OnAfterCopyGenJnlLineFromInvPostBufferFA(InvoicePostBuffer,Rec);
    END;

    [External]
    PROCEDURE CopyFromPrepmtInvoiceBuffer@110(PrepmtInvLineBuffer@1001 : Record 461);
    BEGIN
      "Account No." := PrepmtInvLineBuffer."G/L Account No.";
      "Gen. Bus. Posting Group" := PrepmtInvLineBuffer."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := PrepmtInvLineBuffer."Gen. Prod. Posting Group";
      "VAT Bus. Posting Group" := PrepmtInvLineBuffer."VAT Bus. Posting Group";
      "VAT Prod. Posting Group" := PrepmtInvLineBuffer."VAT Prod. Posting Group";
      "Tax Area Code" := PrepmtInvLineBuffer."Tax Area Code";
      "Tax Liable" := PrepmtInvLineBuffer."Tax Liable";
      "Tax Group Code" := PrepmtInvLineBuffer."Tax Group Code";
      "Use Tax" := FALSE;
      "VAT Calculation Type" := PrepmtInvLineBuffer."VAT Calculation Type";
      "Job No." := PrepmtInvLineBuffer."Job No.";
      Amount := PrepmtInvLineBuffer.Amount;
      "Source Currency Amount" := PrepmtInvLineBuffer."Amount (ACY)";
      "VAT Base Amount" := PrepmtInvLineBuffer."VAT Base Amount";
      "Source Curr. VAT Base Amount" := PrepmtInvLineBuffer."VAT Base Amount (ACY)";
      "VAT Amount" := PrepmtInvLineBuffer."VAT Amount";
      "Source Curr. VAT Amount" := PrepmtInvLineBuffer."VAT Amount (ACY)";
      "VAT Difference" := PrepmtInvLineBuffer."VAT Difference";
      "VAT Base Before Pmt. Disc." := PrepmtInvLineBuffer."VAT Base Before Pmt. Disc.";

      OnAfterCopyGenJnlLineFromPrepmtInvBuffer(PrepmtInvLineBuffer,Rec);
    END;

    [External]
    PROCEDURE CopyFromPurchHeader@109(PurchHeader@1001 : Record 38);
    BEGIN
      "Source Currency Code" := PurchHeader."Currency Code";
      "Currency Factor" := PurchHeader."Currency Factor";
      //**4PS.sn
      IF "Currency Factor" = CurrExchRate.ExchangeRate(1, PurchHeader."Job No.", PurchHeader."Posting Date", PurchHeader."Currency Code", FALSE) THEN
        IF CurrExchRate.HasFoundJobCurrExchRate THEN
          "Exchange Rate From" := "Exchange Rate From"::"Project Exchange Rate";
      //**4PS.en
      Correction := PurchHeader.Correction;
      "EU 3-Party Trade" := PurchHeader."EU 3-Party Trade";  //NAVSE
      "VAT Base Discount %" := PurchHeader."VAT Base Discount %";
      "Sell-to/Buy-from No." := PurchHeader."Buy-from Vendor No.";
      "Bill-to/Pay-to No." := PurchHeader."Pay-to Vendor No.";
      "Country/Region Code" := PurchHeader."VAT Country/Region Code";
      "VAT Registration No." := PurchHeader."VAT Registration No.";
      "Source Type" := "Source Type"::Vendor;
      "Source No." := PurchHeader."Pay-to Vendor No.";
      "Posting No. Series" := PurchHeader."Posting No. Series";
      "IC Partner Code" := PurchHeader."Pay-to IC Partner Code";
      "Ship-to/Order Address Code" := PurchHeader."Order Address Code";
      "Salespers./Purch. Code" := PurchHeader."Purchaser Code";
      "On Hold" := PurchHeader."On Hold";
      IF "Account Type" = "Account Type"::Vendor THEN
        "Posting Group" := PurchHeader."Vendor Posting Group";

      //**4PS.sn
      "Subcontract No." := PurchHeader."Subcontract No.";
      "Interest Date" := PurchHeader."Interest Date";
      "Service Order No." := PurchHeader."Service Order No.";
      GetServiceCategory;
      //**4PS.en

      GetGLSetup;  //NAVFI
      IF GLSetup."Finnish localization active" THEN BEGIN  //NAVFI
        PurchHeader.CALCFIELDS("Message Type","Invoice Message");//180507 bugg, was missing
        GenJnlLineExt.InitGetLine(Rec);//4PSSE
        GenJnlLineExt."Message Type" := PurchHeader."Message Type";
        GenJnlLineExt."Invoice Message" := PurchHeader."Invoice Message";
        GenJnlLineExt."Invoice Message 2" := PurchHeader."Invoice Message 2";
        GenJnlLineExt."Payment date" := PurchHeader."Due Date";
        GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE
      END;  //NAVFI

      GenJnlLine."EU 3-Party Trade" := PurchHeader."EU 3-Party Trade";  //NAVSE

      //NAVNO
      GenJnlLineExt.InitGetLine(Rec);//4PSSE
      GenJnlLineExt.KID := PurchHeader.KID;
      GenJnlLineExt."Payment Type Code Abroad" := PurchHeader."Payment Type Code Abroad";
      GenJnlLineExt."Specification (Norges Bank)" := PurchHeader."Specification (Norges Bank)";
      GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE

      OnAfterCopyGenJnlLineFromPurchHeader(PurchHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromPurchHeaderPrepmt@127(PurchHeader@1000 : Record 38);
    BEGIN
      "Source Currency Code" := PurchHeader."Currency Code";
      "VAT Base Discount %" := PurchHeader."VAT Base Discount %";
      "EU 3-Party Trade" := PurchHeader."EU 3-Party Trade";  //NAVSE
      "Bill-to/Pay-to No." := PurchHeader."Pay-to Vendor No.";
      "Country/Region Code" := PurchHeader."VAT Country/Region Code";
      "VAT Registration No." := PurchHeader."VAT Registration No.";
      "Source Type" := "Source Type"::Vendor;
      "Source No." := PurchHeader."Pay-to Vendor No.";
      "IC Partner Code" := PurchHeader."Buy-from IC Partner Code";
      "VAT Posting" := "VAT Posting"::"Manual VAT Entry";
      "System-Created Entry" := TRUE;
      Prepayment := TRUE;

      OnAfterCopyGenJnlLineFromPurchHeaderPrepmt(PurchHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromPurchHeaderPrepmtPost@137(PurchHeader@1000 : Record 38;UsePmtDisc@1001 : Boolean);
    BEGIN
      "Account Type" := "Account Type"::Vendor;
      "Account No." := PurchHeader."Pay-to Vendor No.";
      SetCurrencyFactor(PurchHeader."Currency Code",PurchHeader."Currency Factor");
      "Source Currency Code" := PurchHeader."Currency Code";
      "Bill-to/Pay-to No." := PurchHeader."Pay-to Vendor No.";
      "Sell-to/Buy-from No." := PurchHeader."Buy-from Vendor No.";
      "Salespers./Purch. Code" := PurchHeader."Purchaser Code";
      "Source Type" := "Source Type"::Customer;
      "Source No." := PurchHeader."Pay-to Vendor No.";
      "IC Partner Code" := PurchHeader."Buy-from IC Partner Code";
      "System-Created Entry" := TRUE;
      Prepayment := TRUE;
      "Due Date" := PurchHeader."Prepayment Due Date";
      "Payment Terms Code" := PurchHeader."Payment Terms Code";
      IF UsePmtDisc THEN BEGIN
        "Pmt. Discount Date" := PurchHeader."Prepmt. Pmt. Discount Date";
        "Payment Discount %" := PurchHeader."Prepmt. Payment Discount %";
      END;

      OnAfterCopyGenJnlLineFromPurchHeaderPrepmtPost(PurchHeader,Rec,UsePmtDisc);
    END;

    [External]
    PROCEDURE CopyFromPurchHeaderApplyTo@107(PurchHeader@1001 : Record 38);
    BEGIN
      "Applies-to Doc. Type" := PurchHeader."Applies-to Doc. Type";
      "Applies-to Doc. No." := PurchHeader."Applies-to Doc. No.";
      "Applies-to ID" := PurchHeader."Applies-to ID";
      "Allow Application" := PurchHeader."Bal. Account No." = '';

      OnAfterCopyGenJnlLineFromPurchHeaderApplyTo(PurchHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromPurchHeaderPayment@104(PurchHeader@1001 : Record 38);
    BEGIN
      "Due Date" := PurchHeader."Due Date";
      "Payment Terms Code" := PurchHeader."Payment Terms Code";
      "Pmt. Discount Date" := PurchHeader."Pmt. Discount Date";
      "Payment Discount %" := PurchHeader."Payment Discount %";
      "Creditor No." := PurchHeader."Creditor No.";
      "Payment Reference" := PurchHeader."Payment Reference";
      "Payment Method Code" := PurchHeader."Payment Method Code";

      //>>RFC148
      GenJnlLine."Payment Reference" := "Payment Reference";
      //<<RFC148

      //NAVNO
      GenJnlLineExt.InitGetLine(Rec);
      GenJnlLineExt.KID := PurchHeader.KID;
      GenJnlLineExt."Payment Type Code Abroad" := PurchHeader."Payment Type Code Abroad";
      GenJnlLineExt."Specification (Norges Bank)" := PurchHeader."Specification (Norges Bank)";
      GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE
      //NAVNO

      // PEB0091
      //CALCFIELDS("Recipient Bank Account");
      GenJnlLine."OCR No." := "OCR No.";
      GenJnlLine."Recipient Bank Account" := "Recipient Bank Account";
      // 0091
      GenJnlLine."Giro Acc. No." := "Giro Acc. No.";  //NAVDK

      //**4PS.sn
      "Pmt. Discount Date 2" := PurchHeader."Pmt. Discount Date 2";
      "Payment Discount % 2" := PurchHeader."Payment Discount % 2";
      "Pmt. Discount Date 3" := PurchHeader."Pmt. Discount Date 3";
      "Payment Discount % 3" := PurchHeader."Payment Discount % 3";
      "Subcontracting Invoice" := PurchHeader."Subcontracting Invoice";
      "Payment Agreement" := PurchHeader."Payment Agreement";
      "Expected Effective Date" := PurchHeader."Actual Effective Date";
      "Expected Enddate" := PurchHeader."Actual End Date";
      "Number of Hours" := PurchHeader."Number of Hours";
      "Avg. Wage Rate" := PurchHeader."Avg. Wage Rate";
      "Labor Amount" := PurchHeader."Labor Amount";
      "Contribution Percentage Labor" := PurchHeader."Contribution Percentage Labor";
      "Contribution Percentage Total" := PurchHeader."Contribution Percentage Total";
      "Fixed B Amount per Hour" := PurchHeader."Fixed B Amount per Hour";
      "Pay To Tax Authority" := PurchHeader."Pay To Tax Authority";
      "Wage Charge (to B Account)" := PurchHeader."Wage Charge (to B Account)";
      "Wage Charge (to Tax Authority)" := PurchHeader."Wage Charge (to Tax Authority)";
      "Transaction Mode B Payments" := PurchHeader."Transaction Mode B Payments";
      "Bank Account Code B Payments" := PurchHeader."Bank Account Code B Payments";
      //CASE PurchHeader."Document Type" OF
      //  PurchHeader."Document Type"::Order:
      //    Approved := TRUE;
      //  PurchHeader."Document Type"::Invoice:
      //    Approved := PurchHeader."Invoice Approved";
      //  PurchHeader."Document Type"::"Credit Memo":
      //    Approved := PurchHeader."Credit Memo Approved";
      //END;
      "Approvement Initials" := PurchHeader."Approvement Initials";
      "Interest Date" := PurchHeader."Interest Date";
      "Your Reference" := PurchHeader."Your Reference";
      "Closed Project No." := PurchHeader."Job No.";
      "Subcontract No." := PurchHeader."Subcontract No.";
      //**4PS.en

      OnAfterCopyGenJnlLineFromPurchHeaderPayment(PurchHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromSalesHeader@103(SalesHeader@1001 : Record 36);
    BEGIN
      "Source Currency Code" := SalesHeader."Currency Code";
      "Currency Factor" := SalesHeader."Currency Factor";
      //**4PS.sn
      IF "Currency Factor" = CurrExchRate.ExchangeRate(1, SalesHeader."Job No.", SalesHeader."Posting Date", SalesHeader."Currency Code", TRUE) THEN
        IF CurrExchRate.HasFoundJobCurrExchRate THEN
          "Exchange Rate From" := "Exchange Rate From"::"Project Exchange Rate";
      //**4PS.en
      "VAT Base Discount %" := SalesHeader."VAT Base Discount %";
      Correction := SalesHeader.Correction;
      "EU 3-Party Trade" := SalesHeader."EU 3-Party Trade";
      "Sell-to/Buy-from No." := SalesHeader."Sell-to Customer No.";
      "Bill-to/Pay-to No." := SalesHeader."Bill-to Customer No.";
      "Country/Region Code" := SalesHeader."VAT Country/Region Code";
      "VAT Registration No." := SalesHeader."VAT Registration No.";
      "Source Type" := "Source Type"::Customer;
      "Source No." := SalesHeader."Bill-to Customer No.";
      "Posting No. Series" := SalesHeader."Posting No. Series";
      "Ship-to/Order Address Code" := SalesHeader."Ship-to Code";
      "IC Partner Code" := SalesHeader."Bill-to IC Partner Code";
      "Salespers./Purch. Code" := SalesHeader."Salesperson Code";
      "On Hold" := SalesHeader."On Hold";
      IF "Account Type" = "Account Type"::Customer THEN
        "Posting Group" := SalesHeader."Customer Posting Group";

      //**4PS.sn
      "Alternative Bill-to Address" := SalesHeader."Alternative Bill-to Address";
      "Interest Date" := SalesHeader."Interest Date";
      "Credit Restriction" := SalesHeader."Credit Restriction";
      VALIDATE("Credit Restriction %",SalesHeader."Credit Restriction %");
      "Credit Restriction Date" := SalesHeader."Credit Restriction Date";
      "Your Reference" := SalesHeader."Your Reference";
      "Batch Seq. No." := SalesHeader."Batch Seq. No.";
      "Service Order No." := SalesHeader."Service Order No.";
      GetServiceCategory;
      //**4PS.en

      OnAfterCopyGenJnlLineFromSalesHeader(SalesHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromSalesHeaderPrepmt@119(SalesHeader@1000 : Record 36);
    BEGIN
      "Source Currency Code" := SalesHeader."Currency Code";
      "VAT Base Discount %" := SalesHeader."VAT Base Discount %";
      "EU 3-Party Trade" := SalesHeader."EU 3-Party Trade";
      "Bill-to/Pay-to No." := SalesHeader."Bill-to Customer No.";
      "Country/Region Code" := SalesHeader."VAT Country/Region Code";
      "VAT Registration No." := SalesHeader."VAT Registration No.";
      "Source Type" := "Source Type"::Customer;
      "Source No." := SalesHeader."Bill-to Customer No.";
      "IC Partner Code" := SalesHeader."Sell-to IC Partner Code";
      "VAT Posting" := "VAT Posting"::"Manual VAT Entry";
      "System-Created Entry" := TRUE;
      Prepayment := TRUE;

      OnAfterCopyGenJnlLineFromSalesHeaderPrepmt(SalesHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromSalesHeaderPrepmtPost@138(SalesHeader@1000 : Record 36;UsePmtDisc@1001 : Boolean);
    BEGIN
      "Account Type" := "Account Type"::Customer;
      "Account No." := SalesHeader."Bill-to Customer No.";
      SetCurrencyFactor(SalesHeader."Currency Code",SalesHeader."Currency Factor");
      "Source Currency Code" := SalesHeader."Currency Code";
      "Sell-to/Buy-from No." := SalesHeader."Sell-to Customer No.";
      "Bill-to/Pay-to No." := SalesHeader."Bill-to Customer No.";
      "Salespers./Purch. Code" := SalesHeader."Salesperson Code";
      "Source Type" := "Source Type"::Customer;
      "Source No." := SalesHeader."Bill-to Customer No.";
      "IC Partner Code" := SalesHeader."Sell-to IC Partner Code";
      "System-Created Entry" := TRUE;
      Prepayment := TRUE;
      "Due Date" := SalesHeader."Prepayment Due Date";
      "Payment Terms Code" := SalesHeader."Prepmt. Payment Terms Code";
      IF UsePmtDisc THEN BEGIN
        "Pmt. Discount Date" := SalesHeader."Prepmt. Pmt. Discount Date";
        "Payment Discount %" := SalesHeader."Prepmt. Payment Discount %";
      END;

      OnAfterCopyGenJnlLineFromSalesHeaderPrepmtPost(SalesHeader,Rec,UsePmtDisc);
    END;

    [External]
    PROCEDURE CopyFromSalesHeaderApplyTo@100(SalesHeader@1001 : Record 36);
    BEGIN
      "Applies-to Doc. Type" := SalesHeader."Applies-to Doc. Type";
      "Applies-to Doc. No." := SalesHeader."Applies-to Doc. No.";
      "Applies-to ID" := SalesHeader."Applies-to ID";
      "Allow Application" := SalesHeader."Bal. Account No." = '';

      OnAfterCopyGenJnlLineFromSalesHeaderApplyTo(SalesHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromSalesHeaderPayment@99(SalesHeader@1001 : Record 36);
    BEGIN
      "Due Date" := SalesHeader."Due Date";
      "Payment Terms Code" := SalesHeader."Payment Terms Code";
      "Payment Method Code" := SalesHeader."Payment Method Code";
      "Pmt. Discount Date" := SalesHeader."Pmt. Discount Date";
      "Payment Discount %" := SalesHeader."Payment Discount %";
      "Direct Debit Mandate ID" := SalesHeader."Direct Debit Mandate ID";

      //**4PS.sn
      "Pmt. Discount Date 2" := SalesHeader."Pmt. Discount Date 2";
      "Payment Discount % 2" := SalesHeader."Payment Discount % 2";
      "Pmt. Discount Date 3" := SalesHeader."Pmt. Discount Date 3";
      "Payment Discount % 3" := SalesHeader."Payment Discount % 3";
      //**4PS.en

      OnAfterCopyGenJnlLineFromSalesHeaderPayment(SalesHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromServiceHeader@98(ServiceHeader@1001 : Record 5900);
    BEGIN
      "Source Currency Code" := ServiceHeader."Currency Code";
      Correction := ServiceHeader.Correction;
      "VAT Base Discount %" := ServiceHeader."VAT Base Discount %";
      "Sell-to/Buy-from No." := ServiceHeader."Customer No.";
      "Bill-to/Pay-to No." := ServiceHeader."Bill-to Customer No.";
      "Country/Region Code" := ServiceHeader."VAT Country/Region Code";
      "VAT Registration No." := ServiceHeader."VAT Registration No.";
      "Source Type" := "Source Type"::Customer;
      "Source No." := ServiceHeader."Bill-to Customer No.";
      "Posting No. Series" := ServiceHeader."Posting No. Series";
      "Ship-to/Order Address Code" := ServiceHeader."Ship-to Code";
      "EU 3-Party Trade" := ServiceHeader."EU 3-Party Trade";
      "Salespers./Purch. Code" := ServiceHeader."Salesperson Code";

      OnAfterCopyGenJnlLineFromServHeader(ServiceHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromServiceHeaderApplyTo@97(ServiceHeader@1001 : Record 5900);
    BEGIN
      "Applies-to Doc. Type" := ServiceHeader."Applies-to Doc. Type";
      "Applies-to Doc. No." := ServiceHeader."Applies-to Doc. No.";
      "Applies-to ID" := ServiceHeader."Applies-to ID";
      "Allow Application" := ServiceHeader."Bal. Account No." = '';

      OnAfterCopyGenJnlLineFromServHeaderApplyTo(ServiceHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromServiceHeaderPayment@96(ServiceHeader@1001 : Record 5900);
    BEGIN
      "Due Date" := ServiceHeader."Due Date";
      "Payment Terms Code" := ServiceHeader."Payment Terms Code";
      "Payment Method Code" := ServiceHeader."Payment Method Code";
      "Pmt. Discount Date" := ServiceHeader."Pmt. Discount Date";
      "Payment Discount %" := ServiceHeader."Payment Discount %";

      OnAfterCopyGenJnlLineFromServHeaderPayment(ServiceHeader,Rec);
    END;

    [External]
    PROCEDURE CopyFromPaymentCustLedgEntry@205(CustLedgEntry@1000 : Record 21);
    BEGIN
      "Document No." := CustLedgEntry."Document No.";
      "Account Type" := "Account Type"::Customer;
      "Account No." := CustLedgEntry."Customer No.";
      "Shortcut Dimension 1 Code" := CustLedgEntry."Global Dimension 1 Code";
      "Shortcut Dimension 2 Code" := CustLedgEntry."Global Dimension 2 Code";
      "Dimension Set ID" := CustLedgEntry."Dimension Set ID";
      "Posting Group" := CustLedgEntry."Customer Posting Group";
      "Source Type" := "Source Type"::Customer;
      "Source No." := CustLedgEntry."Customer No.";
      "Source Currency Code" := CustLedgEntry."Currency Code";
      "System-Created Entry" := TRUE;
      "Financial Void" := TRUE;
      Correction := TRUE;
    END;

    [External]
    PROCEDURE CopyFromPaymentVendLedgEntry@202(VendLedgEntry@1000 : Record 25);
    BEGIN
      "Document No." := VendLedgEntry."Document No.";
      "Account Type" := "Account Type"::Vendor;
      "Account No." := VendLedgEntry."Vendor No.";
      "Shortcut Dimension 1 Code" := VendLedgEntry."Global Dimension 1 Code";
      "Shortcut Dimension 2 Code" := VendLedgEntry."Global Dimension 2 Code";
      "Dimension Set ID" := VendLedgEntry."Dimension Set ID";
      "Posting Group" := VendLedgEntry."Vendor Posting Group";
      "Source Type" := "Source Type"::Vendor;
      "Source No." := VendLedgEntry."Vendor No.";
      "Source Currency Code" := VendLedgEntry."Currency Code";
      "System-Created Entry" := TRUE;
      "Financial Void" := TRUE;
      Correction := TRUE;
    END;

    [External]
    PROCEDURE CopyFromPaymentEmpLedgEntry@1250(EmployeeLedgerEntry@1000 : Record 5222);
    BEGIN
      "Document No." := EmployeeLedgerEntry."Document No.";
      "Account Type" := "Account Type"::Employee;
      "Account No." := EmployeeLedgerEntry."Employee No.";
      "Shortcut Dimension 1 Code" := EmployeeLedgerEntry."Global Dimension 1 Code";
      "Shortcut Dimension 2 Code" := EmployeeLedgerEntry."Global Dimension 2 Code";
      "Dimension Set ID" := EmployeeLedgerEntry."Dimension Set ID";
      "Posting Group" := EmployeeLedgerEntry."Employee Posting Group";
      "Source Type" := "Source Type"::Employee;
      "Source No." := EmployeeLedgerEntry."Employee No.";
      "Source Currency Code" := EmployeeLedgerEntry."Currency Code";
      "System-Created Entry" := TRUE;
      "Financial Void" := TRUE;
      Correction := TRUE;
    END;

    LOCAL PROCEDURE CopyVATSetupToJnlLines@256() : Boolean;
    BEGIN
      IF ("Journal Template Name" <> '') AND ("Journal Batch Name" <> '') THEN
        IF GenJnlBatch.GET("Journal Template Name","Journal Batch Name") THEN
          EXIT(GenJnlBatch."Copy VAT Setup to Jnl. Lines");
      EXIT("Copy VAT Setup to Jnl. Lines");
    END;

    LOCAL PROCEDURE SetAmountWithCustLedgEntry@102();
    BEGIN
      OnBeforeSetAmountWithCustLedgEntry(Rec,CustLedgEntry);

      IF "Currency Code" <> CustLedgEntry."Currency Code" THEN
        CheckModifyCurrencyCode(GenJnlLine."Account Type"::Customer,CustLedgEntry."Currency Code");

      IF Amount = 0 THEN BEGIN
        CustLedgEntry.CALCFIELDS("Remaining Amount");
        SetAmountWithRemaining(
      //  PaymentToleranceMgt.CheckCalcPmtDiscGenJnlCust(Rec,CustLedgEntry,0,FALSE), //**4PS.o
          PaymentToleranceMgt.CheckCalcPmtDiscGenJnlCust(Rec,CustLedgEntry,0,FALSE,0), //**4PS.n
          CustLedgEntry."Amount to Apply",CustLedgEntry."Remaining Amount",CustLedgEntry."Remaining Pmt. Disc. Possible");
      END;

      //**4PS.sn
      IF Amount = 0 THEN BEGIN
        SetAmountWithRemaining(
          PaymentToleranceMgt.CheckCalcPmtDiscGenJnlCust(Rec,CustLedgEntry,0,FALSE,1),
          CustLedgEntry."Amount to Apply",CustLedgEntry."Remaining Amount",CustLedgEntry."Remain. Pmt. Disc. Possible 2");
      END;
      IF Amount = 0 THEN BEGIN
        SetAmountWithRemaining(
          PaymentToleranceMgt.CheckCalcPmtDiscGenJnlCust(Rec,CustLedgEntry,0,FALSE,2),
          CustLedgEntry."Amount to Apply",CustLedgEntry."Remaining Amount",CustLedgEntry."Remain. Pmt. Disc. Possible 3");
      END;
      //**4PS.en
    END;

    LOCAL PROCEDURE SetAmountWithVendLedgEntry@91();
    BEGIN
      OnBeforeSetAmountWithVendLedgEntry(Rec,VendLedgEntry);

      IF "Currency Code" <> VendLedgEntry."Currency Code" THEN
        CheckModifyCurrencyCode("Account Type"::Vendor,VendLedgEntry."Currency Code");
      IF Amount = 0 THEN BEGIN
        VendLedgEntry.CALCFIELDS("Remaining Amount");
        SetAmountWithRemaining(
      //  PaymentToleranceMgt.CheckCalcPmtDiscGenJnlVend(Rec,VendLedgEntry,0,FALSE), //**4PS.o
          PaymentToleranceMgt.CheckCalcPmtDiscGenJnlVend(Rec,VendLedgEntry,0,FALSE,0), //**4PS.n
          VendLedgEntry."Amount to Apply",VendLedgEntry."Remaining Amount",VendLedgEntry."Remaining Pmt. Disc. Possible");
      END;

      //**4PS.sn
      IF Amount = 0 THEN BEGIN
        SetAmountWithRemaining(
          PaymentToleranceMgt.CheckCalcPmtDiscGenJnlVend(Rec,VendLedgEntry,0,FALSE,1),
          VendLedgEntry."Amount to Apply",VendLedgEntry."Remaining Amount",VendLedgEntry."Remain. Pmt. Disc. Possible 2");
      END;
      IF Amount = 0 THEN BEGIN
        SetAmountWithRemaining(
          PaymentToleranceMgt.CheckCalcPmtDiscGenJnlVend(Rec,VendLedgEntry,0,FALSE,21),
          VendLedgEntry."Amount to Apply",VendLedgEntry."Remaining Amount",VendLedgEntry."Remain. Pmt. Disc. Possible 3");
      END;
      //**4PS.en
    END;

    LOCAL PROCEDURE SetAmountWithEmplLedgEntry@176();
    BEGIN
      IF Amount = 0 THEN BEGIN
        EmplLedgEntry.CALCFIELDS("Remaining Amount");
        SetAmountWithRemaining(FALSE,EmplLedgEntry."Amount to Apply",EmplLedgEntry."Remaining Amount",0.0);
      END;
    END;

    [External]
    PROCEDURE CheckModifyCurrencyCode@105(AccountType@1000 : Option;CustVendLedgEntryCurrencyCode@1001 : Code[10]);
    BEGIN
      IF Amount = 0 THEN
        UpdateCurrencyCode(CustVendLedgEntryCurrencyCode)
      ELSE
        GenJnlApply.CheckAgainstApplnCurrency(
          "Currency Code",CustVendLedgEntryCurrencyCode,AccountType,TRUE);
    END;

    LOCAL PROCEDURE SetAmountWithRemaining@101(CalcPmtDisc@1000 : Boolean;AmountToApply@1001 : Decimal;RemainingAmount@1002 : Decimal;RemainingPmtDiscPossible@1003 : Decimal);
    BEGIN
      IF AmountToApply <> 0 THEN
        IF CalcPmtDisc AND (ABS(AmountToApply) >= ABS(RemainingAmount - RemainingPmtDiscPossible)) THEN
          Amount := -(RemainingAmount - RemainingPmtDiscPossible)
        ELSE
          Amount := -AmountToApply
      ELSE
        IF CalcPmtDisc THEN
          Amount := -(RemainingAmount - RemainingPmtDiscPossible)
        ELSE
          Amount := -RemainingAmount;
      IF "Bal. Account Type" IN ["Bal. Account Type"::Customer,"Bal. Account Type"::Vendor] THEN
        Amount := -Amount;

      OnAfterSetAmountWithRemaining(Rec);
      ValidateAmount(FALSE);
    END;

    [External]
    PROCEDURE IsOpenedFromBatch@87() : Boolean;
    VAR
      GenJournalBatch@1002 : Record 232;
      TemplateFilter@1001 : Text;
      BatchFilter@1000 : Text;
    BEGIN
      BatchFilter := GETFILTER("Journal Batch Name");
      IF (BatchFilter = '') AND ("Journal Batch Name" <> '') THEN
        BatchFilter := "Journal Batch Name";

      IF BatchFilter <> '' THEN BEGIN
        TemplateFilter := GETFILTER("Journal Template Name");
        IF (TemplateFilter = '') AND ("Journal Template Name" <> '') THEN BEGIN
          TemplateFilter := "Journal Template Name";
          SETFILTER("Journal Template Name",TemplateFilter);
        END;
        IF TemplateFilter <> '' THEN
          GenJournalBatch.SETFILTER("Journal Template Name",TemplateFilter);
        GenJournalBatch.SETFILTER(Name,BatchFilter);
        GenJournalBatch.FINDFIRST;
      END;

      EXIT((("Journal Batch Name" <> '') AND ("Journal Template Name" = '')) OR (BatchFilter <> ''));
    END;

    [External]
    PROCEDURE GetDeferralAmount@88() DeferralAmount : Decimal;
    BEGIN
      IF "VAT Base Amount" <> 0 THEN
        DeferralAmount := "VAT Base Amount"
      ELSE
        DeferralAmount := Amount;
      OnAfterGetDeferralAmount(Rec,DeferralAmount);
    END;

    PROCEDURE ShowDeferrals@108(PostingDate@1000 : Date;CurrencyCode@1001 : Code[10]) : Boolean;
    VAR
      DeferralUtilities@1002 : Codeunit 1720;
    BEGIN
      EXIT(
        DeferralUtilities.OpenLineScheduleEdit(
          "Deferral Code",GetDeferralDocType,"Journal Template Name","Journal Batch Name",0,'',"Line No.",
          GetDeferralAmount,PostingDate,Description,CurrencyCode));
    END;

    [External]
    PROCEDURE GetDeferralDocType@106() : Integer;
    BEGIN
      EXIT(DeferralDocType::"G/L");
    END;

    [External]
    PROCEDURE IsForPurchase@86() : Boolean;
    BEGIN
      IF ("Account Type" = "Account Type"::Vendor) OR ("Bal. Account Type" = "Bal. Account Type"::Vendor) THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE IsForSales@89() : Boolean;
    BEGIN
      IF ("Account Type" = "Account Type"::Customer) OR ("Bal. Account Type" = "Bal. Account Type"::Customer) THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckGenJournalLinePostRestrictions@90();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckGenJournalLinePrintCheckRestrictions@92();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnMoveGenJournalLine@93(ToRecordID@1000 : RecordID);
    BEGIN
    END;

    [External]
    PROCEDURE IncrementDocumentNo@120(GenJnlBatch@1000 : Record 232;VAR LastDocNumber@1002 : Code[20]);
    VAR
      NoSeriesLine@1001 : Record 309;
    BEGIN
      IF GenJnlBatch."No. Series" <> '' THEN BEGIN
        NoSeriesMgt.SetNoSeriesLineFilter(NoSeriesLine,GenJnlBatch."No. Series","Posting Date");
        IF NoSeriesLine."Increment-by No." > 1 THEN
          NoSeriesMgt.IncrementNoText(LastDocNumber,NoSeriesLine."Increment-by No.")
        ELSE
          LastDocNumber := INCSTR(LastDocNumber);
      END ELSE
        LastDocNumber := INCSTR(LastDocNumber);
    END;

    [External]
    PROCEDURE NeedCheckZeroAmount@196() : Boolean;
    BEGIN
      EXIT(
        ("Account No." <> '') AND
        NOT "System-Created Entry" AND
        NOT "Allow Zero-Amount Posting" AND
        ("Account Type" <> "Account Type"::"Fixed Asset"));
    END;

    [External]
    PROCEDURE IsRecurring@199() : Boolean;
    VAR
      GenJournalTemplate@1000 : Record 80;
    BEGIN
      IF "Journal Template Name" <> '' THEN
        IF GenJournalTemplate.GET("Journal Template Name") THEN
          EXIT(GenJournalTemplate.Recurring);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE SuggestBalancingAmount@46(LastGenJnlLine@1001 : Record 81;BottomLine@1003 : Boolean);
    VAR
      GenJournalLine@1000 : Record 81;
    BEGIN
      IF "Document No." = '' THEN
        EXIT;
      IF GETFILTERS <> '' THEN
        EXIT;

      GenJournalLine.SETRANGE("Journal Template Name",LastGenJnlLine."Journal Template Name");
      GenJournalLine.SETRANGE("Journal Batch Name",LastGenJnlLine."Journal Batch Name");
      IF BottomLine THEN
        GenJournalLine.SETFILTER("Line No.",'<=%1',LastGenJnlLine."Line No.")
      ELSE
        GenJournalLine.SETFILTER("Line No.",'<%1',LastGenJnlLine."Line No.");

      IF GenJournalLine.FINDLAST THEN BEGIN
        IF BottomLine THEN BEGIN
          GenJournalLine.SETRANGE("Document No.",LastGenJnlLine."Document No.");
          GenJournalLine.SETRANGE("Posting Date",LastGenJnlLine."Posting Date");
        END ELSE BEGIN
          GenJournalLine.SETRANGE("Document No.",GenJournalLine."Document No.");
          GenJournalLine.SETRANGE("Posting Date",GenJournalLine."Posting Date");
        END;
        GenJournalLine.SETRANGE("Bal. Account No.",'');
        IF GenJournalLine.FINDFIRST THEN BEGIN
          GenJournalLine.CALCSUMS(Amount);
          "Document No." := GenJournalLine."Document No.";
          "Posting Date" := GenJournalLine."Posting Date";
          VALIDATE(Amount,-GenJournalLine.Amount);
        END;
      END;
    END;

    LOCAL PROCEDURE GetGLAccount@146();
    VAR
      GLAcc@1000 : Record 15;
    BEGIN
      GLAcc.CHANGECOMPANY("Receiving Company");  //**4PS.n
      GLAcc.GET("Account No.");
      CheckGLAcc(GLAcc);
      //IF ReplaceDescription AND (NOT GLAcc."Omit Default Descr. in Jnl.") THEN //**4PS.o
      IF ReplaceDescription AND ReplaceDescriptionXtraCondition THEN //**4PS.n
        UpdateDescription(GLAcc.Name);
      IF ("Bal. Account No." = '') OR
         ("Bal. Account Type" IN
          ["Bal. Account Type"::"G/L Account","Bal. Account Type"::"Bank Account"])
      THEN BEGIN
        "Posting Group" := '';
        "Salespers./Purch. Code" := '';
        "Payment Terms Code" := '';
      END;
      IF "Bal. Account No." = '' THEN
        "Currency Code" := '';
      IF CopyVATSetupToJnlLines THEN BEGIN
        "Gen. Posting Type" := GLAcc."Gen. Posting Type";
        "Gen. Bus. Posting Group" := GLAcc."Gen. Bus. Posting Group";
        "Gen. Prod. Posting Group" := GLAcc."Gen. Prod. Posting Group";
        "VAT Bus. Posting Group" := GLAcc."VAT Bus. Posting Group";
        "VAT Prod. Posting Group" := GLAcc."VAT Prod. Posting Group";
      END;
      "Auto. Acc. Group" := GLAcc."Auto. Acc. Group";  //NAVSE.FI
      GetPlantPostingGroup; //**4PS.n
      "Tax Area Code" := GLAcc."Tax Area Code";
      "Tax Liable" := GLAcc."Tax Liable";
      "Tax Group Code" := GLAcc."Tax Group Code";
      IF "Posting Date" <> 0D THEN
        IF "Posting Date" = CLOSINGDATE("Posting Date") THEN BEGIN
          ClearPostingGroups;
          "Auto. Acc. Group" := '';  //NAVSE.FI
        END;
      VALIDATE("Deferral Code",GLAcc."Default Deferral Template Code");

      OnAfterAccountNoOnValidateGetGLAccount(Rec,GLAcc);
    END;

    LOCAL PROCEDURE GetGLBalAccount@121();
    VAR
      GLAcc@1000 : Record 15;
    BEGIN
      GLAcc.GET("Bal. Account No.");
      CheckGLAcc(GLAcc);
      CheckBalanceAcc(GLAcc); //**4PS.n 026430
      IF "Account No." = '' THEN BEGIN
        IF "Plant Type" = '' THEN //**4PS.n
          Description := GLAcc.Name;
        "Currency Code" := '';
      END;
      IF ("Account No." = '') OR
         ("Account Type" IN
          ["Account Type"::"G/L Account","Account Type"::"Bank Account"])
      THEN BEGIN
        IF "Plant Type" = '' THEN //**4PS.n
          "Posting Group" := '';
        "Salespers./Purch. Code" := '';
        "Payment Terms Code" := '';
      END;
      IF CopyVATSetupToJnlLines THEN BEGIN
        "Bal. Gen. Posting Type" := GLAcc."Gen. Posting Type";
        "Bal. Gen. Bus. Posting Group" := GLAcc."Gen. Bus. Posting Group";
        "Bal. Gen. Prod. Posting Group" := GLAcc."Gen. Prod. Posting Group";
        "Bal. VAT Bus. Posting Group" := GLAcc."VAT Bus. Posting Group";
        "Bal. VAT Prod. Posting Group" := GLAcc."VAT Prod. Posting Group";
      END;
      "Bal. Tax Area Code" := GLAcc."Tax Area Code";
      "Bal. Tax Liable" := GLAcc."Tax Liable";
      "Bal. Tax Group Code" := GLAcc."Tax Group Code";
      IF "Posting Date" <> 0D THEN
        IF "Posting Date" = CLOSINGDATE("Posting Date") THEN
          ClearBalancePostingGroups;

      OnAfterAccountNoOnValidateGetGLBalAccount(Rec,GLAcc);
    END;

    LOCAL PROCEDURE GetCustomerAccount@47();
    VAR
      Cust@1000 : Record 18;
      ConfirmManagement@1001 : Codeunit 27;
    BEGIN
      Cust.CHANGECOMPANY("Receiving Company"); //**4PS.n
      Cust.GET("Account No.");
      Cust.CheckBlockedCustOnJnls(Cust,"Document Type",FALSE);
      CheckICPartner(Cust."IC Partner Code","Account Type","Account No.");
      UpdateDescription(Cust.Name);
      "Payment Method Code" := Cust."Payment Method Code";
      VALIDATE("Recipient Bank Account",Cust."Preferred Bank Account Code");
      "Posting Group" := Cust."Customer Posting Group";
      SetSalespersonPurchaserCode(Cust."Salesperson Code","Salespers./Purch. Code");
      "Payment Terms Code" := Cust."Payment Terms Code";
      IF "Receiving Company" = '' THEN BEGIN //**4PS.n
        VALIDATE("Bill-to/Pay-to No.","Account No.");
        VALIDATE("Sell-to/Buy-from No.","Account No.");
      END; //**4PS.n
      IF NOT SetCurrencyCode("Bal. Account Type","Bal. Account No.") THEN
        "Currency Code" := Cust."Currency Code";
      ClearPostingGroups;
      IF (Cust."Bill-to Customer No." <> '') AND (Cust."Bill-to Customer No." <> "Account No.") AND
         NOT HideValidationDialog
      THEN
        IF NOT ConfirmManagement.ConfirmProcess(
             STRSUBSTNO(
               Text014,Cust.TABLECAPTION,Cust."No.",Cust.FIELDCAPTION("Bill-to Customer No."),
               Cust."Bill-to Customer No."),TRUE)
        THEN
          ERROR('');
      VALIDATE("Payment Terms Code");
      CheckPaymentTolerance;

      OnAfterAccountNoOnValidateGetCustomerAccount(Rec,Cust,CurrFieldNo);
    END;

    LOCAL PROCEDURE GetCustomerBalAccount@122();
    VAR
      Cust@1000 : Record 18;
      ConfirmManagement@1001 : Codeunit 27;
    BEGIN
      Cust.CHANGECOMPANY("Receiving Company"); //**4PS.n
      Cust.GET("Bal. Account No.");
      Cust.CheckBlockedCustOnJnls(Cust,"Document Type",FALSE);
      CheckICPartner(Cust."IC Partner Code","Bal. Account Type","Bal. Account No.");
      IF "Account No." = '' THEN
        Description := Cust.Name;
      "Payment Method Code" := Cust."Payment Method Code";
      VALIDATE("Recipient Bank Account",Cust."Preferred Bank Account Code");
      "Posting Group" := Cust."Customer Posting Group";
      SetSalespersonPurchaserCode(Cust."Salesperson Code","Salespers./Purch. Code");
      "Payment Terms Code" := Cust."Payment Terms Code";
      VALIDATE("Bill-to/Pay-to No.","Bal. Account No.");
      VALIDATE("Sell-to/Buy-from No.","Bal. Account No.");
      IF ("Account No." = '') OR ("Account Type" = "Account Type"::"G/L Account") THEN
        "Currency Code" := Cust."Currency Code";
      IF ("Account Type" = "Account Type"::"Bank Account") AND ("Currency Code" = '') THEN
        "Currency Code" := Cust."Currency Code";
      ClearBalancePostingGroups;
      IF (Cust."Bill-to Customer No." <> '') AND (Cust."Bill-to Customer No." <> "Bal. Account No.") AND
         NOT HideValidationDialog
      THEN
        IF NOT ConfirmManagement.ConfirmProcess(
             STRSUBSTNO(
               Text014,Cust.TABLECAPTION,Cust."No.",Cust.FIELDCAPTION("Bill-to Customer No."),
               Cust."Bill-to Customer No."),TRUE)
        THEN
          ERROR('');
      VALIDATE("Payment Terms Code");
      CheckPaymentTolerance;

      OnAfterAccountNoOnValidateGetCustomerBalAccount(Rec,Cust,CurrFieldNo);
    END;

    LOCAL PROCEDURE GetVendorAccount@115();
    VAR
      Vend@1000 : Record 23;
      ConfirmManagement@1001 : Codeunit 27;
    BEGIN
      Vend.GET("Account No.");
      Vend.CheckBlockedVendOnJnls(Vend,"Document Type",FALSE);
      CheckICPartner(Vend."IC Partner Code","Account Type","Account No.");
      UpdateDescription(Vend.Name);
      "Payment Method Code" := Vend."Payment Method Code";
      "Creditor No." := Vend."Creditor No.";
      "Giro Acc. No." := Vend."Giro Acc. No.";  //NAVDK
      OnGenJnlLineGetVendorAccount(Vend);

      VALIDATE("Recipient Bank Account",Vend."Preferred Bank Account Code");
      "Posting Group" := Vend."Vendor Posting Group";
      SetSalespersonPurchaserCode(Vend."Purchaser Code","Salespers./Purch. Code");
      "Payment Terms Code" := Vend."Payment Terms Code";
      IF "Receiving Company" = '' THEN BEGIN //**4PS.n
        VALIDATE("Bill-to/Pay-to No.","Account No.");
        VALIDATE("Sell-to/Buy-from No.","Account No.");
      END; //**4PS.n
      IF NOT SetCurrencyCode("Bal. Account Type","Bal. Account No.") THEN
        "Currency Code" := Vend."Currency Code";
      ClearPostingGroups;
      IF (Vend."Pay-to Vendor No." <> '') AND (Vend."Pay-to Vendor No." <> "Account No.") AND
         NOT HideValidationDialog
      THEN
        IF NOT ConfirmManagement.ConfirmProcess(
             STRSUBSTNO(
               Text014,Vend.TABLECAPTION,Vend."No.",Vend.FIELDCAPTION("Pay-to Vendor No."),
               Vend."Pay-to Vendor No."),TRUE)
        THEN
          ERROR('');
      VALIDATE("Payment Terms Code");
      CheckPaymentTolerance;

      // PEB0052
      "External Document No." := Vend."External Document No.";
      // 0052
      IF GLSetup."Norwegian Localization Active" AND ("Document Type" = "Document Type"::Invoice) THEN BEGIN
      //IF "Document Type" = "Document Type"::Invoice THEN BEGIN
        GenJnlLineExt.InitGetLine(Rec);//4PSSE
        VendorExt.InitGetLine(Vend);//4PSSE
        GenJnlLineExt."Payment Type Code Abroad" := VendorExt."Payment Type Code Abroad";
        GenJnlLineExt."Specification (Norges Bank)" := VendorExt."Specification (Norges Bank)";
        GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE
      END;
      //NAVNO

      OnAfterAccountNoOnValidateGetVendorAccount(Rec,Vend,CurrFieldNo);
    END;

    LOCAL PROCEDURE GetEmployeeAccount@188();
    VAR
      Employee@1000 : Record 5200;
    BEGIN
      Employee.GET("Account No.");
      Employee.CheckBlockedEmployeeOnJnls(FALSE);
      UpdateDescriptionWithEmployeeName(Employee);
      VALIDATE("Recipient Bank Account",Employee."No.");
      "Posting Group" := Employee."Employee Posting Group";
      SetSalespersonPurchaserCode(Employee."Salespers./Purch. Code","Salespers./Purch. Code");
      "Currency Code" := '';
      ClearPostingGroups;

      OnAfterAccountNoOnValidateGetEmployeeAccount(Rec,Employee);
    END;

    LOCAL PROCEDURE GetVendorBalAccount@123();
    VAR
      Vend@1000 : Record 23;
      ConfirmManagement@1001 : Codeunit 27;
    BEGIN
      Vend.GET("Bal. Account No.");
      Vend.CheckBlockedVendOnJnls(Vend,"Document Type",FALSE);
      CheckICPartner(Vend."IC Partner Code","Bal. Account Type","Bal. Account No.");
      IF "Account No." = '' THEN
        Description := Vend.Name;
      "Payment Method Code" := Vend."Payment Method Code";
      VALIDATE("Recipient Bank Account",Vend."Preferred Bank Account Code");
      "Posting Group" := Vend."Vendor Posting Group";
      SetSalespersonPurchaserCode(Vend."Purchaser Code","Salespers./Purch. Code");
      "Payment Terms Code" := Vend."Payment Terms Code";
      VALIDATE("Bill-to/Pay-to No.","Bal. Account No.");
      VALIDATE("Sell-to/Buy-from No.","Bal. Account No.");
      IF ("Account No." = '') OR ("Account Type" = "Account Type"::"G/L Account") THEN
        "Currency Code" := Vend."Currency Code";
      IF ("Account Type" = "Account Type"::"Bank Account") AND ("Currency Code" = '') THEN
        "Currency Code" := Vend."Currency Code";
      ClearBalancePostingGroups;
      IF (Vend."Pay-to Vendor No." <> '') AND (Vend."Pay-to Vendor No." <> "Bal. Account No.") AND
         NOT HideValidationDialog
      THEN
        IF NOT ConfirmManagement.ConfirmProcess(
             STRSUBSTNO(
               Text014,Vend.TABLECAPTION,Vend."No.",Vend.FIELDCAPTION("Pay-to Vendor No."),
               Vend."Pay-to Vendor No."),TRUE)
        THEN
          ERROR('');
      VALIDATE("Payment Terms Code");
      CheckPaymentTolerance;

      OnAfterAccountNoOnValidateGetVendorBalAccount(Rec,Vend,CurrFieldNo);
    END;

    LOCAL PROCEDURE GetEmployeeBalAccount@177();
    VAR
      Employee@1000 : Record 5200;
    BEGIN
      Employee.GET("Bal. Account No.");
      Employee.CheckBlockedEmployeeOnJnls(FALSE);
      IF "Account No." = '' THEN
        UpdateDescriptionWithEmployeeName(Employee);
      VALIDATE("Recipient Bank Account",Employee."No.");
      "Posting Group" := Employee."Employee Posting Group";
      SetSalespersonPurchaserCode(Employee."Salespers./Purch. Code","Salespers./Purch. Code");
      "Currency Code" := '';
      ClearBalancePostingGroups;

      OnAfterAccountNoOnValidateGetEmployeeBalAccount(Rec,Employee,CurrFieldNo);
    END;

    LOCAL PROCEDURE GetBankAccount@116();
    VAR
      BankAcc@1000 : Record 270;
    BEGIN
      BankAcc.GET("Account No.");
      BankAcc.TESTFIELD(Blocked,FALSE);
      IF ReplaceDescription THEN
        UpdateDescription(BankAcc.Name);
      IF ("Bal. Account No." = '') OR
         ("Bal. Account Type" IN
          ["Bal. Account Type"::"G/L Account","Bal. Account Type"::"Bank Account"])
      THEN BEGIN
        "Posting Group" := '';
        "Salespers./Purch. Code" := '';
        "Payment Terms Code" := '';
      END;
      IF BankAcc."Currency Code" = '' THEN BEGIN
        IF "Bal. Account No." = '' THEN
          "Currency Code" := '';
      END ELSE
        IF SetCurrencyCode("Bal. Account Type","Bal. Account No.") THEN
          BankAcc.TESTFIELD("Currency Code","Currency Code")
        ELSE
          "Currency Code" := BankAcc."Currency Code";
      ClearPostingGroups;

      OnAfterAccountNoOnValidateGetBankAccount(Rec,BankAcc,CurrFieldNo);
    END;

    LOCAL PROCEDURE GetBankBalAccount@124();
    VAR
      BankAcc@1000 : Record 270;
    BEGIN
      BankAcc.GET("Bal. Account No.");
      BankAcc.TESTFIELD(Blocked,FALSE);
      IF "Account No." = '' THEN
        Description := BankAcc.Name;

      IF ("Account No." = '') OR
         ("Account Type" IN
          ["Account Type"::"G/L Account","Account Type"::"Bank Account"])
      THEN BEGIN
        "Posting Group" := '';
        "Salespers./Purch. Code" := '';
        "Payment Terms Code" := '';
      END;
      IF BankAcc."Currency Code" = '' THEN
        IF "Account No." = '' THEN
          "Currency Code" := ''
        ELSE
          ClearCurrencyCode
      ELSE
        IF SetCurrencyCode("Bal. Account Type","Bal. Account No.") THEN
          BankAcc.TESTFIELD("Currency Code","Currency Code")
        ELSE
          "Currency Code" := BankAcc."Currency Code";
      ClearBalancePostingGroups;

      OnAfterAccountNoOnValidateGetBankBalAccount(Rec,BankAcc,CurrFieldNo);
    END;

    LOCAL PROCEDURE GetFAAccount@117();
    VAR
      FA@1000 : Record 5600;
    BEGIN
      FA.GET("Account No.");
      FA.TESTFIELD(Blocked,FALSE);
      FA.TESTFIELD(Inactive,FALSE);
      FA.TESTFIELD("Budgeted Asset",FALSE);
      UpdateDescription(FA.Description);
      "Depreciation Book Code" := FA.GetFA_MainDeprBook("Account No.",TRUE);  //**4PS.n
      GetFADeprBook("Account No.");
      GetFAVATSetup;
      GetFAAddCurrExchRate;

      OnAfterAccountNoOnValidateGetFAAccount(Rec,FA);
    END;

    LOCAL PROCEDURE GetFABalAccount@125();
    VAR
      FA@1000 : Record 5600;
    BEGIN
      FA.GET("Bal. Account No.");
      FA.TESTFIELD(Blocked,FALSE);
      FA.TESTFIELD(Inactive,FALSE);
      FA.TESTFIELD("Budgeted Asset",FALSE);
      IF "Account No." = '' THEN
        Description := FA.Description;

      "Depreciation Book Code" := FA.GetFA_MainDeprBook("Bal. Account No.",TRUE); //**4PS.n

      GetFADeprBook("Bal. Account No.");
      //**4PS.sn
      IF "Depreciation Book Code" <> '' THEN
        CreateDimForFAPostingGroup; //**4PS call C-026623
      //**4PS.en
      GetFAVATSetup;
      GetFAAddCurrExchRate;

      OnAfterAccountNoOnValidateGetFABalAccount(Rec,FA);
    END;

    LOCAL PROCEDURE GetICPartnerAccount@118();
    VAR
      ICPartner@1000 : Record 413;
    BEGIN
      ICPartner.GET("Account No.");
      ICPartner.CheckICPartner;
      UpdateDescription(ICPartner.Name);
      IF ("Bal. Account No." = '') OR ("Bal. Account Type" = "Bal. Account Type"::"G/L Account") THEN
        "Currency Code" := ICPartner."Currency Code";
      IF ("Bal. Account Type" = "Bal. Account Type"::"Bank Account") AND ("Currency Code" = '') THEN
        "Currency Code" := ICPartner."Currency Code";
      ClearPostingGroups;
      "IC Partner Code" := "Account No.";

      OnAfterAccountNoOnValidateGetICPartnerAccount(Rec,ICPartner);
    END;

    LOCAL PROCEDURE GetICPartnerBalAccount@126();
    VAR
      ICPartner@1000 : Record 413;
    BEGIN
      ICPartner.GET("Bal. Account No.");
      IF "Account No." = '' THEN
        Description := ICPartner.Name;

      IF ("Account No." = '') OR ("Account Type" = "Account Type"::"G/L Account") THEN
        "Currency Code" := ICPartner."Currency Code";
      IF ("Account Type" = "Account Type"::"Bank Account") AND ("Currency Code" = '') THEN
        "Currency Code" := ICPartner."Currency Code";
      ClearBalancePostingGroups;
      "IC Partner Code" := "Bal. Account No.";

      OnAfterAccountNoOnValidateGetICPartnerBalAccount(Rec,ICPartner);
    END;

    [External]
    PROCEDURE CreateFAAcquisitionLines@131(VAR FAGenJournalLine@1008 : Record 81);
    VAR
      BalancingGenJnlLine@1006 : Record 81;
      LocalGLAcc@1001 : Record 15;
      FAPostingGr@1000 : Record 5606;
    BEGIN
      TESTFIELD("Journal Template Name");
      TESTFIELD("Journal Batch Name");
      TESTFIELD("Posting Date");
      TESTFIELD("Account Type");
      TESTFIELD("Account No.");
      TESTFIELD("Posting Date");

      // Creating Fixed Asset Line
      FAGenJournalLine.INIT;
      FAGenJournalLine.VALIDATE("Journal Template Name","Journal Template Name");
      FAGenJournalLine.VALIDATE("Journal Batch Name","Journal Batch Name");
      FAGenJournalLine.VALIDATE("Line No.",GetNewLineNo("Journal Template Name","Journal Batch Name"));
      FAGenJournalLine.VALIDATE("Document Type","Document Type");
      FAGenJournalLine.VALIDATE("Document No.",GenerateLineDocNo("Journal Batch Name","Posting Date","Journal Template Name"));
      FAGenJournalLine.VALIDATE("Account Type","Account Type");
      FAGenJournalLine.VALIDATE("Account No.","Account No.");
      FAGenJournalLine.VALIDATE(Amount,Amount);
      FAGenJournalLine.VALIDATE("Posting Date","Posting Date");
      FAGenJournalLine.VALIDATE("FA Posting Type","FA Posting Type"::"Acquisition Cost");
      FAGenJournalLine.VALIDATE("External Document No.","External Document No.");
      FAGenJournalLine.INSERT(TRUE);

      // Creating Balancing Line
      BalancingGenJnlLine.COPY(FAGenJournalLine);
      BalancingGenJnlLine.VALIDATE("Account Type","Bal. Account Type");
      BalancingGenJnlLine.VALIDATE("Account No.","Bal. Account No.");
      BalancingGenJnlLine.VALIDATE(Amount,-Amount);
      BalancingGenJnlLine.VALIDATE("Line No.",GetNewLineNo("Journal Template Name","Journal Batch Name"));
      BalancingGenJnlLine.INSERT(TRUE);

      FAGenJournalLine.TESTFIELD("Posting Group");

      // Inserting additional fields in Fixed Asset line required for acquisition
      IF FAPostingGr.GET(FAGenJournalLine."Posting Group") THEN BEGIN
        LocalGLAcc.GET(FAPostingGr."Acquisition Cost Account");
        LocalGLAcc.CheckGLAcc;
        FAGenJournalLine.VALIDATE("Gen. Posting Type",LocalGLAcc."Gen. Posting Type");
        FAGenJournalLine.VALIDATE("Gen. Bus. Posting Group",LocalGLAcc."Gen. Bus. Posting Group");
        FAGenJournalLine.VALIDATE("Gen. Prod. Posting Group",LocalGLAcc."Gen. Prod. Posting Group");
        FAGenJournalLine.VALIDATE("VAT Bus. Posting Group",LocalGLAcc."VAT Bus. Posting Group");
        FAGenJournalLine.VALIDATE("VAT Prod. Posting Group",LocalGLAcc."VAT Prod. Posting Group");
        FAGenJournalLine.VALIDATE("Tax Group Code",LocalGLAcc."Tax Group Code");
        FAGenJournalLine.VALIDATE("VAT Prod. Posting Group");
        FAGenJournalLine.MODIFY(TRUE)
      END;

      OnAfterCreateFAAcquisitionLines(FAGenJournalLine,Rec);

      // Inserting Source Code
      IF "Source Code" = '' THEN BEGIN
        GenJnlTemplate.GET("Journal Template Name");
        FAGenJournalLine.VALIDATE("Source Code",GenJnlTemplate."Source Code");
        FAGenJournalLine.MODIFY(TRUE);
        BalancingGenJnlLine.VALIDATE("Source Code",GenJnlTemplate."Source Code");
        BalancingGenJnlLine.MODIFY(TRUE);
      END;
    END;

    LOCAL PROCEDURE GenerateLineDocNo@132(BatchName@1004 : Code[10];PostingDate@1002 : Date;TemplateName@1005 : Code[20]) DocumentNo : Code[20];
    VAR
      GenJournalBatch@1000 : Record 232;
      NoSeriesManagement@1003 : Codeunit 396;
    BEGIN
      GenJournalBatch.GET(TemplateName,BatchName);
      IF GenJournalBatch."No. Series" <> '' THEN
        DocumentNo := NoSeriesManagement.TryGetNextNo(GenJournalBatch."No. Series",PostingDate);
    END;

    LOCAL PROCEDURE GetFilterAccountNo@133() : Code[20];
    BEGIN
      IF GETFILTER("Account No.") <> '' THEN
        IF GETRANGEMIN("Account No.") = GETRANGEMAX("Account No.") THEN
          EXIT(GETRANGEMAX("Account No."));
    END;

    [External]
    PROCEDURE SetAccountNoFromFilter@135();
    VAR
      AccountNo@1000 : Code[20];
    BEGIN
      AccountNo := GetFilterAccountNo;
      IF AccountNo = '' THEN BEGIN
        FILTERGROUP(2);
        AccountNo := GetFilterAccountNo;
        FILTERGROUP(0);
      END;
      IF AccountNo <> '' THEN
        "Account No." := AccountNo;
    END;

    [External]
    PROCEDURE GetNewLineNo@136(TemplateName@1000 : Code[10];BatchName@1001 : Code[10]) : Integer;
    VAR
      GenJournalLine@1002 : Record 81;
    BEGIN
      GenJournalLine.VALIDATE("Journal Template Name",TemplateName);
      GenJournalLine.VALIDATE("Journal Batch Name",BatchName);
      GenJournalLine.SETRANGE("Journal Template Name",TemplateName);
      GenJournalLine.SETRANGE("Journal Batch Name",BatchName);
      IF GenJournalLine.FINDLAST THEN
        EXIT(GenJournalLine."Line No." + 10000);
      EXIT(10000);
    END;

    [External]
    PROCEDURE VoidPaymentFile@139();
    VAR
      TempGenJnlLine@1000 : TEMPORARY Record 81;
      GenJournalLine2@1002 : Record 81;
      VoidTransmitElecPmnts@1001 : Report 9200;
    BEGIN
      TempGenJnlLine.RESET;
      TempGenJnlLine := Rec;
      TempGenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
      TempGenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
      GenJournalLine2.COPYFILTERS(TempGenJnlLine);
      GenJournalLine2.SETFILTER("Document Type",'Payment|Refund');
      GenJournalLine2.SETFILTER("Bank Payment Type",'Electronic Payment|Electronic Payment-IAT');
      GenJournalLine2.SETRANGE("Exported to Payment File",TRUE);
      GenJournalLine2.SETRANGE("Check Transmitted",FALSE);
      IF NOT GenJournalLine2.FINDFIRST THEN
        ERROR(NoEntriesToVoidErr);

      CLEAR(VoidTransmitElecPmnts);
      VoidTransmitElecPmnts.SetUsageType(1);   // Void
      VoidTransmitElecPmnts.SETTABLEVIEW(TempGenJnlLine);
      IF "Account Type" = "Account Type"::"Bank Account" THEN
        VoidTransmitElecPmnts.SetBankAccountNo("Account No.")
      ELSE
        IF "Bal. Account Type" = "Bal. Account Type"::"Bank Account" THEN
          VoidTransmitElecPmnts.SetBankAccountNo("Bal. Account No.");
      VoidTransmitElecPmnts.RUNMODAL;
    END;

    [External]
    PROCEDURE TransmitPaymentFile@142();
    VAR
      TempGenJnlLine@1000 : TEMPORARY Record 81;
      VoidTransmitElecPmnts@1001 : Report 9200;
    BEGIN
      TempGenJnlLine.RESET;
      TempGenJnlLine := Rec;
      TempGenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
      TempGenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
      CLEAR(VoidTransmitElecPmnts);
      VoidTransmitElecPmnts.SetUsageType(2);   // Transmit
      VoidTransmitElecPmnts.SETTABLEVIEW(TempGenJnlLine);
      IF "Account Type" = "Account Type"::"Bank Account" THEN
        VoidTransmitElecPmnts.SetBankAccountNo("Account No.")
      ELSE
        IF "Bal. Account Type" = "Bal. Account Type"::"Bank Account" THEN
          VoidTransmitElecPmnts.SetBankAccountNo("Bal. Account No.");
      VoidTransmitElecPmnts.RUNMODAL;
    END;

    LOCAL PROCEDURE SetSalespersonPurchaserCode@933(SalesperPurchCodeToCheck@1000 : Code[20];VAR SalesperPuchCodeToAssign@1001 : Code[20]);
    BEGIN
      IF SalesperPurchCodeToCheck <> '' THEN
        IF SalespersonPurchaser.GET(SalesperPurchCodeToCheck) THEN
          IF SalespersonPurchaser.VerifySalesPersonPurchaserPrivacyBlocked(SalespersonPurchaser) THEN
            SalesperPuchCodeToAssign := ''
          ELSE
            SalesperPuchCodeToAssign := SalesperPurchCodeToCheck;
    END;

    [External]
    PROCEDURE ValidateSalesPersonPurchaserCode@298(GenJournalLine2@1000 : Record 81);
    BEGIN
      IF GenJournalLine2."Salespers./Purch. Code" <> '' THEN
        IF SalespersonPurchaser.GET(GenJournalLine2."Salespers./Purch. Code") THEN
          IF SalespersonPurchaser.VerifySalesPersonPurchaserPrivacyBlocked(SalespersonPurchaser) THEN
            ERROR(SalespersonPurchPrivacyBlockErr,GenJournalLine2."Salespers./Purch. Code");
    END;

    [External]
    PROCEDURE CheckIfPrivacyBlocked@208();
    VAR
      Customer@1002 : Record 18;
      Vendor@1001 : Record 23;
      Employee@1000 : Record 5200;
    BEGIN
      IF FINDSET THEN BEGIN
        REPEAT
          CASE "Account Type" OF
            "Account Type"::Customer:
              BEGIN
                Customer.GET("Account No.");
                IF Customer."Privacy Blocked" THEN
                  ERROR(Customer.GetPrivacyBlockedGenericErrorText(Customer));
                IF Customer.Blocked = Customer.Blocked::All THEN
                  ERROR(BlockedErr,Customer.Blocked,Customer.TABLECAPTION,Customer."No.");
              END;
            "Account Type"::Vendor:
              BEGIN
                Vendor.GET("Account No.");
                IF Vendor."Privacy Blocked" THEN
                  ERROR(Vendor.GetPrivacyBlockedGenericErrorText(Vendor));
                IF Vendor.Blocked IN [Vendor.Blocked::All,Vendor.Blocked::Payment] THEN
                  ERROR(BlockedErr,Vendor.Blocked,Vendor.TABLECAPTION,Vendor."No.");
              END;
            "Account Type"::Employee:
              BEGIN
                Employee.GET("Account No.");
                IF Employee."Privacy Blocked" THEN
                  ERROR(BlockedEmplErr,Employee."No.");
              END;
          END;
        UNTIL NEXT <= 0;
      END;
    END;

    LOCAL PROCEDURE CheckIfPostingDateIsEarlier@451(GenJournalLine@1000 : Record 81;ApplyPostingDate@1001 : Date;ApplyDocType@1002 : ' ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund';ApplyDocNo@1003 : Code[20]);
    VAR
      IsHandled@1004 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeCheckIfPostingDateIsEarlier(GenJournalLine,ApplyPostingDate,ApplyDocType,ApplyDocNo,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF GenJournalLine."Posting Date" < ApplyPostingDate THEN
      //**4PS.so
      //ERROR(
      //  Text015,GenJournalLine."Document Type",GenJournalLine."Document No.",ApplyDocType,ApplyDocNo);
      //**4PS.eo
      //**4PS.sn
      MESSAGE(Text11012008,GenJournalLine."Document Type",GenJournalLine."Document No.",ApplyDocType,ApplyDocNo);
      //**4PS.en
    END;

    LOCAL PROCEDURE ClearCurrencyCode@211();
    VAR
      BankAccount@1000 : Record 270;
    BEGIN
      IF (xRec."Bal. Account Type" = xRec."Bal. Account Type"::"Bank Account") AND (xRec."Bal. Account No." <> '') THEN BEGIN
        BankAccount.GET(xRec."Bal. Account No.");
        IF BankAccount."Currency Code" = "Currency Code" THEN
          "Currency Code" := '';
      END;
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSetupNewLine@161(VAR GenJournalLine@1000 : Record 81;GenJournalTemplate@1001 : Record 80;GenJournalBatch@1002 : Record 232;LastGenJournalLine@1003 : Record 81;Balance@1004 : Decimal;BottomLine@1005 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterClearCustApplnEntryFields@212(VAR CustLedgerEntry@1000 : Record 21);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterClearEmplApplnEntryFields@218(VAR EmployeeLedgerEntry@1000 : Record 5222);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterClearVendApplnEntryFields@213(VAR VendorLedgerEntry@1000 : Record 25);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromCustLedgEntry@181(CustLedgerEntry@1000 : Record 21;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromGenJnlAllocation@182(GenJnlAllocation@1000 : Record 221;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromSalesHeader@160(SalesHeader@1001 : Record 36;VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromSalesHeaderPrepmt@195(SalesHeader@1000 : Record 36;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromSalesHeaderPrepmtPost@197(SalesHeader@1000 : Record 36;VAR GenJournalLine@1001 : Record 81;UsePmtDisc@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromSalesHeaderApplyTo@200(SalesHeader@1000 : Record 36;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromSalesHeaderPayment@201(SalesHeader@1000 : Record 36;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromPurchHeader@141(PurchaseHeader@1001 : Record 38;VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromPurchHeaderPrepmt@186(PurchaseHeader@1001 : Record 38;VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromPurchHeaderPrepmtPost@187(PurchaseHeader@1000 : Record 38;VAR GenJournalLine@1001 : Record 81;UsePmtDisc@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromPurchHeaderApplyTo@192(PurchaseHeader@1000 : Record 38;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromPurchHeaderPayment@194(PurchaseHeader@1000 : Record 38;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromServHeader@163(ServiceHeader@1001 : Record 5900;VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromServHeaderApplyTo@203(ServiceHeader@1001 : Record 5900;VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromServHeaderPayment@204(ServiceHeader@1001 : Record 5900;VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromInvPostBuffer@144(InvoicePostBuffer@1001 : Record 49;VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromInvPostBufferFA@184(InvoicePostBuffer@1000 : Record 49;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyGenJnlLineFromPrepmtInvBuffer@148(PrepmtInvLineBuffer@1001 : Record 461;VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetGLAccount@145(VAR GenJournalLine@1000 : Record 81;VAR GLAccount@1001 : Record 15);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetGLBalAccount@147(VAR GenJournalLine@1000 : Record 81;VAR GLAccount@1001 : Record 15);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetCustomerAccount@149(VAR GenJournalLine@1000 : Record 81;VAR Customer@1001 : Record 18;CallingFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetCustomerBalAccount@152(VAR GenJournalLine@1000 : Record 81;VAR Customer@1001 : Record 18;CallingFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetVendorAccount@150(VAR GenJournalLine@1000 : Record 81;VAR Vendor@1001 : Record 23;CallingFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetVendorBalAccount@153(VAR GenJournalLine@1000 : Record 81;VAR Vendor@1001 : Record 23;CallingFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetEmployeeAccount@189(VAR GenJournalLine@1000 : Record 81;VAR Employee@1001 : Record 5200);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetEmployeeBalAccount@179(VAR GenJournalLine@1000 : Record 81;VAR Employee@1001 : Record 5200;CallingFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetBankAccount@155(VAR GenJournalLine@1000 : Record 81;VAR BankAccount@1001 : Record 270;CallingFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetBankBalAccount@154(VAR GenJournalLine@1000 : Record 81;VAR BankAccount@1001 : Record 270;CallingFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetFAAccount@157(VAR GenJournalLine@1000 : Record 81;VAR FixedAsset@1001 : Record 5600);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetFABalAccount@156(VAR GenJournalLine@1000 : Record 81;VAR FixedAsset@1001 : Record 5600);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetICPartnerAccount@159(VAR GenJournalLine@1000 : Record 81;VAR ICPartner@1001 : Record 413);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAccountNoOnValidateGetICPartnerBalAccount@158(VAR GenJournalLine@1000 : Record 81;VAR ICPartner@1001 : Record 413);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCreateTempJobJnlLine@151(VAR JobJournalLine@1003 : Record 11072008;GenJournalLine@1002 : Record 81;xGenJournalLine@1001 : Record 81;CurrFieldNo@1000 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCreateTempJobJnlLine@162(VAR JobJournalLine@1003 : Record 11072008;GenJournalLine@1000 : Record 81;xGenJournalLine@1002 : Record 81;CurrFieldNo@1001 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdatePricesFromJobJnlLine@166(VAR GenJournalLine@1000 : Record 81;JobJournalLine@1001 : Record 11072008);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCreateDimTableIDs@164(VAR GenJournalLine@1000 : Record 81;CallingFieldNo@1001 : Integer;VAR TableID@1003 : ARRAY [10] OF Integer;VAR No@1002 : ARRAY [10] OF Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCreateFAAcquisitionLines@245(VAR FAGenJournalLine@1000 : Record 81;GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterClearPostingGroups@168(VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterClearBalPostingGroups@169(VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetCustLedgerEntry@234(VAR GenJournalLine@1000 : Record 81;CustLedgerEntry@1001 : Record 21);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetDeferralAmount@275(VAR GenJournalLine@1000 : Record 81;VAR DeferralAmount@1001 : Decimal);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetEmplLedgerEntry@237(VAR GenJournalLine@1000 : Record 81;EmployeeLedgerEntry@1001 : Record 5222);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetVATPostingSetup@264(VAR VATPostingSetup@1000 : Record 325);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetVendLedgerEntry@236(VAR GenJournalLine@1000 : Record 81;VendorLedgerEntry@1001 : Record 25);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterInitNewLine@263(VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSalesTaxCalculateCalculateTax@253(VAR GenJournalLine@1000 : Record 81;CurrentFieldNo@1001 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSalesTaxCalculateReverseCalculateTax@254(VAR GenJournalLine@1000 : Record 81;CurrentFieldNo@1001 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterValidateApplyRequirements@207(TempGenJnlLine@1000 : TEMPORARY Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterValidateShortcutDimCode@262(VAR GenJournalLine@1000 : Record 81;FieldNumber@1002 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCheckDirectPosting@220(VAR GLAccount@1000 : Record 15;GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSetAmountWithRemaining@233(VAR GenJournalLine@1000 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSetJournalLineFieldsFromApplication@231(VAR GenJournalLine@1000 : Record 81;AccType@1002 : 'G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner,Employee';AccNo@1001 : Code[20];xGenJournalLine@1003 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateDocumentTypeAndAppliesToFields@221(VAR GenJournalLine@1000 : Record 81;DocType@1002 : Integer;DocNo@1001 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckDirectPosting@219(VAR GLAccount@1000 : Record 15;VAR IsHandled@1001 : Boolean;GenJournalLine@1002 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckIfPostingDateIsEarlier@355(GenJournalLine@1003 : Record 81;ApplyPostingDate@1002 : Date;ApplyDocType@1001 : ' ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund';ApplyDocNo@1000 : Code[20];VAR IsHandled@1004 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckDocNoBasedOnNoSeries@260(VAR GenJournalLine@1000 : Record 81;LastDocNo@1003 : Code[20];NoSeriesCode@1002 : Code[20];VAR NoSeriesMgtInstance@1001 : Codeunit 396;VAR IsHandled@1004 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeEmptyLine@265(GenJournalLine@1000 : Record 81;VAR Result@1001 : Boolean;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeLookUpAppliesToDocCust@214(GenJournalLine@1000 : Record 81;AccNo@1001 : Code[20];VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeLookUpAppliesToDocEmpl@216(GenJournalLine@1001 : Record 81;AccNo@1000 : Code[20];VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeLookUpAppliesToDocVend@215(GenJournalLine@1001 : Record 81;AccNo@1000 : Code[20];VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeSetAmountWithCustLedgEntry@232(VAR GenJournalLine@1000 : Record 81;VAR CustLedgerEntry@1001 : Record 21);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeSetAmountWithVendLedgEntry@230(VAR GenJournalLine@1000 : Record 81;VAR VendorLedgerEntry@1001 : Record 25);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnLookUpAppliesToDocCustOnAfterSetFilters@235(VAR CustLedgerEntry@1000 : Record 21;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeValidateApplyRequirements@276(VAR TempGenJournalLine@1000 : TEMPORARY Record 81;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeValidateBalGenBusPostingGroup@248(VAR GenJournalLine@1001 : Record 81;VAR CheckIfFieldIsEmpty@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeValidateBalGenPostingType@246(VAR GenJournalLine@1001 : Record 81;VAR CheckIfFieldIsEmpty@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeValidateBalGenProdPostingGroup@249(VAR GenJournalLine@1001 : Record 81;VAR CheckIfFieldIsEmpty@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeValidateGenBusPostingGroup@240(VAR GenJournalLine@1000 : Record 81;VAR CheckIfFieldIsEmpty@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeValidateGenPostingType@244(VAR GenJournalLine@1001 : Record 81;VAR CheckIfFieldIsEmpty@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeValidateGenProdPostingGroup@241(VAR GenJournalLine@1001 : Record 81;VAR CheckIfFieldIsEmpty@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeValidateShortcutDimCode@261(VAR GenJournalLine@1000 : Record 81;FieldNumber@1002 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetFAVATSetupOnBeforeCheckGLAcc@247(VAR GenJournalLine@1000 : Record 81;GLAccount@1001 : Record 15);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetCustLedgerEntryOnAfterAssignCustomerNo@242(VAR GenJournalLine@1000 : Record 81;CustLedgerEntry@1001 : Record 21);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetVendLedgerEntryOnAfterAssignVendorNo@243(VAR GenJournalLine@1000 : Record 81;VendorLedgerEntry@1001 : Record 25);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnLookUpAppliesToDocCustOnAfterUpdateDocumentTypeAndAppliesTo@225(VAR GenJournalLine@1000 : Record 81;CustLedgerEntry@1001 : Record 21);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnLookUpAppliesToDocEmplOnAfterSetFilters@239(VAR EmployeeLedgerEntry@1000 : Record 5222;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnLookUpAppliesToDocEmplOnAfterUpdateDocumentTypeAndAppliesTo@229(VAR GenJournalLine@1000 : Record 81;EmployeeLedgerEntry@1001 : Record 5222);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnLookUpAppliesToDocVendOnAfterSetFilters@238(VAR VendorLedgerEntry@1000 : Record 25;VAR GenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnLookUpAppliesToDocVendOnAfterUpdateDocumentTypeAndAppliesTo@227(VAR GenJournalLine@1000 : Record 81;VendorLedgerEntry@1001 : Record 25);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnModifyOnBeforeTestCheckPrinted@293(VAR GenJournalLine@1000 : Record 81;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnSetUpNewLineOnBeforeIncrDocNo@250(VAR GenJournalLine@1000 : Record 81;LastGenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration(TRUE)]
    LOCAL PROCEDURE OnUpdateLineBalanceOnAfterAssignBalanceLCY@226(VAR BalanceLCY@1000 : Decimal);
    BEGIN
    END;

    [Integration(TRUE)]
    LOCAL PROCEDURE OnValidateAmountOnAfterAssignAmountLCY@222(VAR AmountLCY@1000 : Decimal);
    BEGIN
    END;

    [Integration(TRUE)]
    LOCAL PROCEDURE OnValidateBalVATPctOnAfterAssignBalVATAmountLCY@224(VAR BalVATAmountLCY@1000 : Decimal);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidatePaymentTermsCodeOnBeforeCalculateDueDate@251(VAR GenJournalLine@1000 : Record 81;PaymentTerms@1001 : Record 3;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidatePaymentTermsCodeOnBeforeCalculatePmtDiscountDate@252(VAR GenJournalLine@1002 : Record 81;PaymentTerms@1001 : Record 3;VAR IsHandled@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateVATBaseAmountOnBeforeValidateAmount@273(VAR GenJournalLine@1001 : Record 81;Currency@1000 : Record 4);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateVATPctOnBeforeUpdateSalesPurchLCY@271(VAR GenJournalLine@1000 : Record 81;Currency@1001 : Record 4);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateVATProdPostingGroupOnBeforeVATCalculationCheck@266(VAR GenJournalLine@1000 : Record 81;VAR VATPostingSetup@1001 : Record 325;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateAccountNoOnAfterAssignValue@259(VAR GenJournalLine@1000 : Record 81;VAR xGenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateAccountNoOnBeforeAssignValue@258(VAR GenJournalLine@1000 : Record 81;VAR xGenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateBalAccountNoOnAfterAssignValue@257(VAR GenJournalLine@1000 : Record 81;VAR xGenJournalLine@1001 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateBalAccountNoOnBeforeAssignValue@255(VAR GenJournalLine@1000 : Record 81;VAR xGenJournalLine@1001 : Record 81);
    BEGIN
    END;

    LOCAL PROCEDURE SetLastModifiedDateTime@1165();
    VAR
      DotNet_DateTimeOffset@1000 : Codeunit 3006;
    BEGIN
      "Last Modified DateTime" := DotNet_DateTimeOffset.ConvertToUtcDateTime(CURRENTDATETIME);
    END;

    LOCAL PROCEDURE UpdateDocumentTypeAndAppliesTo@210(DocType@1000 : Integer;DocNo@1001 : Code[20]);
    BEGIN
      "Applies-to Doc. Type" := DocType;
      "Applies-to Doc. No." := DocNo;
      "Applies-to ID" := '';

      OnAfterUpdateDocumentTypeAndAppliesToFields(Rec,DocType,DocNo);

      IF "Document Type" <> "Document Type"::" " THEN
        EXIT;

      IF NOT ("Account Type" IN ["Account Type"::Customer,"Account Type"::Vendor]) THEN
        EXIT;

      CASE "Applies-to Doc. Type" OF
        "Applies-to Doc. Type"::Payment:
          "Document Type" := "Document Type"::Invoice;
        "Applies-to Doc. Type"::"Credit Memo":
          "Document Type" := "Document Type"::Refund;
        "Applies-to Doc. Type"::Invoice,
        "Applies-to Doc. Type"::Refund:
          "Document Type" := "Document Type"::Payment;
      END;
    END;

    [External]
    PROCEDURE UpdateAccountID@1166();
    VAR
      GLAccount@1000 : Record 15;
    BEGIN
      IF "Account Type" <> "Account Type"::"G/L Account" THEN
        EXIT;

      IF "Account No." = '' THEN BEGIN
        CLEAR("Account Id");
        EXIT;
      END;

      IF NOT GLAccount.GET("Account No.") THEN
        EXIT;

      "Account Id" := GLAccount.Id;
    END;

    LOCAL PROCEDURE UpdateAccountNo@1164();
    VAR
      GLAccount@1001 : Record 15;
    BEGIN
      IF ISNULLGUID("Account Id") THEN
        EXIT;

      GLAccount.SETRANGE(Id,"Account Id");
      IF NOT GLAccount.FINDFIRST THEN
        EXIT;

      "Account No." := GLAccount."No.";
    END;

    [External]
    PROCEDURE UpdateCustomerID@175();
    VAR
      Customer@1000 : Record 18;
    BEGIN
      IF "Account Type" <> "Account Type"::Customer THEN
        EXIT;

      IF "Account No." = '' THEN BEGIN
        CLEAR("Customer Id");
        EXIT;
      END;

      IF NOT Customer.GET("Account No.") THEN
        EXIT;

      "Customer Id" := Customer.Id;
    END;

    LOCAL PROCEDURE UpdateCustomerNo@174();
    VAR
      Customer@1001 : Record 18;
    BEGIN
      IF ISNULLGUID("Customer Id") THEN
        EXIT;

      Customer.SETRANGE(Id,"Customer Id");
      IF NOT Customer.FINDFIRST THEN
        EXIT;

      "Account No." := Customer."No.";
    END;

    [External]
    PROCEDURE UpdateAppliesToInvoiceID@167();
    VAR
      SalesInvoiceHeader@1000 : Record 112;
    BEGIN
      IF "Applies-to Doc. Type" <> "Applies-to Doc. Type"::Invoice THEN
        EXIT;

      IF "Applies-to Doc. No." = '' THEN BEGIN
        CLEAR("Applies-to Invoice Id");
        EXIT;
      END;

      IF NOT SalesInvoiceHeader.GET("Applies-to Doc. No.") THEN
        EXIT;

      "Applies-to Invoice Id" := SalesInvoiceHeader.Id;
    END;

    LOCAL PROCEDURE UpdateAppliesToInvoiceNo@165();
    VAR
      SalesInvoiceHeader@1001 : Record 112;
    BEGIN
      IF ISNULLGUID("Applies-to Invoice Id") THEN
        EXIT;

      SalesInvoiceHeader.SETRANGE(Id,"Applies-to Invoice Id");
      IF NOT SalesInvoiceHeader.FINDFIRST THEN
        EXIT;

      "Applies-to Doc. No." := SalesInvoiceHeader."No.";
    END;

    [External]
    PROCEDURE UpdateGraphContactId@170();
    VAR
      Customer@1003 : Record 18;
      Contact@1002 : Record 5050;
      GraphIntContact@1001 : Codeunit 5461;
      GraphID@1000 : Text[250];
    BEGIN
      IF ISNULLGUID("Customer Id") THEN
        CLEAR("Contact Graph Id");

      Customer.SETRANGE(Id,"Customer Id");
      IF NOT Customer.FINDFIRST THEN
        CLEAR("Contact Graph Id");

      IF NOT GraphIntContact.FindGraphContactIdFromCustomer(GraphID,Customer,Contact) THEN
        CLEAR("Contact Graph Id");

      "Contact Graph Id" := GraphID;
    END;

    [External]
    PROCEDURE UpdateJournalBatchID@173();
    VAR
      GenJournalBatch@1000 : Record 232;
    BEGIN
      IF NOT GenJournalBatch.GET("Journal Template Name","Journal Batch Name") THEN
        EXIT;

      "Journal Batch Id" := GenJournalBatch.Id;
    END;

    LOCAL PROCEDURE UpdateJournalBatchName@172();
    VAR
      GenJournalBatch@1001 : Record 232;
    BEGIN
      GenJournalBatch.SETRANGE(Id,"Journal Batch Id");
      IF NOT GenJournalBatch.FINDFIRST THEN
        EXIT;

      "Journal Batch Name" := GenJournalBatch.Name;
    END;

    [External]
    PROCEDURE UpdatePaymentMethodId@198();
    VAR
      PaymentMethod@1000 : Record 289;
    BEGIN
      IF "Payment Method Code" = '' THEN BEGIN
        CLEAR("Payment Method Id");
        EXIT;
      END;

      IF NOT PaymentMethod.GET("Payment Method Code") THEN
        EXIT;

      "Payment Method Id" := PaymentMethod.Id;
    END;

    LOCAL PROCEDURE UpdatePaymentMethodCode@185();
    VAR
      PaymentMethod@1001 : Record 289;
    BEGIN
      IF ISNULLGUID("Payment Method Id") THEN
        EXIT;

      PaymentMethod.SETRANGE(Id,"Payment Method Id");
      IF NOT PaymentMethod.FINDFIRST THEN
        EXIT;

      "Payment Method Code" := PaymentMethod.Code;
    END;

    LOCAL PROCEDURE UpdateDescriptionWithEmployeeName@178(Employee@1000 : Record 5200);
    BEGIN
      IF STRLEN(Employee.FullName) <= MAXSTRLEN(Description) THEN
        UpdateDescription(COPYSTR(Employee.FullName,1,MAXSTRLEN(Description)))
      ELSE
        UpdateDescription(Employee.Initials);
    END;

    [Integration(TRUE)]
    PROCEDURE OnGenJnlLineGetVendorAccount@1217(Vendor@1213 : Record 23);
    BEGIN
    END;

    PROCEDURE ShowDeferralSchedule@206();
    BEGIN
      IF "Account Type" = "Account Type"::"Fixed Asset" THEN
        ERROR(AccTypeNotSupportedErr);

      ShowDeferrals("Posting Date","Currency Code");
    END;

    PROCEDURE CheckCompanyIC@1210190001();
    VAR
      lvCompName@1210190027 : Text[50];
    BEGIN
      //**4PS
      IF "Receiving Company" <> '' THEN
        lvCompName := "Receiving Company"
      ELSE
        lvCompName := COMPANYNAME;

      DimValRec.CHANGECOMPANY(lvCompName);
      ICProjSetupRec.CHANGECOMPANY(lvCompName);
      ProjRec.CHANGECOMPANY(lvCompName);
      ProjTypeRec.CHANGECOMPANY(lvCompName);
      ProjElemRec.CHANGECOMPANY(lvCompName);
      ExtRec.CHANGECOMPANY(lvCompName);
      PlantTypeRec.CHANGECOMPANY(lvCompName);
      PlantNoRec.CHANGECOMPANY(lvCompName);
      CostCompPlantRec.CHANGECOMPANY(lvCompName);
      PlantPostingSetup.CHANGECOMPANY(lvCompName);
      ServTypeRec.CHANGECOMPANY(lvCompName);
      ServOrderRec.CHANGECOMPANY(lvCompName);
      ServContrRec.CHANGECOMPANY(lvCompName);  //db, 19-05-15: C015449
      ServiceCategory.CHANGECOMPANY(lvCompName);
      CostCompRec.CHANGECOMPANY(lvCompName);  //db, 23-10-12
      PaymentTerms.CHANGECOMPANY(lvCompName);

      ICProjSetupRec.GET;
    END;

    PROCEDURE RefersToOtherCompany@1100525008() : Boolean;
    BEGIN
      //**4PS
      EXIT(("Receiving Company" <> '') AND ("Receiving Company" <> COMPANYNAME));
    END;

    PROCEDURE ValidateItem@1210190002(LTypeArtOpt@11012000 : 'Item,Basic Item,Trade Item');
    VAR
      DummyDat@11012001 : Date;
      DummyTxt@11012002 : Text[50];
      DummyDec@1210190023 : Decimal;
      lvRefDate@1100485000 : Date;
      lvDiscRef1@1100485001 : Code[20];
      lvDiscRef2@1100485002 : Code[20];
      ServOrderRec@1100485004 : Record 11012823;
      ProjRec@1100485003 : Record 11072003;
    BEGIN
      //**4PS
      IF "Service Order No." <>'' THEN BEGIN
        ServOrderRec.CHANGECOMPANY("Receiving Company");
        ServOrderRec.GET("Service Order No.");
        lvRefDate := ValidateCu.GetRefDateServOrder(ServOrderRec);
      //  lvDiscRef1 := ServOrderRec."Purch Discount Term Group 1";
      //  lvDiscRef2 := ServOrderRec."Purch Discount Term Group 2";
      END ELSE BEGIN
        IF "Job No." <>'' THEN BEGIN
          ProjRec.CHANGECOMPANY("Receiving Company");
          ProjRec.GET("Job No.");
          lvRefDate := ValidateCu.GetRefDateProject(ProjRec);
          lvDiscRef1 := ProjRec."Purch Discount Term Group 1";
          lvDiscRef2 := ProjRec."Purch Discount Term Group 2";
        END;
      END;

      ValidateCu.ValidateItem(LTypeArtOpt,"Trade Item","Item No.",Manufacturer,"Vendor (Trade Item)",
                              "Basic Item","Shortcut Dimension 2 Code",Description,"Unit of Measure Code",Amount,
                              DummyDec,DummyDat,DummyDec,DummyTxt,"Cost Component",
                              lvDiscRef1,lvDiscRef2,lvRefDate,'');

      IF CurrFieldNo <> 0 THEN
        CurrFieldNo := FIELDNO("Shortcut Dimension 2 Code");  //db, 19-03-10: force update Additional Cost
      VALIDATE("Shortcut Dimension 2 Code");
    END;

    PROCEDURE CheckPlantAcqOrRent@1100485000() : Integer;
    VAR
      lvPlantSetupRec@1100485000 : Record 11012550;
    BEGIN
      //**4PS
      IF ("Cost Component Plant" = '') THEN
        EXIT(0);

      IF ("Receiving Company" <> '') THEN
        lvPlantSetupRec.CHANGECOMPANY("Receiving Company");
      lvPlantSetupRec.GET;

      IF ("Cost Component Plant" = lvPlantSetupRec."Cost Component Acquisition") THEN
        EXIT(1);
      IF ("Cost Component Plant" = lvPlantSetupRec."Cost Component Rent") THEN
        EXIT(2);

      EXIT(0);
    END;

    PROCEDURE CheckFixedAssetPlantRelation@1210190010() : Boolean;
    VAR
      lvPlantSetupRec@1210190000 : Record 11012550;
      lvPlantTypeRec@1100525000 : Record 11012551;
    BEGIN
      //**4PS
      IF ("Plant Type" = '') OR ("Plant No." = '') OR ("Cost Component Plant" = '') OR ("Receiving Company" <> '') THEN
        EXIT(FALSE);

      lvPlantSetupRec.GET;
      IF (NOT lvPlantSetupRec."Integration Fixed Assets") OR
         (lvPlantSetupRec."Cost Component Acquisition" <> "Cost Component Plant")
      THEN
        EXIT(FALSE);
      lvPlantTypeRec.GET("Plant Type");
      IF NOT lvPlantTypeRec."Integration Fixed Assets" THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE FillFixedAssetPlantRelation@1210190004() : Boolean;
    VAR
      lvPlantNumberRec@1210190001 : Record 11012552;
    BEGIN
      //**4PS
      IF NOT CheckFixedAssetPlantRelation() THEN
        EXIT(FALSE);

      lvPlantNumberRec.GET("Plant Type", "Plant No.");
      lvPlantNumberRec.TESTFIELD("Fixed Asset");
      "Account Type" := "Account Type"::"Fixed Asset";
      VALIDATE("Account No.", lvPlantNumberRec."Fixed Asset");
      Description := lvPlantNumberRec.Description;
      "FA Posting Type" := "FA Posting Type"::"Acquisition Cost";

      EXIT(TRUE);
    END;

    PROCEDURE FillSystemCreatedEntry@1210190007();
    BEGIN
      //**4PS
      "System-Created Entry" :=
        ("Service Order No." <> '') OR
        ("Service Contract No." <> '') OR
        ("Job No." <> '') OR
        ("Loan Code" <> '') OR
        ("Plant Type" <> '');
    END;

    PROCEDURE ValidateAppliesToDocNo@1210190000(SkipMessage@1100525000 : Boolean);
    VAR
      lvCustLedgEntryRec@1210190025 : Record 21;
      lvVendLedgEntryRec@1210190024 : Record 25;
    BEGIN
      //**4PS
      IF ("Account Type" = "Account Type"::Customer) AND ("Applies-to Doc. No." <> '') THEN BEGIN
        lvCustLedgEntryRec.CHANGECOMPANY("Receiving Company");
        lvCustLedgEntryRec.SETCURRENTKEY("Document No.");
        IF "Applies-to Doc. Type" <> "Applies-to Doc. Type"::" " THEN
          lvCustLedgEntryRec.SETRANGE("Document Type","Applies-to Doc. Type");
        lvCustLedgEntryRec.SETRANGE("Document No.","Applies-to Doc. No.");
        IF "Account No." <> '' THEN
          lvCustLedgEntryRec.SETRANGE("Customer No.","Account No.");
        IF lvCustLedgEntryRec.FIND('-') THEN BEGIN
          IF "Account No." = '' THEN
            VALIDATE("Account No.", lvCustLedgEntryRec."Customer No.");
          IF NOT lvCustLedgEntryRec.Open THEN BEGIN
            //>>181018
            lvCustLedgEntryRec.SETRANGE(Open,TRUE);
            IF NOT lvCustLedgEntryRec.FINDFIRST THEN
            //<<181018
            IF "Document Type" <> "Document Type"::Refund THEN BEGIN
              IF (NOT SkipMessage) AND (NOT DontWarnValidateAppliesToDocNoBool) THEN  //<--ENH035
              //IF NOT SkipMessage THEN
                MESSAGE(Text11012004 + '\' + Text11012009, FIELDCAPTION("Applies-to Doc. No."),"Applies-to Doc. No.");
              "Applies-to Doc. No." := '';
              "Not Matched" := TRUE;  //<-ENH035
            END; //**4PS.n DP00613
          END;
        END ELSE BEGIN
          IF NOT DontWarnValidateAppliesToDocNoBool THEN   //<--ENH035
            ERROR(Text11012005, FIELDCAPTION("Applies-to Doc. No."),"Applies-to Doc. No.");
          "Not Matched" := TRUE;  //<-ENH035
        END;
      END;

      IF ("Account Type" = "Account Type"::Vendor) AND ("Applies-to Doc. No." <> '') THEN BEGIN
        lvVendLedgEntryRec.SETCURRENTKEY("Document No.");
        IF "Applies-to Doc. Type" <> "Applies-to Doc. Type"::" " THEN
          lvVendLedgEntryRec.SETRANGE("Document Type","Applies-to Doc. Type");
        lvVendLedgEntryRec.SETRANGE("Document No.","Applies-to Doc. No.");
        IF "Account No." <> '' THEN
          lvVendLedgEntryRec.SETRANGE("Vendor No.","Account No.");
        IF lvVendLedgEntryRec.FIND('-') THEN BEGIN
          IF "Account No." = '' THEN
            VALIDATE("Account No.", lvVendLedgEntryRec."Vendor No.");
          IF NOT lvVendLedgEntryRec.Open THEN BEGIN
            //>>181018
            lvVendLedgEntryRec.SETRANGE(Open,TRUE);
            IF NOT lvVendLedgEntryRec.FINDFIRST THEN BEGIN
            //<<181018
            //IF NOT SkipMessage THEN
            IF (NOT SkipMessage) AND (NOT DontWarnValidateAppliesToDocNoBool) THEN   //<--ENH035
              MESSAGE(Text11012004, FIELDCAPTION("Applies-to Doc. No."),"Applies-to Doc. No.");
            "Applies-to Doc. No." := '';
            END;//181018
          END ELSE BEGIN
          END;
        END ELSE
          ERROR(Text11012005, FIELDCAPTION("Applies-to Doc. No."),"Applies-to Doc. No.");
      END;
    END;

    PROCEDURE HandleLookupUnit@1210190008();
    VAR
      ItemUnitRec@1210190000 : Record 5404;
      lvUnit@1210190001 : Code[10];
    BEGIN
      //**4PS
      lvUnit := ItemUnitRec.HandleLookupUnit("Item No.", "Basic Item", "Trade Item", Manufacturer, "Vendor (Trade Item)");
      IF (lvUnit <> '') AND (lvUnit <> "Unit of Measure Code") THEN
        VALIDATE("Unit of Measure Code", lvUnit);
    END;

    PROCEDURE GetPlantPostingGroup@1210190019();
    VAR
      lvTypeNo@1100485001 : Integer;
      lvModeInEx@1100485000 : Code[1];
    BEGIN
      //**4PS
      IF "Plant Type" = '' THEN
        EXIT;

      CheckCompanyIC;
      PlantTypeRec.GET("Plant Type");

      IF "Plant No." = '' THEN BEGIN
        lvTypeNo := CheckPlantAcqOrRent();
        IF (lvTypeNo <> 0) THEN
          lvModeInEx := COPYSTR('IE', lvTypeNo, 1);  //* Internal/External
      END;
      "Posting Group" := PlantTypeRec.PlantPostingGrp("Plant No.", "Receiving Company", lvModeInEx);
    END;

    LOCAL PROCEDURE GetGLSetup@11128245();
    BEGIN
      //4PSSE
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    PROCEDURE SetStructuredPayment@1080000();
    BEGIN
      //4PSSE
      GenJnlLineExt.InitGetLine(Rec);
      GenJnlLineExt.SetStructuredPayment;
      GenJnlLineExt.SaveUpdateLine(Rec);//4PSSE
    END;

    PROCEDURE ResetDeleteInteresLinesICAcc@1100485001(IGenJnlLineRec@1100485004 : Record 81);
    VAR
      lvICAccRec@1100485001 : Record 11012118;
      lvInterestLineICAccRec@1100485000 : Record 11020307;
      lvGenJnlLineRec@1100485002 : Record 81;
      lvGLEntryRec@1100485003 : Record 17;
    BEGIN
      //**4PS
      //* Mutation at interest calculation (R11012114/CU11012160) for IC accounts, always come first in the General Journal
      //* to be able to first perform a check (and eventual make some changes or to delete).
      //* When deleting an 'IC-interest line' all accompanying lines of the IC-account should also be deleted.
      //* Field 'Interest Calculated To' of the IC-account should also be set back and field 'Interest Calculated'
      //* of the linked General Ledger Entries should be set back to False.
      //* ATTENTION:
      //* Not set back these fields when posting 'IC-interest lines', because then it is final.
      //* So before deleting a general journal line at posting, first delete all accompanying lines from table 'InterestLineICAcc',
      //* when calling this function from the 'delete trigger' nothing will happen. See next function.

      WITH lvInterestLineICAccRec DO BEGIN
        RESET;
        SETCURRENTKEY(Type,"Gen. Journal Template Name","Gen. Journal Batch Name","Gen. Journal Line No.");
        SETRANGE(Type, Type::GenJnlLine);
        SETRANGE("Gen. Journal Template Name", IGenJnlLineRec."Journal Template Name");
        SETRANGE("Gen. Journal Batch Name", IGenJnlLineRec."Journal Batch Name");
        SETRANGE("Gen. Journal Line No.", IGenJnlLineRec."Line No.");
        IF NOT FINDFIRST THEN
          EXIT;

        lvICAccRec.GET("IC Account No.");
        lvICAccRec."Interest Calculated to" := lvInterestLineICAccRec."Prev. Interest Calculated to";
        lvICAccRec.MODIFY;
        DELETE;

        RESET;
        SETRANGE(Type, Type::GLEntry);
        SETRANGE("IC Account No.", lvICAccRec."Account No.");
        SETRANGE("Gen. Journal Template Name", IGenJnlLineRec."Journal Template Name");
        SETRANGE("Gen. Journal Batch Name", IGenJnlLineRec."Journal Batch Name");
        IF FINDSET(TRUE,FALSE) THEN BEGIN
          REPEAT
            IF lvGLEntryRec.GET("G/L Entry No.") THEN BEGIN
              lvGLEntryRec."Interest Calculated" := FALSE;
              lvGLEntryRec.MODIFY;
            END;
            DELETE;
          UNTIL NEXT = 0;
        END;

        RESET;
        SETRANGE(Type, Type::GenJnlLine);
        SETRANGE("IC Account No.", lvICAccRec."Account No.");
        SETRANGE("Gen. Journal Template Name", IGenJnlLineRec."Journal Template Name");
        SETRANGE("Gen. Journal Batch Name", IGenJnlLineRec."Journal Batch Name");
        IF FINDSET(TRUE,FALSE) THEN BEGIN
          REPEAT
            //* First delete these then 'GenJnlLine.Delete(TRUE)' so when calling this function from the 'Delete trigger'
            //* nothing will happen.
            DELETE;
            IF ("Gen. Journal Line No." <> IGenJnlLineRec."Line No.") THEN BEGIN
              IF lvGenJnlLineRec.GET("Gen. Journal Template Name","Gen. Journal Batch Name","Gen. Journal Line No.") THEN
                lvGenJnlLineRec.DELETE(TRUE);
            END;
          UNTIL NEXT = 0;
        END;
      END;
    END;

    PROCEDURE DeleteLinkedInteresLinesICAcc@1100485002(IGenJnlLineRec@1100485004 : Record 81);
    VAR
      lvInterestLineICAccRec@1100485000 : Record 11020307;
      lvAccNo@1100485005 : Code[20];
    BEGIN
      //**4PS
      //* See comment in previous function 'ResetDeleteInteresLinesICAcc'.
      //* This function is to delete during posting (CU13). Directly delete all accompanying of IC account.

      WITH lvInterestLineICAccRec DO BEGIN
        RESET;
        SETCURRENTKEY(Type,"Gen. Journal Template Name","Gen. Journal Batch Name","Gen. Journal Line No.");
        SETRANGE(Type, Type::GenJnlLine);
        SETRANGE("Gen. Journal Template Name", IGenJnlLineRec."Journal Template Name");
        SETRANGE("Gen. Journal Batch Name", IGenJnlLineRec."Journal Batch Name");
        SETRANGE("Gen. Journal Line No.", IGenJnlLineRec."Line No.");
        IF NOT FINDFIRST THEN
          EXIT;

        lvAccNo := "IC Account No.";

        RESET;
        SETRANGE(Type, Type::GenJnlLine);
        SETRANGE("IC Account No.", lvAccNo);
        SETRANGE("Gen. Journal Template Name", IGenJnlLineRec."Journal Template Name");
        SETRANGE("Gen. Journal Batch Name", IGenJnlLineRec."Journal Batch Name");
        DELETEALL;

        SETRANGE(Type, Type::GLEntry);
        DELETEALL;
      END;
    END;

    PROCEDURE CheckCostCompServOrderType@1100485019();
    BEGIN
      //**4PS
      CheckCompanyIC;
      DimMgt.GetDimValueRec(2, "Shortcut Dimension 2 Code", DimValRec, FALSE, "Job No.");  //db, 02-02-10
      CostCompRec.CheckDefaultCostComponent("Service Order No.", "Cost Component", "Receiving Company", DimValRec."Cost Type",
        "Additional Cost (Service)");  //db, 24-02-10 + 23-10-12
    END;

    PROCEDURE CheckAppiesToDocNoAllowedForIC@1100525002(ErrorMode@1100525000 : Boolean;FieldNumber@1100525003 : Integer) : Boolean;
    VAR
      lvText11012001@1100525002 : TextConst 'ENU=not allowed.;NOR=ikke tillatt.;SVE=inte tillÜtet.';
      lvText11012002@1100525001 : TextConst 'ENU=Receiving company is filled, apply then only allowed for account type ''Customer''.;NOR=Mottaksselskap er fylt ut, utligning er da kun tillatt for kontotypen ''Kunde''.;SVE=Mottagningsfîretag har fyllts i, tillÑmpning Ñr sedan endast tillÜtet fîr kontotypen ''Kund''.';
    BEGIN
      //**4PS  C-017223
      IF ("Receiving Company" <> '') AND ("Account Type" <> "Account Type"::Customer) THEN BEGIN
        IF ErrorMode THEN BEGIN
          IF FieldNumber <> 0 THEN BEGIN
            CASE FieldNumber OF
              FIELDNO("Applies-to Doc. No."):
                FIELDERROR("Applies-to Doc. No.", lvText11012001 + ' ' + lvText11012002);
              FIELDNO("Applies-to ID"):
                FIELDERROR("Applies-to ID", lvText11012001 + ' ' + lvText11012002);
            END;
          END;
          ERROR(lvText11012002);
        END;
        EXIT(FALSE);
      END;
      EXIT(TRUE);
    END;

    PROCEDURE CheckAdditionalCostService@1100525006(CalledBy@1100525000 : Integer);
    BEGIN
      //**4PS
      //db, 24-02-10
      IF "Service Order No." = '' THEN EXIT;
      CheckCompanyIC;
      IF NOT ServOrderRec.GET("Service Order No.") THEN EXIT;

      IF NOT "Add. Cost Changed Manually" THEN
        "Additional Cost (Service)" :=
          ServOrderRec.GetAdditionalCostService("Service Order No.","Shortcut Dimension 2 Code","Cost Type"+1,"Receiving Company", Rec);
      IF ("Service Order No." <> xRec."Service Order No.") OR
          ("Additional Cost (Service)" <> xRec."Additional Cost (Service)")
      THEN BEGIN
        IF "Additional Cost (Service)" THEN
          VALIDATE("Shortcut Dimension 1 Code", ServOrderRec."Department Code (Other)")
        ELSE
          VALIDATE("Shortcut Dimension 1 Code", ServOrderRec."Global Dimension 1 Code");
      END;

      IF (CalledBy = FIELDNO("Service Order No.")) OR (CalledBy = FIELDNO("Shortcut Dimension 2 Code")) THEN BEGIN
        IF xRec."Shortcut Dimension 2 Code" = '' THEN
          xRec."Cost Type":= -1  //db, 16-03-10: disable default option
        ELSE
          xRec.CALCFIELDS("Cost Type");
        CALCFIELDS("Cost Type");
        IF ("Service Order No." <> xRec."Service Order No.") OR
           ("Cost Type" <> xRec."Cost Type") THEN BEGIN
          VALIDATE("Cost Component");
        END;
      END;
    END;

    PROCEDURE ValidateAdditionalCost@1100525000();
    VAR
      CostCompRec@1100525001 : Record 11012012;
      SaveCostComp@1100525000 : Text[30];
    BEGIN
      //**4PS
      SaveCostComp := "Cost Component";
      IF CurrFieldNo = FIELDNO("Additional Cost (Service)") THEN
        "Add. Cost Changed Manually" := TRUE;
      TESTFIELD("Service Order No.");
      VALIDATE("Service Order No.");
      IF CurrFieldNo <> FIELDNO("Additional Cost (Service)") THEN EXIT;  //db, 18-03-10: T4641

      IF CostCompRec.GET(SaveCostComp) THEN BEGIN
         "Cost Component" := SaveCostComp;
         IF ("Additional Cost (Service)" = TRUE) THEN BEGIN
           IF (CostCompRec."Cost Component (Add.Cost)" <> '') THEN
             "Cost Component" := CostCompRec."Cost Component (Add.Cost)";
         END ELSE BEGIN
           CostCompRec.SETRANGE("Cost Component (Add.Cost)", SaveCostComp);
           IF CostCompRec.FINDSET THEN BEGIN
             REPEAT
               IF (CostCompRec."Cost Component (Add.Cost)" = SaveCostComp) THEN
                 "Cost Component" := CostCompRec.Code;
             UNTIL CostCompRec.NEXT = 0;
           END;
         END;
      END;
    END;

    PROCEDURE SetSkipModify@1100525003(SkipModify@1100525000 : Boolean);
    BEGIN
      //**4PS
      DoSkipModify := SkipModify;
    END;

    PROCEDURE ValidateCostComponent@1100525001();
    VAR
      CostCompRec@1100525000 : Record 11012012;
      CostCompRec2@1100525001 : Record 11012012;
    BEGIN
      //**4PS
      IF CurrFieldNo <> FIELDNO("Cost Component") THEN EXIT;  //db, 18-03-10: T4642

      IF CostCompRec.GET("Cost Component") THEN BEGIN
        //db.sn, 06-12-10: M24263
        IF CostCompRec."Additional Cost (Service)" THEN BEGIN
          CostCompRec2.SETRANGE("Cost Component (Add.Cost)", "Cost Component");
          IF NOT CostCompRec2.FINDFIRST THEN EXIT;
        END ELSE BEGIN
          IF CostCompRec."Cost Component (Add.Cost)" = '' THEN EXIT;
        END;
        //db.en, 06-12-10: M24263
        "Additional Cost (Service)" := CostCompRec."Additional Cost (Service)";
      END;
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(81) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 81');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Gen. Journal Line", "Shortcut Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Shortcut Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Shortcut Dimension 1 Code");
    END;

    PROCEDURE CreateDimForFAPostingGroup@1210190005();
    BEGIN
      //**4PS call C-026623
      CreateDim(
        DimMgt.TypeToTableID1("Account Type"),"Account No.",
        DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
        DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo("Plant Type","Plant No."),
        DATABASE::"Plant Type", "Plant Type",
        DATABASE::Job,"Job No.",
        DATABASE::"Service Order","Service Order No.",
        DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
        DATABASE::Campaign,"Campaign No.");
    END;

    PROCEDURE CreateDimForHourAccLine@1100525005(Type1@1100525015 : Integer;No1@1100525014 : Code[40];Type2@1100525013 : Integer;No2@1100525012 : Code[40];Type3@1100525011 : Integer;No3@1100525010 : Code[40];Type4@1100525009 : Integer;No4@1100525008 : Code[40];Type5@1100525007 : Integer;No5@1100525006 : Code[40];Type6@1100525005 : Integer;No6@1100525004 : Code[40];Type7@1100525003 : Integer;No7@1100525002 : Code[40];Type8@1100525001 : Integer;No8@1100525000 : Code[40]);
    BEGIN
      //**4PS Call C006343
      WhileHoursPostNoDPACheck := TRUE;

      VALIDATE("Account No.");

      CreateDim(
        Type1,No1,
        Type2,No2,
        Type3,No3,
        Type4,No4,
        Type5,No5,
        Type6,No6,
        Type7,No7,
        Type8,No8);

      WhileHoursPostNoDPACheck := FALSE;
    END;

    PROCEDURE ExternalEmployeeVendor@1100525007() LvVendorCde : Code[20];
    VAR
      EmployeeRec@1100525000 : Record 5200;
      VendorRec@1100525002 : Record 23;
    BEGIN
      //**4PS Call C006691  this is according with the check made in CU 11.
      LvVendorCde := '';

      IF "Document Type" <> 0 THEN
        EXIT;

      IF ("Receiving Company" <> COMPANYNAME) AND ("Receiving Company" <> '') THEN
        EXIT;

      IF "Job No." = '' THEN
        EXIT;

      IF "Employee No." = '' THEN
        EXIT;

      IF "Plant Invoice" THEN
        EXIT;

      IF (ProjRec."Small Project" AND ProjRec."Plant Job Order") THEN
        EXIT;

      IF NOT EmployeeRec.GET("Employee No.") THEN
        EXIT;

      IF (NOT EmployeeRec.External) OR (EmployeeRec.Employer = '' ) THEN
        EXIT;

      IF VendorRec.GET(EmployeeRec.Employer) THEN
        LvVendorCde := VendorRec."No.";
    END;

    PROCEDURE OnLookupJobNo@1100525012(EditableMode@1100525000 : Boolean);
    VAR
      PageNo@1100525001 : Integer;
    BEGIN
      //**4PS
      CheckCompanyIC;
      ProjRec."No." := "Job No.";
      IF RefersToOtherCompany THEN
        PageNo := PAGE::"Job List IC";
      IF NOT EditableMode THEN
        PAGE.RUNMODAL(PageNo, ProjRec)
      ELSE BEGIN
        IF PAGE.RUNMODAL(PageNo, ProjRec) = ACTION::LookupOK THEN
          VALIDATE("Job No.", ProjRec."No.");
      END;
    END;

    PROCEDURE OnLookupServiceOrderNo@1100525011(EditableMode@1100525000 : Boolean);
    BEGIN
      //**4PS
      CheckCompanyIC;
      ServOrderRec."No." := "Service Order No.";
      IF NOT EditableMode THEN
        PAGE.RUNMODAL(0, ServOrderRec)
      ELSE BEGIN
        IF PAGE.RUNMODAL(0, ServOrderRec) = ACTION::LookupOK THEN BEGIN
          xRec."Service Order No." := '';  //db, 07-06-10: M19676
          VALIDATE("Service Order No.", ServOrderRec."No.");
        END;
      END;
    END;

    PROCEDURE OnLookupPlantType@1100525034(EditableMode@1100525000 : Boolean);
    BEGIN
      //**4PS
      CheckCompanyIC;
      PlantTypeRec.Code := "Plant Type";
      IF NOT EditableMode THEN
        PAGE.RUNMODAL(0,PlantTypeRec)
      ELSE BEGIN
        IF PAGE.RUNMODAL(0,PlantTypeRec) = ACTION::LookupOK THEN
          VALIDATE("Plant Type", PlantTypeRec.Code);
      END;
    END;

    PROCEDURE ValidatePlantNo@1100525031();
    VAR
      PlantType@1100525000 : Record 11012551;
      PlantSetup@1100525002 : Record 11012550;
    BEGIN
      //**4PS
      IF ("Plant Type" <> '') AND ("Plant No." = '') THEN BEGIN
        PlantSetup.GET;
        IF PlantSetup."Posting on Unique Plant No." THEN
          IF PlantType.GET("Plant Type") THEN
            IF NOT PlantType.Bulk THEN
              IF PlantSetup."Cost Component Acquisition" <> "Cost Component Plant" THEN
                TESTFIELD("Plant No.");
      END;
    END;

    LOCAL PROCEDURE CheckDocNoInDefaultNoSeries@1100528501(SeriesCode@1210190002 : Code[10];DocNo@1000 : Code[20];Date@1210190003 : Date) : Boolean;
    VAR
      NoSeriesLine@1210190001 : Record 309;
      IsDigit@1003 : Boolean;
      i@1004 : Integer;
      SerieLen@1210190000 : Integer;
    BEGIN
      //**4PS
      IF (SeriesCode = '') OR (DocNo = '') THEN
        EXIT(FALSE);

      CLEAR(NoSeriesMgt);
      NoSeriesMgt.SetNoSeriesLineFilter(NoSeriesLine,SeriesCode,Date);
      IF NOT NoSeriesLine.FINDFIRST THEN BEGIN
        NoSeriesLine.SETRANGE("Starting Date");
        IF NOT NoSeriesLine.FINDFIRST THEN
          EXIT(FALSE);
      END;

      SerieLen := 0;
      i := STRLEN(DocNo);
      REPEAT
        IsDigit := DocNo[i] IN ['0'..'9'];
        IF IsDigit THEN
          SerieLen := i - 1;
        i := i - 1;
      UNTIL (i = 0) OR (NOT IsDigit);

      IF SerieLen > 0 THEN BEGIN
        IF COPYSTR(DocNo,1,SerieLen) = COPYSTR(NoSeriesLine."Starting No.",1,SerieLen) THEN
          EXIT(TRUE);
      END ELSE
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE WipAccountProject@1100409000(Proj@1100409009 : Record 11072003;ProjType@1100409008 : Record 11012009;DimVal@1100409007 : Record 349;ProvisionsAtClosure@1100409002 : Boolean;CompName@1100409005 : Text[50];VendorNo@1100409000 : Code[20];VendorPostingGroup@1100409003 : Code[20];CustomerPostingGroup@1100528200 : Code[20]) AccountNo : Code[20];
    VAR
      ICHoursPosting@1100409001 : 'NotApplicable,ReceiverSide,Supplierside';
    BEGIN
      //**4PS
      IF VendorPostingGroup = '' THEN
        VendorPostingGroup := "Vendor Posting Group";
      IF CustomerPostingGroup = '' THEN
        CustomerPostingGroup := "Customer Posting Group";

      IF "Rental Unit" = '' THEN
        AccountNo := ProjType.GetWipAccByPostingGrp(
          Proj."Project Type",
          DimVal."Cost Type",
          Proj."Project Status",
          ProvisionsAtClosure,
          CompName,
          "Cost Type Cost Plus Line",
          VendorNo,  //** 4PS Call Call C006691 changed
          ICHoursPosting::Supplierside,
          VendorPostingGroup,
          CustomerPostingGroup)
      ELSE
        IF (Proj."Project Status" >= Proj."Project Status"::Finished) AND ProvisionsAtClosure THEN BEGIN
          ProjType.TESTFIELD("Provision Account Rental UR");
          AccountNo := ProjType."Provision Account Rental UR";
        END ELSE
          IF ("Rental Unit Line Type" = 0) OR (DimVal."Cost Type" <> DimVal."Cost Type"::Revenue) THEN
            AccountNo := ProjType.GetCostAccountRentalUnit(
              Proj."Project Type",
              DimVal."Cost Type",
              Proj."Project Status",
              ProvisionsAtClosure,
              CompName,
              "Cost Type Cost Plus Line",
              VendorNo,
              "Rental Unit")
          ELSE
            CASE "Rental Unit Line Type" OF
              "Rental Unit Line Type"::ServiceCost:
                BEGIN
                  ProjTypeRec.TESTFIELD("Rental Unit Service Cost Rev.");
                  AccountNo := ProjTypeRec."Rental Unit Service Cost Rev.";
                END;
              "Rental Unit Line Type"::Utilities:
                BEGIN
                  ProjTypeRec.TESTFIELD("Rental Unit Acc Utilities Rev.");
                  AccountNo := ProjTypeRec."Rental Unit Acc Utilities Rev.";
                END;
              "Rental Unit Line Type"::"One-off Costs":
                BEGIN
                  ProjectTypeExtension.TESTFIELD("Rental Unit One-off Cost Rev.");
                  AccountNo := ProjectTypeExtension."Rental Unit One-off Cost Rev.";
                END;
              "Rental Unit Line Type"::Deposit:
                BEGIN
                  ProjectTypeExtension.TESTFIELD("Rental Unit Deposit Revenue");
                  AccountNo := ProjectTypeExtension."Rental Unit Deposit Revenue";
                END;
              ELSE
                BEGIN
                  ProjTypeRec.TESTFIELD("Rental Unit Account Revenue");
                  AccountNo := ProjTypeRec."Rental Unit Account Revenue";
                END;
            END;
    END;

    LOCAL PROCEDURE WipAccountService@1100528201(Proj@1100409009 : Record 11072003;ProjType@1100409008 : Record 11012009;DimVal@1100409007 : Record 349;ProvisionsAtClosure@1100409002 : Boolean;CompName@1100409005 : Text[50];VendorNo@1100409000 : Code[20];VendorPostingGroup@1100409003 : Code[20];CustomerPostingGroup@1100528200 : Code[20]) AccountNo : Code[20];
    VAR
      ICHoursPosting@1100409001 : 'NotApplicable,ReceiverSide,Supplierside';
    BEGIN
      //**4PS
      IF VendorPostingGroup = '' THEN
        VendorPostingGroup := "Vendor Posting Group";
      IF CustomerPostingGroup = '' THEN
        CustomerPostingGroup := "Customer Posting Group";

      IF ("Rental Unit" = '') OR
         ("Rental Unit Line Type" = 0) OR
         (DimVal."Cost Type" <> DimVal."Cost Type"::Revenue)
      THEN BEGIN
        AccountNo := ProjType.GetWipAccByPostingGrp(
          Proj."Project Type",
          DimVal."Cost Type",
          Proj."Project Status",
          ProvisionsAtClosure,
          CompName,
          "Cost Type Cost Plus Line",
          VendorNo,  //** 4PS Call Call C006691 changed
          ICHoursPosting::Supplierside,
          VendorPostingGroup,
          CustomerPostingGroup);
      END ELSE BEGIN
        IF (Proj."Project Status" >= Proj."Project Status"::Finished) AND ProvisionsAtClosure THEN BEGIN
          ProjType.TESTFIELD("Provision Account Rental UR");
          AccountNo := ProjType."Provision Account Rental UR";
        END ELSE BEGIN
          CASE "Rental Unit Line Type" OF
            "Rental Unit Line Type"::ServiceCost:
              BEGIN
                ProjTypeRec.TESTFIELD("Rental Unit Service Cost Rev.");
                AccountNo := ProjTypeRec."Rental Unit Service Cost Rev.";
              END;
            "Rental Unit Line Type"::Utilities:
              BEGIN
                ProjTypeRec.TESTFIELD("Rental Unit Acc Utilities Rev.");
                AccountNo := ProjTypeRec."Rental Unit Acc Utilities Rev.";
              END;
            "Rental Unit Line Type"::"One-off Costs":
              BEGIN
                ProjectTypeExtension.TESTFIELD("Rental Unit One-off Cost Rev.");
                AccountNo := ProjectTypeExtension."Rental Unit One-off Cost Rev.";
              END;
            "Rental Unit Line Type"::Deposit:
              BEGIN
                ProjectTypeExtension.TESTFIELD("Rental Unit Deposit Revenue");
                AccountNo := ProjectTypeExtension."Rental Unit Deposit Revenue";
              END;
            ELSE
              BEGIN
                ProjTypeRec.TESTFIELD("Rental Unit Account Revenue");
                AccountNo := ProjTypeRec."Rental Unit Account Revenue";
              END;
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE ReplaceDescriptionXtraCondition@1100525009() : Boolean;
    VAR
      xGLAcc@1100525000 : Record 15;
    BEGIN
      //**4PS
      IF ("Plant Type" <> '') OR ("Shortcut Dimension 2 Code" <> '') THEN
        EXIT(FALSE);

      IF (Description <> '') THEN
        IF ("Account No." <> xRec."Account No.") OR ("Account Type" <> xRec."Account Type") THEN BEGIN
          IF xGLAcc.GET(xRec."Account No.") THEN
            EXIT(xRec.Description = xGLAcc.Name);
        END ELSE
          EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DontWarnValidateAppliesToDocNo@1100285501();
    BEGIN
      DontWarnValidateAppliesToDocNoBool := TRUE;
    END;

    PROCEDURE CheckDim1JobService@1100525010();
    BEGIN
       //**4PS
      //db, 19-05-15: C015449
      //-check manual change proposal for adjustment entries
      //-assumed company switch done
      IF CurrFieldNo = FIELDNO("Shortcut Dimension 1 Code") THEN BEGIN
        IF "Job No." <> '' THEN BEGIN
          ProjRec.GET("Job No.");
          IF ProjRec."Global Dimension 1 Code" <> '' THEN
            TESTFIELD("Shortcut Dimension 1 Code", ProjRec."Global Dimension 1 Code");
        END ELSE BEGIN
          IF "Service Order No." <> '' THEN BEGIN
            ServOrderRec.GET("Service Order No.");
            IF ServOrderRec."Global Dimension 1 Code" <> '' THEN
              TESTFIELD("Shortcut Dimension 1 Code", ServOrderRec."Global Dimension 1 Code");
          END ELSE BEGIN
            IF "Service Contract No." <> '' THEN BEGIN
              ServContrRec.GET("Service Contract No.");
              IF ServContrRec."Global Dimension 1 Code" <> '' THEN
                TESTFIELD("Shortcut Dimension 1 Code", ServContrRec."Global Dimension 1 Code");
            END;
          END;
        END;
      END;
    END;

    PROCEDURE InitSurchargeForExternalIndirectHours@1100528400(VAR GenJnlLine@1210190002 : Record 81;OrigDimensionValue@1210190001 : Record 349;SurchDimensionValue@1210190009 : Record 349;OverheadSurcharge@1210190004 : Record 11020208;PostedHourLine@1100528400 : Record 11012085;Dimension1Code@1210190005 : Code[20];VAR TotalSurchAmount@1100485002 : Decimal);
    VAR
      HumanResourcesSetup@1210190007 : Record 5218;
      Employee@1100485000 : Record 5200;
      DimMgt@1100525002 : Codeunit 408;
    BEGIN
      //**4PS
      WITH GenJnlLine DO BEGIN
        IF (OrigDimensionValue."Cost Type" = OrigDimensionValue."Cost Type"::Labor) AND
           ("Employee No." <> '') THEN
        BEGIN
          IF Employee.GET("Employee No.") THEN BEGIN
            IF (Employee.External) AND
               (Employee."External Post No Surcharge") THEN
              EXIT;
          END;
        END;

        IF OverheadSurcharge.Percentage <> 0 THEN BEGIN
          HumanResourcesSetup.GET;
          IF HumanResourcesSetup."Surcharge Overtime excl." THEN BEGIN
            IF OverheadSurcharge."Surcharge over Surcharge" THEN BEGIN
              Amount := ROUND(
                (Amount + TotalSurchAmount - (PostedHourLine."Surcharge Overtime" * PostedHourLine."Total Line") ) *
                OverheadSurcharge.Percentage/100)
            END ELSE BEGIN
              Amount := ROUND(
                (Amount - (PostedHourLine."Surcharge Overtime" * PostedHourLine."Total Line") ) *
                OverheadSurcharge.Percentage/100);
            END;
          END ELSE BEGIN
            IF OverheadSurcharge."Surcharge over Surcharge" THEN
              Amount := ROUND((Amount + TotalSurchAmount) * OverheadSurcharge.Percentage/100)
            ELSE
              Amount := ROUND(Amount * OverheadSurcharge.Percentage/100)
          END;
        END ELSE
          Amount := ROUND(OverheadSurcharge.Amount * Quantity);

        "Unit of Measure Code" := SurchDimensionValue."Unit of Measure";
        "Shortcut Dimension 1 Code" := Dimension1Code;
        "Shortcut Dimension 2 Code" := SurchDimensionValue.Code;
        DimMgt.ValidateShortcutDimValues(1,"Shortcut Dimension 1 Code","Dimension Set ID");
        DimMgt.ValidateShortcutDimValues(2,"Shortcut Dimension 2 Code","Dimension Set ID");

        IF SurchDimensionValue."Cost Component" <> '' THEN
          "Cost Component" := SurchDimensionValue."Cost Component";
        Description := STRSUBSTNO(Text11012000, OverheadSurcharge.Description);
        TotalSurchAmount := TotalSurchAmount + Amount;
      END;
    END;

    PROCEDURE AccountIsSupplyingCurrentCompanyICAccount@1100528401() : Boolean;
    VAR
      IntercompanyRelation@1100528400 : Record 11012057;
    BEGIN
      //**4PS
      IF NOT IntercompanyRelation.GET(COMPANYNAME, "Receiving Company") THEN
        EXIT;

      EXIT("Account No." = IntercompanyRelation."Supplying Company IC Account");
    END;

    LOCAL PROCEDURE ClearICApplicationFields@1100529600();
    VAR
      IntercompanyClearingRelation@1100529600 : Record 11229426;
    BEGIN
      //**4PS
      IntercompanyClearingRelation.SETRANGE("Journal Template Name", "Journal Template Name");
      IntercompanyClearingRelation.SETRANGE("Journal Batch Name", "Journal Batch Name");
      IntercompanyClearingRelation.SETRANGE("Journal Line No.", "Line No.");
      IntercompanyClearingRelation.DELETEALL;

      IF "IC Application" THEN BEGIN
        "IC Application" := FALSE;
        "External Document No." := '';
        "System-Created Entry" := FALSE;
        Description := '';
      END;
    END;

    LOCAL PROCEDURE GetAndValidateLoanAccount@1100528502();
    VAR
      LoanHeader@1100528500 : Record 11020587;
      LoanAccountCode@1100528501 : Code[20];
    BEGIN
      //**4PS
      TESTFIELD("Account Type","Account Type"::"G/L Account");
      CheckProjServPlantLoanAllowed(FIELDNO("Loan Code"));
      FillSystemCreatedEntry;

      IF "Loan Code" <> '' THEN
        LoanAccountCode := LoanHeader.GetLoanAccountCode("Loan Code","Loan Type");

      IF LoanAccountCode <> '' THEN
        VALIDATE("Account No.",LoanAccountCode)
      ELSE
        IF "Account No." <> '' THEN
          VALIDATE("Account No.");

      IF "Loan Code" <> '' THEN
        CreateDim(
          DATABASE::"Loan Header","Loan Code",
          DimMgt.TypeToTableID1("Account Type"),"Account No.",
          DimMgt.TypeToTableID1("Bal. Account Type"),"Bal. Account No.",
          DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
          DATABASE::Campaign,"Campaign No.",
          0,'',
          0,'',
          0,'');
    END;

    LOCAL PROCEDURE CheckProjServPlantLoanAllowed@1100528510(ActualFieldNo@1100528500 : Integer);
    BEGIN
      CASE ActualFieldNo OF
        FIELDNO("Service Order No."):
          BEGIN
            IF "Service Order No." <> '' THEN BEGIN
              TESTFIELD("Job No.",'');
              TESTFIELD("Plant Type",'');
              TESTFIELD("Loan Code",'');
            END;
          END;
        FIELDNO("Service Contract No."):
          BEGIN
            IF "Service Contract No." <> '' THEN BEGIN
              TESTFIELD("Job No.",'');
              TESTFIELD("Plant Type",'');
              TESTFIELD("Loan Code",'');
            END;
          END;
        FIELDNO("Job No."):
          BEGIN
            IF "Job No." <> '' THEN BEGIN
              TESTFIELD("Service Order No.",'');
              TESTFIELD("Plant Type",'');
              TESTFIELD("Loan Code",'');
            END;
          END;
        FIELDNO("Plant Type"):
          BEGIN
            IF "Plant Type" <> '' THEN BEGIN
              TESTFIELD("Job No.",'');
              TESTFIELD("Service Order No.",'');
              TESTFIELD("Loan Code",'');
            END;
          END;
        FIELDNO("Loan Code"):
          BEGIN
            IF "Loan Code" <> '' THEN BEGIN
              TESTFIELD("Job No.",'');
              TESTFIELD("Service Order No.",'');
              TESTFIELD("Plant Type",'');
            END;
          END;
      END;
    END;

    PROCEDURE GetServiceCategory@1100529601();
    BEGIN
      //**4PS
      IF "Service Order No." = '' THEN
        EXIT;
      IF "Receiving Company" <> '' THEN
        ServOrderRec.CHANGECOMPANY("Receiving Company")
      ELSE
        ServOrderRec.CHANGECOMPANY(COMPANYNAME);
      IF NOT ServOrderRec.GET("Service Order No.") THEN
        EXIT;
      "Service Category" := ServOrderRec.GetServiceCategory;
    END;

    PROCEDURE LookupServiceContract@1100529606(EditableMode@1100529600 : Boolean);
    BEGIN
      //**4PS
      CheckCompanyIC;
      ServContrRec."No." := "Service Contract No.";
      IF NOT EditableMode THEN
        PAGE.RUNMODAL(0, ServContrRec)
      ELSE
        IF PAGE.RUNMODAL(0, ServContrRec) = ACTION::LookupOK THEN BEGIN
          CurrFieldNo := FIELDNO("Service Contract No.");
          VALIDATE("Service Contract No.", ServContrRec."No.");
        END;
    END;

    LOCAL PROCEDURE "//NAVSE"@100000000();
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterValidateAppliestoDocNo@1100285100(VAR Rec@1100285100 : Record 81);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateReceivedAmount@1100285101(VAR Rec@1100285100 : Record 81;xRec@1100285101 : Record 81);
    BEGIN
      //RFC1127
    END;

    BEGIN
    {
      4PS
      10-10-2000 A. Overeem Fields WKA added.
      19-10-2000 A. Overeem Field Job No. set to Editable.
      12-01-2001 A. Overeem Field Unit of Measure Code added.
      17-02-2005 Peter Schoenmaker - Amount will always be made equal to open amount of Applies-to Doc. No.
                 call 5488 marked with 4PS01.
      //20060706-JE : Added field [Your Reference]
      4PS01 JD 14-02-08 Fill Cost component from SOType of Cost Object
      4PS, 26-08-16, C032670, Function FillSystemCreatedEntry set to Global
    }
    END.
  }
}

