OBJECT Page 11128600 Project Details New
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSSE;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Project Details;
               NOR=Prosjektdetaljer;
               SVE=Projektkontroll];
    SaveValues=Yes;
    SourceTable=Table11128083;
    SourceTableView=SORTING(UserID,Project No.,Line No.)
                    ORDER(Ascending)
                    WHERE(Hide=CONST(No));
    PageType=List;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Reports,Invoices,Invoicing,Other,Overview,Category8_caption,Category9_caption,Category10_caption;
                                SVE=Ny,Process,Rapport,Fakturor,Fakturering,™vrigt,™versikt,Category8_caption,Category9_caption,Category10_caption];
    OnOpenPage=VAR
                 ProjectPrincipal@1100285100 : Record 11012005;
                 ProjectDetailsCU@1100285101 : Codeunit 11128091;
                 SESetup@1101285000 : Record 11128004;
                 ProjectElement@1100583000 : Record 11012010;
                 Customer@1100285102 : Record 18;
               BEGIN
                 //>> 170425 ITERO.SB RFC-101.2
                 Period := FORMAT(DMY2DATE(1,DATE2DMY(WORKDATE,2),DATE2DMY(WORKDATE,3))) + '..' + FORMAT(CALCDATE('<CM>',WORKDATE));
                 //AppMgmt.MakeDateFilter(Period);
                 //ProjectDetailsCU.GetGLEntrysPeriod(UserID,"Project No.",Period);
                 //<<
                 Job.GET("Project No.");

                 IF Job."Forecast Level"=Job."Forecast Level"::"Cost Component" THEN BEGIN
                   Overview := TRUE;
                   SETRANGE(InOverview,TRUE);
                 END ELSE BEGIN
                   Overview := FALSE;
                   SETRANGE(InOverview);
                   //SETRANGE("Cost Component Code",'');
                   Compress:=TRUE;
                 //>>180920
                 //  SETFILTER(Total,'<>%1',0);
                   SETRANGE(TotalNotZero,TRUE);
                 //<<180920
                   CurrPage.UPDATE(FALSE);
                 END;

                 Prognosis.SETRANGE("Project No.",Job."No.");
                 IF Prognosis.FINDLAST THEN
                   ProgCom := Prognosis.Comment
                 ELSE
                   ProgCom := '';

                 IF Job."Single/Main/Sub Project"=Job."Single/Main/Sub Project"::"Main Project" THEN
                   ProjectPrincipal.SETRANGE("Main Project No.","Project No.")
                 ELSE
                   ProjectPrincipal.SETRANGE("Project No.","Project No.");

                 ProjectPrincipal.CALCSUMS("Contract Amount (LCY)");
                 ContractAmount:=ProjectPrincipal."Contract Amount (LCY)";

                 IF SESetup.GET(SESetup."Line type"::Setup,'PROJDETAIL','FILLPROG') THEN
                   IF SESetup."Value (bool)" THEN
                     SetPrognosis2 := TRUE
                   ELSE
                     SetPrognosis := TRUE;

                 //4PSSE.sn 181115
                 IF NOT SESetup.GET(SESetup."Line type"::Setup,'PROJDETAIL','FILLSUNDRY') THEN BEGIN
                   SESetup.INIT;
                   SESetup."Line type" := SESetup."Line type"::Setup;
                   SESetup.Code := 'PROJDETAIL';
                   SESetup."Code 2" := 'FILLSUNDRY';
                   SESetup.Description := 'Inst„llning f”r att kunna fylla kostnadskoder av typ Diverse (bool)';
                   SESetup."Value (bool)" := FALSE;
                   SESetup.INSERT;
                 END;
                 SetFillSundry := SESetup."Value (bool)";
                 //4PSSE.en 181115

                 IF SESetup.GET(SESetup."Line type"::Setup,'PROJDETAIL','REMAININGPROGN') THEN
                   IF SESetup."Value (bool)" THEN BEGIN
                     SetPrognosis := FALSE;
                     IF Job."Prognosis Budget Line" THEN
                       ProgBudget := TRUE
                     ELSE
                       ProgBudget2 := TRUE;
                   END;

                 CustButtonsPageID:=11128089;
                 CustButtonsVisible1 := CustomSelectedbuttons.GET(CustButtonsPageID,1);
                 CustButtonsVisible2 := CustomSelectedbuttons.GET(CustButtonsPageID,2);
                 CustButtonsVisible3 := CustomSelectedbuttons.GET(CustButtonsPageID,3);

                 //190607>>
                 ProjectElement.SETRANGE("Project No.","Project No.");
                 IF NOT ProjectElement.ISEMPTY THEN
                   UsePostionfilter := TRUE;

                 Postionfilter := '';
                 //<<

                 IF Customer.GET(Job."Bill-to Customer No.") THEN
                 PrincipalNAme := Customer.Name;
               END;

    OnAfterGetRecord=VAR
                       ProjDetail@1100285002 : Record 11128083;
                       ProjDetail2@1100285001 : Record 11128083;
                       PSum@1100285000 : Decimal;
                     BEGIN

                       IF Job."Forecast Level"=Job."Forecast Level"::"Cost Object" THEN BEGIN
                         SumLine:=TRUE;
                         IF ("Sum Line"=TRUE) OR ("Prognosis Cost Object"='') OR (("Cost Type"="Cost Type"::Sundry) AND (NOT SetFillSundry)) THEN
                           SumLine:=FALSE;
                       END ELSE IF Job."Forecast Level"=Job."Forecast Level"::"Cost Component" THEN BEGIN
                         SumLine:=TRUE;
                         IF ("Cost Component Code"='') OR (("Cost Type"="Cost Type"::Sundry) AND (NOT SetFillSundry))  THEN
                           SumLine:=FALSE;
                       END;

                       IF (InOverview) AND (Overview = FALSE) THEN
                         InOV:=TRUE
                       ELSE
                         InOV:=FALSE;
                       //>> 180130 ITERO.SB REK-049 Highlight fields when negative amount
                       IF InOV THEN BEGIN
                         IF ("New Prognosis Amount"-"GL Amount") < 0 THEN
                           Mark1:='Unfavorable'
                         ELSE
                          Mark1:='Strong';

                         IF ("Prognosis Amount"-"GL Amount") < 0 THEN
                           Mark2:='Unfavorable'
                         ELSE
                          Mark2:='Strong';
                       END ELSE BEGIN
                         IF ("New Prognosis Amount"-"GL Amount") < 0 THEN
                           Mark1:='Attention'
                         ELSE
                          Mark1:='Standard';

                         IF ("Prognosis Amount"-"GL Amount") < 0 THEN
                           Mark2:='Attention'
                         ELSE
                           Mark2:='Standard';
                       END;
                       //<<

                       PrognosisBL := SumLine;
                       PrognosisBL2 := FALSE;
                       IF Job."Prognosis Budget Line" AND ("Cost Type" <>"Cost Type"::Revenue) THEN
                         PrognosisBL := FALSE;
                       IF Job."Prognosis Budget Line" AND ("Cost Type" = "Cost Type"::Revenue) AND ("Prognosis Cost Object"<>'') THEN
                         PrognosisBL2 := TRUE;
                     END;

    OnModifyRecord=VAR
                     ProjDetail@1100285002 : Record 11128083;
                     ProjDetail2@1100285001 : Record 11128083;
                     PSum@1100285000 : Decimal;
                   BEGIN
                   END;

    OnQueryClosePage=VAR
                       SESetup@1101285000 : Record 11128004;
                       ProjDetail@1101285001 : Record 11128083;
                       Text001@1101285002 : TextConst 'ENU=Prognosis not saved, do you still want to quit?;SVE=P†b”rjad prognos finns, vill du „nd† avsluta (obs. p†b”rjad prognos sparas ej)?';
                     BEGIN
                       //>> 171228 ITERO.SB Question when closing page (not saved prognosis)
                       IF SESetup.GET(SESetup."Line type"::Setup,'PROJDETAIL','FILLPROG') THEN
                         IF SESetup."Value (bool)" THEN BEGIN
                           ProjDetail.SETRANGE(UserID,UserID);
                           ProjDetail.SETRANGE("Project No.","Project No.");
                           ProjDetail.SETFILTER("New Prognosis Amount",'<>0');
                           //>> 180308 ITERO.SB Buggfix (REK)
                           ProjDetail.SETRANGE("Code line",FALSE);
                           ProjDetail.SETRANGE("Sum Line",FALSE);
                           //<<
                           IF ProjDetail.FINDFIRST THEN
                             IF NOT CONFIRM(Text001) THEN
                               ERROR('');
                         END;
                       //<<
                     END;

    ActionList=ACTIONS
    {
      { 1100285009;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100285008;1 ;ActionGroup;
                      CaptionML=[ENU=Project;
                                 NOR=Prosjekt;
                                 SVE=Projekt] }
      { 1100285007;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=&Budget;
                                 NOR=&Budsjett;
                                 SVE=&Budget];
                      RunObject=Page 11128085;
                      RunPageLink=Project No.=FIELD(Project No.),
                                  Cost Object=FIELD(Budget Line Cost Object);
                      Promoted=Yes;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=LedgerBudget;
                      PromotedCategory=Process }
      { 1100285101;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=&Budget;
                                 NOR=&Budsjett;
                                 SVE=&Budget];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=LedgerBudget;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1101285000 : Record 11072003;
                               BEGIN
                                 //181121 ORANGO.EE
                                 Job.SETRANGE("No.", "Project No.");
                                 IF Job.FINDLAST THEN;
                                 PAGE.RUNMODAL(PAGE::"Project Budget", Job);
                               END;
                                }
      { 1100285115;2 ;Action    ;
                      CaptionML=[ENU=Budget &Adjustments;
                                 NOR=Budsjett&justeringer;
                                 SVE=Budget&justeringar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Balance;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 BudgetAdjustment@1100525000 : Record 11012003;
                               BEGIN
                                 BudgetAdjustment.SETRANGE("Project No.", "Project No.");
                                 IF BudgetAdjustment.FINDLAST THEN;
                                 PAGE.RUNMODAL(PAGE::"Budget Adjustment List", BudgetAdjustment);
                               END;
                                }
      { 1100285010;2 ;Action    ;
                      CaptionML=[ENU=Pr&ognosis;
                                 NOR=Pr&ognose;
                                 SVE=Prognos];
                      Promoted=Yes;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 LaunchPrognosisList;
                               END;
                                }
      { 1100285011;2 ;Action    ;
                      CaptionML=[ENU=Project;
                                 SVE=Projekt];
                      RunObject=Page 11128094;
                      RunPageView=SORTING(G/L Account No.,Global Dimension 1 Code,Global Dimension 2 Code,Posting Date)
                                  ORDER(Ascending);
                      RunPageLink=Job No.=FIELD(Project No.),
                                  Global Dimension 2 Code=FIELD(Budget Line Cost Object);
                      Promoted=No;
                      Visible=FALSE;
                      Image=GeneralLedger;
                      PromotedCategory=Process }
      { 1100285012;2 ;Action    ;
                      CaptionML=[ENU=Transactions;
                                 NOR=Transaksjoner;
                                 SVE=Transaktioner];
                      Promoted=Yes;
                      Image=GeneralLedger;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 GLE@1100285000 : Record 17;
                                 Strangen@1100285001 : Text[50];
                                 AFilt1@1100285002 : Code[10];
                                 AFilt2@1100285003 : Code[10];
                                 AFilt3@1100285004 : Code[10];
                                 AFilt4@1100285005 : Code[10];
                                 AFilt5@1100285006 : Code[10];
                                 Job@1100285300 : Record 11072003;
                                 JLE@1100285301 : Record 11072005;
                                 ProjDetail2@1100285302 : Record 11128083;
                                 CostObjFilter@1100285303 : Text;
                               BEGIN
                                 {
                                 GLE.SETRANGE("Job No.","Project No.");
                                 GLE.SETRANGE("Global Dimension 2 Code","Budget Line Cost Object");
                                 Strangen := "Exclude Account";
                                 IF STRPOS(Strangen,';') > 0 THEN BEGIN
                                   EVALUATE(AFilt1,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                                   Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                                 END ELSE BEGIN
                                   AFilt1 := Strangen;
                                 END;
                                 IF STRPOS(Strangen,';') > 0 THEN BEGIN
                                   EVALUATE(AFilt2,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                                   Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                                 END ELSE BEGIN
                                   AFilt2 := Strangen;
                                 END;
                                 IF STRPOS(Strangen,';') > 0 THEN BEGIN
                                   EVALUATE(AFilt3,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                                   Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                                 END ELSE BEGIN
                                   AFilt3 := Strangen;
                                 END;
                                 IF STRPOS(Strangen,';') > 0 THEN BEGIN
                                   EVALUATE(AFilt4,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                                   Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                                 END ELSE BEGIN
                                   AFilt4 := Strangen;
                                 END;
                                 IF STRPOS(Strangen,';') > 0 THEN BEGIN
                                   EVALUATE(AFilt5,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                                   Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                                 END ELSE BEGIN
                                   AFilt5 := Strangen;
                                 END;
                                 GLE.SETFILTER("G/L Account No.",'<>%1&<>%2&<>%3&<>%4&<>%5',AFilt1,AFilt2,AFilt3,AFilt4,AFilt5);
                                 PAGE.RUNMODAL(PAGE::"Project Detail Gen.Led.Entries",GLE);
                                 }

                                 Job.GET("Project No.");

                                 IF Job."Single/Main/Sub Project"=Job."Single/Main/Sub Project"::"Main Project" THEN
                                   JLE.SETRANGE("Main Project No.","Project No.")
                                 ELSE
                                   JLE.SETRANGE("Job No.","Project No.");

                                 JLE.SETRANGE("Global Dimension 2 Code","GL Entry Cost Object");

                                 IF "Sum Line" THEN BEGIN
                                   ProjDetail2.SETRANGE(UserID,UserID);
                                   ProjDetail2.SETRANGE("Project No.","Project No.");
                                   ProjDetail2.SETRANGE("Code line",FALSE);
                                   ProjDetail2.SETRANGE("Sum Line",FALSE);
                                   ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                                   ProjDetail2.SETRANGE("Sum Amount",TRUE);
                                   ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                                   ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                                   IF ProjDetail2.FIND('-') THEN BEGIN
                                     REPEAT
                                       IF CostObjFilter='' THEN
                                         CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                       ELSE
                                         CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                                     UNTIL ProjDetail2.NEXT = 0;
                                   END;
                                   IF CostObjFilter<>'' THEN
                                     JLE.SETFILTER("Global Dimension 2 Code",CostObjFilter);
                                 END;

                                 PAGE.RUNMODAL(PAGE::"Job Ledger Entries",JLE);
                                 {
                                 IF "Cost Type"="Cost Type"::Labor THEN
                                   PAGE.RUNMODAL(PAGE::"Project Ledger (Compr) Labour",JLE)
                                 ELSE BEGIN
                                   //JLE.SETCURRENTKEY("Main Project No.","Job No.","Employee No.","Cost Type","Posting Date","Employee External","Entry Type");
                                   PAGE.RUNMODAL(PAGE::"Project Ledger (Compressed)",JLE);
                                 END;
                                 //>> 160902 ITERO.SB
                                 }
                               END;
                                }
      { 1100285307;2 ;Action    ;
                      CaptionML=[ENU=Transactions (compr.);
                                 NOR=Transaksjoner (compr.);
                                 SVE=Transaktioner (kompr.)];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=GeneralLedger;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 GLE@1100285000 : Record 17;
                                 Strangen@1100285001 : Text[150];
                                 AFilt1@1100285002 : Code[10];
                                 AFilt2@1100285003 : Code[10];
                                 AFilt3@1100285004 : Code[10];
                                 AFilt4@1100285005 : Code[10];
                                 AFilt5@1100285006 : Code[10];
                                 AFilt6@1100285103 : Code[10];
                                 AFilt7@1100285102 : Code[10];
                                 AFilt8@1100285101 : Code[10];
                                 AFilt9@1100285100 : Code[10];
                                 JLE@1100285104 : Record 11072005;
                                 CostObjFilter@1100285105 : Text;
                                 ProjDetail2@1100285106 : Record 11128083;
                                 Job@1100285300 : Record 11072003;
                               BEGIN
                                 //>> 160902 ITERO.SB
                                 //JLE.SETRANGE("Job No.","Project No.");

                                 //JLE.SETRANGE("Main Project No.","Project No.");
                                 Job.GET("Project No.");
                                 //<<170905 ITERO.SB
                                 JLE.FILTERGROUP(25);
                                 //<<
                                 IF Job."Single/Main/Sub Project"=Job."Single/Main/Sub Project"::"Main Project" THEN
                                   JLE.SETRANGE("Main Project No.","Project No.")
                                 ELSE
                                   JLE.SETRANGE("Job No.","Project No.");

                                 IF "Cost Component Code"<>'' THEN
                                   JLE.SETRANGE("Cost Component","Cost Component Code")
                                 ELSE
                                   JLE.SETRANGE("Global Dimension 2 Code","GL Entry Cost Object");

                                 IF "Sum Line" THEN BEGIN
                                   ProjDetail2.SETRANGE(UserID,UserID);
                                   ProjDetail2.SETRANGE("Project No.","Project No.");
                                   ProjDetail2.SETRANGE("Code line",FALSE);
                                   ProjDetail2.SETRANGE("Sum Line",FALSE);
                                   ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                                   ProjDetail2.SETRANGE("Sum Amount",TRUE);
                                   ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                                   ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                                   IF ProjDetail2.FIND('-') THEN BEGIN
                                     REPEAT
                                       IF CostObjFilter='' THEN
                                         CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                       ELSE
                                         CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                                     UNTIL ProjDetail2.NEXT = 0;
                                   END;
                                   IF CostObjFilter<>'' THEN
                                     JLE.SETFILTER("Global Dimension 2 Code",CostObjFilter);
                                 END;
                                 //PAGE.RUNMODAL(PAGE::"Job Ledger Entries",JLE);
                                 //>>170905 ITERO.SB
                                 JLE.FILTERGROUP(0);
                                 //<<
                                 IF "Cost Type"="Cost Type"::Labor THEN
                                   PAGE.RUNMODAL(PAGE::"Project Ledger (Compr) Labour",JLE)
                                 ELSE BEGIN
                                   //JLE.SETCURRENTKEY("Main Project No.","Job No.","Employee No.","Cost Type","Posting Date","Employee External","Entry Type");
                                   PAGE.RUNMODAL(PAGE::"Project Ledger (Compressed)",JLE);
                                 END;
                               END;
                                }
      { 1100285100;2 ;Action    ;
                      CaptionML=[ENU=Create prognosis;
                                 NOR=Opprette prognose;
                                 SVE=Skapa prognos];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 MgtProjdetails@1100285000 : Codeunit 11128091;
                                 Job@1100285001 : Record 11072003;
                               BEGIN
                                 //MgtProjdetails.MgtProjDetailUpdate(UserID,"Project No.");
                                 //Job.GET("Project No.");
                                 //CreatePrognosis.SETTABLEVIEW(Job);
                                 //CreatePrognosis.RUN;
                                 Job.SETFILTER("No.","Project No.");
                                 CreatePrognosis.SetPositionFilter(Postionfilter);
                                 REPORT.RUNMODAL(11128081,TRUE,FALSE,Job);

                                 MgtProjdetails.MgtProjDetailUpdate(UserID,"Project No.",'');
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1101285011;2 ;Action    ;
                      Name=CreatePrognosisFromBudget;
                      CaptionML=[ENU=Create Prognosis from Budget;
                                 SVE=Skapa prognos fr†n budget];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 MgtProjdetails@1101285001 : Codeunit 11128091;
                                 Job@1101285000 : Record 11072003;
                                 RemainingProg@1100583001 : Boolean;
                                 SESetup@1100583002 : Record 11128004;
                                 Prognosis@1100583000 : Record 11012034;
                               BEGIN
                                 //190129 4PS.SE
                                 SESetup.SETRANGE("Code 2",'REMAININGPROGN');
                                 IF SESetup.FINDFIRST AND (SESetup."Value (bool)") THEN
                                   RemainingProg:=TRUE;

                                 Prognosis.SETRANGE("Project No.", "Project No.");
                                 IF Prognosis.FINDFIRST THEN
                                   ERROR(Text003);

                                 IF RemainingProg = TRUE THEN
                                   MgtProjdetails.SetPrognosisBudgetRemaining(UserID,"Project No.")
                                 ELSE
                                   MgtProjdetails.SetPrognosisBudget(UserID,"Project No.");
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1100285013;2 ;Action    ;
                      Name=Prognos;
                      CaptionML=[ENU=Pr&ognosis;
                                 NOR=Pr&ognose;
                                 SVE=Prognoshistorik];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=History;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1100285000 : Record 11072003;
                               BEGIN
                                 Job.GET("Project No.");
                                 Job.LaunchPrognosisList()
                               END;
                                }
      { 1100285014;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=&Budget;
                                 NOR=&Budsjett;
                                 SVE=&Budget];
                      RunObject=Page 11012003;
                      RunPageLink=No.=FIELD(Project No.);
                      Promoted=Yes;
                      Visible=false;
                      Image=LedgerBudget;
                      PromotedCategory=Category5 }
      { 1100285016;2 ;Action    ;
                      CaptionML=[ENU=&Installments;
                                 NOR=&Betalingsplaner;
                                 SVE=&Betalplaner];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AmountByPeriod;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ProjectInstallment@1101285001 : Record 11012018;
                               BEGIN
                                 //190121 ORANGO.EE
                                 ProjectInstallment.SETRANGE("Project No.", "Project No.");
                                 PAGE.RUNMODAL(PAGE::"Project Installments", ProjectInstallment);
                               END;
                                }
      { 1100285015;2 ;Action    ;
                      ShortCutKey=Ctrl+M;
                      CaptionML=[ENU=&Extensions;
                                 NOR=&ETA;
                                 SVE=&ŽTA];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TransferFunds;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ExtensionContract@1101285000 : Record 11012004;
                               BEGIN
                                 //190121 ORANGO.EE
                                 ExtensionContract.SETRANGE("Project No.", "Project No.");
                                 PAGE.RUNMODAL(PAGE::"Extension List", ExtensionContract);
                               END;
                                }
      { 1101285009;2 ;Action    ;
                      AccessByPermission=Page 11229284=X;
                      CaptionML=[ENU=Work Orders;
                                 NOR=Arbeidsordre;
                                 SVE=Arbetsordrar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=HRSetup;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 Proj@1100529000 : Record 11072003;
                               BEGIN
                                 Proj.ShowWorkOrders("Project No.", '');
                               END;
                                }
      { 1100285017;2 ;Action    ;
                      CaptionML=[ENU=Project Control;
                                 NOR=Prosjektkontroll;
                                 SVE=Projektkontroll];
                      Image=PayrollStatistics;
                      OnAction=VAR
                                 ProjectRec@1100525000 : Record 11072003;
                                 Job@1100285000 : Record 11072003;
                               BEGIN
                                 Job.GET("Project No.");
                                 Job.OpenProjectControl;
                               END;
                                }
      { 1100285021;2 ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer;
                                 SVE=Fakturor];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedOrder;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Job@1100285000 : Record 11072003;
                                 SalesInvHeader@1100285101 : Record 112;
                                 SalesInvLine@1100285100 : Record 113;
                               BEGIN
                                 //**4PS
                                 Job.GET("Project No.");
                                 //Job.ShowPostedInvoices;

                                 //**4PS
                                 SalesInvLine.SETCURRENTKEY("Job No.");
                                 SalesInvLine.SETRANGE("Job No.",Job."No.");
                                 IF SalesInvLine.FINDSET THEN
                                   REPEAT
                                     IF (SalesInvHeader.GET(SalesInvLine."Document No.")) AND (NOT SalesInvHeader."Plant Invoice") THEN
                                       SalesInvHeader.MARK(TRUE);
                                   UNTIL SalesInvLine.NEXT = 0;

                                 SalesInvHeader.MARKEDONLY(TRUE);

                                 PAGE.RUNMODAL(PAGE::"Posted Sales Invoices",SalesInvHeader);
                               END;
                                }
      { 1100285020;2 ;Action    ;
                      CaptionML=[ENU=Credit &Memos;
                                 NOR=Kredit&notaer;
                                 SVE=Kredit&notor];
                      Promoted=Yes;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=PostedCreditMemo;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Job@1100285000 : Record 11072003;
                               BEGIN
                                 //**4PS
                                 Job.GET("Project No.");
                                 Job.ShowPostedCreditMemos;
                               END;
                                }
      { 1100285019;2 ;Action    ;
                      CaptionML=[ENU=Credit Memos, not posted;
                                 NOR=Fakturaer;
                                 SVE=Kreditnotor, ej bokf”rda];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 SalesLine@1100285000 : Record 37;
                                 SalesHeader@1100285001 : Record 36;
                               BEGIN
                                 //**4PS
                                 //ShowPostedInvoices;


                                 SalesLine.SETCURRENTKEY("Job No.");
                                 SalesLine.SETRANGE("Job No.","Project No.");
                                 SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::"Credit Memo");
                                 IF SalesLine.FINDSET THEN
                                   REPEAT
                                     IF SalesHeader.GET(SalesLine."Document Type",SalesLine."Document No.") THEN
                                       SalesHeader.MARK(TRUE);
                                   UNTIL SalesLine.NEXT = 0;

                                 SalesHeader.MARKEDONLY(TRUE);
                                 PAGE.RUNMODAL(PAGE::"Sales Credit Memos",SalesHeader);
                               END;
                                }
      { 1100285018;2 ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer;
                                 SVE=Fakturor, ej bokf”rda];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 SalesLine@1100285000 : Record 37;
                                 SalesHeader@1100285001 : Record 36;
                               BEGIN
                                 //**4PS
                                 //ShowPostedInvoices;


                                 SalesLine.SETCURRENTKEY("Job No.");
                                 SalesLine.SETRANGE("Job No.","Project No.");
                                 SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Invoice);
                                 IF SalesLine.FINDSET THEN
                                   REPEAT
                                     IF SalesHeader.GET(SalesLine."Document Type",SalesLine."Document No.") THEN
                                       SalesHeader.MARK(TRUE);
                                   UNTIL SalesLine.NEXT = 0;

                                 SalesHeader.MARKEDONLY(TRUE);
                                 PAGE.RUNMODAL(PAGE::"Sales Invoice List",SalesHeader);
                               END;
                                }
      { 1101285017;2 ;Action    ;
                      CaptionML=[ENU=Show ExflowDocs by project;
                                 SVE=Visa Attestdokument per projekt];
                      Promoted=Yes;
                      Image=CoupledPurchaseInvoice;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ProjectDetails@1101285000 : Codeunit 11128091;
                               BEGIN
                                 TESTFIELD("Project No.");
                                 ProjectDetails.ShowPostedExfPurchaseInvoices("Project No.");
                               END;
                                }
      { 1100285102;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+A;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Generate Cost Plus Entries;
                                 NOR=Opprette selvkosttransaksjoner;
                                 SVE=Generera redovisade sj„lvkostnader];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 lvProjRec@1210190026 : Record 11072003;
                                 lvProjLedgEntryRec@1210190019 : Record 11072005;
                                 lvPostedHourLineRec@1210190015 : Record 11012085;
                                 lvHourAccLineRec@1210190002 : Record 11012039;
                                 lvCreateCostPlusRpt@1210190001 : Report 11012013;
                               BEGIN
                                 //**4PS

                                 lvProjRec.SETRANGE("No.", "Project No.");
                                 lvProjLedgEntryRec.SETRANGE("Cost Plus Entry Created", FALSE);
                                 lvPostedHourLineRec.SETRANGE("Cost Plus Entry Created", FALSE);
                                 lvHourAccLineRec.SETRANGE("Cost Plus Entry Created", FALSE);

                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvProjRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvProjLedgEntryRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvPostedHourLineRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvHourAccLineRec);
                                 lvCreateCostPlusRpt.SetDefault("Project No.");
                                 lvCreateCostPlusRpt.RUN;
                               END;
                                }
      { 1100285022;2 ;Action    ;
                      CaptionML=[ENU=Settlement Sheet;
                                 NOR=Oppgj›rsskjema;
                                 SVE=Avr„kningsark];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CostBudget;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 SettlementSheet@1100409000 : Record 11012021;
                                 Counter@1100409001 : Integer;
                                 Job@1100285000 : Record 11072003;
                               BEGIN
                                 //**4PS
                                 Job.GET("Project No.");

                                 Job.TESTFIELD("Bill-to Customer No.");

                                 SettlementSheet.RESET;
                                 SettlementSheet.SETRANGE("Project No.", Job."No.");
                                 Counter := SettlementSheet.COUNT;
                                 IF Counter > 0 THEN BEGIN
                                   PAGE.RUNMODAL(PAGE::"Settlement Sheet List", SettlementSheet);
                                 END ELSE BEGIN
                                   IF Counter = 0 THEN BEGIN
                                     IF CONFIRM(Text11012007,TRUE) THEN BEGIN
                                       Job.InsertSettlementSheet(Job."Bill-to Customer No.");
                                       COMMIT;
                                       IF SettlementSheet.FINDFIRST THEN
                                         PAGE.RUNMODAL(PAGE::"Settlement Sheet List", SettlementSheet);
                                     END;
                                   END;
                                 END;
                               END;
                                }
      { 1100285024;2 ;Action    ;
                      Name=<Action1100285000>;
                      CaptionML=[ENU=ROT/RUT Reduction;
                                 NOR=ROT/RUT Bel›p;
                                 SVE=ROT/RUT avdrag];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AmountByPeriod;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ROTInformation@1100285000 : Record 11128101;
                                 ROTInformationPage@1100285001 : Page 11128101;
                               BEGIN
                                 // Check if there is any ROT related to the current record
                                 ROTInformation.RESET();
                                 ROTInformation.SETRANGE(Type, ROTInformation.Type::Project);
                                 ROTInformation.SETRANGE("Document No.", "Project No.");

                                 // Set the page view and open ROT Information page.
                                 ROTInformationPage.SETTABLEVIEW(ROTInformation);
                                 ROTInformationPage.RUN;
                               END;
                                }
      { 1100285025;2 ;Action    ;
                      ShortCutKey=Ctrl+U;
                      CaptionML=[ENU=Update projectdetails;
                                 NOR=Oppdater prosjektdetaljer;
                                 SVE=Uppdatera projektdetaljer];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UpdateUnitCost;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 MgtProjdetails@1100285000 : Codeunit 11128091;
                               BEGIN
                                 MgtProjdetails.MgtProjDetailUpdate(UserID,"Project No.",'');
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1100285027;2 ;Action    ;
                      CaptionML=[ENU=Create Prognosis;
                                 SVE=Skapa prognos];
                      Promoted=Yes;
                      Visible=false;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 MgtProjdetails@1100285000 : Codeunit 11128091;
                                 Job@1100285001 : Record 11072003;
                               BEGIN
                                 //MgtProjdetails.MgtProjDetailUpdate(UserID,"Project No.");
                                 //Job.GET("Project No.");
                                 //CreatePrognosis.SETTABLEVIEW(Job);
                                 //CreatePrognosis.RUN;

                                 //Job.SETFILTER("No.","Project No.");
                                 //REPORT.RUNMODAL(11128081,TRUE,FALSE,Job);

                                 Job.SETRANGE("No.","Project No.");
                                 CreatePrognosis.SETTABLEVIEW(Job);
                                 CreatePrognosis.SetPositionFilter(Postionfilter);
                                 CreatePrognosis.RUN;

                                 MgtProjdetails.MgtProjDetailUpdate(UserID,"Project No.",'');
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1100285028;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+P;
                      CaptionML=[ENU=Principals;
                                 NOR=oppdragsgiver;
                                 SVE=Uppdragsgivare];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TeamSales;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectPrincipal@1101285000 : Record 11012005;
                               BEGIN
                                 //190121 ORANGO.EE
                                 ProjectPrincipal.SETRANGE("Project No.", "Project No.");
                                 PAGE.RUNMODAL(PAGE::"Project Principal List", ProjectPrincipal);
                               END;
                                }
      { 1100285300;2 ;Action    ;
                      CaptionML=[ENU=Project Hours per Employee;
                                 NOR=Prosjekt timer per ansatt;
                                 SVE=Projekttimmar per anst„lld];
                      Promoted=Yes;
                      Image=Employee;
                      OnAction=VAR
                                 MgtProjdetails@1100285000 : Codeunit 11128091;
                                 Job@1100285001 : Record 11072003;
                               BEGIN
                                 Job.SETFILTER("No.","Project No.");
                                 REPORT.RUNMODAL(11012039,TRUE,FALSE,Job);
                               END;
                                }
      { 1000000002;2 ;Action    ;
                      ShortCutKey=Ctrl+O;
                      CaptionML=[ENU=Overview (On/Off);
                                 NOR=Oversikt (On/Off);
                                 SVE=™versikt p†/av];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Compress;
                      PromotedCategory=Category7;
                      OnAction=BEGIN

                                 IF Overview = TRUE THEN BEGIN
                                   Overview:=FALSE;
                                   SETRANGE(InOverview);
                                 END ELSE BEGIN
                                   Overview:=TRUE;
                                   SETRANGE(InOverview,TRUE);
                                 END;
                               END;
                                }
      { 1100285304;2 ;Action    ;
                      CaptionML=[ENU=Archive Projectdetails;
                                 NOR=Arkivere prosjektdetaljer;
                                 SVE=Arkivera projektdetaljer];
                      Promoted=Yes;
                      Image=Archive;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 lvArchivePD@1000000000 : Record 11128111;
                                 lvArchivePDFind@1000000001 : Record 11128111;
                                 NyVersion@1000000002 : Integer;
                                 lvProjDetail@1000000003 : Record 11128083;
                               BEGIN
                                 lvArchivePDFind.SETRANGE(UserID,UserID);
                                 lvArchivePDFind.SETRANGE("Project No.","Project No.");
                                 IF lvArchivePDFind.FINDLAST THEN BEGIN
                                   NyVersion := lvArchivePDFind.Version + 1;
                                 END ELSE BEGIN
                                   NyVersion := 1;
                                 END;

                                 lvProjDetail.SETRANGE(UserID,UserID);
                                 lvProjDetail.SETRANGE("Project No.","Project No.");
                                 IF lvProjDetail.FIND('-') THEN BEGIN
                                   REPEAT
                                     lvArchivePD.INIT;
                                     lvArchivePD.Version := NyVersion;
                                     lvArchivePD.UserID := lvProjDetail.UserID;
                                     lvArchivePD."Project No." := lvProjDetail."Project No.";
                                     lvArchivePD."Line No." := lvProjDetail."Line No.";
                                     lvArchivePD.Caption := lvProjDetail.Caption;
                                     lvArchivePD."Budget Amount" := lvProjDetail."Budget Amount";
                                     lvArchivePD."GL Amount" := lvProjDetail."GL Amount";
                                     lvArchivePD."Prognosis Amount" := lvProjDetail."Prognosis Amount";
                                     lvArchivePD."Budget Line Cost Object" := lvProjDetail."Budget Line Cost Object";
                                     lvArchivePD."Budget Line Filter 2" := lvProjDetail."Budget Line Filter 2";
                                     lvArchivePD."GL Entry Cost Object" := lvProjDetail."GL Entry Cost Object";
                                     lvArchivePD."Exclude Account" := lvProjDetail."Exclude Account";
                                     lvArchivePD."Prognosis Cost Object" := lvProjDetail."Prognosis Cost Object";
                                     lvArchivePD."Prognosis Line Filter 2" := lvProjDetail."Prognosis Line Filter 2";
                                     lvArchivePD."Budget Contractamount" := lvProjDetail."Budget Contractamount";
                                     lvArchivePD."Total Line No. From" := lvProjDetail."Total Line No. From";
                                     lvArchivePD."Total Line No. To" := lvProjDetail."Total Line No. To";
                                     lvArchivePD."Code line" := lvProjDetail."Code line";
                                     lvArchivePD."Sum Line" := lvProjDetail."Sum Line";
                                     lvArchivePD.Hide := lvProjDetail.Hide;
                                     lvArchivePD.Description := lvProjDetail.Description;
                                     lvArchivePD."Sum Amount" := lvProjDetail."Sum Amount";
                                     lvArchivePD."Sum Quantity" := lvProjDetail."Sum Quantity";
                                     lvArchivePD.Calcualation := lvProjDetail.Calcualation;
                                     lvArchivePD."Cost Type" := lvProjDetail."Cost Type";
                                     lvArchivePD."Ovearhead Level" := lvProjDetail."Ovearhead Level";
                                     lvArchivePD."Global Dimension 1 Code" := lvProjDetail."Global Dimension 1 Code";
                                     lvArchivePD."Switch Sign" := lvProjDetail."Switch Sign";
                                     lvArchivePD."New Prognosis Amount" := lvProjDetail."New Prognosis Amount";
                                     lvArchivePD.Procent := lvProjDetail.Procent;
                                     lvArchivePD.InOverview := lvProjDetail.InOverview;
                                     lvArchivePD.Comment := lvProjDetail.Comment;
                                     lvArchivePD."Prognosis comment" := lvProjDetail."Prognosis comment";
                                     lvArchivePD."Original Budget" := lvProjDetail."Original Budget";
                                     lvArchivePD."Budget adjustment" := lvProjDetail."Budget adjustment";
                                     lvArchivePD.INSERT;
                                   UNTIL lvProjDetail.NEXT = 0;
                                 END;
                               END;
                                }
      { 1100285303;2 ;Action    ;
                      CaptionML=[ENU=Get archived version;
                                 NOR=Hente opp arkiveret versjon;
                                 SVE=H„mta arkiverad version];
                      Promoted=Yes;
                      Image=GetLines;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 lvArchivePD@1000000002 : Record 11128111;
                                 lvArchivePDFind@1000000001 : Record 11128111;
                                 lvProjDetail@1000000000 : Record 11128083;
                               BEGIN
                                 lvArchivePDFind.SETRANGE(UserID,UserID);
                                 lvArchivePDFind.SETRANGE("Project No.","Project No.");
                                 IF lvArchivePDFind.FINDLAST THEN BEGIN
                                   lvArchivePD.SETRANGE(UserID,UserID);
                                   lvArchivePD.SETRANGE("Project No.","Project No.");
                                   lvArchivePD.SETRANGE(Version,lvArchivePDFind.Version);
                                   IF lvArchivePD.FIND('-') THEN BEGIN
                                     REPEAT
                                       IF lvProjDetail.GET(lvArchivePD.UserID,lvArchivePD."Project No.",lvArchivePD."Line No.") THEN BEGIN
                                         lvProjDetail.VALIDATE("New Prognosis Amount",lvArchivePD."New Prognosis Amount");
                                         lvProjDetail.VALIDATE(Comment,lvArchivePD.Comment);
                                         lvProjDetail.MODIFY;
                                       END;
                                     UNTIL lvArchivePD.NEXT = 0;
                                   END;
                                 END;
                               END;
                                }
      { 1100285305;2 ;Action    ;
                      CaptionML=[ENU=&Print Worksheet;
                                 NOR=&Skriv ut regneark;
                                 SVE=&Skriv ut kalkylblad];
                      Image=Print;
                      OnAction=VAR
                                 ProjRec@1100285000 : Record 11072003;
                                 PrintDoc@1100285001 : Codeunit 229;
                               BEGIN
                                 //**4PS
                                 ProjRec.GET("Project No.");
                                 //CurrPage.SETSELECTIONFILTER(ProjRec);
                                 ProjRec.SETRECFILTER;
                                 PrintDoc.PrintProjWorksheet(ProjRec);
                               END;
                                }
      { 1100285110;2 ;Action    ;
                      CaptionML=[ENU="Prognosis = Accumulated";
                                 NOR="Ny prognose = Virkelig bokf›rt";
                                 SVE=Utfall till prognos];
                      Image=Copy;
                      OnAction=VAR
                                 SESetup@1101285000 : Record 11128004;
                                 RemainingProg@1101285001 : Boolean;
                                 MgtProjdetails@1101285002 : Codeunit 11128091;
                               BEGIN
                                 //190604 4ps.se
                                 SESetup.SETRANGE("Code 2",'REMAININGPROGN');
                                 IF SESetup.FINDFIRST AND (SESetup."Value (bool)") THEN
                                   RemainingProg:=TRUE;

                                 IF RemainingProg = TRUE THEN
                                   MgtProjdetails.SetPrognosisAccRemaining(UserID,"Project No.")
                                 ELSE
                                   MgtProjdetails.SetPrognosisAcc(UserID,"Project No.");
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1100285111;2 ;Action    ;
                      CaptionML=[ENU=Purchase Orders;
                                 NOR=Innkj›psordre;
                                 SVE=Ink”psorder];
                      Promoted=Yes;
                      Image=Purchase;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 Job.GET("Project No.");
                                 Job.ShowPurchaseOrdersForProject;
                               END;
                                }
      { 1100285112;2 ;Action    ;
                      CaptionML=[ENU=Purchase Invoices;
                                 NOR=Kjopsfakturaer;
                                 SVE=Ink”psfakturor];
                      Promoted=Yes;
                      Image=Purchasing;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 PurchInvHeader@1100285100 : Record 122;
                                 PurchaseLine@1100285101 : Record 123;
                                 prevDocNo@1100285102 : Code[30];
                                 PostedPurchInv@1100285103 : Page 146;
                               BEGIN
                                 //**4PS
                                 PurchInvHeader.RESET;
                                 PurchInvHeader.SETCURRENTKEY("Job No.");
                                 PurchInvHeader.SETRANGE("Job No.", "Project No.");
                                 IF PurchInvHeader.FINDSET(FALSE, FALSE) THEN
                                 REPEAT
                                   PurchInvHeader.MARK(TRUE);
                                 UNTIL PurchInvHeader.NEXT = 0;

                                 PurchaseLine.RESET;
                                 PurchaseLine.SETCURRENTKEY("Job No.");
                                 PurchaseLine.SETRANGE("Job No.", "Project No.");
                                 prevDocNo := '';
                                 IF PurchaseLine.FINDSET(FALSE) THEN
                                 REPEAT
                                   IF prevDocNo <> PurchaseLine."Document No." THEN BEGIN
                                     PurchInvHeader.GET(PurchaseLine."Document No.");
                                     IF NOT PurchInvHeader.MARK THEN
                                       PurchInvHeader.MARK(TRUE);
                                     END;
                                   prevDocNo := PurchaseLine."Document No.";
                                 UNTIL PurchaseLine.NEXT=0;

                                 PurchInvHeader.MARKEDONLY(TRUE);
                                 PurchInvHeader.SETRANGE("Job No.");
                                 PostedPurchInv.SETTABLEVIEW(PurchInvHeader);
                                 PostedPurchInv.RUNMODAL;
                               END;
                                }
      { 1100285113;2 ;Action    ;
                      CaptionML=[ENU=Compress Cost Objects;
                                 NOR=Komprimere kostnadsobjekt;
                                 SVE=Komprimera kostnadsobjekt];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Compress;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 IF Compress = FALSE THEN BEGIN
                                   Compress:=TRUE;
                                   //SETRANGE(InOverview,TRUE);

                                 //>>180920
                                 //  SETFILTER(Total,'<>%1',0);
                                   SETRANGE(TotalNotZero,TRUE);
                                 //<<180920

                                   CurrPage.UPDATE(FALSE);
                                 END ELSE BEGIN
                                   Compress:=FALSE;
                                 //>>180920
                                 //  SETRANGE(Total);
                                   SETRANGE(TotalNotZero);
                                 //<<180920
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
      { 1100285116;2 ;Action    ;
                      CaptionML=[ENU=Invoices (Plant);
                                 NOR=Fakturaer (Maskin);
                                 SVE=Fakturor (Maskin)];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedOrder;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Job@1100285000 : Record 11072003;
                                 SalesInvHeader@1100285101 : Record 112;
                                 SalesInvLine@1100285100 : Record 113;
                               BEGIN
                                 //**4PS
                                 Job.GET("Project No.");
                                 //Job.ShowPostedInvoices;

                                 //**4PS
                                 SalesInvLine.SETCURRENTKEY("Job No.");
                                 SalesInvLine.SETRANGE("Job No.",Job."No.");
                                 IF SalesInvLine.FINDSET THEN
                                   REPEAT
                                     IF (SalesInvHeader.GET(SalesInvLine."Document No.")) AND (SalesInvHeader."Plant Invoice") THEN
                                       SalesInvHeader.MARK(TRUE);
                                   UNTIL SalesInvLine.NEXT = 0;

                                 SalesInvHeader.MARKEDONLY(TRUE);

                                 PAGE.RUNMODAL(PAGE::"Posted Sales Invoices",SalesInvHeader);
                               END;
                                }
      { 1100285306;2 ;Action    ;
                      CaptionML=[ENU=Print Site Manager Report;
                                 SVE=Skriv ut arbetschefsrapport];
                      Image=Print;
                      OnAction=VAR
                                 ProjRec@1100285000 : Record 11072003;
                                 PrintDoc@1100285001 : Codeunit 229;
                               BEGIN
                                 //**4PS
                                 ProjRec.GET("Project No.");
                                 //CurrPage.SETSELECTIONFILTER(ProjRec);
                                 ProjRec.SETRECFILTER;
                                 //PrintDoc.PrintProjWorksheet(ProjRec);
                                 PrintDoc.PrintSiteManagerReport(ProjRec);
                               END;
                                }
      { 1101285000;2 ;Action    ;
                      CaptionML=[ENU=&Forecast;
                                 NOR=&Forecast;
                                 SVE=&Prognos ”ver tid];
                      RunObject=Page 11124951;
                      RunPageLink=Project No.=FIELD(Project No.);
                      Visible=false;
                      Image=Forecast }
      { 1101285004;2 ;Action    ;
                      CaptionML=[ENU=Set prognosis;
                                 SVE=Ange prognos];
                      Image=EditForecast;
                      OnAction=VAR
                                 SESetup@1101285000 : Record 11128004;
                               BEGIN
                                 IF SetPrognosis = TRUE THEN BEGIN
                                   SetPrognosis  := FALSE;
                                   SetPrognosis2  := TRUE;
                                 END ELSE BEGIN
                                    SetPrognosis:=TRUE;
                                    SetPrognosis2:=FALSE;
                                 END;
                               END;
                                }
      { 1101285005;2 ;Action    ;
                      CaptionML=[ENU=Transaktions;
                                 SVE=Transaktioner Ankomst+Timmar];
                      Promoted=Yes;
                      Visible=false;
                      Image=GeneralLedger;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF "Sum Line" THEN BEGIN
                                   MESSAGE(Text11120001);
                                 END ELSE BEGIN
                                   ProjDet.GetAmountAndExpCost(UserID,"Project No.","GL Entry Cost Object");
                                   TransCA.SETFILTER(UserID, UserID);
                                   TransCA.SETFILTER("Project No.","Project No.");
                                   TransCA.SETFILTER("Cost Object","GL Entry Cost Object");
                                   PAGE.RUN(PAGE::"Amount Expected Cost Details", TransCA);
                                 END;
                               END;
                                }
      { 1101285006;2 ;Action    ;
                      Name=<Action1000000007>;
                      CaptionML=[ENU=&Print Assembly Worksheet;
                                 NOR=&Skriv ut regneark;
                                 SVE=&Skriv ut kalkylblad (montering)];
                      Visible=false;
                      Image=Print;
                      OnAction=VAR
                                 ProjRec@1100285000 : Record 11072003;
                                 PrintDoc@1100285001 : Codeunit 229;
                               BEGIN
                                 //>> 180221 ITERO.SB REK-005 Added action to print report selection Assembly project worksheet
                                 ProjRec.GET("Project No.");
                                 ProjRec.SETRECFILTER;
                                 ProjRec.SETFILTER("Period Filter",Period);//180507
                                 PrintDoc.PrintAssemblyProjWorksheet(ProjRec);
                                 //<<
                               END;
                                }
      { 1101285007;2 ;Action    ;
                      CaptionML=[ENU=Prognosis Overview;
                                 SVE=Prognos”versikt];
                      RunObject=Page 11128290;
                      RunPageLink=No.=FIELD(Project No.);
                      Promoted=Yes;
                      Image=Worksheet2;
                      PromotedCategory=Category6 }
      { 1100583003;2 ;Action    ;
                      CaptionML=[ENU=Fill revenue prognosis;
                                 SVE=Fyll int„ktsprognos (fr†n betalplan)];
                      Image=Revenue;
                      OnAction=VAR
                                 ProjectInstallment@1100583000 : Record 11012018;
                                 ProjectDetail@1100583001 : Record 11128083;
                                 Text001@1100583002 : TextConst 'ENU=Project installment is missing;SVE=Betalplansrader saknas';
                                 SESetup@1100583003 : Record 11128004;
                                 ShowThousands@1100583004 : Boolean;
                                 RemainingProg@1100583005 : Boolean;
                               BEGIN
                                 SESetup.SETRANGE("Line type",SESetup."Line type"::Setup);
                                 SESetup.SETRANGE(Code,'PROJDETAIL');
                                 SESetup.SETRANGE("Code 2",'SHOWTHOUSANDS');
                                 IF SESetup.GET(SESetup."Line type"::Setup,'PROJDETAIL','SHOWTHOUSANDS') THEN
                                   IF SESetup."Value (bool)" THEN
                                     ShowThousands:=TRUE;
                                 IF SESetup.GET(SESetup."Line type"::Setup,'PROJDETAIL','REMAININGPROGN') THEN
                                 IF SESetup."Value (bool)" THEN
                                   RemainingProg:=TRUE;


                                 //>> 190320 ORANGO.SB Feature #22826 BYGG003
                                 ProjectInstallment.SETRANGE("Project No.","Project No.");
                                 ProjectInstallment.SETRANGE("Extension Contract",'');
                                 IF ProjectInstallment.ISEMPTY THEN
                                   ERROR(Text001);
                                 ProjectInstallment.CALCSUMS("Installment Amount (LCY)");
                                 ProjectDetail.SETRANGE(UserID,UserID);
                                 ProjectDetail.SETRANGE("Project No.","Project No.");
                                 ProjectDetail.SETRANGE("Budget Contractamount",TRUE);
                                 IF ProjectDetail.FINDFIRST THEN BEGIN
                                   IF ShowThousands THEN BEGIN
                                     IF RemainingProg THEN BEGIN
                                       //190527 ORANGO.EE
                                        ProjectDetail.VALIDATE("New Prognosis Amount (rem)",(ProjectInstallment."Installment Amount (LCY)"/1000)-ProjectDetail."Locked GL Amount"); // -ProjectDetail."GL Amount");
                                        ProjectDetail."Prognosis Budget Line":=(ProjectInstallment."Installment Amount (LCY)"/1000)-ProjectDetail."Locked GL Amount"; // -ProjectDetail."GL Amount");
                                     END ELSE
                                       ProjectDetail.VALIDATE("New Prognosis Amount",ProjectInstallment."Installment Amount (LCY)"/1000);

                                   END ELSE BEGIN
                                     IF RemainingProg THEN BEGIN
                                       //190527 ORANGO.EE
                                       ProjectDetail.VALIDATE("New Prognosis Amount (rem)",ProjectInstallment."Installment Amount (LCY)"-ProjectDetail."Locked GL Amount"); // -ProjectDetail."GL Amount");
                                       ProjectDetail."Prognosis Budget Line":=(ProjectInstallment."Installment Amount (LCY)"-ProjectDetail."Locked GL Amount"); // -ProjectDetail."GL Amount");
                                     END ELSE
                                       ProjectDetail.VALIDATE("New Prognosis Amount",ProjectInstallment."Installment Amount (LCY)");

                                   END;
                                   ProjectDetail.MODIFY(TRUE);
                                   CurrPage.UPDATE();
                                 END;
                                 //<<
                               END;
                                }
      { 1100583004;2 ;Action    ;
                      CaptionML=[ENU=Forecast;
                                 NOR=Forecast;
                                 SVE=Prognos ”ver tid];
                      RunObject=Page 11128118;
                      RunPageLink=Project No.=FIELD(Project No.);
                      Image=Forecast;
                      PromotedCategory=Process }
      { 1100583006;2 ;Action    ;
                      CaptionML=[ENU=Lock GL Amount;
                                 SVE=L†s utfall];
                      Image=Lock;
                      OnAction=VAR
                                 SESetup@1101285000 : Record 11128004;
                                 ProjectDetailLockedAmount@1100583000 : Record 11128112;
                                 JobLedgerEntry@1100583001 : Record 11072005;
                                 LastEntryNo@1100583002 : Integer;
                                 Text001@1100583003 : TextConst 'ENU=Job Ledger Entry is missing;SVE=Projekttransaktioner saknas';
                                 MgtProjdetails@1100583004 : Codeunit 11128091;
                                 LockAmount@1101285001 : Report 11128112;
                               BEGIN
                                 //190926 ORANGO.EE #25906
                                 Job.SETFILTER("No.","Project No.");
                                 REPORT.RUNMODAL(11128112, TRUE,FALSE,Job);

                                 //190603 ORANGO.EE #24023
                                 {IF NOT CONFIRM(Text0007, FALSE) THEN
                                   ERROR('');
                                 JobLedgerEntry.SETRANGE("Job No.","Project No.");
                                 IF JobLedgerEntry.FINDLAST THEN
                                   LastEntryNo := JobLedgerEntry."Entry No."
                                 ELSE
                                   ERROR(Text001);}

                                 IF NOT ProjectDetailLockedAmount.GET("Project No.") THEN BEGIN
                                   ProjectDetailLockedAmount.INIT;
                                   ProjectDetailLockedAmount.Project:="Project No.";
                                   ProjectDetailLockedAmount.INSERT(TRUE);
                                 END;
                                 ProjectDetailLockedAmount."Last Entry No" := LastEntryNo;
                                 ProjectDetailLockedAmount.MODIFY(TRUE);

                                 MgtProjdetails.MgtProjDetailUpdate(UserID,"Project No.",'');
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1100583007;2 ;Action    ;
                      CaptionML=[ENU=Project-Position;
                                 SVE=Projektl„ge];
                      RunObject=Page 11012028;
                      RunPageLink=Project No.=FIELD(Project No.);
                      Image=Position;
                      OnAction=VAR
                                 SESetup@1101285000 : Record 11128004;
                                 ProjectDetailLockedAmount@1100583000 : Record 11128112;
                                 JobLedgerEntry@1100583001 : Record 11072005;
                                 LastEntryNo@1100583002 : Integer;
                                 Text001@1100583003 : TextConst 'ENU=Job Ledger Entry is missing;SVE=Projekttransaktioner saknas';
                                 MgtProjdetails@1100583004 : Codeunit 11128091;
                               BEGIN
                                 JobLedgerEntry.SETRANGE("Job No.","Project No.");
                                 IF JobLedgerEntry.FINDLAST THEN
                                   LastEntryNo := JobLedgerEntry."Entry No."
                                 ELSE
                                   ERROR(Text001);

                                 IF NOT ProjectDetailLockedAmount.GET("Project No.") THEN BEGIN
                                   ProjectDetailLockedAmount.INIT;
                                   ProjectDetailLockedAmount.Project:="Project No.";
                                   ProjectDetailLockedAmount.INSERT(TRUE);
                                 END;
                                 ProjectDetailLockedAmount."Last Entry No" := LastEntryNo;
                                 ProjectDetailLockedAmount.MODIFY(TRUE);

                                 MgtProjdetails.MgtProjDetailUpdate(UserID,"Project No.",'');
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1101285016;2 ;Action    ;
                      Name=TargetBudget;
                      CaptionML=[ENU=Target Budget;
                                 SVE=M†lbudget];
                      Image=LedgerBudget;
                      OnAction=VAR
                                 TargetBudget@1101285000 : Record 11128036;
                               BEGIN
                                 //190121 ORANGO.EE
                                 TargetBudget.SETRANGE("Project No.", "Project No.");
                                 PAGE.RUNMODAL(PAGE::"Target Budget List", TargetBudget);
                               END;
                                }
      { 1100285120;2 ;Action    ;
                      CaptionML=[ENU=Advice Orders;
                                 NOR=Bestillingsunderlag;
                                 SVE=Best„llningsunderlag];
                      RunObject=Page 11012102;
                      RunPageLink=Project No.=FIELD(Project No.);
                      Promoted=Yes;
                      Image=OrderReminder;
                      PromotedCategory=Category7 }
      { 1100285309;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100285313;1 ;Action    ;
                      Name=button1;
                      CaptionML=[ENU=Programmable button 1;
                                 NOR=Programmerbar knapp 1;
                                 SVE=Inst„llningsbar knapp 1];
                      Visible=CustButtonsVisible1;
                      OnAction=VAR
                                 RecRef@1100525000 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,CustButtonsPageID,1);
                               END;
                                }
      { 1100285312;1 ;Action    ;
                      Name=button2;
                      CaptionML=[ENU=Programmable button 2;
                                 NOR=Programmerbar knapp 2;
                                 SVE=Inst„llningsbar knapp 2];
                      Visible=CustButtonsVisible2;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,CustButtonsPageID,2);
                               END;
                                }
      { 1100285311;1 ;Action    ;
                      Name=button3;
                      CaptionML=[ENU=Programmable button 3;
                                 NOR=Programmerbar knapp 3;
                                 SVE=Inst„llningsbar knapp 3];
                      Visible=CustButtonsVisible3;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,CustButtonsPageID,3);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1100285000;0;Container;
                ContainerType=ContentArea }

    { 1100285126;1;Group  ;
                CaptionML=[ENU=Project;
                           SVE=Projekt];
                GroupType=Group }

    { 1100285109;2;Group  ;
                Name=ProjectGroup;
                CaptionML=[ENU=Project;
                           NOR=Prosjekt;
                           SVE=Projekt];
                Editable=false;
                GroupType=FixedLayout }

    { 1100285124;3;Group  ;
                GroupType=Group }

    { 1100285107;4;Field  ;
                Name=ProjektNo;
                SourceExpr="Project No." }

    { 1100285131;4;Field  ;
                CaptionML=[ENU=Project Description;
                           SVE=Projektbeskrivning];
                SourceExpr=Job.Description }

    { 1100285114;4;Field  ;
                Name=Prognos kommentar;
                CaptionML=[ENU=Prognosis (comment);
                           NOR=Prognose (kommentar);
                           SVE=Prognos kommentar];
                SourceExpr=ProgCom }

    { 1100285117;4;Field  ;
                CaptionML=[ENU=Contract Amount;
                           SVE=Kontraktsbelopp];
                SourceExpr=FORMAT(ContractAmount) }

    { 1100285135;3;Group  ;
                GroupType=Group }

    { 1100285136;4;Field  ;
                SourceExpr=Job."Bill-to Customer No." }

    { 1100285137;4;Field  ;
                SourceExpr=PrincipalNAme }

    { 1100285125;3;Group  ;
                GroupType=Group }

    { 1100285127;4;Field  ;
                SourceExpr=Job.Address }

    { 1100285129;4;Field  ;
                SourceExpr=Job."Address 2" }

    { 1100285128;4;Field  ;
                SourceExpr=Job."Post Code" + Job.City }

    { 1100285130;4;Field  ;
                SourceExpr=Job."Country/Region Code" }

    { 1100285132;3;Group  ;
                GroupType=Group }

    { 1100285133;4;Field  ;
                CaptionML=[ENU=Project Manager;
                           SVE=Projektledare/Platschef];
                SourceExpr=Text004 +Job."Project Manager" }

    { 1100285134;4;Field  ;
                CaptionML=[ENU=Site Manager;
                           SVE=Arbetschef];
                SourceExpr=Text005 + Job."Site Manager" }

    { 1100285108;4;Field  ;
                SourceExpr=Text006 + Job."Salesperson Code" }

    { 1100285122;1;Group  ;
                CaptionML=[ENU=Filter (Period);
                           NOR=Periodefilter;
                           SVE=Periodfilter (utfall)];
                GroupType=Group }

    { 1100285123;2;Field  ;
                CaptionML=[ENU=Period filter;
                           NOR=Periodefilter;
                           SVE=Periodfilter];
                SourceExpr=Period;
                OnValidate=VAR
                             ProjectDetailsCU@1100285100 : Codeunit 11128091;
                           BEGIN
                             //>> 170425 ITERO.SB RFC-101.2
                             TextManagement.MakeDateFilter(Period);
                             ProjectDetailsCU.GetGLEntrysPeriod(UserID,"Project No.",Period,Postionfilter);
                             //>> 180316 ITERO.SB Buggfix periodfilter
                             ProjectDetailsCU.MgtProjDetailUpdate(UserID,"Project No.",'');
                             //<<
                             CurrPage.UPDATE();
                             //<<
                           END;

                ShowCaption=No }

    { 1100583009;2;Field  ;
                CaptionML=[ENU=Position;
                           SVE=L„ge];
                SourceExpr=Postionfilter;
                TableRelation="Project Element".Element WHERE (Project No.=FIELD(Project No.));
                Visible=UsePostionfilter;
                OnValidate=VAR
                             ProjectDetailsCU@1100583000 : Codeunit 11128091;
                           BEGIN
                             ProjectDetailsCU.MgtProjDetailUpdate(UserID,"Project No.",Postionfilter);
                             CurrPage.UPDATE();
                           END;
                            }

    { 1100285001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1100285002;2;Field  ;
                SourceExpr="Project No.";
                Visible=false;
                Editable=False }

    { 1100285301;2;Field  ;
                SourceExpr="Prognosis Cost Object";
                Visible=FALSE;
                Editable=FALSE }

    { 1100285003;2;Field  ;
                SourceExpr=Caption;
                Editable=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1000000004;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Original Budget";
                Visible=true;
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           BL@1101285000 : Record 11012001;
                           BudgetSubform@1101285001 : Page 11012004;
                           CostObjFilter@1101285002 : Text;
                           ProjDetail2@1101285003 : Record 11128083;
                         BEGIN
                           //>> 171213 ITERO.SB REK012
                           BL.SETRANGE("Project No.","Project No.");
                           BL.SETRANGE(Adjustment,'');
                           BL.SETRANGE("Extension Contract",'');
                           BL.SETRANGE("Cost Object","Budget Line Cost Object");
                           //190607>>
                           IF Postionfilter <> '' THEN
                             BL.SETRANGE(Position,Postionfilter);
                           //<<

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               BL.SETFILTER("Cost Object",CostObjFilter);
                           END;

                           BudgetSubform.EDITABLE(FALSE);
                           BudgetSubform.SETTABLEVIEW(BL);
                           BudgetSubform.RUN;
                           //<<
                         END;
                          }

    { 1101285008;2;Field  ;
                SourceExpr="Budget Comment";
                Editable=FALSE }

    { 1000000005;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Budget adjustment";
                Visible=true;
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           BL@1101285003 : Record 11012001;
                           BudgetSubform@1101285002 : Page 11012004;
                           CostObjFilter@1101285001 : Text;
                           ProjDetail2@1101285000 : Record 11128083;
                         BEGIN
                           //>> 171213 ITERO.SB REK012
                           BL.SETRANGE("Project No.","Project No.");
                           BL.SETFILTER(Adjustment,'<>%1','');
                           BL.SETRANGE("Extension Contract",'');
                           BL.SETRANGE("Cost Object","Budget Line Cost Object");
                           //190607>>
                           IF Postionfilter <> '' THEN
                             BL.SETRANGE(Position,Postionfilter);
                           //<<
                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               BL.SETFILTER("Cost Object",CostObjFilter);
                           END;

                           BudgetSubform.EDITABLE(FALSE);
                           BudgetSubform.SETTABLEVIEW(BL);
                           BudgetSubform.RUN;
                           //<<
                         END;
                          }

    { 1100285104;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Budget Extension Contract";
                Editable=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           BL@1101285003 : Record 11012001;
                           BudgetSubform@1101285002 : Page 11012004;
                           CostObjFilter@1101285001 : Text;
                           ProjDetail2@1101285000 : Record 11128083;
                           ExtensionList@1101285005 : Page 11012014;
                           ExtensionContract@1101285006 : Record 11012004;
                         BEGIN
                           //>> 180220 ITERO.SB REK-019 Drill-down on Extension Contract revenue
                           IF "Budget Contractamount Ext" THEN BEGIN
                             ExtensionContract.FILTERGROUP(25);
                             ExtensionContract.SETRANGE("Project No.","Project No.");
                             ExtensionContract.FILTERGROUP(0);
                             PAGE.RUNMODAL(PAGE::"Extension List",ExtensionContract)
                           END ELSE BEGIN
                           //<<
                             //>> 171213 ITERO.SB REK012
                             BL.SETRANGE("Project No.","Project No.");
                             BL.SETRANGE(Adjustment,'');
                             BL.SETFILTER("Extension Contract",'<>%1','');
                             BL.SETRANGE("Cost Object","Budget Line Cost Object");
                             //190607>>
                             IF Postionfilter <> '' THEN
                               BL.SETRANGE(Position,Postionfilter);
                             //<<
                             IF "Sum Line" THEN BEGIN
                               ProjDetail2.SETRANGE(UserID,UserID);
                               ProjDetail2.SETRANGE("Project No.","Project No.");
                               ProjDetail2.SETRANGE("Code line",FALSE);
                               ProjDetail2.SETRANGE("Sum Line",FALSE);
                               ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                               ProjDetail2.SETRANGE("Sum Amount",TRUE);
                               ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                               ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                               IF ProjDetail2.FIND('-') THEN BEGIN
                                 REPEAT
                                   IF CostObjFilter='' THEN
                                     CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                   ELSE
                                     CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                                 UNTIL ProjDetail2.NEXT = 0;
                               END;
                               IF CostObjFilter<>'' THEN
                                 BL.SETFILTER("Cost Object",CostObjFilter);
                             END;

                             BudgetSubform.EDITABLE(FALSE);
                             BudgetSubform.SETTABLEVIEW(BL);
                             BudgetSubform.RUN;
                             //<<
                           END;
                         END;
                          }

    { 1100285103;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Budget Amount";
                Editable=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           BL@1101285003 : Record 11012001;
                           BudgetSubform@1101285002 : Page 11012004;
                           CostObjFilter@1101285001 : Text;
                           ProjDetail2@1101285000 : Record 11128083;
                         BEGIN
                           //>> 171213 ITERO.SB REK012
                           BL.SETRANGE("Project No.","Project No.");
                           BL.SETRANGE("Cost Object","Budget Line Cost Object");
                           //190607>>
                           IF Postionfilter <> '' THEN
                             BL.SETRANGE(Position,Postionfilter);
                           //<<

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               BL.SETFILTER("Cost Object",CostObjFilter);
                           END;

                           BudgetSubform.EDITABLE(FALSE);
                           BudgetSubform.SETTABLEVIEW(BL);
                           BudgetSubform.RUN;
                           //<<
                         END;
                          }

    { 1100285005;2;Field  ;
                Lookup=Yes;
                CaptionML=[ENU=Accumulated;
                           NOR=Virkelig bokf›rt;
                           SVE=Ack utfall];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="GL Amount";
                Editable=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           JLE@1100285104 : Record 11072005;
                           CostObjFilter@1100285103 : Text;
                           ProjDetail2@1100285102 : Record 11128083;
                           Job@1100285101 : Record 11072003;
                         BEGIN
                           //>> 170425 ITERO.SB RFC-101.2
                           Job.GET("Project No.");
                           //<<180201 ITERO.SB
                           JLE.FILTERGROUP(25);
                           //<<
                           IF Job."Single/Main/Sub Project"=Job."Single/Main/Sub Project"::"Main Project" THEN
                             JLE.SETRANGE("Main Project No.","Project No.")
                           ELSE
                             JLE.SETRANGE("Job No.","Project No.");

                           IF "Cost Component Code"<>'' THEN
                             JLE.SETRANGE("Cost Component","Cost Component Code")
                           ELSE
                             JLE.SETRANGE("Global Dimension 2 Code","GL Entry Cost Object");

                           //190607>>
                           IF Postionfilter <> '' THEN
                             JLE.SETRANGE(Element,Postionfilter);
                           //<<

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               JLE.SETFILTER("Global Dimension 2 Code",CostObjFilter);
                           END;
                           //>>180201 ITERO.SB
                           JLE.FILTERGROUP(0);
                           //<<
                           IF "Cost Type"="Cost Type"::Labor THEN
                             PAGE.RUNMODAL(PAGE::"Project Ledger (Compr) Labour",JLE)
                           ELSE BEGIN
                             PAGE.RUNMODAL(PAGE::"Job Ledger Entries",JLE);
                           END;
                           //<<
                         END;
                          }

    { 1100285121;2;Field  ;
                Lookup=Yes;
                CaptionML=[ENU=Accumulated (period);
                           NOR=Virkelig bokf›rt (i perioden);
                           SVE=Utfall (period)];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="GL Amount Period";
                Editable=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           JLE@1100285103 : Record 11072005;
                           CostObjFilter@1100285102 : Text;
                           ProjDetail2@1100285101 : Record 11128083;
                           Job@1100285100 : Record 11072003;
                         BEGIN
                           //>> 170425 ITERO.SB RFC-101.2
                           Job.GET("Project No.");
                           //<<180201 ITERO.SB
                           JLE.FILTERGROUP(25);
                           //<<
                           IF Job."Single/Main/Sub Project"=Job."Single/Main/Sub Project"::"Main Project" THEN
                             JLE.SETRANGE("Main Project No.","Project No.")
                           ELSE
                             JLE.SETRANGE("Job No.","Project No.");

                           //190607>>
                           IF Postionfilter <> '' THEN
                             JLE.SETRANGE(Element,Postionfilter);
                           //<<

                           IF "Cost Component Code"<>'' THEN
                             JLE.SETRANGE("Cost Component","Cost Component Code")
                           ELSE
                             JLE.SETRANGE("Global Dimension 2 Code","GL Entry Cost Object");

                           IF Period <> '' THEN
                             JLE.SETFILTER("Posting Date",Period);

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               JLE.SETFILTER("Global Dimension 2 Code",CostObjFilter);
                           END;
                           //>>180201 ITERO.SB
                           JLE.FILTERGROUP(0);
                           //<<
                           IF "Cost Type"="Cost Type"::Labor THEN
                             PAGE.RUNMODAL(PAGE::"Project Ledger (Compr) Labour",JLE)
                           ELSE BEGIN
                             PAGE.RUNMODAL(PAGE::"Project Ledger (Compressed)",JLE);
                           END;
                           //<<
                         END;
                          }

    { 1100285106;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="First prognosis";
                Visible=true;
                Editable=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1100285105;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Prognosis (last preclosure)";
                Editable=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1100285308;2;Field  ;
                DecimalPlaces=0:0;
                SourceExpr="Expected Cost";
                Visible=false;
                Editable=FALSE;
                OnLookup=BEGIN
                           IF "Sum Line" THEN BEGIN
                             MESSAGE(Text11120001);
                           END ELSE BEGIN
                             ProjDet.GetAmountAndExpCost(UserID,"Project No.","GL Entry Cost Object");
                             TransCA.SETFILTER(UserID, UserID);
                             TransCA.SETFILTER("Project No.","Project No.");
                             TransCA.SETFILTER("Cost Object","GL Entry Cost Object");
                             //190607 ORANGO.EE BYGG >>
                             IF Postionfilter <> '' THEN
                               TransCA.SETRANGE(Position, Postionfilter);
                             //<<
                             PAGE.RUN(PAGE::"Amount Expected Cost Details", TransCA);
                           END;
                         END;
                          }

    { 1000000006;2;Field  ;
                Name=GL Amount + Expect. Cost;
                CaptionML=SVE=Ack utfall + Ankomstreg;
                DecimalPlaces=0:0;
                SourceExpr="GL Amount"+"Expected Cost";
                Visible=FALSE }

    { 1100285006;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Prognosis Amount";
                Editable=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1000000003;2;Field  ;
                SourceExpr="Prognosis comment";
                Editable=FALSE }

    { 1100285026;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="New Prognosis Amount";
                Visible=SetPrognosis;
                Editable=SumLine;
                Style=Strong;
                StyleExpr=InOV;
                OnValidate=VAR
                             ProjDetail@1100285002 : Record 11128083;
                             ProjDetail2@1100285001 : Record 11128083;
                             PSum@1100285000 : Decimal;
                             SESetup@1100285100 : Record 11128004;
                           BEGIN
                             IF NOT SESetup.GET(SESetup."Line type"::Setup,'PROJDETAIL','CALCQTY') THEN BEGIN
                               SESetup.INIT;
                               SESetup."Line type" := SESetup."Line type"::Setup;
                               SESetup.Code := 'PROJDETAIL';
                               SESetup."Code 2" := 'CALCQTY';
                               SESetup.Description := 'Ber„kna tidkostnad fr†n budget i prognos (bool)';
                               SESetup."Value (bool)" := TRUE;
                               SESetup.INSERT;
                             END;


                             //>> 160701 ITERO.SB RAD-015 Use budgetrate to get prognosis amount, when enter hours in new prognosis field
                             //IF "Sum Quantity" THEN BEGIN
                             IF "Sum Quantity" AND SESetup."Value (bool)" THEN BEGIN
                               ProjDetail.SETRANGE(UserID,UserID);
                               ProjDetail.SETRANGE("Project No.","Project No.");
                               ProjDetail.SETRANGE("Sum Amount",TRUE);
                               ProjDetail.SETRANGE("Prognosis Cost Object","Prognosis Cost Object");
                               IF ProjDetail.FINDFIRST THEN BEGIN
                                 BudgetLine.SETRANGE("Project No.","Project No.");
                                 BudgetLine.SETRANGE("Cost Object","Prognosis Cost Object");
                                 BudgetLine.SETRANGE("Extension Contract",'');
                                 IF BudgetLine.FINDFIRST THEN
                                   ProjDetail.VALIDATE("New Prognosis Amount",BudgetLine."Rate (LCY)"*"New Prognosis Amount");
                                   ProjDetail.MODIFY(TRUE);
                                   CurrPage.UPDATE(TRUE);
                               END;
                             END;
                             //<<
                           END;
                            }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Prognosis, outstanding;
                           NOR=Ny prognose gjennst†ende;
                           SVE=Prognos, †terst†ende];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="New Prognosis Amount"-"GL Amount";
                Visible=SetPrognosis;
                StyleExpr=Mark1 }

    { 1000000001;2;Field  ;
                CaptionML=[ENU=Prognosis vs. budget;
                           NOR="Prognose vs. Budsjett ";
                           SVE=Prognos mot budget];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Budget Amount"-"New Prognosis Amount";
                Visible=SetPrognosis;
                Style=Strong;
                StyleExpr=InOV }

    { 1100285302;2;Field  ;
                CaptionML=[ENU=Comment;
                           NOR=Kommentar til endring i prognose;
                           SVE=Kommentar];
                SourceExpr=Comment;
                Visible=SetPrognosis;
                StyleExpr=TRUE }

    { 1100285118;2;Field  ;
                BlankZero=Yes;
                SourceExpr="Open Amount (Hours)";
                Visible=false }

    { 1100285119;2;Field  ;
                BlankZero=Yes;
                SourceExpr="Open Hours";
                Visible=false }

    { 1101285002;2;Field  ;
                CaptionML=[ENU=Prognosis, outstanding;
                           NOR=Ny prognose gjennst†ende;
                           SVE=Prognos, †terst†ende];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Prognosis Amount"-"GL Amount";
                Visible=SetPrognosis2;
                StyleExpr=Mark2 }

    { 1101285001;2;Field  ;
                CaptionML=[ENU=Prognosis vs. budget;
                           NOR="Prognose vs. Budsjett ";
                           SVE=Prognos mot budget];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Budget Amount"-"Prognosis Amount";
                Visible=SetPrognosis2;
                Style=Strong;
                StyleExpr=InOV }

    { 1101285003;2;Field  ;
                CaptionML=[ENU=Prognosis vs. budget (org.);
                           NOR="Prognose vs. Budsjett ";
                           SVE=Prognos mot budget (org.)];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Original Budget"-"New Prognosis Amount";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1101285010;2;Field  ;
                CaptionML=[ENU=Budget vs amount;
                           SVE=Utfall mot budget];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Budget Amount"-"GL Amount";
                Style=Strong;
                StyleExpr=InOV }

    { 1100583000;2;Field  ;
                CaptionML=[ENU=Budget (incl. adjustment);
                           SVE=Budget (inkl. justering)];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Original Budget"+"Budget adjustment";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1100583002;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="New Prognosis Amount (rem)";
                Visible=ProgBudget2;
                Editable=PrognosisBL;
                Style=Strong;
                StyleExpr=InOV;
                OnValidate=VAR
                             ProjDetail@1100285002 : Record 11128083;
                             ProjDetail2@1100285001 : Record 11128083;
                             PSum@1100285000 : Decimal;
                             SESetup@1100285100 : Record 11128004;
                           BEGIN
                             {
                             IF NOT SESetup.GET(SESetup."Line type"::Setup,'PROJDETAIL','CALCQTY') THEN BEGIN
                               SESetup.INIT;
                               SESetup."Line type" := SESetup."Line type"::Setup;
                               SESetup.Code := 'PROJDETAIL';
                               SESetup."Code 2" := 'CALCQTY';
                               SESetup.Description := 'Ber„kna tidkostnad fr†n budget i prognos (bool)';
                               SESetup."Value (bool)" := TRUE;
                               SESetup.INSERT;
                             END;


                             //>> 160701 ITERO.SB RAD-015 Use budgetrate to get prognosis amount, when enter hours in new prognosis field
                             //IF "Sum Quantity" THEN BEGIN
                             IF "Sum Quantity" AND SESetup."Value (bool)" THEN BEGIN
                               ProjDetail.SETRANGE(UserID,UserID);
                               ProjDetail.SETRANGE("Project No.","Project No.");
                               ProjDetail.SETRANGE("Sum Amount",TRUE);
                               ProjDetail.SETRANGE("Prognosis Cost Object","Prognosis Cost Object");
                               IF ProjDetail.FINDFIRST THEN BEGIN
                                 BudgetLine.SETRANGE("Project No.","Project No.");
                                 BudgetLine.SETRANGE("Cost Object","Prognosis Cost Object");
                                 BudgetLine.SETRANGE("Extension Contract",'');
                                 IF BudgetLine.FINDFIRST THEN
                                   ProjDetail.VALIDATE("New Prognosis Amount",BudgetLine."Rate (LCY)"*"New Prognosis Amount");
                                   ProjDetail.MODIFY(TRUE);
                                   CurrPage.UPDATE(TRUE);
                               END;
                             END;
                             //<<
                             }
                           END;
                            }

    { 1100583001;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Prognosis Amount (rem tot)";
                Visible=false;
                Editable=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1100583005;2;Field  ;
                Lookup=Yes;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Locked GL Amount";
                Visible=false;
                Editable=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           JLE@1100285104 : Record 11072005;
                           CostObjFilter@1100285103 : Text;
                           ProjDetail2@1100285102 : Record 11128083;
                           Job@1100285101 : Record 11072003;
                           ProjectDetailLockedAmount@1100583001 : Record 11128112;
                         BEGIN
                           IF NOT ProjectDetailLockedAmount.GET("Project No.") THEN
                             EXIT;

                           //>> 170425 ITERO.SB RFC-101.2
                           Job.GET("Project No.");
                           //<<180201 ITERO.SB
                           JLE.FILTERGROUP(25);
                           //<<
                           IF Job."Single/Main/Sub Project"=Job."Single/Main/Sub Project"::"Main Project" THEN
                             JLE.SETRANGE("Main Project No.","Project No.")
                           ELSE
                             JLE.SETRANGE("Job No.","Project No.");

                           IF "Cost Component Code"<>'' THEN
                             JLE.SETRANGE("Cost Component","Cost Component Code")
                           ELSE
                             JLE.SETRANGE("Global Dimension 2 Code","GL Entry Cost Object");

                           JLE.SETFILTER("Entry No.",'..%1',ProjectDetailLockedAmount."Last Entry No");

                           //190607>>
                           IF Postionfilter <> '' THEN
                             JLE.SETRANGE(Element,Postionfilter);
                           //<<

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               JLE.SETFILTER("Global Dimension 2 Code",CostObjFilter);
                           END;
                           //>>180201 ITERO.SB
                           JLE.FILTERGROUP(0);
                           //<<
                           IF "Cost Type"="Cost Type"::Labor THEN
                             PAGE.RUNMODAL(PAGE::"Project Ledger (Compr) Labour",JLE)
                           ELSE BEGIN
                             PAGE.RUNMODAL(PAGE::"Project Ledger (Compressed)",JLE);
                           END;
                           //<<
                         END;
                          }

    { 1100583008;2;Field  ;
                CaptionML=[ENU=Prognosis Budget Line;
                           SVE=BK];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Prognosis Budget Line";
                Visible=ProgBudget;
                Style=Strong;
                StyleExpr=InOV;
                OnValidate=VAR
                             ProjectDetailsCU@1100583000 : Codeunit 11128091;
                             BL@1101285000 : Record 11012001;
                             Job@1101285020 : Record 11072003;
                             ProjDetail@1101285017 : Record 11128083;
                             ProjDetail2@1101285016 : Record 11128083;
                             PSum@1101285015 : Decimal;
                             Rev@1101285014 : Decimal;
                             Cost@1101285013 : Decimal;
                             OH1@1101285012 : Decimal;
                             OH2@1101285011 : Decimal;
                             Tim@1101285010 : Decimal;
                             SurchargeRec@1101285009 : Record 11020208;
                             SurchDimValRec@1101285008 : Record 349;
                             lvType@1101285007 : Code[20];
                             DimValRec@1101285006 : Record 349;
                             DimMgt@1101285005 : Codeunit 408;
                             lvOrigin@1101285004 : 'Project,Service';
                             OHSurch@1101285003 : Decimal;
                             vTotSurchAmount@1101285002 : Decimal;
                             BaseAmt@1101285001 : Decimal;
                           BEGIN
                             //Moved code from table
                             VALIDATE("New Prognosis Amount (rem)","Prognosis Budget Line");

                             //>>190506 ORANGO.EE
                             IF ("Cost Type" <> "Cost Type"::Revenue) AND ("Prognosis Budget Line" > 0) THEN BEGIN
                               BL.SETRANGE("Project No.","Project No.");
                               BL.SETRANGE("Cost Object","Budget Line Cost Object");
                               //190607 ORANGO.EE BYGG >>
                               IF Postionfilter <> '' THEN
                                 BL.SETRANGE(Position,Postionfilter);
                               //<<
                               IF BL.FINDSET THEN REPEAT
                                 BL."New prognosis amount" := 0;
                                 BL.MODIFY;
                               UNTIL BL.NEXT = 0;

                               BL.SETRANGE("Project No.","Project No.");
                               BL.SETRANGE("Cost Object","Budget Line Cost Object");
                               IF BL.FINDFIRST THEN
                                BL."New prognosis amount" := "Prognosis Budget Line";
                                BL.MODIFY;
                             END;

                             //ORANGO.EE 190925 BYGG >>
                             IF ("Cost Type" <> "Cost Type"::Revenue) AND ("Prognosis Budget Line" = 0) THEN BEGIN
                               BL.SETRANGE("Project No.","Project No.");
                               BL.SETRANGE("Cost Object","Budget Line Cost Object");

                               IF BL.FINDSET THEN REPEAT
                                 BL."New prognosis amount" := 0;
                                 BL.MODIFY;
                               UNTIL BL.NEXT = 0;

                             END;
                             //<<

                             //200116 ORANGO.EE #27223 >>
                             IF "Cost Type" = "Cost Type"::Revenue THEN BEGIN
                               ProjDetail.SETRANGE("Project No.", Rec."Project No.");
                               ProjDetail.SETRANGE("Budget Line Cost Object", Rec."Budget Line Cost Object");
                               ProjDetail.SETFILTER(UserID, '<>%1', UserID);
                               IF ProjDetail.FIND('-') THEN REPEAT
                                 ProjDetail."Prognosis Budget Line" := Rec."Prognosis Budget Line";
                                 ProjDetail.MODIFY;
                               UNTIL ProjDetail.NEXT = 0;

                             //<<

                               IF ProjDetail.GET('TEMPLATE',Rec."Project No.", Rec."Line No.") THEN BEGIN
                                 ProjDetail."Prognosis Budget Line" := Rec."Prognosis Budget Line";
                                 ProjDetail.MODIFY;
                               END ELSE BEGIN
                                 ProjDetail.UserID := 'TEMPLATE';
                                 ProjDetail."Project No." := Rec."Project No.";
                                 ProjDetail."Line No." := Rec."Line No.";
                                 ProjDetail."Cost Type" := Rec."Cost Type";
                                 ProjDetail."Prognosis Budget Line" := Rec."Prognosis Budget Line";
                                 ProjDetail.INSERT;
                               END;
                               //<<
                             END;

                             ProjDetail.SETRANGE(UserID,UserID);
                             ProjDetail.SETRANGE("Project No.","Project No.");
                             ProjDetail.SETRANGE("Sum Line",TRUE);
                             IF ProjDetail.FIND('-') THEN BEGIN
                               REPEAT
                                 CLEAR(ProjDetail2);
                                 PSum := 0;
                                 ProjDetail2.SETRANGE(UserID,UserID);
                                 ProjDetail2.SETRANGE("Project No.","Project No.");
                                 ProjDetail2.SETRANGE("Code line",FALSE);
                                 ProjDetail2.SETRANGE("Sum Line",FALSE);
                                 ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                                 ProjDetail2.SETRANGE("Sum Amount",TRUE);
                                 IF (Job.GET("Project No.")) AND (Job."Forecast Level"=Job."Forecast Level"::"Cost Object") THEN
                                   ProjDetail2.SETRANGE("Cost Component Code",'');
                                 ProjDetail2.SETFILTER("Line No.",'%1..%2',ProjDetail."Total Line No. From",ProjDetail."Total Line No. To");
                                 IF ProjDetail2.FIND('-') THEN BEGIN
                                   REPEAT
                                     IF (ProjDetail2.UserID=UserID) AND(ProjDetail2."Project No."="Project No.") AND (ProjDetail2."Line No."="Line No.") THEN
                                       PSum := PSum + "Prognosis Budget Line"
                                     ELSE
                                       PSum := PSum + ProjDetail2."Prognosis Budget Line";

                                   UNTIL ProjDetail2.NEXT = 0;
                                   ProjDetail."Prognosis Budget Line":=PSum;
                                   ProjDetail.MODIFY(TRUE);
                                 END;
                               UNTIL ProjDetail.NEXT = 0;
                             END;

                             CLEAR(ProjDetail);

                             IF (Job.GET("Project No.")) AND (Job."Forecast Level"=Job."Forecast Level"::"Cost Object") THEN BEGIN
                             ProjDetail.SETRANGE(UserID,UserID);
                             ProjDetail.SETRANGE("Project No.","Project No.");
                             //ProjDetail.SETRANGE("Sum Line",TRUE);
                             ProjDetail.SETFILTER("Cost Component Code",'<>%1','');
                             IF ProjDetail.FIND('-') THEN BEGIN
                               REPEAT
                                 CLEAR(ProjDetail2);
                                 PSum := 0;
                                 ProjDetail2.SETRANGE(UserID,UserID);
                                 ProjDetail2.SETRANGE("Project No.","Project No.");
                                 ProjDetail2.SETRANGE("Code line",FALSE);
                                 ProjDetail2.SETRANGE("Sum Line",FALSE);
                                 ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                                 ProjDetail2.SETRANGE("Sum Amount",TRUE);
                                 ProjDetail2.CALCFIELDS("Cost Component (Prognosis)");
                                 ProjDetail2.SETRANGE("Cost Component (Prognosis)",ProjDetail."Cost Component Code");
                                 IF ProjDetail2.FIND('-') THEN BEGIN
                                   REPEAT
                                     IF (ProjDetail2.UserID=UserID) AND(ProjDetail2."Project No."="Project No.") AND (ProjDetail2."Line No."="Line No.") THEN
                                       PSum := PSum + "Prognosis Budget Line"
                                     ELSE
                                       PSum := PSum + ProjDetail2."Prognosis Budget Line";

                                   UNTIL ProjDetail2.NEXT = 0;
                                   ProjDetail."Prognosis Budget Line":=PSum;
                                   ProjDetail.MODIFY(TRUE);
                                 END;
                               UNTIL ProjDetail.NEXT = 0;
                             END;
                             END;

                             //Ber„kningar vid ny prognosl„ggning
                             CLEAR(ProjDetail);
                             //H„mta total int„kt
                             ProjDetail.SETRANGE(UserID,UserID);
                             ProjDetail.SETRANGE("Project No.","Project No.");
                             ProjDetail.SETRANGE(Description,'TR');
                             IF ProjDetail.FINDFIRST THEN
                               IF (ProjDetail.UserID=UserID) AND(ProjDetail."Project No."="Project No.") AND (ProjDetail."Line No."="Line No.") THEN
                                 Rev:="New Prognosis Amount"
                               ELSE
                                 Rev:=ProjDetail."Prognosis Budget Line";
                             //H„mta total kostnad
                             ProjDetail.SETRANGE(Description,'TC');
                             IF ProjDetail.FINDFIRST THEN
                               Cost:=ProjDetail."Prognosis Budget Line";
                             //H„mta totalt antal timmar
                             ProjDetail.SETRANGE(Description,'TH');
                             IF ProjDetail.FINDFIRST THEN
                               Tim:=ProjDetail."Prognosis Budget Line";
                             //H„mta belopp Overheadniv† 1
                             ProjDetail.SETRANGE(Description,'OH1');
                             IF ProjDetail.FINDFIRST THEN
                               OH1:=ProjDetail."Prognosis Budget Line";
                             //H„mta belopp Overheadniv† 2
                             ProjDetail.SETRANGE(Description,'OH2');
                             IF ProjDetail.FINDFIRST THEN
                               OH2:=ProjDetail."Prognosis Budget Line";

                             //  IF (ProjDetail.UserID=UserID) AND(ProjDetail."Project No."="Project No.") AND (ProjDetail."Line No."="Line No.") THEN
                             //    Tim := "New "Prognosis Budget Line" Amount"
                             //  ELSE
                             //    Tim:=ProjDetail."New "Prognosis Budget Line" Amount";
                             //END;
                             //Ber„kna TB
                             ProjDetail.SETRANGE(Description,'GM');
                             IF ProjDetail.FINDFIRST THEN BEGIN
                               ProjDetail."Prognosis Budget Line":=Rev-Cost;
                               ProjDetail.MODIFY(TRUE);
                             END;
                             //Ber„kna TG
                             ProjDetail.SETRANGE(Description,'GM%');
                             IF ProjDetail.FINDFIRST THEN BEGIN
                               IF Rev<>0 THEN
                                 ProjDetail."Prognosis Budget Line":=((Rev-Cost)/Rev)*100
                               ELSE
                                 ProjDetail."Prognosis Budget Line":=0;
                               ProjDetail.MODIFY(TRUE);
                             END;
                             //Ber„kna TB/H
                             ProjDetail.SETRANGE(Description,'GM/H');
                             IF ProjDetail.FINDFIRST THEN BEGIN
                               IF Tim <> 0 THEN
                                 ProjDetail."Prognosis Budget Line":=((Rev-Cost)/Tim)
                               ELSE
                                 ProjDetail."Prognosis Budget Line":=0;
                               ProjDetail.MODIFY(TRUE);
                             END;
                             //Ber„kna kostnad f”r Overheadniv† 1
                             ProjDetail.SETRANGE(Description,'OH1Cost');
                             IF ProjDetail.FINDFIRST THEN BEGIN
                               ProjDetail."Prognosis Budget Line":=Tim*OH1;
                               ProjDetail.MODIFY(TRUE);
                             END;
                             //Ber„kna kostnad f”r Overheadniv† 1
                             ProjDetail.SETRANGE(Description,'OH2Cost');
                             IF ProjDetail.FINDFIRST THEN BEGIN
                               ProjDetail."Prognosis Budget Line":=Tim*OH2;
                               ProjDetail.MODIFY(TRUE);
                             END;
                             //Ber„kna TB efter Overhead
                             ProjDetail.SETRANGE(Description,'GMTot');
                             IF ProjDetail.FINDFIRST THEN BEGIN
                               ProjDetail."Prognosis Budget Line":=(Rev-Cost)-((Tim*OH1)+(Tim*OH2));
                               ProjDetail.MODIFY(TRUE);
                             END;
                             //Ber„kna TG efter Overhead
                             ProjDetail.SETRANGE(Description,'GM%Tot');
                             IF ProjDetail.FINDFIRST THEN BEGIN
                               IF Rev<>0 THEN
                                 ProjDetail."Prognosis Budget Line":=(((Rev-Cost)-((Tim*OH1)+(Tim*OH2)))/Rev)*100
                               ELSE
                                 ProjDetail."Prognosis Budget Line":=0;
                               ProjDetail.MODIFY(TRUE);
                             END;


                             //<<
                           END;

                OnLookup=VAR
                           BL@1101285003 : Record 11012001;
                           BudgetSubform@1101285002 : Page 11128085;
                           CostObjFilter@1101285001 : Text;
                           ProjDetail2@1101285000 : Record 11128083;
                           ProjectDetailsCU@1100583001 : Codeunit 11128091;
                         BEGIN

                           IF NOT PrognosisBL2 THEN BEGIN
                             BL.SETRANGE("Project No.","Project No.");
                             BL.SETRANGE("Cost Object","Budget Line Cost Object");
                             IF Postionfilter <> '' THEN
                             BL.SETRANGE(Position, Postionfilter);

                             IF "Sum Line" THEN BEGIN
                               ProjDetail2.SETRANGE(UserID,UserID);
                               ProjDetail2.SETRANGE("Project No.","Project No.");
                               ProjDetail2.SETRANGE("Code line",FALSE);
                               ProjDetail2.SETRANGE("Sum Line",FALSE);
                               ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                               ProjDetail2.SETRANGE("Sum Amount",TRUE);
                               ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                               ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                               IF ProjDetail2.FIND('-') THEN BEGIN
                                 REPEAT
                                   IF CostObjFilter='' THEN
                                     CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                   ELSE
                                     CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                                 UNTIL ProjDetail2.NEXT = 0;
                               END;
                               IF CostObjFilter<>'' THEN
                                 BL.SETFILTER("Cost Object",CostObjFilter);
                             END;

                             BudgetSubform.EDITABLE(TRUE);
                             BudgetSubform.SETTABLEVIEW(BL);

                           //190607 >>
                             BudgetSubform.SetPositionFilter(Postionfilter);
                             //<<
                             BudgetSubform.RUN;
                             //<<
                           END;
                         END;
                          }

    { 1101285012;2;Field  ;
                CaptionML=[ENU=Budget (incl. Extension);
                           SVE=Aktuell budget (Budget (inkl. ŽTA))];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Original Budget" + "Budget Extension Contract";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1101285013;2;Field  ;
                CaptionML=[ENU=Budget (incl Extension) vs Amount;
                           SVE=Budget (inkl. ŽTA) mot utfall];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr=("Original Budget" + "Budget Extension Contract") - "GL Amount";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1100583010;2;Field  ;
                CaptionML=[ENU=BK + Locked GL amount;
                           SVE=Prognos (BK + L†st utfall)];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Prognosis Budget Line" + "Locked GL Amount";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1100583011;2;Field  ;
                CaptionML=[ENU=Diff. prognosis amount;
                           SVE=Diff. senaste prognos];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr=("Prognosis Amount") - ("Prognosis Budget Line" + "Locked GL Amount");
                Visible=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1100583012;2;Field  ;
                CaptionML=[ENU=Diff. budget incl. Extension;
                           SVE=Diff. mot budget inkl. ŽTA];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr=("Original Budget" + "Budget Extension Contract") - ("Prognosis Budget Line" + "Locked GL Amount");
                Visible=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1101285014;2;Field  ;
                CaptionML=[ENU=Total Budget;
                           SVE=Total budget];
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Original Budget" + "Budget adjustment" + "Budget Extension Contract";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV }

    { 1101285018;2;Field  ;
                BlankNumbers=BlankZero;
                SourceExpr="Target Budget";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           TargetBudget@1101285000 : Record 11128036;
                           TargetBudgetList@1101285001 : Page 11128036;
                           ProjDetail2@1101285002 : Record 11128083;
                           CostObjFilter@1101285003 : Text;
                         BEGIN
                           //200120 ORANGO.EE BYGG #27258
                           TargetBudget.SETRANGE("Project No.", "Project No.");
                           TargetBudget.SETRANGE("Cost Object", "GL Entry Cost Object");

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               TargetBudget.SETFILTER("Cost Object",CostObjFilter);
                           END;

                           TargetBudgetList.EDITABLE(FALSE);
                           TargetBudgetList.SETTABLEVIEW(TargetBudget);
                           TargetBudgetList.RUN;
                           //<<
                         END;
                          }

    { 1100285138;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Open Purchase Orders";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           PurchaseLine@1100285100 : Record 39;
                           ProjDetail2@1100285101 : Record 11128083;
                           CostObjFilter@1100285102 : Text;
                           PurchaseOrderSubform@1100285103 : Page 54;
                         BEGIN
                           PurchaseLine.SETRANGE("Job No.", "Project No.");
                           PurchaseLine.SETRANGE("Shortcut Dimension 2 Code", "GL Entry Cost Object");

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               PurchaseLine.SETFILTER("Shortcut Dimension 2 Code",CostObjFilter);
                           END;

                           PurchaseLine.SETFILTER("Completely Received", '<>%1', TRUE);

                           PurchaseOrderSubform.EDITABLE(FALSE);
                           PurchaseOrderSubform.SETTABLEVIEW(PurchaseLine);
                           PurchaseOrderSubform.RUN;
                           //<<
                         END;
                          }

    { 1100285139;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Recieved Not Invoiced";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           PurchaseLine@1100285103 : Record 39;
                           ProjDetail2@1100285102 : Record 11128083;
                           CostObjFilter@1100285101 : Text;
                           PurchaseOrderSubform@1100285100 : Page 54;
                         BEGIN
                           PurchaseLine.SETRANGE("Job No.", "Project No.");
                           PurchaseLine.SETRANGE("Shortcut Dimension 2 Code", "GL Entry Cost Object");

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               PurchaseLine.SETFILTER("Shortcut Dimension 2 Code",CostObjFilter);
                           END;

                           PurchaseLine.SETFILTER("Amnt. Received", '<>%1', 0);
                           PurchaseLine.SETFILTER("Amnt. Invoiced", '=%1', 0);

                           PurchaseOrderSubform.EDITABLE(FALSE);
                           PurchaseOrderSubform.SETTABLEVIEW(PurchaseLine);
                           PurchaseOrderSubform.RUN;
                           //<<
                         END;
                          }

    { 1100285140;2;Field  ;
                DecimalPlaces=0:0;
                BlankNumbers=BlankZero;
                SourceExpr="Extension GL Amount";
                Visible=false;
                Style=Strong;
                StyleExpr=InOV;
                OnLookup=VAR
                           JLE@1100285100 : Record 11072005;
                           ProjDetail2@1100285101 : Record 11128083;
                           CostObjFilter@1100285102 : Text;
                         BEGIN
                           //>> 170425 ITERO.SB RFC-101.2
                           Job.GET("Project No.");
                           //<<180201 ITERO.SB
                           JLE.FILTERGROUP(25);
                           //<<
                           IF Job."Single/Main/Sub Project"=Job."Single/Main/Sub Project"::"Main Project" THEN
                             JLE.SETRANGE("Main Project No.","Project No.")
                           ELSE
                             JLE.SETRANGE("Job No.","Project No.");

                           IF "Cost Component Code"<>'' THEN
                             JLE.SETRANGE("Cost Component","Cost Component Code")
                           ELSE
                             JLE.SETRANGE("Global Dimension 2 Code","GL Entry Cost Object");

                           //190607>>
                           IF Postionfilter <> '' THEN
                             JLE.SETRANGE(Element,Postionfilter);
                           //<<

                           JLE.SETFILTER("Extension Contract", '<>%1', '');

                           IF "Sum Line" THEN BEGIN
                             ProjDetail2.SETRANGE(UserID,UserID);
                             ProjDetail2.SETRANGE("Project No.","Project No.");
                             ProjDetail2.SETRANGE("Code line",FALSE);
                             ProjDetail2.SETRANGE("Sum Line",FALSE);
                             ProjDetail2.SETRANGE("Sum Quantity",FALSE);
                             ProjDetail2.SETRANGE("Sum Amount",TRUE);
                             ProjDetail2.SETFILTER("GL Entry Cost Object",'<>%1','');
                             ProjDetail2.SETFILTER("Line No.",'%1..%2',"Total Line No. From","Total Line No. To");
                             IF ProjDetail2.FIND('-') THEN BEGIN
                               REPEAT
                                 IF CostObjFilter='' THEN
                                   CostObjFilter:=ProjDetail2."GL Entry Cost Object"
                                 ELSE
                                   CostObjFilter := CostObjFilter+'|'+ProjDetail2."GL Entry Cost Object";
                               UNTIL ProjDetail2.NEXT = 0;
                             END;
                             IF CostObjFilter<>'' THEN
                               JLE.SETFILTER("Global Dimension 2 Code",CostObjFilter);
                           END;
                           //>>180201 ITERO.SB
                           JLE.FILTERGROUP(0);
                           //<<
                           IF "Cost Type"="Cost Type"::Labor THEN
                             PAGE.RUNMODAL(PAGE::"Project Ledger (Compr) Labour",JLE)
                           ELSE BEGIN
                             PAGE.RUNMODAL(PAGE::"Job Ledger Entries",JLE);
                           END;
                           //<<
                         END;
                          }

  }
  CODE
  {
    VAR
      Text11012007@1100285000 : TextConst 'ENU=Add Settlement Sheet ?;NOR=Legge til oppgj›rsskjema?;SVE=L„gga till avr„kningsark?';
      CreatePrognosis@1100285001 : Report 11128081;
      Hide@1100285002 : Boolean;
      SumLine@1100285300 : Boolean;
      Overview@1000000000 : Boolean;
      BudgetLine@1100285301 : Record 11012001;
      Job@1100285100 : Record 11072003;
      ProgCom@1100285101 : Text[50];
      Prognosis@1100285102 : Record 11012034;
      InOV@1100285103 : Boolean;
      Compress@1100285104 : Boolean;
      Text0001@1100285105 : TextConst 'ENU="Contract Amount: ";NOR="Kontraktsbel›p: ";SVE="Kontraktsbelopp: "';
      ContractAmount@1100285106 : Decimal;
      Period@1100285107 : Text[20];
      TextManagement@1100285108 : Codeunit 41;
      Ack_Exp@1000000001 : Decimal;
      CustButtonsPageID@1101285004 : Integer;
      CustButtonsVisible1@1100285305 : Boolean INDATASET;
      CustButtonsVisible2@1100285304 : Boolean INDATASET;
      CustButtonsVisible3@1100285303 : Boolean INDATASET;
      CustomSelectedbuttons@1100285302 : Record 11128006;
      SetPrognosis@1101285000 : Boolean;
      SetPrognosis2@1101285001 : Boolean;
      Mark1@1101285002 : Text;
      Mark2@1101285003 : Text;
      Text11120001@1000000002 : TextConst 'SVE=Summeringsrader kan ej visas!';
      ProjDet@1000000004 : Codeunit 11128091;
      TransCA@1000000003 : Record 11128085;
      SetFillSundry@1101285005 : Boolean;
      ProgBudget@1100583000 : Boolean;
      ProgBudget2@1100583001 : Boolean;
      PrognosisBL@1100583002 : Boolean;
      PrognosisBL2@1100583003 : Boolean;
      Postionfilter@1100583004 : Code[10];
      UsePostionfilter@1100583005 : Boolean;
      Text002@1101285006 : TextConst 'ENU=Are you sure you want to lock GL amount?;SVE=Žr du s„ker att du vill l†sa utfall?';
      Text003@1100583006 : TextConst 'ENU=Prognosis already exists, please enter manually.;SVE=Prognos finns redan, du kan inte skapa fr†n budget igen.';
      Text004@1100285109 : TextConst 'ENU="Project Manager: ";SVE="Projektledare: "';
      Text005@1100285110 : TextConst 'ENU="Site Manager: ";SVE="Arbetschef: "';
      Text006@1100285111 : TextConst 'ENU="Sales Person: ";SVE="S„ljare: "';
      PrincipalNAme@1100285112 : Text;

    BEGIN
    {
      160216 ITERO.SB Do not show decimals in project details
      160701 ITERO.SB RAD-015 Use budgetrate to get prognosis amount, when enter hours in new prognosis field
      160720 ITERO.SB RAD-019 Added action Print Site Manager Report
      060902 ITERO.SB RAD-030 + RAD-031 Added action for compressed transactions
      160921 ITERO.SB RAD-029, RAD-030, RAD-030
          161206 ITERO.DL RFC157, 2 new columns
      170111 ITERO.PR New field "GL Amount + Expect. Cost"
      170425 ITERO.SB RFC-101.2 Added field "GL Amount Period"
      170512 ITERO.DL RFC188 caption change ROT -> ROT/RUT
      170905 ITERO.SB Added filtergroup
      171207 ITERO.SB Added fields Prognosis vs. budget & Prognosis, outstanding
      171213 ITERO.SB REK09 Use setprognosis1 and setprognosis2
      171213 ITERO.SB REK012 Lookup page on budget
      171228 ITERO.SB Question when closing page (not saved prognosis)
      180130 ITERO.SB REK-049 Highlight fields when negative amount
      180201 ITERO.SB Added filtergroup
      180220 ITERO.SB REK-019 Drill-down on Extension Contract revenue
      180221 ITERO.SB REK-005 Added action to print report selection Assembly project worksheet
      180308 ITERO.SB Buggfix (REK)
      180316 ITERO.SB Buggfix periodfilter
      180413 ORANGO.PR New Field "Budget Comment"
      180427 ORANGO.WG Work order in ribbon
      180507 ORANGO.DL added period to report (by setfilter)
      180816 ORANGO.DL removed shortcut 'Ctrl+C' from action 'Compress Cost Objects'
      180920 ORANGO.DL Support #18876, change display from "Total<>0" to "TotalNotZero"
      181115 ORANGO.WG Added SetFillSundry
      181121 ORANGO.EE Code instead of "RunObject" for action "Budget"
      181211 ORANGO.EE Added Budget vs Amount - "Budget Amount"-"GL Amount"
      190318 ORANGO.SB Feature #22818/BYGG001_3 Added Budget (incl. adjustment)
      190319 ORANGO.SB Feature #22823/BYGG001_8 Add functionality for prognosis remaining amount
      190320 ORANGO.SB Feature #22826 BYGG003 Fill revenue prognosis from project installment (action)
      190321 ORANGO.SB Feature #22819/BYGG001_4 Locked GL Amount
      190404 ORANGO.SB Feature #22822 BYGG001_7 Added functionaly Prognosis Budget Line
      190424 ORANGO.EE Added field "Budget incl. Extention"
      190527 ORANGO.EE Changed calculation to "Locked GL Amount"
      190830 ORANGO.EE Small change in code
      190322 ORANGO.EE Better dialog windows when archiving prognosis
      190508 ORANGO.SB Feature #24227
      190603 ORANGO.EE REK "Other Description" Feature #24023
      190603 ORANGO.EE REK "Locked GL Amount" Feature #23919 (Field and Action)
      190925 ORANGO.EE BYGG
      191017 ORANGO.EE Fix periodfilter
      191119 ORANGO.EE Periodfilter
      191209 ORANGO.DL BYGG #25624 all PDFs to one PDF, new button
      200406 ORANGO.EE Added button <Page Advice Orders by Project>
      200416 ORANGO.EE New fields in header + new columns: "Open Purchase Orders", "Extension GL Amount" & "Recieved Not Invoiced"
    }
    END.
  }
}

