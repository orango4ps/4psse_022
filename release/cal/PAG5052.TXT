OBJECT Page 5052 Contact List
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00,4PSSE;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Contacts;
               NOR=Kontakter;
               SVE=Kontakter];
    ApplicationArea=#Basic,#Suite,#Service;
    SaveValues=Yes;
    SourceTable=Table5050;
    SourceTableView=SORTING(Company Name,Company No.,Type,Name);
    DataCaptionFields=Company No.;
    PageType=List;
    UsageCategory=Lists;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Contact;
                                NOR=Ny,Prosess,Rapport,Kontakt;
                                SVE=Ny,Process,Rapport,Kontakt];
    OnInit=BEGIN
             ActionVisible := ClientTypeManagement.GetCurrentClientType = CLIENTTYPE::Windows;
             CopyButtonEnable := TRUE; //**4PS.n
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
                 FPSLicenseManagement@1100527400 : Codeunit 11229289;
               BEGIN
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;

                 //**4PS.sn
                 IF ContPersOfOneCompanyAreShown THEN
                   SETCURRENTKEY("Company No.");

                 IF (GETFILTER("Salesperson Code") <> '') AND
                     FPSLicenseManagement.LicenseAndReadPermissionForTable(RelContSalespersonRec)
                 THEN BEGIN
                   RelContSalespersonRec.SETCURRENTKEY("Salesperson Code");
                   COPYFILTER("Salesperson Code", RelContSalespersonRec."Salesperson Code");
                   IF RelContSalespersonRec.FINDSET(FALSE, FALSE) THEN BEGIN

                     IF FINDSET(FALSE, FALSE) THEN
                       REPEAT
                         MARK(TRUE);
                       UNTIL NEXT = 0;

                     REPEAT
                       "No." := RelContSalespersonRec."Contact No.";
                       MARK(TRUE);
                     UNTIL RelContSalespersonRec.NEXT = 0;

                     MARKEDONLY(TRUE);
                     SETCURRENTKEY("No.");
                     RemoveFilterSalesPerson := TRUE;

                   END;
                   SETRANGE("Salesperson Code");
                 END;
                 //Call 14774
                 IF MARKEDONLY THEN
                   SETCURRENTKEY("No.");

                 CopyButtonEnable := gCopyQuote;
                 //DP00751
                 IF GETFILTER(Blocked) = '' THEN //C022587
                   SetBlockedFilter;

                 //C021093
                 IF (NOT ContPersOfOneCompanyAreShown) AND (GETFILTER("Salesperson Code") = '') AND (GETFILTER("Person No.") = '''''') THEN
                   SETCURRENTKEY(Name);
                 //**4PS.en
               END;

    OnAfterGetRecord=BEGIN
                       StyleIsStrong := Type = Type::Company;

                       //**4PS.sn
                       IF RemoveFilterSalesPerson THEN
                         SETRANGE("Salesperson Code");

                       HoldStructRec.RESET;
                       HoldStructRec.SETRANGE(Contact,"No.");
                       IF HoldStructRec.FINDFIRST THEN
                         HoldStructBool := TRUE
                       ELSE
                         HoldStructBool := FALSE;

                       HoldStructRec2.RESET;
                       HoldStructRec2.SETRANGE("Related Contact","No.");
                       IF HoldStructRec2.FINDFIRST THEN
                         HoldstructAvailBool := TRUE
                       ELSE
                         HoldstructAvailBool := FALSE;
                       IF HoldstructAvailBool THEN HoldStructBool := TRUE;
                       //**4PS.en
                     END;

    OnAfterGetCurrRecord=BEGIN
                           EnableFields;
                           IF CRMIntegrationEnabled THEN
                             CRMIsCoupledToRecord := CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=C&ontact;
                                 NOR=&Kontakt;
                                 SVE=K&ontakt];
                      Image=ContactPerson }
      { 1100525005;2 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 SVE=Kort];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 OpenCardPage(CompanyNoForNewRec,PersonNoForNewRec);
                               END;
                                }
      { 1100485010;2 ;Action    ;
                      CaptionML=[ENU=Holding Structures;
                                 SVE=Koncernstrukturer];
                      RunObject=Page 11020215;
                      RunPageLink=Contact=FIELD(No.);
                      Image=Intercompany }
      { 34      ;2   ;ActionGroup;
                      CaptionML=[ENU=Comp&any;
                                 NOR=Selsk&ap;
                                 SVE=&Fîretag];
                      Enabled=CompanyGroupEnabled;
                      Image=Company }
      { 35      ;3   ;Action    ;
                      CaptionML=[ENU=Contact Business Relations;
                                 NOR=Forretningsforbindelser;
                                 SVE=AffÑrsrelationer];
                      ToolTipML=[ENU=View or edit the contact's business relations, such as customers, vendors, banks, lawyers, consultants, competitors, and so on.;
                                 NOR=Vis eller rediger kontaktens forretningsforbindelser, for eksempel kunder, leverandõrer, banker, advokater, konsulenter, konkurrenter og sÜ videre.;
                                 SVE=Visa eller redigera kontaktens affÑrsrelationer, t.ex. kunder, leverantîrer, banker, jurister, konsulter och konkurrenter.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5061;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=BusinessRelation }
      { 36      ;3   ;Action    ;
                      CaptionML=[ENU=Industry Groups;
                                 NOR=Bransjegrupper;
                                 SVE=Branschgrupper];
                      ToolTipML=[ENU=View or edit the industry groups, such as Retail or Automobile, that the contact belongs to.;
                                 NOR=Vis eller rediger bransjegruppene, for eksempel Detaljhandel eller Bilbransje, som kontakten tilhõrer.;
                                 SVE=Visa eller redigera branschgrupperna, till exempel Detaljhandel eller Fordon, som kontakten tillhîr.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5067;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=IndustryGroups }
      { 37      ;3   ;Action    ;
                      CaptionML=[ENU=Web Sources;
                                 NOR=Webkilder;
                                 SVE=Webbadresser];
                      ToolTipML=[ENU=View a list of the web sites with information about the contacts.;
                                 NOR=Vis en liste med nettsteder som har informasjon om kontaktene.;
                                 SVE=Visa en lista med webbplatser med information om kontakterna.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5070;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=Web }
      { 38      ;2   ;ActionGroup;
                      CaptionML=[ENU=P&erson;
                                 NOR=P&erson;
                                 SVE=P&erson];
                      Enabled=PersonGroupEnabled;
                      Image=User }
      { 39      ;3   ;Action    ;
                      CaptionML=[ENU=Job Responsibilities;
                                 NOR=AnsvarsomrÜder;
                                 SVE=Arbetsansvar];
                      ToolTipML=[ENU=View or edit the contact's job responsibilities.;
                                 NOR=Vis eller rediger kontaktens ansvarsomrÜder.;
                                 SVE=Visa eller redigera kontaktens arbetsansvar.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Job;
                      OnAction=VAR
                                 ContJobResp@1001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 ContJobResp."Contact No." := "No.";//Make sure that Contact No. is always filled.//**4PS.n
                                 PAGE.RUNMODAL(PAGE::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 1100285000;3 ;Action    ;
                      CaptionML=[ENU=Person Card;
                                 SVE=Personkort];
                      RunObject=Page 11125050;
                      RunPageLink=No.=FIELD(Person No.);
                      Promoted=No;
                      Image=PersonInCharge }
      { 1100529900;2 ;ActionGroup;
                      CaptionML=[ENU=Relation Tables;
                                 SVE=Relationstabeller];
                      Image=HRSetup }
      { 1210190010;3 ;Action    ;
                      CaptionML=[ENU=Salespersons;
                                 SVE=SÑljare];
                      RunObject=Page 11012769;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=SalesPerson }
      { 41      ;3   ;Action    ;
                      CaptionML=[ENU=Pro&files;
                                 NOR=Pro&filer;
                                 SVE=&Profiler];
                      ToolTipML=[ENU=Open the Profile Questionnaires window.;
                                 NOR=èpne vinduet Profilspõrreskjema.;
                                 SVE=ôppna fînstret Profil frÜgeformulÑr.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Answers;
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 43      ;3   ;Action    ;
                      CaptionML=[ENU=&Picture;
                                 NOR=&Bilde;
                                 SVE=&Bild];
                      ToolTipML=[ENU=View or add a picture of the contact person or, for example, the company's logo.;
                                 NOR=Vis eller legg til et bilde av kontaktpersonen eller for eksempel selskapslogoen.;
                                 SVE=Visa eller lÑgg till en bild fîr kontaktpersonen eller t.ex. fîretagets logotyp.];
                      ApplicationArea=#Suite,#RelationshipMgmt;
                      RunObject=Page 5104;
                      RunPageLink=No.=FIELD(No.);
                      Visible=ActionVisible;
                      Image=Picture }
      { 44      ;3   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 5072;
                      RunPageLink=Table Name=CONST(Contact),
                                  No.=FIELD(No.),
                                  Sub No.=CONST(0);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category4 }
      { 45      ;2   ;ActionGroup;
                      CaptionML=[ENU=Alternati&ve Address;
                                 NOR=Alternati&v adresse;
                                 SVE=Alternati&v adress];
                      Image=Addresses }
      { 46      ;3   ;Action    ;
                      CaptionML=[ENU=List;
                                 NOR=Kort;
                                 SVE=Kort];
                      ToolTipML=[ENU=View or change detailed information about the contact.;
                                 NOR=Vis eller endre detaljert informasjon om kontakten.;
                                 SVE=Visa eller Ñndra detaljerad information om kontakten.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5057;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 47      ;3   ;Action    ;
                      CaptionML=[ENU=Date Ranges;
                                 NOR=Datointervall;
                                 SVE=Datumintervall];
                      ToolTipML=[ENU=Specify date ranges that apply to the contact's alternate address.;
                                 NOR=Angi datointervaller som gjelder for kontaktens alternative adresse.;
                                 SVE=Ange datumintervallen som gÑller fîr kontaktens alternativa adress.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5059;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DateRange }
      { 25      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics 365 for Sales;
                                 NOR=" Dynamics 365 for Sales";
                                 SVE=Dynamics 365 for Sales];
                      Visible=CRMIntegrationEnabled }
      { 23      ;2   ;Action    ;
                      Name=CRMGotoContact;
                      CaptionML=[ENU=Contact;
                                 NOR=Kontakt;
                                 SVE=Kontakt];
                      ToolTipML=[ENU=Open the coupled Dynamics 365 for Sales contact.;
                                 NOR=èpne den koblede kontakten for Dynamics 365 for Sales.;
                                 SVE=ôppna den kopplade Dynamics 365 for Sales-kontakten.];
                      ApplicationArea=#Suite;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=CoupledContactPerson;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Synchronize;
                                 NOR=Synkroniser;
                                 SVE=Synkronisera];
                      ToolTipML=[ENU=Send or get updated data to or from Dynamics 365 for Sales.;
                                 NOR=Send eller motta oppdaterte data til eller fra Dynamics 365 for Sales.;
                                 SVE=Skicka eller hÑmta uppdaterade data till eller frÜn Dynamics 365 for Sales.];
                      ApplicationArea=#Suite;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=Refresh;
                      OnAction=VAR
                                 Contact@1000 : Record 5050;
                                 CRMIntegrationManagement@1001 : Codeunit 5330;
                                 ContactRecordRef@1002 : RecordRef;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Contact);
                                 Contact.NEXT;

                                 IF Contact.COUNT = 1 THEN
                                   CRMIntegrationManagement.UpdateOneNow(Contact.RECORDID)
                                 ELSE BEGIN
                                   ContactRecordRef.GETTABLE(Contact);
                                   CRMIntegrationManagement.UpdateMultipleNow(ContactRecordRef);
                                 END
                               END;
                                }
      { 26      ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling;
                                 NOR=Kobling;
                                 SVE=Koppling];
                      ToolTipML=[ENU=Create, change, or delete a coupling between the Business Central record and a Dynamics 365 for Sales record.;
                                 NOR=Opprett, endre eller slett en kobling mellom Business Central-posten og en Dynamics 365 for Sales-post.;
                                 SVE=Skapa, Ñndra eller ta bort en koppling mellan Business Central-posten och en Dynamics 365 for Sales-post.];
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=LinkAccount }
      { 21      ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Set Up Coupling;
                                 NOR=Konfigurer kobling;
                                 SVE=KopplingsinstÑllning];
                      ToolTipML=[ENU=Create or modify the coupling to a Dynamics 365 for Sales contact.;
                                 NOR=Opprett eller endre koblingen til en kontakt for Dynamics 365 for Sales.;
                                 SVE=Skapa eller Ñndra kopplingen till en Dynamics 365 for Sales-kontakt.];
                      ApplicationArea=#Suite;
                      Image=LinkAccount;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.DefineCoupling(RECORDID);
                               END;
                                }
      { 19      ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Delete Coupling;
                                 NOR=Slett kobling;
                                 SVE=Ta bort koppling];
                      ToolTipML=[ENU=Delete the coupling to a Dynamics 365 for Sales contact.;
                                 NOR=Slett koblingen til en kontakt for Dynamics 365 for Sales.;
                                 SVE=Ta bort kopplingen till en Dynamics 365 for Sales-kontakt.];
                      ApplicationArea=#Suite;
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit 5331;
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 17      ;2   ;ActionGroup;
                      Name=Create;
                      CaptionML=[ENU=Create;
                                 NOR=Opprett;
                                 SVE=Skapa];
                      Image=NewCustomer }
      { 15      ;3   ;Action    ;
                      Name=CreateInCRM;
                      CaptionML=[ENU=Create Contact in Dynamics 365 for Sales;
                                 NOR=Opprett kontakt i Dynamics 365 for Sales;
                                 SVE=Skapa kontakt i Dynamics 365 for Sales];
                      ToolTipML=[ENU=Create a contact in Dynamics 365 for Sales that is linked to a contact in your company.;
                                 NOR=Opprett en kontakt i Dynamics 365 for Sales som er knyttet til en kontakt i firmaet.;
                                 SVE=Skapa en kontakt i Dynamics 365 for Sales som Ñr kopplad till en kontakt i ditt fîretag.];
                      ApplicationArea=#Suite;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=NewCustomer;
                      OnAction=VAR
                                 Contact@1001 : Record 5050;
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Contact);
                                 CRMIntegrationManagement.CreateNewRecordsInCRM(Contact);
                               END;
                                }
      { 13      ;3   ;Action    ;
                      Name=CreateFromCRM;
                      CaptionML=[ENU=Create Contact in Business Central;
                                 NOR=Opprett kontakt i Business Central;
                                 SVE=Skapa kontakt i Business Central];
                      ToolTipML=[ENU=Create a contact here in your company that is linked to the Dynamics 365 for Sales contact.;
                                 NOR=Opprett en kontakt her i firmaet som er knyttet til Dynamics 365 for Sales-kontakten.;
                                 SVE=Skapa en kontakt hÑr i ditt fîretag som Ñr kopplad till Dynamics 365 for Sales-kontakten.];
                      ApplicationArea=#Suite;
                      Image=NewCustomer;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.CreateNewContactFromCRM;
                               END;
                                }
      { 52      ;2   ;Action    ;
                      Name=ShowLog;
                      CaptionML=[ENU=Synchronization Log;
                                 NOR=Synkroniseringslogg;
                                 SVE=Synkroniseringslogg];
                      ToolTipML=[ENU=View integration synchronization jobs for the contact table.;
                                 NOR=Vis synkroniseringsjobber for integrering for kontakttabellen.;
                                 SVE=Visa integrationssynkroniseringsjobb fîr kontakttabellen.];
                      ApplicationArea=#Suite;
                      Image=Log;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowLog(RECORDID);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon;
                                 SVE=Relaterad information];
                      Image=Users }
      { 33      ;2   ;Action    ;
                      CaptionML=[ENU=Relate&d Contacts;
                                 NOR=Tilknytte&de kontakter;
                                 SVE=Ko&ntakter];
                      ToolTipML=[ENU=View a list of all contacts.;
                                 NOR=Vis en liste over alle kontakter.;
                                 SVE=Visa en lista med alla kontakter.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5052;
                      RunPageLink=Company No.=FIELD(Company No.);
                      Image=Users }
      { 55      ;2   ;Action    ;
                      CaptionML=[ENU=Segmen&ts;
                                 NOR=Segme&nter;
                                 SVE=Segmen&t];
                      ToolTipML=[ENU=View the segments that are related to the contact.;
                                 NOR=Vis segmentene som er relatert til kontakten.;
                                 SVE=Visa segmenten som hîr till kontakten.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 11072092;
                      RunPageView=SORTING(Contact No.,Segment No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Mailing &Groups;
                                 NOR=Post&grupper;
                                 SVE=Utskicks&grupper];
                      ToolTipML=[ENU=View or edit the mailing groups that the contact is assigned to, for example, for sending price lists or Christmas cards.;
                                 NOR=Vis eller rediger postgruppene som kontakten er tilordnet til, for eksempel for sending av prislister eller julekort.;
                                 SVE=Visa eller redigera utskicksgrupperna som kontakten Ñr tilldelad till, till exempel fîr utskick av prislistor eller julkort.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5064;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DistributionGroup }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=C&ust./Vendor/Bank Acc./Emplr/Empl.;
                                 NOR=K&unde-/leverandõr-/bankkonto;
                                 SVE=&Kund/Leverantîr/Bankkonto];
                      ToolTipML=[ENU=View the related customer, vendor, or bank account that is associated with the current record.;
                                 NOR=Vis den relaterte kunde-, leverandõr- eller bankkontoen som er knyttet til den gjeldende posten.;
                                 SVE=Visa det relaterade kund-, leverantîrs- eller bankkontot som associeras med kundposten.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ContactReference;
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 7       ;1   ;ActionGroup;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver;
                                 SVE=Uppgifter];
                      Image=Task }
      { 50      ;2   ;Action    ;
                      CaptionML=[ENU=T&asks;
                                 NOR=Oppg&aver;
                                 SVE=U&ppgifter];
                      ToolTipML=[ENU=View all marketing tasks that involve the contact person.;
                                 NOR=Vis alle markedsfõringsoppgaver som omfatter kontaktpersonen.;
                                 SVE=Visa alla marknadsfîringsuppgifter som innefattar kontaktpersonen.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5096;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  System To-do Type=FILTER(Contact Attendee);
                      Image=TaskList }
      { 3       ;2   ;Action    ;
                      CaptionML=[ENU=Open Oppo&rtunities;
                                 NOR=èpne &salgsmuligheter;
                                 SVE=ôppna affÑ&rsmîjligheter];
                      ToolTipML=[ENU=View the open sales opportunities that are handled by salespeople for the contact. Opportunities must involve a contact and can be linked to campaigns.;
                                 NOR=Vis de Üpne salgsmulighetene som hÜndteres av selgere for kontakten. Salgsmuligheter mÜ inkludere en kontakt, og mÜ kunne an knyttes til kampanjer.;
                                 SVE=Visa de îppna fîrsÑljningsmîjligheter som hanteras av sÑljare fîr kontakten. Varje affÑrsmîjlighet mÜste vara knuten till en kontakt, och kan vara kopplad till kampanjer.];
                      ApplicationArea=#RelationshipMgmt;
                      Description=**4PS.o;
                      RunObject=Page 11072071;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  Status=FILTER(Not Started|In Progress);
                      Visible=FALSE;
                      Image=OpportunityList;
                      Scope=Repeater }
      { 76      ;2   ;Action    ;
                      CaptionML=[ENU=Postponed &Interactions;
                                 NOR=Utsatte samhandl&inger;
                                 SVE=Senarelagda &interaktioner];
                      ToolTipML=[ENU=View postponed interactions for the contact.;
                                 NOR=Vis utsatte samhandlinger for kontakten.;
                                 SVE=Visa senarelagda interaktioner fîr kontakten.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5082;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=PostponedInteractions }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter;
                                 SVE=Dokument];
                      Image=Documents }
      { 68      ;2   ;Action    ;
                      Name=ShowSalesQuotes;
                      CaptionML=[ENU=Sales &Quotes;
                                 NOR=&Tilbud;
                                 SVE=FîrsÑljnings&offerter];
                      ToolTipML=[ENU=View sales quotes that exist for the contact.;
                                 NOR=Vis tilbud som finnes for kontakten.;
                                 SVE=Visa fîrsÑljningsofferterna som finns fîr kontakten.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9300;
                      RunPageView=SORTING(Document Type,Sell-to Contact No.);
                      RunPageLink=Sell-to Contact No.=FIELD(No.);
                      Image=Quote }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=History;
                                 NOR=Historikk;
                                 SVE=Historik];
                      Image=History }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Closed Oppo&rtunities;
                                 NOR=Lukkede &salgsmuligheter;
                                 SVE=Avslutade affÑ&rsmîjligheter];
                      ToolTipML=[ENU=View the closed sales opportunities that are handled by salespeople for the contact. Opportunities must involve a contact and can be linked to campaigns.;
                                 NOR=Vis de lukkede salgsmulighetene som hÜndteres av selgere for kontakten. Salgsmuligheter mÜ inkludere en kontakt, og mÜ kunne an knyttes til kampanjer.;
                                 SVE=Visa de avslutade fîrsÑljningsmîjligheter som hanteras av sÑljare fîr kontakten. Varje affÑrsmîjlighet mÜste vara knuten till en kontakt, och kan vara kopplad till kampanjer.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 11072071;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  Status=FILTER(Won|Lost);
                      Visible=FALSE;
                      Image=OpportunityList }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 NOR=Samhandlingsp&oster;
                                 SVE=&Interaktionslogg];
                      ToolTipML=[ENU=View a list of the interactions that you have logged, for example, when you create an interaction, print a cover sheet, a sales order, and so on.;
                                 NOR=Vise en liste over samhandlingene du har loggfõrt, for eksempel nÜr du oppretter en samhandling, skriver ut fõlgebrev, en ordre og sÜ videre.;
                                 SVE=Visa en lista îver de interaktioner som du har loggat, t.ex. genom att du har skapat en interaktion eller skrivit ut ett meddelande eller en fîrsÑljningsorder.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 11072053;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=InteractionLog }
      { 42      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5053;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category4 }
      { 1210190029;2 ;Action    ;
                      CaptionML=[ENU=&Try-outs;
                                 SVE=&Anbud];
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowTryouts;
                               END;
                                }
      { 1210190030;2 ;Action    ;
                      CaptionML=[ENU=Try-out &Quotes;
                                 SVE=A&nbudsfîrfrÜgningar];
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowTryoutQuotes;
                               END;
                                }
      { 1210190031;2 ;Action    ;
                      CaptionML=[ENU=&Features;
                                 SVE=&Funktioner];
                      Image=BulletList;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowFeatures;
                               END;
                                }
      { 1210190033;2 ;Action    ;
                      CaptionML=[ENU=Documents;
                                 SVE=Dokument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 RecRef@1100527000 : RecordRef;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 ShowDocs(RecRef);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100485000;1 ;Action    ;
                      Name=CopyButton;
                      CaptionML=[ENU=&Copy;
                                 SVE=&Kopiera];
                      Promoted=Yes;
                      Enabled=CopyButtonEnable;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 IF gCopyQuote THEN
                                   CopyQuote();

                                 CurrPage.CLOSE;
                               END;
                                }
      { 1100529600;1 ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Search Vendor Category;
                                 SVE=Sîk leverantîrskategori];
                      Image=Vendor;
                      OnAction=VAR
                                 VendorCategoryReport@1100525000 : Report 11020266;
                               BEGIN
                                 //**4PS
                                 VendorCategoryReport.SetSelection(CodingSystem, VendorCategoryFilter, VendorQualificationCodeFilter);
                                 VendorCategoryReport.RUNMODAL;
                                 VendorCategoryReport.GetFilterVendorCategory(CodingSystem, VendorCategoryFilter, VendorQualificationCodeFilter);
                                 EvaluateVendorCategory;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner;
                                 SVE=Fu&nktion];
                      Image=Action }
      { 54      ;2   ;Action    ;
                      Name=MakePhoneCall;
                      CaptionML=[ENU=Make &Phone Call;
                                 NOR=S&lÜ nummeret;
                                 SVE=&Ring upp];
                      ToolTipML=[ENU=Call the selected contact.;
                                 NOR=Ring den valgte kontakten.;
                                 SVE=Ring upp den markerade kontakten.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Calls;
                      OnAction=VAR
                                 TAPIManagement@1001 : Codeunit 11072022;
                               BEGIN
                                 TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.",GetDefaultPhoneNo,'');
                               END;
                                }
      { 56      ;2   ;Action    ;
                      CaptionML=[ENU=Launch &Web Source;
                                 NOR=Start webk&ilde;
                                 SVE=Starta &webbadress];
                      ToolTipML=[ENU=Search for information about the contact online.;
                                 NOR=Sõk etter informasjon om kontakten pÜ Internett.;
                                 SVE=Sîk efter information om kontakten online.];
                      ApplicationArea=#RelationshipMgmt;
                      Visible=ActionVisible;
                      Image=LaunchWeb;
                      OnAction=VAR
                                 ContactWebSource@1001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF PAGE.RUNMODAL(PAGE::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 1100409002;2 ;Action    ;
                      CaptionML=[ENU=Show not blocked contacts;
                                 SVE=Visa ej spÑrrade kontakter];
                      Image=FilterLines;
                      OnAction=BEGIN
                                 ShowNotBlocked := NOT ShowNotBlocked;
                                 SetBlockedFilter;
                               END;
                                }
      { 58      ;2   ;ActionGroup;
                      CaptionML=[ENU=Create as;
                                 NOR=Opprett som;
                                 SVE=Skapa som];
                      Visible=ActionVisible;
                      Image=CustomerContact }
      { 59      ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 NOR=Kunde;
                                 SVE=Kund];
                      ToolTipML=[ENU=Create the contact as a customer.;
                                 NOR=Opprett kontakten som en kunde.;
                                 SVE=Skapa kontakten som en kund.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 //**4PS.sn
                                 InsertingCustomerIsAllowed(TRUE);
                                 TESTFIELD(Blocked, FALSE);
                                 //**4PS.en
                                 //CreateCustomer(ChooseCustomerTemplate); //**4PS.o
                                 SelectTemplAndCreateCustomer; //**4PS.n
                               END;
                                }
      { 60      ;3   ;Action    ;
                      Name=Vendor;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=Create the contact as a vendor.;
                                 NOR=Opprett kontakten som en leverandõr.;
                                 SVE=Skapa kontakten som en leverantîr.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Vendor;
                      OnAction=BEGIN
                                 //**4PS.sn
                                 InsertingVendorIsAllowed(TRUE);
                                 //SelectTemplAndCreateVendor;  //C015345.o
                                 CreateVendor; //C015345.n
                                 //**4PS.en
                               END;
                                }
      { 61      ;3   ;Action    ;
                      AccessByPermission=TableData 270=R;
                      CaptionML=[ENU=Bank;
                                 NOR=Bank;
                                 SVE=Bank];
                      ToolTipML=[ENU=Create the contact as a bank.;
                                 NOR=Opprett kontakten som en bank.;
                                 SVE=Skapa kontakten som en bank.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 1100485004;3 ;Action    ;
                      CaptionML=[ENU=Employer;
                                 SVE=Arbetsgivare];
                      Image=PersonInCharge;
                      OnAction=BEGIN
                                 //**4PS
                                 CreateEmployer;
                               END;
                                }
      { 1100485006;3 ;Action    ;
                      CaptionML=[ENU=Employee;
                                 SVE=Personal];
                      Image=Employee;
                      OnAction=BEGIN
                                 //**4PS
                                 CreateEmployee;
                               END;
                                }
      { 62      ;2   ;ActionGroup;
                      CaptionML=[ENU=Link with existing;
                                 NOR=Knytt til eksisterende;
                                 SVE=LÑnka med befintlig];
                      Image=Links }
      { 63      ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 NOR=Kunde;
                                 SVE=Kund];
                      ToolTipML=[ENU=Link the contact to an existing customer.;
                                 NOR=Koble kontakten til en eksisterende kunde.;
                                 SVE=Koppla kontakten till en befintlig kund.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 //**4PS.sn
                                 InsertingCustomerIsAllowed(TRUE);
                                 //**4PS.en

                                 CreateCustomerLink;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=Link the contact to an existing vendor.;
                                 NOR=Koble kontakten til en eksisterende leverandõr.;
                                 SVE=Koppla kontakten till en befintlig leverantîr.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Vendor;
                      OnAction=BEGIN
                                 //**4PS.sn
                                 InsertingVendorIsAllowed(TRUE);
                                 //**4PS.en

                                 CreateVendorLink;
                               END;
                                }
      { 65      ;3   ;Action    ;
                      AccessByPermission=TableData 270=R;
                      CaptionML=[ENU=Bank;
                                 NOR=Bank;
                                 SVE=Bank];
                      ToolTipML=[ENU=Link the contact to an existing bank.;
                                 NOR=Koble kontakten til en eksisterende bank.;
                                 SVE=Koppla kontakten till en befintlig bank.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 1100485005;3 ;Action    ;
                      CaptionML=[ENU=Create Employer;
                                 SVE=Arbetsgivare];
                      Image=PersonInCharge;
                      OnAction=BEGIN
                                 //**4PS
                                 CreateEmployerLink;
                               END;
                                }
      { 1100485007;3 ;Action    ;
                      CaptionML=[ENU=Create Employee;
                                 SVE=Personal];
                      Image=Employee;
                      OnAction=BEGIN
                                 //**4PS
                                 CreateEmployeeLink;
                               END;
                                }
      { 57      ;2   ;Action    ;
                      Name=Export Contact;
                      CaptionML=[ENU=Export Contact;
                                 NOR=Eksporter kontakt;
                                 SVE=Exportera kontakt];
                      ToolTipML=[ENU=Export Contact;
                                 NOR=Eksporter kontakt;
                                 SVE=Exportera kontakt];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=XMLport 5050;
                      Image=Export }
      { 31      ;2   ;Action    ;
                      AccessByPermission=TableData 11072030=R;
                      CaptionML=[ENU=Create &Interaction;
                                 NOR=&Opprett samhandling;
                                 SVE=Skapa &interaktion];
                      ToolTipML=[ENU=Create an interaction with a specified contact.;
                                 NOR=Opprett en samhandling med en angitt kontakt.;
                                 SVE=Skapa en interaktion med en angiven kontakt.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=CreateInteraction;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 1100528700;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Contact Person;
                                 SVE=Skapa kontaktperson];
                      Image=ContactPerson;
                      PromotedCategory=Process;
                      RunPageMode=Create;
                      OnAction=VAR
                                 TempContact@1100528700 : TEMPORARY Record 5050;
                                 Contact@1100528702 : Record 5050;
                               BEGIN
                                 //**4PS
                                 IF (CompanyNoForNewRec = '') AND (PersonNoForNewRec = '') THEN BEGIN
                                   IF Contact.GET("No.") THEN BEGIN
                                     IF Contact.IsCompany THEN
                                       TempContact.StartWizardCreateContactPerson("No.", '')
                                     ELSE IF Contact.IsPerson THEN
                                       TempContact.StartWizardCreateContactPerson('', "No.")
                                     ELSE
                                       TempContact.StartWizardCreateContactPerson(GETFILTER("Company No."), '');
                                   END ELSE
                                     TempContact.StartWizardCreateContactPerson(GETFILTER("Company No."), '');
                                 END ELSE
                                   TempContact.StartWizardCreateContactPerson(CompanyNoForNewRec, PersonNoForNewRec);
                               END;
                                }
      { 28      ;1   ;Action    ;
                      Name=SyncWithExchange;
                      CaptionML=[ENU=Sync with Office 365;
                                 NOR=Synkroniser med Office 365;
                                 SVE=Synka med Office 365];
                      ToolTipML=[ENU=Synchronize with Office 365 based on last sync date and last modified date. All changes in Office 365 since the last sync date will be synchronized back.;
                                 NOR=Synkronisering ved hjelp av Office 365 basert pÜ forrige synkroniseringsdato og endringsdato. Alle endringer i Office 365 siden forrige synkroniseringsdato, blir synkronisert tilbake.;
                                 SVE=Synkronisera med Office 365 baserat pÜ det senaste synkroniseringsdatumet och senaste Ñndringsdatumet. Alla Ñndringar i Office 365 sedan det senaste synkroniseringsdatumet synkroniseras tillbaka.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Refresh;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SyncExchangeContacts(FALSE);
                               END;
                                }
      { 32      ;1   ;Action    ;
                      Name=FullSyncWithExchange;
                      CaptionML=[ENU=Full Sync with Office 365;
                                 NOR=Synkroniser fullstendig med Office 365;
                                 SVE=Full synkning med Office 365];
                      ToolTipML=[ENU=Synchronize, but ignore the last synchronized and last modified dates. All changes will be pushed to Office 365 and take all contacts from your Exchange folder and sync back.;
                                 NOR=Synkroniser, men ignorer datoene for forrige synkronisering og endring. Alle endringer blir sendt til Office 365, og alle kontakter blir hentet fra Exchange-mappen og synkronisert tilbake.;
                                 SVE=Synkronisera, men ignorera det senaste synkroniseringsdatumet och senaste Ñndringsdatumet. Alla Ñndringar skickas vidare till Office 365 och alla kontakter frÜn din Exchange-mapp synkroniseras tillbaka.];
                      ApplicationArea=#Basic,#Suite;
                      Image=RefreshLines;
                      OnAction=BEGIN
                                 SyncExchangeContacts(TRUE);
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1900900305;1 ;Action    ;
                      Name=NewSalesQuote;
                      CaptionML=[ENU=New Sales Quote;
                                 NOR=Nytt tilbud;
                                 SVE=Ny fîrsÑljningsoffert];
                      ToolTipML=[ENU=Offer items or services to a customer.;
                                 NOR=Tilby varer eller tjenester til en kunde.;
                                 SVE=Erbjud en kund artiklar eller tjÑnster.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=No;
                      Image=NewSalesQuote;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CreateSalesQuoteFromContact;
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1904205506;1 ;Action    ;
                      CaptionML=[ENU=Contact Labels;
                                 NOR=Kontaktetiketter;
                                 SVE=Kontaktetiketter];
                      ToolTipML=[ENU=View mailing labels with names and addresses of your contacts. For example, you can use the report to review contact information before you send sales and marketing campaign letters.;
                                 NOR=Vis etiketter med navn og adresser for kontaktene dine. Du kan for eksempel bruke rapporten til Ü gÜ gjennom kontaktinformasjonen fõr du sender salgs- og markedsfõringsbrev.;
                                 SVE=Visa utskicksetiketter med dina kontakters namn och adress. Du kan till exempel anvÑnda rapporten om du vill granska kontaktinformationen innan du skickar fîrsÑljnings- eller kampanjbrev.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report 5056;
                      Image=Report }
      { 1905922906;1 ;Action    ;
                      CaptionML=[ENU=Questionnaire Handout;
                                 NOR=Spõrreskjema - utskrift;
                                 SVE=FrÜgeformulÑrutskrift];
                      ToolTipML=[ENU=View your profile questionnaire for the contact. You can print this report to have a printed copy of the questions that are within the profile questionnaire.;
                                 NOR=Vis profilspõrreskjemaet for kontakten. Du kan skrive ut denne rapporten slik at du fÜr en kopi av utskriften av spõrsmÜlene i profilspõrreskjemaet.;
                                 SVE=Visa profilfrÜgeformulÑret fîr kontakten. Skriv ut rapporten om du behîver en utskrift av frÜgorna i profilfrÜgeformulÑret.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report 5066;
                      Image=Report }
      { 1900800206;1 ;Action    ;
                      CaptionML=[ENU=Sales Cycle Analysis;
                                 NOR=Salgssyklus - analyse;
                                 SVE=FîrsÑljningscykelanalys];
                      ToolTipML=[ENU=View information about your sales cycles. The report includes details about the sales cycle, such as the number of opportunities currently at that stage, the estimated and calculated current values of opportunities created using the sales cycle, and so on.;
                                 NOR=Vis informasjon om salgssyklusene. Rapporten inneholder opplysninger om salgssyklusen, for eksempel hvor mange salgsmuligheter som for õyeblikket befinner seg i denne fasen, de anslÜtte og beregnede nÜverdiene av salgsmuligheter som er opprettet ved hjelp av salgssykluser, og sÜ videre.;
                                 SVE=Visa information om fîrsÑljningscyklerna. Rapporten innehÜller information om fîrsÑljningscyklerna, t.ex. antal affÑrsmîjligheter som fîr tillfÑllet befinner sig i fasen, uppskattade och berÑknade vÑrden fîr affÑrsmîjligheter som har skapats med hjÑlp av fîrsÑljningscykeln.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report 11072027;
                      Promoted=No;
                      Image=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100409000;1;Group  ;
                GroupType=Group }

    { 1100409001;2;Field  ;
                CaptionML=[ENU=Not Blocked Relations;
                           SVE=Ej spÑrrade relationer];
                SourceExpr=ShowNotBlocked;
                Editable=false }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Style=Strong;
                StyleExpr=StyleIsStrong }

    { 1210190000;2;Field  ;
                SourceExpr=Type }

    { 1210190002;2;Field  ;
                SourceExpr="Company No.";
                OnAssistEdit=VAR
                               Contact@1100525000 : Record 5050;
                             BEGIN
                               //**4PS
                               IF Contact.GET("Company No.") THEN
                                 Contact.RunContactForm;
                             END;
                              }

    { 1210190001;2;Field  ;
                SourceExpr="Person No.";
                OnAssistEdit=VAR
                               Contact@1210190000 : Record 5050;
                             BEGIN
                               //**4PS
                               IF Contact.GET("Person No.") THEN
                                 Contact.RunContactForm;
                             END;
                              }

    { 1100525001;2;Field  ;
                SourceExpr="First Name";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the contact. If the contact is a person, you can click the field to see the Name Details window.;
                           NOR=Angir navnet pÜ kontakten. Hvis kontakten er en person, kan du klikke feltet for Ü vise vinduet Navneopplysninger.;
                           SVE=Anger namnet pÜ kontakten. Om kontakten Ñr en person kan du klicka i fÑltet fîr att visa fînstret Namndetaljer.];
                ApplicationArea=#All;
                SourceExpr=Name;
                Style=Strong;
                StyleExpr=StyleIsStrong }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the company. If the contact is a person, Specifies the name of the company for which this contact works. This field is not editable.;
                           NOR=Angir navnet pÜ selskapet. Hvis kontakten er en person, angis navnet pÜ selskapet som kontakten jobber for. Du kan ikke redigere dette feltet.;
                           SVE=Anger fîretagets namn. Om kontakten Ñr en person anger fÑltet namnet pÜ fîretaget dÑr kontakten arbetar. Det gÜr inte att gîra Ñndringar i fÑltet.];
                ApplicationArea=#All;
                SourceExpr="Company Name";
                Visible=FALSE }

    { 1100525003;2;Field  ;
                SourceExpr="First Name 2";
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Name 2";
                Visible=FALSE }

    { 1100528701;2;Field  ;
                SourceExpr=Surname;
                Visible=FALSE }

    { 1210190024;2;Field  ;
                DrillDown=No;
                SourceExpr="Company Name 2";
                Visible=FALSE }

    { 1100525004;2;Field  ;
                SourceExpr=Gender }

    { 1000000002;2;Field  ;
                SourceExpr=Address }

    { 1000000004;2;Field  ;
                SourceExpr="Address 2";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr=City }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the territory code for the contact.;
                           NOR=Angir distriktskoden for kontakten.;
                           SVE=Anger kontaktens distriktkod.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Territory Code" }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region of the address.;
                           NOR=Angir landet/omrÜdet for adressen.;
                           SVE=Anger adressens land/region.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the contact's phone number.;
                           NOR=Angir kontaktens telefonnummer.;
                           SVE=Anger kontaktens telefonnummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Phone No." }

    { 1210190004;2;Field  ;
                SourceExpr="Phone No. 2";
                Visible=FALSE }

    { 1100485002;2;Field  ;
                SourceExpr="Extension No.";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the contact's mobile telephone number.;
                           NOR=Angir kontaktens mobilnummer.;
                           SVE=Anger kontaktens mobiltelefonnummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Mobile Phone No.";
                Visible=FALSE }

    { 1100525002;2;Field  ;
                SourceExpr="Mobile Phone No. 2";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the contact's fax number.;
                           NOR=Angir kontaktens faksnummer.;
                           SVE=Anger kontaktens faxnummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the salesperson who normally handles this contact.;
                           NOR=Angir koden for selgeren som vanligvis hÜndterer denne kontakten.;
                           SVE=Anger koden fîr den sÑljare som vanligtvis hanterar kontakten.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for the contact.;
                           NOR=Angir valutakoden for kontakten.;
                           SVE=Anger kontaktens valutakod.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the language that is used when translating specified text on documents to foreign business partner, such as an item description on an order confirmation.;
                           NOR=Angir sprÜket som brukes under konvertering av angitt tekst i dokumenter til utenlandsk forretningspartner, for eksempel en varebeskrivelsen pÜ en ordrebekreftelse.;
                           SVE=Anger vilket sprÜk som anvÑnds nÑr angiven text i dokument îversÑtts fîr utlÑndska affÑrspartner, till exempel en artikelbeskrivning pÜ en orderbekrÑftelse.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an alternate name that you can use to search for the record in question when you cannot remember the value in the Name field.;
                           NOR=Angir et alternativt navn du kan bruke til Ü sõke etter den aktuelle posten nÜr du ikke husker verdien i feltet Navn.;
                           SVE=Anger ett alternativt namn som du kan anvÑnda fîr att sîka efter posten i frÜga om du inte minns vÑrdet i fÑltet Namn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Search Name";
                Visible=FALSE }

    { 95  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether to limit access to data for the data subject during daily operations. This is useful, for example, when protecting data from changes while it is under privacy review.;
                           NOR=Angir om du vil begrense tilgangen til data for dataemnet i lõpet av den daglige driften. Dette er nyttig, for eksempel ved Ü beskytte data mot endringer mens personvernet blir gjennomgÜtt.;
                           SVE=Anger om du vill begrÑnsa Ütkomsten till data fîr den registrerade under daglig drift. Detta Ñr anvÑndbart nÑr du vill skydda data frÜn Ñndringar under sekretessgranskning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Privacy Blocked";
                Importance=Additional;
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the person's age is below the definition of adulthood as recognized by law. Data for minors is blocked until a parent or guardian of the minor provides parental consent. You unblock the data by selecting the Parental Consent Received check box.;
                           NOR=Angir at personens alder faller inn under definisjonen avˇvoksenliv som gjenkjennes av lov. Data for mindreÜrige er sperret til enˇforelder eller foresatt forˇden mindreÜrige gir samtykke. Du kan oppheve sperringen av dataene ved Ü merke av for Samtykke fra foreldre mottatt.;
                           SVE=Anger att personen Ñr yngre Ñn vad som definieras som vuxen enligt lag. Data fîr minderÜriga blockeras tills den minderÜrigas fîrÑlder eller mÜlsman ger sitt medgivande. Du tar bort blockeringen av data genom att markera kryssrutan FîrÑlders medgivande har tagits emot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Minor;
                Importance=Additional;
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that a parent or guardian of the minor has provided their consent to allow the minor to use this service. When this check box is selected, data for the minor can be processed.;
                           NOR=Angir at en forelder eller foresatt for den mindreÜrige har gitt sitt samtykkeˇslik at den mindreÜrige kan bruke denne tjenesten. NÜr det er merket av for dette, kan dataene for den mindreÜrige behandles.;
                           SVE=Anger att den minderÜrigas fîrÑlder eller mÜlsman har gett sitt medgivande till att den minderÜriga anvÑnder tjÑnsten. NÑr den hÑr kryssrutan Ñr markerad kan data fîr minderÜriga bearbetas.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Parental Consent Received";
                Importance=Additional;
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                ExtendedDatatype=E-Mail;
                ToolTipML=[ENU=Specifies the contact's email.;
                           NOR=Angir kontaktens e-postadresse.;
                           SVE=Anger kontaktens e-postadress.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Mail";
                Visible=FALSE }

    { 1100525000;2;Field  ;
                SourceExpr="E-Mail 2";
                Visible=FALSE }

    { 1210190008;2;Field  ;
                SourceExpr="Home Page";
                Visible=FALSE }

    { 1210190026;2;Field  ;
                SourceExpr="Job Title" }

    { 1210190012;2;Field  ;
                SourceExpr="Document Group";
                Visible=FALSE }

    { 1210190014;2;Field  ;
                SourceExpr="Visit Address";
                Visible=FALSE }

    { 1210190016;2;Field  ;
                SourceExpr="Visit Address 2";
                Visible=FALSE }

    { 1210190018;2;Field  ;
                SourceExpr="Visit Address Post Code";
                Visible=FALSE }

    { 1210190020;2;Field  ;
                SourceExpr="Visit Address City";
                Visible=FALSE }

    { 1210190022;2;Field  ;
                SourceExpr="Visit Address Country/Region";
                Visible=FALSE }

    { 1100485008;2;Field  ;
                CaptionML=[ENU=Holding Structure Available;
                           SVE=TillgÑnglig koncernstruktur];
                SourceExpr=HoldStructBool;
                Editable=FALSE }

    { 1210190034;2;Field  ;
                SourceExpr=Blocked }

    { 1100528400;2;Field  ;
                SourceExpr=Comment;
                Visible=FALSE }

    { 1100528300;2;Field  ;
                SourceExpr="Available for Control" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 128 ;1   ;Part      ;
                ApplicationArea=#RelationshipMgmt;
                SubPageLink=No.=FIELD(No.),
                            Date Filter=FIELD(Date Filter);
                PagePartID=Page9130;
                PartType=Page }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ClientTypeManagement@1000 : Codeunit 4030;
      CRMCouplingManagement@1002 : Codeunit 5331;
      StyleIsStrong@1001 : Boolean INDATASET;
      CompanyGroupEnabled@1004 : Boolean;
      PersonGroupEnabled@1003 : Boolean;
      CRMIntegrationEnabled@1006 : Boolean;
      CRMIsCoupledToRecord@1005 : Boolean;
      ActionVisible@1007 : Boolean;
      RelContSalespersonRec@1210190002 : Record 11012760;
      HoldStructRec@1100485007 : Record 11020206;
      HoldStructRec2@1100485006 : Record 11020206;
      RemoveFilterSalesPerson@1210190001 : Boolean;
      Text11012000@1100485003 : TextConst 'ENU=First select line(s).;SVE=VÑlj fîrst rad(er).';
      gCopyQuote@1100485000 : Boolean;
      gDocNo@1100485001 : Code[20];
      HoldStructBool@1100485005 : Boolean;
      HoldstructAvailBool@1100485004 : Boolean;
      CompanyNoForNewRec@1100528700 : Code[20];
      PersonNoForNewRec@1100528701 : Code[20];
      CopyButtonEnable@19014618 : Boolean INDATASET;
      ShowNotBlocked@1100409000 : Boolean;
      CodingSystem@1100525003 : Code[20];
      VendorCategoryFilter@1100525002 : Text[250];
      VendorQualificationCodeFilter@1100525000 : Code[10];

    LOCAL PROCEDURE EnableFields@1();
    BEGIN
      CompanyGroupEnabled := Type = Type::Company;
      PersonGroupEnabled := Type = Type::Person;
    END;

    [Internal]
    PROCEDURE SyncExchangeContacts@2(FullSync@1001 : Boolean);
    VAR
      ExchangeSync@1002 : Record 6700;
      O365SyncManagement@1000 : Codeunit 6700;
      ExchangeContactSync@1003 : Codeunit 6703;
    BEGIN
      IF O365SyncManagement.IsO365Setup(TRUE) THEN
        IF ExchangeSync.GET(USERID) THEN BEGIN
          ExchangeContactSync.GetRequestParameters(ExchangeSync);
          O365SyncManagement.SyncExchangeContacts(ExchangeSync,FullSync);
        END;
    END;

    [External]
    PROCEDURE GetSelectionFilter@4() : Text;
    VAR
      Contact@1001 : Record 5050;
      SelectionFilterManagement@1002 : Codeunit 46;
    BEGIN
      CurrPage.SETSELECTIONFILTER(Contact);
      EXIT(SelectionFilterManagement.GetSelectionFilterForContact(Contact));
    END;

    [External]
    PROCEDURE SetSelection@3(VAR Contact@1000 : Record 5050);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Contact);
    END;

    PROCEDURE InitSelectionCopyQuote@1100485000(IDocNo@1210190011 : Code[20]);
    VAR
      lvText001@1210190013 : TextConst 'ENU=Copy Quote to Other Contact(s);SVE=Kopiera offert till annan kontakt/andra kontakter';
      lvPurchHeadRec@1210190012 : Record 38;
    BEGIN
      //**4PS
      gCopyQuote := TRUE;
      gDocNo := IDocNo;
      lvPurchHeadRec.GET(lvPurchHeadRec."Document Type"::Quote, gDocNo);
      CurrPage.CAPTION := lvText001;
    END;

    PROCEDURE CopyQuote@1210190002();
    VAR
      lvContRec@1210190012 : Record 5050;
      lvPurchHeadRec@1100485008 : Record 38;
      lvTmpDummyVendRec@1210190018 : TEMPORARY Record 23;
      lvCopyDocMgtCU@1210190017 : Codeunit 6620;
    BEGIN
      //**4PS
      lvPurchHeadRec.GET(lvPurchHeadRec."Document Type"::Quote, gDocNo);

      CurrPage.SETSELECTIONFILTER(lvContRec);
      IF NOT lvContRec.FINDFIRST THEN
        ERROR(Text11012000);

      lvCopyDocMgtCU.CopyQuoteToMarkedVendorContact(lvTmpDummyVendRec, lvContRec, 2, gDocNo);
    END;

    PROCEDURE GetSelectionFilter4PS@1100485001(VAR ContactRec@1100485000 : Record 5050);
    BEGIN
      //**4PS
      CurrPage.SETSELECTIONFILTER(ContactRec);
    END;

    LOCAL PROCEDURE ContPersOfOneCompanyAreShown@1210190001() : Boolean;
    VAR
      ContactPerson@1210190000 : Record 5050;
      ContactCompany@1210190001 : Record 5050;
    BEGIN
      //**4PS, kkleermaker, 110819, M28570
      IF GETFILTER("Company No.") = '' THEN
        EXIT(FALSE);

      ContactPerson.Type := ContactPerson.Type::Person;
      IF GETFILTER(Type) <> STRSUBSTNO('%1', ContactPerson.Type) THEN
        EXIT(FALSE);

      ContactCompany.SETFILTER("No.", GETFILTER("Company No."));
      ContactCompany.SETRANGE(Type, ContactCompany.Type::Company);
      IF NOT ContactCompany.FINDFIRST THEN
        EXIT(FALSE);
      IF ContactCompany.NEXT = 0 THEN
        EXIT(TRUE);
    END;

    PROCEDURE SetCompanyNoForNewRec@1100528700(ContactNo@1100528700 : Code[20]);
    BEGIN
      //**4PS
      CompanyNoForNewRec := ContactNo;
    END;

    PROCEDURE SetPersonNoForNewRec@1100528701(ContactNo@1100528700 : Code[20]);
    BEGIN
      //**4PS
      PersonNoForNewRec := ContactNo;
    END;

    LOCAL PROCEDURE gShowNotBlockedOnAfterValidate@19064626();
    BEGIN
      //**4PS mg, 16-12-10: M19964
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SetBlockedFilter@1100525000();
    BEGIN
      //**4PSmg, 16-12-10: M19964
      //FILTERGROUP(100);
      IF ShowNotBlocked THEN
        SETRANGE(Blocked, FALSE)
      ELSE
        SETRANGE(Blocked);
      //FILTERGROUP(0);
    END;

    PROCEDURE EvaluateVendorCategory@1100528901();
    VAR
      Contact@1100528901 : Record 5050;
      VendorCategory@1100528902 : Record 11071892;
      ContactFilterTxt@1100525000 : Text;
    BEGIN
      //**4PS
      CLEARMARKS;
      MARKEDONLY(FALSE);

      IF CodingSystem + VendorCategoryFilter + VendorQualificationCodeFilter = '' THEN
        EXIT;
      Contact.COPY(Rec);
      IF Contact.ISEMPTY THEN
        EXIT;

      IF CodingSystem <> '' THEN
        VendorCategory.SETRANGE("Coding System", CodingSystem);
      IF VendorCategoryFilter <> '' THEN
        VendorCategory.SETFILTER(Code, VendorCategoryFilter);
      IF VendorQualificationCodeFilter <> '' THEN
        VendorCategory.SETFILTER("Vendor Qualification Code", VendorQualificationCodeFilter);
      IF VendorCategory.ISEMPTY THEN
        EXIT;

      Contact.FINDSET;
      REPEAT
        VendorCategory.SETRANGE("Contact No.", Contact."No.");
        IF NOT VendorCategory.ISEMPTY THEN
          ContactFilterTxt += Contact."No." + '|';
      UNTIL Contact.NEXT = 0;

      IF ContactFilterTxt <> '' THEN
        SETFILTER("No.", COPYSTR(ContactFilterTxt, 1, STRLEN(ContactFilterTxt) - 1));
    END;

    PROCEDURE FormatVendorCategory@1100525002();
    VAR
      FormatMgt@1100525002 : Codeunit 11012022;
      VendorCategoryFilterCode@1100525000 : Code[250];
    BEGIN
      //**4PS
      IF FormatMgt.Numeric(VendorCategoryFilter) THEN BEGIN
        VendorCategoryFilterCode := VendorCategoryFilter;
        FormatMgt.SetSelection(CodingSystem);
        FormatMgt.FormatElem(VendorCategoryFilterCode, 4, '');
        VendorCategoryFilter := VendorCategoryFilterCode;
      END;
    END;

    BEGIN
    {
      4PS prior changes
      4PS PD(metx) 20-12-2017 XRM-4PS Integration - added actions for integration
      4PS UsageCategory removed
      131107 ITERO.DJ I052 Added new menu action "Person Card"
    }
    END.
  }
}

