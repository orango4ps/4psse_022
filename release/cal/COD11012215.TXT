OBJECT Codeunit 11012215 Purch. Inv. Start DMS WF
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    TableNo=122;
    Permissions=TableData 122=rimd;
    OnRun=VAR
            InvoiceApprovalLine@1210190001 : Record 11012032;
            PostInvoiceApproval@1210190000 : Codeunit 11012027;
          BEGIN
            TESTFIELD("DMS Status", "DMS Status"::"Awaiting Line Entry");

            InvoiceApprovalLine."Document No." := "No.";
            InvoiceApprovalLine.SETRANGE("Journal Template Name", "Journal Template");
            InvoiceApprovalLine.SETRANGE("Document Type", InvoiceApprovalLine."Document Type"::"Purchase Invoice");
            InvoiceApprovalLine.SETRANGE("Document No.", "No.");
            REPEAT
              InvoiceApprovalLine.CheckDimensions;
              PostInvoiceApproval.CheckApprovalLineDMS(InvoiceApprovalLine);
            UNTIL (InvoiceApprovalLine.NEXT = 0);
            InvoiceApprovalLine.CALCFIELDS(Balance);
            CALCFIELDS("Balance Due");

            PostInvoiceApproval.CheckInvoiceMargin(Rec, InvoiceApprovalLine, 0);

            "DMS Status" := "DMS Status"::"Start Workflow";
            "DMS Status Text" := '';
            MODIFY;
          END;

  }
  CODE
  {

    BEGIN
    END.
  }
}

