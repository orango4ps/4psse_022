OBJECT Page 11125208 Service Call
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    Permissions=TableData 36=im,
                TableData 11012823=i,
                TableData 11012826=i;
    CaptionML=[ENU=Service Call;
               NOR=Servicesamtale;
               SVE=Servicesamtal];
    SourceTable=Table11012822;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Texts,Mail Documents;
                                NOR=Ny,Prosesser,Rapport,Tekster,Send dokumenter;
                                SVE=Ny,Behandla,Rapport,Texter];
    OnInit=BEGIN
             FillShowMandatoryVariables;
           END;

    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 ServiceSetup.GET;
               END;

    OnAfterGetRecord=VAR
                       TryoutSuccessor@1100528600 : Record 11012761;
                       Source@1100528800 : 'ServiceLocation,ServiceObject';
                       FPSLicenseManagement@1100527400 : Codeunit 11229289;
                     BEGIN
                       IF "Object No." <> '' THEN
                         CurrPage.PurchaseLineServiceObjectFactbox.PAGE.SetSource(Source::ServiceObject, "Object No.")
                       ELSE
                         CurrPage.PurchaseLineServiceObjectFactbox.PAGE.SetSource(Source::ServiceLocation, "Service Location No.");

                       IF FPSLicenseManagement.LicenseAndReadPermissionForTable(TryoutSuccessor) THEN BEGIN
                         TryOutRelation := TryoutSuccessor.GetTryOut('', '', '', '', '', '', '', "No.", 1);
                         TryOutQuoteRelation := TryoutSuccessor.GetTryOut('', '', '', '', '', '', '', "No.", 2);
                       END;

                       IF (NOT Agent.GET("Agent No.")) THEN
                         Agent.INIT;
                     END;

    OnNewRecord=VAR
                  PlantLocationAddress@1100529301 : Record 11012590;
                BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  UpdateSignalRulesSF;
                  PlantLocationAddress.SETRANGE(Location,"Plant Location");
                  PlantLocationAddresses := '[' + FORMAT(PlantLocationAddress.COUNT) + ']';
                  "Call Kind" := ServiceSetup."Default Call Kind";
                  "Call Type" := ServiceSetup."Default Call Type";

                  IF ServiceSetup.GET THEN
                    IF ServiceSetup."Use Vessel Functionality" THEN
                      "Vessel Service Call" := TRUE;
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnModifyRecord=BEGIN
                     UpdateSignalRulesSF
                   END;

    OnAfterGetCurrRecord=VAR
                           MaintenanceManagementCU@1100525003 : Codeunit 11012829;
                           CurrServiceContractNo@1100525002 : Code[20];
                           RecRef@1100525001 : RecordRef;
                           ServiceObjectInfoMgt@1100525000 : Codeunit 11012840;
                         BEGIN
                           NextCall := ShowNextCall(0);


                           NumWatch := CheckAvailableWatches;
                           NumContract :=
                             STRSUBSTNO('[%1]', MaintenanceManagementCU.GetNoOfActualContractsForObj("Object No.", TODAY, CurrServiceContractNo));
                           NumDim1 := CheckAvailableDim1;

                           ServiceObjectInfoMgt.GetBuildingInfo("Object No.", BuildingCode, BuildingDescription);

                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");

                           UpdateSignalRulesSF;
                           GetPlantValues;
                           CurrPage.ServiceOrderPlantFB.PAGE.SetPlantCompany("Plant Company");
                           CurrPage.PlantMeterReadingFB.PAGE.SetPlantCompany("Plant Company");
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1210190029;1 ;ActionGroup;
                      CaptionML=[ENU=&Service Call;
                                 NOR=&Servicesamtale;
                                 SVE=&Servicesamtal] }
      { 1210190114;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Service Call),
                                  No.=FIELD(No.);
                      Visible=false;
                      Image=ViewComments }
      { 1100485054;2 ;Action    ;
                      CaptionML=[ENU=Report &Procedure;
                                 NOR=Rapporter &prosedyre;
                                 SVE=Rapport&procedur];
                      Visible=false;
                      Image=Report;
                      OnAction=VAR
                                 ServiceOrderInfoMgt@1100528600 : Codeunit 11012841;
                               BEGIN
                                 ServiceOrderInfoMgt.ShowServiceTextLines("Service Location No.", 5);
                               END;
                                }
      { 1100485055;2 ;Action    ;
                      CaptionML=[ENU=Contract &Agreements;
                                 NOR=Kontrakt&avtaler;
                                 SVE=Kontr&aktavtal];
                      Visible=false;
                      Image=ServiceAgreement;
                      OnAction=VAR
                                 ServiceOrderInfoMgt@1100528600 : Codeunit 11012841;
                               BEGIN
                                 ServiceOrderInfoMgt.ShowServiceTextLines("Service Location No.", 6);
                               END;
                                }
      { 1100525037;2 ;Action    ;
                      CaptionML=[ENU=Invoice Agreements;
                                 NOR=Fakturaavtale;
                                 SVE=Fakturaavtal];
                      Visible=false;
                      Image=Agreement;
                      OnAction=VAR
                                 ServiceOrderInfoMgt@1100528600 : Codeunit 11012841;
                               BEGIN
                                 ServiceOrderInfoMgt.ShowServiceTextLines("Service Location No.", 7);
                               END;
                                }
      { 1100485039;2 ;Action    ;
                      CaptionML=[ENU=Reference Periods;
                                 NOR=Referanseperioder;
                                 SVE=Referensperioder];
                      Promoted=Yes;
                      Image=CalculateWIP;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReferencePeriodsServicePAGE@1100528600 : Page 11020670;
                               BEGIN
                                 ReferencePeriodsServicePAGE.SetServiceCallNo("No.");
                                 ReferencePeriodsServicePAGE.RUN;
                               END;
                                }
      { 1100485065;2 ;Action    ;
                      CaptionML=[ENU=Do&cuments;
                                 NOR=Do&kumenter;
                                 SVE=Do&kument];
                      Visible=false;
                      Image=Documents;
                      OnAction=BEGIN
                                 ShowDocuments;  //db, 21-05-10
                               END;
                                }
      { 1100485010;2 ;Action    ;
                      CaptionML=[ENU=History Call;
                                 NOR=Historikk, samtale;
                                 SVE=Historik, samtal];
                      Visible=false;
                      Image=History;
                      OnAction=BEGIN
                                 GetHistory(Rec);
                               END;
                                }
      { 1100485031;2 ;Action    ;
                      CaptionML=[ENU=Open Service Orders;
                                 NOR=èpne serviceordre;
                                 SVE=ôppna serviceorder];
                      Visible=false;
                      Image=ViewDocumentLine;
                      OnAction=BEGIN
                                 GetOpenServiceOrder(Rec);
                               END;
                                }
      { 1100525014;2 ;Action    ;
                      CaptionML=[ENU=Active &Watches;
                                 NOR=Aktive &observasjoner;
                                 SVE=Aktiva &observationer];
                      Image=Union;
                      OnAction=BEGIN
                                 ShowConsignmentRoster;
                               END;
                                }
      { 1100528634;2 ;Action    ;
                      CaptionML=[ENU=Reference Points;
                                 NOR=Referansepunkter;
                                 SVE=Referenspunkter];
                      RunObject=Page 11020345;
                      RunPageLink=Type=CONST(ServCall),
                                  Document No.=FIELD(No.);
                      Image=EntriesList;
                      PromotedCategory=Process }
      { 1100285100;2 ;Action    ;
                      Name=CreateContactCompany;
                      CaptionML=[ENU=Create Contact Company;
                                 SVE=Skapa fîretagskontakt];
                      Promoted=Yes;
                      Image=NewCustomer;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 MarketingSetup@1100285101 : Record 5079;
                                 Contact@1100285100 : Record 5050;
                                 NoSeriesMgt@1100285102 : Codeunit 396;
                                 ContactCardCompany@1100285103 : Page 11125049;
                               BEGIN
                                 MarketingSetup.GET;
                                 MarketingSetup.TESTFIELD("Company Nos.");

                                 Contact.INIT;
                                 NoSeriesMgt.InitSeries(MarketingSetup."Company Nos.", '', 0D, Contact."No.", Contact."No. Series");
                                 Contact.Type := Contact.Type::Company;
                                 Contact.INSERT(TRUE);
                                 Contact.SETRANGE("No.", Contact."No.");
                                 ContactCardCompany.SETTABLEVIEW(Contact);
                                 ContactCardCompany.RUN;

                                 Rec."Contact No. Company" := Contact."No.";

                                 //EXIT(Contact."No.");
                               END;
                                }
      { 1100528619;1 ;ActionGroup;
                      CaptionML=[ENU=Dispatch;
                                 SVE=AvsÑndande];
                      Visible=false }
      { 1100528620;2 ;Action    ;
                      CaptionML=[ENU=File Card;
                                 SVE=ôppna kort];
                      Image=Card;
                      OnAction=VAR
                                 DispatchInterface@1100528600 : Codeunit 11071685;
                               BEGIN
                                 DispatchInterface.ShowDispatchFileCardByServiceCall(Rec);
                               END;
                                }
      { 1100528622;2 ;Action    ;
                      AccessByPermission=Table 11072270=X;
                      CaptionML=[ENU=Open File;
                                 SVE=ôppna sida];
                      Image=LinkWeb;
                      OnAction=VAR
                                 DispatchInterface@1100528600 : Codeunit 11071685;
                               BEGIN
                                 DispatchInterface.ShowDispatchFileByServiceCall(Rec);
                               END;
                                }
      { 1100528621;2 ;Action    ;
                      AccessByPermission=Table 11072270=X;
                      CaptionML=[ENU=Open Order;
                                 NOR=èpen ordre;
                                 SVE=ôppen order];
                      Image=LinkWeb;
                      OnAction=VAR
                                 DispatchInterface@1100528600 : Codeunit 11071685;
                               BEGIN
                                 DispatchInterface.ShowDispatchOrderByServiceCall(Rec);
                               END;
                                }
      { 1100525032;1 ;ActionGroup;
                      CaptionML=[ENU=Bing Maps;
                                 NOR=Bing-kart;
                                 SVE=Bing Maps] }
      { 1100525033;2 ;Action    ;
                      Name=Show Location (And Object) On Map;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=ENU=Show Location (and Object) on Map;
                      Image=Map;
                      OnAction=VAR
                                 BingMapsLocationObjects@1100525000 : Page 11229929;
                                 ServiceLocation@1100525001 : Record 11012801;
                               BEGIN
                                 IF ServiceLocation.GET("Service Location No.") THEN
                                   BingMapsLocationObjects.SetServiceLocation(ServiceLocation);
                                 IF Address <> ServiceLocation.Address THEN
                                   BingMapsLocationObjects.SetCallLocation(Address, City, "Post Code");
                                 IF "Object No." <> '' THEN
                                   BingMapsLocationObjects.SetSingleServiceObject("Object No.");
                                 BingMapsLocationObjects.RUNMODAL;
                               END;
                                }
      { 1100525031;2 ;Action    ;
                      Name=Show Nearby Objects;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=ENU=Show Nearby Objects;
                      Image=Map;
                      OnAction=VAR
                                 BingMapsServiceCall@1100525000 : Page 11229936;
                                 BingMapsHandler@1100525001 : Codeunit 11012485;
                                 tmpLat@1100525002 : Text[255];
                                 tmpLng@1100525003 : Text[255];
                               BEGIN
                                 IF BingMapsHandler.GetLatLngFromAddress(tmpLat, tmpLng, Address, City, "Post Code") THEN BEGIN
                                   BingMapsServiceCall.SetCallRecord(Rec);
                                   BingMapsServiceCall.SetBaseLocation(tmpLat, tmpLng);
                                   BingMapsServiceCall.RUNMODAL;
                                 END
                                 ELSE
                                   MESSAGE(Text004);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1210190075;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=Fu&nksjon;
                                 SVE=Fu&nktion] }
      { 1100485015;2 ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Create &Next Call;
                                 NOR=Opprett &neste samtale;
                                 SVE=Skapa &nÑsta samtal];
                      Promoted=Yes;
                      Visible=false;
                      Image=CreateDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyServCall;  //db, 18-12-09
                               END;
                                }
      { 1210190076;2 ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=Create &Service Order;
                                 NOR=Opprett &serviceordre;
                                 SVE=Skapa &serviceorder];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MakeOrder;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OriginalServiceCall@1100528604 : Record 11012822;
                                 ServiceOrder@1100528602 : Record 11012823;
                                 CreateServiceOrderfromCallFRM@1100528601 : Page 11125229;
                                 ReplanServiceOrder@1100528603 : Page 11126465;
                                 NextStep@1100528600 : ' ,Service Order Card,Plan Service Order';
                               BEGIN
                                 IF "Service Order No." <> '' THEN
                                   IF CONFIRM(Text002, FALSE) = FALSE THEN EXIT;

                                 VALIDATE("Next Step", "Next Step"::ServiceOrder);  //db, 07-12-07
                                 IF Status = Status::Cancelled THEN
                                   ERROR(Text003);

                                 OriginalServiceCall := Rec;
                                 CreateServiceOrderfromCallFRM.SetDefaults("No.");
                                 CreateServiceOrderfromCallFRM.RUNMODAL;
                                 CreateServiceOrderfromCallFRM.GetNextStep(NextStep);
                                 OriginalServiceCall.FIND('=');

                                 IF OriginalServiceCall."Service Order No." <> '' THEN BEGIN
                                   COMMIT;
                                   ServiceOrder.GET(OriginalServiceCall."Service Order No.");
                                   ServiceOrder.SETRECFILTER;
                                   CASE NextStep OF
                                     NextStep::"Service Order Card":
                                       ServiceOrder.ShowServiceOrderCard;
                                     NextStep::"Plan Service Order":
                                       BEGIN
                                         ServiceOrder.SETRECFILTER;
                                         ReplanServiceOrder.SetReplanData(ServiceOrder, TODAY, 1, 0, FALSE, FALSE, TRUE, TRUE);
                                         ReplanServiceOrder.RUNMODAL;
                                       END;
                                   END;
                                 END;

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100528639;2 ;Action    ;
                      CaptionML=[ENU=Create Try-Out Quote;
                                 NOR=Opprett tilbudsforespõrsel;
                                 SVE=Skapa anbudsfîrfrÜgan];
                      Visible=false;
                      Image=Document;
                      OnAction=VAR
                                 TryoutSuccessor@1100528600 : Record 11012761;
                               BEGIN
                                 TryoutSuccessor.SETCURRENTKEY("Service Call No.");
                                 TryoutSuccessor.SETRANGE("Service Call No.", "No.");
                                 IF TryoutSuccessor.ISEMPTY THEN BEGIN
                                   IF Status = Status::Cancelled THEN
                                     ERROR(Text003);

                                   CreateTryoutQuote;
                                   CurrPage.UPDATE(TRUE);
                                 END;
                               END;
                                }
      { 1100485035;2 ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Link to open Service Order;
                                 NOR=Link til Üpen serviceordre;
                                 SVE=LÑnka till îppen serviceorder];
                      Visible=false;
                      Image=Link;
                      OnAction=VAR
                                 CreateServiceOrderfromCallFRM@1210190001 : Page 11125229;
                                 lvServOrder@1100485001 : Code[20];
                               BEGIN
                                 IF "Service Order No." <> '' THEN
                                   IF CONFIRM(Text002, FALSE) = FALSE THEN EXIT;

                                 VALIDATE("Next Step", "Next Step"::ServiceOrder);  //db, 07-12-07
                                 IF Status = Status::Cancelled THEN
                                   ERROR(Text003);

                                 lvServOrder := GetOpenServiceOrder(Rec);
                                 IF lvServOrder <> '' THEN BEGIN
                                   CreateServiceOrderfromCallFRM.SetDefaults("No.");
                                   CreateServiceOrderfromCallFRM.RUNMODAL;

                                   ServCallRec.GET("No.");
                                   IF ServOrderRec.GET(ServCallRec."Service Order No.") THEN BEGIN
                                     ServOrderRec."Previous Service Order No." := lvServOrder;
                                     ServOrderRec.MODIFY(TRUE);
                                   END;
                                 END;
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1210190077;2 ;Action    ;
                      CaptionML=[ENU=Create Sales &Quote;
                                 NOR=Opprett salgs&tilbud;
                                 SVE=Skapa fîrsÑljningso&ffert];
                      Visible=false;
                      Image=Quote;
                      OnAction=VAR
                                 SalesHeader@1100528400 : Record 36;
                               BEGIN
                                 IF "Sales Document No." = '' THEN BEGIN
                                   TESTFIELD("Next Step", "Next Step"::SalesQuote);
                                   IF Status = Status::Cancelled THEN
                                     ERROR(Text003);

                                   SalesHeader."Document Type" := SalesHeader."Document Type"::Quote;
                                   InsertSalesHeader(SalesHeader);
                                   CurrPage.UPDATE(TRUE);
                                 END;
                               END;
                                }
      { 1210190078;2 ;Action    ;
                      ShortCutKey=Ctrl+F10;
                      CaptionML=[ENU=Create Sales &Order;
                                 NOR=Opprett salgs&ordre;
                                 SVE=Skapa fîrsÑljnings&order];
                      Visible=false;
                      Image=MakeOrder;
                      OnAction=VAR
                                 SalesHeader@1100528400 : Record 36;
                                 CreateSalesOrderFromCall@1100527350 : Report 11072159;
                               BEGIN
                                 IF "Sales Document No." = '' THEN BEGIN
                                   TESTFIELD("Next Step", "Next Step"::" ");
                                   VALIDATE("Next Step", "Next Step"::SalesOrder);
                                   IF Status = Status::Cancelled THEN
                                     ERROR(Text003);

                                   IF "Vessel Service Call" THEN BEGIN
                                     CreateSalesOrderFromCall.SetServiceCall(Rec);
                                     CreateSalesOrderFromCall.RUNMODAL;
                                     CreateSalesOrderFromCall.GetServiceCall(Rec);
                                   END ELSE BEGIN
                                     SalesHeader."Document Type" := SalesHeader."Document Type"::Order;
                                     InsertSalesHeader(SalesHeader);
                                   END;

                                   CurrPage.UPDATE(TRUE);
                                 END;
                               END;
                                }
      { 1100485008;2 ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=Create &Project;
                                 NOR=Opprett &Prosjekt;
                                 SVE=Skapa &projekt];
                      Visible=false;
                      Image=Job;
                      OnAction=BEGIN
                                 IF "Project (Dest)" = '' THEN BEGIN
                                   TESTFIELD("Next Step", "Next Step"::Project);
                                   IF Status = Status::Cancelled THEN
                                     ERROR(Text003);

                                   CreateProject;
                                   CurrPage.UPDATE(TRUE);
                                 END;
                               END;
                                }
      { 1100485009;2 ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Create &Small Project;
                                 NOR=Opprett &lite prosjekt;
                                 SVE=Skapa &mindre projekt];
                      Visible=false;
                      Image=Job;
                      OnAction=BEGIN
                                 IF "Project (Dest)" = '' THEN BEGIN
                                   TESTFIELD("Next Step", "Next Step"::SmallProject);
                                   IF Status = Status::Cancelled THEN
                                     ERROR(Text003);

                                   CreateProject;
                                   CurrPage.UPDATE(TRUE);
                                 END;
                               END;
                                }
      { 1100485081;2 ;Action    ;
                      CaptionML=[ENU=Print;
                                 NOR=Skriv ut;
                                 SVE=Skriv ut];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 PrintDoc@1100485000 : Codeunit 229;
                               BEGIN
                                 PrintDoc.PrintServCall(Rec);
                               END;
                                }
      { 1210190012;2 ;Action    ;
                      ShortCutKey=Ctrl+K;
                      CaptionML=[ENU=Completeness Check;
                                 NOR=Fullstendighetskontroll;
                                 SVE=FullstÑndighetskontroll];
                      Image=CheckList;
                      OnAction=VAR
                                 CompletionCheckManagement@1210190001 : Codeunit 11012252;
                                 ServiceCallRecordRef@1210190000 : RecordRef;
                               BEGIN
                                 ServiceCallRecordRef.GETTABLE(Rec);
                                 CompletionCheckManagement.ShowIncompleteFields(ServiceCallRecordRef);
                               END;
                                }
      { 1100529300;2 ;Action    ;
                      CaptionML=[ENU=Search Plant Location;
                                 SVE=Sîk Maskinplats];
                      Promoted=Yes;
                      Visible=false;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF SearchPlantLocation() THEN
                                   CurrPage.UPDATE;
                               END;
                                }
      { 1100528615;2 ;Action    ;
                      CaptionML=ENU=Search Service Location;
                      Promoted=Yes;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF SearchServiceLocation() THEN
                                   CurrPage.UPDATE;
                               END;
                                }
      { 1100528605;2 ;Action    ;
                      CaptionML=ENU=Copy Service Call;
                      Image=Copy;
                      OnAction=VAR
                                 ServiceCall@1100528602 : Record 11012822;
                                 CopyServiceOrderCall@1100528601 : Codeunit 11012851;
                                 ServiceCallNo@1100528600 : Code[20];
                               BEGIN
                                 ServiceCallNo := CopyServiceOrderCall.CopyServiceCall("No.");
                                 COMMIT;
                                 ServiceCall.GET(ServiceCallNo);
                                 ServiceCall.ActivateServCallCard;
                               END;
                                }
      { 1100528500;2 ;Action    ;
                      CaptionML=ENU=Edit Date Or Time Service Call;
                      Visible=False;
                      Image=ChangeDate;
                      OnAction=VAR
                                 EditDateOrTimeServiceCall@1100525000 : Page 11127076;
                               BEGIN
                                 EditDateOrTimeServiceCall.SetReceivingDateAndTime("Receiving Date", "Receiving Time");
                                 EditDateOrTimeServiceCall.LOOKUPMODE(TRUE);
                                 IF EditDateOrTimeServiceCall.RUNMODAL = ACTION::LookupOK THEN
                                   IF (EditDateOrTimeServiceCall.GetReceivingDate <> "Receiving Date") OR (EditDateOrTimeServiceCall.GetReceivingTime <> "Receiving Time") THEN BEGIN
                                     "Receiving Date" := EditDateOrTimeServiceCall.GetReceivingDate;
                                     "Receiving Time" := EditDateOrTimeServiceCall.GetReceivingTime;
                                     MODIFY(TRUE);
                                   END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1210190000;1;Group  ;
                CaptionML=[ENU=General;
                           NOR=Generell;
                           SVE=AllmÑnt] }

    { 1210190001;2;Field  ;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;

                ShowMandatory=TRUE }

    { 1210190063;2;Field  ;
                SourceExpr="Calling Contact";
                Importance=Additional;
                ShowMandatory=CallingContactMandatory }

    { 1210190066;2;Field  ;
                SourceExpr="Calling Account";
                Importance=Additional;
                ShowMandatory=CallingAccountMandatory }

    { 1100485006;2;Field  ;
                SourceExpr="Calling Phone No.";
                Importance=Additional;
                ShowMandatory=CallingPhoneNoMandatory }

    { 1100528609;2;Field  ;
                SourceExpr=Description;
                ShowMandatory=TRUE }

    { 1100485037;2;Field  ;
                SourceExpr="Service Location No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             ServiceLocationNoOnAfterValida;
                             CurrPage.UPDATE;
                           END;

                OnLookup=BEGIN
                           LookupServiceLocation;
                           CurrPage.UPDATE;
                         END;

                ShowMandatory=TRUE }

    { 1100528625;2;Field  ;
                SourceExpr="Service Location Type";
                Importance=Additional;
                Visible=FALSE }

    { 1100528635;2;Field  ;
                SourceExpr="Service Location Struct. No.";
                Importance=Additional;
                Visible=FALSE }

    { 1100528636;2;Field  ;
                SourceExpr="Service Loc. Struct. Line No.";
                Importance=Additional;
                Visible=FALSE }

    { 1100528633;2;Field  ;
                SourceExpr="Tenant No.";
                Importance=Additional;
                Visible=FALSE }

    { 1210190005;2;Field  ;
                SourceExpr=Name;
                Importance=Promoted;
                OnValidate=BEGIN
                             NameOnAfterValidate;
                           END;

                ShowMandatory=NameMandatory }

    { 1100528616;2;Field  ;
                SourceExpr="Name 2";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=Name2Mandatory }

    { 1210190007;2;Field  ;
                SourceExpr=Address;
                OnValidate=BEGIN
                             AddressOnAfterValidate;
                           END;

                ShowMandatory=AddressMandatory }

    { 1100528617;2;Field  ;
                SourceExpr="Address 2";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=Address2Mandatory }

    { 1210190040;2;Field  ;
                SourceExpr="Post Code";
                OnValidate=BEGIN
                             PostCodeOnAfterValidate;
                           END;

                ShowMandatory=PostCodeMandatory }

    { 1210190009;2;Field  ;
                SourceExpr=City;
                OnValidate=BEGIN
                             CityOnAfterValidate;
                           END;

                ShowMandatory=CityMandatory }

    { 1100485020;2;Field  ;
                SourceExpr="Territory Code";
                Importance=Additional;
                OnValidate=BEGIN
                             TerritoryCodeOnAfterValidate;
                           END;

                ShowMandatory=TerritoryCodeMandatory }

    { 1100525023;2;Field  ;
                SourceExpr="Country/Region Code";
                Visible=FALSE;
                ShowMandatory=CountryRegionCodeMandatory }

    { 1210190004;2;Field  ;
                SourceExpr="Customer No.";
                OnValidate=BEGIN
                             CustomerNoOnAfterValidate;
                             CurrPage.UPDATE;
                           END;

                ShowMandatory=CustomerNoMandatory }

    { 1210190106;2;Field  ;
                SourceExpr="Customer Name" }

    { 1210190013;2;Field  ;
                SourceExpr="Contact Name";
                OnLookup=BEGIN
                           ShowContact("Customer No.", "Bill-to Customer No.");
                         END;

                ShowMandatory=ContactNameMandatory }

    { 1100285101;2;Field  ;
                SourceExpr="Contact No. Company" }

    { 1100285102;2;Field  ;
                SourceExpr="Contact Name Company" }

    { 1100528623;2;Field  ;
                SourceExpr="Room (SUP)";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=RoomSUPMandatory }

    { 1100528626;2;Field  ;
                CaptionML=[ENU=Room Description;
                           NOR=Rombeskrivelse;
                           SVE=Rumsbeskrivning];
                SourceExpr=GetRoomDescription;
                Importance=Additional;
                Visible=FALSE }

    { 1100528624;2;Field  ;
                SourceExpr="Part (SUP)";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=PartSUPMandatory }

    { 1100528627;2;Field  ;
                CaptionML=[ENU=Part Description;
                           NOR=Delbeskrivelse;
                           SVE=Delbeskrivning];
                SourceExpr=GetPartDescription;
                Importance=Additional;
                Visible=FALSE }

    { 1210190107;2;Field  ;
                SourceExpr="Object No.";
                OnValidate=BEGIN
                             ObjectNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           IF LookupServiceObjectNo THEN
                             CurrPage.UPDATE;
                         END;

                ShowMandatory=ObjectNoMandatory }

    { 1100525026;2;Field  ;
                SourceExpr="Object Description" }

    { 1100528919;2;Field  ;
                SourceExpr="Object Description 2";
                Visible=FALSE }

    { 1210190036;2;Field  ;
                SourceExpr="Your Reference";
                ShowMandatory=YourReferenceMandatory }

    { 1100485062;2;Field  ;
                SourceExpr="Order No. Customer";
                OnValidate=BEGIN
                             OrderNoCustomerOnAfterValidate;
                           END;

                ShowMandatory=OrderNoCustomerMandatory }

    { 1100525028;2;Field  ;
                SourceExpr="Commision Date";
                Importance=Additional }

    { 1100525002;2;Field  ;
                SourceExpr="Call Kind";
                ShowMandatory=CallKindMandatory }

    { 1100525004;2;Field  ;
                SourceExpr="Call Type";
                ShowMandatory=CallTypeMandatory }

    { 1100409002;2;Field  ;
                SourceExpr="Order Kind";
                ShowMandatory=OrderKindMandatory }

    { 1100409003;2;Field  ;
                SourceExpr="Order Type";
                ShowMandatory=OrderTypeMandatory }

    { 1210190017;2;Field  ;
                Lookup=No;
                SourceExpr=Priority;
                OnValidate=BEGIN
                             PriorityOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               AssistEditPriority;  //db, 16-04-07
                               CurrPage.UPDATE;  //db, 12-10-09: M16190
                             END;

                ShowMandatory=PriorityMandatory }

    { 1210190034;2;Field  ;
                SourceExpr=Status;
                Importance=Promoted }

    { 1100485078;2;Field  ;
                CaptionML=[ENU=No. of Contracts;
                           NOR=Antall kontrakter;
                           SVE=Antal kontrakt];
                SourceExpr=NumContract;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100485060;2;Field  ;
                SourceExpr="Service Contract No.";
                OnValidate=BEGIN
                             ServiceContractNoOnAfterValida;
                             CurrPage.UPDATE;
                           END;

                OnLookup=VAR
                           MaintenanceManagementCU@1100528602 : Codeunit 11012829;
                           ServiceContractNo@1100528603 : Code[20];
                         BEGIN
                           IF "Object No." = '' THEN
                             LookupServiceContract
                           ELSE BEGIN
                             ServiceContractNo := MaintenanceManagementCU.ShowActualContractsForObject("Object No.", "Customer No.", TODAY, TRUE, "Service Contract No.");
                             IF ServiceContractNo <> '' THEN
                               VALIDATE("Service Contract No.", ServiceContractNo);
                           END;
                           CurrPage.UPDATE;
                         END;

                ShowMandatory=ServiceContractNoMandatory }

    { 1100485079;2;Field  ;
                CaptionML=[ENU=No. of Dimensions;
                           NOR=Antall dimensjoner;
                           SVE=Antal dimensioner];
                SourceExpr=NumDim1;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100485057;2;Field  ;
                Lookup=No;
                SourceExpr="Global Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                               GlobalDimension1CodeOnAfterVal;
                           END;

                OnAssistEdit=BEGIN
                               AssistEditDimension1;  //db, 12-11-07
                               CurrPage.UPDATE;  //db,12-05-09: M14956
                             END;

                ShowMandatory=GlobalDimension1CodeMandatory }

    { 1100525024;2;Field  ;
                SourceExpr="Order Manager" }

    { 1100525022;2;Field  ;
                DrillDown=No;
                SourceExpr="Order Manager Name";
                Editable=FALSE }

    { 1210190038;2;Field  ;
                SourceExpr="Assigned to";
                OnValidate=BEGIN
                             AssignedtoOnAfterValidate;
                           END;

                ShowMandatory=AssignedtoMandatory }

    { 1210190105;2;Field  ;
                DrillDown=No;
                SourceExpr="Name Assigned to";
                Editable=FALSE }

    { 1100525027;2;Field  ;
                SourceExpr="Next Step";
                Importance=Additional;
                Visible=FALSE }

    { 1210190019;2;Field  ;
                SourceExpr=Problem;
                ShowMandatory=ProblemMandatory }

    { 1210190021;2;Field  ;
                SourceExpr="Customer Problem";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=CustomerProblemMandatory }

    { 1100525019;2;Field  ;
                CaptionML=[ENU=Building Code;
                           NOR=Bygningskode;
                           SVE=Byggnadskod];
                SourceExpr=BuildingCode;
                Visible=FALSE;
                Editable=FALSE;
                OnDrillDown=VAR
                              ServiceObject@1100525000 : Record 11071691;
                            BEGIN
                              IF ServiceObject.GET("Object No.") THEN
                                ServiceObject.ShowBuildingRelations;
                            END;
                             }

    { 1100525018;2;Field  ;
                CaptionML=[ENU=Building Description;
                           NOR=Beskrivelse Bygning;
                           SVE=Beskrivning Byggnad];
                SourceExpr=BuildingDescription;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100525025;2;Field  ;
                SourceExpr="Do not show on Service Portal";
                Visible=FALSE }

    { 1100528632;2;Field  ;
                SourceExpr=Origin;
                Importance=Additional;
                Visible=FALSE }

    { 1100528643;2;Field  ;
                SourceExpr="Process Structure Code";
                Importance=Additional }

    { 1100527350;2;Field  ;
                SourceExpr="Vessel No.";
                Visible=FALSE }

    { 1100527351;2;Field  ;
                SourceExpr="Vessel Name";
                Visible=FALSE }

    { 1100527352;2;Field  ;
                SourceExpr="Agent No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             IF NOT Agent.GET("Agent No.") THEN
                               Agent.INIT;
                           END;
                            }

    { 1100527355;2;Field  ;
                CaptionML=ENU=Agent Name;
                SourceExpr=Agent.Name;
                Visible=FALSE;
                Editable=FALSE }

    { 1100527353;2;Field  ;
                SourceExpr=Port;
                Visible=FALSE }

    { 1100527354;2;Field  ;
                SourceExpr="Quay Berth";
                Visible=FALSE }

    { 1100527359;2;Field  ;
                Name=ETA (Date);
                CaptionML=ENU=ETA (Date);
                SourceExpr="First Possible Starting Date";
                Visible=FALSE }

    { 1100527357;2;Field  ;
                Name=ETA (Time);
                CaptionML=ENU=ETA (Time);
                SourceExpr="First Possible Starting Time";
                Visible=FALSE }

    { 1100527360;2;Field  ;
                Name=ETD (Date);
                CaptionML=ENU=ETD (Date);
                SourceExpr="Last Possible Ending Date";
                Visible=FALSE }

    { 1100527358;2;Field  ;
                Name=ETD (Time);
                CaptionML=ENU=ETD (Time);
                SourceExpr="Last Possible Ending Time";
                Visible=FALSE }

    { 1100525001;1;Part   ;
                CaptionML=[ENU=Problem Text;
                           NOR=Problemtekst;
                           SVE=Problemtext];
                SubPageLink=Table Name=CONST(Service Call),
                            No.=FIELD(No.),
                            Table Field=CONST(60);
                PagePartID=Page11125227;
                PartType=Page }

    { 1100528603;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           NOR=Fakturering;
                           SVE=Fakturering];
                GroupType=Group }

    { 1100528604;2;Field  ;
                SourceExpr="Bill-to Customer No.";
                ShowMandatory=BilltoCustomerNoMandatory }

    { 1100528606;2;Field  ;
                SourceExpr="Alternative Bill-to Address";
                Visible=FALSE;
                ShowMandatory=AlternativeBilltoAddressMandatory }

    { 1100528608;2;Field  ;
                SourceExpr="Bill-to Name";
                ShowMandatory=BilltoNameMandatory }

    { 1100528610;2;Field  ;
                SourceExpr="Bill-to Name 2";
                Visible=FALSE;
                ShowMandatory=BilltoName2Mandatory }

    { 1100528611;2;Field  ;
                SourceExpr="Bill-to Address";
                ShowMandatory=BilltoAddressMandatory }

    { 1100528612;2;Field  ;
                SourceExpr="Bill-to Address 2";
                Visible=FALSE;
                ShowMandatory=BilltoAddress2Mandatory }

    { 1100528613;2;Field  ;
                SourceExpr="Bill-to Post Code";
                ShowMandatory=BilltoPostCodeMandatory }

    { 1100528614;2;Field  ;
                SourceExpr="Bill-to City";
                ShowMandatory=BilltoCityMandatory }

    { 1100528200;2;Field  ;
                SourceExpr="Master Company";
                Visible=FALSE }

    { 1100528628;2;Field  ;
                SourceExpr="Master Project";
                Visible=FALSE }

    { 1100528629;2;Field  ;
                SourceExpr="Master Element";
                Visible=FALSE }

    { 1100529601;2;Field  ;
                SourceExpr="Bill-to Contact Name";
                Visible=FALSE;
                OnLookup=BEGIN
                           ShowBillToContact("Bill-to Customer No.");
                         END;
                          }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Communication;
                           NOR=Kommunikasjon;
                           SVE=Kommunikation] }

    { 1100526200;2;Field  ;
                SourceExpr="Phone No.";
                ShowMandatory=PhoneNoMandatory }

    { 1100528618;2;Field  ;
                SourceExpr="Phone No. 2";
                Visible=FALSE;
                ShowMandatory=PhoneNo2Mandatory }

    { 1210190025;2;Field  ;
                SourceExpr="Mobile Phone No.";
                ShowMandatory=MobilePhoneNoMandatory }

    { 1210190097;2;Field  ;
                SourceExpr="E-Mail";
                Importance=Promoted;
                ShowMandatory=EMailMandatory }

    { 1100528601;2;Field  ;
                SourceExpr="Fax No.";
                Visible=FALSE;
                ShowMandatory=FaxNoMandatory }

    { 1100528300;2;Field  ;
                SourceExpr="Calling Account E-mail" }

    { 1100525008;1;Group  ;
                CaptionML=[ENU=Agreements;
                           NOR=Avtaler;
                           SVE=Avtal];
                Visible=FALSE;
                GroupType=Group }

    { 1100525010;2;Field  ;
                SourceExpr="Limit Budget Hours";
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ShowMandatory=LimitBudgetHoursMandatory }

    { 1100525009;2;Field  ;
                SourceExpr="Limit Budget Labor";
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ShowMandatory=LimitBudgetLaborMandatory }

    { 1100525011;2;Field  ;
                SourceExpr="Limit Budget Material";
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ShowMandatory=LimitBudgetMaterialMandatory }

    { 1100525013;2;Field  ;
                SourceExpr="Limit Budget Total";
                Importance=Promoted;
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ShowMandatory=LimitBudgetTotalMandatory }

    { 1100528631;2;Field  ;
                SourceExpr="Limit Budget Exceedance";
                Visible=FALSE }

    { 1901343701;1;Group  ;
                CaptionML=[ENU=Planning;
                           NOR=Planlegging;
                           SVE=Planering] }

    { 1100525012;2;Field  ;
                SourceExpr="Planning Agreement Code";
                Importance=Standard;
                ShowMandatory=PlanningAgreementCodeMandatory }

    { 1210190130;2;Field  ;
                SourceExpr="Expected Date";
                Importance=Additional;
                ShowMandatory=ExpectedDateMandatory }

    { 1210190131;2;Field  ;
                SourceExpr="Expected Time";
                Importance=Additional;
                ShowMandatory=ExpectedTimeMandatory }

    { 1210190132;2;Field  ;
                SourceExpr="Expected Hours";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ShowMandatory=ExpectedHoursMandatory }

    { 1100528602;2;Field  ;
                SourceExpr="Firm Planned" }

    { 1100485052;2;Field  ;
                SourceExpr="Preferred Employee No.";
                Visible=FALSE;
                ShowMandatory=PreferredEmployeeNoMandatory }

    { 1100485051;2;Field  ;
                DrillDown=No;
                SourceExpr="Preferred Employee Name";
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1210190024;2;Field  ;
                CaptionML=[ENU=No. of Watches;
                           NOR=Antall observasjoner;
                           SVE=Antal observationer];
                SourceExpr=NumWatch;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1210190031;2;Field  ;
                Lookup=No;
                SourceExpr=Watch;
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               AssistEditWatch(TRUE);  //db, 16-04-07
                             END;

                ShowMandatory=WatchMandatory }

    { 1210190032;2;Field  ;
                SourceExpr="Watch Description";
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1210190044;2;Field  ;
                SourceExpr="Employee No.";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ShowMandatory=EmployeeNoMandatory }

    { 1210190045;2;Field  ;
                DrillDown=No;
                SourceExpr="Employee Name";
                Importance=Promoted;
                Editable=FALSE }

    { 1100525020;2;Field  ;
                SourceExpr=Subcontractor;
                Visible=FALSE;
                ShowMandatory=SubcontractorMandatory }

    { 1100525021;2;Field  ;
                DrillDown=No;
                SourceExpr="Subcontractor Name";
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100409000;2;Field  ;
                Lookup=No;
                SourceExpr=Discipline;
                OnValidate=BEGIN
                             UpdateReferenceNorm;
                           END;

                OnAssistEdit=BEGIN
                               AssistEditDiscipline;
                               UpdateReferenceNorm;
                             END;

                ShowMandatory=DisciplineMandatory }

    { 1100409001;2;Field  ;
                Lookup=No;
                SourceExpr="Trade Speciality";
                Visible=FALSE;
                OnValidate=BEGIN
                             UpdateReferenceNorm;
                           END;

                OnAssistEdit=BEGIN
                               AssistEditTradeSpeciality;
                               UpdateReferenceNorm;
                             END;

                ShowMandatory=TradeSpecialityMandatory }

    { 1210190041;2;Field  ;
                SourceExpr="Plan during Clock Time" }

    { 1210190046;2;Field  ;
                SourceExpr="Export to FSA" }

    { 1100525017;2;Field  ;
                SourceExpr="Decentral Created";
                Visible=FALSE }

    { 1100409004;2;Field  ;
                SourceExpr="Publish on Subcontr. Portal";
                Visible=FALSE }

    { 1210190122;2;Field  ;
                SourceExpr="Receiving Date";
                ShowMandatory=ReceivingDateMandatory }

    { 1210190123;2;Field  ;
                Lookup=No;
                SourceExpr="Received by";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=ReceivedbyMandatory }

    { 1210190124;2;Field  ;
                SourceExpr="Modified on";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=ModifiedonMandatory }

    { 1210190126;2;Field  ;
                SourceExpr="Receiving Time";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=ReceivingTimeMandatory }

    { 1210190125;2;Field  ;
                Lookup=No;
                SourceExpr="Modified by";
                Importance=Additional;
                Visible=FALSE;
                ShowMandatory=ModifiedbyMandatory }

    { 1100528607;2;Field  ;
                SourceExpr="Actual Reference Point";
                OnDrillDown=BEGIN
                              DrillDownActualRefPoint;  //db, 29-09-08
                            END;
                             }

    { 1100529400;2;Field  ;
                SourceExpr="Actual Reference Point Desc" }

    { 1100525007;2;Field  ;
                SourceExpr="Remote Control";
                Visible=FALSE }

    { 1100525030;2;Field  ;
                SourceExpr="Service Cluster";
                Visible=FALSE }

    { 1100525029;2;Field  ;
                SourceExpr="Service Cluster Seqn.";
                Visible=FALSE }

    { 1100528637;2;Field  ;
                SourceExpr="First Possible Starting Date" }

    { 1100528638;2;Field  ;
                SourceExpr="Last Possible Ending Date" }

    { 1100529308;1;Group  ;
                Name=Plant;
                CaptionML=[ENU=Plant;
                           NOR=Maskin;
                           SVE=Maskin];
                Visible=FALSE;
                GroupType=Group }

    { 1100529600;2;Field  ;
                SourceExpr="Plant Company";
                Visible=FALSE }

    { 1100529305;2;Field  ;
                SourceExpr="Plant Location";
                Visible=FALSE;
                OnValidate=BEGIN
                             GetNoOfPlantLocationAddresses;
                             CurrPage.UPDATE(FALSE);
                           END;

                OnLookup=BEGIN
                           LookupPlantLocation;
                           GetNoOfPlantLocationAddresses;
                           CurrPage.UPDATE(FALSE);
                         END;

                ShowMandatory=PlantLocationMandatory }

    { 1100528801;2;Field  ;
                SourceExpr="Plant Location Description";
                Importance=Additional;
                Visible=FALSE }

    { 1100529306;2;Field  ;
                CaptionML=[ENU=No. of Alternative Addresses;
                           NOR=Antall alternative adresser;
                           SVE=Antal alternativa adresser];
                SourceExpr=PlantLocationAddresses;
                Visible=FALSE;
                Editable=FALSE }

    { 1100529303;2;Field  ;
                SourceExpr="Alternative Plant Loc Address";
                Visible=FALSE;
                ShowMandatory=AlternativePlantLocAddressMandatory }

    { 1100529304;2;Field  ;
                SourceExpr="Plant Type";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               LookupPlantInventory(1);
                               CurrPage.UPDATE;
                             END;

                ShowMandatory=PlantTypeMandatory }

    { 1100528802;2;Field  ;
                SourceExpr="Plant Type Description";
                Importance=Promoted;
                Visible=FALSE }

    { 1100529301;2;Field  ;
                SourceExpr="Plant Number";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               LookupPlantInventory(1);
                               CurrPage.UPDATE;
                             END;

                ShowMandatory=PlantNumberMandatory }

    { 1100528803;2;Field  ;
                SourceExpr="Plant Number Description";
                Importance=Promoted;
                Visible=FALSE }

    { 1100529302;2;Field  ;
                SourceExpr="Cost Component Plant";
                Visible=FALSE;
                ShowMandatory=CostComponentPlantMandatory }

    { 1100529000;2;Field  ;
                SourceExpr="Plant Part";
                Visible=FALSE }

    { 1100529001;2;Field  ;
                DrillDown=No;
                SourceExpr="Plant Part Description";
                Importance=Additional;
                Visible=FALSE }

    { 1100528640;1;Group  ;
                CaptionML=[ENU=Source;
                           NOR=Kilde;
                           SVE=KÑlla];
                Visible=false;
                GroupType=Group }

    { 1100528642;2;Field  ;
                CaptionML=[ENU=Try-Out;
                           NOR=Prospekt;
                           SVE=Anbud];
                SourceExpr=TryOutRelation;
                Editable=FALSE;
                OnLookup=VAR
                           TryoutSuccessor@1100528600 : Record 11012761;
                         BEGIN
                           TryoutSuccessor.ShowTryOut('', '', '', '', '', '', '', "No.", 1);
                         END;
                          }

    { 1100528641;2;Field  ;
                CaptionML=[ENU=Try-Out Quote;
                           NOR=Tilbudsforespõrsel;
                           SVE=AnbudsfîrfrÜgan];
                SourceExpr=TryOutQuoteRelation;
                Editable=FALSE;
                OnLookup=VAR
                           TryoutSuccessor@1100528600 : Record 11012761;
                         BEGIN
                           TryoutSuccessor.ShowTryOut('', '', '', '', '', '', '', "No.", 2);
                         END;
                          }

    { 1100530710;1;Group  ;
                CaptionML=ENU=Tenant;
                Visible=FALSE;
                GroupType=Group }

    { 1100530709;2;Field  ;
                SourceExpr="Tenant Name" }

    { 1100530708;2;Field  ;
                SourceExpr="Tenant Name 2" }

    { 1100530707;2;Field  ;
                SourceExpr="Tenant Phone" }

    { 1100530706;2;Field  ;
                SourceExpr="Tenant Phone 2" }

    { 1100530705;2;Field  ;
                SourceExpr="Tenant Mobile Phone" }

    { 1100530704;2;Field  ;
                SourceExpr="Tenant Mobile Phone 2" }

    { 1100530703;2;Field  ;
                SourceExpr="Tenant E-Mail" }

    { 1100530702;2;Field  ;
                SourceExpr="Tenant E-Mail 2" }

    { 1100530700;2;Field  ;
                SourceExpr="Tenant Phone Work" }

    { 1100530701;2;Field  ;
                SourceExpr="Tenant Phone Work 2" }

    { 1100525006;0;Container;
                ContainerType=FactBoxArea }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100525005;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130485;
                PartType=Page }

    { 1100525003;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130489;
                PartType=Page }

    { 1100528600;1;Part   ;
                Name=CallIntakeSignalsSF;
                CaptionML=[ENU=Signals;
                           NOR=Signaler;
                           SVE=Signaler];
                PagePartID=Page11126442;
                Visible=FALSE;
                PartType=Page }

    { 1100525000;1;Part   ;
                Name=ServiceOrderFlowSF;
                CaptionML=[ENU=Service Order Structure;
                           NOR=Serviceordrestruktur;
                           SVE=Serviceorderstruktur];
                SubPageLink=Call No.=FIELD(No.);
                PagePartID=Page11125263;
                Visible=FALSE;
                PartType=Page }

    { 1100528800;1;Part   ;
                Name=PurchaseLineServiceObjectFactbox;
                SubPageLink=Service Location No.=FIELD(Service Location No.),
                            Service Object No.=FIELD(Object No.);
                PagePartID=Page11229357;
                Visible=false;
                PartType=Page }

    { 1100528900;1;Part   ;
                Name=ServiceOrderPlantFB;
                SubPageLink=Plant Type=FIELD(Plant Type),
                            Plant Number=FIELD(Plant Number);
                PagePartID=Page11229360;
                Visible=FALSE;
                PartType=Page }

    { 1100529002;1;Part   ;
                Name=PlantMeterReadingFB;
                CaptionML=ENU=Plant Meter Readings;
                SubPageLink=Plant Type=FIELD(Plant Type),
                            Plant No.=FIELD(Plant Number);
                PagePartID=Page11129918;
                Visible=FALSE;
                PartType=Page }

    { 1100528630;1;Part   ;
                CaptionML=[ENU=Limit Budget Exceedance;
                           SVE=BudgetgrÑns, îverskridande];
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11126753;
                Visible=FALSE;
                PartType=Page }

    { 1100529902;1;Part   ;
                CaptionML=ENU=Service Location;
                SubPageLink=No.=FIELD(Service Location No.);
                PagePartID=Page11229398;
                Editable=FALSE;
                PartType=Page }

    { 1100528644;1;Part   ;
                CaptionML=ENU=Process Steps;
                SubPageLink=Type=CONST(Service Call),
                            Process Structure Code=FIELD(Process Structure Code),
                            Source No. Filter=FIELD(No.);
                PagePartID=Page11126790;
                PartType=Page }

    { 1100527356;1;Part   ;
                Name=<Vessel Service Call Vessel FB>;
                CaptionML=ENU=Vessels;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11229204;
                Visible=FALSE;
                PartType=Page }

    { 1100525016;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100525015;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ServOrderRec@1100485003 : Record 11012823;
      ServCallRec@1100485004 : Record 11012822;
      NextCall@1100485000 : Code[20];
      Text002@1100485005 : TextConst 'ENU=Call already transfered to Service Order. Continue ?;NOR=Samtale er allerede overfõrt til serviceordre. Fortsette?;SVE=Samtalet Ñr redan îverfîrt till en serviceorder. FortsÑtta?';
      Text003@1100485006 : TextConst 'ENU=Call has been cancelled;NOR=Samtalen har blitt avbrutt;SVE=Samtalet har avbrutits';
      BuildingCode@1100525001 : Code[20];
      TryOutRelation@1100528600 : Code[20];
      TryOutQuoteRelation@1100528601 : Code[20];
      NumWatch@1100485010 : Text[30];
      NumContract@1100485012 : Text[30];
      NumDim1@1100485013 : Text[30];
      BuildingDescription@1100525000 : Text[30];
      PlantLocationAddresses@1100529300 : Text[30];
      DPA_IsHardFilter@1100525002 : Boolean;
      CallingContactMandatory@1100528400 : Boolean;
      CallingAccountMandatory@1100528401 : Boolean;
      CallingPhoneNoMandatory@1100528402 : Boolean;
      NameMandatory@1100528403 : Boolean;
      Name2Mandatory@1100528404 : Boolean;
      AddressMandatory@1100528405 : Boolean;
      Address2Mandatory@1100528406 : Boolean;
      PostCodeMandatory@1100528407 : Boolean;
      CityMandatory@1100528408 : Boolean;
      TerritoryCodeMandatory@1100528409 : Boolean;
      CountryRegionCodeMandatory@1100528410 : Boolean;
      CustomerNoMandatory@1100528411 : Boolean;
      ContactNameMandatory@1100528412 : Boolean;
      ObjectNoMandatory@1100528413 : Boolean;
      YourReferenceMandatory@1100528414 : Boolean;
      OrderNoCustomerMandatory@1100528415 : Boolean;
      CallKindMandatory@1100528416 : Boolean;
      CallTypeMandatory@1100528417 : Boolean;
      OrderKindMandatory@1100528418 : Boolean;
      OrderTypeMandatory@1100528419 : Boolean;
      PriorityMandatory@1100528420 : Boolean;
      ServiceContractNoMandatory@1100528421 : Boolean;
      GlobalDimension1CodeMandatory@1100528422 : Boolean;
      AssignedtoMandatory@1100528423 : Boolean;
      ProblemMandatory@1100528424 : Boolean;
      CustomerProblemMandatory@1100528425 : Boolean;
      BilltoCustomerNoMandatory@1100528426 : Boolean;
      AlternativeBilltoAddressMandatory@1100528427 : Boolean;
      BilltoNameMandatory@1100528428 : Boolean;
      BilltoName2Mandatory@1100528429 : Boolean;
      BilltoAddressMandatory@1100528430 : Boolean;
      BilltoAddress2Mandatory@1100528431 : Boolean;
      BilltoPostCodeMandatory@1100528432 : Boolean;
      BilltoCityMandatory@1100528433 : Boolean;
      PhoneNoMandatory@1100528434 : Boolean;
      PhoneNo2Mandatory@1100528435 : Boolean;
      MobilePhoneNoMandatory@1100528436 : Boolean;
      EMailMandatory@1100528437 : Boolean;
      FaxNoMandatory@1100528438 : Boolean;
      LimitBudgetHoursMandatory@1100528439 : Boolean;
      LimitBudgetLaborMandatory@1100528440 : Boolean;
      LimitBudgetMaterialMandatory@1100528441 : Boolean;
      LimitBudgetTotalMandatory@1100528442 : Boolean;
      PlanningAgreementCodeMandatory@1100528443 : Boolean;
      ExpectedDateMandatory@1100528444 : Boolean;
      ExpectedTimeMandatory@1100528445 : Boolean;
      ExpectedHoursMandatory@1100528446 : Boolean;
      PreferredEmployeeNoMandatory@1100528447 : Boolean;
      WatchMandatory@1100528448 : Boolean;
      EmployeeNoMandatory@1100528449 : Boolean;
      SubcontractorMandatory@1100528450 : Boolean;
      DisciplineMandatory@1100528451 : Boolean;
      TradeSpecialityMandatory@1100528452 : Boolean;
      ReceivingDateMandatory@1100528453 : Boolean;
      ReceivedbyMandatory@1100528454 : Boolean;
      ModifiedonMandatory@1100528455 : Boolean;
      ReceivingTimeMandatory@1100528456 : Boolean;
      ModifiedbyMandatory@1100528457 : Boolean;
      PlantLocationMandatory@1100528458 : Boolean;
      AlternativePlantLocAddressMandatory@1100528459 : Boolean;
      PlantTypeMandatory@1100528460 : Boolean;
      PlantNumberMandatory@1100528461 : Boolean;
      CostComponentPlantMandatory@1100528462 : Boolean;
      RoomSUPMandatory@1100527000 : Boolean;
      PartSUPMandatory@1100527001 : Boolean;
      Text004@1100525003 : TextConst 'ENU=Can''t find location data with current address data.';
      ServiceSetup@1100525004 : Record 11012800;
      Agent@1100527350 : Record 11071952;
      Text005@1100285100 : TextConst 'ENU=Do you want to create Contact Company?;SVE=Vill du skapa en fîretagskontakt?';

    PROCEDURE GetHistory@1100485001(VAR ServCallRec@1100485000 : Record 11012822);
    VAR
      ServCallRec2@1100485001 : Record 11012822;
    BEGIN
      WITH ServCallRec DO BEGIN
        RESET;
        IF "Service Location No." <> '' THEN BEGIN
          ServCallRec2.SETCURRENTKEY("Service Location No.");
          ServCallRec2.SETRANGE("Service Location No.", "Service Location No.");
        END;
        IF PAGE.RUNMODAL(PAGE::"Service Call List", ServCallRec2) = ACTION::LookupOK THEN
          ServCallRec:= ServCallRec2;
      END;
    END;

    PROCEDURE GetOpenServiceOrder@1100485002(VAR ServCallRec@1100485000 : Record 11012822) : Code[20];
    VAR
      ServOrderRec@1100485001 : Record 11012823;
    BEGIN
      WITH ServCallRec DO BEGIN
        RESET;
        IF "Customer No." <> '' THEN
          ServOrderRec.SETRANGE("Customer No.", "Customer No.");
        IF "Service Contract No." <> '' THEN
          ServOrderRec.SETRANGE("Service Contract No.", "Service Contract No.");
        IF "Service Location No." <> '' THEN BEGIN
          ServOrderRec.SETCURRENTKEY("Service Location No.");
          ServOrderRec.SETRANGE("Service Location No.", "Service Location No.");
        END;
        IF PAGE.RUNMODAL(PAGE::"Service-Order List", ServOrderRec) = ACTION::LookupOK THEN
          EXIT(ServOrderRec."No.");
      END;

      EXIT('');
    END;

    PROCEDURE UpdateReferenceNorm@1100485003();
    VAR
      RefPeriodRec@1100485000 : Record 11020272;
    BEGIN
      CurrPage.UPDATE;
      RefPeriodRec.UpdateNorm(RefPeriodRec.Type::ServCall, "No.");
      GET("No.");  //db, 06-11-06: previous function updates maintable; avoid SQL-message
      CurrPage.UPDATE;  //db, 06-12-06: refresh flowfields (1e update niet weghalen)
    END;

    LOCAL PROCEDURE ShowConsignmentRoster@1100485005();
    VAR
      Consignment@1100485000 : Record 11012863;
    BEGIN
      IF Consignment.FINDSET(FALSE, FALSE) THEN
        REPEAT
          Consignment.MARK := Consignment.CheckTerritoryAndDepartment("Territory Code", "Global Dimension 1 Code");
        UNTIL Consignment.NEXT = 0;

      Consignment.MARKEDONLY := TRUE;

      PAGE.RUN(PAGE::Consignments, Consignment);
    END;

    PROCEDURE ShowDocuments@1100525000();
    VAR
      RecRef@1100525002 : RecordRef;
      DocumentFilters@1100525003 : Codeunit 11012432;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, TRUE);
    END;

    PROCEDURE StartServCalls@1100525001(lvAction@1100485000 : Integer;lvCount@1100485001 : Boolean) : Integer;
    VAR
      lvServCallRec@1100485002 : Record 11012822;
      lvServOrderRec@1100525000 : Record 11012823;
    BEGIN
      //db, 21-05-10
      lvServCallRec.SETFILTER("No.", '<>%1', "No.");
      CASE lvAction OF
        0:
          BEGIN
            lvServCallRec.SETCURRENTKEY("Service Contract No.");
            lvServCallRec.SETRANGE("Service Contract No.", "Service Contract No.");
            IF ("Service Contract No." = '') THEN EXIT(0);
          END;
        1:
          BEGIN
            lvServCallRec.SETCURRENTKEY("Service Location No.");
            lvServCallRec.SETRANGE("Service Location No.", "Service Location No.");
            IF ("Service Location No." = '') THEN EXIT(0);
          END;
        2:
          BEGIN
            lvServOrderRec.SETCURRENTKEY("Call No.");
            lvServOrderRec.SETRANGE("Call No.", "No.");
            IF lvCount = FALSE THEN BEGIN
              PAGE.RUNMODAL(0, lvServOrderRec);
              EXIT;
            END ELSE BEGIN
              IF "Service Order No." = '' THEN
                EXIT(0)
              ELSE
                EXIT(lvServOrderRec.COUNT);
            END;
          END;
        3:
          BEGIN
            lvServCallRec.SETCURRENTKEY("Customer No.");
            lvServCallRec.SETRANGE("Customer No.", "Customer No.");
            IF ("Customer No." = '') THEN EXIT(0);
          END;
        4:
          BEGIN
            lvServCallRec.SETCURRENTKEY("Object No.");
            lvServCallRec.SETRANGE("Object No.", "Object No.");
            IF ("Object No." = '') THEN EXIT(0);
          END;
      END;

      IF NOT lvCount = FALSE THEN
        PAGE.RUNMODAL(0, lvServCallRec)
      ELSE
        EXIT(lvServCallRec.COUNT);
    END;

    PROCEDURE GetNoOfServCalls@1100525002(lvAction@1100485001 : Integer) NumServCall : Integer;
    BEGIN
      NumServCall := StartServCalls(lvAction, TRUE);
      EXIT(NumServCall);
    END;

    PROCEDURE GetInfo@1100525003() : Integer;
    VAR
      RecRef@1100525000 : RecordRef;
      DocumentLinkMgt@1100525001 : Codeunit 11012401;
    BEGIN
      RecRef.GETTABLE(Rec);

      EXIT(DocumentLinkMgt.GetInfo(RecRef));
    END;

    LOCAL PROCEDURE PriorityOnAfterValidate@19076862();
    BEGIN
      UpdateReferenceNorm;
    END;

    LOCAL PROCEDURE GlobalDimension1CodeOnAfterVal@19079612();
    BEGIN
      CurrPage.UPDATE;  //db,12-05-09: M14956
    END;

    LOCAL PROCEDURE ServiceLocationNoOnAfterValida@19019562();
    BEGIN
      CALCFIELDS("Service Location Description", "Remote Control");
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ServiceContractNoOnAfterValida@19025091();
    BEGIN
      CALCFIELDS("Service Contract Description");
      UpdateReferenceNorm;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CustomerNoOnAfterValidate@19016267();
    BEGIN
      CALCFIELDS("Customer Name");
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ObjectNoOnAfterValidate@19042349();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE NameOnAfterValidate@19065884();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE AddressOnAfterValidate@19060866();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PostCodeOnAfterValidate@19007075();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE TerritoryCodeOnAfterValidate@19066893();
    BEGIN
      CurrPage.UPDATE;  //db,12-05-09: M14956
    END;

    LOCAL PROCEDURE CityOnAfterValidate@19023525();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OrderNoCustomerOnAfterValidate@19028010();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE AssignedtoOnAfterValidate@19050262();
    BEGIN
      CALCFIELDS("Name Assigned to");
    END;

    PROCEDURE UpdateSignalRulesSF@1100528600();
    BEGIN
      CurrPage.CallIntakeSignalsSF.PAGE.UpdateRulesList(0, "No.", '', '', FALSE);
    END;

    LOCAL PROCEDURE FillShowMandatoryVariables@1100528402();
    BEGIN
      CallingContactMandatory := FieldInCompletionControl(FIELDNO("Calling Contact"));
      CallingAccountMandatory := FieldInCompletionControl(FIELDNO("Calling Account"));
      CallingPhoneNoMandatory := FieldInCompletionControl(FIELDNO("Calling Phone No."));
      NameMandatory := FieldInCompletionControl(FIELDNO(Name));
      Name2Mandatory := FieldInCompletionControl(FIELDNO("Name 2"));
      AddressMandatory := FieldInCompletionControl(FIELDNO(Address));
      Address2Mandatory := FieldInCompletionControl(FIELDNO("Address 2"));
      PostCodeMandatory := FieldInCompletionControl(FIELDNO("Post Code"));
      CityMandatory := FieldInCompletionControl(FIELDNO(City));
      TerritoryCodeMandatory := FieldInCompletionControl(FIELDNO("Territory Code"));
      CountryRegionCodeMandatory := FieldInCompletionControl(FIELDNO("Country/Region Code"));
      CustomerNoMandatory := FieldInCompletionControl(FIELDNO("Customer No."));
      ContactNameMandatory := FieldInCompletionControl(FIELDNO("Contact Name"));
      ObjectNoMandatory := FieldInCompletionControl(FIELDNO("Object No."));
      YourReferenceMandatory := FieldInCompletionControl(FIELDNO("Your Reference"));
      OrderNoCustomerMandatory := FieldInCompletionControl(FIELDNO("Order No. Customer"));
      CallKindMandatory := FieldInCompletionControl(FIELDNO("Call Kind"));
      CallTypeMandatory := FieldInCompletionControl(FIELDNO("Call Type"));
      OrderKindMandatory := FieldInCompletionControl(FIELDNO("Order Kind"));
      OrderTypeMandatory := FieldInCompletionControl(FIELDNO("Order Type"));
      PriorityMandatory := FieldInCompletionControl(FIELDNO(Priority));
      ServiceContractNoMandatory := FieldInCompletionControl(FIELDNO("Service Contract No."));
      GlobalDimension1CodeMandatory := FieldInCompletionControl(FIELDNO("Global Dimension 1 Code"));
      AssignedtoMandatory := FieldInCompletionControl(FIELDNO("Assigned to"));
      ProblemMandatory := FieldInCompletionControl(FIELDNO(Problem));
      CustomerProblemMandatory := FieldInCompletionControl(FIELDNO("Customer Problem"));
      BilltoCustomerNoMandatory := FieldInCompletionControl(FIELDNO("Bill-to Customer No."));
      AlternativeBilltoAddressMandatory := FieldInCompletionControl(FIELDNO("Alternative Bill-to Address"));
      BilltoNameMandatory := FieldInCompletionControl(FIELDNO("Bill-to Name"));
      BilltoName2Mandatory := FieldInCompletionControl(FIELDNO("Bill-to Name 2"));
      BilltoAddressMandatory := FieldInCompletionControl(FIELDNO("Bill-to Address"));
      BilltoAddress2Mandatory := FieldInCompletionControl(FIELDNO("Bill-to Address 2"));
      BilltoPostCodeMandatory := FieldInCompletionControl(FIELDNO("Bill-to Post Code"));
      BilltoCityMandatory := FieldInCompletionControl(FIELDNO("Bill-to City"));
      PhoneNoMandatory := FieldInCompletionControl(FIELDNO("Phone No."));
      PhoneNo2Mandatory := FieldInCompletionControl(FIELDNO("Phone No. 2"));
      MobilePhoneNoMandatory := FieldInCompletionControl(FIELDNO("Mobile Phone No."));
      EMailMandatory := FieldInCompletionControl(FIELDNO("E-Mail"));
      FaxNoMandatory := FieldInCompletionControl(FIELDNO("Fax No."));
      LimitBudgetHoursMandatory := FieldInCompletionControl(FIELDNO("Limit Budget Hours"));
      LimitBudgetLaborMandatory := FieldInCompletionControl(FIELDNO("Limit Budget Labor"));
      LimitBudgetMaterialMandatory := FieldInCompletionControl(FIELDNO("Limit Budget Material"));
      LimitBudgetTotalMandatory := FieldInCompletionControl(FIELDNO("Limit Budget Total"));
      PlanningAgreementCodeMandatory := FieldInCompletionControl(FIELDNO("Planning Agreement Code"));
      ExpectedDateMandatory := FieldInCompletionControl(FIELDNO("Expected Date"));
      ExpectedTimeMandatory := FieldInCompletionControl(FIELDNO("Expected Time"));
      ExpectedHoursMandatory := FieldInCompletionControl(FIELDNO("Expected Hours"));
      PreferredEmployeeNoMandatory := FieldInCompletionControl(FIELDNO("Preferred Employee No."));
      WatchMandatory := FieldInCompletionControl(FIELDNO(Watch));
      EmployeeNoMandatory := FieldInCompletionControl(FIELDNO("Employee No."));
      SubcontractorMandatory := FieldInCompletionControl(FIELDNO(Subcontractor));
      DisciplineMandatory := FieldInCompletionControl(FIELDNO(Discipline));
      TradeSpecialityMandatory := FieldInCompletionControl(FIELDNO("Trade Speciality"));
      ReceivingDateMandatory := FieldInCompletionControl(FIELDNO("Receiving Date"));
      ReceivedbyMandatory := FieldInCompletionControl(FIELDNO("Received by"));
      ModifiedonMandatory := FieldInCompletionControl(FIELDNO("Modified on"));
      ReceivingTimeMandatory := FieldInCompletionControl(FIELDNO("Receiving Time"));
      ModifiedbyMandatory := FieldInCompletionControl(FIELDNO("Modified by"));
      PlantLocationMandatory := FieldInCompletionControl(FIELDNO("Plant Location"));
      AlternativePlantLocAddressMandatory := FieldInCompletionControl(FIELDNO("Alternative Plant Loc Address"));
      PlantTypeMandatory := FieldInCompletionControl(FIELDNO("Plant Type"));
      PlantNumberMandatory := FieldInCompletionControl(FIELDNO("Plant Number"));
      CostComponentPlantMandatory := FieldInCompletionControl(FIELDNO("Cost Component Plant"));
      RoomSUPMandatory := FieldInCompletionControl(FIELDNO("Room (SUP)"));
      PartSUPMandatory := FieldInCompletionControl(FIELDNO("Part (SUP)"));
    END;

    LOCAL PROCEDURE FieldInCompletionControl@1100528400(FieldNo@1100528400 : Integer) : Boolean;
    VAR
      ExtendedFieldProperty@1100528402 : Record 11020567;
      TableNo@1100528401 : Integer;
    BEGIN
      TableNo := DATABASE::"Service Call";
      EXIT(ExtendedFieldProperty.FieldInCompletionControl(TableNo, FieldNo));
    END;

    LOCAL PROCEDURE GetNoOfPlantLocationAddresses@1100529600();
    VAR
      PlantLocationAddress@1100529600 : Record 11012590;
    BEGIN
      PlantLocationAddresses := '';
      IF "Plant Location" <> '' THEN BEGIN
        PlantLocationAddress.CHANGECOMPANY("Plant Company");
        PlantLocationAddress.SETRANGE(Location, "Plant Location");
        PlantLocationAddresses := '[' + FORMAT(PlantLocationAddress.COUNT) + ']';
      END;
    END;

    BEGIN
    {
      200512 ORANGO.EE New fields and action CreateContactCompany
    }
    END.
  }
}

