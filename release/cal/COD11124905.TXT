OBJECT Codeunit 11124905 Resource Planning View Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1100525000 : TextConst 'ENU=Resource Groups Discipline';
      Text002@1100525001 : TextConst 'ENU=Resouce Groups Plant';
      Text003@1100525002 : TextConst 'ENU=Resources Discipline';
      Text004@1100525003 : TextConst 'ENU=Resources Plant Type';
      Text005@1100525004 : TextConst 'ENU=Linked Resources;SVE=L„nkade Resurser';
      Text006@1100525005 : TextConst 'ENU=Resources;SVE=Resurser';
      Text007@1100525006 : TextConst 'ENU=Resources Employee';
      Text008@1100525007 : TextConst 'ENU=Resources Subcontractor';
      Text009@1100525008 : TextConst 'ENU=Resources Plant';
      Text010@1100525009 : TextConst 'ENU=Classic View';

    [External]
    PROCEDURE InitViews@1100525000();
    VAR
      ResourcePlanningView@1100525000 : Record 11124916;
    BEGIN
      ResourcePlanningView.SETRANGE("User ID", USERID);
      IF NOT ResourcePlanningView.FINDFIRST THEN
        ValidateClassicView
      ELSE BEGIN
        ValidateResourceGroupsDiscipline;
        ValidateResourceGroupsPlant;
        ValidateResourcesDiscipline;
        ValidateResourcesPlantType;
        ValidateResourcesLinkedResources;
        ValidateResourcesDepartment;
        ValidateResourcesEmployee;
        ValidateResourcesSubcontractor;
        ValidateResourcesPlant;
      END;
    END;

    [External]
    PROCEDURE InitView@1100525002(SetCode@1100525000 : Code[20]);
    BEGIN
      CASE SetCode OF
        'RE-GRP-DIS':
          ValidateResourceGroupsDiscipline;
        'RE-GRP-PLA':
          ValidateResourceGroupsPlant;
        'RE-DIS':
          ValidateResourcesDiscipline;
        'RE-PLANTYP':
          ValidateResourcesPlantType;
        'RE-LINK':
          ValidateResourcesLinkedResources;
        'RE-DEP':
          ValidateResourcesDepartment;
        'RE-EMPL':
          ValidateResourcesEmployee;
        'RE-SUBCON':
          ValidateResourcesSubcontractor;
        'RE-PLANT':
          ValidateResourcesPlant;
        ELSE
          ;
      END;
    END;

    LOCAL PROCEDURE ValidateClassicView@1100525004();
    VAR
      ResourcePlanningView@1100525003 : Record 11124916;
      ResourcePlanningViewLine@1100525001 : Record 11124917;
    BEGIN
      ValidateResourceGroupsDiscipline;
      ValidateResourceGroupsPlant;
      ValidateResourcesDiscipline;
      ValidateResourcesPlantType;
      ValidateResourcesLinkedResources;
      ValidateResourcesDepartment;
      ValidateResourcesEmployee;
      ValidateResourcesSubcontractor;
      ValidateResourcesPlant;

      IF NOT ResourcePlanningView.GET(USERID, 'CLASSIC') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'CLASSIC';
        ResourcePlanningView.Description := Text010;
        ResourcePlanningView."Visable in GRP" := TRUE;
        ResourcePlanningView.INSERT(TRUE);

        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'CLASSIC';
        ResourcePlanningViewLine."No." := 'RE-PLANT';
        ResourcePlanningViewLine.Description := Text009;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::ResourceView;
        ResourcePlanningViewLine.INSERT(TRUE);

        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'CLASSIC';
        ResourcePlanningViewLine."No." := 'RE-EMPL';
        ResourcePlanningViewLine.Description := Text007;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::ResourceView;
        ResourcePlanningViewLine.INSERT(TRUE);

        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'CLASSIC';
        ResourcePlanningViewLine."No." := 'RE-SUBCON';
        ResourcePlanningViewLine.Description := Text008;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::ResourceView;
        ResourcePlanningViewLine.INSERT(TRUE);

        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'CLASSIC';
        ResourcePlanningViewLine."No." := 'RE-GRP-DIS';
        ResourcePlanningViewLine.Description := Text001;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::ResourceView;
        ResourcePlanningViewLine.INSERT(TRUE);

        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'CLASSIC';
        ResourcePlanningViewLine."No." := 'RE-GRP-PLA';
        ResourcePlanningViewLine.Description := Text002;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::ResourceView;
        ResourcePlanningViewLine.INSERT(TRUE);

        COMMIT;
      END;
    END;

    LOCAL PROCEDURE ValidateResourceGroupsDiscipline@1100525003();
    VAR
      ResourcePlanningView@1100525005 : Record 11124916;
      ResourceGroupWOP@1100525003 : Record 11229384;
      ResourcePlanningViewLine@1100525001 : Record 11124917;
      GenericTempTable1@1100525000 : TEMPORARY Record 11020579;
      GroupLine@1100525002 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-GRP-DIS') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-GRP-DIS';
        ResourcePlanningView.Description := Text001;
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      GenericTempTable1.RESET;
      GenericTempTable1.DELETEALL;

      ResourceGroupWOP.SetCompanyPlanGroupFilters;
      ResourceGroupWOP.SETFILTER("User ID Filter", USERID);
      ResourceGroupWOP.SETFILTER("Company Filter", COMPANYNAME);
      ResourceGroupWOP.SETRANGE("Visible in GRP", TRUE);
      ResourceGroupWOP.SETRANGE(Type, ResourceGroupWOP.Type::Discipline);
      IF ResourceGroupWOP.FINDSET THEN BEGIN
        REPEAT
          GenericTempTable1."Key Code1" := ResourceGroupWOP."No.";
          GenericTempTable1.Text1 := ResourceGroupWOP.Name;
          GenericTempTable1.INSERT;
        UNTIL ResourceGroupWOP.NEXT = 0;
      END ELSE BEGIN
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-DIS');
        ResourcePlanningViewLine.SETFILTER("No.", '<>%1', 'RE-GRP-DIS');
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
        EXIT;
      END;

      // check group
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-DIS');
      ResourcePlanningViewLine.SETRANGE("No.", 'RE-GRP-DIS');
      IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'RE-GRP-DIS';
        ResourcePlanningViewLine."No." := 'RE-GRP-DIS';
        ResourcePlanningViewLine.Description := Text001;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
        ResourcePlanningViewLine.INSERT(TRUE);
      END;
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-DIS');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      ResourcePlanningViewLine.SETFILTER("No.", '<>%1', 'RE-GRP-DIS');
      IF ResourcePlanningViewLine.FINDSET THEN
        ResourcePlanningViewLine.DELETEALL;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-DIS');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-DIS');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check deleted resourcegroups
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-DIS');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::ResourceGroup);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN
            GenericTempTable1.DELETE
          ELSE
            ResourcePlanningViewLine.DELETE;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      // check new resourcegroups
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-DIS');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-GRP-DIS';
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := GenericTempTable1.Text1;
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::ResourceGroup;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    LOCAL PROCEDURE ValidateResourceGroupsPlant@1100525005();
    VAR
      ResourcePlanningView@1100525005 : Record 11124916;
      ResourceGroupWOP@1100525003 : Record 11229384;
      ResourcePlanningViewLine@1100525001 : Record 11124917;
      GenericTempTable1@1100525000 : TEMPORARY Record 11020579;
      GroupLine@1100525002 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-GRP-PLA') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-GRP-PLA';
        ResourcePlanningView.Description := Text002;
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      GenericTempTable1.RESET;
      GenericTempTable1.DELETEALL;

      ResourceGroupWOP.SetCompanyPlanGroupFilters;
      ResourceGroupWOP.SETFILTER("User ID Filter", USERID);
      ResourceGroupWOP.SETFILTER("Company Filter", COMPANYNAME);
      ResourceGroupWOP.SETRANGE("Visible in GRP", TRUE);
      ResourceGroupWOP.SETRANGE(Type, ResourceGroupWOP.Type::Plant);
      IF ResourceGroupWOP.FINDSET THEN BEGIN
        REPEAT
          GenericTempTable1."Key Code1" := ResourceGroupWOP."No.";
          GenericTempTable1.Text1 := ResourceGroupWOP.Name;
          GenericTempTable1.INSERT;
        UNTIL ResourceGroupWOP.NEXT = 0;
      END ELSE BEGIN
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-PLA');
        ResourcePlanningViewLine.SETFILTER("No.", '<>%1', 'RE-GRP-PLA');
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
        EXIT;
      END;

      // check group
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-PLA');
      ResourcePlanningViewLine.SETRANGE("No.", 'RE-GRP-PLA');
      IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'RE-GRP-PLA';
        ResourcePlanningViewLine."No." := 'RE-GRP-PLA';
        ResourcePlanningViewLine.Description := Text002;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
        ResourcePlanningViewLine.INSERT(TRUE);
      END;
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-PLA');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      ResourcePlanningViewLine.SETFILTER("No.", '<>%1', 'RE-GRP-PLA');
      IF ResourcePlanningViewLine.FINDSET THEN
        ResourcePlanningViewLine.DELETEALL;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-PLA');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-PLA');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check deleted resourcegroups
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-PLA');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::ResourceGroup);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN
            GenericTempTable1.DELETE
          ELSE
            ResourcePlanningViewLine.DELETE;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      // check new resourcegroups
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-GRP-PLA');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-GRP-PLA';
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := GenericTempTable1.Text1;
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::ResourceGroup;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    LOCAL PROCEDURE ValidateResourcesDiscipline@1100525001();
    VAR
      ResourcePlanningView@1100525005 : Record 11124916;
      ResourceWOP@1100525003 : Record 11229278;
      ResourceDiscipline@1100525002 : Record 11229286;
      ResourcePlanningViewLine@1100525001 : Record 11124917;
      ResourcePlanningViewLine2@1100525008 : Record 11124917;
      GenericTempTable1@1100525000 : TEMPORARY Record 11020579;
      GenericTempTable2@1100525004 : TEMPORARY Record 11020579;
      GroupLine@1100525006 : Integer;
      NextGroupLine@1100525007 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-DIS') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-DIS';
        ResourcePlanningView.Description := Text003;
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      ResourceDiscipline.SETAUTOCALCFIELDS("Discipline Description", "Resource Name");
      IF ResourceDiscipline.FINDSET THEN BEGIN
        REPEAT
          ResourceWOP.SetCompanyPlanGroupFilters;
          ResourceWOP.SETFILTER("User ID Filter", USERID);
          ResourceWOP.SETRANGE("Visible in GRP", TRUE);
          ResourceWOP.SETRANGE("No.", ResourceDiscipline."Resource No.");
          IF ResourceWOP.FINDFIRST THEN BEGIN
            IF NOT GenericTempTable1.GET('RE-DIS' + ResourceDiscipline.Discipline) THEN BEGIN
              GenericTempTable1."Key Code1" := 'RE-DIS' + ResourceDiscipline.Discipline;
              GenericTempTable1.Code1 := ResourceDiscipline.Discipline;
              GenericTempTable1.Text1 := ResourceDiscipline."Discipline Description";
              GenericTempTable1.INSERT;
            END;
            GenericTempTable2."Key Code1" := ResourceDiscipline.Discipline;
            GenericTempTable2."Key Code2" := ResourceDiscipline."Resource No.";
            GenericTempTable2.Text1 := ResourceDiscipline."Resource Name";
            GenericTempTable2.INSERT;
          END;
        UNTIL ResourceDiscipline.NEXT = 0;
      END;

      // check new groups
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-DIS';
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := ResourceDiscipline.FIELDCAPTION(Discipline) + ' ' + GenericTempTable1.Code1 + ' - ' + GenericTempTable1.Text1;
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END ELSE BEGIN
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
        EXIT;
      END;

      // check deleted groups
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF NOT GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN BEGIN
            //delete all resources in this group >>
            GroupLine := ResourcePlanningViewLine."Line No.";
            ResourcePlanningViewLine2.COPY(ResourcePlanningViewLine);
            IF ResourcePlanningViewLine2.NEXT = 1 THEN
              NextGroupLine := ResourcePlanningViewLine2."Line No."
            ELSE
              NextGroupLine := 9999;

            ResourcePlanningViewLine.DELETE;

            ResourcePlanningViewLine2.RESET;
            ResourcePlanningViewLine2.SETCURRENTKEY("User ID",Code,"Line No.");
            ResourcePlanningViewLine2.SETRANGE("User ID", USERID);
            ResourcePlanningViewLine2.SETRANGE(Code, 'RE-LINK');
            ResourcePlanningViewLine2.SETFILTER("Line No.", '>%1&<%2', GroupLine, NextGroupLine);
            ResourcePlanningViewLine2.DELETEALL(TRUE);
            //delete all resources in this group <<

          END;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check resources
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF ResourcePlanningViewLine.FINDFIRST THEN
            GroupLine := ResourcePlanningViewLine."Line No.";
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
          ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
          ResourcePlanningViewLine.SETFILTER("Line No.", '>%1', GroupLine);
          IF ResourcePlanningViewLine.FINDFIRST THEN
            NextGroupLine := ResourcePlanningViewLine."Line No."
          ELSE
            NextGroupLine := 9999;

          // check deleted resources
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
          ResourcePlanningViewLine.SETFILTER("Line No.", '>%1 & <%2', GroupLine, NextGroupLine);
          IF ResourcePlanningViewLine.FINDSET THEN BEGIN
            REPEAT
              IF GenericTempTable2.GET(GenericTempTable1."Key Code1", ResourcePlanningViewLine."No.") THEN
                GenericTempTable2.DELETE
              ELSE
                ResourcePlanningViewLine.DELETE;
            UNTIL ResourcePlanningViewLine.NEXT = 0;
          END;

          // check new resources
          GenericTempTable2.RESET;
          GenericTempTable2.SETRANGE("Key Code1", GenericTempTable1.Code1);
          IF GenericTempTable2.FINDSET THEN BEGIN
            REPEAT
              ResourcePlanningViewLine.RESET;
              ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
              ResourcePlanningViewLine.SETRANGE("User ID", USERID);
              ResourcePlanningViewLine.SETRANGE(Code, 'RE-DIS');
              ResourcePlanningViewLine.SETFILTER("Line No.", '>%1 & <%2', GroupLine, NextGroupLine);
              ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable2."Key Code2");
              IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
                ResourcePlanningViewLine.INIT;
                ResourcePlanningViewLine."User ID" := USERID;
                ResourcePlanningViewLine.Code := 'RE-DIS';
                ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Resource;
                ResourcePlanningViewLine."No." := GenericTempTable2."Key Code2";
                ResourcePlanningViewLine.Description := GenericTempTable2.Text1;
                ResourcePlanningViewLine.INSERT(TRUE);
                IF NextGroupLine < 9999 THEN BEGIN
                  ResourcePlanningViewLine.MoveUp(NextGroupLine);
                  NextGroupLine += 1;
                END;
              END;
            UNTIL GenericTempTable2.NEXT = 0;
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    LOCAL PROCEDURE ValidateResourcesPlantType@1100525006();
    VAR
      ResourcePlanningView@1100525005 : Record 11124916;
      ResourceWOP@1100525003 : Record 11229278;
      ResourcePlanningViewLine@1100525001 : Record 11124917;
      PlantType@1100525002 : Record 11012551;
      GenericTempTable1@1100525000 : TEMPORARY Record 11020579;
      GenericTempTable2@1100525004 : TEMPORARY Record 11020579;
      GroupLine@1100525006 : Integer;
      NextGroupLine@1100525007 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-PLANTYP') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-PLANTYP';
        ResourcePlanningView.Description := Text004;
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      GenericTempTable1.RESET;
      GenericTempTable1.DELETEALL;
      GenericTempTable2.RESET;
      GenericTempTable2.DELETEALL;

      ResourceWOP.SetCompanyPlanGroupFilters;
      ResourceWOP.SETFILTER("User ID Filter", USERID);
      ResourceWOP.SETRANGE("Visible in GRP", TRUE);
      ResourceWOP.SETRANGE(Type, ResourceWOP.Type::Plant);
      IF ResourceWOP.FINDSET THEN BEGIN
        REPEAT
          PlantType.CHANGECOMPANY(ResourceWOP.Company);
          IF PlantType.GET(ResourceWOP."Source No.") THEN BEGIN
            IF NOT GenericTempTable1.GET('RE-PLANTYP' + ResourceWOP."Source No.") THEN BEGIN
              GenericTempTable1."Key Code1" := 'RE-PLANTYP' + ResourceWOP."Source No.";
              GenericTempTable1.Code1 := ResourceWOP."Source No.";
              GenericTempTable1.Text1 := PlantType.Description;
              GenericTempTable1.INSERT;
            END;
            GenericTempTable2."Key Code1" := ResourceWOP."Source No.";
            GenericTempTable2."Key Code2" := ResourceWOP."No.";
            GenericTempTable2.Text1 := ResourceWOP.Name;
            GenericTempTable2.INSERT;
          END;
        UNTIL ResourceWOP.NEXT = 0;
      END;


      // check new groups
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-PLANTYP';
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := PlantType.TABLECAPTION + ' ' + GenericTempTable1.Code1 + ' - ' + GenericTempTable1.Text1;
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END ELSE BEGIN
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
        EXIT;
      END;

      // check deleted groups
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF NOT GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN
            ResourcePlanningViewLine.DELETE;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check resources
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF ResourcePlanningViewLine.FINDFIRST THEN
            GroupLine := ResourcePlanningViewLine."Line No.";
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
          ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
          ResourcePlanningViewLine.SETFILTER("Line No.", '>%1', GroupLine);
          IF ResourcePlanningViewLine.FINDFIRST THEN
            NextGroupLine := ResourcePlanningViewLine."Line No."
          ELSE
            NextGroupLine := 9999;

          // check deleted resources
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
          ResourcePlanningViewLine.SETFILTER("Line No.", '>%1 & <%2', GroupLine, NextGroupLine);
          IF ResourcePlanningViewLine.FINDSET THEN BEGIN
            REPEAT
              IF GenericTempTable2.GET(GenericTempTable1.Code1, ResourcePlanningViewLine."No.") THEN
                GenericTempTable2.DELETE
              ELSE
                ResourcePlanningViewLine.DELETE;
            UNTIL ResourcePlanningViewLine.NEXT = 0;
          END;

          // check new resources
          GenericTempTable2.RESET;
          GenericTempTable2.SETRANGE("Key Code1", GenericTempTable1.Code1);
          IF GenericTempTable2.FINDSET THEN BEGIN
            REPEAT
              ResourcePlanningViewLine.RESET;
              ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
              ResourcePlanningViewLine.SETRANGE("User ID", USERID);
              ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANTYP');
              ResourcePlanningViewLine.SETFILTER("Line No.", '>%1 & <%2', GroupLine, NextGroupLine);
              ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable2."Key Code2");
              IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
                ResourcePlanningViewLine.INIT;
                ResourcePlanningViewLine."User ID" := USERID;
                ResourcePlanningViewLine.Code := 'RE-PLANTYP';
                ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Resource;
                ResourcePlanningViewLine."No." := GenericTempTable2."Key Code2";
                ResourcePlanningViewLine.Description := GenericTempTable2.Text1;
                ResourcePlanningViewLine.INSERT(TRUE);
                IF NextGroupLine < 9999 THEN BEGIN
                  ResourcePlanningViewLine.MoveUp(NextGroupLine);
                  NextGroupLine += 1;
                END;
              END;
            UNTIL GenericTempTable2.NEXT = 0;
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    LOCAL PROCEDURE ValidateResourcesLinkedResources@1100525007();
    VAR
      ResourcePlanningView@1100525005 : Record 11124916;
      ResourceWOP@1100525003 : Record 11229278;
      LinkedResource@1100525002 : Record 11229324;
      ResourcePlanningViewLine@1100525001 : Record 11124917;
      GenericTempTable1@1100525000 : TEMPORARY Record 11020579;
      GenericTempTable2@1100525004 : TEMPORARY Record 11020579;
      GroupLine@1100525006 : Integer;
      NextGroupLine@1100525007 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-LINK') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-LINK';
        ResourcePlanningView.Description := Text005;
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      GenericTempTable1.RESET;
      GenericTempTable1.DELETEALL;
      GenericTempTable2.RESET;
      GenericTempTable2.DELETEALL;

      LinkedResource.SETAUTOCALCFIELDS("Resource Name");
      IF LinkedResource.FINDSET THEN BEGIN
        REPEAT
          ResourceWOP.RESET;
          ResourceWOP.SetCompanyPlanGroupFilters;
          ResourceWOP.SETFILTER("User ID Filter", USERID);
          ResourceWOP.SETRANGE("Visible in GRP", TRUE);
          ResourceWOP.SETRANGE("No.", LinkedResource."Resource No.");
          IF ResourceWOP.FINDFIRST THEN BEGIN
            ResourceWOP.RESET;
            ResourceWOP.SetCompanyPlanGroupFilters;
            ResourceWOP.SETFILTER("User ID Filter", USERID);
            ResourceWOP.SETRANGE("Visible in GRP", TRUE);
            ResourceWOP.SETRANGE("No.", LinkedResource."Main Resource No.");
            IF ResourceWOP.FINDFIRST THEN BEGIN
              IF NOT GenericTempTable1.GET(LinkedResource."Main Resource No.") THEN BEGIN
                GenericTempTable1."Key Code1" := LinkedResource."Main Resource No.";
                GenericTempTable1.Text1 := ResourceWOP.Name;
                GenericTempTable1.INSERT;
              END;
              GenericTempTable2."Key Code1" := LinkedResource."Main Resource No.";
              GenericTempTable2."Key Code2" := LinkedResource."Resource No.";
              GenericTempTable2.Text1 := LinkedResource."Resource Name";
              GenericTempTable2.INSERT;
            END;
          END;
        UNTIL LinkedResource.NEXT = 0;
      END;

      // check group
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
      ResourcePlanningViewLine.SETRANGE("No.", 'RE-LINK');
      IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'RE-LINK';
        ResourcePlanningViewLine."No." := 'RE-LINK';
        ResourcePlanningViewLine.Description := Text005;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
        ResourcePlanningViewLine.INSERT(TRUE);
      END;
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      ResourcePlanningViewLine.SETFILTER("No.", '<>%1', 'RE-LINK');
      IF ResourcePlanningViewLine.FINDSET THEN
        ResourcePlanningViewLine.DELETEALL;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check new groups
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-LINK';
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := GenericTempTable1.Text1;
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Resource;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END ELSE BEGIN
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
        EXIT;
      END;


      // check deleted groups
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Resource);
      ResourcePlanningViewLine.SETRANGE(Indent, FALSE);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF NOT GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN
            ResourcePlanningViewLine.DELETE;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      // check resources
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF ResourcePlanningViewLine.FINDFIRST THEN
            GroupLine := ResourcePlanningViewLine."Line No.";
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
          ResourcePlanningViewLine.SETRANGE(Indent, FALSE);
          ResourcePlanningViewLine.SETFILTER("Line No.", '>%1', GroupLine);
          IF ResourcePlanningViewLine.FINDFIRST THEN
            NextGroupLine := ResourcePlanningViewLine."Line No."
          ELSE
            NextGroupLine := 9999;

          // check deleted resources
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
          ResourcePlanningViewLine.SETFILTER("Line No.", '>%1 & <%2', GroupLine, NextGroupLine);
          IF ResourcePlanningViewLine.FINDSET THEN BEGIN
            REPEAT
              IF GenericTempTable2.GET(GenericTempTable1.Code1, ResourcePlanningViewLine."No.") THEN
                GenericTempTable2.DELETE
              ELSE
                ResourcePlanningViewLine.DELETE;
            UNTIL ResourcePlanningViewLine.NEXT = 0;
          END;

          // check new resources
          GenericTempTable2.RESET;
          GenericTempTable2.SETRANGE("Key Code1", GenericTempTable1."Key Code1");
          IF GenericTempTable2.FINDSET THEN BEGIN
            REPEAT
              ResourcePlanningViewLine.RESET;
              ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
              ResourcePlanningViewLine.SETRANGE("User ID", USERID);
              ResourcePlanningViewLine.SETRANGE(Code, 'RE-LINK');
              ResourcePlanningViewLine.SETFILTER("Line No.", '>%1 & <%2', GroupLine, NextGroupLine);
              ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable2."Key Code2");
              IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
                ResourcePlanningViewLine.INIT;
                ResourcePlanningViewLine."User ID" := USERID;
                ResourcePlanningViewLine.Code := 'RE-LINK';
                ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Resource;
                ResourcePlanningViewLine.Indent := TRUE;
                ResourcePlanningViewLine."No." := GenericTempTable2."Key Code2";
                ResourcePlanningViewLine.Description := GenericTempTable2.Text1;
                ResourcePlanningViewLine.INSERT(TRUE);
                IF NextGroupLine < 9999 THEN BEGIN
                  ResourcePlanningViewLine.MoveUp(NextGroupLine);
                  NextGroupLine += 1;
                END;
              END;
            UNTIL GenericTempTable2.NEXT = 0;
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    LOCAL PROCEDURE ValidateResourcesDepartment@1100525008();
    VAR
      ResourcePlanningView@1100525005 : Record 11124916;
      ResourceWOP@1100525003 : Record 11229278;
      ResourcePlanningViewLine@1100525001 : Record 11124917;
      GenericTempTable1@1100525000 : TEMPORARY Record 11020579;
      GenericTempTable2@1100525004 : TEMPORARY Record 11020579;
      Employee@1100525008 : Record 5200;
      PlantNumber@1100525011 : Record 11012552;
      Vendor@1100525012 : Record 23;
      DimensionValue@1100525009 : Record 349;
      GeneralLedgerSetup@1100525010 : Record 98;
      GroupLine@1100525006 : Integer;
      NextGroupLine@1100525007 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-DEP') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-DEP';
        ResourcePlanningView.Description := Text006 + ' ' + Employee.FIELDCAPTION("Global Dimension 1 Code");
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      GenericTempTable1.RESET;
      GenericTempTable1.DELETEALL;
      GenericTempTable2.RESET;
      GenericTempTable2.DELETEALL;

      ResourceWOP.SetCompanyPlanGroupFilters;
      ResourceWOP.SETFILTER("User ID Filter", USERID);
      ResourceWOP.SETRANGE("Visible in GRP", TRUE);
      IF ResourceWOP.FINDSET THEN BEGIN
        REPEAT
          CASE ResourceWOP.Type OF
            ResourceWOP.Type::Employee:
              BEGIN
                Employee.CHANGECOMPANY(ResourceWOP.Company);
                DimensionValue.CHANGECOMPANY(ResourceWOP.Company);
                GeneralLedgerSetup.CHANGECOMPANY(ResourceWOP.Company);
                IF Employee.GET(ResourceWOP."Source No.") THEN BEGIN
                  IF Employee."Global Dimension 1 Code" <> '' THEN BEGIN
                    GeneralLedgerSetup.GET;
                    IF DimensionValue.GET(GeneralLedgerSetup."Global Dimension 1 Code", Employee."Global Dimension 1 Code") THEN BEGIN
                      IF NOT GenericTempTable1.GET('RE-DEP' + Employee."Global Dimension 1 Code") THEN BEGIN
                        GenericTempTable1."Key Code1" := 'RE-DEP' + Employee."Global Dimension 1 Code";
                        GenericTempTable1.Code1 := Employee."Global Dimension 1 Code";
                        GenericTempTable1.Text1 := DimensionValue.Name;
                        GenericTempTable1.INSERT;
                      END;
                      GenericTempTable2."Key Code1" := Employee."Global Dimension 1 Code";
                      GenericTempTable2."Key Code2" := ResourceWOP."No.";
                      GenericTempTable2.Text1 := ResourceWOP.Name;
                      GenericTempTable2.INSERT;
                    END;
                  END;
                END;
              END;
            ResourceWOP.Type::Plant:
              BEGIN
                PlantNumber.CHANGECOMPANY(ResourceWOP.Company);
                DimensionValue.CHANGECOMPANY(ResourceWOP.Company);
                GeneralLedgerSetup.CHANGECOMPANY(ResourceWOP.Company);
                IF PlantNumber.GET(ResourceWOP."Source No.", ResourceWOP."Source No. 2") THEN BEGIN
                  IF PlantNumber."Department Code" <> '' THEN BEGIN
                    GeneralLedgerSetup.GET;
                    IF DimensionValue.GET(GeneralLedgerSetup."Global Dimension 1 Code", PlantNumber."Department Code") THEN BEGIN
                      IF NOT GenericTempTable1.GET('RE-DEP' + PlantNumber."Department Code") THEN BEGIN
                        GenericTempTable1."Key Code1" := 'RE-DEP' + PlantNumber."Department Code";
                        GenericTempTable1.Code1 := PlantNumber."Department Code";
                        GenericTempTable1.Text1 := DimensionValue.Name;
                        GenericTempTable1.INSERT;
                      END;
                      GenericTempTable2."Key Code1" := PlantNumber."Department Code";
                      GenericTempTable2."Key Code2" := ResourceWOP."No.";
                      GenericTempTable2.Text1 := ResourceWOP.Name;
                      GenericTempTable2.INSERT;
                    END;
                  END;
                END;
              END;
            ResourceWOP.Type::Subcontractor:
              BEGIN
                Vendor.CHANGECOMPANY(ResourceWOP.Company);
                DimensionValue.CHANGECOMPANY(ResourceWOP.Company);
                GeneralLedgerSetup.CHANGECOMPANY(ResourceWOP.Company);
                IF Vendor.GET(ResourceWOP."Source No.") THEN BEGIN
                  IF Vendor."Global Dimension 1 Code" <> '' THEN BEGIN
                    GeneralLedgerSetup.GET;
                    IF DimensionValue.GET(GeneralLedgerSetup."Global Dimension 1 Code", Vendor."Global Dimension 1 Code") THEN BEGIN
                      IF NOT GenericTempTable1.GET('RE-DEP' + Vendor."Global Dimension 1 Code") THEN BEGIN
                        GenericTempTable1."Key Code1" := 'RE-DEP' + Vendor."Global Dimension 1 Code";
                        GenericTempTable1.Code1 := Vendor."Global Dimension 1 Code";
                        GenericTempTable1.Text1 := DimensionValue.Name;
                        GenericTempTable1.INSERT;
                      END;
                      GenericTempTable2."Key Code1" := Vendor."Global Dimension 1 Code";
                      GenericTempTable2."Key Code2" := ResourceWOP."No.";
                      GenericTempTable2.Text1 := ResourceWOP.Name;
                      GenericTempTable2.INSERT;
                    END;
                  END;
                END;
              END;
            ELSE
              ;
          END;
        UNTIL ResourceWOP.NEXT = 0;
      END;

      // check new groups
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-DEP';
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := Employee.FIELDCAPTION("Global Dimension 1 Code") + ' ' + GenericTempTable1.Code1 + ' - ' + GenericTempTable1.Text1;
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END ELSE BEGIN
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
        EXIT;
      END;

      // check deleted groups
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF NOT GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN
            ResourcePlanningViewLine.DELETE;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check resources
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF ResourcePlanningViewLine.FINDFIRST THEN
            GroupLine := ResourcePlanningViewLine."Line No.";
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
          ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
          ResourcePlanningViewLine.SETFILTER("Line No.", '>%1', GroupLine);
          IF ResourcePlanningViewLine.FINDFIRST THEN
            NextGroupLine := ResourcePlanningViewLine."Line No."
          ELSE
            NextGroupLine := 9999;

          // check deleted resources
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
          ResourcePlanningViewLine.SETFILTER("Line No.", '>%1 & <%2', GroupLine, NextGroupLine);
          IF ResourcePlanningViewLine.FINDSET THEN BEGIN
            REPEAT
              IF GenericTempTable2.GET(GenericTempTable1.Code1, ResourcePlanningViewLine."No.") THEN
                GenericTempTable2.DELETE
              ELSE
                ResourcePlanningViewLine.DELETE;
            UNTIL ResourcePlanningViewLine.NEXT = 0;
          END;

          // check new resources
          GenericTempTable2.RESET;
          GenericTempTable2.SETRANGE("Key Code1", GenericTempTable1.Code1);
          IF GenericTempTable2.FINDSET THEN BEGIN
            REPEAT
              ResourcePlanningViewLine.RESET;
              ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
              ResourcePlanningViewLine.SETRANGE("User ID", USERID);
              ResourcePlanningViewLine.SETRANGE(Code, 'RE-DEP');
              ResourcePlanningViewLine.SETFILTER("Line No.", '>%1 & <%2', GroupLine, NextGroupLine);
              ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable2."Key Code2");
              IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
                ResourcePlanningViewLine.INIT;
                ResourcePlanningViewLine."User ID" := USERID;
                ResourcePlanningViewLine.Code := 'RE-DEP';
                ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Resource;
                ResourcePlanningViewLine."No." := GenericTempTable2."Key Code2";
                ResourcePlanningViewLine.Description := GenericTempTable2.Text1;
                ResourcePlanningViewLine.INSERT(TRUE);
                IF NextGroupLine < 9999 THEN BEGIN
                  ResourcePlanningViewLine.MoveUp(NextGroupLine);
                  NextGroupLine += 1;
                END;
              END;
            UNTIL GenericTempTable2.NEXT = 0;
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    LOCAL PROCEDURE ValidateResourcesEmployee@1100525009();
    VAR
      ResourcePlanningView@1100525011 : Record 11124916;
      ResourceWOP@1100525010 : Record 11229278;
      ResourcePlanningViewLine@1100525009 : Record 11124917;
      GenericTempTable1@1100525008 : TEMPORARY Record 11020579;
      GroupLine@1100525001 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-EMPL') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-EMPL';
        ResourcePlanningView.Description := Text007;
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      GenericTempTable1.RESET;
      GenericTempTable1.DELETEALL;

      ResourceWOP.SetCompanyPlanGroupFilters;
      ResourceWOP.SETFILTER("User ID Filter", USERID);
      ResourceWOP.SETRANGE("Visible in GRP", TRUE);
      ResourceWOP.SETRANGE(Type, ResourceWOP.Type::Employee);
      IF ResourceWOP.FINDSET THEN BEGIN
        REPEAT
          GenericTempTable1."Key Code1" := ResourceWOP."No.";
          GenericTempTable1.Text1 := ResourceWOP.Name;
          GenericTempTable1.INSERT;
        UNTIL ResourceWOP.NEXT = 0;
      END;

      // check group
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-EMPL');
      ResourcePlanningViewLine.SETRANGE("No.", 'RE-EMPL');
      IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'RE-EMPL';
        ResourcePlanningViewLine."No." := 'RE-EMPL';
        ResourcePlanningViewLine.Description := Text007;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
        ResourcePlanningViewLine.INSERT(TRUE);
      END;
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-EMPL');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      ResourcePlanningViewLine.SETFILTER("No.", '<>%1', 'RE-EMPL');
      IF ResourcePlanningViewLine.FINDSET THEN
        ResourcePlanningViewLine.DELETEALL;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-EMPL');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-EMPL');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check deleted resources
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-EMPL');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Resource);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN
            GenericTempTable1.DELETE
          ELSE
            ResourcePlanningViewLine.DELETE;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      // check new resources
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-EMPL');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-EMPL';
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Resource;
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := GenericTempTable1.Text1;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    LOCAL PROCEDURE ValidateResourcesSubcontractor@1100525010();
    VAR
      ResourcePlanningView@1100525004 : Record 11124916;
      ResourceWOP@1100525003 : Record 11229278;
      ResourcePlanningViewLine@1100525002 : Record 11124917;
      GenericTempTable1@1100525001 : TEMPORARY Record 11020579;
      GroupLine@1100525000 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-SUBCON') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-SUBCON';
        ResourcePlanningView.Description := Text008;
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      GenericTempTable1.RESET;
      GenericTempTable1.DELETEALL;

      ResourceWOP.SetCompanyPlanGroupFilters;
      ResourceWOP.SETFILTER("User ID Filter", USERID);
      ResourceWOP.SETRANGE("Visible in GRP", TRUE);
      ResourceWOP.SETRANGE(Type, ResourceWOP.Type::Subcontractor);
      IF ResourceWOP.FINDSET THEN BEGIN
        REPEAT
          GenericTempTable1."Key Code1" := ResourceWOP."No.";
          GenericTempTable1.Text1 := ResourceWOP.Name;
          GenericTempTable1.INSERT;
        UNTIL ResourceWOP.NEXT = 0;
      END;

      // check group
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-SUBCON');
      ResourcePlanningViewLine.SETRANGE("No.", 'RE-SUBCON');
      IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'RE-SUBCON';
        ResourcePlanningViewLine."No." := 'RE-SUBCON';
        ResourcePlanningViewLine.Description := Text008;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
        ResourcePlanningViewLine.INSERT(TRUE);
      END;
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-SUBCON');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      ResourcePlanningViewLine.SETFILTER("No.", '<>%1', 'RE-SUBCON');
      IF ResourcePlanningViewLine.FINDSET THEN
        ResourcePlanningViewLine.DELETEALL;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-SUBCON');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-SUBCON');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check deleted resources
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-SUBCON');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Resource);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN
            GenericTempTable1.DELETE
          ELSE
            ResourcePlanningViewLine.DELETE;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      // check new resources
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-SUBCON');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-SUBCON';
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Resource;
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := GenericTempTable1.Text1;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    LOCAL PROCEDURE ValidateResourcesPlant@1100525011();
    VAR
      ResourcePlanningView@1100525004 : Record 11124916;
      ResourceWOP@1100525003 : Record 11229278;
      ResourcePlanningViewLine@1100525002 : Record 11124917;
      GenericTempTable1@1100525001 : TEMPORARY Record 11020579;
      GroupLine@1100525000 : Integer;
    BEGIN
      IF NOT ResourcePlanningView.GET(USERID, 'RE-PLANT') THEN BEGIN
        ResourcePlanningView."User ID" := USERID;
        ResourcePlanningView.Code := 'RE-PLANT';
        ResourcePlanningView.Description := Text009;
        ResourcePlanningView.Default := TRUE;
        ResourcePlanningView.INSERT(TRUE);
      END;

      GenericTempTable1.RESET;
      GenericTempTable1.DELETEALL;

      ResourceWOP.SetCompanyPlanGroupFilters;
      ResourceWOP.SETFILTER("User ID Filter", USERID);
      ResourceWOP.SETRANGE("Visible in GRP", TRUE);
      ResourceWOP.SETRANGE(Type, ResourceWOP.Type::Plant);
      IF ResourceWOP.FINDSET THEN BEGIN
        REPEAT
          GenericTempTable1."Key Code1" := ResourceWOP."No.";
          GenericTempTable1.Text1 := ResourceWOP.Name;
          GenericTempTable1.INSERT;
        UNTIL ResourceWOP.NEXT = 0;
      END;

      // check group
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANT');
      ResourcePlanningViewLine.SETRANGE("No.", 'RE-PLANT');
      IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
        ResourcePlanningViewLine.INIT;
        ResourcePlanningViewLine."User ID" := USERID;
        ResourcePlanningViewLine.Code := 'RE-PLANT';
        ResourcePlanningViewLine."No." := 'RE-PLANT';
        ResourcePlanningViewLine.Description := Text009;
        ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Group;
        ResourcePlanningViewLine.INSERT(TRUE);
      END;
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANT');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      ResourcePlanningViewLine.SETFILTER("No.", '<>%1', 'RE-PLANT');
      IF ResourcePlanningViewLine.FINDSET THEN
        ResourcePlanningViewLine.DELETEALL;

      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANT');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Group);
      IF ResourcePlanningViewLine.FINDFIRST THEN
        GroupLine := ResourcePlanningViewLine."Line No.";
      IF GroupLine > 1 THEN BEGIN
        ResourcePlanningViewLine.RESET;
        ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
        ResourcePlanningViewLine.SETRANGE("User ID", USERID);
        ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANT');
        ResourcePlanningViewLine.SETFILTER("Line No.", '<%1', GroupLine);
        IF ResourcePlanningViewLine.FINDSET THEN
          ResourcePlanningViewLine.DELETEALL;
      END;

      // check deleted resources
      ResourcePlanningViewLine.RESET;
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANT');
      ResourcePlanningViewLine.SETRANGE(Type, ResourcePlanningViewLine.Type::Resource);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          IF GenericTempTable1.GET(ResourcePlanningViewLine."No.") THEN
            GenericTempTable1.DELETE
          ELSE
            ResourcePlanningViewLine.DELETE;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;

      // check new resources
      GenericTempTable1.RESET;
      IF GenericTempTable1.FINDSET THEN BEGIN
        REPEAT
          ResourcePlanningViewLine.RESET;
          ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
          ResourcePlanningViewLine.SETRANGE("User ID", USERID);
          ResourcePlanningViewLine.SETRANGE(Code, 'RE-PLANT');
          ResourcePlanningViewLine.SETRANGE("No.", GenericTempTable1."Key Code1");
          IF NOT ResourcePlanningViewLine.FINDFIRST THEN BEGIN
            ResourcePlanningViewLine.INIT;
            ResourcePlanningViewLine."User ID" := USERID;
            ResourcePlanningViewLine.Code := 'RE-PLANT';
            ResourcePlanningViewLine.Type := ResourcePlanningViewLine.Type::Resource;
            ResourcePlanningViewLine."No." := GenericTempTable1."Key Code1";
            ResourcePlanningViewLine.Description := GenericTempTable1.Text1;
            ResourcePlanningViewLine.INSERT(TRUE);
          END;
        UNTIL GenericTempTable1.NEXT = 0;
      END;
      COMMIT;
    END;

    BEGIN
    {
      Default codes:
      - Classic     Classic View
      - RE-GRP-DIS  Resource Groups Discipline
      - RE-GRP-PLA  Resource Groups Plant
      - RE-DIS      Resources Discipline
      - RE-PLANTYP  Resources Plant Type
      - RE-LINK     Resources Linked Resources
      - RE-DEP      Resources Department (Global Dimension 1)
      - RE-EMPL     Resources Employee
      - RE-SUBCON   Resources Subcontractor
      - RE-PLANT    Resources Plant
    }
    END.
  }
}

