OBJECT Page 11128291 _Prognosis CC MB
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSSE;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Prognosis by date;
               SVE=Prognos per datum];
    SaveValues=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table11128083;
    SourceTableView=SORTING(UserID,Project No.,Line No.);
    PageType=ListPart;
    SourceTableTemporary=Yes;
    RefreshOnActivate=Yes;
    ShowFilter=No;
    OnFindRecord=BEGIN
                   EXIT(FindRec(Rec, Which));
                 END;

    OnNextRecord=BEGIN
                   EXIT(NextRec(Rec, Steps));
                 END;

    OnAfterGetRecord=VAR
                       I@1100528700 : Integer;
                     BEGIN
                       FOR I := 1 TO MATRIX_CurrSetLength DO
                         MATRIX_OnAfterGetRecord(I);

                       InOV:=(InOverview AND (NOT Overview));
                     END;

  }
  CONTROLS
  {
    { 1100528740;0;Container;
                ContainerType=ContentArea }

    { 1100528741;1;Group  ;
                GroupType=Repeater;
                FreezeColumnID=Caption }

    { 1100285100;2;Field  ;
                SourceExpr="Prognosis Cost Object" }

    { 1100528742;2;Field  ;
                SourceExpr=Caption;
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828701;2;Field  ;
                Name=Field1;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[1];
                CaptionClass='3,' + MATRIX_CaptionSet[1];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828801;2;Field  ;
                SourceExpr=MATRIX_CellDataText[1];
                Visible=Show_CellDataText }

    { 1112828702;2;Field  ;
                Name=Field2;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[2];
                CaptionClass='3,' + MATRIX_CaptionSet[2];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828802;2;Field  ;
                SourceExpr=MATRIX_CellDataText[2];
                Visible=Show_CellDataText }

    { 1112828703;2;Field  ;
                Name=Field3;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[3];
                CaptionClass='3,' + MATRIX_CaptionSet[3];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828803;2;Field  ;
                SourceExpr=MATRIX_CellDataText[3];
                Visible=Show_CellDataText }

    { 1112828704;2;Field  ;
                Name=Field4;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[4];
                CaptionClass='3,' + MATRIX_CaptionSet[4];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828804;2;Field  ;
                SourceExpr=MATRIX_CellDataText[4];
                Visible=Show_CellDataText }

    { 1112828705;2;Field  ;
                Name=Field5;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[5];
                CaptionClass='3,' + MATRIX_CaptionSet[5];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828805;2;Field  ;
                SourceExpr=MATRIX_CellDataText[5];
                Visible=Show_CellDataText }

    { 1112828706;2;Field  ;
                Name=Field6;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[6];
                CaptionClass='3,' + MATRIX_CaptionSet[6];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828806;2;Field  ;
                SourceExpr=MATRIX_CellDataText[6];
                Visible=Show_CellDataText }

    { 1112828707;2;Field  ;
                Name=Field7;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[7];
                CaptionClass='3,' + MATRIX_CaptionSet[7];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828807;2;Field  ;
                SourceExpr=MATRIX_CellDataText[7];
                Visible=Show_CellDataText }

    { 1112828708;2;Field  ;
                Name=Field8;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[8];
                CaptionClass='3,' + MATRIX_CaptionSet[8];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828808;2;Field  ;
                SourceExpr=MATRIX_CellDataText[8];
                Visible=Show_CellDataText }

    { 1112828709;2;Field  ;
                Name=Field9;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[9];
                CaptionClass='3,' + MATRIX_CaptionSet[9];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828809;2;Field  ;
                SourceExpr=MATRIX_CellDataText[9];
                Visible=Show_CellDataText }

    { 1112828710;2;Field  ;
                Name=Field10;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[10];
                CaptionClass='3,' + MATRIX_CaptionSet[10];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828810;2;Field  ;
                SourceExpr=MATRIX_CellDataText[10];
                Visible=Show_CellDataText }

    { 1112828711;2;Field  ;
                Name=Field11;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[11];
                CaptionClass='3,' + MATRIX_CaptionSet[11];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828811;2;Field  ;
                SourceExpr=MATRIX_CellDataText[11];
                Visible=Show_CellDataText }

    { 1112828712;2;Field  ;
                Name=Field12;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[12];
                CaptionClass='3,' + MATRIX_CaptionSet[12];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828812;2;Field  ;
                SourceExpr=MATRIX_CellDataText[12];
                Visible=Show_CellDataText }

    { 1112828713;2;Field  ;
                Name=Field13;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[13];
                CaptionClass='3,' + MATRIX_CaptionSet[13];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828813;2;Field  ;
                SourceExpr=MATRIX_CellDataText[13];
                Visible=Show_CellDataText }

    { 1112828714;2;Field  ;
                Name=Field14;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[14];
                CaptionClass='3,' + MATRIX_CaptionSet[14];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828814;2;Field  ;
                SourceExpr=MATRIX_CellDataText[14];
                Visible=Show_CellDataText }

    { 1112828715;2;Field  ;
                Name=Field15;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[15];
                CaptionClass='3,' + MATRIX_CaptionSet[15];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828815;2;Field  ;
                SourceExpr=MATRIX_CellDataText[15];
                Visible=Show_CellDataText }

    { 1112828716;2;Field  ;
                Name=Field16;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[16];
                CaptionClass='3,' + MATRIX_CaptionSet[16];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828816;2;Field  ;
                SourceExpr=MATRIX_CellDataText[16];
                Visible=Show_CellDataText }

    { 1112828717;2;Field  ;
                Name=Field17;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[17];
                CaptionClass='3,' + MATRIX_CaptionSet[17];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828817;2;Field  ;
                SourceExpr=MATRIX_CellDataText[17];
                Visible=Show_CellDataText }

    { 1112828718;2;Field  ;
                Name=Field18;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[18];
                CaptionClass='3,' + MATRIX_CaptionSet[18];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828818;2;Field  ;
                SourceExpr=MATRIX_CellDataText[18];
                Visible=Show_CellDataText }

    { 1112828719;2;Field  ;
                Name=Field19;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[19];
                CaptionClass='3,' + MATRIX_CaptionSet[19];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828819;2;Field  ;
                SourceExpr=MATRIX_CellDataText[19];
                Visible=Show_CellDataText }

    { 1112828720;2;Field  ;
                Name=Field20;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[20];
                CaptionClass='3,' + MATRIX_CaptionSet[20];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828820;2;Field  ;
                SourceExpr=MATRIX_CellDataText[20];
                Visible=Show_CellDataText }

    { 1112828721;2;Field  ;
                Name=Field21;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[21];
                CaptionClass='3,' + MATRIX_CaptionSet[21];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828821;2;Field  ;
                SourceExpr=MATRIX_CellDataText[21];
                Visible=Show_CellDataText }

    { 1112828722;2;Field  ;
                Name=Field22;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[22];
                CaptionClass='3,' + MATRIX_CaptionSet[22];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828822;2;Field  ;
                SourceExpr=MATRIX_CellDataText[22];
                Visible=Show_CellDataText }

    { 1112828723;2;Field  ;
                Name=Field23;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[23];
                CaptionClass='3,' + MATRIX_CaptionSet[23];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828823;2;Field  ;
                SourceExpr=MATRIX_CellDataText[23];
                Visible=Show_CellDataText }

    { 1112828724;2;Field  ;
                Name=Field24;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[24];
                CaptionClass='3,' + MATRIX_CaptionSet[24];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828824;2;Field  ;
                SourceExpr=MATRIX_CellDataText[24];
                Visible=Show_CellDataText }

    { 1112828725;2;Field  ;
                Name=Field25;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[25];
                CaptionClass='3,' + MATRIX_CaptionSet[25];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828825;2;Field  ;
                SourceExpr=MATRIX_CellDataText[25];
                Visible=Show_CellDataText }

    { 1112828726;2;Field  ;
                Name=Field26;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[26];
                CaptionClass='3,' + MATRIX_CaptionSet[26];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828826;2;Field  ;
                SourceExpr=MATRIX_CellDataText[26];
                Visible=Show_CellDataText }

    { 1112828727;2;Field  ;
                Name=Field27;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[27];
                CaptionClass='3,' + MATRIX_CaptionSet[27];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828827;2;Field  ;
                SourceExpr=MATRIX_CellDataText[27];
                Visible=Show_CellDataText }

    { 1112828728;2;Field  ;
                Name=Field28;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[28];
                CaptionClass='3,' + MATRIX_CaptionSet[28];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828828;2;Field  ;
                SourceExpr=MATRIX_CellDataText[28];
                Visible=Show_CellDataText }

    { 1112828729;2;Field  ;
                Name=Field29;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[29];
                CaptionClass='3,' + MATRIX_CaptionSet[29];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828829;2;Field  ;
                SourceExpr=MATRIX_CellDataText[29];
                Visible=Show_CellDataText }

    { 1112828730;2;Field  ;
                Name=Field30;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[30];
                CaptionClass='3,' + MATRIX_CaptionSet[30];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828830;2;Field  ;
                SourceExpr=MATRIX_CellDataText[30];
                Visible=Show_CellDataText }

    { 1112828731;2;Field  ;
                Name=Field31;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[31];
                CaptionClass='3,' + MATRIX_CaptionSet[31];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828831;2;Field  ;
                SourceExpr=MATRIX_CellDataText[31];
                Visible=Show_CellDataText }

    { 1112828732;2;Field  ;
                Name=Field32;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[32];
                CaptionClass='3,' + MATRIX_CaptionSet[32];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828832;2;Field  ;
                SourceExpr=MATRIX_CellDataText[32];
                Visible=Show_CellDataText }

    { 1112828733;2;Field  ;
                Name=Field33;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[33];
                CaptionClass='3,' + MATRIX_CaptionSet[33];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828833;2;Field  ;
                SourceExpr=MATRIX_CellDataText[33];
                Visible=Show_CellDataText }

    { 1112828734;2;Field  ;
                Name=Field34;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[34];
                CaptionClass='3,' + MATRIX_CaptionSet[34];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828834;2;Field  ;
                SourceExpr=MATRIX_CellDataText[34];
                Visible=Show_CellDataText }

    { 1112828735;2;Field  ;
                Name=Field35;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[35];
                CaptionClass='3,' + MATRIX_CaptionSet[35];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828835;2;Field  ;
                SourceExpr=MATRIX_CellDataText[35];
                Visible=Show_CellDataText }

    { 1112828736;2;Field  ;
                Name=Field36;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[36];
                CaptionClass='3,' + MATRIX_CaptionSet[36];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828836;2;Field  ;
                SourceExpr=MATRIX_CellDataText[36];
                Visible=Show_CellDataText }

    { 1112828737;2;Field  ;
                Name=Field37;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[37];
                CaptionClass='3,' + MATRIX_CaptionSet[37];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828837;2;Field  ;
                SourceExpr=MATRIX_CellDataText[37];
                Visible=Show_CellDataText }

    { 1112828738;2;Field  ;
                Name=Field38;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[38];
                CaptionClass='3,' + MATRIX_CaptionSet[38];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828838;2;Field  ;
                SourceExpr=MATRIX_CellDataText[38];
                Visible=Show_CellDataText }

    { 1112828739;2;Field  ;
                Name=Field39;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[39];
                CaptionClass='3,' + MATRIX_CaptionSet[39];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828839;2;Field  ;
                SourceExpr=MATRIX_CellDataText[39];
                Visible=Show_CellDataText }

    { 1112828740;2;Field  ;
                Name=Field40;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[40];
                CaptionClass='3,' + MATRIX_CaptionSet[40];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828840;2;Field  ;
                SourceExpr=MATRIX_CellDataText[40];
                Visible=Show_CellDataText }

    { 1112828741;2;Field  ;
                Name=Field41;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[41];
                CaptionClass='3,' + MATRIX_CaptionSet[41];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828841;2;Field  ;
                SourceExpr=MATRIX_CellDataText[41];
                Visible=Show_CellDataText }

    { 1112828742;2;Field  ;
                Name=Field42;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[42];
                CaptionClass='3,' + MATRIX_CaptionSet[42];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828842;2;Field  ;
                SourceExpr=MATRIX_CellDataText[42];
                Visible=Show_CellDataText }

    { 1112828743;2;Field  ;
                Name=Field43;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[43];
                CaptionClass='3,' + MATRIX_CaptionSet[43];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828843;2;Field  ;
                SourceExpr=MATRIX_CellDataText[43];
                Visible=Show_CellDataText }

    { 1112828744;2;Field  ;
                Name=Field44;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[44];
                CaptionClass='3,' + MATRIX_CaptionSet[44];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828844;2;Field  ;
                SourceExpr=MATRIX_CellDataText[44];
                Visible=Show_CellDataText }

    { 1112828745;2;Field  ;
                Name=Field45;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[45];
                CaptionClass='3,' + MATRIX_CaptionSet[45];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828845;2;Field  ;
                SourceExpr=MATRIX_CellDataText[45];
                Visible=Show_CellDataText }

    { 1112828746;2;Field  ;
                Name=Field46;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[46];
                CaptionClass='3,' + MATRIX_CaptionSet[46];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828846;2;Field  ;
                SourceExpr=MATRIX_CellDataText[46];
                Visible=Show_CellDataText }

    { 1112828747;2;Field  ;
                Name=Field47;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[47];
                CaptionClass='3,' + MATRIX_CaptionSet[47];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828847;2;Field  ;
                SourceExpr=MATRIX_CellDataText[47];
                Visible=Show_CellDataText }

    { 1112828748;2;Field  ;
                Name=Field48;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[48];
                CaptionClass='3,' + MATRIX_CaptionSet[48];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828848;2;Field  ;
                SourceExpr=MATRIX_CellDataText[48];
                Visible=Show_CellDataText }

    { 1112828749;2;Field  ;
                Name=Field49;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[49];
                CaptionClass='3,' + MATRIX_CaptionSet[49];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828849;2;Field  ;
                SourceExpr=MATRIX_CellDataText[49];
                Visible=Show_CellDataText }

    { 1112828750;2;Field  ;
                Name=Field50;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[50];
                CaptionClass='3,' + MATRIX_CaptionSet[50];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828850;2;Field  ;
                SourceExpr=MATRIX_CellDataText[50];
                Visible=Show_CellDataText }

    { 1112828751;2;Field  ;
                Name=Field51;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[51];
                CaptionClass='3,' + MATRIX_CaptionSet[51];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828851;2;Field  ;
                SourceExpr=MATRIX_CellDataText[51];
                Visible=Show_CellDataText }

    { 1112828752;2;Field  ;
                Name=Field52;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[52];
                CaptionClass='3,' + MATRIX_CaptionSet[52];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828852;2;Field  ;
                SourceExpr=MATRIX_CellDataText[52];
                Visible=Show_CellDataText }

    { 1112828753;2;Field  ;
                Name=Field53;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[53];
                CaptionClass='3,' + MATRIX_CaptionSet[53];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828853;2;Field  ;
                SourceExpr=MATRIX_CellDataText[53];
                Visible=Show_CellDataText }

    { 1112828754;2;Field  ;
                Name=Field54;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[54];
                CaptionClass='3,' + MATRIX_CaptionSet[54];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828854;2;Field  ;
                SourceExpr=MATRIX_CellDataText[54];
                Visible=Show_CellDataText }

    { 1112828755;2;Field  ;
                Name=Field55;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[55];
                CaptionClass='3,' + MATRIX_CaptionSet[55];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828855;2;Field  ;
                SourceExpr=MATRIX_CellDataText[55];
                Visible=Show_CellDataText }

    { 1112828756;2;Field  ;
                Name=Field56;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[56];
                CaptionClass='3,' + MATRIX_CaptionSet[56];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828856;2;Field  ;
                SourceExpr=MATRIX_CellDataText[56];
                Visible=Show_CellDataText }

    { 1112828757;2;Field  ;
                Name=Field57;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[57];
                CaptionClass='3,' + MATRIX_CaptionSet[57];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828857;2;Field  ;
                SourceExpr=MATRIX_CellDataText[57];
                Visible=Show_CellDataText }

    { 1112828758;2;Field  ;
                Name=Field58;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[58];
                CaptionClass='3,' + MATRIX_CaptionSet[58];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828858;2;Field  ;
                SourceExpr=MATRIX_CellDataText[58];
                Visible=Show_CellDataText }

    { 1112828759;2;Field  ;
                Name=Field59;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[59];
                CaptionClass='3,' + MATRIX_CaptionSet[59];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828859;2;Field  ;
                SourceExpr=MATRIX_CellDataText[59];
                Visible=Show_CellDataText }

    { 1112828760;2;Field  ;
                Name=Field60;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[60];
                CaptionClass='3,' + MATRIX_CaptionSet[60];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828860;2;Field  ;
                SourceExpr=MATRIX_CellDataText[60];
                Visible=Show_CellDataText }

    { 1112828761;2;Field  ;
                Name=Field61;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[61];
                CaptionClass='3,' + MATRIX_CaptionSet[61];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828861;2;Field  ;
                SourceExpr=MATRIX_CellDataText[61];
                Visible=Show_CellDataText }

    { 1112828762;2;Field  ;
                Name=Field62;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[62];
                CaptionClass='3,' + MATRIX_CaptionSet[62];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828862;2;Field  ;
                SourceExpr=MATRIX_CellDataText[62];
                Visible=Show_CellDataText }

    { 1112828763;2;Field  ;
                Name=Field63;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[63];
                CaptionClass='3,' + MATRIX_CaptionSet[63];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828863;2;Field  ;
                SourceExpr=MATRIX_CellDataText[63];
                Visible=Show_CellDataText }

    { 1112828764;2;Field  ;
                Name=Field64;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[64];
                CaptionClass='3,' + MATRIX_CaptionSet[64];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=InOV }

    { 1112828864;2;Field  ;
                SourceExpr=MATRIX_CellDataText[64];
                Visible=Show_CellDataText }

  }
  CODE
  {
    VAR
      MATRIX_MatrixRecord@1100528723 : Record 2000000007;
      MATRIX_MatrixRecords@1100528722 : ARRAY [64] OF Record 2000000007;
      MATRIX_CaptionSet@1100528718 : ARRAY [64] OF Text[80];
      MATRIX_CurrSetLength@1100528716 : Integer;
      MATRIX_CellData@1100528715 : ARRAY [64] OF Decimal;
      MATRIX_CellDataText@1100285112 : ARRAY [64] OF Text;
      MATRIX_PeriodType@1100528712 : 'Day,Week,Month,Quarter,Year';
      Job@1100285100 : Record 11072003;
      Prognosis@1100285101 : Record 11012034;
      TempProjDetail@1100285105 : TEMPORARY Record 11128083;
      TempProjDetail2@1100285110 : TEMPORARY Record 11128083;
      tempPrognosisLineCC@1100285102 : TEMPORARY Record 11128270;
      PrognosisType@1100285103 : 'CostObject,CostComponent';
      gUSERID@1100285104 : Code[50];
      SumLine@1100285106 : Boolean;
      Overview@1100285108 : Boolean;
      InOV@1100285107 : Boolean;
      Compress@1100285109 : Boolean;
      gLastPrognosisDate@1100285111 : Date;
      Show_CellDataText@1100285113 : Boolean INDATASET;

    PROCEDURE Load@1132(VAR CaptionSet@1005 : ARRAY [64] OF Text[80];VAR MatrixRecords@1006 : ARRAY [64] OF Record 2000000007;CurrSetLength@1007 : Integer;PeriodType@1100528700 : 'Day,Week,Month,Quarter,Year';ProjectNo@1100528701 : Code[20]);
    VAR
      ProjDetailTemplate@1100285100 : Record 11128082;
      cuProjectDetails@1100285101 : Codeunit 11128091;
    BEGIN
      CLEAR(MATRIX_CellData);
      COPYARRAY(MATRIX_CaptionSet, CaptionSet, 1);
      COPYARRAY(MATRIX_MatrixRecords, MatrixRecords, 1);

      MATRIX_CurrSetLength := CurrSetLength;

      MATRIX_PeriodType := PeriodType;
      IF ProjectNo <> '' THEN
        Job.GET(ProjectNo)
      ELSE
        CLEAR(Job);

      TempProjDetail.RESET;
      // DeleteProjDetail(UserId,ProjNo);
      TempProjDetail.SETRANGE(UserID,gUSERID);
      TempProjDetail.SETRANGE("Project No.",Job."No.");
      IF TempProjDetail.FINDSET THEN
        TempProjDetail.DELETEALL;

      // CreateProjDetail(UserId,ProjNo);
      cuProjectDetails.CreateProjDetail(TempProjDetail,gUSERID,Job."No.");

      // GetPrognosisLine(UserId,ProjNo);
      TempProjDetail.RESET;
      GetPrognosisLines(gUSERID,Job."No.");


      TempProjDetail2.RESET;
      TempProjDetail2.DELETEALL;
      TempProjDetail.RESET;
      TempProjDetail.SETRANGE(UserID,gUSERID);
      TempProjDetail.SETRANGE("Project No.",Job."No.");
      IF TempProjDetail.FINDSET THEN REPEAT
        TempProjDetail2.COPY(TempProjDetail);
        TempProjDetail2.INSERT;
      UNTIL TempProjDetail.NEXT =0;

      SumProjDetail(gUSERID,Job."No.");
      CodeLines(gUSERID,Job."No.");
    END;

    LOCAL PROCEDURE GetPrognosisLines@1100285121(pUserId@1100285101 : Code[50];ProjectNo@1100285100 : Code[20]);
    VAR
      LineHasValue@1100285102 : Boolean;
    BEGIN
      tempPrognosisLineCC.RESET;
      tempPrognosisLineCC.SETRANGE("Project No.",ProjectNo);
      tempPrognosisLineCC.DELETEALL;
      IF Job.GET(ProjectNo) THEN
        CASE Job."Forecast Level" OF
          Job."Forecast Level"::"Cost Component": GetPrognosisLinesCC(pUserId,ProjectNo);
          ELSE GetPrognosisLinesCO(pUserId,ProjectNo);
        END;

      //delete lines with all zeroes
      TempProjDetail.SETRANGE(UserID,pUserId);
      TempProjDetail.SETRANGE("Project No.",ProjectNo);
      TempProjDetail.SETFILTER("Prognosis Cost Object",'<>%1','');
      Prognosis.SETRANGE("Project No.",ProjectNo);
      Prognosis.SETRANGE("Prognosis Date",MATRIX_MatrixRecords[1]."Period Start",MATRIX_MatrixRecords[MATRIX_CurrSetLength]."Period End");
      IF TempProjDetail.FINDSET(FALSE) THEN
      REPEAT
        LineHasValue := FALSE;
        tempPrognosisLineCC.SETRANGE("Cost Component Code",FORMAT(TempProjDetail."Line No.",0,2));
        IF Prognosis.FINDSET(FALSE) THEN
        REPEAT
          tempPrognosisLineCC.SETRANGE("Project No.",Prognosis."Project No.");
          tempPrognosisLineCC.SETRANGE("Prognosis Date",Prognosis."Prognosis Date");
          IF tempPrognosisLineCC.FINDSET THEN
          REPEAT
            IF NOT LineHasValue THEN
              LineHasValue := (tempPrognosisLineCC."Actual Costs"<>0) OR (tempPrognosisLineCC."Actual Hours"<>0);
          UNTIL tempPrognosisLineCC.NEXT = 0;
        UNTIL Prognosis.NEXT=0;
        IF NOT LineHasValue THEN BEGIN
          tempPrognosisLineCC.SETRANGE("Prognosis Date");
          tempPrognosisLineCC.DELETEALL;
          LineHasValue := FALSE;
        END;
      UNTIL TempProjDetail.NEXT = 0;
    END;

    LOCAL PROCEDURE GetPrognosisLinesCO@1100285123(pUserId@1100285106 : Code[50];ProjNo@1100285100 : Code[20]);
    VAR
      PL@1100285105 : Record 11012035;
      PSum@1100285104 : Decimal;
      Prognosis@1100285103 : Record 11012034;
      ProjectPreclosureResult@1100285102 : Record 11012093;
      Job@1100285101 : Record 11072003;
      PLComment@1100285107 : Text;
    BEGIN
      PrognosisType := PrognosisType::CostObject;
      TempProjDetail.SETRANGE(UserID,pUserId);
      TempProjDetail.SETRANGE("Project No.",ProjNo);
      TempProjDetail.SETRANGE("Code line",FALSE);
      TempProjDetail.SETRANGE("Sum Line",FALSE);
      TempProjDetail.SETFILTER("Prognosis Cost Object",'<>%1','');

      IF TempProjDetail.FIND('-') THEN BEGIN
        REPEAT
          //Senaste prognos kostnadsobjekt
          Prognosis.SETRANGE("Project No.",ProjNo);
          IF Prognosis.FINDSET(FALSE) THEN BEGIN
            REPEAT
              PSum := 0;
              PLComment:= '';   //190219
              CLEAR(PL);
              PL.SETCURRENTKEY("Project No.","Prognosis Date","Cost Type",Element,"Cost Object");
              PL.SETRANGE("Project No.",ProjNo);
              PL.SETRANGE("Cost Object",TempProjDetail."Prognosis Cost Object");
              PL.SETRANGE("Prognosis Date",Prognosis."Prognosis Date");
              IF PL.FIND('-') THEN BEGIN
                REPEAT
                  IF TempProjDetail."Sum Amount" THEN BEGIN
                    IF PL."Cost Type"=PL."Cost Type"::Revenue THEN
                      PSum := PSum + (PL."Amount Revenue"+PL.Invoiced)
                    ELSE
                      PSum := PSum + PL."Prognosis Total Cost";
                  END ELSE BEGIN
                    PSum := PSum + PL."Prognosis Total Hours"//PL.Quantity;
                  END;
                  IF PLComment = '' THEN PLComment := PL.Comment; //>>190219
                UNTIL PL.NEXT = 0;
              END;

              IF (PSum <> 0) OR (Prognosis."Prognosis Date" = gLastPrognosisDate) THEN
      //>>190219
      //          savePrognosisValue(TempProjDetail."Project No.",Prognosis."Prognosis Date",TempProjDetail."Line No.",TempProjDetail."Sum Amount",PSum,PSum,TempProjDetail.Caption);
                savePrognosisValue(TempProjDetail."Project No.",Prognosis."Prognosis Date",TempProjDetail."Line No.",TempProjDetail."Sum Amount",PSum,PSum,PLComment);
      //<<190219
            UNTIL Prognosis.NEXT=0;
          END;
        UNTIL TempProjDetail.NEXT = 0;
      END;
      //Fyll kostnadskomponentrad „ven f”r prognos p† kostnadsobjekt
      CLEAR(TempProjDetail);
      TempProjDetail.SETRANGE(UserID,gUSERID);
      TempProjDetail.SETRANGE("Project No.",ProjNo);
      TempProjDetail.SETRANGE("Code line",FALSE);
      TempProjDetail.SETRANGE("Sum Line",FALSE);
      TempProjDetail.SETFILTER("Cost Component Code",'<>%1','');
      IF TempProjDetail.FIND('-') THEN BEGIN
        REPEAT
          //Senaste prognos kostnadsobjekt
          Prognosis.SETRANGE("Project No.",ProjNo);

          IF Prognosis.FINDSET(FALSE) THEN BEGIN
            REPEAT
              PSum := 0;
              PLComment:=''; //190219
              CLEAR(PL);
              PL.SETCURRENTKEY("Project No.","Prognosis Date","Cost Type",Element,"Cost Object");
              PL.SETRANGE("Project No.",ProjNo);

              CASE TempProjDetail."Cost Component Code" OF
                '1I': PL.SETRANGE("Cost Type",PL."Cost Type"::Revenue);
                '7O': PL.SETRANGE("Cost Type",PL."Cost Type"::Sundry);
                ELSE
                  PL.SETRANGE("Cost Component",TempProjDetail."Cost Component Code");
              END;

              PL.SETRANGE("Prognosis Date",Prognosis."Prognosis Date");
              IF PL.FIND('-') THEN BEGIN
                REPEAT
                  IF TempProjDetail."Sum Amount" THEN BEGIN
                    IF PL."Cost Type"=PL."Cost Type"::Revenue THEN
                      PSum := PSum + (PL."Amount Revenue"+PL.Invoiced)
                    ELSE
                      PSum := PSum + PL."Prognosis Total Cost";
                  END ELSE BEGIN
                    PSum := PSum + PL."Prognosis Total Hours";//PL.Quantity;
                  END;
                  IF PLComment = '' THEN PLComment := PL.Comment; //190219
                UNTIL PL.NEXT = 0;
              END;

              IF (PSum <> 0) OR (Prognosis."Prognosis Date" = gLastPrognosisDate) THEN
      //>>190219
      //          savePrognosisValue(TempProjDetail."Project No.",Prognosis."Prognosis Date",TempProjDetail."Line No.",TempProjDetail."Sum Amount",PSum,PSum,TempProjDetail.Caption);
                savePrognosisValue(TempProjDetail."Project No.",Prognosis."Prognosis Date",TempProjDetail."Line No.",TempProjDetail."Sum Amount",PSum,PSum,PLComment);
      //<<190219
            UNTIL Prognosis.NEXT=0;
          END;
        UNTIL TempProjDetail.NEXT = 0;
      END;

      CLEAR(TempProjDetail);
      TempProjDetail.SETRANGE(UserID,gUSERID);
      TempProjDetail.SETRANGE("Project No.",ProjNo);
      TempProjDetail.SETRANGE("Code line",FALSE);
      TempProjDetail.SETRANGE("Sum Line",FALSE);
      TempProjDetail.SETRANGE(Hide,FALSE);
    END;

    LOCAL PROCEDURE GetPrognosisLinesCC@1100285122(pUserId@1100285109 : Code[50];ProjectNo@1100285100 : Code[20]);
    VAR
      PL@1100285108 : Record 11012035;
      PSum@1100285107 : Decimal;
      Prognosis@1100285106 : Record 11012034;
      ProjectPreclosureResult@1100285105 : Record 11012093;
      Job@1100285104 : Record 11072003;
      PLCC@1100285103 : Record 11128270;
      JobSub@1100285102 : Record 11072003;
      SESetup@1100285101 : Record 11128004;
    BEGIN
      PrognosisType := PrognosisType::CostComponent;

      TempProjDetail.SETRANGE(UserID,pUserId);
      TempProjDetail.SETRANGE("Project No.",ProjectNo);
      TempProjDetail.SETRANGE("Code line",FALSE);
      TempProjDetail.SETFILTER("Cost Component Code",'<>%1','');
      TempProjDetail.SETRANGE("Sum Line",FALSE);
      IF TempProjDetail.FIND('-') THEN BEGIN
        REPEAT
          //Senaste prognos (kostnadskomponent)
          Prognosis.SETRANGE("Project No.",ProjectNo);
          IF Prognosis.FINDSET(FALSE) THEN REPEAT
            PSum := 0;
            CLEAR(PLCC);
            IF PLCC.GET(ProjectNo,Prognosis."Prognosis Date",TempProjDetail."Cost Component Code") THEN BEGIN
              IF TempProjDetail."Sum Amount" THEN BEGIN
                IF PLCC."Cost Type"=PLCC."Cost Type"::Revenue THEN
                  PSum := PSum + PLCC."Prognosis Total Revenues"
                ELSE
                  PSum := PSum + PLCC."Prognosis Total Cost";
              END ELSE
                PSum := PSum + PLCC."Prognosis Total Hours";
            END;
      //>>190219
      //      savePrognosisValue(Prognosis."Project No.",Prognosis."Prognosis Date",TempProjDetail."Line No.",TempProjDetail."Sum Amount",PSum,PSum,TempProjDetail.Caption);
            savePrognosisValue(Prognosis."Project No.",Prognosis."Prognosis Date",TempProjDetail."Line No.",TempProjDetail."Sum Amount",PSum,PSum,'');
      //<<190219

          UNTIL Prognosis.NEXT=0;
        UNTIL TempProjDetail.NEXT = 0;
      END;
    END;

    PROCEDURE SumProjDetail@1100285000(UserId@1100285001 : Code[50];ProjNo@1100285000 : Code[20]);
    VAR
      ProjDetail2@1100285006 : Record 11128083;
      PSum@1100285004 : Decimal;
      i@1100285100 : Integer;
      progDate@1100285101 : Date;
      LineNo@1100285102 : Integer;
      tempPrognosisLine2@1100285103 : TEMPORARY Record 11128270;
    BEGIN
      TempProjDetail.RESET;
      TempProjDetail.SETRANGE(UserID,UserId);
      TempProjDetail.SETRANGE("Project No.",ProjNo);
      TempProjDetail.SETRANGE("Sum Line",TRUE);
      IF TempProjDetail.FIND('-') THEN BEGIN

        //copy tempPrognosisLineCC -> tempPrognosisLine2  for searching
        tempPrognosisLineCC.RESET;
        tempPrognosisLineCC.SETRANGE("Project No.",ProjNo);
        tempPrognosisLine2.RESET;
        tempPrognosisLine2.DELETEALL;
        IF tempPrognosisLineCC.FINDSET THEN
        REPEAT
          tempPrognosisLine2.COPY(tempPrognosisLineCC);
          tempPrognosisLine2.INSERT;
        UNTIL tempPrognosisLineCC.NEXT=0;

        REPEAT
          CLEAR(TempProjDetail2);
          PSum := 0;
          TempProjDetail2.SETRANGE(UserID,UserId);
          TempProjDetail2.SETRANGE("Project No.",ProjNo);
          TempProjDetail2.SETRANGE("Code line",FALSE);
          TempProjDetail2.SETRANGE("Sum Line",FALSE);
          TempProjDetail2.SETRANGE("Sum Quantity",FALSE);
          TempProjDetail2.SETRANGE("Sum Amount",TRUE);
          TempProjDetail2.SETFILTER("Line No.",'%1..%2',TempProjDetail."Total Line No. From",TempProjDetail."Total Line No. To");
          IF TempProjDetail2.FINDSET THEN BEGIN
            REPEAT
              LineNo:=0;
              IF TempProjDetail2."Cost Component Code"=''THEN BEGIN
                LineNo:=TempProjDetail2."Line No.";
              END ELSE IF Job."Forecast Level"=Job."Forecast Level"::"Cost Component" THEN BEGIN
                LineNo:=TempProjDetail2."Line No.";
              END;
              FOR i := 1 TO MATRIX_CurrSetLength DO BEGIN
                IF NOT EVALUATE(progDate,MATRIX_CaptionSet[i]) THEN
                  progDate := 0D;
                IF NOT tempPrognosisLineCC.GET(TempProjDetail2."Project No.",progDate,TempProjDetail."Line No.") THEN
                  tempPrognosisLineCC."Actual Costs" := 0;
                IF tempPrognosisLine2.GET(TempProjDetail2."Project No.",progDate,LineNo) THEN
      //>>190219
      //            savePrognosisValue(TempProjDetail2."Project No.",progDate,TempProjDetail."Line No.",TRUE,tempPrognosisLineCC."Actual Costs"+tempPrognosisLine2."Actual Costs",0,TempProjDetail.Caption);
                  savePrognosisValue(TempProjDetail2."Project No.",progDate,TempProjDetail."Line No.",TRUE,tempPrognosisLineCC."Actual Costs"+tempPrognosisLine2."Actual Costs",0,'');
      //<<190219
              END;
            UNTIL TempProjDetail2.NEXT = 0;
          END;
        UNTIL TempProjDetail.NEXT = 0;
      END;
      TempProjDetail.RESET;
    END;

    PROCEDURE CodeLines@1100285003(UserId@1100285002 : Code[50];ProjNo@1100285001 : Code[20]);
    VAR
      PSum@1100285005 : Decimal;
      PSum2@1100285100 : Decimal;
      Strangen@1100285006 : Text;
      Line1@1100285007 : Integer;
      Operator1@1100285008 : Code[10];
      Line2@1100285010 : Integer;
      Operator2@1100285009 : Code[10];
      Line3@1100285012 : Integer;
      Operator3@1100285011 : Code[10];
      Line4@1100285014 : Integer;
      Operator4@1100285013 : Code[10];
      Line5@1100285015 : Integer;
      LO1@1100285016 : Decimal;
      LO2@1100285017 : Decimal;
      LO3@1100285018 : Decimal;
      LO4@1100285019 : Decimal;
      i@1100285104 : Integer;
      progDate@1100285101 : Date;
    BEGIN
      tempPrognosisLineCC.RESET;
      TempProjDetail.RESET;
      TempProjDetail.SETRANGE(UserID,UserId);
      TempProjDetail.SETRANGE("Project No.",ProjNo);
      TempProjDetail.SETRANGE("Code line",TRUE);
      TempProjDetail.SETFILTER(Calcualation,'<>%1','');
      IF TempProjDetail.FIND('-') THEN BEGIN
        REPEAT
          CLEAR(Line1);
          CLEAR(Line2);
          CLEAR(Line3);
          CLEAR(Line4);
          CLEAR(Line5);
          CLEAR(Operator1);
          CLEAR(Operator2);
          CLEAR(Operator3);
          CLEAR(Operator4);
          PSum := 0;
          Strangen := TempProjDetail.Calcualation;
          IF STRPOS(Strangen,';') > 0 THEN BEGIN
            EVALUATE(Line1,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
            Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
            IF STRPOS(Strangen,';') > 0 THEN BEGIN
              EVALUATE(Operator1,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
              Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
              IF STRPOS(Strangen,';') > 0 THEN BEGIN
                EVALUATE(Line2,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
              END ELSE BEGIN
                EVALUATE(Line2,Strangen);
              END;
              IF STRPOS(Strangen,';') > 0 THEN BEGIN
                EVALUATE(Operator2,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                IF STRPOS(Strangen,';') > 0 THEN BEGIN
                  EVALUATE(Line3,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                  Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                END ELSE BEGIN
                  EVALUATE(Line3,Strangen);
                END;
                IF STRPOS(Strangen,';') > 0 THEN BEGIN
                  EVALUATE(Operator3,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                  Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                  IF STRPOS(Strangen,';') > 0 THEN BEGIN
                    EVALUATE(Line4,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                    Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                  END ELSE BEGIN
                    EVALUATE(Line4,Strangen);
                  END;
                  IF STRPOS(Strangen,';') > 0 THEN BEGIN
                    EVALUATE(Operator4,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                    Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                    IF STRPOS(Strangen,';') > 0 THEN BEGIN
                      EVALUATE(Line5,COPYSTR(Strangen,1,STRPOS(Strangen,';')-1));
                      Strangen := COPYSTR(Strangen,STRPOS(Strangen,';')+1);
                    END ELSE BEGIN
                      EVALUATE(Line5,Strangen);
                    END;
                  END;
                END;
              END;
            END;
          END;
          FOR i := 1 TO MATRIX_CurrSetLength DO BEGIN
            IF NOT EVALUATE(progDate,MATRIX_CaptionSet[i]) THEN
              progDate :=0D;
            IF (Line1<>0) AND (Operator1<>'') AND (Line2<>0) AND (progDate<>0D) THEN BEGIN
              PSum := 0; PSum2 := 0;
              IF tempPrognosisLineCC.GET(TempProjDetail."Project No.",progDate,FORMAT(Line1,0,2)) THEN
                PSum := tempPrognosisLineCC."Actual Costs" ;
              IF tempPrognosisLineCC.GET(TempProjDetail."Project No.",progDate,FORMAT(Line2,0,2)) THEN
                PSum2 := tempPrognosisLineCC."Actual Costs" ;
              IF (Operator1 = '/') AND TempProjDetail.Procent THEN
                Operator1 := '%';
              PSum := ComputeCodeLines(PSum,Operator1,PSum2);
      //>>190219
      //        savePrognosisValue(TempProjDetail."Project No.",progDate,TempProjDetail."Line No.",TRUE,PSum,0,TempProjDetail.Caption);
              savePrognosisValue(TempProjDetail."Project No.",progDate,TempProjDetail."Line No.",TRUE,PSum,0,'');
      //<<190219
            END;
            IF (Operator2<>'') AND (Line3<>0) AND (progDate<>0D) THEN BEGIN
              PSum := 0; PSum2 := 0;
              IF tempPrognosisLineCC.GET(TempProjDetail."Project No.",progDate,FORMAT(TempProjDetail."Line No.",0,2)) THEN
                PSum := tempPrognosisLineCC."Actual Costs" ;
              IF tempPrognosisLineCC.GET(TempProjDetail."Project No.",progDate,FORMAT(Line3,0,2)) THEN
                PSum2 := tempPrognosisLineCC."Actual Costs" ;
              IF (Operator2 = '/') AND TempProjDetail.Procent THEN
                Operator2 := '%';
              PSum := ComputeCodeLines(PSum,Operator2,PSum2);
      //>>190219
      //        savePrognosisValue(TempProjDetail."Project No.",progDate,TempProjDetail."Line No.",TRUE,PSum,0,TempProjDetail.Caption);
              savePrognosisValue(TempProjDetail."Project No.",progDate,TempProjDetail."Line No.",TRUE,PSum,0,'');
      //<<190219
            END;
            IF (Operator3<>'') AND (Line4<>0) AND (progDate<>0D) THEN BEGIN
              PSum := 0; PSum2 := 0;
              IF tempPrognosisLineCC.GET(TempProjDetail."Project No.",progDate,FORMAT(TempProjDetail."Line No.",0,2)) THEN
                PSum := tempPrognosisLineCC."Actual Costs" ;
              IF tempPrognosisLineCC.GET(TempProjDetail."Project No.",progDate,FORMAT(Line4,0,2)) THEN
                PSum2 := tempPrognosisLineCC."Actual Costs" ;
              IF (Operator3 = '/') AND TempProjDetail.Procent THEN
                Operator3 := '%';
              PSum := ComputeCodeLines(PSum,Operator3,PSum2);
      //>>190219
      //        savePrognosisValue(TempProjDetail."Project No.",progDate,TempProjDetail."Line No.",TRUE,PSum,0,TempProjDetail.Caption);
              savePrognosisValue(TempProjDetail."Project No.",progDate,TempProjDetail."Line No.",TRUE,PSum,0,'');
      //<<190219
              tempPrognosisLineCC.RESET;
            END;
            IF (Operator4<>'') AND (Line5<>0) AND (progDate<>0D) THEN BEGIN
              PSum := 0; PSum2 := 0;
              IF tempPrognosisLineCC.GET(TempProjDetail."Project No.",progDate,FORMAT(TempProjDetail."Line No.",0,2)) THEN
                PSum := tempPrognosisLineCC."Actual Costs" ;
              IF tempPrognosisLineCC.GET(TempProjDetail."Project No.",progDate,FORMAT(Line5,0,2)) THEN
                PSum2 := tempPrognosisLineCC."Actual Costs" ;
              IF (Operator4 = '/') AND TempProjDetail.Procent THEN
                Operator4 := '%';
              PSum := ComputeCodeLines(PSum,Operator4,PSum2);
      //>>190219
      //        savePrognosisValue(TempProjDetail."Project No.",progDate,TempProjDetail."Line No.",TRUE,PSum,0,TempProjDetail.Caption);
              savePrognosisValue(TempProjDetail."Project No.",progDate,TempProjDetail."Line No.",TRUE,PSum,0,'');
      //>>190219
            END;
          END;
        UNTIL TempProjDetail.NEXT = 0;
      END;
      TempProjDetail.RESET;
    END;

    PROCEDURE SetUserData@1100285103(pUserID@1100285100 : Code[50];pLastPrognosisDate@1100285101 : Date);
    BEGIN
      gUSERID := pUserID;
      gLastPrognosisDate := pLastPrognosisDate;
    END;

    LOCAL PROCEDURE ComputeCodeLines@1100285110(Value1@1100285100 : Decimal;Operator@1100285101 : Text;Value2@1100285102 : Decimal) : Decimal;
    BEGIN
      CASE Operator OF
        '+': EXIT(Value1 + Value2);
        '-': EXIT(Value1 - Value2);
        '*': EXIT(Value1 * Value2);
        '/': IF (Value1 <> 0) AND (Value2 <> 0) THEN  EXIT(Value1 / Value2);
        '%': IF (Value1 <> 0) AND (Value2 <> 0) THEN  EXIT((Value1 / Value2)*100);
      END;
      EXIT(0);
    END;

    LOCAL PROCEDURE savePrognosisValue@1100285107(projNo@1100285100 : Code[20];progDate@1100285101 : Date;LineNo@1100285102 : Integer;SumAmount@1100285104 : Boolean;PSumA@1100285103 : Decimal;PSumQ@1100285105 : Decimal;pComment@1100285106 : Text);
    BEGIN
      IF NOT tempPrognosisLineCC.GET(projNo,progDate,FORMAT(LineNo,0,2)) THEN BEGIN
        tempPrognosisLineCC.INIT;
        tempPrognosisLineCC."Project No." := projNo;
        tempPrognosisLineCC."Prognosis Date" := progDate;
        tempPrognosisLineCC."Cost Component Code" := FORMAT(LineNo,0,2);
        tempPrognosisLineCC.INSERT(FALSE);
      END;
      IF SumAmount THEN
        tempPrognosisLineCC."Actual Costs" := PSumA
      ELSE
        tempPrognosisLineCC."Actual Hours" := PSumQ;
      tempPrognosisLineCC.Comment := pComment;
      tempPrognosisLineCC.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE MATRIX_OnAfterGetRecord@1135(ColumnNo@1010 : Integer);
    VAR
      PrognosisDetail@1100528700 : Record 11012884;
    BEGIN
      MATRIX_MatrixRecord := MATRIX_MatrixRecords[ColumnNo];

      tempPrognosisLineCC.SETRANGE("Prognosis Date", MATRIX_MatrixRecord."Period Start", MATRIX_MatrixRecord."Period End");
      tempPrognosisLineCC.SETRANGE("Cost Component Code",FORMAT(TempProjDetail."Line No.",0,2));
      tempPrognosisLineCC.CALCSUMS("Actual Costs","Actual Hours");

      MATRIX_CellData[ColumnNo] := tempPrognosisLineCC."Actual Costs";
      IF "Sum Quantity" THEN
        MATRIX_CellData[ColumnNo] := tempPrognosisLineCC."Actual Hours";

      //>>190219, BYGG006
      IF tempPrognosisLineCC.FINDSET THEN
        IF tempPrognosisLineCC.COUNT = 1 THEN
          MATRIX_CellDataText[ColumnNo] := tempPrognosisLineCC.Comment;
      //<<190219
    END;

    LOCAL PROCEDURE FindRec@59(VAR ProjectDetail@1001 : Record 11128083;Which@1002 : Text[250]) : Boolean;
    VAR
      Found@1100528700 : Boolean;
    BEGIN
      TempProjDetail.Hide := ProjectDetail.Hide;
      TempProjDetail."Cost Component Code" := FORMAT(TempProjDetail."Line No.",0,2);
      Which := '-';
      Found := TempProjDetail.FIND(Which);

      IF Found THEN BEGIN
        REPEAT
          tempPrognosisLineCC.SETRANGE("Project No.",TempProjDetail."Project No.");
          tempPrognosisLineCC.SETRANGE("Cost Component Code",FORMAT(TempProjDetail."Line No.",0,2));
          Found := NOT tempPrognosisLineCC.ISEMPTY;
          IF Found THEN BEGIN
            ProjectDetail.INIT;
            ProjectDetail.TRANSFERFIELDS(TempProjDetail);
            EXIT(Found);
          END;
        UNTIL (Found) OR (TempProjDetail.NEXT=0);
      END;

      IF Found THEN BEGIN
        ProjectDetail.INIT;
        ProjectDetail.TRANSFERFIELDS(TempProjDetail);
      END;
      EXIT(Found);
    END;

    LOCAL PROCEDURE NextRec@60(VAR ProjectDetail@1100285100 : Record 11128083;Steps@1002 : Integer) : Integer;
    VAR
      ResultSteps@1100528700 : Integer;
    BEGIN
      TempProjDetail."Cost Component Code" := FORMAT(TempProjDetail."Line No.",0,2);

      ResultSteps := TempProjDetail.NEXT(Steps);
      IF ResultSteps <> 0 THEN BEGIN
        REPEAT
          tempPrognosisLineCC.SETRANGE("Project No.",TempProjDetail."Project No.");
          tempPrognosisLineCC.SETRANGE("Cost Component Code",FORMAT(TempProjDetail."Line No.",0,2));
          IF NOT tempPrognosisLineCC.ISEMPTY THEN BEGIN
            ProjectDetail.INIT;
            ProjectDetail.TRANSFERFIELDS(TempProjDetail);
            EXIT(ResultSteps);
          END;
          ResultSteps+=1;
        UNTIL (TempProjDetail.NEXT=0);
      END;
      EXIT(0);
    END;

    PROCEDURE UpdatePage@1100285100();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE CreateExcel@1100285101();
    VAR
      ExcelBuffer@1100285100 : TEMPORARY Record 370;
      FileManagement@1100285101 : Codeunit 419;
      i@1100285102 : Integer;
      show_MatrixRecord@1100285103 : Boolean;
      ExcelFileName@1100285104 : Variant;
      plComment@1100285105 : Text;
    BEGIN
      ExcelBuffer.INIT;
      ExcelBuffer.ClearNewRow;

      TempProjDetail.RESET;
      IF TempProjDetail.FINDSET THEN BEGIN
        ExcelBuffer.NewRow;
        ExcelBuffer.AddColumn(TempProjDetail.FIELDCAPTION("Prognosis Cost Object"),FALSE,'',TRUE,FALSE,TRUE,'',1);
        ExcelBuffer.AddColumn(TempProjDetail.FIELDCAPTION(Caption),FALSE,'',TRUE,FALSE,TRUE,'',1);
        FOR i := 1 TO MATRIX_CurrSetLength DO BEGIN
          ExcelBuffer.AddColumn(MATRIX_CaptionSet[i],FALSE,'',TRUE,FALSE,TRUE,'',2);
          //>>190219, BYGG006
          IF Show_CellDataText THEN
            ExcelBuffer.AddColumn('',FALSE,'',TRUE,FALSE,TRUE,'',0);
          //<<190219, BYGG006
        END;
        ExcelBuffer.NewRow;

        ExcelBuffer.StartRange;
        REPEAT
          show_MatrixRecord := TempProjDetail.InOverview;
          FOR i := 1 TO MATRIX_CurrSetLength DO
            IF NOT show_MatrixRecord THEN BEGIN
              MATRIX_MatrixRecord := MATRIX_MatrixRecords[i];
              tempPrognosisLineCC.SETRANGE("Prognosis Date", MATRIX_MatrixRecord."Period Start", MATRIX_MatrixRecord."Period End");
              tempPrognosisLineCC.SETRANGE("Cost Component Code",FORMAT(TempProjDetail."Line No.",0,2));
              tempPrognosisLineCC.CALCSUMS("Actual Costs","Actual Hours");
              show_MatrixRecord := (tempPrognosisLineCC."Actual Costs" <> 0) OR (tempPrognosisLineCC."Actual Hours"<>0);
            END;

          IF show_MatrixRecord THEN BEGIN
            ExcelBuffer.NewRow;
            ExcelBuffer.AddColumn(TempProjDetail."Prognosis Cost Object",FALSE,'',TempProjDetail.InOverview,FALSE,FALSE,'',1);
            ExcelBuffer.AddColumn(TempProjDetail.Caption,FALSE,'',TempProjDetail.InOverview,FALSE,FALSE,'',1);
            FOR i := 1 TO MATRIX_CurrSetLength DO BEGIN

              MATRIX_MatrixRecord := MATRIX_MatrixRecords[i];

              tempPrognosisLineCC.SETRANGE("Prognosis Date", MATRIX_MatrixRecord."Period Start", MATRIX_MatrixRecord."Period End");
              tempPrognosisLineCC.SETRANGE("Cost Component Code",FORMAT(TempProjDetail."Line No.",0,2));
              tempPrognosisLineCC.CALCSUMS("Actual Costs","Actual Hours");

              MATRIX_CellData[i] := tempPrognosisLineCC."Actual Costs";
              IF "Sum Quantity" THEN
                MATRIX_CellData[i] := tempPrognosisLineCC."Actual Hours";
              ExcelBuffer.AddColumn(MATRIX_CellData[i],FALSE,'',TempProjDetail.InOverview,FALSE,FALSE,'### ### ##0',0);
              //>>190219, BYGG006
              IF Show_CellDataText THEN BEGIN
                plComment := '';
                IF tempPrognosisLineCC.FINDSET THEN
                  IF tempPrognosisLineCC.COUNT = 1 THEN
                    plComment := tempPrognosisLineCC.Comment;
                ExcelBuffer.AddColumn(plComment,FALSE,'',TempProjDetail.InOverview,FALSE,FALSE,'',0);
              END;
              //<<190219
            END;
          END;

        UNTIL TempProjDetail.NEXT=0;
      END;

      ExcelBuffer.CreateBook('',CurrPage.CAPTION);
      ExcelBuffer.WriteSheet('',COMPANYNAME,UserID);
      ExcelBuffer.CloseBook;
      ExcelBuffer.OpenExcel;
      // ExcelBuffer.GiveUserControl;
    END;

    PROCEDURE setShow_CellDataText@1100285134(pShow_CellDataText@1100285100 : Boolean);
    BEGIN
      //190219, BYGG006
      Show_CellDataText := pShow_CellDataText;
    END;

    BEGIN
    {
      180307 ORANGO.DL new prognosis overview

      tempPrognosisLineCC."Project No." := Prognosis."Project No.";
      tempPrognosisLineCC."Prognosis Date" := Prognosis."Prognosis Date";
      tempPrognosisLineCC."Cost Component Code" := TempProjDetail."Cost Component Code";
      tempPrognosisLineCC.Quantity := TempProjDetail."Line No.";
      tempPrognosisLineCC.Comment := PLCC.Comment;
      tempPrognosisLineCC."Actual Costs" := PSum
      tempPrognosisLineCC."Actual Hours" := PSum;

      190219 BYGG006 Add more columns 32->64 and comments
    }
    END.
  }
}

