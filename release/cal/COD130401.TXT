OBJECT Codeunit 130401 CAL Test Management
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Window@1006 : Dialog;
      Mode@1003 : 'Test,Publish';
      AddingTestCodeunitsMsg@1004 : TextConst '@@@={Locked};ENU=Adding Test Codeunits @1@@@@@@@;NLD=Adding Test Codeunits @1@@@@@@@';
      SelectTestsToRunQst@1000 : TextConst '@@@={Locked};ENU=Active &Line,Active &Codeunit,&All;NLD=Active &Line,Active &Codeunit,&All';
      SelectTestsToImportQst@1014 : TextConst '@@@={Locked};ENU=&Select Test Codeunits,&All Test Codeunits;NLD=&Select Test Codeunits,&All Test Codeunits';
      SelectTestsToImportFromTCMQst@1001 : TextConst '@@@={Locked};ENU=&Select Test Codeunits,&All Test Codeunits,&Get Tests Codeunits based on Modified Objects,Get Tests Codeunits based on Selected &Objects;NLD=&Select Test Codeunits,&All Test Codeunits,&Get Tests Codeunits based on Modified Objects,Get Tests Codeunits based on Selected &Objects';
      SelectCodeunitsToRunQst@1013 : TextConst '@@@={Locked};ENU=,Active &Codeunit,&All;NLD=,Active &Codeunit,&All';
      DefaultTxt@1005 : TextConst '@@@={Locked};ENU=DEFAULT;NLD=DEFAULT';
      DefaultSuiteTxt@1002 : TextConst '@@@={Locked};ENU=Default Suite - Autogenerated;NLD=Default Suite - Autogenerated';
      ObjectNotCompiledErr@1007 : TextConst '@@@={Locked};ENU=Object not compiled.;NLD=Object not compiled.';
      WindowUpdateDateTime@1010 : DateTime;
      NoOfRecords@1009 : Integer;
      i@1008 : Integer;
      AddingTestsBasedOnChurnMsg@1011 : TextConst '@@@={Locked};ENU=Adding %1 test codeunits based on churn @1@@@@@@@;NLD=Adding %1 test codeunits based on churn @1@@@@@@@';
      NoModifiedObjectsFoundMsg@1012 : TextConst '@@@={Locked};ENU=No modified objects found.;NLD=No modified objects found.';

    [External]
    PROCEDURE SETPUBLISHMODE@1();
    BEGIN
      Mode := Mode::Publish;
    END;

    [External]
    PROCEDURE SETTESTMODE@2();
    BEGIN
      Mode := Mode::Test;
    END;

    [External]
    PROCEDURE ISPUBLISHMODE@3() : Boolean;
    BEGIN
      EXIT(Mode = Mode::Publish);
    END;

    [External]
    PROCEDURE ISTESTMODE@4() : Boolean;
    BEGIN
      EXIT(Mode = Mode::Test);
    END;

    [External]
    PROCEDURE DoesTestCodeunitExist@25(ID@1000 : Integer) : Boolean;
    VAR
      AllObjWithCaption@1001 : Record 2000000058;
    BEGIN
      AllObjWithCaption.RESET;
      AllObjWithCaption.SETRANGE("Object ID",ID);
      AllObjWithCaption.SETRANGE("Object Type",AllObjWithCaption."Object Type"::Codeunit);
      AllObjWithCaption.SETRANGE("Object Subtype",'Test');
      EXIT(NOT AllObjWithCaption.ISEMPTY);
    END;

    PROCEDURE GetTestCodeunitsSelection@11(CALTestSuite@1001 : Record 130400);
    VAR
      CALTestLine@1003 : Record 130401;
      AllObjWithCaption@1006 : Record 2000000058;
      TempAllObjWithCaption@1004 : TEMPORARY Record 2000000058;
      CALTestCoverageMap@1005 : Record 130406;
      CALTestGetCodeunits@1002 : Page 130403;
      Selection@1000 : Integer;
    BEGIN
      IF CALTestCoverageMap.ISEMPTY THEN
        Selection := STRMENU(SelectTestsToImportQst,1)
      ELSE
        Selection := STRMENU(SelectTestsToImportFromTCMQst,1);

      IF Selection = 0 THEN
        EXIT;

      CASE Selection OF
        1:
          BEGIN
            CALTestGetCodeunits.LOOKUPMODE := TRUE;
            IF CALTestGetCodeunits.RUNMODAL = ACTION::LookupOK THEN BEGIN
              CALTestGetCodeunits.SETSELECTIONFILTER(AllObjWithCaption);
              AddTestCodeunits(CALTestSuite,AllObjWithCaption);
            END;
          END;
        2:
          BEGIN
            CALTestLine.SETRANGE("Test Suite",CALTestSuite.Name);
            CALTestLine.DELETEALL(TRUE);
            IF GetTestCodeunits(TempAllObjWithCaption) THEN
              RefreshSuite(CALTestSuite,TempAllObjWithCaption);
          END;
        3:
          GetTestCodeunitsForModifiedObjects(CALTestSuite.Name);
        4:
          GetTestCodeunitsForSelectedObjects(CALTestSuite.Name);
      END;
    END;

    LOCAL PROCEDURE GetTestCodeunits@6(VAR ToAllObjWithCaption@1000 : Record 2000000058) : Boolean;
    VAR
      FromAllObjWithCaption@1001 : Record 2000000058;
    BEGIN
      WITH ToAllObjWithCaption DO BEGIN
        FromAllObjWithCaption.SETRANGE("Object Type","Object Type"::Codeunit);
        FromAllObjWithCaption.SETRANGE("Object Subtype",'Test');
        IF FromAllObjWithCaption.FIND('-') THEN
          REPEAT
            ToAllObjWithCaption := FromAllObjWithCaption;
            INSERT;
          UNTIL FromAllObjWithCaption.NEXT = 0;
      END;

      EXIT(ToAllObjWithCaption.FIND('-'));
    END;

    LOCAL PROCEDURE GetTestCodeunitsForObjects@22(VAR Object@1005 : Record 2000000001;CALTestSuiteName@1007 : Code[10]);
    VAR
      TempMissingCUId@1004 : TEMPORARY Record 2000000026;
      TempTestCodeunitID@1008 : TEMPORARY Record 2000000026;
      CALTestMissingCodeunits@1002 : Page 130404;
      TestLineNo@1001 : Integer;
      TestCodeunitsNumber@1000 : Integer;
    BEGIN
      Object.SETFILTER(Type,'<>%1',Object.Type::TableData);
      IF Object.FINDSET THEN BEGIN
        TestCodeunitsNumber := GetTotalTestCodeunitIDs(Object,TempTestCodeunitID);
        OpenWindow(STRSUBSTNO(AddingTestsBasedOnChurnMsg,TestCodeunitsNumber),TestCodeunitsNumber);
        TestLineNo := GetLastTestLineNo(CALTestSuiteName);
        IF TempTestCodeunitID.FINDSET THEN
          REPEAT
            IF DoesTestCodeunitExist(TempTestCodeunitID.Number) THEN BEGIN
              IF NOT TestLineExists(CALTestSuiteName,TempTestCodeunitID.Number) THEN BEGIN
                TestLineNo := TestLineNo + 10000;
                AddTestLine(CALTestSuiteName,TempTestCodeunitID.Number,TestLineNo);
                UpdateWindow;
              END
            END ELSE BEGIN
              TempMissingCUId.Number := TempTestCodeunitID.Number;
              TempMissingCUId.INSERT;
            END;
          UNTIL TempTestCodeunitID.NEXT = 0;
        Window.CLOSE;
      END ELSE
        MESSAGE(NoModifiedObjectsFoundMsg);

      IF NOT TempMissingCUId.ISEMPTY THEN BEGIN
        COMMIT;
        CALTestMissingCodeunits.Initialize(TempMissingCUId,CALTestSuiteName);
        CALTestMissingCodeunits.RUNMODAL;
      END;
    END;

    LOCAL PROCEDURE GetTestCodeunitsForModifiedObjects@14(CALTestSuiteName@1003 : Code[10]);
    VAR
      Object@1000 : Record 2000000001;
    BEGIN
      Object.SETRANGE(Modified,TRUE);
      GetTestCodeunitsForObjects(Object,CALTestSuiteName);
    END;

    LOCAL PROCEDURE GetTestCodeunitsForSelectedObjects@21(CALTestSuiteName@1000 : Code[10]);
    VAR
      Object@1006 : Record 2000000001;
      CALTestObjectsToSelect@1008 : Page 130407;
    BEGIN
      CALTestObjectsToSelect.LOOKUPMODE := TRUE;
      CALTestObjectsToSelect.SETTABLEVIEW(Object);
      IF CALTestObjectsToSelect.RUNMODAL = ACTION::LookupOK THEN BEGIN
        CALTestObjectsToSelect.SETSELECTIONFILTER(Object);
        GetTestCodeunitsForObjects(Object,CALTestSuiteName);
      END;
    END;

    LOCAL PROCEDURE GetTotalTestCodeunitIDs@23(VAR Object@1000 : Record 2000000001;VAR TestCodeunitID@1002 : Record 2000000026) : Integer;
    VAR
      CALTestCoverageMap@1001 : Record 130406;
    BEGIN
      REPEAT
        CALTestCoverageMap.RESET;
        CALTestCoverageMap.SETRANGE("Object ID",Object.ID);
        CALTestCoverageMap.SETRANGE("Object Type",Object.Type);
        IF CALTestCoverageMap.FINDSET THEN
          REPEAT
            IF NOT TestCodeunitID.GET(CALTestCoverageMap."Test Codeunit ID") THEN BEGIN
              TestCodeunitID.Number := CALTestCoverageMap."Test Codeunit ID";
              TestCodeunitID.INSERT;
            END;
          UNTIL CALTestCoverageMap.NEXT = 0;
      UNTIL Object.NEXT = 0;
      EXIT(TestCodeunitID.COUNT);
    END;

    LOCAL PROCEDURE GetLastTestLineNo@15(TestSuiteName@1001 : Code[10]) LineNo : Integer;
    VAR
      CALTestLine@1000 : Record 130401;
    BEGIN
      CALTestLine.SETRANGE("Test Suite",TestSuiteName);
      IF CALTestLine.FINDLAST THEN
        LineNo := CALTestLine."Line No.";
    END;

    PROCEDURE CreateNewSuite@5(VAR NewSuiteName@1006 : Code[10]);
    VAR
      CALTestSuite@1001 : Record 130400;
    BEGIN
      WITH CALTestSuite DO BEGIN
        NewSuiteName := DefaultTxt;
        INIT;
        VALIDATE(Name,NewSuiteName);
        VALIDATE(Description,DefaultSuiteTxt);
        VALIDATE(Export,FALSE);
        INSERT(TRUE);
      END;
    END;

    LOCAL PROCEDURE RefreshSuite@7(CALTestSuite@1000 : Record 130400;VAR AllObjWithCaption@1005 : Record 2000000058);
    VAR
      CALTestLine@1004 : Record 130401;
      LineNo@1001 : Integer;
    BEGIN
      WITH CALTestLine DO BEGIN
        LineNo := LineNo + 10000;

        INIT;
        VALIDATE("Test Suite",CALTestSuite.Name);
        VALIDATE("Line No.",LineNo);
        VALIDATE("Line Type","Line Type"::Group);
        VALIDATE(Name,DefaultSuiteTxt);
        VALIDATE(Run,TRUE);
        INSERT(TRUE);

        AddTestCodeunits(CALTestSuite,AllObjWithCaption);
      END;
    END;

    PROCEDURE AddTestCodeunits@10(CALTestSuite@1001 : Record 130400;VAR AllObjWithCaption@1000 : Record 2000000058);
    VAR
      TestLineNo@1002 : Integer;
    BEGIN
      IF AllObjWithCaption.FIND('-') THEN BEGIN
        TestLineNo := GetLastTestLineNo(CALTestSuite.Name);
        OpenWindow(AddingTestCodeunitsMsg,AllObjWithCaption.COUNT);
        REPEAT
          TestLineNo := TestLineNo + 10000;
          AddTestLine(CALTestSuite.Name,AllObjWithCaption."Object ID",TestLineNo);
          UpdateWindow;
        UNTIL AllObjWithCaption.NEXT = 0;
        Window.CLOSE;
      END;
    END;

    PROCEDURE AddMissingTestCodeunits@16(VAR TestCodeunitIds@1001 : Record 2000000026;TestSuiteName@1000 : Code[10]);
    VAR
      Object@1003 : Record 2000000001;
      TestLineNo@1002 : Integer;
    BEGIN
      TestLineNo := GetLastTestLineNo(TestSuiteName);
      OpenWindow(STRSUBSTNO(AddingTestsBasedOnChurnMsg,TestCodeunitIds.COUNT),TestCodeunitIds.COUNT);

      REPEAT
        Object.SETRANGE(Type,Object.Type::Codeunit);
        Object.SETRANGE(ID,TestCodeunitIds.Number);
        IF Object.FINDFIRST THEN BEGIN
          TestLineNo := TestLineNo + 10000;
          AddTestLine(TestSuiteName,Object.ID,TestLineNo);
          UpdateWindow;
          TestCodeunitIds.DELETE;
        END;
      UNTIL TestCodeunitIds.NEXT = 0;

      Window.CLOSE;
    END;

    LOCAL PROCEDURE AddTestLine@20(TestSuiteName@1001 : Code[10];TestCodeunitId@1002 : Integer;LineNo@1000 : Integer);
    VAR
      CALTestLine@1003 : Record 130401;
      AllObj@1004 : Record 2000000038;
      Object@1005 : Record 2000000001;
      CodeunitIsValid@1006 : Boolean;
    BEGIN
      WITH CALTestLine DO BEGIN
        IF TestLineExists(TestSuiteName,TestCodeunitId) THEN
          EXIT;

        INIT;
        VALIDATE("Test Suite",TestSuiteName);
        VALIDATE("Line No.",LineNo);
        VALIDATE("Line Type","Line Type"::Codeunit);
        VALIDATE("Test Codeunit",TestCodeunitId);
        VALIDATE(Run,TRUE);

        INSERT(TRUE);

        AllObj.SETRANGE("Object Type",AllObj."Object Type"::Codeunit);
        AllObj.SETRANGE("Object ID",TestCodeunitId);
        IF FORMAT(AllObj."App Package ID") <> '' THEN
          CodeunitIsValid := TRUE;

        IF NOT CodeunitIsValid THEN BEGIN
          Object.SETRANGE(Type,Object.Type::Codeunit);
          Object.SETRANGE(ID,TestCodeunitId);
          CodeunitIsValid := Object.FINDFIRST;
        END;

        IF CodeunitIsValid THEN BEGIN
          SETPUBLISHMODE;
          SETRECFILTER;
          CODEUNIT.RUN(CODEUNIT::"CAL Test Runner",CALTestLine);
        END ELSE BEGIN
          VALIDATE(Result,Result::Failure);
          VALIDATE("First Error",ObjectNotCompiledErr);
          MODIFY(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE TestLineExists@17(TestSuiteName@1000 : Code[10];TestCodeunitId@1001 : Integer) : Boolean;
    VAR
      CALTestLine@1002 : Record 130401;
    BEGIN
      CALTestLine.SETRANGE("Test Suite",TestSuiteName);
      CALTestLine.SETRANGE("Test Codeunit",TestCodeunitId);
      EXIT(NOT CALTestLine.ISEMPTY);
    END;

    [External]
    PROCEDURE ExtendTestCoverage@18(TestCodeunitId@1000 : Integer);
    VAR
      CodeCoverage@1001 : Record 2000000049;
      CALTestCoverageMap@1002 : Record 130406;
    BEGIN
      CodeCoverage.SETRANGE("Line Type",CodeCoverage."Line Type"::Object);
      IF CodeCoverage.FINDSET THEN
        REPEAT
          IF NOT CALTestCoverageMap.GET(TestCodeunitId,CodeCoverage."Object Type",CodeCoverage."Object ID") THEN BEGIN
            CALTestCoverageMap.INIT;
            CALTestCoverageMap."Test Codeunit ID" := TestCodeunitId;
            CALTestCoverageMap."Object Type" := CodeCoverage."Object Type";
            CALTestCoverageMap."Object ID" := CodeCoverage."Object ID";
            CALTestCoverageMap.INSERT;
          END;
        UNTIL CodeCoverage.NEXT = 0;
    END;

    LOCAL PROCEDURE GetLineNoFilter@31(CALTestLine@1000 : Record 130401;Selection@1003 : ',Function,Codeunit') LineNoFilter : Text;
    VAR
      NoOfFunctions@1002 : Integer;
    BEGIN
      LineNoFilter := '';
      CASE Selection OF
        Selection::"Function":
          BEGIN
            CALTestLine.TESTFIELD("Line Type",CALTestLine."Line Type"::"Function");
            LineNoFilter := FORMAT(CALTestLine."Line No.");
            CALTestLine.RESET;
            CALTestLine.SETRANGE("Test Suite",CALTestLine."Test Suite");
            CALTestLine.SETRANGE("Test Codeunit",CALTestLine."Test Codeunit");
            CALTestLine.SETFILTER("Function",'OnRun|%1','');
            CALTestLine.FINDSET;
            REPEAT
              LineNoFilter := LineNoFilter + '|' + FORMAT(CALTestLine."Line No.");
            UNTIL CALTestLine.NEXT = 0;
          END;
        Selection::Codeunit:
          LineNoFilter :=
            STRSUBSTNO('%1..%2',CALTestLine.GetMinCodeunitLineNo,CALTestLine.GetMaxCodeunitLineNo(NoOfFunctions));
      END;
    END;

    [External]
    PROCEDURE RunSelected@19(VAR CurrCALTestLine@1000 : Record 130401);
    VAR
      CALTestLine@1004 : Record 130401;
      CodeunitIsMarked@1002 : Boolean;
      LastCodeunitID@1003 : Integer;
      LineNoFilter@1006 : Text;
      Selection@1001 : ',Function,Codeunit';
      Separator@1005 : Text[1];
    BEGIN
      IF CurrCALTestLine.ISEMPTY THEN
        EXIT;
      CALTestLine.COPY(CurrCALTestLine);
      Separator := '';
      LineNoFilter := '';
      CALTestLine.FINDSET;
      REPEAT
        IF CALTestLine."Line Type" = CALTestLine."Line Type"::Codeunit THEN BEGIN
          LineNoFilter := LineNoFilter + Separator + GetLineNoFilter(CALTestLine,Selection::Codeunit);
          LastCodeunitID := CALTestLine."Test Codeunit";
          CodeunitIsMarked := TRUE;
        END ELSE BEGIN
          IF LastCodeunitID <> CALTestLine."Test Codeunit" THEN BEGIN
            LastCodeunitID := CALTestLine."Test Codeunit";
            LineNoFilter := LineNoFilter + Separator + GetLineNoFilter(CALTestLine,Selection::"Function");
            CodeunitIsMarked := FALSE;
          END ELSE
            IF NOT CodeunitIsMarked THEN
              LineNoFilter := LineNoFilter + Separator + FORMAT(CALTestLine."Line No.")
        END;
        Separator := '|';
      UNTIL CALTestLine.NEXT = 0;

      CALTestLine.RESET;
      CALTestLine.SETRANGE("Test Suite",CurrCALTestLine."Test Suite");
      CALTestLine.SETFILTER("Line No.",LineNoFilter);
      RunSuite(CALTestLine,TRUE);
    END;

    [External]
    PROCEDURE RunSuiteYesNo@9(VAR CurrCALTestLine@1003 : Record 130401);
    VAR
      CALTestLine@1001 : Record 130401;
      Selection@1005 : ',Function,Codeunit';
      LineNoFilter@1000 : Text;
    BEGIN
      IF CurrCALTestLine.ISEMPTY THEN
        EXIT;
      CALTestLine.COPY(CurrCALTestLine);
      IF CALTestLine."Line Type" = CALTestLine."Line Type"::Codeunit THEN
        Selection := STRMENU(SelectCodeunitsToRunQst,2)
      ELSE
        Selection := STRMENU(SelectTestsToRunQst,1);

      IF Selection = 0 THEN
        EXIT;

      LineNoFilter := GetLineNoFilter(CALTestLine,Selection);
      IF LineNoFilter <> '' THEN
        CALTestLine.SETFILTER("Line No.",LineNoFilter);
      RunSuite(CALTestLine,TRUE);
    END;

    [External]
    PROCEDURE RunSuite@8(VAR CALTestLine@1003 : Record 130401;IsTestMode@1004 : Boolean);
    VAR
      CALTestLine2@1002 : Record 130401;
      CALTestRunner@1000 : Codeunit 130400;
    BEGIN
      IF IsTestMode THEN BEGIN
        SETTESTMODE;
        CALTestRunner.RUN(CALTestLine);
      END ELSE BEGIN
        SETPUBLISHMODE;
        CALTestLine2.COPY(CALTestLine);
        CALTestLine2.SETRANGE("Line No.",CALTestLine."Line No.");
        CALTestLine2.TESTFIELD("Test Codeunit");
        CALTestLine2.TESTFIELD("Function",'');

        CALTestLine.DeleteChildren;
        CALTestLine2.DeleteChildren;

        CALTestRunner.RUN(CALTestLine2);
      END;
      CLEAR(CALTestRunner);
    END;

    LOCAL PROCEDURE OpenWindow@13(DisplayText@1001 : Text;NoOfRecords2@1000 : Integer);
    BEGIN
      i := 0;
      NoOfRecords := NoOfRecords2;
      WindowUpdateDateTime := CURRENTDATETIME;
      Window.OPEN(DisplayText);
    END;

    LOCAL PROCEDURE UpdateWindow@12();
    BEGIN
      i := i + 1;
      IF CURRENTDATETIME - WindowUpdateDateTime >= 1000 THEN BEGIN
        WindowUpdateDateTime := CURRENTDATETIME;
        Window.UPDATE(1,ROUND(i / NoOfRecords * 10000,1));
      END;
    END;

    [External]
    PROCEDURE EnableTestToRun@26();
    VAR
      CALTestEnabledCodeunit@1001 : Record 130403;
      AllObjWithCaption@1000 : Record 2000000058;
    BEGIN
      CALTestEnabledCodeunit.DELETEALL;
      AllObjWithCaption.SETRANGE("Object Type",AllObjWithCaption."Object Type"::Codeunit);
      AllObjWithCaption.SETRANGE("Object Subtype",'Test');
      IF AllObjWithCaption.FINDSET THEN
        REPEAT
          CALTestEnabledCodeunit."No." := 0;
          CALTestEnabledCodeunit."Test Codeunit ID" := AllObjWithCaption."Object ID";
          CALTestEnabledCodeunit.INSERT;
        UNTIL AllObjWithCaption.NEXT = 0;
    END;

    PROCEDURE ExportTCM@24(FileName@1000 : Text);
    VAR
      CALTestCoverageMap@1003 : XMLport 130406;
      OutStream@1002 : OutStream;
      File@1001 : File;
    BEGIN
      IF FileName = '' THEN
        EXIT;

      IF EXISTS(FileName) THEN
        ERASE(FileName);

      IF File.CREATE(FileName) THEN BEGIN
        File.CREATEOUTSTREAM(OutStream);
        CALTestCoverageMap.SETDESTINATION(OutStream);
        CALTestCoverageMap.IMPORTFILE(FALSE);
        CALTestCoverageMap.EXPORT;
        File.CLOSE;
      END;
    END;

    PROCEDURE ExportTestResults@27(FileName@1000 : Text;SkipPassed@1006 : Boolean;LastTestRun@1005 : Boolean);
    VAR
      CALExportTestResult@1003 : XMLport 130403;
      OutStream@1002 : OutStream;
      File@1001 : File;
    BEGIN
      IF FileName = '' THEN
        EXIT;

      IF EXISTS(FileName) THEN
        ERASE(FileName);

      IF File.CREATE(FileName) THEN BEGIN
        File.CREATEOUTSTREAM(OutStream);
        CALExportTestResult.SetParam(SkipPassed,LastTestRun);
        CALExportTestResult.SETDESTINATION(OutStream);
        CALExportTestResult.IMPORTFILE(FALSE);
        CALExportTestResult.EXPORT;
        File.CLOSE;
      END;
    END;

    PROCEDURE ImportTestToRun@28(FileName@1001 : Text;Clean@1004 : Boolean);
    VAR
      CALTestEnabledCodeunit@1005 : Record 130403;
      CALImportEnabledCodeunit@1003 : XMLport 130402;
      InStream@1002 : InStream;
      File@1000 : File;
    BEGIN
      IF FileName = '' THEN
        EXIT;

      IF NOT EXISTS(FileName) THEN
        EXIT;

      IF Clean THEN
        CALTestEnabledCodeunit.DELETEALL;

      File.WRITEMODE(FALSE);
      File.OPEN(FileName);
      File.CREATEINSTREAM(InStream);
      CALImportEnabledCodeunit.SETSOURCE(InStream);
      CALImportEnabledCodeunit.IMPORTFILE(TRUE);
      CALImportEnabledCodeunit.IMPORT;
      File.CLOSE;
    END;

    BEGIN
    END.
  }
}

