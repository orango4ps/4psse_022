OBJECT Page 981 Payment Registration
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Register Customer Payments;
               NOR=Registrer kundebetalinger;
               SVE=Registrera kundbetalningar];
    ApplicationArea=#Basic,#Suite;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table981;
    DataCaptionExpr=BalAccCaption;
    PageType=Worksheet;
    UsageCategory=Tasks;
    SourceTableTemporary=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Posting,Navigate,Search,Setup,Line;
                                NOR=Ny,Prosess,Rapport,Bokfõring,Naviger,Sõk,Oppsett,Linje;
                                SVE=Ny,Process,Rapport,Bokfîring,Navigera,Sîk,InstÑllningar,Rad];
    OnOpenPage=BEGIN
                 PaymentRegistrationMgt.RunSetup;
                 FormatPageCaption;
               END;

    OnFindRecord=BEGIN
                   Reload;
                   PaymentRegistrationMgt.CalculateBalance(PostedBalance,UnpostedBalance);
                   TotalBalance := PostedBalance + UnpostedBalance;
                   EXIT(FIND(Which));
                 END;

    OnAfterGetRecord=BEGIN
                       SetUserInteractions;
                     END;

    OnQueryClosePage=BEGIN
                       EXIT(PaymentRegistrationMgt.ConfirmClose(Rec));
                     END;

    ActionList=ACTIONS
    {
      { 37      ;    ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 21      ;1   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon;
                                 SVE=Relaterad information];
                      Image=Navigate }
      { 30      ;2   ;Action    ;
                      Name=Navigate;
                      CaptionML=[ENU=Navigate;
                                 NOR=Naviger;
                                 SVE=Analysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppfõringer og dokumenter som finnes for dokumentnummeret og bokfõringsdatoen i den valgte oppfõringen eller dokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet fîr den valda transaktionen eller det valda dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Category8;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 28      ;2   ;Action    ;
                      Name=Details;
                      CaptionML=[ENU=Details;
                                 NOR=Detaljer;
                                 SVE=Detaljer];
                      ToolTipML=[ENU=View additional information about the document on the selected line and link to the related customer card.;
                                 NOR=Vis tilleggsinformasjon om dokumentet pÜ den valgte linjen, og koble til det tilknyttede kundekortet.;
                                 SVE=Visa ytterligare information om dokumentet pÜ den valda raden och lÑnka den till det relaterade kundkortet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewDetails;
                      PromotedCategory=Category8;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"Payment Registration Details",Rec);
                               END;
                                }
      { 46      ;1   ;ActionGroup;
                      CaptionML=[ENU=Search;
                                 NOR=Sõk;
                                 SVE=Sîk] }
      { 16      ;2   ;Action    ;
                      Name=SearchCustomer;
                      CaptionML=[ENU=Search Customers;
                                 NOR=Sõk i kunder;
                                 SVE=Sîk efter kunder];
                      ToolTipML=[ENU=Open the list of customers, for example, to check for missing payments from a specific customer.;
                                 NOR=èpne listen over kunder, eksempelvis for Ü se etter manglende betalinger fra en bestemt kunde.;
                                 SVE=ôppna listan med kunder, till exempel fîr att kontrollera saknade betalningar frÜn en specifik kund.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 22;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Category6 }
      { 17      ;2   ;Action    ;
                      Name=SearchDocument;
                      CaptionML=[ENU=Search Documents;
                                 NOR=Sõk i dokumenter;
                                 SVE=Sîk efter dokument];
                      ToolTipML=[ENU=Find documents that are not fully invoiced, for example, to post an invoice so that the received payment can be processed.;
                                 NOR=Finn dokumenter som ikke er fullstendig fakturert, for eksempel for Ü bokfõre en faktura slik at den mottatte betalingen kan behandles.;
                                 SVE=Sîk efter dokument som inte Ñr helt fakturerade, till exempel fîr att bokfîra en faktura sÜ att den erhÜllna betalningen kan bearbetas.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 985;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Category6 }
      { 13      ;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 14      ;1   ;ActionGroup;
                      CaptionML=[ENU=Post;
                                 NOR=Bokfõr;
                                 SVE=Bokfîr];
                      Image=Post }
      { 15      ;2   ;Action    ;
                      Name=PostPayments;
                      ShortCutKey=F9;
                      CaptionML=[ENU=Post Payments;
                                 NOR=Bokfõr betalinger;
                                 SVE=Bokfîr betalningar];
                      ToolTipML=[ENU=Post payment of amounts on the lines where the Payment Made check box is selected.;
                                 NOR=Bokfõr betalinger av belõp pÜ linjene hvor det er merket av for Betaling utfõrt.;
                                 SVE=Bokfîr betalningar av belopp pÜ raderna dÑr kryssrutan fîr utfîrd betalning Ñr markerad.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 PaymentRegistrationMgt.ConfirmPost(Rec);
                               END;
                                }
      { 22      ;2   ;Action    ;
                      Name=PostAsLump;
                      CaptionML=[ENU=Post as Lump Payment;
                                 NOR=Bokfõr som engangsbetaling;
                                 SVE=Bokfîr som en betalning av klumpsumma];
                      ToolTipML=[ENU=Post payment as a lump sum of amounts on lines where the Payment Made check box is selected.;
                                 NOR=Bokfõr en betaling som et engangsbelõp pÜ linjer hvor det er merket av for Betaling utfõrt.;
                                 SVE=Bokfîr betalningar som en klumpsumma med belopp pÜ raderna dÑr kryssrutan fîr utfîrd betalning Ñr markerad.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostBatch;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 PaymentRegistrationMgt.ConfirmPostLumpPayment(Rec);
                               END;
                                }
      { 25      ;2   ;Action    ;
                      Name=PreviewPayments;
                      CaptionML=[ENU=Preview Posting Payments;
                                 NOR=ForhÜndsvise bokfõring av betalinger;
                                 SVE=Fîrhandsgranska bokfîringsbetalningar];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet nÜr du bokfõrer dokumentet eller kladden.;
                                 SVE=Granska de olika typerna av transaktioner som skapas nÑr du bokfîr dokumentet eller journalen. NÑr du utfîr den faktiska bokfîringen kan du bli tillfrÜgad om hur transaktioner fîr betalningstolerans ska bokfîras. Fîrhandsgranskningen av bokfîringen utgÜr frÜn standardalternativet: att varje betalningstolerans bokfîrs som en transaktion.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ViewPostedOrder;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 PaymentRegistrationMgt@1000 : Codeunit 980;
                               BEGIN
                                 PaymentRegistrationMgt.Preview(Rec,FALSE);
                               END;
                                }
      { 39      ;2   ;Action    ;
                      Name=PreviewLump;
                      CaptionML=[ENU=Preview Posting Payments as Lump;
                                 NOR=ForhÜndsvise bokfõring av betalinger som engangsbetaling;
                                 SVE=Fîrhandsgranska bokfîringsbetalningar i klump];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal as a lump sum of amounts.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet nÜr du bokfõrer dokumentet eller kladden som et engangsbelõp.;
                                 SVE=Granska de olika typerna av transaktioner som skapas nÑr du bokfîr dokumentet eller journalen som en klumpsumma. NÑr du utfîr den faktiska bokfîringen kan du bli tillfrÜgad om hur transaktioner fîr betalningstolerans ska bokfîras. Fîrhandsgranskningen av bokfîringen utgÜr frÜn standardalternativet: att varje betalningstolerans bokfîrs som en transaktion.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ViewPostedOrder;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 PaymentRegistrationMgt@1000 : Codeunit 980;
                               BEGIN
                                 PaymentRegistrationMgt.Preview(Rec,TRUE);
                               END;
                                }
      { 38      ;1   ;ActionGroup;
                      CaptionML=[ENU=New Documents;
                                 NOR=Nye bilag;
                                 SVE=Nya dokument] }
      { 19      ;2   ;Action    ;
                      Name=OpenGenJnl;
                      CaptionML=[ENU=General Journal;
                                 NOR=Finanskladd;
                                 SVE=Redovisningsjournal];
                      ToolTipML=[ENU=Open the general journal, for example, to record or post a payment that has no related document.;
                                 NOR=èpne finanskladden, for eksempel for Ü registrere eller bokfõre en betaling som ikke har noe tilknyttet dokument.;
                                 SVE=ôppna redovisningsjournalen, till exempel fîr att registrera eller bokfîra en betalning utan relaterat dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=GLRegisters;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 PaymentRegistrationMgt.OpenGenJnl
                               END;
                                }
      { 18      ;2   ;Action    ;
                      Name=FinanceChargeMemo;
                      CaptionML=[ENU=Finance Charge Memo;
                                 NOR=Rentenota;
                                 SVE=RÑntefaktura];
                      ToolTipML=[ENU=Create a finance charge memo for the customer on the selected line, for example, to issue a finance charge for late payment.;
                                 NOR=Opprett en rentenota for kunden pÜ den valgte linjen, for eksempel for Ü utstede en rentebelastning for forsinket betaling.;
                                 SVE=Skapa en rÑntefaktura fîr kunden pÜ den valda raden, till exempel fîr att utfÑrda en rÑntefaktura fîr en sen betalning.];
                      ApplicationArea=#Suite;
                      RunObject=Page 446;
                      RunPageLink=Customer No.=FIELD(Source No.);
                      Promoted=Yes;
                      Image=FinChargeMemo;
                      PromotedCategory=New;
                      RunPageMode=Create;
                      Scope=Repeater }
      { 36      ;1   ;ActionGroup;
                      CaptionML=[ENU=Setup;
                                 NOR=Oppsett;
                                 SVE=InstÑllning];
                      Image=Setup }
      { 31      ;2   ;Action    ;
                      Name=Setup;
                      CaptionML=[ENU=Setup;
                                 NOR=Oppsett;
                                 SVE=InstÑllning];
                      ToolTipML=[ENU=Adjust how payments are posted and which balancing account to use.;
                                 NOR=Juster hvordan betalinger skal bokfõres og hvilken motkonto som skal brukes.;
                                 SVE=Anpassa hur betalningar bokfîrs och vilket balanskonto som ska anvÑndas.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Setup;
                      OnAction=BEGIN
                                 IF PAGE.RUNMODAL(PAGE::"Payment Registration Setup") = ACTION::LookupOK THEN
                                   FormatPageCaption
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the source document that the entry originates from.;
                           NOR=Angir nummeret for kildedokumentet som oppfõringen er hentet fra.;
                           SVE=Anger numret pÜ kÑlldokumentet som transaktionen kommer frÜn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Source No.";
                Visible=FALSE;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                DrillDown=Yes;
                ToolTipML=[ENU=Specifies the name of the customer or vendor that the payment relates to.;
                           NOR=Angir navnet pÜ kunden eller leverandõren som betalingen er relatert til.;
                           SVE=Anger namnet pÜ kunden eller leverantîren som betalningen avser.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Name;
                Editable=FALSE;
                OnDrillDown=VAR
                              Customer@1000 : Record 18;
                            BEGIN
                              Customer.GET("Source No.");
                              PAGE.RUN(PAGE::"Customer Card",Customer);
                            END;
                             }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the document that the payment relates to.;
                           NOR=Angir nummeret for dokumentet som betalingen er relatert til.;
                           SVE=Anger numret pÜ dokumentet som betalningen avser.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document No.";
                Visible=FALSE;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              Navigate;
                            END;
                             }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of document that the payment relates to.;
                           NOR=Angir dokumenttypen som betalingen er relatert til.;
                           SVE=Anger typ av dokumentet som betalningen avser.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Type";
                Visible=FALSE;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the invoice transaction that the payment relates to.;
                           NOR=Angir fakturatransaksjonen som betalingen er relatert til.;
                           SVE=Anger fakturatransaktionen som betalningen avser.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment due date on the related document.;
                           NOR=Angir forfallsdatoen for betalingen for det relaterte dokumentet.;
                           SVE=Anger betalningens fîrfallodatum i relaterat dokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Editable=FALSE;
                StyleExpr=DueDateStyle }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be paid on the document.;
                           NOR=Angir belõpet som gjenstÜr Ü bli betalt i dokumentet.;
                           SVE=Anger beloppet som ÜterstÜr att betala i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Amount";
                Editable=FALSE;
                StyleExpr=PmtDiscStyle }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if you have received or made payment for the document.;
                           NOR=Angir om du har mottatt eller utfõrt betalingen for dokumentet.;
                           SVE=Anger om du har erhÜllit eller betalat enligt dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Made";
                OnValidate=BEGIN
                             SetUserInteractions;
                           END;
                            }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the payment was made.;
                           NOR=Angir datoen da betalingen ble utfõrt.;
                           SVE=Anger datumet dÜ betalningen utfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Date Received";
                StyleExpr=DueDateStyle;
                OnValidate=BEGIN
                             SetUserInteractions;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that is paid in the bank account.;
                           NOR=Angir belõpet som er betalt pÜ bankkontoen.;
                           SVE=Anger vilket belopp som betalas i bankkontot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Received";
                OnValidate=BEGIN
                             SetUserInteractions;
                           END;
                            }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                           NOR=Angir datoen da belõpet i posten mÜ vëre betalt for at det kan oppnÜs kontantrabatt.;
                           SVE=Anger datumet dÜ transaktionens belopp mÜste vara betalt fîr att orderns kassarabatt ska gÑlla.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date";
                AutoFormatType=1;
                Visible=FALSE;
                StyleExpr=PmtDiscStyle;
                OnValidate=BEGIN
                             SetUserInteractions
                           END;
                            }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Rem Amount Incl. Discount;
                           NOR=Restbelõp inkl. rabatt;
                           SVE=èterstÜende belopp inkl. rabatt];
                ToolTipML=[ENU=Specifies the remaining amount after the payment discount is deducted.;
                           NOR=Angir restbelõpet etter at kontantrabatten er trukket fra.;
                           SVE=Anger det ÜterstÜende beloppet efter avdragen kassarabatt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Rem. Amt. after Discount";
                Visible=FALSE;
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                Name=ExternalDocumentNo;
                CaptionML=[ENU=External Document No.;
                           NOR=Eksterndokumentnr.;
                           SVE=Externt dokumentnr];
                ToolTipML=[ENU=Specifies a document number that refers to the customer's or vendor's numbering system.;
                           NOR=Angir et dokumentnummer som henviser til kundens eller leverandõrens nummereringssystem.;
                           SVE=Anger ett dokumentnummer som refererar till kundens eller leverantîrens nummersystem.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No." }

    { 32  ;1   ;Group     ;
                CaptionML=[ENU=Bal. Account Details;
                           NOR=Motregningskontodetaljer;
                           SVE=Motkontoinformation];
                GroupType=GridLayout }

    { 33  ;2   ;Field     ;
                Name=PostedBalance;
                CaptionML=[ENU=Posted Balance;
                           NOR=Bokfõrt saldo;
                           SVE=Bokfîrd balans];
                ToolTipML=[ENU=Specifies the balance of payments posted to the balancing account that is being used in the Payment Registration window.;
                           NOR=Angir saldoen for betalinger som er bokfõrt til motkontoen som brukes i vinduet Betalingsregistrering.;
                           SVE=Anger saldot fîr bokfîrda betalningar i balanskontot som anvÑnds i fînstret Betalningsregistrering.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=PostedBalance;
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                Name=UnpostedBalance;
                CaptionML=[ENU=Unposted Balance;
                           NOR=Ikke-bokfõrt saldo;
                           SVE=Ej bokfîrd balans];
                ToolTipML=[ENU=Specifies the amount that exists on unposted journal lines with the same balancing account as the one used in the Payment Registration window.;
                           NOR=Angir belõpet som finnes pÜ kladdelinjer som ikke er bokfõrt, med samme motkonto som motkontoen som ble brukt i vinduet Betalingsregistrering.;
                           SVE=Anger det belopp som finns pÜ ej bokfîrda journalrader i samma balanskonto som anvÑnds i fînstret Betalningsregistrering.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=UnpostedBalance;
                Editable=FALSE }

    { 35  ;2   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           NOR=Total saldo;
                           SVE=Totalt saldo];
                ToolTipML=[ENU=Specifies the sum of posted amounts and unposted journal line amounts for the balancing account that is being used on the Payment Registration page. The value in this field is the sum of values in the Posted Balance and the Unposted Balance fields.;
                           NOR=Angir summen av bokfõrte belõp og kladdelinjebelõp som ikke er bokfõrt, for motkontoen som blir brukt pÜ siden Betalingsregistrering. Verdien i dette feltet er summen av verdier i feltene Bokfõrt saldo og Ikke-bokfõrte saldo.;
                           SVE=Anger summan av bokfîrda belopp och ej bokfîrda belopp pÜ journalrader i det balanskonto som anvÑnds pÜ sidan Betalningsregistrering. VÑrdet i det hÑr fÑltet Ñr lika med summan av vÑrdena i fÑlten Bokfîrd balans och Ej bokfîrd balans.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalBalance;
                Importance=Promoted;
                Editable=FALSE }

    { 27  ;1   ;Group      }

    { 26  ;2   ;Group     ;
                GroupType=FixedLayout }

    { 24  ;3   ;Group     ;
                GroupType=Group }

    { 23  ;4   ;Field     ;
                ToolTipML=[ENU=Specifies a warning about the payment, such as past due date.;
                           NOR=Angir en advarsel om betalingen, for eksempel at forfallsdato er overskredet.;
                           SVE=Anger en varning om betalningen, som t.ex. har fîrfallit.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Warning;
                Editable=FALSE;
                Style=Unfavorable;
                StyleExpr=TRUE }

  }
  CODE
  {
    VAR
      PaymentRegistrationMgt@1001 : Codeunit 980;
      BalAccCaption@1002 : Text;
      PmtDiscStyle@1000 : Text;
      DueDateStyle@1004 : Text;
      Warning@1003 : Text;
      PostedBalance@1005 : Decimal;
      UnpostedBalance@1006 : Decimal;
      TotalBalance@1007 : Decimal;

    LOCAL PROCEDURE FormatPageCaption@1();
    VAR
      PaymentRegistrationSetup@1000 : Record 980;
    BEGIN
      PaymentRegistrationSetup.GET(USERID);
      BalAccCaption := FORMAT(PaymentRegistrationSetup."Bal. Account Type") + ' - ' + PaymentRegistrationSetup."Bal. Account No.";
    END;

    LOCAL PROCEDURE SetUserInteractions@2();
    BEGIN
      PmtDiscStyle := GetPmtDiscStyle;
      DueDateStyle := GetDueDateStyle;
      Warning := GetWarning;
    END;

    BEGIN
    END.
  }
}

