OBJECT Page 6086323 Expense Allocation Inbox
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EMW16.00.10.3.00;
  }
  PROPERTIES
  {
    Permissions=TableData 6086320=r;
    CaptionML=[DEU=Ausgabenzuordnung;
               ENU=Expense Allocation;
               NLD=Uitgaveallocatie];
    SourceTable=Table6086322;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnOpenPage=BEGIN
                 ExpInboxEntryNo := GETRANGEMIN("Inbox Entry No.");
                 ExpInbox.GET(ExpInboxEntryNo);

                 ExpInbox.CALCFIELDS("Continia User Name");
                 CurrPage.EDITABLE := (NOT (ExpInbox.Status = ExpInbox.Status::Accepted)) AND (NOT ReadOnly);

                 IF ISEMPTY AND (NOT (ExpInbox.Status = ExpInbox.Status::Accepted)) AND (NOT ReadOnly) THEN BEGIN
                   UpdateRemAmount;
                   InitRecFromExpInbox;
                   INSERT(TRUE);
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       UpdateRemAmount;
                     END;

    OnNewRecord=BEGIN
                  UpdateRemAmount;
                  InitRecFromExpInbox;
                END;

    OnInsertRecord=BEGIN
                     UpdateRemAmount;
                     CurrPage.UPDATE(FALSE);
                     EXIT(TRUE);
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT CurrPage.EDITABLE THEN
                         EXIT;

                       DeleteAutoGeneratedEntries;
                       EXIT(ValidateAllocationConsistency(TRUE));
                       EXIT(TRUE);
                     END;

    ActionList=ACTIONS
    {
      { 1160040018;  ;ActionContainer;
                      Name=RelatedInformation;
                      CaptionML=;
                      ActionContainerType=RelatedInformation }
      { 1160040016;1 ;ActionGroup;
                      Name=Line;
                      CaptionML=[DEU=Zeile;
                                 ENU=Line;
                                 NLD=Regel] }
      { 1160040014;2 ;Action    ;
                      Name=Dimensions;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions;
                                 NLD=Dimensies];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDimensions(ReadOnly);
                               END;
                                }
      { 1160040007;2 ;Action    ;
                      Name=Attendees;
                      CaptionML=[DEU=Statusfilter;
                                 ENU=Attendees;
                                 NLD=Deelnemers];
                      Image=Users;
                      OnAction=BEGIN
                                 DrillDownAttendees;
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 1160040012;1;Group  ;
                CaptionML=[DEU=Allgemein;
                           ENU=General;
                           NLD=Algemeen] }

    { 1160040004;2;Field  ;
                Name=Expense Continia User ID;
                CaptionML=[DEU=Continia-Benutzer-ID;
                           ENU=Continia User ID;
                           NLD=Continia gebruikers-id];
                SourceExpr=ExpInbox."Continia User ID";
                Editable=false }

    { 1160040003;2;Field  ;
                Name=Expense Name;
                CaptionML=[DEU=Name;
                           ENU=Name;
                           NLD=Naam];
                SourceExpr=ExpInbox."Continia User Name";
                Editable=false }

    { 1160040021;2;Field  ;
                Name=Expense Description;
                CaptionML=[DEU=Beschreibung;
                           ENU=Description;
                           NLD=Omschrijving];
                SourceExpr=ExpInbox.Description;
                Editable=FALSE }

    { 1160040008;2;Field  ;
                Name=Expense Document Date;
                CaptionML=[DEU=Belegdatum;
                           ENU=Document Date;
                           NLD=Documentdatum];
                SourceExpr=ExpInbox."Document Date";
                Editable=FALSE }

    { 1160040031;2;Group  ;
                GroupType=Group }

    { 1160040015;3;Field  ;
                Name=Expense Currency Code;
                CaptionML=[DEU=W„hrungscode;
                           ENU=Currency Code;
                           NLD=Valutacode];
                SourceExpr=ExpInbox."Currency Code";
                Editable=FALSE }

    { 1160040017;3;Field  ;
                Name=Expense Amount;
                CaptionML=[DEU=Betrag;
                           ENU=Amount;
                           NLD=Bedrag];
                SourceExpr=ExpInbox.Amount;
                AutoFormatType=1;
                AutoFormatExpr=ExpInbox."Currency Code";
                Editable=FALSE }

    { 1160040019;3;Field  ;
                Name=Expense Remaining Amount;
                CaptionML=[DEU=Restbetrag;
                           ENU=Remaining Amount;
                           NLD=Resterend bedrag];
                SourceExpr=RemainingAmount;
                AutoFormatType=1;
                AutoFormatExpr=ExpInbox."Currency Code";
                Editable=FALSE }

    { 1160040000;1;Group  ;
                GroupType=Repeater }

    { 1160040023;2;Field  ;
                Name=Continia User ID;
                SourceExpr="Continia User ID" }

    { 1160040020;2;Field  ;
                Name=Expense Type;
                SourceExpr="Expense Type" }

    { 1160040005;2;Field  ;
                Name=Description;
                SourceExpr=Description;
                Visible=false }

    { 1160040006;2;Field  ;
                Name=Description 2;
                SourceExpr="Description 2";
                Visible=false }

    { 1160040002;2;Field  ;
                Name=Attendees;
                CaptionML=[DEU=Statusfilter;
                           ENU=Attendees;
                           NLD=Deelnemers];
                SourceExpr=GetAttendeesForDisplay;
                OnDrillDown=BEGIN
                              DrillDownAttendees;
                              CurrPage.UPDATE;
                            END;
                             }

    { 1160040025;2;Field  ;
                Name=Amount;
                SourceExpr=Amount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040001;2;Field  ;
                Name=Amount %;
                SourceExpr="Amount %";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040026;2;Field  ;
                Name=Global Dimension 1 Code;
                SourceExpr="Global Dimension 1 Code" }

    { 1160040027;2;Field  ;
                Name=Global Dimension 2 Code;
                SourceExpr="Global Dimension 2 Code" }

    { 1160040009;2;Field  ;
                SourceExpr="Admin Comment" }

    { 1160040024;2;Field  ;
                Name=Job No.;
                SourceExpr="Job No." }

    { 1160040022;2;Field  ;
                Name=Job Task No.;
                SourceExpr="Job Task No." }

    { 1160040034;2;Field  ;
                Name=Billable;
                SourceExpr=Billable;
                Visible=false }

    { 1160040035;2;Field  ;
                Name=Job Line Type;
                SourceExpr="Job Line Type";
                Visible=false }

    { 3   ;2   ;Field     ;
                Name=Cash/Private Card;
                SourceExpr="Cash/Private Card" }

  }
  CODE
  {
    VAR
      ExpInbox@1160040000 : Record 6086323;
      RemainingAmount@1160040001 : Decimal;
      ExpInboxEntryNo@1160040004 : Integer;
      ReadOnly@1160040006 : Boolean;

    LOCAL PROCEDURE UpdateRemAmount@1160040006();
    VAR
      ExpAllocInbox@1160040000 : Record 6086322;
    BEGIN
      ExpAllocInbox.SETCURRENTKEY("Table ID","Inbox Entry No.");
      ExpAllocInbox.SETRANGE("Table ID",DATABASE::"Expense Inbox");
      ExpAllocInbox.SETRANGE("Inbox Entry No.",ExpInboxEntryNo);
      ExpAllocInbox.CALCSUMS(Amount);

      RemainingAmount := ExpInbox.Amount - ExpAllocInbox.Amount;
    END;

    LOCAL PROCEDURE InitRecFromExpInbox@1160040002();
    BEGIN
      Rec.InitFromExpInbox(Rec,ExpInbox);
      VALIDATE(Amount,RemainingAmount);
    END;

    BEGIN
    END.
  }
}

