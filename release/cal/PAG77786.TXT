OBJECT Page 77786 NAV Translation Workbench
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=TTool,4PSSE;
  }
  PROPERTIES
  {
    SourceTable=Table77786;
    SourceTableView=SORTING(Project Code,Language ID,Object ID);
    PageType=Worksheet;
    UsageCategory=Tasks;
    OnInit=BEGIN
             TTProject.SETRANGE(Active,TRUE);
             TTProject.FINDFIRST;
           END;

    OnOpenPage=BEGIN
                 SetFilters;
               END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("Alt. Search Caption");
                     END;

    ActionList=ACTIONS
    {
      { 1100525012;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100525049;1 ;ActionGroup;
                      CaptionML=[ENU=General;
                                 SVE=Allm„nt] }
      { 1100525050;2 ;Action    ;
                      Name=Count Captions;
                      CaptionML=ENU=Count Captions;
                      Image=Calculate;
                      OnAction=BEGIN
                                 MESSAGE(FORMAT(COUNT));
                               END;
                                }
      { 1100525059;2 ;Action    ;
                      Name=Calculate Probability;
                      CaptionML=ENU=Calculate Probability;
                      Image=Calculate;
                      OnAction=VAR
                                 TTCaption@1100525000 : Record 77786;
                                 CalculateProbability@1100525001 : Report 77782;
                               BEGIN
                                 CalculateProbability.SetTTProject(TTProject);
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 CalculateProbability.SETTABLEVIEW(TTCaption);
                                 CalculateProbability.RUNMODAL;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100285001;2 ;Action    ;
                      Name=Swap Translation - Source;
                      Image=SwitchCompanies;
                      OnAction=VAR
                                 TargID@1100285000 : Code[10];
                               BEGIN
                                 //TTProject.GET("Project Code");
                                 GetTTProject;
                                 TargID := TTProject."Target Language ID";
                                 TTProject."Target Language ID" := TTProject."Source Language ID";
                                 TTProject."Source Language ID" := TargID;
                                 TTProject.MODIFY;
                                 SetFilters;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100285002;2 ;Action    ;
                      Name=Swap Translation - Third;
                      OnAction=VAR
                                 TargID@1100285000 : Code[10];
                               BEGIN
                                 //TTProject.GET("Project Code");
                                 GetTTProject;
                                 TargID := TTProject."Target Language ID";
                                 TTProject."Target Language ID" := TTProject."Third Language ID";
                                 TTProject."Third Language ID" := TargID;
                                 TTProject.MODIFY;
                                 SetFilters;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525023;1 ;ActionGroup;
                      CaptionML=ENU=Translate }
      { 1100525048;2 ;Action    ;
                      Name=4PS Create Missing Captions;
                      CaptionML=ENU=Create Missing Captions 4PS;
                      Promoted=Yes;
                      Image=New;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TTTranslationManagement.CreateMissingCaptions(TTProject);
                               END;
                                }
      { 1101285003;2 ;Action    ;
                      Name=Create Missing Captions;
                      CaptionML=ENU=Create Missing Captions;
                      Promoted=Yes;
                      Image=New;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //TTTranslationManagement.CreateMissingCaptions(TTProject);
                                 CLEAR(TTNAVDLTools);
                                 TTNAVDLTools.createMissingEmptyCaptions("Project Code",TRUE);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525013;2 ;Action    ;
                      Name=Full Caption Text;
                      CaptionML=ENU=Full Caption Text;
                      RunObject=Page 77788;
                      RunPageLink=Project Code=FIELD(Project Code),
                                  Language ID=FIELD(Language ID),
                                  Object ID=FIELD(Object ID),
                                  Project Code=FIELD(Project Code),
                                  Language Filter=FIELD(Language Filter),
                                  Third Language Filter=FIELD(Third Language Filter);
                      Promoted=Yes;
                      Image=Text;
                      PromotedCategory=Process }
      { 1100525045;2 ;Action    ;
                      Name=Copy Caption;
                      CaptionML=ENU=Copy Caption;
                      Image=Copy;
                      OnAction=VAR
                                 TTCaption@1100525000 : Record 77786;
                                 CopyCaptions@1100525001 : Report 77784;
                               BEGIN
                                 CopyCaptions.SetTTProject(TTProject);
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 // If there is 1 record selected, the language filters are not copied.
                                 TTCaption.SETFILTER("Language Filter", Rec.GETFILTER("Language Filter"));
                                 TTCaption.SETFILTER("Third Language Filter", Rec.GETFILTER("Third Language Filter"));
                                 CopyCaptions.SETTABLEVIEW(TTCaption);
                                 CopyCaptions.RUNMODAL;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525047;2 ;Action    ;
                      Name=Clear Translation;
                      CaptionML=ENU=Clear Translation Caption;
                      Image=Delete;
                      OnAction=BEGIN
                                 ClearTranslationCaption;
                               END;
                                }
      { 1100525043;2 ;Action    ;
                      Name=Mark Unique Captions;
                      CaptionML=ENU=Mark Unique Captions in Project '~';
                      Promoted=Yes;
                      Image=SelectEntries;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //MarkUniqueCaptions;
                                 CLEAR(TTNAVDLTools);
                                 TTNAVDLTools.MarkUntranslatedUniqueEntries("Project Code",TRUE);
                               END;
                                }
      { 1100525055;2 ;Action    ;
                      Name=4PS Translate from Captions in Project;
                      CaptionML=ENU=4PS Translate from Captions in Project;
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AutoTranslate(0);
                               END;
                                }
      { 1100525040;2 ;Action    ;
                      Name=Translate from Other Project 4PS;
                      CaptionML=ENU=4PS Translate from Other Project;
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TTCaption@1001 : Record 77786;
                                 TranslateFromOtherProject@1000 : Report 77787;
                               BEGIN
                                 TranslateFromOtherProject.SetTTProject(TTProject);
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 TranslateFromOtherProject.SETTABLEVIEW(TTCaption);
                                 TranslateFromOtherProject.RUNMODAL;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1101285002;2 ;Action    ;
                      Name=Translate from Captions in Project;
                      CaptionML=ENU=SQL Translate from Captions in Project 'œ';
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //AutoTranslate(0);
                                 CLEAR(TTNAVDLTools);
                                 //TTProject.GET("Project Code");
                                 GetTTProject;
                                 TTNAVDLTools.SQLAutoTranslateOnCaption(TTProject.Code,TTProject.Code,TTProject."Target Language ID",TTProject."Source Language ID");
                               END;
                                }
      { 1101285000;2 ;Action    ;
                      Name=Translate from Other Project;
                      CaptionML=ENU=SQL Translate from Other Project 'œ';
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TTCaption@1001 : Record 77786;
                                 TranslateFromOtherProject@1000 : Report 77787;
                               BEGIN
                                 CLEAR(TTNAVDLTools);
                                 //TTProject.GET("Project Code");
                                 GetTTProject;
                                 TTNAVDLTools.SQLAutoTranslateOnCaption(TTProject.Code,TTProject."source other project",TTProject."Target Language ID",TTProject."Source Language ID");

                                 CurrPage.UPDATE;
                               END;
                                }
      { 1101285001;2 ;Action    ;
                      Name=rename localizatons;
                      Image=PostBatch;
                      OnAction=BEGIN
                                 CLEAR(TTNAVDLTools);
                                 TTNAVDLTools.renumberlocalizations("Project Code");
                               END;
                                }
      { 1100525022;1 ;ActionGroup;
                      CaptionML=[ENU=Check;
                                 SVE=Check] }
      { 6       ;2   ;ActionGroup;
                      Name=Option Strings;
                      CaptionML=ENU=Option Strings;
                      Image=Approve }
      { 1100525010;3 ;Action    ;
                      Name=Check Option Strings;
                      CaptionML=ENU=Check Option Strings '!)';
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TTCaption@1100525000 : Record 77786;
                                 CheckOptionStrings@1100525001 : Report 77781;
                               BEGIN
                                 CheckOptionStrings.SetTTProject(TTProject);
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 CheckOptionStrings.SETTABLEVIEW(TTCaption);
                                 CheckOptionStrings.RUNMODAL;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100528501;3 ;Action    ;
                      Name=MarkRowsWithSpaceAfterComma;
                      CaptionML=ENU=Check Space After Comma;
                      Image=Approve;
                      OnAction=VAR
                                 TTNAVCaption@1100528500 : Record 77786;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(TTNAVCaption);
                                 TTNAVCaption.SETFILTER("Object ID", '*P8632*|*P8630*');// check this
                                 REPORT.RUN(REPORT::CheckForSpaceAfterComma,TRUE,FALSE,TTNAVCaption);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=Check Changed Source Caption;
                      CaptionML=ENU=Check Changed Source Caption;
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TTCaption@1000 : Record 77786;
                                 CheckChangedCaptions@1001 : Report 77788;
                               BEGIN
                                 CheckChangedCaptions.SetTTProject(TTProject);
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 CheckChangedCaptions.SETTABLEVIEW(TTCaption);
                                 CheckChangedCaptions.RUNMODAL;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525011;2 ;Action    ;
                      Name=Equalize Spaces;
                      CaptionML=ENU=Equalize Spaces between Captions;
                      Promoted=Yes;
                      Image=LinkWithExisting;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TTCaption@1100525000 : Record 77786;
                                 EqualizeSpaces@1100525001 : Report 77783;
                               BEGIN
                                 EqualizeSpaces.SetTTProject(TTProject);
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 EqualizeSpaces.SETTABLEVIEW(TTCaption);
                                 EqualizeSpaces.RUNMODAL;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525042;2 ;Action    ;
                      Name=Different Source/Translation;
                      CaptionML=ENU=Different Source and Translation;
                      Image=CheckList;
                      OnAction=BEGIN
                                 TagSourceTranslationCaptionDiffs;
                               END;
                                }
      { 7       ;2   ;ActionGroup;
                      Name=Equal captions;
                      CaptionML=ENU=Equal captions;
                      Image=CheckDuplicates }
      { 4       ;3   ;Action    ;
                      Name=Equal Source/Translation;
                      CaptionML=ENU=Equal Source and Translation;
                      Image=CheckDuplicates;
                      OnAction=BEGIN
                                 TagSourceTranslationCaptionEqual;
                               END;
                                }
      { 1100528500;3 ;Action    ;
                      Name=Equal Source/Third;
                      CaptionML=ENU=Equal Source and Third Caption;
                      Image=CheckDuplicates;
                      OnAction=VAR
                                 TTNAVCaption@1100528500 : Record 77786;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(TTNAVCaption);
                                 TTNAVCaption.SETFILTER("Language Filter", Rec.GETFILTER("Language Filter"));
                                 TTNAVCaption.SETFILTER("Third Language Filter", Rec.GETFILTER("Third Language Filter"));
                                 REPORT.RUN(REPORT::CheckSameThirdCaption,TRUE,FALSE,TTNAVCaption);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525038;1 ;ActionGroup;
                      CaptionML=[ENU=Tag;
                                 SVE=Kod] }
      { 1100525039;2 ;Action    ;
                      Name=Fill Tag;
                      CaptionML=ENU=Fill Tag;
                      Promoted=Yes;
                      Image=FilterLines;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TTCaption@1100525000 : Record 77786;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 REPORT.RUN(REPORT::"Fill Tag in NAV Captions",TRUE,FALSE,TTCaption);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525019;2 ;Action    ;
                      Name=Clear Tag;
                      CaptionML=ENU=Clear Tag;
                      Promoted=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TTCaption@1100525000 : Record 77786;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 REPORT.RUN(REPORT::"Clear Tag in NAV Captions",TRUE,FALSE,TTCaption);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525018;2 ;Action    ;
                      Name=Copy Tag to Source Language Caption;
                      CaptionML=ENU=Copy Tag to Source Language Caption;
                      Image=Copy;
                      OnAction=BEGIN
                                 CopyTagToSrcLangCaption;
                               END;
                                }
      { 1100525024;1 ;ActionGroup;
                      CaptionML=[ENU=Import/Export;
                                 SVE=Importera,exportera] }
      { 1100525031;2 ;ActionGroup;
                      CaptionML=ENU=Translate Text File;
                      Image=ImportExport }
      { 1100525004;3 ;Action    ;
                      Name=Import Translate Text File;
                      CaptionML=ENU=Import Translate Text File;
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportTranslateTextFile@1000 : Report 77786;
                               BEGIN
                                 ImportTranslateTextFile.SetTTProject(TTProject);
                                 ImportTranslateTextFile.RUNMODAL;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525020;3 ;Action    ;
                      Name=Export Translate Text File;
                      CaptionML=ENU=Export Translate Text File;
                      Promoted=Yes;
                      Image=ExportFile;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TTCaption@1100409000 : Record 77786;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 XMLPORT.RUN(XMLPORT::"Export Translate Text File",TRUE,FALSE,TTCaption);
                               END;
                                }
      { 1101285008;3 ;Action    ;
                      Name=Export All Captions To Excel;
                      Image=Report;
                      OnAction=VAR
                                 ExportallTTNAVCaptions@1101285000 : Report 77788;
                               BEGIN
                                 ExportallTTNAVCaptions.RUNMODAL;
                               END;
                                }
      { 1100525032;2 ;ActionGroup;
                      CaptionML=ENU=Captions XML File;
                      Image=ImportExport }
      { 1100525033;3 ;Action    ;
                      Name=Import XML File;
                      CaptionML=ENU=Import Captions from XML File;
                      Image=Import;
                      OnAction=VAR
                                 ImportCaptionsXMLFile@1000 : XMLport 77789;
                               BEGIN
                                 ImportCaptionsXMLFile.SetTTProject(TTProject);
                                 ImportCaptionsXMLFile.RUN;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525034;3 ;Action    ;
                      Name=Export XML File;
                      CaptionML=ENU=Export Captions as XML File;
                      Image=ExportFile;
                      OnAction=VAR
                                 TTCaption@1100409000 : Record 77786;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 XMLPORT.RUN(XMLPORT::"Export Captions as XML",TRUE,FALSE,TTCaption);
                               END;
                                }
      { 1100525051;2 ;ActionGroup;
                      CaptionML=ENU=Tags XML File;
                      Image=ImportExport }
      { 1100525052;3 ;Action    ;
                      Name=Import Tags XML File;
                      CaptionML=ENU=Import Tags in Captions from XML File;
                      Image=Import;
                      OnAction=VAR
                                 ImportTagsInCaptionsXML@1000 : XMLport 77791;
                               BEGIN
                                 ImportTagsInCaptionsXML.SetTTProject(TTProject);
                                 ImportTagsInCaptionsXML.RUN;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100525057;3 ;Action    ;
                      Name=Export Tags XML File;
                      CaptionML=ENU=Export Tags in Captions as XML File;
                      Image=ExportFile;
                      OnAction=VAR
                                 TTCaption@1100409000 : Record 77786;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(TTCaption);
                                 XMLPORT.RUN(XMLPORT::"Export Tags in Captions as XML",TRUE,FALSE,TTCaption);
                               END;
                                }
      { 1101285004;2 ;Action    ;
                      Name=export tagged to text;
                      Image=ExportDatabase;
                      OnAction=BEGIN
                                 TTNAVDLTools.sendOptionStringsToExcel("Project Code",TRUE);
                               END;
                                }
      { 1000000004;1 ;ActionGroup;
                      CaptionML=ENU=Fast filters }
      { 1000000005;2 ;Action    ;
                      Name=Filter untranslated w source;
                      OnAction=BEGIN
                                 SETFILTER(Caption1,'%1','');
                                 SETFILTER("Alt. Caption1",'<>%1','');
                               END;
                                }
      { 1000000007;2 ;Action    ;
                      Name=Filter translated;
                      OnAction=BEGIN
                                 SETFILTER(Caption1,'<>%1','');
                                 SETFILTER("Alt. Caption1",'');
                               END;
                                }
      { 1000000006;2 ;Action    ;
                      Name=remove filters;
                      CaptionML=SVE=Ta Bort Filter;
                      Image=Cancel;
                      OnAction=BEGIN
                                 SETRANGE(Caption1);
                                 SETRANGE("Alt. Caption1");
                                 SETRANGE(Status);
                                 SETRANGE(Tag2);
                                 SETRANGE("Last Modified");

                                 SetFilters;
                               END;
                                }
      { 1100409004;2 ;Action    ;
                      Name=toggle filter tag2;
                      OnAction=BEGIN
                                 IF GETFILTER(Tag2) = '' THEN
                                   SETFILTER(Tag2,'<>%1','')
                                 ELSE
                                   SETFILTER(Tag2,'');
                               END;
                                }
      { 1101285005;2 ;Action    ;
                      Name=filter before export;
                      Image=Approve;
                      OnAction=BEGIN
                                 SETFILTER(Caption1,'<>%1','');
                                 //SETFILTER("Alt. Caption1",'<>%1','');
                                 SETRANGE(Status,Status::Modified,Status::Approved);
                                 SETFILTER("Last Modified", '1..');
                                 SETRANGE("Language ID");
                               END;
                                }
      { 1100525061;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525062;1 ;Action    ;
                      Name=Captions for Object;
                      CaptionML=ENU=Captions for Object ID;
                      RunObject=Page 77789;
                      RunPageView=SORTING(Project Code,Language ID,Object ID);
                      RunPageLink=Object ID=FIELD(Object ID);
                      Image=Text }
      { 1101285006;1 ;Action    ;
                      Name=Captions for Object Caption;
                      CaptionML=ENU=Captions for Object Source;
                      RunObject=Page 77789;
                      RunPageView=SORTING(Project Code,Language ID,Object ID);
                      RunPageLink=Alt. Caption1=FIELD(Alt. Caption1),
                                  Language ID=FIELD(Language ID);
                      Image=Text }
      { 1100525017;1 ;Action    ;
                      Name=Dictionary;
                      CaptionML=ENU=Dictionary;
                      RunObject=Page 77790;
                      RunPageView=SORTING(Language ID,Search Caption);
                      RunPageLink=Language ID=FIELD(Language Filter),
                                  Search Caption=FIELD(Alt. Search Caption),
                                  Language Filter=FIELD(Language ID);
                      Promoted=Yes;
                      Image=SourceDocLine;
                      PromotedCategory=Process }
      { 3       ;1   ;Action    ;
                      Name=Default Translations;
                      CaptionML=ENU=Default Translations;
                      RunObject=Page 77783;
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process }
      { 1101285007;1 ;ActionGroup }
      { 1101285010;2 ;Action    ;
                      Name=spara objektDatumTid;
                      Image=Save;
                      OnAction=VAR
                                 TTNAVDLTools@1101285000 : Codeunit 77799;
                               BEGIN
                                 TTNAVDLTools.sparaObjektDatumTid;
                               END;
                                }
      { 1101285009;2 ;Action    ;
                      Name=†terst„ll objektDatumTid;
                      Image=Restore;
                      OnAction=VAR
                                 TTNAVDLTools@1101285000 : Codeunit 77799;
                               BEGIN
                                 TTNAVDLTools.†terst„llObjektDatumTid;
                               END;
                                }
      { 1100285100;2 ;Action    ;
                      Name=get from this DB;
                      OnAction=BEGIN
                                 TTNAVDLTools.getCaptionsFromThisDB("Project Code");
                               END;
                                }
      { 1100285101;2 ;Action    ;
                      Name=Table Field Translation List;
                      CaptionML=SVE=Tabellf„lt ”vers„ttningslista;
                      RunObject=Page 11126607 }
      { 1100285102;2 ;Action    ;
                      Name=FillCaptionsFromThisDB;
                      Promoted=Yes;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 TTNAVDLTools.FillCaptionsFromThisDB("Project Code");
                               END;
                                }
      { 1100285103;2 ;Action    ;
                      Name=removeLockedCaptions;
                      OnAction=BEGIN
                                 TTNAVDLTools.removeLockedCaptions("Project Code");
                               END;
                                }
      { 1100285104;2 ;Action    ;
                      Name=getOptions2Lang3;
                      OnAction=VAR
                                 fldRef@1100285101 : FieldRef;
                                 TTNAVCaption@1100285102 : Record 77786;
                                 TTNAVCaption3@1100285103 : Record 77786;
                                 TTLanguage@1100285104 : Record 77781;
                                 tableNo@1100285105 : Integer;
                                 fldNo@1100285106 : Integer;
                                 txtPart@1100285107 : Text;
                                 lField@1100285100 : Record 2000000041;
                               BEGIN
                                 IF NOT TTLanguage.GET('3') THEN BEGIN
                                   TTLanguage.Code := 'options';
                                   TTLanguage.ID := '3';
                                   TTLanguage.INSERT;
                                 END;

                                 TTNAVCaption.COPYFILTERS(Rec);
                                 TTNAVCaption.SETFILTER("Object ID",'T*P8632');
                                 IF TTNAVCaption.FINDSET THEN REPEAT
                                   txtPart := TTNAVCaption."Object ID";
                                   //T11012566-F126-P8632
                                   txtPart := COPYSTR(txtPart,2,STRPOS(txtPart,'-')-2);
                                   EVALUATE(tableNo,txtPart);

                                   txtPart := TTNAVCaption."Object ID";
                                   //T11012566-F126-P8632
                                   txtPart := COPYSTR(txtPart,STRPOS(txtPart,'-')+1);
                                   //F126-P8632
                                   txtPart := COPYSTR(txtPart,2,STRPOS(txtPart,'-')-2);
                                   EVALUATE(fldNo,txtPart);

                                   IF lField.GET(tableNo,fldNo) THEN
                                     IF recRefOPEN(tableNo) AND (lField.ObsoleteState=lField.ObsoleteState::No) THEN BEGIN
                                       fldRef := recRef.FIELD(fldNo);
                                       recRef.CLOSE;
                                       txtPart := fldRef.OPTIONSTRING;

                                       IF NOT TTNAVCaption3.GET(TTNAVCaption."Project Code",'3',TTNAVCaption."Object ID") THEN BEGIN
                                         TTNAVCaption3."Project Code" := TTNAVCaption."Project Code";
                                         TTNAVCaption3."Language ID" := '3';
                                         TTNAVCaption3."Object ID" := TTNAVCaption."Object ID";
                                         TTNAVCaption3.Status := TTNAVCaption3.Status::Generated;
                                         TTNAVCaption3.INSERT;
                                       END;

                                       TTNAVCaption3.SetCaption(txtPart);
                                       TTNAVCaption3.MODIFY;
                                     END;
                                 UNTIL TTNAVCaption.NEXT=0;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1100525000;0;Container;
                ContainerType=ContentArea }

    { 1100525014;1;Field  ;
                Name=Project Code;
                Lookup=Yes;
                CaptionML=ENU=Project Code;
                SourceExpr=TTProject.Code;
                OnLookup=BEGIN
                           CLEAR(PrjForm);
                           PrjForm.LOOKUPMODE(TRUE);
                           IF PrjForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               PrjForm.GETRECORD(PrjRec);
                               PrjRec.Active := TRUE;
                               PrjRec.MODIFY;
                               PrjRec.SetActive(PrjRec, PrjRec.Code);
                               TTProject := PrjRec;
                               SetFilters;
                               CurrPage.UPDATE(FALSE);
                           END;
                         END;
                          }

    { 1100525001;1;Group  ;
                Name=Group;
                CaptionML=ENU=Captions;
                GroupType=Repeater }

    { 1100525016;2;Field  ;
                Name=<Project Code 2>;
                SourceExpr="Project Code";
                Visible=false }

    { 1100525026;2;Field  ;
                SourceExpr=Status;
                Visible=FALSE }

    { 1100525027;2;Field  ;
                SourceExpr="Probability%";
                Visible=FALSE }

    { 1100525002;2;Field  ;
                SourceExpr="Language ID";
                Visible=False }

    { 1100525028;2;Field  ;
                SourceExpr=Length;
                Visible=False }

    { 1100525029;2;Field  ;
                SourceExpr="Actual Length";
                Visible=False }

    { 1100525003;2;Field  ;
                SourceExpr="Object ID";
                Visible=False }

    { 1100525025;2;Field  ;
                AssistEdit=Yes;
                CaptionML=[ENU=Translation;
                           SVE=™vers„ttning];
                SourceExpr=Caption1;
                OnAssistEdit=VAR
                               locCaption@1000 : Record 77786;
                               DictionaryCaption@1001 : Record 77786;
                             BEGIN
                               CLEAR(Dictionary);
                               Dictionary.LOOKUPMODE(TRUE);
                               Dictionary.DetermineInterface(TTProject."Source Language ID", "Alt. Search Caption", "Language ID");
                               IF Dictionary.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                   Dictionary.GETRECORD(DictionaryCaption);
                                   locCaption.GET(DictionaryCaption."Project Code",TTProject."Target Language ID",DictionaryCaption."Object ID");
                                   Caption1 := locCaption.Caption1;
                                   CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1100525005;2;Field  ;
                CaptionML=ENU=Translation Search Caption;
                SourceExpr="Search Caption";
                Visible=False }

    { 1100525006;2;Field  ;
                Lookup=No;
                DrillDown=No;
                AssistEdit=No;
                CaptionML=[ENU=Source;
                           SVE=K„lla];
                SourceExpr="Alt. Caption1" }

    { 1100525007;2;Field  ;
                CaptionML=ENU=Source Seach Caption;
                SourceExpr="Alt. Search Caption";
                Visible=False }

    { 1   ;2   ;Field     ;
                SourceExpr="Third Caption1";
                Visible=FALSE }

    { 2   ;2   ;Field     ;
                SourceExpr="Third Search Caption";
                Visible=FALSE }

    { 1100525008;2;Field  ;
                SourceExpr=Tag1 }

    { 1100525009;2;Field  ;
                SourceExpr=Tag2 }

    { 1100525021;1;Group  ;
                GroupType=Group }

    { 1100525030;2;Group  ;
                GroupType=Group }

    { 1100525035;3;Field  ;
                Name=<Object ID show>;
                Lookup=No;
                DrillDown=No;
                SourceExpr="Object ID";
                Enabled=False;
                Editable=False }

    { 1100525037;3;Field  ;
                Name=<Probability% Show>;
                SourceExpr="Probability%";
                Enabled=False;
                Editable=False }

    { 1100525041;3;Field  ;
                Name=<Actual Length Show>;
                SourceExpr="Actual Length";
                Enabled=False }

    { 1100525044;3;Field  ;
                Name=Advised Length;
                CaptionML=ENU=Advised Length;
                SourceExpr=GetLengthAdvise;
                Enabled=False;
                Editable=False }

    { 1100525046;2;Group  ;
                GroupType=Group }

    { 1100525036;3;Field  ;
                Name=<Status Show>;
                Lookup=No;
                DrillDown=No;
                SourceExpr=Status;
                Enabled=False;
                Editable=False }

    { 1100525053;3;Field  ;
                SourceExpr="Modified By";
                Enabled=False;
                Editable=False }

    { 1100525054;3;Field  ;
                SourceExpr="Last Modified";
                Enabled=False;
                Editable=False }

    { 1000000003;1;Group  ;
                Editable=FALSE;
                GroupType=GridLayout }

    { 1100409000;2;Field  ;
                CaptionML=[ENU=Translation;
                           SVE=™vers„ttning];
                SourceExpr=GetCaption }

    { 1100409003;2;Field  ;
                CaptionML=[ENU=Source;
                           SVE=K„lla];
                SourceExpr=GetAltCaption }

    { 1100409002;2;Field  ;
                CaptionML=ENU=Third;
                SourceExpr=GetThirdCaption }

    { 1100409001;2;Group  ;
                GroupType=Group }

    { 1000000002;3;Field  ;
                CaptionML=[ENU=Translation;
                           SVE=™vers„ttning];
                SourceExpr=LangTarget;
                Importance=Promoted }

    { 1000000001;3;Field  ;
                CaptionML=[ENU=Source;
                           SVE=K„lla];
                SourceExpr=LangSource;
                Importance=Promoted }

    { 1000000000;3;Field  ;
                CaptionML=ENU=Third;
                SourceExpr=LangThird;
                Importance=Promoted }

  }
  CODE
  {
    VAR
      TTProject@1100525000 : Record 77782;
      TTTranslationManagement@1100525001 : Codeunit 77781;
      PrjForm@1100525002 : Page 77782;
      PrjRec@1100525003 : Record 77782;
      Dictionary@1100525004 : Page 77790;
      CaptionRec@1100525005 : Record 77786;
      LangSource@1000000000 : Code[20];
      LangTarget@1000000001 : Code[20];
      LangThird@1000000002 : Code[20];
      TTNAVDLTools@1101285000 : Codeunit 77799;
      GotTTProject@1101285001 : Boolean;
      recRef@1100285100 : RecordRef;

    [TryFunction]
    LOCAL PROCEDURE recRefOPEN@1100285101(tableNo@1100285100 : Integer);
    BEGIN
      recRef.OPEN(tableNo);
    END;

    PROCEDURE SetFilters@1100525000();
    VAR
      TTLanguage@1000000000 : Record 77781;
    BEGIN
      GetTTProject;
      SETRANGE("Language ID",TTProject."Target Language ID");
      SETRANGE("Language Filter",TTProject."Source Language ID");
      SETRANGE("Third Language Filter", TTProject."Third Language ID");
      SETRANGE("Project Code", TTProject.Code);

      IF TTLanguage.GET(TTProject."Source Language ID") THEN LangSource := TTLanguage.ID + ' ' + TTLanguage.Code;
      IF TTLanguage.GET(TTProject."Target Language ID") THEN LangTarget := TTLanguage.ID + ' ' + TTLanguage.Code;
      IF TTLanguage.GET(TTProject."Third Language ID")  THEN LangThird :=  TTLanguage.ID + ' ' + TTLanguage.Code;
    END;

    PROCEDURE AutoTranslate@1000000000(TranslationMode@1000000000 : Option);
    VAR
      OldTTCaption@1000000001 : Record 77786;
    BEGIN
      OldTTCaption.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(Rec);

      TTTranslationManagement.AutoTranslate(TranslationMode, Rec, TTProject);

      COPY(OldTTCaption);
      CurrPage.UPDATE;
    END;

    PROCEDURE MarkUniqueCaptions@1000000002();
    VAR
      OldTTCaption@1000000000 : Record 77786;
    BEGIN
      OldTTCaption.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(Rec);

      TTTranslationManagement.MarkUniqueEntries(Rec,TTProject);

      COPY(OldTTCaption);
      CurrPage.UPDATE;
    END;

    PROCEDURE TagSourceTranslationCaptionDiffs@1000000013();
    VAR
      OldTTCaption@1000000000 : Record 77786;
    BEGIN
      OldTTCaption.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(Rec);

      TTTranslationManagement.TagSourceTranslationCaptionDiffs(Rec,TTProject);

      COPY(OldTTCaption);
      CurrPage.UPDATE;
    END;

    PROCEDURE TagSourceTranslationCaptionEqual@1();
    VAR
      OldTTCaption@1000000000 : Record 77786;
    BEGIN
      OldTTCaption.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(Rec);

      TTTranslationManagement.TagSourceTranslationCaptionEqual(Rec,TTProject);

      COPY(OldTTCaption);
      CurrPage.UPDATE;
    END;

    PROCEDURE ClearTranslationCaption@1100525003();
    VAR
      OldTTCaption@1100525000 : Record 77786;
    BEGIN
      OldTTCaption.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(Rec);

      TTTranslationManagement.ClearTranslationCaption(Rec,TTProject);

      COPY(OldTTCaption);
      CurrPage.UPDATE;
    END;

    PROCEDURE CopyTagToSrcLangCaption@1100525001();
    VAR
      OldTTCaption@1100525000 : Record 77786;
    BEGIN
      OldTTCaption.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(Rec);

      TTTranslationManagement.CopyTagToSrcLangCaption(Rec,TTProject);

      COPY(OldTTCaption);
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE GetTTProject@1101285000();
    BEGIN
      IF GotTTProject THEN
        EXIT;
      GotTTProject := TTProject.GET("Project Code");
    END;

    BEGIN
    END.
  }
}

