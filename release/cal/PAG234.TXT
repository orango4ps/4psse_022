OBJECT Page 234 Apply Employee Entries
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00;
  }
  PROPERTIES
  {
    Permissions=TableData 5222=m;
    CaptionML=[ENU=Apply Employee Entries;
               NOR=Utlign ansattposter;
               SVE=Koppla personaltransaktioner];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5222;
    DataCaptionFields=Employee No.;
    PageType=Worksheet;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Entry;
                                NOR=Ny,Prosess,Rapport,Oppf›ring;
                                SVE=Ny,Process,Rapport,Transaktion];
    OnInit=BEGIN
             AppliesToIDVisible := TRUE;
           END;

    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
               BEGIN
                 IF CalcType = CalcType::Direct THEN BEGIN
                   Empl.GET("Employee No.");
                   ApplnCurrencyCode := '';
                   FindApplyingEntry;
                 END;

                 AppliesToIDVisible := ApplnType <> ApplnType::"Applies-to Doc. No.";

                 GLSetup.GET;

                 IF CalcType = CalcType::GenJnlLine THEN
                   CalcApplnAmount;
                 PostingDone := FALSE;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
               END;

    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"Empl. Entry-Edit",Rec);
                     IF "Applies-to ID" <> xRec."Applies-to ID" THEN
                       CalcApplnAmount;
                     EXIT(FALSE);
                   END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = ACTION::LookupOK THEN
                         LookupOKOnPush;
                       IF ApplnType = ApplnType::"Applies-to Doc. No." THEN BEGIN
                         IF OK AND (TempApplyingEmplLedgEntry."Posting Date" < "Posting Date") THEN BEGIN
                           OK := FALSE;
                           ERROR(
                             EarlierPostingDateErr,TempApplyingEmplLedgEntry."Document Type",TempApplyingEmplLedgEntry."Document No.",
                             "Document Type","Document No.");
                         END;
                         IF OK THEN BEGIN
                           IF "Amount to Apply" = 0 THEN
                             "Amount to Apply" := "Remaining Amount";
                           CODEUNIT.RUN(CODEUNIT::"Empl. Entry-Edit",Rec);
                         END;
                       END;

                       IF CheckActionPerformed THEN BEGIN
                         Rec := TempApplyingEmplLedgEntry;
                         "Applying Entry" := FALSE;
                         IF AppliesToID = '' THEN BEGIN
                           "Applies-to ID" := '';
                           "Amount to Apply" := 0;
                         END;
                         CODEUNIT.RUN(CODEUNIT::"Empl. Entry-Edit",Rec);
                       END;
                     END;

    OnAfterGetCurrRecord=BEGIN
                           IF ApplnType = ApplnType::"Applies-to Doc. No." THEN
                             CalcApplnAmount;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 37      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 NOR=P&ost;
                                 SVE=Trans&aktion];
                      Image=Entry }
      { 31      ;2   ;Action    ;
                      CaptionML=[ENU=Applied E&ntries;
                                 NOR=Utlignede p&oster;
                                 SVE=Kopplade tra&nsaktioner];
                      ToolTipML=[ENU=View the ledger entries that have been applied to this record.;
                                 NOR=Vis postene som har blitt utlignet for denne posten.;
                                 SVE=Visa transaktionerna som har till„mpats p† denna post.];
                      ApplicationArea=#BasicHR;
                      RunObject=Page 63;
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Category4 }
      { 57      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera m†tt, till exempel omr†de, projekt eller avdelning, som du kan tilldela till f”rs„ljnings- och ink”psdokument f”r att f”rdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Detailed &Ledger Entries;
                                 NOR=Detaljerte &poster;
                                 SVE=Detaljerad &reskontra];
                      ToolTipML=[ENU=View a summary of all the posted entries and adjustments related to a specific employee ledger entry.;
                                 NOR=Vis et sammendrag av alle bokf›rte poster og justeringer som er knyttet til en bestemt ansattpost.;
                                 SVE=Visa en ”versikt av alla bokf”rda transaktioner och justeringar som r”r en viss personaltransaktion.];
                      ApplicationArea=#BasicHR;
                      RunObject=Page 5238;
                      RunPageView=SORTING(Employee Ledger Entry No.,Posting Date);
                      RunPageLink=Employee Ledger Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Category4 }
      { 17      ;2   ;Action    ;
                      Name=Navigate;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger;
                                 SVE=Anal&ysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppf›ringer og dokumenter som finnes for dokumentnummeret og bokf›ringsdatoen i den valgte oppf›ringen eller dokumentet.;
                                 SVE=S”k efter alla transaktioner och dokument som existerar f”r dokumentnumret och bokf”ringsdatumet f”r den valda transaktionen eller det valda dokumentet.];
                      ApplicationArea=#BasicHR;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Application;
                                 NOR=U&tligning;
                                 SVE=&Koppling];
                      Image=Apply }
      { 13      ;2   ;Action    ;
                      Name=ActionSetAppliesToID;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=Set Applies-to ID;
                                 NOR=Angi utlignings-ID;
                                 SVE=Ange Koppla till ID];
                      ToolTipML=[ENU=Set the Applies-to ID field on the posted entry to automatically be filled in with the document number of the entry in the journal.;
                                 NOR=Setter Utlignings-ID i den bokf›rte posten ti automatisk utfylling med postens bilagsnummer i kladden.;
                                 SVE=St„ll in f„ltet Koppla till ID p† den bokf”rda transaktionen f”r automatisk ifyllning med transaktionens verifikationsnummer i journalen.];
                      ApplicationArea=#BasicHR;
                      Promoted=Yes;
                      Image=SelectLineToApply;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF (CalcType = CalcType::GenJnlLine) AND (ApplnType = ApplnType::"Applies-to Doc. No.") THEN
                                   ERROR(CannotSetAppliesToIDErr);

                                 SetEmplApplId;
                               END;
                                }
      { 11      ;2   ;Action    ;
                      Name=ActionPostApplication;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Application;
                                 NOR=Etterutligning;
                                 SVE=Bokf”r koppling];
                      ToolTipML=[ENU=Define the document number of the ledger entry to use to perform the application. In addition, you specify the Posting Date for the application.;
                                 NOR=Definerer bilagsnummeret i posten som skal brukes til † utf›re utligningen. I tillegg kan du angi bokf›ringsdatoen for utligningen.;
                                 SVE=Definiera verifikationsnummer p† transaktionen som anv„nds f”r att utf”ra kopplingen. Dessutom anges kopplingens bokf”ringsdatum.];
                      ApplicationArea=#BasicHR;
                      Promoted=Yes;
                      Image=PostApplication;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PostDirectApplication(FALSE);
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forh†ndsvis bokf›ring;
                                 SVE=F”rhandsgranska bokf”ring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet n†r du bokf›rer dokumentet eller kladden.;
                                 SVE=Granska de olika transaktionstyper som skapas n„r du bokf”r dokumentet eller journalen.];
                      ApplicationArea=#BasicHR;
                      Promoted=Yes;
                      Image=ViewPostedOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PostDirectApplication(TRUE);
                               END;
                                }
      { 7       ;2   ;Separator ;
                      CaptionML=[ENU=-;
                                 NOR=-;
                                 SVE=-] }
      { 5       ;2   ;Action    ;
                      CaptionML=[ENU=Show Only Selected Entries to Be Applied;
                                 NOR=Vis bare utvalgte poster som skal utlignes;
                                 SVE=Visa endast valda transaktioner som ska kopplas];
                      ToolTipML=[ENU=View the selected ledger entries that will be applied to the specified record.;
                                 NOR=Viser de valgte finanspostene som utlignes mot den angitte posten.;
                                 SVE=Visa valda transaktioner som kopplas till den angivna posten.];
                      ApplicationArea=#BasicHR;
                      Promoted=Yes;
                      Image=ShowSelected;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowAppliedEntries := NOT ShowAppliedEntries;
                                 IF ShowAppliedEntries THEN
                                   IF CalcType = CalcType::GenJnlLine THEN
                                     SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID")
                                   ELSE BEGIN
                                     EmplEntryApplID := USERID;
                                     IF EmplEntryApplID = '' THEN
                                       EmplEntryApplID := '***';
                                     SETRANGE("Applies-to ID",EmplEntryApplID);
                                   END
                                 ELSE
                                   SETRANGE("Applies-to ID");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 70  ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=Allm„nt] }

    { 73  ;2   ;Field     ;
                CaptionML=[ENU=Posting Date;
                           NOR=Bokf›ringsdato;
                           SVE=Bokf”ringsdatum];
                ToolTipML=[ENU=Specifies the posting date of the entry to be applied.;
                           NOR=Angir bokf›ringsdatoen for posten som skal utlignes.;
                           SVE=Anger den kopplade transaktionens bokf”ringsdatum.];
                ApplicationArea=#BasicHR;
                SourceExpr=TempApplyingEmplLedgEntry."Posting Date";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                CaptionML=[ENU=Document Type;
                           NOR=Dokumenttype;
                           SVE=Dokumenttyp];
                ToolTipML=[ENU=Specifies the document type of the entry to be applied.;
                           NOR=Angir dokumenttypen for posten som skal utlignes.;
                           SVE=Anger den kopplade transaktionens dokumenttyp.];
                ApplicationArea=#BasicHR;
                SourceExpr=TempApplyingEmplLedgEntry."Document Type";
                Editable=FALSE }

    { 77  ;2   ;Field     ;
                CaptionML=[ENU=Document No.;
                           NOR=Bilagsnr.;
                           SVE=Dokumentnummer];
                ToolTipML=[ENU=Specifies the document number of the entry to be applied.;
                           NOR=Angir bilagsnummeret for posten som skal utlignes.;
                           SVE=Anger den kopplade transaktionens dokumentnummer.];
                ApplicationArea=#BasicHR;
                SourceExpr=TempApplyingEmplLedgEntry."Document No.";
                Editable=FALSE }

    { 71  ;2   ;Field     ;
                Name=ApplyingEmployeeNo;
                CaptionML=[ENU=Employee No.;
                           NOR=Ansattnr.;
                           SVE=Anst„llningsnr];
                ToolTipML=[ENU=Specifies the employee number of the entry to be applied.;
                           NOR=Angir ansattnummeret for posten som skal utlignes.;
                           SVE=Anger den kopplade personaltransaktionens dokumentnummer.];
                ApplicationArea=#BasicHR;
                SourceExpr=TempApplyingEmplLedgEntry."Employee No.";
                Visible=FALSE;
                Editable=FALSE }

    { 85  ;2   ;Field     ;
                Name=ApplyingDescription;
                CaptionML=[ENU=Description;
                           NOR=Beskrivelse;
                           SVE=Description];
                ToolTipML=[ENU=Specifies the description of the entry to be applied.;
                           NOR=Angir beskrivelsen for posten som skal utlignes.;
                           SVE=Anger den kopplade transaktionens beskrivning.];
                ApplicationArea=#BasicHR;
                SourceExpr=TempApplyingEmplLedgEntry.Description;
                Visible=FALSE;
                Editable=FALSE }

    { 79  ;2   ;Field     ;
                CaptionML=[ENU=Currency Code;
                           NOR=Valutakode;
                           SVE=Valutakod];
                ToolTipML=[ENU=Specifies the code for the currency that amounts are shown in.;
                           NOR=Angir koden for valutaen som bel›pene vises i.;
                           SVE=Anger i vilken valuta beloppen visas.];
                ApplicationArea=#BasicHR;
                SourceExpr=TempApplyingEmplLedgEntry."Currency Code";
                Editable=FALSE }

    { 81  ;2   ;Field     ;
                CaptionML=[ENU=Amount;
                           NOR=Bel›p;
                           SVE=Belopp];
                ToolTipML=[ENU=Specifies the amount on the entry to be applied.;
                           NOR=Angir bel›pet p† posten som skal utlignes.;
                           SVE=Anger den kopplade transaktionens belopp.];
                ApplicationArea=#BasicHR;
                SourceExpr=TempApplyingEmplLedgEntry.Amount;
                Editable=FALSE }

    { 83  ;2   ;Field     ;
                CaptionML=[ENU=Remaining Amount;
                           NOR=Restbel›p;
                           SVE=terst†ende belopp];
                ToolTipML=[ENU=Specifies the amount on the entry to be applied.;
                           NOR=Angir bel›pet p† posten som skal utlignes.;
                           SVE=Anger den kopplade transaktionens belopp.];
                ApplicationArea=#BasicHR;
                SourceExpr=TempApplyingEmplLedgEntry."Remaining Amount";
                Editable=FALSE }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of entries that will be applied to when you choose the Apply Entries action.;
                           NOR=Angir ID-en for postene som blir utlignet n†r du velger handlingen Utlign poster.;
                           SVE=Anger ID-numret f”r transaktioner som kommer att till„mpas n„r du v„ljer †tg„rden Koppla transaktioner.];
                ApplicationArea=#All;
                SourceExpr="Applies-to ID";
                Visible=AppliesToIDVisible }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the employee entry's posting date.;
                           NOR=Angir ansattpostens bokf›ringsdato.;
                           SVE=Anger personaltransaktionens bokf”ringsdatum.];
                ApplicationArea=#BasicHR;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the employee entry's document type.;
                           NOR=Angir ansattpostens dokumenttype.;
                           SVE=Anger personaltransaktionens dokumenttyp.];
                ApplicationArea=#BasicHR;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the employee entry's document number.;
                           NOR=Angir ansattpostens dokumentnummer.;
                           SVE=Anger personaltransaktionens verifikationsnummer.];
                ApplicationArea=#BasicHR;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the employee account that the entry is linked to.;
                           NOR=Angir nummeret p† ansattkontoen som er knyttet til posten.;
                           SVE=Anger leverant”rskontonumret som personaltransaktionen „r kopplad till.];
                ApplicationArea=#BasicHR;
                SourceExpr="Employee No.";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the employee entry.;
                           NOR=Angir en beskrivelse av ansattposten.;
                           SVE=Anger en beskrivning av personaltransaktionen.];
                ApplicationArea=#BasicHR;
                SourceExpr=Description;
                Editable=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for the amount on the line.;
                           NOR=Angir valutakoden for bel›pet p† linjen.;
                           SVE=Anger valutakoden f”r beloppet p† raden.];
                ApplicationArea=#BasicHR;
                SourceExpr="Currency Code" }

    { 61  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the original entry.;
                           NOR=Angir bel›pet for den opprinnelige posten.;
                           SVE=Anger den ursprungliga transaktionens belopp.];
                ApplicationArea=#BasicHR;
                SourceExpr="Original Amount";
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the entry.;
                           NOR=Angir bel›pet for posten.;
                           SVE=Anger transaktionsbeloppet.];
                ApplicationArea=#BasicHR;
                SourceExpr=Amount;
                Visible=FALSE;
                Editable=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total of the ledger entries that represent debits.;
                           NOR=Angir summen for postene som representerer debet.;
                           SVE=Anger summan av transaktionerna som representerar debet.];
                ApplicationArea=#BasicHR;
                SourceExpr="Debit Amount";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total of the ledger entries that represent credits.;
                           NOR=Angir summen for postene som representerer kredit.;
                           SVE=Anger summan av transaktionerna som representerar krediter.];
                ApplicationArea=#BasicHR;
                SourceExpr="Credit Amount";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be applied to before the entry is totally applied to.;
                           NOR=Angir bel›pet som gjenst†r † bli utlignet, f›r posten utlignes helt.;
                           SVE=Anger beloppet som †terst†r att anv„nda innan transaktionen „r helt anv„nd.];
                ApplicationArea=#BasicHR;
                SourceExpr="Remaining Amount";
                Editable=FALSE }

    { 33  ;2   ;Field     ;
                CaptionML=[ENU=Appln. Remaining Amount;
                           NOR=Utlign restbel›p;
                           SVE=Koppling †terst. belopp];
                ToolTipML=[ENU=Specifies the amount that remains to be applied to before the entry is totally applied to.;
                           NOR=Angir bel›pet som gjenst†r † bli utlignet, f›r posten utlignes helt.;
                           SVE=Anger beloppet som †terst†r att anv„nda innan transaktionen „r helt anv„nd.];
                ApplicationArea=#BasicHR;
                SourceExpr=CalcApplnRemainingAmount("Remaining Amount");
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount to apply.;
                           NOR=Angir bel›pet som skal utlignes.;
                           SVE=Anger belopp att koppla.];
                ApplicationArea=#BasicHR;
                SourceExpr="Amount to Apply";
                OnValidate=BEGIN
                             CODEUNIT.RUN(CODEUNIT::"Empl. Entry-Edit",Rec);

                             IF (xRec."Amount to Apply" = 0) OR ("Amount to Apply" = 0) AND
                                ((ApplnType = ApplnType::"Applies-to ID") OR (CalcType = CalcType::Direct))
                             THEN
                               SetEmplApplId;
                             GET("Entry No.");
                             AmounttoApplyOnAfterValidate;
                           END;
                            }

    { 92  ;2   ;Field     ;
                CaptionML=[ENU=Appln. Amount to Apply;
                           NOR=Utligningsbel›p som skal utlignes;
                           SVE=Koppling Belopp att koppla];
                ToolTipML=[ENU=Specifies the amount to apply.;
                           NOR=Angir bel›pet som skal utlignes.;
                           SVE=Anger belopp att koppla.];
                ApplicationArea=#BasicHR;
                SourceExpr=CalcApplnAmounttoApply("Amount to Apply");
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment to the employee.;
                           NOR=Angir betalingen til den ansatte.;
                           SVE=Anger betalningen till personalen.];
                ApplicationArea=#BasicHR;
                SourceExpr="Payment Reference" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the amount on the entry has been fully paid or there is still a remaining amount that must be applied to.;
                           NOR=Angir om posten er helt utlignet, eller om det stadig gjenst†r † utligne et bel›p.;
                           SVE=Anger om postens belopp har betalats eller om det †terst†r ett belopp som m†ste betalas.];
                ApplicationArea=#BasicHR;
                SourceExpr=Open;
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the entry to be applied is positive.;
                           NOR=Angir om posten som skal utlignes er positiv.;
                           SVE=Anger om transaktionen som kopplas „r positiv.];
                ApplicationArea=#BasicHR;
                SourceExpr=Positive;
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the global dimension that is linked to the record or entry for analysis purposes. Two global dimensions, typically for the company's most important activities, are available on all cards, documents, reports, and lists.;
                           NOR=Angir koden for den globale dimensjonen som er koblet til posten eller oppf›ringen for analyse. To globale dimensjoner, vanligvis for selskapets viktigste aktiviteter, er tilgjengelige p† alle kort, dokumenter, rapporter og lister.;
                           SVE=Anger koden f”r den globala dimension som „r kopplad till posten eller transaktionen f”r analys. Tv† globala dimensioner, vanligtvis f”r f”retagets viktigaste aktiviteter, finns p† alla kort, dokument, rapporter och listor.];
                ApplicationArea=#Dimensions;
                SourceExpr="Global Dimension 1 Code" }

    { 59  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the global dimension that is linked to the record or entry for analysis purposes. Two global dimensions, typically for the company's most important activities, are available on all cards, documents, reports, and lists.;
                           NOR=Angir koden for den globale dimensjonen som er koblet til posten eller oppf›ringen for analyse. To globale dimensjoner, vanligvis for selskapets viktigste aktiviteter, er tilgjengelige p† alle kort, dokumenter, rapporter og lister.;
                           SVE=Anger koden f”r den globala dimension som „r kopplad till posten eller transaktionen f”r analys. Tv† globala dimensioner, vanligtvis f”r f”retagets viktigaste aktiviteter, finns p† alla kort, dokument, rapporter och listor.];
                ApplicationArea=#Dimensions;
                SourceExpr="Global Dimension 2 Code" }

    { 41  ;1   ;Group      }

    { 1903222401;2;Group  ;
                GroupType=FixedLayout }

    { 1903866701;3;Group  ;
                CaptionML=[ENU=Appln. Currency;
                           NOR=Utlign. valuta;
                           SVE=Kopplingsvaluta] }

    { 49  ;4   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code that the amount will be applied in, in case of different currencies.;
                           NOR=Angir valutakoden som bel›pet skal utlignes i, i tilfelle forskjellige valutaer.;
                           SVE=Anger valutakoden som beloppet kopplas till i h„ndelse av olika valutor.];
                ApplicationArea=#BasicHR;
                SourceExpr=ApplnCurrencyCode;
                TableRelation=Currency;
                Editable=FALSE;
                ShowCaption=No }

    { 1900545201;3;Group  ;
                CaptionML=[ENU=Amount to Apply;
                           NOR=Bel›p som skal utlignes;
                           SVE=Belopp att koppla] }

    { 45  ;4   ;Field     ;
                Name=AmountToApply;
                CaptionML=[ENU=Amount to Apply;
                           NOR=Bel›p som skal utlignes;
                           SVE=Belopp att koppla];
                ToolTipML=[ENU=Specifies the sum of the amounts on all the selected employee ledger entries that will be applied by the entry shown in the Available Amount field. The amount is in the currency represented by the code in the Currency Code field.;
                           NOR=Angir summen av bel›pene for alle valgte ansattposter som skal utlignes av posten i feltet Disponibelt bel›p. Bel›pet er i valutaen angitt av koden i feltet Valutakode.;
                           SVE=Anger summan av beloppen f”r alla valda personaltransaktioner som kopplas till transaktionen som visas i f„ltet Disponibelt belopp. Beloppet „r i valutan som representeras av koden i f„ltet Valutakod.];
                ApplicationArea=#BasicHR;
                SourceExpr=AppliedAmount;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1901652301;3;Group  ;
                CaptionML=[ENU=Rounding;
                           NOR=Avrunding;
                           SVE=Avrundning] }

    { 53  ;4   ;Field     ;
                CaptionML=[ENU=Rounding;
                           NOR=Avrunding;
                           SVE=Avrundning];
                ToolTipML=[ENU=Specifies the rounding difference when you apply entries in different currencies to one another. The amount is in the currency represented by the code in the Currency Code field.;
                           NOR=Angir avrundingsdifferansen n†r du utligner poster i forskjellige valutaer mot hverandre. Bel›pet er i valutaen angitt av koden i feltet Valutakode.;
                           SVE=Anger avrundningsdifferensen n„r du kopplar transaktioner i olika valutor till varandra. Beloppet „r i valutan som representeras av koden i f„ltet Valutakod.];
                ApplicationArea=#BasicHR;
                SourceExpr=ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1901992701;3;Group  ;
                CaptionML=[ENU=Applied Amount;
                           NOR=Utlignet bel›p;
                           SVE=Kopplat belopp] }

    { 98  ;4   ;Field     ;
                Name=AppliedAmount;
                CaptionML=[ENU=Applied Amount;
                           NOR=Utlignet bel›p;
                           SVE=Kopplat belopp];
                ToolTipML=[ENU=Specifies the sum of the amounts in the Amount to Apply field, Pmt. Disc. Amount field, and the Rounding. The amount is in the currency represented by the code in the Currency Code field.;
                           NOR=Angir summen av bel›pene i feltene Bel›p som skal utlignes, Betalingsrabattbel›p og Avrunding. Bel›pet er i valutaen angitt av koden i feltet Valutakode.;
                           SVE=Anger summan av beloppen i f„lten Belopp att koppla, Kassarabattbelopp och Avrundning. Beloppet visas i valutan som motsvaras av koden i f„ltet Valutakod.];
                ApplicationArea=#BasicHR;
                SourceExpr=AppliedAmount + (-PmtDiscAmount) + ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1900295601;3;Group  ;
                CaptionML=[ENU=Available Amount;
                           NOR=Disponibelt bel›p;
                           SVE=Disponibelt belopp] }

    { 47  ;4   ;Field     ;
                CaptionML=[ENU=Available Amount;
                           NOR=Disponibelt bel›p;
                           SVE=Disponibelt belopp];
                ToolTipML=[ENU=Specifies the amount of the journal entry, purchase credit memo, or current employee ledger entry that you have selected as the applying entry.;
                           NOR=Angir bel›pet for kladdeposten, kj›pskreditnotaen eller den gjeldende ansattposten du har valgt som utligningspost.;
                           SVE=Anger beloppet f”r journaltransaktionen, ink”pskreditnotan eller den aktuella personaltransaktionen som du har valt som kopplingstransaktion.];
                ApplicationArea=#BasicHR;
                SourceExpr=ApplyingAmount;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1901652401;3;Group  ;
                CaptionML=[ENU=Balance;
                           NOR=Saldo;
                           SVE=Saldo] }

    { 43  ;4   ;Field     ;
                Name=ControlBalance;
                CaptionML=[ENU=Balance;
                           NOR=Saldo;
                           SVE=Saldo];
                ToolTipML=[ENU=Specifies any extra amount that will remain after the application.;
                           NOR=Angir det eventuelle overskytende bel›pet etter at utligningen er gjennomf›rt.;
                           SVE=Anger eventuella extra belopp som st†r kvar efter kopplingen.];
                ApplicationArea=#BasicHR;
                SourceExpr=AppliedAmount + (-PmtDiscAmount) + ApplyingAmount + ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      TempApplyingEmplLedgEntry@1033 : TEMPORARY Record 5222;
      AppliedEmplLedgEntry@1001 : Record 5222;
      Currency@1002 : Record 4;
      CurrExchRate@1003 : Record 330;
      GenJnlLine@1004 : Record 81;
      GenJnlLine2@1005 : Record 81;
      Empl@1007 : Record 5200;
      EmplLedgEntry@1008 : Record 5222;
      GLSetup@1009 : Record 98;
      EmplEntrySetApplID@1013 : Codeunit 112;
      GenJnlApply@1014 : Codeunit 225;
      Navigate@1012 : Page 344;
      GenJnlLineApply@1016 : Boolean;
      AppliedAmount@1017 : Decimal;
      ApplyingAmount@1018 : Decimal;
      PmtDiscAmount@1040 : Decimal;
      ApplnDate@1019 : Date;
      ApplnCurrencyCode@1020 : Code[10];
      ApplnRoundingPrecision@1021 : Decimal;
      ApplnRounding@1022 : Decimal;
      ApplnType@1023 : ' ,Applies-to Doc. No.,Applies-to ID';
      AmountRoundingPrecision@1024 : Decimal;
      CalcType@1027 : 'Direct,GenJnlLine,PurchHeader';
      EmplEntryApplID@1029 : Code[50];
      AppliesToID@1042 : Code[50];
      ValidExchRate@1030 : Boolean;
      DifferentCurrenciesInAppln@1032 : Boolean;
      MustSelectEntryErr@1036 : TextConst 'ENU=You must select an applying entry before you can post the application.;NOR=Du m† velge en utligningspost f›r du kan bokf›re utligningen.;SVE=Du m†ste v„lja en kopplingstransaktion innan du kan bokf”ra kopplingen.';
      PostingInWrongContextErr@1035 : TextConst 'ENU=You must post the application from the window where you entered the applying entry.;NOR=Du m† bokf›re utligningen fra vinduet der du angav utligningsposten.;SVE=Du m†ste bokf”ra kopplingen i det f”nster d„r du registrerade kopplingstransaktionen.';
      CannotSetAppliesToIDErr@1038 : TextConst 'ENU=You cannot set Applies-to ID field while selecting Applies-to Doc. No field.;NOR=Du kan ikke angi feltet Utlignings-ID n†r du velger feltet Utligningsbilagsnr.;SVE=Du f†r inte ange f„ltet Koppla till ID n„r du v„ljer f„ltet Kopplas till ver.nr.';
      ShowAppliedEntries@1039 : Boolean;
      OK@1028 : Boolean;
      EarlierPostingDateErr@1034 : TextConst '@@@=%1 - document type, %2 - document number,%3 - document type,%4 - document number;ENU=You cannot apply and post an entry to an entry with an earlier posting date.\\Instead, post the document of type %1 with the number %2 and then apply it to the document of type %3 with the number %4.;NOR=Du kan ikke utligne og bokf›re en post mot en post med en tidligere bokf›ringsdato.\\I stedet m† du bokf›re dokumentet av typen %1 med nummeret %2 og deretter utligne det mot dokumentet av typen %3 med nummeret %4.;SVE=Det g†r inte att koppla och bokf”ra en transaktion till en transaktion med ett tidigare bokf”ringsdatum.\\Bokf”r i st„llet dokumentet av typen %1 med numret %2 och koppla det till dokumentet av typen %3 med numret %4.';
      PostingDone@1000 : Boolean;
      AppliesToIDVisible@19043506 : Boolean INDATASET;
      ActionPerformed@1104 : Boolean;
      ApplicationPostedMsg@1043 : TextConst 'ENU=The application was successfully posted.;NOR=Utligningen ble bokf›rt p† riktig m†te.;SVE=Kopplingen „r bokf”rd.';
      ApplicationDateErr@1044 : TextConst 'ENU=The posting date entered must not be before the posting date on the employee ledger entry.;NOR=Den angitte bokf›ringsdatoen m† ikke v‘re f›r bokf›ringsdatoen p† ansattposten.;SVE=Det angivna bokf”ringsdatumet f†r inte infalla f”re bokf”ringsdatumet i personaltransaktionen.';
      ApplicationProcessCanceledErr@1045 : TextConst 'ENU=Post application process has been canceled.;NOR=Etterutligningsprosessen er avbrutt.;SVE=Processen Bokf”r kopplade trans. har avbrutits.';
      IsOfficeAddin@1041 : Boolean;

    [External]
    PROCEDURE SetGenJnlLine@1(NewGenJnlLine@1000 : Record 81;ApplnTypeSelect@1001 : Integer);
    BEGIN
      GenJnlLine := NewGenJnlLine;
      GenJnlLineApply := TRUE;

      IF GenJnlLine."Account Type" = GenJnlLine."Account Type"::Employee THEN
        ApplyingAmount := GenJnlLine.Amount;
      IF GenJnlLine."Bal. Account Type" = GenJnlLine."Bal. Account Type"::Employee THEN
        ApplyingAmount := -GenJnlLine.Amount;
      ApplnDate := GenJnlLine."Posting Date";
      ApplnCurrencyCode := GenJnlLine."Currency Code";
      CalcType := CalcType::GenJnlLine;

      CASE ApplnTypeSelect OF
        GenJnlLine.FIELDNO("Applies-to Doc. No."):
          ApplnType := ApplnType::"Applies-to Doc. No.";
        GenJnlLine.FIELDNO("Applies-to ID"):
          ApplnType := ApplnType::"Applies-to ID";
      END;

      SetApplyingEmplLedgEntry;
    END;

    [External]
    PROCEDURE SetEmplLedgEntry@13(NewEmplLedgEntry@1000 : Record 5222);
    BEGIN
      Rec := NewEmplLedgEntry;
    END;

    [External]
    PROCEDURE SetApplyingEmplLedgEntry@9();
    VAR
      Employee@1001 : Record 5200;
    BEGIN
      CASE CalcType OF
        CalcType::Direct:
          BEGIN
            IF "Applying Entry" THEN BEGIN
              IF TempApplyingEmplLedgEntry."Entry No." <> 0 THEN
                EmplLedgEntry := TempApplyingEmplLedgEntry;
              CODEUNIT.RUN(CODEUNIT::"Empl. Entry-Edit",Rec);
              IF "Applies-to ID" = '' THEN
                SetEmplApplId;
              CALCFIELDS(Amount);
              TempApplyingEmplLedgEntry := Rec;
              IF EmplLedgEntry."Entry No." <> 0 THEN BEGIN
                Rec := EmplLedgEntry;
                "Applying Entry" := FALSE;
                SetEmplApplId;
              END;
              SETFILTER("Entry No.",'<> %1',TempApplyingEmplLedgEntry."Entry No.");
              ApplyingAmount := TempApplyingEmplLedgEntry."Remaining Amount";
              ApplnDate := TempApplyingEmplLedgEntry."Posting Date";
              ApplnCurrencyCode := TempApplyingEmplLedgEntry."Currency Code";
            END;
            CalcApplnAmount;
          END;
        CalcType::GenJnlLine:
          BEGIN
            TempApplyingEmplLedgEntry."Posting Date" := GenJnlLine."Posting Date";
            TempApplyingEmplLedgEntry."Document Type" := GenJnlLine."Document Type";
            TempApplyingEmplLedgEntry."Document No." := GenJnlLine."Document No.";
            IF GenJnlLine."Bal. Account Type" = GenJnlLine."Bal. Account Type"::Employee THEN BEGIN
              TempApplyingEmplLedgEntry."Employee No." := GenJnlLine."Bal. Account No.";
              Employee.GET(TempApplyingEmplLedgEntry."Employee No.");
              TempApplyingEmplLedgEntry.Description := COPYSTR(Employee.FullName,1,MAXSTRLEN(TempApplyingEmplLedgEntry.Description));
            END ELSE BEGIN
              TempApplyingEmplLedgEntry."Employee No." := GenJnlLine."Account No.";
              TempApplyingEmplLedgEntry.Description := GenJnlLine.Description;
            END;
            TempApplyingEmplLedgEntry."Currency Code" := GenJnlLine."Currency Code";
            TempApplyingEmplLedgEntry.Amount := GenJnlLine.Amount;
            TempApplyingEmplLedgEntry."Remaining Amount" := GenJnlLine.Amount;
            CalcApplnAmount;
          END;
      END;
    END;

    [External]
    PROCEDURE SetEmplApplId@10();
    BEGIN
      IF (CalcType = CalcType::GenJnlLine) AND (TempApplyingEmplLedgEntry."Posting Date" < "Posting Date") THEN
        ERROR(
          EarlierPostingDateErr,TempApplyingEmplLedgEntry."Document Type",TempApplyingEmplLedgEntry."Document No.",
          "Document Type","Document No.");

      IF TempApplyingEmplLedgEntry."Entry No." <> 0 THEN
        GenJnlApply.CheckAgainstApplnCurrency(
          ApplnCurrencyCode,"Currency Code",GenJnlLine."Account Type"::Employee,TRUE);

      EmplLedgEntry.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(EmplLedgEntry);

      IF GenJnlLineApply THEN
        EmplEntrySetApplID.SetApplId(EmplLedgEntry,TempApplyingEmplLedgEntry,GenJnlLine."Applies-to ID")
      ELSE
        EmplEntrySetApplID.SetApplId(EmplLedgEntry,TempApplyingEmplLedgEntry,'');

      ActionPerformed := EmplLedgEntry."Applies-to ID" <> '';
      CalcApplnAmount;
    END;

    LOCAL PROCEDURE CalcApplnAmount@7();
    BEGIN
      AppliedAmount := 0;
      PmtDiscAmount := 0;
      DifferentCurrenciesInAppln := FALSE;

      CASE CalcType OF
        CalcType::Direct:
          BEGIN
            FindAmountRounding;
            EmplEntryApplID := USERID;
            IF EmplEntryApplID = '' THEN
              EmplEntryApplID := '***';

            EmplLedgEntry := TempApplyingEmplLedgEntry;

            AppliedEmplLedgEntry.SETCURRENTKEY("Employee No.",Open,Positive);
            AppliedEmplLedgEntry.SETRANGE("Employee No.","Employee No.");
            AppliedEmplLedgEntry.SETRANGE(Open,TRUE);
            IF AppliesToID = '' THEN
              AppliedEmplLedgEntry.SETRANGE("Applies-to ID",EmplEntryApplID)
            ELSE
              AppliedEmplLedgEntry.SETRANGE("Applies-to ID",AppliesToID);

            IF TempApplyingEmplLedgEntry."Entry No." <> 0 THEN BEGIN
              EmplLedgEntry.CALCFIELDS("Remaining Amount");
              AppliedEmplLedgEntry.SETFILTER("Entry No.",'<>%1',EmplLedgEntry."Entry No.");
            END;

            HandlChosenEntries(0,EmplLedgEntry."Remaining Amount");
          END;
        CalcType::GenJnlLine:
          BEGIN
            FindAmountRounding;
            IF GenJnlLine."Bal. Account Type" = GenJnlLine."Bal. Account Type"::Employee THEN
              CODEUNIT.RUN(CODEUNIT::"Exchange Acc. G/L Journal Line",GenJnlLine);

            CASE ApplnType OF
              ApplnType::"Applies-to Doc. No.":
                BEGIN
                  AppliedEmplLedgEntry := Rec;
                  WITH AppliedEmplLedgEntry DO BEGIN
                    CALCFIELDS("Remaining Amount");
                    IF "Currency Code" <> ApplnCurrencyCode THEN BEGIN
                      "Remaining Amount" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                        //ApplnDate,"Currency Code",ApplnCurrencyCode,"Remaining Amount"); //**4PS.o
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Remaining Amount",FALSE); //**4PS.n
                      "Amount to Apply" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                        //ApplnDate,"Currency Code",ApplnCurrencyCode,"Amount to Apply"); //**4PS.o
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Amount to Apply",FALSE); //**4PS.n
                    END;

                    IF "Amount to Apply" <> 0 THEN
                      AppliedAmount := ROUND("Amount to Apply",AmountRoundingPrecision)
                    ELSE
                      AppliedAmount := ROUND("Remaining Amount",AmountRoundingPrecision);

                    IF NOT DifferentCurrenciesInAppln THEN
                      DifferentCurrenciesInAppln := ApplnCurrencyCode <> "Currency Code";
                  END;
                  CheckRounding;
                END;
              ApplnType::"Applies-to ID":
                BEGIN
                  GenJnlLine2 := GenJnlLine;
                  AppliedEmplLedgEntry.SETCURRENTKEY("Employee No.",Open,Positive);
                  AppliedEmplLedgEntry.SETRANGE("Employee No.",GenJnlLine."Account No.");
                  AppliedEmplLedgEntry.SETRANGE(Open,TRUE);
                  AppliedEmplLedgEntry.SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID");

                  HandlChosenEntries(1,GenJnlLine2.Amount);
                END;
            END;
          END;
      END;
    END;

    LOCAL PROCEDURE CalcApplnRemainingAmount@4(Amt@1000 : Decimal) : Decimal;
    VAR
      ApplnRemainingAmount@1001 : Decimal;
    BEGIN
      ValidExchRate := TRUE;
      IF ApplnCurrencyCode = "Currency Code" THEN
        EXIT(Amt);

      IF ApplnDate = 0D THEN
        ApplnDate := "Posting Date";
      ApplnRemainingAmount :=
        CurrExchRate.ApplnExchangeAmtFCYToFCY(
        //ApplnDate,"Currency Code",ApplnCurrencyCode,Amt,ValidExchRate); //**4PS.o
          ApplnDate,"Currency Code",ApplnCurrencyCode,Amt,ValidExchRate,FALSE); //**4PS.n
      EXIT(ApplnRemainingAmount);
    END;

    LOCAL PROCEDURE CalcApplnAmounttoApply@11(AmounttoApply@1000 : Decimal) : Decimal;
    VAR
      ApplnAmountToApply@1001 : Decimal;
    BEGIN
      ValidExchRate := TRUE;

      IF ApplnCurrencyCode = "Currency Code" THEN
        EXIT(AmounttoApply);

      IF ApplnDate = 0D THEN
        ApplnDate := "Posting Date";
      ApplnAmountToApply :=
        CurrExchRate.ApplnExchangeAmtFCYToFCY(
        //ApplnDate,"Currency Code",ApplnCurrencyCode,AmounttoApply,ValidExchRate); //**4PS.o
          ApplnDate,"Currency Code",ApplnCurrencyCode,AmounttoApply,ValidExchRate,FALSE); //**4PS.n
      EXIT(ApplnAmountToApply);
    END;

    LOCAL PROCEDURE FindAmountRounding@6();
    BEGIN
      IF ApplnCurrencyCode = '' THEN BEGIN
        Currency.INIT;
        Currency.Code := '';
        Currency.InitRoundingPrecision;
      END ELSE
        IF ApplnCurrencyCode <> Currency.Code THEN
          Currency.GET(ApplnCurrencyCode);

      AmountRoundingPrecision := Currency."Amount Rounding Precision";
    END;

    LOCAL PROCEDURE CheckRounding@3();
    BEGIN
      ApplnRounding := 0;

      CASE CalcType OF
        CalcType::PurchHeader:
          EXIT;
        CalcType::GenJnlLine:
          IF (GenJnlLine."Document Type" <> GenJnlLine."Document Type"::Payment) AND
             (GenJnlLine."Document Type" <> GenJnlLine."Document Type"::Refund)
          THEN
            EXIT;
      END;

      IF ApplnCurrencyCode = '' THEN
        ApplnRoundingPrecision := GLSetup."Appln. Rounding Precision"
      ELSE BEGIN
        IF ApplnCurrencyCode <> "Currency Code" THEN
          Currency.GET(ApplnCurrencyCode);
        ApplnRoundingPrecision := Currency."Appln. Rounding Precision";
      END;

      IF (ABS((AppliedAmount - PmtDiscAmount) + ApplyingAmount) <= ApplnRoundingPrecision) AND DifferentCurrenciesInAppln THEN
        ApplnRounding := -((AppliedAmount - PmtDiscAmount) + ApplyingAmount);
    END;

    [External]
    PROCEDURE GetEmplLedgEntry@5(VAR EmplLedgEntry@1000 : Record 5222);
    BEGIN
      EmplLedgEntry := Rec;
    END;

    LOCAL PROCEDURE FindApplyingEntry@12();
    BEGIN
      IF CalcType = CalcType::Direct THEN BEGIN
        EmplEntryApplID := USERID;
        IF EmplEntryApplID = '' THEN
          EmplEntryApplID := '***';

        EmplLedgEntry.SETCURRENTKEY("Employee No.","Applies-to ID",Open);
        EmplLedgEntry.SETRANGE("Employee No.","Employee No.");
        IF AppliesToID = '' THEN
          EmplLedgEntry.SETRANGE("Applies-to ID",EmplEntryApplID)
        ELSE
          EmplLedgEntry.SETRANGE("Applies-to ID",AppliesToID);
        EmplLedgEntry.SETRANGE(Open,TRUE);
        EmplLedgEntry.SETRANGE("Applying Entry",TRUE);
        IF EmplLedgEntry.FINDFIRST THEN BEGIN
          EmplLedgEntry.CALCFIELDS(Amount,"Remaining Amount");
          TempApplyingEmplLedgEntry := EmplLedgEntry;
          SETFILTER("Entry No.",'<>%1',EmplLedgEntry."Entry No.");
          ApplyingAmount := EmplLedgEntry."Remaining Amount";
          ApplnDate := EmplLedgEntry."Posting Date";
          ApplnCurrencyCode := EmplLedgEntry."Currency Code";
        END;
        CalcApplnAmount;
      END;
    END;

    LOCAL PROCEDURE AmounttoApplyOnAfterValidate@19038179();
    BEGIN
      IF ApplnType <> ApplnType::"Applies-to Doc. No." THEN BEGIN
        CalcApplnAmount;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE LookupOKOnPush@19031339();
    BEGIN
      OK := TRUE;
    END;

    LOCAL PROCEDURE PostDirectApplication@15(PreviewMode@1005 : Boolean);
    VAR
      EmplEntryApplyPostedEntries@1000 : Codeunit 224;
      PostApplication@1002 : Page 579;
      ApplicationDate@1001 : Date;
      NewApplicationDate@1003 : Date;
      NewDocumentNo@1004 : Code[20];
    BEGIN
      IF CalcType = CalcType::Direct THEN BEGIN
        IF TempApplyingEmplLedgEntry."Entry No." <> 0 THEN BEGIN
          Rec := TempApplyingEmplLedgEntry;
          ApplicationDate := EmplEntryApplyPostedEntries.GetApplicationDate(Rec);

          PostApplication.SetValues("Document No.",ApplicationDate);
          IF ACTION::OK = PostApplication.RUNMODAL THEN BEGIN
            PostApplication.GetValues(NewDocumentNo,NewApplicationDate);
            IF NewApplicationDate < ApplicationDate THEN
              ERROR(ApplicationDateErr);
          END ELSE
            ERROR(ApplicationProcessCanceledErr);

          IF PreviewMode THEN
            EmplEntryApplyPostedEntries.PreviewApply(Rec,NewDocumentNo,NewApplicationDate)
          ELSE
            EmplEntryApplyPostedEntries.Apply(Rec,NewDocumentNo,NewApplicationDate);

          IF NOT PreviewMode THEN BEGIN
            MESSAGE(ApplicationPostedMsg);
            PostingDone := TRUE;
            CurrPage.CLOSE;
          END;
        END ELSE
          ERROR(MustSelectEntryErr);
      END ELSE
        ERROR(PostingInWrongContextErr);
    END;

    LOCAL PROCEDURE CheckActionPerformed@1011() : Boolean;
    BEGIN
      IF ActionPerformed THEN
        EXIT(FALSE);
      IF (NOT (CalcType = CalcType::Direct) AND NOT OK AND NOT PostingDone) OR
         (ApplnType = ApplnType::"Applies-to Doc. No.")
      THEN
        EXIT(FALSE);
      EXIT(CalcType = CalcType::Direct);
    END;

    [External]
    PROCEDURE SetAppliesToID@1031(AppliesToID2@1043 : Code[50]);
    BEGIN
      AppliesToID := AppliesToID2;
    END;

    LOCAL PROCEDURE HandlChosenEntries@8(Type@1000 : 'Direct,GenJnlLine';CurrentAmount@1001 : Decimal);
    VAR
      TempAppliedEmplLedgEntry@1004 : TEMPORARY Record 5222;
      CorrectionAmount@1009 : Decimal;
      FromZeroGenJnl@1010 : Boolean;
    BEGIN
      CorrectionAmount := 0;
      IF AppliedEmplLedgEntry.FINDSET(FALSE,FALSE) THEN BEGIN
        REPEAT
          TempAppliedEmplLedgEntry := AppliedEmplLedgEntry;
          TempAppliedEmplLedgEntry.INSERT;
        UNTIL AppliedEmplLedgEntry.NEXT = 0;
      END ELSE
        EXIT;

      FromZeroGenJnl := (CurrentAmount = 0) AND (Type = Type::GenJnlLine);

      REPEAT
        IF NOT FromZeroGenJnl THEN
          TempAppliedEmplLedgEntry.SETRANGE(Positive,CurrentAmount < 0);
        IF TempAppliedEmplLedgEntry.FINDFIRST THEN BEGIN
          IF ((CurrentAmount + TempAppliedEmplLedgEntry."Amount to Apply") * CurrentAmount) >= 0 THEN
            AppliedAmount := AppliedAmount + CorrectionAmount;
          CurrentAmount := CurrentAmount + TempAppliedEmplLedgEntry."Amount to Apply";
        END ELSE BEGIN
          TempAppliedEmplLedgEntry.SETRANGE(Positive);
          TempAppliedEmplLedgEntry.FINDFIRST;
        END;

        AppliedAmount := AppliedAmount + TempAppliedEmplLedgEntry."Amount to Apply";

        TempAppliedEmplLedgEntry.DELETE;
        TempAppliedEmplLedgEntry.SETRANGE(Positive);

      UNTIL NOT TempAppliedEmplLedgEntry.FINDFIRST;
      CheckRounding;
    END;

    BEGIN
    END.
  }
}

