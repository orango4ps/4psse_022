OBJECT Table 11071767 Service-Contract Precl. Detail
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               UpdateResults;
             END;

    OnModify=BEGIN
               TESTFIELD(Posted, FALSE);
             END;

    OnDelete=BEGIN
               TESTFIELD(Posted, FALSE);
             END;

    OnRename=BEGIN
               ERROR(Text000);
             END;

    CaptionML=[ENU=Service Contract Preclosure Detail;
               NOR=Servicekontrakt prelim., detaljer;
               SVE=Servicekontrakt, provredovisningsdetalj];
    LookupPageID=Page11125303;
    DrillDownPageID=Page11125303;
  }
  FIELDS
  {
    { 10  ;   ;Reporting Date      ;Date          ;CaptionML=[ENU=Reporting Date;
                                                              NOR=Rapporteringsdato;
                                                              SVE=Rapporteringsdatum];
                                                   Editable=No }
    { 12  ;   ;Seq. No.            ;Integer       ;CaptionML=[ENU=Seq. No.;
                                                              NOR=Sekv. nr;
                                                              SVE=Sekv. nr];
                                                   Editable=No }
    { 20  ;   ;Period Ending Date  ;Date          ;CaptionML=[ENU=Period Ending Date;
                                                              NOR=Periodens sluttdato;
                                                              SVE=Periodens slutdatum];
                                                   Editable=No }
    { 30  ;   ;Control Period Filter OLD;Text20   ;CaptionML=ENU=Control Period Filter OLD;
                                                   Description=OLD;
                                                   Editable=No }
    { 35  ;   ;Control Period Filter;Date         ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Control Period Filter;
                                                              NOR=Kontrollperiodefilter;
                                                              SVE=Kontrollperiodfilter] }
    { 40  ;   ;Service Contract No.;Code20        ;TableRelation=Service-Contract.No.;
                                                   CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr];
                                                   Editable=No }
    { 41  ;   ;Customer No.        ;Code20        ;CaptionML=[ENU=Customer No.;
                                                              NOR=Kundenr.;
                                                              SVE=Kundnr];
                                                   Editable=No }
    { 42  ;   ;Contract Manager    ;Code10        ;CaptionML=[ENU=Contract Manager;
                                                              NOR=Kontraktleder;
                                                              SVE=Kontrakthanterare];
                                                   Editable=No }
    { 43  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 - kode;
                                                              SVE=Global dimension 1 kod];
                                                   Editable=No;
                                                   CaptionClass='1,1,1' }
    { 45  ;   ;Contract Group      ;Code20        ;CaptionML=[ENU=Contract Group;
                                                              NOR=Kontraktgruppe;
                                                              SVE=Kontraktsgrupp];
                                                   Editable=No }
    { 50  ;   ;Contract Control Period Code;Code10;CaptionML=[ENU=Contract Control Period Code;
                                                              NOR=Kontrollperiodekode for kontrakt;
                                                              SVE=Kontraktskontrollperiodskod];
                                                   Editable=No }
    { 60  ;   ;Contr. Control Per. Filter OLD;Text30;
                                                   CaptionML=ENU=Contract Control Period Filter OLD;
                                                   Description=OLD;
                                                   Editable=No }
    { 65  ;   ;Contract Control Period Filter;Date;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Contract Control Period Filter;
                                                              NOR=Kontrollperiodefilter for kontrakt;
                                                              SVE=Kontraktskontrollperiodsfilter] }
    { 70  ;   ;Eff.Contr. Ctrl. Per.FilterOLD;Text30;
                                                   CaptionML=ENU=Effictive Contract Control Period Filter OLD;
                                                   Description=OLD;
                                                   Editable=No }
    { 75  ;   ;Eff.Contr. Ctrl. Period Filter;Date;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Effictive Contract Control Period Filter;
                                                              NOR=Effektivt kontrollperiodefilter for kontrakt;
                                                              SVE=Effektivt kontraktskontrollperiodsfilter] }
    { 80  ;   ;Effective Period Ending Date;Date  ;CaptionML=ENU=Effective Period Ending Date }
    { 90  ;   ;Calc. Prognosis Total Revenue;Decimal;
                                                   OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Calc. Prognosis Total Revenue;
                                                              NOR=Kalk. Prognose, Total inntekt;
                                                              SVE=Ber„kn. Prognos f”r totala int„kter];
                                                   Editable=No }
    { 91  ;   ;Calc. Progn. Tot. Rev. (Maint);Decimal;
                                                   OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Calc. Prognosis Total Revenue (Maintenance);
                                                              NOR=Kalk. Prognose, Total inntekt (vedlikehold);
                                                              SVE=Ber„kn. Prognos f”r totala int„kter (underh†ll)];
                                                   Editable=No }
    { 92  ;   ;Calc. Progn. Tot. Rev. (Calls);Decimal;
                                                   OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Calc. Prognosis Total Revenue (Calls);
                                                              NOR=Kalk. Prognose, Total inntekt (samtaler);
                                                              SVE=Ber„kn. Prognos f”r totala int„kter (samtal)];
                                                   Editable=No }
    { 93  ;   ;Calc. Progn. Tot. Rev. (Add.);Decimal;
                                                   OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Calc. Prognosis Total Revenue (Additional);
                                                              NOR=Kalk. Prognose (tillegg);
                                                              SVE=Ber„kn. Prognos f”r totala int„kter (extra)];
                                                   Editable=No }
    { 100 ;   ;Calc. Prognosis Total Cost;Decimal ;OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Calc. Prognosis Total Cost;
                                                              NOR=Kalk. Prognose for Totalkostnad;
                                                              SVE=Ber„kn. Prognos f”r totalkostnad];
                                                   Editable=No }
    { 101 ;   ;Calc. Progn. Tot. Cost (Maint);Decimal;
                                                   OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Calc. Prognosis Total Cost (Maintenance);
                                                              NOR=Kalk. Prognose for Totalkostnad (Vedlikehold);
                                                              SVE=Ber„kn. Prognos f”r totalkostnad (underh†ll)];
                                                   Editable=No }
    { 102 ;   ;Calc. Progn. Tot. Cost (Calls);Decimal;
                                                   OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Calc. Prognosis Total Cost (Calls);
                                                              NOR=Kalk. Prognose for Totalkostnad (Samtaler);
                                                              SVE=Ber„kn. Prognos f”r totalkostnad (samtal)];
                                                   Editable=No }
    { 103 ;   ;Calc. Progn. Tot. Cost (Add.);Decimal;
                                                   OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Calc. Prognosis Total Cost (Additional);
                                                              NOR=Kalk. Prognose for Totalkostnad (Tillegg);
                                                              SVE=Ber„kn. Prognos f”r totalkostnad (extra)];
                                                   Editable=No }
    { 110 ;   ;Prognosis Financial Result;Decimal ;CaptionML=[ENU=Prognosis Financial Result;
                                                              NOR=Resultatprognose, finans;
                                                              SVE=Prognos finansiellt resultat];
                                                   Editable=No }
    { 120 ;   ;Calculated Progress % (Maint.);Decimal;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Progress % (Maint.)", "Calculated Progress % (Maint.)");
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=ENU=Calculated Progress % (Maintenance);
                                                   Editable=No }
    { 121 ;   ;Calculated Progress % (Calls);Decimal;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Progress % (Calls)", "Calculated Progress % (Calls)");
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=ENU=Calculated Progress % (Calls);
                                                   Editable=No }
    { 122 ;   ;Calculated Progress % (Add.);Decimal;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Progress % (Add.)", "Calculated Progress % (Add.)");
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=ENU=Calculated Progress % (Additional);
                                                   Editable=No }
    { 123 ;   ;Calculated Progress %;Decimal      ;CaptionML=ENU=Calculated Progress %;
                                                   Editable=No }
    { 124 ;   ;Calculated Preclosure Revenue;Decimal;
                                                   CaptionML=[ENU=Calculated Preclosure Revenue;
                                                              NOR=Kalkulert prelim. inntekt;
                                                              SVE=Ber„knade provredovisningsint„kter];
                                                   Editable=No }
    { 125 ;   ;Calculated Preclosure Cost;Decimal ;CaptionML=[ENU=Calculated Preclosure Cost;
                                                              NOR=Kalkulert prelim. kostnad;
                                                              SVE=Ber„knad provredovisningskostnad];
                                                   Editable=No }
    { 130 ;   ;Calculated Preclosure Result;Decimal;
                                                   CaptionML=[ENU=Calculated Preclosure Result;
                                                              NOR=Estimert resultat (Pr›veregnskap);
                                                              SVE=Ber„knat resultat (preclosure)];
                                                   Editable=No }
    { 134 ;   ;Previous Actual Precl. Revenue;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Precl. Detail"."Total Preclosure Revenue" WHERE (Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                      Contract Control Period Code=FIELD(Contract Control Period Code),
                                                                                                                                      Posted=CONST(Yes),
                                                                                                                                      Service Contract WIP Processed=CONST(No)));
                                                   CaptionML=[ENU=Previous Actual Precl. Revenue;
                                                              NOR=Forrige fakt. prelim. inntekt;
                                                              SVE=F”reg†ende faktisk provredovisn. Int„kter];
                                                   Editable=No }
    { 135 ;   ;Previous Actual Precl. Cost;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Precl. Detail"."Total Preclosure Cost" WHERE (Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                   Contract Control Period Code=FIELD(Contract Control Period Code),
                                                                                                                                   Posted=CONST(Yes),
                                                                                                                                   Service Contract WIP Processed=CONST(No)));
                                                   CaptionML=[ENU=Previous Actual Precl. Cost;
                                                              NOR=Forrige fakt. prelim. kostnad;
                                                              SVE=Tidigare verklig provredovisn. Kostnad];
                                                   Editable=No }
    { 140 ;   ;Previous Actual Precl. Result;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Precl. Detail"."Total Preclosure Result" WHERE (Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                     Contract Control Period Code=FIELD(Contract Control Period Code),
                                                                                                                                     Posted=CONST(Yes),
                                                                                                                                     Service Contract WIP Processed=CONST(No)));
                                                   CaptionML=[ENU=Previous Actual Precl. Result;
                                                              NOR=Forrige faktiskt resultat (Preclosure);
                                                              SVE=F”reg†ende faktisk provredovisn. Resultat];
                                                   Editable=No }
    { 144 ;   ;Preclosure Revenue  ;Decimal       ;OnValidate=BEGIN
                                                                CalcPreclosureTotals;
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Preclosure Revenue;
                                                              NOR=Prelim. inntekt;
                                                              SVE=Provredovisningsint„kter] }
    { 145 ;   ;Preclosure Cost     ;Decimal       ;OnValidate=BEGIN
                                                                CalcPreclosureTotals;
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Preclosure Cost;
                                                              NOR=Prelim. kostnad;
                                                              SVE=Provredovisningskostnad] }
    { 150 ;   ;Preclosure Result   ;Decimal       ;OnValidate=VAR
                                                                Factor@1100528600 : Decimal;
                                                              BEGIN
                                                                IF (xRec."Preclosure Result" <> "Preclosure Result") AND (CurrFieldNo = FIELDNO("Preclosure Result")) THEN BEGIN
                                                                  IF xRec."Preclosure Result" <> 0 THEN BEGIN
                                                                    Factor := "Preclosure Result" / xRec."Preclosure Result";
                                                                    "Preclosure Revenue" *= Factor;
                                                                    "Preclosure Cost" *= Factor;
                                                                  END;
                                                                  IF ("Preclosure Revenue" = 0) AND ("Preclosure Cost" = 0) AND ("Preclosure Result" <> 0) THEN
                                                                    IF "Preclosure Result" > 0 THEN
                                                                      "Preclosure Revenue" := "Preclosure Result"
                                                                    ELSE
                                                                      "Preclosure Cost" := - "Preclosure Result";
                                                                END;
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Preclosure Result;
                                                              NOR=Prelimin‘rt Regnskapsresultat;
                                                              SVE=Projektv„rdering] }
    { 160 ;   ;Total Preclosure Revenue;Decimal   ;CaptionML=[ENU=Total Preclosure Revenue;
                                                              NOR=Totale inntekter, prelimin‘rt regnskap;
                                                              SVE=Totala provredovisningsint„kter];
                                                   Editable=No }
    { 164 ;   ;Total Preclosure Cost;Decimal      ;CaptionML=[ENU=Total Preclosure Cost;
                                                              NOR=Totale kostnader, prelimin‘rt regnskap;
                                                              SVE=Total provredovisningskostnad];
                                                   Editable=No }
    { 165 ;   ;Total Preclosure Result;Decimal    ;CaptionML=[ENU=Total Preclosure Result;
                                                              NOR=Totalt prelim. resultat;
                                                              SVE=Totalt provredovisningsresultat];
                                                   Editable=No }
    { 200 ;   ;Budget Hours (Maintenance);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Hours (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                               Service Contract No.=FIELD(Service Contract No.),
                                                                                                                               Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                               Budget Type=CONST(Budget)));
                                                   CaptionML=[ENU=Budget Hours (Maintenance);
                                                              NOR=Budsjett timer (vedlikehold);
                                                              SVE=Budgettimmar (underh†ll)];
                                                   Editable=No }
    { 210 ;   ;Allowed Hours (Maintenance);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Allowed Hours (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                       Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                       Reference Date=FIELD(Eff.Contr. Ctrl. Period Filter),
                                                                                                                                       Budget Type=CONST(Budget)));
                                                   CaptionML=[ENU=Allowed Hours (Maintenance);
                                                              NOR=Tillatte timer (vedlikehold);
                                                              SVE=Till†tna timmar (underh†ll)];
                                                   Editable=No }
    { 215 ;   ;Actual Cost (Maintenance);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev."."Cost Amount" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                        Work=CONST(Contract),
                                                                                                                        No.=FIELD(Service Contract No.),
                                                                                                                        Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                        Additional=CONST(No),
                                                                                                                        Source Type=CONST(Contract),
                                                                                                                        Status=FILTER(<>Finished),
                                                                                                                        Type=FIELD(Type Cost Filter)));
                                                   CaptionML=[ENU=Actual Cost (Maintenance);
                                                              SVE=Verkliga kostnader (kontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 220 ;   ;Budget Hours (Calls);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Hours (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                               Service Contract No.=FIELD(Service Contract No.),
                                                                                                                               Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                               Budget Type=CONST(Budget Calls)));
                                                   CaptionML=[ENU=Budget Hours (Calls);
                                                              NOR=Budsjett Timer (samtaler);
                                                              SVE=Budgettimmar (samtal)];
                                                   Editable=No }
    { 230 ;   ;Allowed Hours (Calls);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Allowed Hours (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                       Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                       Reference Date=FIELD(Eff.Contr. Ctrl. Period Filter),
                                                                                                                                       Budget Type=CONST(Budget Calls)));
                                                   CaptionML=[ENU=Allowed Hours (Calls);
                                                              NOR=Tillatte timer (samtaler);
                                                              SVE=Till†tna timmar (samtal)];
                                                   Editable=No }
    { 232 ;   ;Actual Cost (Calls) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev."."Cost Amount" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                        Work=CONST(Contract),
                                                                                                                        No.=FIELD(Service Contract No.),
                                                                                                                        Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                        Source Type=CONST(Call),
                                                                                                                        Additional=CONST(No),
                                                                                                                        Status=FILTER(<>Finished),
                                                                                                                        Type=FIELD(Type Cost Filter)));
                                                   CaptionML=[ENU=Actual Cost (Calls);
                                                              SVE=Verkliga kostnader (samtal)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 235 ;   ;Budget Hours (Add.) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Hours (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                               Service Contract No.=FIELD(Service Contract No.),
                                                                                                                               Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                               Budget Type=CONST(Budget Additional)));
                                                   CaptionML=[ENU=Budget Hours (Additional);
                                                              NOR=Budsjett Timer (tillegg);
                                                              SVE=Budgettimmar (extra)];
                                                   Editable=No }
    { 237 ;   ;Allowed Hours (Add.);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Allowed Hours (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                       Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                       Reference Date=FIELD(Eff.Contr. Ctrl. Period Filter),
                                                                                                                                       Budget Type=CONST(Budget Additional)));
                                                   CaptionML=[ENU=Allowed Hours (Additional);
                                                              NOR=Tillatte timer (tillegg);
                                                              SVE=Till†tna timmar (extra)];
                                                   Editable=No }
    { 238 ;   ;Actual Cost (Add.)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev."."Cost Amount" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                        Work=CONST(Contract),
                                                                                                                        No.=FIELD(Service Contract No.),
                                                                                                                        Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                        Additional=CONST(Yes),
                                                                                                                        Status=FILTER(<>Finished),
                                                                                                                        Type=FIELD(Type Cost Filter)));
                                                   CaptionML=[ENU=Actual Cost (Additional);
                                                              SVE=Verkliga kostnader (extra)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 240 ;   ;Posted              ;Boolean       ;CaptionML=[ENU=Posted;
                                                              NOR=Bokf›rt;
                                                              SVE=Bokf”rd];
                                                   Editable=No }
    { 250 ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato;
                                                              SVE=Bokf”ringsdatum];
                                                   Editable=No }
    { 260 ;   ;Account Sales       ;Code20        ;TableRelation="G/L Account".No.;
                                                   CaptionML=[ENU=Account Salest;
                                                              NOR=Salgskonto;
                                                              SVE=F”rs„ljningskonto];
                                                   Editable=No }
    { 270 ;   ;Balance Account Sales;Code20       ;TableRelation="G/L Account".No.;
                                                   CaptionML=[ENU=Balance Account Sales;
                                                              NOR=Balansekonto salg;
                                                              SVE=Balanskonto f”rs„ljning];
                                                   Editable=No }
    { 280 ;   ;G/L Register No. Sales;Integer     ;TableRelation="G/L Register";
                                                   CaptionML=[ENU=G/L Register No. Sales;
                                                              NOR=Hovedboksregisternr, salg;
                                                              SVE=Redovisningsregisternr, f”rs„ljning];
                                                   Editable=No }
    { 290 ;   ;Account Cost        ;Code20        ;TableRelation="G/L Account".No.;
                                                   CaptionML=[ENU=Account Cost;
                                                              NOR=Kontokost;
                                                              SVE=Kontokostnad];
                                                   Editable=No }
    { 300 ;   ;Balance Account Cost;Code20        ;TableRelation="G/L Account".No.;
                                                   CaptionML=[ENU=Balance Account Cost;
                                                              NOR=Balansekonto Kostnad;
                                                              SVE=Balanskonto kostnader];
                                                   Editable=No }
    { 310 ;   ;G/L Register No. Cost;Integer      ;TableRelation="G/L Register";
                                                   CaptionML=[ENU=G/L Register No. Cost;
                                                              NOR=Hovedboksregisternr. kostnad;
                                                              SVE=Redovisningsregisternr, kostnad];
                                                   Editable=No }
    { 320 ;   ;UserId              ;Code20        ;CaptionML=[ENU=Posted by;
                                                              NOR=Bokf›rt av;
                                                              SVE=Bokf”rt av];
                                                   Editable=No }
    { 330 ;   ;Posted Date         ;Date          ;CaptionML=[ENU=Posted on Date;
                                                              NOR=Bokf›rt den;
                                                              SVE=Bokf”rt den];
                                                   Editable=No }
    { 340 ;   ;Progn. Total Revenue (Maint.);Decimal;
                                                   OnValidate=BEGIN
                                                                TestPrognosisFixed;
                                                                CalcPrognosisTotals;
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Revenue (Maintenance);
                                                              NOR=Prognose for total inntekt (Vedlikehold);
                                                              SVE=Prognos totala int„kter (underh.)] }
    { 350 ;   ;Progn. Total Revenue (Calls);Decimal;
                                                   OnValidate=BEGIN
                                                                TestPrognosisFixed;
                                                                CalcPrognosisTotals;
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Revenue (Calls);
                                                              NOR=Prognose for total inntekt (Samtaler);
                                                              SVE=Prognos totala int„kter (samtal)] }
    { 360 ;   ;Progn. Total Revenue (Add.);Decimal;OnValidate=BEGIN
                                                                TestPrognosisFixed;
                                                                CalcPrognosisTotals;
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Revenue (Additional);
                                                              NOR=Prognose for total inntekt (Tillegg);
                                                              SVE=Prognos totala int„kter (extra)] }
    { 370 ;   ;Progn. Total Cost (Maint.);Decimal ;OnValidate=VAR
                                                                ServiceContract@1100528600 : Record 11012812;
                                                                ServicePreclosureManagement@1100528601 : Codeunit 11012847;
                                                              BEGIN
                                                                TestPrognosisFixed;
                                                                CalcPrognosisTotals;
                                                                IF NOT ServiceContract.GET("Service Contract No.") THEN
                                                                  ServiceContract.INIT;
                                                                IF ServiceContract."Calc. Progress Perc. Progn/Res" = ServiceContract."Calc. Progress Perc. Progn/Res"::"Actual Cost" THEN
                                                                  VALIDATE("Calculated Progress % (Maint.)", ServicePreclosureManagement.GetProgressByEffFilter(Rec, 0));
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Cost (Maintenance);
                                                              NOR=Prognose for total kostnad (Vedlikehold);
                                                              SVE=Prognos totala kostnader (underh.)] }
    { 380 ;   ;Progn. Total Cost (Calls);Decimal  ;OnValidate=VAR
                                                                ServiceContract@1100528601 : Record 11012812;
                                                                ServicePreclosureManagement@1100528600 : Codeunit 11012847;
                                                              BEGIN
                                                                TestPrognosisFixed;
                                                                CalcPrognosisTotals;
                                                                IF NOT ServiceContract.GET("Service Contract No.") THEN
                                                                  ServiceContract.INIT;
                                                                IF ServiceContract."Calc. Progress Perc. Progn/Res" = ServiceContract."Calc. Progress Perc. Progn/Res"::"Actual Cost" THEN
                                                                  VALIDATE("Calculated Progress % (Calls)", ServicePreclosureManagement.GetProgressByEffFilter(Rec, 1));
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Cost (Calls);
                                                              NOR=Prognose for total kostnad (Samtale);
                                                              SVE=Prognos totala kostnader (anm„lan)] }
    { 390 ;   ;Progn. Total Cost (Add.);Decimal   ;OnValidate=VAR
                                                                ServiceContract@1100528601 : Record 11012812;
                                                                ServicePreclosureManagement@1100528600 : Codeunit 11012847;
                                                              BEGIN
                                                                TestPrognosisFixed;
                                                                CalcPrognosisTotals;
                                                                IF NOT ServiceContract.GET("Service Contract No.") THEN
                                                                  ServiceContract.INIT;
                                                                IF ServiceContract."Calc. Progress Perc. Progn/Res" = ServiceContract."Calc. Progress Perc. Progn/Res"::"Actual Cost" THEN
                                                                  VALIDATE("Calculated Progress % (Add.)", ServicePreclosureManagement.GetProgressByEffFilter(Rec, 2));
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Cost (Additional);
                                                              NOR=Prognose for total kostnad (Tillegg);
                                                              SVE=Prognos totala kostnader (merarbete)] }
    { 400 ;   ;Progn. Total Revenue;Decimal       ;OnValidate=VAR
                                                                Factor@1100528600 : Decimal;
                                                              BEGIN
                                                                TestPrognosisFixed;
                                                                IF (xRec."Progn. Total Revenue" <> "Progn. Total Revenue") AND (CurrFieldNo = FIELDNO("Progn. Total Revenue")) THEN BEGIN
                                                                  IF xRec."Progn. Total Revenue" <> 0 THEN BEGIN
                                                                    Factor := "Progn. Total Revenue" / xRec."Progn. Total Revenue";
                                                                    "Progn. Total Revenue (Maint.)" *= Factor;
                                                                    "Progn. Total Revenue (Calls)" *= Factor;
                                                                    "Progn. Total Revenue (Add.)" *= Factor;
                                                                  END;
                                                                END;
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Revenue;
                                                              NOR=Prognose totalresultat;
                                                              SVE="Prognos totala int„kter "] }
    { 410 ;   ;Progn. Total Cost   ;Decimal       ;OnValidate=VAR
                                                                Factor@1100528600 : Decimal;
                                                              BEGIN
                                                                TestPrognosisFixed;
                                                                IF (xRec."Progn. Total Cost" <> "Progn. Total Cost") AND (CurrFieldNo = FIELDNO("Progn. Total Cost")) THEN BEGIN
                                                                  IF xRec."Progn. Total Cost" <> 0 THEN BEGIN
                                                                    Factor := "Progn. Total Cost" / xRec."Progn. Total Cost";
                                                                    "Progn. Total Cost (Maint.)" *= Factor;
                                                                    "Progn. Total Cost (Calls)" *= Factor;
                                                                    "Progn. Total Cost (Add.)" *= Factor;
                                                                  END;
                                                                END;
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Revenue;
                                                              NOR=Prognose totalresultat;
                                                              SVE=Prognos totala int„kter] }
    { 420 ;   ;Service Contract WIP Processed;Boolean;
                                                   CaptionML=[ENU=Service Contract WIP Processed;
                                                              NOR=Servicekontrakt Arbeidskapital prosessert;
                                                              SVE=Servicekontrakt, WIP behandlat];
                                                   Editable=No }
    { 500 ;   ;Service Contract Description;Text50;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Service-Contract.Description WHERE (No.=FIELD(Service Contract No.)));
                                                   CaptionML=[ENU=Service Contract Description;
                                                              NOR=Servicekontraktsbeskrivelse;
                                                              SVE=Servicekontraktsbeskrivning];
                                                   Editable=No }
    { 510 ;   ;Customer Name       ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Customer Name;
                                                              NOR=Kundnavn;
                                                              SVE=Kundnamn];
                                                   Editable=No }
    { 520 ;   ;SC Control Reporting Date;Date     ;CaptionML=ENU=Service Contract Control Reporting Date;
                                                   Editable=No }
    { 530 ;   ;Actual Hours (Maintenance);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev.".Hours WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                Work=CONST(Contract),
                                                                                                                No.=FIELD(Service Contract No.),
                                                                                                                Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                Additional=CONST(No),
                                                                                                                Source Type=CONST(Contract),
                                                                                                                Status=FILTER(<>Finished),
                                                                                                                Type=FIELD(Type Cost Filter)));
                                                   CaptionML=[ENU=Actual Hours (Maintenance);
                                                              NOR=Faktiske timer (vedlikehold);
                                                              SVE=Verkliga timmar (underh†ll)];
                                                   Editable=No }
    { 540 ;   ;Actual Labor Cost (Maint.);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev."."Cost Amount" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                        Work=CONST(Contract),
                                                                                                                        No.=FIELD(Service Contract No.),
                                                                                                                        Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                        Cost Type=CONST(Labor),
                                                                                                                        Additional=CONST(No),
                                                                                                                        Source Type=CONST(Contract),
                                                                                                                        Status=FILTER(<>Finished),
                                                                                                                        Type=FIELD(Type Cost Filter)));
                                                   CaptionML=[ENU=Actual Labor Cost (Maintenance);
                                                              NOR=Faktisk kostnad, arbeidskraft (vedlikehold);
                                                              SVE=Verklig arbetskraftskostnad (underh†ll)];
                                                   Editable=No }
    { 550 ;   ;Budget Cost (Maintenance);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Amount (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                                Budget Type=CONST(Budget)));
                                                   CaptionML=[ENU=Budget Cost (Maintenance);
                                                              NOR=Budsjett Kostnader (vedlikehold);
                                                              SVE=Budgetkostnad (underh†ll)];
                                                   Editable=No }
    { 560 ;   ;Budget Labor (Maintenance);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Labor Amount (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                      Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                      Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                                      Budget Type=CONST(Budget)));
                                                   CaptionML=[ENU=Budget Labor (Maintenance);
                                                              NOR=Budsjett Arbeidskraft (vedlikehold);
                                                              SVE=Budgetarbetskraft (underh†ll)];
                                                   Editable=No }
    { 570 ;   ;Actual Hours (Calls);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev.".Hours WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                Work=CONST(Contract),
                                                                                                                No.=FIELD(Service Contract No.),
                                                                                                                Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                Source Type=CONST(Call),
                                                                                                                Additional=CONST(No),
                                                                                                                Status=FILTER(<>Finished),
                                                                                                                Type=FIELD(Type Cost Filter)));
                                                   CaptionML=[ENU=Actual Hours (Calls);
                                                              NOR=Faktiske timer (samtaler);
                                                              SVE=Verkliga timmar (samtal)];
                                                   Editable=No }
    { 580 ;   ;Actual Labor Cost (Calls);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev."."Cost Amount" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                        Work=CONST(Contract),
                                                                                                                        No.=FIELD(Service Contract No.),
                                                                                                                        Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                        Source Type=CONST(Call),
                                                                                                                        Cost Type=CONST(Labor),
                                                                                                                        Additional=CONST(No),
                                                                                                                        Status=FILTER(<>Finished),
                                                                                                                        Type=FIELD(Type Cost Filter)));
                                                   CaptionML=[ENU=Actual Labor Cost (Calls);
                                                              NOR=Faktisk arbeidskraftkostnad (samtaler);
                                                              SVE=Verklig arbetskraftskostnad (samtal)];
                                                   Editable=No }
    { 590 ;   ;Budget Cost (Calls) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Amount (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                                Budget Type=CONST(Budget Calls)));
                                                   CaptionML=[ENU=Budget Cost (Calls);
                                                              NOR=Budsjett Arbeidskraft (tillegg);
                                                              SVE=Budgetkostnad (samtal)];
                                                   Editable=No }
    { 600 ;   ;Budget Labor (Calls);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Labor Amount (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                      Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                      Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                                      Budget Type=CONST(Budget Calls)));
                                                   CaptionML=[ENU=Budget Labor (Calls);
                                                              NOR=Budsjett Arbeidskraft (samtaler);
                                                              SVE=Budgetarbetskraft (samtal)];
                                                   Editable=No }
    { 610 ;   ;Actual Hours (Add.) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev.".Hours WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                Work=CONST(Contract),
                                                                                                                No.=FIELD(Service Contract No.),
                                                                                                                Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                Additional=CONST(Yes),
                                                                                                                Type=FIELD(Type Cost Filter),
                                                                                                                Status=FILTER(<>Finished)));
                                                   CaptionML=[ENU=Actual Hours (Additional);
                                                              NOR=Faktiske timer (Ekstra);
                                                              SVE=Verkliga timmar (extra)];
                                                   Editable=No }
    { 620 ;   ;Actual Labor Cost (Add.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev."."Cost Amount" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                        Work=CONST(Contract),
                                                                                                                        No.=FIELD(Service Contract No.),
                                                                                                                        Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                        Cost Type=CONST(Labor),
                                                                                                                        Additional=CONST(Yes),
                                                                                                                        Type=FIELD(Type Cost Filter),
                                                                                                                        Status=FILTER(<>Finished)));
                                                   CaptionML=[ENU=Actual Labor Cost (Additional);
                                                              NOR=Faktisk kostnad, arbeidskraft (tillegg);
                                                              SVE=Verklig arbetskraftskostnad (extra)];
                                                   Editable=No }
    { 630 ;   ;Budget Cost (Add.)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Control Budget".Amount WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                Work=CONST(Contract),
                                                                                                                No.=FIELD(Service Contract No.),
                                                                                                                Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                Additional=CONST(Yes),
                                                                                                                Budget Type=CONST(Budget),
                                                                                                                Status=FILTER(<>Finished)));
                                                   CaptionML=[ENU=Budget Cost (Additional);
                                                              NOR=Budsjett Kostnad (tillegg);
                                                              SVE=Budgetkostnad (extra)];
                                                   Editable=No }
    { 640 ;   ;Budget Labor (Add.) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Control Budget"."Labor Amount" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                        Work=CONST(Contract),
                                                                                                                        No.=FIELD(Service Contract No.),
                                                                                                                        Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                        Additional=CONST(Yes),
                                                                                                                        Budget Type=CONST(Budget),
                                                                                                                        Status=FILTER(<>Finished)));
                                                   CaptionML=[ENU=Budget Labor (Additional);
                                                              NOR=Budsjett Arbeidskraft (tillegg);
                                                              SVE=Budget arbetskraft (extra)];
                                                   Editable=No }
    { 650 ;   ;Budget Revenue (Maintenance);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Amount (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                                Budget Type=CONST(Revenue)));
                                                   CaptionML=[ENU=Budget Revenue (Maintenance);
                                                              NOR=Budsjett Inntekter (vedlikehold);
                                                              SVE=Budgetint„kter (underh†ll)];
                                                   Editable=No }
    { 660 ;   ;Budget Revenue (Calls);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Contract Ctrl. Budget"."Amount (Preclosure)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                                Service Contract No.=FIELD(Service Contract No.),
                                                                                                                                Reference Date=FIELD(Contract Control Period Filter),
                                                                                                                                Budget Type=CONST(Revenue Calls)));
                                                   CaptionML=[ENU=Budget Revenue (Calls);
                                                              NOR=Budsjett Inntekt (samtaler);
                                                              SVE=Budgetint„kter (samtal)];
                                                   Editable=No }
    { 670 ;   ;Budget Revenue (Add.);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Control Budget".Amount WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                Work=CONST(Contract),
                                                                                                                No.=FIELD(Service Contract No.),
                                                                                                                Service Control Period Date=FIELD(Contract Control Period Filter),
                                                                                                                Additional=CONST(Yes),
                                                                                                                Budget Type=CONST(Revenue),
                                                                                                                Status=FILTER(<>Finished)));
                                                   CaptionML=[ENU=Budget Revenue (Additional);
                                                              NOR=Budsjett Inntekter (tillegg);
                                                              SVE=Budgetint„kter (extra)];
                                                   Editable=No }
    { 680 ;   ;Prognosis Hours (Maint.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Hours (Maint.)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                           Service Contract No.=FIELD(Service Contract No.),
                                                                                                                           Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Hours (Maintenance);
                                                   Editable=No }
    { 690 ;   ;Prognosis Labor (Maint.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Labor (Maint.)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                           Service Contract No.=FIELD(Service Contract No.),
                                                                                                                           Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Labor (Maintenance);
                                                   Editable=No }
    { 700 ;   ;Prognosis Other (Maint.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Other (Maint.)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                           Service Contract No.=FIELD(Service Contract No.),
                                                                                                                           Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Other (Maintenance);
                                                   Editable=No }
    { 710 ;   ;Prognosis Revenue (Maint.);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Revenue (Maint.)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                             Service Contract No.=FIELD(Service Contract No.),
                                                                                                                             Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Revenue (Maintenance);
                                                   Editable=No }
    { 720 ;   ;Prognosis Hours (Calls);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Hours (Calls)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                          Service Contract No.=FIELD(Service Contract No.),
                                                                                                                          Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Hours (Calls);
                                                   Editable=No }
    { 730 ;   ;Prognosis Labor (Calls);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Labor (Calls)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                          Service Contract No.=FIELD(Service Contract No.),
                                                                                                                          Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Labor (Calls);
                                                   Editable=No }
    { 740 ;   ;Prognosis Other (Calls);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Other (Calls)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                          Service Contract No.=FIELD(Service Contract No.),
                                                                                                                          Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Other (Calls);
                                                   Editable=No }
    { 750 ;   ;Prognosis Revenue (Calls);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Revenue (Calls)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                            Service Contract No.=FIELD(Service Contract No.),
                                                                                                                            Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Revenue (Calls);
                                                   Editable=No }
    { 760 ;   ;Prognosis Hours (Add.);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Hours (Add.)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                         Service Contract No.=FIELD(Service Contract No.),
                                                                                                                         Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Hours (Additional);
                                                   Editable=No }
    { 770 ;   ;Prognosis Labor (Add.);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Labor (Add.)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                         Service Contract No.=FIELD(Service Contract No.),
                                                                                                                         Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Labor (Additional);
                                                   Editable=No }
    { 780 ;   ;Prognosis Other (Add.);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Other (Add.)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                         Service Contract No.=FIELD(Service Contract No.),
                                                                                                                         Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Other (Additional);
                                                   Editable=No }
    { 790 ;   ;Prognosis Revenue (Add.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("SC Category Control"."Prognosis Revenue (Add.)" WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                           Service Contract No.=FIELD(Service Contract No.),
                                                                                                                           Control Period Code=FIELD(Contract Control Period Code)));
                                                   CaptionML=ENU=Prognosis Revenue (Aditional);
                                                   Editable=No }
    { 800 ;   ;Invoiced Revenue (Maint.);Decimal  ;CaptionML=[ENU=Invoiced Revenue (Maintenance);
                                                              NOR=Fakturert inntekt (vedlikehold);
                                                              SVE=Fakturerade int„kter (underh†ll)];
                                                   Editable=No }
    { 810 ;   ;Invoiced Revenue (Calls);Decimal   ;CaptionML=[ENU=Invoiced Revenue (Calls);
                                                              NOR=Fakturert inntekt (samtaler);
                                                              SVE=Fakturerade int„kter (samtal)];
                                                   Editable=No }
    { 820 ;   ;Revenue (Additional);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Ctrl. Cost/Rev.".Revenues WHERE (Reporting Date=FIELD(SC Control Reporting Date),
                                                                                                                   Service Control Period Date=FIELD(Control Period Filter),
                                                                                                                   Work=CONST(Contract),
                                                                                                                   No.=FIELD(Service Contract No.),
                                                                                                                   Type=CONST(Revenue),
                                                                                                                   Additional=CONST(Yes),
                                                                                                                   Status=FILTER(<>Finished)));
                                                   CaptionML=[ENU=Cost Plus Revenue (Additional);
                                                              SVE=Int„kter (extra)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 830 ;   ;Invoiced Revenue    ;Decimal       ;CaptionML=[ENU=Invoiced Revenue;
                                                              NOR=Fakturert inntekt;
                                                              SVE=Fakturerade int„kter] }
    { 840 ;   ;Damping Factor      ;Decimal       ;CaptionML=ENU=Damping Factor;
                                                   Editable=No }
    { 850 ;   ;Type Cost Filter    ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Type Cost Filter;
                                                   OptionCaptionML=[ENU=Revenue,Cost,Surcharge Soft,Surcharge Firm,Open Purchase,Received not Invoiced,Hours;
                                                                    NOR=Inntekter,Kostnader,Tilleggsavigft l›pende,Tilleggsavgift fast,pent innkj›p,Mottatt ikke fakturert,Timer;
                                                                    SVE=Int„kter,Kostnad,Till„ggsavgift indirekt,Till„ggsavgift fast,™ppna ink”p,Mottaget inte fakturerat,Timmar];
                                                   OptionString=Revenue,Cost,Surcharge Soft,Surcharge Firm,Open Purchase,Received not Invoiced,Hours }
    { 860 ;   ;Progress % (Maint.) ;Decimal       ;OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Progress % (Maintenance);
                                                              NOR=Fremdrift % (Vedlikehold)] }
    { 870 ;   ;Progress % (Calls)  ;Decimal       ;OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Progress % (Calls);
                                                              NOR=Fremdrift % (Samtaler)] }
    { 880 ;   ;Progress % (Add.)   ;Decimal       ;OnValidate=BEGIN
                                                                UpdateResults;
                                                              END;

                                                   CaptionML=[ENU=Progress % (Additional);
                                                              NOR=Fremdrift (Tillegg)] }
    { 890 ;   ;Progress %          ;Decimal       ;CaptionML=[ENU=Progress %;
                                                              NOR=Fremdrifts%;
                                                              SVE=F”rloppsprocent] }
  }
  KEYS
  {
    {    ;Reporting Date,Seq. No.,Period Ending Date,Service Contract No.,Contract Control Period Code;
                                                   SumIndexFields=Calc. Prognosis Total Revenue,Calc. Prognosis Total Cost,Prognosis Financial Result,Calculated Preclosure Revenue,Calculated Preclosure Cost,Calculated Preclosure Result,Total Preclosure Revenue,Total Preclosure Cost,Total Preclosure Result,Progn. Total Revenue (Maint.),Progn. Total Revenue (Calls),Progn. Total Revenue (Add.),Progn. Total Cost (Maint.),Progn. Total Cost (Calls),Progn. Total Cost (Add.),Progn. Total Revenue,Progn. Total Cost;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
    {    ;Service Contract No.,Contract Control Period Code,Posted,Service Contract WIP Processed;
                                                   SumIndexFields=Preclosure Revenue,Preclosure Cost,Preclosure Result,Total Preclosure Revenue,Total Preclosure Cost,Total Preclosure Result }
    {    ;Reporting Date,Seq. No.,Contract Manager,Contract Group,Global Dimension 1 Code;
                                                   SumIndexFields=Progn. Total Revenue (Maint.),Progn. Total Revenue (Calls),Progn. Total Revenue (Add.),Progn. Total Cost (Maint.),Progn. Total Cost (Calls),Progn. Total Cost (Add.),Progn. Total Revenue,Progn. Total Cost,Preclosure Revenue,Preclosure Cost,Total Preclosure Revenue,Total Preclosure Cost }
    {    ;Reporting Date,Seq. No.,Contract Manager,Customer No.,Global Dimension 1 Code;
                                                   SumIndexFields=Progn. Total Revenue (Maint.),Progn. Total Revenue (Calls),Progn. Total Revenue (Add.),Progn. Total Cost (Maint.),Progn. Total Cost (Calls),Progn. Total Cost (Add.),Progn. Total Revenue,Progn. Total Cost,Preclosure Revenue,Preclosure Cost,Total Preclosure Revenue,Total Preclosure Cost }
    {    ;SC Control Reporting Date,Service Contract No. }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1100528600 : TextConst 'ENU=Renaming not Allowed;NOR=Gi nytt navn er ikke tillatt;SVE=Nytt namn ej till†tet';

    PROCEDURE UpdateResults@1100528600();
    VAR
      ServiceContract@1100525003 : Record 11012812;
      ServicePreclosureManagement@1100528601 : Codeunit 11012847;
      ProgressPercMaint@1100525000 : Decimal;
      ProgressPercCalls@1100525001 : Decimal;
      ProgressPercAdd@1100525002 : Decimal;
    BEGIN
      CALCFIELDS("Previous Actual Precl. Revenue", "Previous Actual Precl. Cost", "Previous Actual Precl. Result");

      "Calc. Prognosis Total Revenue" :=
        ("Calc. Progn. Tot. Rev. (Maint)" + "Calc. Progn. Tot. Rev. (Calls)" + "Calc. Progn. Tot. Rev. (Add.)");
      "Calc. Prognosis Total Cost" :=
        ("Calc. Progn. Tot. Cost (Maint)" + "Calc. Progn. Tot. Cost (Calls)" + "Calc. Progn. Tot. Cost (Add.)");

      "Prognosis Financial Result" := "Progn. Total Revenue" - "Progn. Total Cost";

      "Calculated Progress %" := ServicePreclosureManagement.GetProgressByEffFilter(Rec, 6);
      "Progress %" := ServicePreclosureManagement.GetProgressPercByGivenProgressPercs(Rec);
      "Damping Factor" := GetDampingFactor("Progress %");

      ServiceContract.GET("Service Contract No.");
      IF ServiceContract."Calc. Progress Perc. Progn/Res" = ServiceContract."Calc. Progress Perc. Progn/Res"::"Elapsed Time" THEN BEGIN
        ProgressPercMaint := "Progress %";
        ProgressPercCalls := "Progress %";
        ProgressPercAdd := "Progress %";
      END ELSE BEGIN
        ProgressPercMaint := "Progress % (Maint.)";
        ProgressPercCalls := "Progress % (Calls)";
        ProgressPercAdd := "Progress % (Add.)";
      END;

      "Calculated Preclosure Revenue" :=
        ("Progn. Total Revenue (Maint.)" * ProgressPercMaint / 100) +
        ("Progn. Total Revenue (Calls)" * ProgressPercCalls / 100) +
        ("Progn. Total Revenue (Add.)" * ProgressPercAdd / 100);

      IF "Prognosis Financial Result" >= 0 THEN BEGIN
        "Calculated Preclosure Cost" :=
          ("Progn. Total Cost (Maint.)" * ProgressPercMaint / 100) +
          ("Progn. Total Cost (Calls)" * ProgressPercCalls / 100) +
          ("Progn. Total Cost (Add.)" * ProgressPercAdd / 100);
      END ELSE
        "Calculated Preclosure Cost" := "Progn. Total Cost" - ("Progn. Total Revenue" - "Calculated Preclosure Revenue");
      "Calculated Preclosure Result" := "Calculated Preclosure Revenue" - "Calculated Preclosure Cost";

      "Calculated Preclosure Revenue" *= "Damping Factor";
      "Calculated Preclosure Cost" *= "Damping Factor";
      "Calculated Preclosure Result" *= "Damping Factor";

      "Total Preclosure Revenue" := "Preclosure Revenue" - "Previous Actual Precl. Revenue";
      "Total Preclosure Cost" := "Preclosure Cost" - "Previous Actual Precl. Cost";
      "Total Preclosure Result" := "Preclosure Result" - "Previous Actual Precl. Result";
    END;

    PROCEDURE CalcPrognosisTotals@1100528605();
    BEGIN
      "Progn. Total Revenue" :=
        "Progn. Total Revenue (Maint.)" + "Progn. Total Revenue (Calls)" + "Progn. Total Revenue (Add.)";
      "Progn. Total Cost" :=
        "Progn. Total Cost (Maint.)" + "Progn. Total Cost (Calls)" + "Progn. Total Cost (Add.)";
    END;

    PROCEDURE CalcPreclosureTotals@1100528602();
    BEGIN
      "Preclosure Result" := "Preclosure Revenue" - "Preclosure Cost";
    END;

    PROCEDURE DivideTotals@1100528603(VAR IServiceContrPreclDetail@1100528606 : Record 11071767;IFactorRevenueMaintenance@1100528600 : Decimal;IFactorRevenueCalls@1100528601 : Decimal;IFactorRevenueAdditional@1100528602 : Decimal;IFactorCostMaintenance@1100528603 : Decimal;IFactorCostCalls@1100528604 : Decimal;IFactorCostAdditional@1100528605 : Decimal;IFactorPreclosureRevenue@1100528608 : Decimal;IFactorPreclosureCost@1100528609 : Decimal);
    VAR
      ServiceContrPreclDetail@1100528607 : Record 11071767;
    BEGIN
      ServiceContrPreclDetail.COPY(IServiceContrPreclDetail);
      IF ServiceContrPreclDetail.FINDSET(TRUE) THEN
        REPEAT
          ServiceContrPreclDetail.VALIDATE("Progn. Total Revenue (Maint.)",
            ServiceContrPreclDetail."Progn. Total Revenue (Maint.)" * IFactorRevenueMaintenance);
          ServiceContrPreclDetail.VALIDATE("Progn. Total Revenue (Calls)",
            ServiceContrPreclDetail."Progn. Total Revenue (Calls)" * IFactorRevenueCalls);
          ServiceContrPreclDetail.VALIDATE("Progn. Total Revenue (Add.)",
            ServiceContrPreclDetail."Progn. Total Revenue (Add.)" * IFactorRevenueAdditional);
          ServiceContrPreclDetail.VALIDATE("Progn. Total Cost (Maint.)",
            ServiceContrPreclDetail."Progn. Total Cost (Maint.)" * IFactorCostMaintenance);
          ServiceContrPreclDetail.VALIDATE("Progn. Total Cost (Calls)",
            ServiceContrPreclDetail."Progn. Total Cost (Calls)" * IFactorCostCalls);
          ServiceContrPreclDetail.VALIDATE("Progn. Total Cost (Add.)",
            ServiceContrPreclDetail."Progn. Total Cost (Add.)" * IFactorCostAdditional);
          ServiceContrPreclDetail.VALIDATE("Preclosure Revenue",
            ServiceContrPreclDetail."Preclosure Revenue" * IFactorPreclosureRevenue);
          ServiceContrPreclDetail.VALIDATE("Preclosure Cost",
            ServiceContrPreclDetail."Preclosure Cost" * IFactorPreclosureCost);
          ServiceContrPreclDetail.MODIFY(TRUE);
        UNTIL ServiceContrPreclDetail.NEXT = 0;
    END;

    PROCEDURE GetDampingFactor@1100528601(IProgressPercentage@1100528600 : Decimal) : Decimal;
    VAR
      DampingRatioService@1100528601 : Record 11012897;
    BEGIN
      DampingRatioService.SETFILTER("Until Production", '>=%1', ROUND(IProgressPercentage, 1));
      IF DampingRatioService.FINDFIRST THEN
        EXIT(DampingRatioService.Ratio)
      ELSE
        EXIT(1)
    END;

    PROCEDURE TestPrognosisFixed@1100528604();
    VAR
      ServiceContractPreclosure@1100528600 : Record 11071776;
    BEGIN
      IF ServiceContractPreclosure.GET("Reporting Date", "Seq. No.") THEN
        ServiceContractPreclosure.TESTFIELD("Prognosis Fixed", FALSE);
    END;

    PROCEDURE SetContractControlPeriodFilter@1100528607();
    BEGIN
      SETFILTER("Contract Control Period Filter", GetContractControlPeriodFilterText);
    END;

    PROCEDURE GetContractControlPeriodFilterText@1100528606() : Text;
    VAR
      ServiceContractCtrlPeriod@1100528600 : Record 11071746;
    BEGIN
      IF ServiceContractCtrlPeriod.GET("Service Contract No.", "Contract Control Period Code") THEN
        EXIT(STRSUBSTNO('%1..%2', ServiceContractCtrlPeriod."Starting Date", ServiceContractCtrlPeriod."Ending Date"));
    END;

    PROCEDURE SetControlPeriodFilter@1100528610();
    BEGIN
      SETFILTER("Control Period Filter", GetControlPeriodFilterText);
    END;

    PROCEDURE GetControlPeriodFilterText@1100528608() : Text;
    BEGIN
      IF "Period Ending Date" <> 0D THEN
        EXIT(STRSUBSTNO('..%1', "Period Ending Date"));
    END;

    PROCEDURE SetEffContractControlPeriodFilter@1100528612();
    BEGIN
      SETFILTER("Eff.Contr. Ctrl. Period Filter", GetEffContractControlPeriodFilterText);
    END;

    PROCEDURE GetEffContractControlPeriodFilterText@1100528614() : Text;
    VAR
      ServiceContractCtrlPeriod@1100528600 : Record 11071746;
    BEGIN
      IF ServiceContractCtrlPeriod.GET("Service Contract No.", "Contract Control Period Code") THEN
        EXIT(STRSUBSTNO('%1..%2', ServiceContractCtrlPeriod."Starting Date", "Effective Period Ending Date"));
    END;

    PROCEDURE SetAllPeriodFilters@1100528609();
    BEGIN
      SetContractControlPeriodFilter;
      SetControlPeriodFilter;
      SetEffContractControlPeriodFilter;
    END;

    BEGIN
    END.
  }
}

