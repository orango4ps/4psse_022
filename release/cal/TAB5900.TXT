OBJECT Table 5900 Service Header
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.05,4PS14.00,No part of 4PS Construct,NAVDK.NO;
  }
  PROPERTIES
  {
    Permissions=TableData 5914=d,
                TableData 5950=rimd;
    DataCaptionFields=No.,Name,Description;
    OnInsert=VAR
               ServShptHeader@1001 : Record 5990;
             BEGIN
               ServSetup.GET ;
               IF "No." = '' THEN BEGIN
                 TestNoSeries;
                 NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series",0D,"No.","No. Series");
               END;

               IF "Document Type" = "Document Type"::Order THEN BEGIN
                 ServShptHeader.SETRANGE("Order No.","No.");
                 IF NOT ServShptHeader.ISEMPTY THEN
                   ERROR(Text008,FORMAT("Document Type"),FIELDCAPTION("No."),"No.");
               END;

               InitRecord;

               CLEAR(ServLogMgt);
               ServLogMgt.ServHeaderCreate(Rec);

               IF "Salesperson Code" = '' THEN
                 SetDefaultSalesperson;

               IF GETFILTER("Customer No.") <> '' THEN BEGIN
                 CLEAR(xRec."Ship-to Code");
                 IF GETRANGEMIN("Customer No.") = GETRANGEMAX("Customer No.") THEN
                   VALIDATE("Customer No.",GETRANGEMIN("Customer No."));
               END;

               IF GETFILTER("Contact No.") <> '' THEN
                 IF GETRANGEMIN("Contact No.") = GETRANGEMAX("Contact No.") THEN
                   VALIDATE("Contact No.",GETRANGEMIN("Contact No."));
             END;

    OnModify=BEGIN
               UpdateServiceOrderChangeLog(xRec);
             END;

    OnDelete=VAR
               ServDocRegister@1000 : Record 5936;
               ServDocLog@1001 : Record 5912;
               ServOrderAlloc@1007 : Record 5950;
               ServCommentLine@1008 : Record 5906;
               WhseRequest@1003 : Record 5765;
               Loaner@1006 : Record 5913;
               LoanerEntry@1004 : Record 5914;
               ServAllocMgt@1002 : Codeunit 5930;
               ReservMgt@1005 : Codeunit 99000845;
             BEGIN
               IF NOT UserSetupMgt.CheckRespCenter(2,"Responsibility Center") THEN
                 ERROR(Text000,UserSetupMgt.GetServiceFilter);

               IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                 ServLine.RESET;
                 ServLine.SETRANGE("Document Type",ServLine."Document Type"::Invoice);
                 ServLine.SETRANGE("Document No.","No.");
                 ServLine.SETFILTER("Appl.-to Service Entry",'>%1',0);
                 IF NOT ServLine.ISEMPTY THEN
                   ERROR(Text046,"No.");
               END;

               ServPost.DeleteHeader(Rec,ServShptHeader,ServInvHeader,ServCrMemoHeader);
               VALIDATE("Applies-to ID",'');

               ServLine.RESET;
               ServLine.LOCKTABLE;

               ReservMgt.DeleteDocumentReservation(DATABASE::"Service Line","Document Type","No.",HideValidationDialog);

               WhseRequest.DeleteRequest(DATABASE::"Service Line","Document Type","No.");

               ServLine.SETRANGE("Document Type","Document Type");
               ServLine.SETRANGE("Document No.","No.");
               ServLine.SuspendStatusCheck(TRUE);
               ServLine.DELETEALL(TRUE);

               ServCommentLine.RESET;
               ServCommentLine.SETRANGE("Table Name",ServCommentLine."Table Name"::"Service Header");
               ServCommentLine.SETRANGE("Table Subtype","Document Type");
               ServCommentLine.SETRANGE("No.","No.");
               ServCommentLine.DELETEALL;

               ServDocRegister.SETCURRENTKEY("Destination Document Type","Destination Document No.");
               CASE "Document Type" OF
                 "Document Type"::Invoice:
                   BEGIN
                     ServDocRegister.SETRANGE("Destination Document Type",ServDocRegister."Destination Document Type"::Invoice);
                     ServDocRegister.SETRANGE("Destination Document No.","No.");
                     ServDocRegister.DELETEALL;
                   END;
                 "Document Type"::"Credit Memo":
                   BEGIN
                     ServDocRegister.SETRANGE("Destination Document Type",ServDocRegister."Destination Document Type"::"Credit Memo");
                     ServDocRegister.SETRANGE("Destination Document No.","No.");
                     ServDocRegister.DELETEALL;
                   END;
               END;

               ServOrderAlloc.RESET;
               ServOrderAlloc.SETCURRENTKEY("Document Type");
               ServOrderAlloc.SETRANGE("Document Type","Document Type");
               ServOrderAlloc.SETRANGE("Document No.","No.");
               ServOrderAlloc.SETRANGE(Posted,FALSE);
               ServOrderAlloc.DELETEALL;
               ServAllocMgt.SetServOrderAllocStatus(Rec);

               ServItemLine.RESET;
               ServItemLine.SETRANGE("Document Type","Document Type");
               ServItemLine.SETRANGE("Document No.","No.");
               IF ServItemLine.FIND('-') THEN
                 REPEAT
                   IF ServItemLine."Loaner No." <> '' THEN BEGIN
                     Loaner.GET(ServItemLine."Loaner No.");
                     LoanerEntry.SETRANGE("Document Type","Document Type" + 1);
                     LoanerEntry.SETRANGE("Document No.","No.");
                     LoanerEntry.SETRANGE("Loaner No.",ServItemLine."Loaner No.");
                     LoanerEntry.SETRANGE(Lent,TRUE);
                     IF NOT LoanerEntry.ISEMPTY THEN
                       ERROR(
                         Text040,
                         TABLECAPTION,
                         ServItemLine."Document No.",
                         ServItemLine."Line No.",
                         ServItemLine.FIELDCAPTION("Loaner No."),
                         ServItemLine."Loaner No.");

                     LoanerEntry.SETRANGE(Lent,TRUE);
                     LoanerEntry.DELETEALL;
                   END;

                   CLEAR(ServLogMgt);
                   ServLogMgt.ServItemOffServOrder(ServItemLine);
                   ServItemLine.DELETE;
                 UNTIL ServItemLine.NEXT = 0;

               ServDocLog.RESET;
               ServDocLog.SETRANGE("Document Type","Document Type");
               ServDocLog.SETRANGE("Document No.","No.");
               ServDocLog.DELETEALL;

               ServDocLog.RESET;
               ServDocLog.SETRANGE(Before,"No.");
               ServDocLog.SETFILTER("Document Type",'%1|%2|%3',
                 ServDocLog."Document Type"::Shipment,ServDocLog."Document Type"::"Posted Invoice",
                 ServDocLog."Document Type"::"Posted Credit Memo");
               ServDocLog.DELETEALL;

               IF (ServShptHeader."No." <> '') OR
                  (ServInvHeader."No." <> '') OR
                  (ServCrMemoHeader."No." <> '')
               THEN
                 MESSAGE(PostedDocsToPrintCreatedMsg);
             END;

    OnRename=BEGIN
               ERROR(Text044,TABLECAPTION);
             END;

    CaptionML=[ENU=Service Header;
               NOR=Servicehode;
               SVE=Servicehuvud];
    LookupPageID=Page5901;
    DrillDownPageID=Page5901;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              NOR=Bilagstype;
                                                              SVE=Dokumenttyp];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo;
                                                                    NOR=Tilbud,Ordre,Faktura,Kreditnota;
                                                                    SVE=Offert,Order,Faktura,Kreditnota];
                                                   OptionString=Quote,Order,Invoice,Credit Memo }
    { 2   ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                ConfirmManagement@1000 : Codeunit 27;
                                                                IsHandled@1001 : Boolean;
                                                              BEGIN
                                                                IF ("Customer No." <> xRec."Customer No.") AND (xRec."Customer No." <> '') THEN BEGIN
                                                                  IF "Contract No." <> '' THEN
                                                                    ERROR(
                                                                      Text003,
                                                                      FIELDCAPTION("Customer No."),
                                                                      "Document Type",FIELDCAPTION("No."),"No.",
                                                                      FIELDCAPTION("Contract No."),"Contract No.");
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    IF ServItemLineExists THEN
                                                                      Confirmed :=
                                                                        ConfirmManagement.ConfirmProcess(
                                                                          STRSUBSTNO(Text004,FIELDCAPTION("Customer No.")),TRUE)
                                                                    ELSE
                                                                      IF ServLineExists THEN
                                                                        Confirmed :=
                                                                          ConfirmManagement.ConfirmProcess(
                                                                            STRSUBSTNO(Text057,FIELDCAPTION("Customer No.")),TRUE)
                                                                      ELSE
                                                                        Confirmed :=
                                                                          ConfirmManagement.ConfirmProcess(
                                                                            STRSUBSTNO(Text005,FIELDCAPTION("Customer No.")),TRUE);
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      ServLine.SETFILTER("Quantity Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                                                                        ServLine.SETRANGE("Customer No.",xRec."Customer No.");
                                                                        ServLine.SETFILTER("Shipment No.",'<>%1','');
                                                                      END;

                                                                    IF ServLine.FINDFIRST THEN BEGIN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        ServLine.TESTFIELD("Quantity Shipped",0)
                                                                      ELSE
                                                                        ServLine.TESTFIELD("Shipment No.",'');
                                                                    END;
                                                                    MODIFY(TRUE);

                                                                    ServLine.LOCKTABLE;
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    ServLine.DELETEALL(TRUE);

                                                                    ServItemLine.LOCKTABLE;
                                                                    ServItemLine.RESET;
                                                                    ServItemLine.SETRANGE("Document Type","Document Type");
                                                                    ServItemLine.SETRANGE("Document No.","No.");
                                                                    ServItemLine.DELETEALL(TRUE);

                                                                    GET("Document Type","No.");
                                                                    IF "Customer No." = '' THEN BEGIN
                                                                      INIT;
                                                                      ServSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                GetCust("Customer No.");
                                                                IF "Customer No." <> '' THEN BEGIN
                                                                  IsHandled := FALSE;
                                                                  OnBeforeCheckBlockedCustomer(Cust,IsHandled);
                                                                  IF NOT IsHandled THEN
                                                                    Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                  Cust.TESTFIELD("Gen. Bus. Posting Group");
                                                                  CopyCustomerFields(Cust);
                                                                END;

                                                                IF "Customer No." = xRec."Customer No." THEN
                                                                  IF ShippedServLinesExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;

                                                                COMMIT;
                                                                IF Cust."Bill-to Customer No." <> '' THEN
                                                                  VALIDATE("Bill-to Customer No.",Cust."Bill-to Customer No.")
                                                                ELSE BEGIN
                                                                  IF "Bill-to Customer No." = "Customer No." THEN
                                                                    SkipBillToContact := TRUE;
                                                                  VALIDATE("Bill-to Customer No.","Customer No.");
                                                                  SkipBillToContact := FALSE;
                                                                END;

                                                                VALIDATE("Ship-to Code",'');
                                                                VALIDATE("Service Zone Code");

                                                                IF NOT SkipContact THEN
                                                                  UpdateCont("Customer No.");
                                                                "OIOUBL Profile Code" := Cust."OIOUBL Profile Code";  //NAVDK
                                                              END;

                                                   CaptionML=[ENU=Customer No.;
                                                              NOR=Kundenr.;
                                                              SVE=Kundnr] }
    { 3   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  ServSetup.GET;
                                                                  TestNoSeriesManual;
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.;
                                                              SVE=Nr] }
    { 4   ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                CustCheckCrLimit@1000 : Codeunit 312;
                                                                ConfirmManagement@1002 : Codeunit 27;
                                                                IsHandled@1001 : Boolean;
                                                              BEGIN
                                                                IF (xRec."Bill-to Customer No." <> "Bill-to Customer No.") AND
                                                                   (xRec."Bill-to Customer No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed :=
                                                                      ConfirmManagement.ConfirmProcess(
                                                                        STRSUBSTNO(Text005,FIELDCAPTION("Bill-to Customer No.")),TRUE);
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      ServLine.SETFILTER("Quantity Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN
                                                                        ServLine.SETFILTER("Shipment No.",'<>%1','');

                                                                    IF ServLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        ServLine.TESTFIELD("Quantity Shipped",0)
                                                                      ELSE
                                                                        ServLine.TESTFIELD("Shipment No.",'');
                                                                    ServLine.RESET;
                                                                  END ELSE
                                                                    "Bill-to Customer No." := xRec."Bill-to Customer No.";
                                                                END;

                                                                GetCust("Bill-to Customer No.");

                                                                IsHandled := FALSE;
                                                                OnBeforeCheckBlockedCustomer(Cust,IsHandled);
                                                                IF NOT IsHandled THEN
                                                                  Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);

                                                                Cust.TESTFIELD("Customer Posting Group");
                                                                "EAN No." := Cust."EAN No."; //NAVDK

                                                                IF GUIALLOWED AND NOT HideValidationDialog AND
                                                                   ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order,"Document Type"::Invoice])
                                                                THEN
                                                                  CustCheckCrLimit.ServiceHeaderCheck(Rec);

                                                                CopyBillToCustomerFields(Cust);

                                                                //>>NAVNO
                                                                GLN := Cust.GLN;
                                                                "E-Invoice" := Cust."E-Invoice";
                                                                //<<NAVNO
                                                                ValidateServPriceGrOnServItem;

                                                                IF "Bill-to Customer No." = xRec."Bill-to Customer No." THEN
                                                                  IF ShippedServLinesExist THEN BEGIN
                                                                    TESTFIELD("Customer Disc. Group",xRec."Customer Disc. Group");
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                  END;

                                                                CreateDim(
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Contract Header","Contract No.");

                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");

                                                                IF (xRec."Customer No." = "Customer No.") AND
                                                                   (xRec."Bill-to Customer No." <> "Bill-to Customer No.")
                                                                THEN
                                                                  RecreateServLines(FIELDCAPTION("Bill-to Customer No."));

                                                                IF NOT SkipBillToContact THEN
                                                                  UpdateBillToCont("Bill-to Customer No.");
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              NOR=Faktura til-kundenr.;
                                                              SVE=Faktureringskundnr];
                                                   NotBlank=Yes }
    { 5   ;   ;Bill-to Name        ;Text100       ;CaptionML=[ENU=Bill-to Name;
                                                              NOR=Faktura til-navn;
                                                              SVE=Faktureringsnamn] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[ENU=Bill-to Name 2;
                                                              NOR=Faktura til-navn 2;
                                                              SVE=Faktureringsnamn 2] }
    { 7   ;   ;Bill-to Address     ;Text100       ;CaptionML=[ENU=Bill-to Address;
                                                              NOR=Faktura til-adresse;
                                                              SVE=Faktureringsadress] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;CaptionML=[ENU=Bill-to Address 2;
                                                              NOR=Faktura til-adresse 2;
                                                              SVE=Faktureringsadress 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;TableRelation=IF (Bill-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Bill-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Bill-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Bill-to City;
                                                              NOR=Faktura til-sted;
                                                              SVE=Faktureras ort] }
    { 10  ;   ;Bill-to Contact     ;Text100       ;CaptionML=[ENU=Bill-to Contact;
                                                              NOR=Faktura til-kontakt;
                                                              SVE=Faktureringskontaktperson] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              NOR=Deres referanse;
                                                              SVE=Er referens] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   OnValidate=VAR
                                                                ShipToAddr@1000 : Record 222;
                                                                ConfirmManagement@1001 : Codeunit 27;
                                                              BEGIN
                                                                IF ("Ship-to Code" <> xRec."Ship-to Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN BEGIN
                                                                  IF ("Contract No." <> '') AND NOT HideValidationDialog THEN
                                                                    ERROR(
                                                                      Text003,
                                                                      FIELDCAPTION("Ship-to Code"),
                                                                      "Document Type",FIELDCAPTION("No."),"No.",
                                                                      FIELDCAPTION("Contract No."),"Contract No.");
                                                                  IF ServItemLineExists THEN BEGIN
                                                                    IF NOT ConfirmManagement.ConfirmProcess(
                                                                         STRSUBSTNO(Text004,FIELDCAPTION("Ship-to Code")),TRUE)
                                                                    THEN BEGIN
                                                                      "Ship-to Code" := xRec."Ship-to Code";
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE
                                                                    IF ServLineExists THEN
                                                                      IF NOT ConfirmManagement.ConfirmProcess(
                                                                           STRSUBSTNO(Text057,FIELDCAPTION("Ship-to Code")),TRUE)
                                                                      THEN BEGIN
                                                                        "Ship-to Code" := xRec."Ship-to Code";
                                                                        EXIT;
                                                                      END;
                                                                END;

                                                                IF "Document Type" <> "Document Type"::"Credit Memo" THEN
                                                                  IF "Ship-to Code" <> '' THEN BEGIN
                                                                    IF xRec."Ship-to Code" <> '' THEN BEGIN
                                                                      GetCust("Customer No.");
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        "Location Code" := Cust."Location Code";
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                    END;
                                                                    ShipToAddr.GET("Customer No.","Ship-to Code");
                                                                    SetShipToAddress(
                                                                      ShipToAddr.Name,ShipToAddr."Name 2",ShipToAddr.Address,ShipToAddr."Address 2",
                                                                      ShipToAddr.City,ShipToAddr."Post Code",ShipToAddr.County,ShipToAddr."Country/Region Code");
                                                                    "Ship-to Contact" := ShipToAddr.Contact;
                                                                    "Ship-to Phone" := ShipToAddr."Phone No.";
                                                                    IF ShipToAddr."Location Code" <> '' THEN
                                                                      "Location Code" := ShipToAddr."Location Code";
                                                                    "Ship-to Fax No." := ShipToAddr."Fax No.";
                                                                    "Ship-to E-Mail" := ShipToAddr."E-Mail";
                                                                    IF ShipToAddr."Tax Area Code" <> '' THEN
                                                                      "Tax Area Code" := ShipToAddr."Tax Area Code";
                                                                    "Tax Liable" := ShipToAddr."Tax Liable";
                                                                  END ELSE
                                                                    IF "Customer No." <> '' THEN BEGIN
                                                                      GetCust("Customer No.");
                                                                      SetShipToAddress(
                                                                        Cust.Name,Cust."Name 2",Cust.Address,Cust."Address 2",
                                                                        Cust.City,Cust."Post Code",Cust.County,Cust."Country/Region Code");
                                                                      "Ship-to Contact" := Cust.Contact;
                                                                      "Ship-to Phone" := Cust."Phone No.";
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                      "Tax Liable" := Cust."Tax Liable";
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        "Location Code" := Cust."Location Code";
                                                                      "Ship-to Fax No." := Cust."Fax No.";
                                                                      "Ship-to E-Mail" := Cust."E-Mail";
                                                                    END;

                                                                IF (xRec."Customer No." = "Customer No.") AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN
                                                                  IF (xRec."VAT Country/Region Code" <> "VAT Country/Region Code") OR
                                                                     (xRec."Tax Area Code" <> "Tax Area Code")
                                                                  THEN
                                                                    RecreateServLines(FIELDCAPTION("Ship-to Code"))
                                                                  ELSE BEGIN
                                                                    IF xRec."Tax Liable" <> "Tax Liable" THEN
                                                                      VALIDATE("Tax Liable");
                                                                  END;

                                                                VALIDATE("Service Zone Code");

                                                                IF ("Ship-to Code" <> xRec."Ship-to Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN BEGIN
                                                                  MODIFY(TRUE);
                                                                  ServLine.LOCKTABLE;
                                                                  ServItemLine.LOCKTABLE;
                                                                  ServLine.RESET;
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.DELETEALL(TRUE);
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.DELETEALL(TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              NOR=Lever til-kode;
                                                              SVE=Leveransadresskod] }
    { 13  ;   ;Ship-to Name        ;Text100       ;CaptionML=[ENU=Ship-to Name;
                                                              NOR=Lever til-navn;
                                                              SVE=Leveransnamn] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              NOR=Lever til-navn 2;
                                                              SVE=Leveransnamn 2] }
    { 15  ;   ;Ship-to Address     ;Text100       ;CaptionML=[ENU=Ship-to Address;
                                                              NOR=Lever til-adresse;
                                                              SVE=Leveransadress] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              NOR=Lever til-adresse 2;
                                                              SVE=Leveransadress 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              NOR=Lever til-sted;
                                                              SVE=Leveransort] }
    { 18  ;   ;Ship-to Contact     ;Text100       ;CaptionML=[ENU=Ship-to Contact;
                                                              NOR=Lever til-kontakt;
                                                              SVE=Leveranskontaktperson] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                IF "Order Date" <> xRec."Order Date" THEN BEGIN
                                                                  IF ("Order Date" > "Starting Date") AND
                                                                     ("Starting Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Date"),FIELDCAPTION("Starting Date"));

                                                                  IF ("Order Date" > "Finishing Date") AND
                                                                     ("Finishing Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Date"),FIELDCAPTION("Finishing Date"));

                                                                  IF "Starting Time" <> 0T THEN
                                                                    VALIDATE("Starting Time");
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF ServItemLine."Starting Date" < "Order Date" THEN
                                                                        ERROR(
                                                                          Text027,FIELDCAPTION("Order Date"),
                                                                          ServItemLine.FIELDCAPTION("Starting Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServItemLine.CheckWarranty("Order Date");
                                                                      ServItemLine.CalculateResponseDateTime("Order Date","Order Time");
                                                                      ServItemLine.MODIFY;
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                  UpdateServLinesByFieldNo(FIELDNO("Order Date"),FALSE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Date;
                                                              NOR=Ordredato;
                                                              SVE=Orderdatum];
                                                   NotBlank=Yes }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=VAR
                                                                NoSeries@1000 : Record 308;
                                                              BEGIN
                                                                IF ("Posting No." <> '') AND ("Posting No. Series" <> '') THEN BEGIN
                                                                  NoSeries.GET("Posting No. Series");
                                                                  IF NoSeries."Date Order" THEN
                                                                    ERROR(
                                                                      Text045,
                                                                      FIELDCAPTION("Posting Date"),FIELDCAPTION("Posting No. Series"),"Posting No. Series",
                                                                      NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
                                                                      FIELDCAPTION("Posting No."),"Posting No.");
                                                                END;

                                                                TESTFIELD("Posting Date");
                                                                VALIDATE("Document Date","Posting Date");

                                                                ServLine.SETRANGE("Document Type","Document Type");
                                                                ServLine.SETRANGE("Document No.","No.");
                                                                IF ServLine.FINDSET THEN
                                                                  REPEAT
                                                                    IF "Posting Date" <> ServLine."Posting Date" THEN BEGIN
                                                                      ServLine."Posting Date" := "Posting Date";
                                                                      ServLine.MODIFY;
                                                                    END;
                                                                  UNTIL ServLine.NEXT = 0;

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN BEGIN
                                                                  IF ServLineExists THEN
                                                                    ServLine.MODIFYALL("Posting Date","Posting Date");
                                                                END;

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    ConfirmUpdateCurrencyFactor;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato;
                                                              SVE=Bokf”ringsdatum] }
    { 22  ;   ;Posting Description ;Text100       ;CaptionML=[ENU=Posting Description;
                                                              NOR=Bokf›ringsbeskrivelse;
                                                              SVE=Bokf”ringsbeskrivning] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=VAR
                                                                PaymentTerms@1000 : Record 3;
                                                              BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF ("Document Type" IN ["Document Type"::"Credit Memo"]) AND
                                                                     NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos"
                                                                  THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    VALIDATE("Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  VALIDATE("Pmt. Discount Date",0D);
                                                                  VALIDATE("Payment Discount %",0);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              NOR=Betalingsbet.kode;
                                                              SVE=Betalningsvillkorskod] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato;
                                                              SVE=F”rfallodatum] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Payment Discount %;
                                                              NOR=Kontantrabatt-%;
                                                              SVE=Kassarabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              NOR=Kont.rabattdato;
                                                              SVE=Kassarabattsdatum] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                              END;

                                                   CaptionML=[ENU=Shipment Method Code;
                                                              NOR=Leveringsm†tekode;
                                                              SVE=Utleveransvillkorskod] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN
                                                                  MessageIfServLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode;
                                                              SVE=Lagerst„llekod] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1),
                                                                                               Blocked=CONST(No));
                                                   OnValidate=BEGIN
                                                                CheckHeaderDimension;
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode;
                                                              SVE=Genv„g dimension 1 kod];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2),
                                                                                               Blocked=CONST(No));
                                                   OnValidate=BEGIN
                                                                CheckHeaderDimension;
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode;
                                                              SVE=Genv„g dimension 2 kod];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code20      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[ENU=Customer Posting Group;
                                                              NOR=Bokf›ringsgruppe - kunde;
                                                              SVE=Kundbokf”ringsmall];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                IF CurrFieldNo <> FIELDNO("Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                    IF ServLineExists AND ("Contract No." <> '') AND
                                                                       ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"])
                                                                    THEN
                                                                      ERROR(Text058,FIELDCAPTION("Currency Code"),"Document Type","No.","Contract No.");

                                                                    UpdateCurrencyFactor;
                                                                    ValidateServPriceGrOnServItem;
                                                                  END ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdateServLinesByFieldNo(FIELDNO("Currency Factor"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              NOR=Valutafaktor;
                                                              SVE=Valutafaktor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 34  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                PriceMsgIfServLinesExist(FIELDCAPTION("Customer Price Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Price Group;
                                                              NOR=Kundeprisgruppe;
                                                              SVE=Kund prisgrupp] }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                ServLine@1002 : Record 5902;
                                                                Currency@1001 : Record 4;
                                                                ConfirmManagement@1003 : Codeunit 27;
                                                                RecalculatePrice@1000 : Boolean;
                                                              BEGIN
                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  TESTFIELD("Max. Labor Unit Price",0);
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.SETFILTER(Type,'>0');
                                                                  ServLine.SETFILTER(Quantity,'<>0');
                                                                  IF ServLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServLine.Amount := 0;
                                                                      ServLine."Amount Including VAT" := 0;
                                                                      ServLine."VAT Base Amount" := 0;
                                                                      ServLine.InitOutstandingAmount;
                                                                      ServLine.MODIFY;
                                                                    UNTIL ServLine.NEXT = 0;
                                                                  ServLine.SETRANGE(Type);
                                                                  ServLine.SETRANGE(Quantity);

                                                                  ServLine.SETFILTER("Unit Price",'<>%1',0);
                                                                  ServLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF ServLine.FIND('-') THEN BEGIN
                                                                    RecalculatePrice :=
                                                                      ConfirmManagement.ConfirmProcess(
                                                                        STRSUBSTNO(
                                                                          Text055,
                                                                          FIELDCAPTION("Prices Including VAT"),ServLine.FIELDCAPTION("Unit Price")),
                                                                        TRUE);
                                                                    ServLine.SetServHeader(Rec);

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");

                                                                    REPEAT
                                                                      ServLine.TESTFIELD("Quantity Invoiced",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        ServLine."VAT Difference" := 0;
                                                                        ServLine.InitOutstandingAmount;
                                                                      END ELSE
                                                                        IF "Prices Including VAT" THEN BEGIN
                                                                          ServLine."Unit Price" :=
                                                                            ROUND(
                                                                              ServLine."Unit Price" * (1 + (ServLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF ServLine.Quantity <> 0 THEN BEGIN
                                                                            ServLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                ServLine.CalcChargeableQty * ServLine."Unit Price" * ServLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            ServLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                ServLine."Inv. Discount Amount" * (1 + (ServLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          ServLine."Unit Price" :=
                                                                            ROUND(
                                                                              ServLine."Unit Price" / (1 + (ServLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF ServLine.Quantity <> 0 THEN BEGIN
                                                                            ServLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                ServLine.CalcChargeableQty * ServLine."Unit Price" * ServLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            ServLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                ServLine."Inv. Discount Amount" / (1 + (ServLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END;
                                                                      ServLine.MODIFY;
                                                                    UNTIL ServLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including VAT;
                                                              NOR=Priser inkl. mva.;
                                                              SVE=Priser inkl. moms] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;OnLookup=BEGIN
                                                              MessageIfServLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                            END;

                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              NOR=Fakturarabattkode;
                                                              SVE=Fakturarabattkod] }
    { 40  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Customer Disc. Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              NOR=Kunderabattgruppe;
                                                              SVE=Kundrabattgrupp] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[ENU=Language Code;
                                                              NOR=Spr†kkode;
                                                              SVE=Spr†kkod] }
    { 43  ;   ;Salesperson Code    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                ValidateSalesPersonOnServiceHeader(Rec,FALSE,FALSE);

                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::"Service Contract Header","Contract No.");
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              NOR=Selgerkode;
                                                              SVE=S„ljarkod] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Comment Line" WHERE (Table Name=CONST(Service Header),
                                                                                                   Table Subtype=FIELD(Document Type),
                                                                                                   No.=FIELD(No.),
                                                                                                   Type=CONST(General)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              NOR=Antall skrevet ut;
                                                              SVE=Utskriven];
                                                   Editable=No }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              NOR=Utligningsbilagstype;
                                                              SVE=Kopplas till dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    NOR=" ,Betaling,Faktura,Kreditnota,Rentenota,Purring,Refusjon";
                                                                    SVE=" ,Betalning,Faktura,Kreditnota,R„ntefaktura,Betalningsp†minnelse,terbetalning"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=VAR
                                                                CustLedgEntry@1000 : Record 21;
                                                              BEGIN
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   ("Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  CustLedgEntry.SetAmountToApply("Applies-to Doc. No.","Customer No.");
                                                                  CustLedgEntry.SetAmountToApply(xRec."Applies-to Doc. No.","Customer No.");
                                                                END ELSE
                                                                  IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    CustLedgEntry.SetAmountToApply("Applies-to Doc. No.","Customer No.")
                                                                  ELSE
                                                                    IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND ("Applies-to Doc. No." = '') THEN
                                                                      CustLedgEntry.SetAmountToApply(xRec."Applies-to Doc. No.","Customer No.");
                                                              END;

                                                   OnLookup=VAR
                                                              CustLedgEntry@1001 : Record 21;
                                                              GenJnlLine@1002 : Record 81;
                                                              GenJnlApply@1003 : Codeunit 225;
                                                              ApplyCustEntries@1000 : Page 232;
                                                            BEGIN
                                                              TESTFIELD("Bal. Account No.",'');
                                                              CustLedgEntry.SetApplyToFilters("Bill-to Customer No.","Applies-to Doc. Type","Applies-to Doc. No.",0);

                                                              ApplyCustEntries.SetService(Rec,CustLedgEntry,ServHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyCustEntries.SETTABLEVIEW(CustLedgEntry);
                                                              ApplyCustEntries.SETRECORD(CustLedgEntry);
                                                              ApplyCustEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyCustEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyCustEntries.GetCustLedgEntry(CustLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",CustLedgEntry."Currency Code",GenJnlLine."Account Type"::Customer,TRUE);
                                                                "Applies-to Doc. Type" := CustLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := CustLedgEntry."Document No.";
                                                              END;
                                                              CLEAR(ApplyCustEntries);
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              NOR=Utligningsbilagsnr.;
                                                              SVE=Kopplas till ver.nr] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=VAR
                                                                GLAcc@1000 : Record 15;
                                                                BankAcc@1001 : Record 270;
                                                              BEGIN
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              NOR=Motkontonr.;
                                                              SVE=Motkonto] }
    { 62  ;   ;Shipping No.        ;Code20        ;CaptionML=[ENU=Shipping No.;
                                                              NOR=F›lgeseddelnr.;
                                                              SVE=Leveransnr] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              NOR=Bokf›ringsnr.;
                                                              SVE=Bokf”ring med nr] }
    { 64  ;   ;Last Shipping No.   ;Code20        ;TableRelation="Service Shipment Header";
                                                   CaptionML=[ENU=Last Shipping No.;
                                                              NOR=Siste f›lgeseddelnummer;
                                                              SVE=Senaste leveransnr];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Service Invoice Header";
                                                   CaptionML=[ENU=Last Posting No.;
                                                              NOR=Siste bokf›ringsnr.;
                                                              SVE=Senast bokf”rt med nr];
                                                   Editable=No }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=VAT Registration No.;
                                                              NOR=Organisasjonsnr.;
                                                              SVE=Momsregistreringsnr] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              NOR=rsaksspor;
                                                              SVE=Uppf”ljningskod] }
    { 74  ;   ;Gen. Bus. Posting Group;Code20     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=VAR
                                                                GenBusPostingGroup@1000 : Record 250;
                                                              BEGIN
                                                                IF "Gen. Bus. Posting Group" <> xRec."Gen. Bus. Posting Group" THEN BEGIN
                                                                  IF GenBusPostingGroup.ValidateVatBusPostingGroup(GenBusPostingGroup,"Gen. Bus. Posting Group") THEN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGroup."Def. VAT Bus. Posting Group";
                                                                  RecreateServLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokf›ringsgruppe - firma;
                                                              SVE=Gen. r”relsebokf”ringsmall] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              NOR=Trekanthandel;
                                                              SVE=EU trepartshandel] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdateServLinesByFieldNo(FIELDNO("Transaction Type"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart;
                                                              SVE=EU transaktionstyp] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdateServLinesByFieldNo(FIELDNO("Transport Method"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=Transportm†te;
                                                              SVE=Transports„tt] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=VAT Country/Region Code;
                                                              NOR=Lands-/omr†dekode for mva;
                                                              SVE=Momskod f”r land/region] }
    { 79  ;   ;Name                ;Text100       ;CaptionML=[ENU=Name;
                                                              NOR=Navn;
                                                              SVE=Namn] }
    { 80  ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              NOR=Navn 2;
                                                              SVE=Namn 2] }
    { 81  ;   ;Address             ;Text100       ;OnValidate=BEGIN
                                                                UpdateShipToAddressFromGeneralAddress(FIELDNO("Ship-to Address"));
                                                              END;

                                                   CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress] }
    { 82  ;   ;Address 2           ;Text50        ;OnValidate=BEGIN
                                                                UpdateShipToAddressFromGeneralAddress(FIELDNO("Ship-to Address 2"));
                                                              END;

                                                   CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2;
                                                              SVE=Adress 2] }
    { 83  ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                UpdateShipToAddressFromGeneralAddress(FIELDNO("Ship-to City"));
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode(City,"Post Code",County,"Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Sted;
                                                              SVE=Ort] }
    { 84  ;   ;Contact Name        ;Text100       ;CaptionML=[ENU=Contact Name;
                                                              NOR=Kontaktnavn;
                                                              SVE=Kontaktnamn] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;TableRelation=IF (Bill-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Bill-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Bill-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Bill-to Post Code;
                                                              NOR=Faktura til-postnr.;
                                                              SVE=Faktureras postnr] }
    { 86  ;   ;Bill-to County      ;Text30        ;CaptionML=[ENU=Bill-to County;
                                                              NOR=Faktura til-fylke/delstat;
                                                              SVE=Faktureras delstat];
                                                   CaptionClass='5,1,' + "Bill-to Country/Region Code" }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Bill-to Country/Region Code;
                                                              NOR=Lands-/omr†dekode for Faktura til;
                                                              SVE=Faktureringsland/-region] }
    { 88  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                UpdateShipToAddressFromGeneralAddress(FIELDNO("Ship-to Post Code"));
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode(City,"Post Code",County,"Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr.;
                                                              SVE=Postnr] }
    { 89  ;   ;County              ;Text30        ;OnValidate=BEGIN
                                                                UpdateShipToAddressFromGeneralAddress(FIELDNO("Ship-to County"));
                                                              END;

                                                   CaptionML=[ENU=County;
                                                              NOR=Fylke/delstat;
                                                              SVE=Delstat];
                                                   CaptionClass='5,1,' + "Country/Region Code" }
    { 90  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                UpdateShipToAddressFromGeneralAddress(FIELDNO("Ship-to Country/Region Code"));

                                                                VALIDATE("Ship-to Country/Region Code");
                                                              END;

                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/omr†dekode;
                                                              SVE=Lands-/regionkod] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to Post Code;
                                                              NOR=Lever til-postnr.;
                                                              SVE=Leveranspostnrkod] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[ENU=Ship-to County;
                                                              NOR=Lever til-fylke/delstat;
                                                              SVE=Leveransdelstat];
                                                   CaptionClass='5,1,' + "Ship-to Country/Region Code" }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              NOR=Lands-/omr†dekode for Lever til;
                                                              SVE=Kod f”r leveransland/-region] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              NOR=Motkontotype;
                                                              SVE=Motkontotyp];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    NOR=Finanskonto,Bankkonto;
                                                                    SVE=Redov.konto,Bankkonto];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdateServLinesByFieldNo(FIELDNO("Exit Point"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Exit Point;
                                                              NOR=Utpunkt;
                                                              SVE=Utf”rselplats] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              NOR=Korreksjon;
                                                              SVE=R„ttningstransaktion] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdateServLinesByFieldNo(FIELDNO(Area),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Area;
                                                              NOR=Omr†de;
                                                              SVE=Omr†de] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdateServLinesByFieldNo(FIELDNO("Transaction Specification"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon;
                                                              SVE=EU transaktionsspecifikation] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=VAR
                                                                PaymentMethod@1000 : Record 289;
                                                              BEGIN
                                                                IF PaymentMethod.GET("Payment Method Code") THEN BEGIN
                                                                  "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                  "Bal. Account No." := PaymentMethod."Bal. Account No.";
                                                                END;
                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                END;

                                                                "Payment Channel" := PaymentMethod."Payment Channel"; //NAVDK
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              NOR=Betalingsm†te - kode;
                                                              SVE=Betalningss„tt] }
    { 105 ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                                IF xRec."Shipping Agent Code" = "Shipping Agent Code" THEN
                                                                  EXIT;

                                                                "Shipping Agent Service Code" := '';
                                                                GetShippingTime(FIELDNO("Shipping Agent Code"));
                                                                UpdateServLinesByFieldNo(FIELDNO("Shipping Agent Code"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              NOR=Transport›rkode;
                                                              SVE=Spedit”rkod] }
    { 107 ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code20        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  ServSetup.GET;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH ServHeader DO BEGIN
                                                                ServHeader := Rec;
                                                                ServSetup.GET;
                                                                TestNoSeries;
                                                                IF NoSeriesMgt.LookupSeries(GetPostingNoSeriesCode,"Posting No. Series") THEN
                                                                  VALIDATE("Posting No. Series");
                                                                Rec := ServHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Posting No. Series;
                                                              NOR=Bokf›ringsnr.serie;
                                                              SVE=Bokf”ringsnr-serie] }
    { 109 ;   ;Shipping No. Series ;Code20        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Shipping No. Series" <> '' THEN BEGIN
                                                                  ServSetup.GET;
                                                                  ServSetup.TESTFIELD("Posted Service Shipment Nos.");
                                                                  NoSeriesMgt.TestSeries(ServSetup."Posted Service Shipment Nos.","Shipping No. Series");
                                                                END;
                                                                TESTFIELD("Shipping No.",'');
                                                              END;

                                                   CaptionML=[ENU=Shipping No. Series;
                                                              NOR=F›lgeseddelnr.serie;
                                                              SVE=Leverans nr-serie] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Tax Area Code"));
                                                              END;

                                                   CaptionML=[ENU=Tax Area Code;
                                                              NOR=Mva-omr†dekode;
                                                              SVE=Skatteomr†deskod] }
    { 115 ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Tax Liable"));
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              NOR=Skyldig mva.;
                                                              SVE=Skattepliktig] }
    { 116 ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "VAT Bus. Posting Group" <> xRec."VAT Bus. Posting Group" THEN
                                                                  RecreateServLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - firma;
                                                              SVE=Moms r”relsebokf”ringsmall] }
    { 117 ;   ;Reserve             ;Option        ;CaptionML=[ENU=Reserve;
                                                              NOR=Reserver;
                                                              SVE=Reservera];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    NOR=Aldri,Alternativt,Alltid;
                                                                    SVE=Aldrig,Valfri,Alltid];
                                                   OptionString=Never,Optional,Always }
    { 118 ;   ;Applies-to ID       ;Code50        ;OnValidate=VAR
                                                                CustLedgEntry@1002 : Record 21;
                                                                TempCustLedgEntry@1000 : TEMPORARY Record 21;
                                                                CustEntrySetApplID@1001 : Codeunit 101;
                                                              BEGIN
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.",Open);
                                                                  CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  CustLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF CustLedgEntry.FINDFIRST THEN
                                                                    CustEntrySetApplID.SetApplId(CustLedgEntry,TempCustLedgEntry,'');
                                                                  CustLedgEntry.RESET;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              NOR=Utlignings-ID;
                                                              SVE=Koppla till ID] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN
                                                                  ERROR(
                                                                    Text011,
                                                                    FIELDCAPTION("VAT Base Discount %"),
                                                                    GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                    GLSetup.TABLECAPTION);

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                ServLine.RESET;
                                                                ServLine.SETRANGE("Document Type","Document Type");
                                                                ServLine.SETRANGE("Document No.","No.");
                                                                ServLine.SETFILTER(Type,'<>%1',ServLine.Type::" ");
                                                                ServLine.SETFILTER(Quantity,'<>0');
                                                                ServLine.LOCKTABLE;
                                                                LOCKTABLE;
                                                                IF ServLine.FINDSET THEN BEGIN
                                                                  MODIFY;
                                                                  REPEAT
                                                                    IF (ServLine."Quantity Invoiced" <> ServLine.Quantity) OR
                                                                       ("Shipping Advice" <> "Shipping Advice"::Partial) OR
                                                                       (CurrFieldNo <> 0)
                                                                    THEN BEGIN
                                                                      ServLine.UpdateAmounts;
                                                                      ServLine.MODIFY;
                                                                    END;
                                                                  UNTIL ServLine.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=VAT Base Discount %;
                                                              NOR=Mva-gr.lagsrabatt-%;
                                                              SVE=Nettobelopprabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;OnValidate=VAR
                                                                JobQueueEntry@1000 : Record 472;
                                                                RepairStatus@1001 : Record 5927;
                                                              BEGIN
                                                                ServItemLine.RESET;
                                                                ServItemLine.SETRANGE("Document Type","Document Type");
                                                                ServItemLine.SETRANGE("Document No.","No.");
                                                                LinesExist := TRUE;
                                                                IF ServItemLine.FIND('-') THEN
                                                                  REPEAT
                                                                    IF ServItemLine."Repair Status Code" <> '' THEN BEGIN
                                                                      RepairStatus.GET(ServItemLine."Repair Status Code");
                                                                      IF ((Status = Status::Pending) AND NOT RepairStatus."Pending Status Allowed") OR
                                                                         ((Status = Status::"In Process") AND NOT RepairStatus."In Process Status Allowed") OR
                                                                         ((Status = Status::Finished) AND NOT RepairStatus."Finished Status Allowed") OR
                                                                         ((Status = Status::"On Hold") AND NOT RepairStatus."On Hold Status Allowed")
                                                                      THEN
                                                                        ERROR(
                                                                          Text031,
                                                                          FIELDCAPTION(Status),FORMAT(Status),TABLECAPTION,"No.",ServItemLine.FIELDCAPTION("Repair Status Code"),
                                                                          ServItemLine."Repair Status Code",ServItemLine.TABLECAPTION,ServItemLine."Line No.")
                                                                    END;
                                                                  UNTIL ServItemLine.NEXT = 0
                                                                ELSE
                                                                  LinesExist := FALSE;

                                                                CASE Status OF
                                                                  Status::"In Process":
                                                                    BEGIN
                                                                      IF NOT LinesExist THEN BEGIN
                                                                        "Starting Date" := WORKDATE;
                                                                        VALIDATE("Starting Time",TIME);
                                                                      END ELSE
                                                                        UpdateStartingDateTime;
                                                                    END;
                                                                  Status::Finished:
                                                                    BEGIN
                                                                      TestMandatoryFields(ServLine);
                                                                      IF Status <> xRec.Status THEN
                                                                        IF "Notify Customer" = "Notify Customer"::"By Email" THEN BEGIN
                                                                          TESTFIELD("Customer No.");
                                                                          CLEAR(NotifyCust);
                                                                          NotifyCust.RUN(Rec);
                                                                        END;
                                                                      IF NOT LinesExist THEN BEGIN
                                                                        IF ("Finishing Date" = 0D) AND ("Finishing Time" = 0T) THEN BEGIN
                                                                          "Finishing Date" := WORKDATE;
                                                                          "Finishing Time" := TIME;
                                                                        END;
                                                                      END ELSE
                                                                        UpdateFinishingDateTime;
                                                                    END;
                                                                END;

                                                                IF Status <> Status::Finished THEN BEGIN
                                                                  "Finishing Date" := 0D;
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;

                                                                IF ("Starting Date" <> 0D) AND
                                                                   ("Finishing Date" <> 0D) AND
                                                                   NOT LinesExist
                                                                THEN BEGIN
                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Service Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Starting Date","Starting Time","Finishing Date","Finishing Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END;

                                                                IF Status = Status::Pending THEN
                                                                  IF ServSetup.GET THEN
                                                                    IF ServSetup."First Warning Within (Hours)" <> 0 THEN
                                                                      IF JobQueueEntry.WRITEPERMISSION THEN BEGIN
                                                                        JobQueueEntry.SETRANGE("Object Type to Run",JobQueueEntry."Object Type to Run"::Codeunit);
                                                                        JobQueueEntry.SETRANGE("Object ID to Run",CODEUNIT::"ServOrder-Check Response Time");
                                                                        JobQueueEntry.SETRANGE(Status,JobQueueEntry.Status::"On Hold");
                                                                        IF JobQueueEntry.FINDFIRST THEN
                                                                          JobQueueEntry.SetStatus(JobQueueEntry.Status::Ready);
                                                                      END;
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[ENU=Pending,In Process,Finished,On Hold;
                                                                    NOR=I k›,I arbeid,Ferdig,Avvent;
                                                                    SVE=F”rest†ende,P†g†ende,Avslutad,Stoppad];
                                                   OptionString=Pending,In Process,Finished,On Hold }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              NOR=Fakturarabattberegning;
                                                              SVE=Fakturarabattber„kning];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    NOR=Ingen,%,Bel›p;
                                                                    SVE=Ingen,%,Belopp];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              NOR=Fakturarabattverdi;
                                                              SVE=Fakturarabattv„rde];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 130 ;   ;Release Status      ;Option        ;CaptionML=[ENU=Release Status;
                                                              NOR=Frigivelsesstatus;
                                                              SVE=Sl„ppningsstatus];
                                                   OptionCaptionML=[ENU=Open,Released to Ship;
                                                                    NOR=pen,Frigitt til levering;
                                                                    SVE=™ppen,Frisl„ppt till leverans];
                                                   OptionString=Open,Released to Ship;
                                                   Editable=No }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnValidate=BEGIN
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID;
                                                              SVE=Dimensionsupps„ttnings-ID];
                                                   Editable=No }
    { 5052;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1000 : Record 5050;
                                                                ContBusinessRelation@1001 : Record 5054;
                                                                ConfirmManagement@1002 : Codeunit 27;
                                                              BEGIN
                                                                IF ("Contact No." <> xRec."Contact No.") AND
                                                                   (xRec."Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed :=
                                                                      ConfirmManagement.ConfirmProcess(
                                                                        STRSUBSTNO(Text005,FIELDCAPTION("Contact No.")),TRUE);
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF ("Contact No." = '') AND ("Customer No." = '') THEN BEGIN
                                                                      IF NOT ServLine.ISEMPTY THEN
                                                                        ERROR(Text050,FIELDCAPTION("Contact No."));
                                                                      InitRecordFromContact;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Customer No." <> '') AND ("Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Contact No.");
                                                                  IF ContBusinessRelation.FindByRelation(ContBusinessRelation."Link to Table"::Customer,"Customer No.") AND
                                                                     (ContBusinessRelation."Contact No." <> Cont."Company No.")
                                                                  THEN
                                                                    ERROR(Text038,Cont."No.",Cont.Name,"Customer No.");
                                                                END;

                                                                UpdateCust("Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1000 : Record 5050;
                                                              ContBusinessRelation@1001 : Record 5054;
                                                            BEGIN
                                                              IF "Customer No." <> '' THEN
                                                                IF Cont.GET("Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE
                                                                  IF ContBusinessRelation.FindByRelation(ContBusinessRelation."Link to Table"::Customer,"Customer No.") THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');

                                                              IF "Contact No." <> '' THEN
                                                                IF Cont.GET("Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Contact No.;
                                                              NOR=Kontaktnr.;
                                                              SVE=Kontaktnr] }
    { 5053;   ;Bill-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1001 : Record 5050;
                                                                ContBusinessRelation@1000 : Record 5054;
                                                                ConfirmManagement@1002 : Codeunit 27;
                                                              BEGIN
                                                                IF ("Bill-to Contact No." <> xRec."Bill-to Contact No.") AND
                                                                   (xRec."Bill-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed :=
                                                                      ConfirmManagement.ConfirmProcess(
                                                                        STRSUBSTNO(Text005,FIELDCAPTION("Bill-to Contact No.")),TRUE);
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF ("Bill-to Contact No." = '') AND ("Bill-to Customer No." = '') THEN BEGIN
                                                                      IF NOT ServLine.ISEMPTY THEN
                                                                        ERROR(Text050,FIELDCAPTION("Bill-to Contact No."));
                                                                      InitRecordFromContact;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Contact No." := xRec."Bill-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Bill-to Customer No." <> '') AND ("Bill-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Bill-to Contact No.");
                                                                  IF ContBusinessRelation.FindByRelation(ContBusinessRelation."Link to Table"::Customer,"Bill-to Customer No.") AND
                                                                     (ContBusinessRelation."Contact No." <> Cont."Company No.")
                                                                  THEN
                                                                    ERROR(Text038,Cont."No.",Cont.Name,"Bill-to Customer No.");
                                                                END;

                                                                UpdateBillToCust("Bill-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Bill-to Customer No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE
                                                                  IF ContBusinessRelation.FindByRelation(ContBusinessRelation."Link to Table"::Customer,"Bill-to Customer No.") THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');

                                                              IF "Bill-to Contact No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Bill-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Bill-to Contact No.;
                                                              NOR=Faktura til-kontaktnr.;
                                                              SVE=Faktureringskontaktnr] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=VAR
                                                                RespCenter@1000 : Record 5714;
                                                              BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter(2,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text010,
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetServiceFilter);

                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::"Service Contract Header","Contract No.");

                                                                ServItemLine.RESET;
                                                                ServItemLine.SETRANGE("Document Type","Document Type");
                                                                ServItemLine.SETRANGE("Document No.","No.");
                                                                IF ServItemLine.FIND('-') THEN
                                                                  REPEAT
                                                                    ServItemLine.VALIDATE("Responsibility Center","Responsibility Center");
                                                                    ServItemLine.MODIFY(TRUE);
                                                                  UNTIL ServItemLine.NEXT = 0;

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                  RecreateServLines(FIELDCAPTION("Responsibility Center"));
                                                                  VALIDATE("Location Code",UserSetupMgt.GetLocation(2,'',"Responsibility Center"));
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              NOR=Ansvarssenter;
                                                              SVE=Ansvarsenhet] }
    { 5750;   ;Shipping Advice     ;Option        ;OnValidate=VAR
                                                                WhseValidateSourceHeader@1000 : Codeunit 5781;
                                                              BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                                IF InventoryPickConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(Text064,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION);
                                                                IF WhseShpmntConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(Text065,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION);
                                                                WhseValidateSourceHeader.ServiceHeaderVerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Shipping Advice;
                                                              NOR=Leverings›nske;
                                                              SVE=Leveranstyp];
                                                   OptionCaptionML=[ENU=Partial,Complete;
                                                                    NOR=Delvis,Fullstendig;
                                                                    SVE=Delvis,Fullst„ndig];
                                                   OptionString=Partial,Complete }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Service Line"."Completely Shipped" WHERE (Document Type=FIELD(Document Type),
                                                                                                              Document No.=FIELD(No.),
                                                                                                              Type=FILTER(<>' '),
                                                                                                              Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Completely Shipped;
                                                              NOR=Fullstendig levert;
                                                              SVE=F„rdigt levererat];
                                                   Editable=No }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location.Code;
                                                   CaptionML=[ENU=Location Filter;
                                                              NOR=Lokasjonsfilter;
                                                              SVE=Lagerst„llefilter] }
    { 5792;   ;Shipping Time       ;DateFormula   ;OnValidate=BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                                IF "Shipping Time" <> xRec."Shipping Time" THEN
                                                                  UpdateServLinesByFieldNo(FIELDNO("Shipping Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Time;
                                                              NOR=Leveringstid;
                                                              SVE=Leveranstid] }
    { 5794;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Release Status","Release Status"::Open);
                                                                GetShippingTime(FIELDNO("Shipping Agent Service Code"));
                                                                UpdateServLinesByFieldNo(FIELDNO("Shipping Agent Service Code"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Service Code;
                                                              NOR=Transport›rservicekode;
                                                              SVE=Spedit”r servicekod] }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter;
                                                              SVE=Datumfilter] }
    { 5902;   ;Description         ;Text100       ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 5904;   ;Service Order Type  ;Code10        ;TableRelation="Service Order Type";
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Contract Header","Contract No.");
                                                              END;

                                                   CaptionML=[ENU=Service Order Type;
                                                              NOR=Serviceordretype;
                                                              SVE=Serviceordertyp] }
    { 5905;   ;Link Service to Service Item;Boolean;
                                                   OnValidate=BEGIN
                                                                IF "Link Service to Service Item" <> xRec."Link Service to Service Item" THEN BEGIN
                                                                  ServLine.RESET;
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.SETFILTER(Type,'<>%1',ServLine.Type::Cost);
                                                                  IF ServLine.FIND('-') THEN
                                                                    MESSAGE(
                                                                      Text001,
                                                                      FIELDCAPTION("Link Service to Service Item"),
                                                                      "No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Link Service to Service Item;
                                                              NOR=Knytt service til servicevare;
                                                              SVE=L„nka till serviceartikel] }
    { 5907;   ;Priority            ;Option        ;CaptionML=[ENU=Priority;
                                                              NOR=Prioritet;
                                                              SVE=Prioritet];
                                                   OptionCaptionML=[ENU=Low,Medium,High;
                                                                    NOR=Lav,Middels,H›y;
                                                                    SVE=L†g,Medium,H”g];
                                                   OptionString=Low,Medium,High;
                                                   Editable=No }
    { 5911;   ;Allocated Hours     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Allocation"."Allocated Hours" WHERE (Document Type=FIELD(Document Type),
                                                                                                                       Document No.=FIELD(No.),
                                                                                                                       Allocation Date=FIELD(Date Filter),
                                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                                       Status=FILTER(Active|Finished),
                                                                                                                       Resource Group No.=FIELD(Resource Group Filter)));
                                                   CaptionML=[ENU=Allocated Hours;
                                                              NOR=Tildelte timer;
                                                              SVE=F”rdelade timmar];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5915;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              NOR=Telefonnr.;
                                                              SVE=Telefonnr] }
    { 5916;   ;E-Mail              ;Text80        ;OnValidate=VAR
                                                                MailManagement@1000 : Codeunit 9520;
                                                              BEGIN
                                                                MailManagement.ValidateEmailAddressField("E-Mail");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 5917;   ;Phone No. 2         ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No. 2;
                                                              NOR=Telefonnr. 2;
                                                              SVE=Telefonnr 2] }
    { 5918;   ;Fax No.             ;Text30        ;CaptionML=[ENU=Fax No.;
                                                              NOR=Faksnr.;
                                                              SVE=Telefaxnr] }
    { 5921;   ;No. of Unallocated Items;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Item Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                Document No.=FIELD(No.),
                                                                                                No. of Active/Finished Allocs=CONST(0)));
                                                   CaptionML=[ENU=No. of Unallocated Items;
                                                              NOR=Ant. ikke-fordelte varer;
                                                              SVE=Antal ej f”rdelade artiklar];
                                                   Editable=No }
    { 5923;   ;Order Time          ;Time          ;OnValidate=BEGIN
                                                                IF "Order Time" <> xRec."Order Time" THEN BEGIN
                                                                  IF ("Order Time" > "Starting Time") AND
                                                                     ("Starting Time" <> 0T) AND
                                                                     ("Order Date" = "Starting Date")
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Time"),FIELDCAPTION("Starting Time"));
                                                                  IF "Starting Time" <> 0T THEN
                                                                    VALIDATE("Starting Time");
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServItemLine.CalculateResponseDateTime("Order Date","Order Time");
                                                                      ServItemLine.MODIFY;
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Time;
                                                              NOR=Ordretidspunkt;
                                                              SVE=Ordertid];
                                                   NotBlank=Yes }
    { 5924;   ;Default Response Time (Hours);Decimal;
                                                   CaptionML=[ENU=Default Response Time (Hours);
                                                              NOR=Standard responstid (timer);
                                                              SVE=Standard svarstid (timmar)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5925;   ;Actual Response Time (Hours);Decimal;
                                                   CaptionML=[ENU=Actual Response Time (Hours);
                                                              NOR=Faktisk responstid (timer);
                                                              SVE=Faktisk svarstid (timmar)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 5926;   ;Service Time (Hours);Decimal       ;CaptionML=[ENU=Service Time (Hours);
                                                              NOR=Servicetid (timer);
                                                              SVE=Servicetid (timmar)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5927;   ;Response Date       ;Date          ;CaptionML=[ENU=Response Date;
                                                              NOR=Responsdato;
                                                              SVE=Svarsdatum];
                                                   Editable=No }
    { 5928;   ;Response Time       ;Time          ;CaptionML=[ENU=Response Time;
                                                              NOR=Responstid;
                                                              SVE=Svarstid];
                                                   Editable=No }
    { 5929;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                IF "Starting Date" <> 0D THEN BEGIN
                                                                  IF "Starting Date" < "Order Date" THEN
                                                                    ERROR(Text026,FIELDCAPTION("Starting Date"),FIELDCAPTION("Order Date"));

                                                                  IF ("Starting Date" > "Finishing Date") AND
                                                                     ("Finishing Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Starting Date"),FIELDCAPTION("Finishing Time"));

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF ServItemLine."Starting Date" < "Starting Date" THEN
                                                                        ERROR(Text024,FIELDCAPTION("Starting Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;

                                                                  IF TIME < "Order Time" THEN
                                                                    VALIDATE("Starting Time","Order Time")
                                                                  ELSE
                                                                    VALIDATE("Starting Time",TIME);
                                                                END ELSE BEGIN
                                                                  "Starting Time" := 0T;
                                                                  "Actual Response Time (Hours)" := 0;
                                                                  "Finishing Date" := 0D;
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato;
                                                              SVE=Startdatum] }
    { 5930;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                TESTFIELD("Starting Date");

                                                                IF ("Starting Date" = "Finishing Date") AND
                                                                   ("Starting Time" > "Finishing Time")
                                                                THEN
                                                                  ERROR(Text007,FIELDCAPTION("Starting Time"),FIELDCAPTION("Finishing Time"));

                                                                IF ("Starting Date" = "Order Date") AND
                                                                   ("Starting Time" < "Order Time")
                                                                THEN
                                                                  ERROR(Text026,FIELDCAPTION("Starting Time"),FIELDCAPTION("Order Time"));

                                                                IF ("Starting Time" = 0T) AND (xRec."Starting Time" <> 0T) THEN BEGIN
                                                                  "Finishing Time" := 0T;
                                                                  "Finishing Date" := 0D;
                                                                  "Service Time (Hours)" := 0;
                                                                END;

                                                                IF ("Starting Time" <> 0T) AND
                                                                   ("Starting Date" <> 0D)
                                                                THEN BEGIN
                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Actual Response Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Order Date","Order Time","Starting Date","Starting Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END ELSE
                                                                  "Actual Response Time (Hours)" := 0;
                                                                IF "Finishing Time" <> 0T THEN
                                                                  VALIDATE("Finishing Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt;
                                                              SVE=Starttid] }
    { 5931;   ;Finishing Date      ;Date          ;OnValidate=BEGIN
                                                                IF "Finishing Date" <> 0D THEN BEGIN
                                                                  IF "Finishing Date" < "Starting Date" THEN
                                                                    ERROR(Text026,FIELDCAPTION("Finishing Date"),FIELDCAPTION("Starting Date"));

                                                                  IF "Finishing Date" < "Order Date" THEN
                                                                    ERROR(
                                                                      Text026,
                                                                      FIELDCAPTION("Finishing Date"),
                                                                      FIELDCAPTION("Order Date"));

                                                                  IF "Starting Date" = 0D THEN BEGIN
                                                                    "Starting Date" := "Finishing Date";
                                                                    "Starting Time" := TIME;
                                                                    CALCFIELDS("Contract Serv. Hours Exist");
                                                                    "Actual Response Time (Hours)" :=
                                                                      ServOrderMgt.CalcServTime(
                                                                        "Order Date","Order Time","Starting Date","Starting Time",
                                                                        "Contract No.","Contract Serv. Hours Exist");
                                                                  END;

                                                                  IF "Finishing Date" <> xRec."Finishing Date" THEN BEGIN
                                                                    IF TIME < "Starting Time" THEN
                                                                      "Finishing Time" := "Starting Time"
                                                                    ELSE
                                                                      "Finishing Time" := TIME;
                                                                    VALIDATE("Finishing Time");
                                                                  END;

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF ServItemLine."Finishing Date" > "Finishing Date" THEN
                                                                        ERROR(Text025,FIELDCAPTION("Finishing Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                END ELSE BEGIN
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Finishing Date;
                                                              NOR=Ferdig den;
                                                              SVE=F„rdigdatum] }
    { 5932;   ;Finishing Time      ;Time          ;OnValidate=BEGIN
                                                                TESTFIELD("Finishing Date");
                                                                IF "Finishing Time" <> 0T THEN BEGIN
                                                                  IF ("Starting Date" = "Finishing Date") AND
                                                                     ("Finishing Time" < "Starting Time")
                                                                  THEN
                                                                    ERROR(
                                                                      Text026,FIELDCAPTION("Finishing Time"),
                                                                      FIELDCAPTION("Starting Time"));

                                                                  IF ("Finishing Date" = "Order Date") AND
                                                                     ("Finishing Time" < "Order Time")
                                                                  THEN
                                                                    ERROR(
                                                                      Text026,FIELDCAPTION("Finishing Time"),
                                                                      FIELDCAPTION("Order Time"));

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF (ServItemLine."Finishing Date" = "Finishing Date") AND
                                                                         (ServItemLine."Finishing Time" > "Finishing Time")
                                                                      THEN
                                                                        ERROR(Text025,FIELDCAPTION("Finishing Time"));
                                                                    UNTIL ServItemLine.NEXT = 0;

                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Service Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Starting Date","Starting Time","Finishing Date","Finishing Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END ELSE
                                                                  "Service Time (Hours)" := 0;
                                                              END;

                                                   CaptionML=[ENU=Finishing Time;
                                                              NOR=Ferdig klokken;
                                                              SVE=F„rdigtid] }
    { 5933;   ;Contract Serv. Hours Exist;Boolean ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Hour" WHERE (Service Contract No.=FIELD(Contract No.)));
                                                   CaptionML=[ENU=Contract Serv. Hours Exist;
                                                              NOR=Kontaktservicetimer finnes;
                                                              SVE=Servicekalender];
                                                   Editable=No }
    { 5934;   ;Reallocation Needed ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Order Allocation" WHERE (Status=CONST(Reallocation Needed),
                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                       Document Type=FIELD(Document Type),
                                                                                                       Document No.=FIELD(No.),
                                                                                                       Resource Group No.=FIELD(Resource Group Filter)));
                                                   CaptionML=[ENU=Reallocation Needed;
                                                              NOR=Ny tildeling n›dvendig;
                                                              SVE=Omf”rdelning n”dv„ndig];
                                                   Editable=No }
    { 5936;   ;Notify Customer     ;Option        ;CaptionML=[ENU=Notify Customer;
                                                              NOR=Kundebeskjed;
                                                              SVE=Meddela kund];
                                                   OptionCaptionML=[ENU=No,By Phone 1,By Phone 2,By Fax,By Email;
                                                                    NOR=Ingen,Per telefon 1,Per telefon 2,Per faks,Per e-post;
                                                                    SVE=Nej,Med telefon 1,Med telefon 2,Med fax,Med e-post];
                                                   OptionString=No,By Phone 1,By Phone 2,By Fax,By Email }
    { 5937;   ;Max. Labor Unit Price;Decimal      ;OnValidate=BEGIN
                                                                IF ServLineExists THEN
                                                                  MESSAGE(
                                                                    Text001,
                                                                    FIELDCAPTION("Max. Labor Unit Price"),
                                                                    "No.");
                                                              END;

                                                   CaptionML=[ENU=Max. Labor Unit Price;
                                                              NOR=Maks. salgspris - arbeid;
                                                              SVE=Max. resurspris];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2;
                                                   AutoFormatExpr="Currency Code" }
    { 5938;   ;Warning Status      ;Option        ;CaptionML=[ENU=Warning Status;
                                                              NOR=Varselstatus;
                                                              SVE=Varningsstatus];
                                                   OptionCaptionML=[ENU=" ,First Warning,Second Warning,Third Warning";
                                                                    NOR=" ,F›rste varsel,Andre varsel,Tredje varsel";
                                                                    SVE=" ,F”rsta varning,Andra varning,Tredje varning"];
                                                   OptionString=[ ,First Warning,Second Warning,Third Warning] }
    { 5939;   ;No. of Allocations  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Order Allocation" WHERE (Document Type=FIELD(Document Type),
                                                                                                       Document No.=FIELD(No.),
                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                       Resource Group No.=FIELD(Resource Group Filter),
                                                                                                       Allocation Date=FIELD(Date Filter),
                                                                                                       Status=FILTER(Active|Finished)));
                                                   CaptionML=[ENU=No. of Allocations;
                                                              NOR=Ant. tildelinger;
                                                              SVE=Antal f”rdelningar];
                                                   Editable=No }
    { 5940;   ;Contract No.        ;Code20        ;TableRelation="Service Contract Header"."Contract No." WHERE (Contract Type=CONST(Contract),
                                                                                                                 Customer No.=FIELD(Customer No.),
                                                                                                                 Ship-to Code=FIELD(Ship-to Code),
                                                                                                                 Bill-to Customer No.=FIELD(Bill-to Customer No.));
                                                   OnValidate=VAR
                                                                ServContractHeader@1001 : Record 5965;
                                                              BEGIN
                                                                IF "Contract No." <> xRec."Contract No." THEN BEGIN
                                                                  IF "Contract No." <> '' THEN BEGIN
                                                                    TESTFIELD("Order Date");
                                                                    ServContractHeader.GET(ServContractHeader."Contract Type"::Contract,"Contract No.");
                                                                    IF ServContractHeader.Status <> ServContractHeader.Status::Signed THEN
                                                                      ERROR(Text041,"Contract No.");
                                                                    IF ServContractHeader."Starting Date" > "Order Date" THEN
                                                                      ERROR(Text042,"Contract No.");
                                                                    IF (ServContractHeader."Expiration Date" <> 0D) AND
                                                                       (ServContractHeader."Expiration Date" < "Order Date")
                                                                    THEN
                                                                      ERROR(Text043,"Contract No.");
                                                                  END;
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    ERROR(Text028,
                                                                      FIELDCAPTION("Contract No."),ServItemLine.TABLECAPTION);

                                                                  IF NOT ConfirmChangeContractNo THEN BEGIN
                                                                    "Contract No." := xRec."Contract No.";
                                                                    EXIT;
                                                                  END;

                                                                  IF "Contract No." <> '' THEN BEGIN
                                                                    TESTFIELD("Customer No.");
                                                                    TESTFIELD("Bill-to Customer No.");
                                                                    "Default Response Time (Hours)" := ServContractHeader."Response Time (Hours)";
                                                                    TESTFIELD("Ship-to Code",ServContractHeader."Ship-to Code");
                                                                    "Service Order Type" := ServContractHeader."Service Order Type";
                                                                    VALIDATE("Currency Code",ServContractHeader."Currency Code");
                                                                    "Max. Labor Unit Price" := ServContractHeader."Max. Labor Unit Price";
                                                                    "Your Reference" := ServContractHeader."Your Reference";
                                                                    "Service Zone Code" := ServContractHeader."Service Zone Code";
                                                                  END;
                                                                END;

                                                                IF "Contract No." <> '' THEN
                                                                  CreateDim(
                                                                    DATABASE::"Service Contract Header","Contract No.",
                                                                    DATABASE::"Service Order Type","Service Order Type",
                                                                    DATABASE::Customer,"Bill-to Customer No.",
                                                                    DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                    DATABASE::"Responsibility Center","Responsibility Center");
                                                              END;

                                                   OnLookup=VAR
                                                              ServContractHeader@1000 : Record 5965;
                                                              ServContractList@1001 : Page 6051;
                                                            BEGIN
                                                              IF "Contract No." <> '' THEN
                                                                IF ServContractHeader.GET(ServContractHeader."Contract Type"::Contract,"Contract No.") THEN
                                                                  ServContractList.SETRECORD(ServContractHeader);

                                                              ServContractHeader.RESET;
                                                              ServContractHeader.FILTERGROUP(2);
                                                              ServContractHeader.SETCURRENTKEY("Customer No.","Ship-to Code");
                                                              ServContractHeader.SETRANGE("Customer No.","Customer No.");
                                                              ServContractHeader.SETRANGE("Ship-to Code","Ship-to Code");
                                                              ServContractHeader.SETRANGE("Contract Type",ServContractHeader."Contract Type"::Contract);
                                                              ServContractHeader.SETRANGE("Bill-to Customer No.","Bill-to Customer No.");
                                                              ServContractHeader.SETRANGE(Status,ServContractHeader.Status::Signed);
                                                              ServContractHeader.SETFILTER("Starting Date",'<=%1',"Order Date");
                                                              ServContractHeader.SETFILTER("Expiration Date",'>=%1 | =%2',"Order Date",0D);
                                                              ServContractHeader.FILTERGROUP(0);
                                                              CLEAR(ServContractList);
                                                              ServContractList.SETTABLEVIEW(ServContractHeader);
                                                              ServContractList.LOOKUPMODE(TRUE);
                                                              IF ServContractList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ServContractList.GETRECORD(ServContractHeader);
                                                                VALIDATE("Contract No.",ServContractHeader."Contract No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Contract No.;
                                                              NOR=Kontraktnr.;
                                                              SVE=Kontraktsnr] }
    { 5951;   ;Type Filter         ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Type Filter;
                                                              NOR=Typefilter;
                                                              SVE=Filtertyp];
                                                   OptionCaptionML=[ENU=" ,Resource,Item,Service Cost,Service Contract";
                                                                    NOR=" ,Ressurs,Vare,Servicekost,Servicekontrakt";
                                                                    SVE=" ,Resurs,Artikel,Servicekostnad,Servicekontrakt"];
                                                   OptionString=[ ,Resource,Item,Service Cost,Service Contract] }
    { 5952;   ;Customer Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Customer.No.;
                                                   CaptionML=[ENU=Customer Filter;
                                                              NOR=Kundefilter;
                                                              SVE=Kundfilter] }
    { 5953;   ;Resource Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Resource;
                                                   CaptionML=[ENU=Resource Filter;
                                                              NOR=Ressursfilter;
                                                              SVE=Resursfilter] }
    { 5954;   ;Contract Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="Service Contract Header"."Contract No." WHERE (Contract Type=CONST(Contract));
                                                   CaptionML=[ENU=Contract Filter;
                                                              NOR=Kontraktfilter;
                                                              SVE=Kontraktsfilter] }
    { 5955;   ;Ship-to Fax No.     ;Text30        ;CaptionML=[ENU=Ship-to Fax No.;
                                                              NOR=Lever til-faksnr.;
                                                              SVE=Leveransfaxnr] }
    { 5956;   ;Ship-to E-Mail      ;Text80        ;OnValidate=VAR
                                                                MailManagement@1000 : Codeunit 9520;
                                                              BEGIN
                                                                MailManagement.ValidateEmailAddressField("Ship-to E-Mail");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Ship-to Email;
                                                              NOR=Lever til-e-post;
                                                              SVE=Leverans e-post] }
    { 5957;   ;Resource Group Filter;Code20       ;FieldClass=FlowFilter;
                                                   TableRelation="Resource Group";
                                                   CaptionML=[ENU=Resource Group Filter;
                                                              NOR=Ressursgruppefilter;
                                                              SVE=Resursgruppfilter] }
    { 5958;   ;Ship-to Phone       ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone;
                                                              NOR=Lever til-telefon;
                                                              SVE=Leveranstelefon] }
    { 5959;   ;Ship-to Phone 2     ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone 2;
                                                              NOR=Lever til-telefon 2;
                                                              SVE=Leveranstelefon 2] }
    { 5966;   ;Service Zone Filter ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Service Zone".Code;
                                                   CaptionML=[ENU=Service Zone Filter;
                                                              NOR=Servicesonefilter;
                                                              SVE=Servicezonfilter] }
    { 5968;   ;Service Zone Code   ;Code10        ;TableRelation="Service Zone".Code;
                                                   OnValidate=VAR
                                                                ShipToAddr@1000 : Record 222;
                                                              BEGIN
                                                                IF ShipToAddr.GET("Customer No.","Ship-to Code") THEN
                                                                  "Service Zone Code" := ShipToAddr."Service Zone Code"
                                                                ELSE
                                                                  IF Cust.GET("Customer No.") THEN
                                                                    "Service Zone Code" := Cust."Service Zone Code"
                                                                  ELSE
                                                                    "Service Zone Code" := '';
                                                              END;

                                                   CaptionML=[ENU=Service Zone Code;
                                                              NOR=Servicesonekode;
                                                              SVE=Servicezonskod];
                                                   Editable=No }
    { 5981;   ;Expected Finishing Date;Date       ;CaptionML=[ENU=Expected Finishing Date;
                                                              NOR=Forventet ferdigdato;
                                                              SVE=F”rv„ntat f„rdigdatum] }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Allow Line Disc."));
                                                              END;

                                                   CaptionML=[ENU=Allow Line Disc.;
                                                              NOR=Tillat linjerabatt;
                                                              SVE=Till†t radrabatt] }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter2(2,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(Text060,"Assigned User ID",UserSetupMgt.GetServiceFilter2("Assigned User ID"));
                                                              END;

                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=Assigned User ID;
                                                              NOR=Tilordnet bruker-ID;
                                                              SVE=Tilldelat anv„ndar-ID] }
    { 9001;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              NOR=Tilbudsnr.;
                                                              SVE=Offertnr] }
    { 10600;  ;GLN                 ;Code13        ;OnValidate=BEGIN
                                                                IF NOT EInvoiceDocumentEncode.IsValidEANNo(GLN,TRUE) THEN
                                                                  FIELDERROR(GLN,Text10606);
                                                              END;

                                                   CaptionML=[ENU=GLN No.;
                                                              NOR=GLN;
                                                              SVE=GLN-nr];
                                                   Description=NAVNO }
    { 10601;  ;Account Code NO     ;Text30        ;OnValidate=BEGIN
                                                                IF "Account Code NO" <> xRec."Account Code NO" THEN
                                                                  UpdateServLinesByFieldNo(FIELDNO("Account Code NO"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Account Code NO;
                                                              NOR=Kontokode];
                                                   Description=NAVNO }
    { 10605;  ;E-Invoice           ;Boolean       ;CaptionML=[ENU=E-Invoice;
                                                              NOR=E-faktura;
                                                              SVE=E-faktura];
                                                   Description=NAVNO }
    { 10606;  ;External Document No.;Code35       ;CaptionML=[ENU=External Document No.;
                                                              NOR=Eksterndokumentnr.;
                                                              SVE=Externt dokumentnr];
                                                   Description=NAVNO }
    { 10607;  ;Delivery Date       ;Date          ;CaptionML=[ENU=Delivery Date;
                                                              NOR=Leveringsdato;
                                                              SVE=Leveransdatum];
                                                   Description=NAVNO }
    { 13600;  ;EAN No.             ;Code13        ;OnValidate=BEGIN
                                                                IF "EAN No." = '' THEN
                                                                  EXIT;

                                                                IF NOT OIOUBLDocumentEncode.IsValidEANNo("EAN No.") THEN
                                                                  FIELDERROR("EAN No.", Text13606);
                                                              END;

                                                   CaptionML=[ENU=EAN No.;
                                                              SVE=EAN nr.];
                                                   Description=NAVDK (13600) }
    { 13601;  ;Account Code DK     ;Text30        ;OnValidate=BEGIN
                                                                ServLine.RESET;
                                                                ServLine.SETRANGE("Document Type","Document Type");
                                                                ServLine.SETRANGE("Document No.","No.");
                                                                ServLine.SETFILTER("Account Code DK", '%1|%2', xRec."Account Code DK", '');
                                                                ServLine.MODIFYALL("Account Code DK", "Account Code DK");
                                                              END;

                                                   CaptionML=[ENU=Account Code DK;
                                                              SVE=Kontokod (DK)];
                                                   Description=NAVDK (13601) }
    { 13604;  ;OIOUBL Profile Code ;Code10        ;TableRelation="OIOUBL Profile";
                                                   CaptionML=ENU=OIOUBL Profile Code;
                                                   Description=NAVDK (13604) }
    { 13608;  ;Contact Role        ;Option        ;CaptionML=[ENU=Contact Role;
                                                              SVE=Kontakt roll];
                                                   OptionCaptionML=[ENU=" ,,,Purchase Responsible,,,Accountant,,,Budget Responsible,,,Requisitioner";
                                                                    SVE=" ,,,Ink”psansvarig,,,Bokf”rare,,,Budgetansvarig,,,Anskaffning/rekvirera"];
                                                   OptionString=[ ,,,Purchase Responsible,,,Accountant,,,Budget Responsible,,,Requisitioner];
                                                   Description=NAVDK (13608) }
    { 13620;  ;Payment Channel     ;Option        ;OnValidate=BEGIN
                                                                IF "Payment Channel" = "Payment Channel"::"Payment Slip" THEN
                                                                  ERROR(Text13607, FIELDCAPTION("Payment Channel"),"Payment Channel");
                                                              END;

                                                   CaptionML=[ENU=Payment Channel;
                                                              SVE=Betalningskanal];
                                                   OptionCaptionML=[ENU=" ,Payment Slip,Account Transfer,National Clearing,Direct Debit";
                                                                    SVE=" ,Talong,Konto”verf”ring,Bank”verf”ring,Autogiro"];
                                                   OptionString=[ ,Payment Slip,Account Transfer,National Clearing,Direct Debit];
                                                   Description=NAVDK (13620) }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                        }
    {    ;Customer No.,Order Date                  }
    {    ;Contract No.,Status,Posting Date         }
    {    ;Status,Response Date,Response Time,Priority,Responsibility Center }
    {    ;Status,Priority,Response Date,Response Time }
    {    ;Document Type,Customer No.,Order Date   ;MaintainSQLIndex=No }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Document Type,No.,Customer No.,Posting Date,Status }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst '@@@="%1=User management service filter;";ENU=You cannot delete this document. Your identification is set up to process from Responsibility Center %1 only.;NOR=Du kan ikke slette dette dokumentet. Identifikasjonen din er angitt til bare † behandle fra ansvarssentret %1.;SVE=Det g†r inte att ta bort det h„r dokumentet. Ditt ID „r endast konfigurerat f”r bearbetning fr†n ansvarsenheten %1.';
      Text001@1001 : TextConst 'ENU=Changing %1 in service header %2 will not update the existing service lines.\You must update the existing service lines manually.;NOR=Hvis du endrer %1 i servicehodet %2, oppdateres ikke de eksisterende servicelinjene.\Du m† oppdatere de eksisterende servicelinjene manuelt.;SVE=Žndring av %1 i servicehuvudet %2  kommer inte att uppdatera befintliga servicerader.\Du m†ste uppdatera de befintliga serviceraderna manuellt.';
      Text003@1003 : TextConst '@@@="%1=Customer number field caption;%2=Document type;%3=Number field caption;%4=Number;%5=Contract number field caption;%6=Contract number; ";ENU=You cannot change the %1 because the %2 %3 %4 is associated with a %5 %6.;NOR=Du kan ikke endre %1 fordi %2 %3 %4 er knyttet til en %5 %6.;SVE=Du kan inte „ndra %1 d„rf”r att %2 %3 %4 „r kopplad till ett %5 %6.';
      Text004@1004 : TextConst 'ENU=When you change the %1 the existing Service item line and service line will be deleted.\Do you want to change the %1?;NOR=N†r du endrer %1, slettes den eksisterende servicevarelinjen og servicelinjen.\Vil du endre %1?;SVE=N„r du „ndrar %1 l„ggs den befintliga serviceartikelraden och serviceraden till.\Vill du „ndra %1?';
      Text005@1005 : TextConst 'ENU=Do you want to change the %1?;NOR=Vil du endre %1?;SVE=Vill du „ndra %1?';
      Text007@1007 : TextConst 'ENU=%1 cannot be greater than %2.;NOR=%1 kan ikke v‘re st›rre enn %2.;SVE=%1 kan inte vara st”rre „n %2.';
      Text008@1008 : TextConst '@@@="%1=Document type format;%2=Number field caption;%3=Number;";ENU="You cannot create Service %1 with %2=%3 because this number has already been used in the system.";NOR="Du kan ikke opprette service %1 med %2=%3 fordi dette nummeret allerede er brukt i systemet.";SVE="Det g†r inte att skapa en service%1 med %2=%3 eftersom detta nummer redan anv„nds i systemet."';
      Text010@1010 : TextConst '@@@="%1=Resposibility center table caption;%2=User management service filter;";ENU=Your identification is set up to process from %1 %2 only.;NOR=Identifikasjonen din er angitt til bare † behandle fra %1 %2.;SVE=Ditt ID „r upplagt f”r bearbetning fr†n endast %1 %2.';
      Text011@1011 : TextConst 'ENU=%1 cannot be greater than %2 in the %3 table.;NOR=%1 kan ikke v‘re st›rre enn %2 i tabellen %3.;SVE=%1 kan inte vara st”rre „n %2 i tabellen %3.';
      Text012@1012 : TextConst 'ENU=If you change %1, the existing service lines will be deleted and the program will create new service lines based on the new information on the header.\Do you want to change the %1?;NOR=Hvis du endrer %1, slettes servicelinjene som finnes, og det opprettes nye servicelinjer basert p† de nye opplysningene i hodet.\Vil du endre %1?;SVE=Om du „ndrar %1 tas de befintliga serviceraderna bort och programmet skapar nya servicerader baserade p† den nya informationen i huvudet.\Vill du „ndra %1?';
      Text013@1089 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted credit memos. An empty posted credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis dokumentet slettes, vil det oppst† et hull i nummerserien for bokf›rte kreditnotaer. Det opprettes en tom bokf›rt kreditnota %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Borttag av detta dokument kommer att orsaka en lucka i nr-serien f”r bokf”rda kreditnotor. En tom bokf”rd kreditnota %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      Text015@1015 : TextConst 'ENU=Do you want to update the exchange rate?;NOR=Vil du oppdatere valutakursen?;SVE=Vill du uppdatera valutakursen?';
      Text016@1016 : TextConst 'ENU=You have modified %1.\Do you want to update the service lines?;NOR=Du har endret %1.\Vil du oppdatere servicelinjene?;SVE=Du har „ndrat %1.\Vill du uppdatera serviceraderna?';
      Text018@1018 : TextConst '@@@="%1=Service order type field caption;%2=table caption;%3=Document type field caption;%4=Document type format;%5=Number field caption;%6=Number format;";ENU="You have not specified the %1 for %2 %3=%4, %5=%6.";NOR="Du har ikke angitt %1 for %2 %3=%4, %5=%6.";SVE="Du har inte angett %1 f”r %2 %3=%4, %5=%6."';
      Text019@1019 : TextConst 'ENU=You have changed %1 on the service header, but it has not been changed on the existing service lines.\The change may affect the exchange rate used in the price calculation of the service lines.;NOR=Du har endret %1 p† servicehodet, men dette er ikke endret p† de eksisterende servicelinjene.\Endringen kan p†virke valutakursen som brukes i prisberegningen av servicelinjene.;SVE=Du har „ndrat %1 i servicehuvudet men det har inte „ndrats p† de befintliga serviceraderna.\Žndringen kan p†verka den valutakurs som anv„nds f”r prisber„kningen p† serviceraderna.';
      Text021@1021 : TextConst 'ENU=You have changed %1 on the %2, but it has not been changed on the existing service lines.\You must update the existing service lines manually.;NOR=Du har endret %1 p† %2, men den er ikke endret p† de eksisterende servicelinjene.\Du m† oppdatere de eksisterende servicelinjene manuelt.;SVE=Du har „ndrat %1 p† %2 men det har inte „ndrats p† de befintliga serviceraderna.\Du m†ste uppdatera de befintliga serviceraderna manuellt.';
      ServSetup@1023 : Record 5911;
      Cust@1024 : Record 18;
      ServHeader@1025 : Record 5900;
      ServLine@1026 : Record 5902;
      ServItemLine@1027 : Record 5901;
      PostCode@1031 : Record 225;
      CurrExchRate@1033 : Record 330;
      GLSetup@1034 : Record 98;
      ServShptHeader@1085 : Record 5990;
      ServInvHeader@1084 : Record 5992;
      ServCrMemoHeader@1077 : Record 5994;
      ReservEntry@1076 : Record 337;
      TempReservEntry@1075 : TEMPORARY Record 337;
      Salesperson@1906 : Record 13;
      ServOrderMgt@1037 : Codeunit 5900;
      DimMgt@1038 : Codeunit 408;
      NoSeriesMgt@1039 : Codeunit 396;
      ServLogMgt@1040 : Codeunit 5906;
      UserSetupMgt@1043 : Codeunit 5700;
      NotifyCust@1044 : Codeunit 5915;
      ServPost@1101 : Codeunit 5980;
      OIOUBLDocumentEncode@1000000000 : Codeunit 11128570;
      EInvoiceDocumentEncode@1080000 : Codeunit 11128501;
      CurrencyDate@1046 : Date;
      TempLinkToServItem@1047 : Boolean;
      HideValidationDialog@1048 : Boolean;
      Text024@1002 : TextConst 'ENU=The %1 cannot be greater than the minimum %1 of the\ Service Item Lines.;NOR=%1 kan ikke v‘re st›rre enn minimumet %1 for\ servicevarelinjene.;SVE=%1 f†r inte vara st”rre „n l„gsta %1 p†\ serviceartikelraderna.';
      Text025@1050 : TextConst 'ENU=The %1 cannot be less than the maximum %1 of the related\ Service Item Lines.;NOR=%1 kan ikke v‘re mindre enn det maksimale %1 for de tilh›rende\ servicevarelinjene.;SVE=%1 f†r inte vara l„gre „n h”gsta %1 p† de relaterade\ serviceartikelraderna.';
      Text026@1051 : TextConst 'ENU=%1 cannot be earlier than the %2.;NOR=%1 kan ikke v‘re tidligere enn %2.;SVE=%1 f†r inte vara tidigare „n %2.';
      Text027@1052 : TextConst 'ENU=The %1 cannot be greater than the minimum %2 of the related\ Service Item Lines.;NOR=%1 kan ikke v‘re st›rre enn minimumet %2 for de tilh›rende\ servicevarelinjene.;SVE=%1 f†r inte vara st”rre „n l„gsta %2 f”r de relaterade\serviceartikelraderna.';
      ValidatingFromLines@1053 : Boolean;
      LinesExist@1054 : Boolean;
      Text028@1057 : TextConst 'ENU=You cannot change the %1 because %2 exists.;NOR=Du kan ikke endre %1 fordi %2 finnes.;SVE=Du kan inte „ndra %1 d„rf”r att %2 finns.';
      Text029@1056 : TextConst 'ENU=The %1 field on the %2 will be updated if you change %3 manually.\Do you want to continue?;NOR=Feltet %1 p† %2 oppdateres hvis du endrer %3 manuelt.\Vil du fortsette?;SVE=F„ltet %1 p† %2 kommer att uppdateras om du manuellt „ndrar %3.\Vill du forts„tta?';
      Text031@1059 : TextConst '@@@="%1=Status field caption;%2=Status format;%3=table caption;%4=Number;%5=ServItemLine repair status code field caption;%6=ServItemLine repair status code;%7=ServItemLine table caption;%8=ServItemLine line number;";ENU=You cannot change %1 to %2 in %3 %4.\\%5 %6 in %7 %8 line is preventing it.;NOR=Du kan ikke endre %1 til %2 i %3 %4.\\%5 %6 p† linje %7 %8 forhindrer dette.;SVE=Det g†r inte att „ndra %1 till %2 i %3 %4.\\%5 %6 p† rad %7 %8 f”rhindrar detta.';
      Text037@1060 : TextConst '@@@="%1=Contact number;%2=Contact name;%3=Customer number;";ENU=Contact %1 %2 is not related to customer %3.;NOR=Kontakten %1 %2 er ikke knyttet til kunden %3.;SVE=Kontakt %1 %2 tillh”r inte kund %3.';
      Text038@1013 : TextConst '@@@="%1=Contact number;%2=Contact name;%3=Customer number;";ENU=Contact %1 %2 is related to a different company than customer %3.;NOR=Kontakten %1 %2 er knyttet til et annet selskap enn kunden %3.;SVE=Kontakt %1 %2 tillh”r ett annat f”retag „n kund %3.';
      Text039@1061 : TextConst '@@@="%1=Contact number;%2=Contact name;";ENU=Contact %1 %2 is not related to a customer.;NOR=Kontakten %1 %2 er ikke knyttet til en kunde.;SVE=Kontakt %1 %2 tillh”r inte en kund.';
      ContactNo@1045 : Code[20];
      Text040@1063 : TextConst '@@@="%1=table caption;%2=ServItemLine document number;%3=ServItemLine line number;%4=ServItemLine loaner number field caption;%5=ServItemLine loaner number;";ENU=You cannot delete %1 %2 because the %4 %5 for Service Item Line %3 has not been received.;NOR=Du kan ikke slette %1 %2 fordi %4 %5 for servicevarelinje %3 ikke er mottatt.;SVE=Det g†r inte att ta bort %1 %2 eftersom %4 %5 f”r serviceartikelraden %3 inte har inlevererats.';
      SkipContact@1064 : Boolean;
      SkipBillToContact@1062 : Boolean;
      Text041@1068 : TextConst 'ENU=Contract %1 is not signed.;NOR=Kontakt %1 er ikke underskrevet.;SVE=Kontraktet %1 „r inte signerat.';
      Text042@1069 : TextConst 'ENU=The service period for contract %1 has not yet started.;NOR=Serviceperioden for kontrakten %1 har ikke startet enda.;SVE=Serviceperioden f”r kontraktet %1 har „nnu inte startats.';
      Text043@1070 : TextConst 'ENU=The service period for contract %1 has expired.;NOR=Serviceperioden for kontrakten %1 er utl›pt.;SVE=Serviceperioden f”r kontraktet %1 har g†tt ut.';
      Text044@1073 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.;SVE=Du kan inte byta namn p† %1.';
      Confirmed@1080 : Boolean;
      Text045@1083 : TextConst '@@@="%1=Posting date field caption;%2=Posting number series field caption;%3=Posting number series;%4=NoSeries date order field caption;%5=NoSeries date order;%6=Document type;%7=posting number field caption;%8=Posting number;";ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8.";NOR="Du kan ikke endre feltet %1 fordi %2 %3 har %4 = %5 og %6 er allerede tilordnet %7 %8.";SVE="Du kan inte „ndra f„ltet %1 d„rf”r att %2 %3 har %4 = %5 och %6 har redan tilldelats %7 %8."';
      Text046@1104 : TextConst 'ENU=You cannot delete invoice %1 because one or more service ledger entries exist for this invoice.;NOR=Du kan ikke slette faktura %1 fordi det finnes ‚n eller flere serviceposter for denne fakturaen.;SVE=Du kan inte ta bort faktura %1 d„rf”r att en eller flera servicetransaktioner finns f”r den h„r fakturan.';
      Text047@1100 : TextConst 'ENU=You cannot change %1 because reservation, item tracking, or order tracking exists on the sales order.;NOR=Du kan ikke endre %1 fordi reservasjon, varesporing eller ordresporing finnes i ordren.;SVE=Det g†r inte att „ndra %1 eftersom det finns en reservation, artikelsp†rning eller ordersp†rning p† f”rs„ljningsordern.';
      Text050@1094 : TextConst 'ENU=You cannot reset %1 because the document still has one or more lines.;NOR=Du kan ikke nullstille %1 fordi dokumentet fremdeles har ‚n eller flere linjer.;SVE=Du kan inte †terst„lla %1 d„rf”r att dokumentet har en eller flera rader.';
      Text051@1082 : TextConst '@@@="%1=Document type format;%2=Number;";ENU=The service %1 %2 already exists.;NOR=Tjenesten %1 %2 finnes allerede.;SVE=Tj„nsten %1 %2 finns redan.';
      Text053@1093 : TextConst 'ENU=Deleting this document will cause a gap in the number series for shipments. An empty shipment %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis dokumentet slettes, vil det oppst† et hull i nummerserien for f›lgesedler. Det opprettes en tom f›lgeseddel %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Borttag av dokument kommer att orsaka en lucka i nr-serien f”r utleveranser. En tom returutleverans %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      Text054@1091 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted invoices. An empty posted invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis dokumentet slettes, vil det oppst† et hull i nummerserien for bokf›rte fakturaer. Det opprettes en tom bokf›rt faktura %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Borttag av detta dokument kommer att orsaka en lucka i nr-serien f”r bokf”rda fakturor. En tom bokf”rd faktura %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      Text055@1079 : TextConst 'ENU=You have modified the %1 field. Note that the recalculation of VAT may cause penny differences, so you must check the amounts afterwards. Do you want to update the %2 field on the lines to reflect the new value of %1?;NOR=Du har endret feltet %1. Legg merke til at gjenberegningen av mva. kan gi noen kroners differanse, og du m† kontrollere bel›pene etterp†. Vil du oppdatere feltet %2 p† linjene slik at de gjenspeiler den nye verdien for %1?;SVE=Du har „ndrat f„ltet %1. Observera att omr„kningen av moms kan orsaka ”resskillnader, s† du m†ste efter†t kontrollera beloppen. Vill du uppdatera f„ltet %2 p†  raderna f”r att †terspegla det nya v„rdet av %1?';
      Text057@1103 : TextConst 'ENU=When you change the %1 the existing service line will be deleted.\Do you want to change the %1?;NOR=N†r du endrer %1, slettes den eksisterende servicelinjen.\Vil du endre %1?;SVE=N„r du „ndrar %1 tas den befintliga serviceraden bort.\Vill du „ndra %1?';
      Text058@1088 : TextConst '@@@="%1=Currency code field caption;%2=Document type;%3=Number;%4=Contract number;";ENU=You cannot change %1 because %2 %3 is linked to Contract %4.;NOR=Du kan ikke endre %1 fordi %2 %3 er koblet til kontrakt %4.;SVE=Det g†r inte att „ndra %1 eftersom det finns en l„nk fr†n %2 %3 till kontraktet %4.';
      Text060@1154 : TextConst '@@@="%1=Assigned user ID;%2=User management service filter assigned user id;";ENU=Responsibility Center is set up to process from %1 %2 only.;NOR=Ansvarssentret er konfigurert til bare † behandle fra %1 %2.;SVE=Ansvarsenheten „r endast konfigurerad f”r bearbetning fr†n %1 %2.';
      Text061@1099 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?;NOR=Du kan ha endret en dimensjon.\\Vil du oppdatere linjene?;SVE=Du kanske har „ndrat en dimension.\\Vill du uppdatera raderna?';
      Text062@1087 : TextConst 'ENU=An open inventory pick exists for the %1 and because %2 is %3.\\You must first post or delete the inventory pick or change %2 to Partial.;NOR=Det finnes et †pent lagerplukk for %1 og fordi %2 er %3.\\Du m† f›rst bokf›re eller slette lagerplukket eller endre %2 til Delvis.;SVE=Det finns en ”ppen lagerplockning f”r %1 och eftersom %2 „r %3.\\Du m†ste f”rst bokf”ra eller ta bort lagerplockningen eller „ndra %2 till Delvis.';
      Text063@1102 : TextConst 'ENU=An open warehouse shipment exists for the %1 and %2 is %3.\\You must add the item(s) as new line(s) to the existing warehouse shipment or change %2 to Partial.;NOR=Det finnes en †pen lagerlevering for %1 og %2 er %3.\\Du m† legge til ‚n eller flere varer som ny(e) linje(r) i den eksisterende lagerleveringen eller endre %2 til Delvis.;SVE=Det finns en ”ppen lagerutleverans f”r %1 och eftersom „r %2 „r %3.\\Du m†ste l„gga till artiklarna som nya rader i den befintliga lagerutleveransen eller „ndra %2 till Delvis.';
      Text064@1105 : TextConst 'ENU=You cannot change %1 to %2 because an open inventory pick on the %3.;NOR=Du kan ikke endre %1 til %2 p† grunn av et †pent lagerplukk p† %3.;SVE=Det g†r inte att „ndra %1 till %2 p† grund av en ”ppen lagerplockning p† %3.';
      Text065@1106 : TextConst 'ENU=You cannot change %1  to %2 because an open warehouse shipment exists for the %3.;NOR=Du kan ikke endre %1 til %2 fordi det finnes en †pen lagerlevering for %3.;SVE=Det g†r inte att „ndra %1 till %2 p† grund av att det finns en ”ppen dist.lagerutleverans f”r %3.';
      Text066@1017 : TextConst 'ENU=You cannot change the dimension because there are service entries connected to this line.;NOR=Du kan ikke endre dimensjonen fordi det finnes serviceposter tilknyttet denne linjen.;SVE=Det g†r inte att „ndra dimensionen eftersom det finns servicetransaktioner kopplade till den h„r raden.';
      PostedDocsToPrintCreatedMsg@1022 : TextConst 'ENU=One or more related posted documents have been generated during deletion to fill gaps in the posting number series. You can view or print the documents from the respective document archive.;NOR=Ett eller flere relaterte bokf›rte dokumenter har blitt generert under slettingen for † fylle hull i bokf›ringsnummerseriene. Du kan vise eller skrive ut dokumentene fra det respektive dokumentarkivet.;SVE=Ett eller flera relaterade bokf”rda dokument har genererats under borttagningen f”r att fylla i tomrummen i bokf”ringsnummerserien. Du kan visa eller skriva ut dokumenten fr†n respektive dokumentarkiv.';
      DocumentNotPostedClosePageQst@1020 : TextConst 'ENU=The document has been saved but is not yet posted.\\Are you sure you want to exit?;NOR=Dokumentet er lagret, men er ikke bokf›rt enn†.\\Er du sikker p† at du vil avslutte?;SVE=Dokumentet har inte bokf”rts.\Vill du avsluta?';
      MissingExchangeRatesQst@1006 : TextConst '@@@=%1 - currency code, %2 - posting date;ENU=There are no exchange rates for currency %1 and date %2. Do you want to add them now? Otherwise, the last change you made will be reverted.;NOR=Det finnes ingen valutakurser for valutaen %1 og datoen %2. Vil du legge dem til n†? Ellers tilbakestilles den siste endringen du gjorde.;SVE=Vill du uppdatera raderna?';
      Text10606@1080001 : TextConst 'ENU=The GLN No. field does not contain a valid, 13-digit GLN  number;NOR=GLN-nr.-feltet inneholder ikke et gyldig, 13-sifret GLN-nummer';
      Text13606@1101100001 : TextConst 'ENU=does not contain a valid, 13-digit EAN No.;SVE=inneh†ller inte ett giltigt 13-siffrors EAN nr';
      Text13607@1101100002 : TextConst 'ENU=%1 %2 is not supported in this version of OIOUBL.;SVE=%1 %2 st”ds inte i denna version av OIOXML.';

    [Internal]
    PROCEDURE AssistEdit@1(OldServHeader@1000 : Record 5900) : Boolean;
    VAR
      ServHeader2@1001 : Record 5900;
    BEGIN
      WITH ServHeader DO BEGIN
        COPY(Rec);
        ServSetup.GET;
        TestNoSeries;
        IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldServHeader."No. Series","No. Series") THEN BEGIN
          IF ("Customer No." = '') AND ("Contact No." = '') THEN
            CheckCreditMaxBeforeInsert(FALSE);

          NoSeriesMgt.SetSeries("No.");
          IF ServHeader2.GET("Document Type","No.") THEN
            ERROR(Text051,LOWERCASE(FORMAT("Document Type")),"No.");
          Rec := ServHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    [External]
    PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20];Type5@1012 : Integer;No5@1011 : Code[20]);
    VAR
      SourceCodeSetup@1008 : Record 242;
      ServiceContractHeader@1015 : Record 5965;
      No@1010 : ARRAY [10] OF Code[20];
      TableID@1009 : ARRAY [10] OF Integer;
      ContractDimensionSetID@1014 : Integer;
      OldDimSetID@1013 : Integer;
    BEGIN
      SourceCodeSetup.GET;

      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      TableID[5] := Type5;
      No[5] := No5;
      OnAfterCreateDimTableIDs(Rec,CurrFieldNo,TableID,No);

      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      OldDimSetID := "Dimension Set ID";

      IF "Contract No." <> '' THEN BEGIN
        ServiceContractHeader.GET(ServiceContractHeader."Contract Type"::Contract,"Contract No.");
        ContractDimensionSetID := ServiceContractHeader."Dimension Set ID";
      END;

      "Dimension Set ID" :=
        DimMgt.GetRecDefaultDimID(
          Rec,CurrFieldNo,TableID,No,SourceCodeSetup."Service Management",
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",ContractDimensionSetID,DATABASE::"Service Contract Header");

      OnCreateDimOnBeforeUpdateLines(Rec,xRec,CurrFieldNo);

      IF "Dimension Set ID" <> OldDimSetID THEN BEGIN
        MODIFY;
        DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
        IF ServItemLineExists OR ServLineExists THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    [External]
    PROCEDURE UpdateAllLineDim@41(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      ConfirmManagement@1003 : Codeunit 27;
      NewDimSetID@1002 : Integer;
      IsHandled@1004 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeUpdateAllLineDim(Rec,NewParentDimSetID,OldParentDimSetID,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT ConfirmManagement.ConfirmProcess(Text061,TRUE) THEN
        EXIT;

      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");
      ServLine.LOCKTABLE;
      IF ServLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(ServLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF ServLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            ServLine."Dimension Set ID" := NewDimSetID;
            DimMgt.UpdateGlobalDimFromDimSetID(
              ServLine."Dimension Set ID",ServLine."Shortcut Dimension 1 Code",ServLine."Shortcut Dimension 2 Code");
            ServLine.MODIFY;
          END;
        UNTIL ServLine.NEXT = 0;

      ServItemLine.RESET;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      ServItemLine.LOCKTABLE;
      IF ServItemLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(ServItemLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF ServItemLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            ServItemLine."Dimension Set ID" := NewDimSetID;
            DimMgt.UpdateGlobalDimFromDimSetID(
              ServItemLine."Dimension Set ID",ServItemLine."Shortcut Dimension 1 Code",ServItemLine."Shortcut Dimension 2 Code");
            ServItemLine.MODIFY;
          END;
        UNTIL ServItemLine.NEXT = 0;
    END;

    [External]
    PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1002 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");

      IF ServItemLineExists OR ServLineExists THEN
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);

      OnAfterValidateShortcutDimCode(Rec,xRec,FieldNumber,ShortcutDimCode);
    END;

    LOCAL PROCEDURE UpdateCurrencyFactor@12();
    VAR
      UpdateCurrencyExchangeRates@1000 : Codeunit 1281;
      ConfirmManagement@1001 : Codeunit 27;
    BEGIN
      IF "Currency Code" <> '' THEN BEGIN
        CurrencyDate := "Posting Date";
        IF UpdateCurrencyExchangeRates.ExchangeRatesForCurrencyExist(CurrencyDate,"Currency Code") THEN BEGIN
        //"Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code"); //**4PS.o
          "Currency Factor" := CurrExchRate.ExchangeRate(0,'',CurrencyDate,"Currency Code",TRUE); //**4PS.n
          IF "Currency Code" <> xRec."Currency Code" THEN
            RecreateServLines(FIELDCAPTION("Currency Code"));
        END ELSE BEGIN
          IF ConfirmManagement.ConfirmProcess(
               STRSUBSTNO(MissingExchangeRatesQst,"Currency Code",CurrencyDate),TRUE)
          THEN BEGIN
            UpdateCurrencyExchangeRates.OpenExchangeRatesPage("Currency Code");
            UpdateCurrencyFactor;
          END ELSE
            RevertCurrencyCodeAndPostingDate;
        END;
      END ELSE BEGIN
        "Currency Factor" := 0;
        IF "Currency Code" <> xRec."Currency Code" THEN
          RecreateServLines(FIELDCAPTION("Currency Code"));
      END;
    END;

    LOCAL PROCEDURE RecreateServLines@2(ChangedFieldName@1000 : Text[100]);
    VAR
      TempServLine@1002 : TEMPORARY Record 5902;
      ServDocReg@1005 : Record 5936;
      TempServDocReg@1004 : TEMPORARY Record 5936;
      ConfirmManagement@1001 : Codeunit 27;
      ExtendedTextAdded@1003 : Boolean;
    BEGIN
      IF ServLineExists THEN BEGIN
        IF HideValidationDialog THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text012,ChangedFieldName),TRUE);
        IF Confirmed THEN BEGIN
          ServLine.LOCKTABLE;
          ReservEntry.LOCKTABLE;
          MODIFY;

          ServLine.RESET;
          ServLine.SETRANGE("Document Type","Document Type");
          ServLine.SETRANGE("Document No.","No.");
          IF ServLine.FIND('-') THEN BEGIN
            REPEAT
              ServLine.TESTFIELD("Quantity Shipped",0);
              ServLine.TESTFIELD("Quantity Invoiced",0);
              ServLine.TESTFIELD("Shipment No.",'');
              TempServLine := ServLine;
              IF ServLine.Nonstock THEN BEGIN
                ServLine.Nonstock := FALSE;
                ServLine.MODIFY;
              END;
              TempServLine.INSERT;
              CopyReservEntryToTemp(ServLine);
            UNTIL ServLine.NEXT = 0;

            IF "Location Code" <> xRec."Location Code" THEN
              IF NOT TempReservEntry.ISEMPTY THEN
                ERROR(Text047,FIELDCAPTION("Location Code"));

            IF "Document Type" = "Document Type"::Invoice THEN BEGIN
              ServDocReg.SETCURRENTKEY("Destination Document Type","Destination Document No.");
              ServDocReg.SETRANGE("Destination Document Type",ServDocReg."Destination Document Type"::Invoice);
              ServDocReg.SETRANGE("Destination Document No.",TempServLine."Document No.");
              IF ServDocReg.FIND('-') THEN
                REPEAT
                  TempServDocReg := ServDocReg;
                  TempServDocReg.INSERT;
                UNTIL ServDocReg.NEXT = 0;
            END;
            ServLine.DELETEALL(TRUE);

            IF "Document Type" = "Document Type"::Invoice THEN BEGIN
              IF TempServDocReg.FIND('-') THEN
                REPEAT
                  ServDocReg := TempServDocReg;
                  ServDocReg.INSERT;
                UNTIL TempServDocReg.NEXT = 0;
            END;

            CreateServiceLines(TempServLine,ExtendedTextAdded);
            TempServLine.SETRANGE(Type);
            TempServLine.DELETEALL;
          END;
        END ELSE
          ERROR('');
      END;
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13();
    VAR
      ConfirmManagement@1000 : Codeunit 27;
    BEGIN
      IF ConfirmManagement.ConfirmProcess(Text015,TRUE) THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
    END;

    LOCAL PROCEDURE UpdateServLinesByFieldNo@15(ChangedFieldNo@1000 : Integer;AskQuestion@1001 : Boolean);
    VAR
      Field@1003 : Record 2000000041;
      ConfirmManagement@1004 : Codeunit 27;
      Question@1002 : Text[250];
    BEGIN
      Field.GET(DATABASE::"Service Header",ChangedFieldNo);

      IF ServLineExists AND AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
            Text016,
            Field."Field Caption");
        IF NOT ConfirmManagement.ConfirmProcess(Question,TRUE) THEN
          EXIT
      END;

      IF ServLineExists THEN BEGIN
        ServLine.LOCKTABLE;
        ServLine.RESET;
        ServLine.SETRANGE("Document Type","Document Type");
        ServLine.SETRANGE("Document No.","No.");

        ServLine.SETRANGE("Quantity Shipped",0);
        ServLine.SETRANGE("Quantity Invoiced",0);
        ServLine.SETRANGE("Quantity Consumed",0);
        ServLine.SETRANGE("Shipment No.",'');

        IF ServLine.FIND('-') THEN
          REPEAT
            CASE ChangedFieldNo OF
              FIELDNO("Currency Factor"):
                IF (ServLine."Posting Date" = "Posting Date") AND (ServLine.Type <> ServLine.Type::" ") THEN BEGIN
                  ServLine.VALIDATE("Unit Price");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Posting Date"):
                BEGIN
                  ServLine.VALIDATE("Posting Date","Posting Date");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Responsibility Center"):
                BEGIN
                  ServLine.VALIDATE("Responsibility Center","Responsibility Center");
                  ServLine.MODIFY(TRUE);
                  ServItemLine.RESET;
                  ServItemLine.SETRANGE("Document Type","Document Type");
                  ServItemLine.SETRANGE("Document No.","No.");
                  IF ServItemLine.FIND('-') THEN
                    REPEAT
                      ServItemLine.VALIDATE("Responsibility Center","Responsibility Center");
                      ServItemLine.MODIFY(TRUE);
                    UNTIL ServItemLine.NEXT = 0;
                END;
              FIELDNO("Order Date"):
                BEGIN
                  ServLine."Order Date" := "Order Date";
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Transaction Type"):
                BEGIN
                  ServLine.VALIDATE("Transaction Type","Transaction Type");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Transport Method"):
                BEGIN
                  ServLine.VALIDATE("Transport Method","Transport Method");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Exit Point"):
                BEGIN
                  ServLine.VALIDATE("Exit Point","Exit Point");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO(Area):
                BEGIN
                  ServLine.VALIDATE(Area,Area);
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Transaction Specification"):
                BEGIN
                  ServLine.VALIDATE("Transaction Specification","Transaction Specification");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Shipping Agent Code"):
                BEGIN
                  ServLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Shipping Time"):
                BEGIN
                  ServLine.VALIDATE("Shipping Time","Shipping Time");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDNO("Shipping Agent Service Code"):
                BEGIN
                  ServLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
                  ServLine.MODIFY(TRUE);
                END;
              //>>NAVNO
              FIELDNO("Account Code NO"):
                BEGIN
                  ServLine.VALIDATE("Account Code NO","Account Code NO");
                  ServLine.MODIFY(TRUE);
                END;
              //<<NAVNO
              ELSE
                OnUpdateServLineByChangedFieldName(Rec,ServLine,Field."Field Caption");
            END;
          UNTIL ServLine.NEXT = 0;
      END;
    END;

    [External]
    PROCEDURE TestMandatoryFields@9(VAR PassedServLine@1002 : Record 5902);
    BEGIN
      OnBeforeTestMandatoryFields(Rec,PassedServLine);

      ServSetup.GET;
      CheckMandSalesPersonOrderData(ServSetup);
      PassedServLine.RESET;
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");

      IF PassedServLine.FIND('-') THEN
        REPEAT
          IF (PassedServLine."Qty. to Ship" <> 0) OR
             (PassedServLine."Qty. to Invoice" <> 0) OR
             (PassedServLine."Qty. to Consume" <> 0)
          THEN BEGIN
            IF ("Document Type" = "Document Type"::Order) AND
               "Link Service to Service Item" AND
               (PassedServLine.Type IN [PassedServLine.Type::Item,PassedServLine.Type::Resource])
            THEN
              PassedServLine.TESTFIELD("Service Item Line No.");

            CASE PassedServLine.Type OF
              PassedServLine.Type::Item:
                BEGIN
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    PassedServLine.TESTFIELD("Unit of Measure Code");
                END;
              PassedServLine.Type::Resource:
                BEGIN
                  IF ServSetup."Work Type Code Mandatory" THEN
                    PassedServLine.TESTFIELD("Work Type Code");
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    PassedServLine.TESTFIELD("Unit of Measure Code");
                END;
              PassedServLine.Type::Cost:
                IF ServSetup."Unit of Measure Mandatory" THEN
                  PassedServLine.TESTFIELD("Unit of Measure Code");
            END;

            IF PassedServLine."Job No." <> '' THEN
              PassedServLine.TESTFIELD("Qty. to Consume",PassedServLine."Qty. to Ship");
          END;
        UNTIL PassedServLine.NEXT = 0
      ELSE
        IF ServLine.FIND('-') THEN
          REPEAT
            IF (ServLine."Qty. to Ship" <> 0) OR
               (ServLine."Qty. to Invoice" <> 0) OR
               (ServLine."Qty. to Consume" <> 0)
            THEN BEGIN
              IF ("Document Type" = "Document Type"::Order) AND
                 "Link Service to Service Item" AND
                 (ServLine.Type IN [ServLine.Type::Item,ServLine.Type::Resource])
              THEN
                ServLine.TESTFIELD("Service Item Line No.");

              CASE ServLine.Type OF
                ServLine.Type::Item:
                  BEGIN
                    IF ServSetup."Unit of Measure Mandatory" THEN
                      ServLine.TESTFIELD("Unit of Measure Code");
                  END;
                ServLine.Type::Resource:
                  BEGIN
                    IF ServSetup."Work Type Code Mandatory" THEN
                      ServLine.TESTFIELD("Work Type Code");
                    IF ServSetup."Unit of Measure Mandatory" THEN
                      ServLine.TESTFIELD("Unit of Measure Code");
                  END;
                ServLine.Type::Cost:
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    ServLine.TESTFIELD("Unit of Measure Code");
              END;

              IF ServLine."Job No." <> '' THEN
                ServLine.TESTFIELD("Qty. to Consume",ServLine."Qty. to Ship");
            END;
          UNTIL ServLine.NEXT = 0;
    END;

    [External]
    PROCEDURE UpdateResponseDateTime@3();
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Response Date");
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      IF ServItemLine.FIND('-') THEN BEGIN
        "Response Date" := ServItemLine."Response Date";
        "Response Time" := ServItemLine."Response Time";
        MODIFY(TRUE);
      END;
    END;

    LOCAL PROCEDURE UpdateStartingDateTime@5();
    BEGIN
      IF ValidatingFromLines THEN
        EXIT;
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
      IF ServItemLine.FIND('-') THEN BEGIN
        "Starting Date" := ServItemLine."Starting Date";
        "Starting Time" := ServItemLine."Starting Time";
        MODIFY(TRUE);
      END ELSE BEGIN
        "Starting Date" := 0D;
        "Starting Time" := 0T;
      END;
    END;

    LOCAL PROCEDURE UpdateFinishingDateTime@8();
    BEGIN
      IF ValidatingFromLines THEN
        EXIT;
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
      ServItemLine.ASCENDING := FALSE;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
      IF ServItemLine.FIND('-') THEN BEGIN
        "Finishing Date" := ServItemLine."Finishing Date";
        "Finishing Time" := ServItemLine."Finishing Time";
        MODIFY(TRUE);
      END ELSE BEGIN
        "Finishing Date" := 0D;
        "Finishing Time" := 0T;
      END;
    END;

    LOCAL PROCEDURE PriceMsgIfServLinesExist@10(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF ServLineExists THEN
        MESSAGE(
          Text019,
          ChangedFieldName);
    END;

    LOCAL PROCEDURE ServItemLineExists@4() : Boolean;
    VAR
      ServItemLine@1000 : Record 5901;
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      EXIT(NOT ServItemLine.ISEMPTY);
    END;

    [External]
    PROCEDURE ServLineExists@11() : Boolean;
    BEGIN
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");
      EXIT(NOT ServLine.ISEMPTY);
    END;

    LOCAL PROCEDURE MessageIfServLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF ServLineExists AND NOT HideValidationDialog THEN
        MESSAGE(
          Text021,
          ChangedFieldName,TABLECAPTION);
    END;

    LOCAL PROCEDURE ValidateServPriceGrOnServItem@6();
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      IF ServItemLine.FIND('-') THEN BEGIN
        ServItemLine.SetServHeader(Rec);
        REPEAT
          IF ServItemLine."Service Price Group Code" <> '' THEN BEGIN
            ServItemLine.VALIDATE("Service Price Group Code");
            ServItemLine.MODIFY;
          END;
        UNTIL ServItemLine.NEXT = 0
      END;
    END;

    [External]
    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    [External]
    PROCEDURE SetValidatingFromLines@17(NewValidatingFromLines@1000 : Boolean);
    BEGIN
      ValidatingFromLines := NewValidatingFromLines;
    END;

    LOCAL PROCEDURE TestNoSeries@21();
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeTestNoSeries(Rec,IsHandled);
      IF IsHandled THEN
        EXIT;

      CASE "Document Type" OF
        "Document Type"::Quote:
          ServSetup.TESTFIELD("Service Quote Nos.");
        "Document Type"::Order:
          ServSetup.TESTFIELD("Service Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@20() : Code[20];
    VAR
      NoSeriesCode@1001 : Code[20];
      IsHandled@1000 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeGetNoSeries(Rec,NoSeriesCode,IsHandled);
      IF IsHandled THEN
        EXIT(NoSeriesCode);

      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(ServSetup."Service Quote Nos.");
        "Document Type"::Order:
          EXIT(ServSetup."Service Order Nos.");
        "Document Type"::Invoice:
          EXIT(ServSetup."Service Invoice Nos.");
        "Document Type"::"Credit Memo":
          EXIT(ServSetup."Service Credit Memo Nos.");
      END;
    END;

    LOCAL PROCEDURE TestNoSeriesManual@33();
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeTestNoSeriesManual(Rec,IsHandled);
      IF IsHandled THEN
        EXIT;

      CASE "Document Type" OF
        "Document Type"::Quote:
          NoSeriesMgt.TestManual(ServSetup."Service Quote Nos.");
        "Document Type"::Order:
          NoSeriesMgt.TestManual(ServSetup."Service Order Nos.");
        "Document Type"::Invoice:
          NoSeriesMgt.TestManual(ServSetup."Service Invoice Nos.");
        "Document Type"::"Credit Memo":
          NoSeriesMgt.TestManual(ServSetup."Service Credit Memo Nos.");
      END;
    END;

    LOCAL PROCEDURE UpdateCont@24(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cont@1002 : Record 5050;
      Cust@1004 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        CLEAR(ServOrderMgt);
        ContactNo := ServOrderMgt.FindContactInformation(Cust."No.");
        IF Cont.GET(ContactNo) THEN BEGIN
          "Contact No." := Cont."No.";
          "Contact Name" := Cont.Name;
          "Phone No." := Cont."Phone No.";
          "Fax No." := Cont."Fax No.";  //NAVDK,NAVNO
          "E-Mail" := Cont."E-Mail";
        END ELSE BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Contact No." := Cust."Primary Contact No."
          ELSE
            IF ContBusRel.FindByRelation(ContBusRel."Link to Table"::Customer,"Customer No.") THEN
              "Contact No." := ContBusRel."Contact No."
            ELSE
              "Contact No." := '';
          "Contact Name" := Cust.Contact;
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateBillToCont@27(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cont@1002 : Record 5050;
      Cust@1001 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        CLEAR(ServOrderMgt);
        ContactNo := ServOrderMgt.FindContactInformation("Bill-to Customer No.");
        IF Cont.GET(ContactNo) THEN BEGIN
          "Bill-to Contact No." := Cont."No.";
          "Bill-to Contact" := Cont.Name;
        END ELSE BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Bill-to Contact No." := Cust."Primary Contact No."
          ELSE
            IF ContBusRel.FindByRelation(ContBusRel."Link to Table"::Customer,"Bill-to Customer No.") THEN
              "Bill-to Contact No." := ContBusRel."Contact No."
            ELSE
              "Bill-to Contact No." := '';
          "Bill-to Contact" := Cust.Contact;
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateCust@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Cust@1006 : Record 18;
      Cont@1005 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Contact No." := Cont."No.";
        "Phone No." := Cont."Phone No.";
        "E-Mail" := Cont."E-Mail";
      END ELSE BEGIN
        "Phone No." := '';
        "Fax No." := '';  //NAVDK,NAVNO
        "E-Mail" := '';
        "Contact Name" := '';
        EXIT;
      END;

      IF Cont.Type = Cont.Type::Person THEN
        "Contact Name" := Cont.Name
      ELSE
        IF Cust.GET("Customer No.") THEN
          "Contact Name" := Cust.Contact
        ELSE
          "Contact Name" := '';

      IF ContBusinessRelation.FindByContact(ContBusinessRelation."Link to Table"::Customer,Cont."Company No.") THEN BEGIN
        IF ("Customer No." <> '') AND
           ("Customer No." <> ContBusinessRelation."No.")
        THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Customer No.");

        IF "Customer No." = '' THEN BEGIN
          SkipContact := TRUE;
          VALIDATE("Customer No.",ContBusinessRelation."No.");
          SkipContact := FALSE;
        END;
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);

      IF ("Customer No." = "Bill-to Customer No.") OR
         ("Bill-to Customer No." = '')
      THEN
        VALIDATE("Bill-to Contact No.","Contact No.");

      OnAfterUpdateCust(Rec);
    END;

    LOCAL PROCEDURE UpdateBillToCust@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Cust@1004 : Record 18;
      Cont@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Bill-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Bill-to Contact" := Cont.Name
        ELSE
          IF Cust.GET("Bill-to Customer No.") THEN
            "Bill-to Contact" := Cust.Contact
          ELSE
            "Bill-to Contact" := '';
      END ELSE BEGIN
        "Bill-to Contact" := '';
        EXIT;
      END;

      IF ContBusinessRelation.FindByContact(ContBusinessRelation."Link to Table"::Customer,Cont."Company No.") THEN BEGIN
        IF "Bill-to Customer No." = '' THEN BEGIN
          SkipBillToContact := TRUE;
          VALIDATE("Bill-to Customer No.",ContBusinessRelation."No.");
          SkipBillToContact := FALSE;
        END ELSE
          IF "Bill-to Customer No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Bill-to Customer No.");
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);
    END;

    [Internal]
    PROCEDURE CheckCreditMaxBeforeInsert@28(HideCreditCheckDialogue@1004 : Boolean);
    VAR
      ServHeader@1001 : Record 5900;
      ContBusinessRelation@1002 : Record 5054;
      Cont@1003 : Record 5050;
      CustCheckCreditLimit@1000 : Codeunit 312;
    BEGIN
      IF HideCreditCheckDialogue THEN
        EXIT;
      IF GETFILTER("Customer No.") <> '' THEN BEGIN
        IF GETRANGEMIN("Customer No.") = GETRANGEMAX("Customer No.") THEN BEGIN
          ServHeader."Bill-to Customer No." := GETRANGEMIN("Customer No.");
          CustCheckCreditLimit.ServiceHeaderCheck(ServHeader);
        END
      END ELSE
        IF GETFILTER("Contact No.") <> '' THEN
          IF GETRANGEMIN("Contact No.") = GETRANGEMAX("Contact No.") THEN BEGIN
            Cont.GET(GETRANGEMIN("Contact No."));
            IF ContBusinessRelation.FindByContact(ContBusinessRelation."Link to Table"::Customer,Cont."Company No.") THEN BEGIN
              ServHeader."Bill-to Customer No." := ContBusinessRelation."No.";
              CustCheckCreditLimit.ServiceHeaderCheck(ServHeader);
            END;
          END;
    END;

    [External]
    PROCEDURE UpdateServiceOrderChangeLog@22(VAR OldServHeader@1000 : Record 5900);
    BEGIN
      IF Status <> OldServHeader.Status THEN
        ServLogMgt.ServHeaderStatusChange(Rec,OldServHeader);

      IF "Customer No." <> OldServHeader."Customer No." THEN
        ServLogMgt.ServHeaderCustomerChange(Rec,OldServHeader);

      IF "Ship-to Code" <> OldServHeader."Ship-to Code" THEN
        ServLogMgt.ServHeaderShiptoChange(Rec,OldServHeader);

      IF "Contract No." <> OldServHeader."Contract No." THEN
        ServLogMgt.ServHeaderContractNoChanged(Rec,OldServHeader);
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@39() PostingNos : Code[20];
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      ServSetup.GET;
      IsHandled := FALSE;
      OnBeforeGetPostingNoSeriesCode(Rec,ServSetup,PostingNos,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF "Document Type" IN ["Document Type"::"Credit Memo"] THEN
        PostingNos := ServSetup."Posted Serv. Credit Memo Nos."
      ELSE
        PostingNos := ServSetup."Posted Service Invoice Nos.";

      OnAfterGetPostingNoSeriesCode(Rec,PostingNos);
    END;

    [External]
    PROCEDURE InitRecord@32();
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote,"Document Type"::Order:
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Service Invoice Nos.");
            NoSeriesMgt.SetDefaultSeries("Shipping No. Series",ServSetup."Posted Service Shipment Nos.");
          END;
        "Document Type"::Invoice:
          BEGIN
            IF ("No. Series" <> '') AND
               (ServSetup."Service Invoice Nos." = ServSetup."Posted Service Invoice Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Service Invoice Nos.");
            IF ServSetup."Shipment on Invoice" THEN
              NoSeriesMgt.SetDefaultSeries("Shipping No. Series",ServSetup."Posted Service Shipment Nos.");
          END;
        "Document Type"::"Credit Memo":
          BEGIN
            IF ("No. Series" <> '') AND
               (ServSetup."Service Credit Memo Nos." = ServSetup."Posted Serv. Credit Memo Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Serv. Credit Memo Nos.");
          END;
      END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::Quote]
      THEN BEGIN
        "Order Date" := WORKDATE;
        "Order Time" := TIME;
      END;

      "Posting Date" := WORKDATE;
      "Document Date" := WORKDATE;
      "Default Response Time (Hours)" := ServSetup."Default Response Time (Hours)";
      "Link Service to Service Item" := ServSetup."Link Service to Service Item";

      IF Cust.GET("Customer No.") THEN
        VALIDATE("Location Code",UserSetupMgt.GetLocation(2,Cust."Location Code","Responsibility Center"));

      IF "Document Type" IN ["Document Type"::"Credit Memo"] THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;

      "Posting Description" := FORMAT("Document Type") + ' ' + "No.";

      Reserve := Reserve::Optional;

      IF Cust.GET("Customer No.") THEN
        IF Cust."Responsibility Center" <> '' THEN
          "Responsibility Center" := UserSetupMgt.GetRespCenter(2,Cust."Responsibility Center")
        ELSE
          "Responsibility Center" := UserSetupMgt.GetRespCenter(2,"Responsibility Center")
      ELSE
        "Responsibility Center" := UserSetupMgt.GetServiceFilter;
      "Delivery Date" := "Posting Date";  //NAVNO
      OnAfterInitRecord(Rec);
    END;

    LOCAL PROCEDURE InitRecordFromContact@43();
    BEGIN
      INIT;
      ServSetup.GET;
      InitRecord;
      "No. Series" := xRec."No. Series";
      IF xRec."Shipping No." <> '' THEN BEGIN
        "Shipping No. Series" := xRec."Shipping No. Series";
        "Shipping No." := xRec."Shipping No.";
      END;
      IF xRec."Posting No." <> '' THEN BEGIN
        "Posting No. Series" := xRec."Posting No. Series";
        "Posting No." := xRec."Posting No.";
      END;
    END;

    LOCAL PROCEDURE GetCust@30(CustNo@1000 : Code[20]);
    BEGIN
      IF NOT (("Document Type" = "Document Type"::Quote) AND (CustNo = '')) THEN BEGIN
        IF CustNo <> Cust."No." THEN
          Cust.GET(CustNo);
      END ELSE
        CLEAR(Cust);
    END;

    LOCAL PROCEDURE ShippedServLinesExist@31() : Boolean;
    BEGIN
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");
      ServLine.SETFILTER("Quantity Shipped",'<>0');
      EXIT(ServLine.FIND('-'));
    END;

    LOCAL PROCEDURE UpdateShipToAddress@29();
    VAR
      Location@1000 : Record 14;
      CompanyInfo@1001 : Record 79;
    BEGIN
      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
        IF "Location Code" <> '' THEN BEGIN
          Location.GET("Location Code");
          SetShipToAddress(
            Location.Name,Location."Name 2",Location.Address,Location."Address 2",
            Location.City,Location."Post Code",Location.County,Location."Country/Region Code");
          "Ship-to Contact" := Location.Contact;
        END ELSE BEGIN
          CompanyInfo.GET;
          "Ship-to Code" := '';
          SetShipToAddress(
            CompanyInfo."Ship-to Name",CompanyInfo."Ship-to Name 2",CompanyInfo."Ship-to Address",CompanyInfo."Ship-to Address 2",
            CompanyInfo."Ship-to City",CompanyInfo."Ship-to Post Code",CompanyInfo."Ship-to County",
            CompanyInfo."Ship-to Country/Region Code");
          "Ship-to Contact" := CompanyInfo."Ship-to Contact";
        END;
        "VAT Country/Region Code" := "Country/Region Code";
      END;

      OnAfterUpdateShipToAddress(Rec);
    END;

    [External]
    PROCEDURE SetShipToAddress@117(ShipToName@1000 : Text[100];ShipToName2@1001 : Text[50];ShipToAddress@1002 : Text[100];ShipToAddress2@1003 : Text[50];ShipToCity@1004 : Text[30];ShipToPostCode@1005 : Code[20];ShipToCounty@1006 : Text[30];ShipToCountryRegionCode@1007 : Code[10]);
    BEGIN
      "Ship-to Name" := ShipToName;
      "Ship-to Name 2" := ShipToName2;
      "Ship-to Address" := ShipToAddress;
      "Ship-to Address 2" := ShipToAddress2;
      VALIDATE("Ship-to Country/Region Code",ShipToCountryRegionCode);
      "Ship-to City" := ShipToCity;
      "Ship-to Post Code" := ShipToPostCode;
      "Ship-to County" := ShipToCounty;
    END;

    [External]
    PROCEDURE ConfirmDeletion@36() : Boolean;
    VAR
      ConfirmManagement@1000 : Codeunit 27;
    BEGIN
      ServPost.TestDeleteHeader(Rec,ServShptHeader,ServInvHeader,ServCrMemoHeader);
      IF ServShptHeader."No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(
             STRSUBSTNO(Text053,ServShptHeader."No."),TRUE)
        THEN
          EXIT;
      IF ServInvHeader."No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(
             STRSUBSTNO(Text054,ServInvHeader."No."),TRUE)
        THEN
          EXIT;
      IF ServCrMemoHeader."No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(
             STRSUBSTNO(Text013,ServCrMemoHeader."No."),TRUE)
        THEN
          EXIT;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CopyReservEntryToTemp@44(OldServLine@1001 : Record 5902);
    BEGIN
      ReservEntry.RESET;
      ReservEntry.SetSourceFilter(
        DATABASE::"Service Line",OldServLine."Document Type",OldServLine."Document No.",OldServLine."Line No.",FALSE);
      IF ReservEntry.FINDSET THEN
        REPEAT
          TempReservEntry := ReservEntry;
          TempReservEntry.INSERT;
        UNTIL ReservEntry.NEXT = 0;
      ReservEntry.DELETEALL;
    END;

    LOCAL PROCEDURE CopyReservEntryFromTemp@56(OldServLine@1001 : Record 5902;NewSourceRefNo@1000 : Integer);
    BEGIN
      TempReservEntry.RESET;
      TempReservEntry.SetSourceFilter(
        DATABASE::"Service Line",OldServLine."Document Type",OldServLine."Document No.",OldServLine."Line No.",FALSE);
      IF TempReservEntry.FINDSET THEN
        REPEAT
          ReservEntry := TempReservEntry;
          ReservEntry."Source Ref. No." := NewSourceRefNo;
          IF NOT ReservEntry.INSERT THEN;
        UNTIL TempReservEntry.NEXT = 0;
      TempReservEntry.DELETEALL;
    END;

    [External]
    PROCEDURE ShowDocDim@23();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF ServItemLineExists OR ServLineExists THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    [External]
    PROCEDURE LookupAdjmtValueEntries@37(QtyType@1000 : 'General,Invoicing');
    VAR
      ItemLedgEntry@1004 : Record 32;
      ServiceLine@1001 : Record 5902;
      ServiceShptLine@1005 : Record 5991;
      TempValueEntry@1003 : TEMPORARY Record 5802;
    BEGIN
      ServiceLine.SETRANGE("Document Type","Document Type");
      ServiceLine.SETRANGE("Document No.","No.");
      TempValueEntry.RESET;
      TempValueEntry.DELETEALL;

      CASE "Document Type" OF
        "Document Type"::Order,"Document Type"::Invoice:
          BEGIN
            IF ServiceLine.FINDSET THEN
              REPEAT
                IF (ServiceLine.Type = ServiceLine.Type::Item) AND (ServiceLine.Quantity <> 0) THEN
                  IF ServiceLine."Shipment No." <> '' THEN BEGIN
                    ServiceShptLine.SETRANGE("Document No.",ServiceLine."Shipment No.");
                    ServiceShptLine.SETRANGE("Line No.",ServiceLine."Shipment Line No.");
                  END ELSE BEGIN
                    ServiceShptLine.SETCURRENTKEY("Order No.","Order Line No.");
                    ServiceShptLine.SETRANGE("Order No.",ServiceLine."Document No.");
                    ServiceShptLine.SETRANGE("Order Line No.",ServiceLine."Line No.");
                  END;
                ServiceShptLine.SETRANGE(Correction,FALSE);
                IF QtyType = QtyType::Invoicing THEN
                  ServiceShptLine.SETFILTER("Qty. Shipped Not Invoiced",'<>0');

                IF ServiceShptLine.FINDSET THEN
                  REPEAT
                    ServiceShptLine.FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                    IF ItemLedgEntry.FINDSET THEN
                      REPEAT
                        CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                      UNTIL ItemLedgEntry.NEXT = 0;
                  UNTIL ServiceShptLine.NEXT = 0;
              UNTIL ServiceLine.NEXT = 0;
          END;
      END;
      PAGE.RUNMODAL(0,TempValueEntry);
    END;

    LOCAL PROCEDURE CreateTempAdjmtValueEntries@38(VAR TempValueEntry@1001 : TEMPORARY Record 5802;ItemLedgEntryNo@1000 : Integer);
    VAR
      ValueEntry@1002 : Record 5802;
    BEGIN
      ValueEntry.SETCURRENTKEY("Item Ledger Entry No.");
      ValueEntry.SETRANGE("Item Ledger Entry No.",ItemLedgEntryNo);
      IF ValueEntry.FINDSET THEN
        REPEAT
          IF ValueEntry.Adjustment THEN BEGIN
            TempValueEntry := ValueEntry;
            IF TempValueEntry.INSERT THEN;
          END;
        UNTIL ValueEntry.NEXT = 0;
    END;

    [External]
    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      ServiceInvDisc@1000 : Codeunit 5950;
    BEGIN
      ServiceInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    [External]
    PROCEDURE SetSecurityFilterOnRespCenter@42();
    BEGIN
      IF UserSetupMgt.GetServiceFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetServiceFilter);
        FILTERGROUP(0);
      END;

      SETRANGE("Date Filter",0D,WORKDATE - 1);
    END;

    LOCAL PROCEDURE CheckMandSalesPersonOrderData@40(ServiceMgtSetup@1000 : Record 5911);
    BEGIN
      IF ServiceMgtSetup."Salesperson Mandatory" THEN
        TESTFIELD("Salesperson Code");

      IF "Document Type" = "Document Type"::Order THEN BEGIN
        IF ServiceMgtSetup."Service Order Type Mandatory" AND ("Service Order Type" = '') THEN
          ERROR(Text018,
            FIELDCAPTION("Service Order Type"),TABLECAPTION,
            FIELDCAPTION("Document Type"),FORMAT("Document Type"),
            FIELDCAPTION("No."),FORMAT("No."));
        IF ServiceMgtSetup."Service Order Start Mandatory" THEN BEGIN
          TESTFIELD("Starting Date");
          TESTFIELD("Starting Time");
        END;
        IF ServiceMgtSetup."Service Order Finish Mandatory" THEN BEGIN
          TESTFIELD("Finishing Date");
          TESTFIELD("Finishing Time");
        END;
        IF ServiceMgtSetup."Fault Reason Code Mandatory" AND NOT ValidatingFromLines THEN BEGIN
          ServItemLine.RESET;
          ServItemLine.SETRANGE("Document Type","Document Type");
          ServItemLine.SETRANGE("Document No.","No.");
          IF ServItemLine.FIND('-') THEN
            REPEAT
              ServItemLine.TESTFIELD("Fault Reason Code");
            UNTIL ServItemLine.NEXT = 0;
        END;
      END;
    END;

    [External]
    PROCEDURE InventoryPickConflict@47(DocType@1004 : 'Quote,Order,Invoice,Credit Memo';DocNo@1003 : Code[20];ShippingAdvice@1002 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseActivityLine@1000 : Record 5767;
      ServiceLine@1001 : Record 5902;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseActivityLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.");
      WarehouseActivityLine.SETRANGE("Source Type",DATABASE::"Service Line");
      WarehouseActivityLine.SETRANGE("Source Subtype",DocType);
      WarehouseActivityLine.SETRANGE("Source No.",DocNo);
      IF WarehouseActivityLine.ISEMPTY THEN
        EXIT(FALSE);
      ServiceLine.SETRANGE("Document Type",DocType);
      ServiceLine.SETRANGE("Document No.",DocNo);
      ServiceLine.SETRANGE(Type,ServiceLine.Type::Item);
      IF ServiceLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    [External]
    PROCEDURE InvPickConflictResolutionTxt@48() : Text[500];
    BEGIN
      EXIT(STRSUBSTNO(Text062,TABLECAPTION,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice")));
    END;

    [External]
    PROCEDURE WhseShpmntConflict@52(DocType@1002 : 'Quote,Order,Invoice,Credit Memo';DocNo@1001 : Code[20];ShippingAdvice@1000 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseShipmentLine@1003 : Record 7321;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseShipmentLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.","Source Line No.");
      WarehouseShipmentLine.SETRANGE("Source Type",DATABASE::"Service Line");
      WarehouseShipmentLine.SETRANGE("Source Subtype",DocType);
      WarehouseShipmentLine.SETRANGE("Source No.",DocNo);
      IF WarehouseShipmentLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    [External]
    PROCEDURE WhseShpmtConflictResolutionTxt@54() : Text[500];
    BEGIN
      EXIT(STRSUBSTNO(Text063,TABLECAPTION,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice")));
    END;

    LOCAL PROCEDURE GetShippingTime@49(CalledByFieldNo@1000 : Integer);
    VAR
      ShippingAgentServices@1001 : Record 5790;
    BEGIN
      IF (CalledByFieldNo <> CurrFieldNo) AND (CurrFieldNo <> 0) THEN
        EXIT;

      IF ShippingAgentServices.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
        "Shipping Time" := ShippingAgentServices."Shipping Time"
      ELSE BEGIN
        GetCust("Customer No.");
        "Shipping Time" := Cust."Shipping Time"
      END;
      IF NOT (CalledByFieldNo IN [FIELDNO("Shipping Agent Code"),FIELDNO("Shipping Agent Service Code")]) THEN
        VALIDATE("Shipping Time");
    END;

    LOCAL PROCEDURE CheckHeaderDimension@46();
    BEGIN
      IF ("Contract No." <> '') AND ("Document Type" = "Document Type"::Invoice) THEN
        ERROR(Text066);
    END;

    LOCAL PROCEDURE CreateServiceLines@50(VAR TempServLine@1004 : TEMPORARY Record 5902;VAR ExtendedTextAdded@1000 : Boolean);
    VAR
      TransferExtendedText@1001 : Codeunit 378;
    BEGIN
      ServLine.INIT;
      ServLine."Line No." := 0;
      TempServLine.FIND('-');
      ExtendedTextAdded := FALSE;

      REPEAT
        IF TempServLine."Attached to Line No." = 0 THEN BEGIN
          ServLine.INIT;
          ServLine.SetHideReplacementDialog(TRUE);
          ServLine.SetHideCostWarning(TRUE);
          ServLine."Line No." := ServLine."Line No." + 10000;
          ServLine.VALIDATE(Type,TempServLine.Type);
          IF TempServLine."No." <> '' THEN BEGIN
            ServLine.VALIDATE("No.",TempServLine."No.");
            IF ServLine.Type <> ServLine.Type::" " THEN BEGIN
              ServLine.VALIDATE("Unit of Measure Code",TempServLine."Unit of Measure Code");
              ServLine.VALIDATE("Variant Code",TempServLine."Variant Code");
              IF TempServLine.Quantity <> 0 THEN
                ServLine.VALIDATE(Quantity,TempServLine.Quantity);
            END;
          END;

          ServLine."Serv. Price Adjmt. Gr. Code" := TempServLine."Serv. Price Adjmt. Gr. Code";
          ServLine."Document No." := TempServLine."Document No.";
          ServLine."Service Item No." := TempServLine."Service Item No.";
          ServLine."Appl.-to Service Entry" := TempServLine."Appl.-to Service Entry";
          ServLine."Service Item Line No." := TempServLine."Service Item Line No.";
          ServLine.VALIDATE(Description,TempServLine.Description);
          ServLine.VALIDATE("Description 2",TempServLine."Description 2");

          IF TempServLine."No." <> '' THEN BEGIN
            TempLinkToServItem := "Link Service to Service Item";
            IF "Link Service to Service Item" THEN BEGIN
              "Link Service to Service Item" := FALSE;
              MODIFY(TRUE);
            END;
            ServLine."Spare Part Action" := TempServLine."Spare Part Action";
            ServLine."Component Line No." := TempServLine."Component Line No.";
            ServLine."Replaced Item No." := TempServLine."Replaced Item No.";
            ServLine.VALIDATE("Work Type Code",TempServLine."Work Type Code");

            ServLine."Location Code" := TempServLine."Location Code";
            IF ServLine.Type <> ServLine.Type::" " THEN BEGIN
              IF ServLine.Type = ServLine.Type::Item THEN BEGIN
                ServLine.VALIDATE("Variant Code",TempServLine."Variant Code");
                IF ServLine."Location Code" <> '' THEN
                  ServLine."Bin Code" := TempServLine."Bin Code";
              END;
              ServLine."Fault Reason Code" := TempServLine."Fault Reason Code";
              ServLine."Exclude Warranty" := TempServLine."Exclude Warranty";
              ServLine."Exclude Contract Discount" := TempServLine."Exclude Contract Discount";
              ServLine.VALIDATE("Contract No.",TempServLine."Contract No.");
              ServLine.VALIDATE(Warranty,TempServLine.Warranty);
            END;
            ServLine."Fault Area Code" := TempServLine."Fault Area Code";
            ServLine."Symptom Code" := TempServLine."Symptom Code";
            ServLine."Resolution Code" := TempServLine."Resolution Code";
            ServLine."Fault Code" := TempServLine."Fault Code";
            ServLine.VALIDATE("Dimension Set ID",TempServLine."Dimension Set ID");
          END;
          "Link Service to Service Item" := TempLinkToServItem;

          OnBeforeInsertServLineOnServLineRecreation(ServLine,TempServLine);
          ServLine.INSERT;
          ExtendedTextAdded := FALSE;
        END ELSE
          IF NOT ExtendedTextAdded THEN BEGIN
            TransferExtendedText.ServCheckIfAnyExtText(ServLine,TRUE);
            TransferExtendedText.InsertServExtText(ServLine);
            OnAfterTransferExtendedTextForServLineRecreation(ServLine);
            ServLine.FIND('+');
            ExtendedTextAdded := TRUE;
          END;
        CopyReservEntryFromTemp(TempServLine,ServLine."Line No.");
      UNTIL TempServLine.NEXT = 0;
    END;

    [External]
    PROCEDURE SetCustomerFromFilter@186();
    VAR
      CustomerNo@1000 : Code[20];
    BEGIN
      CustomerNo := GetFilterCustNo;
      IF CustomerNo = '' THEN BEGIN
        FILTERGROUP(2);
        CustomerNo := GetFilterCustNo;
        FILTERGROUP(0);
      END;
      IF CustomerNo <> '' THEN
        VALIDATE("Customer No.",CustomerNo);
    END;

    LOCAL PROCEDURE GetFilterCustNo@64() : Code[20];
    BEGIN
      IF GETFILTER("Customer No.") <> '' THEN
        IF GETRANGEMIN("Customer No.") = GETRANGEMAX("Customer No.") THEN
          EXIT(GETRANGEMAX("Customer No."));
    END;

    LOCAL PROCEDURE UpdateShipToAddressFromGeneralAddress@53(FieldNumber@1000 : Integer);
    BEGIN
      IF ("Ship-to Code" = '') AND (NOT ShipToAddressModified) THEN
        CASE FieldNumber OF
          FIELDNO("Ship-to Address"):
            IF xRec.Address = "Ship-to Address" THEN
              "Ship-to Address" := Address;
          FIELDNO("Ship-to Address 2"):
            IF xRec."Address 2" = "Ship-to Address 2" THEN
              "Ship-to Address 2" := "Address 2";
          FIELDNO("Ship-to City"), FIELDNO("Ship-to Post Code"):
            BEGIN
              IF xRec.City = "Ship-to City" THEN
                "Ship-to City" := City;
              IF xRec."Post Code" = "Ship-to Post Code" THEN
                "Ship-to Post Code" := "Post Code";
              IF xRec.County = "Ship-to County" THEN
                "Ship-to County" := County;
              IF xRec."Country/Region Code" = "Ship-to Country/Region Code" THEN
                "Ship-to Country/Region Code" := "Country/Region Code";
            END;
          FIELDNO("Ship-to County"):
            IF xRec.County = "Ship-to County" THEN
              "Ship-to County" := County;
          FIELDNO("Ship-to Country/Region Code"):
            IF  xRec."Country/Region Code" = "Ship-to Country/Region Code" THEN
              "Ship-to Country/Region Code" := "Country/Region Code";
        END;
    END;

    [External]
    PROCEDURE CopyCustomerFilter@51();
    VAR
      CustomerFilter@1000 : Text;
    BEGIN
      CustomerFilter := GETFILTER("Customer No.");
      IF CustomerFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Customer No.",CustomerFilter);
        FILTERGROUP(0)
      END;
    END;

    LOCAL PROCEDURE CopyCustomerFields@68(Cust@1000 : Record 18);
    BEGIN
      Name := Cust.Name;
      "Name 2" := Cust."Name 2";
      Address := Cust.Address;
      "Address 2" := Cust."Address 2";
      City := Cust.City;
      "Post Code" := Cust."Post Code";
      County := Cust.County;
      "Country/Region Code" := Cust."Country/Region Code";
          "Account Code DK" := Cust."Account Code DK";  //NAVDK
          "Account Code NO" := Cust."Account Code NO";  //NAVNO
      IF NOT SkipContact THEN BEGIN
        "Contact Name" := Cust.Contact;
        "Phone No." := Cust."Phone No.";
        "E-Mail" := Cust."E-Mail";
      END;
      "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
      "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
      "Tax Area Code" := Cust."Tax Area Code";
      "Tax Liable" := Cust."Tax Liable";
      "VAT Registration No." := Cust."VAT Registration No.";
      "Shipping Advice" := Cust."Shipping Advice";
      "Responsibility Center" := UserSetupMgt.GetRespCenter(2,Cust."Responsibility Center");
      VALIDATE("Location Code",UserSetupMgt.GetLocation(2,Cust."Location Code","Responsibility Center"));

      OnAfterCopyCustomerFields(Rec,Cust);
    END;

    LOCAL PROCEDURE CopyBillToCustomerFields@67(Cust@1000 : Record 18);
    VAR
      PaymentTerms@1001 : Record 3;
    BEGIN
      "Bill-to Name" := Cust.Name;
      "Bill-to Name 2" := Cust."Name 2";
      "Bill-to Address" := Cust.Address;
      "Bill-to Address 2" := Cust."Address 2";
      "Bill-to City" := Cust.City;
      "Bill-to Post Code" := Cust."Post Code";
      "Bill-to County" := Cust.County;
      "Bill-to Country/Region Code" := Cust."Country/Region Code";
      IF NOT SkipBillToContact THEN
        "Bill-to Contact" := Cust.Contact;
      "Payment Terms Code" := Cust."Payment Terms Code";
      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
        "Payment Method Code" := '';
        IF PaymentTerms.GET("Payment Terms Code") THEN
          IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
            "Payment Method Code" := Cust."Payment Method Code"
      END ELSE
        "Payment Method Code" := Cust."Payment Method Code";
      GLSetup.GET;
      IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN BEGIN
        "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
        "VAT Registration No." := Cust."VAT Registration No.";
        "VAT Country/Region Code" := Cust."Country/Region Code";
        "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
      END;
      "Customer Posting Group" := Cust."Customer Posting Group";
      "Currency Code" := Cust."Currency Code";
      "Customer Price Group" := Cust."Customer Price Group";
      "Prices Including VAT" := Cust."Prices Including VAT";
      "Allow Line Disc." := Cust."Allow Line Disc.";
      "Invoice Disc. Code" := Cust."Invoice Disc. Code";
      "Customer Disc. Group" := Cust."Customer Disc. Group";
      "Language Code" := Cust."Language Code";
      SetSalespersonCode(Cust."Salesperson Code","Salesperson Code");
      Reserve := Cust.Reserve;
        //>>NAVNO
        GLN := Cust.GLN;
        "E-Invoice" := Cust."E-Invoice";
        //<<NAVNO

      OnAfterCopyBillToCustomerFields(Rec,Cust);
    END;

    LOCAL PROCEDURE ShipToAddressModified@55() : Boolean;
    BEGIN
      IF (xRec.Address <> "Ship-to Address") OR
         (xRec."Address 2" <> "Ship-to Address 2") OR
         (xRec.City <> "Ship-to City") OR
         (xRec.County <> "Ship-to County") OR
         (xRec."Post Code" <> "Ship-to Post Code") OR
         (xRec."Country/Region Code" <> "Ship-to Country/Region Code")
      THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    [External]
    PROCEDURE ConfirmCloseUnposted@98() : Boolean;
    VAR
      InstructionMgt@1000 : Codeunit 1330;
    BEGIN
      IF ServLineExists OR ServItemLineExists THEN
        IF InstructionMgt.IsUnpostedEnabledForRecord(Rec) THEN
          EXIT(InstructionMgt.ShowConfirm(DocumentNotPostedClosePageQst,InstructionMgt.QueryPostOnCloseCode));
      EXIT(TRUE)
    END;

    LOCAL PROCEDURE ConfirmChangeContractNo@59() : Boolean;
    VAR
      ServContractLine@1001 : Record 5964;
      ConfirmManagement@1003 : Codeunit 27;
      Confirmed@1000 : Boolean;
      IsHandled@1002 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeConfirmUpdateContractNo(Rec,IsHandled,Confirmed,HideValidationDialog);
      IF IsHandled THEN
        EXIT(Confirmed);

      Confirmed :=
        ConfirmManagement.ConfirmProcess(
          STRSUBSTNO(
            Text029,ServContractLine.FIELDCAPTION("Next Planned Service Date"),
            ServContractLine.TABLECAPTION,FIELDCAPTION("Contract No.")),TRUE);

      EXIT(Confirmed);
    END;

    LOCAL PROCEDURE SetDefaultSalesperson@18();
    VAR
      UserSetup@1000 : Record 91;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN
        EXIT;

      IF UserSetup."Salespers./Purch. Code" <> '' THEN
        VALIDATE("Salesperson Code",UserSetup."Salespers./Purch. Code");
    END;

    [External]
    PROCEDURE ValidateSalesPersonOnServiceHeader@433(ServiceHeader2@1000 : Record 5900;IsTransaction@1001 : Boolean;IsPostAction@1002 : Boolean);
    BEGIN
      IF ServiceHeader2."Salesperson Code" <> '' THEN
        IF Salesperson.GET(ServiceHeader2."Salesperson Code") THEN
          IF Salesperson.VerifySalesPersonPurchaserPrivacyBlocked(Salesperson) THEN BEGIN
            IF IsTransaction THEN
              ERROR(Salesperson.GetPrivacyBlockedTransactionText(Salesperson,IsPostAction,TRUE));
            IF NOT IsTransaction THEN
              ERROR(Salesperson.GetPrivacyBlockedGenericText(Salesperson,TRUE));
          END;
    END;

    LOCAL PROCEDURE SetSalespersonCode@218(SalesPersonCodeToCheck@1000 : Code[20];VAR SalesPersonCodeToAssign@1001 : Code[20]);
    BEGIN
      IF SalesPersonCodeToCheck <> '' THEN
        IF Salesperson.GET(SalesPersonCodeToCheck) THEN
          IF Salesperson.VerifySalesPersonPurchaserPrivacyBlocked(Salesperson) THEN
            SalesPersonCodeToAssign := ''
          ELSE
            SalesPersonCodeToAssign := SalesPersonCodeToCheck;
    END;

    LOCAL PROCEDURE RevertCurrencyCodeAndPostingDate@167();
    BEGIN
      "Currency Code" := xRec."Currency Code";
      "Posting Date" := xRec."Posting Date";
      MODIFY;
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyCustomerFields@71(VAR ServiceHeader@1000 : Record 5900;Customer@1001 : Record 18);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyBillToCustomerFields@70(VAR ServiceHeader@1000 : Record 5900;Customer@1001 : Record 18);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetPostingNoSeriesCode@61(VAR ServiceHeader@1000 : Record 5900;VAR PostingNos@1002 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterInitRecord@34(VAR ServiceHeader@1000 : Record 5900);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateShipToAddress@137(VAR ServiceHeader@1000 : Record 5900);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnUpdateServLineByChangedFieldName@139(ServiceHeader@1000 : Record 5900;VAR ServiceLine@1001 : Record 5902;ChangedFieldName@1002 : Text[100]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCreateDimTableIDs@138(VAR ServiceHeader@1000 : Record 5900;CallingFieldNo@1001 : Integer;VAR TableID@1003 : ARRAY [10] OF Integer;VAR No@1002 : ARRAY [10] OF Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterValidateShortcutDimCode@176(VAR ServiceHeader@1000 : Record 5900;xServiceHeader@1001 : Record 5900;FieldNumber@1003 : Integer;VAR ShortcutDimCode@1002 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateCust@140(VAR ServiceHeader@1000 : Record 5900);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferExtendedTextForServLineRecreation@141(VAR ServLine@1001 : Record 5902);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckBlockedCustomer@69(Customer@1000 : Record 18;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeConfirmUpdateContractNo@63(VAR ServiceHeader@1000 : Record 5900;Confirmed@1001 : Boolean;HideValidationDialog@1002 : Boolean;IsHandled@1003 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeGetNoSeries@60(VAR ServiceHeader@1000 : Record 5900;VAR NoSeriesCode@1001 : Code[20];VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeGetPostingNoSeriesCode@65(VAR ServiceHeader@1000 : Record 5900;ServiceMgtSetup@1001 : Record 5911;VAR PostingNos@1002 : Code[20];VAR IsHandled@1003 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeInsertServLineOnServLineRecreation@35(VAR ServiceLine@1000 : Record 5902;VAR TempServiceLine@1001 : TEMPORARY Record 5902);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeTestMandatoryFields@57(VAR ServiceHeader@1000 : Record 5900;VAR ServiceLine@1001 : Record 5902);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeTestNoSeries@58(VAR ServiceHeader@1000 : Record 5900;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeTestNoSeriesManual@62(VAR ServiceHeader@1001 : Record 5900;VAR IsHandled@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeUpdateAllLineDim@236(VAR ServiceHeader@1000 : Record 5900;NewParentDimSetID@1002 : Integer;OldParentDimSetID@1001 : Integer;VAR IsHandled@1003 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnCreateDimOnBeforeUpdateLines@66(VAR ServiceHeader@1000 : Record 5900;xServiceHeader@1001 : Record 5900;CurrentFieldNo@1002 : Integer);
    BEGIN
    END;

    BEGIN
    END.
  }
}

