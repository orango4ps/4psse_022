OBJECT Page 1290 Payment Reconciliation Journal
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.03,NAVDK;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Payment Reconciliation Journal;
               NOR=Betalingsavstemmingskladd;
               SVE=BetalningsavstÑmningsjournal];
    LinksAllowed=No;
    SourceTable=Table274;
    DataCaptionExpr="Bank Account No.";
    DelayedInsert=Yes;
    SourceTableView=WHERE(Statement Type=CONST(Payment Application));
    PageType=Worksheet;
    AutoSplitKey=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Manual Application,Review,Details,View,Page,Posting,Line;
                                NOR=Ny,Prosess,Rapport,Manuell bruk,Vurdering,Detaljer,Visning,Side,Bokfõring,Linje;
                                SVE=Ny,Process,Rapport,Manuell koppling,Granska,Detaljer,Visa,Sida,Bokfîring,Rad];
    OnOpenPage=VAR
                 GLSetup@1100285500 : Record 98;
                 ServerConfigSettingHandler@1000 : Codeunit 6723;
               BEGIN
                 IsSaasExcelAddinEnabled := ServerConfigSettingHandler.GetIsSaasExcelAddinEnabled;
                 PageClosedByPosting := FALSE;

                 SetDimensionsVisibility;

                 //4PSSE
                 GLSetup.GET;
                 DKinfoEnable := GLSetup."Danish Localization Active";
               END;

    OnClosePage=BEGIN
                  IF DKinfoEnable THEN
                    UpdateFIKStatus;  //NAVDK
                END;

    OnAfterGetRecord=VAR
                       PaymentMatchingDetails@1000 : Record 1299;
                     BEGIN
                       MatchDetails := PaymentMatchingDetails.MergeMessages(Rec);

                       GetAppliedPmtData(AppliedPmtEntry,RemainingAmountAfterPosting,StatementToRemAmtDifference,PmtAppliedToTxt);
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine;
                  AppliedPmtEntry.INIT;
                  StatementToRemAmtDifference := 0;
                  RemainingAmountAfterPosting := 0;
                END;

    OnAfterGetCurrRecord=BEGIN
                           IF NOT IsBankAccReconInitialized THEN BEGIN
                             BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                             IsBankAccReconInitialized := TRUE;
                           END;

                           FinanceChargeMemoEnabled := "Account Type" = "Account Type"::Customer;
                           BankAccReconciliation.CALCFIELDS("Total Balance on Bank Account","Total Unposted Applied Amount","Total Transaction Amount",
                             "Total Applied Amount","Total Outstd Bank Transactions","Total Outstd Payments","Total Applied Amount Payments");

                           OutstandingTransactions := BankAccReconciliation."Total Outstd Bank Transactions" -
                             (BankAccReconciliation."Total Applied Amount" - BankAccReconciliation."Total Unposted Applied Amount") +
                             BankAccReconciliation."Total Applied Amount Payments";
                           OutstandingPayments := BankAccReconciliation."Total Outstd Payments" - BankAccReconciliation."Total Applied Amount Payments";

                           UpdateBalanceAfterPostingStyleExpr;

                           TestIfFiltershaveBeenRemovedWithRefreshAndClose;
                         END;

    ActionList=ACTIONS
    {
      { 45      ;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=Process;
                                 NOR=Prosess;
                                 SVE=Process] }
      { 22      ;2   ;Action    ;
                      Name=ImportBankTransactions;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Import Bank Transactions;
                                 NOR=Importer &banktransaksjoner;
                                 SVE=&Importera banktransaktioner];
                      ToolTipML=[ENU=Import a file for transaction payments that was made from your bank account and apply the payments to the entry. The file name must end in .csv, .txt, asc, or .xml.;
                                 NOR=Importer en fil for transaksjonsbetalinger som ble utfõrt fra bankkontoen, og utlign betalingene til posten. Filnavnet mÜ ha filtypen CSV, TXT, ASC eller XML.;
                                 SVE=Importera en fil fîr transaktionsbetalningar som har gjorts frÜn ditt bankkonto och koppla betalningarna till transaktionen. Filnamnet mÜste sluta med .csv, .txt, asc eller .xml.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SubscriberInvoked@1000 : Boolean;
                               BEGIN
                                 OnAfterImportBankTransactions(SubscriberInvoked,Rec);
                                 IF DKinfoEnable THEN BEGIN
                                   IF (COUNT > 0) AND BankAccReconciliation."FIK Payment Reconciliation" THEN
                                     ERROR(CannotImportStatementIntoFIKErr);
                                   BankAccReconciliation.ImportBankStatement;
                                   CurrPage.UPDATE(FALSE);
                                   BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                   BankAccReconciliation."FIK Payment Reconciliation" := FALSE;
                                   BankAccReconciliation.MODIFY;
                                 END
                                 ELSE BEGIN
                                   IF NOT SubscriberInvoked THEN BEGIN
                                     BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                     BankAccReconciliation.ImportBankStatement;
                                     IF BankAccReconciliation.FIND THEN;
                                   END;
                                 END;
                               END;
                                }
      { 1060001 ;2   ;Action    ;
                      Name=ImportFIKStatement;
                      Ellipsis=Yes;
                      CaptionML=ENU=Import FIK Statement;
                      ToolTipML=ENU=Import a file with FIK payments. The Fik payments are automatically applied as suggestions.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=DKinfoEnable;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 BankAccReconciliation@1060000 : Record 273;
                               BEGIN
                                 BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                 IF (COUNT > 0) AND (NOT BankAccReconciliation."FIK Payment Reconciliation") THEN
                                   ERROR(CannotImportFIKLinesErr);

                                 IF BankAccReconciliation.ImportFIK THEN BEGIN
                                   COMMIT;
                                   CODEUNIT.RUN(CODEUNIT::"Match FIK Bank Rec. Lines",BankAccReconciliation);
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=ApplyAutomatically;
                      CaptionML=[ENU=Apply Automatically;
                                 NOR=Utlign automatisk;
                                 SVE=Koppla automatiskt];
                      ToolTipML=[ENU=Apply payments to their related open entries based on data matches between bank transaction text and entry information.;
                                 NOR=Utlign betalinger til deres relaterte Üpne poste basert pÜ datasamsvar mellom banktransaksjonstekst og postinformasjon.;
                                 SVE=Koppla betalningar till deras relaterade îppna transaktioner utifrÜn datamatchningar mellan banktransaktionstexten och transaktionsinformationen.];
                      ApplicationArea=#Basic,#Suite;
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MapAccounts;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 BankAccReconciliation@1000 : Record 273;
                                 AppliedPaymentEntry@1001 : Record 1294;
                                 SubscriberInvoked@1002 : Boolean;
                               BEGIN
                                 AppliedPaymentEntry.SETRANGE("Statement Type","Statement Type");
                                 AppliedPaymentEntry.SETRANGE("Bank Account No.","Bank Account No.");
                                 AppliedPaymentEntry.SETRANGE("Statement No.","Statement No.");

                                 IF AppliedPaymentEntry.COUNT > 0 THEN
                                   IF NOT CONFIRM(RemoveExistingApplicationsQst) THEN
                                     EXIT;

                                 BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                 IF DKinfoEnable THEN BEGIN
                                   UpdateFIKStatus;
                                   IF BankAccReconciliation."FIK Payment Reconciliation" THEN
                                     CODEUNIT.RUN(CODEUNIT::"Match FIK Bank Rec. Lines",BankAccReconciliation)
                                   ELSE
                                     CODEUNIT.RUN(CODEUNIT::"Match Bank Pmt. Appl.",BankAccReconciliation);
                                 END
                                 ELSE BEGIN
                                   OnAtActionApplyAutomatically(BankAccReconciliation,SubscriberInvoked);
                                   IF NOT SubscriberInvoked THEN
                                     CODEUNIT.RUN(CODEUNIT::"Match Bank Pmt. Appl.",BankAccReconciliation);

                                 END;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 58      ;2   ;ActionGroup;
                      CaptionML=[ENU=Post;
                                 NOR=Bokfõr;
                                 SVE=Bokfîr];
                      Image=Post }
      { 72      ;3   ;Action    ;
                      Name=TestReport;
                      CaptionML=[ENU=&Test Report;
                                 NOR=&Kontrollrapport;
                                 SVE=&Testrapport];
                      ToolTipML=[ENU=Preview the resulting payment reconciliations to see the consequences before you perform the actual posting.;
                                 NOR=ForhÜndsvis de resulterende betalingsavstemmingene for Ü se konsekvensene fõr du faktisk bokfõrer.;
                                 SVE=Fîrhandsgranska betalningsavstÑmningarna fîr att se konsekvenserna innan du utfîr den faktiska bokfîringen.];
                      ApplicationArea=#Basic,#Suite;
                      Image=TestReport;
                      OnAction=VAR
                                 TestReportPrint@1001 : Codeunit 228;
                               BEGIN
                                 BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                 TestReportPrint.PrintBankAccRecon(BankAccReconciliation);
                               END;
                                }
      { 35      ;3   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Payments and Reconcile Bank Account;
                                 NOR=Bokfõr betalinger og avstem bankkonto;
                                 SVE=Bokfîr betalningar och stÑm av bankkonton];
                      ToolTipML=[ENU=Reconcile the bank account for payments that you post with the journal and close related ledger entries.;
                                 NOR=Avstem bankkontoen for betalinger du bokfõrer med kladden, og lukk relaterte poster.;
                                 SVE=StÑm av bankkontot fîr betalningar som du bokfîr med journalen och stÑng relaterade transaktioner.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostApplication;
                      PromotedCategory=Category9;
                      OnAction=BEGIN
                                 InvokePost(FALSE)
                               END;
                                }
      { 60      ;3   ;Action    ;
                      Name=PostPaymentsOnly;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Payments Only;
                                 NOR=Bokfõr bare betalinger;
                                 SVE=Bokfîr enbart betalningar];
                      ToolTipML=[ENU=Post payments but do not close related bank account ledger entries or reconcile the bank account.;
                                 NOR=Bokfõr betalinger, men ikke lukk relaterte bankkontoposter eller avstem bankkontoen.;
                                 SVE=Bokfîr betalningar men stÑng inte relaterade bankkontotransaktioner och stÑm heller inte av bankkontot.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PaymentJournal;
                      PromotedCategory=Category9;
                      OnAction=BEGIN
                                 InvokePost(TRUE)
                               END;
                                }
      { 42      ;1   ;ActionGroup;
                      CaptionML=[ENU=New Documents;
                                 NOR=Nye bilag;
                                 SVE=Nya dokument] }
      { 20      ;2   ;Action    ;
                      Name=FinanceChargeMemo;
                      CaptionML=[ENU=New Finance Charge Memo;
                                 NOR=Ny rentenota;
                                 SVE=Ny rÑntefaktura];
                      ToolTipML=[ENU=Define a memo that includes information about the calculated interest on outstanding balances of an account. You can then send the memo in an email to the customer.;
                                 NOR=Definer et notat som inkluderer informasjon om den beregnede renten pÜ utestÜende saldi for en konto. Deretter kan du sende notatet til kunden via e-post.;
                                 SVE=Definiera en PM som innehÜller information om den berÑknade rÑntan pÜ kontots utestÜende saldon. Du kan sedan skicka detta PM i ett e-postmeddelande till kunden.];
                      ApplicationArea=#Suite;
                      RunObject=Page 446;
                      RunPageLink=Customer No.=FIELD(Account No.);
                      Enabled=FinanceChargeMemoEnabled;
                      PromotedIsBig=Yes;
                      Image=FinChargeMemo;
                      RunPageMode=Create }
      { 41      ;2   ;Action    ;
                      Name=OpenGenJnl;
                      CaptionML=[ENU=General Journal;
                                 NOR=Finanskladd;
                                 SVE=Redovisningsjournal];
                      ToolTipML=[ENU=Open the general journal, for example, to record or post a payment that has no related document.;
                                 NOR=èpne finanskladden, for eksempel for Ü registrere eller bokfõre en betaling som ikke har noe tilknyttet dokument.;
                                 SVE=ôppna redovisningsjournalen, till exempel fîr att registrera eller bokfîra en betalning utan relaterat dokument.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 39;
                      PromotedIsBig=Yes;
                      Image=GLRegisters }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Payment Journal;
                                 NOR=Betalingskladd;
                                 SVE=Utbetalningsjournal];
                      ToolTipML=[ENU=View or edit the payment journal where you can register payments to vendors.;
                                 NOR=Vis eller rediger utbetalingskladden der du kan registrere utbetalinger til leverandõrer.;
                                 SVE=Visa eller redigera utbetalningsjournalen dÑr du kan registrera utbetalningar till leverantîrer.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 256;
                      PromotedIsBig=Yes;
                      Image=PaymentJournal }
      { 63      ;1   ;ActionGroup;
                      CaptionML=[ENU=Manual Application;
                                 NOR=Manuell utligning;
                                 SVE=Manuell koppling] }
      { 59      ;2   ;Action    ;
                      Name=TransferDiffToAccount;
                      CaptionML=[ENU=Transfer Difference to Account;
                                 NOR=Overfõr differanse til konto;
                                 SVE=ôverfîr differens till konto];
                      ToolTipML=[ENU=Specify the balancing account to which you want a non-applicable payment amount on a payment reconciliation journal line to be posted when you post the journal.;
                                 NOR=Angi motkontoen som du vil at en ikke-tilgjengelig betalingsbelõp pÜ en linje for betalingsavstemmingskladd skal bokfõres til nÜr du bokfõrer kladden.;
                                 SVE=Ange balanskontot pÜ vilket du vill bokfîra ett ej kopplingsbart betalningsbelopp frÜn en rad i en betalningsavstÑmningsjournal nÑr du bokfîr journalen.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TransferToGeneralJournal;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 MatchBankPayments@1001 : Codeunit 1255;
                               BEGIN
                                 MatchBankPayments.TransferDiffToAccount(Rec,TempGenJournalLine)
                               END;
                                }
      { 30      ;2   ;Action    ;
                      Name=AddMappingRule;
                      CaptionML=[ENU=Map Text to Account;
                                 NOR=Tilordne tekst til konto;
                                 SVE=Mappa text till konto];
                      ToolTipML=[ENU=Associate text on payments with debit, credit, and balancing accounts, so payments are posted to the accounts when you post payments. The payments are not applied to invoices or credit memos, and are suited for recurring cash receipts or expenses.;
                                 NOR=Knytt tekst i betalinger til debet-, kredit- og motkonti slik at betalinger blir bokfõrt til kontiene nÜr du bokfõrer betalinger. Betalingene blir ikke utlignet til fakturaer eller kreditnotaer, og de passer til gjentakende kontantmottak eller utgifter.;
                                 SVE=Associera texten pÜ betalningen med debet-, kredit- och balanskonton, sÜ att betalningar bokfîrs pÜ kontona nÑr du bokfîr betalningar. Betalningarna kopplas inte till fakturor eller kreditnotor, och anvÑnds fîr Üterkommande inbetalningar eller utgifter.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Add;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 TextToAccMapping@1000 : Record 1251;
                                 MatchBankPayments@1001 : Codeunit 1255;
                               BEGIN
                                 IF DKinfoEnable THEN BEGIN
                                   BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                   UpdateFIKStatus;
                                   IF BankAccReconciliation."FIK Payment Reconciliation" THEN
                                     ERROR(CannotAddMappingRulesForFIKLinesErr);
                                 END;
                                 TextToAccMapping.InsertRecFromBankAccReconciliationLine(Rec);
                                 MatchBankPayments.RerunTextMapper(Rec);
                               END;
                                }
      { 31      ;2   ;Action    ;
                      Name=ApplyEntries;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Apply Manually;
                                 NOR=&Utlign manuelt;
                                 SVE=&Koppla manuellt];
                      ToolTipML=[ENU=Review and apply payments that were applied automatically to wrong open entries or not applied at all.;
                                 NOR=Vurder og utlign betalinger som ble utlignet automatisk til feilaktige Üpne poster eller ikke utlignet i det hele tatt.;
                                 SVE=Granska och koppla betalningar som har kopplats automatiskt till fel îppna transaktioner eller inte kopplats alls.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 DisplayApplication;
                                 GetAppliedPmtData(AppliedPmtEntry,RemainingAmountAfterPosting,StatementToRemAmtDifference,PmtAppliedToTxt);
                               END;
                                }
      { 44      ;1   ;ActionGroup;
                      CaptionML=[ENU=Review;
                                 NOR=Vurdering;
                                 SVE=Granska] }
      { 36      ;2   ;Action    ;
                      Name=Accept;
                      CaptionML=[ENU=Accept Applications;
                                 NOR=Godta utligninger;
                                 SVE=Acceptera kopplingar];
                      ToolTipML=[ENU=Accept a payment application after reviewing it or manually applying it to entries. This closes the payment application and sets the Match Confidence to Accepted.;
                                 NOR=Godta en betalingsutligning etter Ü ha vurdert den eller utlignet den manuelt til poster. Dermed lukkes betalingsutligningen, og Konfidensintervall settes til Godtatt.;
                                 SVE=Acceptera en betalningskoppling efter att du har granskat den eller kopplat den manuellt till transaktioner. DÜ stÑngs betalningskopplingen och MatchningssÑkerhet anges till Accepterat.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BankAccReconciliationLine@1000 : Record 274;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(BankAccReconciliationLine);
                                 BankAccReconciliationLine.AcceptAppliedPaymentEntriesSelectedLines;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Remove Applications;
                                 NOR=Fjern utligninger;
                                 SVE=Ta bort kopplingar];
                      ToolTipML=[ENU=Remove a payment application from an entry. This unapplies the payment.;
                                 NOR=Fjern en betalingsutligning fra en post. Dermed oppheves utligningen av betalingen.;
                                 SVE=Ta bort en betalningskoppling frÜn en transaktion. DÜ kopplas betalningen bort.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BankAccReconciliationLine@1000 : Record 274;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(BankAccReconciliationLine);
                                 BankAccReconciliationLine.RejectAppliedPaymentEntriesSelectedLines;
                               END;
                                }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=Custom Sorting;
                                 NOR=Egendefinert sortering;
                                 SVE=Anpassad sortering] }
      { 56      ;2   ;Action    ;
                      Name=ShowNonAppliedLines;
                      CaptionML=[ENU=Show Non-Applied Lines;
                                 NOR=Vis ikke-utlignede linjer;
                                 SVE=Visa okopplade rader];
                      ToolTipML=[ENU=Display only payments in the list that have not been applied.;
                                 NOR=Vis bare betalinger i listen som ikke har blitt utlignet ennÜ.;
                                 SVE=Visa enbart betalningar som inte har kopplats i listan.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=FilterLines;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 SETFILTER(Difference,'<>0');
                                 CurrPage.UPDATE;
                               END;
                                }
      { 55      ;2   ;Action    ;
                      Name=ShowAllLines;
                      CaptionML=[ENU=Show All Lines;
                                 NOR=Vis alle linjer;
                                 SVE=Visa alla rader];
                      ToolTipML=[ENU=Show all payments in the list no matter what their status is.;
                                 NOR=Vis alle betalinger i listen uavhengig av status.;
                                 SVE=Visa alla betalningar i listan, oavsett deras status.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AllLines;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 SETRANGE(Difference);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 32      ;2   ;Action    ;
                      Name=SortForReviewDescending;
                      CaptionML=[ENU=Sort for Review Descending;
                                 NOR=Sorter synkende for vurdering;
                                 SVE=Sortera fîr granskning - fallande];
                      ToolTipML=[ENU=Sort the lines in ascending order.;
                                 NOR=Sorter linjene i stigende rekkefõlge.;
                                 SVE=Sortera rader i stigande ordning.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MoveDown;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 UpdateSorting(FALSE);
                               END;
                                }
      { 34      ;2   ;Action    ;
                      Name=SortForReviewAscending;
                      CaptionML=[ENU=Sort for Review Ascending;
                                 NOR=Sorter stigende for vurdering;
                                 SVE=Sortera fîr granskning - stigande];
                      ToolTipML=[ENU=Sort the lines in descending order.;
                                 NOR=Sorter linjene i synkende rekkefõlge.;
                                 SVE=Sortera rader i fallande ordning.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MoveUp;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 UpdateSorting(TRUE);
                               END;
                                }
      { 39      ;    ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 38      ;1   ;Action    ;
                      Name=Dimensions;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera dimensioner, till exempel omrÜde, projekt eller avdelning, som du kan tilldela fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
                                 BankAccReconciliation.ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 6       ;1   ;Action    ;
                      Name=LineDimensions;
                      CaptionML=[ENU=Line Dimensions;
                                 NOR=Linjedimensjoner;
                                 SVE=Raddimensioner];
                      ToolTipML=[ENU=View or edit the line dimensions sets that are set up for the current line.;
                                 NOR=Vis eller rediger linjedimensjonssettene som er definert for den gjeldene linjen.;
                                 SVE=Visa eller redigera raddimensionsuppsÑttningarna som har angetts fîr den aktuella raden.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category10;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 21      ;1   ;Action    ;
                      CaptionML=[ENU=Bank Account Card;
                                 NOR=Bankkort;
                                 SVE=Bankkontokort];
                      ToolTipML=[ENU=View or edit information about the bank account that is related to the payment reconciliation journal.;
                                 NOR=Vis eller rediger informasjon om bankkontoen som er relatert til betalingsavstemmingskladden.;
                                 SVE=Visa eller redigera information om bankkontot som hîr till betalningsavstÑmningsjournalen.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1283;
                      RunPageLink=No.=FIELD(Bank Account No.);
                      Image=BankAccount }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=Details;
                                 NOR=Detaljer;
                                 SVE=Detaljer] }
      { 27      ;2   ;Action    ;
                      Name=ShowBankTransactionDetails;
                      CaptionML=[ENU=Bank Transaction Details;
                                 NOR=Banktransaksjonsdetaljer;
                                 SVE=Banktransaktionsdetaljer];
                      ToolTipML=[ENU=View the values that exist in an imported bank statement file for the selected line.;
                                 NOR=Vis verdiene som eksisterer i en importert bankkontoutdragsfil for den valgte linjen.;
                                 SVE=Visa vÑrdena som finns i en importerad bankutdragsfil fîr den valda raden.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1221;
                      RunPageLink=Data Exch. No.=FIELD(Data Exch. Entry No.),
                                  Line No.=FIELD(Data Exch. Line No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExternalDocument;
                      PromotedCategory=Category10 }
      { 74      ;1   ;ActionGroup;
                      CaptionML=[ENU=Page;
                                 NOR=Side;
                                 SVE=Sida] }
      { 73      ;2   ;Action    ;
                      Name=EditInExcel;
                      CaptionML=[ENU=Edit in Excel;
                                 NOR=Rediger i Excel;
                                 SVE=Redigera i Excel];
                      ToolTipML=[ENU=Send the data in the journal to an Excel file for analysis or editing.;
                                 NOR=Send dataene i journalen til en Excel-fil for analyse eller redigering.;
                                 SVE=Skicka data i journalen till en Excel-fil fîr analys eller redigering.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsSaasExcelAddinEnabled;
                      PromotedIsBig=Yes;
                      Image=Excel;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ODataUtility@1000 : Codeunit 6710;
                               BEGIN
                                 ODataUtility.EditWorksheetInExcel(CurrPage.CAPTION,CurrPage.OBJECTID(FALSE),'');
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater;
                FreezeColumnID=Statement Amount }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quality of the automatic payment application on the journal line.;
                           NOR=Angir kvaliteten pÜ den automatiske betalingsutligningen pÜ kladdelinjen.;
                           SVE=Anger kvaliteten pÜ den automatiska betalningskopplingen pÜ journalraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Match Confidence";
                Editable=FALSE;
                OnDrillDown=BEGIN
                              DisplayApplication;
                            END;
                             }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the payment represented by the journal line was recorded in the bank account.;
                           NOR=Angir datoen da betalingen som er representert av kladdelinjen, ble registrert pÜ bankkontoen.;
                           SVE=Anger datumet nÑr betalningen som representeras av journalraden registrerades pÜ bankkontot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Date" }

    { 16  ;2   ;Field     ;
                Width=40;
                ToolTipML=[ENU=Specifies the text that the customer or vendor entered on that payment transaction that is represented by the journal line.;
                           NOR=Angir teksten som kunden eller leverandõren angav pÜ den betalingsutligningen som representeres av kladdelinjen.;
                           SVE=Anger texten som kunden eller leverantîren angett i betalningstransaktionen som representeras av journalraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Text" }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the imported bank transaction.;
                           NOR=Angir ID-en for den importerte banktransaksjonen.;
                           SVE=Ange ID-numret fîr den importerade banktransaktionen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction ID";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Transaction Amount;
                           NOR=Transaksjonsbelõp;
                           SVE=Transaktionsbelopp];
                ToolTipML=[ENU=Specifies the amount that was paid into the bank account and then imported as a bank statement line represented by the journal line.;
                           NOR=Angir belõpet som ble betalt til bankkontoen og deretter ble importert som en bankkontoutdragslinje som ble representert av kladdelinjen.;
                           SVE=Anger beloppet som betalades in pÜ bankkontot och sedan importerades som en bankutdragsrad som representeras av journalraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Statement Amount";
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             CurrPage.UPDATE(FALSE)
                           END;
                            }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that has been applied to one or more open entries.;
                           NOR=Angir belõpet som har blitt utlignet til Çn eller flere Üpne poster.;
                           SVE=Anger beloppet som har kopplats till en eller flera îppna transaktioner.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applied Amount" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the difference between the amount in the Statement Amount field and the amount in the Applied Amount field.;
                           NOR=Viser differansen mellom belõpet i feltet Utdragsbelõp og belõpet i feltet Utlignet belõp.;
                           SVE=Anger skillnaden mellan beloppet i fÑltet Transaktionsbelopp och fÑltet Kopplat belopp.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Difference;
                Editable=FALSE;
                Style=Unfavorable }

    { 52  ;2   ;Field     ;
                Name=StatementToRemAmtDifference;
                CaptionML=[ENU=Difference from Remaining Amount;
                           NOR=Differanse fra restbelõp;
                           SVE=Differens mot ÜterstÜende belopp];
                ToolTipML=[ENU=Specifies the difference between the values in the Statement Amount and the Remaining Amount After Posting fields.;
                           NOR=Viser differansen mellom verdiene i feltene Utdragsbelõp og Restbelõp etter bokfõring.;
                           SVE=Anger differensen mellan vÑrdena i fÑlten Transaktionsbelopp och èterstÜende belopp efter bokfîring.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=StatementToRemAmtDifference;
                Visible=FALSE;
                Enabled=FALSE }

    { 49  ;2   ;Field     ;
                CaptionML=[ENU=Document No.;
                           NOR=Bilagsnr.;
                           SVE=Dokumentnr];
                ToolTipML=[ENU=Specifies the document number of the open entry that the payment is applied to.;
                           NOR=Angir dokumentnummeret for den Üpne posten som betalingen blir utlignet til.;
                           SVE=Anger dokumentnumret fîr den îppna transaktionen som betalningen kopplas till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAppliedToDocumentNo }

    { 47  ;2   ;Field     ;
                Name=DescAppliedEntry;
                CaptionML=[ENU=Description;
                           NOR=Beskrivelse;
                           SVE=Beskrivning];
                ToolTipML=[ENU=Specifies the description on the open entry that the payment is applied to.;
                           NOR=Angir beskrivelsen av den Üpne posten som betalingen blir utlignet til.;
                           SVE=Anger en beskrivning av den îppna transaktionen som betalningen kopplas till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AppliedPmtEntry.Description;
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                Name=DueDateAppliedEntry;
                CaptionML=[ENU=Due Date;
                           NOR=Forfallsdato;
                           SVE=Fîrfallodatum];
                ToolTipML=[ENU=Specifies the due date on the open entry that the payment is applied to.;
                           NOR=Angir forfallsdatoen for den Üpne posten som betalingen blir utlignet til.;
                           SVE=Anger fîrfallodatumet fîr den îppna transaktionen som betalningen kopplas till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AppliedPmtEntry."Due Date" }

    { 43  ;2   ;Field     ;
                Name=AccountName;
                CaptionML=[ENU=Account Name;
                           NOR=Kontonavn;
                           SVE=Kontonamn];
                ToolTipML=[ENU=Specifies the name of the customer or vendor that the payment is applied to.;
                           NOR=Angir navnet pÜ kunden eller leverandõren som betalingen blir utlignet til.;
                           SVE=Anger namnet pÜ kunden eller leverantîren som betalningen kopplas till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAppliedToName;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              AppliedToDrillDown;
                            END;
                             }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of account that the payment application will be posted to when you post the worksheet.;
                           NOR=Angir kontotypen som betalingsutligningen blir bokfõrt til ved bokfõring av forslaget.;
                           SVE=Anger typen av konto som betalningskopplingen bokfîrs pÜ nÑr du bokfîr fîrslaget.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Type" }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the account number that the payment application will be posted to when you post the worksheet.;
                           NOR=Angir kontonummeret som betalingsutligningen blir bokfõrt til ved bokfõring av forslaget.;
                           SVE=Anger kontonumret som betalningskopplingen bokfîrs pÜ nÑr du bokfîr fîrslaget.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account No.";
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             IF Difference <> 0 THEN
                               TransferRemainingAmountToAccount;
                           END;
                            }

    { 46  ;2   ;Field     ;
                Name=PostingDateAppliedEntry;
                CaptionML=[ENU=Posting Date;
                           NOR=Bokfõringsdato;
                           SVE=Bokfîringsdatum];
                ToolTipML=[ENU=Specifies the posting date on the open entry that the payment is applied to.;
                           NOR=Angir bokfõringsdatoen for den Üpne posten som betalingen blir utlignet til.;
                           SVE=Anger bokfîringsdatumet fîr den îppna transaktionen som betalningen kopplas till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AppliedPmtEntry."Posting Date";
                Visible=FALSE;
                Editable=FALSE }

    { 51  ;2   ;Field     ;
                CaptionML=[ENU=Entry Currency Code;
                           NOR=Valutakode for post;
                           SVE=Valutakod fîr transaktion];
                ToolTipML=[ENU=Specifies the currency code on the open entry that the payment is applied to.;
                           NOR=Angir valutakoden for den Üpne posten som betalingen blir utlignet til.;
                           SVE=Anger valutakoden fîr den îppna transaktionen som betalningen kopplas till.];
                ApplicationArea=#Suite;
                SourceExpr=AppliedPmtEntry."Currency Code";
                Visible=FALSE }

    { 2   ;2   ;Field     ;
                Name=Match Details;
                CaptionML=[ENU=Match Details;
                           NOR=Avstemmingsdetaljer;
                           SVE=Matchningsdetaljer];
                ToolTipML=[ENU=Specifies details about the payment application on the journal line.;
                           NOR=Angir detaljene om betalingsutligningen pÜ kladdelinjen.;
                           SVE=Anger information om betalningskopplingen pÜ journalraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MatchDetails;
                Visible=FALSE;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              DisplayApplication;
                            END;
                             }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies for a journal line where the payment has been applied, how many entries the payment has been applied to.;
                           NOR=Angir hvor mange poster betalingen har blitt utlignet for, for en kladdelinje der betalingen har blitt utlignet.;
                           SVE=Anger hur mÜnga transaktioner betalningen har kopplats till, fîr en journalrad dÑr betalningen har kopplats.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applied Entries";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                Name=RemainingAmount;
                CaptionML=[ENU=Remaining Amount After Posting;
                           NOR=Restbelõp etter bokfõring;
                           SVE=èterstÜende belopp efter bokfîring];
                ToolTipML=[ENU=Specifies the amount that remains to be paid on the open entry that the payment is applied to.;
                           NOR=Angir belõpet som gjenstÜr Ü betales for den Üpne posten som betalingen blir utlignet til.;
                           SVE=Anger beloppet som ÜterstÜr att betala pÜ den îppna transaktionen som betalningen kopplas till.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=RemainingAmountAfterPosting;
                Visible=FALSE;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                Width=40;
                ToolTipML=[ENU=Specifies additional information on the bank statement line for the payment.;
                           NOR=Angir tilleggsinformasjon pÜ linjen pÜ bankkontoutdraget for betalingen.;
                           SVE=Anger ytterligare information om betalningen pÜ bankutdragsraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Additional Transaction Info";
                Visible=FALSE;
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                Width=30;
                ToolTipML=[ENU=Specifies the address of the customer or vendor who made the payment that is represented by the journal line.;
                           NOR=Angir adressen til kunden eller leverandõren som utfõrte betalingen som representeres av kladdelinjen.;
                           SVE=Anger adressen till kunden eller leverantîren som har gjort betalningen som representeras av journalraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Related-Party Address";
                Visible=FALSE;
                Editable=FALSE }

    { 5   ;2   ;Field     ;
                Width=20;
                ToolTipML=[ENU=Specifies the bank account number of the customer or vendor who made the payment.;
                           NOR=Angir bankkontonummeret for kunden eller leverandõren som utfõrte betalingen.;
                           SVE=Anger bankkontonumret fîr kunden eller leverantîren som har gjort betalningen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Related-Party Bank Acc. No.";
                Visible=FALSE;
                Editable=FALSE }

    { 19  ;2   ;Field     ;
                Width=10;
                ToolTipML=[ENU=Specifies the city name of the customer or vendor.;
                           NOR=Angir navnet pÜ poststedet for kunden eller leverandõren.;
                           SVE=Anger kundens eller leverantîrens ort.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Related-Party City";
                Visible=FALSE;
                Editable=FALSE }

    { 17  ;2   ;Field     ;
                Width=30;
                ToolTipML=[ENU=Specifies the name of the customer or vendor who made the payment that is represented by the journal line.;
                           NOR=Angir navnet pÜ kunden eller leverandõren som utfõrte betalingen som representeres av kladdelinjen.;
                           SVE=Anger namnet pÜ kunden eller leverantîren som har gjort betalningen som representeras av journalraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Related-Party Name";
                Visible=FALSE;
                Editable=FALSE }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=DimVisible1 }

    { 65  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=DimVisible2 }

    { 71  ;2   ;Field     ;
                Name=ShortcutDimCode3;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kladdelinjen.;
                           SVE=Anger dimensionsvÑrdeskoden som Ñr lÑnkad till journalraden.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible3;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);

                             OnAfterValidateShortcutDimCode(Rec,ShortcutDimCode,3);
                           END;
                            }

    { 70  ;2   ;Field     ;
                Name=ShortcutDimCode4;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kladdelinjen.;
                           SVE=Anger dimensionsvÑrdeskoden som Ñr lÑnkad till journalraden.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible4;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);

                             OnAfterValidateShortcutDimCode(Rec,ShortcutDimCode,4);
                           END;
                            }

    { 69  ;2   ;Field     ;
                Name=ShortcutDimCode5;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kladdelinjen.;
                           SVE=Anger dimensionsvÑrdeskoden som Ñr lÑnkad till journalraden.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible5;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);

                             OnAfterValidateShortcutDimCode(Rec,ShortcutDimCode,5);
                           END;
                            }

    { 68  ;2   ;Field     ;
                Name=ShortcutDimCode6;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kladdelinjen.;
                           SVE=Anger dimensionsvÑrdeskoden som Ñr lÑnkad till journalraden.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible6;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);

                             OnAfterValidateShortcutDimCode(Rec,ShortcutDimCode,6);
                           END;
                            }

    { 67  ;2   ;Field     ;
                Name=ShortcutDimCode7;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kladdelinjen.;
                           SVE=Anger dimensionsvÑrdeskoden som Ñr lÑnkad till journalraden.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible7;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);

                             OnAfterValidateShortcutDimCode(Rec,ShortcutDimCode,7);
                           END;
                            }

    { 66  ;2   ;Field     ;
                Name=ShortcutDimCode8;
                ToolTipML=[ENU=Specifies the dimension value code linked to the journal line.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kladdelinjen.;
                           SVE=Anger dimensionsvÑrdeskoden som Ñr lÑnkad till journalraden.];
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible8;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);

                             OnAfterValidateShortcutDimCode(Rec,ShortcutDimCode,8);
                           END;
                            }

    { 28  ;1   ;Group     ;
                GroupType=Group }

    { 33  ;2   ;Group     ;
                Editable=FALSE;
                GroupType=Group }

    { 25  ;3   ;Field     ;
                Name=BalanceOnBankAccount;
                CaptionML=[ENU=Balance on Bank Account;
                           NOR=Saldo pÜ bankkonto;
                           SVE=Saldo pÜ bankkonto];
                ToolTipML=[ENU=Specifies the balance of the bank account per the last time you reconciled the bank account.;
                           NOR=Angir saldoen for bankkontoen per sist gang du avstemte bankkontoen.;
                           SVE=Anger saldot pÜ bankkontot per den senaste gÜngen du stÑmde av bankkontot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconciliation."Total Balance on Bank Account";
                AutoFormatType=1;
                OnDrillDown=BEGIN
                              BankAccReconciliation.DrillDownOnBalanceOnBankAccount;
                            END;
                             }

    { 26  ;3   ;Field     ;
                Name=TotalTransactionAmount;
                CaptionML=[ENU=Total Transaction Amount;
                           NOR=Totalt transaksjonsbelõp;
                           SVE=Totalt transaktionsbelopp];
                ToolTipML=[ENU=Specifies the sum of values in the Statement Amount field on all the lines in the Payment Reconciliation Journal window.;
                           NOR=Angir summen av verdier i feltet Utdragsbelõp pÜ alle linjene i vinduet Betalingsavstemmingskladd.;
                           SVE=Anger summan av vÑrdena i fÑltet Transaktionsbelopp pÜ alla raderna i fînstret BetalningsavstÑmningsjournal.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconciliation."Total Transaction Amount";
                AutoFormatType=1 }

    { 24  ;3   ;Field     ;
                Name=BalanceOnBankAccountAfterPosting;
                CaptionML=[ENU=Balance on Bank Account After Posting;
                           NOR=Saldo pÜ bankkonto etter bokfõring;
                           SVE=Saldo pÜ bankkonto efter bokfîring];
                ToolTipML=[ENU=Specifies the total amount that will exist on the bank account as a result of payment applications that you post in the Payment Reconciliation Journal window.;
                           NOR=Angir totalbelõpet som eksisterer pÜ bankkontoen som et resultat av betalingsutligninger du bokfõrer i vinduet Betalingsavstemmingskladd.;
                           SVE=Anger det totala beloppet som kommer att finnas pÜ bankkontot som ett resultat av betalningskopplingar som du bokfîr i fînstret BetalningsavstÑmningsjournal.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconciliation."Total Balance on Bank Account" + BankAccReconciliation."Total Unposted Applied Amount";
                AutoFormatType=1;
                StyleExpr=BalanceAfterPostingStyleExpr }

    { 3   ;2   ;Group     ;
                GroupType=Group }

    { 54  ;3   ;Field     ;
                Name=OutstandingTransactions;
                CaptionML=[ENU=Outstanding Transactions;
                           NOR=UtestÜende transaksjoner;
                           SVE=UtestÜende transaktioner];
                ToolTipML=[ENU=Specifies the outstanding bank transactions that have not been applied.;
                           NOR=Angir de utestÜende banktransaksjonene som ikke har blitt utlignet.;
                           SVE=Anger de utestÜende banktransaktioner som inte har kopplats.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=OutstandingTransactions;
                Editable=FALSE;
                OnDrillDown=VAR
                              DummyOutstandingBankTransaction@1001 : Record 1284;
                            BEGIN
                              DummyOutstandingBankTransaction.DrillDown("Bank Account No.",
                                DummyOutstandingBankTransaction.Type::"Bank Account Ledger Entry","Statement Type","Statement No.");
                            END;
                             }

    { 61  ;3   ;Field     ;
                Name=OutstandingPayments;
                CaptionML=[ENU=Outstanding Payments;
                           NOR=UtestÜende betalinger;
                           SVE=UtestÜende betalningar];
                ToolTipML=[ENU=Specifies the outstanding check transactions that have not been applied.;
                           NOR=Angir de utestÜende sjekktransaksjonene som ikke har blitt utlignet.;
                           SVE=Anger de utestÜende checktransaktioner som inte har kopplats.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=OutstandingPayments;
                Editable=FALSE;
                OnDrillDown=VAR
                              DummyOutstandingBankTransaction@1001 : Record 1284;
                            BEGIN
                              DummyOutstandingBankTransaction.DrillDown("Bank Account No.",
                                DummyOutstandingBankTransaction.Type::"Check Ledger Entry","Statement Type","Statement No.");
                            END;
                             }

    { 23  ;3   ;Field     ;
                Name=StatementEndingBalance;
                CaptionML=[ENU=Statement Ending Balance;
                           NOR=Utdrag - sluttsaldo;
                           SVE=Kontoutdragets slutsaldo];
                ToolTipML=[ENU=Specifies the balance on your actual bank account after the bank has processed the payments that you have imported with the bank statement file.;
                           NOR=Angir saldoen pÜ den reelle bankkontoen etter at banken har behandlet betalingene du har importert, med bankkontoutdragsfilen.;
                           SVE=Anger saldot pÜ ditt faktiska bankkonto efter att banken har behandlat betalningarna som du har importerat med bankutdragsfilen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BankAccReconciliation."Statement Ending Balance";
                AutoFormatType=1;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      BankAccReconciliation@1000 : Record 273;
      AppliedPmtEntry@1007 : Record 1294;
      TempGenJournalLine@1009 : TEMPORARY Record 81;
      MatchDetails@1002 : Text;
      PmtAppliedToTxt@1003 : TextConst '@@@="%1=integer value for number of entries";ENU=The payment has been applied to %1 entries.;NOR=Betalingen er utlignet mot %1 poster.;SVE=Betalningen har kopplats till %1 transaktioner.';
      IsBankAccReconInitialized@1004 : Boolean;
      StatementToRemAmtDifference@1005 : Decimal;
      FinanceChargeMemoEnabled@1001 : Boolean;
      RemainingAmountAfterPosting@1006 : Decimal;
      RemoveExistingApplicationsQst@1008 : TextConst 'ENU=When you run the Apply Automatically action, it will undo all previous applications.\\Do you want to continue?;NOR=NÜr du utfõrer handlingen Utlign automatisk, tilbakestilles alle tidligere utligninger.\\Vil du fortsette?;SVE=NÑr du kîr ÜtgÑrden Koppla automatiskt Üngras alla tidigare kopplingar.\\Vill du fortsÑtta?';
      BalanceAfterPostingStyleExpr@1010 : Text;
      PageMustCloseMsg@1011 : TextConst 'ENU=The Payment Reconciliation Journal window has been closed because the connection was suspended.;NOR=Vinduet Betalingsavstemmingskladd ble lukket fordi tilkoblingen ble brutt.;SVE=Fînstret UtbetalningsavstÑmningsjournal har stÑngts eftersom anslutningen brîts.';
      PageClosedByPosting@1012 : Boolean;
      OutstandingTransactions@1015 : Decimal;
      OutstandingPayments@1014 : Decimal;
      ShortcutDimCode@1013 : ARRAY [8] OF Code[20];
      IsSaasExcelAddinEnabled@1016 : Boolean;
      DimVisible1@1024 : Boolean;
      DimVisible2@1023 : Boolean;
      DimVisible3@1022 : Boolean;
      DimVisible4@1021 : Boolean;
      DimVisible5@1020 : Boolean;
      DimVisible6@1019 : Boolean;
      DimVisible7@1018 : Boolean;
      DimVisible8@1017 : Boolean;
      CannotAddMappingRulesForFIKLinesErr@1060000 : TextConst 'ENU=You cannot use the Map Text to Account function for payments of type FIK.';
      CannotImportFIKLinesErr@1060001 : TextConst 'ENU=You cannot import FIK statement files into this payment reconciliation journal, because it contains journal lines for non-FIK payments.\\Import the FIK statement file into a payment reconciliation journal that is empty or contains lines for other FIK payments.';
      CannotImportStatementIntoFIKErr@1060002 : TextConst 'ENU=You cannot import bank statement files for non-FIK payments into a payment reconciliation journal that already contains journal lines for FIK payments.';
      DKinfoEnable@1100285500 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateFIKStatus@1060000();
    VAR
      GLSetup@1100285500 : Record 98;
    BEGIN
      IF NOT DKinfoEnable THEN BEGIN
        GLSetup.GET;
        DKinfoEnable := GLSetup."Danish Localization Active";
      END;

      IF NOT DKinfoEnable THEN EXIT;
      //NAVDK
      IF BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.") THEN
        IF COUNT = 0 THEN BEGIN
          BankAccReconciliation."FIK Payment Reconciliation" := FALSE;
          BankAccReconciliation.MODIFY;
        END;
    END;

    LOCAL PROCEDURE UpdateSorting@4(IsAscending@1003 : Boolean);
    VAR
      BankAccReconciliationLine@1005 : Record 274;
      PaymentMatchingDetails@1000 : Record 1299;
      AppliedPaymentEntry2@1002 : Record 1294;
      AmountDifference@1001 : Decimal;
      ScoreRange@1004 : Integer;
      SubscriberInvoked@1006 : Boolean;
    BEGIN
      BankAccReconciliationLine.SETRANGE("Statement Type","Statement Type");
      BankAccReconciliationLine.SETRANGE("Bank Account No.","Bank Account No.");
      BankAccReconciliationLine.SETRANGE("Statement No.","Statement No.");
      BankAccReconciliationLine.SETAUTOCALCFIELDS("Match Confidence");

      IF BankAccReconciliationLine.FINDSET THEN BEGIN
        REPEAT
          ScoreRange := 10000;
          BankAccReconciliationLine."Sorting Order" := BankAccReconciliationLine."Match Confidence" * ScoreRange;

          // Update sorting for same match confidence based onother criteria
          GetAppliedPmtData(AppliedPaymentEntry2,RemainingAmountAfterPosting,AmountDifference,PmtAppliedToTxt);

          ScoreRange := ScoreRange / 10;
          IF AmountDifference <> 0 THEN
            BankAccReconciliationLine."Sorting Order" -= ScoreRange;

          ScoreRange := ScoreRange / 10;
          IF Difference <> 0 THEN
            BankAccReconciliationLine."Sorting Order" -= ScoreRange;

          ScoreRange := ScoreRange / 10;
          IF PaymentMatchingDetails.MergeMessages(Rec) <> '' THEN
            BankAccReconciliationLine."Sorting Order" -= ScoreRange;

          BankAccReconciliationLine.MODIFY;
        UNTIL BankAccReconciliationLine.NEXT = 0;

        OnUpdateSorting(BankAccReconciliation,SubscriberInvoked);

        //NAVDK
        IF  BankAccReconciliation."FIK Payment Reconciliation" THEN
          SETCURRENTKEY("Sorting Order","Transaction Text")
        ELSE

          IF NOT SubscriberInvoked THEN
            SETCURRENTKEY("Sorting Order");
        ASCENDING(IsAscending);

        CurrPage.UPDATE(FALSE);
        FINDFIRST;
      END;
    END;

    LOCAL PROCEDURE InvokePost@2(OnlyPayments@1000 : Boolean);
    VAR
      BankAccReconciliation@1001 : Record 273;
      BankAccReconPostYesNo@1002 : Codeunit 371;
    BEGIN
      BankAccReconciliation.GET("Statement Type","Bank Account No.","Statement No.");
      BankAccReconciliation."Post Payments Only" := OnlyPayments;

      IF BankAccReconPostYesNo.BankAccReconPostYesNo(BankAccReconciliation) THEN BEGIN
        RESET;
        PageClosedByPosting := TRUE;
        CurrPage.CLOSE;
      END;
    END;

    LOCAL PROCEDURE UpdateBalanceAfterPostingStyleExpr@3();
    BEGIN
      WITH BankAccReconciliation DO
        IF "Total Balance on Bank Account" + "Total Unposted Applied Amount" <> "Statement Ending Balance" THEN
          BalanceAfterPostingStyleExpr := 'Unfavorable'
        ELSE
          BalanceAfterPostingStyleExpr := 'Favorable';
    END;

    LOCAL PROCEDURE TestIfFiltershaveBeenRemovedWithRefreshAndClose@5();
    BEGIN
      FILTERGROUP := 2;
      IF NOT PageClosedByPosting THEN
        IF GETFILTER("Bank Account No.") + GETFILTER("Statement Type") + GETFILTER("Statement No.") = '' THEN BEGIN
          MESSAGE(PageMustCloseMsg);
          CurrPage.CLOSE;
        END;
      FILTERGROUP := 0;
    END;

    LOCAL PROCEDURE SetDimensionsVisibility@6();
    VAR
      DimMgt@1000 : Codeunit 408;
    BEGIN
      DimVisible1 := FALSE;
      DimVisible2 := FALSE;
      DimVisible3 := FALSE;
      DimVisible4 := FALSE;
      DimVisible5 := FALSE;
      DimVisible6 := FALSE;
      DimVisible7 := FALSE;
      DimVisible8 := FALSE;

      DimMgt.UseShortcutDims(
        DimVisible1,DimVisible2,DimVisible3,DimVisible4,DimVisible5,DimVisible6,DimVisible7,DimVisible8);

      CLEAR(DimMgt);
    END;

    [Integration]
    PROCEDURE OnAtActionApplyAutomatically@1(BankAccReconciliation@1000 : Record 273;VAR SubscriberInvoked@1001 : Boolean);
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnUpdateSorting@7(BankAccReconciliation@1001 : Record 273;VAR SubscriberInvoked@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnAfterImportBankTransactions@9(VAR SubscriberInvoked@1000 : Boolean;VAR BankAccReconciliationLine@1001 : Record 274);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterValidateShortcutDimCode@10(VAR BankAccReconciliationLine@1000 : Record 274;VAR ShortcutDimCode@1001 : ARRAY [8] OF Code[20];DimIndex@1002 : Integer);
    BEGIN
    END;

    BEGIN
    END.
  }
}

