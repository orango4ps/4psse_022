OBJECT Page 11125678 Estimate RAW Card
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Kalkulation RAW;
               ENU=Estimate (RAW) Card;
               NLD=Calculatie (RAW)];
    SourceTable=Table11012151;
    SourceTableView=WHERE(RAW Estimate=CONST(Yes));
    PageType=Card;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 EstSetup.GET;
                 IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN
                   RateEditable := TRUE
                 ELSE
                   RateEditable := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       SETRANGE("No.");
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  "RAW Estimate" := TRUE;
                  CheckEstimateTemplate;  //DP02264
                  InitRecord;
                END;

    OnInsertRecord=VAR
                     xRecRef@1100525000 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnAfterGetCurrRecord=VAR
                           RecRef@1100525000 : RecordRef;
                         BEGIN
                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(FALSE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");
                           CheckEstEditable;  //C043451
                         END;

    ActionList=ACTIONS
    {
      { 1100525104;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525105;1 ;ActionGroup;
                      CaptionML=[DEU=Kalkulation;
                                 ENU=&Estimate;
                                 NLD=&Calculatie<Undefined>;
                                 NOR=&Kalkyle;
                                 SVE=&Kalkyl] }
      { 1100525106;2 ;Action    ;
                      Name=Comments;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments;
                                 NLD=Op&merkingen;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Estimate),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1100525107;2 ;Action    ;
                      Name=Rates;
                      CaptionML=[DEU=&Tarife;
                                 ENU=&Rates;
                                 NLD=&Tarieven;
                                 NOR=&Avgifter;
                                 SVE=&Avgifter];
                      Image=AdjustItemCost;
                      OnAction=VAR
                                 EstimateRateList@1100525000 : Page 11125699;
                                 EstimateRate@1100525001 : Record 11012160;
                               BEGIN
                                 EstimateRate.SETRANGE(EstimateRate."Estimate No.","No.");
                                 EstimateRateList.SETTABLEVIEW(EstimateRate);
                                 EstimateRateList.RUNMODAL();
                                 UpdateContractAmount; //RAW
                               END;
                                }
      { 1100525108;2 ;Action    ;
                      Name=Purchase Actions;
                      CaptionML=[DEU=Einkaufsmarkierungen;
                                 ENU=Purchase Actions;
                                 NLD=Inkoopacties;
                                 NOR=Innkjõpshandlinger;
                                 SVE=InkîpsÜtgÑrder];
                      RunObject=Page 11072274;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Image=OrderTracking }
      { 1100525109;2 ;Action    ;
                      Name=Documents;
                      CaptionML=[DEU=&Belege;
                                 ENU=Do&cuments;
                                 NLD=Do&cumenten;
                                 NOR=Do&kumenter;
                                 SVE=Do&kument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                                 DocumentFilters@1100525000 : Codeunit 11012432;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1100525110;2 ;Action    ;
                      Name=VAT Specifications;
                      CaptionML=[DEU=MwSt.-Spezifikationen;
                                 ENU=VAT Specifications;
                                 NLD=BTW-specficaties];
                      Image=SetupList;
                      OnAction=VAR
                                 VatSpecRec@1100525001 : Record 11125678;
                                 TmpVatSpecRec@1100525000 : TEMPORARY Record 11125678;
                               BEGIN
                                 VatSpecRec.SETRANGE("Estimate No.", "No.");
                                 IF VatSpecRec.FINDSET THEN BEGIN
                                   REPEAT
                                     TmpVatSpecRec.COPY(VatSpecRec);
                                     TmpVatSpecRec."Tender Paragraph No." := '';
                                     IF TmpVatSpecRec.INSERT THEN;
                                   UNTIL VatSpecRec.NEXT = 0;
                                 END;
                                 TmpVatSpecRec.SETRANGE("Tender Paragraph No.", '');
                                 PAGE.RUNMODAL(0, TmpVatSpecRec);
                               END;
                                }
      { 1100525088;2 ;Action    ;
                      Name=Rooms;
                      CaptionML=[DEU=KalkulationsrÑume;
                                 ENU=Estimate Rooms;
                                 NLD=Calculatieruimten];
                      RunObject=Page 11126867;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Image=Warehouse }
      { 1100525082;1 ;Action    ;
                      Name=Estimate Surcharges;
                      CaptionML=[DEU=KalkulationszuschÑge;
                                 ENU=Estimate Surcharges;
                                 NLD=Calculatietoeslagen];
                      RunObject=Page 11020563;
                      RunPageView=WHERE(Estimate No.=FILTER(<>''));
                      RunPageLink=Estimate No.=FIELD(No.);
                      Promoted=Yes;
                      Image=InsertStartingFee;
                      PromotedCategory=Process;
                      RunPageMode=Edit }
      { 1100525138;1 ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[DEU=Statistik;
                                 ENU=Statistics;
                                 NLD=Statistieken;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      RunObject=Page 11125758;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1100528505;1 ;Action    ;
                      Name=To-dos;
                      CaptionML=[DEU=Aufgaben;
                                 ENU=To-dos;
                                 NLD=Taken];
                      RunObject=Page 5096;
                      RunPageView=SORTING(Estimate No. RAW,Date,Closed);
                      RunPageLink=Estimate No. RAW=FIELD(No.),
                                  System To-do Type=CONST(Organizer);
                      Visible=FALSE;
                      Image=NewToDo }
      { 1100529501;1 ;ActionGroup;
                      CaptionML=[DEU=SH;
                                 ENU=SH;
                                 NLD=VG];
                      Image=Alerts }
      { 1100529500;2 ;Action    ;
                      CaptionML=[DEU=StandardarbeitsplÑne;
                                 ENU=Standard Workplans;
                                 NLD=Standaard werkplannen;
                                 SVE=Standardarbetsplaner];
                      Image=PlanningWorksheet;
                      OnAction=VAR
                                 SHWorkplan@1100528300 : Record 11126011;
                               BEGIN
                                 SHWorkplan.FILTERGROUP(9);
                                 SHWorkplan.SETRANGE("Source Type", SHWorkplan."Source Type"::Estimate);
                                 SHWorkplan.SETRANGE("Source Code", "No.");
                                 SHWorkplan.FILTERGROUP(9);
                                 PAGE.RUNMODAL(PAGE::"SH Standard Workplans", SHWorkplan);
                               END;
                                }
      { 1100525111;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100525133;1 ;Action    ;
                      Name=StartEstimate;
                      ShortCutKey=Ctrl+E;
                      CaptionML=[DEU=Kalkulation starten;
                                 ENU=Start Estimate;
                                 NLD=Calculeren;
                                 NOR=Kalkyledetaljer;
                                 SVE=Kalkyldetaljer];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Calculate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 StartRAWEstimate; //DP01676
                               END;
                                }
      { 1100525079;1 ;ActionGroup;
                      CaptionML=[DEU=Kopieren;
                                 ENU=Copy;
                                 NLD=Kopiâer;
                                 NOR=KOPIER;
                                 SVE=Kopiera];
                      Image=Copy }
      { 1100525113;2 ;Action    ;
                      Name=CopyEstimatetoProjectBudget;
                      ShortCutKey=F11;
                      Ellipsis=Yes;
                      CaptionML=[DEU=öbertragen Kalkulation in Projekt;
                                 ENU=Copy Estimate to Project Budget;
                                 NLD=Overzetten calculatie naar project;
                                 NOR=Kopier kalkyle til prosjektbudsjett;
                                 SVE=Kopiera kalkyl till projektbudget];
                      RunObject=Page 11125696;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Process }
      { 1100525091;2 ;Action    ;
                      Name=TransferEstimateToService;
                      CaptionML=[DEU=öbertragen Kalkulation in Service;
                                 ENU=Copy Estimate to Service;
                                 NLD=Overzetten calculatie naar service;
                                 NOR=Kopier kalkyle til service;
                                 SVE=Kopiera kalkyl till service];
                      Image=Copy;
                      OnAction=VAR
                                 ServiceSetup@1100528600 : Record 11012800;
                                 FPSLicenseManagement@1100527400 : Codeunit 11229289;
                               BEGIN
                                 IF FPSLicenseManagement.LicenseAndReadPermissionForTable(ServiceSetup) THEN
                                   ServiceSetup.GET;

                                 PAGE.RUN(PAGE::"Transfer Estimate-Service RAW", Rec);  //DP01585
                               END;
                                }
      { 1100525114;2 ;Action    ;
                      Name=Copy Estimate;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Kopieren Kalkulation;
                                 ENU=Copy Estimate;
                                 NLD=Calculatie kopiâren;
                                 NOR=Kopier kalkyle;
                                 SVE=Kopiera kalkyl];
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 StartCopyEstimate(TRUE);  //C027531+C028591 (db, 19-01-16)
                               END;
                                }
      { 1100525080;1 ;ActionGroup;
                      CaptionML=[DEU=Aktualisieren;
                                 ENU=Update;
                                 NLD=Bijwerken;
                                 NOR=Oppdater;
                                 SVE=Uppdatera];
                      Image=RefreshText }
      { 1100525115;2 ;Action    ;
                      Name=Update Norms and Prices;
                      CaptionML=[DEU=Aktualisieren Normen und Preise;
                                 ENU=Update Norms and Prices;
                                 NLD=Actualiseren normen en prijzen;
                                 NOR=Oppdater normer og priser;
                                 SVE=Uppdatera normer och priser];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(1);
                               END;
                                }
      { 1100525116;2 ;Action    ;
                      Name=Adjust Prices with Percentage;
                      CaptionML=[DEU=Aktualisieren Preise mit &Prozentsatz;
                                 ENU=Adjust Prices with &Percentage;
                                 NLD=Bijwerken prijzen met &percentage;
                                 NOR=Juster priser med &prosent;
                                 SVE=Justera priser med &procent];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(2);
                               END;
                                }
      { 1100525090;2 ;Action    ;
                      Name=Update From Selected Quote;
                      CaptionML=[DEU=öbernehmen Einkaufsanfragepreis;
                                 ENU=Update From Selected Quote;
                                 NLD=Overnemen geselecteerde inkoopofferteprijs;
                                 NOR=Oppdater fra valgt tilbud;
                                 SVE=Uppdatera frÜn vald offert];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(4);
                               END;
                                }
      { 1100525117;2 ;Action    ;
                      Name=Update Discount Percentage;
                      CaptionML=[DEU=Aktualisieren RabattprozentsÑtze;
                                 ENU=Update &Discount Percentage;
                                 NLD=Bijwerken &kortingspercentage;
                                 NOR=Oppdater &Rabattprosent;
                                 SVE=Upp&datera rabattprocent];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(3);
                               END;
                                }
      { 1100525118;1 ;Action    ;
                      Name=Substitute Rate collectively;
                      CaptionML=[DEU=Kollektiv ersetzen &Tarif;
                                 ENU=Substitute &Rate collectively;
                                 NLD=Collectief vervangen &tarief;
                                 NOR=Erstatt &Avgift kollektivt;
                                 SVE=ErsÑtt &avgift kollektivt];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(1);
                               END;
                                }
      { 1100525081;1 ;ActionGroup;
                      CaptionML=[DEU=Kalkulation;
                                 ENU=Estimate;
                                 NLD=Calculatie;
                                 NOR=Kalkyle;
                                 SVE=Kalkyl];
                      Image=Calculate }
      { 1100525119;2 ;Action    ;
                      Name=Process Estimate;
                      ShortCutKey=F9;
                      CaptionML=[DEU=Durchrechnen Kalkulation;
                                 ENU=Process Estimate;
                                 NLD=Calculatie doorrekenen;
                                 NOR=Prosseser kalkyle;
                                 SVE=Processkalkyl];
                      Image=CalculatePlan;
                      OnAction=BEGIN
                                 UpdateContractAmount; //RAW
                               END;
                                }
      { 1100525123;2 ;Action    ;
                      Name=Edit Compressed Estimate;
                      CaptionML=[DEU=Komprimieren Kalkulation;
                                 ENU=Edit Compressed Estimate;
                                 NLD=Platslaan calculatie;
                                 NOR=Rediger komprimert kalkyle;
                                 SVE=Redigera komprimerad kalkyl];
                      Image=Compress;
                      OnAction=BEGIN
                                 EstLineRec.SETRANGE("Estimate No.", "No.");
                                 REPORT.RUNMODAL(REPORT::"Select Estimate Lines RAW", TRUE, FALSE, EstLineRec);
                               END;
                                }
      { 1100529503;1 ;ActionGroup;
                      CaptionML=[DEU=SH;
                                 ENU=SH;
                                 NLD=VG];
                      Image=Alerts }
      { 1100529502;2 ;Action    ;
                      CaptionML=[DEU=Standard-Arbeitsplan erstellen;
                                 ENU=Generate Standard Workplan;
                                 NLD=Standaard werkplan aanmaken];
                      Image=PlanningWorksheet;
                      OnAction=VAR
                                 SHCopyManagement@1100528300 : Codeunit 11125987;
                               BEGIN
                                 SHCopyManagement.GenerateStandardWorkplanFromEstimate(Rec);
                               END;
                                }
      { 1100525120;1 ;Action    ;
                      Name=Delete Zero Lines;
                      CaptionML=[DEU=Lîschen Nullzeilen;
                                 ENU=Delete Zero Lines;
                                 NLD=Nulregels verwijderen;
                                 NOR=Fjerne Nullrader;
                                 SVE=Ta bort nollrader];
                      Image=Delete;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(5);
                               END;
                                }
      { 1100525122;1 ;Action    ;
                      Name=Coding Estimate Lines;
                      CaptionML=[DEU=Kodieren Kalkulationszeilen;
                                 ENU=Coding Estimate Lines;
                                 NLD=Calculatieregels afcoderen];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 CheckUncodedLines(1);
                               END;
                                }
      { 1100525124;1 ;Action    ;
                      Name=Exchange Estimates;
                      CaptionML=[DEU=Kalkulationen ersetzen;
                                 ENU=Exchange Estimates;
                                 NLD=Calculaties uitwisselen;
                                 NOR=Utveksle kalkyler;
                                 SVE=Byt kalkyler];
                      RunObject=XMLport 11125666;
                      Image=ImportExport }
      { 1100525125;1 ;Action    ;
                      Name=Export Bid Form Cover Page;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Deckblatt Angebotsformular exportieren;
                                 ENU=Export Bid Form Cover Page;
                                 NLD=Inschrijvingsstaat exporteren;
                                 NOR=Eksporter Vud fra Forside];
                      Image=Export;
                      OnAction=VAR
                                 Estimate@1100525002 : Record 11012151;
                                 EstimateRAWSetup@1100525001 : Record 11125673;
                                 ExportZSU@1100525000 : Report 11125678;
                               BEGIN
                                 // jhoek.210211.begin
                                 Estimate := Rec;
                                 Estimate.SETRECFILTER;

                                 EstimateRAWSetup.GET;
                                 EstimateRAWSetup.TESTFIELD("Default Estimate Export Folder");

                                 ExportZSU.SetFileName(
                                   STRSUBSTNO(
                                     '%1\%2 - %3.zsx',
                                     DELCHR(EstimateRAWSetup."Default Estimate Export Folder", '>', '\'),
                                     Estimate."No.",
                                     Estimate.Description));
                                 ExportZSU.SETTABLEVIEW(Estimate);
                                 ExportZSU.RUNMODAL;
                                 // jhoek.210211.end
                               END;
                                }
      { 1100525126;1 ;Action    ;
                      Name=AdjustActualContractAmountRAW;
                      CaptionML=[DEU=Anpassen wirklichen Vertragspreis (RAW);
                                 ENU=Adjust Actual Contract Amount (RAW);
                                 NLD=Werkelijke aanneemsom (RAW) aanpassen];
                      Image=Edit;
                      OnAction=BEGIN
                                 AdjustContractAmount;  //X001
                               END;
                                }
      { 1100525127;1 ;Action    ;
                      Name=Change Estim. Surcharges (RAW);
                      CaptionML=[DEU=KalkulationszuschlÑge Ñndern (RAW);
                                 ENU=Change Estim. Surcharges (RAW);
                                 NLD=Calculatieopslagen (RAW) wijzigen];
                      Image=InsertStartingFee;
                      OnAction=BEGIN
                                 ChangeSurcharges; // jhoek.090910
                               END;
                                }
      { 1100525128;1 ;Action    ;
                      Name=Estimate Documents;
                      CaptionML=[DEU=Kalkulationsbelege;
                                 ENU=Estimate Documents;
                                 NLD=Calculatiedocumenten;
                                 NOR=Rediger Word-dokument;
                                 SVE=Redigera Word-dokument];
                      Image=Word;
                      OnAction=BEGIN
                                 TESTFIELD("Contact No.");
                                 EditDocuments("Contact No.", "Contact Person No.", FALSE, '');
                               END;
                                }
      { 1100525129;  ;ActionContainer;
                      ActionContainerType=Reports }
      { 1100525130;1 ;Action    ;
                      Name=Estimate Reports;
                      CaptionML=[DEU=Berichte kalkulieren;
                                 ENU=Estimate Reports;
                                 NLD=Rapporten &Calculatie];
                      Image=Report;
                      OnAction=VAR
                                 Estimate@1100525001 : Record 11012151;
                                 PrintDoc@1100525000 : Codeunit 229;
                               BEGIN
                                 Estimate."No." := "No.";
                                 PrintDoc.PrintEstimateRAW(Estimate);  //C035887
                               END;
                                }
      { 1100525131;1 ;Action    ;
                      Name=Bid Form;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Angebotsformular;
                                 ENU=Bid Form;
                                 NLD=Inschrijvingsbiljet];
                      Image=Report;
                      OnAction=VAR
                                 Estimate@1100525001 : Record 11012151;
                                 PrintDoc@1100525000 : Codeunit 229;
                               BEGIN
                                 Estimate."No." := "No.";
                                 PrintDoc.PrintBidFormRAW(Estimate);
                               END;
                                }
      { 1100525132;1 ;Action    ;
                      Name=Bid Form Cover Page;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Angebotsliste;
                                 ENU=Bid Form Cover Page;
                                 NLD=Inschrijvingsstaat];
                      Image=Report;
                      OnAction=VAR
                                 Estimate@1100525001 : Record 11012151;
                                 PrintDoc@1100525000 : Codeunit 229;
                               BEGIN
                                 Estimate."No." := "No.";
                                 PrintDoc.PrintBidFormCoverPageRAW(Estimate);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1100525000;0;Container;
                ContainerType=ContentArea }

    { 1100525001;1;Group  ;
                Name=General;
                CaptionML=[DEU=Allgemein;
                           ENU=General;
                           NLD=Algemeen;
                           NOR=Generell;
                           SVE=AllmÑnt];
                GroupType=Group }

    { 1100525002;2;Field  ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1100525003;2;Field  ;
                SourceExpr=Description;
                Importance=Promoted }

    { 1100525004;2;Field  ;
                SourceExpr="Description 2";
                Importance=Additional }

    { 1100525005;2;Field  ;
                SourceExpr=Address }

    { 1100525006;2;Field  ;
                SourceExpr="Post Code" }

    { 1100525007;2;Field  ;
                SourceExpr=City }

    { 1100525008;2;Field  ;
                SourceExpr="Country/Region Code";
                Importance=Additional }

    { 1100525009;2;Field  ;
                SourceExpr=Estimator;
                Importance=Additional;
                OnValidate=BEGIN
                             CALCFIELDS("Name Estimator");
                           END;
                            }

    { 1100525010;2;Field  ;
                SourceExpr="Name Estimator";
                Importance=Additional }

    { 1100525011;2;Field  ;
                SourceExpr="Purchaser Code";
                Importance=Additional }

    { 1100525012;2;Field  ;
                SourceExpr="Purchaser Name";
                Importance=Additional }

    { 1100525013;2;Field  ;
                SourceExpr="Consultancy Firm No.";
                Importance=Additional;
                OnValidate=BEGIN
                             CALCFIELDS("Consultancy Firm Name");
                           END;
                            }

    { 1100525014;2;Field  ;
                SourceExpr="Consultancy Firm Name";
                Importance=Additional }

    { 1100525015;2;Field  ;
                SourceExpr="Contact No.";
                OnValidate=BEGIN
                             EvaluateRelation;
                           END;
                            }

    { 1100525016;2;Field  ;
                SourceExpr="Contact Name";
                Importance=Additional }

    { 1100525017;2;Field  ;
                SourceExpr="Contact Person No.";
                OnValidate=BEGIN
                             CALCFIELDS("Contact Person Name");
                           END;
                            }

    { 1100525018;2;Field  ;
                SourceExpr="Contact Person Name";
                Importance=Additional }

    { 1100525019;2;Field  ;
                SourceExpr="Customer No.";
                OnValidate=BEGIN
                             EvaluateRelation;
                           END;
                            }

    { 1100525020;2;Field  ;
                SourceExpr="Customer Name";
                Importance=Additional }

    { 1100525021;2;Field  ;
                SourceExpr="Customer Disc. Group";
                Importance=Additional }

    { 1100525022;2;Field  ;
                SourceExpr="Construction Spec. No.";
                Importance=Promoted }

    { 1100525023;2;Field  ;
                SourceExpr="Construction Spec. No. (Cust.)" }

    { 1100528902;2;Field  ;
                SourceExpr="Construction Spec. No. (Note)" }

    { 1100525024;2;Field  ;
                SourceExpr="Order No. Customer" }

    { 1100525025;2;Field  ;
                SourceExpr="Search Name" }

    { 1100525026;2;Field  ;
                SourceExpr="Territory Code" }

    { 1100525027;2;Field  ;
                SourceExpr=Type;
                Importance=Additional }

    { 1100525028;2;Field  ;
                SourceExpr=Discipline;
                Importance=Additional }

    { 1100525029;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1100525030;2;Field  ;
                SourceExpr=Status }

    { 1100525031;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1100525032;1;Group  ;
                Name=Data;
                CaptionML=[DEU=Daten;
                           ENU=Data;
                           NLD=Data;
                           NOR=Data;
                           SVE=Data];
                GroupType=Group }

    { 1100525033;2;Field  ;
                SourceExpr="Creation Date" }

    { 1100525034;2;Field  ;
                SourceExpr="Last Date Modified" }

    { 1100525035;2;Field  ;
                SourceExpr="Modified by" }

    { 1100525036;2;Field  ;
                SourceExpr="Starting Date" }

    { 1100525037;2;Field  ;
                SourceExpr="Ending Date" }

    { 1100529900;2;Field  ;
                SourceExpr="Register Date" }

    { 1100525137;2;Field  ;
                SourceExpr="Tender Date";
                Importance=Promoted }

    { 1100529901;2;Field  ;
                SourceExpr="Information Note Date" }

    { 1100529902;2;Field  ;
                SourceExpr="Information Note Time" }

    { 1100525136;2;Field  ;
                SourceExpr="Expected Est. Completion Date";
                Importance=Promoted }

    { 1100525038;2;Field  ;
                SourceExpr="Reference Date (Rate)" }

    { 1100525039;2;Field  ;
                SourceExpr="Reference Date (Item)";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001)THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100525040;2;Field  ;
                SourceExpr="Reference Date (Company)";
                Importance=Additional }

    { 1100525041;2;Field  ;
                SourceExpr="Reference Date (Customer)";
                Importance=Additional }

    { 1100525042;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 0";
                Importance=Additional }

    { 1100525043;2;Field  ;
                SourceExpr="Purch Discount Term Group 1";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100525044;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 1";
                Importance=Additional }

    { 1100525045;2;Field  ;
                SourceExpr="Purch Discount Term Group 2";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001)THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100525046;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 2";
                Importance=Additional }

    { 1100525049;2;Field  ;
                SourceExpr="Sales Discount Term Group 1";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100525094;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 1";
                Importance=Additional }

    { 1100525047;2;Field  ;
                SourceExpr="Sales Discount Term Group 2";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001)THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100525048;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 2";
                Importance=Additional }

    { 1100528504;2;Field  ;
                SourceExpr="Subcontracting in Hours" }

    { 1100525084;2;Field  ;
                SourceExpr="Plant Rates in Hours" }

    { 1100529400;2;Field  ;
                SourceExpr="Plant Company" }

    { 1100525083;2;Field  ;
                SourceExpr="Plant Location";
                Importance=Promoted;
                OnLookup=BEGIN
                           LookupPlantLocation;  //DP02115
                         END;
                          }

    { 1100525065;2;Field  ;
                SourceExpr="Kind of Plant Rate" }

    { 1100525050;1;Group  ;
                Name=Other;
                CaptionML=[DEU=öbriges;
                           ENU=Other;
                           NLD=Overig;
                           NOR=ùvrige;
                           SVE=ôvriga];
                GroupType=Group }

    { 1100525051;2;Field  ;
                SourceExpr="Rate Group";
                Importance=Additional;
                Editable=RateEditable }

    { 1100525052;2;Field  ;
                SourceExpr="Rate Code";
                OnLookup=BEGIN
                           LookupRateListRAW;
                         END;
                          }

    { 1100525053;2;Field  ;
                SourceExpr="Norm Group";
                Importance=Additional }

    { 1100525086;2;Field  ;
                CaptionML=[DEU=Arbeitskataloggruppe;
                           ENU=Constr. Spec. Activity Group;
                           NLD=Werkcatalogusgroep];
                SourceExpr="Part Group" }

    { 1100525092;2;Field  ;
                SourceExpr="Recipe Group" }

    { 1100525054;2;Field  ;
                SourceExpr="Coding System";
                Importance=Additional }

    { 1100525055;2;Field  ;
                SourceExpr=Code;
                Importance=Additional }

    { 1100528503;2;Field  ;
                SourceExpr="Preferred Supplier" }

    { 1100528502;2;Field  ;
                SourceExpr="Name Vendor";
                Importance=Additional }

    { 1100528501;2;Field  ;
                SourceExpr="Vendor (Trade Item)";
                Importance=Additional }

    { 1100525056;2;Field  ;
                SourceExpr="Project No.";
                Importance=Additional }

    { 1100525057;2;Field  ;
                SourceExpr=Element;
                Importance=Additional }

    { 1100525058;2;Field  ;
                SourceExpr="Project Planning Activity Code";
                Importance=Additional }

    { 1100525121;2;Field  ;
                SourceExpr="Service Order No.";
                Importance=Additional }

    { 1100525112;2;Field  ;
                SourceExpr="Service Contract No.";
                Importance=Additional;
                OnLookup=BEGIN
                           LookupServiceContract;  //db, 24-10-08
                         END;
                          }

    { 1100525093;2;Field  ;
                SourceExpr="Service Location No.";
                Importance=Additional;
                OnLookup=BEGIN
                           LookupServiceLocation;
                         END;
                          }

    { 1100525059;2;Field  ;
                SourceExpr="Estimate Source";
                Importance=Additional;
                OnLookup=BEGIN
                           HandleLookupEstimate;
                         END;
                          }

    { 1100525063;2;Field  ;
                SourceExpr=Finished }

    { 1100525064;2;Field  ;
                SourceExpr=Fixed;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             CheckEstEditable;  //C043451
                           END;
                            }

    { 1100525087;2;Field  ;
                CaptionML=[DEU=Kopieren Arbeitskatalogzeilen;
                           ENU=Copy Constr. Spec. Activity Lines;
                           NLD=Kopiâren werkcatalogusregels];
                SourceExpr="Copy Part Lines" }

    { 1100525061;1;Group  ;
                Name=RAW;
                CaptionML=[DEU=RAW;
                           ENU=RAW;
                           NLD=RAW];
                GroupType=Group }

    { 1100528901;2;Field  ;
                SourceExpr="Summary Cost (RAW)";
                Editable=FixedOff }

    { 1100528900;2;Field  ;
                SourceExpr="Percentage (Discount)";
                Editable=FixedOff;
                OnValidate=BEGIN
                             //DP01488
                             UpdateContractAmount;
                           END;
                            }

    { 1100525062;2;Field  ;
                SourceExpr="Percentage (GeneralCost)";
                Editable=FixedOff;
                OnValidate=BEGIN
                             UpdateContractAmount;
                           END;
                            }

    { 1100525089;2;Field  ;
                SourceExpr="Percentage (ExecutionCost)";
                Editable=FixedOff;
                OnValidate=BEGIN
                             //DP01486
                             UpdateContractAmount;
                           END;
                            }

    { 1100525085;2;Field  ;
                SourceExpr="Percentage (Profit/Risk)";
                Editable=FixedOff;
                OnValidate=BEGIN
                             UpdateContractAmount;
                           END;
                            }

    { 1100525066;2;Field  ;
                SourceExpr="Surcharge % Labor";
                Editable=FixedOff;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100525067;2;Field  ;
                SourceExpr="Surcharge % Material";
                Editable=FixedOff;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100525068;2;Field  ;
                SourceExpr="Surcharge % Subcontracting";
                Editable=FixedOff;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100525069;2;Field  ;
                SourceExpr="Surcharge % Plant";
                Editable=FixedOff;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100525070;2;Field  ;
                SourceExpr="Contractor Name";
                Importance=Additional }

    { 1100525071;2;Field  ;
                SourceExpr="Contractor Address";
                Importance=Additional }

    { 1100525072;2;Field  ;
                SourceExpr="Contractor City";
                Importance=Additional }

    { 1100525073;2;Field  ;
                SourceExpr="Contractor 2 Name";
                Importance=Additional }

    { 1100525074;2;Field  ;
                SourceExpr="Contractor 2 Address";
                Importance=Additional }

    { 1100525075;2;Field  ;
                SourceExpr="Contractor 2 City";
                Importance=Additional }

    { 1100525076;2;Field  ;
                SourceExpr="Contractor 3 Name";
                Importance=Additional }

    { 1100525077;2;Field  ;
                SourceExpr="Contractor 3 Address";
                Importance=Additional }

    { 1100525078;2;Field  ;
                SourceExpr="Contractor 3 City";
                Importance=Additional }

    { 1100525097;0;Container;
                ContainerType=FactBoxArea }

    { 1100525135;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100528500;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130167;
                PartType=Page }

    { 1100525098;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11125749;
                PartType=Page }

    { 1100525099;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11125750;
                PartType=Page }

    { 1100525100;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11125751;
                PartType=Page }

    { 1100525101;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11125752;
                Visible=FALSE;
                PartType=Page }

    { 1100527000;1;Part   ;
                CaptionML=[DEU=Bemerkungen;
                           ENU=Comments;
                           NLD=Opmerkingen;
                           NOR=Merknader;
                           SVE=Kommentar];
                SubPageLink=Table Name=CONST(Estimate),
                            No.=FIELD(No.);
                PagePartID=Page11072482;
                Editable=FALSE;
                PartType=Page }

    { 1100525103;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100525102;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      EstSetup@1100525012 : Record 11012150;
      EstRec@1100525011 : Record 11012151;
      EstLineRec@1100525009 : Record 11125698;
      PrintDoc@1100525006 : Codeunit 229;
      RateEditable@1100525003 : Boolean INDATASET;
      DPA_IsHardFilter@1100525002 : Boolean;
      Text001@1100525013 : TextConst 'DEU=Mîchten Sie die Preise aktualisieren?;ENU=Do you want to actualize prices ?;NLD=Wilt u prijzen actualiseren ?;NOR=Vil du aktualisere priser?;SVE=Vill du fîrverkliga priser?';
      FixedOff@1100528900 : Boolean;

    PROCEDURE CheckUncodedLines@1210190000(lvAction@1210190000 : Integer);
    VAR
      lvEstLineRec@1100525000 : Record 11125698;
    BEGIN
      IF lvAction = 1 THEN BEGIN
        WITH EstLineRec DO BEGIN
          SETRANGE("Estimate No.", "No.");

          SETRANGE("Uncoded Labor", TRUE);
          MODIFYALL("Uncoded Labor", FALSE);
          SETRANGE("Uncoded Labor");

          SETRANGE("Uncoded Material", TRUE);
          MODIFYALL("Uncoded Material", FALSE);
          SETRANGE("Uncoded Material");

          SETRANGE("Uncoded Subcontracting", TRUE);
          MODIFYALL("Uncoded Subcontracting", FALSE);
          SETRANGE("Uncoded Subcontracting");

          SETRANGE("Uncoded Plant", TRUE);
          MODIFYALL("Uncoded Plant", FALSE);
          SETRANGE("Uncoded Plant");

          SETRANGE("Uncoded Sundry", TRUE);
          MODIFYALL("Uncoded Sundry", FALSE);
          SETRANGE("Uncoded Sundry");

          IF FINDSET(TRUE, FALSE) THEN BEGIN
            REPEAT
              //DP01676.sn
              IF ("Cost Object" = '') AND ("Labor Amount" <> 0) THEN
                 "Uncoded Labor" := TRUE;
              IF ("Cost Object" = '') AND ("Material Amount" <> 0) THEN
                "Uncoded Material" := TRUE;
              IF ("Cost Object" = '') AND ("Subcontracting Amount" <> 0) THEN
                "Uncoded Subcontracting" := TRUE;
              IF ("Cost Object" = '') AND ("Plant Amount" <> 0) THEN
                "Uncoded Plant" := TRUE;
              IF ("Cost Object" = '') AND ("Sundry Amount" <> 0) THEN
                "Uncoded Sundry" := TRUE;
              //DP01676.en

              IF "Uncoded Labor" OR "Uncoded Material" OR "Uncoded Subcontracting" OR "Uncoded Plant" OR "Uncoded Sundry" THEN
                "Uncoded Line" := TRUE
              ELSE
                "Uncoded Line" := FALSE;
              MODIFY;

            UNTIL NEXT = 0;
          END;
          COMMIT;

          lvEstLineRec.SETRANGE("Estimate No.","No.");
          PAGE.RUNMODAL(PAGE::"Uncoded Estimate Lines RAW",lvEstLineRec);

          SETRANGE("Uncoded Labor", TRUE);
          MODIFYALL("Uncoded Labor", FALSE);
          SETRANGE("Uncoded Labor");

          SETRANGE("Uncoded Material", TRUE);
          MODIFYALL("Uncoded Material", FALSE);
          SETRANGE("Uncoded Material");

          SETRANGE("Uncoded Subcontracting", TRUE);
          MODIFYALL("Uncoded Subcontracting", FALSE);
          SETRANGE("Uncoded Subcontracting");

          SETRANGE("Uncoded Plant", TRUE);
          MODIFYALL("Uncoded Plant", FALSE);
          SETRANGE("Uncoded Plant");

          SETRANGE("Uncoded Sundry", TRUE);
          MODIFYALL("Uncoded Sundry", FALSE);
          SETRANGE("Uncoded Sundry");

          COMMIT;
        END;
      END;
    END;

    PROCEDURE SetfilterEstimate@1100485000(lvEst@1210190000 : Code[20]);
    BEGIN
      FILTERGROUP(2);
      SETRANGE("No.",lvEst);
      FILTERGROUP(0);
    END;

    PROCEDURE ActivateUpdateFunctions@1100485001(lvAction@1100485000 : Integer);
    VAR
      EstUpdate@1100485001 : Report 11125668;
    BEGIN
      EstUpdate.FillDefaults("No.", lvAction);
      EstLineRec.SETRANGE("Estimate No.", "No.");
      EstUpdate.SETTABLEVIEW(EstLineRec);
      EstUpdate.RUNMODAL;
      CLEAR(EstUpdate);
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE ActivateReplaceFunctions@1100525000(lvAction@1100485000 : Integer);
    VAR
      EstReplace@1100485001 : Report 11125669;
    BEGIN
      EstReplace.FillDefaults("No.", lvAction);
      EstLineRec.SETRANGE("Estimate No.", "No.");
      EstReplace.SETTABLEVIEW(EstLineRec);
      EstReplace.RUNMODAL;
      CLEAR(EstReplace);
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE EvaluateRelation@1100525002();
    BEGIN
      CurrPage.SAVERECORD;
      CheckRateConditions;
      GET("No.");  //read current record (may changed after previous function); avoid sql-error
      CurrPage.UPDATE;
    END;

    PROCEDURE UpdateContractAmount@1100525001();
    VAR
      RecalcRAWEstimateRecur@1100525000 : Codeunit 11125669;
    BEGIN
      CurrPage.SAVERECORD;
      RecalcRAWEstimateRecur.RecalculateEstimateRAW("No.");
      GET("No.");
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE ChangeSurcharges@1100525003();
    VAR
      Estimate@1100525000 : Record 11012151;
    BEGIN
      Estimate := Rec;
      Estimate.SETRECFILTER;
      PAGE.RUNMODAL(PAGE::"Change Estimate Surcharges RAW", Estimate);
      CurrPage.UPDATE;
    END;

    PROCEDURE AdjustContractAmount@1210190001();
    VAR
      EstRec@1210190001 : Record 11012151;
      AdjustRep@1100525000 : Report 11125674;
    BEGIN
      EstRec.SETRANGE("No.", "No.");
      AdjustRep.SETTABLEVIEW(EstRec);
      AdjustRep.SetSelection("No.");
      AdjustRep.RUNMODAL;
    END;

    LOCAL PROCEDURE HandleLookupEstimate@1100525004();
    VAR
      Estimate@1100525000 : Record 11012151;
    BEGIN
      Estimate.SETRANGE("RAW Estimate", "RAW Estimate");
      IF PAGE.RUNMODAL(0, Estimate) = ACTION::LookupOK THEN
        "Estimate Source" := Estimate."No.";
    END;

    LOCAL PROCEDURE LookupRateListRAW@1100525005();
    VAR
      EstimateRate@1100525000 : Record 11012160;
    BEGIN
      EstimateRate.SETRANGE("Estimate No.", "No.");
      EstimateRate."Rate Code" := "Rate Code";
      IF PAGE.RUNMODAL(PAGE::"Estimate Rate List RAW", EstimateRate) = ACTION::LookupOK THEN
        "Rate Code" := EstimateRate."Rate Code" ;
    END;

    PROCEDURE CheckEstEditable@3();
    BEGIN
      //C043451
      FixedOff := NOT Fixed;
    END;

    LOCAL PROCEDURE CheckEstimateTemplate@1100528902();
    VAR
      EstimateTemplate@1100528900 : Record 11229776;
    BEGIN
      //DP02264
      IF ApplyEstimateTemplate(EstimateTemplate) THEN
        "Estimate Template Code" := EstimateTemplate.Code;
    END;

    BEGIN
    END.
  }
}

