OBJECT Table 11072039 Segment Header
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.03,4PS14.00 (5076);
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Description;
    OnInsert=BEGIN
               IF "No." = '' THEN BEGIN
                 RMSetup.GET;
                 RMSetup.TESTFIELD("Segment Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."Segment Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;

               IF "Salesperson Code" = '' THEN
                 SetDefaultSalesperson;

               Date := WORKDATE;
             END;

    OnDelete=VAR
               SegHist@1000 : Record 11072041;
               SegCriteriaLine@1001 : Record 11072048;
               SegInteractLanguage@1002 : Record 5104;
             BEGIN
               SegCriteriaLine.SETRANGE("Segment No.","No.");
               SegCriteriaLine.DELETEALL; // Must be deleted first!
               SegHist.SETRANGE("Segment No.","No.");
               // SegHist.DELETEALL;  //**4PS.o
               SegHist.DELETEALL(TRUE);  //**4PS.n
               SegInteractLanguage.SETRANGE("Segment No.","No.");
               SegInteractLanguage.DELETEALL(TRUE);

               SegLine.SETRANGE("Segment No.","No.");
               SegLine.DELETEALL(TRUE);

               GET("No.");
             END;

    CaptionML=[DEU=Segmentskopf;
               ENU=Segment Header;
               NLD=Segmentkop;
               NOR=Segmenthode;
               SVE=Segmenthuvud];
    LookupPageID=Page11072065;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."Segment Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Nr.;
                                                              ENU=No.;
                                                              NLD=Nr.;
                                                              NOR=Nr.;
                                                              SVE=Nr] }
    { 2   ;   ;Description         ;Text100       ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO(Description),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Beschreibung;
                                                              ENU=Description;
                                                              NLD=Omschrijving;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 3   ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Campaign No."),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Kampagnennr.;
                                                              ENU=Campaign No.;
                                                              NLD=Campagnenr.;
                                                              NOR=Kampanjenr.;
                                                              SVE=Kampanjnr] }
    { 4   ;   ;Salesperson Code    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Salesperson Code"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=VerkÑufercode;
                                                              ENU=Salesperson Code;
                                                              NLD=Verkoper;
                                                              NOR=Selgerkode;
                                                              SVE=SÑljarkod] }
    { 5   ;   ;Correspondence Type (Default);Option;
                                                   OnValidate=VAR
                                                                Attachment@1001 : Record 11072030;
                                                                ErrorText@1000 : Text[80];
                                                              BEGIN
                                                                IF NOT Attachment.GET("Attachment No.") THEN
                                                                  EXIT;

                                                                ErrorText := Attachment.CheckCorrespondenceType("Correspondence Type (Default)");
                                                                IF ErrorText <> '' THEN
                                                                  ERROR(
                                                                    Text000 + ErrorText,
                                                                    FIELDCAPTION("Correspondence Type (Default)"),"Correspondence Type (Default)",TABLECAPTION,"No.");
                                                                IF "Correspondence Type (Default)" <> "Correspondence Type (Default)"::" " THEN
                                                                  UpdateSegLinesByFieldNo(FIELDNO("Correspondence Type (Default)"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Korrespondenzart (Standard);
                                                              ENU=Correspondence Type (Default);
                                                              NLD=Correspondentietype (Standaard);
                                                              NOR=Korrespondansetype (Standard);
                                                              SVE=Motsvarande typ (standard)];
                                                   OptionCaptionML=[DEU=" ,Ausdruck,E-Mail,Fax";
                                                                    ENU=" ,Hard Copy,Email,Fax";
                                                                    NLD=" ,Afdruk,E-mail,Fax";
                                                                    NOR=" ,Brev,E-post,Faks";
                                                                    SVE=" ,Utskrift,E-post,Fax"];
                                                   OptionString=[ ,Hard Copy,Email,Fax] }
    { 6   ;   ;Interaction Template Code;Code10   ;TableRelation="Interaction Template";
                                                   OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Interaction Template Code"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=AktivitÑtenvorlagencode;
                                                              ENU=Interaction Template Code;
                                                              NLD=Interactiesjablooncode;
                                                              NOR=Interaksjonsmalkode;
                                                              SVE=Interaktionsmallkod] }
    { 7   ;   ;Unit Cost (LCY)     ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Unit Cost (LCY)"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Einstandspreis (MW);
                                                              ENU=Unit Cost (LCY);
                                                              NLD=Kostprijs (LV);
                                                              NOR=Enhetskost (NOK);
                                                              SVE=Styckkostnad (BVA)];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 8   ;   ;Unit Duration (Min.);Decimal       ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Unit Duration (Min.)"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Vorgabedauer (Min.);
                                                              ENU=Unit Duration (Min.);
                                                              NLD=Eenheidsduur (Min.);
                                                              NOR=Interaksjonstid (min.);
                                                              SVE=Interaktionstid (min.)];
                                                   DecimalPlaces=0:0;
                                                   MinValue=0 }
    { 9   ;   ;Attachment No.      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Segment Interaction Language"."Attachment No." WHERE (Segment No.=FIELD(No.),
                                                                                                                             Segment Line No.=CONST(0),
                                                                                                                             Language Code=FIELD("Language Code (Default)")));
                                                   OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Attachment No."),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Dateianhangsnr.;
                                                              ENU=Attachment No.;
                                                              NLD=Bijlagenr.;
                                                              NOR=Vedleggsnr.;
                                                              SVE=Bilagenr] }
    { 10  ;   ;Date                ;Date          ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO(Date),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Datum;
                                                              ENU=Date;
                                                              NLD=Datum;
                                                              NOR=Dato;
                                                              SVE=Datum] }
    { 11  ;   ;Campaign Target     ;Boolean       ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Campaign Target"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Kampagnenziel;
                                                              ENU=Campaign Target;
                                                              NLD=Campagnedoel;
                                                              NOR=KampanjemÜl;
                                                              SVE=KampanjmÜl] }
    { 12  ;   ;Information Flow    ;Option        ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Information Flow"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Informationsfluss;
                                                              ENU=Information Flow;
                                                              NLD=Informatiestroom;
                                                              NOR=Informasjonsflyt;
                                                              SVE=Informationsflîde];
                                                   OptionCaptionML=[DEU=" ,Ausgehend,Eingehend";
                                                                    ENU=" ,Outbound,Inbound";
                                                                    NLD=" ,Uitgaand,Inkomend";
                                                                    NOR=" ,UtgÜende,Innkommende";
                                                                    SVE=" ,AvgÜende,Ankommande"];
                                                   OptionString=[ ,Outbound,Inbound];
                                                   BlankZero=Yes }
    { 13  ;   ;Initiated By        ;Option        ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Initiated By"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Veranlasst durch;
                                                              ENU=Initiated By;
                                                              NLD=Gestart door;
                                                              NOR=Initiert av;
                                                              SVE=Initierat av];
                                                   OptionCaptionML=[DEU=" ,Wir,Sie";
                                                                    ENU=" ,Us,Them";
                                                                    NLD=" ,Wij,Zij";
                                                                    NOR=" ,Oss,Dem";
                                                                    SVE=" ,Internt,Externt"];
                                                   OptionString=[ ,Us,Them];
                                                   BlankZero=Yes }
    { 14  ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[DEU=Nummernserie;
                                                              ENU=No. Series;
                                                              NLD=Nr.-reeks;
                                                              NOR=Nr-serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 15  ;   ;Campaign Response   ;Boolean       ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Campaign Response"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Kampagnenreaktion;
                                                              ENU=Campaign Response;
                                                              NLD=Campagnerespons;
                                                              NOR=Kampanjerepons;
                                                              SVE=Kampanjsvar] }
    { 16  ;   ;No. of Lines        ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Segment Line" WHERE (Segment No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Zeilen;
                                                              ENU=No. of Lines;
                                                              NLD=Aantal regels;
                                                              NOR=Antall Rader;
                                                              SVE=Antal rader];
                                                   Editable=No }
    { 17  ;   ;Cost (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Segment Line"."Cost (LCY)" WHERE (Segment No.=FIELD(No.)));
                                                   CaptionML=[DEU=Einstandsbetrag (MW);
                                                              ENU=Cost (LCY);
                                                              NLD=Kosten (LV);
                                                              NOR=Kostnad (NOK);
                                                              SVE=Kostnad (BVA)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 18  ;   ;Duration (Min.)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Segment Line"."Duration (Min.)" WHERE (Segment No.=FIELD(No.)));
                                                   CaptionML=[DEU=Dauer (Min.);
                                                              ENU=Duration (Min.);
                                                              NLD=Duur (Min.);
                                                              NOR=Varighet (Min.);
                                                              SVE=Varaktighet (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 19  ;   ;Language Code (Default);Code10     ;TableRelation=Language;
                                                   OnValidate=VAR
                                                                SegInteractLanguage@1001 : Record 5104;
                                                              BEGIN
                                                                IF "Language Code (Default)" = xRec."Language Code (Default)" THEN
                                                                  EXIT;

                                                                IF NOT SegInteractLanguage.GET("No.",0,"Language Code (Default)") THEN BEGIN
                                                                  "Subject (Default)" := '';
                                                                  IF CONFIRM(Text010,TRUE,SegInteractLanguage.TABLECAPTION,"Language Code (Default)") THEN BEGIN
                                                                    SegInteractLanguage.INIT;
                                                                    SegInteractLanguage."Segment No." := "No.";
                                                                    SegInteractLanguage."Segment Line No." := 0;
                                                                    SegInteractLanguage."Language Code" := "Language Code (Default)";
                                                                    SegInteractLanguage.Description := FORMAT("Interaction Template Code") + ' ' + FORMAT("Language Code (Default)");
                                                                    SegInteractLanguage.INSERT(TRUE);
                                                                  END ELSE
                                                                    ERROR('');
                                                                END ELSE
                                                                  "Subject (Default)" := SegInteractLanguage.Subject;
                                                              END;

                                                   OnLookup=VAR
                                                              SegInteractLanguage@1000 : Record 5104;
                                                            BEGIN
                                                              MODIFY;
                                                              COMMIT;

                                                              SegInteractLanguage.SETRANGE("Segment No.","No.");
                                                              SegInteractLanguage.SETRANGE("Segment Line No.",0);
                                                              IF "Language Code (Default)" <> '' THEN
                                                                SegInteractLanguage.GET("No.",0,"Language Code (Default)");
                                                              IF PAGE.RUNMODAL(0,SegInteractLanguage) = ACTION::LookupOK THEN BEGIN
                                                                GET("No.");
                                                                "Language Code (Default)" := SegInteractLanguage."Language Code";
                                                                "Subject (Default)" := SegInteractLanguage.Subject;
                                                                MODIFY;
                                                              END ELSE
                                                                GET("No.");
                                                              CALCFIELDS("Attachment No.");
                                                            END;

                                                   CaptionML=[DEU=Sprachcode (Standard);
                                                              ENU=Language Code (Default);
                                                              NLD=Taal (Standaard);
                                                              NOR=SprÜkkode (Standard);
                                                              SVE=SprÜkkod (standard)] }
    { 20  ;   ;Interaction Group Code;Code10      ;TableRelation="Interaction Group";
                                                   CaptionML=[DEU=AktivitÑtengruppencode;
                                                              ENU=Interaction Group Code;
                                                              NLD=Interactiegroepscode;
                                                              NOR=Interaksjonsgruppekode;
                                                              SVE=Interaktionsgruppkod] }
    { 21  ;   ;No. of Criteria Actions;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Segment Criteria Line" WHERE (Segment No.=FIELD(No.),
                                                                                                    Type=CONST(Action)));
                                                   CaptionML=[DEU=Anzahl Kriterienaktionen;
                                                              ENU=No. of Criteria Actions;
                                                              NLD=Aantal criteria;
                                                              NOR=Antall kriteriumshandlinger;
                                                              SVE=Antal kriteriumÜtgÑrder];
                                                   Editable=No }
    { 22  ;   ;Send Word Docs. as Attmt.;Boolean  ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Send Word Docs. as Attmt."),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[DEU=Word-Dokumente als Anh. senden;
                                                              ENU=Send Word Docs. as Attmt.;
                                                              NLD=Word-doc. als bijlage verzenden;
                                                              NOR=Send Word-dok. som vedlegg;
                                                              SVE=Skicka Word-dok. som bilaga] }
    { 23  ;   ;Ignore Contact Corres. Type;Boolean;CaptionML=[DEU=Kontakt Korrespond.-Art ignor.;
                                                              ENU=Ignore Contact Corres. Type;
                                                              NLD=Correspondentietype contact negeren;
                                                              NOR=Ignorer Kontakt korrespondansetype;
                                                              SVE=Ignorera Kontakt motsv. typ] }
    { 24  ;   ;Subject (Default)   ;Text100       ;OnValidate=VAR
                                                                SegInteractLanguage@1000 : Record 5104;
                                                                UpdateLines@1001 : Boolean;
                                                              BEGIN
                                                                IF SegLinesExist(FIELDCAPTION("Subject (Default)")) THEN
                                                                  UpdateLines := CONFIRM(STRSUBSTNO(Text011,FIELDCAPTION("Subject (Default)")),TRUE);

                                                                IF SegInteractLanguage.GET("No.",0,"Language Code (Default)") THEN BEGIN
                                                                  SegInteractLanguage.Subject := "Subject (Default)";
                                                                  SegInteractLanguage.MODIFY;
                                                                  MODIFY;
                                                                END;

                                                                IF NOT UpdateLines THEN
                                                                  EXIT;

                                                                SegLine.SETRANGE("Segment No.","No.");
                                                                SegLine.SETRANGE("Interaction Template Code","Interaction Template Code");
                                                                SegLine.SETRANGE("Language Code","Language Code (Default)");
                                                                SegLine.SETRANGE(Subject,xRec."Subject (Default)");
                                                                SegLine.MODIFYALL(Subject,"Subject (Default)");
                                                              END;

                                                   CaptionML=[DEU=Betreff (Standard);
                                                              ENU=Subject (Default);
                                                              NLD=Onderwerp (Standaard);
                                                              NOR=Emne (standard);
                                                              SVE=AngÜende (standard)] }
    { 25  ;   ;Campaign Description;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Campaign.Description WHERE (No.=FIELD(Campaign No.)));
                                                   CaptionML=[DEU=Kampagnenbeschreibung;
                                                              ENU=Campaign Description;
                                                              NLD=Campagneomschrijving;
                                                              NOR=Kampanjebeskrivelse;
                                                              SVE=Kampanjbeskrivning];
                                                   Editable=No }
    { 11012000;;Optional Mergefield 1;Text80      ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Optional Mergefield 1"),CurrFieldNo <> 0); //**4PS.n
                                                              END;

                                                   CaptionML=[DEU=ZusÑtzl. Seriendruckfeld 1;
                                                              ENU=Optional Mergefield 1;
                                                              NLD=Extra samenvoegveld 1;
                                                              NOR=Valgfritt flettefelt 1;
                                                              SVE=Valfritt kopplingsfÑlt 1] }
    { 11012001;;Optional Mergefield 2;Text80      ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Optional Mergefield 2"),CurrFieldNo <> 0); //**4PS.n
                                                              END;

                                                   CaptionML=[DEU=ZusÑtzl. Seriendruckfeld 2;
                                                              ENU=Optional Mergefield 2;
                                                              NLD=Extra samenvoegveld 2;
                                                              NOR=Valgfritt Koblingsfelt 2;
                                                              SVE=Valfritt kopplingsfÑlt 2] }
    { 11012002;;Optional Mergefield 3;Text80      ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Optional Mergefield 3"),CurrFieldNo <> 0); //**4PS.n
                                                              END;

                                                   CaptionML=[DEU=ZusÑtzl. Seriendruckfeld 3;
                                                              ENU=Optional Mergefield 3;
                                                              NLD=Extra samenvoegveld 3;
                                                              NOR=Valgfritt Koblingsfelt 3;
                                                              SVE=Valfritt kopplingsfÑlt 3] }
    { 11012003;;Optional Mergefield 4;Text80      ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Optional Mergefield 4"),CurrFieldNo <> 0); //**4PS.n
                                                              END;

                                                   CaptionML=[DEU=ZusÑtzl. Seriendruckfeld 4;
                                                              ENU=Optional Mergefield 4;
                                                              NLD=Extra samenvoegveld 4;
                                                              NOR=Valgfritt Koblingsfelt 4;
                                                              SVE=Valfritt kopplingsfÑlt 4] }
    { 11012004;;Optional Mergefield 5;Text80      ;OnValidate=BEGIN
                                                                UpdateSegLinesByFieldNo(FIELDNO("Optional Mergefield 5"),CurrFieldNo <> 0); //**4PS.n
                                                              END;

                                                   CaptionML=[DEU=ZusÑtzl. Seriendruckfeld 5;
                                                              ENU=Optional Mergefield 5;
                                                              NLD=Extra samenvoegveld 5;
                                                              NOR=Valgfritt Koblingsfelt 5;
                                                              SVE=Valfritt kopplingsfÑlt 5] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Salesperson Code                         }
    {    ;Campaign No.                             }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Description,Campaign No.             }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU="Die %1 = %2 kann fÅr %3 %4 nicht angegeben werden.\";ENU="%1 = %2 can not be specified for %3 %4.\";NLD="%1 = %2 kan niet opgegeven worden voor %3 %4.\";NOR="%1 = %2 kan ikke spesifiseres for %3 %4.\";SVE="%1 = %2 kan inte specificeras fîr %3 %4.\"';
      Text002@1002 : TextConst 'DEU=''%1'' wurde geÑndert.\\Mîchten Sie die Segmentszeilen mit dem AktivitÑtenvorlagencode ''%2'' aktualisieren?;ENU=You have modified %1.\\Do you want to update the segment lines where the Interaction Template Code is %2?;NLD=U hebt %1 gewijzigd.\\Wilt u de segmentregels bijwerken waar de interactiesjablooncode %2 is?;NOR=Du har endret %1.\\Vil du oppdatere segmentrader hvor interaksjonsmalkoden er %2?;SVE=Du har Ñndrat %1.\\Vill du uppdatera segmentrader dÑr interaktionsmallkoden Ñr %2?';
      Text003@1003 : TextConst 'DEU=Der %1 darf nicht ohne Aktualisierung der Zeilen verÑndert werden, wenn Åbernommene DateianhÑnge vorhanden sind.;ENU=%1 may not be modified without updating lines when inherited attachments exist.;NLD=%1 mag niet gewijzigd worden zonder de regels bij te werken als er overgenomen bijlagen bestaan.;NOR=%1 kan ikke endres uten oppdatering av rader nÜr arvede vedlegg finnes.;SVE=%1 fÜr inte Ñndras utan en uppdatering av rader nÑr Ñrvda bilagor finns.';
      Text005@1005 : TextConst 'DEU="Das Segment %1 enthÑlt bereits %3 = %2.\Sind Sie sicher, dass Sie ein %4 wieder verwenden mîchten?";ENU=Segment %1 already contains %2 %3.\Are you sure you want to reuse a %4?;NLD=Segment %1 bevat reeds %2 %3.\Weet u zeker dat u een %4 opnieuw wilt gebruiken?;NOR=Segment %1 inneholder allerede %2 %3.\Er du sikker pÜ Ü du vil gjenbruke en %4?;SVE=Segment %1 innehÜller redan %2 %3.\ér du sÑker pÜ att du vill ÜteranvÑnda en %4?';
      Text006@1006 : TextConst 'DEU="Das Segment %1 enthÑlt bereits %3 = %2.\Sind Sie sicher, dass Sie ein %4 wieder verwenden mîchten?";ENU=Segment %1 already contains %2 %3.\Are you sure you want to reuse a %4?;NLD=Segment %1 bevat reeds %2 %3.\Weet u zeker dat u een %4 opnieuw wilt gebruiken?;NOR=Segment %1 inneholder allerede %2 %3.\Er du sikker pÜ Ü du vil gjenbruke en %4?;SVE=Segment %1 innehÜller redan %2 %3.\ér du sÑker pÜ att du vill ÜteranvÑnda en %4?';
      RMSetup@1010 : Record 5079;
      SegHeader@1011 : Record 11072039;
      SegLine@1012 : Record 11072040;
      OptionalMergeFieldRec@1210190005 : Record 11012145;
      ContactRec@1100485000 : Record 5050;
      NoSeriesMgt@1014 : Codeunit 396;
      SegCriteriaManagement@1015 : Codeunit 11072025;
      SegHistMgt@1016 : Codeunit 11072024;
      Text010@1007 : TextConst 'DEU=Mîchten Sie den %1 %2 erstellen?;ENU=Do you want to create %1 %2?;NLD=Wilt u %1 %2 maken?;NOR=Vil du opprette %1 %2?;SVE=Vill du skapa %1 %2?';
      Text011@1004 : TextConst 'DEU=''%1'' wurde geÑndert.\\Mîchten Sie die entsprechenden Segmentszeilen aktualisieren?;ENU=You have modified %1.\\Do you want to update the corresponding segment lines?;NLD=U hebt %1 gewijzigd.\\Wilt u de bijbehorende segmentregels bijwerken?;NOR=Du har endret %1.\\Vil du oppdatere tilhõrende segmentrader?;SVE=Du har Ñndrat %1.\\Vill du uppdatera motsvarande segmentrader?';
      Text012@1030 : TextConst '@@@=You have modified Meeting.\\Do you want to apply the Meeting BUS to all segment lines?;DEU=''%1'' wurde geÑndert.\\Mîchten Sie ''%1 %2'' auf alle Segmentszeilen anwenden?;ENU=You have modified %1.\\Do you want to apply the %1 %2 to all segment lines?;NLD=U hebt %1 gewijzigd.\\Wilt u %1 %2 toepassen op alle segmentregels?;NOR=Du har endret %1.\Vil du utligne %1 %2 til alle segmentrader?;SVE=Du har Ñndrat %1.\\Vill du koppla %1 %2 till alla segmentrader?';
      Text11012000@1210190004 : TextConst 'DEU=Seriendruckfeld;ENU=Merge Field;NLD=Samenvoegveld;NOR=Flett felt;SVE=Koppla fÑlt';

    [External]
    PROCEDURE AssistEdit@2(OldSegHeader@1000 : Record 11072039) : Boolean;
    BEGIN
      WITH SegHeader DO BEGIN
        SegHeader := Rec;
        RMSetup.GET;
        RMSetup.TESTFIELD("Segment Nos.");
        IF NoSeriesMgt.SelectSeries(RMSetup."Segment Nos.",OldSegHeader."No. Series","No. Series") THEN BEGIN
          RMSetup.GET;
          RMSetup.TESTFIELD("Segment Nos.");
          NoSeriesMgt.SetSeries("No.");
          Rec := SegHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    [External]
    PROCEDURE CreateOpportunities@1();
    VAR
      SegmentLine@1000 : Record 11072040;
    BEGIN
      SegmentLine.SETRANGE("Segment No.","No.");
      SegmentLine.SETFILTER("Contact No.",'<>%1','');
      IF SegmentLine.FINDSET THEN
        REPEAT
          SegmentLine.CreateOpportunity;
        UNTIL SegmentLine.NEXT = 0;
    END;

    [External]
    PROCEDURE CreateSegInteractions@14(InteractionTemplateCode@1000 : Code[10];SegmentNo@1005 : Code[20];SegmentLineNo@1006 : Integer);
    VAR
      InteractionTmplLanguage@1003 : Record 5103;
      SegInteractLanguage@1002 : Record 5104;
      Attachment@1001 : Record 11072030;
      AttachmentManagement@1004 : Codeunit 11072021;
    BEGIN
      SegInteractLanguage.SETRANGE("Segment No.",SegmentNo);
      SegInteractLanguage.SETRANGE("Segment Line No.",SegmentLineNo);
      SegInteractLanguage.DELETEALL(TRUE);

      InteractionTmplLanguage.RESET;
      InteractionTmplLanguage.SETRANGE("Interaction Template Code",InteractionTemplateCode);
      IF InteractionTmplLanguage.FIND('-') THEN
        REPEAT
          SegInteractLanguage.INIT;
          SegInteractLanguage."Segment No." := SegmentNo;
          SegInteractLanguage."Segment Line No." := SegmentLineNo;
          SegInteractLanguage."Language Code" := InteractionTmplLanguage."Language Code";
          SegInteractLanguage.Description := InteractionTmplLanguage.Description;
          IF Attachment.GET(InteractionTmplLanguage."Attachment No.") THEN
            SegInteractLanguage."Attachment No." := AttachmentManagement.InsertAttachment(InteractionTmplLanguage."Attachment No.");
          SegInteractLanguage.INSERT(TRUE);
        UNTIL InteractionTmplLanguage.NEXT = 0;
    END;

    LOCAL PROCEDURE CopyFromTemplate@16(InteractionTemplate@1000 : Record 11072032);
    BEGIN
      "Language Code (Default)" := InteractionTemplate."Language Code (Default)";
      "Interaction Group Code" := InteractionTemplate."Interaction Group Code";
      "Unit Cost (LCY)" := InteractionTemplate."Unit Cost (LCY)";
      "Unit Duration (Min.)" := InteractionTemplate."Unit Duration (Min.)";
      "Information Flow" := InteractionTemplate."Information Flow";
      "Initiated By" := InteractionTemplate."Initiated By";
      "Campaign Target" := InteractionTemplate."Campaign Target";
      "Campaign Response" := InteractionTemplate."Campaign Response";
      "Correspondence Type (Default)" := InteractionTemplate."Correspondence Type (Default)";
      "Ignore Contact Corres. Type" := InteractionTemplate."Ignore Contact Corres. Type";
    END;

    LOCAL PROCEDURE UpdateSegLinesByFieldNo@19(ChangedFieldNo@1000 : Integer;AskQuestion@1001 : Boolean);
    VAR
      Field@1005 : Record 2000000041;
      Attachment@1003 : Record 11072030;
      Question@1002 : Text[260];
    BEGIN
      Field.GET(DATABASE::"Segment Header",ChangedFieldNo);

      IF NOT SegLinesExist(Field."Field Caption") THEN BEGIN
        IF "No." <> '' THEN
          UpdateSegHeader("Interaction Template Code",
            ChangedFieldNo = FIELDNO("Interaction Template Code"));
        EXIT;
      END;

      IF AskQuestion THEN BEGIN
        IF ChangedFieldNo = FIELDNO("Interaction Template Code") THEN
          Question := STRSUBSTNO(Text012,Field."Field Caption","Interaction Template Code")
        ELSE
          Question := STRSUBSTNO(Text002,Field."Field Caption","Interaction Template Code");
        IF NOT CONFIRM(Question,TRUE) THEN BEGIN
          IF ChangedFieldNo = FIELDNO("Interaction Template Code") THEN BEGIN
            SegLine.SETRANGE("Segment No.","No.");
            IF SegLine.FIND('-') THEN BEGIN
              REPEAT
                IF SegLine.AttachmentInherited THEN
                  ERROR(Text003,FIELDCAPTION("Interaction Template Code"));
              UNTIL SegLine.NEXT = 0;
            END
          END;
          UpdateSegHeader("Interaction Template Code",
            ChangedFieldNo = FIELDNO("Interaction Template Code"));
          EXIT;
        END;
      END;

      SegLine.RESET;
      SegLine.SETRANGE("Segment No.","No.");
      IF ChangedFieldNo <> FIELDNO("Interaction Template Code") THEN
        SegLine.SETRANGE("Interaction Template Code","Interaction Template Code");

      IF NOT SegLine.ISEMPTY THEN
        CASE ChangedFieldNo OF
          FIELDNO(Description):
            SegLine.MODIFYALL(Description,Description);
          FIELDNO("Campaign No."):
            SegLine.MODIFYALL("Campaign No.","Campaign No.");
          FIELDNO("Salesperson Code"):
            SegLine.MODIFYALL("Salesperson Code","Salesperson Code");
          FIELDNO("Correspondence Type (Default)"):
            SegLine.MODIFYALL("Correspondence Type","Correspondence Type (Default)");
          FIELDNO("Interaction Template Code"):
            BEGIN
              SegLine.MODIFYALL("Interaction Template Code","Interaction Template Code");
              UpdateSegHeader("Interaction Template Code",TRUE);
            END;
          FIELDNO("Unit Cost (LCY)"):
            SegLine.MODIFYALL("Cost (LCY)","Unit Cost (LCY)");
          FIELDNO("Unit Duration (Min.)"):
            SegLine.MODIFYALL("Duration (Min.)","Unit Duration (Min.)");
          FIELDNO(Date):
            SegLine.MODIFYALL(Date,Date);
          FIELDNO("Campaign Target"):
            SegLine.MODIFYALL("Campaign Target","Campaign Target");
          FIELDNO("Information Flow"):
            SegLine.MODIFYALL("Information Flow","Information Flow");
          FIELDNO("Initiated By"):
            SegLine.MODIFYALL("Initiated By","Initiated By");
          FIELDNO("Campaign Response"):
            SegLine.MODIFYALL("Campaign Response","Campaign Response");
          FIELDNO("Interaction Group Code"):
            SegLine.MODIFYALL("Interaction Group Code","Interaction Group Code");
          FIELDNO("Send Word Docs. as Attmt."):
            SegLine.MODIFYALL("Send Word Doc. As Attmt.","Send Word Docs. as Attmt.");
          FIELDNO("Attachment No."):
            SegLine.MODIFYALL("Attachment No.","Attachment No.");
          //**4PS.sn
          FIELDNO("Optional Mergefield 1") :
            SegLine.MODIFYALL("Optional Mergefield 1","Optional Mergefield 1");
          FIELDNO("Optional Mergefield 2") :
            SegLine.MODIFYALL("Optional Mergefield 2","Optional Mergefield 2");
          FIELDNO("Optional Mergefield 3") :
            SegLine.MODIFYALL("Optional Mergefield 3","Optional Mergefield 3");
          FIELDNO("Optional Mergefield 4") :
            SegLine.MODIFYALL("Optional Mergefield 4","Optional Mergefield 4");
          FIELDNO("Optional Mergefield 5") :
            SegLine.MODIFYALL("Optional Mergefield 5","Optional Mergefield 5");
          //**4PS.en
        END;

      OnAfterUpdateSegLinesByFieldNo(Rec,ChangedFieldNo);
    END;

    [External]
    PROCEDURE SegLinesExist@3(ChangedFieldName@1000 : Text[100]) : Boolean;
    BEGIN
      SegLine.RESET;
      SegLine.SETRANGE("Segment No.","No.");
      IF ChangedFieldName <> FIELDCAPTION("Interaction Template Code") THEN
        SegLine.SETRANGE("Interaction Template Code","Interaction Template Code");
      EXIT(SegLine.FIND('-'));
    END;

    [External]
    PROCEDURE ReuseLogged@7(LoggedSegEntryNo@1000 : Integer);
    VAR
      LoggedSeg@1001 : Record 11072038;
      InteractLogEntry@1002 : Record 11072027;
      SegLine@1003 : Record 11072040;
      NextLineNo@1004 : Integer;
    BEGIN
      IF LoggedSegEntryNo = 0 THEN BEGIN
        CALCFIELDS("No. of Criteria Actions");
        IF "No. of Criteria Actions" <> 0 THEN
          IF NOT CONFIRM(
               Text005,FALSE,
               "No.","No. of Criteria Actions",FIELDCAPTION("No. of Criteria Actions"),LoggedSeg.TABLECAPTION)
          THEN
            EXIT;
        IF PAGE.RUNMODAL(PAGE::"Logged Segments",LoggedSeg) <> ACTION::LookupOK THEN
          EXIT;
      END ELSE
        LoggedSeg.GET(LoggedSegEntryNo);

      //**4PS.sn
      "Interaction Template Code" :=LoggedSeg."Interaction Template Code";
      MODIFY;
      //**4PS.en
      SegLine.LOCKTABLE;
      SegLine.SETRANGE("Segment No.","No.");
      IF SegLine.FINDLAST THEN
        NextLineNo := SegLine."Line No.";

      CLEAR(SegCriteriaManagement);
      SegCriteriaManagement.InsertReuseLogged("No.",LoggedSeg."Entry No.");

      InteractLogEntry.SETCURRENTKEY("Logged Segment Entry No.");
      InteractLogEntry.SETRANGE("Logged Segment Entry No.",LoggedSeg."Entry No.");
      IF InteractLogEntry.FIND('-') THEN
        REPEAT
          IF AddContactAllowed(InteractLogEntry."Contact No.") THEN BEGIN //**4PS.n
            NextLineNo := NextLineNo + 10000;
            SegLine.INIT;
            SegLine."Segment No." := "No.";
            SegLine."Line No." := NextLineNo;
            SegLine.VALIDATE("Contact No.",InteractLogEntry."Contact No.");
            SegLine."Campaign No." := InteractLogEntry."Campaign No.";
            SegLine."Interaction Template Code" := InteractLogEntry."Interaction Template Code";  //**4PS.n
            SegLine.INSERT(TRUE);
            SegHistMgt.InsertLine("No.",SegLine."Contact No.",SegLine."Line No.");
          END; //**4PS.n
        UNTIL InteractLogEntry.NEXT = 0;
    END;

    [External]
    PROCEDURE ReuseCriteria@4();
    VAR
      SavedSegCriteria@1000 : Record 11072049;
      SavedSegCriteriaLineAction@1001 : Record 11072050;
      SavedSegCriteriaLineFilter@1002 : Record 11072050;
      Cont@1003 : Record 5050;
      ContProfileAnswer@1004 : Record 5089;
      ContMailingGrp@1005 : Record 5056;
      InteractLogEntry@1006 : Record 11072027;
      ContJobResp@1007 : Record 5067;
      ContIndustGrp@1008 : Record 5058;
      ContBusRel@1009 : Record 5054;
      ValueEntry@1010 : Record 5802;
      Plot@1100529600 : Record 11012500;
      PLotBuyer2@1100529601 : Record 11012500;
      ProjectAuthority@1100529602 : Record 11020216;
      RentalPackage@1100529604 : Record 11012941;
      AddContacts@1011 : Report 11072055;
      ReduceContacts@1012 : Report 11072054;
      RefineContacts@1013 : Report 11072053;
      AddPlots@1100529603 : Report 11020330;
    BEGIN
      CALCFIELDS("No. of Criteria Actions");
      IF "No. of Criteria Actions" <> 0 THEN
        IF NOT CONFIRM(
             Text006,FALSE,
             "No.","No. of Criteria Actions",FIELDCAPTION("No. of Criteria Actions"),SavedSegCriteria.TABLECAPTION)
        THEN
          EXIT;

      IF PAGE.RUNMODAL(PAGE::"Saved Segment Criteria List",SavedSegCriteria) <> ACTION::LookupOK THEN
        EXIT;

      SavedSegCriteriaLineAction.SETRANGE("Segment Criteria Code",SavedSegCriteria.Code);
      SavedSegCriteriaLineAction.SETRANGE(Type,SavedSegCriteriaLineAction.Type::Action);
      IF SavedSegCriteriaLineAction.FIND('-') THEN
        REPEAT
          SegHeader.SETRANGE("No.","No.");
          Cont.RESET;
          ContProfileAnswer.RESET;
          ContMailingGrp.RESET;
          InteractLogEntry.RESET;
          ContJobResp.RESET;
          ContIndustGrp.RESET;
          ContBusRel.RESET;
          ValueEntry.RESET;
          //**4PS.sn
          Plot.RESET;
          PLotBuyer2.RESET;
          ProjectAuthority.RESET;
          RentalPackage.RESET;
          //**4PS.en
          SavedSegCriteriaLineFilter.SETRANGE("Segment Criteria Code",SavedSegCriteria.Code);
          SavedSegCriteriaLineFilter.SETRANGE(
            "Line No.",SavedSegCriteriaLineAction."Line No." + 1,
            SavedSegCriteriaLineAction."Line No." + SavedSegCriteriaLineAction."No. of Filters");
          IF SavedSegCriteriaLineFilter.FIND('-') THEN
            REPEAT
              CASE SavedSegCriteriaLineFilter."Table No." OF
                DATABASE::Contact:
                  Cont.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Contact Profile Answer":
                  ContProfileAnswer.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Contact Mailing Group":
                  ContMailingGrp.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Interaction Log Entry":
                  InteractLogEntry.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Contact Job Responsibility":
                  ContJobResp.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Contact Industry Group":
                  ContIndustGrp.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Contact Business Relation":
                  ContBusRel.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Value Entry":
                  ValueEntry.SETVIEW(SavedSegCriteriaLineFilter.View);
                //**4PS.sn
                DATABASE::Plot:
                  IF SavedSegCriteriaLineFilter."Second Buyer (Plot)" THEN
                    PLotBuyer2.SETVIEW(SavedSegCriteriaLineFilter.View)
                  ELSE
                    Plot.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Project Authority":
                  ProjectAuthority.SETVIEW(SavedSegCriteriaLineFilter.View);
                DATABASE::"Rental Package":
                  RentalPackage.SETVIEW(SavedSegCriteriaLineFilter.View);
                //**4PS.en
              END;
            UNTIL SavedSegCriteriaLineFilter.NEXT = 0;
          CASE SavedSegCriteriaLineAction.Action OF
            SavedSegCriteriaLineAction.Action::"Add Contacts":
              BEGIN
                CLEAR(AddContacts);
                AddContacts.SETTABLEVIEW(SegHeader);
                AddContacts.SETTABLEVIEW(Cont);
                AddContacts.SETTABLEVIEW(ContProfileAnswer);
                AddContacts.SETTABLEVIEW(ContMailingGrp);
                AddContacts.SETTABLEVIEW(InteractLogEntry);
                AddContacts.SETTABLEVIEW(ContJobResp);
                AddContacts.SETTABLEVIEW(ContIndustGrp);
                AddContacts.SETTABLEVIEW(ContBusRel);
                AddContacts.SETTABLEVIEW(ValueEntry);
                //**4PS.sn
                AddContacts.SETTABLEVIEW(Plot);
                IF PLotBuyer2.GETFILTERS <> '' THEN
                  AddContacts.SetPlotBuyer2View(PLotBuyer2.GETVIEW);
                AddContacts.SETTABLEVIEW(ProjectAuthority);
                AddContacts.SETTABLEVIEW(RentalPackage);
                //**4PS.en
                AddContacts.SetOptions(
                  SavedSegCriteriaLineAction."Allow Existing Contacts",
                  SavedSegCriteriaLineAction."Expand Contact",
                  SavedSegCriteriaLineAction."Allow Company with Persons",
                  SavedSegCriteriaLineAction."Ignore Exclusion");
                AddContacts.USEREQUESTPAGE(FALSE);
                AddContacts.RUNMODAL;
              END;
            SavedSegCriteriaLineAction.Action::"Remove Contacts (Reduce)":
              BEGIN
                CLEAR(ReduceContacts);
                ReduceContacts.SETTABLEVIEW(SegHeader);
                ReduceContacts.SETTABLEVIEW(Cont);
                ReduceContacts.SETTABLEVIEW(ContProfileAnswer);
                ReduceContacts.SETTABLEVIEW(ContMailingGrp);
                ReduceContacts.SETTABLEVIEW(InteractLogEntry);
                ReduceContacts.SETTABLEVIEW(ContJobResp);
                ReduceContacts.SETTABLEVIEW(ContIndustGrp);
                ReduceContacts.SETTABLEVIEW(ContBusRel);
                ReduceContacts.SETTABLEVIEW(ValueEntry);
                ReduceContacts.SetOptions(SavedSegCriteriaLineAction."Entire Companies");
                ReduceContacts.USEREQUESTPAGE(FALSE);
                ReduceContacts.RUNMODAL;
              END;
            SavedSegCriteriaLineAction.Action::"Remove Contacts (Refine)":
              BEGIN
                CLEAR(RefineContacts);
                RefineContacts.SETTABLEVIEW(SegHeader);
                RefineContacts.SETTABLEVIEW(Cont);
                RefineContacts.SETTABLEVIEW(ContProfileAnswer);
                RefineContacts.SETTABLEVIEW(ContMailingGrp);
                RefineContacts.SETTABLEVIEW(InteractLogEntry);
                RefineContacts.SETTABLEVIEW(ContJobResp);
                RefineContacts.SETTABLEVIEW(ContIndustGrp);
                RefineContacts.SETTABLEVIEW(ContBusRel);
                RefineContacts.SETTABLEVIEW(ValueEntry);
                ReduceContacts.SetOptions(SavedSegCriteriaLineAction."Entire Companies");
                RefineContacts.USEREQUESTPAGE(FALSE);
                RefineContacts.RUNMODAL;
              END;
            //**4PS.sn
            SavedSegCriteriaLineAction.Action::"Add Plots":
              BEGIN
                CLEAR(AddPlots);
                AddPlots.SETTABLEVIEW(SegHeader);
                AddPlots.SETTABLEVIEW(Cont);
                AddPlots.SETTABLEVIEW(Plot);
                IF PLotBuyer2.GETFILTERS <> '' THEN
                  AddPlots.SetPlotBuyer2View(PLotBuyer2.GETVIEW);
                AddPlots.SetOptions(SavedSegCriteriaLineAction."Allow Existing Plots");
                AddPlots.USEREQUESTPAGE(FALSE);
                AddPlots.RUNMODAL;
              END;
            //**4PS.en
          END;
        UNTIL SavedSegCriteriaLineAction.NEXT = 0;
    END;

    [External]
    PROCEDURE SaveCriteria@5();
    VAR
      SegCriteriaLine@1000 : Record 11072048;
      SavedSegCriteria@1001 : Record 11072049;
      SavedSegCriteriaLine@1002 : Record 11072050;
      SaveSegCriteria@1003 : Page 11072085;
      FormAction@1004 : Action;
    BEGIN
      CALCFIELDS("No. of Criteria Actions");
      TESTFIELD("No. of Criteria Actions");
      SaveSegCriteria.RUNMODAL;
      SaveSegCriteria.GetValues(FormAction,SavedSegCriteria.Code,SavedSegCriteria.Description);
      IF FormAction = ACTION::OK THEN BEGIN
        SavedSegCriteria.INSERT(TRUE);
        SegCriteriaLine.SETRANGE("Segment No.","No.");
        SegCriteriaLine.FIND('-');
        REPEAT
          SavedSegCriteriaLine.INIT;
          SavedSegCriteriaLine."Segment Criteria Code" := SavedSegCriteria.Code;
          SavedSegCriteriaLine."Line No." := SegCriteriaLine."Line No.";
          SavedSegCriteriaLine.Action := SegCriteriaLine.Action;
          SavedSegCriteriaLine.Type := SegCriteriaLine.Type;
          SavedSegCriteriaLine."Table No." := SegCriteriaLine."Table No.";
          SavedSegCriteriaLine.View := SegCriteriaLine.View;
          SavedSegCriteriaLine."Allow Existing Contacts" := SegCriteriaLine."Allow Existing Contacts";
          SavedSegCriteriaLine."Expand Contact" := SegCriteriaLine."Expand Contact";
          SavedSegCriteriaLine."Allow Company with Persons" := SegCriteriaLine."Allow Company with Persons";
          SavedSegCriteriaLine."Ignore Exclusion" := SegCriteriaLine."Ignore Exclusion";
          SavedSegCriteriaLine."Entire Companies" := SegCriteriaLine."Entire Companies";
          SavedSegCriteriaLine."No. of Filters" := SegCriteriaLine."No. of Filters";
          //**4PS.sn
          SavedSegCriteriaLine."Second Buyer (Plot)" := SegCriteriaLine."Second Buyer (Plot)";
          SavedSegCriteriaLine."Allow Existing Plots" := SegCriteriaLine."Allow Existing Plots";
          //**4PS.en
          SavedSegCriteriaLine.INSERT;
        UNTIL SegCriteriaLine.NEXT = 0;
      END;
    END;

    [Internal]
    PROCEDURE MaintainAttachment@13();
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;

      IF "Attachment No." <> 0 THEN
        OpenAttachment
      ELSE BEGIN
        CreateAttachment;
        CALCFIELDS("Attachment No.");
      END;
    END;

    [Internal]
    PROCEDURE CreateAttachment@12();
    VAR
      SegInteractLanguage@1000 : Record 5104;
    BEGIN
      IF NOT SegInteractLanguage.GET("No.",0,"Language Code (Default)") THEN BEGIN
        SegInteractLanguage.INIT;
        SegInteractLanguage."Segment No." := "No.";
        SegInteractLanguage."Segment Line No." := 0;
        SegInteractLanguage."Language Code" := "Language Code (Default)";
        SegInteractLanguage.Description := FORMAT("Interaction Template Code") + ' ' + FORMAT("Language Code (Default)");
        SegInteractLanguage.Subject := "Subject (Default)";
      END;
      SegInteractLanguage.CreateAttachment;
    END;

    [Internal]
    PROCEDURE OpenAttachment@6();
    VAR
      SegInteractLanguage@1001 : Record 5104;
    BEGIN
      IF SegInteractLanguage.GET("No.",0,"Language Code (Default)") THEN
        IF SegInteractLanguage."Attachment No." <> 0 THEN
          SegInteractLanguage.OpenAttachment;
    END;

    [Internal]
    PROCEDURE ImportAttachment@10();
    VAR
      SegInteractLanguage@1003 : Record 5104;
    BEGIN
      IF NOT SegInteractLanguage.GET("No.",0,"Language Code (Default)") THEN BEGIN
        SegInteractLanguage.INIT;
        SegInteractLanguage."Segment No." := "No.";
        SegInteractLanguage."Segment Line No." := 0;
        SegInteractLanguage."Language Code" := "Language Code (Default)";
        SegInteractLanguage.Description :=
          FORMAT("Interaction Template Code") + ' ' + FORMAT("Language Code (Default)");
        SegInteractLanguage.INSERT(TRUE);
      END;
      SegInteractLanguage.ImportAttachment;
    END;

    [Internal]
    PROCEDURE ExportAttachment@9();
    VAR
      SegInteractLanguage@1000 : Record 5104;
    BEGIN
      IF SegInteractLanguage.GET("No.",0,"Language Code (Default)") THEN
        IF SegInteractLanguage."Attachment No." <> 0 THEN
          SegInteractLanguage.ExportAttachment;
    END;

    [Internal]
    PROCEDURE RemoveAttachment@8(Prompt@1000 : Boolean);
    VAR
      SegInteractLanguage@1001 : Record 5104;
    BEGIN
      IF SegInteractLanguage.GET("No.",0,"Language Code (Default)") THEN
        IF SegInteractLanguage."Attachment No." <> 0 THEN
          SegInteractLanguage.RemoveAttachment(Prompt);
    END;

    [External]
    PROCEDURE UpdateSegHeader@11(InteractTmplCode@1006 : Code[10];InteractTmplChange@1005 : Boolean);
    VAR
      InteractionTemplate@1004 : Record 11072032;
      IsHandled@1000 : Boolean;
    BEGIN
      OnBeforeUpdateSegHeader(Rec,InteractTmplCode,InteractTmplChange,IsHandled);

      IF InteractTmplChange THEN BEGIN
        MODIFY;
        GET("No.");
        "Interaction Template Code" := InteractTmplCode;
        "Subject (Default)" := '';

        IF InteractionTemplate.GET("Interaction Template Code") THEN BEGIN
          CopyFromTemplate(InteractionTemplate);
          IF (GETFILTER("Campaign No.") = '') AND (InteractionTemplate."Campaign No." <> '') THEN
            "Campaign No." := InteractionTemplate."Campaign No.";

          CreateSegInteractions("Interaction Template Code","No.",0);
        END ELSE BEGIN
          CopyFromTemplate(InteractionTemplate);
          IF GETFILTER("Campaign No.") = '' THEN
            "Campaign No." := '';
        END;

        MODIFY;
        CALCFIELDS("Attachment No.");
      END;

      OnAfterUpdateSegHeader(Rec);
    END;

    LOCAL PROCEDURE SetDefaultSalesperson@124();
    VAR
      UserSetup@1000 : Record 91;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN
        EXIT;

      IF UserSetup."Salespers./Purch. Code" <> '' THEN
        VALIDATE("Salesperson Code",UserSetup."Salespers./Purch. Code");
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateSegHeader@18(VAR SegmentHeader@1000 : Record 11072039);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateSegLinesByFieldNo@15(VAR SegmentHeader@1000 : Record 11072039;CalledByFieldNo@1001 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeUpdateSegHeader@17(VAR SegmentHeader@1000 : Record 11072039;InteractTmplCode@1002 : Code[10];InteractTmplChange@1001 : Boolean;VAR IsHandled@1003 : Boolean);
    BEGIN
    END;

    PROCEDURE GetCaptionClass@1210190000(FieldNumber@1210190001 : Integer;MergeFieldNumber@1210190002 : Integer) : Text[80];
    VAR
      lOptionalMergeFieldRec@1210190003 : Record 11012145;
      lField@1210190004 : Record 2000000041;
      CaptionTxt@1210190005 : Text[78];
    BEGIN
      //**4PS
      lField.GET(DATABASE::"Segment Header",FieldNumber);

      CaptionTxt := lField."Field Caption";
      IF lOptionalMergeFieldRec.GET("Interaction Template Code", MergeFieldNumber) THEN
        IF lOptionalMergeFieldRec."Merge Field Name" <> '' THEN
          CaptionTxt := STRSUBSTNO(
            Text11012000  + ' ' + lOptionalMergeFieldRec."Merge Field Name", 1, MAXSTRLEN(CaptionTxt));

      EXIT('11012000,' + CaptionTxt);
    END;

    PROCEDURE OptionalMergeFieldEditable@1210190001(MergeFieldNo@1210190001 : Integer) : Boolean;
    BEGIN
      //**4PS
      IF "Interaction Template Code" = '' THEN
        EXIT(FALSE);

      IF NOT OptionalMergeFieldRec.GET("Interaction Template Code", MergeFieldNo) THEN
        EXIT(FALSE);

      IF OptionalMergeFieldRec."Merge Field Name" = '' THEN
        EXIT(FALSE);

      EXIT(OptionalMergeFieldRec.Table = OptionalMergeFieldRec.Table::" ");
    END;

    PROCEDURE AddContactAllowed@1100485000(lContactNo@1100485000 : Code[20]) : Boolean;
    BEGIN
      //**4PS
      IF NOT ContactRec.GET(lContactNo) THEN
        EXIT(FALSE);

      EXIT(NOT ContactRec.Blocked AND NOT ContactRec."Exclude from Segment");
    END;

    BEGIN
    {
      4PS - 01-02-07 - Blocked Contacts or Contacts which are excluded from Segments are skipped.
    }
    END.
  }
}

