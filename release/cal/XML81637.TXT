OBJECT XMLport 81637 Handyman Project Export
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSHM,4PSSE;
  }
  PROPERTIES
  {
    Direction=Export;
    Encoding=UTF-8;
  }
  ELEMENTS
  {
    { [{C56F1B10-A6B4-4E95-BE59-26E94089AAFD}];  ;OrderList           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 HandymanSetup.GET();
                                                                               END;
                                                                                }

    { [{108E1A5C-A877-49E1-A4C6-04E1DE53B778}];1 ;Order               ;Element ;Table   ;
                                                  SourceTable=Table11072003;
                                                  Export::OnAfterGetRecord=VAR
                                                                             ProjectPrincipal@1101285000 : Record 11012005;
                                                                           BEGIN
                                                                             //RFC143
                                                                             IF ProjectPrincipal.GET(Job."No.",Job."Bill-to Customer No.") THEN BEGIN
                                                                               Requsition := ProjectPrincipal."Order No. Customer";
                                                                               CustomerReference := ProjectPrincipal."Principal Reference";
                                                                             END;
                                                                           END;
                                                                            }

    { [{6DF5017F-D158-4F26-84D8-6A93DD842C3D}];2 ;OrderNo             ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Job::No. }

    { [{3C58C893-7C7A-4827-B970-87C66DA09FBB}];2 ;HSOrderNumber       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 lvHandymanImportBuffer@1100285500 : Record 81624;
                                                                               BEGIN
                                                                                 lvHandymanImportBuffer.SETCURRENTKEY("HM Client ID", Status, Type, "Project No.");
                                                                                 lvHandymanImportBuffer.SETRANGE("HM Client ID", HandymanSetup."Client Number Handyman");
                                                                                 lvHandymanImportBuffer.SETRANGE(Status, lvHandymanImportBuffer.Status::Imported);
                                                                                 lvHandymanImportBuffer.SETRANGE(Type, lvHandymanImportBuffer.Type::Project);
                                                                                 lvHandymanImportBuffer.SETRANGE("Project No.", Job."No.");
                                                                                 IF lvHandymanImportBuffer.FINDFIRST THEN
                                                                                   HSOrderNumber := FORMAT(lvHandymanImportBuffer.HSID, 0, 9)
                                                                                 ELSE
                                                                                   HSOrderNumber := '0';
                                                                               END;
                                                                                }

    { [{B771E6FA-846B-4472-8C24-150A36EDC923}];2 ;OrderHead           ;Element ;Text    ;
                                                  DataType=Code }

    { [{9D70EC2C-7FAA-407A-87A8-D26262A9C2C3}];3 ;OrderDate           ;Element ;Text    ;
                                                  DataType=Date;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OrderDate := FORMAT(Job."Creation Date", 0, 9) + 'T00:00:00';
                                                                               END;
                                                                                }

    { [{8ACA5C60-5255-44D3-8E8A-BB0ABA4A43B2}];3 ;InternalOrder       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InternalOrder := '0';
                                                                               END;
                                                                                }

    { [{AFC97D34-4E4C-4375-AC6C-8B525B7518F3}];3 ;FreeOrder           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 FreeOrder := '0';
                                                                                 IF (Job.Expediter = HandymanSetup."Free Order Expediter") THEN
                                                                                   FreeOrder := '1';
                                                                               END;
                                                                                }

    { [{3427CE5D-DA84-4A43-83B7-7ED76088C3A7}];3 ;Requsition          ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC143
                                                                               END;
                                                                                }

    { [{6DA0F26F-6D2A-4412-8E91-D3E350D32346}];3 ;OrderDelay          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OrderDelay := '-1';
                                                                               END;
                                                                                }

    { [{BBE93784-9707-43F8-88AD-80FE1DAFA9AF}];3 ;MainOrder           ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Job::Description }

    { [{A4AB8E4E-96FD-496C-A301-3B25892D5116}];3 ;CustomerReference   ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterAssignVariable=BEGIN
                                                                                  //RFC143
                                                                                END;
                                                                                 }

    { [{DF60B69D-D581-4307-8028-B79E16D35C56}];3 ;ShowInCalendar      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ShowInCalendar := '1';
                                                                               END;
                                                                                }

    { [{64433C94-BC4C-4094-AC1B-4D40EC5262ED}];3 ;CategoryList        ;Element ;Text     }

    { [{4A3DF041-E5AB-430B-A306-4FEC5152E388}];4 ;Category            ;Element ;Text     }

    { [{22ED3786-69DB-4D91-8196-3A7C7783BA26}];5 ;CategoryType        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CategoryType := '0';
                                                                               END;
                                                                                }

    { [{19898810-8697-40FD-947F-595E57FAEAD4}];5 ;CategoryID          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Job::Main Project }

    { [{E7FC2555-0AEB-422F-B0D6-EF6DB5C33FB7}];5 ;Name                ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 lvJob@1100285500 : Record 11072003;
                                                                               BEGIN
                                                                                 IF lvJob.GET(Job."Main Project") THEN
                                                                                   Name := lvJob.Description
                                                                                 ELSE
                                                                                   Name := '';
                                                                               END;
                                                                                }

    { [{C00CAAA2-DE63-4B80-BB76-8F20C57B8595}];5 ;Label               ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Label := 'Huvudprojekt';
                                                                               END;
                                                                                }

    { [{93772C38-ADD4-437F-A4F7-BA26855375BE}];5 ;Settings            ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Settings := '1';
                                                                               END;
                                                                                }

    { [{217686B2-C296-41D9-ABFF-562D84D7874A}];5 ;DepartmentID        ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Job::Global Dimension 1 Code }

    { [{D16531CB-E405-4267-8CDC-A7AD7DACD591}];4 ;Category            ;Element ;Text    ;
                                                  VariableName=Category2 }

    { [{458DABAE-D8BD-47E5-97B5-21429C73843C}];5 ;CategoryType        ;Element ;Text    ;
                                                  VariableName=CategoryType2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CategoryType2 := '1';
                                                                               END;
                                                                                }

    { [{30E24EA8-FB4B-490F-AA1F-6836CB20C2F1}];5 ;CategoryID          ;Element ;Text    ;
                                                  VariableName=CategoryIDDisc;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CategoryIDDisc := '';
                                                                                 IF Discipline.GET(Job.Discipline) THEN
                                                                                   CategoryIDDisc := HandymanSetup."Company Prefix" + '_' + Job.Discipline;

                                                                                 IF Job.Type <> '' THEN BEGIN
                                                                                    IF HandymanExportWL.GET(HandymanExportWL.Type::Type, Job.Type) THEN
                                                                                      CategoryIDDisc := HandymanSetup."Company Prefix" + '_T_' + Job.Type;
                                                                                 END;
                                                                               END;
                                                                                }

    { [{35CAB5C5-2231-4072-BDAC-788421BE25B1}];5 ;Name                ;Element ;Text    ;
                                                  VariableName=Name2;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 lvJob@1100285500 : Record 11072003;
                                                                               BEGIN
                                                                                 Name2 := '';
                                                                                 IF (Discipline.GET(Job.Discipline)) THEN Name2 := Discipline.Description;

                                                                                 IF (Job.Type <> '') THEN BEGIN
                                                                                    IF (HandymanExportWL.GET(HandymanExportWL.Type::Type, Job.Type)) THEN Name2 := Type.Description;
                                                                                 END;
                                                                               END;
                                                                                }

    { [{22356B4E-56AF-4A4B-9CA0-7D0B61F6D869}];5 ;Label               ;Element ;Text    ;
                                                  VariableName=Label2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Label2 := 'Disciplin';
                                                                               END;
                                                                                }

    { [{CC1A3BE9-79BA-45CD-A61B-81A780CDD49C}];5 ;Settings            ;Element ;Text    ;
                                                  VariableName=Settings2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Settings2 := '0';
                                                                               END;
                                                                                }

    { [{C722242E-3FE5-4908-839C-F23C75ACB38A}];5 ;DepartmentID        ;Element ;Text     }

    { [{5BA19158-E247-43C1-888F-D3BB2896AFAE}];3 ;Message             ;Element ;Text     }

    { [{FFF48CE8-452B-496D-95C7-7DECD109B0A6}];3 ;Workplace           ;Element ;Text     }

    { [{B39033A2-21EC-453F-BB25-E647AA4FA23B}];3 ;ContactName         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ProjectPrincipal@1100409000 : Record 11012005;
                                                                                 Contact@1100285000 : Record 5050;
                                                                               BEGIN
                                                                                 // IME-390
                                                                                 Job.CALCFIELDS("Principal Name");
                                                                                 ContactName := Job."Principal Name";
                                                                                 Telephone2 := Job."Mobile Phone No."; //RFC142
                                                                                 Telephone1 := Job."Phone No."; // 150825
                                                                                 IF ProjectPrincipal.GET(Job."No.", Job."Bill-to Customer No.") THEN BEGIN
                                                                                   ProjectPrincipal.CALCFIELDS("Contact Person Name");
                                                                                   IF (ProjectPrincipal."Contact Person Name" <> '') THEN
                                                                                     ContactName := ProjectPrincipal."Contact Person Name";
                                                                                     // 150825 ITERO.MH <<
                                                                                     IF (Contact.GET(ProjectPrincipal."Contact Person No.")) THEN BEGIN
                                                                                       Telephone2 := Contact."Mobile Phone No."; //RFC142
                                                                                       Telephone1 := Contact."Phone No.";
                                                                                     END;
                                                                                     // 150825 ITERO.MH >>
                                                                                 END;
                                                                                 IF Telephone1 = '' THEN Telephone1:= '-';
                                                                                 IF Telephone2 = '' THEN Telephone2:= '-';
                                                                               END;
                                                                                }

    { [{DE146C3D-8D30-4A3B-B0DE-6AE5C53F1D0A}];3 ;Telephone1          ;Element ;Text     }

    { [{BAAC0E20-737E-4FAB-B518-2CB8DDCA678D}];3 ;Telephone2          ;Element ;Text    ;
                                                  DataType=Text }

    { [{47C626B6-0C37-42EF-863A-3CF841AFB104}];3 ;Quote               ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Quote := '0';
                                                                               END;
                                                                                }

    { [{C85F86AB-38BE-4DAC-B240-79DA325996C3}];3 ;FixedPrice          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 FixedPrice := '0';
                                                                               END;
                                                                                }

    { [{599BD85C-706F-4E25-9A26-4A58E36B2A96}];3 ;VATRate             ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VATRate := '0'
                                                                               END;
                                                                                }

    { [{D4B217AA-427B-4E52-8182-7799524114E7}];3 ;Completed           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Completed := '0';
                                                                                 IF (DeactivateProject) THEN Completed := '1';
                                                                               END;
                                                                                }

    { [{7E8D0DB3-A51C-4826-854B-410E10986FB0}];3 ;StartDate           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 StartDate := FORMAT(Job."Starting Date", 0, 9) +  'T00:00:00';
                                                                               END;
                                                                                }

    { [{CA50AEBF-1B0C-4EA8-B118-DC4826C713DE}];3 ;FinishDate          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 FinishDate := FORMAT(Job."Ending Date", 0, 9) + 'T00:00:00';
                                                                               END;
                                                                                }

    { [{A40F4FA3-19ED-463F-906D-A280806FC620}];3 ;EstimatedHours      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EstimatedHours := '0';
                                                                               END;
                                                                                }

    { [{BBCCBAC8-EE4D-448C-832D-9F12A48507F6}];3 ;Manager             ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Job::Project Manager }

    { [{8F61974B-8902-49B7-99BD-C7A2046F9F0B}];3 ;DoNotSetAsPassive   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF (SetAsPassive) THEN
                                                                                    DoNotSetAsPassive := '0'
                                                                                 ELSE
                                                                                    DoNotSetAsPassive := '1'; //IME251
                                                                               END;
                                                                                }

    { [{F77E0430-9C16-4DBB-8AAF-EF85046D458C}];3 ;UpdateOrderDates    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 UpdateOrderDates := '0';
                                                                               END;
                                                                                }

    { [{389171A7-09DE-4626-8A0C-F2FAF1D54CBE}];3 ;UseKB1              ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 lvExtContract@1100285500 : Record 11012004;
                                                                               BEGIN
                                                                                 lvExtContract.SETRANGE("Project No.", Job."No.");
                                                                                 lvExtContract.SETFILTER(Status, '%1|%2', lvExtContract.Status::"Invoicing Allowed", lvExtContract.Status::Order);
                                                                                 IF NOT (lvExtContract.ISEMPTY) THEN
                                                                                    UseKB1 := '1'
                                                                                 ELSE
                                                                                    UseKB1 := '0';
                                                                               END;
                                                                                }

    { [{71BD2480-1E74-4AAA-96B1-ECE14CB8643E}];3 ;UseKB2              ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 lvProjectElement@1100285500 : Record 11012010;
                                                                               BEGIN
                                                                                 lvProjectElement.SETRANGE("Project No.", Job."No.");
                                                                                 lvProjectElement.SETRANGE(Blocked, FALSE);

                                                                                 IF NOT (lvProjectElement.ISEMPTY) THEN
                                                                                    UseKB2 := '1'
                                                                                 ELSE
                                                                                    UseKB2 := '0';
                                                                               END;
                                                                                }

    { [{CEC87FB1-3629-4C41-9390-C248FD0128BE}];3 ;UsePhase            ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Team Code".COUNT > 0) THEN
                                                                                    UsePhase := '1'
                                                                                 ELSE
                                                                                    UsePhase := '0';
                                                                               END;
                                                                                }

    { [{EB69AB76-96A0-494A-8FF8-827DAB4805F2}];3 ;KBInputRequired     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 KBInputRequired := '0';
                                                                               END;
                                                                                }

    { [{CD261768-CAB0-4AF5-AE71-EF4254A115E9}];3 ;Def_KB1             ;Element ;Text     }

    { [{AA8CED66-D4EF-4C3A-A099-5976E27D8460}];3 ;Def_KB2             ;Element ;Text     }

    { [{CC227286-B933-4889-B24E-A3651AE607BE}];3 ;Def_Phase           ;Element ;Text     }

    { [{77067D39-1661-4A93-8757-D61655C6E56A}];3 ;KB_ValueList        ;Element ;Text     }

    { [{51FBB0B8-3D9E-4EC2-89E2-F653399CCD20}];4 ;KB_Value            ;Element ;Table   ;
                                                  SourceTable=Table11012004;
                                                  SourceTableView=WHERE(Field60=FILTER(3|2));
                                                  LinkFields=Field10=FIELD(Field1);
                                                  LinkTable=Job;
                                                  MinOccurs=Zero }

    { [{AEF38E12-0F12-4860-8E34-9804C81520E3}];5 ;Level               ;Element ;Text    ;
                                                  VariableName=LevelExt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 LevelExt := '0';
                                                                               END;
                                                                                }

    { [{ED430B16-420F-4F72-AF95-9B624B37C776}];5 ;Value               ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Extension Contract::Contract No. }

    { [{09DAC8F2-6EBB-4791-AAFE-2ED7A61EC198}];5 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Extension Contract::Description }

    { [{0CE9F512-6E54-4A17-A605-A795E468B083}];5 ;Parent              ;Element ;Text    ;
                                                  VariableName=ParentExt }

    { [{EAEED390-E3C4-4777-8620-5996E2970634}];4 ;KB_Value            ;Element ;Table   ;
                                                  SourceTable=Table11012010;
                                                  SourceTableView=WHERE(Field400=CONST(No));
                                                  LinkFields=Field10=FIELD(Field1);
                                                  LinkTable=Job;
                                                  MinOccurs=Zero }

    { [{984CDA33-33EA-4D9D-BE19-CD525CA1F939}];5 ;Level               ;Element ;Text    ;
                                                  VariableName=LevelElement;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 LevelElement := '1';
                                                                               END;
                                                                                }

    { [{6D8E5517-4D4C-47A6-963E-F64BD5587B31}];5 ;Value               ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Project Element::Element }

    { [{4DBF3D65-B822-44EC-AC5A-8ADE57F1818D}];5 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Project Element::Description }

    { [{889D4B40-3647-4169-8FEC-896AC8F7C449}];5 ;Parent              ;Element ;Text    ;
                                                  VariableName=ParentElement }

    { [{00E446FF-ACE1-4FDC-B481-980629462A6B}];4 ;KB_Value            ;Element ;Table   ;
                                                  SourceTable=Table11128233;
                                                  MinOccurs=Zero }

    { [{C07F810F-D2D1-42CC-B4D1-41C0F675560D}];5 ;Level               ;Element ;Text    ;
                                                  VariableName=TeamCodeLevel;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 TeamCodeLevel := '2';
                                                                               END;
                                                                                }

    { [{E9EC8094-5029-4DA6-B507-5AD396DF596C}];5 ;Value               ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Team Code::Code }

    { [{A7D62809-5858-4C5D-9A23-4B32CF0FD0AF}];5 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Team Code::Description }

    { [{DBD29CE5-FE5F-409E-AE0A-7162C71AA89F}];5 ;Parent              ;Element ;Text    ;
                                                  VariableName=TeamCodeParent }

    { [{636CF6C0-40FE-48A1-BB34-59728FE4D0FD}];3 ;Location            ;Element ;Table   ;
                                                  VariableName=int_Location1;
                                                  SourceTable=Table2000000026;
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=VAR
                                                                         lvHandymanImportBuffer@1100409000 : Record 81624;
                                                                       BEGIN

                                                                         // IME-391 <<
                                                                         DoNotExportAddress := FALSE;
                                                                         lvHandymanImportBuffer.SETCURRENTKEY("HM Client ID", Status, Type, "Project No.");
                                                                         lvHandymanImportBuffer.SETRANGE("HM Client ID", HandymanSetup."Client Number Handyman");
                                                                         lvHandymanImportBuffer.SETRANGE(Status, lvHandymanImportBuffer.Status::Imported);
                                                                         lvHandymanImportBuffer.SETRANGE(Type, lvHandymanImportBuffer.Type::Project);
                                                                         lvHandymanImportBuffer.SETRANGE("Project No.", Job."No.");
                                                                         IF (lvHandymanImportBuffer.FINDFIRST()) THEN BEGIN
                                                                            IF (Job.Address = lvHandymanImportBuffer."Address 1") THEN DoNotExportAddress := TRUE;
                                                                         END;
                                                                         // IME-391 >>


                                                                         IF (STRLEN(Job.Address) > 40) OR (STRLEN(Job."Address 2") > 40) THEN BEGIN
                                                                            int_Location1.SETFILTER(Number, '1..-1');
                                                                            int_Location2.SETFILTER(Number, '1');
                                                                         END ELSE BEGIN
                                                                            int_Location1.SETFILTER(Number, '1');
                                                                            int_Location2.SETFILTER(Number, '1..-1');
                                                                         END;

                                                                         // IME-391 <<
                                                                         IF (DoNotExportAddress) THEN BEGIN
                                                                            int_Location1.SETFILTER(Number, '1..-1');
                                                                            int_Location2.SETFILTER(Number, '1..-1');
                                                                         END;
                                                                         // IME-391 >>
                                                                       END;
                                                                        }

    { [{B097F7B8-EF4E-40FF-94DA-38D8D1641785}];4 ;Address1            ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Address1 := COPYSTR(Job.Address, 1, 40);
                                                                               END;
                                                                                }

    { [{BFF452C2-7B4D-46AE-8D42-13E719DC0392}];4 ;Address2            ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Address2 := COPYSTR(Job."Address 2", 1, 40);
                                                                               END;
                                                                                }

    { [{77A98C7C-9EBC-4A52-8E61-B1A494F7BA8F}];4 ;PostalCode          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Job::Post Code }

    { [{28A5ACCC-AC95-4462-9BA2-AF247DD6D726}];4 ;PostalArea          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Job::City }

    { [{E05A75BB-5806-43D2-A270-2D1990D72DAC}];4 ;Country             ;Element ;Text    ;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF (Job."Country/Region Code" <> '') THEN Country := Job."Country/Region Code"
                                                                                 ELSE BEGIN
                                                                                    CompanyInformation.GET();
                                                                                    Country := CompanyInformation."Country/Region Code";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{AB199F35-B4C5-40EB-A125-6ABD30B74068}];3 ;Location            ;Element ;Table   ;
                                                  VariableName=int_Location2;
                                                  SourceTable=Table2000000026;
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF (STRLEN(Job.Address) > 40) OR (STRLEN(Job."Address 2") > 40) THEN BEGIN
                                                                            int_Location1.SETFILTER(Number, '1..-1');
                                                                            int_Location2.SETFILTER(Number, '1');
                                                                         END ELSE BEGIN
                                                                            int_Location1.SETFILTER(Number, '1');
                                                                            int_Location2.SETFILTER(Number, '1..-1');
                                                                         END;

                                                                         // IME-391 <<
                                                                         IF (DoNotExportAddress) THEN BEGIN
                                                                            int_Location1.SETFILTER(Number, '1..-1');
                                                                            int_Location2.SETFILTER(Number, '1..-1');
                                                                         END;
                                                                         // IME-391 >>
                                                                       END;
                                                                        }

    { [{F4C2D00E-4E22-423A-879E-53253FCC899D}];4 ;Address1            ;Element ;Text    ;
                                                  VariableName=Adress1_2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Adress1_2 := COPYSTR(Job.Address, 1, 40);
                                                                               END;
                                                                                }

    { [{79B6AF68-6813-4004-9692-661DD11563E3}];4 ;Address2            ;Element ;Text    ;
                                                  VariableName=Adress2_2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Adress2_2 := COPYSTR(Job."Address 2", 1, 40);
                                                                               END;
                                                                                }

    { [{AAB3E9E0-C46E-4A06-8938-1CB98A82E69B}];4 ;PostalCode          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Job::Post Code }

    { [{CF6E4E2E-7D0A-4936-ADF0-5516307C0AFC}];4 ;PostalArea          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Job::City }

    { [{08C97D9A-2EC3-4378-9D37-05FA6D2DBD5B}];4 ;Address3            ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Address3 := COPYSTR(Job.Address, 40);
                                                                               END;
                                                                                }

    { [{85F25407-3608-441D-840A-30CBF8818429}];4 ;Address4            ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Address4 := COPYSTR(Job."Address 2", 40);
                                                                               END;
                                                                                }

    { [{38AE33F4-FD53-44DB-AC91-497924EE17AF}];4 ;Country             ;Element ;Text    ;
                                                  VariableName=Country_2;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF (Job."Country/Region Code" <> '') THEN Country := Job."Country/Region Code"
                                                                                 ELSE BEGIN
                                                                                    CompanyInformation.GET();
                                                                                    Country := CompanyInformation."Country/Region Code";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{331E6F1F-823A-4ED5-A56F-49BD22FB9550}];3 ;Department          ;Element ;Text     }

    { [{CBFE360F-5513-4EDE-B3B4-87E072A26727}];4 ;HSDepartmentID      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 HSDepartmentID := '0';
                                                                               END;
                                                                                }

    { [{B747003D-685A-4DF2-8F45-5B8E9B3C4037}];4 ;DepartmentID        ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Job::Global Dimension 1 Code }

    { [{1B137977-6B82-42E6-9FC4-1E87567C0A24}];2 ;Customer            ;Element ;Text    ;
                                                  VariableName=Customertxt }

    { [{8B0B2D1E-E222-425F-8E48-F42EC3E17676}];3 ;CustomerNo          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CustomerNo := Job."Bill-to Customer No.";
                                                                                 IF (Customer.GET(CustomerNo)) THEN;
                                                                               END;
                                                                                }

    { [{2ACBD6DA-09BE-4471-B23D-CEF5B4DA960D}];3 ;CustomerName        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Job::Principal Name }

    { [{B3298B4B-674A-414A-B6D8-9CE8665744A1}];3 ;Telephone1          ;Element ;Text    ;
                                                  VariableName=Telephone1_2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Telephone1_2 := Customer."Phone No.";
                                                                               END;
                                                                                }

    { [{BECB782B-DC88-49A7-B813-A0A07C6069B8}];3 ;Telephone2          ;Element ;Text    ;
                                                  VariableName=Telephone2_2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Telephone2_2 := Customer."Phone No. 2";
                                                                               END;
                                                                                }

    { [{79F9AE9E-EB9D-4913-8E19-7D70B9E6CFA4}];3 ;Email               ;Element ;Text    ;
                                                  VariableName=Email1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Email1 := Customer."E-Mail";
                                                                               END;
                                                                                }

    { [{0D97AE45-F4CA-40B5-9FAF-C6127E5374E9}];3 ;VATNumber           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VATNumber := Customer."VAT Registration No.";
                                                                               END;
                                                                                }

    { [{35D00665-3500-4EA5-B280-795409453F6E}];3 ;ContactList         ;Element ;Text     }

    { [{F2A30718-8AD9-4B6D-9C1D-BDB48F59C1A3}];4 ;Contact             ;Element ;Table   ;
                                                  VariableName=Contact23;
                                                  SourceTable=Table5050;
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=BEGIN


                                                                         ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                                         ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
                                                                         ContBusRel.SETRANGE("No.",Customer."No.");
                                                                         IF ContBusRel.FINDFIRST THEN BEGIN
                                                                            Contact23.SETRANGE("Company No.", ContBusRel."Contact No.");
                                                                            Contact23.SETFILTER("Person No.", '<>%1', '');
                                                                         END ELSE BEGIN
                                                                            Contact23.SETRANGE("No.", 'inget');
                                                                         END;
                                                                       END;
                                                                        }

    { [{2A79E4CE-7756-4364-90B1-D454DAE7C306}];5 ;ContactID           ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Contact23::No. }

    { [{7CB65F53-3472-4A09-9F93-ED5CAFF9B1F4}];5 ;ContactName         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Contact23::Name }

    { [{CC975BDB-8EA5-4694-93BF-2C79E20C8EE1}];5 ;Email               ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Contact23::E-Mail }

    { [{2F1D72A8-5B09-46AE-A35C-5803BC1F4846}];5 ;Telephone1          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Contact23::Phone No. }

    { [{55F02C1E-5B6A-4C2C-9883-F81A4ED83A60}];5 ;Telephone2          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Contact23::Phone No. 2 }

    { [{02F57FE4-16B9-44B4-B211-23B50F5C4B7C}];2 ;ParticipantList     ;Element ;Text     }

    { [{6BFE01D9-6C5F-4963-AFC1-BBFE4E3DAA97}];3 ;Participant         ;Element ;Table   ;
                                                  VariableName=ParticipantInt;
                                                  SourceTable=Table2000000026;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF (Job.Expediter = HandymanSetup."Free Order Expediter") OR (Job.Expediter = HandymanSetup."HM User Expediter") OR (Job.Expediter = '') THEN
                                                                            ParticipantInt.SETFILTER(Number, '1..-1') ELSE ParticipantInt.SETFILTER(Number, '1');
                                                                       END;
                                                                        }

    { [{A572DAA7-F593-4339-98DE-8AE47A24C085}];4 ;EmployeeNo          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Job::Expediter }

    { [{DA9B136E-F7B3-4D9C-A6A8-2DD3E08580D4}];4 ;MainParticipant     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 MainParticipant := '1';
                                                                               END;
                                                                                }

    { [{69D5551C-38D0-4221-A008-EAAD0F7EFB29}];2 ;OrderDescriptionList;Element ;Text     }

    { [{4D3C822C-8BF1-4E34-8DDE-DD0FECB0FB41}];3 ;OrderDescription    ;Element ;Text    ;
                                                  VariableName=OrderDesc1;
                                                  MinOccurs=Zero }

    { [{95E9F765-BA26-42AC-A7D2-9D537BA4BFA1}];4 ;HSDescriptionID     ;Element ;Text    ;
                                                  VariableName=HSDesc1;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 lvHandymanImportBuffer@1100285000 : Record 81624;
                                                                               BEGIN
                                                                                 lvHandymanImportBuffer.SETRANGE(Status, lvHandymanImportBuffer.Status::Imported);
                                                                                 lvHandymanImportBuffer.SETRANGE(Type, lvHandymanImportBuffer.Type::Comment);
                                                                                 lvHandymanImportBuffer.SETRANGE("Description ID", Job."No." + '_00000');
                                                                                 IF (lvHandymanImportBuffer.FINDFIRST) THEN HSDesc1 := FORMAT(lvHandymanImportBuffer.HSID, 0, 9) ELSE HSDesc1 := '0';
                                                                               END;
                                                                                }

    { [{2B64980A-01F8-40B8-9E41-618D53996DC7}];4 ;DescriptionID       ;Element ;Text    ;
                                                  VariableName=DescID1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DescID1 := Job."No." + '_00000';
                                                                               END;
                                                                                }

    { [{46567EF6-BA58-4095-865D-4BF9E13528DC}];4 ;Text                ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Job::Description }

    { [{FD29508C-6970-4A10-9460-F2FBB207AEF8}];4 ;DateTime            ;Element ;Text    ;
                                                  VariableName=DateTimeDesc;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DateTimeDesc := FORMAT(Job."Last Date Modified", 0 ,9) + 'T' + COPYSTR(FORMAT(Job."Time Last Modified", 0, 9), 1, 8);
                                                                               END;
                                                                                }

    { [{8E855AA1-5684-49DE-9162-2DD980A8E74D}];3 ;OrderDescription    ;Element ;Table   ;
                                                  VariableName=OrderDesc2;
                                                  SourceTable=Table2000000026;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF (Job."Description 2" = '') THEN OrderDesc2.SETFILTER(Number, '1..-1') ELSE OrderDesc2.SETFILTER(Number, '1');
                                                                       END;
                                                                        }

    { [{14057906-DC2D-4B87-B745-653FAFBED2E6}];4 ;HSDescriptionID     ;Element ;Text    ;
                                                  VariableName=HSDesc2;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 lvHandymanImportBuffer@1100285000 : Record 81624;
                                                                               BEGIN
                                                                                 lvHandymanImportBuffer.SETRANGE(Status, lvHandymanImportBuffer.Status::Imported);
                                                                                 lvHandymanImportBuffer.SETRANGE(Type, lvHandymanImportBuffer.Type::Comment);
                                                                                 lvHandymanImportBuffer.SETRANGE("Description ID", Job."No." + '_00001');
                                                                                 IF (lvHandymanImportBuffer.FINDFIRST) THEN HSDesc2 := FORMAT(lvHandymanImportBuffer.HSID, 0, 9) ELSE HSDesc2 := '0';
                                                                               END;
                                                                                }

    { [{E80AB179-5EB4-4475-8B41-B895C261E2E1}];4 ;DescriptionID       ;Element ;Text    ;
                                                  VariableName=DescID2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DescID2 := Job."No." + '_00001';
                                                                               END;
                                                                                }

    { [{25359AC9-F985-4F5E-A692-3A43773AFE31}];4 ;Text                ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Job::Description 2 }

    { [{AE91ED7F-09BC-483C-AFE4-217044862272}];4 ;DateTime            ;Element ;Text    ;
                                                  VariableName=DateTimeDesc2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DateTimeDesc2 := DateTimeDesc;
                                                                               END;
                                                                                }

    { [{A038925B-DB39-4BA5-861F-198F31DB01DF}];3 ;OrderDescription    ;Element ;Table   ;
                                                  SourceTable=Table97;
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         "Comment Line".SETRANGE("Table Name", "Comment Line"."Table Name"::Job);
                                                                         "Comment Line".SETRANGE("No.", Job."No.");
                                                                         "Comment Line".SETFILTER(Code, HandymanSetup."Comment Code Filter Export");//'IT|OB|HM');
                                                                       END;
                                                                        }

    { [{6753BEBF-3A77-4CB5-A020-62497EC0052C}];4 ;HSDescriptionID     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 lvHandymanImportBuffer@1100285000 : Record 81624;
                                                                               BEGIN
                                                                                 lvHandymanImportBuffer.SETCURRENTKEY(Status, "Description ID");
                                                                                 lvHandymanImportBuffer.SETRANGE("Description ID", Job."No." + '_' + FORMAT("Comment Line"."Line No."));
                                                                                 //lvHandymanImportBuffer.SETRANGE(Status, lvHandymanImportBuffer.Status::Imported);
                                                                                 IF (lvHandymanImportBuffer.FINDFIRST) THEN HSDescriptionID := FORMAT(lvHandymanImportBuffer.HSID, 0, 9) ELSE HSDescriptionID := '0';
                                                                               END;
                                                                                }

    { [{D441B105-6913-4BFB-87E6-FC4EE2264EF3}];4 ;DescriptionID       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DescriptionID := Job."No." + '_' + FORMAT("Comment Line"."Line No.");
                                                                               END;
                                                                                }

    { [{5B218D79-648C-4D99-B93D-44A2EDACA1F7}];4 ;Text                ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Comment Line::Comment }

    { [{524E888F-C84F-4F22-8673-C5590F07A446}];4 ;DateTime            ;Element ;Text    ;
                                                  VariableName=DateTimeComment;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DateTimeComment := FORMAT("Comment Line".Date, 0 ,9) + 'T' + COPYSTR(FORMAT("Comment Line"."Time Created", 0, 9), 1, 8);
                                                                                 // IME-411 << ***
                                                                                 IF ("Comment Line".Date = 0D) THEN DateTimeComment := FORMAT(Job."Last Date Modified", 0 ,9) + 'T00:00:00';
                                                                                 IF ("Comment Line"."Time Created" = 0T) THEN DateTimeComment += '00:00:00';
                                                                                 // IME-411 >> ***
                                                                               END;
                                                                                }

    { [{93AD9D66-A943-477A-83C3-6780052CF3ED}];4 ;Internal            ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Comment Line".Code = 'IT') OR (("Comment Line".Code = HandymanSetup."Handyman Internal Code")) THEN Internal := '1' ELSE Internal := '0';
                                                                               END;
                                                                                }

    { [{436CBB70-7002-4E28-827F-A79B31BD929D}];2 ;MaterialList        ;Element ;Text     }

    { [{437485E7-239F-47DF-901E-B3A74C0144DC}];3 ;Material            ;Element ;Table   ;
                                                  SourceTable=Table39;
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         "Purchase Line".SETRANGE("Job No.", Job."No.");  // RFC015
                                                                         "Purchase Line".SETRANGE("Document Type", "Purchase Line"."Document Type"::Order); // RFC015
                                                                         // ITERO.MH 150107
                                                                         IF DoNotExportMaterialLines(Job) THEN // RFC-130 Changed to function for criteria of material export
                                                                            "Purchase Line".SETRANGE("Line No.", -1); // Hides the purchase line

                                                                         //IF (Job."Settlement Method" = Job."Settlement Method"::"Fixed Price") THEN BEGIN
                                                                         //   "Purchase Line".SETRANGE("Line No.", -1); // Hides the purchase line
                                                                         //END;
                                                                       END;
                                                                        }

    { [{AC96A2AB-0C98-4771-9307-62115E528BC6}];4 ;HSMaterialID        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 HSMaterialID := '0';
                                                                               END;
                                                                                }

    { [{0C0B0199-DCD4-4D52-841B-3D5149AB38C7}];4 ;MaterialID          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 MaterialID := "Purchase Line"."Document No." + '#' + FORMAT("Purchase Line"."Line No.");
                                                                               END;
                                                                                }

    { [{8ED4AEAC-D8AC-41CA-9BF4-62CE9F49DF3D}];4 ;StoreNo             ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 StoreNo := '';
                                                                               END;
                                                                                }

    { [{74FBA6B1-3AC4-4BC0-9B72-E75F806B3D7C}];4 ;WholesalerNo        ;Element ;Text    ;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 WholesalerNo := HandymanSetup."Company Prefix" + '_' + "Purchase Line"."Vendor (Trade Item)";
                                                                               END;
                                                                                }

    { [{B93F9D50-87B8-42F9-98A8-44EF149CFEF7}];4 ;ItemNo              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Line::Trade Item }

    { [{9A2FABB3-A9D0-4BAC-B7D1-9C598E15338E}];4 ;Date                ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Purchase Line"."Expected Receipt Date" = 0D) THEN BEGIN
                                                                                    IF ("Purchase Line"."Order Date" <> 0D) THEN
                                                                                       Date := FORMAT("Purchase Line"."Order Date", 0, 9) +  'T00:00:00'
                                                                                    ELSE
                                                                                       Date := FORMAT(TODAY, 0, 9) +  'T00:00:00';
                                                                                 END
                                                                                 ELSE Date := FORMAT("Purchase Line"."Expected Receipt Date", 0, 9) +  'T00:00:00';
                                                                               END;
                                                                                }

    { [{7975AA90-CB00-4FFA-A32B-4CCFE2731953}];4 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Line::Description }

    { [{5114792D-1823-449C-9A2F-D4F549CBCB92}];4 ;Unit                ;Element ;Text    ;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Unit := COPYSTR("Purchase Line"."Unit of Measure Code", 1, 4);
                                                                               END;
                                                                                }

    { [{DC45D014-F96D-41C8-8BDE-D85C3E71A6E1}];4 ;Price               ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Price := '0';
                                                                               END;
                                                                                }

    { [{C0DEC044-520D-4918-A92D-59D36A7627DD}];4 ;CustomerPrice       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CustomerPrice := '0';
                                                                               END;
                                                                                }

    { [{B1695521-07D4-4907-8B74-6D7748C420A0}];4 ;VATRate             ;Element ;Text    ;
                                                  VariableName=VATRateMaterial;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VATRateMaterial := '0';
                                                                               END;
                                                                                }

    { [{DD3E9587-6440-4483-A2A8-C52EC8A8F552}];4 ;AgreedPrice         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AgreedPrice := '0';
                                                                               END;
                                                                                }

    { [{0BA13AD5-E52F-49C4-86C3-94B957737353}];4 ;Quantity            ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Quantity := FORMAT("Purchase Line".Quantity, 0, 9);
                                                                               END;
                                                                                }

    { [{7E67D8FD-7642-43AC-A57C-C5A3C66EF1D0}];4 ;Reference           ;Element ;Text     }

    { [{6238C798-B6BD-46AB-A048-7696A29D57FC}];4 ;KB1                 ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Line::Extension Contract }

    { [{30A0A1AB-B213-4180-B519-088462ECF36F}];4 ;KB2                 ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Line::Element }

    { [{B90EF4E5-868B-4DBE-9B49-28BF6E9EE359}];4 ;Phase               ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Phase := '';
                                                                               END;
                                                                                }

    { [{50DFC501-AE2A-4F9A-B11D-B86A2DAEC126}];3 ;Material            ;Element ;Table   ;
                                                  SourceTable=Table11127980;
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=BEGIN

                                                                         // RFC-131 NEw export of Purchase Header
                                                                         "Symbrio Purchase Inv. Header".SETFILTER(OrderHeadID, '=%1', '');

                                                                         // 160825 RFC-130 <<
                                                                         IF DoNotExportMaterialLines(Job) THEN // RFC-130 Changed to function for criteria of material export
                                                                            "Symbrio Purchase Inv. Header".SETRANGE(InvoiceHeadID, '--o--');
                                                                         // 160825 RFC-130 >>
                                                                       END;

                                                  Export::OnAfterGetRecord=VAR
                                                                             SymbrioPurchaseInvLine@1100285100 : Record 11127981;
                                                                           BEGIN


                                                                             SymbrioPurchaseInvLine.SETRANGE(InvoiceHeadID, "Symbrio Purchase Inv. Header".InvoiceHeadID);
                                                                             SymbrioPurchaseInvLine.SETRANGE(OrderHeadID, "Symbrio Purchase Inv. Header".OrderHeadID);
                                                                             SymbrioPurchaseInvLine.SETRANGE("DateTime Received", "Symbrio Purchase Inv. Header"."DateTime Received");
                                                                             SymbrioPurchaseInvLine.SETRANGE("Date Received", "Symbrio Purchase Inv. Header"."Date Received");
                                                                             SymbrioPurchaseInvLine.SETRANGE("Time Received", "Symbrio Purchase Inv. Header"."Time Received");
                                                                             SymbrioPurchaseInvLine.SETRANGE(AccountRefProject, Job."No.");
                                                                             IF SymbrioPurchaseInvLine.ISEMPTY THEN currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{7D2F133B-014D-44E4-A1DA-9E3CB4ABBE31}];4 ;HSMaterialID        ;Element ;Text    ;
                                                  VariableName=HSMaterialID2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 HSMaterialID2 := '0';
                                                                               END;
                                                                                }

    { [{F215F2EA-0EC1-4617-965A-DC4ADBA5A796}];4 ;MaterialID          ;Element ;Text    ;
                                                  VariableName=MaterialID2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 MaterialID2 := '###_' + "Symbrio Purchase Inv. Header".InvoiceHeadID;
                                                                               END;
                                                                                }

    { [{51E62F43-7692-44C0-8A14-E9D7D93AD49B}];4 ;StoreNo             ;Element ;Text    ;
                                                  VariableName=StoreNo2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 StoreNo2 := '';
                                                                               END;
                                                                                }

    { [{EAB6BECC-94A0-4349-B474-0C625E57AD92}];4 ;WholesalerNo        ;Element ;Text    ;
                                                  VariableName=WholesalerNo2;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 WholesalerNo2 := '';
                                                                               END;
                                                                                }

    { [{91534D5C-5684-4508-BC82-BA91D712144F}];4 ;ItemNo              ;Element ;Text    ;
                                                  VariableName=ItemNo2;
                                                  DataType=Code }

    { [{3979E5DA-2D68-4C81-875D-15B4E813A368}];4 ;Date                ;Element ;Text    ;
                                                  VariableName=Date2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Symbrio Purchase Inv. Header"."Date Received" <> 0D THEN
                                                                                   Date2 := FORMAT("Symbrio Purchase Inv. Header"."Date Received", 0, 9) +  'T00:00:00'
                                                                                 ELSE
                                                                                   Date2 := FORMAT(TODAY, 0, 9) +  'T00:00:00';
                                                                               END;
                                                                                }

    { [{E7B847BF-C10E-49D9-BF88-83B8FF5FEF19}];4 ;Description         ;Element ;Text    ;
                                                  VariableName=Description2;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Description2 :=  '* ' +  "Symbrio Purchase Inv. Header".SupplierInvoiceNo+ ' ' + "Symbrio Purchase Inv. Header".SupplierCompanyName;
                                                                               END;
                                                                                }

    { [{CB2E703A-E377-461F-8F48-A4C6199353DA}];4 ;Unit                ;Element ;Text    ;
                                                  VariableName=Unit2;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //Unit := COPYSTR("Purchase Line"."Unit of Measure Code", 1, 4);
                                                                               END;
                                                                                }

    { [{EC4D5F39-55EB-4C6B-9366-03BEA524F566}];4 ;Price               ;Element ;Text    ;
                                                  VariableName=Price2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Price2 := '0';
                                                                               END;
                                                                                }

    { [{E69B8DD9-59F1-450F-BC85-071EE179F727}];4 ;CustomerPrice       ;Element ;Text    ;
                                                  VariableName=CustomerPrice2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CustomerPrice2 := '0';
                                                                               END;
                                                                                }

    { [{E65B8C2B-8D3D-40E2-BB7E-5F024A9B27D8}];4 ;VATRate             ;Element ;Text    ;
                                                  VariableName=VATRateMaterial2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VATRateMaterial2 := '0';
                                                                               END;
                                                                                }

    { [{24932124-1671-4C0A-84DF-7E98F992BBAF}];4 ;AgreedPrice         ;Element ;Text    ;
                                                  VariableName=AgreedPrice2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AgreedPrice2 := '0';
                                                                               END;
                                                                                }

    { [{18EDDE78-CBB9-4611-8F8F-3AE96CFED88F}];4 ;Quantity            ;Element ;Text    ;
                                                  VariableName=Quantity2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Quantity2 := '1';//FORMAT("Purchase Line".Quantity, 0, 9);
                                                                               END;
                                                                                }

    { [{3AFF40BC-0626-498C-AB7B-EE9EE9EAEB16}];4 ;Reference           ;Element ;Text    ;
                                                  VariableName=Reference2 }

    { [{10851B77-AB95-4230-BFC2-574E9C993800}];4 ;KB1                 ;Element ;Text    ;
                                                  VariableName=KB12;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 KB12 := '';//"Purchase Header".Element;
                                                                               END;
                                                                                }

    { [{8A6E7AEF-98FF-4554-866A-163E27BAEFD9}];4 ;KB2                 ;Element ;Text    ;
                                                  VariableName=KB22;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN

                                                                                 KB22 := '';
                                                                               END;
                                                                                }

    { [{98B942C6-F7A4-4DA7-8B3C-071F889667BC}];4 ;Phase               ;Element ;Text    ;
                                                  VariableName=Phase2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Phase2 := '';
                                                                               END;
                                                                                }

    { [{3ECCD222-3F4B-4C1E-9338-B57123399500}];2 ;SalaryCodeRegistrationList;Element;Text;
                                                  VariableName=<SalaryCodeRegistrationList> }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Discipline@1100285500 : Record 11020204;
      Customer@1100285501 : Record 18;
      ContBusRel@1100285502 : Record 5054;
      HandymanSetup@1100285000 : Record 81609;
      CompanyInformation@1100285001 : Record 79;
      HandymanExportWL@1100285002 : Record 81631;
      Type@1100285003 : Record 11012006;
      DeactivateProject@1100285503 : Boolean;
      SetAsPassive@1100285004 : Boolean;
      DoNotExportAddress@1100409000 : Boolean;

    PROCEDURE SetProject@1100285500(JobNo@1100285500 : Code[30];Deactivate@1100285501 : Boolean);
    BEGIN
      Job.GET(JobNo);
      Job.SETRECFILTER;
      DeactivateProject := Deactivate;
      SetAsPassive := FALSE;
      IF (Deactivate) AND (Job."Project Status" = Job."Project Status"::"Administrative Finished") THEN SetAsPassive := TRUE;
    END;

    LOCAL PROCEDURE DoNotExportMaterialLines@1100285100(VAR Job@1100285102 : Record 11072003) : Boolean;
    VAR
      HandymanSetup@1100285100 : Record 81609;
      CommentLine@1100285101 : Record 97;
    BEGIN
      IF Job."Settlement Method" <> Job."Settlement Method"::"Fixed Price" THEN EXIT(FALSE); // Always export non-fixed price projects
      HandymanSetup.GET;
      IF (HandymanSetup."Material Export Comment Code" = '') THEN EXIT(TRUE);
      CommentLine.SETRANGE("Table Name", CommentLine."Table Name"::Job);
      CommentLine.SETRANGE("No.", Job."No.");
      CommentLine.SETRANGE(Code, HandymanSetup."Material Export Comment Code");
      EXIT(CommentLine.ISEMPTY);
    END;

    BEGIN
    {
      141116 ITERO.MH IME214 Correction of Project Export without blank line
      141210 ITERO.MH IME251 Added field DoNetSetAsPassive
      150107 ITERO.MH IME263 Added table view filter on Elmement And Extension Contract
                      IME265 Added code for filter on Purchase Line
      150303 ITERO.MH Added IF () on Get() to remove potential bugs
      150413 ITERO.MH Added new Location element with to send or not send Address 3 & 4
                      Added trigger for DoNotSetAsPassive from Handyman Mgmt
      150820 ITERO.MH IME-390, IME-391
      150825 ITERO.MH IME-390 Changed Telephone to be exported from Contact
      150929 ITERO.MH IME-411 Added more possibilities to populate date on comment element
                      RFC015: Only export PurchaseLine type Order
      151012 ITERO.MH RFC048: Added field MainOrder with Description of project
      160628 ITERO.MH RFC-130 NEw criteria for export of material: return false of DoNotExportMaterialLines()
                              Function adds new criteria based on material comment code to trigger export of some fixed price projects too
      160713 ITERO.MH RFC-131 New addition of material export: Purchase Invoices on a seperate line
      160825 ITERO.MH RFC-130 Added criteria for material export on RFC-131
      180427 ORANGO.DL RFC143 handle export of new fields CustomerReference, Requsition
      180427 ORANGO.DL RFC142 handle export of new field Telephone1
    }
    END.
  }
}

