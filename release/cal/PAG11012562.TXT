OBJECT Page 11012562 Plant Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Zeilen;
               ENU=Lines;
               NLD=Regels;
               NOR=Rader;
               SVE=Rader];
    SourceTable=Table11012557;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             PageFieldsEditable := TRUE;
             PlantTypeEditable := TRUE;
             PlantNoEditable := TRUE;
             Description2Editable := TRUE;
             ToLocationEditable := TRUE;
             AskedQuantityEditable := TRUE;
             QtyToReceiveEditable := TRUE;
             RentalShiftDatesEditable := TRUE;
             PurchaseFieldsEditable := TRUE;
             SalesRateEditable := TRUE;
             BuyBackRateEditable := TRUE;
             PlantFieldsEditable := TRUE;
             ItemFieldsEditable := TRUE;
             ItemAmountEditable := TRUE;
             ItemNewLocationCodeEditable := TRUE;

             AskedQuantityVisible := TRUE;
             QtyToReceiveVisible := TRUE;
             QuantityInventoryVisible := TRUE;
             QuantityDamagedVisible := TRUE;
             QuantityExitVisible := TRUE;
             ReasonCodeExitVisible := TRUE;
             FromRateCodeVisible := TRUE;
             ToRateCodeVisible := TRUE;
             ItemFieldsVisible := TRUE;
             ItemNewLocationCodeVisible := TRUE;
             ItemInventoryVisible := TRUE;

             CommentCPOrderEnable := TRUE;
             OrderPickingStatusEnable := TRUE;

             ProjectStockEditable := TRUE;
             DeliverEditable := TRUE;
             ShipToLocationEditable := TRUE;
             CollectionPointEditable := TRUE;
           END;

    OnOpenPage=BEGIN
                 UserSetup.GET(USERID);  //*DP00183
                 PlantSetup.GET;
                 SalesRateEditable := PlantSetup."Change Sales Rate";
                 BuyBackRateEditable := PlantSetup."Change Buy Back Rate";
                 FromRateCodeVisible := PlantSetup."Rate Codes";
                 ToRateCodeVisible := PlantSetup."Rate Codes";
                 OrderPickingStatusEnable := PlantSetup."PO-Picking Bar Code Scanner";
                 CommentCPOrderEnable := PlantSetup."Comment CP Order";

                 IF "Plant Order No." <> '' THEN BEGIN
                   PlantOrderRec.GET("Plant Order No.");
                   IF PlantOrderRec.Posted THEN
                     CurrPage.EDITABLE(FALSE);
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       SetDateFilter;
                       CALCFIELDS(Bulk,"Stock Plant No. on From Loc.","Stock Plant Type on From Loc.","Stock Rate Code on From Loc.");
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  UpdateAfterAddLinkedPlant := FALSE;  //*01-07-2010  Sometimes problem if only items inserted
                  InitRecord;
                  Type := xRec.Type;
                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=VAR
                     PlantOrderLine@1100529001 : Record 11012557;
                   BEGIN
                     //*DP00183.sn
                     IF (UserSetup."Plant Category Filter (Rem.PO)" <> '') THEN BEGIN
                       CALCFIELDS("Plant Order Type");
                       IF ("Plant Order Type" = "Plant Order Type"::Removal) THEN BEGIN
                         IF PlantOrderLine.GET("Plant Order No.", "Line No.") THEN BEGIN
                           PlantOrderLine.SETRANGE("Plant Order No.", "Plant Order No.");
                           PlantOrderLine.FINDLAST;
                           "Line No." := PlantOrderLine."Line No." + 10000;
                         END;
                       END;
                     END;
                     //*DP00183.sn
                     //AddStandardItemOnInsertRecord();  //*16163.o
                     //AddStandardItemOnInsertRecord('I');  //*16163.n  I=Insert  //*01-07-2010.o
                     AddLinkedPlantTypeStndItemMgt.InsertOnPlantOrder(Rec, 0);  //*01-07-2010  0=Insert
                   END;

    OnModifyRecord=BEGIN
                     //AddStandardItemOnInsertRecord('M');  //*16163.n  M=Modify  //*01-07-2010.o
                     IF AddLinkedPlantTypeStndItemMgt.InsertOnPlantOrder(Rec, 1) THEN  //*01-07-2010  1=Modify
                       UpdateAfterAddLinkedPlant := TRUE;  //* Sometimes the form is not updated after Modify, therefore this is done
                                                           //* in 'OnAfterGetCurrRecord'. Because 'CurrPage.UPDATE' not allowed in OnModify!.
                   END;

    OnDeleteRecord=BEGIN
                     IF PlantOrderRec.GET("Plant Order No.") THEN BEGIN
                       PlantOrderRec.TESTFIELD(Posted, FALSE);
                       //* Ondanks dat subform op niet editable is gezet was verwijderen toch mogelijk
                       IF PlantOrderRec.Status >= PlantOrderRec.Status::Released THEN
                         PlantOrderRec.FIELDERROR(Status);
                     END;
                     ModifyAllowedOnOrderPickStatus(0);  //DP00688
                   END;

    ActionList=ACTIONS
    {
      { 1100409002;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100529003;1 ;ActionGroup;
                      CaptionML=[DEU=&Zeile;
                                 ENU=&Line;
                                 NLD=&Regel;
                                 NOR=&Linje;
                                 SVE=Ra&d] }
      { 1100529004;2 ;Action    ;
                      CaptionML=[DEU=Bemerkungen;
                                 ENU=Comments;
                                 NLD=Opmerkingen;
                                 NOR=Merknader;
                                 SVE=Kommentar];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 CommentSheet(TRUE);  //*DP00183
                               END;
                                }
      { 1100529002;2 ;Action    ;
                      CaptionML=[DEU=Belege;
                                 ENU=Documents;
                                 NLD=Documenten;
                                 NOR=Dokumenter;
                                 SVE=Dokument];
                      Image=Documents;
                      OnAction=BEGIN
                                 ShowDocuments();  //*DP00183
                               END;
                                }
      { 1100409001;1 ;ActionGroup;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions;
                                 NLD=F&uncties;
                                 NOR=Fu&nksjon;
                                 SVE=Fu&nktion] }
      { 1100529007;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Teilweiser öbertrag in neuen Auftrag;
                                 ENU=Partly Transfer to New Order;
                                 NLD=Gedeeltelijk overzetten naar nieuwe order;
                                 NOR=Overfõr delvis til Ny Ordre];
                      Enabled=PartlyTransferOrderEnabled;
                      Image=ChangeBatch;
                      OnAction=VAR
                                 POLine@1100529000 : Record 11012557;
                                 ExtentedPlantOrdeFuncCU@1100529001 : Codeunit 11020503;
                                 NewOrderNo@1100529002 : Code[20];
                               BEGIN
                                 //*DP00183
                                 PlantSetup.TESTFIELD("Extended Picking Procedure", TRUE);
                                 CurrPage.SETSELECTIONFILTER(POLine);

                                 PlantOrderRec.GET("Plant Order No.");
                                 NewOrderNo := ExtentedPlantOrdeFuncCU.RunPartlyMoveToNewOrder(PlantOrderRec, POLine);
                                 IF NewOrderNo <> '' THEN BEGIN
                                   COMMIT;
                                   CurrPage.UPDATE(FALSE);  //Update orderlines ('delete' copied lines)
                                   IF PlantOrderRec.GET(NewOrderNo) THEN
                                     PAGE.RUN(PAGE::"Plant Order", PlantOrderRec);  //Open new card with new order
                                 END;
                               END;
                                }
      { 1100528008;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Teilweiser öbertrag in vorhandenen Auftrag;
                                 ENU=Partly Transfer to Existing Order;
                                 NLD=Gedeeltelijk overzetten naar bestaande order];
                      Enabled=PartlyTransferOrderEnabled;
                      Image=ChangeBatch;
                      OnAction=VAR
                                 FromPlantOrder@1100528001 : Record 11012556;
                                 ToPlantOrder@1100528002 : Record 11012556;
                                 PlantOrderLine@1100529000 : Record 11012557;
                                 ExtendedPlantOrderFunctions@1100529001 : Codeunit 11020503;
                                 PLAHelperFunctions@1100528000 : Codeunit 11124922;
                                 ToPlantOrderNo@1100529002 : Code[20];
                               BEGIN
                                 PlantSetup.TESTFIELD("Extended Picking Procedure", TRUE);
                                 CurrPage.SETSELECTIONFILTER(PlantOrderLine);

                                 FromPlantOrder.GET("Plant Order No.");
                                 ToPlantOrderNo := ExtendedPlantOrderFunctions.SelectPlantOrderForTranferringLines(FromPlantOrder);
                                 IF ToPlantOrderNo <> '' THEN BEGIN
                                   ExtendedPlantOrderFunctions.PartlyTransferToOrder(PlantOrderLine, ToPlantOrderNo);
                                   COMMIT;
                                   CurrPage.UPDATE(FALSE);
                                   IF ToPlantOrder.GET(ToPlantOrderNo) THEN
                                     PAGE.RUN(PAGE::"Plant Order", ToPlantOrder);
                                 END;
                               END;
                                }
      { 1100409000;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=ZurÅckgekommene vermisste Artikel;
                                 ENU=Create Returned &Loss Order;
                                 NLD=Teruggekomen vermissing aanmaken;
                                 NOR=Opprett returnert &Tapsordre;
                                 SVE=Skapa returnerade fîr&lustorder];
                      Image=CreateCreditMemo;
                      OnAction=VAR
                                 PlantOrder@1100409000 : Record 11012556;
                               BEGIN
                                 PlantOrder.GET("Plant Order No.");
                                 PlantOrder.TESTFIELD("No.");
                                 PlantOrder.TESTFIELD(Posted, FALSE);
                                 PlantOrder.TESTFIELD(Type, PlantOrder.Type::Removal);

                                 CreateReturnedLossOrder(PlantOrder);
                               END;
                                }
      { 1100528800;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Serviceauftrag erstellen;
                                 ENU=Create Service Order;
                                 NLD=Serviceorder aanmaken;
                                 NOR=Opprette Serviceordre;
                                 SVE=Skapa serviceorder];
                      Image=MakeOrder;
                      OnAction=VAR
                                 CreatePlantServiceOrder@1100529000 : Page 11229373;
                               BEGIN
                                 TESTFIELD(Type, Type::Plant);
                                 TESTFIELD("Plant Order No.");
                                 TESTFIELD("Line No.");
                                 CreatePlantServiceOrder.SetSelectionPlantOrdeLine(Rec);
                                 CreatePlantServiceOrder.RUNMODAL;
                               END;
                                }
      { 1100528002;2 ;ActionGroup;
                      CaptionML=[DEU=Order-&Picking;
                                 ENU=Order Picking;
                                 NLD=Order picken;
                                 SVE=Orderplockning] }
      { 1100528005;3 ;Action    ;
                      Name=Assign;
                      CaptionML=[DEU=Zuordnen;
                                 ENU=Assign;
                                 NLD=Toekennen;
                                 NOR=Tilordne;
                                 SVE=Tilldela];
                      OnAction=VAR
                                 PlantOrderLine@1100528000 : Record 11012557;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PlantOrderLine);
                                 AssignToPicker(PlantOrderLine);
                               END;
                                }
      { 1100528003;3 ;Action    ;
                      Name=Release;
                      CaptionML=[DEU=Freigeben;
                                 ENU=Release;
                                 NLD=Vrijgeven;
                                 NOR=Frigi;
                                 SVE=SlÑppa];
                      OnAction=VAR
                                 PlantOrderLine@1100528000 : Record 11012557;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PlantOrderLine);
                                 ReleaseForPicking(PlantOrderLine);
                               END;
                                }
      { 1100528004;3 ;Action    ;
                      Name=Re-open;
                      CaptionML=[DEU=Erneut îffnen;
                                 ENU=Re-open;
                                 NLD=Heropenen];
                      OnAction=VAR
                                 PlantOrderLine@1100528000 : Record 11012557;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PlantOrderLine);
                                 ReOpenForPicking(PlantOrderLine);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="From Location";
                Visible=FALSE;
                Enabled=PageFieldsEditable }

    { 4   ;2   ;Field     ;
                SourceExpr=Type;
                Editable=PageFieldsEditable;
                OnValidate=BEGIN
                             ModifyAllowedOnOrderPickStatus(FIELDNO(Type));  //DP00688
                             UpdateEditable;
                           END;
                            }

    { 1100485000;2;Field  ;
                SourceExpr="Set Code";
                Visible=FALSE;
                Editable=PlantFieldsEditable;
                OnValidate=BEGIN
                             UpdateEditable;
                           END;
                            }

    { 6   ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Plant Type";
                Editable=PlantTypeEditable;
                OnValidate=BEGIN
                             ModifyAllowedOnOrderPickStatus(FIELDNO("Plant Type"));  //DP00688
                             UpdateEditable;
                           END;

                OnLookup=BEGIN
                           //LookupPlantType();  //*C-028869.o
                           LookupPlantType(Text);  //*C-028869.n
                           UpdateEditable;
                         END;

                OnAssistEdit=BEGIN
                               LookupPlantInventory(1);
                               UpdateEditable;
                             END;
                              }

    { 1100529704;2;Field  ;
                SourceExpr="Plant Group";
                Visible=FALSE;
                Editable=PageFieldsEditable }

    { 1100529700;2;Field  ;
                SourceExpr="From Plant Group";
                Visible=FALSE;
                Editable=PageFieldsEditable }

    { 1100529702;2;Field  ;
                SourceExpr="To Plant Group";
                Visible=FALSE;
                Editable=PageFieldsEditable }

    { 8   ;2   ;Field     ;
                SourceExpr="Rental Type";
                Visible=FALSE;
                Editable=PlantFieldsEditable;
                OnValidate=BEGIN
                             UpdateEditable;
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="No.";
                Editable=PlantNoEditable;
                OnValidate=BEGIN
                             ModifyAllowedOnOrderPickStatus(FIELDNO("No."));  //DP00688
                           END;

                OnLookup=VAR
                           StandTextRec@11012003 : Record 7;
                           PlantNumber@1100528501 : Record 11012552;
                         BEGIN
                           CASE Type OF
                             Type::Plant:
                               BEGIN
                                 PlantNumber.SETRANGE("Plant Type", "Plant Type");
                                 PlantNumber."Plant Type" := "Plant Type";
                                 PlantNumber."No." := "No.";
                                 PlantOrderRec.GET("Plant Order No.");
                                 IF PlantOrderRec.Posted OR (PlantOrderRec.Status >= PlantOrderRec.Status::Released) THEN
                                   PAGE.RUNMODAL(0, PlantNumber)
                                 ELSE BEGIN
                                   IF PAGE.RUNMODAL(0, PlantNumber) = ACTION::LookupOK THEN
                                     VALIDATE("No.", PlantNumber."No.");
                                 END;
                               END;
                             Type::Text:
                               BEGIN
                                 StandTextRec.Code := "No.";
                                 IF PAGE.RUNMODAL(PAGE::"Standard Text Codes",StandTextRec) = ACTION::LookupOK THEN BEGIN
                                   Text := StandTextRec.Code;
                                   EXIT(TRUE);
                                 END;
                              END;
                           END;
                         END;

                OnDrillDown=BEGIN
                              IF Type = Type::Plant THEN
                                LookupPlantInventory(2);
                            END;
                             }

    { 1100529010;2;Field  ;
                SourceExpr="Item No.";
                Visible=ItemFieldsVisible;
                Editable=ItemFieldsEditable;
                OnValidate=BEGIN
                             ModifyAllowedOnOrderPickStatus(FIELDNO("Item No."));  //DP00688
                           END;

                OnLookup=BEGIN
                           Text := LookupItemNo(xRec."Item No.");
                           IF Text <> "Item No." THEN
                             EXIT(TRUE)  //* Selected by LookupOK
                           ELSE
                             CurrPage.UPDATE(TRUE); //* May be MultiCopy is done, then form must be refreshed
                         END;

                OnAssistEdit=VAR
                               Item@1100526002 : Record 27;
                               PlantOrder@1100526000 : Record 11012556;
                               PlantLocation@1100526001 : Record 11012554;
                               LocationCodeItem@1100526003 : Code[10];
                             BEGIN
                               LocationCodeItem := "Location Code";
                               IF "Location Code" = '' THEN BEGIN
                                 PlantOrder.GET("Plant Order No.");
                                 IF PlantOrder."From Location" <> '' THEN BEGIN
                                   PlantLocation.GET(PlantOrder."From Location");
                                   IF PlantLocation.Depot AND (PlantLocation."Location Code (Items)" <> '') THEN
                                     LocationCodeItem := PlantLocation."Location Code (Items)";
                                 END;
                               END;
                               Item.SETFILTER(Inventory, '>0');
                               Item.SETFILTER("Location Filter", LocationCodeItem);

                               IF "Item No." <> '' THEN
                                 IF Item.GET("Item No.") THEN;

                               IF ItemFieldsEditable THEN BEGIN
                                 IF PAGE.RUNMODAL(0, Item) = ACTION::LookupOK THEN
                                   VALIDATE("Item No.", Item."No.");
                               END ELSE
                                 PAGE.RUNMODAL(0, Item);
                             END;
                              }

    { 1100529009;2;Field  ;
                SourceExpr="Variant Code";
                Visible=FALSE;
                Editable=ItemFieldsEditable;
                OnValidate=BEGIN
                             ModifyAllowedOnOrderPickStatus(FIELDNO("Variant Code"));  //DP00688
                           END;
                            }

    { 12  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=PageFieldsEditable }

    { 1100525002;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE;
                Editable=Description2Editable }

    { 1100529011;2;Field  ;
                CaptionML=[DEU=V/Z Werkzeug/Artikel;
                           ENU=S/BB Plant/Item;
                           NLD=V/t mat./art.];
                SourceExpr=GetSalesBuyBack();
                Visible=FALSE }

    { 1100485030;2;Field  ;
                SourceExpr="Inspection No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr=Bulk;
                Visible=FALSE }

    { 1100529008;2;Field  ;
                SourceExpr="Plant Category";
                Visible=FALSE }

    { 1100485004;2;Field  ;
                CaptionML=[DEU=Extern;
                           ENU=External;
                           NLD=Extern;
                           NOR=Eksternt;
                           SVE=Externt];
                SourceExpr=GetExternal();
                OnLookup=VAR
                           Vend@1100409000 : Record 23;
                         BEGIN
                           Vend."No." := VendorNoExternalPlant();
                           PAGE.RUNMODAL(0, Vend);
                         END;
                          }

    { 1100409004;2;Field  ;
                CaptionML=[DEU=Kreditorennr. externes Werkzeug;
                           ENU=Vendor No. External Plant;
                           NLD=Lev.nr. extern materieel];
                SourceExpr=VendorNoExternalPlant();
                TableRelation=Vendor;
                Visible=FALSE }

    { 1100409005;2;Field  ;
                CaptionML=[DEU=Kreditor externes Werkzeug;
                           ENU=Vendor External Plant;
                           NLD=Lev. extern materieel];
                SourceExpr=VendorNameExternalPlant();
                TableRelation=Vendor;
                Visible=FALSE;
                OnLookup=VAR
                           Vend@1100409000 : Record 23;
                         BEGIN
                           Vend."No." := VendorNoExternalPlant();
                           PAGE.RUNMODAL(0, Vend);
                         END;
                          }

    { 1100485006;2;Field  ;
                SourceExpr="From Rate Code";
                Visible=FromRateCodeVisible;
                Editable=PlantFieldsEditable;
                OnLookup=BEGIN
                           LookupPlantInventory(3);
                         END;
                          }

    { 1100485002;2;Field  ;
                SourceExpr="To Location";
                Visible=FALSE;
                Editable=ToLocationEditable }

    { 1100485008;2;Field  ;
                SourceExpr="To Rate Code";
                Visible=ToRateCodeVisible;
                Editable=PlantFieldsEditable }

    { 1100529017;2;Field  ;
                SourceExpr="Mobilization Rate Code";
                Visible=MobilizationRateCodeVisible;
                Editable=MobilizationRateCodeEditable }

    { 1100485032;2;Field  ;
                SourceExpr="To Employee Company";
                Visible=FALSE;
                Editable=PageFieldsEditable }

    { 1100485034;2;Field  ;
                SourceExpr="To Employee No.";
                Visible=FALSE;
                Editable=PageFieldsEditable;
                OnLookup=BEGIN
                           LookupToEmployee(CurrPage.EDITABLE);
                         END;
                          }

    { 1210190016;2;Field  ;
                CaptionML=[DEU=Name Mitarbeiter;
                           ENU=Employee Name;
                           NLD=Werknemernaam;
                           NOR=Navn pÜ ansatt;
                           SVE=Namn pÜ anstÑlld];
                SourceExpr=GetEmployeeName;
                Visible=FALSE;
                Editable=FALSE }

    { 1100529014;2;Field  ;
                SourceExpr="Location Code";
                Visible=ItemFieldsVisible;
                Editable=ItemFieldsEditable }

    { 1100525005;2;Field  ;
                SourceExpr="Bin Code";
                Visible=ItemFieldsVisible;
                Editable=ItemFieldsEditable }

    { 1100529013;2;Field  ;
                Name=Inventory-Item;
                CaptionML=[DEU=Artikellagerbestand;
                           ENU=Item Inventory;
                           NLD=Art.voorraad];
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=Rec.GetItemInventory(0);
                Visible=FALSE }

    { 1100529012;2;Field  ;
                Name=Inventory-Location;
                CaptionML=[DEU=Artikellagerbestand Lagerort;
                           ENU=Item Inventory Location;
                           NLD=Art.voorraad vestiging;
                           NOR="Plassering for artikkellager ";
                           SVE=Artikellager per lagerstÑlle];
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=Rec.GetItemInventory(1);
                Visible=FALSE }

    { 1100529019;2;Field  ;
                CaptionML=[DEU=Artikellagerbestand Lagerort;
                           ENU=Item Inventory Bin;
                           NLD=Art.voorraad opslaglocatie];
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=Rec.GetItemInventory(2);
                Visible=FALSE }

    { 1100529015;2;Field  ;
                SourceExpr="New Location Code";
                Visible=ItemNewLocationCodeVisible;
                Editable=ItemNewLocationCodeEditable }

    { 1100529018;2;Field  ;
                SourceExpr="New Bin Code";
                Visible=ItemNewLocationCodeVisible;
                Editable=ItemNewLocationCodeEditable }

    { 1100525000;2;Field  ;
                SourceExpr=Element;
                Visible=FALSE;
                Editable=PageFieldsEditable;
                HideValue=ElementHideValue }

    { 20  ;2   ;Field     ;
                SourceExpr="Expected return on";
                Visible=FALSE;
                Editable=PlantFieldsEditable }

    { 1100485012;2;Field  ;
                SourceExpr="Asked Quantity";
                Visible=AskedQuantityVisible;
                Editable=AskedQuantityEditable;
                OnValidate=BEGIN
                             ModifyAllowedOnOrderPickStatus(FIELDNO("Asked Quantity"));  //DP00688
                           END;
                            }

    { 1100525006;2;Field  ;
                SourceExpr="Qty. to Receive";
                Visible=QtyToReceiveVisible;
                Editable=QtyToReceiveEditable }

    { 16  ;2   ;Field     ;
                SourceExpr=Quantity;
                Editable=PageFieldsEditable;
                OnValidate=BEGIN
                             ModifyAllowedOnOrderPickStatus(FIELDNO(Quantity));  //DP00688
                             QuantityOnAfterValidate;
                           END;
                            }

    { 1210190010;2;Field  ;
                SourceExpr="Quantity Inventory";
                Visible=QuantityInventoryVisible;
                Editable=PlantFieldsEditable }

    { 1210190012;2;Field  ;
                SourceExpr="Quantity Damaged";
                Visible=QuantityDamagedVisible;
                Editable=PlantFieldsEditable }

    { 1210190014;2;Field  ;
                SourceExpr="Quantity Exit";
                Visible=QuantityExitVisible;
                Editable=PlantFieldsEditable }

    { 1100485026;2;Field  ;
                SourceExpr="Reason Code (Exit)";
                Visible=ReasonCodeExitVisible;
                Editable=PageFieldsEditable;
                OnValidate=BEGIN
                             UpdateEditable;
                           END;
                            }

    { 1100485022;2;Field  ;
                SourceExpr="Quantity Exit (Sold)";
                Visible=FALSE;
                Editable=PlantFieldsEditable }

    { 1100409003;2;Field  ;
                SourceExpr="Exit Order No.";
                Visible=QuantityExitVisible }

    { 18  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Editable=UnitOfMeasureEditable;
                OnValidate=BEGIN
                             ModifyAllowedOnOrderPickStatus(FIELDNO("Unit of Measure"));  //DP00688
                           END;
                            }

    { 1100525004;2;Field  ;
                CaptionML=[DEU=Miettarif;
                           ENU=Rental Rate;
                           NLD=Huurtarief;
                           NOR=Leiesats;
                           SVE=Uthyrningsavgift];
                BlankZero=Yes;
                SourceExpr=GetRentalRate();
                AutoFormatType=2;
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Buy Back Rate";
                Visible=FALSE;
                Editable=BuyBackRateEditable }

    { 24  ;2   ;Field     ;
                SourceExpr="Sales Rate";
                Editable=SalesRateEditable }

    { 1100529016;2;Field  ;
                SourceExpr="Item Amount";
                Visible=ItemFieldsVisible;
                Editable=ItemAmountEditable }

    { 26  ;2   ;Field     ;
                SourceExpr="Stock Plant No. on From Loc.";
                Visible=FALSE }

    { 1100485010;2;Field  ;
                SourceExpr="Stock Rate Code on From Loc.";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Stock Plant Type on From Loc.";
                Visible=FALSE }

    { 1100525003;2;Field  ;
                CaptionML=[DEU=VerfÅgbarer Werkzeugtyp in Depot;
                           ENU=Available Plant Type on Depot;
                           NLD=Beschikbaar mat.srt. op depot];
                BlankZero=Yes;
                SourceExpr=CalcPlantTypeAvailable();
                Visible=FALSE }

    { 1100527700;2;Field  ;
                CaptionML=[DEU=VerfÅgbar fÅr VON-Standort;
                           ENU=Available on FROM-Location;
                           NLD=Beschikbaar op VAN-locatie];
                BlankZero=Yes;
                SourceExpr=CalcPlantTypeAvailableFromLocation();
                Visible=FALSE }

    { 1100525008;2;Field  ;
                CaptionML=[DEU=Menge in RÅcksendedepot von Lager;
                           ENU=Qty on Return Depot From Loc.;
                           NLD=Aantal op retourdepot van loc.];
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=GetQtyPlantTypeOnReturnDepot();
                Visible=FALSE;
                Editable=FALSE }

    { 1100525007;2;Field  ;
                CaptionML=[DEU=Menge erwartete RÅcksendung;
                           ENU=Qty Expected Return;
                           NLD=Aantal retour verwacht];
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=GetQtyPlantTypeExpectedReturn();
                Visible=FALSE;
                Editable=FALSE }

    { 1210190004;2;Field  ;
                SourceExpr="Rental Shift";
                Visible=FALSE;
                Editable=PlantFieldsEditable;
                OnValidate=BEGIN
                             UpdateEditable;
                           END;
                            }

    { 1210190006;2;Field  ;
                SourceExpr="Rental Startdate (To Location)";
                Visible=FALSE;
                Editable=RentalShiftDatesEditable }

    { 1210190008;2;Field  ;
                SourceExpr="Rental Enddate (From Location)";
                Visible=FALSE;
                Editable=RentalShiftDatesEditable }

    { 1100485014;2;Field  ;
                SourceExpr="Purch. Order Type";
                Visible=FALSE;
                Editable=PurchaseFieldsEditable }

    { 1100485016;2;Field  ;
                SourceExpr="Vendor No.";
                Visible=FALSE;
                Editable=PurchaseFieldsEditable;
                OnAssistEdit=BEGIN
                               IF PurchaseFieldsEditable THEN
                                 AssistEditVendorNo;
                             END;
                              }

    { 1100525001;2;Field  ;
                SourceExpr="Order Address Code";
                Visible=FALSE;
                Enabled=PurchaseFieldsEditable }

    { 1100485018;2;Field  ;
                SourceExpr="Direct Delivery";
                Visible=FALSE;
                Editable=PurchaseFieldsEditable }

    { 1210190000;2;Field  ;
                SourceExpr="Location Copied Need";
                Visible=FALSE }

    { 1210190002;2;Field  ;
                SourceExpr="Line No. Copied Need";
                Visible=FALSE }

    { 1100529400;2;Field  ;
                SourceExpr="Plant Meter";
                Visible=FALSE }

    { 1100529005;2;Field  ;
                CaptionML=[DEU=ZÑhlerstand;
                           ENU=Meter Reading;
                           NLD=Meterstand;
                           NOR=Meteravlesning;
                           SVE=MÑtaravlÑsning];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ActualMeterReading;
                Visible=FALSE;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              //DP00614
                              DrillDownMeterReading();
                              IF NOT Posted THEN
                                CheckInspection();
                            END;
                             }

    { 1100529006;2;Field  ;
                CaptionML=[DEU=Einheit ZÑhlerstand;
                           ENU=Unit Meter Reading;
                           NLD=Eenheid meterstand];
                SourceExpr=MeterReadingTypeUnitOfMeasure;
                Visible=FALSE;
                Editable=FALSE }

    { 1100485024;2;Field  ;
                SourceExpr="Order Picking Status";
                Visible=OrderPickingStatusEnable;
                Enabled=OrderPickingStatusEnable;
                Editable=FALSE }

    { 1100485020;2;Field  ;
                SourceExpr="Comment CP Order";
                Visible=CommentCPOrderEnable;
                Enabled=CommentCPOrderEnable;
                Editable=PageFieldsEditable }

    { 1100529001;2;Field  ;
                CaptionML=[DEU=Bemerkungen;
                           ENU=Comments;
                           NLD=Opmerkingen;
                           NOR=Merknader;
                           SVE=Kommentar];
                SourceExpr=HasCommentLines();
                Visible=FALSE;
                OnDrillDown=BEGIN
                              CommentSheet(TRUE);  //*DP00183
                            END;
                             }

    { 1100529000;2;Field  ;
                CaptionML=[DEU=Belege;
                           ENU=Documents;
                           NLD=Documenten;
                           NOR=Dokument;
                           SVE=Dokument];
                SourceExpr=HasDocumentLinks();
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ShowDocuments();  //*DP00183
                            END;
                             }

    { 1100528000;2;Field  ;
                SourceExpr="Picker No.";
                Visible=FALSE }

    { 1100528001;2;Field  ;
                SourceExpr="Picking Status";
                Visible=FALSE;
                Editable=FALSE }

    { 1100528700;2;Field  ;
                SourceExpr="Collection Point Code";
                Visible=FALSE;
                Editable=CollectionPointEditable }

    { 1100528006;2;Field  ;
                SourceExpr="Storage Location";
                Visible=FALSE }

    { 1100528007;2;Field  ;
                SourceExpr=Shelf;
                Visible=FALSE }

    { 1100529600;2;Field  ;
                SourceExpr="Project No. (Inventory)";
                Visible=FALSE }

    { 1100529601;2;Field  ;
                SourceExpr="Project Stock";
                Visible=FALSE;
                Editable=ProjectStockEditable;
                OnValidate=BEGIN
                             UpdateEditable;
                           END;
                            }

    { 1100529602;2;Field  ;
                SourceExpr=Deliver;
                Visible=FALSE;
                Editable=DeliverEditable;
                OnValidate=BEGIN
                             UpdateEditable;
                           END;
                            }

    { 1100529603;2;Field  ;
                SourceExpr="Ship To Location";
                Visible=FALSE;
                Editable=ShipToLocationEditable }

    { 1100529020;2;Field  ;
                CaptionML=[DEU=Mietvertrag;
                           ENU=Rental Agreement;
                           NLD=Huurafspraak];
                SourceExpr=HasRentalAgreement();
                Visible=FALSE }

  }
  CODE
  {
    VAR
      PlantSetup@11012000 : Record 11012550;
      UserSetup@1100529000 : Record 91;
      PlantOrderRec@1210190002 : Record 11012556;
      PlanningFutureDeficit@1210190001 : Codeunit 11012576;
      PlantOrderCostMgtCU@1100485001 : Codeunit 11012581;
      AddLinkedPlantTypeStndItemMgt@1100525001 : Codeunit 11012583;
      UpdateAfterAddLinkedPlant@1100525002 : Boolean;
      PlantListLastPlantType@1210190003 : Code[20];
      SaveRemoval@1100529002 : Boolean;
      PageFieldsEditable@1100529007 : Boolean INDATASET;
      QuantityInventoryVisible@19008232 : Boolean INDATASET;
      QuantityDamagedVisible@19012066 : Boolean INDATASET;
      QuantityExitVisible@19046635 : Boolean INDATASET;
      ReasonCodeExitVisible@19052298 : Boolean INDATASET;
      AskedQuantityVisible@19070419 : Boolean INDATASET;
      QtyToReceiveVisible@19050888 : Boolean INDATASET;
      AskedQuantityEditable@19044480 : Boolean INDATASET;
      PurchaseFieldsEditable@19012738 : Boolean INDATASET;
      QtyToReceiveEditable@19025168 : Boolean INDATASET;
      FromRateCodeVisible@19023073 : Boolean INDATASET;
      ToRateCodeVisible@19064766 : Boolean INDATASET;
      SalesRateEditable@19004097 : Boolean INDATASET;
      BuyBackRateEditable@19005937 : Boolean INDATASET;
      OrderPickingStatusEnable@19019190 : Boolean INDATASET;
      CommentCPOrderEnable@19076467 : Boolean INDATASET;
      PlantTypeEditable@1100409000 : Boolean INDATASET;
      PlantNoEditable@1100529010 : Boolean INDATASET;
      Description2Editable@1100525003 : Boolean INDATASET;
      ToLocationEditable@1100409002 : Boolean INDATASET;
      RentalShiftDatesEditable@1100409003 : Boolean INDATASET;
      PlantFieldsEditable@1100529009 : Boolean INDATASET;
      ItemFieldsVisible@1100529001 : Boolean INDATASET;
      ItemFieldsEditable@1100529004 : Boolean INDATASET;
      ItemAmountEditable@1100529011 : Boolean INDATASET;
      UnitOfMeasureEditable@1100529012 : Boolean INDATASET;
      ItemNewLocationCodeVisible@1100529003 : Boolean INDATASET;
      ItemNewLocationCodeEditable@1100529005 : Boolean INDATASET;
      ItemInventoryVisible@1100529008 : Boolean INDATASET;
      PartlyTransferOrderEnabled@1100525004 : Boolean INDATASET;
      Text002@1100529600 : TextConst 'DEU=Montageauftrag %1 wurde erstellt.;ENU=Assembly Order %1 was created.;NLD=Assemblageorder %1 is aangemaakt.';
      MobilizationRateCodeVisible@1100529013 : Boolean INDATASET;
      MobilizationRateCodeEditable@1100529014 : Boolean INDATASET;
      ElementHideValue@1100525005 : Boolean INDATASET;
      ProjectStockEditable@1100529601 : Boolean INDATASET;
      DeliverEditable@1100529603 : Boolean INDATASET;
      ShipToLocationEditable@1100529602 : Boolean INDATASET;
      CollectionPointEditable@1100528700 : Boolean INDATASET;

    PROCEDURE GetExternal@1100485001() : Boolean;
    VAR
      lvPlantTypeRec@1100485000 : Record 11012551;
      lvPlantNoRec@1100485001 : Record 11012552;
    BEGIN
      IF (Type <> Type::Plant) OR ("Plant Type" = '') THEN
        EXIT(FALSE);

      IF ("No." <= '0') THEN BEGIN
        IF lvPlantTypeRec.GET("Plant Type") THEN
          EXIT(lvPlantTypeRec.External);
      END ELSE BEGIN
        IF lvPlantNoRec.GET("Plant Type", "No.") THEN
          EXIT(lvPlantNoRec.External);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE LookupPlantType@1100525001(PlantType@1210190000 : Code[20]);
    VAR
      PlantTypeRec@1100525000 : Record 11012551;
      TmpPlantTypeRec@1100525002 : TEMPORARY Record 11012551;
      MultiCopyMgt@1100525003 : Codeunit 11012068;
      PlantTypeList@1100525001 : Page 11012552;
      FormLookupOK@1210190001 : Boolean;
    BEGIN
      IF Type <> Type::Plant THEN
        EXIT;
      PlantOrderRec.GET("Plant Order No.");
      PlantTypeRec.Code := "Plant Type";  //*C-028869.o
      //*C-028869.sn
      IF PlantType = '' THEN
        PlantTypeRec.Code := PlantListLastPlantType
      ELSE
        PlantTypeRec.Code := PlantType;
      //*C-028869.en
      PlantTypeList.SETRECORD(PlantTypeRec);
      IF (PlantOrderRec.Status < PlantOrderRec.Status::Released) AND (NOT Posted) THEN BEGIN
        PlantTypeList.LOOKUPMODE(TRUE);
        PlantTypeList.SetMultiCopyAllowed(TRUE);
      END;
      //IF PlantTypeList.RUNMODAL = ACTION::LookupOK THEN BEGIN  //*C-028869.o
      //  PlantTypeList.GETRECORD(PlantTypeRec);                 //*C-028869.o
      //*C-028869.sn
      FormLookupOK := (PlantTypeList.RUNMODAL = ACTION::LookupOK);
      PlantTypeList.GETRECORD(PlantTypeRec);
      PlantListLastPlantType := PlantTypeRec.Code;
      IF FormLookupOK THEN BEGIN
      //*C-028869.en
        VALIDATE("Plant Type", PlantTypeRec.Code);
      END ELSE BEGIN
        IF PlantTypeList.GetMultiCopyRec(TmpPlantTypeRec) THEN BEGIN
          MultiCopyMgt.CopyPlantTypeToPlantOrderLine(TmpPlantTypeRec, PlantOrderRec, "Line No.");
          CurrPage.UPDATE(TRUE);
        END;
      END;
    END;

    PROCEDURE LookupPlantInventory@1100485000(ILevel@1100485003 : Integer);
    VAR
      lvInventoryRec@1100485001 : Record 11012555;
      lvInventoryPage@1100485000 : Page 11012559;
      lvDetails@1100485002 : 'InventEntry,PlantType,PlantNo,RateCode';
    BEGIN
      //* Level: 1-Plant Type, 2-Plant No., 3-Rate Code
      IF Type <> Type::Plant THEN
        EXIT;
      lvInventoryRec.SETRANGE(Removed,FALSE);
      lvInventoryRec.SETRANGE(Location,"From Location");
      IF (ILevel = 2) OR (ILevel = 3) THEN
        lvInventoryRec.SETRANGE("Plant Type", "Plant Type");
      IF (ILevel = 3) AND ("No." <>'')THEN
        lvInventoryRec.SETRANGE("Plant No.", "No.");
      lvInventoryRec.Removed := FALSE;
      lvInventoryRec.Location := "From Location";
      lvInventoryRec."Plant Type" := "Plant Type";
      lvInventoryRec."Plant No." := "No.";
      IF NOT PlantSetup."Rate Codes" THEN
        lvInventoryPage.SetDetailSelection(lvDetails::PlantNo)
      ELSE BEGIN
        lvInventoryRec."Rate Code" := "From Rate Code";
        lvInventoryPage.SetDetailSelection(lvDetails::RateCode);
      END;
      IF "Transfer Date" <> 0D THEN
        lvInventoryRec.SETFILTER("Present from", '..%1', "Transfer Date");
      lvInventoryPage.SETTABLEVIEW(lvInventoryRec);
      lvInventoryPage.SETRECORD(lvInventoryRec);
      PlantOrderRec.GET("Plant Order No.");
      IF PlantOrderRec.Status < PlantOrderRec.Status::Released THEN
        lvInventoryPage.LOOKUPMODE := TRUE;
      IF lvInventoryPage.RUNMODAL = ACTION::LookupOK THEN BEGIN
        lvInventoryPage.GETRECORD(lvInventoryRec);
        lvInventoryPage.GetDetailSelection(lvDetails);
        IF (ILevel = 1) THEN
          VALIDATE("Plant Type",lvInventoryRec."Plant Type");
        IF ((ILevel = 1) OR (ILevel = 2)) AND (lvDetails <> lvDetails::PlantType) THEN
          VALIDATE("No.",lvInventoryRec."Plant No.");
        IF ((ILevel = 1) OR (ILevel = 2) OR (ILevel = 3)) AND (lvDetails = lvDetails::RateCode) THEN BEGIN
          VALIDATE("From Rate Code",lvInventoryRec."Rate Code");
          VALIDATE("From Plant Group",lvInventoryRec."Plant Group");
        END;
      END;
    END;

    PROCEDURE CreateReturnedLossOrder@1100525002(PlantOrder@1100525000 : Record 11012556);
    VAR
      PlantOrderLine@1100525002 : Record 11012557;
      CreatePlantReturnedOrder@1100525001 : Codeunit 11012558;
    BEGIN
      PlantOrderLine.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(PlantOrderLine);
      CreatePlantReturnedOrder.CreateReturnedLossOrdersFromPO(PlantOrder, PlantOrderLine);
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    BEGIN
      IF Type = Type::Plant THEN
        PlanningFutureDeficit.FutureDeficitWarning("Plant Order No.", "Line No.", "Plant Type", "Expected return on", Quantity);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      IF UpdateAfterAddLinkedPlant THEN BEGIN  //*01-07-2010
       UpdateAfterAddLinkedPlant := FALSE;  //* First reset then update form!
       CurrPage.UPDATE(FALSE);
      END;
      IF NOT PlantOrderRec.GET("Plant Order No.") THEN
        PlantOrderRec.INIT;
      PageFieldsEditable := ((NOT PlantOrderRec.Posted) AND (PlantOrderRec.Status < PlantOrderRec.Status::Released));

      QuantityInventoryVisible :=
        (PlantOrderRec."Advanced Removal" AND
        ((PlantOrderRec."To Location Repair" <> '') OR (PlantOrderRec."To Location Exit" <> '')));
      QuantityDamagedVisible := (PlantOrderRec."Advanced Removal" AND (PlantOrderRec."To Location Repair" <> ''));
      QuantityExitVisible := (PlantOrderRec."Advanced Removal" AND (PlantOrderRec."To Location Exit" <> ''));
      ReasonCodeExitVisible := QuantityExitVisible OR (PlantOrderRec.Type = PlantOrderRec.Type::Removal);

      AskedQuantityVisible := PlantSetup."Extended Picking Procedure" AND (PlantOrderRec.Type = PlantOrderRec.Type::Arrival);
      AskedQuantityEditable := PageFieldsEditable AND AskedQuantityVisible;
      PurchaseFieldsEditable := PageFieldsEditable AND
        PlantSetup."Extended Picking Procedure" AND (PlantOrderRec.Type = PlantOrderRec.Type::Arrival);

      QtyToReceiveVisible := PlantSetup."Removal with Qty. to Receive" AND (PlantOrderRec.Type = PlantOrderRec.Type::Removal);
      QtyToReceiveEditable := PageFieldsEditable AND QtyToReceiveVisible;

      ItemNewLocationCodeVisible := PlantOrderRec.IsOtherTransferDepotToDepot();  //*DP00183.n
      ItemFieldsVisible := (PlantOrderRec.Type <= PlantOrderRec.Type::Removal) OR ItemNewLocationCodeVisible;
      ItemInventoryVisible := (PlantOrderRec.Type = PlantOrderRec.Type::Arrival) OR ItemNewLocationCodeVisible;  //*DP00183.c

      MobilizationRateCodeVisible := PlantOrderRec."Receipt Registration (TR)";
      PartlyTransferOrderEnabled := (PlantOrderRec.Type IN [PlantOrderRec.Type::Arrival, PlantOrderRec.Type::Removal]);

      UpdateEditable;
    END;

    PROCEDURE UpdateEditable@1100409000();
    BEGIN
      IF NOT PlantOrderRec.GET("Plant Order No.") THEN
        PlantOrderRec.INIT;
      PageFieldsEditable := ((NOT PlantOrderRec.Posted) AND (PlantOrderRec.Status < PlantOrderRec.Status::Released));
      PlantTypeEditable := PageFieldsEditable AND (Type = Type::Plant) AND (NOT PlantOrderCostMgtCU.POLineLinkedCostWithPurchOrder(Rec));
      PlantNoEditable := PageFieldsEditable AND ((Type = Type::Plant) OR (Type = Type::Text));
      Description2Editable := PageFieldsEditable AND ((Type = Type::Plant) OR (Type = Type::Item)) AND ("Set Code" = '');
      ToLocationEditable := PageFieldsEditable AND
        ((Type = Type::Plant) AND ("Plant Type" <> '') AND (PlantOrderRec.Type = PlantOrderRec.Type::Removal));
      RentalShiftDatesEditable := PageFieldsEditable AND "Rental Shift";

      PlantFieldsEditable := PageFieldsEditable AND (Type = Type::Plant);
      ItemFieldsEditable := PageFieldsEditable AND ItemFieldsVisible AND (Type = Type::Item);
      ItemAmountEditable := ItemFieldsEditable AND ("Reason Code (Exit)" = '');
      ItemNewLocationCodeEditable := PageFieldsEditable AND ItemNewLocationCodeVisible AND (Type = Type::Item);
      UnitOfMeasureEditable := ItemFieldsEditable AND (NOT (("Plant Quote No." <> '') AND ("Plant Quote Line No." <> 0))) AND
        (NOT (("Location Copied Need" <> '') AND ("Line No. Copied Need" <> 0)));

      SalesRateEditable := PageFieldsEditable AND
        (((Type = Type::Plant) AND (PlantSetup."Change Sales Rate" OR (("Plant Quote No." <> '') AND ("Plant Quote Line No." <> 0)))) OR
         ItemAmountEditable);
      BuyBackRateEditable := PageFieldsEditable AND ((Type = Type::Plant) AND PlantSetup."Change Buy Back Rate");
      MobilizationRateCodeEditable := PageFieldsEditable AND TransportRateCodeAllowed;
      ElementHideValue := (Type = Type::Text);

      ProjectStockEditable := (Type = Type::Item) AND ("Project No. (Inventory)" <> '') AND PageFieldsEditable;
      DeliverEditable := ProjectStockEditable AND "Project Stock";
      ShipToLocationEditable := DeliverEditable AND (Deliver <> Deliver::" ");
      CollectionPointEditable := "Picking Status" = "Picking Status"::Open;
    END;

    PROCEDURE SetPlantCategoryFilter@1100529000(Removal@1100529000 : Boolean);
    BEGIN
      //*DP00183
      //* Set filter on Plant Category, only for removal orders (reset filter for other order types).
      IF (Removal = SaveRemoval) OR (UserSetup."Plant Category Filter (Rem.PO)" = '') THEN
        EXIT;

      SaveRemoval := Removal;
      FILTERGROUP(9);  // May not be modified/deleted by the user
      IF Removal THEN
        SETFILTER("Plant Category", UserSetup."Plant Category Filter (Rem.PO)")
      ELSE
        SETRANGE("Plant Category");  //* Reset filter
      FILTERGROUP(0);
    END;

    PROCEDURE CreateAssemblyOrder@1100529601();
    VAR
      ExtendedPlantOrderFunctions@1100529600 : Codeunit 11020503;
      AssemblyOrderNo@1100529601 : Code[20];
    BEGIN
      //DP01497
      AssemblyOrderNo := ExtendedPlantOrderFunctions.CreateAssemblyOrder("Plant Order No.", "Line No.", "Item No.");
      IF AssemblyOrderNo <> '' THEN
        MESSAGE(Text002, AssemblyOrderNo);
    END;

    BEGIN
    {
      4PS 10-08-16 UKR-C25593 KD: Multiple meter readings (BI049) - Field "Plant Meter" added
    }
    END.
  }
}

