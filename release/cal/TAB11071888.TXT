OBJECT Table 11071888 Generic Sales Header
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00,4PSSE;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Generic Sales Header;
               NOR=Generisk salgshode;
               SVE=Generellt fîrsÑljningshuvud];
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              NOR=Dokumenttype;
                                                              SVE=Dokumenttyp];
                                                   OptionCaptionML=[ENU=Quote,Order,Pro Forma Invoice,Pro Forma Credit Memo,Blanket Order,Return Order,Invoice Proposal,Posted Invoice,Posted Credit Memo;
                                                                    NOR=Tilbud,Ordre,Proforma Faktura,Proforma Kreditnota,Rammeordre,Returordre,Fakturaforslag,Bokfõrt faktura,Bokfõrt kreditnota;
                                                                    SVE=Offert,Order,Proformafaktura,Proformakredit,Avropsorder,Returorder,Fakturafîrslag,Bokfîrd faktura,Bokfîrd kreditnota];
                                                   OptionString=Quote,Order,Pro Forma Invoice,Pro Forma Credit Memo,Blanket Order,Return Order,Invoice Proposal,Posted Invoice,Posted Credit Memo }
    { 2   ;   ;Sell-to Customer No.;Code20        ;CaptionML=[ENU=Sell-to Customer No.;
                                                              NOR=Salg til-kundenr;
                                                              SVE=Fîrs.kundnr] }
    { 3   ;   ;No.                 ;Code20        ;CaptionML=[ENU=No.;
                                                              NOR=Nr.;
                                                              SVE=Nr] }
    { 4   ;   ;Bill-to Customer No.;Code20        ;CaptionML=[ENU=Bill-to Customer No.;
                                                              NOR=Faktura til-kundenr.;
                                                              SVE=Faktureringskundnr] }
    { 5   ;   ;Bill-to Name        ;Text100       ;CaptionML=[ENU=Bill-to Name;
                                                              NOR=Faktura til-navn;
                                                              SVE=Faktureringsnamn] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[ENU=Bill-to Name 2;
                                                              NOR=Faktura til-navn 2;
                                                              SVE=Faktureringsnamn 2] }
    { 7   ;   ;Bill-to Address     ;Text100       ;CaptionML=[ENU=Bill-to Address;
                                                              NOR=Faktura til-adresse;
                                                              SVE=Faktureringsadress] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;CaptionML=[ENU=Bill-to Address 2;
                                                              NOR=Faktura til-adresse 2;
                                                              SVE=Faktureringsadress 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;CaptionML=[ENU=Bill-to City;
                                                              NOR=Faktura til-sted;
                                                              SVE=Faktureras ort] }
    { 10  ;   ;Bill-to Contact     ;Text100       ;CaptionML=[ENU=Bill-to Contact;
                                                              NOR=Faktura til-kontakt;
                                                              SVE=Faktureringskontakt] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              NOR=Deres referanse;
                                                              SVE=Er referens] }
    { 12  ;   ;Ship-to Code        ;Code10        ;CaptionML=[ENU=Ship-to Code;
                                                              NOR=Lever til-kode;
                                                              SVE=Leveransadresskod] }
    { 13  ;   ;Ship-to Name        ;Text100       ;CaptionML=[ENU=Ship-to Name;
                                                              NOR=Lever til-navn;
                                                              SVE=Leveransnamn] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              NOR=Lever til-navn 2;
                                                              SVE=Leveransnamn 2] }
    { 15  ;   ;Ship-to Address     ;Text100       ;CaptionML=[ENU=Ship-to Address;
                                                              NOR=Lever til-adresse;
                                                              SVE=Leveransadress] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              NOR=Lever til-adresse 2;
                                                              SVE=Leveransadress 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;CaptionML=[ENU=Ship-to City;
                                                              NOR=Lever til-sted;
                                                              SVE=Leveransort] }
    { 18  ;   ;Ship-to Contact     ;Text100       ;CaptionML=[ENU=Ship-to Contact;
                                                              NOR=Leveransekontaktperson;
                                                              SVE=Leveranskontaktperson] }
    { 19  ;   ;Order Date          ;Date          ;CaptionML=[ENU=Order Date;
                                                              NOR=Bestillingsdato;
                                                              SVE=Orderdatum] }
    { 20  ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              NOR=Bokfõringsdato;
                                                              SVE=Bokfîringsdatum] }
    { 21  ;   ;Shipment Date       ;Date          ;CaptionML=[ENU=Shipment Date;
                                                              NOR=Forsendelsesdato;
                                                              SVE=Utleveransdatum] }
    { 22  ;   ;Posting Description ;Text100       ;CaptionML=[ENU=Posting Description;
                                                              NOR=Bokfõringsbeskrivelse;
                                                              SVE=Bokfîringsbeskrivning] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;CaptionML=[ENU=Payment Terms Code;
                                                              NOR=Betalingsbet.kode;
                                                              SVE=Betalningsvillkorskod] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato;
                                                              SVE=Fîrfallodatum] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;CaptionML=[ENU=Payment Discount %;
                                                              NOR=Kontantrabatt-%;
                                                              SVE=Kassarabatt %];
                                                   DecimalPlaces=0:5 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              NOR=Kont.rabattdato;
                                                              SVE=Kassarabattsdatum] }
    { 27  ;   ;Shipment Method Code;Code10        ;CaptionML=[ENU=Shipment Method/Incoterm Code;
                                                              NOR=LeveringsmÜtekode;
                                                              SVE=Utleveransvillkorskod] }
    { 28  ;   ;Location Code       ;Code10        ;CaptionML=[ENU=Location Code;
                                                              NOR=Plasseringkode;
                                                              SVE=LagerstÑllekod] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode;
                                                              SVE=GenvÑg dimension 1 kod];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode;
                                                              SVE=GenvÑg dimension 2 kod];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code10      ;CaptionML=[ENU=Customer Posting Group;
                                                              NOR=Bokfõringsgruppe - kunde;
                                                              SVE=Kundbokfîringsmall] }
    { 32  ;   ;Currency Code       ;Code10        ;CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod] }
    { 33  ;   ;Currency Factor     ;Decimal       ;CaptionML=[ENU=Currency Factor;
                                                              NOR=Valutafaktor;
                                                              SVE=Valutafaktor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0 }
    { 34  ;   ;Customer Price Group;Code10        ;CaptionML=[ENU=Customer Price Group;
                                                              NOR=Kundeprisgruppe;
                                                              SVE=Kund prisgrupp] }
    { 35  ;   ;Prices Including VAT;Boolean       ;CaptionML=[ENU=Prices Including VAT;
                                                              NOR=Priser inkl. mva.;
                                                              SVE=Priser inkl. moms] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;CaptionML=[ENU=Invoice Disc. Code;
                                                              NOR=Fakturarabattkode;
                                                              SVE=Fakturarabattkod] }
    { 40  ;   ;Customer Disc. Group;Code20        ;CaptionML=[ENU=Customer Disc. Group;
                                                              NOR=Kunderabattgruppe;
                                                              SVE=Kundrabattgrupp] }
    { 41  ;   ;Language Code       ;Code10        ;CaptionML=[ENU=Language Code;
                                                              NOR=SprÜkkode;
                                                              SVE=SprÜkkod] }
    { 43  ;   ;Salesperson Code    ;Code10        ;CaptionML=[ENU=Salesperson Code;
                                                              NOR=Selgerkode;
                                                              SVE=SÑljarkod] }
    { 44  ;   ;Order No.           ;Code20        ;CaptionML=[ENU=Order No.;
                                                              NOR=Ordrenr.;
                                                              SVE=Ordernr] }
    { 45  ;   ;Order Class         ;Code10        ;CaptionML=[ENU=Order Class;
                                                              NOR=Ordreklasse;
                                                              SVE=Orderstatistiknr] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Comment Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                 No.=FIELD(No.),
                                                                                                 Document Line No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Kommentar;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              NOR=Antall skrevet ut;
                                                              SVE=Utskriven] }
    { 51  ;   ;On Hold             ;Code3         ;CaptionML=[ENU=On Hold;
                                                              NOR=Avvent;
                                                              SVE=Stoppad] }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              NOR=Utligningsbilagstype;
                                                              SVE=Kopplas till dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    NOR=" ,Betaling,Faktura,Kreditnota,Rentenota,Purring,Refusjon";
                                                                    SVE=" ,Betalning,Faktura,Kreditnota,RÑntefaktura,BetalningspÜminnelse,èterbetalning"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;CaptionML=[ENU=Applies-to Doc. No.;
                                                              NOR=Utligningsbilagsnr.;
                                                              SVE=Kopplas till ver.nr] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;CaptionML=[ENU=Bal. Account No.;
                                                              NOR=Motkontonr.;
                                                              SVE=Motkonto] }
    { 57  ;   ;Ship                ;Boolean       ;CaptionML=[ENU=Ship;
                                                              NOR=Levere;
                                                              SVE=Leverera] }
    { 58  ;   ;Invoice             ;Boolean       ;CaptionML=[ENU=Invoice;
                                                              NOR=Faktura;
                                                              SVE=Faktura] }
    { 59  ;   ;Print Posted Documents;Boolean     ;CaptionML=[ENU=Print Posted Documents;
                                                              NOR=Skriv ut bokfõrte dokumenter;
                                                              SVE=Skriv ut bokfîrda dokument] }
    { 62  ;   ;Shipping No.        ;Code20        ;CaptionML=[ENU=Shipping No.;
                                                              NOR=Fõlgeseddelnr.;
                                                              SVE=Leveransnr] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              NOR=Bokfõringsnr.;
                                                              SVE=Bokfîring med nr] }
    { 64  ;   ;Last Shipping No.   ;Code20        ;CaptionML=[ENU=Last Shipping No.;
                                                              NOR=Siste fõlges.nr.;
                                                              SVE=Senaste leveransnr] }
    { 65  ;   ;Last Posting No.    ;Code20        ;CaptionML=[ENU=Last Posting No.;
                                                              NOR=Siste bokfõringsnr.;
                                                              SVE=Senast bokfîrt med nr] }
    { 66  ;   ;Prepayment No.      ;Code20        ;CaptionML=[ENU=Prepayment No.;
                                                              NOR=Forskuddsbetalingsnr;
                                                              SVE=Nr fîr fîrskottsbetalning] }
    { 67  ;   ;Last Prepayment No. ;Code20        ;CaptionML=[ENU=Last Prepayment No.;
                                                              NOR=Siste forskuddsnummer;
                                                              SVE=Nr fîr senaste fîrskottsbetalning] }
    { 68  ;   ;Prepmt. Cr. Memo No.;Code20        ;CaptionML=[ENU=Prepmt. Cr. Memo No.;
                                                              NOR=Kreditnotanummer for forskudd;
                                                              SVE=Kreditnotanr fîr fîrbet.] }
    { 69  ;   ;Last Prepmt. Cr. Memo No.;Code20   ;CaptionML=[ENU=Last Prepmt. Cr. Memo No.;
                                                              NOR=Siste kreditnotanummer for forskudd;
                                                              SVE=Kreditnotanr fîr senaste fîrbet.] }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=VAT Registration No.;
                                                              NOR=Organisasjonsnr.;
                                                              SVE=Momsregistreringsnr] }
    { 71  ;   ;Combine Shipments   ;Boolean       ;CaptionML=[ENU=Combine Shipments;
                                                              NOR=Opprett samlefaktura;
                                                              SVE=Samlingsfakturering] }
    { 73  ;   ;Reason Code         ;Code10        ;CaptionML=[ENU=Reason Code;
                                                              NOR=èrsaksspor;
                                                              SVE=Uppfîljningskod] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokfõringsgruppe - firma;
                                                              SVE=Gen. rîrelsebokfîringsmall] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              NOR=Trekanthandel;
                                                              SVE=EU trepartshandel] }
    { 76  ;   ;Transaction Type    ;Code10        ;CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart;
                                                              SVE=EU transaktionstyp] }
    { 77  ;   ;Transport Method    ;Code10        ;CaptionML=[ENU=Transport Method;
                                                              NOR=TransportmÜte;
                                                              SVE=TransportsÑtt] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;CaptionML=[ENU=VAT Country/Region Code;
                                                              NOR=Lands-/regionkode for mva;
                                                              SVE=Momskod fîr land/region] }
    { 79  ;   ;Sell-to Customer Name;Text100      ;CaptionML=[ENU=Sell-to Customer Name;
                                                              NOR=Salg til-kundenavn;
                                                              SVE=Fîrs.kundnamn] }
    { 80  ;   ;Sell-to Customer Name 2;Text50     ;CaptionML=[ENU=Sell-to Customer Name 2;
                                                              NOR=Salg til-kundenavn 2;
                                                              SVE=Fîrs.kundnamn 2] }
    { 81  ;   ;Sell-to Address     ;Text100       ;CaptionML=[ENU=Sell-to Address;
                                                              NOR=Salg til-adresse;
                                                              SVE=Fîrs.adress] }
    { 82  ;   ;Sell-to Address 2   ;Text50        ;CaptionML=[ENU=Sell-to Address 2;
                                                              NOR=Salg til-adresse 2;
                                                              SVE=Fîrs.adress 2] }
    { 83  ;   ;Sell-to City        ;Text30        ;CaptionML=[ENU=Sell-to City;
                                                              NOR=Salg til-sted;
                                                              SVE=Fîrs.ort] }
    { 84  ;   ;Sell-to Contact     ;Text100       ;CaptionML=[ENU=Sell-to Contact;
                                                              NOR=Salg til-kontakt;
                                                              SVE=Fîrs.kontaktperson] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;CaptionML=[ENU=Bill-to Post Code;
                                                              NOR=Faktura til-postnr.;
                                                              SVE=Faktureras postnr] }
    { 86  ;   ;Bill-to County      ;Text30        ;CaptionML=[ENU=Bill-to County;
                                                              NOR=Faktureres Fylke;
                                                              SVE=Faktureras delstat] }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;CaptionML=[ENU=Bill-to Country/Region Code;
                                                              NOR=Lands-/regionkode for Faktura til;
                                                              SVE=Faktureringsland/-region] }
    { 88  ;   ;Sell-to Post Code   ;Code20        ;CaptionML=[ENU=Sell-to Post Code;
                                                              NOR=Salg til-postnr.;
                                                              SVE=Fîrs.postnrkod] }
    { 89  ;   ;Sell-to County      ;Text30        ;CaptionML=[ENU=Sell-to County;
                                                              NOR=Salg til-fylke/delstat;
                                                              SVE=Fîrs.delstat] }
    { 90  ;   ;Sell-to Country/Region Code;Code10 ;CaptionML=[ENU=Sell-to Country/Region Code;
                                                              NOR=Lands-/regionkode for Salg til;
                                                              SVE=Fîrs.land/-region] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;CaptionML=[ENU=Ship-to Post Code;
                                                              NOR=Lever til-postnr.;
                                                              SVE=Leveranspostnrkod] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[ENU=Ship-to County;
                                                              NOR=Lever til-fylke/delstat;
                                                              SVE=Leveransdelstat] }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;CaptionML=[ENU=Ship-to Country/Region Code;
                                                              NOR=Kode for Leveranseland/-Region;
                                                              SVE=Kod fîr leveransland/-region] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              NOR=Motkontotype;
                                                              SVE=Motkontotyp];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    NOR=Finanskonto,Bankkonto;
                                                                    SVE=Redov.konto,Bankkonto];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;CaptionML=[ENU=Exit Point;
                                                              NOR=Utpunkt;
                                                              SVE=Utfîrselplats] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              NOR=Korreksjon;
                                                              SVE=RÑttningstransaktion] }
    { 99  ;   ;Document Date       ;Date          ;CaptionML=[ENU=Document Date;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum] }
    { 100 ;   ;External Document No.;Code35       ;CaptionML=[ENU=External Document No.;
                                                              NOR=Eksterndokumentnr.;
                                                              SVE=Externt dokumentnr] }
    { 101 ;   ;Area                ;Code10        ;CaptionML=[ENU=Area;
                                                              NOR=OmrÜde;
                                                              SVE=OmrÜde] }
    { 102 ;   ;Transaction Specification;Code10   ;CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon;
                                                              SVE=EU transaktionsspecifikation] }
    { 104 ;   ;Payment Method Code ;Code10        ;CaptionML=[ENU=Payment Method Code;
                                                              NOR=BetalingsmÜte - kode;
                                                              SVE=BetalningssÑtt] }
    { 105 ;   ;Shipping Agent Code ;Code10        ;CaptionML=[ENU=Shipping Agent Code;
                                                              NOR=Transportõrkode;
                                                              SVE=Speditîrkod] }
    { 106 ;   ;Package Tracking No.;Text30        ;CaptionML=[ENU=Package Tracking No.;
                                                              NOR=Pakkesporingsnr;
                                                              SVE=Godsupplysningsnr] }
    { 109 ;   ;Shipping No. Series ;Code10        ;CaptionML=[ENU=Shipping No. Series;
                                                              NOR=Fõlgeseddelnr.serie;
                                                              SVE=Leverans nr-serie] }
    { 110 ;   ;Order No. Series    ;Code10        ;CaptionML=[ENU=Order No. Series;
                                                              NOR=Ordrenr.serie;
                                                              SVE=Order nr-serie] }
    { 111 ;   ;Pre-Assigned No.    ;Code20        ;CaptionML=[ENU=Pre-Assigned No.;
                                                              NOR=ForhÜndstilordnet nr.;
                                                              SVE=Fîrhandstilldelat nr] }
    { 113 ;   ;Source Code         ;Code10        ;CaptionML=[ENU=Source Code;
                                                              NOR=Kildespor;
                                                              SVE=Ursprungskod] }
    { 114 ;   ;Tax Area Code       ;Code20        ;CaptionML=[ENU=Tax Area Code;
                                                              NOR=Mva-omrÜdekode;
                                                              SVE=SkatteomrÜdeskod] }
    { 115 ;   ;Tax Liable          ;Boolean       ;CaptionML=[ENU=Tax Liable;
                                                              NOR=Skyldig mva.;
                                                              SVE=Skattepliktig] }
    { 116 ;   ;VAT Bus. Posting Group;Code10      ;CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokfõringsgruppe - firma;
                                                              SVE=Moms rîrelsebokfîringsmall] }
    { 117 ;   ;Reserve             ;Option        ;CaptionML=[ENU=Reserve;
                                                              NOR=Reserver;
                                                              SVE=Reservera];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    NOR=Aldri,Alternativt,Alltid;
                                                                    SVE=Aldrig,Valfri,Alltid];
                                                   OptionString=Never,Optional,Always }
    { 118 ;   ;Applies-to ID       ;Code50        ;CaptionML=[ENU=Applies-to ID;
                                                              NOR=Utlignings-ID;
                                                              SVE=Koppla till ID] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;CaptionML=[ENU=VAT Base Discount %;
                                                              NOR=Mva-gr.lagsrabatt-%;
                                                              SVE=Nettobelopprabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[ENU=Open,Released,,,,,,,Closed;
                                                                    NOR=èpen,Frigitt,,,,,,,Lukket;
                                                                    SVE=ôppen,SlÑppt,,,,,,,StÑngd];
                                                   OptionString=Open,Released,Pending Approval,Pending Prepayment,,,,,Closed }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              NOR=Fakturarabattberegning;
                                                              SVE=FakturarabattberÑkning];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    NOR=Ingen,%,Belõp;
                                                                    SVE=Ingen,%,Belopp];
                                                   OptionString=None,%,Amount }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              NOR=Fakturarabattverdi;
                                                              SVE=FakturarabattvÑrde];
                                                   AutoFormatType=1 }
    { 123 ;   ;Send IC Document    ;Boolean       ;CaptionML=[ENU=Send IC Document;
                                                              NOR=Sende IC-dokument;
                                                              SVE=Skicka konc.int. dokument] }
    { 130 ;   ;Prepayment %        ;Decimal       ;CaptionML=[ENU=Prepayment %;
                                                              NOR=Forskuddsprosent;
                                                              SVE=Fîrskottsbetalning %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 131 ;   ;Prepayment No. Series;Code10       ;CaptionML=[ENU=Prepayment No. Series;
                                                              NOR=Nummerserie for forskudd;
                                                              SVE=Nummerserie fîr fîrskottsbet.] }
    { 132 ;   ;Compress Prepayment ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Compress Prepayment;
                                                              NOR=Komprimer forskudd;
                                                              SVE=Komprimera fîrskottsbetalning] }
    { 133 ;   ;Prepayment Due Date ;Date          ;CaptionML=[ENU=Prepayment Due Date;
                                                              NOR=Forfallsdato for forskudd;
                                                              SVE=Fîrfallodatum fîr fîrskottsbet.] }
    { 134 ;   ;Prepmt. Cr. Memo No. Series;Code10 ;CaptionML=[ENU=Prepmt. Cr. Memo No. Series;
                                                              NOR=Nummerserie for kreditnota for forskudd;
                                                              SVE=Nr-serie fîr kreditnota fîr fîrbet.] }
    { 135 ;   ;Prepmt. Posting Description;Text50 ;CaptionML=[ENU=Prepmt. Posting Description;
                                                              NOR=Beskrivelse av bokfõring av forskudd;
                                                              SVE=Fîrskottsbet: bokfîringsbeskr.] }
    { 136 ;   ;Prepayment Invoice/Cr. Memo;Boolean;CaptionML=[ENU=Prepayment Invoice/Cr. Memo;
                                                              NOR=ForhÜndbetaling Faktura/Kreditnota;
                                                              SVE=Fîrskottsfaktura/kredit] }
    { 137 ;   ;Prepayment Order No.;Code20        ;CaptionML=[ENU=Prepayment Order No.;
                                                              NOR=Ordrenummer for forskudd;
                                                              SVE=Ordernr fîr fîrskottsbetalning] }
    { 138 ;   ;Prepmt. Pmt. Discount Date;Date    ;CaptionML=[ENU=Prepmt. Pmt. Discount Date;
                                                              NOR=Betalingsrabattdato for forskuddsbetaling;
                                                              SVE=Betalningsrabattdatum fîr fîrskottsbetalning] }
    { 139 ;   ;Prepmt. Payment Terms Code;Code10  ;CaptionML=[ENU=Prepmt. Payment Terms Code;
                                                              NOR=BetalingsvilkÜrskode for forskuddsbetaling;
                                                              SVE=Betalningsvillkorskod fîr fîrskottsbetalning] }
    { 140 ;   ;Prepmt. Payment Discount %;Decimal ;CaptionML=[ENU=Prepmt. Payment Discount %;
                                                              NOR=Rabattprosent for betaling for forskudd;
                                                              SVE=Kassarabatter i % fîr fîrskottsbetalning];
                                                   DecimalPlaces=0:5 }
    { 151 ;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              NOR=Forespõrselsnr.;
                                                              SVE=Offertnr] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID;
                                                              SVE=DimensionsuppsÑttnings-ID] }
    { 825 ;   ;Authorization Required;Boolean     ;CaptionML=[ENU=Authorization Required;
                                                              NOR=Godkjenning kreves;
                                                              SVE=Auktorisering krÑvs] }
    { 827 ;   ;Credit Card No.     ;Code20        ;CaptionML=[ENU=Credit Card No.;
                                                              NOR=Kredittkortnummer;
                                                              SVE=Kreditkortsnr] }
    { 5043;   ;No. of Archived Versions;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Max("Sales Header Archive"."Version No." WHERE (Document Type=FIELD(Document Type),
                                                                                                               No.=FIELD(No.),
                                                                                                               Doc. No. Occurrence=FIELD(Doc. No. Occurrence)));
                                                   CaptionML=[ENU=No. of Archived Versions;
                                                              NOR=Ant. arkiverte versjoner;
                                                              SVE=Ant. arkiverade versioner];
                                                   Editable=No }
    { 5048;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[ENU=Doc. No. Occurrence;
                                                              NOR=Dokumentnr. Forekomst;
                                                              SVE=Dok.nr fîrekomst] }
    { 5050;   ;Campaign No.        ;Code20        ;CaptionML=[ENU=Campaign No.;
                                                              NOR=Kampanjenr.;
                                                              SVE=Kampanjnr] }
    { 5051;   ;Sell-to Customer Template Code;Code10;
                                                   CaptionML=[ENU=Sell-to Customer Template Code;
                                                              NOR=Salg til-kunde - malkode;
                                                              SVE=Fîrs.kundmallkod] }
    { 5052;   ;Sell-to Contact No. ;Code20        ;CaptionML=[ENU=Sell-to Contact No.;
                                                              NOR=Salg til-kontaktnr.;
                                                              SVE=Fîrs.kontaktnr] }
    { 5053;   ;Bill-to Contact No. ;Code20        ;CaptionML=[ENU=Bill-to Contact No.;
                                                              NOR=Faktura til-kontaktnr.;
                                                              SVE=Faktureringskontaktnr] }
    { 5054;   ;Bill-to Customer Template Code;Code10;
                                                   CaptionML=[ENU=Bill-to Customer Template Code;
                                                              NOR=Faktura til-kundenr. - malkode;
                                                              SVE=Mallkod fîr faktureringskund] }
    { 5055;   ;Opportunity No.     ;Code20        ;CaptionML=[ENU=Opportunity No.;
                                                              NOR=Salgsmulighetsnr.;
                                                              SVE=AffÑrsmîjlighetsnr] }
    { 5700;   ;Responsibility Center;Code10       ;CaptionML=[ENU=Responsibility Center;
                                                              NOR=Ansvarssenter;
                                                              SVE=Ansvarsenhet] }
    { 5750;   ;Shipping Advice     ;Option        ;CaptionML=[ENU=Shipping Advice;
                                                              NOR=Leveringsõnske;
                                                              SVE=Leveranstyp];
                                                   OptionCaptionML=[ENU=Partial,Complete;
                                                                    NOR=Delvis,Fullstendig;
                                                                    SVE=Delvis,FullstÑndig];
                                                   OptionString=Partial,Complete }
    { 5751;   ;Shipped Not Invoiced;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Qty. Shipped Not Invoiced=FILTER(<>0)));
                                                   CaptionML=[ENU=Shipped Not Invoiced;
                                                              NOR="Levert ikke fakturert ";
                                                              SVE=Levererat ej fakturerat];
                                                   Editable=No }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Sales Line"."Completely Shipped" WHERE (Document Type=FIELD(Document Type),
                                                                                                            Document No.=FIELD(No.),
                                                                                                            Type=FILTER(<>' '),
                                                                                                            Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Completely Shipped;
                                                              NOR=Fullstendig levert;
                                                              SVE=FÑrdigt levererat];
                                                   Editable=No }
    { 5753;   ;Posting from Whse. Ref.;Integer    ;CaptionML=[ENU=Posting from Whse. Ref.;
                                                              NOR=Bokfõring fra lagerref.;
                                                              SVE=Bokf. frÜn dist.lager ref.] }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Location Filter;
                                                              NOR=Lokasjonsfilter;
                                                              SVE=LagerstÑllefilter] }
    { 5790;   ;Requested Delivery Date;Date       ;CaptionML=[ENU=Requested Delivery Date;
                                                              NOR=Anmodet leveringsdato;
                                                              SVE=BegÑrt leveransdatum] }
    { 5791;   ;Promised Delivery Date;Date        ;CaptionML=[ENU=Promised Delivery Date;
                                                              NOR=Lovet leveringsdato;
                                                              SVE=Lovat leveransdatum] }
    { 5792;   ;Shipping Time       ;DateFormula   ;CaptionML=[ENU=Shipping Time;
                                                              NOR=Leveringstid;
                                                              SVE=Leveranstid] }
    { 5793;   ;Outbound Whse. Handling Time;DateFormula;
                                                   CaptionML=[ENU=Outbound Whse. Handling Time;
                                                              NOR=UtgÜende lagerhÜndteringstid;
                                                              SVE=AvgÜende lagerhanteringstid] }
    { 5794;   ;Shipping Agent Service Code;Code10 ;CaptionML=[ENU=Shipping Agent Service Code;
                                                              NOR=Transportõrservicekode;
                                                              SVE=Speditîr servicekod] }
    { 5795;   ;Late Order Shipping ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                                                                         Document No.=FIELD(No.),
                                                                                         Shipment Date=FIELD(Date Filter),
                                                                                         Outstanding Quantity=FILTER(<>0)));
                                                   CaptionML=[ENU=Late Order Shipping;
                                                              NOR=Forsinket levering;
                                                              SVE=Sen orderleverans];
                                                   Editable=No }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter;
                                                              SVE=Datumfilter] }
    { 5800;   ;Receive             ;Boolean       ;CaptionML=[ENU=Receive;
                                                              NOR=Motta;
                                                              SVE=Inleverera] }
    { 5801;   ;Return Receipt No.  ;Code20        ;CaptionML=[ENU=Return Receipt No.;
                                                              NOR=Returseddelnr.;
                                                              SVE=Returinleveransnr] }
    { 5802;   ;Return Receipt No. Series;Code20   ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Return Receipt No. Series;
                                                              NOR=Returseddel - nr.serie;
                                                              SVE=Returinleverans nr-serie] }
    { 5803;   ;Last Return Receipt No.;Code20     ;CaptionML=[ENU=Last Return Receipt No.;
                                                              NOR=Siste returseddelnr.;
                                                              SVE=Senaste returinleveransnr] }
    { 6601;   ;Return Order No.    ;Code20        ;CaptionML=[ENU=Return Order No.;
                                                              NOR=Bestillingsreturnr.;
                                                              SVE=Returordernr] }
    { 6602;   ;Return Order No. Series;Code10     ;CaptionML=[ENU=Return Order No. Series;
                                                              NOR=Nr.serie for bestillingsretur;
                                                              SVE=Returorder nr-serie] }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;CaptionML=[ENU=Allow Line Disc.;
                                                              NOR=Tillat linjerabatt;
                                                              SVE=TillÜt radrabatt] }
    { 7200;   ;Get Shipment/Return Rcpt. Used;Boolean;
                                                   CaptionML=[ENU=Get Shipment/Return Rcpt. Used;
                                                              NOR=Hent Forsendelse/Retur, Kvittering brukt;
                                                              SVE=HÑmtad leverans/retur] }
    { 9000;   ;Assigned User ID    ;Code50        ;CaptionML=[ENU=Assigned User ID;
                                                              NOR=Tilordnet bruker-ID;
                                                              SVE=Tilldelat anvÑndar-ID] }
    { 11012000;;Project Invoice/Credit Memo;Boolean;
                                                   CaptionML=[ENU=Project Invoice/Credit Memo;
                                                              NOR=Prosjekt Faktura/Kreditnota;
                                                              SVE=Projektfaktura/kredit] }
    { 11012005;;Job No.            ;Code20        ;CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 11012010;;Installment Invoice/Cr. Memo;Boolean;
                                                   CaptionML=[ENU=Installment Invoice/Cr. Memo;
                                                              NOR=Avdrag Faktura/Kreditnota;
                                                              SVE=Avbetalningsfaktura/kredit] }
    { 11012015;;Production Motivation Date;Date   ;CaptionML=[ENU=Production Motivation Date;
                                                              NOR=Produksjonsmotivasjonsdato;
                                                              SVE=Datum fîr Produktionsorsak] }
    { 11012016;;Production Motivation Code;Code10 ;CaptionML=[ENU=Production Motivation Code;
                                                              NOR=Produksjonsmotivasjonskode;
                                                              SVE=Produktionsorsakskod] }
    { 11012020;;Invoice/Credit Memo Text;Text250  ;CaptionML=[ENU=Invoice/Credit Memo Text;
                                                              NOR=Faktura/Kreditnota Tekst;
                                                              SVE=Faktura/Kredit text] }
    { 11012030;;Interest Date      ;Date          ;CaptionML=[ENU=Interest Date;
                                                              NOR=Rentedato;
                                                              SVE=RÑntedatum] }
    { 11012040;;Related Sales Order No.;Code20    ;CaptionML=[ENU=Related Sales Order No.;
                                                              NOR=Relatert salgsordrenr;
                                                              SVE=Relaterat fîrs.ordernr] }
    { 11012258;;Company VAT Registration No.;Text20;
                                                   CaptionML=[ENU=Company VAT Registration No.;
                                                              NOR=Selskapets momsregistreringsnr;
                                                              SVE=Fîretagets momsregistreringsnr] }
    { 11012259;;Country/Region of Origin;Code10   ;CaptionML=[ENU=Country/Region of Origin;
                                                              NOR=Opprinnelsesland/Opprinnelsesregion;
                                                              SVE=Ursprungsland/ursprungsregion] }
    { 11012260;;Country/Region of Destination;Code10;
                                                   CaptionML=[ENU=Country/Region of Destination;
                                                              NOR=Destinasjonsland/destinasjonsregion;
                                                              SVE=Destinationsland/destinationsregion] }
    { 11012261;;Extended VAT Determination;Boolean;CaptionML=[ENU=Extended VAT Determination;
                                                              NOR=Utvidet momsbestemmelse;
                                                              SVE=Utîkad momsbestÑmning] }
    { 11012262;;Invoice From       ;Option        ;CaptionML=[ENU=Invoice From;
                                                              NOR=Faktura fra;
                                                              SVE=Faktura frÜn];
                                                   OptionCaptionML=[ENU=" ,Logistic,Sales";
                                                                    NOR=" ,Logistikk,Salg";
                                                                    SVE=" ,Logistik,FîrsÑljning"];
                                                   OptionString=[ ,Logistic,Sales] }
    { 11012265;;Offer Amount       ;Decimal       ;CaptionML=[ENU=Offer Amount;
                                                              NOR=Tilbudsbelõp;
                                                              SVE=Anbudsbelopp] }
    { 11012270;;Selection Code     ;Code20        ;CaptionML=[ENU=Selection Code;
                                                              NOR=Utvalgskode;
                                                              SVE=Valkod] }
    { 11012271;;Selection Code is Current Doc.;Boolean;
                                                   CaptionML=[ENU=Selection Code is Current Doc.;
                                                              NOR=Utvalgskoden er aktuelt dok.;
                                                              SVE=Valkoden Ñr aktuellt dok.] }
    { 11012280;;Invoice Layout Code;Code10        ;CaptionML=[ENU=Invoice Layout Code;
                                                              NOR=Fakturalayoutkode;
                                                              SVE=Fakturalayoutkod] }
    { 11012377;;Valid Until        ;Date          ;CaptionML=[ENU=Valid Until;
                                                              NOR=Gyldig til;
                                                              SVE=Giltigt till] }
    { 11012390;;Extra Shipments Allowed;Boolean   ;CaptionML=[ENU=Extra Shipments Allowed;
                                                              NOR=Ekstra forsendelser tillatt;
                                                              SVE=TillÜtna extra utleveranser] }
    { 11012391;;Shipping Details   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Shipping Details" WHERE (Source=FILTER(SalesOrder),
                                                                                               Order No.=FIELD(No.)));
                                                   CaptionML=[ENU=Shipping Details;
                                                              NOR=Leveringsdetaljer;
                                                              SVE=Leveransinformation];
                                                   Editable=No }
    { 11012495;;Rental Contract Modified on;Date  ;CaptionML=[ENU=Rental Contract Modified on;
                                                              NOR=Leiekontrakten endret den;
                                                              SVE=Uthyrningskontraktet Ñndrades] }
    { 11012500;;Elected Alternative No.;Integer   ;CaptionML=[ENU=Elected Alternative No.;
                                                              NOR=Valgt alternativnr;
                                                              SVE=Valt alternativnr];
                                                   MinValue=0 }
    { 11012505;;Plant Location Code;Code20        ;CaptionML=[ENU=Plant Location;
                                                              NOR=Maskinplassering;
                                                              SVE=Maskinutplacering] }
    { 11012506;;Plant Depot Logistics;Code20      ;CaptionML=[ENU=Plant Depot Logistics;
                                                              NOR=Maskindepot, logistikk;
                                                              SVE=MaskindepÜ, logistik] }
    { 11012507;;Location Code Logistics;Code10    ;CaptionML=[ENU=Location Code Logistics;
                                                              NOR=Logistikk for lokasjonkode;
                                                              SVE=Logistik fîr lagerstÑllekod] }
    { 11012511;;Arrival Date       ;Date          ;CaptionML=[ENU=Arrival Date;
                                                              NOR=Ankomstdato;
                                                              SVE=Ankomstdatum] }
    { 11012512;;Removal Date       ;Date          ;CaptionML=[ENU=Removal Date;
                                                              NOR=Fjerningsdato;
                                                              SVE=Borttagningsdatum] }
    { 11012513;;Rental Starting Date;Date         ;CaptionML=[ENU=Rental Starting Date;
                                                              NOR=Startdato for Leie;
                                                              SVE=Startdatum fîr uthyrning] }
    { 11012514;;Rental Ending Date ;Date          ;CaptionML=[ENU=Rental Ending Date;
                                                              NOR=Sluttdato for Leleie;
                                                              SVE=Slutdatum fîr uthyrning] }
    { 11012515;;Rental Contract Invoice Status;Option;
                                                   CaptionML=[ENU=Rental Contract Invoice Status;
                                                              NOR=Leiekontrakt, fakturastatus;
                                                              SVE=Uthyrningskontrakt, fakturastatus];
                                                   OptionCaptionML=[ENU=Open,Chargeable,Temporary,Invoiced;
                                                                    NOR=èpen,Belastbar,Midlertidig,Fakturert;
                                                                    SVE=ôppen,Debiterbar,TillfÑllig,Fakturerad];
                                                   OptionString=Open,Chargeable,Temporary,Invoiced }
    { 11012548;;Plant Location Filter;Code250     ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Plant Location Filter;
                                                              NOR=Maskinlokasjonsfilter;
                                                              SVE=Maskinutplaceringfilter] }
    { 11012549;;Plant Loc. Filter On Invoice;Boolean;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Plant Location=FIELD(Plant Location Filter)));
                                                   CaptionML=[ENU=Plant Loc. Filter On Invoice;
                                                              NOR=Maskinlokasjonsfilter pÜ faktura;
                                                              SVE=Maskinutplacering Filtrera pÜ faktura];
                                                   Editable=No }
    { 11012550;;Plant Invoice      ;Boolean       ;CaptionML=[ENU=Plant Invoice;
                                                              NOR=Maskinfaktura;
                                                              SVE=Maskinfaktura] }
    { 11012551;;Rental Period to Date;Date        ;CaptionML=[ENU=Rental Period to Date;
                                                              NOR=Leieperiode til dato;
                                                              SVE=Uthyrningsperiod till datum] }
    { 11012552;;Company Name       ;Text30        ;CaptionML=[ENU=Company Name;
                                                              NOR=Navn pÜ selskap;
                                                              SVE=Fîretagsnamn] }
    { 11012554;;Service Invoice    ;Boolean       ;CaptionML=[ENU=Service Invoice;
                                                              NOR=Servicefaktura;
                                                              SVE=Servicefaktura] }
    { 11012555;;Alternative Bill-to Address;Code10;CaptionML=[ENU=Alternative Bill-to Address;
                                                              NOR=Alternativ Faktureringsadresse;
                                                              SVE=Alternativ faktureringsadress] }
    { 11012556;;Exported on        ;Date          ;CaptionML=[ENU=Exported on;
                                                              NOR=Eksportert den;
                                                              SVE=Exporterat den] }
    { 11012557;;Rental Unit Invoice;Boolean       ;CaptionML=[ENU=Rental Unit Invoice;
                                                              NOR=Leieenhetsfaktura;
                                                              SVE=Uthyrningsenhetsfaktura] }
    { 11012558;;Withhold % Last Installment;Decimal;
                                                   CaptionML=[ENU=Withhold % Last Installment;
                                                              NOR=Tilbakehold % Forrige Avdrag;
                                                              SVE=InnehÜll % av senaste avbetalning] }
    { 11012559;;Public notary      ;Code20        ;CaptionML=[ENU=Public notary;
                                                              NOR=Notarius publicus;
                                                              SVE=Notarius publicus] }
    { 11012560;;Last Installment Amount;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Invoice Line"."Amount Including VAT" WHERE (Document No.=FIELD(No.),
                                                                                                                      Last Installment=CONST(Yes)));
                                                   CaptionML=[ENU=Last Installment Amount;
                                                              NOR=Siste avdragsbelõp;
                                                              SVE=Senaste avbetalningsbelopp];
                                                   Editable=No }
    { 11012561;;Notary Case Number ;Text30        ;CaptionML=[ENU=Notary Case Number;
                                                              NOR=Notariens Saksnummer;
                                                              SVE=Notariens Ñrendenummer] }
    { 11012562;;Calculate B Amounts based on;Option;
                                                   CaptionML=[ENU=Calculate B Amounts based on;
                                                              NOR=Beregn B-belõp basert pÜ;
                                                              SVE=BerÑkna B-belopp baserat pÜ];
                                                   OptionCaptionML=[ENU=Labor Amount,Invoice Amount;
                                                                    NOR=Arbeidskraftsbelõp,Faktureringsbelõp;
                                                                    SVE=Arbetskraftsbelopp,faktureringsbelopp];
                                                   OptionString=Labor Amount,Invoice Amount }
    { 11012563;;Labor Amount (Subcontracting);Decimal;
                                                   CaptionML=[ENU=Labor Amount (Subcontracting);
                                                              NOR=Arbeidskraftsbelõp (Underentrepenõr);
                                                              SVE=Arbetskraftsbelopp (underentreprenad)];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012564;;Blocked Amount (Subcontracting;Decimal;
                                                   CaptionML=[ENU=Blocked Amount (Subcontracting);
                                                              NOR=Sperret belõp (Underentrepenõr);
                                                              SVE=SpÑrrat belopp (underentreprenad)];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012566;;Specific WKA Percentages;Boolean  ;CaptionML=[ENU=Specific WKA Percentages;
                                                              NOR=Spesifike WKA-Prosentsatser;
                                                              SVE=Specifika WKA-procentsatser] }
    { 11012567;;% Labor            ;Decimal       ;CaptionML=[ENU=% Labor;
                                                              NOR=% arbeidskraft;
                                                              SVE=Procent, arbetskraft];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   AutoFormatType=1 }
    { 11012568;;% to B Account     ;Decimal       ;CaptionML=[ENU=% to B Account;
                                                              NOR=% til B-konto;
                                                              SVE=Procent till B-konto];
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 11012570;;WKA Period         ;Text50        ;CaptionML=[ENU=WKA Period;
                                                              NOR=WKA-periode;
                                                              SVE=WKA-period] }
    { 11012585;;Sales Document Type;Option        ;CaptionML=[ENU=Sales Document Type;
                                                              NOR=Salgsdokumenttype;
                                                              SVE=Fîrs.dokumenttyp];
                                                   OptionCaptionML=[ENU=Standard,Sales Logistics Separated,Rental Contract;
                                                                    NOR=Standard,Salgslogistikk separert,Leiekontrakt;
                                                                    SVE=Standard,FîrsÑljningslogistik separerad,Uthyrningskontrakt];
                                                   OptionString=Standard,Sales Logistics Separated,RentalContract }
    { 11012590;;PDF Send Released  ;Boolean       ;CaptionML=[ENU=PDF Send Released;
                                                              NOR=PDF, send frigitte;
                                                              SVE=PDF, skicka slÑppta] }
    { 11012591;;PDF Document is Send;Boolean      ;CaptionML=[ENU=PDF Document is Send;
                                                              NOR=PDF-dokumentet er sendt;
                                                              SVE=PDF-dokumentet har skickats] }
    { 11012592;;PDF Date Send      ;Date          ;CaptionML=[ENU=PDF Date Send;
                                                              NOR=PDF, dato sendt;
                                                              SVE=PDF, datum skickat] }
    { 11012594;;PDF Print Code     ;Boolean       ;CaptionML=[ENU=PDF Print Code;
                                                              NOR=PDF-utskriftskode;
                                                              SVE=PDF-utskriftskod] }
    { 11012595;;XML-Export         ;Boolean       ;CaptionML=[ENU=XML-Export;
                                                              NOR=XML Õ eksporter;
                                                              SVE=XML Õ Exportera] }
    { 11012596;;XML Exported       ;Boolean       ;CaptionML=[ENU=XML Exported;
                                                              NOR=XML Õ eksportert;
                                                              SVE=XML har exporterats] }
    { 11012610;;Inserted By        ;Code50        ;CaptionML=[ENU=Inserted By;
                                                              NOR=Satt inn av;
                                                              SVE=Infogad av] }
    { 11012620;;Invoice Frequency Rental;DateFormula;
                                                   CaptionML=[ENU=Invoice Frequency Rental;
                                                              NOR=Faktureringsintervall for leie;
                                                              SVE=Faktureringsintervall fîr uthyrning] }
    { 11012700;;Service Warranty Code;Code10      ;CaptionML=[ENU=Service Warranty Code;
                                                              NOR=Servicegarantikode;
                                                              SVE=Servicegarantikod] }
    { 11012800;;Service Call No.   ;Code20        ;CaptionML=[ENU=Service Call No.;
                                                              NOR=Servicesamtalenr.;
                                                              SVE=Servicesamtalsnr] }
    { 11012801;;Description Service Call;Text50   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Call".Description WHERE (No.=FIELD(Service Call No.)));
                                                   CaptionML=[ENU=Description Service Call;
                                                              NOR=Beskrivelse av servicesamtale;
                                                              SVE=Servicesamtalsbeskrivning];
                                                   Editable=No }
    { 11012804;;Service Contract No.;Code20       ;CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr] }
    { 11012805;;Service Order No.  ;Code20        ;CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr] }
    { 11012810;;Principal Reference;Text50        ;CaptionML=[ENU=Principal Reference;
                                                              NOR=Oppdragsgiverreferanse;
                                                              SVE=Uppdragsgivarreferens] }
    { 11012820;;Order No. Customer ;Text50        ;CaptionML=[ENU=Order No. Customer;
                                                              NOR=Ordrenr, (Kunde);
                                                              SVE=Ordernr, (kund)] }
    { 11012830;;Commision Date Customer;Date      ;CaptionML=[ENU=Commision Date Principal;
                                                              NOR=Kommisjonsdato, oppdragsgiver;
                                                              SVE=Provisionsdatum, uppdragsgivare] }
    { 11012840;;Ship-to Contact No.;Code20        ;CaptionML=[ENU=Ship-to Contact No.;
                                                              NOR=Leveranse, Kontaktnr.;
                                                              SVE=Leverans, kontaktnr] }
    { 11012850;;Ship-to Phone No.  ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone No.;
                                                              NOR=Lever til-telefonnummer;
                                                              SVE=Leveranstelefonnr] }
    { 11012860;;Amount Payment in Advance;Decimal ;CaptionML=[ENU=Amount Payment in Advance;
                                                              NOR=Belõp, forskuddsbetaling;
                                                              SVE=Belopp, betalning i fîrskott];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012870;;Salesperson Name   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Salesperson Code)));
                                                   CaptionML=[ENU=Salesperson Name;
                                                              NOR=Selgernavn;
                                                              SVE=SÑljarnamn];
                                                   Editable=No }
    { 11012998;;Sales Representative Code;Code10  ;CaptionML=[ENU=Sales Representative Code;
                                                              NOR=Salgsrepresentantkode;
                                                              SVE=Fîrs.representantkod] }
    { 11012999;;Name Sales Representative;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Sales Representative Code)));
                                                   CaptionML=[ENU=Name Sales Representative;
                                                              NOR=Navn pÜ selger;
                                                              SVE=SÑljarens namn];
                                                   Editable=No }
    { 11020254;;Credit Restriction ;Code20        ;CaptionML=[ENU=Credit Restriction;
                                                              NOR=Kreditrestriksjon;
                                                              SVE=Kreditrestriktion] }
    { 11020255;;Credit Restriction Date;Date      ;CaptionML=[ENU=Credit Restriction Date;
                                                              NOR=Kreditrestriksjonsdato;
                                                              SVE=Kreditrestriktionsdatum] }
    { 11020256;;Credit Restriction %;Decimal      ;CaptionML=[ENU=Credit Restriction %;
                                                              NOR=Kreditrestriksjon %;
                                                              SVE=Kreditrestriktion %];
                                                   DecimalPlaces=0:2 }
    { 11020257;;Credit Restriction Amount;Decimal ;CaptionML=[ENU=Credit Restriction Amount;
                                                              NOR=Kreditrestriksjonsbelõp;
                                                              SVE=Kreditrestriktionsbelopp];
                                                   DecimalPlaces=2:2 }
    { 11020258;;Payment Discount % 2;Decimal      ;CaptionML=[ENU=Payment Discount % 2;
                                                              NOR=Kontantrabatt % 2;
                                                              SVE=Kassarabatt % 2];
                                                   DecimalPlaces=0:5 }
    { 11020259;;Pmt. Discount Date 2;Date         ;CaptionML=[ENU=Pmt. Discount Date 2;
                                                              NOR=Kontantrabattdato 2;
                                                              SVE=Kassa Rabattdatum 2] }
    { 11020260;;Payment Discount % 3;Decimal      ;CaptionML=[ENU=Payment Discount % 3;
                                                              NOR=Kontantrabatt % 3;
                                                              SVE=Kassarabatt % 3];
                                                   DecimalPlaces=0:5 }
    { 11020261;;Pmt. Discount Date 3;Date         ;CaptionML=[ENU=Pmt. Discount Date 3;
                                                              NOR=Kontantrabattdato 3;
                                                              SVE=Kassa Rabattdatum 3] }
    { 11020270;;Delivery Time      ;Time          ;CaptionML=[ENU=Delivery Time;
                                                              NOR=Leveransetid;
                                                              SVE=Leveranstid] }
    { 11020280;;E-Mail (Invoices)  ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email (Invoices);
                                                              SVE=E-post (Fakturor)] }
    { 11020285;;Electronic Invoicing;Option       ;CaptionML=[ENU=Electronic Invoicing;
                                                              NOR=Elektronisk fakturering;
                                                              SVE=Elektronisk fakturering];
                                                   OptionCaptionML=[ENU=Print,,E-Mail,,GLN (XML),Digipoort (XML);
                                                                    NOR=Skriv ut,,Email,,GLN (XML),Digipoort (XML);
                                                                    SVE=Skriv ut,,Email,,GLN (XML),Digipoort (XML)];
                                                   OptionString=Print,,E-Mail,,GLN (XML),Digipoort (XML) }
    { 11020287;;NAV 2009 Invoice   ;Boolean       ;CaptionML=ENU=NAV 2009 Invoice }
    { 11128020;;ROT/RUT reduction  ;Boolean       ;CaptionML=SVE=ROT/RUT avdrag;
                                                   Description=I.012 }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Checksiffra@1100285501 : Decimal;
      PersNr@1100285500 : Code[10];

    PROCEDURE Amount@1100525002() : Decimal;
    VAR
      SalesLine@1100525000 : Record 37;
      SalesInvoiceLine@1100525001 : Record 113;
      SalesCrMemoLine@1100525002 : Record 115;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice", "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesLine.SETCURRENTKEY("Document Type", "Document No.");
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            SalesLine.CALCSUMS(Amount);
            EXIT(SalesLine.Amount);
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceLine.SETCURRENTKEY("Document No.");
            SalesInvoiceLine.SETRANGE("Document No.", "No.");
            SalesInvoiceLine.CALCSUMS(Amount);
            EXIT(SalesInvoiceLine.Amount);
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoLine.SETCURRENTKEY("Document No.");
            SalesCrMemoLine.SETRANGE("Document No.", "No.");
            SalesCrMemoLine.CALCSUMS(Amount);
            EXIT(-SalesCrMemoLine.Amount);
          END;
      END;
    END;

    PROCEDURE FilteredAmount@1100527301(Extensions@1100527300 : Boolean) : Decimal;
    VAR
      SalesLine@1100525000 : Record 37;
      SalesInvoiceLine@1100525001 : Record 113;
      SalesCrMemoLine@1100525002 : Record 115;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesLine.SETCURRENTKEY("Document Type", "Document No.");
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            IF NOT Extensions THEN
              SalesLine.SETRANGE("Extension Contract", '');
            SalesLine.SETRANGE(Option, '');
            SalesLine.CALCSUMS(Amount);
            EXIT(SalesLine.Amount);
          END;
        "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesLine.SETCURRENTKEY("Document Type", "Document No.");
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            IF NOT Extensions THEN
              SalesLine.SETRANGE("Extension Contract", '');
            SalesLine.SETRANGE(Option, '');
            SalesLine.CALCSUMS(Amount);
            EXIT(-SalesLine.Amount);
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceLine.SETCURRENTKEY("Document No.");
            SalesInvoiceLine.SETRANGE("Document No.", "No.");
            IF NOT Extensions THEN
              SalesInvoiceLine.SETRANGE("Extension Contract", '');
            SalesInvoiceLine.SETRANGE(Option, '');
            SalesInvoiceLine.CALCSUMS(Amount);
            EXIT(SalesInvoiceLine.Amount);
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoLine.SETCURRENTKEY("Document No.");
            SalesCrMemoLine.SETRANGE("Document No.", "No.");
            IF NOT Extensions THEN
              SalesCrMemoLine.SETRANGE("Extension Contract", '');
            SalesCrMemoLine.SETRANGE(Option, '');
            SalesCrMemoLine.CALCSUMS(Amount);
            EXIT(-SalesCrMemoLine.Amount);
          END;
      END;
    END;

    PROCEDURE AmountIncludingVAT@1100525003() : Decimal;
    VAR
      SalesLine@1100525000 : Record 37;
      SalesInvoiceLine@1100525001 : Record 113;
      SalesCrMemoLine@1100525002 : Record 115;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice", "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesLine.SETCURRENTKEY("Document Type", "Document No.");
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            SalesLine.CALCSUMS("Amount Including VAT");
            EXIT(SalesLine."Amount Including VAT");
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceLine.SETCURRENTKEY("Document No.");
            SalesInvoiceLine.SETRANGE("Document No.", "No.");
            SalesInvoiceLine.CALCSUMS("Amount Including VAT");
            EXIT(SalesInvoiceLine."Amount Including VAT");
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoLine.SETCURRENTKEY("Document No.");
            SalesCrMemoLine.SETRANGE("Document No.", "No.");
            SalesCrMemoLine.CALCSUMS("Amount Including VAT");
            EXIT(-SalesCrMemoLine."Amount Including VAT");
          END;
      END;
    END;

    PROCEDURE AmountVAT@1100525007() : Decimal;
    VAR
      SalesLine@1100525000 : Record 37;
      SalesInvoiceLine@1100525001 : Record 113;
      SalesCrMemoLine@1100525002 : Record 115;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice", "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesLine.SETCURRENTKEY("Document Type", "Document No.");
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            SalesLine.CALCSUMS("Line VAT Amount");
            EXIT(SalesLine."Line VAT Amount");
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceLine.SETCURRENTKEY("Document No.");
            SalesInvoiceLine.SETRANGE("Document No.", "No.");
            SalesInvoiceLine.CALCSUMS("Line VAT Amount");
            EXIT(SalesInvoiceLine."Line VAT Amount");
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoLine.SETCURRENTKEY("Document No.");
            SalesCrMemoLine.SETRANGE("Document No.", "No.");
            SalesCrMemoLine.CALCSUMS("Line VAT Amount");
            EXIT(SalesCrMemoLine."Line VAT Amount");
          END;
      END;
    END;

    PROCEDURE OpenComplaints@1100525014() : Integer;
    VAR
      ComplaintDocument@1100525000 : Record 11012457;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Posted Invoice":
          BEGIN
            ComplaintDocument.SETRANGE("Document Type", ComplaintDocument."Document Type"::"PI-S");
            ComplaintDocument.SETRANGE("Document No.", "No.");
            ComplaintDocument.SETFILTER("Complaint Status", STRSUBSTNO('<>%', ComplaintDocument."Complaint Status"::Finished));
            EXIT(ComplaintDocument.COUNT);
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            ComplaintDocument.SETRANGE("Document Type", ComplaintDocument."Document Type"::"PM-S");
            ComplaintDocument.SETRANGE("Document No.", "No.");
            ComplaintDocument.SETFILTER("Complaint Status", STRSUBSTNO('<>%', ComplaintDocument."Complaint Status"::Finished));
            EXIT(ComplaintDocument.COUNT);
          END;
      END;
    END;

    PROCEDURE Complaints@1100525001() : Integer;
    VAR
      ComplaintDocument@1100525000 : Record 11012457;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Posted Invoice":
          BEGIN
            ComplaintDocument.SETRANGE("Document Type", ComplaintDocument."Document Type"::"PI-S");
            ComplaintDocument.SETRANGE("Document No.", "No.");
            EXIT(ComplaintDocument.COUNT);
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            ComplaintDocument.SETRANGE("Document Type", ComplaintDocument."Document Type"::"PM-S");
            ComplaintDocument.SETRANGE("Document No.", "No.");
            EXIT(ComplaintDocument.COUNT);
          END;
      END;
    END;

    PROCEDURE HasOnlyReverseChargeVATLines@1100525024() : Boolean;
    VAR
      SalesLine@1100525002 : Record 37;
      SalesInvoiceLine@1100525001 : Record 113;
      SalesCrMemoLine@1100525000 : Record 115;
      HasReverseChargeVatLines@1100525003 : Boolean;
      HasOtherVatLines@1100528400 : Boolean;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice", "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            SalesLine.SETFILTER("VAT Identifier", STRSUBSTNO('<>''%1''', ''));
            SalesLine.SETRANGE("VAT Calculation Type", SalesLine."VAT Calculation Type"::"Reverse Charge VAT");
            HasReverseChargeVatLines := NOT SalesLine.ISEMPTY;
            SalesLine.SETFILTER(
              "VAT Calculation Type", STRSUBSTNO('<>%1', SalesLine."VAT Calculation Type"::"Reverse Charge VAT"));
            HasOtherVatLines := NOT SalesLine.ISEMPTY;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceLine.SETRANGE("Document No.", "No.");
            SalesInvoiceLine.SETFILTER("VAT Identifier", STRSUBSTNO('<>''%1''', ''));
            SalesInvoiceLine.SETRANGE("VAT Calculation Type", SalesInvoiceLine."VAT Calculation Type"::"Reverse Charge VAT");
            HasReverseChargeVatLines := NOT SalesInvoiceLine.ISEMPTY;
            SalesInvoiceLine.SETFILTER(
              "VAT Calculation Type", STRSUBSTNO('<>%1', SalesInvoiceLine."VAT Calculation Type"::"Reverse Charge VAT"));
            HasOtherVatLines := NOT SalesInvoiceLine.ISEMPTY;
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoLine.SETRANGE("Document No.", "No.");
            SalesCrMemoLine.SETFILTER("VAT Identifier", STRSUBSTNO('<>''%1''', ''));
            SalesCrMemoLine.SETRANGE("VAT Calculation Type", SalesCrMemoLine."VAT Calculation Type"::"Reverse Charge VAT");
            HasReverseChargeVatLines := NOT SalesCrMemoLine.ISEMPTY;
            SalesCrMemoLine.SETFILTER(
              "VAT Calculation Type", STRSUBSTNO('<>%1', SalesCrMemoLine."VAT Calculation Type"::"Reverse Charge VAT"));
            HasOtherVatLines := NOT SalesCrMemoLine.ISEMPTY;
          END;
      END;
      EXIT(HasReverseChargeVatLines AND NOT HasOtherVatLines);
    END;

    PROCEDURE GetContractAmount@1100525021(Extensions@1100528201 : Boolean) : Decimal;
    VAR
      ContractAmount@1100525001 : Decimal;
      Invoiced@1100525002 : Decimal;
      ToBeInvoiced@1100525003 : Decimal;
      ExtensionContractAmount@1100528200 : Decimal;
      AdvancePaymentsInvoiced@1100529600 : Decimal;
    BEGIN
      CalcSummary(ContractAmount, ExtensionContractAmount, Invoiced, ToBeInvoiced, AdvancePaymentsInvoiced, Extensions);
      EXIT(ContractAmount);
    END;

    PROCEDURE GetExtensionContractAmount@1100528200(Extensions@1100528201 : Boolean) : Decimal;
    VAR
      ContractAmount@1100525001 : Decimal;
      Invoiced@1100525002 : Decimal;
      ToBeInvoiced@1100525003 : Decimal;
      ExtensionContractAmount@1100528200 : Decimal;
      AdvancePaymentsInvoiced@1100529600 : Decimal;
    BEGIN
      CalcSummary(ContractAmount, ExtensionContractAmount, Invoiced, ToBeInvoiced, AdvancePaymentsInvoiced, Extensions);
      EXIT(ExtensionContractAmount);
    END;

    PROCEDURE GetInvoiced@1100525020(Extensions@1100528201 : Boolean) : Decimal;
    VAR
      ContractAmount@1100525001 : Decimal;
      Invoiced@1100525002 : Decimal;
      ToBeInvoiced@1100525003 : Decimal;
      ExtensionContractAmount@1100528200 : Decimal;
      AdvancePaymentsInvoiced@1100529600 : Decimal;
    BEGIN
      CalcSummary(ContractAmount, ExtensionContractAmount, Invoiced, ToBeInvoiced, AdvancePaymentsInvoiced, Extensions);
      EXIT(Invoiced);
    END;

    PROCEDURE GetNowInvoiced@1100527300(Extensions@1100527300 : Boolean) : Decimal;
    BEGIN
      EXIT(FilteredAmount(Extensions));
    END;

    PROCEDURE GetToBeInvoiced@1100525018(Extensions@1100528201 : Boolean) : Decimal;
    VAR
      ContractAmount@1100525001 : Decimal;
      Invoiced@1100525002 : Decimal;
      ToBeInvoiced@1100525003 : Decimal;
      ExtensionContractAmount@1100528200 : Decimal;
      AdvancePaymentsInvoiced@1100529600 : Decimal;
    BEGIN
      CalcSummary(ContractAmount, ExtensionContractAmount, Invoiced, ToBeInvoiced, AdvancePaymentsInvoiced, Extensions);
      EXIT(ToBeInvoiced);
    END;

    PROCEDURE GetAdvancePaymentsInvoiced@1100529602(Extensions@1100528201 : Boolean) : Decimal;
    VAR
      ContractAmount@1100525001 : Decimal;
      Invoiced@1100525002 : Decimal;
      ToBeInvoiced@1100525003 : Decimal;
      ExtensionContractAmount@1100528200 : Decimal;
      AdvancePaymentsInvoiced@1100529600 : Decimal;
    BEGIN
      CalcSummary(ContractAmount, ExtensionContractAmount, Invoiced, ToBeInvoiced, AdvancePaymentsInvoiced, Extensions);
      EXIT(AdvancePaymentsInvoiced);
    END;

    PROCEDURE GetLaborAmountSubcontracting@1100525006() LaborAmount : Decimal;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Posted Invoice",
        "Document Type"::"Posted Credit Memo":
          LaborAmount := "Labor Amount (Subcontracting)";
        "Document Type"::"Pro Forma Invoice",
        "Document Type"::"Pro Forma Credit Memo":
          LaborAmount := ROUND(GetLaborAmountSubcontractingProForma);
      END;
    END;

    LOCAL PROCEDURE GetLaborAmountSubcontractingProForma@1100525027() LaborAmountSubcontracting : Decimal;
    VAR
      SalesLine@1100525000 : Record 37;
      DimensionValue@1100525004 : Record 349;
      DimensionManagement@1100525003 : Codeunit 408;
      Amount@1100525001 : Decimal;
      AmountLabor@1100525002 : Decimal;
    BEGIN
      SalesLine.SETRANGE("Document Type", "Document Type");
      SalesLine.SETRANGE("Document No.", "No.");
      SalesLine.SETFILTER("VAT Calculation Type", '%1', SalesLine."VAT Calculation Type"::"Reverse Charge VAT");
      IF SalesLine.FINDSET THEN
        REPEAT
          IF "Installment Invoice/Cr. Memo" OR
             (NOT "Installment Invoice/Cr. Memo" AND
               ("Calculate B Amounts based on" =
                "Calculate B Amounts based on"::"Invoice Amount"))
          THEN
              Amount := Amount + SalesLine."Amount Including VAT"
            ELSE
              IF SalesLine."Cost Plus Line No." <> 0 THEN BEGIN
                IF SalesLine."Cost Type Cost Plus Line" = SalesLine."Cost Type Cost Plus Line"::Labor THEN
                  AmountLabor := AmountLabor + SalesLine."Amount Including VAT"
              END ELSE BEGIN
                IF SalesLine."Shortcut Dimension 2 Code" <> '' THEN BEGIN
                  DimensionManagement.GetDimValueRec(2, SalesLine."Shortcut Dimension 2 Code", DimensionValue, FALSE, '');
                  IF (DimensionValue."Cost Type" = DimensionValue."Cost Type"::Labor) THEN
                    AmountLabor := AmountLabor + SalesLine."Amount Including VAT"
                  ELSE
                    IF (DimensionValue."Cost Type" = DimensionValue."Cost Type"::Revenue) THEN
                      Amount := Amount + SalesLine."Amount Including VAT";
                END;
              END;
        UNTIL SalesLine.NEXT = 0;

      LaborAmountSubcontracting := AmountLabor + Amount * ("% Labor" / 100);
    END;

    PROCEDURE GetBlockedAmountSubcontracting@1100525025() BlockedAmountSubcontracting : Decimal;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Posted Invoice",
        "Document Type"::"Posted Credit Memo":
          BlockedAmountSubcontracting := "Blocked Amount (Subcontracting";
        "Document Type"::"Pro Forma Invoice",
        "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            BlockedAmountSubcontracting := ((GetLaborAmountSubcontractingProForma / 100) * "% to B Account");
            BlockedAmountSubcontracting := ROUND(BlockedAmountSubcontracting);
          END;
      END;
    END;

    PROCEDURE GetRestAmountSubcontracting@1100525016() RestAmount : Decimal;
    BEGIN
      IF "Withhold % Last Installment" = 0 THEN
        RestAmount := AmountIncludingVAT - GetBlockedAmountSubcontracting
      ELSE
        RestAmount :=
          AmountIncludingVAT - GetBlockedAmountSubcontracting -
          ((GetLastInstallmentAmount / 100) * "Withhold % Last Installment");
    END;

    PROCEDURE GetRestAmountSubcontractingInclCreditRestriction@1100528401() : Decimal;
    VAR
      CreditRestrictionAmount@1100528400 : Decimal;
    BEGIN
      IF ("Document Type" = "Document Type"::"Pro Forma Invoice") OR
         ("Document Type" = "Document Type"::"Posted Invoice")
      THEN
        CreditRestrictionAmount := AmountIncludingVAT * ("Credit Restriction %" / 100);

      EXIT(GetRestAmountSubcontracting + CreditRestrictionAmount);
    END;

    PROCEDURE GetWithholdAmount@1100525012() WithholdAmount : Decimal;
    BEGIN
      WithholdAmount := (GetLastInstallmentAmount / 100) * "Withhold % Last Installment";
    END;

    PROCEDURE GetLastInstallmentAmount@1100525011() LastInstallmentAmount : Decimal;
    VAR
      SalesLine@1100525001 : Record 37;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            SalesLine.SETRANGE("Last Installment", TRUE);
            IF SalesLine.FINDSET THEN
              REPEAT
                LastInstallmentAmount := LastInstallmentAmount + SalesLine."Amount Including VAT";
              UNTIL SalesLine.NEXT = 0;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            CALCFIELDS("Last Installment Amount");
            LastInstallmentAmount := "Last Installment Amount";
          END;
        "Document Type"::"Pro Forma Credit Memo", "Document Type"::"Posted Credit Memo":
          LastInstallmentAmount := 0;
      END;
    END;

    PROCEDURE GetCurrencyCode@1100525019() CurrencyCode : Code[10];
    VAR
      GeneralLedgerSetup@1100525002 : Record 98;
    BEGIN
      IF "Currency Code" <> '' THEN
        CurrencyCode := "Currency Code"
      ELSE
        IF GeneralLedgerSetup.GET THEN
          CurrencyCode := GeneralLedgerSetup."LCY Code";
    END;

    PROCEDURE GetPublicNotaryBankAccountNo@1100525013() BankAccountNo : Text[30];
    VAR
      Customer@1100525002 : Record 18;
      CustomerBankAccount@1100525003 : Record 287;
    BEGIN
      IF Customer.GET("Public notary") THEN
        IF CustomerBankAccount.GET(Customer."No.", Customer."Preferred Bank Account Code") THEN
          BankAccountNo := CustomerBankAccount."Bank Account No.";
    END;

    PROCEDURE GetTranslatedPaymentTermsDescription@1100525022() : Text[100];
    VAR
      PaymentTerms@1100525000 : Record 3;
    BEGIN
      IF "Payment Terms Code" = '' THEN
        PaymentTerms.INIT
      ELSE BEGIN
        PaymentTerms.GET("Payment Terms Code");
        PaymentTerms.TranslateDescription(PaymentTerms, "Language Code");
      END;
      EXIT(PaymentTerms.Description);
    END;

    PROCEDURE GetTranslatedShipmentMethodDescription@1100525029() : Text[100];
    VAR
      ShipmentMethod@1100525000 : Record 10;
    BEGIN
      IF "Shipment Method Code" = '' THEN
        ShipmentMethod.INIT
      ELSE BEGIN
        ShipmentMethod.GET("Shipment Method Code");
        ShipmentMethod.TranslateDescription(ShipmentMethod,"Language Code");
      END;
      EXIT(ShipmentMethod.Description);
    END;

    PROCEDURE InsertSalesHeaderWithLines@1100525005(SalesHeader@1100525000 : Record 36;VAR GenericSalesLine@1100525001 : Record 11071889);
    BEGIN
      InsertSalesHeader(SalesHeader);
      InsertLines(GenericSalesLine);
    END;

    PROCEDURE InsertSalesHeader@1100525008(SalesHeader@1100525000 : Record 36);
    VAR
      SalesHeaderExtension@1100525001 : Record 11071868;
    BEGIN
      INIT;
      TRANSFERFIELDS(SalesHeader);
      SalesHeaderExtension.GetSalesHeadExtension(SalesHeader."Document Type", SalesHeader."No.");
      "E-Mail (Invoices)" := SalesHeaderExtension."E-Mail (Invoices)";
      "Electronic Invoicing" := SalesHeaderExtension."Electronic Invoicing";
      INSERT;
    END;

    PROCEDURE InsertSalesInvoiceHeaderWithLines@1100525009(SalesInvoiceHeader@1100525000 : Record 112;VAR GenericSalesLine@1100525001 : Record 11071889);
    BEGIN
      InsertSalesInvoiceHeader(SalesInvoiceHeader);
      InsertLines(GenericSalesLine);
    END;

    PROCEDURE InsertSalesInvoiceHeader@1100525000(SalesInvoiceHeader@1100525000 : Record 112);
    BEGIN
      INIT;
      TRANSFERFIELDS(SalesInvoiceHeader);
      "Document Type" := "Document Type"::"Posted Invoice";
      INSERT;
    END;

    PROCEDURE InsertSalesCrMemoHeaderWithLines@1100525004(SalesCrMemoHeader@1100525000 : Record 114;VAR GenericSalesLine@1100525001 : Record 11071889);
    BEGIN
      InsertSalesCrMemoHeader(SalesCrMemoHeader);
      InsertLines(GenericSalesLine);
    END;

    PROCEDURE InsertSalesCrMemoHeader@1100525010(SalesCrMemoHeader@1100525000 : Record 114);
    BEGIN
      INIT;
      TRANSFERFIELDS(SalesCrMemoHeader);
      "Document Type" := "Document Type"::"Posted Credit Memo";
      INSERT;
    END;

    LOCAL PROCEDURE InsertLines@1100525032(VAR GenericSalesLine@1100525001 : Record 11071889);
    VAR
      SalesLine@1100525000 : Record 37;
      SalesInvoiceLine@1100525002 : Record 113;
      SalesCrMemoLine@1100525004 : Record 115;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice", "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            IF SalesLine.FINDSET THEN
              REPEAT
              //>>RFC001
                IF ("Invoice Layout Code"='0') THEN
                  GenericSalesLine.InsertSalesLineGroup(SalesLine)
                ELSE
              //<<RFC001
                  GenericSalesLine.InsertSalesLine(SalesLine);
              UNTIL SalesLine.NEXT = 0;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceLine.SETRANGE("Document No.", "No.");
            IF SalesInvoiceLine.FINDSET THEN
              REPEAT
              //>>RFC001
                IF ("Invoice Layout Code"='0') THEN
                  GenericSalesLine.InsertSalesInvoiceLineGroup(SalesInvoiceLine)
                ELSE
              //<<RFC001
                  GenericSalesLine.InsertSalesInvoiceLine(SalesInvoiceLine);
              UNTIL SalesInvoiceLine.NEXT = 0;
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoLine.SETRANGE("Document No.", "No.");
            IF SalesCrMemoLine.FINDSET THEN
              REPEAT
              //>>RFC001
                IF ("Invoice Layout Code"='0') THEN
                  GenericSalesLine.InsertSalesCrMemoLineGroup(SalesCrMemoLine)
                ELSE
              //<<RFC001
                  GenericSalesLine.InsertSalesCrMemoLine(SalesCrMemoLine);
              UNTIL SalesCrMemoLine.NEXT = 0;
          END;
      END;
    END;

    LOCAL PROCEDURE CalcSummary@1100485002(VAR ContractAmount@1100525000 : Decimal;VAR ExtensionContractAmount@1100528200 : Decimal;VAR Invoiced@1100525001 : Decimal;VAR ToBeInvoiced@1100525006 : Decimal;VAR AdvancePaymentsInvoiced@1100529600 : Decimal;Extensions@1100528201 : Boolean);
    VAR
      TempGenericSalesLine@1100525007 : TEMPORARY Record 11071889;
      ProjectInstallment@1100525004 : Record 11012018;
      TempPlot@1100525005 : TEMPORARY Record 11012500;
      PresentEntryNo@1100525002 : Integer;
    BEGIN
      InsertLines(TempGenericSalesLine);
      IF "Installment Invoice/Cr. Memo" AND NOT "Service Invoice" THEN BEGIN
        Invoiced := 0;
        ContractAmount := 0;
        ExtensionContractAmount := 0;
        AdvancePaymentsInvoiced := 0;
        PresentEntryNo := 0;
        PresentEntryNo :=
          DetermineCustomerLedgerNo(
            "No.", "Bill-to Customer No.","Posting Date");

        TempGenericSalesLine.RESET;
        TempGenericSalesLine.SETRANGE("Document Type", "Document Type");
        TempGenericSalesLine.SETRANGE("Document No.", "No.");
        TempGenericSalesLine.SETFILTER(Type, '<>%1', TempGenericSalesLine.Type::" ");
        TempGenericSalesLine.SETRANGE(Option, '');
        //>> 170831 ITERO.SB Do not calc summary when extension line (pure 275453)
        TempGenericSalesLine.SETRANGE("Extension Contract", '');
        //<<
        IF TempGenericSalesLine.FINDSET THEN BEGIN
          IF ProjectInstallment.GET(
            "Job No.",
            "Sell-to Customer No.",
            TempGenericSalesLine."Plot No.",
            TempGenericSalesLine."Installment No.")
          THEN BEGIN
            CASE TRUE OF
              ((ProjectInstallment."Plot No." <> '') AND (ProjectInstallment.Option = '') AND (ProjectInstallment."Extension Contract" = '')):
                BEGIN
                  TempGenericSalesLine.SETFILTER("Plot No.", '<>%1', '');
                  REPEAT
                    IF NOT TempPlot.GET("Job No.", TempGenericSalesLine."Plot No.") THEN BEGIN
                      IF ProjectInstallment.GET(
                        "Job No.",
                        "Sell-to Customer No.",
                        TempGenericSalesLine."Plot No.",
                        TempGenericSalesLine."Installment No.")
                      THEN BEGIN
                        IF (ProjectInstallment.Option = '') AND (ProjectInstallment."Extension Contract" = '') THEN BEGIN
                          DeterminePlotSummary(
                            "Job No.", ProjectInstallment."Plot No.", PresentEntryNo, ContractAmount, Invoiced, AdvancePaymentsInvoiced);
                          TempPlot."Project No." := "Job No.";
                          TempPlot."Plot No." := TempGenericSalesLine."Plot No.";
                          TempPlot.INSERT;
                        END;
                      END;
                    END;
                  UNTIL TempGenericSalesLine.NEXT = 0;
                END;
              ((ProjectInstallment."Plot No." = '') AND (ProjectInstallment.Option = '')):
                BEGIN
                  DetermineBasicSummary("Job No.", PresentEntryNo, ContractAmount, Invoiced, AdvancePaymentsInvoiced);
                  IF Extensions THEN
                    DetermineExtensionSummary("Job No.", PresentEntryNo, ExtensionContractAmount, Invoiced, AdvancePaymentsInvoiced);
                END;
              END;
          END;
        END;

        ToBeInvoiced := ContractAmount + ExtensionContractAmount - (Invoiced + FilteredAmount(Extensions));
      END;
    END;

    LOCAL PROCEDURE DetermineBasicSummary@1100525017(JobNo@1100525005 : Code[20];PresentEntryNo@1100525003 : Integer;VAR ContractAmount@1100525002 : Decimal;VAR Invoiced@1100525001 : Decimal;VAR AdvancePaymentsInvoiced@1100529601 : Decimal);
    VAR
      ProjectPrincipal@1210190000 : Record 11012005;
      ProjectInstallment@1100525000 : Record 11012018;
      InvoicedLoc@1100529600 : Decimal;
    BEGIN
      ProjectPrincipal.GET(JobNo, "Sell-to Customer No.");
      ContractAmount := ProjectPrincipal."Contract Amount" + ProjectPrincipal."Plot Price";

      ProjectInstallment.SETRANGE("Project No.", JobNo);
      ProjectInstallment.SETRANGE(Principal, "Sell-to Customer No.");
      ProjectInstallment.SETFILTER("Extension Contract", '%1', '');
      ProjectInstallment.SETFILTER(Option, '%1', '');
      ProjectInstallment.SETFILTER("Plot No.", '%1', '');
      IF ProjectInstallment.FINDSET THEN
        REPEAT
          InvoicedLoc := 0;
          DetermineInvoiced(ProjectInstallment, PresentEntryNo, InvoicedLoc);
          Invoiced += InvoicedLoc;
          IF ProjectInstallment."Advance Payment" THEN
            AdvancePaymentsInvoiced += InvoicedLoc;
        UNTIL ProjectInstallment.NEXT = 0;
    END;

    LOCAL PROCEDURE DetermineExtensionSummary@1100525015(JobNo@1100525001 : Code[20];PresentEntryNo@1100525004 : Integer;VAR ExtensionContractAmount@1100525003 : Decimal;VAR Invoiced@1100525002 : Decimal;VAR AdvancePaymentsInvoiced@1100529601 : Decimal);
    VAR
      ProjectInstallment@1100525000 : Record 11012018;
      InvoicedLoc@1100529600 : Decimal;
    BEGIN
      ProjectInstallment.SETRANGE("Project No.", JobNo);
      ProjectInstallment.SETRANGE(Principal, "Sell-to Customer No.");
      ProjectInstallment.SETFILTER("Extension Contract", '<>%1', '');
      ProjectInstallment.SETFILTER(Option, '%1', '');
      ProjectInstallment.SETFILTER("Plot No.", '%1', '');
      IF ProjectInstallment.FINDSET THEN
        REPEAT
          InvoicedLoc := 0;
          ExtensionContractAmount := ExtensionContractAmount + ProjectInstallment."Installment Amount";
          DetermineInvoiced(ProjectInstallment, PresentEntryNo, InvoicedLoc);
          Invoiced += InvoicedLoc;
          IF ProjectInstallment."Advance Payment" THEN
            AdvancePaymentsInvoiced += InvoicedLoc;
        UNTIL ProjectInstallment.NEXT = 0;
    END;

    LOCAL PROCEDURE DeterminePlotSummary@1100485004(JobNo@1100525001 : Code[20];PlotNo@1100485000 : Code[10];PresentEntryNo@1100525003 : Integer;VAR ContractAmount@1100525002 : Decimal;VAR Invoiced@1100525004 : Decimal;VAR AdvancePaymentsInvoiced@1100529601 : Decimal);
    VAR
      ProjectInstallment@1100525000 : Record 11012018;
      InvoicedLoc@1100529600 : Decimal;
    BEGIN
      ProjectInstallment.SETRANGE("Project No.", JobNo);
      ProjectInstallment.SETRANGE(Principal, "Sell-to Customer No.");
      ProjectInstallment.SETFILTER("Extension Contract", '%1', '');
      ProjectInstallment.SETRANGE("Plot No.", PlotNo);
      ProjectInstallment.SETFILTER(Option, '%1', '');
      IF ProjectInstallment.FINDSET THEN
        REPEAT
          InvoicedLoc := 0;
          ContractAmount := ContractAmount + ProjectInstallment."Installment Amount";
          DetermineInvoiced(ProjectInstallment, PresentEntryNo, InvoicedLoc);
          Invoiced += InvoicedLoc;
          IF ProjectInstallment."Advance Payment" THEN
            AdvancePaymentsInvoiced += InvoicedLoc;
        UNTIL ProjectInstallment.NEXT = 0;
    END;

    LOCAL PROCEDURE DetermineInvoiced@1210190008(ProjectInstallment@1100525000 : Record 11012018;PresentEntryNo@1100525001 : Integer;VAR Invoiced@1100525002 : Decimal);
    VAR
      JobLedgerEntry@1100409000 : Record 11072005;
      InvoiceEntryNo@1100525004 : Integer;
    BEGIN
      JobLedgerEntry.SETCURRENTKEY("Job No.");
      JobLedgerEntry.SETRANGE("Job No.", ProjectInstallment."Project No.");
      JobLedgerEntry.SETRANGE(Principal, "Sell-to Customer No.");
      JobLedgerEntry.SETRANGE("Project Invoice", TRUE);
      JobLedgerEntry.SETRANGE("Installment Invoice", TRUE);
      JobLedgerEntry.SETRANGE("Installment No.", ProjectInstallment."Installment No.");
      JobLedgerEntry.SETRANGE("Extension Contract", ProjectInstallment."Extension Contract");
      JobLedgerEntry.SETRANGE("Plot No.", ProjectInstallment."Plot No.");
      IF JobLedgerEntry.FINDSET THEN
        REPEAT
          InvoiceEntryNo := DetermineCustomerLedgerNo(
            JobLedgerEntry."Document No.", "Bill-to Customer No.",JobLedgerEntry."Posting Date");
          IF (InvoiceEntryNo < PresentEntryNo) OR
             (PresentEntryNo = 0)
          THEN
            Invoiced := Invoiced - JobLedgerEntry."Total Price";
        UNTIL JobLedgerEntry.NEXT = 0;
    END;

    LOCAL PROCEDURE DetermineCustomerLedgerNo@1210190004(DocumentNo@1210190001 : Code[20];BilltoCustomerNo@1100525000 : Code[20];PostingDate@1100409000 : Date) @1210190003 : Integer;
    VAR
      CustLedgerEntry@1210190000 : Record 21;
    BEGIN
      CustLedgerEntry.SETCURRENTKEY("Document No.");
      CustLedgerEntry.SETRANGE("Document No.", DocumentNo);
      CustLedgerEntry.SETRANGE("Customer No.", BilltoCustomerNo);
      CustLedgerEntry.SETRANGE("Posting Date", PostingDate);
      IF CustLedgerEntry.FINDFIRST THEN
        EXIT(CustLedgerEntry."Entry No.");
    END;

    PROCEDURE HasTextLines@1100525023() : Boolean;
    VAR
      SalesReportTextLine@1100525000 : Record 11071912;
    BEGIN
      SalesReportTextLine.SETRANGE("Document Type", "Document Type");
      SalesReportTextLine.SETRANGE("Document No.", "No.");
      EXIT(NOT SalesReportTextLine.ISEMPTY);
    END;

    PROCEDURE GetVATClauseDescriptions@1100409000(GetAllDescriptions@1100528400 : Boolean;Index@1100528401 : Integer) VATClauseDescriptions : Text;
    VAR
      TempGenericSalesLine@1100409000 : TEMPORARY Record 11071889;
      TempVATPostingSetup@1100409002 : TEMPORARY Record 325;
      TempVATClause@1100409001 : TEMPORARY Record 560;
      VATPostingSetup@1100409003 : Record 325;
      Counter@1100528402 : Integer;
    BEGIN
      InsertLines(TempGenericSalesLine);
      IF TempGenericSalesLine.FINDSET THEN
        REPEAT
          IF (TempGenericSalesLine."VAT Bus. Posting Group" <> '') OR
             (TempGenericSalesLine."VAT Prod. Posting Group" <> '')
          THEN
            IF TempGenericSalesLine."Amount Including VAT" <> 0 THEN BEGIN
              TempVATPostingSetup."VAT Bus. Posting Group" := TempGenericSalesLine."VAT Bus. Posting Group";
              TempVATPostingSetup."VAT Prod. Posting Group" := TempGenericSalesLine."VAT Prod. Posting Group";
              IF TempVATPostingSetup.INSERT THEN;
            END;
        UNTIL TempGenericSalesLine.NEXT = 0;

      IF TempVATPostingSetup.FINDSET THEN
        REPEAT
          IF VATPostingSetup.GET(
            TempVATPostingSetup."VAT Bus. Posting Group",
            TempVATPostingSetup."VAT Prod. Posting Group")
          THEN BEGIN
            TempVATClause.Code := VATPostingSetup."VAT Clause Code";
            IF TempVATClause.INSERT THEN;
          END;
        UNTIL TempVATPostingSetup.NEXT = 0;

      IF TempVATClause.FINDSET THEN
        REPEAT
          Counter := Counter + 1;
          IF GetAllDescriptions OR
             (Counter = Index)
          THEN
            AddVATClauseDescription(VATClauseDescriptions, TempVATClause.Code);
        UNTIL TempVATClause.NEXT = 0;
    END;

    LOCAL PROCEDURE AddVATClauseDescription@1100409005(VAR VATClauseDescriptions@1100409000 : Text;VATClauseCode@1100409001 : Code[10]);
    VAR
      VATClause@1100409004 : Record 560;
    BEGIN
      IF VATClauseCode = '' THEN
        EXIT;
      IF NOT VATClause.GET(VATClauseCode) THEN
        EXIT;
      IF VATClause.Description = '' THEN
        EXIT;

      VATClause.TranslateDescription("Language Code");

      IF VATClauseDescriptions = '' THEN
        VATClauseDescriptions := VATClause.Description
      ELSE
        VATClauseDescriptions := VATClauseDescriptions + Br + VATClause.Description;
    END;

    LOCAL PROCEDURE Br@1100528424() Br : Text;
    BEGIN
      Br := '<BR>';
    END;

    PROCEDURE DetermineDocumentType@1100528400(VAR SalesHeader@1100528400 : Record 36;VAR SalesInvoiceHeader@1100528401 : Record 112;VAR SalesCrMemoHeader@1100528402 : Record 114) DocumentType : Integer;
    VAR
      SalesHeaderInv@1100525000 : Record 36;
      SalesHeaderCr@1100525001 : Record 36;
    BEGIN
      SalesHeader.FILTERGROUP(20);
      SalesInvoiceHeader.FILTERGROUP(20);
      SalesCrMemoHeader.FILTERGROUP(20);
      CASE TRUE OF
        SalesHeader.HASFILTER:
          BEGIN
            SalesHeaderInv.SETRANGE("Document Type", SalesHeaderInv."Document Type"::Invoice);
            SalesHeaderCr.SETRANGE("Document Type", SalesHeaderCr."Document Type"::"Credit Memo");
            IF SalesHeader.GETFILTER("Document Type") = SalesHeaderInv.GETFILTER("Document Type") THEN
              DocumentType := "Document Type"::"Pro Forma Invoice";
            IF SalesHeader.GETFILTER("Document Type") = SalesHeaderCr.GETFILTER("Document Type") THEN
              DocumentType := "Document Type"::"Pro Forma Credit Memo";
            SalesHeader.SETRANGE("Document Type"); //Remove filter in filtergroup 20, because it is only used for determining document type.
          END;
        SalesInvoiceHeader.HASFILTER:
          BEGIN
            DocumentType := "Document Type"::"Posted Invoice";
            SalesInvoiceHeader.SETRANGE("No.");  //Remove filter in filtergroup 20, because it is only used for determining document type.
          END;
        SalesCrMemoHeader.HASFILTER:
          BEGIN
            DocumentType := "Document Type"::"Posted Credit Memo";
            SalesCrMemoHeader.SETRANGE("No."); //Remove filter in filtergroup 20, because it is only used for determining document type.
          END;
      END;
      SalesHeader.FILTERGROUP(0);
      SalesInvoiceHeader.FILTERGROUP(0);
      SalesCrMemoHeader.FILTERGROUP(0);
    END;

    PROCEDURE AdvancePaymentInstallmentExists@1100529600() : Boolean;
    VAR
      TempGenericSalesLine@1100525007 : TEMPORARY Record 11071889;
      ProjectInstallment@1100525004 : Record 11012018;
    BEGIN
      InsertLines(TempGenericSalesLine);
      IF "Installment Invoice/Cr. Memo" AND NOT "Service Invoice" THEN BEGIN
        TempGenericSalesLine.RESET;
        TempGenericSalesLine.SETRANGE("Document Type", "Document Type");
        TempGenericSalesLine.SETRANGE("Document No.", "No.");
        TempGenericSalesLine.SETFILTER(Type, '<>%1', TempGenericSalesLine.Type::" ");
        TempGenericSalesLine.SETRANGE(Option, '');
        IF NOT TempGenericSalesLine.ISEMPTY THEN BEGIN
          ProjectInstallment.SETRANGE("Project No.", "Job No.");
          ProjectInstallment.SETRANGE(Principal, "Sell-to Customer No.");
          ProjectInstallment.SETRANGE("Advance Payment", TRUE);
          EXIT(NOT ProjectInstallment.ISEMPTY);
        END;
      END;
      EXIT(FALSE);
    END;

    PROCEDURE "***ITERO****"@1100285503();
    BEGIN
    END;

    PROCEDURE GetInstallmentAmount@1100285500() WithholdAmount : Decimal;
    VAR
      SalesLine@1100525001 : Record 37;
      ProjectInstallment@1100285500 : Record 11012018;
      SalesInvLine@1100285501 : Record 113;
      SalesCrMemoLine@1100285502 : Record 115;
    BEGIN
      //>>160315 ITERO.SB New calc. of withheld amount (RAD-39)
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            SalesLine.CALCSUMS("Withheld Amount");
            WithholdAmount:=SalesLine."Withheld Amount";
      //      {
      //      IF SalesLine.FINDSET THEN
      //        REPEAT
      //          ProjectInstallment.SETRANGE("Project No.",SalesLine."Job No.");
      //          ProjectInstallment.SETRANGE(Principal,SalesLine."Sell-to Customer No.");
      //          ProjectInstallment.SETRANGE("Plot No.",SalesLine."Plot No.");
      //          ProjectInstallment.SETRANGE("Installment No.",SalesLine."Installment No.");
      //          IF ProjectInstallment.FINDSET THEN
      //            WithholdAmount:= WithholdAmount + ProjectInstallment."Withheld Amount";
      //        UNTIL SalesLine.NEXT = 0;
      //      }
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvLine.SETRANGE("Document No.", "No.");
            SalesInvLine.CALCSUMS("Withheld Amount");
            WithholdAmount:=SalesInvLine."Withheld Amount";

      //      {
      //      IF SalesInvLine.FINDSET THEN
      //        REPEAT
      //          ProjectInstallment.SETRANGE("Project No.",SalesInvLine."Job No.");
      //          ProjectInstallment.SETRANGE(Principal,SalesInvLine."Sell-to Customer No.");
      //          ProjectInstallment.SETRANGE("Plot No.",SalesInvLine."Plot No.");
      //          ProjectInstallment.SETRANGE("Installment No.",SalesInvLine."Installment No.");
      //          IF ProjectInstallment.FINDSET THEN
      //            WithholdAmount:= WithholdAmount + ProjectInstallment."Withheld Amount";
      //        UNTIL SalesInvLine.NEXT = 0;
      //      }
          END;
      //>> 140317 ITERO.SB Extended GetinstallmentAmount function with "Pro Forma Credit Memo" and "Posted Credit Memo"
          "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesLine.SETRANGE("Document Type", "Document Type");
            SalesLine.SETRANGE("Document No.", "No.");
            SalesLine.CALCSUMS("Withheld Amount");
            //>>160427 ITERO.SB RAD039fix
            WithholdAmount:=SalesLine."Withheld Amount"*-1;
            //<<

      //      {
      //      IF SalesLine.FINDSET THEN
      //        REPEAT
      //          ProjectInstallment.SETRANGE("Project No.",SalesLine."Job No.");
      //          ProjectInstallment.SETRANGE(Principal,SalesLine."Sell-to Customer No.");
      //          ProjectInstallment.SETRANGE("Plot No.",SalesLine."Plot No.");
      //          ProjectInstallment.SETRANGE("Installment No.",SalesLine."Installment No.");
      //          IF ProjectInstallment.FINDSET THEN
      //            WithholdAmount:= WithholdAmount + ProjectInstallment."Withheld Amount";
      //        UNTIL SalesLine.NEXT = 0;
      //       }
          END;

        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoLine.SETRANGE("Document No.", "No.");
            SalesCrMemoLine.CALCSUMS("Withheld Amount");
            //>>160427 ITERO.SB RAD039fix
            WithholdAmount:=SalesCrMemoLine."Withheld Amount"*-1;
            //<<
      //      {
      //      IF SalesCrMemoLine.FINDSET THEN
      //        REPEAT
      //          ProjectInstallment.SETRANGE("Project No.",SalesCrMemoLine."Job No.");
      //          ProjectInstallment.SETRANGE(Principal,SalesCrMemoLine."Sell-to Customer No.");
      //          ProjectInstallment.SETRANGE("Plot No.",SalesCrMemoLine."Plot No.");
      //          ProjectInstallment.SETRANGE("Installment No.",SalesCrMemoLine."Installment No.");
      //          IF ProjectInstallment.FINDSET THEN
      //            WithholdAmount:= WithholdAmount + ProjectInstallment."Withheld Amount";
      //        UNTIL SalesCrMemoLine.NEXT = 0;
      //      }
          END;

      END;
      //<<
      //<<
    END;

    PROCEDURE GetInstallmentAmountTot@1100285501() WithholdAmount : Decimal;
    VAR
      SalesLine@1100525001 : Record 37;
      ProjectInstallment@1100285500 : Record 11012018;
      SalesInvLine@1100285501 : Record 113;
      SalesCrMemoLine@1100285000 : Record 115;
    BEGIN
      //>>160315 ITERO.SB New calc. of withheld amount (RAD-39)

      //{
      //CASE "Document Type" OF
      //  "Document Type"::"Pro Forma Invoice","Document Type"::"Posted Invoice":
      //    BEGIN
      //      ProjectInstallment.SETRANGE("Project No.", "Job No.");
      //      ProjectInstallment.SETRANGE(Principal, "Sell-to Customer No.");
      //      ProjectInstallment.SETFILTER("Extension Contract", '%1', '');
      //      ProjectInstallment.SETFILTER(Option, '%1', '');
      //      ProjectInstallment.SETFILTER("Plot No.", '%1', '');
      //      ProjectInstallment.SETRANGE("Last Installment",FALSE);
      //      IF ProjectInstallment.FINDSET THEN REPEAT
      //        ProjectInstallment.CALCFIELDS("Invoiced Price");//,ProjectInstallment."Invoice in Process");
      //          IF (ProjectInstallment."Invoiced Price"<>0) THEN
      //          WithholdAmount:= WithholdAmount+ProjectInstallment."Withheld Amount";
      //      UNTIL ProjectInstallment.NEXT = 0;
      //    END;
      //END;
      //}
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice","Document Type"::"Posted Invoice":
          BEGIN
            SalesInvLine.SETRANGE("Job No.","Job No.");
            SalesInvLine.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
            //>> 170911 ITERO.SB Pure 276758 handle withheld amount for extensions
            SalesInvLine.SETFILTER("Extension Contract",'%1','');
            //<<
            SalesInvLine.CALCSUMS("Withheld Amount");
            WithholdAmount:=SalesInvLine."Withheld Amount";

            // Include Withheld Amount from Cr.Memo
            //>>160427 ITERO.SB RAD039fix
            SalesCrMemoLine.SETRANGE("Job No.","Job No.");
            SalesCrMemoLine.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
            //>> 170911 ITERO.SB Pure 276758 handle withheld amount for extensions
            SalesCrMemoLine.SETFILTER("Extension Contract",'%1','');
            //<<
            SalesCrMemoLine.CALCSUMS("Withheld Amount");
            WithholdAmount += SalesCrMemoLine."Withheld Amount";
          END;
      END;
      //<<
    END;

    PROCEDURE GetAmount@1100285502() Amount : Decimal;
    VAR
      SalesHeader@1100285502 : Record 36;
      SalesInvoiceHeader@1100285503 : Record 112;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN
              Amount:=SalesHeader.Amount;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceHeader.SETRANGE("No.", "No.");
            IF SalesInvoiceHeader.FINDFIRST THEN
              Amount:=SalesInvoiceHeader.Amount;
          END;
        "Document Type"::"Pro Forma Credit Memo", "Document Type"::"Posted Credit Memo":
          Amount := 0;
      END;
    END;

    PROCEDURE GetROT@1100285504(Type@1100285512 : Integer) : Decimal;
    VAR
      SalesHeader@1100285502 : Record 36;
      SalesInvoiceHeader@1100285503 : Record 112;
      ROTInformation@1100285504 : Record 11128101;
      TotalROT@1100285501 : Decimal;
      RotCount@1100285500 : Integer;
      AmountLabor@1100285505 : Decimal;
      SalesLine@1100285506 : Record 37;
      lvDimensionValue@1100285509 : Record 349;
      lvGeneralLedgerSetup@1100285508 : Record 98;
      lvCostPlusEntry@1100285507 : Record 11012019;
      AmountROT@1100285510 : Decimal;
      AmountROTtot@1100285511 : Decimal;
      SalesInvoiceLine@1100285513 : Record 113;
      SalesHeader2@1100285514 : Record 36;
      SalesCrMemoHeader@1100285515 : Record 114;
      ProjectPrincipal@1100285516 : Record 11012005;
    BEGIN

      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN BEGIN
              //RotCount := 0;
              IF (SalesHeader."ROT/RUT reduction") THEN BEGIN
                ROTInformation.RESET();
                ROTInformation.SETRANGE(Type, ROTInformation.Type::Invoice);
                //ROTInformation.SETRANGE("Document No.", SalesHeader."No.");
                ROTInformation.SETRANGE("Invoice No.",SalesHeader."No.");
                ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                  //RotCount += 1;
                  TotalROT:=TotalROT+ROTInformation.Amount;
                UNTIL ROTInformation.NEXT = 0;

                IF Type = 1 THEN
                  EXIT(TotalROT);
                IF Type = 2 THEN
                  EXIT(AmountROT);
                IF Type = 3 THEN
                  EXIT(AmountROTtot);

              END;

            END;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceHeader.SETRANGE("No.", "No.");
            IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
              //RotCount := 0;
              IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                ROTInformation.RESET();
                ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                //ROTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                ROTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                  //RotCount += 1;
                  TotalROT:=TotalROT+ROTInformation.Amount;
                UNTIL ROTInformation.NEXT = 0;

                IF Type = 1 THEN
                  EXIT(TotalROT);
                IF Type = 2 THEN
                  EXIT(AmountROT);
                IF Type = 3 THEN
                  EXIT(AmountROTtot);

              END;

            END;

          END;
        //END;
        //"Document Type"::"Pro Forma Credit Memo", "Document Type"::"Posted Credit Memo":
          //Amount := 0;

      //>>140317 ITERO.SB Extended "GetROT" function with "Pro Forma Credit Memo" and "Posted Credit Memo"
        "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesHeader2.SETRANGE("Document Type", "Document Type");
            SalesHeader2.SETRANGE("No.", "No.");
            IF SalesHeader2.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesHeader2."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                //RotCount := 0;
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  ROTInformation.RESET();
                  ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                  //ROTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                  IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                    //RotCount += 1;
                    TotalROT:=TotalROT+ROTInformation.Amount;
                  UNTIL ROTInformation.NEXT = 0;
                  IF Type = 1 THEN
                    EXIT(TotalROT);
                  IF Type = 2 THEN
                    EXIT(AmountROT);
                  IF Type = 3 THEN
                    EXIT(AmountROTtot);

                END;
              END;
            END;
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            //SalesHeader2.SETRANGE("Document Type", "Document Type");
            SalesCrMemoHeader.SETRANGE("No.", "No.");
            IF SalesCrMemoHeader.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesCrMemoHeader."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                //RotCount := 0;
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  ROTInformation.RESET();
                  ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                  //ROTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Invoice No.", SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                  IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                    //RotCount += 1;
                    TotalROT:=TotalROT+ROTInformation.Amount;
                  UNTIL ROTInformation.NEXT = 0;

                  IF Type = 1 THEN
                    EXIT(TotalROT);
                  IF Type = 2 THEN
                    EXIT(AmountROT);
                  IF Type = 3 THEN
                    EXIT(AmountROTtot);

                END;
              END;
            END;
          END;

        END;
      //<<
    END;

    PROCEDURE GetOCR@1100285506() : Code[30];
    VAR
      SEUtils@1100285100 : Codeunit 11128000;
    BEGIN
      EXIT(SEUtils.makeOCR10ref("No.",TRUE));
    END;

    PROCEDURE GetROTtxt@1100285507() ROTtxt : Text;
    VAR
      SalesHeader@1100285502 : Record 36;
      SalesInvoiceHeader@1100285503 : Record 112;
      ROTInformation@1100285504 : Record 11128101;
      SalesLine@1100285506 : Record 37;
      SalesInvoiceLine@1100285513 : Record 113;
      SalesCrMemoHeader@1100285500 : Record 114;
    BEGIN

      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN BEGIN
              IF (SalesHeader."ROT/RUT reduction") THEN BEGIN
                ROTInformation.RESET();
                ROTInformation.SETRANGE(Type, ROTInformation.Type::Invoice);
                //ROTInformation.SETRANGE("Document No.", SalesHeader."No.");
                ROTInformation.SETRANGE("Invoice No.",SalesHeader."No.");
                ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                  IF ROTtxt='' THEN
                    ROTtxt:=ROTtxt+ROTInformation.Name+':'+ROTInformation."Personal No."+' Del:'+FORMAT(ROTInformation."Quote of ROT Amount")+'%'
                  ELSE
                    ROTtxt:=ROTtxt+','+ROTInformation.Name+':'+ROTInformation."Personal No."+' Del:'+FORMAT(ROTInformation."Quote of ROT Amount")+'%';
                UNTIL ROTInformation.NEXT = 0;
                //<<
                IF ROTInformation."Building/Apartment"=0 THEN
                  ROTtxt:='Fastbet.:'+ROTInformation."Building No."+','+ROTtxt
                ELSE
                  ROTtxt:='Lgh:'+ROTInformation."Building No."+',Orgnr:'+ROTInformation."Apartment Organisation No."+','+ROTtxt;
              END;
            END;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceHeader.SETRANGE("No.", "No.");
            IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
              IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                ROTInformation.RESET();
                ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                //ROTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                ROTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                  IF ROTtxt='' THEN
                    ROTtxt:=ROTtxt+ROTInformation.Name+':'+ROTInformation."Personal No."+' Del:'+FORMAT(ROTInformation."Quote of ROT Amount")+'%'
                  ELSE
                    ROTtxt:=ROTtxt+','+ROTInformation.Name+':'+ROTInformation."Personal No."+' Del:'+FORMAT(ROTInformation."Quote of ROT Amount")+'%';
                UNTIL ROTInformation.NEXT = 0;
                //>> 140403 ITERO.SB Handle "ROT-fixed price"
                IF ROTInformation."Building/Apartment"=0 THEN
                  ROTtxt:='Fastbet.:'+ROTInformation."Building No."+','+ROTtxt
                ELSE
                  ROTtxt:='Lgh:'+ROTInformation."Building No."+',Orgnr:'+ROTInformation."Apartment Organisation No."+','+ROTtxt;

              END;
            END;
          END;
      //>>140317 ITERO.SB Extended "GetROTtxt" function with "Pro Forma Credit Memo" and "Posted Credit Memo"
        "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesHeader."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  ROTInformation.RESET();
                  ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                  //ROTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                  IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                    IF ROTtxt='' THEN
                      ROTtxt:=ROTtxt+ROTInformation.Name+':'+ROTInformation."Personal No."+' Del:'+FORMAT(ROTInformation."Quote of ROT Amount")+'%'
                    ELSE
                      ROTtxt:=ROTtxt+','+ROTInformation.Name+':'+ROTInformation."Personal No."+' Del:'+FORMAT(ROTInformation."Quote of ROT Amount")+'%';
                  UNTIL ROTInformation.NEXT = 0;
                  //>> 140403 ITERO.SB Handle "ROT-fixed price"
                  //<<
                  IF ROTInformation."Building/Apartment"=0 THEN
                    ROTtxt:='Fastbet.:'+ROTInformation."Building No."+','+ROTtxt
                  ELSE
                    ROTtxt:='Lgh:'+ROTInformation."Building No."+',Orgnr:'+ROTInformation."Apartment Organisation No."+','+ROTtxt;

                END;
              END;
            END;
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoHeader.SETRANGE("No.", "No.");
            IF SalesCrMemoHeader.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesCrMemoHeader."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  ROTInformation.RESET();
                  ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                  //ROTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                  IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                    IF ROTtxt='' THEN
                      ROTtxt:=ROTtxt+ROTInformation.Name+':'+ROTInformation."Personal No."+' Del:'+FORMAT(ROTInformation."Quote of ROT Amount")+'%'
                    ELSE
                      ROTtxt:=ROTtxt+','+ROTInformation.Name+':'+ROTInformation."Personal No."+' Del:'+FORMAT(ROTInformation."Quote of ROT Amount")+'%';
                  UNTIL ROTInformation.NEXT = 0;
                  //>> 140403 ITERO.SB Handle "ROT-fixed price"
                  //<<
                  IF ROTInformation."Building/Apartment"=0 THEN
                    ROTtxt:='Fastbet.:'+ROTInformation."Building No."+','+ROTtxt
                  ELSE
                    ROTtxt:='Lgh:'+ROTInformation."Building No."+',Orgnr:'+ROTInformation."Apartment Organisation No."+','+ROTtxt;

                END;
              END;
            END;
          END;
      END;
      //<<
    END;

    PROCEDURE GetPhoneNo@1100285505() PhoneNo : Text;
    VAR
      Job@1100285500 : Record 11072003;
      Employee@1100285501 : Record 5200;
    BEGIN
      IF Job.GET("Job No.") THEN BEGIN
        IF Employee.GET(Job."Project Manager") THEN
          PhoneNo := Employee."Phone No.";
      END;
    END;

    PROCEDURE GetROTPct@1100285000(Type@1100285000 : Integer) : Decimal;
    VAR
      ROTPct@1100285001 : Decimal;
      SalesHeader@1100285017 : Record 36;
      SalesInvoiceHeader@1100285016 : Record 112;
      ROTInformation@1100285015 : Record 11128101;
      TotalROT@1100285014 : Decimal;
      RotCount@1100285013 : Integer;
      AmountLabor@1100285012 : Decimal;
      SalesLine@1100285011 : Record 37;
      lvDimensionValue@1100285010 : Record 349;
      lvGeneralLedgerSetup@1100285009 : Record 98;
      lvCostPlusEntry@1100285008 : Record 11012019;
      AmountROT@1100285007 : Decimal;
      AmountROTtot@1100285006 : Decimal;
      SalesInvoiceLine@1100285005 : Record 113;
      SalesHeader2@1100285004 : Record 36;
      SalesCrMemoHeader@1100285003 : Record 114;
      ProjectPrincipal@1100285002 : Record 11012005;
      SalesReceivablesSetup@1100285018 : Record 311;
    BEGIN
      // 151215 ITERO.AC RFC-065 New function that returns current ROT Percentage

      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN BEGIN
              IF (SalesHeader."ROT/RUT reduction") THEN BEGIN
                ROTInformation.RESET();
                ROTInformation.SETRANGE(Type, ROTInformation.Type::Invoice);
                ROTInformation.SETRANGE("Invoice No.",SalesHeader."No.");
                ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                IF ROTInformation.FINDFIRST THEN BEGIN
                    ROTPct := ROTInformation."ROT Percentage";
                    IF ROTPct = 0 THEN
                      ROTPct := GetSalesSetupROTPct();
                    EXIT(ROTPct);
                END;
              END;
            END;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceHeader.SETRANGE("No.", "No.");
            IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
              IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                ROTInformation.RESET();
                ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                ROTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                IF ROTInformation.FINDFIRST THEN BEGIN
                    ROTPct := ROTInformation."ROT Percentage";
                    IF ROTPct = 0 THEN
                      ROTPct := GetSalesSetupROTPct();
                    EXIT(ROTPct);
                END;
              END;
            END;
          END;

        "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesHeader2.SETRANGE("Document Type", "Document Type");
            SalesHeader2.SETRANGE("No.", "No.");
            IF SalesHeader2.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesHeader2."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                //RotCount := 0;
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  ROTInformation.RESET();
                  ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                  ROTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                  IF ROTInformation.FINDFIRST THEN BEGIN
                    ROTPct := ROTInformation."ROT Percentage";
                    IF ROTPct = 0 THEN
                      ROTPct := GetSalesSetupROTPct();
                    EXIT(ROTPct);
                  END;
                END;
              END;
            END;
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoHeader.SETRANGE("No.", "No.");
            IF SalesCrMemoHeader.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesCrMemoHeader."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  ROTInformation.RESET();
                  ROTInformation.SETRANGE(Type, ROTInformation.Type::"Posted Invoice");
                  ROTInformation.SETRANGE("Invoice No.", SalesInvoiceHeader."No.");
                  ROTInformation.SETRANGE("Application Type",ROTInformation."Application Type"::ROT);//RFC188
                  IF ROTInformation.FINDFIRST THEN BEGIN
                    ROTPct := ROTInformation."ROT Percentage";
                    IF ROTPct = 0 THEN
                      ROTPct := GetSalesSetupROTPct();
                    EXIT(ROTPct);
                  END;
                END;
              END;
            END;
          END;
        END;
    END;

    LOCAL PROCEDURE GetSalesSetupROTPct@1100285004() : Decimal;
    VAR
      SalesReceivablesSetup@1100285000 : Record 311;
      ROTPct@1100285001 : Decimal;
    BEGIN
      // 151215 ITERO.AC RFC-065 New function that returns current ROT Percentage from Sales Setup

      IF SalesReceivablesSetup.GET() THEN BEGIN

        SalesReceivablesSetup.TESTFIELD("ROT Percentage");
        ROTPct := SalesReceivablesSetup."ROT Percentage";     // ITERO.AC 151215 RFC-065 Bugfix
        EXIT(ROTPct);

      END;
    END;

    PROCEDURE GetInterestRate@1100285100() InterestRate : Decimal;
    VAR
      Job@1100285500 : Record 11072003;
      Employee@1100285501 : Record 5200;
      Customer@1100285100 : Record 18;
      FCT@1100285101 : Record 5;
    BEGIN
      //>> 170505 ITERO.SB IME-510
      InterestRate:=0;
      IF Customer.GET("Sell-to Customer No.") THEN
        IF FCT.GET(Customer."Fin. Charge Terms Code") THEN
          InterestRate:=FCT."Interest Rate";
      //<<
    END;

    PROCEDURE GetRUT@1100285105(Type@1100285512 : Integer) : Decimal;
    VAR
      SalesHeader@1100285502 : Record 36;
      SalesInvoiceHeader@1100285503 : Record 112;
      RUTInformation@1100285504 : Record 11128101;
      TotalRUT@1100285501 : Decimal;
      RutCount@1100285500 : Integer;
      AmountLabor@1100285505 : Decimal;
      SalesLine@1100285506 : Record 37;
      lvDimensionValue@1100285509 : Record 349;
      lvGeneralLedgerSetup@1100285508 : Record 98;
      lvCostPlusEntry@1100285507 : Record 11012019;
      AmountRUT@1100285510 : Decimal;
      AmountRUTtot@1100285511 : Decimal;
      SalesInvoiceLine@1100285513 : Record 113;
      SalesHeader2@1100285514 : Record 36;
      SalesCrMemoHeader@1100285515 : Record 114;
      ProjectPrincipal@1100285516 : Record 11012005;
    BEGIN

      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN BEGIN
              //RotCount := 0;
              IF (SalesHeader."ROT/RUT reduction") THEN BEGIN
                RUTInformation.RESET();
                RUTInformation.SETRANGE(Type, RUTInformation.Type::Invoice);
                //RUTInformation.SETRANGE("Document No.", SalesHeader."No.");
                RUTInformation.SETRANGE("Invoice No.",SalesHeader."No.");
                RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                IF (RUTInformation.FINDSET(TRUE)) THEN REPEAT
                  //RUTCount += 1;
                  TotalRUT:=TotalRUT+RUTInformation.Amount;
                UNTIL RUTInformation.NEXT = 0;

                IF Type = 1 THEN
                  EXIT(TotalRUT);
                IF Type = 2 THEN
                  EXIT(AmountRUT);
                IF Type = 3 THEN
                  EXIT(AmountRUTtot);

              END;

            END;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceHeader.SETRANGE("No.", "No.");
            IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
              //RUTCount := 0;
              IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                RUTInformation.RESET();
                RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                //RUTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                RUTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                IF (RUTInformation.FINDSET(TRUE)) THEN REPEAT
                  //RUTCount += 1;
                  TotalRUT:=TotalRUT+RUTInformation.Amount;
                UNTIL RUTInformation.NEXT = 0;

                IF Type = 1 THEN
                  EXIT(TotalRUT);
                IF Type = 2 THEN
                  EXIT(AmountRUT);
                IF Type = 3 THEN
                  EXIT(AmountRUTtot);

              END;

            END;

          END;
        //END;
        //"Document Type"::"Pro Forma Credit Memo", "Document Type"::"Posted Credit Memo":
          //Amount := 0;

      //>>140317 ITERO.SB Extended "GetRUT" function with "Pro Forma Credit Memo" and "Posted Credit Memo"
        "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesHeader2.SETRANGE("Document Type", "Document Type");
            SalesHeader2.SETRANGE("No.", "No.");
            IF SalesHeader2.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesHeader2."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                //RUTCount := 0;
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  RUTInformation.RESET();
                  RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                  //RUTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                  IF (RUTInformation.FINDSET(TRUE)) THEN REPEAT
                    //RUTCount += 1;
                    TotalRUT:=TotalRUT+RUTInformation.Amount;
                  UNTIL RUTInformation.NEXT = 0;
                  IF Type = 1 THEN
                    EXIT(TotalRUT);
                  IF Type = 2 THEN
                    EXIT(AmountRUT);
                  IF Type = 3 THEN
                    EXIT(AmountRUTtot);

                END;
              END;
            END;
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            //SalesHeader2.SETRANGE("Document Type", "Document Type");
            SalesCrMemoHeader.SETRANGE("No.", "No.");
            IF SalesCrMemoHeader.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesCrMemoHeader."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                //RUTCount := 0;
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  RUTInformation.RESET();
                  RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                  //RUTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Invoice No.", SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                  IF (RUTInformation.FINDSET(TRUE)) THEN REPEAT
                    //RUTCount += 1;
                    TotalRUT:=TotalRUT+RUTInformation.Amount;
                  UNTIL RUTInformation.NEXT = 0;

                  IF Type = 1 THEN
                    EXIT(TotalRUT);
                  IF Type = 2 THEN
                    EXIT(AmountRUT);
                  IF Type = 3 THEN
                    EXIT(AmountRUTtot);

                END;
              END;
            END;
          END;

        END;
      //<<
    END;

    PROCEDURE GetRUTtxt@1100285106() RUTtxt : Text;
    VAR
      SalesHeader@1100285502 : Record 36;
      SalesInvoiceHeader@1100285503 : Record 112;
      RUTInformation@1100285504 : Record 11128101;
      SalesLine@1100285506 : Record 37;
      SalesInvoiceLine@1100285513 : Record 113;
      SalesCrMemoHeader@1100285500 : Record 114;
    BEGIN

      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN BEGIN
              IF (SalesHeader."ROT/RUT reduction") THEN BEGIN
                RUTInformation.RESET();
                RUTInformation.SETRANGE(Type, RUTInformation.Type::Invoice);
                //RUTInformation.SETRANGE("Document No.", SalesHeader."No.");
                RUTInformation.SETRANGE("Invoice No.",SalesHeader."No.");
                RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                IF (RUTInformation.FINDSET(TRUE)) THEN REPEAT
                  IF RUTtxt='' THEN
                    RUTtxt:=RUTtxt+RUTInformation.Name+':'+RUTInformation."Personal No."+' Del:'+FORMAT(RUTInformation."Quote of ROT Amount")+'%'
                  ELSE
                    RUTtxt:=RUTtxt+','+RUTInformation.Name+':'+RUTInformation."Personal No."+' Del:'+FORMAT(RUTInformation."Quote of ROT Amount")+'%';
                UNTIL RUTInformation.NEXT = 0;
                //<<
              END;
            END;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceHeader.SETRANGE("No.", "No.");
            IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
              IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                RUTInformation.RESET();
                RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                //RUTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                RUTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                IF (RUTInformation.FINDSET(TRUE)) THEN REPEAT
                  IF RUTtxt='' THEN
                    RUTtxt:=RUTtxt+RUTInformation.Name+':'+RUTInformation."Personal No."+' Del:'+FORMAT(RUTInformation."Quote of ROT Amount")+'%'
                  ELSE
                    RUTtxt:=RUTtxt+','+RUTInformation.Name+':'+RUTInformation."Personal No."+' Del:'+FORMAT(RUTInformation."Quote of ROT Amount")+'%';
                UNTIL RUTInformation.NEXT = 0;
                //>> 140403 ITERO.SB Handle "ROT-fixed price"
              END;
            END;
          END;
      //>>140317 ITERO.SB Extended "GetROTtxt" function with "Pro Forma Credit Memo" and "Posted Credit Memo"
        "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesHeader."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  RUTInformation.RESET();
                  RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                  //RUTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                  IF (RUTInformation.FINDSET(TRUE)) THEN REPEAT
                    IF RUTtxt='' THEN
                      RUTtxt:=RUTtxt+RUTInformation.Name+':'+RUTInformation."Personal No."+' Del:'+FORMAT(RUTInformation."Quote of ROT Amount")+'%'
                    ELSE
                      RUTtxt:=RUTtxt+','+RUTInformation.Name+':'+RUTInformation."Personal No."+' Del:'+FORMAT(RUTInformation."Quote of ROT Amount")+'%';
                  UNTIL RUTInformation.NEXT = 0;
                  //>> 140403 ITERO.SB Handle "ROT-fixed price"
                  //<<
                END;
              END;
            END;
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoHeader.SETRANGE("No.", "No.");
            IF SalesCrMemoHeader.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesCrMemoHeader."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  RUTInformation.RESET();
                  RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                  //RUTInformation.SETRANGE("Document No.", SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                  IF (RUTInformation.FINDSET(TRUE)) THEN REPEAT
                    IF RUTtxt='' THEN
                      RUTtxt:=RUTtxt+RUTInformation.Name+':'+RUTInformation."Personal No."+' Del:'+FORMAT(RUTInformation."Quote of ROT Amount")+'%'
                    ELSE
                      RUTtxt:=RUTtxt+','+RUTInformation.Name+':'+RUTInformation."Personal No."+' Del:'+FORMAT(RUTInformation."Quote of ROT Amount")+'%';
                  UNTIL RUTInformation.NEXT = 0;
                  //>> 140403 ITERO.SB Handle "ROT-fixed price"
                END;
              END;
            END;
          END;
      END;
      //<<
    END;

    PROCEDURE GetRUTPct@1100285108(Type@1100285000 : Integer) : Decimal;
    VAR
      RUTPct@1100285001 : Decimal;
      SalesHeader@1100285017 : Record 36;
      SalesInvoiceHeader@1100285016 : Record 112;
      RUTInformation@1100285015 : Record 11128101;
      TotalRUT@1100285014 : Decimal;
      RutCount@1100285013 : Integer;
      AmountLabor@1100285012 : Decimal;
      SalesLine@1100285011 : Record 37;
      lvDimensionValue@1100285010 : Record 349;
      lvGeneralLedgerSetup@1100285009 : Record 98;
      lvCostPlusEntry@1100285008 : Record 11012019;
      AmountRUT@1100285007 : Decimal;
      AmountRUTtot@1100285006 : Decimal;
      SalesInvoiceLine@1100285005 : Record 113;
      SalesHeader2@1100285004 : Record 36;
      SalesCrMemoHeader@1100285003 : Record 114;
      ProjectPrincipal@1100285002 : Record 11012005;
      SalesReceivablesSetup@1100285018 : Record 311;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice":
          BEGIN
            SalesHeader.SETRANGE("Document Type", "Document Type");
            SalesHeader.SETRANGE("No.", "No.");
            IF SalesHeader.FINDFIRST THEN BEGIN
              IF (SalesHeader."ROT/RUT reduction") THEN BEGIN
                RUTInformation.RESET();
                RUTInformation.SETRANGE(Type, RUTInformation.Type::Invoice);
                RUTInformation.SETRANGE("Invoice No.",SalesHeader."No.");
                RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                IF RUTInformation.FINDFIRST THEN BEGIN
                    RUTPct := RUTInformation."ROT Percentage";
                    IF RUTPct = 0 THEN
                      RUTPct := GetSalesSetupRUTPct();
                    EXIT(RUTPct);
                END;
              END;
            END;
          END;
        "Document Type"::"Posted Invoice":
          BEGIN
            SalesInvoiceHeader.SETRANGE("No.", "No.");
            IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
              IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                RUTInformation.RESET();
                RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                RUTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                IF RUTInformation.FINDFIRST THEN BEGIN
                    RUTPct := RUTInformation."ROT Percentage";
                    IF RUTPct = 0 THEN
                      RUTPct := GetSalesSetupRUTPct();
                    EXIT(RUTPct);
                END;
              END;
            END;
          END;

        "Document Type"::"Pro Forma Credit Memo":
          BEGIN
            SalesHeader2.SETRANGE("Document Type", "Document Type");
            SalesHeader2.SETRANGE("No.", "No.");
            IF SalesHeader2.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesHeader2."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                //RUTCount := 0;
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  RUTInformation.RESET();
                  RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                  RUTInformation.SETRANGE("Invoice No.",SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                  IF RUTInformation.FINDFIRST THEN BEGIN
                    RUTPct := RUTInformation."ROT Percentage";
                    IF RUTPct = 0 THEN
                      RUTPct := GetSalesSetupRUTPct();
                    EXIT(RUTPct);
                  END;
                END;
              END;
            END;
          END;
        "Document Type"::"Posted Credit Memo":
          BEGIN
            SalesCrMemoHeader.SETRANGE("No.", "No.");
            IF SalesCrMemoHeader.FINDFIRST THEN BEGIN
              SalesInvoiceHeader.SETRANGE("No.", SalesCrMemoHeader."Applies-to Doc. No.");
              IF SalesInvoiceHeader.FINDFIRST THEN BEGIN
                IF (SalesInvoiceHeader."ROT/RUT Reduction") THEN BEGIN
                  RUTInformation.RESET();
                  RUTInformation.SETRANGE(Type, RUTInformation.Type::"Posted Invoice");
                  RUTInformation.SETRANGE("Invoice No.", SalesInvoiceHeader."No.");
                  RUTInformation.SETRANGE("Application Type",RUTInformation."Application Type"::RUT);//RFC188
                  IF RUTInformation.FINDFIRST THEN BEGIN
                    RUTPct := RUTInformation."ROT Percentage";
                    IF RUTPct = 0 THEN
                      RUTPct := GetSalesSetupRUTPct();
                    EXIT(RUTPct);
                  END;
                END;
              END;
            END;
          END;
        END;
    END;

    LOCAL PROCEDURE GetSalesSetupRUTPct@1100285107() : Decimal;
    VAR
      SalesReceivablesSetup@1100285000 : Record 311;
      RUTPct@1100285001 : Decimal;
    BEGIN
      IF SalesReceivablesSetup.GET THEN BEGIN
        SalesReceivablesSetup.TESTFIELD("RUT Percentage");
        RUTPct := SalesReceivablesSetup."RUT Percentage";     // ITERO.AC 151215 RFC-065 Bugfix
        EXIT(RUTPct);
      END;
    END;

    PROCEDURE GetInstallmentAmountFromInstallments@1101285000() WithholdAmount : Decimal;
    VAR
      SalesLine@1100525001 : Record 37;
      ProjectInstallment@1100285500 : Record 11012018;
      SalesInvLine@1100285501 : Record 113;
      SalesCrMemoLine@1100285000 : Record 115;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Pro Forma Invoice","Document Type"::"Posted Invoice":
          BEGIN
            ProjectInstallment.SETRANGE("Project No.", "Job No.");
            ProjectInstallment.SETRANGE(Principal, "Sell-to Customer No.");
            ProjectInstallment.SETFILTER("Extension Contract", '%1', '');
            ProjectInstallment.SETFILTER(Option, '%1', '');
            ProjectInstallment.SETFILTER("Plot No.", '%1', '');
            ProjectInstallment.SETRANGE("Last Installment",FALSE);
            IF ProjectInstallment.FINDSET THEN REPEAT
              IF (ProjectInstallment."Installment Amount"<>0) THEN
              WithholdAmount := WithholdAmount + ProjectInstallment."Installment Amount";
            UNTIL ProjectInstallment.NEXT = 0;
          END;
      END;
    END;

    BEGIN
    {
      This table contains fields of the tables Sales Header (36), Sales Invoice Header (112) and Sales Cr.Memo Header (114).
      This table is used in report Generic Sales Document (11020285). This is a report that can be used for printing
      a Pro Forma Sales Invoice, Pro Forma Sales Cr.Memo, Posted Sales Invoice or Posted Sales Cr.Memo.
      This table is only used as a temporary table.

      Some FlowFields in the tables Sales Header (36), Sales Invoice Header (112) and Sales Cr.Memo Header (114) refer to
      different tables.
      Example:
      The FlowField Amount in table Sales Header (36) has the CalcFormula:
        Sum("Sales Line".Amount WHERE (Document Type=FIELD(Document Type),Document No.=FIELD(No.)))
      The FlowField Amount in table Sales Invoice Header (112) has the CalcFormula:
        Sum("Sales Invoice Line".Amount WHERE (Document No.=FIELD(No.)))
      The FlowField Amount in table Sales Cr.Memo Header (114) has the CalcFormula:
        Sum("Sales Cr.Memo Line".Amount WHERE (Document No.=FIELD(No.)))
      Therefore the following FlowFields have been replaced with functions:
              60 Amount
              61 Amount Including VAT
        11012580 Amount VAT
        11012597 Open Complaints
        11012598 Complaints

      To prevent that the Generic Sales Header table will contain to many fields, some fields (that are not
      relevant to a printed invoice or credit memo) have not been added to the Generic Sales Header table:
             107 No. Series (table 36), Pre-Assigned No. Series (table 112, 114)
             108 Posting No. Series (table 36), No. Series (table 112, 114)
             112 User ID
             124 IC Status
             125 Sell-to IC Partner Code
             126 Bill-to IC Partner Code
             129 IC Direction
             160 Job Queue Status
             161 Job Queue Entry ID
        11012593 PDF Sent by
        11012815 Inserted By
        11012880 Invoice Exported by XML
        11020281 Invoice per E-Mail
        11020282 E-Mail Sent by
        11020283 E-Mail Sent on

      When a Sales Header record is inserted in a temporary Generic Sales Header table, the fields
      "E-Mail (Invoices)" and "Electronic Invoicing" are read from table Sales Header Extension (11071868).

      Not allowed to add more fields to this table
      140203 ITERO.SB New functions added
      140317 ITERO.SB Extended "GetROTtxt","GetROT" and "GetinstallmentAmount" functions with "Pro Forma Credit Memo" and "Posted Credit Memo"
      140414 ITERO.SB Updated ROT-calc. + added func. GetPhoneNo (Manager)
      141015 ITERO.MH ENH021 Added "ROT" as field
      150909 RFC001
      151215 ITERO.AC RFC-065 Bugfixes. Added two functions: GetROTPct() AND GetSalesSetupROTPct()
      160315 ITERO.SB New calc. of withheld amount (RAD-39)
      160422 ITERO.SB Use old version of function HasOnlyReverseChargeVATLines (from 100_dev)
      160427 ITERO.SB RAD039fix, Handle new field, Withheld Amt. (Credit)
      170130 ITERO.DL IME-502 removed CheckNo() and remake GetOCR()to use SEUtils.makeOCR10ref()
      170505 ITERO.SB IME-510
      170512 ITERO.DL RFC188 namechange ROT -> "ROT/RUT Reduction"
      170602 ITERO.DL RFC188 added functions for RUT
      170831 ITERO.SB Do not calc summary when extension line (pure 275453)
      170911 ITERO.SB Pure 276758 handle withheld amount for extensions

      190925 ORANGO.EE - New function GetInstallmentAmountFromInstallments
    }
    END.
  }
}

