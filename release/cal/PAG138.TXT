OBJECT Page 138 Posted Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.04,DCNL14.00.00.5.00.08,4PS14.00,NAVDK.NO.FI,EXF,4PSSE;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Purchase Invoice;
               NOR=Bokfõrt kjõpsfaktura;
               SVE=Bokfîrd inkîpsfaktura];
    InsertAllowed=No;
    SourceTable=Table122;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Correct,Invoice,Print/Send,Navigate,Approval;
                                NOR=Ny,Prosess,Rapport,Korriger,Faktura,Skriv ut / send,Naviger;
                                SVE=Ny,Process,Rapport,Korrigera,Faktura,Skriv ut/skicka,Navigera];
    OnInit=BEGIN
             //**4PS.sn
             "Ext. Document IDEditable" := TRUE;
             "Ext. Document IDVisible" := TRUE;
             "Interest DateVisible" := TRUE;
             //Always hide buttons CorrectInvoice and CancelInvoice.
             CorrectInvoiceVisible := FALSE;
             CancelInvoiceVisible := FALSE;
             //**4PS.en
           END;

    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
                 lvInterestCalcMgtCU@1210190002 : Codeunit 11012049;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
                 IsFoundationEnabled := ApplicationAreaMgmtFacade.IsFoundationEnabled;

                 ActivateFields;

                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 //**4PS.sn
                 IF NOT lvInterestCalcMgtCU.PermissionInterestGranule() THEN
                   "Interest DateVisible" := FALSE;

                 PurchSetup.GET;
                 IF PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Other THEN BEGIN
                   "Ext. Document IDEditable" := FALSE;
                   "Ext. Document IDVisible" := FALSE;
                 END;
                 //**4PS.en
                 //4PSSE
                 GLSetup.GET;
                 DKinfoEnable := GLSetup."Danish Localization Active";
                 FIinfoEnable := GLSetup."Finnish localization active";
                 NORlocalizationEnable := GLSetup."Norwegian Localization Active";
               END;

    OnAfterGetRecord=BEGIN
                       //**4PS.sn
                       IF gFromReference THEN BEGIN
                         gFromReference := FALSE;
                         CurrPage.PurchInvLines.PAGE.InitSelectionFromReference(gInvLineNo);
                       END;
                       IF NOT PurchInvHeaderExtension.GET("No.") THEN
                         CLEAR(PurchInvHeaderExtension);
                       //**4PS.en
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnModifyRecord=BEGIN
                     //**4PS.sn; hbk 14446
                     CODEUNIT.RUN(CODEUNIT::"Purch. Inv. Header-Edit",Rec);
                     EXIT(FALSE);
                     //**4PS.en; hbk 14446
                   END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                           RecRef@1100527300 : RecordRef;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("No.","Posting Date");
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           //**4PS.sn;
                           SetControlAppearance;
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                           //**4PS.en;

                           //**4PS.sn;
                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Shortcut Dimension 1 Code");
                           FillDocumentViewerFactbox;
                           //**4PS.en;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 NOR=F&aktura;
                                 SVE=Fa&ktura];
                      Image=Invoice }
      { 45      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 400;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category5 }
      { 55      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 66;
                      RunPageLink=Document Type=CONST(Posted Invoice),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category5 }
      { 89      ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera mÜtt, till exempel omrÜde, projekt eller avdelning, som du kan tilldela till fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 106     ;2   ;Action    ;
                      AccessByPermission=TableData 456=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Approvals;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ShowPostedApprovalEntries(RECORDID);
                               END;
                                }
      { 12013591;2   ;Separator  }
      { 12013592;2   ;Action    ;
                      Name=<Action1100285004>;
                      ShortCutKey=Ctrl+I;
                      CaptionML=[ENU=Show document;
                                 SVE=Visa dokument];
                      Image=Document;
                      OnAction=BEGIN
                                 // ExFlow
                                 ExFlow.ShowImagePostedDoc(2,"No.");
                               END;
                                }
      { 12013593;2   ;Action    ;
                      Name=<Action1100285005>;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=Attached Fil&es;
                                 SVE=&Bilagor];
                      Image=Documents;
                      OnAction=BEGIN
                                 // ExFlow
                                 ExFlow.ShowAttachmentPostedDoc(2, "No.");
                               END;
                                }
      { 1100485001;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+S;
                      CaptionML=[ENU=Scanned Document;
                                 SVE=Skannade dokument];
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 lvPurchSetupRec@1100485003 : Record 312;
                               BEGIN
                                 lvPurchSetupRec.GET;
                                 lvPurchSetupRec.ShowScannedDocument(2, "No.","Buy-from Vendor No.","Ext. Document ID");
                               END;
                                }
      { 1100525001;2 ;Action    ;
                      CaptionML=[ENU=Subcontracting Hours;
                                 SVE=Underentreprenadstimmar];
                      Promoted=Yes;
                      Image=SubcontractingWorksheet;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 SubcontractingHoursInvoice@1100525000 : Record 11020694;
                               BEGIN
                                 //**4PS
                                 SubcontractingHoursInvoice.RunPageFromPurchInvHeader(Rec);
                               END;
                                }
      { 1210190017;2 ;Action    ;
                      CaptionML=[ENU=&Documents;
                                 SVE=&Dokument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1210190010;2 ;Action    ;
                      CaptionML=[ENU=ICF Specifications;
                                 SVE=ICF-specifikationer];
                      Promoted=Yes;
                      Image=ElectronicDoc;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 ShowICFInvoiceLines;  //**4PS
                               END;
                                }
      { 1100285103;2 ;Action    ;
                      CaptionML=[ENU=Show &Documents;
                                 SVE=Visa &dokument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                                 SourceCodeSetup@1000000001 : Record 242;
                                 PurchInvHeader@1000000000 : Record 122;
                                 PurchCredHeader@1100285300 : Record 124;
                                 DocumentFilter@1000000003 : Record 11012073;
                                 GlobalTempDocumentProperties@1000000002 : TEMPORARY Record 11012746;
                               BEGIN
                                 //RFC136
                                 //160324
                                 SourceCodeSetup.GET;
                                 CASE "Source Code" OF
                                   SourceCodeSetup.Purchases,'':
                                     BEGIN
                                       IF PurchInvHeader.GET("No.") THEN
                                         RecRef.GETTABLE(PurchInvHeader)
                                       ELSE
                                         IF PurchCredHeader.GET("No.") THEN
                                           RecRef.GETTABLE(PurchCredHeader)
                                         ELSE
                                         RecRef.GETTABLE(Rec);
                                     END;
                                   ELSE
                                     RecRef.GETTABLE(Rec);
                                 END;

                                 DocumentFilters.CreateTemporaryFilter(RecRef, DocumentFilter);
                                 COMMIT;

                                 DocumentFilters.ApplyDocumentFilter(DocumentFilter, GlobalTempDocumentProperties);
                                 GlobalTempDocumentProperties.SETRANGE("From Filter Form", FALSE);
                                 CASE GlobalTempDocumentProperties.COUNT OF
                                   0:
                                     CASE RecRef.NUMBER OF
                                      122: BEGIN PurchInvHeader.SETRECFILTER; PurchInvHeader.PrintRecords(TRUE); END;
                                      124: BEGIN PurchCredHeader.SETRECFILTER; PurchCredHeader.PrintRecords(TRUE,FALSE); END;
                                     END;
                                   1:  GlobalTempDocumentProperties.OpenDocument;
                                   ELSE
                                   PAGE.RUNMODAL(0, GlobalTempDocumentProperties);
                                 END;
                               END;
                                }
      { 1100528205;2 ;ActionGroup;
                      CaptionML=[ENU=&Approval;
                                 SVE=&GodkÑnnanden];
                      Image=BOMLedger }
      { 1100528204;3 ;Action    ;
                      CaptionML=[ENU=Approval Entries;
                                 SVE=GodkÑnnandetransaktioner];
                      RunObject=Page 658;
                      RunPageView=WHERE(Table ID=CONST(122));
                      RunPageLink=Document No.=FIELD(No.);
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExist;
                      Image=BOMLedger;
                      PromotedCategory=Category8 }
      { 1100528203;3 ;Action    ;
                      CaptionML=[ENU=Approval Comments;
                                 SVE=GodkÑnnandekommentarer];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExist;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalEntry@1100525000 : Record 454;
                                 ApprovalCommentLine@1100525001 : Record 455;
                               BEGIN
                                 IF OpenApprovalEntriesExist THEN BEGIN
                                   //ApprovalManagement4PSConstr.FilterApprovalEntryOpen(2, "No.", ApprovalEntry, FALSE);//**4PS C049344.o
                                   ApprovalManagement4PSConstr.FilterApprovalEntryOpen(DATABASE::"Purch. Inv. Header", 2, "No.", ApprovalEntry, FALSE);//**4PS C049344.n
                                   ApprovalCommentLine.SETRANGE("Table ID", DATABASE::"Purch. Inv. Header");
                                   ApprovalCommentLine.SETRANGE("Record ID to Approve", RECORDID);
                                   ApprovalCommentLine."Workflow Step Instance ID" := ApprovalEntry."Workflow Step Instance ID";
                                   ApprovalManagement4PSConstr.DrillDownApprovalCommentsHdr(ApprovalEntry,ApprovalCommentLine);
                                 END;
                               END;
                                }
      { 1100528202;3 ;Action    ;
                      CaptionML=[ENU=Posted Approval Entries;
                                 SVE=Bokfîrda godkÑnnandetransaktioner];
                      RunObject=Page 659;
                      RunPageView=WHERE(Table ID=CONST(122));
                      RunPageLink=Document No.=FIELD(No.);
                      Promoted=Yes;
                      Image=BOMLedger;
                      PromotedCategory=Category8 }
      { 1100528201;3 ;Action    ;
                      CaptionML=[ENU=Posted Approval Comments;
                                 SVE=Bokfîrda godkÑnnandekommentarer];
                      RunObject=Page 661;
                      RunPageView=WHERE(Table ID=CONST(122));
                      RunPageLink=Document No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedCategory=Category8 }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 27      ;1   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut;
                                 SVE=Skriv &ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargjõr for Ü skrive ut dokumentet. Det vises et rapportforespõrselsvindu for dokumentet der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Fîrbered utskrift av dokumentet. Ett rapportfînster om dokumentet îppnas dÑr det gÜr att ange vad du vill inkludera pÜ utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchInvHeader);
                                 PurchInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=Correct;
                                 NOR=Korriger;
                                 SVE=Korrigera] }
      { 23      ;2   ;Action    ;
                      Name=CorrectInvoice;
                      CaptionML=[ENU=Correct;
                                 NOR=Korriger;
                                 SVE=Korrigera];
                      ToolTipML=[ENU=Reverse this posted invoice and automatically create a new invoice with the same information that you can correct before posting. This posted invoice will automatically be canceled.;
                                 NOR=Tilbakefõr denne bokfõrte fakturaen, og opprett automatisk en ny faktura med den samme informasjonen som du kan korrigere fõr bokfõring. Denne bokfõrte fakturaen annulleres automatisk.;
                                 SVE=èterfîr den hÑr bokfîrda fakturan och skapa automatiskt en ny faktura med samma information som du kan Ñndra innan den bokfîrs. Den hÑr bokfîrda inkîpsfakturan annulleras automatiskt.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=CorrectInvoiceVisible;
                      PromotedIsBig=Yes;
                      Image=Undo;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 CorrectPstdPurchInvYesNo@1000 : Codeunit 1324;
                               BEGIN
                                 IF CorrectPstdPurchInvYesNo.CorrectInvoice(Rec) THEN
                                   CurrPage.CLOSE;
                               END;
                                }
      { 11      ;2   ;Action    ;
                      Name=CancelInvoice;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Avbryt];
                      ToolTipML=[ENU=Create and post a purchase credit memo that reverses this posted purchase invoice. This posted purchase invoice will be canceled.;
                                 NOR=Opprett og bokfõr en kjõpskreditnota som tilbakefõrer denne bokfõrte kjõpsfakturaen. Denne bokfõrte kjõpsfakturaen vil bli annullert.;
                                 SVE=Skapa och bokfîr en inkîpskreditnota som Üterfîr den hÑr bokfîrda inkîpsfakturan. Den hÑr bokfîrda inkîpsfakturan annulleras.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=CancelInvoiceVisible;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 CancelPstdPurchInvYesNo@1000 : Codeunit 1325;
                               BEGIN
                                 IF CancelPstdPurchInvYesNo.CancelInvoice(Rec) THEN
                                   CurrPage.CLOSE;
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=CreateCreditMemo;
                      CaptionML=[ENU=Create Corrective Credit Memo;
                                 NOR=Opprett korrigerende kreditnota;
                                 SVE=Skapa korrigerande kreditnota];
                      ToolTipML=[ENU=Create a credit memo for this posted invoice that you complete and post manually to reverse the posted invoice.;
                                 NOR=Opprett en kreditnota for denne bokfõrte fakturaen som du fullfõrer og bokfõrer manuelt for Ü tilbakefõre den bokfõrte fakturaen.;
                                 SVE=Skapa en kreditnota fîr den hÑr bokfîrda fakturan, som du fyller i och bokfîr manuellt fîr att Üterfîra den bokfîrda fakturan.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=CreateCreditMemo;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 PurchaseHeader@1001 : Record 38;
                                 CorrectPostedPurchInvoice@1000 : Codeunit 1313;
                               BEGIN
                                 IF CorrectPostedPurchInvoice.CreateCreditMemoCopyDocument(Rec,PurchaseHeader) THEN BEGIN
                                   PAGE.RUN(PAGE::"Purchase Credit Memo",PurchaseHeader);
                                   CurrPage.CLOSE;
                                 END;
                               END;
                                }
      { 49      ;2   ;Action    ;
                      Name=ShowCreditMemo;
                      CaptionML=[ENU=Show Canceled/Corrective Credit Memo;
                                 NOR=Vis annullert/korrigerende kreditnota;
                                 SVE=Visa annullerad/korrigerande kreditnota];
                      ToolTipML=[ENU=Open the posted purchase credit memo that was created when you canceled the posted purchase invoice. If the posted purchase invoice is the result of a canceled purchase credit memo, then the canceled purchase credit memo will open.;
                                 NOR=èpne den bokfõrte kjõpskreditnotaen som ble opprettet da du kansellerte den bokfõrte kjõpsfakturaen. Hvis den bokfõrte kjõpsfakturaen er et resultat av den kansellerte kjõpskreditnotaen, sÜ vil den kansellerte kjõpskreditnotaen bli Üpnet.;
                                 SVE=ôppna den bokfîrda inkîpskreditnotan som skapades nÑr du annullerade den bokfîrda inkîpsfakturan. Om den bokfîrda inkîpsfakturan Ñr resultatet av en annullerad inkîpskreditnota îppnas den annullerade inkîpskreditnotan.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=Cancelled OR Corrective;
                      Image=CreditMemo;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrCrMemo;
                               END;
                                }
      { 39      ;1   ;ActionGroup;
                      CaptionML=[ENU=Actions;
                                 NOR=Handlinger;
                                 SVE=ètgÑrder];
                      Image=Invoice }
      { 37      ;2   ;Action    ;
                      Name=Vendor;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverandõren i kjõpsdokumentet.;
                                 SVE=Visa eller redigera detaljerad information om leverantîren pÜ inkîpsdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Image=Vendor;
                      PromotedCategory=Category7 }
      { 33      ;2   ;Action    ;
                      Name=Navigate;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger;
                                 SVE=Anal&ysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the posted purchase document.;
                                 NOR=Finn alle poster og dokumenter som finnes for dokumentnummeret og bokfõringsdatoen pÜ det bokfõrte kjõpsdokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet pÜ det bokfîrda inkîpsdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 1901458458;2 ;Action    ;
                      Name=DocAttach;
                      CaptionML=[ENU=Attachments;
                                 NOR=Vedlegg;
                                 SVE=Bilagor];
                      ToolTipML=[ENU=Add a file as an attachment. You can attach images as well as documents.;
                                 NOR=Legg til en fil som vedlegg. Du kan legge ved bilderˇog dokumenter.;
                                 SVE=LÑgg till en fil som en bilaga. Du kan bifoga bilder och dokument.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Image=Attach;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1000 : Page 1173;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 57      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger;
                                 SVE=Anal&ysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppfõringer og dokumenter som finnes for dokumentnummeret og bokfõringsdatoen i den valgte oppfõringen eller dokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet fîr den valda transaktionen eller det valda dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Navigate;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 19      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 17      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inngÜende dokument;
                                 SVE=Visa inkommande dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppfõringen eller dokumentet.;
                                 SVE=Visa alla poster med inkommande dokument och filbilagor som finns fîr transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 15      ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inngÜende dokument;
                                 SVE=VÑlj inkommande dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppfõringen eller dokumentet.;
                                 SVE=VÑlj en inkommande dokumentpost och en filbilaga som du vill koppla till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("No.","Posting Date",RECORDID);
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inngÜende dokument fra fil;
                                 SVE=Skapa inkommande dokument frÜn fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved Ü velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppfõringen eller dokumentet.;
                                 SVE=Skapa en post fîr inkommande dokument genom att vÑlja en fil att bifoga. Koppla sedan posten fîr det inkommande dokumentet till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("No.","Posting Date");
                               END;
                                }
      { 68      ;1   ;Action    ;
                      Name=Update Document;
                      CaptionML=[ENU=Update Document;
                                 NOR=Oppdater dokument;
                                 SVE=Uppdatera dokument];
                      ToolTipML=[ENU=Add new information that is relevant to the document, such as a payment reference. You can only edit a few fields because the document has already been posted.;
                                 NOR=Legg til ny informasjon som er relevant i dokumentet, for eksempel en betalingsreferanse. Du kan bare redigere noen fÜ felter fordi dokumentet allerede er bokfõrt.;
                                 SVE=LÑgg till ny information som Ñr relevant fîr dokumentet, till exempel en betalningsreferens. Du kan bara redigera nÜgra av fÑlten eftersom dokumentet redan har bokfîrts.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Edit;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 PostedPurchInvoiceUpdate@1000 : Page 1351;
                               BEGIN
                                 PostedPurchInvoiceUpdate.LOOKUPMODE := TRUE;
                                 PostedPurchInvoiceUpdate.SetRec(Rec);
                                 PostedPurchInvoiceUpdate.RUNMODAL;
                               END;
                                }
      { 1100528409;1 ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 SVE=GodkÑnnande] }
      { 1100528408;2 ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 SVE=GodkÑnn];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                                 ApprovalEntry@1100528200 : Record 454;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                                 //**4PS.sn
                                 IF NOT ApprovalsMgmt.FindOpenApprovalEntryForCurrUser(ApprovalEntry,RECORDID) THEN
                                   MARK(FALSE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 1100528407;2 ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 SVE=Avvisa];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528406;2 ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 SVE=Delegera];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528405;2 ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 SVE=Kommentarer];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalEntry@1100525000 : Record 454;
                                 ApprovalCommentLine@1100525001 : Record 455;
                               BEGIN
                                 //4Ps.sn
                                 IF OpenApprovalEntriesExist THEN BEGIN
                                   //ApprovalManagement4PSConstr.FilterApprovalEntryOpen(2, "No.", ApprovalEntry, FALSE);//**4PS C049344.o
                                   ApprovalManagement4PSConstr.FilterApprovalEntryOpen(DATABASE::"Purch. Inv. Header", 2, "No.", ApprovalEntry, FALSE);//**4PS C049344.n
                                   ApprovalCommentLine.SETRANGE("Table ID", DATABASE::"Purch. Inv. Header");
                                   ApprovalCommentLine.SETRANGE("Document No.", "No.");
                                   ApprovalCommentLine.SETRANGE("Record ID to Approve", RECORDID);
                                   ApprovalCommentLine."Workflow Step Instance ID" := ApprovalEntry."Workflow Step Instance ID";
                                   ApprovalManagement4PSConstr.DrillDownApprovalCommentsHdr(ApprovalEntry,ApprovalCommentLine);
                                 END;
                                 //4Ps.en
                               END;
                                }
      { 1100525003;2 ;Action    ;
                      CaptionML=[ENU=&On Hold;
                                 SVE=S&toppad];
                      Promoted=Yes;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=Lock;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsBridge4PSConstruct@1100525000 : Codeunit 11125348;
                               BEGIN
                                 ApprovalsBridge4PSConstruct.OnHold(Rec);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100528404;1 ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 SVE=BegÑr godkÑnnande];
                      Image=Action }
      { 1100528403;2 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalManagement4PSConstr@1100528400 : Codeunit 11125349;
                                 ApprovalsBridge4PSConstruct@1100528401 : Codeunit 11125348;
                               BEGIN
                                 ApprovalManagement4PSConstr.CheckPostedPurchaseInvoiceApprovalsWorkflowEnabled(Rec);
                                 ApprovalsBridge4PSConstruct.OnSendPostedPurchaseInvoiceForApproval(Rec);
                               END;
                                }
      { 1100528402;2 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      Enabled=CanCancelApprovalForRecord;
                      Image=Cancel;
                      OnAction=VAR
                                 ApprovalsBridge4PSConstruct@1100528400 : Codeunit 11125348;
                               BEGIN
                                 ApprovalsBridge4PSConstruct.OnCancelPostedPurchaseInvoiceApprovalRequest(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted invoice number.;
                           NOR=Angir det bokfõrte fakturanummeret.;
                           SVE=Anger den bokfîrda fakturans nummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                Importance=Additional;
                Editable=FALSE }

    { 59  ;2   ;Field     ;
                CaptionML=[ENU=Vendor;
                           NOR=Leverandõr;
                           SVE=Leverantîr];
                ToolTipML=[ENU=Specifies the name of the vendor who shipped the items.;
                           NOR=Angir navnet pÜ leverandõren som leverte varene.;
                           SVE=Anger namnet pÜ leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Vendor Name";
                TableRelation=Vendor.Name;
                Editable=FALSE }

    { 1100485014;2;Field  ;
                SourceExpr="Related Purch. Order No.";
                Editable=FALSE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kjõp fra;
                           SVE=Kîp frÜn];
                GroupType=Group }

    { 61  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor who shipped the items.;
                           NOR=Angir adressen til leverandõren som leverte varene.;
                           SVE=Anger adressen till leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable=FALSE }

    { 63  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 65  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                Editable=FALSE }

    { 51  ;3   ;Group     ;
                Visible=IsBuyFromCountyVisible;
                GroupType=Group }

    { 29  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from County";
                Importance=Additional;
                Editable=FALSE }

    { 6   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 35  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the ship-to address.;
                           NOR=Angir lands- eller omrÜdekoden for lever til-adressen.;
                           SVE=Anger land eller region i leveransadressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Country/Region Code";
                Importance=Additional;
                Editable=FALSE }

    { 100 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the contact you bought the items from.;
                           NOR=Angir nummeret pÜ kontakten som du kjõpte varene fra.;
                           SVE=Anger kontaktnumret till leverantîren som du kîpte artiklarna av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact at the vendor who shipped the items.;
                           NOR=Angir navnet pÜ kontaktpersonen hos den leverandõren som leverte varene.;
                           SVE=Anger namnet pÜ kontaktpersonen hos leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 1100285104;2;Field  ;
                SourceExpr="Reference (Vendor)";
                Editable=false }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date the purchase header was posted.;
                           NOR=Angir datoen da bestillingshodet ble bokfõrt.;
                           SVE=Anger datumet dÜ inkîpsordern bokfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the purchase document was created.;
                           NOR=Angir datoen da kjõpsdokumentet ble opprettet.;
                           SVE=Anger datumet nÑr inkîpsdokumentet skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the invoice is due. The program calculates the date using the Payment Terms Code and Document Date fields on the purchase header.;
                           NOR=Angir nÜr fakturaen forfaller. Programmet beregner datoen ved hjelp av feltet Betalingsbet.kode og Bilagsdato i bestillingshodet.;
                           SVE=Anger nÑr fakturan fîrfaller. Datumet berÑknas frÜn fÑlten Betalningsvillkorskod och Dokumentdatum i inkîpshuvudet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable=FALSE }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase quote document if a quote was used to start the purchase process.;
                           NOR=Angir nummeret pÜ forespõrselsdokumentet hvis en forespõrsel ble brukt til Ü starte kjõpsprosessen.;
                           SVE=Anger numret pÜ inkîpsofferten om en offert anvÑndes som inledning till inkîpsprocessen.];
                ApplicationArea=#Suite;
                SourceExpr="Quote No.";
                Importance=Additional;
                Editable=FALSE }

    { 81  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase order that this invoice was posted from.;
                           NOR=Angir nummeret pÜ bestillingen som denne fakturaen er bokfõrt fra.;
                           SVE=Anger numret pÜ inkîpsordern som den hÑr fakturan bokfîrdes frÜn.];
                ApplicationArea=#Suite;
                SourceExpr="Order No.";
                Importance=Additional;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's own invoice number.;
                           NOR=Angir leverandõrens eget fakturanummer.;
                           SVE=Anger leverantîrens egna fakturanummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Invoice No.";
                Importance=Promoted;
                Editable=FALSE }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's order number.;
                           NOR=Angir leverandõrens ordrenummer.;
                           SVE=Anger leverantîrens egna ordernummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Order No.";
                Importance=Additional;
                Editable=FALSE }

    { 83  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase document that the posted invoice was created for.;
                           NOR=Angir nummeret pÜ kjõpsdokumentet som den bokfõrte fakturaen ble opprettet for.;
                           SVE=Anger numret pÜ inkîpsdokumentet fîr vilket den hÑr bokfîrda fakturan skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pre-Assigned No.";
                Importance=Additional;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the document has been printed.;
                           NOR=Angir hvor mange ganger dokumentet har blitt skrevet ut.;
                           SVE=Anger hur mÜnga gÜnger dokumentet har skrivits ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed";
                Importance=Additional;
                Editable=FALSE }

    { 1101200000;2;Field  ;
                SourceExpr="Subcontracting Invoice";
                Editable=FALSE }

    { 1100485002;2;Field  ;
                SourceExpr="Your Reference";
                Editable=FALSE }

    { 1100528207;2;Field  ;
                SourceExpr="Approval Code" }

    { 1100528413;2;Field  ;
                CaptionML=[ENU=Approval by User;
                           SVE=GodkÑnnande av anvÑndare];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApprover(RECORDID,0);
                Editable=FALSE }

    { 1100528412;2;Field  ;
                CaptionML=[ENU=Approval by User Name;
                           SVE=GodkÑnnande av anvÑndarnamn];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApproverName(RECORDID,0);
                Editable=FALSE }

    { 1101200004;2;Field  ;
                SourceExpr="On Hold";
                Editable=FALSE }

    { 1100527300;2;Field  ;
                AccessByPermission=Codeunit 6085578=X;
                CaptionML=ENU=No. of Documents (DC);
                SourceExpr=DocMgt.GetNoOfDocForDoc(DATABASE::"Purchase Header",2,"No.",0);
                Visible=FALSE;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              DocMgt.LookupDocsForDoc(DATABASE::"Purchase Header",2,"No.",0)
                            END;
                             }

    { 1101200002;2;Field  ;
                SourceExpr="Approvement Initials";
                Editable=FALSE }

    { 1100528400;2;Field  ;
                SourceExpr="Job No.";
                Importance=Additional;
                Editable=FALSE }

    { 1100528401;2;Field  ;
                SourceExpr="Service Order No.";
                Importance=Additional;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is assigned to the vendor.;
                           NOR=Angir hvilken innkjõper som er knyttet til leverandõren.;
                           SVE=Anger vilken inkîpare som Ñr kopplad till leverantîren.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                Editable=FALSE }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the responsibility center that serves the vendor on this purchase document.;
                           NOR=Angir koden for ansvarssenteret som betjener leverandõren pÜ dette kjõpsdokumentet.;
                           SVE=Anger koden fîr ansvarsenheten som ansvarar fîr leverantîren i det hÑr inkîpsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FALSE }

    { 1100529500;2;Field  ;
                SourceExpr="Back-to-back";
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice has been either corrected or canceled.;
                           NOR=Angir om den bokfõrte kjõpsfakturaen er blitt korrigert eller kansellert.;
                           SVE=Anger om den bokfîrda inkîpsfakturan har rÑttats eller annullerats.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Importance=Additional;
                Visible=IsFoundationEnabled;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveCreditMemo;
                            END;
                             }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice is a corrective document.;
                           NOR=Angir om den bokfõrte kjõpsfakturaen er et korrigerende dokument.;
                           SVE=Anger om den bokfîrda inkîpsfakturan Ñr ett rÑttningsdokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledCreditMemo;
                            END;
                             }

    { 12013587;2;Field    ;
                SourceExpr=Approve;
                Editable=False }

    { 52  ;1   ;Part      ;
                Name=PurchInvLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page139 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer;
                           SVE=Fakturadetaljer];
                GroupType=Group }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code used to calculate the amounts on the invoice.;
                           NOR=Angir valutakoden som er brukt til Ü beregne belõpene i fakturaen.;
                           SVE=Anger valutakoden som anvÑnds fîr att berÑkna fakturans belopp.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=VAR
                               UpdateCurrencyFactor@1001 : Codeunit 325;
                               ChangeExchangeRate@1000 : Page 511;
                             BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.SetAdditionalParameters(1, "Job No.", FALSE); //**4PS.n
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 UpdateCurrencyFactor.ModifyPostedPurchaseInvoice(Rec);
                               END;
                             END;
                              }

    { 1070000;2;Field     ;
                ToolTipML=[ENU=Specifies whether the purchase invoice was involved in an EU 3-party trade.;
                           SVE=Anger om inkîpsfakturan ingick i en EU trepartshandel.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="EU 3-Party Trade";
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the invoiced items were expected.;
                           NOR=Angir forventet mottaksdato for de fakturerte varene.;
                           SVE=Anger datumet dÜ de fakturerade artiklarna fîrvÑntades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted;
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code to use to find the payment terms that apply to the purchase header.;
                           NOR=Angir koden som skal brukes for Ü finne betalingsbetingelsene som gjelder for bestillingshodet.;
                           SVE=Anger koden som anvÑnds fîr att hitta betalningsvillkoren som tillÑmpas pÜ inkîpshuvudet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE;
                LookupPageID=Cost Object List }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis betaling utfõres innen datoen i feltet Kont.rabattdato.;
                           SVE=Anger den procentuella kassarabatten som anvÑnds om betalningen gîrs senast det datum som anges i fÑltet Kassarabattsdatum.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Discount %";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                           NOR=Angir datoen da belõpet i posten mÜ vëre betalt for at det kan oppnÜs kontantrabatt.;
                           SVE=Anger datumet dÜ transaktionens belopp mÜste vara betalt fîr att orderns kassarabatt ska gÑlla.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Editable=FALSE }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location where the items are registered.;
                           NOR=Angir koden for lokasjonen som varene er registrert pÜ.;
                           SVE=Anger koden fîr lagerstÑllet dÑr artiklarna registreras.];
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Importance=Additional;
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the delivery conditions of the related shipment, such as free on board (FOB).;
                           NOR=Angir leveringsbetingelsene for den tilknyttede leveringen, for eksempel Fritt ombord (FOB).;
                           SVE=Anger leveransvillkoren fîr den relaterade utleveransen, till exempel fritt ombord.];
                ApplicationArea=#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Additional;
                Editable=FALSE }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment of the purchase invoice.;
                           NOR=Angir betalingen for kjõpsfakturaen.;
                           SVE=Anger betalningen av inkîpsfakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Reference";
                Importance=Additional;
                Editable=FALSE }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor.;
                           NOR=Angir nummeret for leverandõren.;
                           SVE=Anger leverantîrens nummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Creditor No.";
                Importance=Additional;
                Editable=FALSE }

    { 1060000;2;Field     ;
                ToolTipML=[ENU=Specifies the vendor's giro account.;
                           SVE=Anger leverantîrens gironr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Giro Acc. No.";
                Visible=DKinfoEnable }

    { 41  ;1   ;Group     ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling;
                           SVE=Leverans och betalning];
                GroupType=Group }

    { 1906801201;2;Group  ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til;
                           SVE=Leverans];
                GroupType=Group }

    { 47  ;3   ;Field     ;
                CaptionML=[ENU=Address Code;
                           NOR=Adressekode;
                           SVE=Adresskod];
                ToolTipML=[ENU=Specifies the address on purchase orders shipped with a drop shipment directly from the vendor to a customer.;
                           NOR=Angir adressen pÜ bestillinger som ble levert direkte fra leverandõren til en kunde.;
                           SVE=Anger adressen pÜ inkîpsordrar som levereras med direktutleverans frÜn leverantîren till en kund.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=FALSE }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the company at the address to which the items in the purchase order were shipped.;
                           NOR=Angir navnet pÜ selskapet med adressen som varene i bestillingen ble levert til.;
                           SVE=Anger namnet pÜ fîretaget som finns pÜ adressen dit inkîpsorderns artiklar levererades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address that the items in the purchase order were shipped to.;
                           NOR=Angir adressen du vil at varene i bestillingen ble levert til.;
                           SVE=Anger adressen dit artiklarna pÜ inkîpsordern levererades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 44  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 58  ;3   ;Group     ;
                Visible=IsShipToCountyVisible;
                GroupType=Group }

    { 54  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 8   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 56  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the ship-to address.;
                           NOR=Angir lands- eller omrÜdekoden for lever til-adressen.;
                           SVE=Anger land eller region i leveransadressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 46  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person at the address that the items in the purchase order were shipped to.;
                           NOR=Angir navnet pÜ kontaktpersonen pÜ adressen som varene i bestillingen ble levert til.;
                           SVE=Anger namnet pÜ en kontaktperson pÜ adressen dit artiklarna pÜ inkîpsordern levererades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 43  ;2   ;Group     ;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til;
                           SVE=Betalas];
                GroupType=Group }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the vendor who you received the invoice from.;
                           NOR=Angir navnet pÜ leverandõren du har mottatt fakturaen fra.;
                           SVE=Anger namnet pÜ leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor that you received the invoice from.;
                           NOR=Angir adressen til leverandõren som du har mottatt fakturaen fra.;
                           SVE=Anger adressen till leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional;
                Editable=FALSE }

    { 60  ;3   ;Group     ;
                Visible=IsPayToCountyVisible;
                GroupType=Group }

    { 62  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to County";
                Importance=Additional;
                Editable=FALSE }

    { 78  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 64  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the ship-to address.;
                           NOR=Angir lands- eller omrÜdekoden for lever til-adressen.;
                           SVE=Anger land eller region i leveransadressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Country/Region Code";
                Importance=Additional;
                Editable=FALSE }

    { 102 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the contact you received the invoice from.;
                           NOR=Angir nummeret pÜ kontakten som du mottok fakturaen fra.;
                           SVE=Anger numret pÜ kontakten som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person you should contact at the vendor who you received the invoice from.;
                           NOR=Angir navnet pÜ kontaktperson hos leverandõren som du mottok fakturaen fra.;
                           SVE=Anger namnet pÜ kontaktpersonen hos leverantîren som du mottog fakturan frÜn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Editable=FALSE }

    { 1090000;2;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Message Type";
                Visible=FIinfoEnable;
                Editable=FALSE }

    { 1090002;2;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Invoice Message";
                Visible=FIinfoEnable;
                Editable=FALSE }

    { 1210190004;2;Field  ;
                SourceExpr="Interest Date";
                Visible="Interest DateVisible";
                Editable=FALSE }

    { 1100525002;2;Field  ;
                SourceExpr="Journal Template";
                Editable=FALSE }

    { 1100525004;2;Field  ;
                SourceExpr="Reason Code";
                Editable=FALSE }

    { 1100285102;2;Field  ;
                SourceExpr=KID;
                Visible=NORlocalizationEnable }

    { 1100285100;2;Field  ;
                SourceExpr="Export to Symbrio";
                Importance=Additional }

    { 1100285101;2;Field  ;
                SourceExpr="Export to Symbrio Type";
                Importance=Additional }

    { 1100529401;2;Field  ;
                CaptionML=[ENU=Destination;
                           SVE=Destination];
                SourceExpr=PurchInvHeaderExtension.Destination;
                Editable=FALSE }

    { 1100529400;2;Field  ;
                SourceExpr="Transport Method";
                Editable=FALSE }

    { 1100485022;2;Field  ;
                SourceExpr="Company VAT Registration No.";
                Editable=FALSE }

    { 1100485020;2;Field  ;
                SourceExpr="VAT Registration No.";
                Editable=FALSE }

    { 1100485017;2;Field  ;
                SourceExpr="Country/Region of Origin";
                Editable=FALSE }

    { 1100485016;2;Field  ;
                SourceExpr="Country/Region of Destination";
                Editable=FALSE }

    { 1905403901;1;Group  ;
                CaptionML=[ENU=Subcontracting;
                           SVE=Underentreprenad] }

    { 1000000000;2;Field  ;
                SourceExpr="Payment Agreement";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Actual Effective Date";
                Editable=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Actual End Date";
                Editable=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Number of Hours";
                Editable=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Avg. Wage Rate";
                Editable=FALSE }

    { 1000000010;2;Field  ;
                SourceExpr="Labor Amount";
                Editable=FALSE }

    { 1210190011;2;Field  ;
                SourceExpr="Contribution Percentage Labor";
                Editable=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="Contribution Percentage Total";
                Editable=FALSE }

    { 1100528200;2;Field  ;
                SourceExpr="Fixed B Amount per Hour";
                Editable=FALSE }

    { 1100485004;2;Field  ;
                CaptionML=[ENU=WKA Data present;
                           SVE=WKA-data finns];
                SourceExpr=gWKAPresent;
                Editable=FALSE }

    { 1000000022;2;Field  ;
                SourceExpr="Pay To Tax Authority";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000014;2;Field  ;
                SourceExpr="Wage Charge (to B Account)";
                Editable=FALSE }

    { 1000000016;2;Field  ;
                SourceExpr="Wage Charge (to Tax Authority)";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000018;2;Field  ;
                SourceExpr="Nat.Ins.Contr.";
                Editable=FALSE }

    { 1100529600;2;Field  ;
                SourceExpr="Pay VAT Amt. on B-Acc. Vendor";
                Editable=FALSE }

    { 1000000020;2;Field  ;
                SourceExpr=Text;
                Editable=FALSE;
                MultiLine=Yes }

    { 1903447101;1;Group  ;
                CaptionML=[ENU=DMS;
                           SVE=DMS] }

    { 1210190013;2;Field  ;
                SourceExpr="DMS Status" }

    { 1210190015;2;Field  ;
                SourceExpr="DMS Status Text" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1901275107;1;Part   ;
                Name=Attached Documents;
                CaptionML=[ENU=Attachments;
                           NOR=Vedlegg;
                           SVE=Bilagor];
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(122),
                            No.=FIELD(No.);
                PagePartID=Page1174;
                PartType=Page }

    { 1100528206;1;Part   ;
                Name=CaptureUI;
                CaptionML=[ENU=DC Document;
                           SVE=DC Dokument];
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11126596;
                Visible=FALSE }

    { 9   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190001;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130207;
                PartType=Page }

    { 1100528416;1;Part   ;
                SubPageLink=Table ID=CONST(122),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100528415;1;Part   ;
                SubPageLink=Table ID=CONST(122),
                            Document No.=FIELD(No.);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1100528414;1;Part   ;
                Name=WorkflowStatus;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

    { 1100528500;1;Part   ;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page9104;
                Visible=FALSE;
                PartType=Page }

    { 1100527450;1;Part   ;
                SubPageLink=Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page11129725;
                ProviderID=52;
                Visible=FALSE;
                PartType=Page }

    { 1100528101;1;Part   ;
                Name=DocumentViewerDocument;
                CaptionML=ENU=Document Viewer Documents;
                PagePartID=Page11129746;
                Visible=FALSE;
                PartType=Page }

    { 1100528100;1;Part   ;
                Name=DocumentViewer;
                CaptionML=ENU=Document Viewer;
                SubPageLink=Source Type=FIELD(Source Type),
                            No.=FIELD(No.),
                            Description=FIELD(Description);
                PagePartID=Page11129745;
                ProviderID=1100528101;
                Visible=FALSE;
                PartType=Page }

  }
  CODE
  {
    VAR
      PurchInvHeader@1000 : Record 122;
      ApplicationAreaMgmtFacade@1001 : Codeunit 9179;
      FormatAddress@1008 : Codeunit 365;
      PurchSetup@1100485001 : Record 312;
      PurchInvHeaderExtension@1100529400 : Record 11229338;
      HasIncomingDocument@1002 : Boolean;
      IsOfficeAddin@1003 : Boolean;
      IsFoundationEnabled@1004 : Boolean;
      IsBuyFromCountyVisible@1007 : Boolean;
      IsPayToCountyVisible@1006 : Boolean;
      IsShipToCountyVisible@1005 : Boolean;
      gFromReference@1210190000 : Boolean;
      gInvLineNo@1210190001 : Integer;
      gWKAPresent@1100485000 : Boolean;
      DPA_IsHardFilter@1100000999 : Boolean;
      "Interest DateVisible"@19029017 : Boolean INDATASET;
      "Ext. Document IDVisible"@19068947 : Boolean INDATASET;
      "Ext. Document IDEditable"@19001168 : Boolean INDATASET;
      OpenApprovalEntriesExist@1100528404 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1100528403 : Boolean;
      ApprovalManagement4PSConstr@1100528402 : Codeunit 11125349;
      ShowWorkflowStatus@1100528401 : Boolean;
      DocMgt@1100525000 : Codeunit 6085578;
      CorrectInvoiceVisible@1100528400 : Boolean INDATASET;
      CancelInvoiceVisible@1100528405 : Boolean INDATASET;
      GLSetup@111285700 : Record 98;
      DKinfoEnable@11128570 : Boolean INDATASET;
      FIinfoEnable@11128200 : Boolean INDATASET;
      NORlocalizationEnable@11128201 : Boolean INDATASET;
      "*** ExFlow ***"@12013588 : Integer;
      ExFlow@12013589 : Codeunit 12013601;
      CanCancelApprovalForRecord@1100527300 : Boolean;

    LOCAL PROCEDURE ActivateFields@6();
    BEGIN
      IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
      IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
      IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
    END;

    PROCEDURE InitSelectionFromReference@1210190002(IInvLineNo@1210190000 : Integer);
    BEGIN
      //**4PS.n
      gFromReference := TRUE;
      gInvLineNo := IInvLineNo;
    END;

    PROCEDURE ShowICFInvoiceLines@1210190000();
    VAR
      ICFLineRec@1210190000 : Record 11012327;
    BEGIN
      //**4PS
      ICFLineRec.RESET;
      ICFLineRec.SETRANGE(Vendor, "Pay-to Vendor No.");
      ICFLineRec.SETRANGE("Invoice No.", "Pre-Assigned No.");
      IF ICFLineRec.FIND('-') THEN
        PAGE.RUNMODAL(PAGE::"ICF Invoices", ICFLineRec);
    END;

    PROCEDURE CheckWKAData@1100485001();
    VAR
      lVendLedgEntryRec@1100485000 : Record 25;
      lvTmpDummyErrorRec@1100485002 : TEMPORARY Record 11012052;
      lvWKACalcCU@1100485001 : Codeunit 11012020;
    BEGIN
      //**4PS
      gWKAPresent := FALSE;
      IF NOT "Subcontracting Invoice" THEN
        EXIT;

      lVendLedgEntryRec."Vendor No." := "Buy-from Vendor No.";
      lVendLedgEntryRec."Subcontracting Invoice" := "Subcontracting Invoice";
      lVendLedgEntryRec."Payment Agreement" := "Payment Agreement";
      lVendLedgEntryRec."Actual Effective Date" := "Actual Effective Date";
      lVendLedgEntryRec."Actual End Date" := "Actual End Date";
      lVendLedgEntryRec."Number of Hours" := "Number of Hours";
      lVendLedgEntryRec."Avg. Wage Rate" := "Avg. Wage Rate";
      lVendLedgEntryRec."Labor Amount" := "Labor Amount";
      lVendLedgEntryRec."Contribution Percentage Labor" := "Contribution Percentage Labor";
      lVendLedgEntryRec."Contribution Percentage Total" := "Contribution Percentage Total";
      lVendLedgEntryRec."Fixed B Amount per Hour" := "Fixed B Amount per Hour";
      lVendLedgEntryRec."Pay To Tax Authority" := "Pay To Tax Authority";
      lVendLedgEntryRec."Wage Charge (to B Account)" := "Wage Charge (to B Account)";
      lVendLedgEntryRec."Wage Charge (to Tax Authority)" := "Wage Charge (to Tax Authority)";
      lVendLedgEntryRec."Nat.Ins.Contr." := "Nat.Ins.Contr.";
      lVendLedgEntryRec."Transaction Mode B Payments" := "Transaction Mode B Payments";
      lVendLedgEntryRec."Bank Account Code B Payments" := "Bank Account Code B Payments";
      lVendLedgEntryRec.Approved := "Invoice Approved";
      lVendLedgEntryRec."Approvement Initials" := "Approvement Initials";
      lVendLedgEntryRec."Document Type" := lVendLedgEntryRec."Document Type"::Invoice;

      gWKAPresent := lvWKACalcCU.CheckExternal(lVendLedgEntryRec, lvTmpDummyErrorRec);
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      //**4PS
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID); //**4PS.n
    END;

    LOCAL PROCEDURE FillDocumentViewerFactbox@1100528100();
    VAR
      DocumentLinkManagement@1100528100 : Codeunit 11012401;
      DocumentProperties@1100528101 : Record 11012746;
      DocumentAttachmentMgt@1100528102 : Codeunit 6085602;
      TempDocument@1100528103 : Record 6085756;
      EmptyRecID@1100528104 : RecordID;
      DocumentViewerTempDoc@1100528105 : Record 11072460;
    BEGIN
      CurrPage.DocumentViewerDocument.PAGE.ResetPage;
      DocumentLinkManagement.GetDocuments(DocumentProperties, RECORDID.GETRECORD);
      DocumentProperties.MARKEDONLY(TRUE);
      CurrPage.DocumentViewerDocument.PAGE.SetExternal4PSDocuments(DocumentProperties);

      CASE PurchSetup."Scanning Application Purch.Inv" OF
        PurchSetup."Scanning Application Purch.Inv"::"Document Capture":
          BEGIN
            DocumentAttachmentMgt.CreateTempDocumentList(TempDocument, EmptyRecID, DATABASE::"Purch. Inv. Header", 0, "No.", 0, TRUE);
            CurrPage.DocumentViewerDocument.PAGE.SetDocumentCaptureDocuments(TempDocument);
            IF "Ext. Document ID" <> '' THEN BEGIN
              CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::DocumentCapture, "Ext. Document ID");
            END ELSE
              CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::DocumentCapture, '');
          END;
        PurchSetup."Scanning Application Purch.Inv"::Whitevision:
          BEGIN
            CurrPage.DocumentViewerDocument.PAGE.SetWhiteVisionDocumentUsingPurchInvHeader(Rec);
            CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::WhiteVision, '');
          END;
      END;

      CurrPage.DocumentViewer.PAGE.SetEmailSubject("No.");
    END;

    BEGIN
    {
      4PS 24-09-2009 PS, Approval removed
      <DC>
        Document Capture, Removed by 4PS
      </DC>
      4PS 20-09-16 UKR-C27159 VAKAT: BI032 checkbox Back-to-back - Added field
      4PS 30-03-18 DP01917 OLKOL: Action Approve changed
      --- ExFlow --->
      Field General : Approve
      Action        : Show Document (Code)
      Action        : Attached Files (Code)
      Globals
      <-- ExFlow ---

      PEB *** Begin ***
      PEB0012 "Note of Goods" field added
      PEB
        New field on Page
        General:
         - Note of Goods
      PEB *** End ***
      160817 ITERO.DL RFC125 new fields, KID
      160909 ITERO.DL RFC136 view attached documents (from Symbrio) if no doc then print report
      190524 ORANGO.SB Support #24434 Added Page OLDConsent Line List
    }
    END.
  }
}

