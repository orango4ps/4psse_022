OBJECT Page 2196 O365 Link to Financials
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=O365 Link to Financials;
               NOR=Kobling til Financials i O365;
               SVE=O365 L„nk till Financials];
    PageType=CardPart;
    OnInit=BEGIN
             Initialize;
           END;

  }
  CONTROLS
  {
    { 1   ;    ;Container ;
                ContainerType=ContentArea }

    { 4   ;1   ;Field     ;
                Name=TryOutLbl;
                CaptionML=[ENU=Thanks for choosing to explore Dynamics 365 Business Central!;
                           NOR=Takk for at du pr›ver Dynamics 365 Business Central!;
                           SVE=Tack f”r att du valde att utforska Dynamics 365 Business Central!];
                ToolTipML=[ENU=Specifies thanks for choosing to explore Dynamics 365 Business Central!;
                           NOR=Angir takketeksten for at man pr›ver Dynamics 365 Business Central!;
                           SVE=Anger ett tack f”r att du valde att utforska Dynamics 365 Business Central!];
                ApplicationArea=#Invoicing;
                Visible=ShowLabel;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 2   ;1   ;Field     ;
                Name=LinkToFinancials;
                ApplicationArea=#Invoicing;
                SourceExpr=TryD365FinancialsLbl;
                Visible=ShowLabel;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              O365SetupMgmt.ChangeToEvaluationCompany;
                            END;

                ShowCaption=No }

  }
  CODE
  {
    VAR
      IdentityManagement@1001 : Codeunit 9801;
      TryD365FinancialsLbl@1004 : TextConst 'ENU=Click here to try out the evaluation company in Dynamics 365 Business Central.;NOR=Klikk her for † pr›ve evalueringsselskapet i Dynamics 365 Business Central.;SVE=Klicka h„r om du vill att testa demof”retaget i Dynamics 365 Business Central.';
      O365SetupMgmt@1002 : Codeunit 2315;
      ShowLabel@1000 : Boolean;

    LOCAL PROCEDURE Initialize@6();
    VAR
      PermissionManager@1000 : Codeunit 9002;
      ApplicationAreaMgmt@1004 : Codeunit 9178;
      IsFinApp@1003 : Boolean;
      IsSaas@1001 : Boolean;
      IsInvAppAreaSet@1002 : Boolean;
    BEGIN
      IsFinApp := IdentityManagement.IsFinAppId;
      IsSaas := PermissionManager.SoftwareAsAService;
      IsInvAppAreaSet := ApplicationAreaMgmt.IsInvoicingOnlyEnabled;

      ShowLabel := IsFinApp AND IsSaas AND IsInvAppAreaSet;
    END;

    BEGIN
    END.
  }
}

