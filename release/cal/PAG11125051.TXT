OBJECT Page 11125051 Contact Card Contact Person
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00 (5050);
  }
  PROPERTIES
  {
    Permissions=TableData 23=r;
    CaptionML=[ENU=Contact Card Contact Person;
               NOR=Kontaktkort kontaktperson;
               SVE=Kontaktkort kontaktperson];
    InsertAllowed=No;
    SourceTable=Table5050;
    SourceTableView=WHERE(Type=CONST(Person),
                          Company No.=FILTER(<>''));
    PageType=ListPlus;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Mail Documents;
                                NOR=Ny,Behandle,Rapport,Send dokument;
                                SVE=Ny,Behandla,Rapport,Maila dokument];
    OnInit=BEGIN
             FeatureSFVisible := TRUE;
             MapPointVisible := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000 : Codeunit 802;
                 CRMIntegrationManagement@1001 : Codeunit 5330;
               BEGIN
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;

                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;

                 IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(FeatureRec) THEN
                   FeatureSFVisible := FALSE;

                 CreateInOutLookVisible := CURRENTCLIENTTYPE = CLIENTTYPE::Windows;
               END;

    OnClosePage=BEGIN
                  CheckDataPresent(xRec);
                END;

    OnAfterGetRecord=BEGIN
                       IF (xRec."No." <> '') AND ("No." <> xRec."No.") THEN
                         CheckDataPresent(xRec);

                       ContactPersonCompanyName := GetContactPersonCompanyName;
                     END;

    OnNewRecord=VAR
                  Contact@1100525001 : Record 5050;
                BEGIN
                  Type := Type::Person;
                  //RU12
                  IF GETFILTER("Company No.") <> '' THEN BEGIN
                    "Company No." := GETRANGEMAX("Company No.");
                    Contact.GET("Company No.");
                    InheritCompanyToPersonData(Contact,TRUE);
                  END;
                  //
                END;

    OnInsertRecord=BEGIN
                     InsertingIsAllowed(TRUE);
                   END;

    OnDeleteRecord=BEGIN
                     DeletingIsAllowed(TRUE);

                     CheckBusinessRelations;
                   END;

    OnAfterGetCurrRecord=VAR
                           CRMCouplingManagement@1001 : Codeunit 5331;
                         BEGIN
                           xRec := Rec;
                           EnableFields;
                           EnableDisableFeatureSF;

                           IF CRMIntegrationEnabled THEN
                             CRMIsCoupledToRecord := CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);

                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(DocumentsByCompany);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode('');
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 76      ;1   ;ActionGroup;
                      CaptionML=[ENU=C&ontact;
                                 NOR=K&ontakt;
                                 SVE=K&ontakt];
                      Image=ContactPerson }
      { 1210190014;2 ;Action    ;
                      CaptionML=[ENU=Profile;
                                 NOR=Profil;
                                 SVE=Profil];
                      RunObject=Page 5051;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=Answers;
                      OnAction=BEGIN
                                 //**4PS
                               END;
                                }
      { 1210190010;2 ;Action    ;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter;
                                 SVE=Dokument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1100527000 : RecordRef;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 ShowDocs(RecRef);
                               END;
                                }
      { 1100525005;2 ;ActionGroup;
                      CaptionML=[ENU=C&ontact;
                                 NOR=K&ontakt;
                                 SVE=K&ontakt];
                      Image=ContactPerson }
      { 1100528739;3 ;Action    ;
                      CaptionML=[ENU=Person;
                                 NOR=Person;
                                 SVE=Person];
                      Image=User;
                      OnAction=VAR
                                 Contact@1100528700 : Record 5050;
                               BEGIN
                                 IF "Person No." <> '' THEN BEGIN
                                   Contact.GET("Person No.");
                                   PAGE.RUNMODAL(PAGE::"Contact Card Person", Contact);
                                 END;
                               END;
                                }
      { 1100528735;3 ;Action    ;
                      CaptionML=[ENU=Company;
                                 NOR=Selskap;
                                 SVE=F”retag];
                      Image=Company;
                      OnAction=VAR
                                 Contact@1100528700 : Record 5050;
                               BEGIN
                                 IF "Company No." <> '' THEN BEGIN
                                   Contact.GET("Company No.");
                                   PAGE.RUNMODAL(PAGE::"Contact Card Company", Contact);
                                 END;
                               END;
                                }
      { 80      ;2   ;ActionGroup;
                      CaptionML=[ENU=P&erson;
                                 NOR=P&erson;
                                 SVE=P&erson];
                      Image=User }
      { 85      ;3   ;Action    ;
                      CaptionML=[ENU=Business Relations;
                                 NOR=Forretningsforbindelser;
                                 SVE=Aff„rsrelationer];
                      RunObject=Page 5061;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=BusinessRelation }
      { 81      ;3   ;Action    ;
                      CaptionML=[ENU=Job Responsibilities;
                                 NOR=Jobbansvar;
                                 SVE=Arbetsansvar];
                      Image=Job;
                      OnAction=VAR
                                 ContJobResp@1001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 ContJobResp."Contact No." := "No.";//Make sure that Contact No. is always filled.//**4PS.n
                                 PAGE.RUNMODAL(PAGE::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 87      ;2   ;Action    ;
                      CaptionML=[ENU=Pro&files;
                                 NOR=&Profiler;
                                 SVE=&Profiler];
                      Image=Answers;
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 89      ;2   ;Action    ;
                      CaptionML=[ENU=&Picture;
                                 NOR=&Bilde;
                                 SVE=&Bild];
                      RunObject=Page 5104;
                      RunPageLink=No.=FIELD(No.);
                      Image=Picture }
      { 90      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 5072;
                      RunPageLink=Table Name=CONST(Contact),
                                  No.=FIELD(No.),
                                  Sub No.=CONST(0);
                      Image=ViewComments }
      { 91      ;2   ;ActionGroup;
                      CaptionML=[ENU=Alternati&ve Address;
                                 NOR=Alternati&v adresse;
                                 SVE=Alternati&v adress];
                      Image=Addresses }
      { 92      ;3   ;Action    ;
                      CaptionML=[ENU=List;
                                 NOR=Liste;
                                 SVE=Lista];
                      RunObject=Page 5057;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 93      ;3   ;Action    ;
                      CaptionML=[ENU=Date Ranges;
                                 NOR=Datointervall;
                                 SVE=Datumintervall];
                      RunObject=Page 5059;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DateRange }
      { 23      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 NOR=Dynamics CRM;
                                 SVE=Dynamics 365 for Sales];
                      Visible=CRMIntegrationEnabled;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '') }
      { 21      ;2   ;Action    ;
                      Name=CRMGotoContact;
                      CaptionML=[ENU=Contact;
                                 NOR=Kontakt;
                                 SVE=Kontakt];
                      ToolTipML=ENU=Open the coupled Microsoft Dynamics CRM contact.;
                      Image=CoupledContactPerson;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Synchronize Now;
                                 NOR=Synkroniser n†;
                                 SVE=Synkronisera];
                      ToolTipML=[ENU=Send or get updated data to or from Microsoft Dynamics CRM.;
                                 NOR=Send eller motta oppdaterte data til eller fra Microsoft Dynamics CRM.;
                                 SVE=Skicka eller h„mta uppdaterade data till eller fr†n Dynamics 365 for Sales.];
                      Image=Refresh;
                      OnAction=VAR
                                 CRMIntegrationManagement@1001 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.UpdateOneNow(RECORDID);
                               END;
                                }
      { 27      ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling;
                                 NOR=Kobling;
                                 SVE=Koppling];
                      ToolTipML=[ENU=Create, change, or delete a coupling between the Microsoft Dynamics NAV record and a Microsoft Dynamics CRM record.;
                                 NOR=Opprett, endre eller slett en kobling mellom Microsoft Dynamics NAV-posten og en Microsoft Dynamics CRM-post.;
                                 SVE=Skapa, „ndra eller ta bort en koppling mellan Microsoft Dynamics NAV-posten och en Dynamics 365 for Sales-post.];
                      Image=LinkAccount }
      { 25      ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Set Up Coupling;
                                 NOR=Konfigurer kobling;
                                 SVE=Kopplingsinst„llning];
                      ToolTipML=[ENU=Create or modify the coupling to a Microsoft Dynamics CRM contact.;
                                 NOR=Opprett eller endre koblingen til en Microsoft Dynamics CRM-kontakt.;
                                 SVE=Skapa eller „ndra kopplingen till en Dynamics 365 for Sales-kontakt.];
                      Image=LinkAccount;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.DefineCoupling(RECORDID);
                               END;
                                }
      { 19      ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Delete Coupling;
                                 NOR=Slett kobling;
                                 SVE=Ta bort koppling];
                      ToolTipML=[ENU=Delete the coupling to a Microsoft Dynamics CRM contact.;
                                 NOR=Slett koblingen til en Microsoft Dynamics CRM-kontakt.;
                                 SVE=Ta bort kopplingen till en Dynamics 365 for Sales-kontakt.];
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit 5331;
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon;
                                 SVE=Relaterad information];
                      Image=Users }
      { 100     ;2   ;Action    ;
                      CaptionML=[ENU=Segmen&ts;
                                 NOR=Segme&nter;
                                 SVE=Segmen&t];
                      RunObject=Page 11072092;
                      RunPageView=SORTING(Contact No.,Segment No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 86      ;2   ;Action    ;
                      CaptionML=[ENU=Mailing &Groups;
                                 NOR=Mailing&grupper;
                                 SVE=Utskicks&grupper];
                      RunObject=Page 5064;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DistributionGroup }
      { 99      ;2   ;Action    ;
                      CaptionML=[ENU=C&ust./Vendor/Bank Acc./Emplr/Empl.;
                                 NOR=K&unde/Leverand›r/Bankkonto/Arbeidsgiver/Ansatte;
                                 SVE=&Kund/Leverant”r/Bankkonto];
                      Image=ContactReference;
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Online Map;
                                 NOR=Online Map;
                                 SVE=Online Map];
                      Image=Map;
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 1210190007;2 ;Action    ;
                      CaptionML=[ENU=Salespersons;
                                 NOR=Selgere;
                                 SVE=S„ljare];
                      RunObject=Page 11012769;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=SalesPerson;
                      OnAction=BEGIN
                                 //**4PS
                               END;
                                }
      { 11012016;2   ;Action    ;
                      CaptionML=[ENU=&Features;
                                 NOR=&Funksjoner;
                                 SVE=&Funktioner];
                      Image=BulletList;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowFeatures;
                               END;
                                }
      { 1210190021;2 ;Action    ;
                      CaptionML=[ENU=V&essels;
                                 NOR=F&art›yer;
                                 SVE=F&artyg];
                      RunObject=Page 11125239;
                      RunPageLink=Owner=FIELD(No.);
                      Image=WorkCenter;
                      OnAction=BEGIN
                                 //**4PS
                               END;
                                }
      { 7       ;1   ;ActionGroup;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver;
                                 SVE=Uppgifter];
                      Image=Task }
      { 1100528801;2 ;Action    ;
                      CaptionML=[ENU=Create To-do;
                                 NOR=Opprett gj›rem†l;
                                 SVE=Skapa Uppgift];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewToDo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Todo@1100528802 : Record 5080;
                                 TempTodo@1100528803 : TEMPORARY Record 5080;
                               BEGIN
                                 Todo.SETRANGE("Contact No.", "No.");
                                 Todo.SETRANGE(Todo."Contact Company No.", "Company No.");
                                 TempTodo.CreateTaskFromTask(Todo);
                               END;
                                }
      { 96      ;2   ;Action    ;
                      CaptionML=[ENU=T&o-dos;
                                 NOR=&Oppgaver;
                                 SVE=U&ppgifter];
                      RunObject=Page 5096;
                      RunPageView=SORTING(Contact Company No.,Date,Contact No.,Closed);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  System To-do Type=FILTER(Contact Attendee);
                      Image=TaskList }
      { 3       ;2   ;Action    ;
                      CaptionML=[ENU=Oppo&rtunities;
                                 NOR=Sa&lgsmuligheter;
                                 SVE=Aff„&rsm”jligheter];
                      Visible=FALSE;
                      Image=OpportunityList;
                      OnAction=BEGIN
                                 //RTC Postponed Page 11072071
                               END;
                                }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter;
                                 SVE=Dokument];
                      Image=Documents }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=Sales &Quotes;
                                 NOR=Salgs&tilbud;
                                 SVE=F”rs„ljnings&offerter];
                      RunObject=Page 9300;
                      RunPageView=SORTING(Document Type,Sell-to Contact No.);
                      RunPageLink=Sell-to Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Process }
      { 11012001;2   ;Action    ;
                      CaptionML=[ENU=&Try-outs;
                                 NOR=&Prospekter;
                                 SVE=&Anbud];
                      Image=Document;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowTryouts;
                               END;
                                }
      { 11012015;2   ;Action    ;
                      CaptionML=[ENU=Try-out &Quotes;
                                 NOR=T&ilbudsforesp›rsler;
                                 SVE=A&nbudsf”rfr†gningar];
                      Image=Quote;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowTryoutQuotes;
                               END;
                                }
      { 1100485009;1 ;ActionGroup;
                      CaptionML=[ENU=Consolidate Data;
                                 NOR=Konsolider data;
                                 SVE=Konsolidera data] }
      { 1100485010;2 ;Action    ;
                      CaptionML=[ENU=Try-outs;
                                 NOR=Prospekter;
                                 SVE=Anbud];
                      Image=Document;
                      OnAction=BEGIN
                                 //**4PS
                                 ConsolidatedContactData.ShowTryOut(Rec);
                               END;
                                }
      { 1100485024;2 ;Action    ;
                      CaptionML=[ENU=Try-out Quotes;
                                 NOR=Tilbudsforesp›rsler;
                                 SVE=Anbudsf”rfr†gningar];
                      Image=Quote;
                      OnAction=BEGIN
                                 //**4PS
                                 ConsolidatedContactData.ShowTryOutQuotes(Rec);
                               END;
                                }
      { 1100485018;2 ;Action    ;
                      CaptionML=[ENU=Estimates;
                                 NOR=Kalkyler;
                                 SVE=Kalkyler];
                      Image=Calculate;
                      OnAction=BEGIN
                                 //**4PS
                                 ConsolidatedContactData.ShowEstimates(Rec);
                               END;
                                }
      { 1100485019;2 ;Action    ;
                      CaptionML=[ENU=Projects;
                                 NOR=Prosjekt;
                                 SVE=Projekt];
                      Image=Job;
                      OnAction=BEGIN
                                 //**4PS
                                 ConsolidatedContactData.ShowProjects(Rec);
                               END;
                                }
      { 1100485013;2 ;Action    ;
                      CaptionML=[ENU=Contact Relations;
                                 NOR=Kontaktrelasjoner;
                                 SVE=Kontaktrelationer];
                      Image=CustomerContact;
                      OnAction=BEGIN
                                 //**4PS
                                 ConsolidatedContactData.ShowCustomerandVendor(Rec);
                               END;
                                }
      { 1100485011;2 ;Action    ;
                      CaptionML=[ENU=Interaction Log Entries;
                                 NOR=Interaksjonslogg Transaksjoner;
                                 SVE=Interaktionslogg];
                      Image=InteractionLog;
                      OnAction=BEGIN
                                 //**4PS
                                 ConsolidatedContactData.ShowInteractEntries(Rec);
                               END;
                                }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=History;
                                 NOR=Historikk;
                                 SVE=Historik];
                      Image=History }
      { 149     ;2   ;Action    ;
                      CaptionML=[ENU=Postponed &Interactions;
                                 NOR=Utsatte &interaksjoner;
                                 SVE=Senarelagda &interaktioner];
                      RunObject=Page 5082;
                      RunPageView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=PostponedInteractions }
      { 95      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 NOR=Transaksjoner &Interaksjonslogg;
                                 SVE=&Interaktionslogg];
                      RunObject=Page 11072053;
                      RunPageView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=InteractionLog }
      { 88      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      RunObject=Page 5053;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 75      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=Fu&nksjon;
                                 SVE=Fu&nktion];
                      Image=Action }
      { 102     ;2   ;Action    ;
                      CaptionML=[ENU=Launch &Web Source;
                                 NOR=Last &webadresse;
                                 SVE=Starta &webbadress];
                      Image=LaunchWeb;
                      OnAction=VAR
                                 ContactWebSource@1001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF PAGE.RUNMODAL(PAGE::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 103     ;2   ;Action    ;
                      CaptionML=[ENU=Print Cover &Sheet;
                                 NOR=Skriv ut &Omslagsark;
                                 SVE=Skriv ut &f”rs„ttsblad];
                      Image=PrintCover;
                      OnAction=BEGIN
                                 PrintDoc.PrintRelation(Rec);
                               END;
                                }
      { 105     ;2   ;ActionGroup;
                      CaptionML=[ENU=Create as;
                                 NOR=Opprett som;
                                 SVE=Skapa som];
                      Image=CustomerContact }
      { 106     ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 NOR=Kundens finansielle status;
                                 SVE=Kund];
                      Image=Customer;
                      OnAction=BEGIN
                                 //**4PS.sn
                                 InsertingCustomerIsAllowed(TRUE);
                                 TESTFIELD(Blocked, FALSE);
                                 SelectTemplAndCreateCustomer;
                                 //**4PS.en
                               END;
                                }
      { 107     ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverand›r;
                                 SVE=Leverant”r];
                      Image=Vendor;
                      OnAction=BEGIN
                                 //**4PS.sn
                                 InsertingVendorIsAllowed(TRUE);
                                 //SelectTemplAndCreateVendor;  //C015345.o
                                 CreateVendor; //C015345.n
                                 //**4PS.en
                               END;
                                }
      { 109     ;2   ;ActionGroup;
                      CaptionML=[ENU=Link with existing;
                                 NOR=Knytt til eksisterende;
                                 SVE=L„nka med befintlig];
                      Image=Links }
      { 110     ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 NOR=Kundens finansielle status;
                                 SVE=Kund];
                      Image=Customer;
                      OnAction=BEGIN
                                 //**4PS.sn
                                 InsertingCustomerIsAllowed(TRUE);
                                 //**4PS.en
                                 CreateCustomerLink;
                               END;
                                }
      { 111     ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverand›r;
                                 SVE=Leverant”r];
                      Image=Vendor;
                      OnAction=BEGIN
                                 //**4PS.sn
                                 InsertingVendorIsAllowed(TRUE);
                                 //**4PS.en
                                 CreateVendorLink;
                               END;
                                }
      { 153     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Template;
                                 NOR=Koble mal;
                                 SVE=Koppla mall];
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ConfigTemplateMgt@1000 : Codeunit 8612;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 ConfigTemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 11012014;2   ;Action    ;
                      CaptionML=[ENU=Create in &Outlook;
                                 NOR=Opprett i &Outlook;
                                 SVE=Skapa i &Outlook];
                      Visible=CreateInOutLookVisible;
                      Image=ExportContact;
                      OnAction=VAR
                                 OutlookCu@1210190019 : Codeunit 11012751;
                               BEGIN
                                 //**4PS
                                 OutlookCu.CreateProspect(Rec);
                               END;
                                }
      { 1210190009;2 ;Action    ;
                      CaptionML=[ENU=&Filter on Features;
                                 NOR=&Filter p† funksjoner;
                                 SVE=&Filter p† funktioner];
                      Promoted=Yes;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ContactFeature@1210190015 : Record 11012752;
                                 FilterOnContactFeature@1210190001 : Page 11012757;
                               BEGIN
                                 //**4PS
                                 FilterOnContactFeature.SetContactFilter(Rec);
                                 ContactFeature.SETRANGE(Contacts, TRUE);
                                 FilterOnContactFeature.SETTABLEVIEW(ContactFeature);
                                 FilterOnContactFeature.RUNMODAL;
                                 CLEAR(FilterOnContactFeature);
                               END;
                                }
      { 1210190037;2 ;Action    ;
                      CaptionML=[ENU=Move Documents;
                                 NOR=Flytt dokument;
                                 SVE=Flytta dokument];
                      ToolTipML=[ENU=Move documents to an other contact;
                                 NOR=Flytt dokumenter til en annen kontakt];
                      RunObject=Page 11012790;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(No.);
                      Image=Documents;
                      OnAction=BEGIN
                                 //**4PS
                               END;
                                }
      { 1100485000;2 ;Action    ;
                      CaptionML=[ENU=Adopt Local Address Changes;
                                 NOR=Adopter lokale adresseendringer;
                                 SVE=Anta lokala adress„ndringar];
                      RunObject=Page 11020266;
                      Image=EditJournal;
                      OnAction=BEGIN
                                 //**4PS
                               END;
                                }
      { 1100525010;2 ;Action    ;
                      ShortCutKey=Ctrl+K;
                      CaptionML=[ENU=Completeness Check;
                                 NOR=Fullstendighetskontroll;
                                 SVE=Fullst„ndighetskontroll];
                      Image=CheckList;
                      OnAction=VAR
                                 CheckRecordCompletion@1100525000 : Codeunit 11012252;
                                 RecRef@1100525001 : RecordRef;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 CheckRecordCompletion.ShowIncompleteFields(RecRef);
                               END;
                                }
      { 1100527000;2 ;Action    ;
                      CaptionML=[ENU=Create Try-Out;
                                 SVE=Skapa anbud];
                      Image=NewDocument;
                      OnAction=VAR
                                 Tryout@1100527001 : Record 11012750;
                                 TryoutLine@1100527000 : Record 11012755;
                               BEGIN
                                 Tryout.INSERT(TRUE);
                                 TryoutLine."Try-out No." := Tryout.Code;
                                 TryoutLine."Contact No." := "Company No.";
                                 TryoutLine."Contact Person No." := "No.";
                                 TryoutLine.INSERT(TRUE);
                                 PAGE.RUN(PAGE::"Try-out", Tryout);
                               END;
                                }
      { 1100525007;1 ;ActionGroup;
                      CaptionML=[ENU=Mail Documents;
                                 NOR=Send dokumenter;
                                 SVE=E-postdokument];
                      ActionContainerType=NewDocumentItems }
      { 1100525001;2 ;Action    ;
                      CaptionML=[ENU=E-Mail;
                                 NOR=E-Mail;
                                 SVE=E-post];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 //**4PS
                                 EditDocuments(TRUE, "E-Mail");
                               END;
                                }
      { 1100525003;2 ;Action    ;
                      CaptionML=[ENU=E-Mail 2;
                                 NOR=E-Mail 2;
                                 SVE=E-post 2];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 //**4PS
                                 EditDocuments(TRUE, "E-Mail 2");
                               END;
                                }
      { 77      ;1   ;Action    ;
                      AccessByPermission=TableData 11072030=R;
                      CaptionML=[ENU=Create &Interact;
                                 NOR=Opprette &Samhandling;
                                 SVE=Skapa &interaktion];
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1907415106;1 ;Action    ;
                      CaptionML=[ENU=Contact Cover Sheet;
                                 NOR=Kontaktmelding;
                                 SVE=Kontaktmeddelande];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 PrintDoc.PrintRelation(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generell;
                           SVE=Allm„nt] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Editable="No.Editable" }

    { 1100528702;2;Field  ;
                SourceExpr="Person No.";
                Importance=Promoted;
                Editable="Person No.Editable";
                OnValidate=BEGIN
                             TESTFIELD("Person No.");
                           END;
                            }

    { 1100528500;2;Field  ;
                SourceExpr="First Name";
                Editable=FALSE }

    { 1100285100;2;Field  ;
                SourceExpr=Surname }

    { 1210190017;2;Field  ;
                SourceExpr=Name;
                Editable=FALSE }

    { 1100525008;2;Field  ;
                SourceExpr=Gender;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Company No.";
                Importance=Promoted;
                Visible=FALSE;
                Editable=FALSE }

    { 1210190016;2;Field  ;
                CaptionML=[ENU=Company Name;
                           NOR=Navn p† selskap;
                           SVE=F”retagsnamn];
                SourceExpr=ContactPersonCompanyName;
                Editable=FALSE }

    { 1100528720;2;Field  ;
                SourceExpr=Address;
                Visible=FALSE;
                Editable=AddressEditable }

    { 1100528715;2;Field  ;
                SourceExpr="Address 2";
                Importance=Additional;
                Visible=FALSE;
                Editable="Address 2Editable" }

    { 1100528710;2;Field  ;
                SourceExpr="Post Code";
                Visible=FALSE;
                Editable="Post CodeEditable" }

    { 1100528708;2;Field  ;
                SourceExpr="Country/Region Code";
                Visible=FALSE;
                Editable="Country/Region CodeEditable" }

    { 1100528711;2;Field  ;
                SourceExpr=City;
                Visible=FALSE;
                Editable=CityEditable }

    { 1100528701;2;Field  ;
                SourceExpr="Territory Code";
                Visible=FALSE;
                Editable="Territory CodeEditable" }

    { 20  ;2   ;Field     ;
                SourceExpr="Search Name";
                Visible=FALSE;
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Editable="Salesperson CodeEditable";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 1100485023;2;Field  ;
                DrillDown=No;
                SourceExpr="Name Salesperson" }

    { 1100525011;2;Field  ;
                SourceExpr="Sales Representative Code";
                Visible=FALSE;
                Editable=SalesRepresentativeCodeEditabl;
                OnValidate=BEGIN
                             CALCFIELDS("Name Sales Representative");  //**4PS.n
                           END;
                            }

    { 1100525013;2;Field  ;
                DrillDown=No;
                SourceExpr="Name Sales Representative";
                Importance=Additional;
                Visible=FALSE }

    { 1100528716;2;Field  ;
                SourceExpr="Purchaser Code";
                Visible=FALSE;
                Editable="Purchaser CodeEditable";
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1100528718;2;Field  ;
                SourceExpr="Name Purchaser";
                Importance=Additional;
                Visible=FALSE }

    { 1100525000;2;Field  ;
                SourceExpr="Contact Type";
                Visible=FALSE;
                Editable="Contact TypeEditable" }

    { 1210190004;2;Field  ;
                SourceExpr="Job Title";
                Editable="Job TitleEditable" }

    { 1210190006;2;Field  ;
                SourceExpr="Job Title 2";
                Importance=Additional;
                Visible=FALSE;
                Editable="Job Title 2Editable" }

    { 1100528706;2;Field  ;
                SourceExpr=Department;
                Visible=FALSE;
                Editable=DepartmentEditable }

    { 58  ;2   ;Field     ;
                SourceExpr="Organizational Level Code";
                Visible=FALSE;
                Editable=OrganizationalLevelCodeEditabl }

    { 1100409003;2;Field  ;
                SourceExpr=Blocked;
                Importance=Additional;
                Editable=BlockedEditable }

    { 1100409002;2;Field  ;
                SourceExpr="Blocked at";
                Importance=Additional }

    { 1100409001;2;Field  ;
                SourceExpr="Blocked by";
                Importance=Additional }

    { 1100409000;2;Field  ;
                SourceExpr="Blocking Reason";
                Importance=Additional;
                Editable="Blocking ReasonEditable" }

    { 1100485007;1;Part   ;
                Name=FeatureSF;
                SubPageLink=Relation Type=FIELD(Type),
                            Code=FIELD(No.);
                PagePartID=Page11012138;
                Visible=FeatureSFVisible;
                Editable=FeatureSFEditable }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Communication;
                           NOR=Kommunikasjon;
                           SVE=Kommunikation] }

    { 1100409005;2;Field  ;
                SourceExpr="Phone No.";
                Editable="Phone No.Editable" }

    { 1100409004;2;Field  ;
                SourceExpr="Phone No. 2";
                Importance=Additional;
                Visible=FALSE;
                Editable="Phone No. 2Editable" }

    { 1210190011;2;Field  ;
                SourceExpr="Phone No. Work";
                Visible=FALSE;
                Editable="Phone No. WorkEditable" }

    { 1100485004;2;Field  ;
                SourceExpr="Extension No.";
                Visible=FALSE;
                Editable="Extension No.Editable" }

    { 1210190013;2;Field  ;
                SourceExpr="Phone No. Work 2";
                Importance=Additional;
                Visible=FALSE;
                Editable="Phone No. Work 2Editable" }

    { 36  ;2   ;Field     ;
                SourceExpr="Mobile Phone No.";
                Editable="Mobile Phone No.Editable" }

    { 1210190002;2;Field  ;
                SourceExpr="Mobile Phone No. 2";
                Importance=Additional;
                Visible=FALSE;
                Editable="Mobile Phone No. 2Editable" }

    { 38  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE;
                Editable="Fax No.Editable" }

    { 46  ;2   ;Field     ;
                SourceExpr="E-Mail";
                Editable="E-MailEditable" }

    { 1210190015;2;Field  ;
                SourceExpr="E-Mail 2";
                Visible=FALSE;
                Editable="E-Mail 2Editable" }

    { 1100525009;2;Field  ;
                SourceExpr="Home Page";
                Visible=FALSE }

    { 1100528704;2;Field  ;
                SourceExpr=Pager;
                Visible=FALSE;
                Editable=PagerEditable }

    { 130 ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE;
                Editable="Language CodeEditable" }

    { 128 ;2   ;Field     ;
                SourceExpr="Salutation Code";
                Editable="Salutation CodeEditable" }

    { 126 ;2   ;Field     ;
                SourceExpr="Correspondence Type";
                Visible=FALSE;
                Editable="Correspondence TypeEditable" }

    { 1101200000;2;Field  ;
                SourceExpr="Document Group";
                Visible=FALSE;
                Editable="Document GroupEditable" }

    { 60  ;2   ;Field     ;
                SourceExpr="Exclude from Segment";
                Importance=Additional;
                Visible=FALSE;
                Editable="Exclude from SegmentEditable" }

    { 1901902801;1;Group  ;
                CaptionML=[ENU=Visit Address;
                           NOR=Bes›ksadresse;
                           SVE=Bes”ksadress] }

    { 1100528731;2;Field  ;
                SourceExpr="Visit Address";
                Editable="Visit AddressEditable" }

    { 1100528729;2;Field  ;
                SourceExpr="Visit Address 2";
                Importance=Additional;
                Visible=FALSE;
                Editable="Visit Address 2Editable" }

    { 1100528727;2;Field  ;
                SourceExpr="Visit Address Post Code";
                Editable=VisitAddressPostCodeEditable }

    { 1100528725;2;Field  ;
                SourceExpr="Visit Address City";
                Editable="Visit Address CityEditable" }

    { 1100528722;2;Field  ;
                SourceExpr="Visit Address County";
                Importance=Additional;
                Visible=FALSE;
                Editable="Visit Address CountyEditable" }

    { 1100528714;2;Field  ;
                SourceExpr="Visit Address Country/Region";
                Editable=VisitAddressCountryRegionEdita }

    { 1905885001;1;Group  ;
                CaptionML=[ENU=Date;
                           NOR=Dato;
                           SVE=Datum];
                GroupType=Group }

    { 1000000042;2;Field  ;
                SourceExpr="Last Date Modified" }

    { 1000000046;2;Field  ;
                SourceExpr="Modified by" }

    { 1000000043;2;Field  ;
                SourceExpr="Date of Last Interaction";
                OnDrillDown=VAR
                              InteractionLogEntry@1100525001 : Record 11072027;
                            BEGIN
                              InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                              InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                              InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                              InteractionLogEntry.SETRANGE("Attempt Failed",FALSE);
                              IF InteractionLogEntry.FIND('+') THEN
                                PAGE.RUN(0,InteractionLogEntry);
                            END;
                             }

    { 1000000044;2;Field  ;
                SourceExpr="Last Date Attempted";
                OnDrillDown=VAR
                              InteractionLogEntry@1100525002 : Record 11072027;
                            BEGIN
                              InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                              InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                              InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                              InteractionLogEntry.SETRANGE("Initiated By",InteractionLogEntry."Initiated By"::Us);
                              IF InteractionLogEntry.FIND('+') THEN
                                PAGE.RUN(0,InteractionLogEntry);
                            END;
                             }

    { 1000000045;2;Field  ;
                SourceExpr="Next Task Date" }

    { 1905052801;1;Group  ;
                CaptionML=[ENU=Integration;
                           NOR=Integrasjon;
                           SVE=Integration];
                Visible=FALSE;
                GroupType=Group }

    { 1100525002;2;Field  ;
                SourceExpr="Login ID";
                Editable="Login IDEditable" }

    { 1100525004;2;Field  ;
                SourceExpr=Role;
                Editable=RoleEditable }

    { 1100525006;2;Field  ;
                SourceExpr="Enablement Date";
                Editable="Enablement DateEditable" }

    { 1100528700;2;Field  ;
                SourceExpr="Website Code (Plant Mgt.)";
                Editable=WebsiteCodePlantMgtEditable }

    { 1210190012;0;Container;
                ContainerType=FactBoxArea }

    { 1100529902;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190008;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130201;
                Visible=TRUE;
                PartType=Page }

    { 1210190005;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130202;
                Visible=TRUE;
                PartType=Page }

    { 1210190003;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130203;
                Visible=TRUE;
                PartType=Page }

    { 1210190001;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1210190000;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CentralDataMgt@1210190014 : Codeunit 11012010;
      PrintDoc@1100485003 : Codeunit 229;
      RecRef@1210190026 : RecordRef;
      FeatureRec@1100485000 : Record 11012753;
      ConsolidatedContactData@1210190000 : Codeunit 11020207;
      ContactPersonCompanyName@1210190004 : Text[100];
      MapPointVisible@19022708 : Boolean INDATASET;
      CRMIntegrationEnabled@1006 : Boolean;
      CRMIsCoupledToRecord@1007 : Boolean;
      FeatureSFVisible@19036009 : Boolean INDATASET;
      "No.Editable"@19005397 : Boolean INDATASET;
      "Person No.Editable"@1210190005 : Boolean INDATASET;
      AddressEditable@19025954 : Boolean INDATASET;
      "Address 2Editable"@19054460 : Boolean INDATASET;
      "Post CodeEditable"@19041336 : Boolean INDATASET;
      CityEditable@19066647 : Boolean INDATASET;
      "Territory CodeEditable"@1100528700 : Boolean INDATASET;
      "Country/Region CodeEditable"@19033023 : Boolean INDATASET;
      "Salesperson CodeEditable"@19071610 : Boolean INDATASET;
      SalesRepresentativeCodeEditabl@19059828 : Boolean INDATASET;
      "Purchaser CodeEditable"@19049936 : Boolean INDATASET;
      "Contact TypeEditable"@19039387 : Boolean INDATASET;
      "Job TitleEditable"@19021642 : Boolean INDATASET;
      "Job Title 2Editable"@19076327 : Boolean INDATASET;
      DepartmentEditable@19032945 : Boolean INDATASET;
      OrganizationalLevelCodeEditabl@1210190001 : Boolean INDATASET;
      BlockedEditable@1100409001 : Boolean INDATASET;
      "Blocking ReasonEditable"@1100409000 : Boolean INDATASET;
      "Phone No.Editable"@1100409002 : Boolean INDATASET;
      "Phone No. 2Editable"@1100409003 : Boolean INDATASET;
      "Phone No. WorkEditable"@19025027 : Boolean INDATASET;
      "Extension No.Editable"@19013591 : Boolean INDATASET;
      "Phone No. Work 2Editable"@19049792 : Boolean INDATASET;
      "Mobile Phone No.Editable"@19054400 : Boolean INDATASET;
      "Mobile Phone No. 2Editable"@19078726 : Boolean INDATASET;
      "Fax No.Editable"@19043622 : Boolean INDATASET;
      "E-MailEditable"@19070018 : Boolean INDATASET;
      "E-Mail 2Editable"@19078032 : Boolean INDATASET;
      PagerEditable@19052949 : Boolean INDATASET;
      "Language CodeEditable"@19021421 : Boolean INDATASET;
      "Salutation CodeEditable"@19022437 : Boolean INDATASET;
      "Correspondence TypeEditable"@19065875 : Boolean INDATASET;
      "Document GroupEditable"@1210190002 : Boolean INDATASET;
      "Exclude from SegmentEditable"@19019548 : Boolean INDATASET;
      "Visit AddressEditable"@19072532 : Boolean INDATASET;
      "Visit Address 2Editable"@19007860 : Boolean INDATASET;
      VisitAddressPostCodeEditable@19008097 : Boolean INDATASET;
      "Visit Address CityEditable"@19055420 : Boolean INDATASET;
      "Visit Address CountyEditable"@19019460 : Boolean INDATASET;
      VisitAddressCountryRegionEdita@19072484 : Boolean INDATASET;
      "Login IDEditable"@1210190003 : Boolean INDATASET;
      RoleEditable@19035063 : Boolean INDATASET;
      "Enablement DateEditable"@19008726 : Boolean INDATASET;
      WebsiteCodePlantMgtEditable@19001818 : Boolean INDATASET;
      FeatureSFEditable@19037755 : Boolean INDATASET;
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
      CreateInOutLookVisible@1100525000 : Boolean;

    PROCEDURE EnableFields@1();
    VAR
      CompanyNotEditable@1210190024 : Boolean;
      ContactPersonNotEditable@1210190023 : Boolean;
      ContactEditable@1100525000 : Boolean;
    BEGIN
      CompanyNotEditable := NOT InsertingCompanyIsAllowed(FALSE);
      ContactPersonNotEditable := NOT InsertingPersonIsAllowed(FALSE);

      IF (Type = Type::Company) AND ("No." <> '') THEN
        CompanyNotEditable := NOT ChangingCompanyIsAllowed;

      IF (Type = Type::Person) AND ("No." <> '') THEN
        ContactPersonNotEditable := NOT ChangingPersonIsAllowed;

      ContactEditable :=
        ((Type = Type::Company) AND NOT CompanyNotEditable) OR
        ((Type = Type::Person) AND NOT ContactPersonNotEditable);

      // General
      "No.Editable" := ContactEditable;
      "Person No.Editable" := ContactEditable;
      AddressEditable := ContactEditable;
      "Address 2Editable" := ContactEditable;
      "Post CodeEditable" := ContactEditable;
      CityEditable := ContactEditable;
      "Territory CodeEditable" := ContactEditable;
      "Country/Region CodeEditable" := ContactEditable;
      "Salesperson CodeEditable" := ContactEditable;
      SalesRepresentativeCodeEditabl := ContactEditable;
      "Purchaser CodeEditable" := ContactEditable;
      "Contact TypeEditable" := ContactEditable;
      "Job TitleEditable" := ContactEditable;
      "Job Title 2Editable" := ContactEditable;
      DepartmentEditable := ContactEditable;
      OrganizationalLevelCodeEditabl := (Type=Type::Person) AND NOT ContactPersonNotEditable;
      BlockedEditable := ContactEditable;
      "Blocking ReasonEditable" := ContactEditable;

      // Communication
      "Phone No.Editable" := ContactEditable;
      "Phone No. 2Editable" := ContactEditable;
      "Phone No. WorkEditable" := ContactEditable;
      "Extension No.Editable" := ContactEditable;
      "Phone No. Work 2Editable" := ContactEditable;
      "Mobile Phone No.Editable" := ContactEditable;
      "Mobile Phone No. 2Editable" := ContactEditable;
      "Fax No.Editable" := ContactEditable;
      "E-MailEditable" := ContactEditable;
      "E-Mail 2Editable" := ContactEditable;
      PagerEditable := ContactEditable;
      "Language CodeEditable" := ContactEditable;
      "Salutation CodeEditable" := ContactEditable;
      "Correspondence TypeEditable" := ContactEditable;
      "Document GroupEditable" := (ContactEditable) AND (NOT ((Type = Type::Person) AND ("Company No." <> '')));
      "Exclude from SegmentEditable" := ContactEditable;

      // Visit Address
      "Visit AddressEditable" := ContactEditable;
      "Visit Address 2Editable" := ContactEditable;
      VisitAddressPostCodeEditable := ContactEditable;
      "Visit Address CityEditable" := ContactEditable;
      "Visit Address CountyEditable" := ContactEditable;
      VisitAddressCountryRegionEdita := ContactEditable;

      // Integration
      "Login IDEditable" := (Type=Type::Person) AND NOT ContactPersonNotEditable;
      RoleEditable := ContactEditable;
      "Enablement DateEditable" := ContactEditable;
      WebsiteCodePlantMgtEditable := ContactEditable;

      // Central Data Management Fields
      IF NOT ContactEditable THEN BEGIN
        "Salesperson CodeEditable" :=
          CentralDataMgt.FieldInputAllowed(DATABASE::Contact, FIELDNO("Salesperson Code"));
        SalesRepresentativeCodeEditabl :=
          CentralDataMgt.FieldInputAllowed(DATABASE::Contact, FIELDNO("Sales Representative Code"));
        "Purchaser CodeEditable" :=
          CentralDataMgt.FieldInputAllowed(DATABASE::Contact, FIELDNO("Purchaser Code"));
        "Contact TypeEditable" :=
          CentralDataMgt.FieldInputAllowed(DATABASE::Contact, FIELDNO("Contact Type"));
      END;
    END;

    LOCAL PROCEDURE EnableDisableFeatureSF@1100528400();
    VAR
      ContactFeatureType@1100528400 : Record 11012753;
      RelationType@1100528401 : Integer;
      CompanyRelationsCentralMgt@1100528402 : Record 11012059;
    BEGIN
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(CompanyRelationsCentralMgt) THEN BEGIN
        FeatureSFEditable := FALSE;
        EXIT;
      END;

      IF Type = Type::Company THEN
        RelationType := ContactFeatureType."Relation Type"::Company
      ELSE
        RelationType := ContactFeatureType."Relation Type"::Contact;
      FeatureSFEditable := CentralDataMgt.ContactFeatureTypeIsEditable("No.", RelationType);
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CALCFIELDS("Name Salesperson");  //**4PS.n
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CALCFIELDS("Name Purchaser");  //**4PS.n
    END;

    BEGIN
    {
      4PS, This page is a copy of page 5050 and adjusted to be used only for Contact Persons
      200406 ORANGO.EE - Added "Surname"
    }
    END.
  }
}

