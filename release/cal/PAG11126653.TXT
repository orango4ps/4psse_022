OBJECT Page 11126653 Purchase Requisition Header
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Requisition;
               NOR=Innkjopsrekvisisjon;
               SVE=Inkîpsrekvisition];
    SourceTable=Table11229330;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=ENU=New,Process,Report,Approve,Request Approval;
    OnInit=BEGIN
             RequisitionEditable := TRUE;
             RequisitionLinesEditable := TRUE;
           END;

    OnOpenPage=BEGIN
                 GLSetup.GET
               END;

    OnAfterGetRecord=BEGIN
                       RequisitionText := GetFirstTextLine;
                       PreferredVendor := GetPreferredVendor(TRUE);
                       RequisitionEditable := NOT Fixed;
                     END;

    OnNewRecord=BEGIN
                  "Project No." := GETFILTER("Project No.");
                  "Purchase Action" := GETFILTER("Purchase Action");
                  GetDefaultsFromProject;  //DP01314
                  GetDefaultsFromPurchaseAction;
                  RequisitionEditable := TRUE;
                END;

    OnAfterGetCurrRecord=VAR
                           RecRef@1100527300 : RecordRef;
                           Dimension@1100527450 : Record 348;
                           DimensionValue@1100527451 : Record 349;
                         BEGIN
                           SetControlAppearance;
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           //DP01314.sn
                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(FALSE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");
                           //DP01314.en

                           RequisitionLinesEditable := TRUE;
                           IF "Global Dimension 1 Code" <> '' THEN BEGIN
                             Dimension.GET(GLSetup."Global Dimension 1 Code");
                             DimensionValue.GET(GLSetup."Global Dimension 1 Code", "Global Dimension 1 Code");
                             IF Dimension.Blocked THEN BEGIN
                               RequisitionLinesEditable := FALSE;
                               MESSAGE(Text007, Dimension.Code);
                             END ELSE
                               IF DimensionValue.Blocked THEN BEGIN
                                 RequisitionLinesEditable := FALSE;
                                 MESSAGE(Text008, DimensionValue."Dimension Code", DimensionValue.Code);
                               END;
                           END;
                           CurrPage.RequisitionLines.PAGE.SetPageEditable(RequisitionEditable AND RequisitionLinesEditable);
                         END;

    ActionList=ACTIONS
    {
      { 1100529428;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525003;1 ;Action    ;
                      CaptionML=ENU=Comment Lines (Purchase Requisition);
                      Image=ViewComments;
                      OnAction=BEGIN
                                 EditCommentLines;  //DP01314
                               END;
                                }
      { 1100529809;1 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      ToolTipML=ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Enabled="No." <> '';
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 1100529700;1 ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntry@1100529700 : Record 454;
                                 ApprovalEntries@1100529701 : Page 658;
                               BEGIN
                                 ApprovalEntry.FILTERGROUP(2);
                                 ApprovalEntry.SETRANGE("Table ID", DATABASE::"Purchase Requisition");
                                 ApprovalEntry.SETRANGE("Document No.", "No.");
                                 ApprovalEntry.FILTERGROUP(0);
                                 ApprovalEntries.SETTABLEVIEW(ApprovalEntry);
                                 ApprovalEntries.RUNMODAL;
                               END;
                                }
      { 1100528911;1 ;Action    ;
                      CaptionML=[ENU=Texts;
                                 NOR=Tekster;
                                 SVE=Texter];
                      RunObject=Page 11126669;
                      RunPageLink=Line Type=CONST(Requisition),
                                  No.=FIELD(No.);
                      Image=Text }
      { 1100529426;1 ;Action    ;
                      CaptionML=[ENU=Vendors;
                                 NOR=Leverandõrer;
                                 SVE=Leverantîrer];
                      RunObject=Page 11126655;
                      RunPageLink=Purchase Requisition No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Segment;
                      PromotedCategory=Process }
      { 1100528912;1 ;Action    ;
                      CaptionML=[ENU=Purchasers;
                                 NOR=Innkjõpere;
                                 SVE=Inkîpare];
                      RunObject=Page 11126668;
                      RunPageLink=Purchase Requisition No.=FIELD(No.);
                      Image=Employee }
      { 1100528902;1 ;Action    ;
                      CaptionML=[ENU=Purchase Orders;
                                 NOR=Innkjõpsordre;
                                 SVE=Inkîpsordrar];
                      RunObject=Page 9307;
                      RunPageView=SORTING(Document Type,Job No.)
                                  WHERE(Document Type=CONST(Order));
                      RunPageLink=Purchase Requisition No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Process }
      { 1100528900;1 ;Action    ;
                      CaptionML=[ENU=Purchase Quotes;
                                 NOR=Innkjõpstilbud;
                                 SVE=Inkîpsofferter];
                      RunObject=Page 9306;
                      RunPageView=SORTING(Document Type,Job No.)
                                  WHERE(Document Type=CONST(Quote));
                      RunPageLink=Purchase Requisition No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Process }
      { 1100528909;1 ;Action    ;
                      Name=CompareQuotes;
                      CaptionML=[ENU=Quote Comparison;
                                 NOR=Tilbudssammenligning;
                                 SVE=OffertjÑmfîrelse];
                      Image=CompareCost;
                      OnAction=VAR
                                 PurchaseHeader@1100528901 : Record 38;
                                 ComparisonQuotes@1100528902 : Record 11020214;
                               BEGIN
                                 PurchaseHeader.SETRANGE("Document Type", PurchaseHeader."Document Type"::Quote);
                                 PurchaseHeader.SETRANGE("Purchase Requisition No.", "No.");
                                 IF NOT PurchaseHeader.FINDFIRST THEN EXIT;

                                 ComparisonQuotes.SETRANGE(Type, ComparisonQuotes.Type::"Comparison Quote");
                                 ComparisonQuotes.SETRANGE("Comparison Quote", PurchaseHeader."Comparison Quote");
                                 IF NOT ComparisonQuotes.FINDFIRST THEN EXIT;
                                 PAGE.RUNMODAL(PAGE::"Quote Comparison Matrix", ComparisonQuotes);
                               END;
                                }
      { 1100529430;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100529429;1 ;Action    ;
                      Name=CopyRequisition;
                      CaptionML=ENU=Copy Requisition;
                      Image=Copy;
                      OnAction=BEGIN
                                 CopyRequisition;
                               END;
                                }
      { 1100529432;1 ;Action    ;
                      Name=AssignPurchaseActionLines;
                      CaptionML=ENU=Assign Purchase Action Lines;
                      Enabled=RequisitionEditable;
                      Image=AddAction;
                      OnAction=BEGIN
                                 CopyPurchActionToRequisition;
                               END;
                                }
      { 1100529431;1 ;Action    ;
                      Name=AssignBudgetLines;
                      CaptionML=ENU=Assign Budget Lines;
                      Promoted=Yes;
                      Enabled=RequisitionEditable;
                      PromotedIsBig=Yes;
                      Image=AddAction;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CopyBudgetPage@1100525000 : Page 11130131;
                                 CopyServiceBudgetPage@1100527700 : Page 11127073;
                               BEGIN
                                 IF "Project No." <> '' THEN BEGIN
                                   CopyBudgetPage.SetSelectionRequisition("No.");
                                   CopyBudgetPage.RUNMODAL;
                                 END ELSE
                                   IF "Service Order No." <> '' THEN BEGIN
                                     CopyServiceBudgetPage.SetSelectionRequisition("No.");
                                     CopyServiceBudgetPage.RUNMODAL;
                                   END;
                               END;
                                }
      { 1100529420;1 ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Reopen;
                                 NOR=èpne pÜ nytt;
                                 SVE=ôppna igen];
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseRequisition@1100529400 : Record 11229330;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchaseRequisition);
                                 PurchaseRequisitionMgt.ReopenRequisitionManually(PurchaseRequisition);
                               END;
                                }
      { 1100529424;1 ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑppa];
                      Promoted=Yes;
                      Enabled=PurchaseRequisitionApprovalsWorkflowNotEnabled;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseRequisition@1100529400 : Record 11229330;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchaseRequisition);
                                 PurchaseRequisitionMgt.ReleaseRequisitionManually(PurchaseRequisition);
                               END;
                                }
      { 1100529500;1 ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn;
                                 SVE=GodkÑnn];
                      Enabled=PurchaseRequisitionApprovalsWorkflowNotEnabled;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseRequisition@1100529400 : Record 11229330;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchaseRequisition);
                                 PurchaseRequisitionMgt.ApproveRequisition(PurchaseRequisition);  //DP01314
                               END;
                                }
      { 1100529501;1 ;Action    ;
                      Name=Finalize;
                      CaptionML=[ENU=Finalize;
                                 NOR=Lukk;
                                 SVE=StÑng];
                      Image=Close;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseRequisition@1100529400 : Record 11229330;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchaseRequisition);
                                 PurchaseRequisitionMgt.CloseRequisition(PurchaseRequisition);  //DP01314
                               END;
                                }
      { 1100528213;1 ;Action    ;
                      Name=Close;
                      CaptionML=[ENU=Close;
                                 NOR=Lukk;
                                 SVE=Avsluta];
                      Image=Close;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseRequisition@1100529400 : Record 11229330;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchaseRequisition);
                                 PurchaseRequisitionMgt.CloseRequisitionFinal(PurchaseRequisition);  //DP01314
                               END;
                                }
      { 1100529602;1 ;Action    ;
                      Name=Cancel;
                      CaptionML=ENU=Cancel;
                      Visible=FALSE;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseRequisition@1100529600 : Record 11229330;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchaseRequisition);
                                 PurchaseRequisitionMgt.CancelRequisition(PurchaseRequisition);
                               END;
                                }
      { 1100529434;1 ;Action    ;
                      Name=GeneratePurchaseQuote;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Purchase Quotes;
                      Promoted=Yes;
                      Image=MakeOrder;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1100528300 : Record 11072003;
                                 PurchRequisitionMgt@1100529600 : Codeunit 11229287;
                                 lvOptionNo@1210190004 : Integer;
                               BEGIN
                                 IF Status = Status::Definitive THEN
                                   ERROR(Text006, Status);

                                 IF NOT Job.GET("Project No.") THEN Job.INIT;
                                 IF (Job."Project Portal Project") THEN
                                   lvOptionNo := STRMENU(Text003,2)
                                 ELSE
                                   lvOptionNo := STRMENU(Text003,1);  //DP01314
                                 IF (lvOptionNo < 1) THEN
                                   ERROR('');

                                 PurchRequisitionMgt.CreateQuote(Rec, lvOptionNo);
                               END;
                                }
      { 1100529433;1 ;Action    ;
                      Name=GeneratePurchaseOrder;
                      CaptionML=[ENU=Create Purchase Order;
                                 NOR=Opprette kjõpsordre;
                                 SVE=Skapa inkîpsorder];
                      Promoted=Yes;
                      Image=MakeOrder;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchRequisitionMgt@1100529600 : Codeunit 11229287;
                               BEGIN
                                 IF Status = Status::Closed THEN
                                   ERROR(Text006, Status);
                                 PurchRequisitionMgt.CreateOrder(Rec);
                               END;
                                }
      { 1100529601;1 ;Action    ;
                      Name=GeneratePlantRequestOrder;
                      CaptionML=ENU=Generate Plant Request/Order;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Components;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchReqLine2@1100529000 : Record 11229331;
                                 PurchReqMgt@1100529001 : Codeunit 11229287;
                               BEGIN
                                 CurrPage.RequisitionLines.PAGE.SETSELECTIONFILTER(PurchReqLine2);
                                 IF NOT PurchReqLine2.FINDFIRST THEN
                                   ERROR(Text004);
                                 PurchReqMgt.ProcessPlantRequest(PurchReqLine2);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100529600;1 ;Action    ;
                      Name=GenerateInventoryOrder;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=ENU=Generate Inventory Orders;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=InventoryJournal;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchReqLine2@1100529801 : Record 11229331;
                                 PurchReqMgt@1100529800 : Codeunit 11229287;
                               BEGIN
                                 CurrPage.RequisitionLines.PAGE.SETSELECTIONFILTER(PurchReqLine2);
                                 IF NOT PurchReqLine2.FINDFIRST THEN
                                   ERROR(Text004);
                                 PurchReqMgt.ProcessInventory(PurchReqLine2);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100528500;1 ;Action    ;
                      Name=SelectProjectTenderParagraphs;
                      CaptionML=ENU=Select Project Tender Paragraphs;
                      Image=SelectEntries;
                      OnAction=VAR
                                 ProjectTenderParagraphsPage@1100528500 : Page 11020553;
                                 PurchaseRequisitionMgt@1100527352 : Codeunit 11229287;
                                 ProjectTenderParagraph@1100527351 : Record 11012263;
                                 PurchaseRequisitionNo@1100527350 : Code[20];
                                 ProjectNo@1100527353 : Code[20];
                               BEGIN
                                 TESTFIELD("Project No.");
                                 PurchaseRequisitionNo := "No.";
                                 ProjectNo := "Project No.";
                                 ProjectTenderParagraph.SETRANGE("Project No.", "Project No.");
                                 ProjectTenderParagraphsPage.SETTABLEVIEW(ProjectTenderParagraph);
                                 ProjectTenderParagraphsPage.LOOKUPMODE(TRUE);
                                 IF ProjectTenderParagraphsPage.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                   ProjectTenderParagraphsPage.SETSELECTIONFILTER(ProjectTenderParagraph);
                                   PurchaseRequisitionMgt.SelectProjectTenderParagraphs(ProjectTenderParagraph, PurchaseRequisitionNo, ProjectNo);
                                 END;
                               END;
                                }
      { 1100528901;1 ;Action    ;
                      Name=CreateDocuments;
                      CaptionML=[ENU=Create Documents;
                                 NOR=Opprette dokument(er);
                                 SVE=Skapa dokument];
                      Promoted=Yes;
                      Image=Word;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 DocGenerateFrm@1210190001 : Page 11126673;
                               BEGIN
                                 DocGenerateFrm.SetFilter("No.");
                                 DocGenerateFrm.RUNMODAL;
                               END;
                                }
      { 1100528908;1 ;Action    ;
                      Name=MailQuoteDoc;
                      CaptionML=[ENU=Print Purchase Quote Documents;
                                 NOR=Skriv ut innkjõpstilbudsdokumenter;
                                 SVE=Skriv ut inkîpsoffertdokument];
                      Image=PrintDocument;
                      OnAction=VAR
                                 PurchRequisitionMgt@1100529600 : Codeunit 11229287;
                               BEGIN
                                 PurchRequisitionMgt.PrintQuoteDocs(Rec);
                               END;
                                }
      { 1100528907;1 ;Action    ;
                      Name=MailQuote;
                      CaptionML=ENU=Email Quotes;
                      Image=Email;
                      OnAction=VAR
                                 PurchRequisitionMgt@1100529600 : Codeunit 11229287;
                               BEGIN
                                 PurchRequisitionMgt.SendMailQuote(Rec);
                               END;
                                }
      { 1100528906;1 ;Action    ;
                      Name=MailQuoteLetter;
                      CaptionML=ENU=Email Quote Thanks Letters;
                      Image=Email;
                      OnAction=BEGIN
                                 PurchaseRequisitionMgt.SendMailQuoteLetter(Rec);
                               END;
                                }
      { 1100528212;1 ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning;
                                 SVE=GodkÑnnande] }
      { 1100528211;2 ;Action    ;
                      Name=ApproveApprovalRequest;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn;
                                 SVE=GodkÑnn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.;
                                 SVE=GodkÑnn de begÑrda fîrÑndringarna.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 1100528210;2 ;Action    ;
                      Name=RejectApprovalRequest;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 1100528209;2 ;Action    ;
                      Name=DelegateApprovalRequest;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger;
                                 SVE=Delegera];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 1100528208;2 ;Action    ;
                      Name=CommentApprovalRequest;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader;
                                 SVE=Kommentar];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 1100528207;1 ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning;
                                 SVE=BegÑr godkÑnnande] }
      { 1100528206;2 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforespõrsel;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 PurchaseRequisitionMgt.SendRequisitionForApproval(Rec);
                               END;
                                }
      { 1100528205;2 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforespõrsel;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforespõrselen.;
                                 SVE=Annullera godkÑnnandebegÑran.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      PromotedIsBig=Yes;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsBridge4PSConstruct@1001 : Codeunit 11125348;
                               BEGIN
                                 ApprovalsBridge4PSConstruct.OnCancelPurchaseRequisitionApprovalRequest(Rec);
                               END;
                                }
      { 1100528905;  ;ActionContainer;
                      ActionContainerType=Reports }
      { 1100528904;1 ;Action    ;
                      CaptionML=[ENU=Quote Reports;
                                 NOR=Tilbudsrapporter;
                                 SVE=Offertrapporter];
                      Image=PrintForm;
                      OnAction=BEGIN
                                 PurchaseRequisitionMgt.PrintWriteOff(Rec);
                               END;
                                }
      { 1100528903;1 ;Action    ;
                      CaptionML=ENU=Purchase Requisition Reports;
                      Image=Print;
                      OnAction=BEGIN
                                 SETRANGE(Status, Status);
                                 PrintDoc.PrintPurchaseRequisition(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1100529400;0;Container;
                ContainerType=ContentArea }

    { 1100529401;1;Group  ;
                CaptionML=[ENU=General;
                           NOR=Generell;
                           SVE=AllmÑnt];
                GroupType=Group }

    { 1100529402;2;Field  ;
                SourceExpr="No.";
                Editable=RequisitionEditable;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1100529403;2;Field  ;
                SourceExpr=Description;
                Editable=RequisitionEditable }

    { 1100529404;2;Field  ;
                SourceExpr="Project No.";
                Editable=RequisitionEditable;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100529807;2;Field  ;
                SourceExpr="Project Description";
                Visible=FALSE }

    { 1100525000;2;Field  ;
                SourceExpr="Service Order No.";
                Importance=Additional;
                Editable=RequisitionEditable;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100529808;2;Field  ;
                SourceExpr="Service Order Description";
                Visible=FALSE }

    { 1100525001;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                Importance=Additional;
                Editable=RequisitionEditable;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100529405;2;Field  ;
                SourceExpr="Purchase Action";
                Editable=RequisitionEditable }

    { 1100529406;2;Field  ;
                SourceExpr=Status;
                Editable=FALSE;
                OnValidate=BEGIN
                             //Status update only with action-buttons.
                           END;
                            }

    { 1100529806;2;Field  ;
                SourceExpr="Ready for Procurement";
                Visible=FALSE;
                Editable=RequisitionEditable }

    { 1100525002;2;Field  ;
                SourceExpr="Quote only";
                Editable=RequisitionEditable }

    { 1100529419;2;Field  ;
                SourceExpr="Amounts only";
                Editable=RequisitionEditable }

    { 1100529407;2;Field  ;
                SourceExpr="Purchaser Code";
                Editable=RequisitionEditable;
                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           COMMIT;
                           LookupPurchaser;
                           CurrPage.UPDATE;
                         END;
                          }

    { 1100528920;2;Field  ;
                SourceExpr="Name Purchaser";
                Importance=Additional }

    { 1100529423;2;Field  ;
                SourceExpr="Target Amount (LCY)";
                Editable=RequisitionEditable }

    { 1100529421;2;Field  ;
                SourceExpr=Comment;
                Editable=RequisitionEditable }

    { 1100528913;2;Field  ;
                CaptionML=ENU=Requistion Text;
                SourceExpr=RequisitionText;
                Editable=FALSE }

    { 1100528914;2;Field  ;
                CaptionML=[ENU=Vendor;
                           NOR=Leverandõr;
                           SVE=Leverantîr];
                SourceExpr=PreferredVendor;
                Editable=FALSE }

    { 1100529425;2;Field  ;
                SourceExpr="Back-to-back";
                Editable=RequisitionEditable }

    { 1100529800;2;Field  ;
                SourceExpr="No. of Quotes";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DrillDownNoOfQuotes;
                            END;
                             }

    { 1100529801;2;Field  ;
                SourceExpr="No. of Orders";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DrillDownNoOfOrders;
                            END;
                             }

    { 1100529805;2;Field  ;
                SourceExpr="No. of Blanket Orders";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DrillDownNoOfBlanketOrders;
                            END;
                             }

    { 1100529802;2;Field  ;
                SourceExpr="No. of Plant Orders";
                Visible=FALSE }

    { 1100529803;2;Field  ;
                SourceExpr="No. of Plant Requests";
                Visible=FALSE }

    { 1100529804;2;Field  ;
                SourceExpr="No. of Inventory Orders";
                Visible=FALSE }

    { 1100529422;1;Part   ;
                Name=RequisitionLines;
                SubPageLink=Purchase Requisition No.=FIELD(No.);
                PagePartID=Page11126654;
                Editable=RequisitionLinesEditable;
                UpdatePropagation=Both }

    { 1100529408;1;Group  ;
                CaptionML=[ENU=Delivery;
                           NOR=Leveranse;
                           SVE=LEVERANS];
                GroupType=Group }

    { 1100529414;2;Field  ;
                SourceExpr=Deliver;
                Editable=RequisitionEditable }

    { 1100529415;2;Field  ;
                SourceExpr="Ship To Location";
                Editable=RequisitionEditable }

    { 1100528918;2;Field  ;
                SourceExpr="Document Template";
                Editable=RequisitionEditable }

    { 1100529416;2;Field  ;
                SourceExpr="Requested Quote Receipt Date";
                Editable=RequisitionEditable }

    { 1100528917;2;Field  ;
                SourceExpr="Vendors react before";
                Editable=RequisitionEditable }

    { 1100529417;2;Field  ;
                SourceExpr="Requested Receipt Date";
                Editable=RequisitionEditable }

    { 1100529418;2;Field  ;
                SourceExpr="Required on Site Date";
                Editable=RequisitionEditable }

    { 1100529435;2;Field  ;
                SourceExpr="Shipment Method Code" }

    { 1100529436;2;Field  ;
                SourceExpr="Transport Method" }

    { 1100529437;2;Field  ;
                SourceExpr=Destination }

    { 1100529409;1;Group  ;
                CaptionML=[ENU=Log;
                           NOR=Logg;
                           SVE=Logg];
                GroupType=Group }

    { 1100529410;2;Field  ;
                SourceExpr="Date Created" }

    { 1100529411;2;Field  ;
                SourceExpr="Created by" }

    { 1100529412;2;Field  ;
                SourceExpr="Last Date Modified" }

    { 1100529413;2;Field  ;
                SourceExpr="Modified by" }

    { 1100528916;0;Container;
                ContainerType=FactBoxArea }

    { 1100528919;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100528915;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11126671;
                PartType=Page }

    { 1100528204;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=Table ID=CONST(11229330),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100528203;1;Part   ;
                SubPageLink=Table ID=CONST(11229330),
                            Document No.=FIELD(No.);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1100528202;1;Part   ;
                Name=WorkflowStatus;
                ApplicationArea=#Suite;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1100528201;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100528200;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text003@1100529401 : TextConst 'ENU=Quotes,Quotes + Word documents,Quotes + Print Word Documents,Quotes + Print Word Documents with printer selection;NOR=Tilbud,Tilbud + Word-dokument,Tilbud + Skriv ut Word-dokument,Tilbud + Skriv ut Word-dokument med skrivervalgg;SVE=Offerter,Offerter + Word-dokument,Offerter + Skriv ut Word-dokument,Offerter + Skriv ut Word-dokument med skrivarval';
      Text004@1100529600 : TextConst 'ENU=Please select requisition lines.';
      Text006@1100529400 : TextConst 'ENU=Status is %1, creation of quotes not possible;NOR=Status er definitiv, ikke mulig Ü opprette tilbud;SVE=Status Ñr definitiv, det gÜr inte att skapa offerter';
      PurchaseRequisitionMgt@1100528900 : Codeunit 11229287;
      PrintDoc@1100528901 : Codeunit 229;
      RequisitionText@1100528902 : Text[250];
      PreferredVendor@1100528903 : Text[250];
      RequisitionEditable@1100528904 : Boolean INDATASET;
      OpenApprovalEntriesExistForCurrUser@1100528204 : Boolean;
      OpenApprovalEntriesExist@1100528203 : Boolean;
      ShowWorkflowStatus@1100528202 : Boolean;
      CanCancelApprovalForRecord@1100528201 : Boolean;
      ApprovalManagement4PSConstr@1100528200 : Codeunit 11125349;
      PurchaseRequisitionApprovalsWorkflowNotEnabled@1100528100 : Boolean;
      GLSetup@1100527450 : Record 98;
      RequisitionLinesEditable@1100527451 : Boolean INDATASET;
      Text007@1100527452 : TextConst 'ENU=Dimension %1 is blocked.';
      Text008@1100527453 : TextConst 'ENU=Dimension Value %1 - %2 is blocked.';

    PROCEDURE CopyRequisition@2();
    VAR
      PurchaseRequisition@1210190000 : Record 11229330;
      CopyReport@1100525000 : Report 11020315;
      NewRequisition@1100529400 : Code[20];
    BEGIN
      PurchaseRequisition := Rec;
      PurchaseRequisition.SETRECFILTER;
      CopyReport.SETTABLEVIEW(PurchaseRequisition);
      CopyReport.FillDefaults("No.");
      CopyReport.RUNMODAL;
      CopyReport.GetDestination(NewRequisition);
      IF PurchaseRequisition.GET(NewRequisition) THEN
        Rec := PurchaseRequisition;
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
      PurchaseRequisitionApprovalsWorkflowNotEnabled := NOT ApprovalManagement4PSConstr.IsPurchaseRequisitionApprovalsWorkflowEnabled(Rec);
    END;

    BEGIN
    END.
  }
}

