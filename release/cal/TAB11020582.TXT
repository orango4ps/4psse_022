OBJECT Table 11020582 Base Recipe Line
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    Permissions=TableData 313=r;
    OnInsert=BEGIN
               IF "Recipe (Child)" = '' THEN BEGIN
                 IF "Cost Type (Hours)" <> "Cost Type (Hours)"::Labor THEN  //DP01047
                   "Rate Code" := ''  //db, 11-03-16: related fields will be cleared on validate
                 ELSE
                   CheckDefaultRate;
                 xRec."Rate Type" := "Rate Type";  //disable function ConvertNorm by next validate
                 xRec."Team Size" := "Team Size";
                 VALIDATE("Rate Code");            //get actual rate (if copied from old template)
                 DetermineNormGroup;
               END;

               InitRecipeLine(FALSE);  //db, 11-11-09: M16810
               InitAdjustmentFactor;
               IF Quantity <> 0 THEN
                 VALIDATE(Quantity);  //if Ctrl C+V used, force update hours based on adjustment factor
             END;

    OnModify=BEGIN
               CentrManagementCU.EditBaseRecipeLine(Rec,2,xRec);  //DP00381
             END;

    OnDelete=VAR
               QuanSheetRec@1210190001 : Record 11012186;
               QuantityRelation@1100409000 : Record 11020463;
               BufferRec@1100485002 : Record 11012195;
               SurchLine@1100485001 : Integer;
               TextRec@1100409001 : Record 11020595;
               ChrgRec2@1100409002 : Record 11229771;
             BEGIN
               EstimateMgmt.ModifyLinkedBaseRcpLines(0,Rec,0); //0:delete

               CentrManagementCU.EditBaseRecipeLine(Rec,4,xRec);  //DP00381

               EstCodeRec.RESET;
               EstCodeRec.SETFILTER("Estimate No.", '%1', '');
               EstCodeRec.SETFILTER("Sub-Estimate No.", '%1', '');
               EstCodeRec.SETFILTER("Part Group", '%1', '');
               EstCodeRec.SETFILTER(Part, '%1', '');
               EstCodeRec.SETRANGE("Estimate Line",0);
               EstCodeRec.SETRANGE("Recipe Group","Recipe Group");
               EstCodeRec.SETRANGE(Recipe,Recipe);
               EstCodeRec.SETRANGE("Recipe Line","Line No.");
               IF NOT EstCodeRec.ISEMPTY THEN //Call 23762
                 EstCodeRec.DELETEALL(TRUE);  //C033963 (db, 29-12-16: CentralMgt)

               //db.sn, 26-01-15: C020404
               ChrgRec.RESET;
               ChrgRec.SETFILTER("Sales Document No.", '%1', '');  //DP00481
               ChrgRec.SETFILTER("Estimate No.", '%1', '');
               ChrgRec.SETFILTER("Sub-Estimate No.", '%1', '');
               ChrgRec.SETFILTER("Part Group", '%1', '');
               ChrgRec.SETFILTER(Part, '%1', '');
               ChrgRec.SETRANGE("Recipe Line",0);
               ChrgRec.SETRANGE("Recipe Group","Recipe Group");
               ChrgRec.SETRANGE(Recipe,Recipe);
               ChrgRec.SETRANGE("Basic Line","Line No.");  //remove estimated lines included in surcharge
               IF NOT ChrgRec.ISEMPTY THEN BEGIN  //C030221
                 ChrgRec.FINDSET;
                 REPEAT
                   SurchLine := ChrgRec."Surcharge Line";
                   ChrgRec.DELETE(TRUE);  //C033963 (db, 29-12-16: CentralMgt)
                   IF "Cost Amount" <> 0 THEN BEGIN  //skip calculate charge if current line will not change result
                     IF RcpLineRec.GET("Recipe Group", Recipe, SurchLine) THEN BEGIN
                       RcpLineRec.CheckRecipeCharge;
                       //db, 30-01-15: if last basic line deleted for surcharge, initialise surcharge line to disable totals
                       ChrgRec2.COPY(ChrgRec);
                       ChrgRec2.SETFILTER("Basic Line", '<>%1', "Line No.");
                       ChrgRec2.SETRANGE("Surcharge Line",SurchLine);
                       IF NOT ChrgRec2.FINDFIRST THEN BEGIN
                         RcpLineRec.InitNormPrice;
                         RcpLineRec.CalculateTotals;
                         RcpLineRec.MODIFY;
                       END;
                     END;
                   END;
                 UNTIL ChrgRec.NEXT = 0;
               END;

               ChrgRec.SETRANGE("Basic Line");
               ChrgRec.SETRANGE("Surcharge Line","Line No.");  //delete surcharge lines
               IF NOT ChrgRec.ISEMPTY THEN  //C030221
                 ChrgRec.DELETEALL(TRUE);  //C033963 (db, 29-12-16: CentralMgt)
               //db.en, 26-01-15: C020404

               QuanSheetRec.RESET;
               QuanSheetRec.SETFILTER("Estimate No.", '%1', '');
               QuanSheetRec.SETFILTER("Sub-Estimate No.", '%1', '');
               QuanSheetRec.SETFILTER("Part Group", '%1', '');
               QuanSheetRec.SETFILTER(Part, '%1', '');
               QuanSheetRec.SETRANGE("Estimate Line",0);
               QuanSheetRec.SETRANGE("Recipe Group","Recipe Group");
               QuanSheetRec.SETRANGE(Recipe,Recipe);
               QuanSheetRec.SETRANGE("Recipe Line","Line No.");
               IF NOT QuanSheetRec.ISEMPTY THEN //Call 23762
                 QuanSheetRec.DELETEALL;

               //DP00686.sn
               QuantityRelation.SETFILTER("Estimate No.", '%1', '');
               QuantityRelation.SETFILTER("Sub-Estimate No.", '%1', '');
               QuantityRelation.SETFILTER("Part Group", '%1', '');
               QuantityRelation.SETFILTER(Part, '%1', '');
               QuantityRelation.SETRANGE("Estimate Line",0);
               QuantityRelation.SETRANGE("Recipe Group","Recipe Group");
               QuantityRelation.SETRANGE(Recipe,Recipe);
               QuantityRelation.SETRANGE("Recipe Line","Line No.");
               IF NOT QuantityRelation.ISEMPTY THEN //Call 23762
                QuantityRelation.DELETEALL;
               //DP00686.en

               BufferRec.RESET;
               BufferRec.SETFILTER("Estimate No.", '%1', '');
               BufferRec.SETFILTER("Sub-Estimate No.", '%1', '');
               BufferRec.SETFILTER("Part Group", '%1', '');
               BufferRec.SETFILTER(Part, '%1', '');
               BufferRec.SETRANGE("Estimate Line",0);
               //BufferRec.SETRANGE("Sales Document Type", "Sales Document Type");
               BufferRec.SETFILTER("Sales Document No.", '%1', '');  //DP00481
               BufferRec.SETRANGE("Sales Line No.", 0);              //DP00481
               BufferRec.SETRANGE("Recipe Group","Recipe Group");
               BufferRec.SETRANGE(Recipe,Recipe);
               BufferRec.SETRANGE("Recipe Line","Line No.");
               IF NOT BufferRec.ISEMPTY THEN //Call 23762
                 BufferRec.DELETEALL;

               TextRec.SETRANGE("Table Name",TextRec."Table Name"::Estimate);
               TextRec.SETRANGE(Group,"Recipe Group");
               TextRec.SETRANGE("No.",Recipe);
               TextRec.SETRANGE("Recipe Line No.","Line No.");   //DP00686
               TextRec.DELETEALL;

               DELETE;
               UpdateRelatedRecipe("Recipe Group", Recipe);
               INSERT;
             END;

    CaptionML=ENU=Base Recipe Line;
  }
  FIELDS
  {
    { 41  ;   ;Recipe              ;Code20        ;TableRelation="Base Recipe".No. WHERE (Recipe Group=FIELD(Recipe Group));
                                                   CaptionML=[ENU=Recipe;
                                                              NOR=Mal;
                                                              SVE=Mall] }
    { 42  ;   ;Recipe Group        ;Code10        ;TableRelation="Recipe Group";
                                                   CaptionML=[ENU=Recipe Group;
                                                              NOR=Maltype;
                                                              SVE=Malltyp] }
    { 50  ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.;
                                                              SVE=Radnr] }
    { 51  ;   ;Attached to Line No.;Integer       ;TableRelation="Base Recipe Line"."Line No." WHERE (Recipe=FIELD(Recipe),
                                                                                                      Recipe Group=FIELD(Recipe Group));
                                                   CaptionML=[ENU=Attached to Line No.;
                                                              NOR=Knyttet til linjenr.;
                                                              SVE=Bifogad till radnr] }
    { 52  ;   ;Set Level           ;Integer       ;CaptionML=[ENU=Set Level;
                                                              NOR=Still inn nivÜ;
                                                              SVE=StÑll in nivÜ] }
    { 55  ;   ;Set Code            ;Code10        ;TableRelation="Plant Set";
                                                   OnValidate=BEGIN
                                                                IF "Set Code" <> xRec."Set Code" THEN
                                                                  IF "Cost Type (Price)" <> "Cost Type (Price)"::Plant THEN
                                                                    CheckCostTypePriceAllowed;
                                                                ValidateSetCode;  //DP01407
                                                                IF "Line No." <> 0 THEN // T000129
                                                                  EstimateMgmt.ModifyLinkedBaseRcpLines(0,Rec,0); //0:delete
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Set Code;
                                                              NOR=Still inn kode;
                                                              SVE=StÑll in kod] }
    { 60  ;   ;Description         ;Text100       ;OnValidate=BEGIN
                                                                UpdateMgt.CheckBackSlash(Description);   //DP00381
                                                              END;

                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 70  ;   ;Quantity            ;Decimal       ;OnValidate=BEGIN
                                                                EstimateMgmt.SetQuantityRatio(Quantity, xRec.Quantity);  //C044680
                                                                EstimateMgmt.ModifyLinkedBaseRcpLines(1,Rec,0); //1:modify quantity

                                                                IF CurrFieldNo = FIELDNO(Quantity) THEN
                                                                  CheckBomLines;  //DP02339
                                                                CalculateTotals;
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF EnterQuantity(4) THEN
                                                                EditQuanSheet;
                                                            END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall;
                                                              SVE=Antal];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 80  ;   ;Unit of Measure     ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   OnValidate=BEGIN
                                                                IF CurrFieldNo = FIELDNO("Unit of Measure") THEN
                                                                  ValidateUnitOfMeasure("Unit of Measure");
                                                              END;

                                                   OnLookup=BEGIN
                                                              HandleLookupUnit;
                                                            END;

                                                   CaptionML=[ENU=Unit of Measure;
                                                              NOR=Enhet;
                                                              SVE=MÜttenhet] }
    { 85  ;   ;Norm Group          ;Code10        ;TableRelation="Norm Group".Code;
                                                   OnValidate=BEGIN
                                                                DetermineNorm;
                                                              END;

                                                   CaptionML=[ENU=Norm Group;
                                                              NOR=Normgruppe;
                                                              SVE=Normgrupp] }
    { 87  ;   ;Sub Operation Code  ;Code20        ;TableRelation="Sub Operation".Code;
                                                   OnValidate=VAR
                                                                ValidateNewCostObject@1210190000 : Boolean;
                                                              BEGIN
                                                                DetermineNormGroup;
                                                                DetermineNorm;

                                                                IF "Sub Operation Code" <> '' THEN //Call 23762
                                                                  IF SubOperRec.GET("Sub Operation Code") THEN BEGIN
                                                                    SubOperRec.TESTFIELD(Expired,FALSE);  //db, 07-12-09
                                                                    IF SubOperRec.Operation <> '' THEN //Call 23762
                                                                      IF OperRec.GET(SubOperRec.Operation) THEN BEGIN
                                                                        //Call 23762
                                                                        IF ("Cost Object Labor" = '') THEN
                                                                          ValidateNewCostObject := TRUE
                                                                        ELSE
                                                                          ValidateNewCostObject := OldSubOperationDefault;
                                                                        IF ValidateNewCostObject THEN BEGIN
                                                                        //Call 23762
                                                                          VALIDATE("Cost Object Labor", OperRec."Cost Object");
                                                                          CheckCostObject("Cost Object Labor");
                                                                        END;
                                                                        IF OperRec."Rate Code" <> '' THEN
                                                                          IF "Rate Code" <> OperRec."Rate Code" THEN //Call 23762
                                                                            VALIDATE("Rate Code", OperRec."Rate Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Sub Operation Code;
                                                              NOR=Underinnsatskode;
                                                              SVE=Underinsatskod] }
    { 90  ;   ;Norm                ;Decimal       ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> FIELDNO("Production Rate") THEN
                                                                  IF Norm <> 0 THEN
                                                                    "Production Rate" := 1 / Norm
                                                                  ELSE
                                                                    "Production Rate" := 0;

                                                                CalculateTotals;  //db, 24-09-12: norm and production rate used to calculate hours
                                                              END;

                                                   CaptionML=[ENU=Norm;
                                                              NOR=Norm;
                                                              SVE=Norm];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 95  ;   ;Production Rate     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Production Rate" <> 0 THEN
                                                                  VALIDATE(Norm, 1 / "Production Rate")
                                                                ELSE
                                                                  VALIDATE(Norm,1);
                                                              END;

                                                   CaptionML=[ENU=Production Rate;
                                                              NOR=Produksjonsrate;
                                                              SVE=Produktionstakt];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 100 ;   ;Rate Code           ;Code10        ;TableRelation=IF (Rates Based On=CONST(Rate Group)) "Rate by Group"."Rate Code"
                                                                 ELSE IF (Rates Based On=CONST(Budget Rate)) "Budget Rate".Code;
                                                   OnValidate=VAR
                                                                BaseRecipe@1100409001 : Record 11020581;
                                                                CostObjectRate@1100525000 : Code[20];
                                                              BEGIN
                                                                IF "Rate Code" = '' THEN BEGIN
                                                                  InitRateRelatedFields;  //DP01047
                                                                  InitNormRelatedFields(0);  //C053751
                                                                END;

                                                                GetEstSetup;  //DP01183
                                                                IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN BEGIN  //DP00686
                                                                  BaseRecipe.GET("Recipe Group", Recipe);
                                                                  IF "Rate Code" = '' THEN
                                                                    SetRateRec.INIT
                                                                  ELSE
                                                                    SetRateRec.GET(BaseRecipe."Rate Group","Rate Code");
                                                                  VALIDATE("Cost Rate", SetRateRec."Cost Rate");  //DP02114
                                                                  VALIDATE("Sales Rate", SetRateRec."Sales Rate");  //DP02114
                                                                  "Rate Type" := SetRateRec."Rate Type";
                                                                  IF "Rate Type" = "Rate Type"::Minuts THEN
                                                                    "Team Size" := SetRateRec."Team Size"
                                                                  ELSE
                                                                    "Team Size" := 0;
                                                                END ELSE BEGIN
                                                                  BudgetRateRec.SETRANGE(Code,"Rate Code");
                                                                  BudgetRateRec.SETRANGE("Starting Date",0D,TODAY);
                                                                  BudgetRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, TODAY);
                                                                  IF NOT BudgetRateRec.FINDLAST THEN
                                                                    BudgetRateRec.INIT;
                                                                  VALIDATE("Cost Rate", BudgetRateRec.Rate);  //DP02114
                                                                  VALIDATE("Sales Rate", BudgetRateRec."Sales Rate");  //DP02114
                                                                  "Rate Type" := BudgetRateRec."Rate Type";  //DP00381
                                                                  IF "Rate Type" = "Rate Type"::Minuts THEN
                                                                    "Team Size" := BudgetRateRec."Team Size"  //DP00381
                                                                  ELSE
                                                                    "Team Size" := 0;

                                                                  HourRateRec.SETRANGE(Code,"Rate Code");
                                                                  HourRateRec.SETRANGE("Starting Date",0D,TODAY);
                                                                  HourRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, TODAY);
                                                                  IF NOT HourRateRec.FINDLAST THEN
                                                                    HourRateRec.INIT;
                                                                  VALIDATE("Sales Rate", HourRateRec."Hour Rate");  //DP02114
                                                                END;
                                                                //C043241.sn
                                                                IF ("Item No." + "Basic Item" + "Trade Item" = '') AND
                                                                   ("Sub Operation Code" + "Subcontracting Activity"= '') AND
                                                                   ("Plant Type" + "Set Code" = '') AND
                                                                   ("Recipe (Child)" = '') AND
                                                                   ("Surcharge Type" = "Surcharge Type"::" ") THEN BEGIN  //db, 31-08-18
                                                                  IF "Rate Code" <> '' THEN BEGIN //C050221
                                                                    IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN
                                                                      Description := SetRateRec.Description
                                                                    ELSE
                                                                      Description := BudgetRateRec.Description;
                                                                  END;
                                                                END;
                                                                IF (EstSetup."Upd. Cost Object by Rate Code") OR ("Cost Object Labor" = '') THEN BEGIN
                                                                  IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN
                                                                    CostObjectRate := SetRateRec."Cost Object"
                                                                  ELSE
                                                                    CostObjectRate := BudgetRateRec."Cost Object";
                                                                  IF CostObjectRate <> '' THEN BEGIN
                                                                    "Cost Object Labor" := CostObjectRate;
                                                                    DimMgt.GetDimValueRec(2, "Cost Object Labor", DimValRec, TRUE,'');
                                                                    VALIDATE("Cost Component", DimValRec."Cost Component");
                                                                    IF EstSetup."Estimate Based On" = EstSetup."Estimate Based On"::CostObject THEN
                                                                      IF CostObjectLeading THEN  //C050221
                                                                        Description := DimValRec.Name;
                                                                  END;
                                                                END;
                                                                //C043241.en

                                                                //check conversion norm after change of rate type and team size:
                                                                IF ("Rate Type" <> xRec."Rate Type") OR ("Team Size" <> xRec."Team Size") THEN
                                                                  ConvertNorm(("Rate Type" <> xRec."Rate Type"), ("Team Size" <> xRec."Team Size"));

                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Rate Code;
                                                              NOR=Avgiftskode;
                                                              SVE=Avgiftskod] }
    { 110 ;   ;Cost Rate           ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Code" = '' THEN
                                                                  "Cost Rate (FCY)" := ExchangeAmtLCYToFCY("Cost Rate", FALSE, TRUE, FALSE);  //DP02114
                                                              END;

                                                   CaptionML=[ENU=Cost Rate;
                                                              SVE=Avgift];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 120 ;   ;Net Cost Price      ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT SkipValidateFCY THEN
                                                                  "Net Cost Price (FCY)" := ExchangeAmtLCYToFCY("Net Cost Price", FALSE, TRUE, FALSE);  //DP02114
                                                                CalculateDiscount(FALSE);
                                                                //EstimateMgmt.CalcBuyBackRates("Item No.","Plant Type",'',0,"Net Cost Price","Buy Back Price","Buy Back %");  //C061014
                                                                //"Buy Back Price (FCY)" := ExchangeAmtLCYToFCY("Buy Back Price", FALSE, TRUE, FALSE);  //DP02114
                                                                UpdateSalesPriceFromCostPrice;  //db, 14-04-14: C014487
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=ENU=Net Cost Price;
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 141 ;   ;Buy Back Price      ;Decimal       ;OnValidate=BEGIN
                                                                EstimateMgmt.CalcBuyBackRates("Item No.","Plant Type",'',1,"Net Sales Price","Buy Back Price","Buy Back %");  //C061014
                                                                "Buy Back Price (FCY)" := ExchangeAmtLCYToFCY("Buy Back Price", FALSE, TRUE, FALSE);  //DP02114
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Buy Back Price;
                                                              NOR=Tilbakekjõpspris;
                                                              SVE=èterkîpspris];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 144 ;   ;Buy Back %          ;Decimal       ;OnValidate=BEGIN
                                                                EstimateMgmt.CalcBuyBackRates("Item No.","Plant Type",'',2,"Net Sales Price","Buy Back Price","Buy Back %");  //C061014
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Buy Back %;
                                                              NOR=Tilbakekjõpsprosent;
                                                              SVE=èterkîpsprocent];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 150 ;   ;Hours               ;Decimal       ;CaptionML=[ENU=Hours;
                                                              NOR="Timer ";
                                                              SVE=Timmar];
                                                   DecimalPlaces=2:;
                                                   Editable=No }
    { 160 ;   ;Labor Cost Amount   ;Decimal       ;CaptionML=[ENU=Labor Cost Amount;
                                                              NOR=Arbeidskraftsbelõp;
                                                              SVE=Arbetskraftsbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 170 ;   ;Net Cost Amount     ;Decimal       ;CaptionML=ENU=Net Cost Amount;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 171 ;   ;Gross Amount        ;Decimal       ;CaptionML=[ENU=Gross Amount;
                                                              NOR=Bruttobelõp;
                                                              SVE=Bruttobelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 191 ;   ;Buy Back Amount     ;Decimal       ;CaptionML=[ENU=Buy Back Amount;
                                                              NOR=Tilbakekjõpsbelõp;
                                                              SVE=èterkîpsbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 200 ;   ;Cost Amount         ;Decimal       ;CaptionML=[ENU=Cost Amount;
                                                              NOR=Kostbelõp;
                                                              SVE=Kostnadsbelopp];
                                                   NotBlank=No;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 270 ;   ;Plant Type          ;Code20        ;TableRelation="Plant Type";
                                                   OnValidate=BEGIN
                                                                IF ("Plant Type" <> xRec."Plant Type") AND ("Plant Type" <> '') THEN BEGIN
                                                                  //C039780.sn
                                                                  RecipeRec.GET("Recipe Group", Recipe);
                                                                  "Plant Rates in Hours" := RecipeRec."Plant Rates in Hours";
                                                                  //C039780.en
                                                                  IF "Cost Type (Price)" <> "Cost Type (Price)"::Plant THEN
                                                                    CheckCostTypePriceAllowed;
                                                                  GetDefaultsPlantType;
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Plant Type;
                                                              NOR=Maskintype;
                                                              SVE=Maskintyp] }
    { 271 ;   ;Plant Price Type    ;Option        ;CaptionML=[ENU=Plant Price Type;
                                                              NOR=Maskin Pristype;
                                                              SVE=Maskin pristyp];
                                                   OptionCaptionML=[ENU=" ,Day,Week,,Month,,,,,Hour";
                                                                    NOR=" ,Dag,Uke,,MÜned,,,,,Time";
                                                                    SVE=" ,Dag,Vecka,,MÜnad,,,,,Timme"];
                                                   OptionString=[ ,Day,Week,,Month,,,,,Hour];
                                                   Editable=No }
    { 272 ;   ;Start Rental Period ;Date          ;OnValidate=BEGIN
                                                                CalcRentalUnits;
                                                                EstimateMgmt.ModifyLinkedBaseRcpLines(3,Rec,FIELDNO("Start Rental Period")); //3:fields
                                                              END;

                                                   CaptionML=[ENU=Start Rental Period;
                                                              NOR=Start Leieperiode;
                                                              SVE=Starta uthyrningsperiod] }
    { 273 ;   ;End Rental Period   ;Date          ;OnValidate=BEGIN
                                                                CalcRentalUnits;
                                                                EstimateMgmt.ModifyLinkedBaseRcpLines(3,Rec,FIELDNO("End Rental Period")); //3:fields
                                                              END;

                                                   CaptionML=[ENU=End Rental Period;
                                                              NOR=Slutt pÜ Leieperiode;
                                                              SVE=Slut pÜ uthyrningsperiod] }
    { 274 ;   ;Rental Period Formula;DateFormula  ;OnValidate=BEGIN
                                                                IF FORMAT("Rental Period Formula") <> '' THEN BEGIN
                                                                  IF "Set Code" = '' THEN
                                                                    TESTFIELD("Plant Price Type");
                                                                  VALIDATE("Time Quantity",EstimateMgmt.ConvPlantCalcPeriod("Rental Period Formula","Plant Price Type"));
                                                                END ELSE BEGIN
                                                                  IF "Rental Time Units" <> 0 THEN
                                                                    VALIDATE("Time Quantity","Rental Time Units")
                                                                  ELSE
                                                                    VALIDATE("Time Quantity",1);
                                                                END;
                                                                EstimateMgmt.ModifyLinkedBaseRcpLines(3,Rec,FIELDNO("Rental Period Formula")); //3:fields
                                                              END;

                                                   CaptionML=[ENU=Rental Period Formula;
                                                              NOR=Formel for Leieperiode;
                                                              SVE=Formel fîr uthyrningsperiod] }
    { 275 ;   ;Rental Time Units   ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Rental Period Formula");
                                                                EstimateMgmt.ModifyLinkedBaseRcpLines(3,Rec,FIELDNO("Rental Time Units")); //3:fields
                                                              END;

                                                   CaptionML=[ENU=Rental Time Units;
                                                              NOR=Leietidsenhet;
                                                              SVE=Uthyrningstidsenhet];
                                                   BlankZero=Yes }
    { 280 ;No ;Project No.         ;Code20        ;TableRelation=Job;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Project No.",''); //DP00381
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr.;
                                                              SVE=Projektnr] }
    { 290 ;   ;Element             ;Code20        ;TableRelation="Base Element";
                                                   OnValidate=BEGIN
                                                                FormatMgt.FormatElem(Element,2,'');
                                                                IF Element <> '' THEN
                                                                  ElemRec.GET(Element);

                                                                GetDisciplineByElement;  //DP02460
                                                              END;

                                                   OnLookup=BEGIN
                                                              ElemRec.Code := Element;
                                                              IF PAGE.RUNMODAL(PAGE::Elements, ElemRec) = ACTION::LookupOK THEN
                                                                VALIDATE(Element, ElemRec.Code);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 295 ;No ;Extension Contract  ;Code10        ;TableRelation="Extension Contract"."Contract No." WHERE (Project No.=FIELD(Project No.));
                                                   CaptionML=[ENU=Extension Contract;
                                                              NOR=ETA;
                                                              SVE=éTA] }
    { 300 ;   ;Cost Object Labor   ;Code20        ;TableRelation="Dimension Value".Code WHERE (Cost Type=CONST(Labor),
                                                                                               Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Cost Object Labor;
                                                              NOR=Kostnadsobjekt, arbeidskraft;
                                                              SVE=Kostnadsobjekt, arbetskraft] }
    { 335 ;   ;Cost Object Price   ;Code20        ;TableRelation="Dimension Value".Code WHERE (Cost Type=FILTER(Material..Sundry),
                                                                                               Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                //C050221
                                                                IF ("Cost Object Price" <> xRec."Cost Object Price") AND ("Cost Object Price" <> '') THEN
                                                                  GetDefaultsCostObject("Cost Type (Price)", "Cost Object Price");
                                                              END;

                                                   CaptionML=ENU=Cost Object Price }
    { 400 ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   OnValidate=BEGIN
                                                                IF ("Item No." <> xRec."Item No.") AND ("Item No." <> '') THEN BEGIN
                                                                  ClearFields(1); //Plant
                                                                  ValidateItem(ItemTypeOpt::Item, TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Artikkelnr;
                                                              SVE=Artikelnr] }
    { 410 ;   ;Basic Item          ;Code20        ;TableRelation="Basic Item"."Product Code" WHERE (Manufacturer=FIELD(Manufacturer));
                                                   OnValidate=BEGIN
                                                                IF ("Basic Item" <> xRec."Basic Item") AND ("Basic Item" <> '') THEN BEGIN
                                                                  ValidateItem(ItemTypeOpt::"Basic Item", TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Basic Item;
                                                              NOR=Fabrikantartikkel;
                                                              SVE=Basartikel] }
    { 411 ;   ;Item Type           ;Text40        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Basic Item"."Item Type" WHERE (Product Code=FIELD(Basic Item),
                                                                                                      Manufacturer=FIELD(Manufacturer)));
                                                   CaptionML=[ENU=Item Type;
                                                              NOR=Artikkeltype;
                                                              SVE=Artikeltyp];
                                                   Editable=No }
    { 412 ;   ;Item Brand          ;Text40        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Basic Item"."Item Brand" WHERE (Product Code=FIELD(Basic Item),
                                                                                                       Manufacturer=FIELD(Manufacturer)));
                                                   CaptionML=[ENU=Item Brand;
                                                              NOR=Artikkelens Varemerke;
                                                              SVE=Artikelns varumÑrke];
                                                   Editable=No }
    { 413 ;   ;Item Series         ;Text40        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Basic Item"."Item Series" WHERE (Product Code=FIELD(Basic Item),
                                                                                                        Manufacturer=FIELD(Manufacturer)));
                                                   CaptionML=[ENU=Item Series;
                                                              NOR=Artikkelserier;
                                                              SVE=Artikelserier];
                                                   Editable=No }
    { 420 ;   ;Trade Item          ;Code20        ;TableRelation="Trade Item"."Item Code" WHERE (Vendor=FIELD("Vendor (Trade Item)"));
                                                   OnValidate=BEGIN
                                                                IF ("Trade Item" <> xRec."Trade Item") AND ("Trade Item" <> '') THEN BEGIN
                                                                  ValidateItem(ItemTypeOpt::"Trade Item", TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Trade Item;
                                                              NOR=Katalogartikkel;
                                                              SVE=Anskaffningsartikel] }
    { 440 ;   ;Vendor (Trade Item) ;Code15        ;TableRelation="ETIM Vendor - Central Mgt";
                                                   OnValidate=VAR
                                                                lvExecValidate@1100485000 : Boolean;
                                                              BEGIN
                                                                IF ("Vendor (Trade Item)" <> xRec."Vendor (Trade Item)") AND ("Vendor (Trade Item)" <> '') THEN BEGIN
                                                                  IF "Basic Item" <> '' THEN BEGIN
                                                                    "Trade Item" := '';
                                                                    lvExecValidate := TRUE;
                                                                  END;
                                                                  IF "Trade Item" <> '' THEN BEGIN
                                                                    VALIDATE("Trade Item");
                                                                    lvExecValidate := TRUE;
                                                                  END;
                                                                  //db.sn, 17-12-10: M18021
                                                                  IF lvExecValidate THEN BEGIN
                                                                    IF TradeItemRec.CheckReplaceVendor(
                                                                      xRec."Vendor (Trade Item)", xRec."Trade Item",
                                                                      "Vendor (Trade Item)", "Trade Item") THEN
                                                                      ValidateItem(ItemTypeOpt::"Trade Item", TRUE)
                                                                    ELSE
                                                                      ValidateItem(ItemTypeOpt::"Trade Vendor", TRUE);
                                                                  END;
                                                                  //db.en, 17-12-10: M18021
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Vendor (Trade Item);
                                                              NOR=Leverandõr (katalogartikkel);
                                                              SVE=Leverantîr (skaffningsartikel)] }
    { 450 ;   ;Manufacturer        ;Code15        ;TableRelation="ETIM Vendor - Central Mgt";
                                                   CaptionML=[ENU=Manufacturer;
                                                              NOR=Produsent;
                                                              SVE=Tillverkare] }
    { 460 ;   ;Gross Price         ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT SkipValidateFCY THEN
                                                                  "Gross Price (FCY)" := ExchangeAmtLCYToFCY("Gross Price", FALSE, TRUE, FALSE);  //DP02114
                                                                CalculateNetPrice;
                                                                UpdateSalesPriceFromCostPrice;  //db, 14-04-14: C014487
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Gross Price;
                                                              NOR=Bruttopris;
                                                              SVE=Bruttopris];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 468 ;   ;Purchase Discount % ;Decimal       ;OnValidate=BEGIN
                                                                IF CurrFieldNo = FIELDNO("Purchase Discount %") THEN BEGIN
                                                                  TESTFIELD("Gross Price");  //db, 11-11-13: DP00260 (C005807)
                                                                END;

                                                                //DP00381.sn
                                                                CalculateNetPrice;
                                                                UpdateSalesPriceFromCostPrice;  //db, 14-04-14: C014487
                                                                CalculateTotals;
                                                                //DP00381.en
                                                              END;

                                                   CaptionML=[ENU=Purchase Discount %;
                                                              NOR=Innkjõpsrabattprosent;
                                                              SVE=Inkîpsrabattprocent];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 469 ;   ;Sales Discount %    ;Decimal       ;OnValidate=BEGIN
                                                                IF CurrFieldNo = FIELDNO("Sales Discount %") THEN BEGIN
                                                                  TESTFIELD("Gross Price");  //db, 11-11-13: DP00260 (C005807)
                                                                END;

                                                                //DP00381.sn
                                                                CalculateNetPrice;
                                                                IF "Sales Discount %" <> 0 THEN BEGIN  //db, 14-04-14: C014487
                                                                  GetEstSetup;  //DP01183
                                                                  EstSetup.TESTFIELD("Item Sales Price Based On", EstSetup."Item Sales Price Based On"::GrossMin);
                                                                END;
                                                                CalculateTotals;
                                                                //DP00381.en
                                                              END;

                                                   CaptionML=[ENU=Sales Discount %;
                                                              NOR=Salgsrabattprosent;
                                                              SVE=FîrsÑljningsrabattprocent];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 480 ;   ;Price Reference Date;Date          ;CaptionML=[ENU=Price Reference Date;
                                                              NOR=Referansedato for pris;
                                                              SVE=PrissÑttningsdatum];
                                                   Editable=No }
    { 490 ;   ;Variable            ;Boolean       ;CaptionML=[ENU=Variable;
                                                              NOR=Variabel;
                                                              SVE=Variabel] }
    { 500 ;   ;Rate Type           ;Option        ;CaptionML=[ENU=Rate Type;
                                                              NOR=Avgiftstype;
                                                              SVE=Avgiftstyp];
                                                   OptionCaptionML=[ENU=Hours,Minuts;
                                                                    NOR=Timer,Minutter;
                                                                    SVE=Timmar,Minuter];
                                                   OptionString=Hours,Minuts;
                                                   Editable=No }
    { 510 ;   ;Team Size           ;Decimal       ;CaptionML=[ENU=Team Size;
                                                              NOR=Teamstõrrelse;
                                                              SVE=Teamstorlek];
                                                   Editable=No }
    { 520 ;   ;Time Quantity       ;Decimal       ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Time Quantity;
                                                              NOR=Tidskvantitet;
                                                              SVE=Tidskvantitet];
                                                   BlankZero=Yes }
    { 530 ;   ;Unit of Time        ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Unit of Time;
                                                              NOR=Tidsenhet;
                                                              SVE=Tidsenhet] }
    { 540 ;   ;Surcharge %         ;Decimal       ;OnValidate=BEGIN
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Surcharge %;
                                                              NOR=Tilleggsgebyrsprosent;
                                                              SVE=TillÑggsavgiftsprocent];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 545 ;   ;Surcharge Type      ;Option        ;OnValidate=BEGIN
                                                                IF "Surcharge Type" <> "Surcharge Type"::" " THEN BEGIN
                                                                  IF (xRec."Surcharge Type" = xRec."Surcharge Type"::" ") AND
                                                                     (Quantity + Norm + "Net Cost Price" <> 0) THEN
                                                                        ERROR(Text005);
                                                                  "Norm Group" := '';
                                                                  "Sub Operation Code" := '';
                                                                  InitAdjustmentFactor;
                                                                  EvaluateSurchargeCostType;  //db, 14-11-13:DP00381
                                                                END ELSE BEGIN
                                                                  ERROR(Text004);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Surcharge Type;
                                                              NOR=Tilleggsgebyrtype;
                                                              SVE=TillÑggsavgiftstyp];
                                                   OptionCaptionML=[ENU=" ,Labor,Material,Subcontracting,Plant,Sundry";
                                                                    NOR=" ,Arbeidskraft,Materiale,Underentrepenõr,Maskin,Diverse";
                                                                    SVE=" ,Arbetskraft,Material,Underentreprenad,Maskin,Diverse"];
                                                   OptionString=[ ,Labor,Material,Subcontracting,Plant,Sundry] }
    { 547 ;   ;Recipe Level        ;Integer       ;CaptionML=[ENU=Recipe Level;
                                                              NOR=MalnivÜ;
                                                              SVE=MallnivÜ] }
    { 550 ;   ;Line Status         ;Code10        ;TableRelation="Line Status".Status;
                                                   CaptionML=[ENU=Line Status;
                                                              NOR=Radstatus;
                                                              SVE=Radstatus] }
    { 552 ;   ;Subcontracting Activity;Code10     ;TableRelation="Subcontracting Activity".Code;
                                                   OnValidate=BEGIN
                                                                IF "Cost Type (Price)" <> "Cost Type (Price)"::Subcontracting THEN
                                                                  CheckCostTypePriceAllowed;  //db, 19-02-19
                                                                GetSubcontractorActivity(FIELDNO("Subcontracting Activity"));  //DP01958a
                                                              END;

                                                   CaptionML=ENU=Subcontracting Activity;
                                                   Description=DP01492-2 }
    { 555 ;   ;Subcontractor       ;Code20        ;TableRelation=IF (Subcontracting Activity=FILTER(='')) Vendor.No. WHERE (Subcontractor Type=FILTER(Subcontractor|Self Employed|Employment Agency))
                                                                 ELSE IF (Subcontracting Activity=FILTER(<>'')) "Subcontracting Activity Price"."Subcontractor No." WHERE (Subcontracting Activity=FIELD(Subcontracting Activity));
                                                   OnValidate=BEGIN
                                                                GetSubcontractorActivity(FIELDNO(Subcontractor));  //DP01958a
                                                              END;

                                                   CaptionML=[ENU=Subcontractor;
                                                              NOR=Underentreprenõr;
                                                              SVE=Underentreprenîr];
                                                   Description=DP01492-2 }
    { 556 ;   ;Subcontractor Name  ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Name WHERE (No.=FIELD(Subcontractor)));
                                                   CaptionML=[ENU=Subcontractor Name;
                                                              NOR=Underentreprenõrens navn;
                                                              SVE=Underentreprenîrens namn];
                                                   Editable=No }
    { 560 ;   ;Cumulative Hours    ;Decimal       ;CaptionML=[ENU=Cumulative Hours;
                                                              NOR=Akkumulerte timer;
                                                              SVE=Ackumulerade timmar] }
    { 565 ;   ;Cumulative Labor    ;Decimal       ;CaptionML=[ENU=Cumulative Labor;
                                                              NOR=Akkumulert arbeidskraft;
                                                              SVE=Ackumulerad arbetskraft];
                                                   AutoFormatType=1 }
    { 566 ;   ;Cumulative Net Amount;Decimal      ;CaptionML=ENU=Cumulative Net Amount;
                                                   AutoFormatType=1 }
    { 569 ;   ;Cumulative Buy Back ;Decimal       ;CaptionML=[ENU=Cumulative Buy Back;
                                                              NOR=Akkumulert Tilbakekjõp;
                                                              SVE=Ackumulerat Üterkîp];
                                                   AutoFormatType=1 }
    { 570 ;   ;Length              ;Decimal       ;OnValidate=BEGIN
                                                                CalculateQuantity;
                                                              END;

                                                   CaptionML=[ENU=Length;
                                                              NOR=Lengde;
                                                              SVE=LÑngd];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   CaptionClass='11012150,1' }
    { 571 ;   ;Width               ;Decimal       ;OnValidate=BEGIN
                                                                CalculateQuantity;
                                                              END;

                                                   CaptionML=[ENU=Width;
                                                              NOR=Bredde;
                                                              SVE=Bredd];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   CaptionClass='11012150,2' }
    { 572 ;   ;Height              ;Decimal       ;OnValidate=BEGIN
                                                                CalculateQuantity;
                                                              END;

                                                   CaptionML=[ENU=Height;
                                                              NOR=Hõyde;
                                                              SVE=Hîjd];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   CaptionClass='11012150,3' }
    { 575 ;   ;Weight              ;Decimal       ;OnValidate=BEGIN
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Weight;
                                                              NOR=Vekt;
                                                              SVE=Vikt];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 576 ;   ;Total Weight        ;Decimal       ;CaptionML=[ENU=Total Weight;
                                                              NOR=Totalvekt;
                                                              SVE=Viktsumma];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 577 ;   ;Cumulative Weight   ;Decimal       ;CaptionML=[ENU=Cumulative Weight;
                                                              NOR=Akkumulert Vekt;
                                                              SVE=Ackumulerad vikt];
                                                   DecimalPlaces=0:2 }
    { 580 ;   ;Uncoded Labor       ;Boolean       ;CaptionML=[ENU=Uncoded Labor;
                                                              NOR=Ukodet arbeidskraft;
                                                              SVE=Okodad arbetskraft];
                                                   Editable=No }
    { 581 ;   ;Uncoded Material    ;Boolean       ;CaptionML=[ENU=Uncoded Material;
                                                              NOR=Ukodat Materiale;
                                                              SVE=Okodat material];
                                                   Editable=No }
    { 582 ;   ;Uncoded Subcontracting;Boolean     ;CaptionML=[ENU=Uncoded Subcontracting;
                                                              NOR=Ukodet underentrepenõr;
                                                              SVE=Okodad underentreprenad];
                                                   Editable=No }
    { 583 ;   ;Uncoded Plant       ;Boolean       ;CaptionML=[ENU=Uncoded Plant;
                                                              NOR=Ukodet maskin;
                                                              SVE=Okodad Maskin];
                                                   Editable=No }
    { 584 ;   ;Uncoded Line        ;Boolean       ;CaptionML=[ENU=Uncoded Line;
                                                              NOR=Ukodet Rad;
                                                              SVE=Okodad rad];
                                                   Editable=No }
    { 590 ;   ;Adjustment Factor Hours;Decimal    ;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(1,1);  //DP00555
                                                              END;

                                                   CaptionML=[ENU=Hours Adjustment Factor;
                                                              NOR=Timejusteringsfaktor;
                                                              SVE=Timjusteringsfaktor];
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 591 ;   ;Adjustment Factor Price;Decimal    ;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(2,1);  //DP00555
                                                              END;

                                                   CaptionML=ENU=Price Adjustment Factor;
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 595 ;   ;Cum. Adj. Factor Hours;Decimal     ;CaptionML=[ENU=Hours Cum. Adjustment Factor;
                                                              NOR=Timer Akkumulert Justeringsfaktor;
                                                              SVE=Timmar ackum. Justeringsfaktor];
                                                   DecimalPlaces=0:6 }
    { 596 ;   ;Cum. Adj. Factor Price;Decimal     ;CaptionML=ENU=Price Cum. Adj. Factor;
                                                   DecimalPlaces=0:6 }
    { 600 ;   ;External Text       ;Text250       ;OnValidate=BEGIN
                                                                "External Text Block" := "External Text" <> '';
                                                              END;

                                                   CaptionML=[ENU=External Text;
                                                              NOR=Ekstern Tekst;
                                                              SVE=Extern text] }
    { 601 ;   ;External Text Block ;Boolean       ;CaptionML=[ENU=External Text Block;
                                                              NOR=Ekstern Tekstblokk;
                                                              SVE=Externt textblock];
                                                   Editable=No }
    { 605 ;   ;Internal Text       ;Text250       ;OnValidate=BEGIN
                                                                "Internal Text Block" := "Internal Text" <> '';
                                                              END;

                                                   CaptionML=[ENU=Internal Text;
                                                              NOR=Intern tekst;
                                                              SVE=Intern text] }
    { 606 ;   ;Internal Text Block ;Boolean       ;CaptionML=[ENU=Internal Text Block;
                                                              NOR=Intern tekstblokkering;
                                                              SVE=Internt textblock];
                                                   Editable=No }
    { 620 ;   ;Ask for Quote       ;Boolean       ;OnValidate=BEGIN
                                                                "Ask for Quote" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=Ask for Quote;
                                                              NOR=Be om tilbud;
                                                              SVE=BegÑr offert] }
    { 630 ;   ;Purchase Route Reference;Code20    ;OnLookup=BEGIN
                                                              //lvRouteRefMgtCU.ShowReferenceList("Purchase Route Reference");
                                                            END;

                                                   CaptionML=[ENU=Purchase Route Reference;
                                                              NOR=Referanse for Innkjõpsrute;
                                                              SVE=Referens fîr inkîpsfîljd];
                                                   Editable=No }
    { 640 ;   ;Document No.        ;Code20        ;TableRelation="Document Properties";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Document No.;
                                                              NOR=Dokumentnr.;
                                                              SVE=Verifikationsnr] }
    { 650 ;   ;Code                ;Code20        ;OnValidate=VAR
                                                                CodingSystem@1210190005 : Record 11012088;
                                                              BEGIN
                                                                RecipeRec.GET("Recipe Group", Recipe);
                                                                RecipeRec.TESTFIELD("Coding System");

                                                                IF Code <> '' THEN BEGIN
                                                                  CodingSystem.GET(RecipeRec."Coding System");
                                                                  IF CodingSystem."Deviant Code allowed" = FALSE THEN BEGIN  //db, 26-06-15
                                                                    FormatMgt.SetSelection(RecipeRec."Coding System");
                                                                    FormatMgt.FormatElem(Code,4,'');
                                                                    CodeRec.GET(RecipeRec."Coding System", Code);
                                                                  END;
                                                                END;

                                                                EstCodeRec.RESET;
                                                                EstCodeRec.SETFILTER("Estimate No.", '%1', '');
                                                                EstCodeRec.SETFILTER("Sub-Estimate No.", '%1', '');
                                                                EstCodeRec.SETFILTER("Part Group", '%1', '');
                                                                EstCodeRec.SETFILTER(Part, '%1', '');
                                                                EstCodeRec.SETRANGE("Estimate Line", 0);
                                                                EstCodeRec.SETRANGE("Recipe Group", "Recipe Group");
                                                                EstCodeRec.SETRANGE(Recipe, Recipe);
                                                                EstCodeRec.SETRANGE("Recipe Line", "Line No.");
                                                                EstCodeRec.SETRANGE("Coding System", RecipeRec."Coding System");
                                                                EstCodeRec.DELETEALL;

                                                                IF Code <> '' THEN BEGIN
                                                                  EstCodeRec.INIT;
                                                                  EstCodeRec."Recipe Group" := "Recipe Group";
                                                                  EstCodeRec.Recipe := Recipe;
                                                                  EstCodeRec."Recipe Line" := "Line No.";
                                                                  EstCodeRec."Coding System" := RecipeRec."Coding System";
                                                                  EstCodeRec.Code := Code;
                                                                  EstCodeRec.INSERT;
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              RecipeRec.GET("Recipe Group", Recipe);
                                                              RecipeRec.TESTFIELD("Coding System");
                                                              CodeRec.SETRANGE("Coding System", RecipeRec."Coding System");

                                                              CodeRec.Code := Code;
                                                              IF RecipeRec.Fixed THEN
                                                                PAGE.RUNMODAL(PAGE::"Codes per Coding System", CodeRec)
                                                              ELSE
                                                                IF PAGE.RUNMODAL(PAGE::"Codes per Coding System", CodeRec) = ACTION::LookupOK THEN
                                                                  VALIDATE(Code, CodeRec.Code);
                                                            END;

                                                   CaptionML=[ENU=Code;
                                                              NOR=Kode;
                                                              SVE=Kod] }
    { 660 ;   ;Price Agreement     ;Boolean       ;CaptionML=[ENU=Price Agreement;
                                                              NOR=Prisavtale;
                                                              SVE=Prisavtal] }
    { 661 ;   ;Norm Agreement      ;Boolean       ;CaptionML=[ENU=Norm Agreement;
                                                              NOR=Normavtale;
                                                              SVE=Normavtal] }
    { 670 ;   ;Vendor              ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[ENU=Vendor;
                                                              NOR=Leverandõr;
                                                              SVE=Leverantîrsnamn] }
    { 671 ;   ;Vendor Name         ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Name WHERE (No.=FIELD(Vendor)));
                                                   CaptionML=[ENU=Vendor Name;
                                                              NOR=Leverandõrnavn;
                                                              SVE=Leverantîrsnamn];
                                                   Editable=No }
    { 680 ;   ;Discipline          ;Code10        ;TableRelation=Discipline;
                                                   CaptionML=[ENU=Discipline;
                                                              NOR=Disiplin;
                                                              SVE=Disciplin] }
    { 685 ;   ;Trade Speciality    ;Code10        ;TableRelation="Trade Speciality".Code WHERE (Discipline=FIELD(Discipline));
                                                   CaptionML=[ENU=Trade Speciality;
                                                              NOR=SNI-nummer;
                                                              SVE=SNI-nummer] }
    { 690 ;   ;Trade Expertise     ;Code10        ;TableRelation="Trade Expertise";
                                                   OnValidate=BEGIN
                                                                TradeExpRec.GetRelatedValue(Discipline, "Trade Speciality", "Trade Expertise");
                                                              END;

                                                   CaptionML=[ENU=Trade Expertise;
                                                              NOR=Bransjeekspertise;
                                                              SVE=Branschexpertis] }
    { 700 ;   ;Recipe (Child)      ;Code20        ;TableRelation="Base Recipe".No. WHERE (Recipe Group=FIELD("Recipe Group (Child)"));
                                                   OnValidate=VAR
                                                                RecipeHeader@1100529500 : Record 11020581;
                                                              BEGIN
                                                                CheckParentChildRecipe("Recipe Group (Child)", "Recipe (Child)");

                                                                IF "Recipe (Child)" <> '' THEN BEGIN
                                                                  IF "Cost Type (Price)" <> "Cost Type (Price)"::" " THEN
                                                                    CheckCostTypePriceAllowed;
                                                                  "Rate Code" := '';  //db, 05-11-15: C026570 (calculate average wage based on LaborAmount/Hours)
                                                                  RecipeRec.GET("Recipe Group (Child)", "Recipe (Child)");
                                                                  RecipeRec.CALCFIELDS(Hours, "Labor Cost Amount",
                                                                    "Gross Amount", "Material Cost Amount", "Subcontracting Cost Amount", "Plant Cost Amount", "Sundry Cost Amount");
                                                                  RecipeRec.CALCFIELDS("Labor Sales Amount",
                                                                    "Material Sales Amount", "Subcontracting Sales Amount", "Plant Sales Amount", "Sundry Sales Amount");  //db, 28-10-13: DP00381
                                                                END ELSE BEGIN
                                                                  CLEAR(RecipeRec);
                                                                END;

                                                                Description := RecipeRec.Description;
                                                                "Unit of Measure" := RecipeRec."Unit of Measure";
                                                                Norm := RecipeRec.Hours;
                                                                "Norm Group" := '';  //db, 24-06-14: C010709
                                                                IF Norm <> 0 THEN
                                                                  "Production Rate" := 1 / Norm
                                                                ELSE
                                                                  "Production Rate" := 0;
                                                                //C033781.sn
                                                                IF "Recipe (Child)" <> '' THEN BEGIN
                                                                  "Surcharge % Price" := 0;
                                                                  IF NOT SkipUpdateSurcharge THEN BEGIN  //validate also called from UpdateRelatedRecipe
                                                                    RecipeHeader.GET("Recipe Group", Recipe);
                                                                    "Surcharge % Labor" := RecipeHeader."Surcharge % Labor";
                                                                    "Recipe Surcharge % Material" := RecipeHeader."Surcharge % Material";
                                                                    "Recipe Surcharge % Subc." := RecipeHeader."Surcharge % Subcontracting";
                                                                    "Recipe Surcharge % Plant" := RecipeHeader."Surcharge % Plant";
                                                                    "Recipe Surcharge % Sundry" := RecipeHeader."Surcharge % Sundry";
                                                                  END;
                                                                END;
                                                                //C033781.en
                                                                "Net Cost Price" := RecipeRec."Material Cost Amount" + RecipeRec."Subcontracting Cost Amount" +
                                                                  RecipeRec."Plant Cost Amount" + RecipeRec."Sundry Cost Amount";
                                                                "Gross Price" := RecipeRec."Gross Amount";   //db, 05-11-15: C026570 (filter on CostType disabled in flowfield)
                                                                "Net Sales Price" := RecipeRec."Material Sales Amount" + RecipeRec."Subcontracting Sales Amount" +
                                                                  RecipeRec."Plant Sales Amount" + RecipeRec."Sundry Sales Amount";  //db, 28-10-13: DP00381
                                                                //DP02114.sn
                                                                "Net Cost Price (FCY)" := ExchangeAmtLCYToFCY("Net Cost Price", FALSE, TRUE, FALSE);
                                                                "Gross Price (FCY)" := ExchangeAmtLCYToFCY("Gross Price", FALSE, TRUE, FALSE);
                                                                "Net Sales Price (FCY)" := ExchangeAmtLCYToFCY("Net Sales Price", FALSE, TRUE, FALSE);
                                                                //DP02114.en

                                                                //CheckDefaultRate;  //DP00381
                                                                IF "Rate Code" = '' THEN BEGIN
                                                                  IF RecipeRec.Hours = 0 THEN BEGIN
                                                                    "Cost Rate" := 0;
                                                                    "Cost Rate (FCY)" := 0;
                                                                    "Sales Rate" := 0;
                                                                    "Sales Rate (FCY)" := 0;
                                                                  END ELSE BEGIN
                                                                    "Cost Rate" := RecipeRec."Labor Cost Amount" / RecipeRec.Hours;
                                                                    "Cost Rate (FCY)" := ExchangeAmtLCYToFCY(RecipeRec."Labor Cost Amount", FALSE, TRUE, FALSE) / RecipeRec.Hours;
                                                                    "Sales Rate" := RecipeRec."Labor Sales Amount" / RecipeRec.Hours;  //db, 28-10-13: DP00381
                                                                    "Sales Rate (FCY)" := ExchangeAmtLCYToFCY(RecipeRec."Labor Sales Amount", FALSE, TRUE, FALSE) / RecipeRec.Hours;
                                                                  END;
                                                                END ELSE BEGIN
                                                                  xRec."Rate Type" := "Rate Type"::Hours;
                                                                  xRec."Team Size" := 0;
                                                                  VALIDATE("Rate Code");
                                                                END;

                                                                CalculateDiscount(FALSE);
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Recipe (Child);
                                                              NOR=Mal (Underordnet);
                                                              SVE=Mall (underordnad)] }
    { 705 ;   ;Recipe Header       ;Boolean       ;CaptionML=[ENU=Recipe Header;
                                                              NOR=Maltittel;
                                                              SVE=Mallrubrik] }
    { 710 ;   ;Recipe Group (Child);Code10        ;TableRelation="Recipe Group".No.;
                                                   CaptionML=[ENU=Recipe Group (Child);
                                                              NOR=Maltype (Underordnet);
                                                              SVE=Malltyp (underordnad)] }
    { 720 ;   ;Additional Cost     ;Boolean       ;CaptionML=[ENU=Additional Cost;
                                                              NOR=Tilleggskoster;
                                                              SVE=TillÑggskostnader] }
    { 740 ;   ;Removal Contribution;Boolean       ;CaptionML=[ENU=Removal Contribution;
                                                              NOR=Fjerningsbidrag;
                                                              SVE=Borttagningsbidrag] }
    { 750 ;   ;Cost Component      ;Code20        ;TableRelation="Cost Component".Code;
                                                   CaptionML=[ENU=Cost Component;
                                                              NOR=Kostnadskomponent;
                                                              SVE=Kostnadsdel] }
    { 755 ;   ;Comments            ;Text50        ;CaptionML=[ENU=Comments;
                                                              NOR=Merknader;
                                                              SVE=Kommentar] }
    { 770 ;   ;Supply              ;Boolean       ;CaptionML=[ENU=Supply;
                                                              NOR=Tilfõrsel;
                                                              SVE=FîrrÜd] }
    { 780 ;   ;Comments for Logistics;Text50      ;CaptionML=[ENU=Comments for Logistics;
                                                              NOR=Kommentarer for logistikk;
                                                              SVE=Kommentarer fîr logistik] }
    { 790 ;   ;Material Sheet      ;Option        ;CaptionML=[ENU=Material Sheet;
                                                              NOR=Materialeark;
                                                              SVE=Materialark];
                                                   OptionCaptionML=[ENU=Customer and Assemly,Customer Only,Assembly only,Do not report;
                                                                    NOR="Kunde og montering,Kun kunde,Kun montering,Ikke Rapporter ";
                                                                    SVE=Kund och montering,Endast kund,Endast montering,Rapportera inte];
                                                   OptionString=Customer and Assemly,Customer Only,Assembly only,Do not report }
    { 791 ;   ;Scheme Code         ;Code15        ;CaptionML=[ENU=Scheme Code;
                                                              NOR=Plankode;
                                                              SVE=Plankod] }
    { 808 ;   ;Object Type         ;Text30        ;CaptionML=[ENU=Object Type;
                                                              NOR=Objekttype;
                                                              SVE=Objekttyp] }
    { 809 ;   ;Object Brand        ;Text30        ;CaptionML=[ENU=Object Brand;
                                                              NOR=Objektsmerke;
                                                              SVE=ObjektsmÑrke] }
    { 930 ;   ;Admicode            ;Code10        ;TableRelation="Admi Code";
                                                   OnValidate=VAR
                                                                lvAdmiCodeRec@1100485000 : Record 11012390;
                                                              BEGIN
                                                                IF Admicode <> '' THEN BEGIN
                                                                  lvAdmiCodeRec.GET(Admicode);
                                                                  IF Description = '' THEN
                                                                    Description := lvAdmiCodeRec.Description;
                                                                  //DP00381.sn
                                                                  IF ("Cost Object Price" = '') THEN BEGIN
                                                                    IF ("Cost Type (Price)"= "Cost Type (Price)"::Material) AND (lvAdmiCodeRec."Cost Object Material" <> '') THEN
                                                                      GetDefaultsCostObject(gvCostType::Material, lvAdmiCodeRec."Cost Object Material");
                                                                    IF ("Cost Type (Price)"= "Cost Type (Price)"::Subcontracting) AND (lvAdmiCodeRec."Cost Object Subcontracting" <> '') THEN
                                                                      GetDefaultsCostObject(gvCostType::Subcontracting, lvAdmiCodeRec."Cost Object Subcontracting");
                                                                    IF ("Cost Type (Price)"= "Cost Type (Price)"::Plant) AND (lvAdmiCodeRec."Cost Object Plant" <> '') THEN
                                                                      GetDefaultsCostObject(gvCostType::Plant, lvAdmiCodeRec."Cost Object Plant");
                                                                    IF ("Cost Type (Price)"= "Cost Type (Price)"::Sundry) AND (lvAdmiCodeRec."Cost Object Sundry" <> '') THEN
                                                                      GetDefaultsCostObject(gvCostType::Sundry, lvAdmiCodeRec."Cost Object Sundry");
                                                                  END;
                                                                  //DP00381.en
                                                                 END;
                                                              END;

                                                   CaptionML=[ENU=Admi Code;
                                                              NOR=Admi-kode;
                                                              SVE=Admi-kod] }
    { 940 ;   ;Purchase Action     ;Code10        ;CaptionML=[ENU=Purchase Action;
                                                              NOR=Innkjõpshandling, Materiale;
                                                              SVE=InkîpsÜtgÑrdsmaterial] }
    { 950 ;   ;Purchase Action Filter;Code10      ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Purchase Action Filter;
                                                              NOR=Innkjõpshandlingsfilter, Materiale;
                                                              SVE=InkîpsÜtgÑrdsfilter, material] }
    { 960 ;   ;Purchase Phase      ;Code10        ;CaptionML=[ENU=Purchase Phase;
                                                              NOR=Innkjõpsfase, Materiale;
                                                              SVE=Inkîpsfas, material];
                                                   Numeric=Yes }
    { 970 ;   ;Purchase Action Status;Option      ;CaptionML=[ENU=Purchase Action Status;
                                                              NOR=Innkjõpshandlingsstatus, Materiale;
                                                              SVE=InkîpsÜtgÑrdsstatus, material];
                                                   OptionCaptionML=[ENU=Concept,Applied,Approved,Definitive;
                                                                    NOR=Konsept,Anvendt,Godkjent,Definitiv;
                                                                    SVE=Koncept,TillÑmpat,GodkÑnt,Definitiv];
                                                   OptionString=Concept,Applied,Approved,Definitive;
                                                   Editable=No }
    { 980 ;   ;Purch. Action Appr. Date;Date      ;CaptionML=[ENU=Purch. Action Approval Date;
                                                              NOR=Godkjenningsdato for for Innkjõpshandling, Materiale;
                                                              SVE=Inkîp GodkÑnnandedatum fîr ÜtgÑrd, material];
                                                   Editable=No }
    { 990 ;   ;Advised             ;Boolean       ;CaptionML=[ENU=Advised;
                                                              NOR=ForeslÜtt Materiale;
                                                              SVE=Fîreslaget material] }
    { 1000;   ;PurchAction Subc. OLD;Code10       ;CaptionML=[ENU=Purchase Action Subcontracting OLD;
                                                              NOR=Innkjõpshandling, underentrepenõr;
                                                              SVE=InkîpsÜtgÑrd, underentreprenad];
                                                   Description=DP01676: expired }
    { 1010;   ;PurchAction Filter Subc. OLD;Code10;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Purchase Action Filter Subcontracting OLD;
                                                              NOR=Innkjõpshandlingsfilter, underentrepenõr;
                                                              SVE=InkîpsÜtgÑrdsfilter, underentreprenad];
                                                   Description=DP01676: expired }
    { 1020;   ;PurchPhase Subc. OLD;Code10        ;CaptionML=[ENU=Purchase Phase Subcontracting OLD;
                                                              NOR=Innkjõpsfase, underentrepenõr;
                                                              SVE=Inkîpsfas, underentreprenad];
                                                   Numeric=Yes;
                                                   Description=DP01676: expired }
    { 1030;   ;PurchAction Status Subc. OLD;Option;CaptionML=[ENU=Purchase Action Status Subcontracting OLD;
                                                              NOR=Innkjõpshandlingsstatus, underentrepenõr;
                                                              SVE=InkîpsÜtgÑrdsstatus, underentreprenad];
                                                   OptionCaptionML=[ENU=Concept,Applied,Approved,Definitive;
                                                                    NOR=Konsept,Anvendt,Godkjent,Definitiv;
                                                                    SVE=Koncept,TillÑmpat,GodkÑnt,Definitiv];
                                                   OptionString=Concept,Applied,Approved,Definitive;
                                                   Description=DP01676: expired;
                                                   Editable=No }
    { 1040;   ;PurchAction ApprDate Subc. OLD;Date;CaptionML=[ENU=Purch. Action Approval Date Subcontracting OLD;
                                                              NOR=Innkjõpshandling Godkjenningsdato , underentrepenõr;
                                                              SVE=Inkîp GodkÑnnandedatum fîr ÜtgÑrd, underentreprenad];
                                                   Description=DP01676: expired;
                                                   Editable=No }
    { 1050;   ;Advised Subc. OLD   ;Boolean       ;CaptionML=[ENU=Advised Subcontracting OLD;
                                                              NOR=ForeslÜtt underentrepenõr;
                                                              SVE=Fîreslagen underentreprenad];
                                                   Description=DP01676: expired }
    { 1060;   ;PurchAction Plant OLD;Code10       ;CaptionML=[ENU=Purchase Action Plant OLD;
                                                              NOR=Innkjõpshandling for maskin;
                                                              SVE=InkîpsÜtgÑrd fîr Maskin];
                                                   Description=DP01676: expired }
    { 1070;   ;PurchAction Filter Plant OLD;Code10;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Purchase Action Filter Plant OLD;
                                                              NOR=Innkjõpshandlingsfilter, maskin;
                                                              SVE=InkîpsÜtgÑrdsfilter, Maskin];
                                                   Description=DP01676: expired }
    { 1080;   ;PurchPhase Plant OLD;Code10        ;CaptionML=[ENU=Purchase Phase Plant OLD;
                                                              NOR=Innkjõpsfase, maskin;
                                                              SVE=Inkîpsfas, Maskin];
                                                   Numeric=Yes;
                                                   Description=DP01676: expired }
    { 1090;   ;PurchAction Status Plant OLD;Option;CaptionML=[ENU=Purchase Action Status Plant OLD;
                                                              NOR=Innkjõpshandlingsstatus, maskin;
                                                              SVE=InkîpsÜtgÑrdsstatus, Maskin];
                                                   OptionCaptionML=[ENU=Concept,Applied,Approved,Definitive;
                                                                    NOR=Konsept,Anvendt,Godkjent,Definitiv;
                                                                    SVE=Koncept,TillÑmpat,GodkÑnt,Definitiv];
                                                   OptionString=Concept,Applied,Approved,Definitive;
                                                   Description=DP01676: expired;
                                                   Editable=No }
    { 1100;   ;PurchAction ApprDate Plant OLD;Date;CaptionML=[ENU=Purch. Action Approval Date Plant OLD;
                                                              NOR=Innkjõpshandling Godkjenningsdato, maskin;
                                                              SVE=Inkîp GodkÑnnandedatum fîr ÜtgÑrd, Maskin];
                                                   Description=DP01676: expired;
                                                   Editable=No }
    { 1110;   ;Advised Plant OLD   ;Boolean       ;CaptionML=[ENU=Advised Plant OLD;
                                                              NOR=ForeslÜtt maskin;
                                                              SVE=Fîreslagen Maskin];
                                                   Description=DP01676: expired }
    { 1120;   ;Ignore Recipe Quantity;Boolean     ;OnValidate=BEGIN
                                                                //db.so, 03-11-11: M27731
                                                                //IF MODIFY THEN;  //db, 27-05-10: M13221;
                                                                //db.eo, 03-11-11: M27731
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Ignore Recipe Quantity;
                                                              NOR=Ignorer Malantall;
                                                              SVE=Ignorera mallantal] }
    { 1130;   ;Rates Based On      ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Estimate Setup"."Rates Based On");
                                                   CaptionML=[ENU=Rates Based On;
                                                              NOR=Avgifter basert pÜ;
                                                              SVE=Avgifter baseras pÜ];
                                                   OptionCaptionML=[ENU=Rate Group,Budget Rate;
                                                                    NOR=Satsgruppe,Budsjettsats;
                                                                    SVE=Kostnadsgrupp,Budgetavgift];
                                                   OptionString=Rate Group,Budget Rate;
                                                   Editable=No }
    { 1140;   ;Wage Component      ;Code10        ;TableRelation="Wage Component";
                                                   CaptionML=[ENU=Wage Component;
                                                              NOR=Lõnnsart;
                                                              SVE=Lîneart] }
    { 1150;   ;Price History 0 Exists;Boolean     ;CaptionML=ENU=Price History 0 Exists;
                                                   Editable=No }
    { 1160;   ;Quantity Sheet Feature;Code10      ;TableRelation="Est. Quantity Sheet Feature";
                                                   CaptionML=ENU=Quantity Sheet Feature }
    { 1215;   ;Part of Line        ;Integer       ;TableRelation="Base Recipe Line"."Line No." WHERE (Recipe Group=FIELD(Recipe Group),
                                                                                                      Recipe=FIELD(Recipe));
                                                   OnValidate=BEGIN
                                                                DetermineBOMLevel("Part of Line","Level BOM");
                                                              END;

                                                   CaptionML=[ENU=Part of Line;
                                                              NOR=Del av Rad;
                                                              SVE=Del av rad];
                                                   Description=BOM }
    { 1220;   ;Original Quantity   ;Decimal       ;CaptionML=[ENU=Original Quantity BOM;
                                                              NOR=Opprinnelig antall Õ stykkliste];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=BOM }
    { 1225;   ;Level BOM           ;Integer       ;CaptionML=[ENU=Level BOM;
                                                              NOR=NivÜ Õ stykkliste;
                                                              SVE=NivÜstruktur];
                                                   Description=BOM;
                                                   Editable=No }
    { 1230;   ;BOM Item No.        ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=BOM Item No.;
                                                              NOR=Strukturartikkelnr;
                                                              SVE=Strukturartikelnr];
                                                   Description=BOM }
    { 1500;   ;Plant Rates in Hours;Boolean       ;OnValidate=BEGIN
                                                                //C053751.sn
                                                                IF "Cost Type (Price)" = "Cost Type (Price)"::Plant THEN BEGIN
                                                                  IF NOT "Plant Rates in Hours" THEN BEGIN
                                                                    CLEAR("Cost Type (Hours)");
                                                                    Quantity := Hours;
                                                                    //"Quantity (Sales)" := "Hours (Sales)";
                                                                    InitNormRelatedFields(0);
                                                                  END ELSE BEGIN
                                                                    "Cost Type (Hours)" := "Cost Type (Hours)"::Plant;
                                                                    InitNormRelatedFields(1);
                                                                  END;
                                                                END;
                                                                //C053751.en
                                                                DeterminePlantPrice;
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Plant Rates in Hours;
                                                              NOR=Maskingebyrer i timer;
                                                              SVE=Maskinavgifter i timmar];
                                                   Description=DP01492-5 }
    { 1510;   ;Subcontracting in Hours;Boolean    ;OnValidate=BEGIN
                                                                //C053751.sn
                                                                IF "Cost Type (Price)" = "Cost Type (Price)"::Subcontracting THEN BEGIN
                                                                  IF NOT "Subcontracting in Hours" THEN BEGIN
                                                                    CLEAR("Cost Type (Hours)");
                                                                    Quantity := Hours;
                                                                    //"Quantity (Sales)" := "Hours (Sales)";
                                                                    InitNormRelatedFields(0);
                                                                  END ELSE BEGIN
                                                                    "Cost Type (Hours)" := "Cost Type (Hours)"::Subcontracting;
                                                                    InitNormRelatedFields(1);
                                                                  END;
                                                                END;
                                                                //C053751.en
                                                                CalculateTotals;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Subcontracting in Hours;
                                                   Description=C053751 }
    { 2000;   ;Cost Type (Price)   ;Option        ;InitValue=Material;
                                                   OnValidate=BEGIN
                                                                //DP00381
                                                                IF CurrFieldNo = FIELDNO("Cost Type (Price)") THEN BEGIN  //db, 17-03-14: C012735
                                                                  GetEstSetup;  //DP01183
                                                                  IF "Cost Type (Price)" <> "Cost Type (Price)"::" " THEN BEGIN
                                                                    TESTFIELD("Recipe (Child)", '');
                                                                    TESTFIELD("Item No.", '');
                                                                    TESTFIELD("Basic Item", '');
                                                                    TESTFIELD("Trade Item", '');
                                                                    TESTFIELD("Plant Type", '');
                                                                    TESTFIELD("Set Code", '');
                                                                    TESTFIELD("Subcontracting Activity", '');
                                                                    IF ("Cost Type (Price)" = "Cost Type (Price)"::Plant) OR
                                                                       ("Cost Type (Price)" = "Cost Type (Price)"::Subcontracting) THEN BEGIN  //C061168
                                                                      "Rate Code":= '';
                                                                      InitRateRelatedFields;
                                                                    END;
                                                                    IF "Cost Type (Price)" <> "Cost Type (Price)"::Plant THEN
                                                                      TESTFIELD("Cost Type (Hours)", "Cost Type (Hours)"::Labor);  //C038168
                                                                  END ELSE BEGIN
                                                                    "Cost Object Price" := '';
                                                                  END;
                                                                  GetAbsenceValue;  //C050221
                                                                END;
                                                                //InitSurcharge(TRUE);  //DP00594
                                                                IF CurrFieldNo = FIELDNO("Cost Type (Price)") THEN BEGIN //db, 17-03-14: C012735
                                                                  InitSurcharge(TRUE);  //db, 26-05-14: C015031
                                                                  CalculateTotals;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Cost Type (Price);
                                                   OptionCaptionML=[ENU=" ,Material,Subcontracting,Plant,Sundry";
                                                                    SVE=" ,Material,Underentreprenad,Maskin,Diverse"];
                                                   OptionString=[ ,Material,Subcontracting,Plant,Sundry] }
    { 2005;   ;Cost Type (Hours)   ;Option        ;OnValidate=BEGIN
                                                                //DP01047
                                                                IF CurrFieldNo = FIELDNO("Cost Type (Hours)") THEN BEGIN
                                                                  IF "Cost Type (Hours)" <> "Cost Type (Hours)"::Labor THEN BEGIN
                                                                    IF "Cost Type (Hours)" = "Cost Type (Hours)"::Plant THEN  //DP01676
                                                                      TESTFIELD("Plant Rates in Hours",TRUE);  //DP01492
                                                                    IF "Cost Type (Hours)" = "Cost Type (Hours)"::Subcontracting THEN
                                                                      TESTFIELD("Subcontracting in Hours",TRUE);  //C053751
                                                                    VALIDATE("Rate Code", '');
                                                                  END;
                                                                  IF "Cost Type (Hours)" = "Cost Type (Hours)"::Plant THEN
                                                                    TESTFIELD("Cost Type (Price)", "Cost Type (Price)"::Plant);  //C038168
                                                                  IF "Cost Type (Hours)" = "Cost Type (Hours)"::Subcontracting THEN
                                                                    TESTFIELD("Cost Type (Price)", "Cost Type (Price)"::Subcontracting);  //C053751
                                                                  CalculateTotals;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Cost Type (Hours);
                                                   OptionCaptionML=ENU=Labor,,Subcontracting,Plant;
                                                   OptionString=Labor,,Subcontracting,Plant;
                                                   Description=DP01047+DP01676 }
    { 2010;   ;Net Sales Price     ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT SkipValidateFCY THEN
                                                                  "Net Sales Price (FCY)" := ExchangeAmtLCYToFCY("Net Sales Price", TRUE, TRUE, FALSE);  //DP02114
                                                                CalculateDiscount(TRUE);
                                                                EstimateMgmt.CalcBuyBackRates("Item No.","Plant Type",'',0,"Net Sales Price","Buy Back Price","Buy Back %");  //C061014
                                                                "Buy Back Price (FCY)" := ExchangeAmtLCYToFCY("Buy Back Price", FALSE, TRUE, FALSE);
                                                                IF "Net Sales Price" = 0 THEN
                                                                  "Sales Discount %" := 0;  //db, 11-11-13: DP00260 (C005807): (empty sales price/discount for items)
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=ENU=Net Sales Price;
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 2040;   ;Sales Rate          ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Code" = '' THEN
                                                                  "Sales Rate (FCY)" := ExchangeAmtLCYToFCY("Sales Rate", TRUE, TRUE, FALSE);  //DP02114
                                                              END;

                                                   CaptionML=[ENU=Sales Rate;
                                                              NOR=Salgsrate;
                                                              SVE=FîrsÑljningsavgift];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 2060;   ;Surcharge % Labor   ;Decimal       ;OnValidate=BEGIN
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Labor;
                                                              NOR=Tilleggsgebyrsprosent, arbeidskraft;
                                                              SVE=TillÑggsavgiftsprocent, arbetskraft];
                                                   BlankZero=Yes }
    { 2065;   ;Surcharge % Price   ;Decimal       ;OnValidate=BEGIN
                                                                IF "Surcharge % Price" <> 0 THEN TESTFIELD("Recipe (Child)", '');  //C033781
                                                                //CheckSurchargeMaterialPrice;  //db, 26-05-14: C015031
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=ENU=Surcharge % Price;
                                                   BlankZero=Yes }
    { 2066;   ;Recipe Surcharge % Material;Decimal;OnValidate=BEGIN
                                                                IF "Recipe Surcharge % Material" <> 0 THEN TESTFIELD("Recipe (Child)");  //C033781
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=ENU=Recipe Surcharge % Material;
                                                   BlankZero=Yes;
                                                   Description=C033781 }
    { 2067;   ;Recipe Surcharge % Subc.;Decimal   ;OnValidate=BEGIN
                                                                IF "Recipe Surcharge % Subc." <> 0 THEN TESTFIELD("Recipe (Child)");  //C033781
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=ENU=Recipe Surcharge % Subcontracting;
                                                   BlankZero=Yes;
                                                   Description=C033781 }
    { 2068;   ;Recipe Surcharge % Plant;Decimal   ;OnValidate=BEGIN
                                                                IF "Recipe Surcharge % Plant" <> 0 THEN TESTFIELD("Recipe (Child)");  //C033781
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=ENU=Recipe Surcharge % Plant;
                                                   BlankZero=Yes;
                                                   Description=C033781 }
    { 2069;   ;Recipe Surcharge % Sundry;Decimal  ;OnValidate=BEGIN
                                                                IF "Recipe Surcharge % Sundry" <> 0 THEN TESTFIELD("Recipe (Child)");  //C033781
                                                                CalculateTotals;
                                                              END;

                                                   CaptionML=ENU=Recipe Surcharge % Sundry;
                                                   BlankZero=Yes;
                                                   Description=C033781 }
    { 2100;   ;Labor Sales Amount  ;Decimal       ;CaptionML=[ENU=Labor Sales Amount;
                                                              NOR=Belõp salg arbied;
                                                              SVE=Arbetskraft fîrsÑljningsbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 2110;   ;Net Sales Amount    ;Decimal       ;CaptionML=ENU=Net Sales Amount;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 2115;   ;Hours (Sales)       ;Decimal       ;CaptionML=[ENU=Hours (Sales);
                                                              SVE=Timmar];
                                                   DecimalPlaces=2:;
                                                   Editable=No }
    { 2200;   ;Sales Amount        ;Decimal       ;CaptionML=[ENU=Sales Amount;
                                                              NOR=Salgsbelõp;
                                                              SVE=FîrsÑljningsbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 2340;   ;Price Agreement (Sales);Boolean    ;CaptionML=ENU=Price Agreement (Sales) }
    { 2345;   ;Norm Agreement (Sales);Boolean     ;CaptionML=ENU=Norm Agreement (Sales) }
    { 2350;   ;Adj. Factor Hours (Sales);Decimal  ;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(1,2);  //DP00555
                                                              END;

                                                   CaptionML=ENU=Hours Adjustment Factor (Sales);
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 2360;   ;Cum. Adj. Factor Hours (Sales);Decimal;
                                                   CaptionML=ENU=Cum. Hours Adjustment Factor (Sales);
                                                   DecimalPlaces=0:6 }
    { 3000;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                CheckCurrencyAgreement;
                                                                VALIDATE("Rate Code");
                                                                VALIDATE("Gross Price");
                                                                "Gross Price (FCY)" := ExchangeAmtLCYToFCY("Gross Price", FALSE, TRUE, FALSE);
                                                                CalculateTotals;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Currency Code;
                                                              SVE=Valutakod];
                                                   Description=DP02114 }
    { 3001;   ;Currency Agreement  ;Boolean       ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Currency Agreement;
                                                              SVE=Valuta avtal];
                                                   Description=DP02114 }
    { 3010;   ;Net Cost Price (FCY);Decimal       ;OnValidate=BEGIN
                                                                SetSkipValidateFCY(TRUE);
                                                                VALIDATE("Net Cost Price", ExchangeAmtFCYToLCY("Net Cost Price (FCY)", FALSE, TRUE, FALSE));
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Net Cost Price (FCY);
                                                   BlankZero=Yes;
                                                   Description=DP02114;
                                                   AutoFormatType=2 }
    { 3020;   ;Net Sales Price (FCY);Decimal      ;OnValidate=BEGIN
                                                                SetSkipValidateFCY(TRUE);
                                                                VALIDATE("Net Sales Price", ExchangeAmtFCYToLCY("Net Sales Price (FCY)", TRUE, TRUE, FALSE));
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Net Sales Price (FCY);
                                                   BlankZero=Yes;
                                                   Description=DP02114;
                                                   AutoFormatType=2 }
    { 3030;   ;Gross Price (FCY)   ;Decimal       ;OnValidate=VAR
                                                                SaveGrossPrice@1100525000 : Decimal;
                                                              BEGIN
                                                                //C026956.sn
                                                                //SetSkipValidateFCY(TRUE);
                                                                SaveGrossPrice := "Gross Price (FCY)";
                                                                VALIDATE("Gross Price", ExchangeAmtFCYToLCY("Gross Price (FCY)", FALSE, TRUE, FALSE));
                                                                IF CurrFieldNo = FIELDNO("Gross Price (FCY)") THEN
                                                                  "Gross Price (FCY)" := SaveGrossPrice;  //function CalculateDiscount cleared input on validate GrossPrice
                                                                //C026956.en
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Gross Price (FCY);
                                                   BlankZero=Yes;
                                                   Description=DP02114;
                                                   AutoFormatType=2 }
    { 3040;   ;Cost Rate (FCY)     ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Cost Rate", ExchangeAmtFCYToLCY("Cost Rate (FCY)", FALSE, TRUE, FALSE));
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Cost Rate (FCY);
                                                   Description=DP02114;
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 3050;   ;Sales Rate (FCY)    ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Sales Rate", ExchangeAmtFCYToLCY("Sales Rate (FCY)", TRUE, TRUE, FALSE));
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Sales Rate (FCY);
                                                   Description=DP02114;
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 3060;   ;Material Cost Amount (FCY);Decimal ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Material Cost Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3070;   ;Material Sales Amount (FCY);Decimal;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Material Sales Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3080;   ;Gross Amount (FCY)  ;Decimal       ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Gross Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3090;   ;Subcontr. Cost Amount (FCY);Decimal;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Subcontracting Cost Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3100;   ;Subcontr. Sales Amount (FCY);Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Subcontracting Sales Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3120;   ;Plant Cost Amount (FCY);Decimal    ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Plant Cost Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3130;   ;Plant Sales Amount (FCY);Decimal   ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Plant Sales Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3150;   ;Sundry Cost Amount (FCY);Decimal   ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Sundry Cost Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3160;   ;Sundry Sales Amount (FCY);Decimal  ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Sundry Sales Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3180;   ;Cost Amount (FCY)   ;Decimal       ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Cost Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3190;   ;Sales Amount (FCY)  ;Decimal       ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Sales Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3200;   ;Labor Cost Amount (FCY);Decimal    ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Labor Cost Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3210;   ;Labor Sales Amount (FCY);Decimal   ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Labor Sales Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3230;   ;Net Cost Amount (FCY);Decimal      ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Net Cost Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3240;   ;Net Sales Amount (FCY);Decimal     ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Net Sales Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 3250;   ;Buy Back Price (FCY);Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Buy Back Price", ExchangeAmtFCYToLCY("Buy Back Price (FCY)", FALSE, TRUE, FALSE));
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Buy Back Price (FCY);
                                                   Description=DP02114 }
    { 3260;   ;Buy Back Amount (FCY);Decimal      ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Buy Back Amount (FCY);
                                                   Description=DP02114;
                                                   Editable=No }
    { 11012434;;Project Planning Activity Code;Code10;
                                                   TableRelation="Project Planning Base Activity";
                                                   OnValidate=VAR
                                                                ProjectPlanningBaseActivity@1100528401 : Record 11012434;
                                                                FormatManagement@1100528400 : Codeunit 11012022;
                                                              BEGIN
                                                                FormatManagement.FormatElem("Project Planning Activity Code", 20, '');
                                                                IF "Project Planning Activity Code" <> '' THEN
                                                                  ProjectPlanningBaseActivity.GET("Project Planning Activity Code");
                                                              END;

                                                   OnLookup=VAR
                                                              ProjectPlanningBaseActivity@1100528400 : Record 11012434;
                                                            BEGIN
                                                              ProjectPlanningBaseActivity.Code := "Project Planning Activity Code";
                                                              IF PAGE.RUNMODAL(PAGE::"Proj. Planning Base Activities", ProjectPlanningBaseActivity) = ACTION::LookupOK THEN
                                                                VALIDATE("Project Planning Activity Code", ProjectPlanningBaseActivity.Code);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Project Planning Activity Code;
                                                              NOR=Prosjektplan, Aktivitetskode;
                                                              SVE=Projektplan, aktivitetskod];
                                                   Description=RAW }
    { 11125671;;VAT Prod. Posting Group;Code20    ;TableRelation="VAT Product Posting Group";
                                                   OnValidate=VAR
                                                                GWWSetup@1100525000 : Record 11012260;
                                                              BEGIN
                                                                GWWSetup.GET;
                                                                CASE "VAT Prod. Posting Group" OF
                                                                  GWWSetup."VAT Prod. Posting Group (L)": "VAT Type" := "VAT Type"::Low;
                                                                  GWWSetup."VAT Prod. Posting Group (Z)": "VAT Type" := "VAT Type"::Zero;
                                                                  ELSE BEGIN
                                                                    "VAT Type" := "VAT Type"::High;
                                                                    IF "VAT Prod. Posting Group" <> '' THEN
                                                                      TESTFIELD("VAT Prod. Posting Group", GWWSetup."VAT Prod. Posting Group (H)");
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Moms produktbokfõringsmal;
                                                              SVE=Moms produktbokfîringsmall];
                                                   Description=RAW }
    { 11125672;;VAT Type           ;Option        ;CaptionML=[ENU=VAT Type;
                                                              NOR=Mva.-type;
                                                              SVE=Momstyp];
                                                   OptionCaptionML=[ENU=High,Low,Zero;
                                                                    NOR=Hõg,Lav,Null;
                                                                    SVE=Hîg,LÜg,Noll];
                                                   OptionString=High,Low,Zero;
                                                   Description=RAW;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Recipe Group,Recipe,Line No.            ;SumIndexFields=Hours,Hours (Sales),Labor Cost Amount,Labor Sales Amount,Buy Back Amount,Total Weight;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
    {    ;Purchase Route Reference,Ask for Quote   }
    {    ;Recipe Group (Child),Recipe (Child)      }
    {    ;Recipe Group,Recipe,Cost Type (Price)   ;SumIndexFields=Net Cost Amount,Net Sales Amount,Cost Amount,Sales Amount,Gross Amount }
    {    ;Project Planning Activity Code           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      EstSetup@1210190001 : Record 11012150;
      SetRateRec@1100525001 : Record 11012162;
      BudgetRateRec@1210190007 : Record 11012000;
      HourRateRec@1100528900 : Record 11012022;
      RecipeRec@11012005 : Record 11020581;
      RcpLineRec@1100485000 : Record 11020582;
      EstCodeRec@1210190014 : Record 11229772;
      CodeRec@1210190015 : Record 11012089;
      ChrgRec@1210190000 : Record 11229771;
      OperRec@11012006 : Record 11012165;
      SubOperRec@11012007 : Record 11012166;
      TradeItemRec@1210190019 : Record 11012317;
      BasicItemRec@11012008 : Record 11012316;
      ItemRec@1210190004 : Record 27;
      DimValRec@1210190002 : Record 349;
      ElemRec@1210190021 : Record 11012060;
      TradeExpRec@1100485001 : Record 11020286;
      FormatMgt@11012009 : Codeunit 11012022;
      UpdateMgt@1210190009 : Codeunit 11012229;
      ValidateCu@11012010 : Codeunit 11012033;
      CentrManagementCU@11012012 : Codeunit 11012010;
      DimMgt@1210190003 : Codeunit 408;
      EstimateMgmt@1100525000 : Codeunit 11012232;
      ItemTypeOpt@1210190011 : 'Item,Basic Item,Trade Item,Trade Vendor';
      Text004@1210190016 : TextConst 'ENU=Remove Charge Line;NOR=Fjern gebyrrader;SVE=Ta bort avgiftsrader';
      Text005@1210190017 : TextConst 'ENU=Switch to Surcharge Line not allowed for Recipe Line with filled Quantity, Norm or Price;NOR=Bytting til tilleggsgebyrsraden er ikke tillatt for Malrad med antall, Norm eller Pris fylt ut;SVE=VÑxling till tillÑggsavgiftsraden Ñr inte tillÜtet fîr mallrad med antal, norm eller pris ifyllt';
      gvCostType@1100485005 : 'Labor,Material,Subcontracting,Plant,Sundry';
      EstSetupRead@1210190028 : Boolean;
      SkipCalculateTotals@1210190010 : Boolean;
      NormPresent@1210190018 : Boolean;
      NormGroupPresent@1210190022 : Boolean;
      FromRecipeLineDelete@1210190024 : Boolean;
      Text011@1100409000 : TextConst 'ENU=Add Line first.;NOR=Legg til rad fõrst.;SVE=LÑgg till rad fîrst.';
      SkipUpdateSurcharge@1100529500 : Boolean;
      SkipValidateFCY@1100528902 : Boolean;

    PROCEDURE CalculateTotals@1();
    VAR
      SaveRecipeLine@1100529501 : Record 11020582;
      WageCompRec@1100528900 : Record 11012014;
      OverTimeFactorCost@1100528901 : Decimal;
      OverTimeFactorSales@1100528902 : Decimal;
      RecipeSalesAmount@1100529500 : Decimal;
      CostRate@1100525000 : Decimal;
      SalesRate@1100525001 : Decimal;
      CostRateFCY@1100528903 : Decimal;
      SalesRateFCY@1100528904 : Decimal;
    BEGIN
      IF SkipCalculateTotals THEN
        EXIT;

      IF "Item No." + "Basic Item" + "Trade Item" <> '' THEN
        "Cost Type (Price)" := "Cost Type (Price)"::Material;  //DP00381

      IF "Surcharge Type" <> "Surcharge Type"::" " THEN BEGIN
        "Time Quantity" := 1;
        "Unit of Time" := '';
        Quantity := "Surcharge %" / 100;
        //C026570.sn
        "Surcharge % Labor" := 0;
        "Surcharge % Price" := 0;
        //C026570.en
        //C033781.sn
        "Recipe Surcharge % Material" := 0;
        "Recipe Surcharge % Subc." := 0;
        "Recipe Surcharge % Plant" := 0;
        "Recipe Surcharge % Sundry" := 0;
         //C033781.en
      END;

      CostRate := "Cost Rate";    //C031529
      SalesRate := "Sales Rate";  //C031529

      IF "Recipe (Child)" <> '' THEN BEGIN  //db, 23-05-07 (call 9504)
        //DP01183.sn
        SaveRecipeLine := Rec;  //C033781
        //GetEstSetup;
        //IF EstSetup."Apply Surcharge Recipe Header" = EstSetup."Apply Surcharge Recipe Header"::Default THEN BEGIN
        IF ("Recipe Header") THEN BEGIN  //C033781 (db, 02-01-17: exploding child-recipe not implemented for base recipe)
          //C026570.sn
          "Surcharge % Labor" := 0;
          "Surcharge % Price" := 0;
          //C026570.en
          //C033781.sn
          "Recipe Surcharge % Material" := 0;
          "Recipe Surcharge % Subc." := 0;
          "Recipe Surcharge % Plant" := 0;
          "Recipe Surcharge % Sundry" := 0;
          //C033781.en
        END;
        //DP01183.en
        IF ("Recipe Header" = FALSE) AND ("Recipe Level" = 0) THEN BEGIN  //db, 22-03-11: M26419
          IF RecipeRec.GET("Recipe Group (Child)", "Recipe (Child)") THEN BEGIN
            RecipeRec.CALCFIELDS(
              Hours,"Labor Cost Amount",  //C031529
              "Gross Amount","Material Cost Amount","Subcontracting Cost Amount",
              "Plant Cost Amount","Sundry Cost Amount","Buy Back Amount","Total Weight");
            RecipeRec.CALCFIELDS(
              "Hours (Sales)","Labor Sales Amount",  //C031529
              "Material Sales Amount","Subcontracting Sales Amount",
              "Plant Sales Amount","Sundry Sales Amount");  //DP00594

            //C031529.sn
            IF RecipeRec.Hours <> 0 THEN
              CostRate := RecipeRec."Labor Cost Amount" / RecipeRec.Hours;
            IF RecipeRec."Hours (Sales)" <> 0 THEN
              SalesRate := RecipeRec."Labor Sales Amount" / RecipeRec."Hours (Sales)";
            //C031529.en
            Norm := RecipeRec.Hours;
            IF Norm <> 0 THEN
              "Production Rate" := 1 / Norm
            ELSE
              "Production Rate" := 0;

            "Net Cost Price" := RecipeRec."Material Cost Amount" + RecipeRec."Subcontracting Cost Amount" +
              RecipeRec."Plant Cost Amount" + RecipeRec."Sundry Cost Amount";
            //C033781.sn
            //"Net Sales Price" := RecipeRec."Material Sales Amount" + RecipeRec."Subcontracting Sales Amount" +
            //  RecipeRec."Plant Sales Amount" + RecipeRec."Sundry Sales Amount";  //DP00594
            RecipeSalesAmount :=
              RecipeRec."Material Sales Amount" * (1 + "Recipe Surcharge % Material"/100) +
              RecipeRec."Subcontracting Sales Amount" * (1 + "Recipe Surcharge % Subc."/100) +
              RecipeRec."Plant Sales Amount" * (1 + "Recipe Surcharge % Plant"/100) +
              RecipeRec."Sundry Sales Amount" * (1 + "Recipe Surcharge % Sundry"/100);
            //C033781.en
            "Gross Price" := RecipeRec."Gross Amount";
            "Buy Back Price" := RecipeRec."Buy Back Amount";
            Weight := RecipeRec."Total Weight";
          END;
        END;
      END;

      //DP02114.sn
      CostRateFCY := ExchangeAmtLCYToFCY(CostRate, FALSE, TRUE, FALSE);
      SalesRateFCY := ExchangeAmtLCYToFCY(SalesRate, FALSE, TRUE, FALSE);
      //DP02114.en

      //DP01047.sn
      IF "Production Rate" > 100000 THEN
        Hours := "Time Quantity" * Quantity / "Production Rate"
      ELSE
        Hours := "Time Quantity" * Quantity * Norm;
      "Hours (Sales)" := Hours;  //DP00594 (quantity+norm sales not yet implemented)
      //DP01047.en

      IF "Cum. Adj. Factor Hours" <> 0 THEN
        Hours := Hours * "Cum. Adj. Factor Hours";
      "Labor Cost Amount"  := Hours * CostRate;  //C031529
      "Labor Sales Amount" := "Hours (Sales)" * SalesRate * (1 + "Surcharge % Labor"/100);  //C031529
      //DP02114.sn
      "Labor Cost Amount (FCY)" := Hours * CostRateFCY;
      "Labor Sales Amount (FCY)" := "Hours (Sales)" * SalesRateFCY * (1 + "Surcharge % Labor"/100);
      //DP02114.en
      //DP00236.sn
      IF "Wage Component" <> '' THEN BEGIN
        WageCompRec.GetOverTimeFactors("Wage Component",OverTimeFactorCost, OverTimeFactorSales);
        IF OverTimeFactorCost <> 0 THEN BEGIN
          "Labor Cost Amount" := "Labor Cost Amount" * OverTimeFactorCost;
          "Labor Cost Amount (FCY)" := "Labor Cost Amount (FCY)" * OverTimeFactorCost;  //DP02114
        END;
        IF OverTimeFactorSales <> 0 THEN BEGIN
          "Labor Sales Amount" := "Labor Sales Amount" * OverTimeFactorSales;
          "Labor Sales Amount (FCY)" := "Labor Sales Amount (FCY)" * OverTimeFactorSales;  //DP02114
        END;
      END;
      //DP00236.en
      IF "Rate Type" = "Rate Type"::Minuts THEN
        Hours := Hours * "Team Size" / 60;

      "Gross Amount" := "Time Quantity" * Quantity * "Gross Price";
      "Gross Amount (FCY)" := "Time Quantity" * Quantity * ExchangeAmtLCYToFCY("Gross Price", FALSE, TRUE, FALSE);  //DP02114
      "Net Cost Amount" := "Time Quantity" * Quantity * "Net Cost Price";
      "Net Cost Amount (FCY)" := "Time Quantity" * Quantity * ExchangeAmtLCYToFCY("Net Cost Price", FALSE, TRUE, FALSE);  //DP02114
      IF "Recipe (Child)" <> '' THEN BEGIN
        "Net Sales Amount" := "Time Quantity" * Quantity * RecipeSalesAmount;  //C033781
        "Net Sales Amount (FCY)" := "Time Quantity" * Quantity * ExchangeAmtLCYToFCY(RecipeSalesAmount, TRUE, TRUE, FALSE);  //DP02114
      END ELSE BEGIN
        "Net Sales Amount" := "Time Quantity" * Quantity * "Net Sales Price" * (1 + "Surcharge % Price"/100);  //DP00594
        "Net Sales Amount (FCY)" := "Time Quantity" * Quantity * ExchangeAmtLCYToFCY("Net Sales Price", TRUE, TRUE, FALSE) * (1 + "Surcharge % Price"/100);  //DP02114
      END;

      //DP01047.sn
      IF (("Cost Type (Hours)" = "Cost Type (Hours)"::Subcontracting) AND ("Cost Type (Price)" = "Cost Type (Price)"::Subcontracting)) OR  //DP01676
         (("Cost Type (Hours)" = "Cost Type (Hours)"::Plant) AND ("Cost Type (Price)" = "Cost Type (Price)"::Plant)) THEN BEGIN  //C038168
        "Gross Amount" := Hours * "Gross Price";
        "Net Cost Amount" := Hours * "Net Cost Price";
        "Net Sales Amount" := "Hours (Sales)" * "Net Sales Price" * (1 + "Surcharge % Price"/100);
        //DP02114.sn
        "Gross Amount (FCY)" := Hours * ExchangeAmtLCYToFCY("Gross Price", FALSE, TRUE, FALSE);
        "Net Cost Amount (FCY)" := Hours * ExchangeAmtLCYToFCY("Net Cost Price", FALSE, TRUE, FALSE);
        "Net Sales Amount (FCY)" := "Hours (Sales)" * ExchangeAmtLCYToFCY("Net Sales Price", FALSE, TRUE, FALSE) * (1 + "Surcharge % Price"/100);
        //DP02114.en
      END;
      //DP01047.en

      IF "Cum. Adj. Factor Price" <> 0 THEN BEGIN
        "Gross Amount" := "Gross Amount" * "Cum. Adj. Factor Price";
        "Net Cost Amount" := "Net Cost Amount" * "Cum. Adj. Factor Price";
        "Net Sales Amount" := "Net Sales Amount" * "Cum. Adj. Factor Price";
        //DP02114.sn
         "Gross Amount (FCY)" := "Gross Amount (FCY)" * "Cum. Adj. Factor Price";
        "Net Cost Amount (FCY)" := "Net Cost Amount (FCY)" * "Cum. Adj. Factor Price";
        "Net Sales Amount (FCY)" := "Net Sales Amount (FCY)" * "Cum. Adj. Factor Price";
        //DP02114.en
      END;
      "Cost Amount" := "Labor Cost Amount" + "Net Cost Amount";
      "Cost Amount (FCY)" := "Labor Cost Amount (FCY)" + "Net Cost Amount (FCY)";  //DP02114
      "Sales Amount" := "Labor Sales Amount" + "Net Sales Amount";
      "Sales Amount (FCY)" := "Labor Sales Amount (FCY)" + "Net Sales Amount (FCY)";  //DP02114

      "Total Weight" := ROUND(Quantity * Weight);
      "Buy Back Amount" := ROUND(Quantity * "Buy Back Price");
      "Buy Back Amount (FCY)" := ROUND(Quantity * ExchangeAmtLCYToFCY("Buy Back Price", FALSE, TRUE, FALSE));  //DP02114

      IF "Surcharge Type" <> "Surcharge Type"::" " THEN
        Quantity := 1;

      //C033781.sn
      IF "Recipe (Child)" <> '' THEN BEGIN
        "Surcharge % Labor" := SaveRecipeLine."Surcharge % Labor";
        "Surcharge % Price" := 0;
        "Recipe Surcharge % Material" := SaveRecipeLine."Recipe Surcharge % Material";
        "Recipe Surcharge % Subc." := SaveRecipeLine."Recipe Surcharge % Subc.";
        "Recipe Surcharge % Plant" := SaveRecipeLine."Recipe Surcharge % Plant";
        "Recipe Surcharge % Sundry" := SaveRecipeLine."Recipe Surcharge % Sundry";
      END;
      //C033781.en
    END;

    PROCEDURE CalculateQuantity@11012000();
    VAR
      lv1@1210190000 : Decimal;
      lv2@1210190001 : Decimal;
      lv3@1210190002 : Decimal;
    BEGIN
      lv1 := Length;
      lv2 := Width;
      lv3 := Height;

      IF Length = 0 THEN lv1 := 1;
      IF Width = 0 THEN lv2 := 1;
      IF Height = 0 THEN lv3 := 1;

      VALIDATE(Quantity, lv1 * lv2 * lv3);
    END;

    PROCEDURE CalculateNetPrice@13();
    BEGIN
      VALIDATE("Net Cost Price","Gross Price" - (("Gross Price"/100) * "Purchase Discount %"));
      VALIDATE("Net Sales Price","Gross Price" - (("Gross Price"/100) * "Sales Discount %"));
    END;

    PROCEDURE CalculateDiscount@1210190012(SalesBln@1100528900 : Boolean);
    BEGIN
      IF "Gross Price" <> 0 THEN BEGIN
        IF  ("Item No." + "Basic Item" + "Trade Item" + "Plant Type" = '') AND ("Purchase Discount %" = 0) THEN BEGIN
          "Gross Price" := "Net Cost Price";
          "Gross Price (FCY)" := "Net Cost Price (FCY)";  //DP02114
          //db.sn, 11-11-13: DP00260 (C005807)
          IF SalesBln = FALSE THEN
            VALIDATE("Net Sales Price","Gross Price" - (("Gross Price"/100) * "Sales Discount %"));
          //db.en, 11-11-13: DP00260 (C005807)
        END ELSE BEGIN
          IF SalesBln THEN
            "Sales Discount %" := (("Gross Price" - "Net Sales Price") / "Gross Price") * 100
          ELSE
            "Purchase Discount %" := (("Gross Price" - "Net Cost Price") / "Gross Price") * 100;
        END;
      END ELSE BEGIN
        //db.sn, 11-11-13: DP00260 (C005807)
        IF NOT SalesBln THEN BEGIN
          IF "Purchase Discount %" = 0 THEN BEGIN
            "Gross Price" := "Net Cost Price";
            "Gross Price (FCY)" := "Net Cost Price (FCY)";  //DP02114
            VALIDATE("Net Sales Price","Gross Price" - (("Gross Price"/100) * "Sales Discount %"));
          END;
        END;
        //db.en, 11-11-13: DP00260 (C005807)
        IF "Purchase Discount %" <> 100 THEN BEGIN
          IF NOT (("Item No." + "Basic Item" + "Trade Item" + "Plant Type" = '') AND ("Purchase Discount %" = 0)) THEN BEGIN
            "Gross Price" := "Net Cost Price" / ((100 - "Purchase Discount %") / 100);
            "Gross Price (FCY)" := "Net Cost Price (FCY)" / ((100 - "Purchase Discount %") / 100);  //DP02114
          END;
        END ELSE BEGIN
          "Gross Price" := "Net Cost Price";
          "Gross Price (FCY)" := "Net Cost Price (FCY)";  //DP02114
        END;
      END;
    END;

    PROCEDURE CalculateGrossPrice@1100485000();
    BEGIN
      IF "Purchase Discount %" <> 100 THEN BEGIN
        "Gross Price" := "Net Cost Price" * 100 / (100 - "Purchase Discount %");
        "Gross Price (FCY)" := "Net Cost Price (FCY)" * 100 / (100 - "Purchase Discount %");  //DP02114
      END;
    END;

    PROCEDURE ValidateItem@3(LTypeArtOpt@11012000 : 'Item,Basic Item,Trade Item,Trade Vendor';lvSwitchItem@1210190001 : Boolean);
    VAR
      lvRefDate@1100485001 : Date;
      lvItemOper@1100485002 : Code[20];
    BEGIN
      IF lvSwitchItem = TRUE THEN BEGIN
        "Price Agreement" := FALSE;
        "Price Agreement (Sales)" := FALSE;  //DP00381
      END;

      IF ("Purchase Route Reference" = '') AND ("Price Agreement" = FALSE) THEN BEGIN
        CalcItemCostPriceAndDiscount(LTypeArtOpt);  //db, 14-04-14: C013433

        IF "Cost Object Price" <> xRec."Cost Object Price" THEN
          GetDefaultsCostObject(gvCostType::Material, "Cost Object Price");

        ClearFields(2); //Buyback
        IF LTypeArtOpt = LTypeArtOpt::Item THEN BEGIN
          lvRefDate := TODAY;  //db, 05-08-16
          IF NOT ItemRec.GET("Item No.") THEN ItemRec.INIT;
          IF ItemRec."Sales/Buy-Back Item (Plant)" THEN BEGIN  //db, 06-06-11: M27669 (skip validate for normal items)
            ValidateCu.GetSalesBuyBackRates("Item No.",'',lvRefDate,
              "Gross Price","Buy Back Price");  //db, 06-06-11: M27669 (use SalesRate as GrossPrice)
            //C061014.sn
            EstSetup.GET;
            IF EstSetup."Item Sales Price Based On" = EstSetup."Item Sales Price Based On"::GrossMin THEN
              "Net Sales Price" := "Gross Price";
            //C061014.en
            VALIDATE("Buy Back Price");
            VALIDATE("Net Cost Price");
          END;
        END;
      END;
      IF ("Purchase Route Reference" = '') AND ("Price Agreement (Sales)" = FALSE) THEN BEGIN  //db, 19-12-14: C018758
        CalcItemSalesPriceAndDiscount;  //db, 14-04-14: C013433
      END;

      IF lvSwitchItem = TRUE THEN BEGIN
        //db.sn, 26-05-14: C015031
        InitSurcharge(TRUE);
        CheckSurchargeMaterialPrice;  //db, 12-08-13: C005338
        //db.en, 26-05-14: C015031
        lvItemOper := '';  //db, 02-02-07: operation provisionally not saved per basis/trade item
        IF ItemRec.GET("Item No.") THEN BEGIN
          CopyItemText;  //DP00686
          VALIDATE("External Text", ItemRec.Text);
          lvItemOper := ItemRec."Sub Operation Code";
        END;

        CASE LTypeArtOpt OF
          LTypeArtOpt::Item:
            BEGIN
              IF NOT ItemRec.GET("Item No.") THEN ItemRec.INIT;
              ItemRec.TESTFIELD(Blocked,FALSE);
              Weight := ItemRec.Weight;
            END;
          LTypeArtOpt::"Basic Item":
            BEGIN
              IF NOT BasicItemRec.GET(Manufacturer, "Basic Item") THEN BasicItemRec.INIT;
              BasicItemRec.TESTFIELD(Expired,FALSE);
              Weight := BasicItemRec."Net Weight";
              IF BasicItemRec."Sub Operation Code" <> '' THEN
                lvItemOper := BasicItemRec."Sub Operation Code";
            END;
          LTypeArtOpt::"Trade Item",
          LTypeArtOpt::"Trade Vendor":
            BEGIN
              IF NOT TradeItemRec.GET("Vendor (Trade Item)", "Trade Item") THEN TradeItemRec.INIT;
              TradeItemRec.TESTFIELD(Expired,FALSE);
              Weight := TradeItemRec."Gross Weight";
              IF TradeItemRec."Sub Operation Code" <> '' THEN
                lvItemOper := TradeItemRec."Sub Operation Code";
            END;
        END;
        IF lvItemOper <> '' THEN   //db, 24-05-07 (call 9441 + problem when replacing trade item as a result of preferred vendor)
          VALIDATE("Sub Operation Code", lvItemOper);
      END;

      CalculateTotals;
    END;

    PROCEDURE CalcItemCostPriceAndDiscount@1100525010(LTypeArtOpt@1100525001 : 'Item,Basic Item,Trade Item,Trade Vendor');
    VAR
      lvRefDate@1100525005 : Date;
      lvDiscRef1@1100525004 : Code[20];
      lvDiscRef2@1100525003 : Code[20];
      lvRefPrio@1100525002 : Code[10];
      Desc1Txt@1100525007 : Text[50];
      Desc2Txt@1100525006 : Text[50];
    BEGIN
      //db, 14-04-14: C013433
      IF "Price Agreement" THEN EXIT;  //C030087

      lvRefDate := TODAY;  //db, 05-08-16
      ValidateCu.ValidateItem(
        LTypeArtOpt, "Trade Item", "Item No.", Manufacturer, "Vendor (Trade Item)", "Basic Item",
        "Cost Object Price", Desc1Txt, "Unit of Measure", "Net Cost Price",
        "Purchase Discount %", "Price Reference Date", "Gross Price", Desc2Txt, "Cost Component",
        lvDiscRef1, lvDiscRef2, lvRefDate, lvRefPrio);
      IF LTypeArtOpt = LTypeArtOpt::"Trade Item" THEN
        "Price History 0 Exists" := ValidateCu.PriceHistory0Exists("Trade Item", "Vendor (Trade Item)", lvRefDate)
      ELSE
        "Price History 0 Exists" := FALSE;

      IF Desc2Txt = '' THEN
        Description := Desc1Txt
      ELSE
        Description := COPYSTR((Desc1Txt + '\' + Desc2Txt), 1, MAXSTRLEN(Description));
    END;

    PROCEDURE CalcItemSalesPriceAndDiscount@1100525011();
    VAR
      InventorySetup@1100528900 : Record 313;
      Customer@1100528901 : Record 18;
      lvRefDate@1100528906 : Date;
      lvDiscRef1@1100528905 : Code[20];
      lvDiscRef2@1100528904 : Code[20];
      lvRefPrio@1100528903 : Code[10];
    BEGIN
      IF "Price Agreement (Sales)" THEN EXIT;  //C030087
      //C061014.sn
      IF ItemRec.GET("Item No.") THEN
        IF ItemRec."Sales/Buy-Back Item (Plant)" THEN EXIT;
      //C061014.en

      //C035138.sn
      InventorySetup.GET;
      IF NOT Customer.GET(InventorySetup."Default Customer") THEN Customer.INIT;
      lvDiscRef1 := Customer."Sales Discount Term Group";
      lvRefDate := TODAY;
      ValidateCu.GetSalesDiscount(
        Customer."No.", "Item No.", "Basic Item", "Trade Item", Manufacturer, "Vendor (Trade Item)",
        "Net Sales Price", "Sales Discount %", "Gross Price", lvRefDate, Customer."Customer Disc. Group",
        lvDiscRef1, lvDiscRef2, lvRefPrio);
      VALIDATE("Net Sales Price");
      //C035138.en

      UpdateSalesPriceFromCostPrice;  //db, 14-04-14: C014487
    END;

    PROCEDURE DetermineNormGroup@4();
    BEGIN
      IF "Norm Group" = '' THEN
        IF ("Recipe Group" <> '') AND (Recipe <> '') THEN //Call 23762
          IF RecipeRec.GET("Recipe Group",Recipe) THEN
            "Norm Group" := RecipeRec."Norm Group";
    END;

    PROCEDURE DetermineNorm@7();
    VAR
      NormRec@11012000 : Record 11012163;
    BEGIN
      IF (NormRec."Sub Operation Code" <> "Sub Operation Code") OR (NormRec."Norm Group" <> "Norm Group") THEN //Call 23762
        NormPresent := NormRec.GET("Sub Operation Code","Norm Group"); //Call 23762
      IF NormPresent THEN BEGIN //Call 23762
        VALIDATE(Norm, NormRec.Norm);
        ConvertNorm(FALSE, FALSE);
      END ELSE BEGIN
        IF ("Norm Group" <> '') AND ("Sub Operation Code" <> '') THEN BEGIN
          VALIDATE(Norm, 0);
        END;
      END;
      CalculateTotals;
    END;

    PROCEDURE ConvertNorm@1210190002(SwitchType@1210190001 : Boolean;SwitchSize@1210190002 : Boolean);
    VAR
      NormGrpRec@1210190000 : Record 11012164;
    BEGIN
      IF (SwitchType = FALSE) AND (SwitchSize = FALSE) THEN BEGIN
        IF NormGrpRec.Code <> "Norm Group" THEN //Call 23762
          NormGroupPresent := NormGrpRec.GET("Norm Group"); //Call 23762
        IF NormGroupPresent THEN BEGIN //Call 23762
          IF NormGrpRec."Rate Type" <> "Rate Type" THEN
            SwitchType := TRUE;
          IF NormGrpRec."Team Size" <> "Team Size" THEN BEGIN
            SwitchSize := TRUE;
            xRec."Team Size" := NormGrpRec."Team Size";
          END;
        END;
      END;

      IF SwitchType = TRUE THEN
        IF "Rate Type" = "Rate Type"::Hours THEN
          Norm := Norm / 60
        ELSE
          Norm := Norm * 60;

      IF SwitchSize = TRUE THEN BEGIN
        IF "Team Size" <> 0 THEN
          Norm := Norm / "Team Size";
        IF xRec."Team Size" <> 0 THEN
          Norm := Norm * xRec."Team Size";
      END;

      IF SwitchSize OR SwitchType THEN
        IF Norm <> 0 THEN
          "Production Rate" := 1 / Norm
        ELSE
          "Production Rate" := 0;
    END;

    PROCEDURE HandleLookupOperationNorm@1100528902() lvRefresh : Boolean;
    VAR
      NormGroupFrm@1100525000 : Page 11012174;
      SubOperationCode@1100528900 : Code[20];
    BEGIN
      //DP00381
      IF ("Recipe (Child)" <> '') OR ("Surcharge Type" <> "Surcharge Type"::" ") THEN EXIT;

      CLEAR(NormGroupFrm);
      NormGroupFrm.SetSelection(DATABASE::"Base Recipe Line",'','','','',0,"Recipe Group",Recipe);
      //db.sn, 14-01-14
      NormGroupFrm.SetSubOperation("Sub Operation Code");
      NormGroupFrm.LOOKUPMODE(TRUE);
      IF NormGroupFrm.RUNMODAL = ACTION::LookupOK THEN BEGIN
        lvRefresh := NormGroupFrm.ApplySelection;
        IF lvRefresh = FALSE THEN BEGIN
          NormGroupFrm.GetSubOperation(SubOperationCode);
          IF SubOperationCode <> '' THEN BEGIN
            VALIDATE("Sub Operation Code", SubOperationCode);
            ProcessSubOperation;  //db, 28-02-14: C013489
          END;
        END;
      END;
      //db.en, 14-01-14

      EXIT(lvRefresh);
    END;

    PROCEDURE HandleLookupRecipe@1100528901() lvRefresh : Boolean;
    VAR
      RecipeFrm@1100528901 : Page 11125073;
      RecipeRec@1100528900 : Record 11020581;
    BEGIN
      //DP00381
      IF ("Item No." + "Basic Item" + "Trade Item" <> '') OR ("Surcharge Type" <> "Surcharge Type"::" ") THEN EXIT;

      CLEAR(RecipeFrm);
      RecipeFrm.LOOKUPMODE(TRUE);
      RecipeFrm.SetSelection(DATABASE::"Base Recipe Line",'','',"Recipe Group",Recipe,'','','','','',TRUE,"Line No.");  //C027336
      IF "Recipe Group (Child)" = '' THEN
        RecipeRec.SETRANGE("Recipe Group","Recipe Group")  //C046429: search in same group as parent
      ELSE
        RecipeRec.SETRANGE("Recipe Group","Recipe Group (Child)");
      IF RecipeRec.GET("Recipe Group (Child)","Recipe (Child)") THEN
        RecipeFrm.SETRECORD(RecipeRec);
      RecipeFrm.SETTABLEVIEW(RecipeRec);
      IF RecipeFrm.RUNMODAL = ACTION::LookupOK THEN BEGIN
        RecipeFrm.GETRECORD(RecipeRec);
        "Recipe Group (Child)" := RecipeRec."Recipe Group";
        VALIDATE("Recipe (Child)", RecipeRec."No.");
      END ELSE BEGIN
        lvRefresh := RecipeFrm.CheckMultiCopy;
      END;

      EXIT(lvRefresh);
    END;

    PROCEDURE HandleLookupItem@1100525003(lvFieldNo@1100525004 : Integer) lvRefresh : Boolean;
    VAR
      ItemRec@1100525012 : Record 27;
      BasicItemRec@1100525011 : Record 11012316;
      TradeItemRec@1100525010 : Record 11012317;
      ItemFrm@1100525008 : Page 31;
      BasicItemFrm@1100525007 : Page 11012333;
      TradeItemFrm@1100525006 : Page 11012334;
      lvRefDate@1100525003 : Date;
      lvDiscRef1@1100525002 : Code[20];
      lvDiscRef2@1100525001 : Code[20];
      lvTempRecipeLine@1100525005 : TEMPORARY Record 11020582;
      g_ItemCode@1100525014 : Code[20];
      g_Vendor@1100525013 : Code[20];
    BEGIN
      IF ("Recipe (Child)" <> '') OR ("Surcharge Type" <> "Surcharge Type"::" ") THEN EXIT;

      lvRefDate := TODAY;  //db, 05-08-16

      IF lvFieldNo = FIELDNO("Item No.") THEN BEGIN
        CLEAR(ItemFrm);
        ItemFrm.LOOKUPMODE(TRUE);
        ItemFrm.DetermineInterface(DATABASE::"Base Recipe Line",'','',
          '',Recipe,0,"Recipe Group",'',"Line No.",'','');

        IF ItemRec.GET("Item No.") THEN
          ItemFrm.SETRECORD(ItemRec);

        IF ItemFrm.RUNMODAL = ACTION::LookupOK THEN BEGIN
          ItemFrm.GETRECORD(ItemRec);
          VALIDATE("Item No.", ItemRec."No.");
        END ELSE BEGIN
          lvRefresh := ItemFrm.CheckMultiCopy;
        END;
      END;

      IF lvFieldNo = FIELDNO("Basic Item") THEN BEGIN
        CLEAR(BasicItemFrm);
        BasicItemFrm.LOOKUPMODE(TRUE);
        BasicItemFrm.SetSelection(DATABASE::"Base Recipe Line",'','',
          '',Recipe,0,"Recipe Group",'',"Line No.",'','');

        BasicItemFrm.SetReference(lvRefDate, lvDiscRef1, lvDiscRef2);

        BasicItemRec.InitLookup(BasicItemRec, "Basic Item", Manufacturer);
        BasicItemFrm.SETRECORD(BasicItemRec);

        IF BasicItemFrm.RUNMODAL = ACTION::LookupOK THEN BEGIN
          BasicItemFrm.GETRECORD(BasicItemRec);
          Manufacturer := BasicItemRec.Manufacturer;
          VALIDATE("Basic Item", BasicItemRec."Product Code");
        END ELSE BEGIN
          lvRefresh :=  BasicItemFrm.CheckMultiCopy;
        END;
      END;

      IF lvFieldNo = FIELDNO("Trade Item") THEN BEGIN
        IF "Item No." <> '' THEN BEGIN
          lvTempRecipeLine.COPY(Rec);
          lvTempRecipeLine.VALIDATE("Item No.","Item No.");
          g_ItemCode := lvTempRecipeLine."Trade Item";
          g_Vendor := lvTempRecipeLine."Vendor (Trade Item)";
        END ELSE BEGIN
          g_ItemCode := '';
          g_Vendor := '';
        END;

        CLEAR(TradeItemFrm);
        TradeItemFrm.LOOKUPMODE(TRUE);
        TradeItemFrm.SetSelection(DATABASE::"Base Recipe Line",
          '', '', '', Recipe, 0,
          "Recipe Group", '', "Line No.", '', '',
          "Vendor (Trade Item)", "Trade Item", Manufacturer, "Basic Item", g_ItemCode, g_Vendor);

        TradeItemFrm.SetReference(lvRefDate, lvDiscRef1, lvDiscRef2);

        TradeItemRec.InitLookup(TradeItemRec, "Basic Item", Manufacturer, "Trade Item", "Vendor (Trade Item)");
        TradeItemFrm.SETRECORD(TradeItemRec);

        IF TradeItemFrm.RUNMODAL = ACTION::LookupOK THEN BEGIN
          TradeItemFrm.GETRECORD(TradeItemRec);
          Manufacturer := TradeItemRec.Manufacturer;
          "Basic Item" := TradeItemRec."Product Code";
          "Vendor (Trade Item)" := TradeItemRec.Vendor;
          VALIDATE("Trade Item", TradeItemRec."Item Code");
        END ELSE BEGIN
          lvRefresh := TradeItemFrm.CheckMultiCopy;
        END;
      END;

      EXIT(lvRefresh);
    END;

    PROCEDURE HandleAssistEditItem@1100528300(lvFieldNo@1210190000 : Integer) lvRefresh : Boolean;
    VAR
      WebshopItemMgt@1100528300 : Codeunit 11012306;
      RecRef@1100528301 : RecordRef;
    BEGIN
      IF lvFieldNo = FIELDNO("Trade Item") THEN BEGIN
        RecRef.GETTABLE(Rec);
        WebshopItemMgt.RunModalDialogForMultipleItems("Vendor (Trade Item)", "Trade Item", RecRef);
        lvRefresh := TRUE;
      END;
    END;

    PROCEDURE HandleLookupUnit@1210190008();
    VAR
      ItemUnitRec@1210190000 : Record 5404;
      lvUnit@1210190001 : Code[10];
    BEGIN
      lvUnit := ItemUnitRec.HandleLookupUnit("Item No.", "Basic Item", "Trade Item", Manufacturer, "Vendor (Trade Item)");
      IF (lvUnit <> '') AND (lvUnit <> "Unit of Measure") THEN BEGIN
        xRec."Unit of Measure" := "Unit of Measure";
        VALIDATE("Unit of Measure", lvUnit);
      END;
    END;

    PROCEDURE CheckItemUnitConversion@1210190010(VAR MainNewRec@1210190006 : Record 11020582;MainOldRec@1210190007 : Record 11020582);
    VAR
      ItemRec@1210190004 : Record 27;
      UnitFactor@1210190005 : Decimal;
      UnitFactorOld@1210190003 : Decimal;
      UnitFactorNew@1210190002 : Decimal;
      UnitControl@1210190001 : Codeunit 5402;
    BEGIN
      WITH MainNewRec DO BEGIN
        UnitFactorOld := 1;
        UnitFactorNew := 1;
        ValidateCu.SkipErrorUnitConversion(CurrFieldNo=0);  //db, 10-03-15: C017415
        IF "Trade Item" <> '' THEN BEGIN
          ValidateCu.ValidateUnit(ItemTypeOpt::"Trade Item",
            "Item No.","Basic Item","Trade Item",Manufacturer,"Vendor (Trade Item)",
            Quantity,"Unit of Measure",UnitFactorNew);
          //ValidateCu.ValidateUnit(ItemTypeOpt::"Trade Item",
          //  "Item No.","Basic Item","Trade Item",Manufacturer,"Vendor (Trade Item)",
          //  "Quantity (Sales)","Unit of Measure",DummyFactor);  //C036708
        END ELSE BEGIN
          IF "Basic Item" <> '' THEN BEGIN
            ValidateCu.ValidateUnit(ItemTypeOpt::"Basic Item",
              "Item No.","Basic Item","Trade Item",Manufacturer,"Vendor (Trade Item)",
              Quantity,"Unit of Measure",UnitFactorNew);
            //ValidateCu.ValidateUnit(ItemTypeOpt::"Basic Item",
            //  "Item No.","Basic Item","Trade Item",Manufacturer,"Vendor (Trade Item)",
            //  "Quantity (Sales)","Unit of Measure",DummyFactor);  //C036708
          END ELSE BEGIN
            IF "Item No." <> '' THEN BEGIN
              ItemRec.GET("Item No.");
              UnitFactorOld := UnitControl.GetQtyPerUnitOfMeasure(ItemRec, MainOldRec."Unit of Measure");
              UnitFactorNew := UnitControl.GetQtyPerUnitOfMeasure(ItemRec, "Unit of Measure");
              UnitFactor := UnitFactorOld;
              ValidateCu.ValidateUnit(ItemTypeOpt::Item,
                "Item No.","Basic Item","Trade Item",Manufacturer,"Vendor (Trade Item)",
                Quantity,"Unit of Measure",UnitFactor);
              //ValidateCu.ValidateUnit(ItemTypeOpt::Item,
              //  "Item No.","Basic Item","Trade Item",Manufacturer,"Vendor (Trade Item)",
              //  "Quantity (Sales)","Unit of Measure",DummyFactor);  //C036708
            END;
          END;
        END;
        IF (UnitFactorNew * UnitFactorOld) <> 0 THEN BEGIN
          IF UnitFactorNew <> UnitFactorOld THEN BEGIN
            VALIDATE("Gross Price", ("Gross Price" * UnitFactorNew / UnitFactorOld));
            VALIDATE(Weight,(Weight * UnitFactorNew / UnitFactorOld));
          END;
        END;
      END;
    END;

    PROCEDURE CreateCharge@1100485005();
    VAR
      RecipeLine@1100485004 : Record 11020582;
      ChrgRec@11012000 : Record 11229771;
      ChrgLine@11012001 : Integer;
      ChrgDesc@11012002 : Text[100];
      lvText001@1100485003 : TextConst 'ENU=Current line is not a surcharge line.;NOR=Aktuell rad er ikke en tilleggsgebyrsrad.;SVE=Aktuell rad Ñr inte en tillÑggsavgiftrad.';
      lvText003@1100485001 : TextConst 'ENU=Are these recipe lines the basis for calculating surcharge for %1 ?;NOR=Utgjõr disse malrader Beregningsunderlag for tilleggsgebyr for %1?;SVE=Utgîr dessa mallrader berÑkningsunderlag fîr tillÑggsavgift fîr %1?';
      lvText004@1100525000 : TextConst 'ENU=First select Lines;NOR=Velg rad(er) fõrst;SVE=VÑlj rader fîrst';
    BEGIN
      RecipeLine.COPY(Rec);

      WITH RecipeLine DO BEGIN
        ChrgLine := "Line No.";
        ChrgDesc := Description;
        IF "Surcharge Type" = "Surcharge Type"::" " THEN BEGIN
          MESSAGE(lvText001);
          EXIT;
        END;
        IF "Surcharge Type" = "Surcharge Type"::Labor THEN
          TESTFIELD("Rate Code");  //C049505

        //db.sn, 29-01-15
        SETFILTER("Surcharge Type", '%1', "Surcharge Type"::" ");
        SETFILTER("Line No.", '<>%1', "Line No.");
        //db.en, 29-01-15

        IF NOT FINDFIRST THEN BEGIN
          MESSAGE(lvText004);
        END ELSE BEGIN
          IF CONFIRM(lvText003, TRUE, ChrgDesc) THEN BEGIN
            FINDSET(FALSE, FALSE);
            REPEAT;
              IF NOT ChrgRec.GET('', '', '', '', 0, 0, '', 0, "Recipe Group", Recipe, ChrgLine, "Line No.") THEN //DP00481
              BEGIN
                ChrgRec.INIT;
                ChrgRec."Recipe Group" := "Recipe Group";
                ChrgRec.Recipe := Recipe;
                ChrgRec."Surcharge Line" := ChrgLine;
                ChrgRec."Basic Line" := "Line No.";
                ChrgRec.INSERT(TRUE);
              END;
            UNTIL NEXT = 0;
          END;
        END;
        MARKEDONLY(FALSE);
      END;

      CLEARMARKS;
    END;

    PROCEDURE CheckRecipeCharge@8();
    VAR
      ChrgRec1@11012000 : Record 11229771;
      ChrgRec2@11012001 : Record 11229771;
      RcpLineRec1@11012002 : Record 11020582;
      RcpLineRec2@11012003 : Record 11020582;
      RecipeLineOriginal@1210190000 : Record 11020582;
    BEGIN
      //read with current recipe line in surcharge table whether this is a basic line for surcharge lines.
      ChrgRec1.SETFILTER("Estimate No.", '%1', '');
      ChrgRec1.SETFILTER("Sub-Estimate No.", '%1', '');
      ChrgRec1.SETFILTER("Part Group", '%1', '');
      ChrgRec1.SETFILTER(Part, '%1', '');
      ChrgRec1.SETFILTER("Sales Document No.", '%1', '');  //DP00481
      ChrgRec1.SETRANGE("Recipe Line", 0);
      ChrgRec1.SETRANGE("Recipe Group", "Recipe Group");
      ChrgRec1.SETRANGE(Recipe, Recipe);
      IF "Surcharge Type" <> "Surcharge Type"::" " THEN
        ChrgRec1.SETRANGE("Surcharge Line", "Line No.")
      ELSE
        ChrgRec1.SETRANGE("Basic Line", "Line No.");
      IF ChrgRec1.FINDSET(FALSE, FALSE) THEN BEGIN
        REPEAT
          //make surcharge line in estimate current
          RcpLineRec2.GET("Recipe Group", Recipe, ChrgRec1."Surcharge Line");
          RecipeLineOriginal := RcpLineRec2; //call 30195
          RcpLineRec2.InitNormPrice;  //db, 29-11-11
          //check all basic lines in surcharge table for surcharge line
          ChrgRec2.COPY(ChrgRec1);  //db, 15-06-10
          ChrgRec2.SETRANGE("Surcharge Line", ChrgRec1."Surcharge Line");
          ChrgRec2.SETRANGE("Basic Line");
          IF ChrgRec2.FINDSET(FALSE, FALSE) THEN BEGIN
            REPEAT
              //determine Line Total per Cost Type for Basic Lines belonging to Surcharge
              IF RcpLineRec1.GET("Recipe Group", Recipe, ChrgRec2."Basic Line") THEN BEGIN
                IF RcpLineRec2."Surcharge Type" = RcpLineRec2."Surcharge Type"::Labor THEN BEGIN
                  RcpLineRec2.Norm := RcpLineRec2.Norm + RcpLineRec1.Hours;
                END ELSE BEGIN
                  RcpLineRec2."Gross Price" := RcpLineRec2."Gross Price" + RcpLineRec1."Gross Amount";
                  RcpLineRec2."Net Cost Price" := RcpLineRec2."Net Cost Price" + RcpLineRec1."Net Cost Amount";
                  RcpLineRec2."Net Sales Price" := RcpLineRec2."Net Sales Price" + RcpLineRec1."Net Sales Amount";
                END;
              END;
            UNTIL ChrgRec2.NEXT = 0;
          END;
          //update surcharge line with totals by Cost Type of basic lines
          IF RcpLineRec2."Gross Price" <> 0 THEN BEGIN
            RcpLineRec2."Purchase Discount %" :=
              100 * (RcpLineRec2."Gross Price" - RcpLineRec2."Net Cost Price") / RcpLineRec2."Gross Price";
            RcpLineRec2."Sales Discount %" :=
              100 * (RcpLineRec2."Gross Price" - RcpLineRec2."Net Sales Price") / RcpLineRec2."Gross Price";
          END;
          IF RcpLineRec2."Surcharge Type" = RcpLineRec2."Surcharge Type"::Labor THEN BEGIN
            //C043241.sn
            RecipeRec.GET("Recipe Group", Recipe);
            IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN BEGIN
              IF SetRateRec.GET(RecipeRec."Rate Group", RcpLineRec2."Rate Code") THEN BEGIN
                IF SetRateRec."Rate Type" = SetRateRec."Rate Type"::Minuts THEN BEGIN
                  RcpLineRec2.Norm := RcpLineRec2.Norm * 60;
                  IF SetRateRec."Team Size" <> 0 THEN
                    RcpLineRec2.Norm := RcpLineRec2.Norm / SetRateRec."Team Size";
                END;
                IF RcpLineRec2.Norm <> 0 THEN
                  RcpLineRec2."Production Rate" := 1 / RcpLineRec2.Norm
                ELSE
                  RcpLineRec2."Production Rate" := 0;
              END;
            END ELSE BEGIN
              BudgetRateRec.SETRANGE(Code,RcpLineRec2."Rate Code");
              BudgetRateRec.SETRANGE("Starting Date",0D,TODAY);
              BudgetRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, TODAY);
              IF BudgetRateRec.FINDLAST THEN BEGIN
                IF BudgetRateRec."Rate Type" = BudgetRateRec."Rate Type"::Minuts THEN BEGIN
                  RcpLineRec2.Norm := RcpLineRec2.Norm * 60;
                  IF BudgetRateRec."Team Size" <> 0 THEN
                    RcpLineRec2.Norm := RcpLineRec2.Norm / BudgetRateRec."Team Size";
                END;
                IF RcpLineRec2.Norm <> 0 THEN
                  RcpLineRec2."Production Rate" := 1 / RcpLineRec2.Norm
                ELSE
                  RcpLineRec2."Production Rate" := 0;
              END;
            END;
            //C043241.en
          END;
          RcpLineRec2.CalculateTotals;
          IF FORMAT(RcpLineRec2) <> FORMAT(RecipeLineOriginal) THEN //call 30195
            RcpLineRec2.MODIFY(TRUE);   //db, 20-04-10: M19083 (Central Mgt)
        UNTIL ChrgRec1.NEXT = 0;
      END;
    END;

    PROCEDURE CheckSameValue@1210190009(lvCostType@1210190001 : Integer;lvCostObjectOld@1210190002 : Code[20]);
    VAR
      lvRcpLineRec@1210190000 : Record 11020582;
    BEGIN
      IF lvCostType = 1 THEN
        lvRcpLineRec.SETFILTER("Cost Object Labor", '%1', lvCostObjectOld)
      ELSE
        lvRcpLineRec.SETFILTER("Cost Object Price", '%1', lvCostObjectOld);
      lvRcpLineRec.SETRANGE(Description, Description);
      lvRcpLineRec.SETRANGE("Unit of Measure", "Unit of Measure");
      IF lvRcpLineRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF lvCostType = 1 THEN
            lvRcpLineRec."Cost Object Labor" := "Cost Object Labor"
          ELSE
            lvRcpLineRec."Cost Object Price" := "Cost Object Price";
          lvRcpLineRec.MODIFY;
        UNTIL lvRcpLineRec.NEXT = 0;
      END;
    END;

    PROCEDURE CheckCostObject@1210190005(CostObject@1210190000 : Code[20]);
    VAR
      DefRate@1100485000 : Code[10];
    BEGIN
      RecipeRec.GET("Recipe Group", Recipe);
      DefRate := RecipeRec."Rate Code";
      GetEstSetup;  //DP01183

      IF CostObject <> '' THEN BEGIN
        DimMgt.GetDimValueRec(2, CostObject, DimValRec, TRUE,'');
        //db.sn, 02-10-09: M15745
        VALIDATE("Cost Component", DimValRec."Cost Component");
        IF EstSetup."Estimate Based On" <> EstSetup."Estimate Based On"::CostObject THEN EXIT;
        //db.en, 02-10-09: M15745
        IF "Sub Operation Code" <> '' THEN BEGIN
          ProcessSubOperation;
          EXIT;
        END;
        IF "Norm Agreement" OR "Price Agreement" THEN BEGIN
          IF DimValRec."Cost Type" = DimValRec."Cost Type"::Labor THEN BEGIN
            IF DimValRec."Rate Code" = '' THEN
              VALIDATE("Rate Code", DefRate)
            ELSE
              VALIDATE("Rate Code", DimValRec."Rate Code");
          END;
          EXIT;
        END;
        IF CostObjectLeading THEN  //C050221
          Description := DimValRec.Name;
        InitNormPrice;  //db, 29-11-11
        IF DimValRec."Cost Type" = DimValRec."Cost Type"::Labor THEN BEGIN
          IF DimValRec."Rate Code" = '' THEN
            VALIDATE("Rate Code", DefRate)
          ELSE
            VALIDATE("Rate Code", DimValRec."Rate Code");
          VALIDATE(Norm, DimValRec.Norm);
        END ELSE BEGIN
          VALIDATE("Gross Price", DimValRec.Price);
        END;
      END;
    END;

    PROCEDURE OldSubOperationDefault@1210190006() : Boolean;
    VAR
      OldSubOperRec@1210190001 : Record 11012166;
      OldOperRec@1210190000 : Record 11012165;
    BEGIN
      IF xRec."Sub Operation Code" <> '' THEN //Call 23762
        IF OldSubOperRec.GET(xRec."Sub Operation Code") THEN
          IF OldSubOperRec.Operation <> '' THEN //Call 23762
            IF OldOperRec.GET(OldSubOperRec.Operation) THEN;

      EXIT(xRec."Cost Object Labor" = OldOperRec."Cost Object");
    END;

    PROCEDURE ProcessSubOperation@1100485002();
    VAR
      SubOperRec@1100485000 : Record 11012166;
    BEGIN
      IF "Item No." + "Basic Item" + "Trade Item" <> '' THEN EXIT;

      //IF "Sub Operation Code" <> '' THEN //Call 23762 //db, 09-02-12: M32143
      IF SubOperRec.GET("Sub Operation Code") THEN BEGIN
        Description := COPYSTR(SubOperRec.Description, 1, MAXSTRLEN(Description));
        IF SubOperRec."Unit of Measure" <> '' THEN
          "Unit of Measure" := SubOperRec."Unit of Measure";
      END;
    END;

    PROCEDURE EnterQuantity@1210190013(lvOrigin@1210190002 : Integer) : Boolean;
    VAR
      EstSetup@1100409001 : Record 11012150;
      QuanRec@1210190000 : Record 11012186;
      QuantityRelation@1100409000 : Record 11020463;
    BEGIN
      //DP00686
      //lvOrigin:
      //  1 = Length, Width and Height
      //  2 = quantity (input)
      //  3 = house type
      //  4 = quantity (lookup)

      IF "Surcharge Type" <> "Surcharge Type"::" " THEN EXIT(FALSE);

      IF lvOrigin <> 1 THEN BEGIN
        IF Length <> 0 THEN EXIT(FALSE);
        IF Width <> 0 THEN EXIT(FALSE);
        IF Height <> 0 THEN EXIT(FALSE);
      END;

      GetEstSetup;  //DP01183
      IF lvOrigin <> 4 THEN BEGIN
        IF NOT EstSetup."Quantity Sheet with Relations" THEN BEGIN
          QuanRec.SETFILTER("Estimate No.", '%1', '');
          QuanRec.SETFILTER("Sub-Estimate No.", '%1', '');
          QuanRec.SETFILTER("Part Group", '%1', '');
          QuanRec.SETFILTER(Part, '%1', '');
          QuanRec.SETRANGE("Estimate Line", 0);
          QuanRec.SETRANGE("Recipe Group", "Recipe Group");
          QuanRec.SETRANGE(Recipe, Recipe);
          QuanRec.SETRANGE("Recipe Line", "Line No.");
          IF QuanRec.FINDFIRST THEN EXIT(FALSE);
        END ELSE
          IF QuantityRelation.GET('','','','',0,"Recipe Group",Recipe,"Line No.") THEN
            EXIT(FALSE);
      END;

      EXIT(TRUE);
    END;

    PROCEDURE EditQuanSheet@1210190007();
    VAR
      EstSetup@1100409004 : Record 11012150;
      QuanRec@1210190000 : Record 11012186;
      QuantityRelation@1100409003 : Record 11020463;
      QuanSheetRec@1100409002 : Record 11020461;
      QuanSheetFrm@1100409001 : Page 11229784;
    BEGIN
      //DP00686
      IF "Line No." = 0 THEN
        ERROR(Text011);

      GetEstSetup;  //DP01183
      IF NOT EstSetup."Quantity Sheet with Relations" THEN BEGIN
        QuanRec.RESET;
        QuanRec.SETFILTER("Estimate No.", '%1', '');
        QuanRec.SETFILTER("Sub-Estimate No.", '%1', '');
        QuanRec.SETFILTER("Part Group", '%1', '');
        QuanRec.SETFILTER(Part, '%1', '');
        QuanRec.SETRANGE("Estimate Line", 0);
        QuanRec.SETRANGE("Recipe Group", "Recipe Group");
        QuanRec.SETRANGE(Recipe, Recipe);
        QuanRec.SETRANGE("Recipe Line", "Line No.");
        PAGE.RUNMODAL(PAGE::"Estimate Quantity Sheet", QuanRec);
        QuanRec.SETRANGE("Row No.", 0);
        IF QuanRec.FINDFIRST THEN
          VALIDATE(Quantity, QuanRec.Result);
      END ELSE BEGIN
        QuanSheetRec.SETRANGE("Recipe Group","Recipe Group");
        QuanSheetRec.SETRANGE(Recipe,Recipe);
        QuanSheetFrm.SETTABLEVIEW(QuanSheetRec);
        IF NOT QuantityRelation.GET('','','','',0,"Recipe Group",Recipe,"Line No.") THEN QuantityRelation.INIT;
        IF NOT QuanSheetRec.GET("Recipe Group",Recipe,QuantityRelation."Quantity Sheet") THEN QuanSheetRec.INIT;
        QuanSheetFrm.SETRECORD(QuanSheetRec);
        QuanSheetFrm.SetDefaultNEW(Rec,TRUE,QuantityRelation);
        QuanSheetFrm.RUNMODAL;
        IF QuantityRelation.GET('','','','',0,"Recipe Group",Recipe,"Line No.") THEN
          IF GET("Recipe Group",Recipe,"Line No.") THEN
            VALIDATE(Quantity);
      END;
    END;

    PROCEDURE InitAdjustmentFactor@1210190003();
    BEGIN
      IF "Adjustment Factor Hours" = 0 THEN
        "Adjustment Factor Hours" := 1;
      IF "Adjustment Factor Price" = 0 THEN
        "Adjustment Factor Price" := 1;
      IF "Adj. Factor Hours (Sales)" = 0 THEN  //DP00555
        "Adj. Factor Hours (Sales)" := 1;

      "Cum. Adj. Factor Hours" := "Adjustment Factor Hours";
      "Cum. Adj. Factor Price" := "Adjustment Factor Price";
      "Cum. Adj. Factor Hours (Sales)" := "Adj. Factor Hours (Sales)";  //DP00555
    END;

    PROCEDURE ProcessAdjustmentFactor@1210190004(IAdjType@1210190000 : Integer;IEstType@1100525000 : Integer);
    BEGIN
      IF (IEstType = 0) OR (IEstType = 2) THEN BEGIN  //DP00555 (0=both, 1=cost, 2=sales)
        CASE IAdjType OF
          1:
            IF "Adj. Factor Hours (Sales)" = 0 THEN
              "Adj. Factor Hours (Sales)" := 1;
        END;
      END;
      IF (IEstType = 0) OR (IEstType = 1) THEN BEGIN  //DP00555 (0=both, 1=cost, 2=sales)
        CASE IAdjType OF
          1:
            IF "Adjustment Factor Hours" = 0 THEN
              "Adjustment Factor Hours" := 1;
          2:
            IF "Adjustment Factor Price" = 0 THEN
              "Adjustment Factor Price" := 1;
        END;
      END;
      MODIFY;

      UpdateMgt.ResetAdjustmentFactor('', '', "Recipe Group", Recipe, "Line No.", TRUE, 5, IAdjType, IEstType);  //DP00555

      GET("Recipe Group", Recipe, "Line No.");
    END;

    PROCEDURE UpdateRelatedRecipe@1100485001(lvRcpGrp@1210190002 : Code[20];lvRcp@1210190001 : Code[20]);
    VAR
      lvRcpLineRec@1210190000 : Record 11020582;
      OldRcpLineRec@1100409000 : Record 11020582;
    BEGIN
      //db, 01-08-05: call after changing recipe lines (form 11012158)

      lvRcpLineRec.RESET;
      lvRcpLineRec.SETCURRENTKEY("Recipe Group (Child)", "Recipe (Child)");
      lvRcpLineRec.SETRANGE("Recipe Group (Child)", lvRcpGrp);
      lvRcpLineRec.SETRANGE("Recipe (Child)", lvRcp);
      IF lvRcpLineRec.FINDSET(TRUE,FALSE) THEN BEGIN
        REPEAT
          OldRcpLineRec := lvRcpLineRec;
          lvRcpLineRec.SetSkipUpdateSurcharge(TRUE);  //C033781
          lvRcpLineRec.VALIDATE("Recipe (Child)");
          lvRcpLineRec.SetSkipUpdateSurcharge(FALSE);  //C033781
          IF FORMAT(OldRcpLineRec) <> FORMAT(lvRcpLineRec) THEN  //db, 21-01-13: if record not changed, avoid update related companies
            lvRcpLineRec.MODIFY(TRUE);
          UpdateRelatedRecipe(lvRcpLineRec."Recipe Group", lvRcpLineRec.Recipe);
        UNTIL lvRcpLineRec.NEXT = 0;
      END;
    END;

    PROCEDURE CheckParentChildRecipe@1210190011(lvRcpGrp@1210190002 : Code[20];lvRcp@1210190001 : Code[20]);
    VAR
      lvRcpLineRec@1210190000 : Record 11020582;
      lvText000@1100485000 : TextConst 'ENU=Recursion;NOR=Rekursjon;SVE=Rekursion';
    BEGIN
      IF ("Recipe Group" = "Recipe Group (Child)") AND (Recipe = "Recipe (Child)") THEN
        ERROR(lvText000);

      WHILE lvRcp <> '' DO BEGIN
        lvRcpLineRec.SETRANGE("Recipe Group", lvRcpGrp);
        lvRcpLineRec.SETRANGE(Recipe, lvRcp);
        lvRcpLineRec.SETFILTER("Recipe Group (Child)", '<>%1', '');
        lvRcpLineRec.SETFILTER("Recipe (Child)", '<>%1', '');
        IF lvRcpLineRec.FINDSET(FALSE, FALSE) THEN BEGIN
          REPEAT
            lvRcpGrp := lvRcpLineRec."Recipe Group (Child)";
            lvRcp := lvRcpLineRec."Recipe (Child)";
            IF ("Recipe Group" = lvRcpGrp) AND (Recipe = lvRcp) THEN
              ERROR(lvText000)
            ELSE
              CheckParentChildRecipe(lvRcpGrp, lvRcp);
          UNTIL lvRcpLineRec.NEXT = 0;
        END;
        lvRcp := '';
      END;
    END;

    PROCEDURE CheckDefaultRate@1100485003();
    BEGIN
      RecipeRec.GET("Recipe Group", Recipe);
      IF "Rate Code" = '' THEN
        "Rate Code" := RecipeRec."Rate Code";
    END;

    PROCEDURE GetItemSpecifications@1100485006();
    BEGIN
      IF ItemRec.GET("Item No.") THEN BEGIN
        "Item Series" := ItemRec."Item Series";
        "Item Type" := ItemRec."Item Type";
        "Item Brand" := ItemRec."Item Brand";
      END;
    END;

    PROCEDURE GetDefaultsPlantType@1100485010();
    VAR
      PlantTypeRec@1100485000 : Record 11012551;
    BEGIN
      //DP01407.sn
      EstSetup.GET;
      IF EstSetup."Plant Company" <> '' THEN
        PlantTypeRec.CHANGECOMPANY(EstSetup."Plant Company");
      //DP01407.en
      PlantTypeRec.GET("Plant Type");
      Description := PlantTypeRec.Description;
      "Unit of Measure" := PlantTypeRec."Unit of Measure";
      "Cost Object Price" := PlantTypeRec."Cost Object";
      Weight := PlantTypeRec.Weight;
      CLEAR("Price Agreement");
      DeterminePlantPrice;

      IF "Attached to Line No." <> 0 THEN
        GetRentalPeriodFromSet;
    END;

    PROCEDURE DeterminePlantPrice@1100485011();
    VAR
      SearchRateCu@1100485000 : Codeunit 11012567;
      RefDate@1100485001 : Date;
      RentalType@1100525007 : Option;
      DummyPlantPriceType@1100525006 : Option;
      DummyRentalType@1100525005 : Option;
      PlantDiscount@1100525004 : Decimal;
      SalesPrice@1100525003 : Decimal;
      BuyBackPrice@1100525002 : Decimal;
      PlantTypeRec@1100525001 : Record 11012551;
    BEGIN
      IF ("Plant Type" = '') OR "Price Agreement" THEN
        EXIT;
      //db.sn, 06-04-17: C036770
      ClearFields(2); //Buyback
      ClearFields(3); //Discount
      //db.en, 06-04-17: C036770
      IF "Start Rental Period" <> 0D THEN
        RefDate := "Start Rental Period"
      ELSE
        RefDate := TODAY;

      IF NOT RecipeRec.GET("Recipe Group", Recipe) THEN
        RecipeRec.INIT;

      //DP01047.sn
      RentalType := -1;  //0=rental, 1=sales, 2=buy-back, 3= hours
      //DP01407.sn
      EstSetup.GET;
      IF EstSetup."Plant Company" <> '' THEN
        PlantTypeRec.CHANGECOMPANY(EstSetup."Plant Company");
      //DP01407.en
      PlantTypeRec.GET("Plant Type");
      IF "Plant Rates in Hours" THEN BEGIN  //DP01492
        "Cost Type (Hours)" := "Cost Type (Hours)"::Plant;
        "Rate Code" := '';
        InitRateRelatedFields;
        IF (PlantTypeRec."Rental Type" <> PlantTypeRec."Rental Type"::"Sales/Buy Back") THEN
          RentalType := 3;
      END;

      VALIDATE("Net Cost Price", SearchRateCu.CostRateFromEstimate("Plant Type",'','',RefDate,EstSetup."Plant Company",RentalType,"Plant Price Type"));  //DP01407
      VALIDATE("Gross Price","Net Cost Price");
      SalesPrice := SearchRateCu.SalesRateFromEstimate(
        "Plant Type",'','','',1,RefDate,EstSetup."Plant Company",RentalType,"Plant Price Type");  //DP01407
      IF RentalType = 1 THEN BEGIN
        DummyRentalType := 2;
        BuyBackPrice := SearchRateCu.SalesRateFromEstimate("Plant Type",'','','',0,RefDate,EstSetup."Plant Company",DummyRentalType,DummyPlantPriceType);  //DP01407
      END;
      PlantDiscount := SearchRateCu.SalesDiscountFromEstimate("Plant Type",'','','','',RefDate,EstSetup."Plant Company",RentalType);  //DP01407
      VALIDATE("Net Sales Price", SalesPrice * (100-PlantDiscount)/100);
      VALIDATE("Buy Back Price", BuyBackPrice * (100-PlantDiscount)/100);
      //DP01047.en
    END;

    PROCEDURE GetDefaultsCostObject@1100485012(CostType@1100485000 : 'Labor,Material,Subcontracting,Plant,Sundry';CostObject@1100485001 : Code[20]);
    VAR
      DimensionValue@1100528900 : Record 349;
    BEGIN
      //DP01676: function derived from BudgetLine; skip message on validate
      EstSetup.GET;
      IF CostObject = '' THEN EXIT;

      DimMgt.GetDimValueRec(2, CostObject, DimensionValue, TRUE, '');
      DimensionValue.TESTFIELD(Blocked, FALSE);

      //C050221.sn
      IF EstSetup."Estimate Based On" = EstSetup."Estimate Based On"::CostObject THEN BEGIN
        IF CostObjectLeading THEN
          Description := DimensionValue.Name;
      END;
      //C050221.en

      IF EstSetup."Default Purchase Action" THEN BEGIN  //C050221
        IF (CostType = CostType::Material) OR (CostType = CostType::Subcontracting) OR (CostType = CostType::Plant) THEN BEGIN
          IF ("Purchase Action" = '') AND (DimensionValue."Purchase Action" <> '') THEN
            VALIDATE("Purchase Action", DimensionValue."Purchase Action");
        END;
      END;
    END;

    LOCAL PROCEDURE CostObjectLeading@1100528503() : Boolean;
    BEGIN
      //C050221
      IF ("Item No." + "Basic Item" + "Trade Item" <> '') OR
         ("Sub Operation Code" + "Subcontracting Activity" <> '') OR
         ("Plant Type" + "Set Code" <> '') OR
         ("Recipe (Child)" <> '') OR
         ("Surcharge Type" <> "Surcharge Type"::" ") THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE GetAbsenceValue@1100528501();
    BEGIN
      //C050221
      GetEstSetup;
      IF "Cost Type (Price)" = "Cost Type (Price)"::Material THEN
         VALIDATE("Cost Object Price", EstSetup."Absence Value Material");
      IF "Cost Type (Price)" = "Cost Type (Price)"::Subcontracting THEN
         VALIDATE("Cost Object Price", EstSetup."Absence Value Subcontracting");
      IF "Cost Type (Price)" = "Cost Type (Price)"::Plant THEN
         VALIDATE("Cost Object Price", EstSetup."Absence Value Plant");
      IF "Cost Type (Price)" = "Cost Type (Price)"::Sundry THEN
         VALIDATE("Cost Object Price", EstSetup."Absence Value Sundry Cost");
    END;

    PROCEDURE CalcRentalUnits@1100525007();
    VAR
      PlantLocation@1100525000 : Record 11012554;
      RateTypeUsed@1100525002 : Option;
      CalcRentalPeriodsCu@1100525001 : Codeunit 11012568;
    BEGIN
      PlantLocation.INIT;
      PlantLocation.InitRecord;

      VALIDATE("Rental Time Units",
        CalcRentalPeriodsCu.NumberRentalPeriods(
          PlantLocation,"Start Rental Period","End Rental Period","Plant Type",'',RateTypeUsed));

      IF "Set Code" = '' THEN
        TESTFIELD("Plant Price Type", RateTypeUsed + 1);
    END;

    PROCEDURE ClearFields@1100525004(FieldGroup@1100525000 : 'Item,PlantType,BuyBack');
    BEGIN
      CASE FieldGroup OF
        FieldGroup::Item:
          BEGIN
            VALIDATE("Net Cost Price",0);
            VALIDATE("Item No.",'')
          END;
        FieldGroup::PlantType:
          BEGIN
            VALIDATE("Net Cost Price",0);
            VALIDATE("Plant Type",'');
          END;
        FieldGroup::BuyBack:
          BEGIN
            CLEAR("Buy Back Price");
            CLEAR("Buy Back %");
          END;
      END;
    END;

    PROCEDURE ChkFieldsEmpty@1100525028(FieldGroup@1100525000 : 'Material,Plant,BuyBack,Discount');
    BEGIN
      CASE FieldGroup OF
        FieldGroup::Material:
          BEGIN
            //TESTFIELD("Material Price",0);
            //TESTFIELD("Item No.",0)
          END;
        FieldGroup::Plant:
          BEGIN
            //TESTFIELD("Plant Type",0);
            //TESTFIELD("Plant Price Type",0);
          END;
        FieldGroup::BuyBack:
          BEGIN
            TESTFIELD("Buy Back Price",0);
            TESTFIELD("Buy Back %",0);
          END;
        FieldGroup::Discount:
          BEGIN
            TESTFIELD("Purchase Discount %",0);
            TESTFIELD("Gross Price",0);
          END;
      END;
    END;

    PROCEDURE InitRecord@1100528500();
    VAR
      BaseRecipe@1100528500 : Record 11020581;
      ProjSetup@1100528501 : Record 315;
    BEGIN
      //C045041
      IF BaseRecipe.GET("Recipe Group", Recipe) THEN BEGIN
        ProjSetup.GET;
        "Subcontracting in Hours" := ProjSetup."Subcontracting in Hours";  //C053751
        "Rate Code" := BaseRecipe."Rate Code";
        "Plant Rates in Hours" := BaseRecipe."Plant Rates in Hours";
      END;
    END;

    PROCEDURE InitRecipeLine@1100525000(SaveOrig@1100525000 : Boolean);
    BEGIN
      "Purchase Route Reference" := '';
      IF SaveOrig = FALSE THEN BEGIN
        "Price Agreement" := FALSE;
        "Price Agreement (Sales)" := FALSE;  //DP00381
        "Norm Agreement" := FALSE;
        "Norm Agreement (Sales)" := FALSE;   //DP00381
      END;
      InitSurcharge(FALSE);  //DP00594

      CentrManagementCU.EditBaseRecipeLine(Rec,1,xRec);   //DP00381
    END;

    LOCAL PROCEDURE GetRentalPeriodFromSet@1100525014();
    VAR
      RecipeLine2@1100525000 : Record 11020582;
    BEGIN
      IF "Attached to Line No." = 0 THEN
        EXIT;

      RecipeLine2.GET("Recipe Group", Recipe, "Attached to Line No.");

      IF RecipeLine2."Set Code" = '' THEN
        EXIT;

      IF "Plant Rates in Hours" THEN EXIT;  //DP01492

      VALIDATE("Start Rental Period", RecipeLine2."Start Rental Period");
      VALIDATE("End Rental Period", RecipeLine2."End Rental Period");
      VALIDATE("Rental Period Formula", RecipeLine2."Rental Period Formula");
      VALIDATE("Rental Time Units", RecipeLine2."Rental Time Units");
    END;

    PROCEDURE GetEstSetup@1210190014();
    BEGIN
      //Call 23762
      IF NOT EstSetupRead THEN BEGIN
        EstSetup.GET;
        EstSetupRead := TRUE;
      END;
    END;

    PROCEDURE SetSkipCalculateTotals@1210190016(SetCalculateTotals@1210190000 : Boolean);
    BEGIN
      //Call 23762
      SkipCalculateTotals := SetCalculateTotals;
    END;

    PROCEDURE SetFromEstimateLineDelete@1210190020(FromRecipeLine@1210190000 : Boolean);
    BEGIN
      //Call 23762
      FromRecipeLineDelete := FromRecipeLine;
    END;

    PROCEDURE IsFixed@1210190021() : Boolean;
    VAR
      RecipeHeader@1210190001 : Record 11020581;
    BEGIN
      IF RecipeHeader.GET("Recipe Group", Recipe) THEN
        EXIT(RecipeHeader.Fixed);
    END;

    PROCEDURE ProcessCostObject@1100528906(iAction@1210190000 : Integer;iCostType@1100528900 : Integer;iCostObject@1100528901 : Code[20]);
    VAR
      DimValRec@1100528902 : Record 349;
    BEGIN
      //DP00381
      IF (("Recipe (Child)" <> '') AND ("Recipe Header"= TRUE)) OR ("Surcharge Type" <> "Surcharge Type"::" ") THEN EXIT;  //db, 13-03-14

      IF iAction = 1 THEN BEGIN   //validate
        IF iCostObject <> '' THEN BEGIN
          DimValRec.RESET;
          DimValRec.SETRANGE("Global Dimension No.",2);
          DimValRec.SETRANGE(Code, iCostObject);
          IF iCostType = 0 THEN BEGIN
            DimValRec.SETRANGE("Cost Type", DimValRec."Cost Type"::Labor);
          END ELSE BEGIN
            IF "Cost Type (Price)" = "Cost Type (Price)"::" " THEN
              DimValRec.SETRANGE("Cost Type", DimValRec."Cost Type"::Material, DimValRec."Cost Type"::Sundry)
            ELSE
              DimValRec.SETRANGE("Cost Type","Cost Type (Price)");
          END;
          DimValRec.FINDFIRST;
          IF iCostType <> 0 THEN
            IF "Item No." + "Basic Item" + "Trade Item" <> '' THEN
              DimValRec.TESTFIELD("Cost Type", DimValRec."Cost Type"::Material);
          DetermineCostObject(DimValRec);
        END;
      END;

      IF iAction = 2 THEN BEGIN   //lookup
        DimValRec.RESET;
        DimValRec.Code := iCostObject;
        DimValRec.SETRANGE("Global Dimension No.",2);
        IF iCostType = 0 THEN BEGIN
          DimValRec.SETRANGE("Cost Type", DimValRec."Cost Type"::Labor);
        END ELSE BEGIN
          IF "Cost Type (Price)" = "Cost Type (Price)"::" " THEN
            DimValRec.SETRANGE("Cost Type", DimValRec."Cost Type"::Material, DimValRec."Cost Type"::Sundry)
          ELSE
            DimValRec.SETRANGE("Cost Type","Cost Type (Price)");
        END;
        IF PAGE.RUNMODAL(PAGE::"Cost Object List", DimValRec) = ACTION::LookupOK THEN BEGIN
          iCostObject := DimValRec.Code;
          ProcessCostObject(1, iCostType, iCostObject);
        END;
      END;
    END;

    LOCAL PROCEDURE DetermineCostObject@1100528900(DimValRec@1100528900 : Record 349);
    BEGIN
      //DP00381
      IF DimValRec."Cost Type" = DimValRec."Cost Type"::Labor THEN BEGIN
        VALIDATE("Cost Object Labor", DimValRec.Code);
      END ELSE BEGIN
        "Cost Type (Price)" := DimValRec."Cost Type";
        VALIDATE("Cost Object Price", DimValRec.Code);
      END;

      CheckCostObject(DimValRec.Code);
      IF "Item No." + "Basic Item" + "Trade Item" = '' THEN BEGIN
        IF "Sub Operation Code" <> '' THEN BEGIN
          ProcessSubOperation;
        END ELSE BEGIN
          IF CostObjectLeading THEN  //C050221
            Description := DimValRec.Name;
        END;
      END;
    END;

    PROCEDURE ChargePresent@1100528908(VAR chrg0@1100528905 : Boolean;VAR chrg1@1100528904 : Boolean;VAR chrg2@1100528903 : Boolean;VAR chrg3@1100528902 : Boolean;VAR chrg4@1100528901 : Boolean;VAR chrg5@1100528900 : Boolean);
    VAR
      ChrgRec@1100528906 : Record 11229771;
    BEGIN
      //DP00381
      chrg0 := FALSE;
      chrg1 := FALSE;
      chrg2 := FALSE;
      chrg3 := FALSE;
      chrg4 := FALSE;
      chrg5 := FALSE;

      ChrgRec.RESET;
      ChrgRec.SETFILTER("Estimate No.", '%1', '');
      ChrgRec.SETFILTER("Sub-Estimate No.", '%1', '');
      ChrgRec.SETFILTER("Part Group", '%1', '');
      ChrgRec.SETFILTER(Part, '%1', '');
      ChrgRec.SETRANGE("Recipe Line", 0);
      ChrgRec.SETRANGE("Recipe Group", "Recipe Group");
      ChrgRec.SETRANGE(Recipe, Recipe);
      ChrgRec.SETRANGE("Basic Line", "Line No.");
      ChrgRec.SETRANGE("Surcharge Line");
      IF NOT ChrgRec.ISEMPTY THEN BEGIN  //db, 25-10-16
        ChrgRec.FINDSET;
        REPEAT
          IF RcpLineRec.GET("Recipe Group", Recipe, ChrgRec."Surcharge Line") THEN BEGIN
            CASE RcpLineRec."Surcharge Type" OF
              RcpLineRec."Surcharge Type"::Labor:
                chrg1 := TRUE;
              RcpLineRec."Surcharge Type"::Material:
                chrg2 := TRUE;
              RcpLineRec."Surcharge Type"::Subcontracting:
                chrg3 := TRUE;
              RcpLineRec."Surcharge Type"::Plant:
                chrg4 := TRUE;
              RcpLineRec."Surcharge Type"::Sundry:
                chrg5 := TRUE;
            END;
          END;
        UNTIL ChrgRec.NEXT = 0;
      END;

      ChrgRec.SETRANGE("Basic Line");
      ChrgRec.SETRANGE("Surcharge Line", "Line No.");
      IF NOT ChrgRec.ISEMPTY THEN  //db, 25-10-16
        chrg0 := TRUE;
    END;

    PROCEDURE InitNormPrice@1100528909();
    BEGIN
      //db, 29-11-11
      Norm := 0;
      "Production Rate" := 0;
      "Net Cost Price" := 0;
      "Purchase Discount %" := 0;
      "Gross Price" := 0;
      "Net Sales Price" := 0;
      "Sales Discount %" := 0;
    END;

    PROCEDURE GetMinuts@1100485009(lvType@1100485002 : Integer;iCostSales@1100528900 : 'Cost,Sales') Result : Decimal;
    VAR
      NormDec@1100528901 : Decimal;
    BEGIN
      //IF iCostSales = iCostSales::Sales THEN  //DP00381
      //  NormDec := "Norm (Sales)"
      //ELSE
        NormDec := Norm;
      IF "Rate Type" = "Rate Type"::Hours THEN
        Result := NormDec * 60
      ELSE
        Result := NormDec;
      IF "Surcharge Type" <> "Surcharge Type"::" " THEN
        Result := Result * "Surcharge %" / 100;
      //IF iCostSales = iCostSales::Sales THEN BEGIN  //DP00381
      //  IF "Cum. Adj. Factor Hours (Sales)" <> 0 THEN
      //    Result := Result * "Cum. Adj. Factor Hours (Sales)";
      //END ELSE BEGIN
        IF "Cum. Adj. Factor Hours" <> 0 THEN
          Result := Result * "Cum. Adj. Factor Hours";
      //END;
      IF "Team Size" > 0 THEN
        Result := Result * "Team Size";
      IF lvType = 1 THEN BEGIN
        //IF iCostSales = iCostSales::Sales THEN  //DP00381
        //  Result := Result * "Quantity (Sales)"
        //ELSE
          Result := Result * Quantity;
      END;
      EXIT(Result);
    END;

    PROCEDURE EvaluateSurchargeCostType@1100525020();
    BEGIN
      //db, 14-11-13: DP00381
      "Cost Type (Price)" := "Surcharge Type" - 1;
      IF "Surcharge Type" = "Surcharge Type"::Labor THEN
        "Cost Object Price" := ''
      ELSE
        "Cost Object Labor" := '';

      GetEstSetup;  //DP01183
      CASE "Surcharge Type" OF
        "Surcharge Type"::Labor: "Cost Object Labor" := EstSetup."Absence Value Labor";
        "Surcharge Type"::Material: "Cost Object Price" := EstSetup."Absence Value Material";
        "Surcharge Type"::Subcontracting: "Cost Object Price" := EstSetup."Absence Value Subcontracting";
        "Surcharge Type"::Plant: "Cost Object Price" := EstSetup."Absence Value Plant";
        "Surcharge Type"::Sundry: "Cost Object Price" := EstSetup."Absence Value Sundry Cost";
      END;
    END;

    PROCEDURE CheckCostTypePriceAllowed@1100525008();
    BEGIN
      //db, 19-11-13: DP00381
      IF "Cost Type (Price)" <> "Cost Type (Price)"::" " THEN BEGIN
        IF ("Set Code" = '') AND ("Plant Type" = '') THEN BEGIN
          //db, 29-12-14: skip check on quantity; init value for set code is 1 to fill cumulative quantity on related lines
          TESTFIELD(Quantity, 0);
        //TESTFIELD("Quantity (Sales)", 0);
        END;
        TESTFIELD("Net Cost Price", 0);
        TESTFIELD("Net Sales Price", 0);
      END;
      IF "Item No." + "Basic Item" + "Trade Item" <> '' THEN BEGIN
        TESTFIELD("Recipe (Child)", '');
        TESTFIELD("Plant Type", '');
        TESTFIELD("Set Code", '');
        TESTFIELD("Subcontracting Activity", '');  //db, 19-02-19
      END;
      IF "Recipe (Child)" <> '' THEN BEGIN
        TESTFIELD("Item No.", '');
        TESTFIELD("Basic Item", '');
        TESTFIELD("Trade Item", '');
        TESTFIELD("Plant Type", '');
        TESTFIELD("Set Code", '');
        TESTFIELD("Subcontracting Activity", '');  //db, 19-02-19
      END;
      IF "Plant Type" <> '' THEN BEGIN
        TESTFIELD("Item No.", '');
        TESTFIELD("Basic Item", '');
        TESTFIELD("Trade Item", '');
        TESTFIELD("Recipe (Child)", '');
        TESTFIELD("Set Code", '');
        TESTFIELD("Subcontracting Activity", '');  //db, 19-02-19
      END;
      IF "Set Code" <> '' THEN BEGIN
        TESTFIELD("Item No.", '');
        TESTFIELD("Basic Item", '');
        TESTFIELD("Trade Item", '');
        TESTFIELD("Recipe (Child)", '');
        TESTFIELD("Plant Type", '');
        TESTFIELD("Subcontracting Activity", '');  //db, 19-02-19
      END;
      //db.sn, 19-02-19
      IF "Subcontracting Activity" <> '' THEN BEGIN
        TESTFIELD("Recipe (Child)", '');
        TESTFIELD("Item No.", '');
        TESTFIELD("Basic Item", '');
        TESTFIELD("Trade Item", '');
        TESTFIELD("Plant Type", '');
        TESTFIELD("Set Code", '');
      END;
      //db.en, 19-02-19

      "Cost Type (Price)" := "Cost Type (Price)"::" ";
      IF "Item No." + "Basic Item" + "Trade Item" <> '' THEN
        "Cost Type (Price)" := "Cost Type (Price)"::Material;
      IF "Plant Type" + "Set Code" <> '' THEN
        "Cost Type (Price)" := "Cost Type (Price)"::Plant;
      IF "Subcontracting Activity" <> '' THEN
        "Cost Type (Price)" := "Cost Type (Price)"::Subcontracting;   //db, 19-02-19
    END;

    PROCEDURE InitSurcharge@1100528911(SwitchCostType@1100528900 : Boolean);
    BEGIN
      //DP00594
      IF "Surcharge Type" <> "Surcharge Type"::" " THEN EXIT;
      //DP01183.sn
      IF "Recipe (Child)" <> '' THEN BEGIN
        GetEstSetup;
        IF EstSetup."Apply Surcharge Recipe Header" = EstSetup."Apply Surcharge Recipe Header"::Default THEN
          EXIT;  //db, 05-11-15: C026570
      END;
      //DP01183.en

      IF RecipeRec.GET("Recipe Group",Recipe) THEN BEGIN
        IF SwitchCostType = FALSE THEN
          "Surcharge % Labor" := RecipeRec."Surcharge % Labor";
        IF "Cost Type (Price)" = "Cost Type (Price)"::Material THEN BEGIN
          "Surcharge % Price" :=  RecipeRec."Surcharge % Material";
          CheckSurchargeMaterialPrice;
        END;
        IF "Cost Type (Price)" = "Cost Type (Price)"::Subcontracting THEN
          "Surcharge % Price" := RecipeRec."Surcharge % Subcontracting";
        IF "Cost Type (Price)" = "Cost Type (Price)"::Plant THEN
          "Surcharge % Price" := RecipeRec."Surcharge % Plant";
        IF "Cost Type (Price)" = "Cost Type (Price)"::Sundry THEN
          "Surcharge % Price" := RecipeRec."Surcharge % Sundry";
      END;
    END;

    PROCEDURE CheckSurchargeMaterialPrice@1100528912();
    VAR
      ProjSetup@1100528900 : Record 315;
      PriceHistRec@1100528902 : Record 11012315;
      RefDate@1100528901 : Date;
    BEGIN
      //DP00594
      IF "Cost Type (Price)" = "Cost Type (Price)"::Material THEN BEGIN
        ProjSetup.GET;
        IF ProjSetup."Apply SurchMat PriceZero Only" THEN BEGIN
          RefDate := TODAY;  //db, 05-08-16
          IF "Trade Item" <> '' THEN BEGIN
            PriceHistRec.SETRANGE(Vendor, "Vendor (Trade Item)");
            PriceHistRec.SETRANGE("Item Code", "Trade Item");
            PriceHistRec.SETRANGE("Starting Date", 0D, RefDate);
            IF NOT PriceHistRec.FINDLAST THEN PriceHistRec.INIT;
            IF PriceHistRec."Gross Price" <> 0 THEN
              "Surcharge % Price" := 0;
          END ELSE BEGIN
            IF "Item No." + "Basic Item" <> '' THEN
              "Surcharge % Price" := 0;
          END;
        END;
      END;
    END;

    PROCEDURE UpdateSalesPriceFromCostPrice@1100525009();
    BEGIN
      //db, 14-04-14: C014487
      GetEstSetup;  //DP01183
      IF EstSetup."Item Sales Price Based On" = EstSetup."Item Sales Price Based On"::GrossMin THEN EXIT;

      IF "Price Agreement (Sales)" THEN EXIT;

      "Sales Discount %":= 0;
      "Net Sales Price":= "Net Cost Price";
      "Net Sales Price (FCY)" := ExchangeAmtLCYToFCY("Net Sales Price", TRUE, TRUE, FALSE);  //DP02114
    END;

    PROCEDURE CopyItemText@1100409003();
    VAR
      TextRec@1100485000 : Record 11020595;
      TextRec2@1100485001 : Record 11020595;
      CurrLino@1100525001 : Integer;
      CommentLine@1100409000 : Record 97;
    BEGIN
      //DP00686
      IF "Line No." = 0 THEN EXIT;

      CommentLine.SETRANGE("Table Name", CommentLine."Table Name"::Item);
      CommentLine.SETRANGE("No.", "Item No.");
      IF NOT CommentLine.FINDFIRST THEN EXIT;

      TextRec.SETRANGE("Table Name", TextRec."Table Name"::Estimate);
      TextRec.SETRANGE(Group, "Recipe Group");
      TextRec.SETRANGE("No.", Recipe);
      TextRec.SETFILTER("Estimate No.", '%1', '');
      TextRec.SETFILTER("Sub-Estimate No.", '%1', '');
      TextRec.SETFILTER("Part Group", '%1', '');
      TextRec.SETFILTER(Part, '%1', '');
      TextRec.SETRANGE("Estimate Line No.", 0);
      TextRec.SETRANGE("Recipe Line No.", "Line No.");
      //TextRec.SETRANGE("Source Table", TextRec."Source Table"::Item);  //db, 17-02-15
      TextRec.DELETEALL;

      //TextRec.SETRANGE("Source Table");  //db, 17-02-15
      IF TextRec.FINDLAST THEN
        CurrLino := TextRec."Line No."
      ELSE
        CurrLino := 0;
      IF CommentLine.FINDSET THEN BEGIN
        REPEAT
          TextRec2.INIT;
          TextRec2."Table Name" := TextRec2."Table Name"::Estimate;
          //TextRec2."Source Table" := TextRec2."Source Table"::Item;  //db, 17-02-15
          TextRec2.Group := "Recipe Group";
          TextRec2."No." := Recipe;

          TextRec2.Date := CommentLine.Date;
          TextRec2.Code := CommentLine.Code;
          TextRec2.Comment := CommentLine.Comment;
          TextRec2."Comment Code" := CommentLine."Comment Code";
          TextRec2."Language Code" := CommentLine."Language Code";  //db, 22-05-15
          TextRec2."Line Break" := CommentLine."Line Break";
          TextRec2."Created by" := USERID;
          TextRec2."Time Created" := TIME;

          TextRec2."Recipe Line No." := "Line No.";
          CurrLino := CurrLino + 10000;
          TextRec2."Line No." := CurrLino;
          TextRec2.INSERT;
        UNTIL CommentLine.NEXT = 0;
      END;
    END;

    PROCEDURE RemoveRelatedData@1100525012();
    BEGIN
      //db, 31-08-17: obsolete function (not used according to Statical Prism)
    END;

    PROCEDURE InitRateRelatedFields@1100525033();
    BEGIN
      //DP01047
      "Cost Rate" := 0;
      "Cost Rate (FCY)" := 0; //DP02114
      "Sales Rate" := 0;
      "Sales Rate (FCY)" := 0;  //DP02114
      CLEAR("Rate Type");
      "Team Size" := 0;
      "Wage Component" := '';  //DP00236
    END;

    PROCEDURE InitNormRelatedFields@1100525006(iValue@1100528900 : Decimal);
    BEGIN
      //C053751: 0=clear; 1=init (switch plant/norm in hours should be budget neutral)
      Norm := 0;
      "Production Rate" := 0;
      //"Norm (Sales)" := 0;
      //"Production Rate (Sales)" := 0;
    END;

    PROCEDURE ValidateUnitOfMeasure@1100528400(UnitOfMeasureCode@1100528400 : Code[10]);
    BEGIN
      "Unit of Measure" := UnitOfMeasureCode;
      IF "Unit of Measure" <>  xRec."Unit of Measure" THEN
        CheckItemUnitConversion(Rec, xRec);
      CalculateTotals;
    END;

    PROCEDURE SetSkipUpdateSurcharge@1100529500(iSkipUpdateSurcharge@1100529500 : Boolean);
    BEGIN
      SkipUpdateSurcharge := iSkipUpdateSurcharge;  //C033781
    END;

    PROCEDURE LookupPlantType@1100529402();
    VAR
      PlantType@1100529400 : Record 11012551;
    BEGIN
      //DP01407
      EstSetup.GET;
      IF EstSetup."Plant Company" <> '' THEN
         PlantType.CHANGECOMPANY(EstSetup."Plant Company");
      PlantType.Code := "Plant Type";  //C036768
      IF PAGE.RUNMODAL(0, PlantType) = ACTION::LookupOK THEN
        VALIDATE("Plant Type", PlantType.Code);
    END;

    PROCEDURE LookupSetCode@1100529403();
    VAR
      PlantSet@1100529400 : Record 11012587;
    BEGIN
      //DP01407
      EstSetup.GET;
      IF EstSetup."Plant Company" <> '' THEN
         PlantSet.CHANGECOMPANY(EstSetup."Plant Company");
      PlantSet.Code := "Set Code";  //C036768
      IF PAGE.RUNMODAL(0, PlantSet) = ACTION::LookupOK THEN
        VALIDATE("Set Code", PlantSet.Code);
    END;

    PROCEDURE ValidateSetCode@1100529404();
    VAR
      PlantSet@1100529400 : Record 11012587;
    BEGIN
      //DP01407
      IF "Set Code" = '' THEN EXIT;
      EstSetup.GET;
      IF EstSetup."Plant Company" <> '' THEN
        PlantSet.CHANGECOMPANY(EstSetup."Plant Company");
      PlantSet.GET("Set Code");
      Description := PlantSet.Description;
      "Unit of Measure" := PlantSet."Unit of Measure";
    END;

    PROCEDURE GetSubcontractorActivity@1100529900(CalledBy@1100528500 : Integer);
    VAR
      SubcontractingActivityPrice@1100529900 : Record 11229373;
      BaseRecipe@1100525000 : Record 11020581;
    BEGIN
      //DP01492-2
      BaseRecipe.GET("Recipe Group", Recipe);
      BaseRecipe.TESTFIELD(Fixed, FALSE);  //C041836

      TESTFIELD("Cost Type (Price)", "Cost Type (Price)"::Subcontracting);
      SubcontractingActivityPrice.SETRANGE("Subcontracting Activity", "Subcontracting Activity");
      IF CalledBy = FIELDNO("Subcontracting Activity") THEN  //DP01958a
        SubcontractingActivityPrice.SETRANGE("Preferred Subcontractor", TRUE)
      ELSE
        SubcontractingActivityPrice.SETRANGE("Subcontractor No.", Subcontractor);
      IF SubcontractingActivityPrice.FINDFIRST THEN BEGIN
        VALIDATE("Net Cost Price", SubcontractingActivityPrice.GetPrice(TODAY));
        IF CalledBy = FIELDNO("Subcontracting Activity") THEN BEGIN  //DP01958a
          SubcontractingActivityPrice.CALCFIELDS("Activity Description");
          Description := SubcontractingActivityPrice."Activity Description";
        END;
        "Unit of Measure" := SubcontractingActivityPrice."Unit of Measure";
        "Cost Object Price" := SubcontractingActivityPrice."Cost Object";
        Subcontractor := SubcontractingActivityPrice."Subcontractor No.";
      END;
      IF "Subcontracting in Hours" THEN BEGIN  //C053751
        "Cost Type (Hours)" := "Cost Type (Hours)"::Subcontracting;
        "Rate Code" := '';
        InitRateRelatedFields;
      END;
    END;

    PROCEDURE DetermineBOMLevel@1100525019(LineNo@1100525000 : Integer;VAR BOMLevel@1100525002 : Integer);
    VAR
      BaseRecipeLine3@1100525003 : Record 11020582;
    BEGIN
      //T008150
      BaseRecipeLine3.SETRANGE("Recipe Group","Recipe Group");
      BaseRecipeLine3.SETRANGE(Recipe,Recipe);
      BaseRecipeLine3.SETRANGE("Line No.",LineNo);
      IF BaseRecipeLine3.FINDFIRST THEN
        BOMLevel := BaseRecipeLine3."Level BOM" + 1;
    END;

    LOCAL PROCEDURE CheckCurrencyAgreement@1100525034();
    BEGIN
      //DP02114
      GetEstSetup;
      IF "Currency Code" = '' THEN BEGIN
        "Currency Agreement" := FALSE;
      END ELSE BEGIN
        "Currency Agreement" := ("Currency Code" <> EstSetup."Currency Code");
      END;
    END;

    PROCEDURE GetCurrencyFactor@1100528601(IUseSalesExchange@1100528600 : Boolean;IUseReportCurrency@1100528602 : Boolean) : Decimal;
    VAR
      CurrencyExchangeRate@1100528601 : Record 330;
      CurrencyCode@1100528603 : Code[10];
    BEGIN
      //DP02114
      GetEstSetup;
      IF IUseReportCurrency THEN
        CurrencyCode := EstSetup."Currency Code"
      ELSE
        CurrencyCode := "Currency Code";
      EXIT(CurrencyExchangeRate.ExchangeRate(2, '', TODAY, CurrencyCode, IUseSalesExchange));
    END;

    PROCEDURE ExchangeAmtLCYToFCY@1100528602(IAmount@1100528601 : Decimal;IUseSalesExchange@1100528602 : Boolean;IUsePriceRounding@1100528605 : Boolean;IUseReportCurrency@1100528607 : Boolean) : Decimal;
    VAR
      CurrencyExchangeRate@1100528600 : Record 330;
      Currency@1100528604 : Record 4;
      Amount@1100528603 : Decimal;
      CurrencyCode@1100528606 : Code[10];
    BEGIN
      //DP02114
      IF "Currency Code" = '' THEN
        EXIT(IAmount);
      GetEstSetup;
      IF IUseReportCurrency THEN
        CurrencyCode := EstSetup."Currency Code"
      ELSE
        CurrencyCode := "Currency Code";
      Amount := CurrencyExchangeRate.ExchangeAmtLCYToFCY(
        2, '', TODAY, CurrencyCode, IAmount, GetCurrencyFactor(IUseSalesExchange, IUseReportCurrency), IUseSalesExchange);
      IF NOT Currency.GET(CurrencyCode) THEN
        Currency.InitRoundingPrecision;
      IF IUsePriceRounding THEN
        Amount := ROUND(Amount, Currency."Unit-Amount Rounding Precision")
      ELSE
        Amount := ROUND(Amount, Currency."Amount Rounding Precision");
      EXIT(Amount);
    END;

    PROCEDURE ExchangeAmtFCYToLCY@1100528600(IAmount@1100528601 : Decimal;IUseSalesExchange@1100528602 : Boolean;IUsePriceRounding@1100528605 : Boolean;IUseReportCurrency@1100528606 : Boolean) : Decimal;
    VAR
      CurrencyExchangeRate@1100528600 : Record 330;
      Currency@1100528604 : Record 4;
      Amount@1100528603 : Decimal;
      CurrencyCode@1100528607 : Code[10];
    BEGIN
      //DP02114
      IF "Currency Code" = '' THEN
        EXIT(IAmount);
      GetEstSetup;
      IF IUseReportCurrency THEN
        CurrencyCode := EstSetup."Currency Code"
      ELSE
        CurrencyCode := "Currency Code";
      Amount := CurrencyExchangeRate.ExchangeAmtFCYToLCY(
        2, '', TODAY, CurrencyCode, IAmount, GetCurrencyFactor(IUseSalesExchange, IUseReportCurrency), IUseSalesExchange);
      Currency.InitRoundingPrecision;
      IF IUsePriceRounding THEN
        Amount := ROUND(Amount, Currency."Unit-Amount Rounding Precision")
      ELSE
        Amount := ROUND(Amount, Currency."Amount Rounding Precision");
      EXIT(Amount);
    END;

    PROCEDURE ExchangeAmtFCYToFCY@1100528604(IAmount@1100528606 : Decimal;IFromCurrencyCode@1100528604 : Code[10];IToCurrencyCode@1100528605 : Code[10];IUseSalesExchange@1100528607 : Boolean;IUsePriceRounding@1100528608 : Boolean) : Decimal;
    VAR
      CurrencyExchangeRate@1100528603 : Record 330;
      Currency@1100528602 : Record 4;
      CurrencyFactor@1100528609 : Decimal;
      Amount@1100528601 : Decimal;
    BEGIN
      //DP02114
      Amount := IAmount;
      IF IFromCurrencyCode <> '' THEN BEGIN
        CurrencyFactor := CurrencyExchangeRate.ExchangeRate(2, '', TODAY, IFromCurrencyCode, IUseSalesExchange);
        Amount := CurrencyExchangeRate.ExchangeAmtFCYToLCY(2, '', TODAY, IFromCurrencyCode, Amount, CurrencyFactor, IUseSalesExchange);
      END;
      IF IToCurrencyCode <> '' THEN BEGIN
        CurrencyFactor := CurrencyExchangeRate.ExchangeRate(2, '', TODAY, IToCurrencyCode, IUseSalesExchange);
        Amount := CurrencyExchangeRate.ExchangeAmtLCYToFCY(2, '', TODAY, IToCurrencyCode, Amount, CurrencyFactor, IUseSalesExchange);
      END;
      IF NOT Currency.GET(IToCurrencyCode) THEN
        Currency.InitRoundingPrecision;
      IF IUsePriceRounding THEN
        Amount := ROUND(Amount, Currency."Unit-Amount Rounding Precision")
      ELSE
        Amount := ROUND(Amount, Currency."Amount Rounding Precision");
      EXIT(Amount);
    END;

    PROCEDURE SetSkipValidateFCY@1100528603(ISkipValidateFCY@1100528600 : Boolean);
    BEGIN
      //DP02114
      SkipValidateFCY := ISkipValidateFCY;
    END;

    PROCEDURE CheckBomLines@1100528919();
    VAR
      BaseRecipeLine@1210190000 : Record 11020582;
      OldQuan@1210190001 : Decimal;
      NewQuan@1210190002 : Decimal;
    BEGIN
      IF ("BOM Item No." = '') THEN EXIT;
      IF ("Level BOM" <> 0) THEN EXIT;

      //DP02339.sn
      OldQuan := xRec.Quantity;
      NewQuan := Quantity;
      //DP02339.en

      BaseRecipeLine.SETRANGE("Recipe Group", "Recipe Group");
      BaseRecipeLine.SETRANGE(Recipe, Recipe);
      BaseRecipeLine.SETRANGE("BOM Item No.", "BOM Item No.");
      BaseRecipeLine.SETRANGE("Part of Line", "Line No.");
      IF BaseRecipeLine.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF OldQuan = 0 THEN
            BaseRecipeLine.Quantity := BaseRecipeLine."Original Quantity" * NewQuan  //DP02339
          ELSE
            BaseRecipeLine.Quantity := BaseRecipeLine.Quantity * NewQuan / OldQuan;
          BaseRecipeLine.CalculateTotals;
          BaseRecipeLine.MODIFY(TRUE);
        UNTIL BaseRecipeLine.NEXT = 0;
      END;
    END;

    PROCEDURE GetDisciplineByElement@1100528920();
    VAR
      BaseElement@1100528900 : Record 11012060;
    BEGIN
      //DP02460
      IF Element = '' THEN EXIT;
      IF NOT BaseElement.GET(Element) THEN BaseElement.INIT;
      IF BaseElement.Discipline <> '' THEN
        Discipline := BaseElement.Discipline;
    END;

    BEGIN
    {
      //db, 05-08-16: all references to table Estimate removed
    }
    END.
  }
}

