OBJECT Page 5097 Create Task
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Create Task;
               NOR=Opprett oppgave;
               SVE=Skapa Uppgift];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5080;
    DataCaptionExpr=Caption;
    PageType=Card;
    OnInit=VAR
             PermissionManager@1000 : Codeunit 9002;
           BEGIN
             AttachmentEnable := TRUE;
             LanguageCodeEnable := TRUE;
             CalcDueDateFromEnable := TRUE;
             RecurringDateIntervalEnable := TRUE;
             WizardContactNameEnable := TRUE;
             AllDayEventEnable := TRUE;
             LocationEnable := TRUE;
             DurationEnable := TRUE;
             EndingTimeEnable := TRUE;
             StartTimeEnable := TRUE;
             SalespersonCodeEnable := TRUE;
             SalespersonCodeEditable := TRUE;
             "Responsible PersonEditable" := TRUE; //**4PS.n
             // WizardOpportunityDescriptionEd := TRUE; //**4PS.o
             WizardContactNameEditable := TRUE;
             TeamTaskEditable := TRUE;
             IsSoftwareAsAService := PermissionManager.SoftwareAsAService;
             ContactNoEditable := TRUE; //**4PS.n
           END;

    OnOpenPage=BEGIN
                 IsOnMobile := ClientTypeManagement.GetCurrentClientType = CLIENTTYPE::Phone;

                 WizardContactNameEditable := FALSE;
                 WizardCampaignDescriptionEdita := FALSE;
                 // WizardOpportunityDescriptionEd := FALSE; //**4PS.o

                 IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN BEGIN
                   SalespersonCodeEditable := FALSE;
                   TeamTaskEditable := FALSE;
                 END;

                 //**4PS.sn
                 IF Employee.GET(GETFILTER("Responsible Person")) THEN
                   "Responsible PersonEditable" := FALSE;
                 //**4PS.en

                 IF "Segment Description" <> '' THEN
                   SegmentDescEditable := FALSE;

                 IsMeeting := (Type = Type::Meeting);
               END;

    OnAfterGetRecord=BEGIN
                       EnableFields;
                       WizardContactNameOnFormat(FORMAT("Wizard Contact Name"));
                     END;

    OnQueryClosePage=BEGIN
                       IF CloseAction IN [ACTION::OK,ACTION::LookupOK] THEN
                         FinishPage;
                     END;

    ActionList=ACTIONS
    {
      { 1100529601;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100529602;1 ;Action    ;
                      CaptionML=[ENU=Co&mment;
                                 SVE=&Kommentar];
                      ToolTipML=[ENU=View or add comments.;
                                 SVE=Visa eller lÑgg till kommentarer.];
                      Visible=FALSE;
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowTmpComment; //**4PS.n
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 10      ;1   ;Action    ;
                      Name=Finish;
                      CaptionML=[ENU=&Finish;
                                 NOR=&Fullfõr;
                                 SVE=&Slutfîr];
                      ToolTipML=[ENU=Finish the task.;
                                 NOR=Fullfõr oppgaven.;
                                 SVE=Slutfîr uppgiften.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Visible=IsOnMobile;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=BEGIN
                                 FinishPage;
                                 CurrPage.CLOSE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=General;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt];
                GroupType=Group }

    { 18  ;2   ;Field     ;
                Name=TypeSaaS;
                CaptionML=[ENU=Type;
                           NOR=Type;
                           SVE=Typ];
                ToolTipML=[ENU=Specifies the type of the Task.;
                           NOR=Angir oppgavetypen.;
                           SVE=Anger uppgiftens typ.];
                OptionCaptionML=[ENU=" ,,Phone Call";
                                 NOR=" ,,Telefonsamtale";
                                 SVE=" ,,Telefonsamtal"];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Type;
                Visible=IsSoftwareAsAService;
                OnValidate=BEGIN
                             ValidateTypeField;
                           END;
                            }

    { 7   ;2   ;Field     ;
                Name=TypeOnPrem;
                CaptionML=[ENU=Type;
                           NOR=Type;
                           SVE=Typ];
                ToolTipML=[ENU=Specifies the type of the Task.;
                           NOR=Angir oppgavetypen.;
                           SVE=Anger uppgiftens typ.];
                OptionCaptionML=[ENU=" ,Meeting,Phone Call";
                                 NOR=" ,Mõte,Telefonsamtale";
                                 SVE=" ,Mîte,Telefonsamtal"];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Type;
                Visible=NOT IsSoftwareAsAService;
                OnValidate=BEGIN
                             ValidateTypeField;
                           END;
                            }

    { 1100528700;2;Field  ;
                SourceExpr="Standard To-do Code";
                OnValidate=VAR
                             StandardTodo@1100525000 : Record 11125866;
                           BEGIN
                             //**4PS.sn
                             IF "Standard To-do Code" <> '' THEN BEGIN
                               StandardTodo.GET("Standard To-do Code");
                               VALIDATE(Description, StandardTodo.Description);
                             END;
                             //**4PS.en
                           END;

                OnLookup=VAR
                           StandardTodo@1100528700 : Record 11125866;
                         BEGIN
                           IF PAGE.RUNMODAL(PAGE::"Standard To-dos", StandardTodo) = ACTION::LookupOK THEN BEGIN
                             VALIDATE("Standard To-do Code", StandardTodo.Code);
                             VALIDATE(Description, StandardTodo.Description);
                           END;
                         END;
                          }

    { 1100529604;2;Field  ;
                SourceExpr="Standard To-do Description" }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the Task.;
                           NOR=Angir beskrivelsen av oppgaven.;
                           SVE=Anger en beskrivning av uppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Description }

    { 44  ;2   ;Field     ;
                Name=AllDayEvent;
                CaptionML=[ENU=All Day Event;
                           NOR=Hele dagen;
                           SVE=Hela dagen];
                ToolTipML=[ENU=Specifies that the Task of the Meeting type is an all-day event, which is an activity that lasts 24 hours or longer.;
                           NOR=Angir at oppgaven av typen Mõte er en heldagshendelse, det vil si en aktivitet som varer 24 timer eller lenger.;
                           SVE=Anger att uppgiften av typen Mîte varar hela dagen, det vill sÑga 24 timmar eller lÑngre.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="All Day Event";
                Enabled=AllDayEventEnable;
                OnValidate=BEGIN
                             AllDayEventOnAfterValidate;
                           END;
                            }

    { 12  ;2   ;Field     ;
                Name=Start Date;
                CaptionML=[ENU=Start Date;
                           NOR=Startdato;
                           SVE=Startdatum];
                ToolTipML=[ENU=Specifies the date when the Task should be started. There are certain rules for how dates should be entered found in How to: Enter Dates and Times.;
                           NOR=Angir datoen da oppgaven skal starte. Det finnes bestemte regler for hvordan datoer skal registreres. Disse finner du under Lëre hvordan du setter inn datoer og klokkeslett.;
                           SVE=Anger datumet dÜ uppgiften startas. Det finns vissa regler fîr hur datum anges i SÜ hÑr anger du datum och tid.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Date }

    { 49  ;2   ;Field     ;
                Name=Start Time;
                CaptionML=[ENU=Start Time;
                           NOR=Starttidspunkt;
                           SVE=Starttid];
                ToolTipML=[ENU=Specifies the time when the Task of the Meeting type should be started.;
                           NOR=Angir klokkeslettet da oppgaven av typen Mõte skal starte.;
                           SVE=Anger tidpunkten dÜ uppgiften av typen Mîte startas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Start Time";
                Enabled=StartTimeEnable }

    { 51  ;2   ;Field     ;
                CaptionML=[ENU=Duration;
                           NOR=Varighet;
                           SVE=Varaktighet];
                ToolTipML=[ENU=Specifies the duration of the Task of the Meeting type.;
                           NOR=Angir varigheten for oppgaven av typen Mõte.;
                           SVE=Anger varaktigheten fîr uppgiften av typen Mîte.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Duration;
                Enabled=DurationEnable }

    { 45  ;2   ;Field     ;
                Name=Ending Date;
                CaptionML=[ENU=Ending Date;
                           NOR=Sluttdato;
                           SVE=Slutdatum];
                ToolTipML=[ENU=Specifies the date of when the Task should end. There are certain rules for how dates should be entered. For more information, see How to: Enter Dates and Times.;
                           NOR=Angir datoen da oppgaven skal avsluttes. Det finnes bestemte regler for hvordan datoer skal registreres. Se Lëre hvordan du setter inn datoer og klokkeslett for mer informasjon.;
                           SVE=Anger datumet dÜ uppgiften avslutas. Det finns vissa regler fîr hur datum anges. Mer information finns i SÜ hÑr anger du datum och tid.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Ending Date" }

    { 55  ;2   ;Field     ;
                Name=Ending Time;
                CaptionML=[ENU=Ending Time;
                           NOR=Sluttidspunkt;
                           SVE=Sluttid];
                ToolTipML=[ENU=Specifies the time of when the Task of the Meeting type should end.;
                           NOR=Angir klokkeslettet da oppgaven av typen Mõte skal avsluttes.;
                           SVE=Anger tidpunkten dÜ uppgiften av typen Mîte avlutas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Ending Time";
                Enabled=EndingTimeEnable }

    { 29  ;2   ;Field     ;
                Name=TeamTask;
                CaptionML=[ENU=Team Task;
                           NOR=Oppgave for prosjektgruppe;
                           SVE=Teamuppgift];
                ToolTipML=[ENU=Specifies if the Task is meant to be done team-wide. Select the check box to specify that the Task applies to the entire Team.;
                           NOR=Angir om oppgaven skal utfõres av hele prosjektgruppen. Merk av for Ü angi at oppgaven gjelder for hele prosjektgruppen.;
                           SVE=Anger att uppgiften utfîrs av hela teamet. Markera kryssrutan fîr att ange att uppgiften gÑller fîr hela teamet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Team To-do";
                Editable=TeamTaskEditable;
                OnValidate=BEGIN
                             IF NOT "Team To-do" THEN BEGIN
                               "Team Code" := '';
                             //SalespersonCodeEnable := FALSE; //**4PS.o T007713
                               IF Type = Type::Meeting THEN BEGIN
                                 ClearDefaultAttendeeInfo;
                                 AssignDefaultAttendeeInfo;
                               END;
                             END;
                           END;
                            }

    { 21  ;2   ;Field     ;
                Lookup=No;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies a Contact name from the wizard.;
                           NOR=Angir et kontaktnavn fra veiviseren.;
                           SVE=Anger ett kontaktnamn frÜn guiden.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Wizard Contact Name";
                TableRelation=Contact;
                Enabled=WizardContactNameEnable;
                Editable=WizardContactNameEditable;
                OnAssistEdit=VAR
                               Cont@1102601001 : Record 5050;
                             BEGIN
                               IF (GETFILTER("Contact No.") = '') AND (GETFILTER("Contact Company No.") = '') AND ("Segment Description" = '') THEN BEGIN
                                 IF Cont.GET("Contact No.") THEN ;
                                 IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                   VALIDATE("Contact No.",Cont."No.");
                                   "Wizard Contact Name" := Cont.Name;
                                 END;
                               END;
                             END;
                              }

    { 9   ;2   ;Field     ;
                CaptionML=[ENU=Salesperson;
                           NOR=Selger;
                           SVE=SÑljare];
                ToolTipML=[ENU=Specifies the code of the Salesperson assigned to the Task.;
                           NOR=Angir koden for selgeren som er tilordnet til oppgaven.;
                           SVE=Anger koden fîr sÑljaren som tilldelades uppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Salesperson Code";
                Enabled=SalespersonCodeEnable;
                Editable=SalespersonCodeEditable }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Team;
                           NOR=Prosjektgruppe;
                           SVE=Team];
                ToolTipML=[ENU=Specifies the code of the Team to which the Task is assigned.;
                           NOR=Angir koden for prosjektgruppen som oppgaven er tilordnet til.;
                           SVE=Anger koden fîr teamet som tilldelades uppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Team Code";
                Enabled="Team To-do" OR NOT IsMeeting;
                Editable="Team To-do";
                OnValidate=BEGIN
                             IF (xRec."Team Code" <> "Team Code") AND
                                ("Team Code" <> '') AND
                                (Type = Type::Meeting)
                             THEN BEGIN
                               ClearDefaultAttendeeInfo;
                               AssignDefaultAttendeeInfo
                             END
                           END;
                            }

    { 11  ;2   ;Field     ;
                Lookup=No;
                CaptionML=[ENU=Campaign;
                           NOR=Kampanje;
                           SVE=Kampanj];
                ToolTipML=[ENU=Specifies a description of the campaign that is related to the task. The description is copied from the campaign card.;
                           NOR=Angir en beskrivelse av kampanjen som er relatert til oppgaven. Beskrivelsen blir kopiert fra kampanjekortet.;
                           SVE=Anger en beskrivning av kampanjen som Ñr relaterad till uppgiften. Beskrivningen kopieras frÜn kampanjkortet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Wizard Campaign Description";
                TableRelation=Campaign;
                Importance=Additional;
                Visible=FALSE;
                Editable=WizardCampaignDescriptionEdita;
                OnAssistEdit=VAR
                               Campaign@1102601001 : Record 11072034;
                             BEGIN
                               IF GETFILTER("Campaign No.") = '' THEN BEGIN
                                 IF Campaign.GET("Campaign No.") THEN ;
                                 IF PAGE.RUNMODAL(0,Campaign) = ACTION::LookupOK THEN BEGIN
                                   VALIDATE("Campaign No.",Campaign."No.");
                                   "Wizard Campaign Description" := Campaign.Description;
                                 END;
                               END;
                             END;
                              }

    { 5   ;2   ;Field     ;
                Lookup=No;
                CaptionML=[ENU=Opportunity;
                           NOR=Salgsmulighet;
                           SVE=AffÑrsmîjlighet];
                ToolTipML=[ENU=Specifies a description of the Opportunity that is related to the Task. The description is copied from the Campaign card.;
                           NOR=Angir en beskrivelse av salgsmuligheten som er relatert til oppgaven. Beskrivelsen blir kopiert fra kampanjekortet.;
                           SVE=Anger en beskrivning av affÑrsmîjligheten som Ñr relaterad till uppgiften. Beskrivningen kopieras frÜn kampanjkortet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Wizard Opportunity Description";
                TableRelation=Opportunity;
                Importance=Additional;
                Editable=WizardOpportunityDescriptionEd;
                OnAssistEdit=VAR
                               Opp@1102601001 : Record 5092;
                             BEGIN
                               IF GETFILTER("Opportunity No.") = '' THEN BEGIN
                                 IF Opp.GET("Opportunity No.") THEN ;
                                 IF PAGE.RUNMODAL(0,Opp) = ACTION::LookupOK THEN BEGIN
                                   VALIDATE("Opportunity No.",Opp."No.");
                                   "Wizard Opportunity Description" := Opp.Description;
                                 END;
                               END;
                             END;
                              }

    { 6   ;2   ;Field     ;
                Name=SegmentDesc;
                Lookup=No;
                CaptionML=[ENU=Create Tasks for Segment Contacts;
                           NOR=Opprett oppgaver for segmentkontakter;
                           SVE=Skapa uppgifter fîr segmentkontakter];
                ToolTipML=[ENU=Specifies a description of the Segment related to the Task. The description is copied from the Segment Card.;
                           NOR=Angir en beskrivelse av segmentet som er relatert til oppgaven. Beskrivelsen blir kopiert fra segmentkortet.;
                           SVE=Anger en beskrivning av segmentet som Ñr relaterad till uppgiften. Beskrivningen kopieras frÜn segmentkortet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Segment Description";
                TableRelation="Segment Header";
                Importance=Additional;
                Editable=SegmentDescEditable;
                OnAssistEdit=VAR
                               SegmentHeader@1102601000 : Record 11072039;
                             BEGIN
                               IF GETFILTER("Segment No.") = '' THEN BEGIN
                                 IF SegmentHeader.GET("Segment No.") THEN ;
                                 IF PAGE.RUNMODAL(0,SegmentHeader) = ACTION::LookupOK THEN BEGIN
                                   VALIDATE("Segment No.",SegmentHeader."No.");
                                   "Segment Description" := SegmentHeader.Description;
                                 END;
                               END;
                             END;
                              }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Priority;
                           NOR=Prioritet;
                           SVE=Prioritet];
                ToolTipML=[ENU=Specifies the priority of the Task. There are three options:;
                           NOR=Angir prioriteten for oppgaven. Det er tre alternativer:;
                           SVE=Anger uppgiftens prioritet. Det finns tre alternativ:];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Priority;
                Importance=Additional }

    { 3   ;2   ;Field     ;
                Name=Location;
                CaptionML=[ENU=Location;
                           NOR=Lokasjon;
                           SVE=Plats];
                ToolTipML=[ENU=Specifies the Location where the Meeting will take place.;
                           NOR=Angir lokasjonen der mõtet skal foregÜ.;
                           SVE=Anger den plats dÑr mîtet kommer att Ñga rum.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Location;
                Importance=Promoted;
                Visible=NOT IsSoftwareAsAService;
                Enabled=LocationEnable }

    { 1100529600;2;Field  ;
                SourceExpr=Rubric }

    { 1100529603;2;Field  ;
                SourceExpr="Contact No.";
                Editable=ContactNoEditable;
                OnLookup=VAR
                           Todo@1100529601 : Record 5080;
                           Cont@1100529600 : Record 5050;
                         BEGIN
                           //**4PS.sn
                           // code copied from page 5098 To-do Card
                           IF Type = Type::Meeting THEN BEGIN
                             Todo.SETRANGE("No.","No.");
                             PAGE.RUNMODAL(PAGE::"Attendee Scheduling",Todo);
                           END ELSE BEGIN
                             IF "Try-out No." <> '' THEN
                               PrepareTryoutContactLookup(Cont);
                             IF "Try-out Quote No." <> '' THEN
                               PrepareTryoutQuoteContLookup(Cont);

                             IF Cont.GET("Contact No.") THEN;
                             IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                               VALIDATE("Contact No.",Cont."No.");
                               CurrPage.UPDATE;
                             END;
                           END;
                           //**4PS.en
                         END;
                          }

    { 1100529606;2;Field  ;
                SourceExpr=Status }

    { 1100527400;2;Field  ;
                Name=ResponsibilityGeneral;
                SourceExpr="Responsibility Code";
                Importance=Additional;
                Visible=FALSE }

    { 1100527401;2;Field  ;
                Name=ResponsiblePersonGeneral;
                SourceExpr="Responsible Person";
                Importance=Additional;
                Visible=FALSE }

    { 1100527402;2;Field  ;
                Name=NameEmployeeGeneral;
                SourceExpr="Name Employee";
                Importance=Additional;
                Visible=FALSE }

    { 20  ;1   ;Group     ;
                Name=MeetingAttendees;
                CaptionML=[ENU=Meeting Attendees;
                           NOR=Mõtedeltakere;
                           SVE=Mîtesdeltagare];
                Visible=IsMeeting;
                GroupType=Group }

    { 19  ;2   ;Part      ;
                Name=AttendeeSubform;
                ApplicationArea=#RelationshipMgmt;
                SubPageLink=To-do No.=FIELD(No.);
                PagePartID=Page5198;
                PartType=Page }

    { 22  ;2   ;Group     ;
                Name=MeetingInteraction;
                CaptionML=[ENU=Interaction;
                           NOR=Samhandling;
                           SVE=Interaktion];
                GroupType=Group }

    { 16  ;3   ;Field     ;
                CaptionML=[ENU=Send Invitation(s) on OK;
                           NOR=Send invitasjon(er) ved fullfõring;
                           SVE=Skicka inbjudan nÑr jag klickar pÜ Slutfîr];
                ToolTipML=[ENU=Specifies if the meeting invitation task will be sent when the Create Task wizard is finished.;
                           NOR=Angir om mõteinvitasjonsoppgaven blir sendt nÜr veiviseren Opprett oppgave fullfõres.;
                           SVE=Anger om uppgiften om mîtesinbjudan skickas nÑr guiden Skapa uppgift Ñr slutfîrd.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Send on finish" }

    { 15  ;3   ;Field     ;
                CaptionML=[ENU=Interaction Template;
                           NOR=Samhandlingsmal;
                           SVE=Interaktionsmall];
                ToolTipML=[ENU=Specifies the code for the Interaction Template that you have selected.;
                           NOR=Angir koden for den valgte samhandlingsmalen.;
                           SVE=Anger koden fîr den interaktionsmall som du har valt.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Interaction Template Code";
                TableRelation="Interaction Template";
                OnValidate=BEGIN
                             ValidateInteractionTemplCode;
                             InteractionTemplateCodeOnAfter;
                           END;
                            }

    { 14  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the language that is used when translating specified text on documents to foreign business partner, such as an item description on an order confirmation.;
                           NOR=Angir sprÜket som brukes under konvertering av angitt tekst i dokumenter til utenlandsk forretningspartner, for eksempel en varebeskrivelsen pÜ en ordrebekreftelse.;
                           SVE=Anger vilket sprÜk som anvÑnds nÑr angiven text i dokument îversÑtts fîr utlÑndska affÑrspartner, till exempel en artikelbeskrivning pÜ en orderbekrÑftelse.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Language Code";
                Enabled=LanguageCodeEnable;
                OnValidate=BEGIN
                             ValidateLanguageCode;
                           END;

                OnLookup=BEGIN
                           LookupLanguageCode;
                         END;
                          }

    { 13  ;3   ;Field     ;
                Name=Attachment;
                AssistEdit=Yes;
                CaptionML=[ENU=Attachment;
                           NOR=Vedlegg;
                           SVE=Bilaga];
                ToolTipML=[ENU=Specifies if the linked attachment is inherited or unique.;
                           NOR=Angir om det koblede vedlegget er arvet eller unikt.;
                           SVE=Anger om den lÑnkade bilagan Ñr Ñrvd eller unik.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Attachment No." > 0;
                Enabled=AttachmentEnable;
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               AssistEditAttachment;
                             END;
                              }

    { 1100528703;2;Field  ;
                CaptionML=ENU=What is the responsibility?;
                SourceExpr="Responsibility Code" }

    { 1100528701;2;Field  ;
                CaptionML=ENU=Who is the responsible person?;
                SourceExpr="Responsible Person";
                Editable="Responsible PersonEditable" }

    { 1100529605;2;Field  ;
                SourceExpr="Name Employee" }

    { 1100525000;2;Field  ;
                SourceExpr="Contact Company Name";
                Editable=FALSE }

    { 1100529626;1;Group  ;
                CaptionML=[ENU=Related Activities;
                           SVE=Relaterade aktiviteter] }

    { 1100529625;2;Field  ;
                SourceExpr="Campaign No." }

    { 1100529624;2;Field  ;
                SourceExpr="Campaign Description" }

    { 4   ;1   ;Group     ;
                Name=RecurringOptions;
                CaptionML=[ENU=Recurring;
                           NOR=Gjentakende;
                           SVE=èterkommande];
                GroupType=Group }

    { 17  ;2   ;Field     ;
                CaptionML=[NOR=Gjentakende oppgaver;
                           SVE=èterkommande uppgift];
                ToolTipML=[ENU=Specifies that the Task occurs periodically.;
                           NOR=Angir at oppgaven skjer regelmessig.;
                           SVE=Anger att uppgiften Ñr Üterkommande.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Recurring;
                OnValidate=BEGIN
                             RecurringOnAfterValidate;
                           END;
                            }

    { 26  ;2   ;Field     ;
                CaptionML=[ENU=Recurring Date Interval;
                           NOR=Gjentakende datointervall;
                           SVE=èterkommande datumintervall];
                ToolTipML=[ENU=Specifies the date formula to assign automatically a recurring Task to a Salesperson or Team.;
                           NOR=Angir datoformelen som brukes til Ü knytte et gjentakende oppgave til en selger eller en prosjektgruppe automatisk.;
                           SVE=FÑltet innehÜller datumformeln som anvÑnds nÑr en Üterkommande uppgift tilldelas en sÑljare eller ett team automatiskt.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Recurring Date Interval";
                Enabled=RecurringDateIntervalEnable }

    { 34  ;2   ;Field     ;
                CaptionML=[NOR=Beregn fra;
                           SVE=BerÑkna frÜn datum];
                ToolTipML=[ENU=Specifies the date to use to calculate the date on which the next Task should be completed.;
                           NOR=Angir datoen som skal brukes til Ü beregne datoen for fullfõring av neste oppgave.;
                           SVE=Anger datumet som anvÑnds fîr att berÑkna datumet dÜ nÑsta uppgift ska vara slutfîrd.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Calc. Due Date From";
                Enabled=CalcDueDateFromEnable }

    { 1100529607;1;Group  ;
                Name=Date;
                CaptionML=[ENU=Date;
                           SVE=Datum];
                GroupType=Group }

    { 1100529608;2;Field  ;
                SourceExpr="Planned by" }

    { 1100529609;2;Field  ;
                SourceExpr="Planned on" }

    { 1100529610;2;Field  ;
                SourceExpr="Planned in Outlook" }

    { 1100529611;1;Group  ;
                Name=Links;
                CaptionML=[ENU=Links;
                           SVE=LÑnkar];
                GroupType=Group }

    { 1100529612;2;Field  ;
                SourceExpr="Try-out No." }

    { 1100529613;2;Field  ;
                SourceExpr="Try-out Quote No." }

    { 1100529614;2;Field  ;
                SourceExpr="Estimate No." }

    { 1100529615;2;Field  ;
                SourceExpr="Project No." }

    { 1100529616;2;Field  ;
                SourceExpr="Parcel No.";
                Importance=Additional }

    { 1100529617;2;Field  ;
                SourceExpr="Building Code";
                Importance=Additional }

    { 1100529627;2;Field  ;
                SourceExpr="Service Location No." }

    { 1100529618;2;Field  ;
                SourceExpr="Service Contract No." }

    { 1100529619;2;Field  ;
                SourceExpr="Service Call No." }

    { 1100529620;2;Field  ;
                SourceExpr="Service Order No." }

    { 1100529621;2;Field  ;
                SourceExpr="Customer No.";
                Importance=Additional }

    { 1100529622;2;Field  ;
                SourceExpr="Cust. Ledger Entry No.";
                Importance=Additional }

    { 1100529623;2;Field  ;
                SourceExpr="Action No.";
                Importance=Additional }

    { 1100528500;2;Field  ;
                SourceExpr="Estimate No. RAW";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      Text000@1025 : TextConst 'ENU=(Multiple);NOR=(Flere);SVE=(Flera)';
      Text001@1001 : TextConst 'ENU=untitled;NOR=uten navn;SVE=namnlîs';
      Cont@1004 : Record 5050;
      SalesPurchPerson@1005 : Record 13;
      Campaign@1006 : Record 11072034;
      Team@1007 : Record 5083;
      Opp@1008 : Record 5092;
      SegHeader@1009 : Record 11072039;
      AttendeeTemp@1012 : TEMPORARY Record 5199;
      ClientTypeManagement@1003 : Codeunit 4030;
      Employee@1100528700 : Record 5200;
      SalespersonFilter@1026 : Code[20];
      ContactFilter@1030 : Code[20];
      TeamTaskEditable@19073246 : Boolean INDATASET;
      WizardContactNameEditable@19024232 : Boolean INDATASET;
      WizardCampaignDescriptionEdita@19073396 : Boolean INDATASET;
      WizardOpportunityDescriptionEd@19027967 : Boolean INDATASET;
      "Responsible PersonEditable"@19078680 : Boolean INDATASET;
      SegmentDescEditable@19045407 : Boolean INDATASET;
      IsMeeting@1000 : Boolean;
      IsOnMobile@1002 : Boolean;
      SalespersonCodeEnable@19074307 : Boolean INDATASET;
      StartTimeEnable@19064228 : Boolean INDATASET;
      EndingTimeEnable@19019613 : Boolean INDATASET;
      DurationEnable@19035217 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      AllDayEventEnable@19049519 : Boolean INDATASET;
      WizardContactNameEnable@19059568 : Boolean INDATASET;
      RecurringDateIntervalEnable@19019953 : Boolean INDATASET;
      CalcDueDateFromEnable@19036769 : Boolean INDATASET;
      LanguageCodeEnable@19042658 : Boolean INDATASET;
      AttachmentEnable@19033701 : Boolean INDATASET;
      IsSoftwareAsAService@1010 : Boolean;
      SalespersonCodeEditable@19071610 : Boolean INDATASET;
      ContactNoEditable@1100529601 : Boolean;
      TmpRlshpMgtCommentLine@1100529600 : TEMPORARY Record 5061;

    LOCAL PROCEDURE Caption@1() : Text[260];
    VAR
      CaptionStr@1000 : Text[260];
    BEGIN
      IF Cont.GET(GETFILTER("Contact Company No.")) THEN
        CaptionStr := COPYSTR(Cont."No." + ' ' + Cont.Name,1,MAXSTRLEN(CaptionStr));
      IF Cont.GET(GETFILTER("Contact No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Cont."No." + ' ' + Cont.Name,1,MAXSTRLEN(CaptionStr));
      IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + SalesPurchPerson.Code + ' ' + SalesPurchPerson.Name,1,MAXSTRLEN(CaptionStr));
      IF Team.GET(GETFILTER("Team Code")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Team.Code + ' ' + Team.Name,1,MAXSTRLEN(CaptionStr));
      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Campaign."No." + ' ' + Campaign.Description,1,MAXSTRLEN(CaptionStr));
      IF Opp.GET(GETFILTER("Opportunity No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Opp."No." + ' ' + Opp.Description,1,MAXSTRLEN(CaptionStr));
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + SegHeader."No." + ' ' + SegHeader.Description,1,MAXSTRLEN(CaptionStr));
      IF CaptionStr = '' THEN
        CaptionStr := Text001;

      EXIT(CaptionStr);
    END;

    LOCAL PROCEDURE EnableFields@21();
    BEGIN
      RecurringDateIntervalEnable := Recurring;
      CalcDueDateFromEnable := Recurring;

      IF NOT Recurring THEN BEGIN
        EVALUATE("Recurring Date Interval",'');
        CLEAR("Calc. Due Date From");
      END;

      IsMeeting := Type = Type::Meeting;

      IF IsMeeting THEN BEGIN
        StartTimeEnable := NOT "All Day Event";
        EndingTimeEnable := NOT "All Day Event";
        DurationEnable := NOT "All Day Event";
        LocationEnable := TRUE;
        AllDayEventEnable := TRUE;
        LanguageCodeEnable := "Interaction Template Code" <> '';
        AttachmentEnable := "Interaction Template Code" <> '';
      END ELSE BEGIN
        // StartTimeEnable := FALSE; //**4PS.o
        StartTimeEnable := TRUE; //**4PS.n
        EndingTimeEnable := FALSE;
        LocationEnable := FALSE;
        DurationEnable := FALSE;
        AllDayEventEnable := FALSE;
      END;

      ContactNoEditable := NOT IsMeeting; //**4PS.n
    END;

    LOCAL PROCEDURE ValidateTypeField@3();
    BEGIN
      IF Type <> xRec.Type THEN
        IF Type = Type::Meeting THEN BEGIN
          ClearDefaultAttendeeInfo;
          AssignDefaultAttendeeInfo;
          LoadTempAttachment;
          IF NOT "Team To-do" THEN
            IF "Salesperson Code" = '' THEN BEGIN
              IF Cont.GET("Contact No.") THEN
                VALIDATE("Salesperson Code",Cont."Salesperson Code")
              ELSE
                IF Cont.GET("Contact Company No.") THEN
                  VALIDATE("Salesperson Code",Cont."Salesperson Code");
              IF Campaign.GET(GETFILTER("Campaign No.")) THEN
                VALIDATE("Salesperson Code",Campaign."Salesperson Code");
              IF Opp.GET(GETFILTER("Opportunity No.")) THEN
                VALIDATE("Salesperson Code",Opp."Salesperson Code");
              IF SegHeader.GET(GETFILTER("Segment No.")) THEN
                VALIDATE("Salesperson Code",SegHeader."Salesperson Code");
              MODIFY;
            END;
          GetAttendee(AttendeeTemp);
          CurrPage.AttendeeSubform.PAGE.SetAttendee(AttendeeTemp);
          CurrPage.AttendeeSubform.PAGE.SetTaskFilter(SalespersonFilter,ContactFilter);
          CurrPage.AttendeeSubform.PAGE.UpdateForm;
        END ELSE BEGIN
          ClearDefaultAttendeeInfo;
          CurrPage.AttendeeSubform.PAGE.GetAttendee(AttendeeTemp);
          SetAttendee(AttendeeTemp);
          //SalespersonCodeEnable := FALSE; //**4PS.o
          WizardContactNameEnable := TRUE;
        END;
      IsMeeting := (Type = Type::Meeting);
      TypeOnAfterValidate;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE AllDayEventOnAfterValidate@19020274();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE RecurringOnAfterValidate@19068337();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE InteractionTemplateCodeOnAfter@19000597();
    BEGIN
      EnableFields
    END;

    LOCAL PROCEDURE WizardContactNameOnFormat@19031225(Text@19070643 : Text[1024]);
    BEGIN
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        Text := Text000;
    END;

    LOCAL PROCEDURE FinishPage@2();
    BEGIN
      CurrPage.AttendeeSubform.PAGE.GetAttendee(AttendeeTemp);
      SetAttendee(AttendeeTemp);

      CheckStatus;
      SetComments(TmpRlshpMgtCommentLine); //**4PS.n
      FinishWizard(FALSE);
    END;

    LOCAL PROCEDURE ShowTmpComment@1100529601();
    BEGIN
      //**4PS
      TmpRlshpMgtCommentLine.SETRANGE("Table Name", TmpRlshpMgtCommentLine."Table Name"::"To-do");
      TmpRlshpMgtCommentLine.SETRANGE("No.", '');
      TmpRlshpMgtCommentLine.SETRANGE("Sub No.", 0);
      TmpRlshpMgtCommentLine."Table Name" := TmpRlshpMgtCommentLine."Table Name"::"To-do";
      PAGE.RUNMODAL(PAGE::"Rlshp. Mgt. Comment Sheet", TmpRlshpMgtCommentLine);
    END;

    BEGIN
    {
      4PS, 06-02-2017, "Standard To-do Code" moved to just above Description
    }
    END.
  }
}

