OBJECT Page 50 Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.03,4PS14.00,NAVSE.DK.NO.FI,EXF,4PSSE;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Order;
               NOR=Bestilling;
               SVE=Inkîpsorder];
    SourceTable=Table38;
    PopulateAllFields=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Release,Posting,Prepare,Order,Request Approval,Print/Send,Navigate,Mail Documents;
                                NOR=Ny,Prosess,Rapport,Godkjenn,Frigi,Bokfõring,Klargjõr,Ordre,Be om godkjenning,Skriv ut / send,Naviger;
                                SVE=Ny,Process,Rapport,GodkÑnn,SlÑpp,Bokfîring,Fîrbered,Order,BegÑr godkÑnnande,Skriv ut/skicka,Navigera];
    OnInit=VAR
             PurchasesPayablesSetup@1000 : Record 312;
             ApplicationAreaMgmtFacade@1001 : Codeunit 9179;
             PurchSetup@1100528000 : Record 312;
           BEGIN
             JobQueueUsed := PurchasesPayablesSetup.JobQueueActive;
             SetExtDocNoMandatoryCondition;
             ShowShippingOptionsWithLocation := ApplicationAreaMgmtFacade.IsLocationEnabled OR ApplicationAreaMgmtFacade.IsAllDisabled;

             //**4PS.sn
             //Fields which are set with variable FieldsEditable
             //"ICM StatusEditable","ICM ProcedureEditable","Reference (ICM)Editable",ShipmentInstruct1Editable,ShipmentInstruct2Editable
             FieldsEditable := TRUE;
             GS1Editable := TRUE;

             ReleasedOrderFieldsEditable := TRUE;
             InductionNoteNoEditable := TRUE;
             PaymentAgreementEditable := TRUE;

             NewDocumentReportingVisible := FALSE;
             StandardShippingOptionsVisible := FALSE;

             PurchSetup.GET;
             LinkItemDocsToPurchHeadEnabled := PurchSetup."Allow Link Item Docs to Purch.";
             //**4PS.en
           END;

    OnOpenPage=VAR
                 PermissionManager@1000 : Codeunit 9002;
                 EXApprovalSetup@1100285500 : Record 12013601;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 SetDocNoVisible;
                 IsSaaS := PermissionManager.SoftwareAsAService;

                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;
                 IF ("No." <> '') AND ("Buy-from Vendor No." = '') THEN
                   DocumentIsPosted := (NOT GET("Document Type","No."));

                 ActivateFields;
                 //4PSSE
                 GLSetup.GET;
                 DKinfoEnable := GLSetup."Danish Localization Active";
                 FIinfoEnable := GLSetup."Finnish localization active";
                 NORlocalizationEnable := GLSetup."Norwegian Localization Active";
                 ExFlowVisible := EXApprovalSetup.READPERMISSION;

                 //>>4PSSE
                 CustButtonsPageID := 50;
                 CustButtonsVisible1 := CustomSelectedbuttons.GET(CustButtonsPageID,1);
                 CustButtonsVisible2 := CustomSelectedbuttons.GET(CustButtonsPageID,2);
                 CustButtonsVisible3 := CustomSelectedbuttons.GET(CustButtonsPageID,3);
                 //<<4PSSE
               END;

    OnAfterGetRecord=VAR
                       Vendor@1100528300 : Record 23;
                       DummyAmount@1210190000 : Decimal;
                     BEGIN
                       CalculateCurrentShippingAndPayToOption;

                       //**4PS.sn
                       ReleasedOrderFieldsEditable := (Status <> Status::Released) AND (Status <> Status::Closed);
                       PaymentAgreementEditable := VendorIsSubcontractor AND ReleasedOrderFieldsEditable;
                       InductionNoteNoEditable := "Invoice Conduction Note" AND ReleasedOrderFieldsEditable;
                       GetReceivedInvoicedAmounts(
                         DummyAmount, DummyAmount,
                         AmountReceived, AmountInvoiced, DummyAmount, DummyAmount,
                         DummyAmount,
                         0,'',''); //call 26769

                       CALCFIELDS("ICM Login Code");
                       FieldsEditable := ("ICM Login Code"<>'');
                       GS1Editable := FieldsEditable;
                       IF (NOT FieldsEditable) THEN BEGIN
                         IF (Vendor.GET("Buy-from Vendor No.")) THEN BEGIN
                           GS1Editable := (Vendor."Electronic Order Type" = Vendor."Electronic Order Type"::"GS1 (SOAP)") OR
                                          (Vendor."Electronic Order Type" = Vendor."Electronic Order Type"::"GS1 (XML-RPC)");
                         END;
                       END;

                       IF gFromReference THEN BEGIN
                         gFromReference := FALSE;
                         CurrPage.PurchLines.PAGE.InitSelectionFromReference(gOrderLineNo);
                       END;

                       PurchaseHeaderExtension.GetPurchHeadExtension("Document Type", "No."); //kzwerver, 110929, n, #28914
                       //**4PS.en
                     END;

    OnNewRecord=BEGIN
                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetBuyFromVendorFromFilter;

                  CalculateCurrentShippingAndPayToOption;

                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  //"Responsibility Center" := UserMgt.GetPurchasesFilter; //**4PS.o
                  //**4PS.sn
                  "Responsibility Center" := UserMgt.GetPurchasesDefault;
                  AmountReceived := 0;
                  AmountInvoiced := 0;

                  ReleasedOrderFieldsEditable := TRUE;
                  //**4PS.en
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=VAR
                       InstructionMgt@1001 : Codeunit 1330;
                     BEGIN
                       IF ShowReleaseNotification THEN
                         IF NOT InstructionMgt.ShowConfirmUnreleased THEN
                           EXIT(FALSE);
                       IF NOT DocumentIsPosted THEN
                         EXIT(ConfirmCloseUnposted);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetControlAppearance;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.ApprovalFactBox.PAGE.UpdateApprovalEntriesFromSourceRecord(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           OnAfterGetCurrRec; //**4PS.n
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 61      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Bestilling;
                                 SVE=Ord&er];
                      Image=Order }
      { 129     ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera mÜtt, till exempel omrÜde, projekt eller avdelning, som du kan tilldela till fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#Suite;
                      Image=Statistics;
                      OnAction=BEGIN
                                 OpenPurchaseOrderStatistics;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 64      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverandõren i kjõpsdokumentet.;
                                 SVE=Visa eller redigera detaljerad information om leverantîren pÜ inkîpsdokumentet.];
                      ApplicationArea=#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Enabled="Buy-from Vendor No." <> '';
                      Image=Vendor;
                      PromotedCategory=Category11 }
      { 53      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Approvals;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 WorkflowsEntriesBuffer@1001 : Record 832;
                               BEGIN
                                 WorkflowsEntriesBuffer.RunWorkflowEntriesPage(RECORDID,DATABASE::"Purchase Header","Document Type","No.");
                               END;
                                }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category8 }
      { 107     ;2   ;Action    ;
                      Name=DocAttach;
                      CaptionML=[ENU=Attachments;
                                 NOR=Vedlegg;
                                 SVE=Bilagor];
                      ToolTipML=[ENU=Add a file as an attachment. You can attach images as well as documents.;
                                 NOR=Legg til en fil som vedlegg. Du kan legge ved bilderˇog dokumenter.;
                                 SVE=LÑgg till en fil som en bilaga. Du kan bifoga bilder och dokument.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Attach;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1001 : Page 1173;
                                 RecRef@1000 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 1210190006;2 ;Action    ;
                      CaptionML=[ENU=Blanket Scheme;
                                 SVE=Avropsschema];
                      Visible=FALSE;
                      Image=BlanketOrder;
                      OnAction=VAR
                                 PurchHead@1210190002 : Record 38;
                               BEGIN
                                 //**4PS (RTC.c)
                                 TESTFIELD("No.");
                                 TESTFIELD("Document Type", "Document Type"::Order);
                                 TESTFIELD("Purchase Order Type", "Purchase Order Type"::"Blanket Order");
                                 PurchHead.SETRANGE("No.", "No.");
                                 //Note: Filters on "Document Type" and "Purchase Order Type" not needed, because hard filters in Blanket Scheme
                                 PAGE.RUNMODAL(PAGE::"Blanket Scheme", PurchHead);
                               END;
                                }
      { 1100529600;2 ;Action    ;
                      Name=SCOrderVariations;
                      CaptionML=ENU=SC Order Variations;
                      Description=4PS DP01524;
                      RunObject=Page 11130286;
                      RunPageLink=Purchase Order Number=FIELD(No.);
                      Visible=FALSE;
                      Image=WarehouseRegisters }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter;
                                 SVE=Dokument];
                      Image=Documents }
      { 66      ;2   ;Action    ;
                      CaptionML=[ENU=Receipts;
                                 NOR=Mottak;
                                 SVE=Inleveranser];
                      ToolTipML=[ENU=View a list of posted purchase receipts for the order.;
                                 NOR=Vis en liste med bokfõrte kjõpsmottak for ordren.;
                                 SVE=Visa en lista med bokfîrda inkîpsinleveranser fîr ordern.];
                      ApplicationArea=#Suite;
                      RunObject=Page 145;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Promoted=Yes;
                      Image=PostedReceipts;
                      PromotedCategory=Category11 }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer;
                                 SVE=Fakturor];
                      ToolTipML=[ENU=View a list of ongoing purchase invoices for the order.;
                                 NOR=Vis en liste over pÜgÜende kjõpsfakturaer for ordren.;
                                 SVE=Visa en lista med pÜgÜende inkîpsfakturor fîr ordern.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=Invoice;
                      PromotedCategory=Category11;
                      OnAction=VAR
                                 lPurchReceiptLine@1210190002 : Record 121;
                                 lPurchInvLine@1210190001 : Record 123;
                                 lPurchInvHeader@1210190000 : Record 122;
                               BEGIN
                                 //**4PS
                                 lPurchReceiptLine.SETCURRENTKEY("Order No.");
                                 lPurchReceiptLine.SETRANGE("Order No.","No.");
                                 IF lPurchReceiptLine.FINDSET THEN
                                   REPEAT
                                     lPurchInvLine.SETCURRENTKEY("Receipt No.", "Receipt Line No.");
                                     lPurchInvLine.SETRANGE("Receipt No.",lPurchReceiptLine."Document No.");
                                     lPurchInvLine.SETRANGE("Receipt Line No.",lPurchReceiptLine."Line No.");
                                     IF lPurchInvLine.FINDSET THEN
                                       REPEAT
                                         IF lPurchInvHeader.GET(lPurchInvLine."Document No.") THEN
                                           lPurchInvHeader.MARK(TRUE);
                                       UNTIL lPurchInvLine.NEXT = 0;
                                   UNTIL lPurchReceiptLine.NEXT = 0;

                                 lPurchInvHeader.SETCURRENTKEY("Related Purch. Order No.");
                                 lPurchInvHeader.SETRANGE("Related Purch. Order No.", "No.");
                                 IF lPurchInvHeader.FINDSET THEN
                                   REPEAT
                                     lPurchInvHeader.MARK(TRUE);
                                   UNTIL lPurchInvHeader.NEXT = 0;
                                 lPurchInvHeader.SETRANGE("Related Purch. Order No.");
                                 lPurchInvHeader.SETCURRENTKEY("No.");

                                 lPurchInvHeader.MARKEDONLY(TRUE);

                                 PAGE.RUNMODAL(PAGE::"Posted Purchase Invoices",lPurchInvHeader);
                               END;
                                }
      { 1210190001;2 ;Action    ;
                      CaptionML=[ENU=Credit Memos;
                                 SVE=Kreditnotor];
                      Image=CreditMemo;
                      OnAction=VAR
                                 lPurchReceiptLine@1210190002 : Record 121;
                                 lPurchCredMemoLine@1210190001 : Record 125;
                                 lPurchCredMemoHeader@1210190000 : Record 124;
                               BEGIN
                                 //**4PS
                                 lPurchReceiptLine.SETCURRENTKEY("Order No.");
                                 lPurchReceiptLine.SETRANGE("Order No.","No.");
                                 IF lPurchReceiptLine.FINDSET THEN
                                   REPEAT
                                     lPurchCredMemoLine.SETCURRENTKEY("Receipt No.", "Receipt Line No.");
                                     lPurchCredMemoLine.SETRANGE("Receipt No.",lPurchReceiptLine."Document No.");
                                     lPurchCredMemoLine.SETRANGE("Receipt Line No.",lPurchReceiptLine."Line No.");
                                     IF lPurchCredMemoLine.FINDSET THEN
                                       REPEAT
                                         IF lPurchCredMemoHeader.GET(lPurchCredMemoLine."Document No.") THEN
                                           lPurchCredMemoHeader.MARK(TRUE);
                                       UNTIL lPurchCredMemoLine.NEXT = 0;
                                   UNTIL lPurchReceiptLine.NEXT = 0;

                                 //add credit headers (document copy of invoice). These do not have receipts.
                                 lPurchCredMemoHeader.SETCURRENTKEY("Related Purch. Order No.");
                                 lPurchCredMemoHeader.SETRANGE("Related Purch. Order No.", "No.");
                                 IF lPurchCredMemoHeader.FINDSET THEN
                                   REPEAT
                                     lPurchCredMemoHeader.MARK(TRUE);
                                   UNTIL lPurchCredMemoHeader.NEXT = 0;

                                 lPurchCredMemoHeader.SETCURRENTKEY("No."); //Always primary key when using MARKEDONLY
                                 lPurchCredMemoHeader.SETRANGE("Related Purch. Order No.");
                                 lPurchCredMemoHeader.MARKEDONLY(TRUE);

                                 PAGE.RUNMODAL(PAGE::"Posted Purchase Credit Memos",lPurchCredMemoHeader);
                               END;
                                }
      { 205     ;2   ;Action    ;
                      Name=PostedPrepaymentInvoices;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 NOR=F&orskuddsfakturaer;
                                 SVE=F&îrskottsfakturor];
                      ToolTipML=[ENU="View related posted sales invoices that involve a prepayment. ";
                                 NOR="Vis tilknyttede bokfõrte salgsfakturaer som omfatter en forskuddsbetaling. ";
                                 SVE="Visa relaterade bokfîrda fîrsÑljningsfakturor som berîr en fîrskottsbetalning. "];
                      ApplicationArea=#Prepayments;
                      Description=**4PS.o;
                      RunObject=Page 146;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Visible=FALSE;
                      Image=PrepaymentInvoice }
      { 206     ;2   ;Action    ;
                      Name=PostedPrepaymentCrMemos;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 NOR=Kredi&tnotaer for forskudd;
                                 SVE=Kredi&tnotor fîr fîrskottsbetalning];
                      ToolTipML=[ENU="View related posted sales credit memos that involve a prepayment. ";
                                 NOR="Vis tilknyttede bokfõrte salgskreditnotaer som omfatter en forskuddsbetaling. ";
                                 SVE="Visa relaterade bokfîrda fîrsÑljningskreditnotor som berîr en fîrskottsbetalning. "];
                      ApplicationArea=#Prepayments;
                      Description=**4PS.o;
                      RunObject=Page 147;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Visible=FALSE;
                      Image=PrepaymentCreditMemo }
      { 1100525010;2 ;Action    ;
                      CaptionML=[ENU=Inward Processing Relief;
                                 SVE=Aktivt fîrÑdlingstîd];
                      Visible=FALSE;
                      Image=SubcontractingWorksheet;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowInwardLines;
                               END;
                                }
      { 1210190027;2 ;Action    ;
                      CaptionML=[ENU=Warranty Data;
                                 SVE=Garantiinformation];
                      RunObject=Page 11124856;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Visible=FALSE;
                      Image=BeginningText }
      { 1100528409;2 ;Action    ;
                      CaptionML=ENU=Signhost Signers;
                      Visible=FALSE;
                      Image=Users;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowSignhostSigners;
                               END;
                                }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager;
                                 SVE=Distributionslager];
                      Image=Warehouse }
      { 180     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 NOR=&Lagerplass.-/-plukklinjer;
                                 SVE=La&gerinfîrsel/plock.rader];
                      ToolTipML=[ENU=View items that are inbound or outbound on inventory put-away or inventory pick documents for the transfer order.;
                                 NOR=Viser varer som er inngÜende eller utgÜende pÜ lagerplasserings- eller lagerplukkdokumenter for overfõringsordren.;
                                 SVE=Visa artiklar som Ñr ankommande eller avgÜende i lagerartikelinfîrsel- eller lagerplockningsdokument fîr îverfîringsordern.];
                      ApplicationArea=#Warehouse;
                      RunObject=Page 5774;
                      RunPageView=SORTING(Source Document,Source No.,Location Code);
                      RunPageLink=Source Document=CONST(Purchase Order),
                                  Source No.=FIELD(No.);
                      Visible=FALSE;
                      Image=PickLines }
      { 148     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Receipt Lines;
                                 NOR=Lagermottakslinjer;
                                 SVE=Dist.lager inleveransrader];
                      ToolTipML=[ENU=View ongoing warehouse receipts for the document, in advanced warehouse configurations.;
                                 NOR=Vis pÜgÜende lagermottak for dokumentet i avanserte lageroppsett.;
                                 SVE=Visa pÜgÜende distributionslagerinleveranser fîr dokumentet, i avancerad distributionslagerkonfiguration.];
                      ApplicationArea=#Warehouse;
                      RunObject=Page 7342;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunPageLink=Source Type=CONST(39),
                                  Source Subtype=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Visible=FALSE;
                      Image=ReceiptLines }
      { 12013597;2   ;Action    ;
                      Name=<Action1100285004>;
                      ShortCutKey=Ctrl+I;
                      CaptionML=[ENU=Show document;
                                 SVE=Visa dokument];
                      Visible=ExFlowVisible;
                      Image=Document;
                      OnAction=BEGIN
                                 // ExFlow
                                 ExFlow.ShowImageDocument("Document Type","No.");
                               END;
                                }
      { 12013598;2   ;Action    ;
                      Name=<Action1100285005>;
                      CaptionML=[ENU=Attached Fil&es;
                                 SVE=&Bilagor];
                      RunObject=Page 12013644;
                      RunPageView=SORTING(Document Type,Document No.,Attached);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Visible=ExFlowVisible;
                      Image=Documents }
      { 183     ;2   ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 NOR=Dire&kte levering;
                                 SVE=D&irektutleverans];
                      Image=Delivery }
      { 226     ;3   ;Action    ;
                      Name=Warehouse_GetSalesOrder;
                      CaptionML=[ENU=Get &Sales Order;
                                 NOR=Hent &ordre;
                                 SVE=HÑmta &fîrs.order];
                      ToolTipML=[ENU="Select the sales order that must be linked to the purchase order, for drop shipment or special order. ";
                                 NOR="Velg ordren som mÜ knyttes til bestillingen, for direktelevering eller spesialordre. ";
                                 SVE="VÑlj den fîrsÑljningsorder som mÜste lÑnkas till inkîpsordern, fîr direktutleverans eller specialorder. "];
                      ApplicationArea=#Suite;
                      RunObject=Codeunit 76;
                      Visible=FALSE;
                      Image=Order }
      { 227     ;2   ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 NOR=Spesi&albestilling;
                                 SVE=Special&order];
                      Image=SpecialOrder }
      { 228     ;3   ;Action    ;
                      AccessByPermission=TableData 110=R;
                      CaptionML=[ENU=Get &Sales Order;
                                 NOR=Hent &ordre;
                                 SVE=HÑmta &fîrs.order];
                      ToolTipML=[ENU="Select the sales order that must be linked to the purchase order, for drop shipment or special order. ";
                                 NOR="Velg ordren som mÜ knyttes til bestillingen, for direktelevering eller spesialordre. ";
                                 SVE="VÑlj den fîrsÑljningsorder som mÜste lÑnkas till inkîpsordern, fîr direktutleverans eller specialorder. "];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Image=Order;
                      OnAction=VAR
                                 PurchHeader@1000 : Record 38;
                                 DistIntegration@1001 : Codeunit 5702;
                               BEGIN
                                 PurchHeader.COPY(Rec);
                                 DistIntegration.GetSpecialOrders(PurchHeader);
                                 Rec := PurchHeader;
                               END;
                                }
      { 1210190034;1 ;Action    ;
                      CaptionML=[ENU=Document &Relations;
                                 SVE=Dokument&relationer];
                      RunObject=Page 11012413;
                      RunPageLink=Document Type=CONST(Purchase Order),
                                  No.=FIELD(No.);
                      Image=Relationship }
      { 1100528200;1 ;Action    ;
                      CaptionML=[ENU=Document Parts;
                                 SVE=Dokumentdelar];
                      RunObject=Page 11125849;
                      RunPageView=WHERE(Level=CONST(Purchase Order));
                      RunPageLink=Code=FIELD(No.);
                      Visible=FALSE;
                      Image=IndentChartOfAccounts }
      { 1100528402;1 ;Action    ;
                      CaptionML=[ENU=Doc&uments;
                                 SVE=Dok&ument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1100528701 : RecordRef;
                                 DocumentFilters@1100528702 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1100525023;1 ;Action    ;
                      CaptionML=[ENU=Phase List;
                                 SVE=Faslista];
                      RunObject=Page 11072630;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Visible=FALSE;
                      Image=List }
      { 1210190043;1 ;Action    ;
                      CaptionML=[ENU=Purchase Texts;
                                 SVE=Inkîpstexter];
                      RunObject=Page 11012126;
                      RunPageLink=Line Type=CONST(Purchase Order),
                                  No.=FIELD(No.);
                      Visible=FALSE;
                      Image=Text }
      { 1100409004;1 ;Action    ;
                      CaptionML=[ENU=Guarantee;
                                 SVE=Garanti];
                      RunObject=Page 11229267;
                      RunPageLink=Purchase Order=FIELD(No.);
                      Visible=FALSE;
                      Image=Splitlines }
      { 1100485903;1 ;ActionGroup;
                      CaptionML=[ENU=Complaint Management;
                                 SVE=Incidenthantering];
                      Visible=FALSE }
      { 1100485904;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create New Complaint;
                                 SVE=Skapa nytt klagomÜl];
                      Visible=FALSE;
                      Image=EditReminder;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 lvComplMgtCU.CreateNewComplaintOnDocument(lvComplDocRec."Document Type"::"O-P", "No.");
                               END;
                                }
      { 1100485905;2 ;Action    ;
                      CaptionML=[ENU=Open Complaints;
                                 SVE=ôppna klagomÜl];
                      Visible=FALSE;
                      Image=Reminder;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"O-P", "No.", TRUE);
                               END;
                                }
      { 1100485906;2 ;Action    ;
                      CaptionML=[ENU=Complaints;
                                 SVE=KlagomÜl];
                      Visible=FALSE;
                      Image=ReminderTerms;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"O-P", "No.", FALSE);
                               END;
                                }
      { 1210190030;2 ;Action    ;
                      CaptionML=[ENU=&Documents;
                                 SVE=&Dokument];
                      Visible=FALSE;
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1210190053;1 ;ActionGroup;
                      CaptionML=[ENU=GS1 Loggings;
                                 SVE=GS1-loggningar];
                      Visible=FALSE }
      { 1210190054;2 ;Action    ;
                      CaptionML=[ENU=GS1 Errors;
                                 SVE=GS1-fel];
                      Visible=FALSE;
                      Image=ErrorFALedgerEntries;
                      OnAction=BEGIN
                                 GS1ErrorLogDrillDown;
                               END;
                                }
      { 1210190055;2 ;Action    ;
                      CaptionML=[ENU=GS1 Changes;
                                 SVE=GS1-Ñndringar];
                      Visible=FALSE;
                      Image=LedgerEntries;
                      OnAction=BEGIN
                                 GS1PurchaseOrderLogDrillDown;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 37      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning;
                                 SVE=GodkÑnnande] }
      { 35      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn;
                                 SVE=GodkÑnn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.;
                                 SVE=GodkÑnn de begÑrda fîrÑndringarna.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                                 //**4PS.sn
                                 MARK(FALSE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      ToolTipML=[ENU=Reject the requested changes.;
                                 NOR=Avvis de forespurte endringene.;
                                 SVE=Avvisa de begÑrda Ñndringarna.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 31      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger;
                                 SVE=Delegera];
                      ToolTipML=[ENU=Delegate the requested changes to the substitute approver.;
                                 NOR=Deleger de forespurte endringene til den stedfortredende godkjenneren.;
                                 SVE=Delegera begÑrda Ñndringar till en ersÑttare.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader;
                                 SVE=Kommentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑpp];
                      Image=ReleaseDoc }
      { 137     ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=&Frigi;
                                 SVE=&SlÑpp];
                      ToolTipML=[ENU=Release the document to the next stage of processing. When a document is released, it will be included in all availability calculations from the expected receipt date of the items. You must reopen the document before you can make changes to it.;
                                 NOR=Frigi dokumentet til neste behandlingsfase. NÜr et dokument frigis, tas det med i alle tilgjengelighetsberegninger fra den forventede mottaksdatoen for varene. Du mÜ Üpne dokumentet pÜ nytt fõr du kan gjõre endringer i det.;
                                 SVE=SlÑpp dokumentet till nÑsta etapp i bearbetningen. NÑr ett dokument slÑpps, tas det med i alla dispositionsberÑkningar frÜn och med artiklarnas planerade inleveransdatum. Du mÜste îppna dokumentet igen innan du kan Ñndra i det.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 138     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=èpne pÜ &nytt;
                                 SVE=ôppna &igen];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed;
                                 NOR=èpne dokumentet pÜ nytt for Ü endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de mÜ Üpnes fõr de kan endres;
                                 SVE=ôppna dokumentet igen och Ñndra det efter att det har godkÑnts. GodkÑnda dokument har statusen SlÑppt och mÜste îppnas innan de kan Ñndras];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      Image=ReOpen;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 1100525026;2 ;Action    ;
                      Name=FinishPhase;
                      CaptionML=[ENU=Finish Manual Phase;
                                 SVE=Avsluta manuell fas];
                      Promoted=No;
                      Visible=FALSE;
                      Image=Confirm;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 FinishManualPhase;
                               END;
                                }
      { 1210190044;2 ;Action    ;
                      Name=Close;
                      CaptionML=[ENU=Close;
                                 SVE=Avsluta];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Close;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ReleasePurchDoc@1210190001 : Codeunit 415;
                               BEGIN
                                 //**4PS
                                 IF Status = Status::"Pending Approval" THEN
                                   ERROR(Text11012010);
                                 ReleasePurchDoc.Close(Rec);
                               END;
                                }
      { 68      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner;
                                 SVE=Fu&nktion];
                      Image=Action }
      { 12047964;2   ;Action    ;
                      CaptionML=[ENU=Get latest coding from vendor;
                                 SVE=HÑmta senaste konteringen fîr leverantîr];
                      Promoted=Yes;
                      Image=CopyWorksheet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // PEB0042
                                 gBaseMgt.GetLatestCodingFromVendor(Rec);
                                 // 0042
                               END;
                                }
      { 69      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 24=R;
                      CaptionML=[ENU=Calculate &Invoice Discount/Charge;
                                 NOR=Beregn &fakturarabatt;
                                 SVE=&BerÑkna fakturarabatt];
                      ToolTipML=[ENU=Calculate the discount that can be granted based on all lines in the purchase document.;
                                 NOR=Beregn rabatten som kan gis basert pÜ alle linjer i kjõpsdokumentet.;
                                 SVE=BerÑkna rabatten som kan beviljas baserat pÜ alla rader i inkîpsdokumentet.];
                      ApplicationArea=#Suite;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 179     ;2   ;Action    ;
                      Name=GetRecurringPurchaseLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Recurring Purchase Lines;
                                 NOR=Hent gjentakende bestillingslinjer;
                                 SVE=HÑmta Üterkommande inkîpsrader];
                      ToolTipML=[ENU=Insert purchase document lines that you have set up for the vendor as recurring. Recurring purchase lines could be for a monthly replenishment order or a fixed freight expense.;
                                 NOR=Sett inn kjõpsdokumentlinjer du har definert som gjentakende for leverandõren. Gjentakende kjõpslinjer kan brukes for en mÜnedlig etterfyllingsordre eller en fast fraktutgift.;
                                 SVE=Infoga inkîpsdokumentrader som du har skapat som Üterkommande fîr leverantîren. èterkommande inkîpsrader kan t.ex. vara fîr en mÜnatlig Üteranskaffningsorder eller en fast fraktkostnad.];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Image=VendorCode;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 1100485004;2 ;Action    ;
                      Name=RemovalContribution;
                      CaptionML=[ENU=Calculate Removal Contribution;
                                 SVE=BerÑkna borttagningsbidrag];
                      Image=Calculate;
                      OnAction=BEGIN
                                 //**4PS
                                 DetermineRemovalContribution;
                               END;
                                }
      { 70      ;2   ;Action    ;
                      Name=CopyDocument;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument;
                                 SVE=Kopiera dokument];
                      ToolTipML=[ENU=Copy document lines and header information from another purchase document to this document. You can copy a posted purchase invoice into a new purchase invoice to quickly create a similar document.;
                                 NOR=Kopier dokumentlinjer og hodeopplysninger fra et annet kjõpsdokument til dette dokumentet. Du kan kopiere en bokfõrt kjõpsfaktura til en ny kjõpsfaktura for Ü opprette et lignende dokument raskt.;
                                 SVE=Kopiera dokumentrader och huvudinformation frÜn andra inkîpsdokument till det hÑr dokumentet. Du kan kopiera en bokfîrd inkîpsfaktura till en ny inkîpsfaktura om du snabbt vill skapa ett liknande dokument.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 142     ;2   ;Action    ;
                      Name=MoveNegativeLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 NOR=Flytt negative linjer;
                                 SVE=Flytta negativa rader];
                      ToolTipML=[ENU=Prepare to create a replacement sales order in a sales return process.;
                                 NOR=Klargjõr for Ü opprette en erstatningsordre i salgsreturprosessen.;
                                 SVE=Fîrbered skapa en ersÑttningsfîrsÑljningsorder i en fîrsÑljningsreturprocess.];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 1100528000;2 ;Action    ;
                      CaptionML=ENU=Link Item Doucments to Order;
                      Visible=LinkItemDocsToPurchHeadEnabled;
                      Enabled=LinkItemDocsToPurchHeadEnabled;
                      Image=LinkWithExisting;
                      OnAction=VAR
                                 PurchLine@1100528000 : Record 39;
                               BEGIN
                                 //**4PS
                                 PurchLine.LinkItemDocumentsToPurchHead(Rec, PurchLine, FALSE);
                               END;
                                }
      { 1100285002;2 ;Separator  }
      { 1100285001;2 ;Action    ;
                      CaptionML=[ENU=In&ward Registration;
                                 SVE=&Ankomstregistrering];
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //NTR Start
                                 TESTFIELD("Buy-from Vendor No.");
                                 TESTFIELD("Pay-to Vendor No.");
                                 TESTFIELD("VAT Bus. Posting Group");
                                 TESTFIELD("Gen. Bus. Posting Group");
                                 IF ISSERVICETIER THEN BEGIN
                                   InwRegList.PurchHeaderKey("Document Type","No.");
                                   InwRegList.RUN;
                                 END ELSE BEGIN
                                   InwRegForm.PurchHeaderKey("Document Type","No.");
                                   InwRegForm.RUN;
                                 END;
                                 //NTR End
                               END;
                                }
      { 1100285000;2 ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Inward Reg. &Entries;
                                 SVE=Ankomstreg.&transaktioner];
                      RunObject=Page 11128010 }
      { 225     ;2   ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 NOR=Dire&kte levering;
                                 SVE=D&irektutleverans];
                      Image=Delivery }
      { 184     ;3   ;Action    ;
                      Name=Functions_GetSalesOrder;
                      CaptionML=[ENU=Get &Sales Order;
                                 NOR=Hent &ordre;
                                 SVE=HÑmta &fîrs.order];
                      ToolTipML=[ENU="Select the sales order that must be linked to the purchase order, for drop shipment or special order. ";
                                 NOR="Velg ordren som mÜ knyttes til bestillingen, for direktelevering eller spesialordre. ";
                                 SVE="VÑlj den fîrsÑljningsorder som mÜste lÑnkas till inkîpsordern, fîr direktutleverans eller specialorder. "];
                      ApplicationArea=#Suite;
                      RunObject=Codeunit 76;
                      Visible=FALSE;
                      Image=Order }
      { 186     ;2   ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 NOR=Spesi&albestilling;
                                 SVE=Special&order];
                      Image=SpecialOrder }
      { 187     ;3   ;Action    ;
                      AccessByPermission=TableData 110=R;
                      CaptionML=[ENU=Get &Sales Order;
                                 NOR=Hent &ordre;
                                 SVE=HÑmta &fîrs.order];
                      ToolTipML=[ENU="Select the sales order that must be linked to the purchase order, for drop shipment or special order. ";
                                 NOR="Velg ordren som mÜ knyttes til bestillingen, for direktelevering eller spesialordre. ";
                                 SVE="VÑlj den fîrsÑljningsorder som mÜste lÑnkas till inkîpsordern, fîr direktutleverans eller specialorder. "];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Image=Order;
                      OnAction=VAR
                                 PurchHeader@1000 : Record 38;
                                 DistIntegration@1001 : Codeunit 5702;
                               BEGIN
                                 PurchHeader.COPY(Rec);
                                 DistIntegration.GetSpecialOrders(PurchHeader);
                                 Rec := PurchHeader;
                               END;
                                }
      { 1000004 ;2   ;Separator  }
      { 1070000 ;2   ;Action    ;
                      CaptionML=[ENU=In&ward Registration;
                                 SVE=&Ankomstregistrering];
                      ToolTipML=[ENU="Enter information about a purchase invoice that you want to register early as a preliminary posting until you overwrite it later when you make the final posting of the purchase invoice. ";
                                 SVE="Ange information om en inkîpsfaktura som du vill registrera tidigt som en preliminÑr bokfîring, innan du skriver îver den senare nÑr du gîr den slutliga bokfîringen av inkîpsfakturan. "];
                      Promoted=Yes;
                      Image=InwardEntry;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // NTR Start
                                 TESTFIELD("Buy-from Vendor No.");
                                 TESTFIELD("Pay-to Vendor No.");
                                 TESTFIELD("VAT Bus. Posting Group");
                                 TESTFIELD("Gen. Bus. Posting Group");
                                 InwRegList.PurchHeaderKey("Document Type","No.");
                                 InwRegList.RUN;
                                 // NTR End
                               END;
                                }
      { 1070001 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Inward Reg. &Entries;
                                 SVE=Ankomstreg.&transaktioner];
                      ToolTipML=[ENU=View or edit inward registration entries for the purchase order.;
                                 SVE=Visa eller redigera ankomstregistreringstransaktioner fîr inkîpsordern.];
                      RunObject=Page 11128015;
                      RunPageView=SORTING(Source Type,Source No.);
                      RunPageLink=Source Type=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=InwardEntry }
      { 173     ;2   ;Action    ;
                      Name=Archive Document;
                      CaptionML=[ENU=Archi&ve Document;
                                 NOR=Arki&ver dokument;
                                 SVE=Arki&vera dokument];
                      ToolTipML=[ENU=Send the document to the archive, for example because it is too soon to delete it. Later, you delete or reprocess the archived document.;
                                 NOR=Send dokumentet til arkivet, for eksempel fordi det er for tidlige Ü slette det. Senere kan du slette eller behandle det arkiverte dokumentet pÜ nytt.;
                                 SVE=Skicka dokument till arkivet, om det till exempel Ñr fîr tidigt att ta bort det. Du kan ta bort eller bearbeta det arkiverade dokumentet vid ett senare tillfÑlle.];
                      ApplicationArea=#Suite;
                      Image=Archive;
                      OnAction=BEGIN
                                 ArchiveManagement.ArchivePurchDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 195     ;2   ;Action    ;
                      AccessByPermission=TableData 410=R;
                      CaptionML=[ENU=Send Intercompany Purchase Order;
                                 NOR=Send konsernintern bestilling;
                                 SVE=Skicka koncernintern inkîpsorder];
                      ToolTipML=[ENU=Send the purchase order to the intercompany outbox or directly to the intercompany partner if automatic transaction sending is enabled.;
                                 NOR=Send bestillingen til den konserninterne utboksen eller direkte til den konserninterne partneren hvis automatisk transaksjonssending er aktivert.;
                                 SVE=Skicka inkîpsordern till den koncerninterna utkorgen eller direkt till den koncerninterna partnern om automatisk transaktionssÑndning har aktiverats.];
                      ApplicationArea=#Intercompany;
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalsMgmt@1003 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   ICInOutboxMgt.SendPurchDoc(Rec,FALSE);
                               END;
                                }
      { 51      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument];
                      ActionContainerType=NewDocumentItems;
                      Visible=FALSE;
                      Image=Documents }
      { 47      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inngÜende dokument;
                                 SVE=Visa inkommande dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document, for example for auditing purposes;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for posten eller dokumentet, for eksempel for revisjonsformÜl;
                                 SVE=Visa alla poster med inkommande dokument och filbilagor som finns fîr transaktionen eller dokumentet];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 45      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inngÜende dokument;
                                 SVE=VÑlj inkommande dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppfõringen eller dokumentet.;
                                 SVE=VÑlj en inkommande dokumentpost och en filbilaga som du vill koppla till transaktionen eller dokumentet.];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 43      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inngÜende dokument fra fil;
                                 SVE=Skapa inkommande dokument frÜn fil];
                      ToolTipML=[ENU=Create an incoming document from a file that you select from the disk. The file will be attached to the incoming document record.;
                                 NOR=Opprett et innkommende dokument fra en fil du velger fra disken. Filen blir lagt ved i posten for det innkommende dokumentet.;
                                 SVE=Skapa ett inkommande dokument frÜn en fil som du vÑljer pÜ disken. Filen bifogas posten fîr det inkommande dokumentet.];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Enabled=("Incoming Document Entry No." = 0) AND ("No." <> '');
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPurchaseDocument(Rec);
                               END;
                                }
      { 41      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 NOR=Fjern inngÜende dokument;
                                 SVE=Ta bort inkommande dokument];
                      ToolTipML=[ENU=Remove any incoming document records and file attachments.;
                                 NOR=Fjern eventuelle innkommende dokumentposter og filvedlegg.;
                                 SVE=Ta bort inkommande dokumentposter och filbilagor.];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IF IncomingDocument.GET("Incoming Document Entry No.") THEN
                                   IncomingDocument.RemoveLinkToRelatedRecord;
                                 "Incoming Document Entry No." := 0;
                                 MODIFY(TRUE);
                               END;
                                }
      { 1100527450;2 ;Action    ;
                      Name=ChooseTradeName;
                      CaptionML=ENU=Choose Tradename;
                      Visible=FALSE;
                      Image=CompareContacts;
                      OnAction=BEGIN
                                 //**4PS
                                 ChooseTradeName;
                               END;
                                }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning;
                                 SVE=BegÑr godkÑnnande];
                      Visible=FALSE }
      { 57      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforespõrsel;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      ToolTipML=[ENU=Request approval of the document.;
                                 NOR=Be om godkjenning av dokumentet.;
                                 SVE=BegÑr godkÑnnande av dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Enabled=NOT OpenApprovalEntriesExist AND CanRequestApprovalForFlow;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 55      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforespõrsel;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforespõrselen.;
                                 SVE=Annullera godkÑnnandebegÑran.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Enabled=CanCancelApprovalForRecord OR CanCancelApprovalForFlow;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                                 WorkflowWebhookMgt@1000 : Codeunit 1543;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                                 WorkflowWebhookMgt.FindAndCancel(RECORDID);
                               END;
                                }
      { 86      ;2   ;ActionGroup;
                      CaptionML=[ENU=Flow;
                                 NOR=Flow;
                                 SVE=Flow];
                      Image=Flow }
      { 88      ;3   ;Action    ;
                      Name=CreateFlow;
                      CaptionML=[ENU=Create a Flow;
                                 NOR=Opprett en flyt;
                                 SVE=Skapa ett arbetsflîde];
                      ToolTipML=[ENU=Create a new Flow from a list of relevant Flow templates.;
                                 NOR=Opprett en ny flyt fra en liste over relevante flytmaler.;
                                 SVE=Skapa ett nytt arbetsflîde frÜn en lista med relevanta arbetsflîdesmallar.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsSaaS;
                      Image=Flow;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 FlowServiceManagement@1000 : Codeunit 6400;
                                 FlowTemplateSelector@1001 : Page 6400;
                               BEGIN
                                 // Opens page 6400 where the user can use filtered templates to create new flows.
                                 FlowTemplateSelector.SetSearchText(FlowServiceManagement.GetPurchasingTemplateFilter);
                                 FlowTemplateSelector.RUN;
                               END;
                                }
      { 92      ;3   ;Action    ;
                      Name=SeeFlows;
                      CaptionML=[ENU=See my Flows;
                                 NOR=Se mine flyter;
                                 SVE=Visa mina arbetsflîden];
                      ToolTipML=[ENU=View and configure Flows that you created.;
                                 NOR=Vis og konfigurer flyter som du har opprettet.;
                                 SVE=Visa och konfigurera arbetsflîden som du har skapat.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 6401;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Flow;
                      PromotedCategory=Category9 }
      { 17      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager;
                                 SVE=Distributionslager];
                      Image=Warehouse }
      { 149     ;2   ;Action    ;
                      AccessByPermission=TableData 7316=R;
                      CaptionML=[ENU=Create &Whse. Receipt;
                                 NOR=Opprett &lagermottak;
                                 SVE=Skapa &dist.lagerinleverans];
                      ToolTipML=[ENU=Create a warehouse receipt to start a receive and put-away process according to an advanced warehouse configuration.;
                                 NOR=Opprett et lagermottak for Ü starte en mottaks- og plasseringsprosess i henhold til et avansert lageroppsett.;
                                 SVE=Skapa en distributionslagerinleverans fîr att starta en inleverans- och artikelinfîrselprocess enligt en avancerad distributionslagerkonfiguration.];
                      ApplicationArea=#Warehouse;
                      Visible=FALSE;
                      Image=NewReceipt;
                      OnAction=VAR
                                 GetSourceDocInbound@1001 : Codeunit 5751;
                               BEGIN
                                 GetSourceDocInbound.CreateFromPurchOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 150     ;2   ;Action    ;
                      AccessByPermission=TableData 7340=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick;
                                 NOR=Opprett lagerplas&sering/-plukk;
                                 SVE=Skapa lagerinf&îrsel / plockning];
                      ToolTipML=[ENU=Create an inventory put-away or inventory pick to handle items on the document according to a basic warehouse configuration that does not require warehouse receipt or shipment documents.;
                                 NOR=Opprett en lagerplassering eller lagerplukk for Ü hÜndtere varer i dokumentet i henhold til et grunnleggende lageroppsett som ikke krever dokumenter for lagermottak eller -levering.;
                                 SVE=Skapa en lagerartikelinfîrsel eller lagerplockning fîr att hantera artiklar i dokumentet enligt en grundlÑggande distributionslagerkonfiguration som inte krÑver distributionslagerdokument fîr inleverans eller utleverans.];
                      ApplicationArea=#Warehouse;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 77      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okfõring;
                                 SVE=B&okfîring];
                      Image=Post }
      { 79      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okfõr;
                                 SVE=&Bokfîr];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullfõr dokumentet eller kladden ved Ü bokfõre belõpene og antallene til de relaterte kontiene i selskapstablÜene.;
                                 SVE=Slutfîr dokumentet eller journalen genom att bokfîra beloppen och kvantiteterna till de relaterade kontona i fîretagets redovisning.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post (Yes/No)");
                                 //**4PS.sn
                                 CurrPage.UPDATE(FALSE);
                                 COMMIT;
                                 CheckInwardLines("No.",TRUE);
                                 //**4PS.en
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=ForhÜndsvis bokfõring;
                                 SVE=Fîrhandsgranska bokfîring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet nÜr du bokfõrer dokumentet eller kladden.;
                                 SVE=Granska de olika typer av transaktioner som skapas nÑr du bokfîr dokumentet eller journalen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=ViewPostedOrder;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 ShowPreview;
                               END;
                                }
      { 80      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokfõr og &skriv ut;
                                 SVE=Bokfîr och skriv &ut];
                      ToolTipML=[ENU=Finalize and prepare to print the document or journal. The values and quantities are posted to the related accounts. A report request window where you can specify what to include on the print-out.;
                                 NOR=Fullfõr og klargjõr for Ü skrive ut dokumentet eller kladden. Verdiene og antallene blir bokfõrt til de relaterte kontiene. Det vises en rapportforespõrselsside der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Slutfîr och fîrbered utskrift av dokumentet eller journalen. VÑrdena och kvantiteterna bokfîrs pÜ de relaterade kontona. Ett fînster med en rapportbegÑran dÑr du kan ange vad som ska tas med pÜ utskriften.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post + Print");
                                 //**4PS.sn
                                 CurrPage.UPDATE(FALSE);
                                 COMMIT;
                                 CheckInwardLines("No.",TRUE);
                                 //**4PS.en
                               END;
                                }
      { 78      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport;
                                 SVE=Testrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil fõr du bokfõrer kladden eller dokumentet.;
                                 SVE=Visa en testrapport sÜ att du kan hitta och rÑtta till eventuella fel innan du bokfîr journalen eller dokumentet.];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 81      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 NOR=&Massebokfõr;
                                 SVE=Bokfîr b&atch-jobb];
                      ToolTipML=[ENU=Post several documents at once. A report request window opens where you can specify which documents to post.;
                                 NOR=Bokfõr flere dokumenter samtidig. Det vises et rapportforespõrselsvindu der du kan angi hvilke dokumenter som skal bokfõres.;
                                 SVE=Bokfîr flera dokument pÜ en gÜng. Ett rapportfînster îppnas dÑr du kan ange vilka dokument som ska bokfîras.];
                      ApplicationArea=#Suite;
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purchase Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.sn
                                 COMMIT;
                                 CheckInwardLines("No.", FALSE);
                                 //**4PS.en
                               END;
                                }
      { 1100409003;2 ;Action    ;
                      Name=PostSelected;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Selected Lines;
                                 SVE=Bokfîr valda rader];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=PostingEntries;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 PurchSetup@1100525000 : Record 312;
                                 PurchPostSelected@1100528600 : Codeunit 11229302;
                                 InstructionMgt@1100528602 : Codeunit 1330;
                                 ErrorMessage@1100528601 : Text;
                               BEGIN
                                 //**4PS //DP00556
                                 PurchSetup.GET; //C026873
                                 PurchSetup.TESTFIELD("Post with Job Queue",FALSE); //C026873
                                 "Markedonly Receipt Run" := CurrPage.PurchLines.PAGE.SetReceiveMarkedOnly;
                                 MODIFY;
                                 COMMIT;

                                 PurchPostSelected.SetPostingCodeunitID(CODEUNIT::"Purch.-Post (Yes/No)");
                                 IF NOT PurchPostSelected.RUN(Rec) THEN BEGIN
                                   ErrorMessage := GETLASTERRORTEXT;
                                   CLEARLASTERROR;
                                 END ELSE BEGIN
                                   IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
                                     ShowPostedConfirmationMessage;
                                 END;
                                 GET("Document Type", "No.");
                                 "Markedonly Receipt Run" := FALSE; //C026873
                                 MODIFY;
                                 CurrPage.PurchLines.PAGE.ReSetReceiveMarkedOnly;
                                 CurrPage.UPDATE(FALSE);
                                 COMMIT;

                                 IF ErrorMessage <> '' THEN
                                   ERROR(ErrorMessage);

                                 CheckInwardLines("No.",TRUE);
                               END;
                                }
      { 1100527900;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and E-mail;
                                 SVE=Bokfîr och E-posta];
                      Promoted=Yes;
                      Image=PostMail;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 //**4PS
                                 Post(CODEUNIT::"Purch.-Post + Email (Yes/No)");
                                 CurrPage.UPDATE(FALSE);
                                 COMMIT;
                                 CheckInwardLines("No.",TRUE);
                               END;
                                }
      { 1101285002;2 ;Action    ;
                      Name=button1;
                      CaptionML=[ENU=Programmable button 1;
                                 NOR=Programmerbar knapp 1;
                                 SVE=InstÑllningsbar knapp 1];
                      Visible=CustButtonsVisible1;
                      OnAction=VAR
                                 RecRef@1100525000 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,CustButtonsPageID,1);
                               END;
                                }
      { 1101285001;2 ;Action    ;
                      Name=button2;
                      CaptionML=[ENU=Programmable button 2;
                                 NOR=Programmerbar knapp 2;
                                 SVE=InstÑllningsbar knapp 2];
                      Visible=CustButtonsVisible2;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,CustButtonsPageID,2);
                               END;
                                }
      { 1101285000;2 ;Action    ;
                      Name=button3;
                      CaptionML=[ENU=Programmable button 3;
                                 NOR=Programmerbar knapp 3;
                                 SVE=InstÑllningsbar knapp 3];
                      Visible=CustButtonsVisible3;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                               BEGIN
                                 //4PSSE
                                 RecRef.GETTABLE(Rec);
                                 CustomSelectedbuttons.openTypeID(RecRef,CustButtonsPageID,3);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbkõ;
                                 SVE=Ta bort frÜn jobbkî];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektkõen.;
                                 SVE=Ta bort den schemalagda bearbetningen av den hÑr rapporten frÜn jobbkîn.];
                      ApplicationArea=#Suite;
                      Visible=JobQueueVisible;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 1210190049;2 ;Action    ;
                      CaptionML=[ENU=Send Order Electronically;
                                 SVE=Skicka order elektroniskt];
                      Promoted=Yes;
                      Image=ExportElectronicDocument;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 SendOrderElectronic(FALSE);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100525012;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send Order Electronically (with options);
                                 SVE=Skicka order elektroniskt (med alternativ)];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=ExportElectronicDocument;
                      PromotedCategory=Category10;
                      OnAction=BEGIN
                                 //**4PS.sn [jhoek]
                                 //**4PS.c //kzwerver, 110623, c, #RfC Electr. Purchase Order
                                 CurrPage.UPDATE(TRUE);
                                 SendOrderElectronic(TRUE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 1210190028;2 ;Action    ;
                      CaptionML=[ENU=&Reminders;
                                 SVE=&PÜminnelser];
                      RunObject=Page 11020225;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Visible=FALSE;
                      Image=Reminder }
      { 209     ;2   ;ActionGroup;
                      CaptionML=[ENU=Prepa&yment;
                                 NOR=&Forskudd;
                                 SVE=F&îrskottsbetalning];
                      Visible=FALSE;
                      Image=Prepayment }
      { 202     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Prepayment Test &Report;
                                 NOR=&Testrapport for forskudd;
                                 SVE=&Testrapport fîr fîrskottsbetalning];
                      ToolTipML=[ENU="Preview the prepayment transactions that will results from posting the sales document as invoiced. ";
                                 NOR="ForhÜndsvis forskuddstransaksjonene som er et resultat av bokfõring av salgsdokumentet som fakturert. ";
                                 SVE="Fîrhandsgranska fîrskottsbetalningstransaktionerna som resulterar frÜn att fîrsÑljningsdokumentet har bokfîrts som fakturerat. "];
                      ApplicationArea=#Prepayments;
                      Visible=FALSE;
                      Image=PrepaymentSimulation;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeaderPrepmt(Rec);
                               END;
                                }
      { 203     ;3   ;Action    ;
                      Name=PostPrepaymentInvoice;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Invoice;
                                 NOR=Bo&kfõr forskuddsfaktura;
                                 SVE=Bokfîr f&îrskottsfaktura];
                      ToolTipML=[ENU="Post the specified prepayment information. ";
                                 NOR="Bokfõr den angitte forskuddsinformasjonen. ";
                                 SVE="Bokfîr den angivna fîrskottsbetalningsinformationen. "];
                      ApplicationArea=#Prepayments;
                      Visible=FALSE;
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 ApprovalsMgmt@1002 : Codeunit 1535;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtInvoiceYN(Rec,FALSE);
                               END;
                                }
      { 210     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Invoic&e;
                                 NOR=Bokfõ&r og skriv ut forskuddsfaktura;
                                 SVE=Bokfîr och skriv ut faktura pÜ fîrskottsb&et.];
                      ToolTipML=[ENU="Post the specified prepayment information and print the related report. ";
                                 NOR="Bokfõre den angitte forskuddsinformasjon og skriv ut den tilknyttede rapporten. ";
                                 SVE="Bokfîr den angivna fîrskottsbetalningsinformationen och skriv ut den relaterade rapporten. "];
                      ApplicationArea=#Prepayments;
                      Visible=FALSE;
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 ApprovalsMgmt@1002 : Codeunit 1535;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtInvoiceYN(Rec,TRUE);
                               END;
                                }
      { 73      ;3   ;Action    ;
                      Name=PreviewPrepmtInvoicePosting;
                      CaptionML=[ENU=Preview Prepmt. Invoice Posting;
                                 NOR=ForhÜndsvisning for forskuddsbetaling av bokfõrt faktura;
                                 SVE=Fîrhandsgranska bokfîring av faktura fîr fîrskottsbetalning];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the prepayment invoice.;
                                 NOR=Se gjennom de ulike oppfõringstypene som blir opprettet nÜr du bokfõrer fakturaen for forhÜndsbetaling.;
                                 SVE=Granska de olika typer av transaktioner som skapas nÑr du bokfîr fîrskottsfakturan.];
                      ApplicationArea=#Prepayments;
                      Visible=FALSE;
                      Image=ViewPostedOrder;
                      OnAction=BEGIN
                                 ShowPrepmtInvoicePreview;
                               END;
                                }
      { 204     ;3   ;Action    ;
                      Name=PostPrepaymentCreditMemo;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Credit Memo;
                                 NOR=Bokfõr kredit&nota for forskudd;
                                 SVE=Bokfîr &kreditnota fîr fîrskottsbetalning];
                      ToolTipML=[ENU=Create and post a credit memo for the specified prepayment information.;
                                 NOR=Opprett og bokfõr en kreditnota for den angitte forskuddsinformasjonen.;
                                 SVE=Skapa och bokfîr en kreditnota fîr den angivna fîrskottsbetalningsinformationen.];
                      ApplicationArea=#Prepayments;
                      Visible=FALSE;
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 ApprovalsMgmt@1002 : Codeunit 1535;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtCrMemoYN(Rec,FALSE);
                               END;
                                }
      { 211     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Cr. Mem&o;
                                 NOR=Bokfõr og skriv &ut kreditnota for forskudd;
                                 SVE=B&okfîr och skriv ut kreditnota fîr fîrskottsbet.];
                      ToolTipML=[ENU=Create and post a credit memo for the specified prepayment information and print the related report.;
                                 NOR=Opprett og bokfõr en kreditnota for den angitte forskuddsinformasjonen, og skriv ut den tilknyttede rapporten.;
                                 SVE=Skapa och bokfîr en kreditnota fîr den angivna fîrskottsbetalningsinformationen och skriv ut den relaterade rapporten.];
                      ApplicationArea=#Prepayments;
                      Visible=FALSE;
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 ApprovalsMgmt@1002 : Codeunit 1535;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtCrMemoYN(Rec,TRUE);
                               END;
                                }
      { 118     ;3   ;Action    ;
                      Name=PreviewPrepmtCrMemoPosting;
                      CaptionML=[ENU=Preview Prepmt. Cr. Memo Posting;
                                 NOR=ForhÜndsvisning for forskuddsbetaling av bokfõrt kredittnotat;
                                 SVE=Fîrhandsgranska bokfîring av kreditnota fîr fîrskottsbetalning];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the prepayment credit memo.;
                                 NOR=Se gjennom de ulike oppfõringstypene som blir opprettet nÜr du bokfõrer kredittnotatet for forskuddsbetaling.;
                                 SVE=Granska de olika typer av transaktioner som skapas nÑr du bokfîr kreditnotan fîr fîrskottsbetalning.];
                      ApplicationArea=#Prepayments;
                      Visible=FALSE;
                      Image=ViewPostedOrder;
                      OnAction=BEGIN
                                 ShowPrepmtCrMemoPreview;
                               END;
                                }
      { 1100525003;2 ;ActionGroup;
                      CaptionML=[ENU=Additional;
                                 SVE=Ytterligare];
                      Image=Versions }
      { 1100485031;3 ;Action    ;
                      CaptionML=[ENU=Create Purchase Lines for Sub Projects;
                                 SVE=Skapa inkîpsrader for underprojekt];
                      Visible=FALSE;
                      Image=Purchase;
                      OnAction=BEGIN
                                 //**4PS
                                 DistrPurchLinesOverSubProjects(Rec);
                               END;
                                }
      { 1210190048;3 ;Action    ;
                      CaptionML=[ENU=Select Blanket Order;
                                 SVE=VÑlj avropsorder];
                      Visible=FALSE;
                      Image=BlanketOrder;
                      OnAction=BEGIN
                                 //**4PS
                                 SelectBlanketOrder;
                               END;
                                }
      { 1100528411;3 ;Action    ;
                      CaptionML=ENU=Update Signhost Data;
                      Visible=FALSE;
                      Image=Import;
                      OnAction=VAR
                                 UpdateSignhostData@1100528400 : Codeunit 11020230;
                               BEGIN
                                 //**4PS
                                 UpdateSignhostData.UpdateDataOfSignhostDocumentsOfRecID(RECORDID);
                               END;
                                }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=Print;
                                 NOR=Skriv ut;
                                 SVE=Skriv ut];
                      Image=Print }
      { 82      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Order;
                                 NOR=&Skriv ut;
                                 SVE=Skriv &ut];
                      ToolTipML=[ENU=Prepare to print the document. The report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargjõr for Ü skrive ut dokumentet. Det vises et rapportforespõrselsvindu for dokumentet der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Fîrbered utskrift av dokumentet. Dokumentets rapportfînster îppnas, och dÑr kan du ange vad du vill inkludera pÜ utskriften.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Print;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 PurchaseHeader@1000 : Record 38;
                               BEGIN
                                 // ExFlow ->
                                 IF Approve THEN
                                   BEGIN
                                     DocHead.RetrieveRecord(DocHead, "Document Type","No.");

                                     IF DocHead.Status < 2 THEN
                                       MESSAGE(EXF01);
                                   END;
                                 // <- ExFlow
                                 PurchaseHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(PurchaseHeader);
                                 PurchaseHeader.PrintRecords(TRUE);
                               END;
                                }
      { 22      ;2   ;Action    ;
                      Name=SendCustom;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send;
                                 NOR=Send;
                                 SVE=Skicka];
                      ToolTipML=[ENU=Prepare to send the document according to the vendor's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.;
                                 NOR=Klargjõr for Ü sende dokumentet i henhold til leverandõrens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til Üpnes slik at du kan bekrefte eller velge en sendingsprofil.;
                                 SVE=Fîrbered att skicka dokumentet enligt leverantîrens utskicksprofil, t.ex. som bilaga till ett e-postmeddelande. Fînstret Skicka dokument till îppnas fîrst sÜ att det gÜr att bekrÑfta eller vÑlja en utskicksprofil.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NewDocumentReportingVisible;
                      PromotedIsBig=Yes;
                      Image=SendToMultiple;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 PurchaseHeader@1000 : Record 38;
                               BEGIN
                                 PurchaseHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(PurchaseHeader);
                                 PurchaseHeader.SendRecords;
                               END;
                                }
      { 1101200031;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Edit Word Documents;
                                 SVE=Redigera Word-dokument];
                      Promoted=Yes;
                      Image=Word;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 Contact@1100528701 : Record 5050;
                                 DocumentTemplate@1100528702 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Vendor No.");
                                 IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN
                                   EditDocuments(
                                     "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Order"),
                                     Contact."No.", "Buy-from Contact Person No.", FALSE, '', TRUE);
                               END;
                                }
      { 1100485014;2 ;Action    ;
                      CaptionML=[ENU=Print Word Document;
                                 SVE=Skriv ut Word-dokument];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 Contact@1100528701 : Record 5050;
                                 DocumentTemplate@1100528702 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Vendor No.");
                                 IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN
                                   EditDocuments(
                                     "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Order"),
                                     Contact."No.", "Buy-from Contact Person No.", FALSE, '', FALSE);
                               END;
                                }
      { 1100409000;1 ;ActionGroup;
                      CaptionML=[ENU=Mail Documents;
                                 SVE=E-postdokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Email }
      { 1100485011;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=E-mail Documents;
                                 SVE=E-posta dokument];
                      Promoted=Yes;
                      Image=ExportElectronicDocument;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 EmailDoc@1100485001 : Codeunit 11012408;
                               BEGIN
                                 //DP00556 Call 30183
                                 IF "E-Mail Sent on" <> 0D THEN BEGIN
                                   IF NOT CONFIRM(Text11012009, TRUE, "E-Mail Sent on") THEN
                                     ERROR('');
                                 END;
                                 //DP00556 Call 30183

                                 EmailDoc.EmailDocuments(Rec); // **4PS.n
                               END;
                                }
      { 1100409002;2 ;Action    ;
                      CaptionML=[ENU=Mail Document to Buy-from Vendor;
                                 SVE=Inkîpsleverantîr];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 Contact@1100409000 : Record 5050;
                                 Vendor@1100409001 : Record 23;
                                 DocumentTemplate@1100409002 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Vendor No.");
                                 IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN BEGIN
                                   Vendor.GET("Buy-from Vendor No.");
                                   EditDocuments(
                                     "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Order"),
                                     Contact."No.", '', TRUE, Vendor."E-Mail", FALSE);
                                 END;
                               END;
                                }
      { 1100409001;2 ;Action    ;
                      CaptionML=[ENU=Mail Document to Buy-from Contact;
                                 SVE=Inkîpskontaktperson];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 Contact@1100409000 : Record 5050;
                                 DocumentTemplate@1100409001 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Contact No.");
                                 IF Contact.GET("Buy-from Contact No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Order"),
                                       Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail", FALSE)
                                   ELSE
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Order"),
                                       Contact."No.", '', TRUE, Contact."E-Mail", FALSE);
                                 END;
                               END;
                                }
      { 1100525000;1 ;ActionGroup;
                      Name=Plant;
                      CaptionML=[ENU=Plant;
                                 SVE=Maskin];
                      Visible=FALSE;
                      Image=Resource }
      { 1100525020;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Plant - Get Transport Ride Cost;
                      Visible=FALSE;
                      Image=Cost;
                      OnAction=VAR
                                 lvShippingAgentRec@1100525003 : Record 291;
                                 lvTransRideRec@1100525002 : Record 11020517;
                                 lvCreatePurchOrderTransRideRpt@1100525000 : Report 11020511;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 TESTFIELD("Buy-from Vendor No.");

                                 lvShippingAgentRec.SETRANGE("Vendor No.", "Buy-from Vendor No.");
                                 IF "Order Date" <> 0D THEN
                                   lvShippingAgentRec.SETFILTER("Transport Date Filter", '..%1', "Order Date");
                                 lvCreatePurchOrderTransRideRpt.SETTABLEVIEW(lvShippingAgentRec);
                                 lvCreatePurchOrderTransRideRpt.SETTABLEVIEW(lvTransRideRec);  //* Make filters of this dataitem empty
                                 lvCreatePurchOrderTransRideRpt.SetOnExistingPurchOrder("No.");
                                 lvCreatePurchOrderTransRideRpt.RUNMODAL;
                               END;
                                }
      { 1100485901;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Plant - Get Transport Order Cost;
                                 SVE=Maskin Õ hÑmta transportorderkostnad];
                      Visible=FALSE;
                      Image=Cost;
                      OnAction=VAR
                                 lvShippingAgentRec@1100485002 : Record 291;
                                 lvTransOrderRec@1100485004 : Record 11020505;
                                 lvPostedTransOrderRec@1100485003 : Record 11020507;
                                 lvCreatePurchOrderTransportRpt@1100485000 : Report 11020505;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 TESTFIELD("Buy-from Vendor No.");

                                 lvShippingAgentRec.SETRANGE("Vendor No.", "Buy-from Vendor No.");
                                 IF "Order Date" <> 0D THEN
                                   lvShippingAgentRec.SETFILTER("Transport Date Filter", '..%1', "Order Date");
                                 lvCreatePurchOrderTransportRpt.SETTABLEVIEW(lvShippingAgentRec);
                                 lvCreatePurchOrderTransportRpt.SETTABLEVIEW(lvTransOrderRec);       //* Make filters of this dataitem empty
                                 lvCreatePurchOrderTransportRpt.SETTABLEVIEW(lvPostedTransOrderRec); //* Make filters of this dataitem empty
                                 lvCreatePurchOrderTransportRpt.SetOnExistingPurchOrder("No.");
                                 lvCreatePurchOrderTransportRpt.RUNMODAL;
                               END;
                                }
      { 1100525035;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create &Unique Plant Numbers;
                      Visible=FALSE;
                      Image=CreateSerialNo;
                      OnAction=VAR
                                 CreatePlant@1100525000 : Codeunit 11012243;
                               BEGIN
                                 IF NOT CreatePlant.ConfirmCreate() THEN
                                   EXIT;
                                 CurrPage.PurchLines.PAGE.CreatePlantNumbersUnique();
                               END;
                                }
      { 1100525001;1 ;ActionGroup;
                      CaptionML=[ENU=E-commerce;
                                 SVE=E-handel];
                      Visible=FALSE;
                      Image=ExportElectronicDocument }
      { 1100525017;2 ;Action    ;
                      ShortCutKey=Ctrl+K;
                      CaptionML=[ENU=Create ICK Order Files;
                                 SVE=Skapa ICK-orderfiler];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Export;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 lPurchHeaderRec@1100525000 : Record 38;
                               BEGIN
                                 //**4PS
                                 IF "ICM Login Code" = '' THEN
                                   ERROR(Text11012006);

                                 lPurchHeaderRec.SETRANGE("No.","No.");
                                 lPurchHeaderRec.SETRANGE("Buy-from Vendor No.","Buy-from Vendor No.");
                                 lPurchHeaderRec.SETRANGE("ICM Status", "ICM Status"::Create);
                                 REPORT.RUNMODAL(REPORT::"Create ICK Files",TRUE,FALSE,lPurchHeaderRec);
                               END;
                                }
      { 1210190017;2 ;Action    ;
                      ShortCutKey=Ctrl+M;
                      CaptionML=[ENU=Create ICM Order Files;
                                 SVE=Skapa ICM-orderfiler];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Export;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 lPurchHeaderRec@1210190000 : Record 38;
                               BEGIN
                                 //**4PS
                                 IF "ICM Login Code" = '' THEN
                                   ERROR(Text11012006);

                                 lPurchHeaderRec.SETRANGE("No.","No.");
                                 lPurchHeaderRec.SETRANGE("Buy-from Vendor No.","Buy-from Vendor No.");
                                 lPurchHeaderRec.SETRANGE("ICM Status", "ICM Status"::Create);
                                 REPORT.RUNMODAL(REPORT::"Create ICM Files",TRUE,FALSE,lPurchHeaderRec);
                               END;
                                }
      { 1210190019;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=Import ICM Order Confirmations;
                                 SVE=Importera ICM-orderbekrÑftelser];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Import;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 lPurchHeaderRec@1210190000 : Record 38;
                               BEGIN
                                 //**4PS
                                 lPurchHeaderRec.SETRANGE("No.","No.");
                                 lPurchHeaderRec.SETRANGE("Buy-from Vendor No.","Buy-from Vendor No.");
                                 //lPurchHeaderRec.SETRANGE("ICM Order Confirm. Received",FALSE);  //db, 16-03-09: M13962
                                 REPORT.RUNMODAL(REPORT::"Import ICM Order Confirmations",TRUE,FALSE,lPurchHeaderRec);
                               END;
                                }
      { 1210190045;2 ;Action    ;
                      ShortCutKey=Ctrl+G;
                      CaptionML=[ENU=Print ICM Order Confirmations;
                                 SVE=Skriv ut ICM-orderbekrÑftelser];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Print;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 lPurchHeaderRec@1210190000 : Record 38;
                               BEGIN
                                 //**4PS
                                 lPurchHeaderRec.SETRANGE("No.","No.");
                                 lPurchHeaderRec.SETRANGE("Purchaser Code","Purchaser Code");
                                 REPORT.RUNMODAL(REPORT::"ICM Messages by Purchaser",TRUE,FALSE,lPurchHeaderRec);
                               END;
                                }
      { 1100528405;1 ;ActionGroup;
                      CaptionML=[ENU=&Order Confirmation;
                                 SVE=&OrderbekrÑftelse];
                      Image=Email }
      { 1100525009;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Email Confirmation;
                                 SVE=Skicka e-postbekrÑftelse];
                      Promoted=Yes;
                      Image=Email;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 PurchaseHeader@1100528400 : Record 38;
                               BEGIN
                                 //**4PS
                                 PurchaseHeader.COPY(Rec);
                                 PurchaseHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Purchase - E-Mail Order", TRUE, FALSE, PurchaseHeader);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                Lookup=No;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#Suite;
                SourceExpr="No.";
                Importance=Promoted;
                Visible=DocNoVisible;
                Editable=ReleasedOrderFieldsEditable;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1210190005;2;Field  ;
                SourceExpr="Purchase Order Type";
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             PurchaseOrderTypeOnAfterValida;
                           END;
                            }

    { 4   ;2   ;Field     ;
                CaptionML=[ENU=Vendor No.;
                           NOR=Leverandõrnr.;
                           SVE=Leverantîrsnr];
                ToolTipML=[ENU=Specifies the number of the vendor who delivers the products.;
                           NOR=Angir nummeret pÜ leverandõren som leverer produktene.;
                           SVE=Anger numret pÜ leverantîren som levererar produkterna.];
                ApplicationArea=#Suite;
                NotBlank=Yes;
                SourceExpr="Buy-from Vendor No.";
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             OnAfterValidateBuyFromVendorNo(Rec,xRec);
                             CurrPage.UPDATE;
                           END;

                OnLookup=BEGIN
                           //**4PS.sn
                           LookupVendor(xRec);
                           //**4PS.en
                         END;
                          }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Vendor Name;
                           NOR=Leverandõrnavn;
                           SVE=Leverantîrsnamn];
                ToolTipML=[ENU=Specifies the name of the vendor who delivers the products.;
                           NOR=Angir navnet pÜ leverandõren som leverer produktene.;
                           SVE=Anger namnet pÜ leverantîren som levererar produkterna.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Vendor Name";
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             OnAfterValidateBuyFromVendorNo(Rec,xRec);
                             CurrPage.UPDATE;
                           END;

                OnAssistEdit=BEGIN
                               //**4PS
                               EditDetailsBuyerAddress;
                             END;

                ShowMandatory=TRUE }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies additional posting information for the document. After you post the document, the description can add detail to vendor and customer ledger entries.;
                           NOR=Angir ekstra bokfõringsinformasjon for dokumentet. NÜr du bokfõrer dokumentet, kan beskrivelsen tilfõre detaljer til leverandõr- og kundeposter.;
                           SVE=Anger ytterligare bokfîringsinformation fîr dokumentet. NÑr du bokfîr dokumentet kan beskrivningen tillfîra detaljer i leverantîrs- och kundreskontratransaktioner.];
                ApplicationArea=#Suite;
                SourceExpr="Posting Description";
                Visible=FALSE }

    { 62  ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kjõp fra;
                           SVE=Kîp frÜn];
                GroupType=Group }

    { 89  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the vendor's buy-from address.;
                           NOR=Angir leverandõrens kjõp fra-adresse.;
                           SVE=Anger leverantîrens inkîpsadress.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                QuickEntry=FALSE }

    { 91  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies an additional part of the vendor's buy-from address.;
                           NOR=Angir en tilleggsdel for leverandõrens kjõp fra-adresse.;
                           SVE=Anger ett tillÑgg till leverantîrens inkîpsadress.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Visible=FALSE;
                QuickEntry=FALSE }

    { 93  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                QuickEntry=FALSE }

    { 122 ;3   ;Group     ;
                Visible=IsBuyFromCountyVisible;
                GroupType=Group }

    { 121 ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county of the address.;
                           NOR=Angir delstat, omrÜde eller fylke i adressen.;
                           SVE=Anger delstat, region eller lÑn i adressen.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from County";
                Importance=Additional;
                QuickEntry=FALSE }

    { 76  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                QuickEntry=FALSE }

    { 120 ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the address.;
                           NOR=Angir landet eller omrÜdet i adressen.;
                           SVE=Anger adressens land eller region.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Country/Region Code";
                Importance=Additional;
                OnValidate=BEGIN
                             IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 174 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of contact person of the vendor's buy-from.;
                           NOR=Angir nummeret pÜ kontaktpersonen for leverandõrens kjõp fra-adresse.;
                           SVE=Anger numret pÜ kontaktpersonen fîr inkîpsleverantîren.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about an order from this vendor.;
                           NOR=Angir navnet pÜ den personen som skal kontaktes hvis det oppstÜr spõrsmÜl til en ordre fra denne leverandõren.;
                           SVE=Anger namnet pÜ personen som kontaktas angÜende en order frÜn den hÑr leverantîren.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Contact";
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable;
                OnLookup=BEGIN
                           //**4PS.sn
                           IF ReleasedOrderFieldsEditable THEN
                             LookupContactPerson;
                           //**4PS.en
                         END;
                          }

    { 1100409008;2;Field  ;
                SourceExpr="E-Mail for Purch. Order";
                Editable=ReleasedOrderFieldsEditable }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's order number.;
                           NOR=Angir leverandõrens ordrenummer.;
                           SVE=Anger leverantîrens eget ordernummer.];
                ApplicationArea=#Suite;
                SourceExpr="Vendor Order No.";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1100527500;2;Field  ;
                SourceExpr="Subcontracting Invoice";
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable }

    { 9100;2   ;Field     ;
                SourceExpr="Invoice Conduction Note";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;  //**4PS.n
                           END;
                            }

    { 1101200000;2;Field  ;
                SourceExpr="Induction Note No.";
                Importance=Additional;
                Visible=FALSE;
                Editable=InductionNoteNoEditable;
                OnValidate=BEGIN
                             InductionNoteNoOnAfterValidate;
                           END;
                            }

    { 1210190014;2;Field  ;
                SourceExpr="Amounts only";
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             //**4PS
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1210190015;2;Field  ;
                SourceExpr="Job No.";
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             //**4PS
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100525005;2;Field  ;
                SourceExpr="Project Description";
                Importance=Additional }

    { 1100485032;2;Field  ;
                SourceExpr="Service Order No.";
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             //**4PS
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100525007;2;Field  ;
                SourceExpr="Service Order Description";
                Importance=Additional }

    { 1100528500;2;Field  ;
                CaptionML=[ENU=Service Warranty Code;
                           SVE=Servicegarantikod];
                SourceExpr=PurchaseHeaderExtension."Service Warranty Code";
                TableRelation="Service Warranty";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             //**4PS DP00121
                             PurchaseHeaderExtension.VALIDATE("Service Warranty Code");
                             PurchaseHeaderExtension.UpdatePurchHeadExtension("Document Type", "No.");
                             CurrPage.SAVERECORD;
                           END;
                            }

    { 1100528900;2;Field  ;
                SourceExpr="Purchase Requisition No.";
                Importance=Additional;
                Visible=FALSE }

    { 1100525029;2;Field  ;
                SourceExpr="Purchase Plan";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1100525031;2;Field  ;
                Lookup=Yes;
                SourceExpr=PhasePlanMgt.ShowPlanStatus(Rec);
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable;
                OnLookup=VAR
                           DocumentPhase@1100525001 : Record 11020418;
                         BEGIN
                           //**4PS
                           IF "Purchase Plan" = '' THEN
                             EXIT;

                           DocumentPhase.SETRANGE("Document Type", "Document Type");
                           DocumentPhase.SETRANGE("Document No.", "No.");
                           PAGE.RUNMODAL(PAGE::"Document Phase List", DocumentPhase);
                         END;
                          }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date of the record.;
                           NOR=Angir postens bokfõringsdato.;
                           SVE=Anger postens bokfîringsdatum.];
                ApplicationArea=#Suite;
                SourceExpr="Posting Date";
                Importance=Additional;
                OnValidate=BEGIN
                             SaveInvoiceDiscountAmount;
                           END;
                            }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the order was created.;
                           NOR=Angir datoen da ordren ble opprettet.;
                           SVE=Anger datumet nÑr ordern skapades.];
                ApplicationArea=#Suite;
                SourceExpr="Order Date";
                Editable=ReleasedOrderFieldsEditable }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the related document was created.;
                           NOR=Angir datoen da de relaterte dokumentet ble opprettet.;
                           SVE=Anger datumet nÑr det relaterade dokumentet skapades.];
                ApplicationArea=#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable }

    { 1100528502;2;Field  ;
                ApplicationArea=#Suite;
                SourceExpr="Closing Date";
                Importance=Additional;
                Visible=FALSE;
                Editable=Status<>Status::Closed }

    { 237 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quote number for the purchase order.;
                           NOR=Angir tilbudsnummeret for bestillingen.;
                           SVE=Anger offertnumret fîr inkîpsordern.];
                ApplicationArea=#Suite;
                SourceExpr="Quote No.";
                Importance=Additional;
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the original document you received from the vendor. You can require the document number for posting, or let it be optional. By default, it's required, so that this document references the original. Making document numbers optional removes a step from the posting process. For example, if you attach the original invoice as a PDF, you might not need to enter the document number. To specify whether document numbers are required, in the Purchases & Payables Setup window, select or clear the Ext. Doc. No. Mandatory field.;
                           NOR=Angir dokumentnummeret for det opprinnelige dokumentet du mottok fra leverandõren. Du kan kreve dokumentnummeret for bokfõring eller la det vëre valgfritt. Det er obligatorisk som standard, slik at dette dokumentet refererer til originalen. Hvis dokumentnumre gjõres valgfrie, fjernes et trinn fra bokfõringsprosessen. Hvis du for eksempel legger ved den opprinnelige fakturaen som en PDF-fil, kan det hende du ikke behõver Ü angi dokumentnummeret. Hvis du vil angi om dokumentnummeret er obligatorisk, gÜr du til vinduet for kjõpsoppsett, og merker av for eller fjerner merket for feltet Eksternt dokumentnr. obligatorisk.;
                           SVE=Anger dokumentnumret fîr det ursprungliga dokumentet som du har fÜtt frÜn leverantîren. Du kan krÑva dokumentnumret fîr bokfîring eller lÜta det vara frivilligt. Som standard krÑvs det i syfte att lÜta detta dokument referera till det ursprungliga. Vid valfria dokumentnummer fîrvinner ett steg frÜn bokfîringsprocessen. Om du till exempel bifogar den ursprungliga fakturan som en PDF kanske du inte behîver ange dokumentnumret. Fîr att ange om dokumentnummer krÑvs, vÑlj eller rensa fÑltet Externt dok.nr obligatoriskt i fînstret Inkîp & InkîpsinstÑllningar.];
                ApplicationArea=#Suite;
                SourceExpr="Vendor Invoice No.";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable;
                ShowMandatory=VendorInvoiceNoMandatory }

    { 96  ;2   ;Field     ;
                CaptionML=[ENU=Alternate Vendor Address Code;
                           NOR=Alternativ adressekode for leverandõr;
                           SVE=Kod fîr alternativ leverantîrsadress];
                ToolTipML=[ENU=Specifies the order address of the related vendor.;
                           NOR=Angir bestillingsadressen for den relaterte leverandõren.;
                           SVE=Anger den relaterade leverantîrens orderadress.];
                ApplicationArea=#Suite;
                SourceExpr="Order Address Code";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is assigned to the vendor.;
                           NOR=Angir hvilken innkjõper som er knyttet til leverandõren.;
                           SVE=Anger vilken inkîpare som Ñr kopplad till leverantîren.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1100525027;2;Field  ;
                DrillDown=No;
                SourceExpr="Name Purchaser";
                Importance=Additional;
                Visible=FALSE }

    { 1100529900;2;Field  ;
                SourceExpr="Resource Request No.";
                Importance=Additional;
                Visible=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry that handles the posting of purchase orders.;
                           NOR=Angir status for en jobbkõpost som hÜndterer bokfõring av bestillinger.;
                           SVE=Anger statusen fîr en jobbkîtransaktion som hanterar bokfîringen av inkîpsorder.];
                ApplicationArea=#All;
                SourceExpr="Job Queue Status";
                Importance=Additional;
                Visible=FALSE }

    { 1100528407;2;Field  ;
                CaptionML=[ENU=Approval by User;
                           SVE=GodkÑnnande av anvÑndare];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApprover(RECORDID,0);
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1100528504;2;Field  ;
                CaptionML=[ENU=Approval by User Name;
                           SVE=GodkÑnnande av anvÑndarnamn];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApproverName(RECORDID,0);
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 131 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the responsibility center, such as a distribution hub, that is associated with the involved user, company, customer, or vendor.;
                           NOR=Angir koden til ansvarssenteret, for eksempel en distribusjonshub, som er knyttet til den involverte brukeren, selskapet, kunden eller leverandõren.;
                           SVE=Anger koden fîr ansvarsenheten, till exempel ett distributionsnav, som associeras med anvÑndaren, fîretaget, kunden eller leverantîren i frÜga.];
                ApplicationArea=#Suite;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.;
                           SVE=Anger ID fîr anvÑndaren som ansvarar fîr dokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Assigned User ID";
                Importance=Additional;
                Visible=FALSE }

    { 133 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the record is open, waiting to be approved, invoiced for prepayment, or released to the next stage of processing.;
                           NOR=Angir om posten er Üpen, om den venter pÜ godkjenning, om den er fakturert for forskudd eller om den er frigitt til neste fase i behandlingen.;
                           SVE=Anger om posten Ñr îppen, vÑntar pÜ att godkÑnnas, har fakturerats fîr fîrskottsbetalning eller har slÑppts till nÑsta steg i behandlingen.];
                ApplicationArea=#Suite;
                SourceExpr=Status }

    { 12013587;2;Field    ;
                SourceExpr=Approve;
                Visible=ExFlowVisible }

    { 12013588;2;Field    ;
                SourceExpr="Requisition No.";
                Visible=ExFlowVisible }

    { 12013589;2;Field    ;
                CaptionML=[ENU=Approval Status;
                           SVE=GodkÑnnandestatus];
                SourceExpr=ExFlowStatusFromPO;
                Visible=ExFlowVisible;
                OnDrillDown=BEGIN
                              // ExFlow 190401->
                              ExFlowFormat;
                              // <- ExFlow 190401
                            END;
                             }

    { 1100485034;2;Field  ;
                CaptionML=[ENU=Amount Received;
                           SVE=Inlevererat belopp];
                BlankZero=Yes;
                SourceExpr=AmountReceived;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1210190041;2;Field  ;
                Name=AmountInvoiced;
                CaptionML=[ENU=Invoiced Amount;
                           SVE=Fakturerat belopp];
                BlankZero=Yes;
                SourceExpr=AmountInvoiced;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528408;2;Field  ;
                CaptionML=[ENU=Documents;
                           SVE=Dokument];
                SourceExpr=HasDocumentLinks;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100529401;2;Field  ;
                SourceExpr="Back-to-back";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 111280000;2;Field   ;
                SourceExpr="Document Sent By" }

    { 1000000000;2;Field  ;
                SourceExpr="Fast Order" }

    { 60  ;1   ;Part      ;
                Name=PurchLines;
                ApplicationArea=#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page54;
                Enabled="Buy-from Vendor No." <> '';
                Editable="Buy-from Vendor No." <> '';
                PartType=Page;
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer;
                           SVE=Fakturadetaljer];
                Visible=FALSE;
                GroupType=Group }

    { 119 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency of amounts on the purchase document.;
                           NOR=Angir valutaen til belõpene pÜ kjõpsdokumentet.;
                           SVE=Anger valutan fîr beloppen pÜ inkîpsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               //**4PS.sn
                               ChangeExchangeRate.SetAdditionalParameters(1, "Job No.", FALSE);
                               ChangeExchangeRate.EDITABLE(ReleasedOrderFieldsEditable);
                               //**4PS.en
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 SaveInvoiceDiscountAmount;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1000003;2;Field     ;
                ToolTipML=[ENU=Select this field if the purchase order is involved in an EU 3-party trade.;
                           SVE=Markera det hÑr fÑltet om inkîpsordern ingÜr i en EU trepartshandel.];
                SourceExpr="EU 3-Party Trade" }

    { 191 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT specification of the involved customer or vendor to link transactions made for this record with the appropriate general ledger account according to the VAT posting setup.;
                           NOR=Angir mva-spesifikasjonen for den involverte kunden eller leverandõren for Ü koble transaksjoner som ble utfõrt for denne posten, med riktig finanskonto i henhold til det generelle mva-bokfõringsoppsettet.;
                           SVE=Anger momsspecifikationen fîr den berîrda kunden eller leverantîren i syfte att koppla transaktioner som skapas fîr posten till det lÑmpliga redovisningskontot enligt momsbokfîringsinstÑllningen.];
                ApplicationArea=#Suite;
                SourceExpr="VAT Bus. Posting Group";
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable }

    { 1101200001;2;Field  ;
                SourceExpr="Your Reference" }

    { 1100528400;2;Field  ;
                SourceExpr="Consented Date-Time";
                Visible=FALSE }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable;
                LookupPageID=Cost Object List;
                OnValidate=BEGIN
                             //**4PS02.sn
                             //The test below is the same as the test in the OnValidate of PurchaseOrderLine.No.
                             IF ("Document Type" <> "Document Type"::Quote) THEN
                               TESTFIELD("Buy-from Vendor No.")
                             ELSE BEGIN
                               IF ("Buy-from Vendor No." = '') AND ("Buy-from Contact No." = '') THEN
                                 TESTFIELD("Buy-from Vendor No.");
                             END;
                             //**4PS02.en
                               ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbelõpet.;
                           SVE=Anger en formel som berÑknar betalningsfîrfallodatumet, kassarabattsdatumet och kassarabattens belopp.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Terms Code";
                Editable=ReleasedOrderFieldsEditable }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis betaling utfõres innen datoen i feltet Kont.rabattdato.;
                           SVE=Anger den procentuella kassarabatten som anvÑnds om betalningen gîrs senast det datum som anges i fÑltet Kassarabattsdatum.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Discount %";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                           NOR=Angir datoen da belõpet i posten mÜ vëre betalt for at det kan oppnÜs kontantrabatt.;
                           SVE=Anger datumet dÜ transaktionens belopp mÜste vara betalt fîr att orderns kassarabatt ska gÑlla.];
                ApplicationArea=#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 117 ;2   ;Field     ;
                ToolTipML=[NOR=Angir hvordan du utfõrer en betaling, for eksempel med bankoverfõring, kontanter eller sjekk.;
                           SVE=Anger hur kunden betalar, t.ex. med bankîverfîring, kontanter eller check.];
                SourceExpr="Payment Method Code";
                Importance=Additional;
                Visible=DKinfoEnable }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment of the purchase invoice.;
                           NOR=Angir betalingen for kjõpsfakturaen.;
                           SVE=Anger betalningen av inkîpsfakturan.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Reference";
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor.;
                           NOR=Angir nummeret for leverandõren.;
                           SVE=Anger leverantîrens nummer.];
                ApplicationArea=#Suite;
                SourceExpr="Creditor No.";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1060000;2;Field     ;
                ToolTipML=[ENU=Specifies the vendor's giro account.;
                           SVE=Anger leverantîrens gironr.];
                SourceExpr="Giro Acc. No.";
                Visible=DKinfoEnable }

    { 106 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the related entry represents an unpaid invoice for which either a payment suggestion, a reminder, or a finance charge memo exists.;
                           NOR=Angir at den relaterte oppfõringen representerer en ubetalt faktura som det finnes et betalingsforslag, en purring eller en rentenota for.;
                           SVE=Anger att den relaterade transaktionen representerar en obetald faktura som det finns ett betalningsfîrslag, en betalningspÜminnelse eller en rÑntefaktura fîr.];
                ApplicationArea=#Suite;
                SourceExpr="On Hold";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 144 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the time it takes to make items part of available inventory, after the items have been posted as received.;
                           NOR=Angir hvor lang tid det tar Ü gjõre varene til en del av lageret, etter at varene er bokfõrt som mottatt.;
                           SVE=Anger hur lÜng tid det tar att fîra in artiklar i det disponibla lagret nÑr artiklarna har bokfîrts som inlevererade.];
                ApplicationArea=#Warehouse;
                SourceExpr="Inbound Whse. Handling Time";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 146 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a date formula for the amount of time it takes to replenish the item.;
                           NOR=Angir en datoformel for tiden det tar Ü etterfylle varen.;
                           SVE=Anger en datumformel fîr tiden det tar att fylla pÜ artikeln.];
                ApplicationArea=#Suite;
                SourceExpr="Lead Time Calculation";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling;
                           SVE=Leverans och betalning];
                GroupType=Group }

    { 1101200005;2;Field  ;
                SourceExpr="Ship-to Project" }

    { 1101200009;2;Field  ;
                SourceExpr=Deliver }

    { 1101200007;2;Field  ;
                SourceExpr="Ship-to Location";
                OnAssistEdit=BEGIN
                               OnAssistShipToLocation();  //**4PS.n
                             END;
                              }

    { 83  ;2   ;Group     ;
                CaptionML=SVE=Leverans;
                GroupType=Group }

    { 94  ;3   ;Group     ;
                GroupType=Group }

    { 90  ;4   ;Field     ;
                Name=ShippingOptionWithLocation;
                CaptionML=[ENU=Ship-to;
                           NOR=Forsendelsesadresse;
                           SVE=Leverans];
                ToolTipML=[ENU=Specifies the address that the products on the purchase document are shipped to. Default (Company Address): The same as the company address specified in the Company Information window. Location: One of the company's location addresses. Customer Address: Used in connection with drop shipment. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Angir adressen som produktene i kjõpsdokumentet skal sendes til. Standard (selskapsadresse): Det samme som selskapsadressen angitt i vinduet Selskapsopplysninger. Lokasjon: En av selskapets adresser. Kundeadresse: Brukes i forbindelse med direktelevering. Tilpasset adresse: En forsendelsesadresse du angir i feltene nedenfor.;
                           SVE=Anger den adress som produkterna i inkîpsdokumentet levereras till. StandardvÑrde (fîretagsadress): Samma som den fîretagsadress som anges i fîretagets informationsfînster. Plats: En av fîretagets lagerstÑlleadresser. Kundadress: AnvÑnd i samband med direktutleverans. Anpassad adress: Valfri leveransadress som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Company Address),Location,Customer Address,Custom Address;
                                 NOR=Standard (selskapsadresse),Lokasjon,Kundeadresse,Egendefinert adresse;
                                 SVE=Standard (fîretagets adress),Plats,Kundadress,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                Visible=StandardShippingOptionsVisible;
                HideValue=NOT ShowShippingOptionsWithLocation AND (ShipToOptions = ShipToOptions::Location);
                OnValidate=BEGIN
                             ValidateShippingOption;
                           END;
                            }

    { 84  ;4   ;Field     ;
                Name=ShippingOptionWithoutLocation;
                CaptionML=[ENU=Ship-to;
                           NOR=Forsendelsesadresse;
                           SVE=Leverans];
                ToolTipML=[ENU=Specifies the address that the products on the purchase document are shipped to. Default (Company Address): The same as the company address specified in the Company Information window. Customer Address: Used in connection with drop shipment. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Angir adressen som produktene i kjõpsdokumentet skal sendes til. Standard (selskapsadresse): Det samme som selskapsadressen angitt i Selskapsopplysninger-vinduet. Kundeadresse. Brukes i forbindelse med direktelevering. Tilpasset adresse: En forsendelsesadresse du angir i feltene under.;
                           SVE=Anger den adress som produkterna i inkîpsdokumentet levereras till. StandardvÑrde (fîretagsadress): Samma som den fîretagsadress som anges i fîretagets informationsfînster. Kundadress: AnvÑnd i samband med direktutleverans. Anpassad adress: Valfri leveransadress som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Company Address),Customer Address,Custom Address;
                                 NOR=Standard (selskapsadresse),Kundeadresse,Egendefinert adresse;
                                 SVE=Standard (fîretagets adress),Kundadress,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                Visible=StandardShippingOptionsVisible;
                HideValue=ShowShippingOptionsWithLocation AND (ShipToOptions = ShipToOptions::Location);
                OnValidate=BEGIN
                             ValidateShippingOption
                           END;
                            }

    { 99  ;4   ;Group     ;
                GroupType=Group }

    { 98  ;5   ;Group     ;
                Visible=StandardShippingOptionsVisible;
                GroupType=Group }

    { 104 ;6   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the location where you want the items to be placed when they are received.;
                           NOR=Angir en kode for lokasjonen der du vil at de bestilte varene skal plasseres.;
                           SVE=Anger en kod fîr lagerstÑllet dÑr du vill att artiklarna placeras nÑr de har levererats.];
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Importance=Promoted;
                Visible=StandardShippingOptionsVisible }

    { 101 ;5   ;Group     ;
                Visible=(Deliver  = Deliver::"Customer Address") OR (Deliver = Deliver::"Customer Ship-to Address");
                GroupType=Group }

    { 85  ;6   ;Field     ;
                ToolTipML=[ENU=Specifies the code for another delivery address than the vendor's own address, which is entered by default.;
                           NOR=Angir koden for en annen leveringsadresse enn leverandõrens egen adresse, som er angitt som standard.;
                           SVE=Anger koden fîr en annan leveransadress Ñn kundens egna adress, som anges som standard.];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to Code";
                Editable=("Sell-to Customer No." <> '') }

    { 42  ;5   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the company at the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir navnet pÜ selskapet med adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger namnet pÜ det fîretag som finns pÜ den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=Deliver = Deliver::"Custom Address" }

    { 1210190039;5;Field  ;
                CaptionML=[ENU=Name 2;
                           SVE=Namn 2];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name 2";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address" }

    { 44  ;5   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir adressen du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 46  ;5   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 48  ;5   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 124 ;5   ;Group     ;
                Visible=IsShipToCountyVisible;
                GroupType=Group }

    { 112 ;6   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county of the address.;
                           NOR=Angir delstat, omrÜde eller fylke i adressen.;
                           SVE=Anger delstat, region eller lÑn i adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 109 ;5   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code of the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir postnummeret til selskapet med adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger postnumret fîr den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 105 ;5   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country/region code of the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir land/omrÜde i adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger regionkod fîr den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Editable=Deliver = Deliver::"Custom Address";
                OnValidate=BEGIN
                             IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 50  ;5   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person for the address of the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir navnet pÜ en kontaktperson i adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger namnet pÜ en kontaktperson knuten till den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact" }

    { 127 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that you want the vendor to deliver to the ship-to address.;
                           NOR=Angir datoen da du vil at leverandõren skal levere til leveringsadressen.;
                           SVE=Anger det datum som du vill att leverantîren ska leverera till leveransadressen.];
                ApplicationArea=#Suite;
                SourceExpr="Requested Receipt Date";
                Importance=Additional }

    { 139 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the vendor has promised to deliver the order.;
                           NOR=Angir pÜ hvilken dato leverandõren har lovet Ü levere ordren.;
                           SVE=Anger det datum som leverantîren har lovat att leverera ordern.];
                ApplicationArea=#OrderPromising;
                SourceExpr="Promised Receipt Date";
                Importance=Additional }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU="Specifies the date you expect the items to be available in your warehouse. If you leave the field blank, it will be calculated as follows: Planned Receipt Date + Safety Lead Time + Inbound Warehouse Handling Time = Expected Receipt Date.";
                           NOR="Angir datoen da du forventer at varene skal vëre tilgjengelige pÜ lager. Hvis du lar dette feltet vëre tomt, blir det beregnet pÜ fõlgende mÜte: Planlagt mottaksdato + Sikkerhetsleveringstid + InngÜende lagerhÜndteringstid = Forventet mottaksdato.";
                           SVE="Anger det datum dÜ du vÑntar dig att artiklarna ska vara tillgÑngliga i distributionslagret. Om du inte anger nÜgot berÑknas det sÜ hÑr: Planerat inleveransdatum + SÑkerhetsledtid + Ankommande distributionslagerhanteringstid = FîrvÑntat inleveransdatum."];
                ApplicationArea=#Suite;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted }

    { 1210190003;2;Field  ;
                SourceExpr=Expediter;
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable }

    { 1100528300;2;Field  ;
                CaptionML=[ENU=Delivery Time;
                           SVE=Leveranstid];
                SourceExpr=PurchaseHeaderExtension."Delivery Time";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             PurchaseHeaderExtensionDeliver;
                           END;
                            }

    { 1100529602;2;Field  ;
                CaptionML=[ENU=Delivery End Time;
                           SVE=Leveranstid, slut];
                SourceExpr=PurchaseHeaderExtension."Delivery End Time";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             PurchaseHeaderExtensionDeliver;
                           END;
                            }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the delivery conditions of the related shipment, such as free on board (FOB).;
                           NOR=Angir leveringsbetingelsene for den tilknyttede leveringen, for eksempel Fritt ombord (FOB).;
                           SVE=Anger leveransvillkoren fîr den relaterade utleveransen, till exempel fritt ombord.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable }

    { 1100529400;2;Field  ;
                CaptionML=[ENU=Destination;
                           SVE=Destination];
                SourceExpr=PurchaseHeaderExtension.Destination;
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             PurchaseHeaderExtensionDeliver;
                           END;
                            }

    { 1210190008;2;Field  ;
                SourceExpr="Extra Receipts Allowed";
                Importance=Additional }

    { 1100528501;2;Field  ;
                SourceExpr="Purchase Order Correction";
                Importance=Additional }

    { 1100525002;2;Field  ;
                SourceExpr="Vendor Authorization No.";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1100525004;2;Field  ;
                SourceExpr="Original Order No.";
                Importance=Additional;
                Visible=FALSE }

    { 1100525006;2;Field  ;
                SourceExpr="Shipping Agent Code";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1100525008;2;Field  ;
                SourceExpr="Package Tracking No.";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1100528406;2;Field  ;
                SourceExpr="Vendor Shipment No.";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1100525014;2;Field  ;
                CaptionML=[ENU=Shipping Instruction;
                           SVE=Leveransinstruktion];
                SourceExpr=PurchaseHeaderExtension."Shipping Instruction";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable;
                OnValidate=BEGIN
                             PurchaseHeaderExtensionDeliver;
                           END;
                            }

    { 71  ;2   ;Group     ;
                CaptionML=SVE=Betalas;
                Editable=ReleasedOrderFieldsEditable;
                GroupType=Group }

    { 103 ;3   ;Field     ;
                Name=PayToOptions;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til;
                           SVE=Betalas];
                ToolTipML=[ENU=Specifies the vendor that the purchase document will be paid to. Default (Vendor): The same as the vendor on the purchase document. Another Vendor: Any vendor that you specify in the fields below.;
                           NOR=Angir leverandõren som kjõpsdokumentet betales til. Standard (leverandõr): Det samme som leverandõren pÜ kjõpsdokumentet. En annen leverandõr: En leverandõr du angir i feltene nedenfor.;
                           SVE=Anger den leverantîr som inkîpsdokumentet utbetalas till. StandardvÑrde (Leverantîr): Samma som leverantîren pÜ inkîpsdokumentet. Annan leverantîr: Valfri leverantîr som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Vendor),Another Vendor,Custom Address;
                                 NOR=Standard (leverandõr),en annen leverandõr,kundeadresse;
                                 SVE=Standard (leverantîr),Annan leverantîr,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=PayToOptions;
                Importance=Additional;
                OnValidate=BEGIN
                             IF PayToOptions = PayToOptions::"Default (Vendor)" THEN
                               VALIDATE("Pay-to Vendor No.","Buy-from Vendor No.");
                           END;
                            }

    { 95  ;3   ;Group     ;
                Visible=NOT (PayToOptions = PayToOptions::"Default (Vendor)");
                GroupType=Group }

    { 24  ;4   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the vendor sending the invoice.;
                           NOR=Angir navnet pÜ leverandõren som sender fakturaen.;
                           SVE=Anger namnet pÜ leverantîren som skickar fakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Importance=Additional;
                Enabled=PayToOptions = PayToOptions::"Another Vendor";
                Editable=PayToOptions = PayToOptions::"Another Vendor" }

    { 26  ;4   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor sending the invoice.;
                           NOR=Angir adressen til leverandõren som sender fakturaen.;
                           SVE=Anger adressen fîr leverantîren som skickar fakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 28  ;4   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 30  ;4   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 123 ;4   ;Group     ;
                Visible=IsPayToCountyVisible;
                GroupType=Group }

    { 116 ;5   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county of the address.;
                           NOR=Angir delstat, omrÜde eller fylke i adressen.;
                           SVE=Anger delstat, region eller lÑn i adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to County";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 97  ;4   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 114 ;4   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country/region code of the vendor on the purchase document.;
                           NOR=Angir lands-/omrÜdekoden  for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens lands/regionkod i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Country/Region Code";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                OnValidate=BEGIN
                             IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 176 ;4   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of contact person of the vendor's buy-from.;
                           NOR=Angir nummeret pÜ kontaktpersonen for leverandõrens kjõp fra-adresse.;
                           SVE=Anger numret pÜ kontaktpersonen fîr inkîpsleverantîren.];
                ApplicationArea=#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.") }

    { 32  ;4   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about an order from this vendor.;
                           NOR=Angir navnet pÜ den personen som skal kontaktes hvis det oppstÜr spõrsmÜl til en ordre fra denne leverandõren.;
                           SVE=Anger namnet pÜ personen som kontaktas angÜende en order frÜn den hÑr leverantîren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.") }

    { 1080000;2;Field     ;
                ToolTipML=[ENU=Specifies the Kunde ID (KID) associated with purchase header.;
                           NOR=Angir kunde-ID-en (KID) som er knyttet til bestillingshodet.];
                SourceExpr=KID;
                Visible=NORlocalizationEnable }

    { 1090000;2;Field     ;
                ToolTipML=ENU=Specifies the message type for the purchase header.;
                SourceExpr="Message Type";
                Visible=FIinfoEnable;
                ShowMandatory=TRUE }

    { 1090002;2;Field     ;
                ToolTipML=ENU=Specifies an invoice message for the purchase header.;
                SourceExpr="Invoice Message";
                Importance=Promoted;
                Visible=FIinfoEnable;
                ShowMandatory=TRUE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel;
                           SVE=Utlandshandel];
                GroupType=Group }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a specification of the document's transaction, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir en spesifikasjon for dokumentets transaksjon ved rapportering til INTRASTAT.;
                           SVE=Anger en specifikation av fîrsÑljningsdokumentets transaktion fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr="Transaction Specification";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of transaction that the document represents, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transaksjonstypen som dokumentet representerer ved rapportering til INTRASTAT.;
                           SVE=Anger den transaktionstyp som dokumentet representerar fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Type";
                Importance=Additional;
                Editable=ReleasedOrderFieldsEditable }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transportmÜten ved rapportering til INTRASTAT.;
                           SVE=Anger transportsÑttet fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr="Transport Method";
                Importance=Additional;
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the port of entry where the items pass into your country/region, for reporting to Intrastat.;
                           NOR=Angir koden for innfõrselsstedet der varene kommer inn i landet/omrÜdet, for rapportering til Intrastat.;
                           SVE=Anger koden fîr inskeppningshamnen dÑr artiklarna kommer till ditt land/din region, fîr rapportering till Intrastat.];
                ApplicationArea=#Suite;
                SourceExpr="Entry Point";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 113 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area of the customer or vendor, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir omrÜdet for kunden eller leverandõren ved rapportering til INTRASTAT.;
                           SVE=Anger omrÜdet i kundens eller leverantîrens adress fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr=Area;
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies a two-digit code for the payment type.;
                           NOR=Angir en tosifret kode for betalingstypen.;
                           SVE=Ange tvÜsiffrig kod fîr betaltypen];
                SourceExpr="Payment Type Code Abroad";
                Visible=NORlocalizationEnable }

    { 1080004;2;Field     ;
                ToolTipML=[ENU=Specifies information for your local government bank. Contact your bank for additional information.;
                           NOR=Angir informasjon for sentralbanken i landet. Kontakt banken din for mer informasjon.];
                SourceExpr="Specification (Norges Bank)";
                Visible=NORlocalizationEnable }

    { 1100485010;2;Field  ;
                SourceExpr="Company VAT Registration No.";
                Visible=FALSE }

    { 1100485026;2;Field  ;
                SourceExpr="VAT Registration No.";
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1100485022;2;Field  ;
                SourceExpr="Country of Origin";
                Visible=FALSE }

    { 1100485024;2;Field  ;
                SourceExpr="Country of Destination";
                Visible=FALSE }

    { 1903104001;1;Group  ;
                CaptionML=[ENU=ICM;
                           SVE=ICM];
                GroupType=Group }

    { 1000000036;2;Field  ;
                SourceExpr="ICM Login Code";
                Visible=FALSE }

    { 1000000044;2;Field  ;
                SourceExpr="ICM Status";
                Visible=FALSE;
                Editable=FieldsEditable }

    { 1000000032;2;Field  ;
                SourceExpr="ICM Procedure";
                Visible=FALSE;
                Editable=FieldsEditable }

    { 1000000046;2;Field  ;
                SourceExpr="Reference (ICM)";
                Visible=FALSE;
                Editable=FieldsEditable }

    { 1100525018;2;Field  ;
                Name=PhoneICM;
                CaptionML=[ENU=Phone No. (ICM);
                           SVE=Telefonnr (ICM)];
                SourceExpr=[PhoneICM ];
                Visible=FALSE;
                OnValidate=BEGIN
                             PhoneICMOnAfterValidate;
                           END;
                            }

    { 1100525013;2;Field  ;
                Name=ShipmentInstruct1;
                CaptionML=[ENU=Shipment Instruction 1;
                           SVE=Utleveransinstruktion 1];
                SourceExpr=ShipmentInstruct1;
                Visible=FALSE;
                Editable=GS1Editable;
                OnValidate=BEGIN
                             ShipmentInstruct1OnAfterValida;
                           END;
                            }

    { 1100525015;2;Field  ;
                Name=ShipmentInstruct2;
                CaptionML=[ENU=Shipment Instruction 2;
                           SVE=Utleveransinstruktion 2];
                SourceExpr=ShipmentInstruct2;
                Visible=FALSE;
                Editable=GS1Editable;
                OnValidate=BEGIN
                             ShipmentInstruct2OnAfterValida;
                           END;
                            }

    { 1000000034;2;Field  ;
                SourceExpr="ICM File Created on";
                Visible=FALSE }

    { 1100525033;2;Field  ;
                SourceExpr="ICM File Sent";
                Visible=FALSE }

    { 1000000038;2;Field  ;
                SourceExpr="ICM Order Confirm. Received on";
                Visible=FALSE }

    { 1000000040;2;Field  ;
                SourceExpr="ICM Confirmations";
                Visible=FALSE }

    { 1100528901;2;Field  ;
                SourceExpr=GetIcbDetails(1);
                Importance=Additional;
                Visible=FALSE }

    { 1000000042;2;Field  ;
                SourceExpr="ICM Errors";
                Visible=FALSE }

    { 1100528902;2;Field  ;
                SourceExpr=GetIcbDetails(2);
                Importance=Additional;
                Visible=FALSE }

    { 1901254101;1;Group  ;
                CaptionML=[ENU=Status;
                           SVE=Status] }

    { 1000000048;2;Field  ;
                SourceExpr="Input by" }

    { 1000000050;2;Field  ;
                SourceExpr="Input Date" }

    { 171 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of archived versions for this document.;
                           NOR=Angir antall arkiverte versjoner for dette dokumentet.;
                           SVE=Anger antalet arkiverade versioner av det hÑr dokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="No. of Archived Versions";
                Importance=Additional;
                Visible=FALSE }

    { 1000000060;2;Field  ;
                SourceExpr="Document Confirmation Received" }

    { 1100409007;2;Field  ;
                SourceExpr="Electronic Order Type" }

    { 1100529002;2;Field  ;
                SourceExpr="FSC Type Code";
                Importance=Additional;
                Visible=FALSE;
                Editable=ReleasedOrderFieldsEditable }

    { 1000000052;2;Field  ;
                SourceExpr="Modified by" }

    { 1000000054;2;Field  ;
                SourceExpr="Last Date Modified" }

    { 1000000064;2;Field  ;
                SourceExpr="E-Mail Sent by";
                Editable=FALSE }

    { 1000000062;2;Field  ;
                SourceExpr="E-Mail Sent on";
                Editable=FALSE }

    { 1100528403;2;Field  ;
                CaptionML=[ENU=GS1 Sent by;
                           SVE=GS1 skickades av];
                SourceExpr=PurchaseHeaderExtension."GS1 Sent by";
                Visible=FALSE;
                Editable=FALSE }

    { 1100528401;2;Field  ;
                CaptionML=[ENU=GS1 Sent on;
                           SVE=GS1 skickades den];
                SourceExpr=PurchaseHeaderExtension."GS1 Sent on";
                Visible=FALSE;
                Editable=FALSE }

    { 1210190060;2;Field  ;
                CaptionML=[ENU=GS1 Error Logs;
                           SVE=GS1-felloggar];
                SourceExpr=CheckIfGS1ErrorLogsExist;
                Visible=FALSE;
                Editable=FALSE }

    { 1900776401;1;Group  ;
                CaptionML=[ENU=Contract;
                           SVE=Kontrakt (EBITA %)] }

    { 1000000066;2;Field  ;
                CaptionML=[ENU=Starting Date;
                           SVE=Startdatum];
                SourceExpr="Starting Date Subcontracting";
                Visible=FALSE }

    { 1000000068;2;Field  ;
                CaptionML=[ENU=Finishing Date;
                           SVE=FÑrdigdatum];
                SourceExpr="Finishing Date Subcontracting";
                Visible=FALSE }

    { 1000000070;2;Field  ;
                CaptionML=[ENU=Renewal Date;
                           SVE=Fîrnyelsedatum];
                SourceExpr="Renewal Date Subcontracting";
                Visible=FALSE }

    { 1100525036;2;Field  ;
                SourceExpr="Contract Applicable" }

    { 1100525038;2;Field  ;
                SourceExpr="Return Date Signed Contract" }

    { 1100525040;2;Field  ;
                CaptionML=[ENU=Letter of Credit Applicable;
                           SVE=Brev om tillÑmplig kredit];
                SourceExpr=LetterOfCreditIsApplicable;
                Visible=FALSE }

    { 1100409005;2;Field  ;
                SourceExpr="Letter of Credit Applied" }

    { 1100525042;2;Field  ;
                SourceExpr="Return Date Letter of Credit" }

    { 1210190018;2;Field  ;
                SourceExpr="Return Date Safety/Health-plan";
                Importance=Additional;
                Visible=FALSE }

    { 1100525044;2;Field  ;
                SourceExpr="Reminder Terms Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 108 ;1   ;Part      ;
                Name=Attached Documents;
                CaptionML=[ENU=Attachments;
                           NOR=Vedlegg;
                           SVE=Bilagor];
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(38),
                            No.=FIELD(No.),
                            Document Type=FIELD(Document Type);
                PagePartID=Page1174;
                Visible=FALSE;
                PartType=Page }

    { 23  ;1   ;Part      ;
                ApplicationArea=#Suite;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100529901;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190002;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page11130181;
                ProviderID=60;
                Visible=FALSE;
                PartType=Page }

    { 1903326807;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9090;
                ProviderID=60;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                Name=ApprovalFactBox;
                ApplicationArea=#Suite;
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                PartType=Page }

    { 1904651607;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9094;
                PartType=Page }

    { 39  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Suite;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1903435607;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                PartType=Page }

    { 1906949207;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                PartType=Page }

    { 3   ;1   ;Part      ;
                ApplicationArea=#Suite;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9100;
                ProviderID=60;
                PartType=Page }

    { 1100528201;1;Part   ;
                SubPageLink=Document Type=CONST(Order),
                            Document No.=FIELD(Document No.),
                            Document Line No.=FIELD(Line No.);
                PagePartID=Page11126651;
                ProviderID=60;
                PartType=Page }

    { 59  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#Suite;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1100528404;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page11126539;
                PartType=Page }

    { 1100527000;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(Document No.);
                PagePartID=Page11130283;
                ProviderID=60;
                PartType=Page }

    { 1100528415;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page11129727;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1006 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1005 : Codeunit 5700;
      ArchiveManagement@1007 : Codeunit 5063;
      PurchCalcDiscByType@1009 : Codeunit 66;
      FormatAddress@1028 : Codeunit 365;
      ChangeExchangeRate@1001 : Page 511;
      ShipToOptions@1022 : 'Default (Company Address),Location,Customer Address,Custom Address';
      PayToOptions@1021 : 'Default (Vendor),Another Vendor,Custom Address';
      PurchaseHeaderExtension@1100528400 : Record 11020398;
      VendorRec@11012007 : Record 23;
      JobQueueVisible@1000 : Boolean INDATASET;
      JobQueueUsed@1004 : Boolean INDATASET;
      HasIncomingDocument@1012 : Boolean;
      DocNoVisible@1008 : Boolean;
      VendorInvoiceNoMandatory@1010 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1011 : Boolean;
      OpenApprovalEntriesExist@1014 : Boolean;
      ShowWorkflowStatus@1013 : Boolean;
      CanCancelApprovalForRecord@1015 : Boolean;
      DocumentIsPosted@1016 : Boolean;
      OpenPostedPurchaseOrderQst@1017 : TextConst '@@@="%1 = posted document number";ENU=The order is posted as number %1 and moved to the Posted Purchase Invoices window.\\Do you want to open the posted invoice?;NOR=Ordren er bokfõrt som nummer %1 og flyttet til vinduet Bokfõrte kjõpsfakturaer.\\Vil du Üpne den bokfõrte fakturaen?;SVE=Ordern har bokfîrts som nummer %1 och flyttats till fînstret Bokfîrda inkîpsfakturor.\\Vill du îppna den bokfîrda fakturan?';
      CanRequestApprovalForFlow@1019 : Boolean;
      CanCancelApprovalForFlow@1020 : Boolean;
      ShowShippingOptionsWithLocation@1023 : Boolean;
      IsSaaS@1024 : Boolean;
      IsBuyFromCountyVisible@1027 : Boolean;
      IsPayToCountyVisible@1026 : Boolean;
      IsShipToCountyVisible@1025 : Boolean;
      AmountReceived@1100485006 : Decimal;
      AmountInvoiced@1210190002 : Decimal;
      Text11012004@1210190003 : TextConst 'ENU=Generate Order Line(s) not allowed, Blanket Order %1 valid until %2.;SVE=Generera orderrad(er) inte tillÜtet. Avropsorder %1 giltig till %2.';
      gFromReference@1210190006 : Boolean;
      gOrderLineNo@1210190004 : Integer;
      Text11012006@1100485001 : TextConst 'ENU=ICM Login Code is empty;SVE=ICM-inloggningskod Ñr tom';
      PhasePlanMgt@1100525006 : Codeunit 11012242;
      ShipmentInstruct1@1100525001 : Text[38];
      ShipmentInstruct2@1100525002 : Text[38];
      PhoneICM@1100525003 : Text[13];
      DPA_IsHardFilter@1100000999 : Boolean;
      PaymentAgreementEditable@19078437 : Boolean INDATASET;
      InductionNoteNoEditable@19050615 : Boolean INDATASET;
      FieldsEditable@1210190000 : Boolean INDATASET;
      GS1Editable@1100528300 : Boolean INDATASET;
      Text11012009@1100409000 : TextConst 'ENU=Email has been sent on %1. Do you wish to continue?';
      LinkItemDocsToPurchHeadEnabled@1100528000 : Boolean INDATASET;
      NewDocumentReportingVisible@1100528401 : Boolean INDATASET;
      ApprovalManagement4PSConstr@1100528551 : Codeunit 11125349;
      ReleasedOrderFieldsEditable@1100529600 : Boolean INDATASET;
      Text11012010@1100527450 : TextConst 'ENU=Purchase Order with status ''Pending Approval'' cannot be closed';
      StandardShippingOptionsVisible@1100528500 : Boolean INDATASET;
      InwRegList@1070000 : Page 11128014;
      InwRegForm@1100285003 : Page 11128010;
      VendledgEntry@1100285001 : Record 25;
      GenJnlLine@1100285000 : Record 81;
      GLSetup@111285700 : Record 98;
      DKinfoEnable@11128570 : Boolean INDATASET;
      FIinfoEnable@11128200 : Boolean INDATASET;
      NORlocalizationEnable@1100285300 : Boolean INDATASET;
      "*** ExFlow ***"@12013591 : Integer;
      DocHead@12013592 : Record 12013608;
      ExFlow@12013595 : Codeunit 12013601;
      EXF01@12013596 : TextConst 'ENU=Warning! The purchase order is not approved!;SVE=Varning! Inkîpsordern Ñr inte godkÑnd!';
      ExFlowVisible@1100285500 : Boolean INDATASET;
      "*** PEB ***"@12047960 : Integer;
      gBaseMgt@12047958 : Codeunit 11128082;
      "*** Orango ***"@1101285005 : Integer;
      CustButtonsPageID@1101285004 : Integer;
      CustButtonsVisible1@1101285003 : Boolean INDATASET;
      CustButtonsVisible2@1101285002 : Boolean INDATASET;
      CustButtonsVisible3@1101285001 : Boolean INDATASET;
      CustomSelectedbuttons@1101285000 : Record 11128006;

    LOCAL PROCEDURE ActivateFields@6();
    BEGIN
      IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
      IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
      IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
    END;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    VAR
      PurchaseHeader@1001 : Record 38;
      InstructionMgt@1002 : Codeunit 1330;
      ApplicationAreaMgmtFacade@1004 : Codeunit 9179;
      LinesInstructionMgt@1005 : Codeunit 1320;
      IsScheduledPosting@1003 : Boolean;
    BEGIN
      IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
        LinesInstructionMgt.PurchaseCheckAllLinesHaveQuantityAssigned(Rec);

      //**4PS. If this NAV standard function is changed, look at action "PostSelected" to see if anything has to be changed there
      SendToPosting(PostingCodeunitID);

      IsScheduledPosting := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      DocumentIsPosted := (NOT PurchaseHeader.GET("Document Type","No.")) OR IsScheduledPosting;

      IF IsScheduledPosting THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);

      IF PostingCodeunitID <> CODEUNIT::"Purch.-Post (Yes/No)" THEN
        EXIT;

      IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
        ShowPostedConfirmationMessage;
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SaveInvoiceDiscountAmount@14();
    VAR
      DocumentTotals@1000 : Codeunit 57;
    BEGIN
      CurrPage.SAVERECORD;
      DocumentTotals.PurchaseRedistributeInvoiceDiscountAmountsOnDocument(Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@9929();
    BEGIN
      CurrPage.PurchLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@3212();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@2528();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@2899();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE Prepayment37OnAfterValidate@4319();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShowPreview@7();
    VAR
      PurchPostYesNo@1000 : Codeunit 91;
    BEGIN
      PurchPostYesNo.Preview(Rec);
    END;

    LOCAL PROCEDURE ShowPrepmtInvoicePreview@15();
    VAR
      PurchPostPrepmtYesNo@1000 : Codeunit 445;
    BEGIN
      PurchPostPrepmtYesNo.Preview(Rec,2);
    END;

    LOCAL PROCEDURE ShowPrepmtCrMemoPreview@9();
    VAR
      PurchPostPrepmtYesNo@1000 : Codeunit 445;
    BEGIN
      PurchPostPrepmtYesNo.Preview(Rec,3);
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.PurchaseDocumentNoIsVisible(DocType::Order,"No.");
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@3();
    VAR
      PurchasesPayablesSetup@1000 : Record 312;
    BEGIN
      PurchasesPayablesSetup.GET;
      VendorInvoiceNoMandatory := PurchasesPayablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
      WorkflowWebhookMgt@1000 : Codeunit 1543;
    BEGIN
      JobQueueVisible := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      SetExtDocNoMandatoryCondition;

      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);

      WorkflowWebhookMgt.GetCanRequestAndCanCancel(RECORDID,CanRequestApprovalForFlow,CanCancelApprovalForFlow);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@17();
    VAR
      OrderPurchaseHeader@1003 : Record 38;
      PurchInvHeader@1000 : Record 122;
      InstructionMgt@1002 : Codeunit 1330;
    BEGIN
      IF NOT OrderPurchaseHeader.GET("Document Type","No.") THEN BEGIN
        PurchInvHeader.SETRANGE("No.","Last Posting No.");
        IF PurchInvHeader.FINDFIRST THEN
          IF InstructionMgt.ShowConfirm(STRSUBSTNO(OpenPostedPurchaseOrderQst,PurchInvHeader."No."),
               InstructionMgt.ShowPostedConfirmationMessageCode)
          THEN
            PAGE.RUN(PAGE::"Posted Purchase Invoice",PurchInvHeader);
      END;
    END;

    LOCAL PROCEDURE ValidateShippingOption@8();
    BEGIN
      EXIT; //**4PS.n

      CASE ShipToOptions OF
        ShipToOptions::"Default (Company Address)",
        ShipToOptions::"Custom Address":
          BEGIN
            VALIDATE("Location Code",'');
            VALIDATE("Sell-to Customer No.",'');
          END;
        ShipToOptions::Location:
          BEGIN
            VALIDATE("Location Code");
            VALIDATE("Sell-to Customer No.",'');
          END;
        ShipToOptions::"Customer Address":
          BEGIN
            VALIDATE("Sell-to Customer No.");
            VALIDATE("Location Code",'');
          END;
      END;
    END;

    LOCAL PROCEDURE ShowReleaseNotification@12() : Boolean;
    VAR
      LocationsQuery@1001 : Query 5002;
    BEGIN
      IF Status <> Status::Released THEN BEGIN
        LocationsQuery.SETRANGE(Document_No,"No.");
        LocationsQuery.SETRANGE(Require_Receive,TRUE);
        LocationsQuery.OPEN;
        IF LocationsQuery.READ THEN
          EXIT(TRUE);
        LocationsQuery.SETRANGE(Document_No,"No.");
        LocationsQuery.SETRANGE(Require_Receive);
        LocationsQuery.SETRANGE(Require_Put_away,TRUE);
        LocationsQuery.OPEN;
        EXIT(LocationsQuery.READ);
      END;
      EXIT(FALSE);
    END;

    LOCAL PROCEDURE CalculateCurrentShippingAndPayToOption@36();
    BEGIN
      CASE TRUE OF
        "Sell-to Customer No." <> '':
          ShipToOptions := ShipToOptions::"Customer Address";
        "Location Code" <> '':
          ShipToOptions := ShipToOptions::Location;
        ELSE
          IF ShipToAddressEqualsCompanyShipToAddress THEN
            ShipToOptions := ShipToOptions::"Default (Company Address)"
          ELSE
            ShipToOptions := ShipToOptions::"Custom Address";
      END;

      CASE TRUE OF
        ("Pay-to Vendor No." = "Buy-from Vendor No.") AND BuyFromAddressEqualsPayToAddress:
          PayToOptions := PayToOptions::"Default (Vendor)";
        ("Pay-to Vendor No." = "Buy-from Vendor No.") AND (NOT BuyFromAddressEqualsPayToAddress):
          PayToOptions := PayToOptions::"Custom Address";
        "Pay-to Vendor No." <> "Buy-from Vendor No.":
          PayToOptions := PayToOptions::"Another Vendor";
      END;

      OnAfterCalculateCurrentShippingAndPayToOption(ShipToOptions,PayToOptions,Rec);
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCalculateCurrentShippingAndPayToOption@10(VAR ShipToOptions@1001 : 'Default (Company Address),Location,Customer Address,Custom Address';VAR PayToOptions@1000 : 'Default (Vendor),Another Vendor,Custom Address';PurchaseHeader@1002 : Record 38);
    BEGIN
    END;

    PROCEDURE VendorIsSubcontractor@1210190003() : Boolean;
    BEGIN
      //**4PS
      VendorRec.SETRANGE("No.","Buy-from Vendor No.");
      VendorRec.SETFILTER("Subcontractor Type",'>%1',VendorRec."Subcontractor Type"::" ");
      EXIT(VendorRec.FIND('-'));
    END;

    PROCEDURE SelectBlanketOrder@1210190001();
    VAR
      lvPurchHeadRec@1210190009 : Record 38;
      lvPurchLine@1210190008 : Record 39;
      lvPurchLine2@1210190007 : Record 39;
      lvMarkedLineRec@1100485001 : Record 39;
      lvPurchLinesFrm@1100485000 : Page 518;
      lvRouteRefMgtCU@1210190010 : Codeunit 11012045;
      LastLino@1210190000 : Integer;
      lvLastRefNo@1210190002 : Code[20];
    BEGIN
      //**4PS
      lvPurchLine.FILTERGROUP(9);
      lvPurchLine.SETRANGE("Document Type", lvPurchLine."Document Type"::"Blanket Order");
      lvPurchLine.SETRANGE("Buy-from Vendor No.", "Buy-from Vendor No.");
      lvPurchLine.SETRANGE("Purchase Order Status",
        lvPurchLine."Purchase Order Status"::Open, lvPurchLine."Purchase Order Status"::Released);
      lvPurchLine.FILTERGROUP(0);
      lvPurchLine.SETFILTER("Valid Until", '%1|>%2', 0D, TODAY);
      lvPurchLinesFrm.SETTABLEVIEW(lvPurchLine);
      lvPurchLinesFrm.LOOKUPMODE(TRUE);
      IF lvPurchLinesFrm.RUNMODAL() = ACTION::LookupOK THEN BEGIN
        IF NOT lvPurchLinesFrm.GetMarkedLines(lvMarkedLineRec) THEN BEGIN
          lvPurchLinesFrm.GETRECORD(lvPurchLine);
          lvPurchLine.SETRANGE("Document Type", lvPurchLine."Document Type");
          lvPurchLine.SETRANGE("Document No.", lvPurchLine."Document No.");
          lvPurchLine.SETRANGE("Line No.", lvPurchLine."Line No.");
        END ELSE BEGIN
          lvPurchLine.COPY(lvMarkedLineRec);
        END;
        IF lvPurchLine.FINDSET(TRUE,FALSE) THEN BEGIN
          REPEAT
            lvPurchHeadRec.GET(lvPurchLine."Document Type", lvPurchLine."Document No.");
            IF (lvPurchHeadRec."Valid Until" <> 0D) AND (lvPurchHeadRec."Valid Until" <= TODAY) THEN
              ERROR(Text11012004, lvPurchHeadRec."No.", lvPurchHeadRec."Valid Until");

            lvPurchLine2.RESET;
            lvPurchLine2.SETRANGE("Document Type", "Document Type"::Order);
            lvPurchLine2.SETRANGE("Document No.", "No.");
            IF lvPurchLine2.FINDLAST THEN
              LastLino := lvPurchLine2."Line No."
            ELSE
              LastLino := 0;

            lvPurchLine2 := lvPurchLine;
            lvPurchLine2."Document Type" := "Document Type"::Order;
            lvPurchLine2."Document No." := "No.";
            lvPurchLine2."Line No." := LastLino + 10000;
            lvPurchLine2."Blanket Order No." := lvPurchLine."Document No.";
            lvPurchLine2."Blanket Order Line No." := lvPurchLine."Line No.";
            lvPurchLine2.Quantity := 0;
            lvPurchLine2."Quantity Received" := 0;
            lvPurchLine2."Quantity Invoiced" := 0;
            lvPurchLine2."Quantity (Base)" := 0;
            lvPurchLine2."Qty. Received (Base)" := 0;
            lvPurchLine2."Qty. Invoiced (Base)" := 0;
            lvPurchLine2.INSERT(TRUE);

            lvPurchLine2.Quantity := lvPurchLine.Quantity;  //however incorrect, but reset by next function
            lvPurchLine2.Quantity := lvPurchLine2.CheckBlanketOrder(FALSE);
            lvPurchLine2.VALIDATE(Quantity);
            IF (lvPurchLine."Purchase Route Reference" <> '') THEN BEGIN
              lvPurchLine2."Purchase Route Reference" := lvPurchLine."Purchase Route Reference";
            END ELSE BEGIN
              lvLastRefNo := lvRouteRefMgtCU.GetLastRefNo();
              lvLastRefNo := INCSTR(lvLastRefNo);
              lvPurchLine2."Purchase Route Reference" := lvLastRefNo;
              lvPurchLine."Purchase Route Reference" := lvLastRefNo;
              lvRouteRefMgtCU.WriteLastRefNo(lvLastRefNo);
            END;
            lvPurchLine2.MODIFY(TRUE);

            //lvPurchLine."Qty. to Receive" := lvPurchLine.Quantity - lvPurchLine2.Quantity;
            //lvPurchLine.MODIFY;  //db, 19-04-10: M19112

          UNTIL lvPurchLine.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE InitSelectionFromReference@1210190002(IOrderLineNo@1210190000 : Integer);
    BEGIN
      //**4PS
      gFromReference := TRUE;
      gOrderLineNo := IOrderLineNo;
    END;

    PROCEDURE EditDetailsBuyerAddress@1100485001();
    VAR
      lvPurchHeaderRec@1100485000 : Record 38;
      NameDetails@1210190000 : Page 11072501;
    BEGIN
      //**4PS
      IF WRITEPERMISSION THEN BEGIN
        MODIFY;
        COMMIT;
      END;

      lvPurchHeaderRec.SETRANGE("Document Type","Document Type");
      lvPurchHeaderRec.SETRANGE("No.","No.");

      CLEAR(NameDetails);
      NameDetails.SETTABLEVIEW(lvPurchHeaderRec);
      NameDetails.SETRECORD(lvPurchHeaderRec);
      NameDetails.RUNMODAL;
      NameDetails.GETRECORD(lvPurchHeaderRec);

      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShowDocuments@1100528400();
    VAR
      DocumentFilters@1100528400 : Codeunit 11012432;
      RecRef@1100528401 : RecordRef;
    BEGIN
      //**4PS
      RecRef.GETTABLE(Rec);
      DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
    END;

    PROCEDURE GS1ErrorLogDrillDown@1210190005();
    VAR
      GS1ErrorLog@1210190000 : Record 11072078;
    BEGIN
      //**4PS
      GS1ErrorLog.SETRANGE("Document Type", "Document Type");
      GS1ErrorLog.SETRANGE("Document No.", "No.");
      GS1ErrorLog.TableDrillDown(GS1ErrorLog);
    END;

    PROCEDURE GS1PurchaseOrderLogDrillDown@1210190007();
    VAR
      GS1PurchaseOrderLog@1210190000 : Record 11072079;
    BEGIN
      //**4PS
      GS1PurchaseOrderLog.SETRANGE("Document Type", "Document Type");
      GS1PurchaseOrderLog.SETRANGE("Document No.", "No.");
      GS1PurchaseOrderLog.TableDrillDown(GS1PurchaseOrderLog);
    END;

    LOCAL PROCEDURE InductionNoteNoOnAfterValidate@19013542();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE PurchaseOrderTypeOnAfterValida@19048848();
    VAR
      lvPurchLineRec@1100525001 : Record 39;
    BEGIN
      //**4PS
      IF "Purchase Order Type" = "Purchase Order Type"::"Blanket Order" THEN BEGIN
        lvPurchLineRec.SETRANGE("Document Type", lvPurchLineRec."Document Type"::Order);
        lvPurchLineRec.SETRANGE("Document No.","No.");
        IF lvPurchLineRec.FINDSET THEN
         CurrPage.UPDATE;
      END;
    END;

    LOCAL PROCEDURE PurchaseHeaderExtensionDeliver@19002753();
    BEGIN
      //**4PS
      PurchaseHeaderExtension.UpdatePurchHeadExtension("Document Type", "No.");
    END;

    LOCAL PROCEDURE ShipmentInstruct1OnAfterValida@19023030();
    BEGIN
      //**4PS
      HandleShipmentInstruction(1, ShipmentInstruct1, ShipmentInstruct2);
    END;

    LOCAL PROCEDURE ShipmentInstruct2OnAfterValida@19004685();
    BEGIN
      //**4PS
      HandleShipmentInstruction(1, ShipmentInstruct1, ShipmentInstruct2);
    END;

    LOCAL PROCEDURE PhoneICMOnAfterValidate@19008432();
    BEGIN
      //**4PS
      HandlePhoneICM(1, PhoneICM);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRec@19077479();
    VAR
      RecRef@1100529900 : RecordRef;
    BEGIN
      //**4PS
      HandlePhoneICM(0, PhoneICM);
      HandleShipmentInstruction(0, ShipmentInstruct1, ShipmentInstruct2);

      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Shortcut Dimension 1 Code");
    END;

    LOCAL PROCEDURE GetIcbDetails@1100528900(iAction@1100528900 : Integer) DetailTxt : Text;
    VAR
      ICMOrderConfirmationHeader@1100528901 : Record 11012324;
    BEGIN
      //C052891
      IF iAction = 1 THEN BEGIN
        CALCFIELDS("ICM Confirmations");
        IF "ICM Confirmations" = 0 THEN EXIT('');
        ICMOrderConfirmationHeader.SETRANGE("Confirmation/Error", ICMOrderConfirmationHeader."Confirmation/Error"::Confirmation);
      END;
      IF iAction = 2 THEN BEGIN
        CALCFIELDS("ICM Errors");
        IF "ICM Errors" = 0 THEN EXIT('');
        ICMOrderConfirmationHeader.SETRANGE("Confirmation/Error", ICMOrderConfirmationHeader."Confirmation/Error"::Error);
      END;
      IF (iAction = 1) OR (iAction = 2) THEN BEGIN
        ICMOrderConfirmationHeader.SETRANGE("Order No.", "No.");
        IF ICMOrderConfirmationHeader.FINDSET THEN BEGIN
          REPEAT
            IF DetailTxt = '' THEN
              DetailTxt := ICMOrderConfirmationHeader.TABLECAPTION + ': ';
            IF ICMOrderConfirmationHeader."Error Message 1" <> '' THEN
              DetailTxt := DetailTxt + ICMOrderConfirmationHeader."Error Message 1" + '; ';
            IF ICMOrderConfirmationHeader."Error Message 2" <> '' THEN
              DetailTxt := DetailTxt + ICMOrderConfirmationHeader."Error Message 2" + '; ';
            IF ICMOrderConfirmationHeader."Error Message 3" <> '' THEN
              DetailTxt := DetailTxt + ICMOrderConfirmationHeader."Error Message 3" + '; ';
            IF ICMOrderConfirmationHeader."Error Message 4" <> '' THEN
              DetailTxt := DetailTxt + ICMOrderConfirmationHeader."Error Message 4" + '; ';
          UNTIL (ICMOrderConfirmationHeader.NEXT = 0) OR (STRLEN(DetailTxt) > 1000);
        END;
      END;
      EXIT(DetailTxt);
    END;

    BEGIN
    {
      4PS 20-09-16 UKR-C27159 VAKAT: BI032 checkbox Back-to-back - Added field
      4PS 30-03-18 DP01917 OLKOL: Action Approve changed

      Field General : Approve
      Field General : ExFlowStatus
      Field General : Requisition No.
      Action        : Show Document (Code)
      Action        : Attachments
      Code          : Action Print
      Text Const.   : EXF01
      Globals
      Variables     : DocHead,ExFlow
      190401 SICH upgraded to 513.
      <-- ExFlow ---

      PEB *** Begin ***
      PEB0012 "Note of Goods" field added
      PEB0042 Get Coding from Latest Invoice
      PEB
        New field on Page
        General:
         - Note of Goods
      PEB *** End ***

      190829 ORANGO.LP CER GAP 15 New field "Document Sent By"
      191209 ORANGO.FH #26956 Removed bool ReleasedOrderFieldsEditable from propertie "Editable" on field "Vendor Order No
      191105 ORANGO.LP 4PSSE CER GAP 13 New field "Fast Order"
    }
    END.
  }
}

