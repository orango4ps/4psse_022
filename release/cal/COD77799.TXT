OBJECT Codeunit 77799 TT NAV DL Tools
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=TTool;
  }
  PROPERTIES
  {
    OnRun=VAR
            ProjectCode@1101285000 : Code[20];
          BEGIN
            //ProjCode := 'N2017-011';
            EXIT;

            TTNAVProject.SETRANGE(Active,TRUE);
            TTNAVProject.FINDLAST;
            ProjectCode := TTNAVProject.Code;

            markeraAllaSammaSomENU;

            // TTNAVCaption1.SETRANGE("Project Code",TTNAVProject.Code);
            // TTNAVCaption1.SETRANGE("Language ID",TTNAVProject."Target Language ID");
            // TTNAVCaption1.SETRANGE("Language Filter",TTNAVProject."Source Language ID");
            // TTNAVCaption1.SETFILTER(Caption1,'<>%1','');
            // SetGetDialog;

            //"insert renumber localizations";
            //renumberlocalizations(ProjectCode);

            //createMissingEmptyCaptions(ProjectCode);


            // AutoTranslateOnCaption;


            //TTTranslationManagement.AutoTranslate(0, Rec, TTProject);

            //"fix options strings";
            //AutoTranslate;

            //TTTranslationManagement.TagOptionStringDifferences

            // sendOptionStringsToExcel(ProjectCode,TRUE);
            //markEquals;
            //MarkUntranslatedUniqueEntries(ProjectCode);
            //SQLAutoTranslateOnCaption(TTNAVProject."source other project",TTNAVProject.Code,TTNAVProject."Target Language ID",TTNAVProject."Source Language ID");
            //flaggaBortDCW(ProjectCode);

            // readLicense('C:\Navision\imtech\151119 Permission Report Detailed (1).txt');
            // readLicense('C:\Navision\imtech\151222 Permission Report Detailed.txt');
            // readLicense('K:\Assemblin (Imtech Nordic)\02_licenser\161024 Permission Report Detailed.txt');
          END;

  }
  CODE
  {
    VAR
      TTNAVCaption1@1000000000 : Record 77786;
      TTNAVCaption2@1000000001 : Record 77786;
      TTNAVCaption3@1100409004 : Record 77786;
      TTNAVCaption4@1000000005 : Record 77786;
      renumberobjects@1000000002 : Record 72850;
      TTNAVObject@1000000003 : Record 77785;
      TTNAVObject2@1000000004 : Record 77785;
      TTTranslationManagement@1100409001 : Codeunit 77781;
      TTNAVProject@1100409003 : Record 77782;
      dial@1101285000 : Dialog;
      SetGetDialogBool@1101285001 : Boolean;
      ServerEnvironmentManagement@1101285002 : Codeunit 11012284;

    LOCAL PROCEDURE flaggaBortDCW@1101285000(ProjectCode@1101285001 : Code[20]);
    VAR
      TTCaption@1101285000 : Record 77786;
      objlistr@1101285002 : Record 2000000001;
      objType@1101285003 : Code[10];
    BEGIN
      TTCaption.SETRANGE("Project Code",ProjectCode);
      TTCaption.SETRANGE("Language ID",TTNAVProject."Target Language ID");
      TTCaption.SETFILTER(Tag1,'%1','');

      objlistr.SETFILTER("Version List",'DCW*|EMW*');
      IF objlistr.FINDSET(FALSE) THEN REPEAT
        CASE objlistr.Type OF
          objlistr.Type::Codeunit:  objType := 'C';
          objlistr.Type::Page:      objType := 'N';
          objlistr.Type::Report:    objType := 'R';
          objlistr.Type::MenuSuite: objType := 'M';
          objlistr.Type::Query:     objType := 'Q';
          objlistr.Type::Table:     objType := 'T';
          objlistr.Type::XMLport:   objType := 'X';
        END;
        IF objType <> '' THEN BEGIN
          TTCaption.SETFILTER("Object ID",objType+FORMAT(objlistr.ID,0,2)+'-*');
          IF TTCaption.FINDSET THEN
            TTCaption.MODIFYALL(Tag1,COPYSTR(objlistr."Version List",1,3),FALSE);
        END;
        objType := ''
      UNTIL objlistr.NEXT=0;
    END;

    PROCEDURE SQLAutoTranslateOnCaption@1101285003(TargetProjectCode@1101285005 : Code[20];SourceProjectCode@1101285006 : Code[20];LangID@1101285007 : Code[10];commonLangID@1101285010 : Code[10]);
    VAR
      lADOConnection@1101285000 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000514-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Connection";
      ltxtConnectionString@1101285001 : Text;
      lADOCommand@1101285002 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000507-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Command";
      lADORecordSet@1101285003 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000535-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Recordset";
      lvarActiveConnection@1101285004 : Variant;
      lcommandstring@1101285008 : ARRAY [2] OF Text[250];
      fnutt@1101285009 : Char;
      lwherestring@1101285011 : ARRAY [4] OF Text[250];
    BEGIN

      //for all blank TargetProject.(SVE).Captions
      //  find corresponding source.(ENU).caption
      //  find caption in SourceProject (ENU) and corresponding caption (SVE)
      //  unpdate tagrget.(SVE).caption with source.(SVE).caption


      IF (TargetProjectCode = '') OR (SourceProjectCode = '') OR (LangID = '') OR (commonLangID = '') THEN EXIT;

      fnutt := 39;

      lcommandstring[1] := 'update ts set ';
      lcommandstring[1] += 'ts.Caption1 = ot.Caption1,ts.Caption2 = ot.Caption2,ts.Caption3 = ot.Caption3,ts.Caption4 = ot.Caption4,ts.Caption5 = ot.Caption5,ts.Caption6 = ot.Caption6, ';
      lcommandstring[1] += 'ts.Status = 6, ts.[Last Modified] = CURRENT_TIMESTAMP, ts.Tag2 = '+FORMAT(fnutt)+'œ'+FORMAT(fnutt)+' ';
      lcommandstring[2] := 'from ';
      lcommandstring[2] += '[TT NAV Caption] ts,[TT NAV Caption] tt,[TT NAV Caption] os,[TT NAV Caption] ot ';
      lwherestring[1] := 'where ';
      lwherestring[1] += 'ts.[Project Code] = '+FORMAT(fnutt)+TargetProjectCode+FORMAT(fnutt)+' and ts.Caption1 = '+FORMAT(fnutt)+''+FORMAT(fnutt)+' and ts.[Language ID] = '+LangID+' ';
      lwherestring[2] := ' and tt.[Project Code] = ts.[Project Code] and tt.Caption1 <> '+FORMAT(fnutt)+FORMAT(fnutt)+' and tt.[Language ID] = '+commonLangID+' and tt.[Object ID] = ts.[Object ID] ';
      lwherestring[2] += ' and os.[Project Code] = '+FORMAT(fnutt)+SourceProjectCode+FORMAT(fnutt)+ ' ';
      lwherestring[3] := ' and os.Caption1 = tt.Caption1 and os.Caption2 = tt.Caption2 and os.Caption3 = tt.Caption3 and os.Caption4 = tt.Caption4 and os.Caption5 = tt.Caption5 and os.Caption6 = tt.Caption6';
      lwherestring[3] += ' and os.[Language ID] = tt.[Language ID] ';
      lwherestring[4] := ' and os.[Project Code] = ot.[Project Code] and os.[Object ID] = ot.[Object ID] and ot.[Language ID] = ts.[Language ID] and ot.Caption1 <> '+FORMAT(fnutt)+FORMAT(fnutt)+';';

      ltxtConnectionString:='Driver={SQL Server};'
          + 'Server='+ServerEnvironmentManagement.GetDatabaseServerName+';'
          + 'Database='+ServerEnvironmentManagement.GetDatabaseName+';'
          + 'Trusted_Connection=True;';
      //    + 'Uid='+USERID+';'
      //    + 'Pwd='+pcodPassword+';';

      IF ISCLEAR(lADOConnection) THEN CREATE(lADOConnection,TRUE,TRUE);
      lADOConnection.ConnectionString:=ltxtConnectionString;
      lADOConnection.Open;

      IF ISCLEAR(lADOCommand) THEN CREATE(lADOCommand,TRUE,TRUE);

      lvarActiveConnection := lADOConnection;
      lADOCommand.ActiveConnection := lvarActiveConnection;
      lADOCommand.CommandText := lcommandstring[1] + lcommandstring[2] + lwherestring[1]+ lwherestring[2]+ lwherestring[3]+ lwherestring[4];
      lADOCommand.CommandType := 1;
      lADOCommand.CommandTimeout := 0;
      lADOCommand.Execute;

      // IF ISCLEAR(lADORecordSet) THEN CREATE(lADORecordSet,TRUE,TRUE);
      // lADORecordSet.ActiveConnection := lvarActiveConnection;
      // lADORecordSet.Open(lADOCommand);
      // WHILE NOT lADORecordSet.EOF DO BEGIN
      //  MESSAGE(lADORecordSet.GetString);
      //
      //  //lADORecordset.MoveNext;
      // END;


      lADOConnection.Close;
      CLEAR(lADOConnection);


      // update ts set
      // ts.Caption1 = ot.Caption1,
      // ts.Caption2 = ot.Caption2,
      // ts.Caption3 = ot.Caption3,
      // ts.Caption4 = ot.Caption4,
      // ts.Caption5 = ot.Caption5,
      // ts.Caption6 = ot.Caption6,
      // ts.Status = 6, ts.[Last Modified] = CURRENT_TIMESTAMP, ts.Tag2 = 'AC'
      // from
      // [TT NAV Caption] ts
      // ,[TT NAV Caption] tt
      // ,[TT NAV Caption] os
      // ,[TT NAV Caption] ot
      // where
      // ts.[Project Code] = '4PSSE2017-011' and ts.Caption1 = '' and ts.[Language ID] = 1044
      // and tt.[Project Code] = ts.[Project Code] and tt.Caption1 <> '' and tt.[Language ID] = 1033 and tt.[Object ID] = ts.[Object ID]
      // and os.[Project Code] = 'NAVNO2017' and
      // os.Caption1 = tt.Caption1 and
      // os.Caption2 = tt.Caption2 and
      // os.Caption3 = tt.Caption3 and
      // os.Caption4 = tt.Caption4 and
      // os.Caption5 = tt.Caption5 and
      // os.Caption6 = tt.Caption6 and
      // os.[Language ID] = 1033 and os.[Object ID] = ts.[Object ID]
      // and os.[Project Code] = ot.[Project Code] and os.[Object ID] = ot.[Object ID] and ot.[Language ID] = 1044;
    END;

    PROCEDURE MarkUntranslatedUniqueEntries@1100525012(ProjectCode@1101285001 : Code[20];openCloseDialog@1101285004 : Boolean);
    VAR
      TempCaption@1100525003 : TEMPORARY Record 77786;
      TTCaptionSource@1101285000 : Record 77786;
      TTCaption@1101285003 : Record 77786;
      prevCaption@1101285002 : Text;
    BEGIN
      SetGetDialog;
      dial.UPDATE(1,'MarkUniqueEntries');
      // SetTagExpression('~%');
      TTNAVProject.GET(ProjectCode);
      TTCaption.SETRANGE("Project Code",ProjectCode);
      TTCaption.SETRANGE("Language ID",TTNAVProject."Target Language ID");
      TTCaption.SETFILTER(Caption1,'%1','');
      TempCaption.SETRANGE("Project Code",ProjectCode);
      TempCaption.SETRANGE("Language ID",TTNAVProject."Target Language ID");

      //MaxCounter := TTCaption.COUNT;
      //OpenWindow(Text003,MaxCounter);
      TTCaption.SETCURRENTKEY("Project Code","Language ID",Caption1);

      //TTCaption.SETRANGE("Language Filter",TTProject."Source Language ID");
      IF TTCaption.FINDSET THEN REPEAT
        dial.UPDATE(2,TTCaption."Object ID");
        IF TTCaptionSource.GET(TTCaption."Project Code",TTNAVProject."Source Language ID",TTCaption."Object ID") THEN
          IF (TTCaptionSource.Caption1<>'') AND (prevCaption <> TTCaptionSource.GetCaption) THEN BEGIN
            TempCaption.SETFILTER(Caption1,'%1',TTCaptionSource.Caption1);

            IF TempCaption.ISEMPTY THEN BEGIN
              TempCaption."Object ID" := TTCaption."Object ID";
              TempCaption.Caption1 := TTCaption."Alt. Caption1";
              TempCaption.INSERT;
              TTCaption.Tag2 := '~'+TTCaption.Tag2;
              TTCaption.MODIFY;
            END;
            prevCaption := TTCaptionSource.GetCaption;
          END;
      UNTIL TTCaption.NEXT = 0;

      IF openCloseDialog THEN
        dial.CLOSE;
    END;

    LOCAL PROCEDURE SetGetDialog@1101285006();
    BEGIN
      IF SetGetDialogBool THEN
        EXIT;

      dial.OPEN('#1########################################################################\'+
                '#2########################################################################');
      SetGetDialogBool := TRUE;
    END;

    PROCEDURE createMissingEmptyCaptions@1101285002(ProjectCode@1101285001 : Code[20];openCloseDialog@1101285003 : Boolean);
    VAR
      TTNAVCaption@1101285000 : Record 77786;
      prevType@1101285002 : Text;
    BEGIN
      SetGetDialog;
      dial.UPDATE(1,'createMissingEmptyCaptions');
      TTNAVProject.GET(ProjectCode);

      TTNAVCaption.SETRANGE("Project Code",ProjectCode);
      TTNAVCaption.SETRANGE("Language ID",TTNAVProject."Source Language ID");
      IF TTNAVCaption.FINDSET(FALSE) THEN
      REPEAT
        dial.UPDATE(2,TTNAVCaption."Object ID");
        IF NOT TTNAVCaption2.GET(TTNAVCaption."Project Code",TTNAVProject."Target Language ID",TTNAVCaption."Object ID") THEN BEGIN
          TTNAVCaption2    := TTNAVCaption;
          TTNAVCaption2."Language ID" := TTNAVProject."Target Language ID";
          TTNAVCaption2.SetCaption('');
          TTNAVCaption2.Status := TTNAVCaption2.Status::Generated;
          TTNAVCaption2.INSERT;
        END;
        IF TTNAVProject."Third Language ID" <> '' THEN
          IF NOT TTNAVCaption2.GET(TTNAVCaption."Project Code",TTNAVProject."Third Language ID",TTNAVCaption."Object ID") THEN BEGIN
            TTNAVCaption2    := TTNAVCaption;
            TTNAVCaption2."Language ID" := TTNAVProject."Third Language ID";
            TTNAVCaption2.SetCaption('');
            TTNAVCaption2.Status := TTNAVCaption2.Status::Generated;
            TTNAVCaption2.INSERT;
          END;
        IF COPYSTR(TTNAVCaption."Object ID",1,1) <> prevType THEN
          COMMIT;
        prevType := COPYSTR(TTNAVCaption."Project Code",1,1);
      UNTIL TTNAVCaption.NEXT = 0;

      IF openCloseDialog THEN
        dial.CLOSE;
    END;

    PROCEDURE AutoTranslateOnCaption@1000000007();
    VAR
      captionFound@1000000000 : Boolean;
      TTNAVCaption@1101285000 : Record 77786;
    BEGIN
      SetGetDialog;
      dial.UPDATE(1,'AutoTranslateOnCaption');

      TTNAVCaption.COPYFILTERS(TTNAVCaption1);
      TTNAVCaption.SETFILTER(Caption1,'%1','');
      IF TTNAVCaption.FINDSET(TRUE) THEN REPEAT
        dial.UPDATE(2,TTNAVCaption."Object ID");
        captionFound := FALSE;
        //find sources
        TTNAVCaption2.SETRANGE("Project Code",TTNAVProject.Code);
        TTNAVCaption2.SETRANGE("Language ID",TTNAVProject."Source Language ID");
        IF TTNAVCaption2.GET(TTNAVCaption."Project Code",TTNAVProject."Source Language ID",TTNAVCaption."Object ID") THEN BEGIN
          TTNAVCaption2.SETRANGE(Caption1,TTNAVCaption2.Caption1);
          TTNAVCaption2.SETRANGE(Caption2,TTNAVCaption2.Caption2);
          TTNAVCaption2.SETRANGE(Caption3,TTNAVCaption2.Caption3);
          TTNAVCaption2.SETRANGE(Caption4,TTNAVCaption2.Caption4);
          TTNAVCaption2.SETRANGE(Caption5,TTNAVCaption2.Caption5);
          TTNAVCaption2.SETRANGE(Caption6,TTNAVCaption2.Caption6);
          //for each source, find target with value
          IF TTNAVCaption2.FINDSET(FALSE) THEN REPEAT
            IF TTNAVCaption3.GET(TTNAVCaption."Project Code",TTNAVCaption."Language ID",TTNAVCaption2."Object ID") THEN
              IF TTNAVCaption3.GetCaption <> '' THEN BEGIN
                TTNAVCaption4.GET(TTNAVCaption."Project Code",TTNAVCaption."Language ID",TTNAVCaption."Object ID");
                TTNAVCaption4.SetCaption(TTNAVCaption3.GetCaption);
                TTNAVCaption4.Status := TTNAVCaption4.Status::"Caption based AutoTrans";
                TTNAVCaption4.UpdateProperties;
                captionFound := TTNAVCaption4.MODIFY(FALSE);
              END;
          UNTIL (TTNAVCaption2.NEXT=0) OR captionFound;
        END;



      UNTIL TTNAVCaption.NEXT=0;
    END;

    PROCEDURE markEquals@1100409001();
    VAR
      TTNAVCaption@1101285000 : Record 77786;
    BEGIN
      SetGetDialog;
      dial.UPDATE(1,'markEquals');

      TTNAVCaption.COPYFILTERS(TTNAVCaption1);
      TTNAVCaption.SETFILTER(Tag2,'%1','');

      IF TTNAVCaption.FINDSET(FALSE) THEN
      REPEAT
        dial.UPDATE(2,TTNAVCaption."Object ID");
        IF TTNAVCaption2.GET(TTNAVCaption."Project Code",TTNAVProject."Source Language ID",TTNAVCaption."Object ID") THEN
          IF TTNAVCaption.GetCaption = TTNAVCaption2.GetCaption THEN BEGIN
            TTNAVCaption3.GET(TTNAVCaption."Project Code",TTNAVCaption."Language ID",TTNAVCaption."Object ID");
            TTNAVCaption3.Tag2 := '=';
            TTNAVCaption3.MODIFY(FALSE);
            COMMIT;
          END;

      UNTIL TTNAVCaption.NEXT=0;
      dial.CLOSE; SetGetDialogBool:= FALSE;
    END;

    PROCEDURE sendOptionStringsToExcel@1100409007(ProjectCode@1101285002 : Code[20];openCloseDialog@1101285001 : Boolean);
    VAR
      TAB@1101285029 : Char;
      XlApp@1101285024 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ApplicationClass" RUNONCLIENT;
      trText@1100409000 : Text;
      soText@1100409001 : Text;
      thText@1100409002 : Text;
      colPos@1100409003 : Integer;
      value@1100409004 : Text;
      TTNAVCaption@1101285000 : Record 77786;
      ExcelBuffer@1101285003 : TEMPORARY Record 370;
      CurrRow@1101285004 : Integer;
      CurrCol@1101285005 : Integer;
      FileNameServer@1101285006 : Text;
      FileManagement@1101285007 : Codeunit 419;
      XlWrkBkWriter@1101285008 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorkbookWriter";
      Text000@1101285026 : TextConst '@@@="{Locked=""Excel""}";ENU=Excel not found.;NOR=Finner ikke Excel.;SVE=Excel finns inte.';
      Text036@1101285025 : TextConst '@@@="{Locked=""Excel""}";ENU=The Excel workbook does not exist.;NOR=Excel-arbeidsboken finnes ikke.;SVE=Excel-arbetsboken finns inte.';
      Text037@1101285009 : TextConst '@@@="{Locked=""Excel""}";ENU=Could not create the Excel workbook.;NOR=Kan ikke opprette Excel-arbeidsboken.;SVE=Det gick inte att skapa Excel-arbetsboken.';
      XlWrkShtWriter@1101285010 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorksheetWriter";
      XlWrkBk@1101285022 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook" RUNONCLIENT;
      ExcelBufferDialogMgt@1101285017 : Codeunit 5370;
      OrientationValues@1101285016 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.OrientationValues";
      XlHelper@1101285023 : DotNet "'Microsoft.Dynamics.Nav.Integration.Office, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Integration.Office.Excel.ExcelHelper" RUNONCLIENT;
      LF@1101285015 : Char;
      CR@1101285028 : Char;
      RecNo@1101285014 : Integer;
      InfoRecNo@1101285013 : Integer;
      TotalRecNo@1101285012 : Integer;
      LastUpdate@1101285011 : DateTime;
      Text005@1101285018 : TextConst '@@@="{Locked=""Excel""}";ENU=Creating Excel worksheet...\\;NOR=Oppretter Excel-ark...\\;SVE=Skapar Excel-kalkylblad...\\';
      TempInfoExcelBuf@1101285019 : TEMPORARY Record 370;
      Decorator@1101285020 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellDecorator";
      FileNameClient@1101285021 : Text;
      localFile@1101285027 : File;
      utRad@1101285030 : Text;
    BEGIN
      SetGetDialog;
      dial.UPDATE(1,'sendOptionStringsToExcel');

      TTNAVCaption.COPYFILTERS(TTNAVCaption1);
      TTNAVProject.SETRANGE(Active,TRUE);
      TTNAVProject.FINDLAST;
      TTNAVCaption.SETRANGE("Project Code",ProjectCode);
      TTNAVCaption.SETFILTER("Object ID",'*P8632*|*P8630*');
      TTNAVCaption.SETRANGE("Language ID",TTNAVProject."Target Language ID");
      TTNAVCaption.SETRANGE("Language Filter",TTNAVProject."Source Language ID");
      TTNAVCaption.SETRANGE("Third Language Filter",TTNAVProject."Third Language ID");
      TTNAVCaption.SETFILTER(Caption1,'<>%1','');
      TTNAVCaption.SETFILTER(Tag2,'<>%1','');

      ExcelBuffer.DELETEALL;
      CLEAR(ExcelBuffer);
      // ExcelBuffer.CreateBookAndOpenExcel('',TTNAVProject.Code,'',COMPANYNAME,USERID);

      ExcelBuffer.INIT;
      ExcelBuffer.VALIDATE("Row No.",0);
      ExcelBuffer.VALIDATE("Column No.",0);
      ExcelBuffer."Cell Value as Text" := TTNAVCaption.GETFILTERS;
      ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
      ExcelBuffer.INSERT;
      CurrRow +=1;

      IF TTNAVCaption.FINDSET(FALSE) THEN
      REPEAT
        dial.UPDATE(2,TTNAVCaption."Object ID");
        colPos := 0;
        CurrCol := 1;

      //  CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := TTNAVCaption."Object ID";
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;

        CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := TTNAVCaption."Language ID";
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;

        trText := TTNAVCaption.GetCaption;
        REPEAT
          value := trText;
          IF STRPOS(trText,',') <> 0 THEN
            value := COPYSTR(trText,1,STRPOS(trText,',')-1);
          trText := COPYSTR(trText,STRPOS(trText,',')+1);
          //ExcelBuffer.AddColumn(value,FALSE,'',FALSE,FALSE,FALSE,'',ExcelBuffer."Cell Type"::Text);
          CurrCol += 1;
          ExcelBuffer.INIT;
          ExcelBuffer.VALIDATE("Row No.",CurrRow);
          ExcelBuffer.VALIDATE("Column No.",CurrCol);
          ExcelBuffer."Cell Value as Text" := value;
          ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
          ExcelBuffer.INSERT;
        UNTIL (STRPOS(trText,',') = 0) ;
        CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := trText;
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;

        soText := TTNAVCaption.GetAltCaption;
        CurrRow +=1;
        CurrCol := 0;
        CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := TTNAVCaption."Object ID";
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;

        CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := TTNAVCaption.GETFILTER("Language Filter");
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;
        REPEAT
          value := soText;
          IF STRPOS(soText,',') <> 0 THEN
            value := COPYSTR(soText,1,STRPOS(soText,',')-1);
          soText := COPYSTR(soText,STRPOS(soText,',')+1);
          //ExcelBuffer.AddColumn(value,FALSE,'',FALSE,FALSE,FALSE,'',ExcelBuffer."Cell Type"::Text);
          CurrCol += 1;
          ExcelBuffer.INIT;
          ExcelBuffer.VALIDATE("Row No.",CurrRow);
          ExcelBuffer.VALIDATE("Column No.",CurrCol);
          ExcelBuffer."Cell Value as Text" := value;
          ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
          ExcelBuffer.INSERT;
        UNTIL (STRPOS(soText,',') = 0) ;
        //ExcelBuffer.AddColumn(trText,FALSE,'',FALSE,FALSE,FALSE,'',ExcelBuffer."Cell Type"::Text);
        CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := soText;
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;


        soText := TTNAVCaption.GetThirdCaption;
        CurrRow +=1;
        CurrCol := 0;
        CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := TTNAVCaption."Object ID";
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;

        CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := TTNAVCaption.GETFILTER("Third Language Filter");
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;
        REPEAT
          value := soText;
          IF STRPOS(soText,',') <> 0 THEN
            value := COPYSTR(soText,1,STRPOS(soText,',')-1);
          soText := COPYSTR(soText,STRPOS(soText,',')+1);
          //ExcelBuffer.AddColumn(value,FALSE,'',FALSE,FALSE,FALSE,'',ExcelBuffer."Cell Type"::Text);
          CurrCol += 1;
          ExcelBuffer.INIT;
          ExcelBuffer.VALIDATE("Row No.",CurrRow);
          ExcelBuffer.VALIDATE("Column No.",CurrCol);
          ExcelBuffer."Cell Value as Text" := value;
          ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
          ExcelBuffer.INSERT;
        UNTIL (STRPOS(soText,',') = 0) ;
        //ExcelBuffer.AddColumn(trText,FALSE,'',FALSE,FALSE,FALSE,'',ExcelBuffer."Cell Type"::Text);
        CurrCol += 1;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := soText;
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;


        CurrRow +=1;
        CurrCol := 0;
        ExcelBuffer.INIT;
        ExcelBuffer.VALIDATE("Row No.",CurrRow);
        ExcelBuffer.VALIDATE("Column No.",CurrCol);
        ExcelBuffer."Cell Value as Text" := '';
        ExcelBuffer."Cell Type" := ExcelBuffer."Cell Type"::Text;
        ExcelBuffer.INSERT;

        //ExcelBuffer.NewRow;
        CurrRow +=2;
        CurrCol := 0;
      UNTIL TTNAVCaption.NEXT=0;


      CR := 13;
      LF := 10;
      TAB := 9;
      CurrRow := 0;
      IF ExcelBuffer.FINDSET THEN BEGIN
        localFile.TEXTMODE(TRUE);
        localFile.CREATE(FileManagement.ServerTempFileName('txt'));
      //  'c:\temp\cod77799.txt');
      //  FileManagement.CreateServerFolder
        REPEAT
          IF CurrRow <> ExcelBuffer."Row No." THEN BEGIN
            localFile.WRITE(utRad);
            utRad := '';
          END;
          utRad := utRad + (DELCHR(ExcelBuffer."Cell Value as Text",'<>',' ')+FORMAT(TAB));
          CurrRow := ExcelBuffer."Row No.";
        UNTIL ExcelBuffer.NEXT = 0;
        value := localFile.NAME;
        localFile.CLOSE;
        FileManagement.DownloadToFile(value,'c:\temp\cod77799.txt');
      END;

      MESSAGE('c:\temp\cod77799.txt');

      IF openCloseDialog THEN BEGIN
      dial.CLOSE; SetGetDialogBool:= FALSE;END;
    END;

    PROCEDURE "fix options strings"@1000000000(ProjectCode@1101285001 : Code[20]);
    VAR
      TTNAVCaption@1101285000 : Record 77786;
    BEGIN
      TTNAVCaption.COPYFILTERS(TTNAVCaption1);
      TTNAVCaption.SETRANGE("Project Code",ProjectCode);
      TTNAVCaption.SETFILTER("Language ID",'1044|1053');
      TTNAVCaption.SETFILTER(Caption1,',*');
      IF TTNAVCaption.FINDSET THEN
      REPEAT
        TTNAVCaption2.GET(TTNAVCaption."Project Code",TTNAVCaption."Language ID",TTNAVCaption."Object ID");
        IF STRLEN(TTNAVCaption2.Caption1) < MAXSTRLEN(TTNAVCaption2.Caption1)-1 THEN BEGIN
          TTNAVCaption2.Caption1 := ' '+ TTNAVCaption2.Caption1;
          TTNAVCaption2.MODIFY(FALSE);
        END;
      UNTIL TTNAVCaption.NEXT=0;
    END;

    PROCEDURE AutoTranslate@1100409000(ProjectCode@1101285001 : Code[20]);
    VAR
      TTProject@1100409000 : Record 77782;
      TTNAVCaption@1101285000 : Record 77786;
    BEGIN
      SetGetDialog;
      dial.UPDATE(1,'AutoTranslate');

      TTProject.GET(ProjectCode);
      CLEAR(TTNAVCaption);

      TTNAVCaption.SETRANGE("Project Code",ProjectCode);
      TTNAVCaption.SETFILTER("Language ID",TTProject."Source Language ID");
      TTNAVCaption.SETFILTER(Caption1,'<>%1','');
      IF TTNAVCaption.FINDSET THEN
      REPEAT
        dial.UPDATE(2,TTNAVCaption."Object ID");
        IF TTNAVCaption."Search Caption" = '' THEN BEGIN
          TTNAVCaption.MakeSearchCaption(TTNAVCaption.Caption1,TTNAVCaption."Search Caption");
          IF TTNAVCaption."Search Caption" <> '' THEN
            TTNAVCaption.MODIFY;
        END;
      //  Counter := Counter + 1;
        CASE TRUE OF
      //    FindExactMatch(TranslateMode, TgtCaption, TTProject),
      //    FindMatch(TranslateMode, TgtCaption, TTProject, TRUE), //same object
          FindMatch(TTNAVCaption, TTProject): //all objects
            BEGIN
              TTNAVCaption.UpdateProperties;
              TTNAVCaption.MODIFY(TRUE);
            END;
          ELSE BEGIN
            TTNAVCaption."Probability%" := 0;
            TTNAVCaption.MODIFY;
          END;
        END;
      UNTIL TTNAVCaption.NEXT = 0;
    END;

    LOCAL PROCEDURE FindMatch@1100525027(VAR TgtCaption@1100525000 : Record 77786;TTProject@1100525001 : Record 77782) : Boolean;
    VAR
      TranslationBuffer@1100525005 : TEMPORARY Record 77786;
      Translation@1100525004 : Record 77786;
    BEGIN

      TgtCaption.CALCFIELDS("Alt. Search Caption", TgtCaption."Alt. Caption1");
      GetPossibleTranslations(TgtCaption."Alt. Search Caption", TgtCaption."Alt. Caption1", TTProject, TranslationBuffer, FALSE);

      TranslationBuffer.SETFILTER(Caption1, '<>%1', '');

      IF NOT TranslationBuffer.FINDFIRST THEN
        EXIT;

      Translation.GET(
        TranslationBuffer."Project Code",
        TranslationBuffer."Language ID",
        TranslationBuffer."Object ID");
      //IF TranslateMode = TranslateMode::Translate THEN BEGIN
        TgtCaption.SetCaption(Translation.GetCaption);
      //  IF WithinObject THEN
      //    TgtCaption.Status := TgtCaption.Status::"Obj.-based AutoTrans"
      //  ELSE
          TgtCaption.Status := TgtCaption.Status::"Caption based AutoTrans";
      //END;

      TgtCaption."Probability%" := TranslationBuffer."No. of Occurrences";
      TranslationBuffer.CALCSUMS(TranslationBuffer."No. of Occurrences");

      IF TranslationBuffer."No. of Occurrences" <> 0 THEN BEGIN
        TgtCaption."Probability%" :=
          ROUND(TgtCaption."Probability%" / TranslationBuffer."No. of Occurrences") * 100;
      //  IF WithinObject THEN
      //    TgtCaption."Probability%" := 15 + 0.8 * TgtCaption."Probability%";
      END ELSE BEGIN
        TgtCaption."Probability%" := 0;
        EXIT;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetPossibleTranslations@1100525021(SearchCaption@1100525000 : Code[100];SourceCaption1@1210190000 : Text[250];TTProject@1100525002 : Record 77782;VAR TTCaptionResultSet@1100525001 : Record 77786;WithinObject@1100525005 : Boolean);
    VAR
      TTCaption@1100525004 : Record 77786;
    BEGIN
      IF SearchCaption = '' THEN
        EXIT;

      TTCaption.SETRANGE("Project Code", TTProject.Code);
      TTCaption.SETRANGE("Language ID", TTProject."Source Language ID");
      TTCaption.SETRANGE("Search Caption", SearchCaption);
      TTCaption.SETRANGE("Language Filter", TTProject."Target Language ID");
      TTCaption.SETRANGE(Caption1, SourceCaption1);

      IF WithinObject THEN BEGIN
        TTCaption.SETRANGE("Object Type", TTCaption."Object Type");
        TTCaption.SETRANGE("Object No.", TTCaption."Object No.");
      END;

      IF NOT TTCaption.FINDSET THEN
        EXIT;

      TTCaptionResultSet."Language ID" := TTProject."Target Language ID";
      TTCaptionResultSet."Project Code" := TTProject.Code;
      REPEAT
        TTCaption.CALCFIELDS("Alt. Caption1");
        TTCaptionResultSet.SETFILTER(Caption1, '%1', TTCaption."Alt. Caption1");
        IF TTCaptionResultSet.FINDFIRST THEN BEGIN
          TTCaptionResultSet."No. of Occurrences" := TTCaptionResultSet."No. of Occurrences" + 1;
          TTCaptionResultSet.MODIFY;
        END ELSE BEGIN
          TTCaptionResultSet."Object ID" := TTCaption."Object ID";
          TTCaptionResultSet.Caption1 := TTCaption."Alt. Caption1";
          TTCaptionResultSet."No. of Occurrences" := 1;
          TTCaptionResultSet."Entry No." := TTTranslationManagement.NextEntryNo;
          TTCaptionResultSet.INSERT;
        END;
      UNTIL TTCaption.NEXT = 0;

      TTCaptionResultSet.SETRANGE(Caption1);
      TTCaptionResultSet.SETCURRENTKEY("No. of Occurrences");
      TTCaptionResultSet.ASCENDING(FALSE);
    END;

    PROCEDURE "insert renumber localizations"@1000000002();
    BEGIN
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13600;renumberobjects."4PS Object ID" := 11128570;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13601;renumberobjects."4PS Object ID" := 11128571;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13602;renumberobjects."4PS Object ID" := 11128572;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13603;renumberobjects."4PS Object ID" := 11128573;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13604;renumberobjects."4PS Object ID" := 11128574;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13605;renumberobjects."4PS Object ID" := 11128575;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13606;renumberobjects."4PS Object ID" := 11128576;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13607;renumberobjects."4PS Object ID" := 11128577;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13608;renumberobjects."4PS Object ID" := 11128578;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13609;renumberobjects."4PS Object ID" := 11128579;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13610;renumberobjects."4PS Object ID" := 11128580;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13611;renumberobjects."4PS Object ID" := 11128581;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13612;renumberobjects."4PS Object ID" := 11128582;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13613;renumberobjects."4PS Object ID" := 11128583;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13614;renumberobjects."4PS Object ID" := 11128584;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13615;renumberobjects."4PS Object ID" := 11128585;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13616;renumberobjects."4PS Object ID" := 11128586;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13617;renumberobjects."4PS Object ID" := 11128587;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13618;renumberobjects."4PS Object ID" := 11128588;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13650;renumberobjects."4PS Object ID" := 11128589;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13660;renumberobjects."4PS Object ID" := 11128590;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13651;renumberobjects."4PS Object ID" := 11128591;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13652;renumberobjects."4PS Object ID" := 11128592;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13653;renumberobjects."4PS Object ID" := 11128593;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13672;renumberobjects."4PS Object ID" := 11128594;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 13600;renumberobjects."4PS Object ID" := 11128570;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 13601;renumberobjects."4PS Object ID" := 11128571;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 13602;renumberobjects."4PS Object ID" := 11128572;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13600;renumberobjects."4PS Object ID" := 11128570;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13601;renumberobjects."4PS Object ID" := 11128571;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13602;renumberobjects."4PS Object ID" := 11128572;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13603;renumberobjects."4PS Object ID" := 11128573;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13604;renumberobjects."4PS Object ID" := 11128574;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13605;renumberobjects."4PS Object ID" := 11128575;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13620;renumberobjects."4PS Object ID" := 11128590;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 13600;renumberobjects."4PS Object ID" := 11128570;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::XMLport;renumberobjects."NAV Object ID" := 13600;renumberobjects."4PS Object ID" := 11128570;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 13403;renumberobjects."4PS Object ID" := 11126170;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 32000000;renumberobjects."4PS Object ID" := 11126180;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 32000001;renumberobjects."4PS Object ID" := 11126181;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 32000002;renumberobjects."4PS Object ID" := 11126182;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 13400;renumberobjects."4PS Object ID" := 11126170;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 32000000;renumberobjects."4PS Object ID" := 11126180;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 32000001;renumberobjects."4PS Object ID" := 11126181;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 32000002;renumberobjects."4PS Object ID" := 11126182;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 32000004;renumberobjects."4PS Object ID" := 11126184;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 32000005;renumberobjects."4PS Object ID" := 11126185;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 32000006;renumberobjects."4PS Object ID" := 11126186;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 32000007;renumberobjects."4PS Object ID" := 11126187;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11207;renumberobjects."4PS Object ID" := 11128017;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11208;renumberobjects."4PS Object ID" := 11128018;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11206;renumberobjects."4PS Object ID" := 11128023;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13400;renumberobjects."4PS Object ID" := 11126170;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13402;renumberobjects."4PS Object ID" := 11126172;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 13403;renumberobjects."4PS Object ID" := 11126173;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 32000000;renumberobjects."4PS Object ID" := 11126180;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 32000001;renumberobjects."4PS Object ID" := 11126181;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 32000003;renumberobjects."4PS Object ID" := 11126183;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 32000004;renumberobjects."4PS Object ID" := 11126184;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 32000005;renumberobjects."4PS Object ID" := 11126185;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 32000006;renumberobjects."4PS Object ID" := 11126186;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 13400;renumberobjects."4PS Object ID" := 11126170;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 13401;renumberobjects."4PS Object ID" := 11126171;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 32000000;renumberobjects."4PS Object ID" := 11126180;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 32000001;renumberobjects."4PS Object ID" := 11126181;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 32000002;renumberobjects."4PS Object ID" := 11126182;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 32000003;renumberobjects."4PS Object ID" := 11126183;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 32000004;renumberobjects."4PS Object ID" := 11126184;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11203;renumberobjects."4PS Object ID" := 11128013;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11204;renumberobjects."4PS Object ID" := 11128014;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 3010590;renumberobjects."4PS Object ID" := 11128040;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10600;renumberobjects."4PS Object ID" := 11128500;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10601;renumberobjects."4PS Object ID" := 11128501;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10610;renumberobjects."4PS Object ID" := 11128502;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10612;renumberobjects."4PS Object ID" := 11128503;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10613;renumberobjects."4PS Object ID" := 11128504;IF renumberobjects.INSERT(TRUE) THEN;

      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10614;renumberobjects."4PS Object ID" := 11128505;IF renumberobjects.INSERT(TRUE) THEN;

      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10619;renumberobjects."4PS Object ID" := 11128506;IF renumberobjects.INSERT(TRUE) THEN;

      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10620;renumberobjects."4PS Object ID" := 11128507;IF renumberobjects.INSERT(TRUE) THEN;

      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10621;renumberobjects."4PS Object ID" := 11128508;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10622;renumberobjects."4PS Object ID" := 11128509;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10623;renumberobjects."4PS Object ID" := 11128510;IF renumberobjects.INSERT(TRUE) THEN;

      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10625;renumberobjects."4PS Object ID" := 11128510;IF renumberobjects.INSERT(TRUE) THEN;


      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 15000002;renumberobjects."4PS Object ID" := 11128515;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 15000003;renumberobjects."4PS Object ID" := 11128516;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 15000200;renumberobjects."4PS Object ID" := 11128517;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 15000031;renumberobjects."4PS Object ID" := 11128518;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 10628;renumberobjects."4PS Object ID" := 11128519;IF renumberobjects.INSERT(TRUE) THEN;


      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 10601;renumberobjects."4PS Object ID" := 11128500;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 10602;renumberobjects."4PS Object ID" := 11128501;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 10603;renumberobjects."4PS Object ID" := 11128502;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 10604;renumberobjects."4PS Object ID" := 11128503;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000000;renumberobjects."4PS Object ID" := 11128504;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000001;renumberobjects."4PS Object ID" := 11128505;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000002;renumberobjects."4PS Object ID" := 11128506;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000003;renumberobjects."4PS Object ID" := 11128507;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000004;renumberobjects."4PS Object ID" := 11128508;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000005;renumberobjects."4PS Object ID" := 11128509;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000006;renumberobjects."4PS Object ID" := 11128510;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000007;renumberobjects."4PS Object ID" := 11128511;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000008;renumberobjects."4PS Object ID" := 11128512;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000009;renumberobjects."4PS Object ID" := 11128513;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000010;renumberobjects."4PS Object ID" := 11128514;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000011;renumberobjects."4PS Object ID" := 11128515;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000012;renumberobjects."4PS Object ID" := 11128516;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000013;renumberobjects."4PS Object ID" := 11128517;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000027;renumberobjects."4PS Object ID" := 11128518;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000100;renumberobjects."4PS Object ID" := 11128519;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000101;renumberobjects."4PS Object ID" := 11128520;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 15000200;renumberobjects."4PS Object ID" := 11128521;IF renumberobjects.INSERT(TRUE) THEN;

      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10601;renumberobjects."4PS Object ID" := 11128500;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10602;renumberobjects."4PS Object ID" := 11128501;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10603;renumberobjects."4PS Object ID" := 11128502;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10604;renumberobjects."4PS Object ID" := 11128503;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10605;renumberobjects."4PS Object ID" := 11128504;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10606;renumberobjects."4PS Object ID" := 11128505;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10607;renumberobjects."4PS Object ID" := 11128506;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10608;renumberobjects."4PS Object ID" := 11128507;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10609;renumberobjects."4PS Object ID" := 11128508;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10610;renumberobjects."4PS Object ID" := 11128509;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10611;renumberobjects."4PS Object ID" := 11128510;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10612;renumberobjects."4PS Object ID" := 11128511;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10614;renumberobjects."4PS Object ID" := 11128512;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10615;renumberobjects."4PS Object ID" := 11128513;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10616;renumberobjects."4PS Object ID" := 11128514;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10617;renumberobjects."4PS Object ID" := 11128515;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10630;renumberobjects."4PS Object ID" := 11128516;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10640;renumberobjects."4PS Object ID" := 11128517;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10641;renumberobjects."4PS Object ID" := 11128518;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10642;renumberobjects."4PS Object ID" := 11128519;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10643;renumberobjects."4PS Object ID" := 11128520;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10644;renumberobjects."4PS Object ID" := 11128521;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 10645;renumberobjects."4PS Object ID" := 11128522;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000000;renumberobjects."4PS Object ID" := 11128523;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000001;renumberobjects."4PS Object ID" := 11128524;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000002;renumberobjects."4PS Object ID" := 11128525;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000003;renumberobjects."4PS Object ID" := 11128526;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000004;renumberobjects."4PS Object ID" := 11128527;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000005;renumberobjects."4PS Object ID" := 11128528;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000006;renumberobjects."4PS Object ID" := 11128529;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000050;renumberobjects."4PS Object ID" := 11128530;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000060;renumberobjects."4PS Object ID" := 11128531;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000061;renumberobjects."4PS Object ID" := 11128532;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000062;renumberobjects."4PS Object ID" := 11128533;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000063;renumberobjects."4PS Object ID" := 11128534;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000064;renumberobjects."4PS Object ID" := 11128535;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000065;renumberobjects."4PS Object ID" := 11128536;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000066;renumberobjects."4PS Object ID" := 11128537;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000067;renumberobjects."4PS Object ID" := 11128538;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 15000100;renumberobjects."4PS Object ID" := 11128539;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 3010590;renumberobjects."4PS Object ID" := 11128040;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 10601;renumberobjects."4PS Object ID" := 11128500;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 10602;renumberobjects."4PS Object ID" := 11128501;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 10603;renumberobjects."4PS Object ID" := 11128502;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000000;renumberobjects."4PS Object ID" := 11128503;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000001;renumberobjects."4PS Object ID" := 11128504;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000002;renumberobjects."4PS Object ID" := 11128505;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000003;renumberobjects."4PS Object ID" := 11128506;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000004;renumberobjects."4PS Object ID" := 11128507;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000005;renumberobjects."4PS Object ID" := 11128508;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000006;renumberobjects."4PS Object ID" := 11128509;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000007;renumberobjects."4PS Object ID" := 11128510;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000027;renumberobjects."4PS Object ID" := 11128511;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000100;renumberobjects."4PS Object ID" := 11128512;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 15000200;renumberobjects."4PS Object ID" := 11128513;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 10604;renumberobjects."4PS Object ID" := 11128514;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 10605;renumberobjects."4PS Object ID" := 11128515;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 10606;renumberobjects."4PS Object ID" := 11128516;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 11200;renumberobjects."4PS Object ID" := 11128010;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 11201;renumberobjects."4PS Object ID" := 11128011;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 11202;renumberobjects."4PS Object ID" := 11128012;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 11203;renumberobjects."4PS Object ID" := 11128013;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 11204;renumberobjects."4PS Object ID" := 11128014;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Codeunit;renumberobjects."NAV Object ID" := 11205;renumberobjects."4PS Object ID" := 11128015;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11200;renumberobjects."4PS Object ID" := 11128010;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11202;renumberobjects."4PS Object ID" := 11128012;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11203;renumberobjects."4PS Object ID" := 11128013;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11204;renumberobjects."4PS Object ID" := 11128014;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11205;renumberobjects."4PS Object ID" := 11128015;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11206;renumberobjects."4PS Object ID" := 11128016;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11207;renumberobjects."4PS Object ID" := 11128017;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11208;renumberobjects."4PS Object ID" := 11128018;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11209;renumberobjects."4PS Object ID" := 11128019;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11210;renumberobjects."4PS Object ID" := 11128020;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11211;renumberobjects."4PS Object ID" := 11128021;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 11212;renumberobjects."4PS Object ID" := 11128022;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Page;renumberobjects."NAV Object ID" := 3010590;renumberobjects."4PS Object ID" := 11128040;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11200;renumberobjects."4PS Object ID" := 11128010;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11201;renumberobjects."4PS Object ID" := 11128011;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11203;renumberobjects."4PS Object ID" := 11128013;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11204;renumberobjects."4PS Object ID" := 11128014;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11205;renumberobjects."4PS Object ID" := 11128015;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11206;renumberobjects."4PS Object ID" := 11128016;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11207;renumberobjects."4PS Object ID" := 11128017;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11208;renumberobjects."4PS Object ID" := 11128018;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11210;renumberobjects."4PS Object ID" := 11128020;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Report;renumberobjects."NAV Object ID" := 11211;renumberobjects."4PS Object ID" := 11128021;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11200;renumberobjects."4PS Object ID" := 11128010;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11201;renumberobjects."4PS Object ID" := 11128011;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11202;renumberobjects."4PS Object ID" := 11128012;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11203;renumberobjects."4PS Object ID" := 11128013;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11204;renumberobjects."4PS Object ID" := 11128014;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11205;renumberobjects."4PS Object ID" := 11128015;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11206;renumberobjects."4PS Object ID" := 11128016;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11207;renumberobjects."4PS Object ID" := 11128017;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 11208;renumberobjects."4PS Object ID" := 11128018;IF renumberobjects.INSERT(TRUE) THEN;
      renumberobjects."Object Type" := renumberobjects."Object Type"::Table;renumberobjects."NAV Object ID" := 3010590;renumberobjects."4PS Object ID" := 11128040;IF renumberobjects.INSERT(TRUE) THEN;
    END;

    PROCEDURE renumberlocalizations@1000000001(ProjectCode@1000000002 : Code[20]);
    VAR
      oldObjNo@1000000000 : Code[100];
      newObjId@1000000001 : Code[100];
      objType@1101285000 : Code[10];
      TTNAVCaption@1101285002 : Record 77786;
    BEGIN
      SetGetDialog;
      dial.UPDATE(1,'renumberlocalizations');
      CLEAR(TTNAVCaption);
      CLEAR(TTNAVObject);
      CLEAR(renumberobjects);

      TTNAVCaption.SETRANGE("Project Code",ProjectCode);

      renumberobjects.SETFILTER("4PS Object ID",'<>0');
      renumberobjects.SETFILTER("NAV Object ID",'<>0');
      // renumberobjects.SETRANGE("NAV FieldID",0);
      // renumberobjects.SETRANGE("4PS FieldID",0);
      renumberobjects.SETFILTER("Object Type",'<>%1',renumberobjects."Object Type"::FieldNumber);
      IF renumberobjects.FINDSET THEN
      REPEAT
        CASE renumberobjects."Object Type" OF
          renumberobjects."Object Type"::Codeunit:  objType := 'C';
          renumberobjects."Object Type"::Page:      objType := 'N';
          renumberobjects."Object Type"::Report:    objType := 'R';
          renumberobjects."Object Type"::MenuSuite: objType := 'M';
          renumberobjects."Object Type"::Query:     objType := 'Q';
          renumberobjects."Object Type"::Table:     objType := 'T';
          renumberobjects."Object Type"::XMLport:   objType := 'X';
        END;
        TTNAVObject.SETFILTER(ID,objType+FORMAT(renumberobjects."NAV Object ID",0,2)+'-*');

        dial.UPDATE(2,objType+FORMAT(renumberobjects."NAV Object ID",0,2));

        IF TTNAVObject.FINDSET THEN
        REPEAT
          oldObjNo := FORMAT(TTNAVObject."Object No.",0,2);
          newObjId := objType +
            FORMAT(renumberobjects."4PS Object ID",0,2) +
            COPYSTR(TTNAVObject.ID,STRLEN(FORMAT(renumberobjects."NAV Object ID",0,2))+2);
          TTNAVObject2.GET(TTNAVObject.ID);
          TTNAVObject2.ID := newObjId;
          TTNAVObject2."Object No." := renumberobjects."4PS Object ID";

          newObjId := COPYSTR(TTNAVObject."ID Values",STRLEN(oldObjNo)+1);
          TTNAVObject2."ID Values" := FORMAT(renumberobjects."4PS Object ID",0,2)+newObjId;

          IF TTNAVObject2.INSERT(FALSE) THEN
            TTNAVObject.DELETE;
        UNTIL TTNAVObject.NEXT=0;


        TTNAVCaption.SETFILTER("Object ID",objType + FORMAT(renumberobjects."NAV Object ID",0,2)+'-*');
        IF TTNAVCaption.FINDSET THEN
        REPEAT
          //oldObjId := COPYSTR(TTNAVCaption."Object ID",1,STRLEN(renumberobjects."NAV ID"));
          newObjId := objType + FORMAT(renumberobjects."4PS Object ID",0,2) +
            COPYSTR(TTNAVCaption."Object ID",STRLEN(FORMAT(renumberobjects."NAV Object ID",0,2))+2);
          TTNAVCaption2.GET(TTNAVCaption."Project Code",TTNAVCaption."Language ID",TTNAVCaption."Object ID");
          TTNAVCaption2."Object ID" := newObjId;

          IF TTNAVCaption2.INSERT(FALSE) THEN
            TTNAVCaption.DELETE;
        UNTIL TTNAVCaption.NEXT=0;



      UNTIL renumberobjects.NEXT=0;
    END;

    LOCAL PROCEDURE readLicense@1101285004(infilename@1101285000 : Text);
    VAR
      infile@1101285001 : File;
      inradtext@1101285002 : Text;
      activeRead@1101285003 : Boolean;
      readLines@1101285004 : Integer;
      rangeFromTxt@1101285005 : Text;
      rangeToTxt@1101285006 : Text;
      objType@1101285007 : Text;
      permTxt@1101285008 : Text;
    BEGIN
      infile.TEXTMODE(TRUE);
      infile.WRITEMODE(FALSE);
      IF NOT infile.OPEN(infilename) THEN
        EXIT;

      CLEAR(TTNAVCaption1);
      CLEAR(TTNAVObject);
      TTNAVCaption1.RESET;
      TTNAVCaption1.SETRANGE("Project Code",TTNAVProject.Code);
      TTNAVCaption1.SETRANGE("Language ID",TTNAVProject."Target Language ID");
      TTNAVCaption1.SETFILTER(Tag1,'<>%1','');
      TTNAVCaption1.MODIFYALL(Tag1,'',FALSE);
      TTNAVCaption1.SETRANGE(Tag1,'');

      // infile.SEEK(0);
      REPEAT
        infile.READ(inradtext);
        readLines +=1;

        IF NOT activeRead THEN BEGIN
          activeRead := inradtext = 'Module Objects and Permissions';
          IF activeRead THEN
            readLines := 0;
        END;

        IF activeRead AND (readLines>4) THEN BEGIN
          activeRead := inradtext <> '';
          rangeFromTxt := '';
          rangeToTxt := '';
          objType := '';
          permTxt := '';

          rangeFromTxt := COPYSTR(inradtext,61,15);
          IF STRPOS(rangeFromTxt,' ') <> 0 THEN
            rangeFromTxt := COPYSTR(rangeFromTxt,1,STRPOS(rangeFromTxt,' ')-1);

          rangeToTxt := COPYSTR(inradtext,76,15);
          IF STRPOS(rangeToTxt,' ') <> 0 THEN
            rangeToTxt := COPYSTR(rangeToTxt,1,STRPOS(rangeToTxt,' ')-1);

          objType := COPYSTR(inradtext,91,20);
          IF STRPOS(objType,' ') <> 0 THEN
            objType := COPYSTR(objType,1,STRPOS(objType,' ')-1);

          permTxt := COPYSTR(inradtext,111,10);
          IF STRPOS(permTxt,' ') <> 0 THEN
            permTxt := COPYSTR(permTxt,1,STRPOS(permTxt,' ')-1);

          dial.UPDATE(1,objType+' '+rangeFromTxt+'..'+rangeToTxt);
          TTNAVObject.SETRANGE("Object Type",-1);
          CASE objType OF
            'Codeunit': TTNAVObject.SETRANGE("Object Type",TTNAVObject."Object Type"::Codeunit);
            'TableData':TTNAVObject.SETRANGE("Object Type",TTNAVObject."Object Type"::Table);
            'Report':TTNAVObject.SETRANGE("Object Type",TTNAVObject."Object Type"::Report);
            'Page':TTNAVObject.SETRANGE("Object Type",TTNAVObject."Object Type"::Page);
            'MenuSuite':TTNAVObject.SETRANGE("Object Type",TTNAVObject."Object Type"::MenuSuite);
            'XMLPort':TTNAVObject.SETRANGE("Object Type",TTNAVObject."Object Type"::XMLport);

            'TableDescription',
            'System',
            'Form',
            'Dataport':;
          END;
          IF (rangeFromTxt<>'') AND (rangeToTxt<>'') THEN BEGIN
            TTNAVObject.SETFILTER("Object No.",STRSUBSTNO('%1..%2',rangeFromTxt,rangeToTxt));
            IF TTNAVObject.FINDSET THEN REPEAT
              TTNAVCaption1.SETRANGE("Object ID",TTNAVObject.ID);
              TTNAVCaption1.MODIFYALL(Tag1,'LIC',FALSE);
            UNTIL TTNAVObject.NEXT = 0;
          END;

        END;

      UNTIL infile.POS >= infile.LEN;
    END;

    PROCEDURE sparaObjektDatumTid@1101285001();
    VAR
      NAVtranslateIDs@1101285001 : Record 72850;
      Obj@1101285000 : Record 2000000001;
      i@1101285002 : Integer;
    BEGIN
      i:= 0;
      Obj.SETFILTER(Type,'%1..',Obj.Type::Table);
      Obj.SETFILTER(Date,'<>%1',0D);

      IF Obj.FINDSET THEN REPEAT
        i += 1;
        NAVtranslateIDs.INIT;
        NAVtranslateIDs."Object Type" := Obj.Type;
        NAVtranslateIDs."NAV Object ID" := Obj.ID;
        IF NOT NAVtranslateIDs.GET(NAVtranslateIDs."Object Type",NAVtranslateIDs."NAV Object ID") THEN
          NAVtranslateIDs.INSERT;
        NAVtranslateIDs."NAV Object Date" := Obj.Date;
        NAVtranslateIDs."NAV Object Time" := Obj.Time;
        NAVtranslateIDs."NAV Object Modified" := Obj.Modified;
        NAVtranslateIDs.MODIFY;
      UNTIL Obj.NEXT=0;

      MESSAGE(STRSUBSTNO('%1 saved'),i);
    END;

    PROCEDURE "†terst„llObjektDatumTid"@1101285005();
    VAR
      NAVtranslateIDs@1101285001 : Record 72850;
      Obj@1101285000 : Record 2000000001;
      i@1101285002 : Integer;
      j@1101285003 : Integer;
    BEGIN
      NAVtranslateIDs.SETFILTER("NAV Object Date",'<>%1',0D);
      NAVtranslateIDs.SETFILTER("NAV Object Time",'<>%1',0T);
      IF NAVtranslateIDs.FINDSET THEN REPEAT
        i += 1;
        IF Obj.GET(NAVtranslateIDs."Object Type",'',NAVtranslateIDs."NAV Object ID") THEN
          IF (Obj.Date <> NAVtranslateIDs."NAV Object Date") OR (Obj.Time <> NAVtranslateIDs."NAV Object Time") THEN BEGIN
            Obj.Date := NAVtranslateIDs."NAV Object Date";
            Obj.Time := NAVtranslateIDs."NAV Object Time";
            Obj.Modified := NAVtranslateIDs."NAV Object Modified";
            Obj.MODIFY;
            j += 1;
          END;
        IF NAVtranslateIDs."4PS Object ID" = 0 THEN
          NAVtranslateIDs.DELETE
        ELSE BEGIN
          NAVtranslateIDs."NAV Object Date" := 0D;
          NAVtranslateIDs."NAV Object Time" := 0T;
          NAVtranslateIDs."NAV Object Modified" := FALSE;
          NAVtranslateIDs.MODIFY;
        END;
      UNTIL NAVtranslateIDs.NEXT=0;

      MESSAGE(STRSUBSTNO('%1 of %2 restored'),j,i);
    END;

    LOCAL PROCEDURE markeraAllaSammaSomENU@111280001();
    VAR
      ENUSWElika@111280000 : Boolean;
      ENUNORlika@111280001 : Boolean;
      hasENU@111280002 : Boolean;
    BEGIN
      TTNAVProject.SETRANGE(Active,TRUE);
      TTNAVProject.FINDLAST;

      TTNAVObject.FINDSET;
      REPEAT
        TTNAVCaption1.Caption1 := '';
        TTNAVCaption2.Caption1 := '';
        TTNAVCaption3.Caption1 := '';
        ENUSWElika := FALSE;
        ENUNORlika := ENUSWElika;

        hasENU := TTNAVCaption1.GET(TTNAVProject.Code,1033,TTNAVObject.ID);
        IF hasENU THEN
          hasENU := TTNAVCaption1.Caption1<>'';

        IF  hasENU AND TTNAVCaption2.GET(TTNAVProject.Code,1053,TTNAVObject.ID) THEN
          ENUSWElika := (TTNAVCaption1.Caption1 = TTNAVCaption2.Caption1);
        IF  hasENU AND TTNAVCaption3.GET(TTNAVProject.Code,1044,TTNAVObject.ID) THEN
          ENUNORlika := (TTNAVCaption1.Caption1 = TTNAVCaption3.Caption1);

        IF ENUNORlika AND ENUSWElika THEN BEGIN
      //    TTNAVCaption4.SETRANGE("Project Code",TTNAVCaption1."Project Code");
      //    TTNAVCaption4.SETRANGE("Object ID",TTNAVCaption1."Object ID");
      //    IF TTNAVCaption4.FINDSET THEN
      //      TTNAVCaption4.MODIFYALL(Tag2,'LIKA',FALSE);
          TTNAVCaption1.Tag2 := 'LIKA';
          TTNAVCaption1.MODIFY(FALSE);
          TTNAVCaption2.DELETE(FALSE);
          TTNAVCaption3.DELETE(FALSE);
        END;

      UNTIL TTNAVObject.NEXT=0;
    END;

    PROCEDURE getCaptionsFromThisDB@1100285100(projCode@1100285100 : Code[20]);
    VAR
      i@1100285101 : Integer;
      Obj@1100285102 : Record 2000000001;
      Field@1100285104 : Record 2000000041;
      TempTableFieldTranslation1@1100285103 : Record 11229306;
      Language@1100285109 : Record 8;
      Options@1100285108 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.ArrayList";
      Captions@1100285107 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.ArrayList";
      Counter@1100285106 : Integer;
      StringFunctions@1100285111 : Codeunit 11012273;
      FieldRef@1100285112 : FieldRef;
      RecRef@1100285113 : RecordRef;
      WindowsLanguageID@1100285110 : Integer;
    BEGIN
      i:= 0;
      Field.SETRANGE(ObsoleteState,Field.ObsoleteState::No);
      Field.SETRANGE(TableNo,1,6);
      IF Field.FINDSET THEN REPEAT
        TempTableFieldTranslation1.INIT;
        TempTableFieldTranslation1."Table No." := Field.TableNo;
        TempTableFieldTranslation1."Field No." := Field."No.";
        TempTableFieldTranslation1."Option SeqNo." := -1;

        RecRef.OPEN(Field.TableNo);
        FieldRef := RecRef.FIELD(Field."No.");
        RecRef.CLOSE;

        CLEAR(Options);
        Options := Options.ArrayList;
        Options.Add('');

        CLEAR(Captions);
        Captions := Captions.ArrayList;
        WindowsLanguageID := 1053;
        GLOBALLANGUAGE(WindowsLanguageID);
        Captions.Add(FieldRef.CAPTION);
        InsertCaption(TempTableFieldTranslation1,Field,WindowsLanguageID, Options, Captions, -1,-1);



      UNTIL Field.NEXT=0;





      Field.SETRANGE(TableNo,1,10);
      Field.SETRANGE(Type,Field.Type::Option);
      IF Field.FINDSET THEN REPEAT
        TempTableFieldTranslation1.INIT;
        TempTableFieldTranslation1."Table No." := Field.TableNo;
        TempTableFieldTranslation1."Field No." := Field."No.";
        TempTableFieldTranslation1."Option SeqNo." := -1;

        RecRef.OPEN(Field.TableNo);
        FieldRef := RecRef.FIELD(Field."No.");
        RecRef.CLOSE;
        StringFunctions.SplitString2(FieldRef.OPTIONSTRING, ',', Options);

        WindowsLanguageID := 1053;
        GLOBALLANGUAGE(WindowsLanguageID);
        CLEAR(Captions);
        StringFunctions.SplitString2(FieldRef.OPTIONCAPTION, ',', Captions);
        FOR Counter := 0 TO Options.Count - 1 DO BEGIN
          IF (NOT Options.Equals(Options.Item(Counter), '')) THEN
            InsertCaption(TempTableFieldTranslation1,Field,WindowsLanguageID, Options, Captions, Counter,Options.Count);
        END;

        WindowsLanguageID := 1033;
        GLOBALLANGUAGE(WindowsLanguageID);
        CLEAR(Captions);
        StringFunctions.SplitString2(FieldRef.OPTIONCAPTION, ',', Captions);
        FOR Counter := 0 TO Options.Count - 1 DO BEGIN
          IF (NOT Options.Equals(Options.Item(Counter), '')) THEN
            InsertCaption(TempTableFieldTranslation1,Field,WindowsLanguageID, Options, Captions, Counter,Options.Count);
        END;

        WindowsLanguageID := 1044;
        GLOBALLANGUAGE(WindowsLanguageID);
        CLEAR(Captions);
        StringFunctions.SplitString2(FieldRef.OPTIONCAPTION, ',', Captions);
        FOR Counter := 0 TO Options.Count - 1 DO BEGIN
          IF (NOT Options.Equals(Options.Item(Counter), '')) THEN
            InsertCaption(TempTableFieldTranslation1,Field,WindowsLanguageID, Options, Captions, Counter,Options.Count);
        END;

        WindowsLanguageID := 1033;
        GLOBALLANGUAGE(WindowsLanguageID);

      UNTIL Field.NEXT=0;
      // PAGE.RUN(PAGE::"Table Field Translations",TempTableFieldTranslation1);
    END;

    LOCAL PROCEDURE InsertCaption@1100528009(VAR TableFieldTranslation@1100285103 : Record 11229306;Field@1100285101 : Record 2000000041;WindowsLanguageID@1100525007 : Integer;Options@1100528002 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.ArrayList";Captions@1100528001 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.ArrayList";Counter@1100528000 : Integer;ArrLen@1100285100 : Integer);
    VAR
      TableFieldTranslationMgt@1100285102 : Codeunit 11020235;
    BEGIN
      IF ISNULL(Captions) THEN
        EXIT;
      IF (NOT TableFieldTranslation.GET(Field.TableNo, Field."No.",WindowsLanguageID, Counter)) THEN BEGIN
        TableFieldTranslation.INIT;
        TableFieldTranslation."Table No." := Field.TableNo;
        TableFieldTranslation."Field No." := Field."No.";
        TableFieldTranslation."Language Id" := WindowsLanguageID;
        TableFieldTranslation."Option SeqNo." := Counter;
        TableFieldTranslation.INSERT;
      END;
      IF (Counter >= 0) THEN BEGIN
        IF (Options.Equals(Options.Item(Counter), ' ')) THEN
          TableFieldTranslation."Option Value" := STRSUBSTNO('%1', TableFieldTranslationMgt.GetBlankOptionTxt)
        ELSE
          TableFieldTranslation."Option Value" := Options.Item(Counter);
        TableFieldTranslation.Description := Captions.Item(Counter);
      END ELSE BEGIN
        TableFieldTranslation."Option Value" := '';
        TableFieldTranslation.Description := Captions.Item(0);
      END;
      TableFieldTranslation."Option Length" := ArrLen;//4PSSE
      TableFieldTranslation.MODIFY;
    END;

    PROCEDURE FillCaptionsFromThisDB@1100285101(projCode@1100285100 : Code[20]);
    VAR
      Obj@1100285111 : Record 2000000001;
      Field@1100285110 : Record 2000000041;
      StringFunctions@1100285104 : Codeunit 11012273;
      FieldRef@1100285103 : FieldRef;
      RecRef@1100285102 : RecordRef;
      WindowsLanguageID@1100285101 : Integer;
      LastEntryNo@1100285108 : Integer;
      ObjID@1100285109 : Code[100];
      FieldRefCAPTION@1100285106 : Text;
      FieldRefOPTIONCAPTION@1100285105 : Text;
    BEGIN
      IF TTNAVCaption4.FINDLAST THEN
        LastEntryNo := TTNAVCaption4."Entry No.";
      SELECTLATESTVERSION;

      Obj.SETRANGE(Type,Obj.Type::Table);
      Obj.SETRANGE(ID,1,4);
      IF Obj.FINDSET THEN REPEAT

        RecRef.OPEN(Obj.ID);
        Field.SETRANGE(TableNo,Obj.ID);
        IF Field.FINDSET THEN REPEAT
          FieldRef := RecRef.FIELD(Field."No.");

          ObjID := 'T'+FORMAT(Field.TableNo,0,2)+'-F'+FORMAT(Field."No.",0,2);
          WindowsLanguageID := 1044;
          GLOBALLANGUAGE(WindowsLanguageID);
          FieldRefCAPTION := FieldRef.CAPTION;
          FieldRefOPTIONCAPTION := FieldRef.OPTIONCAPTION;
          SaveCaptionsFromThisDBField(projCode,WindowsLanguageID,ObjID,FieldRefCAPTION,FieldRefOPTIONCAPTION,LastEntryNo);

          WindowsLanguageID := 1053;
          GLOBALLANGUAGE(WindowsLanguageID);
          FieldRefCAPTION := FieldRef.CAPTION;
          FieldRefOPTIONCAPTION := FieldRef.OPTIONCAPTION;
          SaveCaptionsFromThisDBField(projCode,WindowsLanguageID,ObjID,FieldRefCAPTION,FieldRefOPTIONCAPTION,LastEntryNo);

          WindowsLanguageID := 1033;
          GLOBALLANGUAGE(WindowsLanguageID);
          FieldRefCAPTION := FieldRef.CAPTION;
          FieldRefOPTIONCAPTION := FieldRef.OPTIONCAPTION;
          SaveCaptionsFromThisDBField(projCode,WindowsLanguageID,ObjID,FieldRefCAPTION,FieldRefOPTIONCAPTION,LastEntryNo);

        UNTIL Field.NEXT=0;
        RecRef.CLOSE;

      UNTIL Obj.NEXT=0;
      COMMIT;
          WindowsLanguageID := 1033;
          GLOBALLANGUAGE(WindowsLanguageID);
    END;

    LOCAL PROCEDURE SaveCaptionsFromThisDBField@1100285118(projCode@1100285103 : Code[20];WindowsLanguageID@1100285100 : Integer;ObjID@1100285101 : Code[100];FieldRefCAPTION@1100285105 : Text;FieldRefOPTIONCAPTION@1100285107 : Text;VAR LastEntryNo@1100285102 : Integer);
    VAR
      lTTNAVCaption1@1100285106 : Record 77786;
      lTTNAVCaption2@1100285104 : Record 77786;
    BEGIN
      // FieldRef.NAME    // T3-F13600-P2818-L128:OIOUBL Code
      // FieldRef.CAPTION // T3-F13600-P8629-A1033-L999:OIOUBL Code
      IF NOT lTTNAVCaption1.GET(projCode,FORMAT(WindowsLanguageID,0,2),ObjID+'-P8629') THEN BEGIN
        lTTNAVCaption1.INIT;
        lTTNAVCaption1."Project Code" := projCode;
        lTTNAVCaption1."Language ID" := FORMAT(WindowsLanguageID,0,2);
        lTTNAVCaption1."Object ID" := ObjID+'-P8629';
        lTTNAVCaption1.SetCaption(FieldRefCAPTION);
        lTTNAVCaption1.Status := TTNAVCaption1.Status::Imported;
        lTTNAVCaption1."Entry No." := LastEntryNo + 1;
        IF lTTNAVCaption1.INSERT(TRUE) THEN
          LastEntryNo += 1;
      END;

      // FieldRef.OPTIONSTRING  // T3-F13600-P10340-L19: ,Contract,Specific
      // FieldRef.OPTIONCAPTION // T3-F13600-P8632-A1033-L999: ,Contract,Specific
      IF FieldRefOPTIONCAPTION='' THEN
        EXIT;
      IF NOT lTTNAVCaption2.GET(projCode,FORMAT(WindowsLanguageID,0,2),ObjID+'-P8632') THEN BEGIN
        lTTNAVCaption2.INIT;
        lTTNAVCaption2."Project Code" := projCode;
        lTTNAVCaption2."Language ID" := FORMAT(WindowsLanguageID,0,2);
        lTTNAVCaption2."Object ID" := ObjID+'-P8632';
        lTTNAVCaption2.SetCaption(FieldRefOPTIONCAPTION);
        lTTNAVCaption2.Status := TTNAVCaption1.Status::Imported;
        lTTNAVCaption2."Entry No." := LastEntryNo + 1;
        IF lTTNAVCaption2.INSERT(TRUE) THEN
          LastEntryNo += 1;
      END;
    END;

    PROCEDURE removeLockedCaptions@1100285103(projCode@1100285100 : Code[20]);
    VAR
      lTTNAVCaption1@1100285102 : Record 77786;
      lTTNAVCaption2@1100285101 : Record 77786;
      dial@1100285103 : Dialog;
      i@1100285104 : Integer;
      j@1100285105 : Integer;
    BEGIN
      TTNAVCaption1.SETRANGE("Project Code",projCode);
      TTNAVCaption1.SETRANGE("Language ID",'1');
      TTNAVCaption1.SETFILTER(Caption1,'*{Locked}*');
      i := TTNAVCaption1.COUNT;
      dial.OPEN('@1@@@@@@@@@@@@@@@@@@@@@@@@@@');
      j:=0;
      IF TTNAVCaption1.FINDSET THEN REPEAT
        j +=1;
        dial.UPDATE(1,ROUND(((j/i)*10000),1));
        TTNAVCaption2.SETRANGE("Project Code",projCode);
        TTNAVCaption2.SETRANGE("Object ID",TTNAVCaption1."Object ID");
        IF NOT TTNAVCaption2.ISEMPTY THEN
          TTNAVCaption2.DELETEALL;
      UNTIL TTNAVCaption1.NEXT=0;
      dial.CLOSE;
    END;

    BEGIN
    {

      SQLAutoTranslateOnCaption
      select ts.[Object ID],ts.Caption1,tt.Caption1,os.Caption1,ot.Caption1,ts.*, CURRENT_TIMESTAMP
      from
      [TT NAV Caption] ts
      ,[TT NAV Caption] tt
      ,[TT NAV Caption] os
      ,[TT NAV Caption] ot
      where
      ts.[Project Code] = '4PSSE2017-011' and ts.Caption1 = '' and ts.[Language ID] = 1044
      and tt.[Project Code] = ts.[Project Code] and tt.Caption1 <> '' and tt.[Language ID] = 1033 and tt.[Object ID] = ts.[Object ID]
      and os.[Project Code] = '4PSSE2013-100' and
      os.Caption1 = tt.Caption1 and
      os.Caption2 = tt.Caption2 and
      os.Caption3 = tt.Caption3 and
      os.Caption4 = tt.Caption4 and
      os.Caption5 = tt.Caption5 and
      os.Caption6 = tt.Caption6 and
      os.[Language ID] = 1033 and os.[Object ID] = ts.[Object ID]
      and os.[Project Code] = ot.[Project Code] and os.[Object ID] = ot.[Object ID] and ot.[Language ID] = 1044;
    }
    END.
  }
}

