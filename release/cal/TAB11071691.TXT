OBJECT Table 11071691 Service-Object
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=VAR
               ServiceSetup@1100528600 : Record 11012800;
             BEGIN
               ServiceSetup.GET;
               IF "No." = '' THEN BEGIN
                 ServiceSetup.TESTFIELD("Object Nos.");
                 NoSeriesMgt.InitSeries(ServiceSetup."Object Nos.", xRec."No. Series", 0D, "No.", "No. Series");
               END;
               "Input by" := USERID;
               "Input Date" := CREATEDATETIME(TODAY,TIME);

               UpdateTenderCode;
             END;

    OnModify=VAR
               BuildingObjectRelation@1100528300 : Record 11071820;
             BEGIN
               BuildingObjectRelation.SETRANGE("Object No.", "No.");
               IF (NOT BuildingObjectRelation.ISEMPTY) THEN
                 TESTFIELD("Service Location No.", '');

               "Modified by" := USERID;
               "Last date modified" := CREATEDATETIME(TODAY,TIME);
             END;

    OnDelete=VAR
               ServiceInspectionLine@1100528601 : Record 11071751;
               ObjectSpecificationLine@1100528602 : Record 11071781;
               RelatedObject@1100528603 : Record 11071704;
               BuildingObjectRelation@1100528300 : Record 11071820;
               MaintenanceSchemeVersion@1100528600 : Record 11071743;
               ObjectReplacementValue@1100528604 : Record 11128779;
               NEN2767ConditionMeasHeader@1100528605 : Record 11128776;
               ObjectConsumptionComponent@1100528800 : Record 11071969;
               PurchaseLineServiceObject@1100528801 : Record 11072194;
               ServiceObjectProperty@1100529000 : Record 11072287;
               ServiceLocStructureLine@1100525000 : Record 11071720;
             BEGIN
               TestNotInUse;

               ServiceInspectionLine.SETRANGE("Inspection Type", ServiceInspectionLine."Inspection Type"::"Object (Calls)");
               ServiceInspectionLine.SETRANGE("Service Contract No.", '');
               ServiceInspectionLine.SETRANGE(Code, "No.");
               ServiceInspectionLine.DELETEALL(TRUE);

               ObjectSpecificationLine.SETRANGE("Specification Type", ObjectSpecificationLine."Specification Type"::Object);
               ObjectSpecificationLine.SETRANGE(Code, "No.");
               ObjectSpecificationLine.DELETEALL(TRUE);

               RelatedObject.SETRANGE("Object No.", "No.");
               RelatedObject.DELETEALL(TRUE);
               RelatedObject.SETRANGE("Object No.");
               RelatedObject.SETRANGE("Related Object");
               RelatedObject.SETRANGE("Related Object", "No.");
               RelatedObject.DELETEALL(TRUE);

               BuildingObjectRelation.SETCURRENTKEY("Object No.", "Building Code");
               BuildingObjectRelation.SETRANGE("Object No.", "No.");
               BuildingObjectRelation.DELETEALL(TRUE);

               MaintenanceSchemeVersion.SETRANGE("Line Type", MaintenanceSchemeVersion."Line Type"::"Object Installation");
               MaintenanceSchemeVersion.SETRANGE(Code, "No.");
               MaintenanceSchemeVersion.DELETEALL(TRUE);

               ObjectReplacementValue.SETRANGE("Service Object No.", "No.");
               IF NOT ObjectReplacementValue.ISEMPTY THEN
                 ObjectReplacementValue.DELETEALL(TRUE);

               NEN2767ConditionMeasHeader.SETRANGE("Service Object No.", "No.");
               IF NOT NEN2767ConditionMeasHeader.ISEMPTY THEN
                 NEN2767ConditionMeasHeader.DELETEALL(TRUE);

               ObjectConsumptionComponent.SETRANGE("Object No.", "No.");
               ObjectConsumptionComponent.DELETEALL(TRUE);

               PurchaseLineServiceObject.SETRANGE("Service Object No.", "No.");
               IF PurchaseLineServiceObject.FINDSET THEN
                 REPEAT
                   PurchaseLineServiceObject.ServiceObjectDeleted;
                 UNTIL PurchaseLineServiceObject.NEXT = 0;

               ServiceObjectProperty.SETRANGE("Service Object No.", "No.");
               ServiceObjectProperty.DELETEALL;

               ServiceLocStructureLine.SETRANGE("Service Object No.", "No.");
               ServiceLocStructureLine.SETRANGE("Object Line", TRUE);
               ServiceLocStructureLine.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Object;
               NOR=Objekt;
               SVE=Objekt];
    LookupPageID=Page11125145;
    DrillDownPageID=Page11125145;
  }
  FIELDS
  {
    { 10  ;   ;No.                 ;Code20        ;OnValidate=VAR
                                                                ServiceSetup@1100528600 : Record 11012800;
                                                              BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  ServiceSetup.GET;
                                                                  NoSeriesMgt.TestManual(ServiceSetup."Object Nos."); //mg.c, 15-12-10: M24121
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr;
                                                              SVE=Nr] }
    { 20  ;   ;Standard Object No. ;Code20        ;TableRelation="Standard Object".No. WHERE (Expired=CONST(No));
                                                   OnValidate=VAR
                                                                StandardObject@1100525000 : Record 11020334;
                                                              BEGIN
                                                                IF StandardObject.GET("Standard Object No.") THEN BEGIN
                                                                  "Warranty Code Customer" := StandardObject."Warranty Code";
                                                                  IF ((Description <> '') AND (Description <> StandardObject.Description)) OR
                                                                     (("Description 2" <> '') AND ("Description 2" <> StandardObject."Description 2"))
                                                                  THEN BEGIN
                                                                    IF CONFIRM(Text000, TRUE, StandardObject.Description, StandardObject."Description 2") THEN BEGIN
                                                                      VALIDATE(Description, StandardObject.Description);
                                                                      VALIDATE("Description 2", StandardObject."Description 2");
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    VALIDATE(Description, StandardObject.Description);
                                                                    VALIDATE("Description 2", StandardObject."Description 2");
                                                                  END;
                                                                  "NEN2767 Element Code" := StandardObject."NEN2767 Element Code";
                                                                  Subcontracting := StandardObject.Subcontracting;
                                                                  VALIDATE("Brand Code", StandardObject."Brand Code");
                                                                  VALIDATE("Model Code", StandardObject."Model Code");
                                                                  VALIDATE("Type Code", StandardObject."Type Code");
                                                                  VALIDATE("Hide in Service Portal", StandardObject."Hide in Service Portal"); //klaasz.n, SPT
                                                                  VALIDATE("Item No.", StandardObject."Item No.");
                                                                  VALIDATE("Quantity Based on", StandardObject."Quantity Based on");
                                                                END;
                                                                UpdateTenderCode;
                                                                CopyObjectLevelSpecs;
                                                                IF xRec."Standard Object No." <> "Standard Object No." THEN BEGIN
                                                                  UpdateContractObjects;
                                                                  ApplySMAgreements;
                                                                  CopyObjectMaterialInventory;
                                                                END;

                                                                CALCFIELDS("Standard Object Checklist URL"); //C035078.n
                                                              END;

                                                   OnLookup=VAR
                                                              ServiceObjectManagement@1100528600 : Codeunit 11012808;
                                                            BEGIN
                                                              IF ServiceObjectManagement.HandleLookupStandardObject('', FALSE, "Standard Object No.") THEN
                                                                VALIDATE("Standard Object No.");
                                                            END;

                                                   CaptionML=[ENU=Standard Object No.;
                                                              NOR=Standardobjektnr;
                                                              SVE=Standardobjektsnr] }
    { 30  ;   ;Object Customer     ;Code20        ;CaptionML=[ENU=Object Customer;
                                                              NOR=Objektkunde;
                                                              SVE=Objektkund] }
    { 35  ;   ;Brand Code          ;Code20        ;TableRelation="Service Object Brand";
                                                   OnValidate=BEGIN
                                                                IF xRec."Brand Code" <> "Brand Code" THEN
                                                                  VALIDATE("Model Code", '');
                                                                CALCFIELDS("Brand Description");
                                                              END;

                                                   CaptionML=[ENU=Brand;
                                                              NOR=Varemerke;
                                                              SVE=MÑrke] }
    { 40  ;   ;Brand Description   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Object Brand".Description WHERE (Code=FIELD(Brand Code)));
                                                   CaptionML=[ENU=Brand Description;
                                                              SVE=MÑrke];
                                                   Editable=No }
    { 45  ;   ;Type Code           ;Code20        ;TableRelation="Service Object Type".Code WHERE (Brand Code=FIELD(Brand Code),
                                                                                                   Model Code=FIELD(Model Code));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Type Description");
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NOR=Radtype;
                                                              SVE=Radtyp] }
    { 50  ;   ;Type Description    ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Object Type".Description WHERE (Brand Code=FIELD(Brand Code),
                                                                                                               Model Code=FIELD(Model Code),
                                                                                                               Code=FIELD(Type Code)));
                                                   CaptionML=[ENU=Type Description;
                                                              NOR=Typebeskrivelse;
                                                              SVE=Radtypbeskrivning];
                                                   Editable=No }
    { 55  ;   ;Model Code          ;Code20        ;TableRelation="Service Object Model".Code WHERE (Brand Code=FIELD(Brand Code));
                                                   OnValidate=BEGIN
                                                                IF xRec."Model Code" <> "Model Code" THEN
                                                                  VALIDATE("Type Code", '');
                                                                CALCFIELDS("Model Description");
                                                              END;

                                                   CaptionML=[ENU=Model;
                                                              NOR=Modell;
                                                              SVE=Modell] }
    { 60  ;   ;Model Description   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Object Model".Description WHERE (Brand Code=FIELD(Brand Code),
                                                                                                                Code=FIELD(Model Code)));
                                                   CaptionML=[ENU=Model Description;
                                                              NOR=Modellbeskrivelse;
                                                              SVE=Modell];
                                                   Editable=No }
    { 70  ;   ;Description         ;Text100       ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 75  ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2;
                                                              SVE=Beskrivning 2] }
    { 100 ;   ;Standard Object Description;Text100;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object".Description WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=[ENU=Standard Object Description;
                                                              NOR=Standard objektsbeskrivelse;
                                                              SVE=Standardobjektsbeskrivning];
                                                   Editable=No }
    { 110 ;   ;Standard Object Description 2;Text50;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Description 2" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=[ENU=Standard Object Description 2;
                                                              SVE=Standardobjektsbeskrivning 2];
                                                   Editable=No }
    { 120 ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 130 ;   ;Service Location No.;Code20        ;TableRelation="Service Location";
                                                   OnValidate=VAR
                                                                RelatedObject@1100526200 : Record 11071704;
                                                                ContractObject@1100528601 : Record 11071702;
                                                              BEGIN
                                                                //mg, 21-01-11
                                                                IF xRec."Service Location No." <> "Service Location No." THEN BEGIN
                                                                  RelatedObject.SETRANGE("Object No.", "No.");
                                                                  RelatedObject.DELETEALL;

                                                                  RelatedObject.SETCURRENTKEY("Related Object");
                                                                  RelatedObject.SETRANGE("Object No.");
                                                                  RelatedObject.SETRANGE("Related Object", "No.");
                                                                  RelatedObject.DELETEALL;

                                                                  CALCFIELDS("Location Description", "Location Address", "Location Address 2", "Location City", "Location Contact Name",
                                                                    "Location Post Code", "Location Country/Region Code");

                                                                  ContractObject.SETCURRENTKEY("Service Object No.");
                                                                  ContractObject.SETRANGE("Service Object No.", "No.");
                                                                  IF ContractObject.FINDSET THEN
                                                                    REPEAT
                                                                      ContractObject.VALIDATE("Service Location No.", "Service Location No.");
                                                                      ContractObject.MODIFY;
                                                                    UNTIL ContractObject.NEXT = 0;
                                                                END;
                                                                IF "Service Location No." <> '' THEN
                                                                  TestNotInBuilding;
                                                                IF ("Service Location No." = '') AND ("IFC Object ID" <> '') THEN
                                                                  "IFC Object ID" := '';
                                                              END;

                                                   OnLookup=VAR
                                                              ServiceLocation@1210190000 : Record 11012801;
                                                            BEGIN
                                                              IF ServiceLocation.GET("Service Location No.") THEN;
                                                              IF PAGE.RUNMODAL(0, ServiceLocation) = ACTION::LookupOK THEN
                                                                VALIDATE("Service Location No.", ServiceLocation."No.");
                                                            END;

                                                   CaptionML=[ENU=Service Location No.;
                                                              NOR=Servicelokasjon Nr.;
                                                              SVE=Serviceplatsnr] }
    { 140 ;   ;In use since        ;Date          ;CaptionML=[ENU=In use since;
                                                              NOR=I bruk siden;
                                                              SVE=AnvÑnds sedan] }
    { 150 ;   ;Warranty Starting Date Cust.;Date  ;CaptionML=[ENU=Warranty Starting Date Customer;
                                                              SVE=Kunds startdatum fîr garanti] }
    { 180 ;   ;Warranty Code Customer;Code10      ;TableRelation="Service Warranty";
                                                   CaptionML=[ENU=Warranty Code Customer;
                                                              NOR=Garantikode kunde;
                                                              SVE=Grantikod kund] }
    { 190 ;   ;Warranty Description (Cust.);Text30;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Warranty".Description WHERE (Code=FIELD(Warranty Code Customer)));
                                                   CaptionML=[ENU=Warranty Description (Customer);
                                                              SVE=Grantibeskrivning];
                                                   Editable=No }
    { 200 ;   ;Modified by         ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Modified by;
                                                              NOR=Endret av;
                                                              SVE=éndrad av];
                                                   Editable=No }
    { 210 ;   ;Last date modified  ;DateTime      ;CaptionML=[ENU=Last date modified;
                                                              NOR=Sist dato endret;
                                                              SVE=Uppdateringsdatum];
                                                   Editable=No }
    { 220 ;   ;Input by            ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Input by;
                                                              NOR=Input av;
                                                              SVE=Inmatat av];
                                                   Editable=No }
    { 230 ;   ;Input Date          ;DateTime      ;CaptionML=[ENU=Input Date;
                                                              NOR=Input Dato;
                                                              SVE=Inmatat den];
                                                   Editable=No }
    { 240 ;   ;Preferred Employee OBS;Code20      ;TableRelation="Resource (WOP)" WHERE (Type=CONST(Employee));
                                                   CaptionML=ENU=Preferred Employee OBSOLETE;
                                                   Description=OBSOLETE;
                                                   Editable=No }
    { 260 ;   ;Building            ;Text30        ;CaptionML=[ENU=Building;
                                                              NOR=Byggning;
                                                              SVE=Byggnad] }
    { 270 ;   ;Floor               ;Text30        ;CaptionML=[ENU=Floor;
                                                              NOR=Gulv;
                                                              SVE=VÜning] }
    { 280 ;   ;Room                ;Text30        ;CaptionML=[ENU=Room;
                                                              NOR=Rom;
                                                              SVE=Rum] }
    { 290 ;   ;Customer Feature    ;Text30        ;CaptionML=[ENU=Customer Feature;
                                                              NOR=Kundefunksjon;
                                                              SVE=Kundfunktion] }
    { 300 ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(ServObject),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Kommentar;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 310 ;   ;Text                ;Text250       ;CaptionML=[ENU=Text;
                                                              NOR=Text;
                                                              SVE=BenÑmning] }
    { 320 ;   ;Replace from        ;Date          ;CaptionML=[ENU=Replace from;
                                                              NOR=Erstatt fra;
                                                              SVE=ErsÑtt frÜn] }
    { 330 ;   ;Replace with Standard Object;Code20;TableRelation="Standard Object".No.;
                                                   CaptionML=[ENU=Replace with Standard Object;
                                                              NOR=Erstatt med standardobjekt;
                                                              SVE=ErsÑtt med standardobjekt] }
    { 340 ;   ;System-Created Replacement;Boolean ;CaptionML=[ENU=System-Created Replacement;
                                                              NOR=Systemopprettet erstatning;
                                                              SVE=Systemskapad ersÑttning] }
    { 350 ;   ;Replaced by         ;Code20        ;TableRelation=Service-Object.No.;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("System-Created Replacement", FALSE);
                                                              END;

                                                   CaptionML=[ENU=Replaced by;
                                                              NOR=Erstattet av;
                                                              SVE=Ersatt av] }
    { 360 ;   ;Replaces            ;Code20        ;TableRelation=Service-Object.No.;
                                                   CaptionML=[ENU=Replaces;
                                                              NOR=Erstatter;
                                                              SVE=ErsÑtter] }
    { 370 ;   ;Location Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Location".Description WHERE (No.=FIELD(Service Location No.)));
                                                   CaptionML=[ENU=Locatie Description;
                                                              NOR=Lokasjonsbeskrivelse;
                                                              SVE=Beskrivning av lagerstÑlle];
                                                   Editable=No }
    { 380 ;   ;Location Address    ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Location".Address WHERE (No.=FIELD(Service Location No.)));
                                                   CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress];
                                                   Editable=No }
    { 390 ;   ;Location Address 2  ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Location"."Address 2" WHERE (No.=FIELD(Service Location No.)));
                                                   CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2;
                                                              SVE=Adress 2];
                                                   Editable=No }
    { 400 ;   ;Location City       ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Location".City WHERE (No.=FIELD(Service Location No.)));
                                                   CaptionML=[ENU=City;
                                                              NOR=Poststed;
                                                              SVE=Ort];
                                                   Editable=No }
    { 410 ;   ;Location Contact Name;Text100      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Location"."Contact Name" WHERE (No.=FIELD(Service Location No.)));
                                                   CaptionML=[ENU=Contact Name;
                                                              NOR=Kontaktnavn;
                                                              SVE=Kontaktnamn];
                                                   Editable=No }
    { 420 ;   ;Location Post Code  ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Location"."Post Code" WHERE (No.=FIELD(Service Location No.)));
                                                   TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr;
                                                              SVE=Postnr];
                                                   Editable=No }
    { 430 ;   ;Location Country/Region Code;Code10;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Location"."Country/Region Code" WHERE (No.=FIELD(Service Location No.)));
                                                   TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode;
                                                              SVE=Lands-/regionkod];
                                                   Editable=No }
    { 440 ;   ;Tender Code System 1;Code10        ;TableRelation="Coding System"."Coding System";
                                                   OnValidate=BEGIN
                                                                IF "Tender Code System 1" <> xRec."Tender Code System 1" THEN
                                                                  "Tender Code 1" := '';
                                                              END;

                                                   CaptionML=[ENU=Tender Code System 1;
                                                              NOR=Tilbudskodesystem 1;
                                                              SVE=Standardandbudkodsystem];
                                                   Editable=No }
    { 450 ;   ;Tender Code 1       ;Code20        ;TableRelation="Code per Coding System".Code WHERE (Coding System=FIELD(Tender Code System 1));
                                                   CaptionML=[ENU=Tender Code 1;
                                                              NOR=Tilbudskode 1;
                                                              SVE=Anbudskod] }
    { 460 ;   ;Discipline          ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object".Discipline WHERE (No.=FIELD(Standard Object No.)));
                                                   TableRelation=Discipline;
                                                   CaptionML=[ENU=Discipline;
                                                              NOR=Disiplin;
                                                              SVE=Disciplin];
                                                   Editable=No }
    { 470 ;   ;Trade Speciality    ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Trade Speciality" WHERE (No.=FIELD(Standard Object No.)));
                                                   TableRelation="Trade Speciality".Code WHERE (Discipline=FIELD(Discipline));
                                                   CaptionML=[ENU=Trade Speciality;
                                                              NOR=SNI-nummer;
                                                              SVE=SNI-nummer];
                                                   Editable=No }
    { 480 ;   ;Year of Manufacture ;Integer       ;CaptionML=[ENU=Year of Manufacture;
                                                              NOR=ProduksjonsÜr;
                                                              SVE=TillverkningsÜr] }
    { 490 ;   ;Company Name        ;Text30        ;TableRelation=Company;
                                                   OnValidate=VAR
                                                                Company@1100528600 : Record 2000000006;
                                                              BEGIN
                                                                VALIDATE("Project No.");
                                                                IF "Company Name" = COMPANYNAME THEN
                                                                  "Company Name" := '';
                                                                IF "Company Name" <> '' THEN
                                                                  Company.GET("Company Name");
                                                              END;

                                                   CaptionML=[ENU=Company Name;
                                                              NOR=Navn pÜ selskap;
                                                              SVE=Fîretagsnamn] }
    { 500 ;   ;Project No.         ;Code20        ;TableRelation=IF (Company Name=CONST()) Job;
                                                   OnValidate=VAR
                                                                Job@1100528600 : Record 11072003;
                                                              BEGIN
                                                                IF "Project No." = '' THEN BEGIN
                                                                  "Plot No." := '';
                                                                  EXIT;
                                                                END;

                                                                IF "Company Name" = '' THEN
                                                                  Job.CHANGECOMPANY(COMPANYNAME)
                                                                ELSE
                                                                  Job.CHANGECOMPANY("Company Name");
                                                                Job.GET("Project No.");
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 510 ;   ;Plot No.            ;Code10        ;TableRelation=IF (Company Name=CONST()) Plot."Plot No." WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=VAR
                                                                Plot@1100528600 : Record 11012500;
                                                              BEGIN
                                                                IF "Plot No." = '' THEN
                                                                  EXIT;
                                                                TESTFIELD("Project No.");
                                                                IF "Company Name" = '' THEN
                                                                  Plot.CHANGECOMPANY(COMPANYNAME)
                                                                ELSE
                                                                  Plot.CHANGECOMPANY("Company Name");
                                                                Plot.GET("Project No.", "Plot No.");
                                                              END;

                                                   CaptionML=[ENU=Plot No.;
                                                              NOR=Tegningnr;
                                                              SVE=Ritningnr] }
    { 520 ;   ;Quantity            ;Integer       ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                IF Quantity <> 0 THEN
                                                                  TESTFIELD("Quantity Based on", "Quantity Based on"::"Service Object");
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall;
                                                              SVE=Antal];
                                                   MinValue=1 }
    { 530 ;   ;Blocked             ;Boolean       ;OnValidate=BEGIN
                                                                IF Blocked THEN
                                                                  UpdateContractObjectBlocked();
                                                              END;

                                                   CaptionML=[ENU=Blocked;
                                                              NOR=Sperret;
                                                              SVE=SpÑrrad] }
    { 540 ;No ;Reserved msquared   ;Code20        ;CaptionML=[ENU=Reserved;
                                                              NOR=Reservert;
                                                              SVE=Reserverat] }
    { 550 ;   ;Tender Code System 2;Code10        ;TableRelation="Coding System"."Coding System";
                                                   OnValidate=BEGIN
                                                                IF "Tender Code System 2" <> xRec."Tender Code System 2" THEN
                                                                  "Tender Code 2" := '';
                                                              END;

                                                   CaptionML=[ENU=Tender Code System 2;
                                                              NOR=Tilbudskodesystem 2;
                                                              SVE=Anbudskodsystem 2];
                                                   Editable=No }
    { 560 ;   ;Tender Code 2       ;Code20        ;TableRelation="Code per Coding System".Code WHERE (Coding System=FIELD(Tender Code System 2));
                                                   CaptionML=[ENU=Tender Code 2;
                                                              NOR=Tilbudskode 2;
                                                              SVE=Anbudskod 2] }
    { 620 ;   ;Yard No. (AYNO)     ;Code20        ;CaptionML=[ENU=Yard No. (AYNO);
                                                              NOR=Verksted nr. (AYNO);
                                                              SVE=Varvnr (AYNO)];
                                                   Editable=No }
    { 630 ;   ;Entity Type (AYNO)  ;Option        ;CaptionML=[ENU=Entity Type (AYNO);
                                                              NOR=Enhetstype (AYNO);
                                                              SVE=Enhetstyp (AYNO)];
                                                   OptionCaptionML=[ENU=None,Cable,Device,Extra Need,,,,,,Position;
                                                                    SVE=Ingen,Kabel,Anordning,Extra behov,,,,,,Position];
                                                   OptionString=None,Cable,Device,ExtraNeed,,,,,,Position;
                                                   Editable=No }
    { 635 ;   ;System No. (AYNO)   ;Code20        ;CaptionML=[ENU=System No. (AYNO);
                                                              NOR=System nr. (AYNO);
                                                              SVE=Systemnr (AYNO)];
                                                   Editable=No }
    { 640 ;   ;Entity No. (AYNO)   ;Code20        ;CaptionML=[ENU=Entity No. (AYNO);
                                                              NOR=Enhet nr. (AYNO);
                                                              SVE=Enhetsnr (AYNO)];
                                                   Editable=No }
    { 650 ;   ;Warranty Starting Date Vendor;Date ;CaptionML=[ENU=Warranty Starting Date Vendor;
                                                              SVE=Leverantîrs startdatum fîr garanti] }
    { 660 ;   ;Warranty Code Vendor;Code10        ;TableRelation="Service Warranty";
                                                   CaptionML=[ENU=Warranty Code Vendor;
                                                              NOR=Garantikode leverandõr;
                                                              SVE=Grantikod leveranîr] }
    { 670 ;   ;Warranty Exp. Date Vendor;Date     ;CaptionML=[ENU=Warranty Expiration Date Vendor;
                                                              SVE=Leverantîrs slutdatum fîr garanti] }
    { 680 ;   ;Warranty Exp. Date Customer;Date   ;CaptionML=[ENU=Warranty Expiration Date Customer;
                                                              SVE=Kunds slutdatum fîr garanti] }
    { 690 ;   ;NEN2767 Element Code;Code20        ;TableRelation="NEN2767 Element".No.;
                                                   OnValidate=VAR
                                                                NEN2767LTMPSetup@1100528601 : Record 11128772;
                                                                NEN2767Element@1100528600 : Record 11128770;
                                                              BEGIN
                                                                IF "NEN2767 Element Code" <> '' THEN BEGIN
                                                                  NEN2767Management.TestNEN2767Licensed;
                                                                  NEN2767LTMPSetup.GET;
                                                                  NEN2767LTMPSetup.TESTFIELD("Default Version Code");
                                                                  NEN2767Element.GET(NEN2767LTMPSetup."Default Version Code", "NEN2767 Element Code");
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              NEN2767LTMPSetup@1100528601 : Record 11128772;
                                                              NEN2767Element@1100528600 : Record 11128770;
                                                            BEGIN
                                                              NEN2767LTMPSetup.GET;
                                                              NEN2767LTMPSetup.TESTFIELD("Default Version Code");
                                                              NEN2767Element.SETRANGE("Version Code", NEN2767LTMPSetup."Default Version Code");
                                                              IF "NEN2767 Element Code" <> '' THEN BEGIN
                                                                NEN2767Element.SETRANGE("No.", "NEN2767 Element Code");
                                                                IF NEN2767Element.FINDFIRST THEN
                                                                NEN2767Element.SETRANGE("No.");
                                                              END;
                                                              IF PAGE.RUNMODAL(0, NEN2767Element) = ACTION::LookupOK THEN
                                                                VALIDATE("NEN2767 Element Code", NEN2767Element."No.");
                                                            END;

                                                   CaptionML=[ENU=NEN2767 Element;
                                                              NOR=NEN2767-element;
                                                              SVE=NEN2767 Element] }
    { 700 ;   ;Condition Meas. Method OLD;Option  ;OnValidate=BEGIN
                                                                NEN2767Management.TestNEN2767Licensed;
                                                              END;

                                                   CaptionML=ENU=Condition Measurement Method OLD;
                                                   OptionCaptionML=[ENU=Scale,Repair Cost;
                                                                    NOR=Skala,Reparasjonskost;
                                                                    SVE=Skala,Reperationskostnad];
                                                   OptionString=Scale,Repair Cost;
                                                   Description=OLD }
    { 710 ;   ;Desired Condition Score;Option     ;OnValidate=BEGIN
                                                                IF "Desired Condition Score" <> "Desired Condition Score"::" " THEN
                                                                  NEN2767Management.TestNEN2767Licensed;
                                                              END;

                                                   CaptionML=[ENU=Desired Condition Score;
                                                              NOR=ùnsket tilstandspoengsum;
                                                              SVE=ônskat tillstÜndspoÑng];
                                                   OptionCaptionML=[ENU=" ,1,2,3,4,5,6";
                                                                    NOR=" ,1,2,3,4,5,6";
                                                                    SVE=" ,1,2,3,4,5,6"];
                                                   OptionString=[ ,1,2,3,4,5,6] }
    { 720 ;   ;Measure Quantity    ;Decimal       ;CaptionML=[ENU=Measure Quantity;
                                                              NOR=MÜlingsantall;
                                                              SVE=MÑtvÑrde, antal] }
    { 730 ;   ;Unit Of Measure     ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Unit Of Measure;
                                                              NOR=Enhet;
                                                              SVE=Enhet] }
    { 740 ;   ;Bill-to Vendor No.  ;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Bill-to Vendor No.;
                                                              NOR=Fakturer til-leverandõrnr.;
                                                              SVE=Faktureras leverantîrsnr.] }
    { 750 ;   ;Picture             ;BLOB          ;CaptionML=[ENU=Picture;
                                                              NOR=Bilde;
                                                              SVE=Bild];
                                                   SubType=Bitmap }
    { 760 ;   ;Subcontracting      ;Boolean       ;CaptionML=[ENU=Subcontracting;
                                                              NOR=Underentrepenõr;
                                                              SVE=Underentreprenad] }
    { 770 ;   ;Object Group        ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Object Group" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=[ENU=Object Group;
                                                              NOR=Objektgruppe;
                                                              SVE=Objektgrupp];
                                                   Editable=No }
    { 780 ;   ;Status              ;Code10        ;TableRelation="Service Object Status";
                                                   OnValidate=VAR
                                                                ServiceObjectStatus@1100525000 : Record 11071980;
                                                                IoTManagement@1100528800 : Codeunit 11130041;
                                                                InstallationManagement@1100528601 : Codeunit 11012268;
                                                                IoTAction@1100528801 : ' ,,,,Call,,,,ServiceObjectStatus';
                                                              BEGIN
                                                                IF ServiceObjectStatus.GET(Status) THEN
                                                                  IF Blocked <> ServiceObjectStatus.Block THEN
                                                                    VALIDATE(Blocked, ServiceObjectStatus.Block);

                                                                IF Status <> xRec.Status THEN
                                                                  IF InstallationManagement.LicensePermissionForCodeUnit(CODEUNIT::"IoT Management") THEN
                                                                    IoTManagement.CloseCorrespondingIoTActionLogEntries(IoTAction::ServiceObjectStatus, "No.", '');
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status] }
    { 790 ;   ;Ending Date         ;Date          ;OnValidate=VAR
                                                                ContractObject@1100528600 : Record 11071702;
                                                              BEGIN
                                                                IF "Ending Date" <> 0D THEN BEGIN
                                                                  ContractObject.SETCURRENTKEY("Service Object No.");
                                                                  ContractObject.SETRANGE("Service Object No.", "No.");
                                                                  ContractObject.SETFILTER("Ending Date", '%1|>%2', 0D, "Ending Date");
                                                                  IF ContractObject.FINDSET THEN
                                                                    REPEAT
                                                                      ContractObject.VALIDATE("Ending Date", "Ending Date");
                                                                      ContractObject.MODIFY(TRUE);
                                                                    UNTIL ContractObject.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato;
                                                              SVE=Slutdatum] }
    { 820 ;   ;Fixed Asset No.     ;Code20        ;TableRelation="Fixed Asset";
                                                   OnValidate=VAR
                                                                FA@1100529000 : Record 5600;
                                                                ServiceSetup@1100529001 : Record 11012800;
                                                              BEGIN
                                                                IF "Fixed Asset No." <> '' THEN BEGIN
                                                                  ServiceSetup.GET;
                                                                  ServiceSetup.TESTFIELD("Activation Cost");
                                                                  FA.CheckLinkServObjectAllowed("Fixed Asset No.", "No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Fixed Asset No.;
                                                              SVE=AnlÑggningstillgÜngsnr] }
    { 840 ;   ;Hide in Service Portal;Boolean     ;CaptionML=[ENU=Hide in Portal;
                                                              SVE=Dîlj i serviceportal] }
    { 850 ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[ENU=Vendor No.;
                                                              NOR=Leverandõrnr.;
                                                              SVE=Lev.nr] }
    { 860 ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.;
                                                              SVE=Artikelnr];
                                                   Editable=No }
    { 880 ;   ;BIM Model No.       ;Code20        ;TableRelation="BIM Model";
                                                   CaptionML=[ENU=BIM Model No.;
                                                              SVE=BIM-modellnr.];
                                                   Editable=No }
    { 890 ;   ;IFC Object ID       ;Text30        ;CaptionML=[ENU=IFC Object ID;
                                                              SVE=IFC-objekt-ID];
                                                   Editable=No }
    { 900 ;   ;Latitude            ;Code30        ;OnValidate=BEGIN
                                                                ValidateGPSCoordinate(Latitude);
                                                              END;

                                                   CaptionML=[ENU=Latitude;
                                                              NOR=Breddegrad;
                                                              SVE=Latitude];
                                                   CharAllowed=09.. }
    { 910 ;   ;Longitude           ;Code30        ;OnValidate=BEGIN
                                                                ValidateGPSCoordinate(Longitude);
                                                              END;

                                                   CaptionML=[ENU=Longitude;
                                                              NOR=Lengdegrad;
                                                              SVE=Longitude];
                                                   CharAllowed=09.. }
    { 920 ;   ;Quantity Based on   ;Option        ;OnValidate=BEGIN
                                                                CASE "Quantity Based on" OF
                                                                  "Quantity Based on"::"Service Object":
                                                                    Quantity := 1;
                                                                  "Quantity Based on"::"Contract Object":
                                                                    Quantity := 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Quantity Based on;
                                                              SVE=Antal baserat pÜ];
                                                   OptionCaptionML=ENU=Service Object,Contract Object;
                                                   OptionString=Service Object,Contract Object }
    { 930 ;   ;Standard Object Checklist URL;Text250;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Checklist URL" WHERE (No.=FIELD(Standard Object No.)));
                                                   ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Checklist URL;
                                                              NOR=Sjekkliste for URL;
                                                              SVE=Kontrollista fîr URL];
                                                   Description=C035078;
                                                   Editable=No }
    { 940 ;   ;Phase               ;Text30        ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Phase;
                                                              SVE=Fas] }
    { 950 ;   ;Actual Reference Point;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Document Reference Point"."Reference Point" WHERE (Type=CONST(ServObject),
                                                                                                                          Document No.=FIELD(No.),
                                                                                                                          Actual=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Reference Point;
                                                              SVE=Verklig referenspunkt];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 960 ;   ;Dsp Origin          ;Option        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=DSP Origin;
                                                   OptionCaptionML=ENU=" ,MA,DSP,Manual";
                                                   OptionString=[ ,LIP,DSP,Manual];
                                                   Editable=No }
    { 970 ;   ;Dsp Version No.     ;Text10        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=DSP Version No.;
                                                   Editable=No }
    { 980 ;   ;Dsp Operator        ;Text50        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=DSP Operator;
                                                   Editable=No }
    { 990 ;   ;Dsp Discipline      ;Option        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=DSP Discipline;
                                                   OptionCaptionML=ENU=" ,Gas,Electra,Water,CAI,Copper,Glass";
                                                   OptionString=[ ,Gas,Electra,Water,CAI,Copper,Glass];
                                                   Editable=No }
    { 1000;   ;Dsp Cluster Id      ;Text50        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=DSP Cluster ID;
                                                   Editable=No }
    { 1010;   ;Dsp Connection Object Id;Text50    ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=DSP Connection Object ID;
                                                   Editable=No }
    { 1020;   ;Dsp Assignment Id   ;Text50        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=DSP Assignment Id;
                                                   Editable=No }
    { 1050;   ;IFC Object ID As Hex;Text60        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=IFC Object ID As Hex;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Service Location No.                     }
    {    ;Project No.,Yard No. (AYNO),Entity Type (AYNO),System No. (AYNO),Entity No. (AYNO) }
    {    ;Standard Object No.                      }
    {    ;Fixed Asset No.                          }
    {    ;Item No.                                 }
    {    ;BIM Model No.,IFC Object ID              }
    {    ;BIM Model No.,IFC Object ID As Hex       }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      NoSeriesMgt@1100525001 : Codeunit 396;
      Text000@1100528600 : TextConst 'ENU=Replace existing description by %1/%2?;SVE=ErsÑtt befintlig beskrivning med %1/%2';
      Text001@1100528601 : TextConst 'ENU=Object %1 is linked to Service Contract %2, removal not allowed;NOR=Objekt %1 er linket til Servicekontrakt %2, fjerning er ikke tillatt.;SVE=Objektet %1 Ñr kopplat till servicekontrakt %2, borttagning Ñr inte tillÜten';
      Text002@1100528602 : TextConst 'ENU=The Object Will Be Disabled Within Contracts, Continue?;NOR=Objektet vil bli deaktivert innen kontrakter. Fortsette?;SVE=Objektet kommer att inaktiveras inom kontrakten, fortsÑtta?';
      Text003@1100528300 : TextConst 'ENU=Object %1 related to one or more buildings.;NOR=Objekt %1 er relatert til en eller flere bygg.;SVE=Objekt %1 avser en eller flera byggnader.';
      Text004@1100528301 : TextConst 'ENU=No Preferred Building defined in %1 with object %2;NOR=Ingen foretrukket bygning definert i %1 med objekt %2;SVE=Ingen înskad byggnad definierad i %1 med objekt %2';
      Text005@1100528603 : TextConst 'ENU=No Service Location(s) selected with Building 51;NOR=Ingen servicelokasjon(er) valgt med byggning 51;SVE=Antal serviceplats(er) valda med byggnad 51';
      Text006@1100528604 : TextConst 'ENU=Object %1 is used in table %2. Removal not allowed.;NOR=Objekt %1 er brukt i tabell %2. Fjerning er ikke tillatt.;SVE=Objekt %1 anvÑnds i tabell %2. Borttagning Ñr inte tillÜten.';
      NEN2767Management@1100528605 : Codeunit 11012863;
      Text007@1100528606 : TextConst 'ENU=Max. No. of Images already reached;SVE=Max antal bilder har nÜtts';

    PROCEDURE AssistEdit@2(OldObject@1000 : Record 11071691) : Boolean;
    VAR
      ObjectRec@1001 : Record 11071691;
      ServiceSetup@1100528600 : Record 11012800;
    BEGIN
      WITH ObjectRec DO BEGIN
        ObjectRec := Rec;
        ServiceSetup.GET;
        ServiceSetup.TESTFIELD("Object Nos."); //mg.c, 15-12-10: M24121
        IF NoSeriesMgt.SelectSeries(
          ServiceSetup."Object Nos.",OldObject."No. Series", "No. Series")
        THEN BEGIN //mg.c, 15-12-10: M24121
          NoSeriesMgt.SetSeries("No.");
          Rec := ObjectRec;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE UpdateTenderCode@1100528600();
    VAR
      StandardObject@1100528601 : Record 11020334;
    BEGIN
      IF StandardObject.GET("Standard Object No.") THEN BEGIN
        "Tender Code System 1" := StandardObject."Tender Code System 1";
        "Tender Code 1" := StandardObject."Tender Code 1";
        "Tender Code System 2" := StandardObject."Tender Code System 2";
        "Tender Code 2" := StandardObject."Tender Code 2";
      END;
    END;

    PROCEDURE CopyObjectLevelSpecs@1100528612();
    VAR
      ObjectSpecificationLine@1100528601 : Record 11071781;
      DummyObjectSpecificationLine@1100528602 : Record 11071781;
      ObjectSpecificationMgt@1100528600 : Codeunit 11012848;
    BEGIN
      IF "Standard Object No." = '' THEN
        EXIT;

      ObjectSpecificationLine.SETRANGE("Specification Type", ObjectSpecificationLine."Specification Type"::"Standard Object");
      ObjectSpecificationLine.SETRANGE(Code, "Standard Object No.");
      ObjectSpecificationLine.SETRANGE("Object Level", TRUE);
      ObjectSpecificationLine.SETRANGE(Type, ObjectSpecificationLine.Type::Line);
      IF ObjectSpecificationLine.FINDSET THEN
        REPEAT
          IF ObjectSpecificationLine.Type = ObjectSpecificationLine.Type::Line THEN BEGIN
            ObjectSpecificationMgt.FindOrCreateObjectSpecGroup("No.",
              ObjectSpecificationLine.GetObjSpecificationGroupCode, DummyObjectSpecificationLine);
          END;
          ObjectSpecificationMgt.FindOrCreateObjectSpec("No.", ObjectSpecificationLine."Specification Code",
            DummyObjectSpecificationLine);
        UNTIL ObjectSpecificationLine.NEXT = 0;
    END;

    PROCEDURE UpdateContractObjectBlocked@1100528602();
    VAR
      ContractObject@1100528600 : Record 11071702;
    BEGIN
      ContractObject.SETCURRENTKEY("Service Object No.");
      ContractObject.SETRANGE("Service Object No.", "No.");
      ContractObject.SETFILTER("Ending Date", '%1|>%2', 0D, TODAY);
      IF NOT ContractObject.ISEMPTY THEN BEGIN
        IF NOT CONFIRM(Text002, TRUE) THEN
          ERROR('');
        ContractObject.MODIFYALL("Ending Date", TODAY, TRUE);
      END;
    END;

    PROCEDURE TestNotInBuilding@1100528300();
    VAR
      BuildingObjectRelation@1100528300 : Record 11071820;
    BEGIN
      BuildingObjectRelation.SETCURRENTKEY("Object No.");
      BuildingObjectRelation.SETRANGE("Object No.", "No.");
      IF NOT BuildingObjectRelation.ISEMPTY THEN
        ERROR(Text003, "No.");
    END;

    PROCEDURE ShowBuildingRelations@1100528302();
    VAR
      BuildingObjectRelation@1100528300 : Record 11071820;
    BEGIN
      TESTFIELD("Service Location No.", '');

      BuildingObjectRelation.FILTERGROUP(9);
      BuildingObjectRelation.SETRANGE("Object No.", "No.");
      BuildingObjectRelation.FILTERGROUP(0);
      BuildingObjectRelation.SETCURRENTKEY("Object No.");
      PAGE.RUNMODAL(PAGE::"Building-Object Relations", BuildingObjectRelation);
    END;

    PROCEDURE GetPrefServiceLocationNo@1100528301(IWithErrorCheck@1100528300 : Boolean) : Code[20];
    VAR
      BuildingObjectRelation@1100528301 : Record 11071820;
      Building@1100528302 : Record 11071819;
      ServiceLocation@1100528600 : Record 11012801;
      Complex@1100525000 : Record 11071816;
    BEGIN
      IF IWithErrorCheck THEN
        TESTFIELD("No.");

      IF "Service Location No." <> '' THEN
        EXIT("Service Location No.");

      BuildingObjectRelation.SETCURRENTKEY("Object No.");
      BuildingObjectRelation.SETRANGE("Object No.", "No.");
      IF BuildingObjectRelation.ISEMPTY THEN BEGIN
        IF IWithErrorCheck THEN
          TESTFIELD("Service Location No.");
      END ELSE BEGIN
        IF BuildingObjectRelation.COUNT > 1 THEN BEGIN
          BuildingObjectRelation.SETRANGE("Preferred Building", TRUE);
          IF BuildingObjectRelation.ISEMPTY THEN
            IF IWithErrorCheck THEN
              ERROR(Text004, BuildingObjectRelation.TABLECAPTION, "No.")
            ELSE
              EXIT;
        END;
        BuildingObjectRelation.FINDFIRST;
        IF IWithErrorCheck THEN
          BuildingObjectRelation.TESTFIELD("Building Code");
        IF IWithErrorCheck THEN
          Building.GET(BuildingObjectRelation."Building Code")
        ELSE
          IF NOT Building.GET(BuildingObjectRelation."Building Code") THEN
            EXIT;
        ServiceLocation.SETCURRENTKEY("Building Code");
        ServiceLocation.SETRANGE("Building Code", Building.Code);
        IF ServiceLocation.ISEMPTY THEN
          IF IWithErrorCheck THEN
            ERROR(Text005, Building.Code);
        IF ServiceLocation.COUNT > 1 THEN BEGIN
          IF Building."Preferred Service Location No." <> '' THEN
            EXIT(Building."Preferred Service Location No.");
          IF Complex.GET(Building."Complex Code") THEN BEGIN
            IF IWithErrorCheck THEN
              Complex.TESTFIELD("Preferred Service Location No.");
            EXIT(Complex."Preferred Service Location No.");
          END ELSE BEGIN
            IF IWithErrorCheck THEN
              Building.TESTFIELD("Preferred Service Location No.");
            EXIT;
          END;
        END ELSE
          IF Complex.GET(Building."Complex Code") THEN
            IF Complex."Preferred Service Location No." <> '' THEN
              EXIT(Complex."Preferred Service Location No.");
        ServiceLocation.FINDFIRST;
        EXIT(ServiceLocation."No.");
      END;
    END;

    PROCEDURE BelongsToServiceLocation@1100528303(IServiceLocationNo@1100528302 : Code[20]) : Boolean;
    VAR
      BuildingObjectRelation@1100528301 : Record 11071820;
      ServiceLocation@1100528300 : Record 11012801;
    BEGIN
      IF ("Service Location No." <> '') AND ("Service Location No." = IServiceLocationNo) THEN
        EXIT(TRUE);
      IF NOT ServiceLocation.GET(IServiceLocationNo) THEN
        EXIT(FALSE);
      IF ServiceLocation."Building Code" = '' THEN
        EXIT(FALSE);

      EXIT(BuildingObjectRelation.GET(ServiceLocation."Building Code", "No."));
    END;

    PROCEDURE TestNotInUse@1100528603();
    VAR
      ContractObject@1100528600 : Record 11071702;
      MaintenanceProposalLine@1100528601 : Record 11071696;
      ServiceContractArrangement@1100528602 : Record 11071705;
      ServiceCall@1100528603 : Record 11012822;
      ServiceOrderObject@1100528604 : Record 11071724;
      ObjectModificationLine@1100528605 : Record 11071701;
      ReplacementLine@1100528606 : Record 11071710;
    BEGIN
      ContractObject.SETCURRENTKEY("Service Object No.");
      ContractObject.SETRANGE("Service Object No.", "No.");
      IF ContractObject.FINDFIRST THEN
        ERROR(Text001, ContractObject."Service Object No.", ContractObject."Service Contract No.");

      ServiceContractArrangement.SETRANGE("Object No.", "No.");
      IF NOT ServiceContractArrangement.ISEMPTY THEN
        ERROR(Text006, "No.", ServiceContractArrangement.TABLECAPTION);

      MaintenanceProposalLine.SETRANGE("Object No.", "No.");
      IF NOT MaintenanceProposalLine.ISEMPTY THEN
        ERROR(Text006, "No.", MaintenanceProposalLine.TABLECAPTION);

      ServiceCall.SETRANGE("Object No.", "No.");
      IF NOT ServiceCall.ISEMPTY THEN
        ERROR(Text006, "No.", ServiceCall.TABLECAPTION);

      ServiceOrderObject.SETRANGE("Object No.", "No.");
      IF NOT ServiceOrderObject.ISEMPTY THEN
        ERROR(Text006, "No.", ServiceOrderObject.TABLECAPTION);

      ObjectModificationLine.SETRANGE("Object No.", "No.");
      IF NOT ObjectModificationLine.ISEMPTY THEN
        ERROR(Text006, "No.", ObjectModificationLine.TABLECAPTION);

      ReplacementLine.SETRANGE("Object No.", "No.");
      IF NOT ReplacementLine.ISEMPTY THEN
        ERROR(Text006, "No.", ReplacementLine.TABLECAPTION);
    END;

    PROCEDURE VendorWillBeCharged@1100528604(IServiceOrderNo@1100528603 : Code[20];IPostingDate@1100528600 : Date;VAR OBilltoVendorNo@1100528602 : Code[20]) : Boolean;
    VAR
      ServWarrDiscountTerm@1100528601 : Record 11071811;
      ServiceOrder@1100528604 : Record 11012823;
    BEGIN
      IF IServiceOrderNo <> '' THEN BEGIN
        IF NOT ServiceOrder.GET(IServiceOrderNo) THEN
          EXIT;
        IF NOT (ServiceOrder."Source Type" IN [ServiceOrder."Source Type"::Call, ServiceOrder."Source Type"::Direct]) THEN
          EXIT;
      END; // else called from service call
      // If Discount Term Customer <> 100% -> Customer will be charged
      // If Discount Term Customer = 100% -> Vendor will be charged
      IF ("Warranty Code Customer" <> '') AND ("Warranty Starting Date Cust." <> 0D) AND ("Bill-to Vendor No." <> '') AND
         (IPostingDate >= "Warranty Starting Date Cust.")
      THEN BEGIN
        ServWarrDiscountTerm.SETRANGE("Warranty Code", "Warranty Code Customer");
        ServWarrDiscountTerm.SETRANGE("Cost Type", ServWarrDiscountTerm."Cost Type"::" ");
        ServWarrDiscountTerm.SETRANGE(Percentage, 100);
        IF NOT ServWarrDiscountTerm.FINDSET THEN
          EXIT;
        REPEAT
          IF (FORMAT(ServWarrDiscountTerm.Period) = '') OR
             (IPostingDate <= CALCDATE(ServWarrDiscountTerm.Period, "Warranty Starting Date Cust."))
          THEN BEGIN
            OBilltoVendorNo := "Bill-to Vendor No.";
            EXIT(TRUE);
          END;
        UNTIL ServWarrDiscountTerm.NEXT = 0;
      END;
    END;

    PROCEDURE GetDepartmentCode@1100528605(IServiceContractNo@1100528600 : Code[20]) : Code[20];
    VAR
      ServiceLocation@1100528601 : Record 11012801;
      ServiceContract@1100528602 : Record 11012812;
      MaintenanceManagement@1100528604 : Codeunit 11012829;
      ServiceLocationNo@1100528603 : Code[20];
    BEGIN
      ServiceLocationNo := GetPrefServiceLocationNo(FALSE);
      IF ServiceLocationNo <> '' THEN
        IF ServiceLocation.GET(ServiceLocationNo) THEN
          IF ServiceLocation."Global Dimension 1 Code" <> '' THEN
            EXIT(ServiceLocation."Global Dimension 1 Code");
      IF IServiceContractNo = '' THEN
        MaintenanceManagement.GetNoOfActualContractsForObj("No.", TODAY, IServiceContractNo);
      IF ServiceContract.GET(IServiceContractNo) THEN
        EXIT(ServiceContract."Global Dimension 1 Code");
    END;

    PROCEDURE GetPreferredBuildingCode@1100528601() : Code[20];
    VAR
      BuildingObjectRelation@1100528600 : Record 11071820;
    BEGIN
      BuildingObjectRelation.SETCURRENTKEY("Object No.");
      BuildingObjectRelation.SETRANGE("Object No.", "No.");
      IF BuildingObjectRelation.COUNT = 1 THEN BEGIN
        BuildingObjectRelation.FINDFIRST;
        EXIT(BuildingObjectRelation."Building Code");
      END ELSE BEGIN
        BuildingObjectRelation.SETRANGE("Preferred Building", TRUE);
        IF BuildingObjectRelation.FINDFIRST THEN
          EXIT(BuildingObjectRelation."Building Code");
        BuildingObjectRelation.SETRANGE("Preferred Building");
        IF BuildingObjectRelation.FINDFIRST THEN
          EXIT(BuildingObjectRelation."Building Code");
      END;
    END;

    PROCEDURE ApplySMAgreements@1100528606();
    VAR
      ServiceContract@1100528602 : Record 11012812;
      ContractObject@1100528601 : Record 11071702;
      MaintenanceManagement@1100528600 : Codeunit 11012829;
    BEGIN
      IF MODIFY(TRUE) THEN; // Needed for HandleSMAgreement();
      MaintenanceManagement.GetActualContractDSForObject("No.", TODAY, ServiceContract);
      IF ServiceContract.FINDSET THEN
        REPEAT
          IF ContractObject.GET(ServiceContract."No.", "No.") THEN BEGIN
            ContractObject.HandleSMAgreement(TRUE, TRUE);
            ContractObject.MODIFY(TRUE);
          END;
        UNTIL ServiceContract.NEXT = 0;
    END;

    LOCAL PROCEDURE UpdateContractObjects@1100528607();
    VAR
      ContractObject@1100528600 : Record 11071702;
    BEGIN
      MODIFY;
      ContractObject.SETCURRENTKEY("Service Object No.");
      ContractObject.SETRANGE("Service Object No.", "No.");
      ContractObject.SETFILTER("Ending Date", '%1|>=%2', 0D, TODAY);
      ContractObject.SetDoNotConfirmMaintenanceSchemeCreation(TRUE);
      IF ContractObject.FINDSET THEN
        REPEAT
          ContractObject.FillDefaultMaintScheme;
        UNTIL ContractObject.NEXT = 0;
    END;

    PROCEDURE SelectAndAddPicture@1100528616();
    VAR
      FileManagement@1100528602 : Codeunit 419;
      FileName@1100528603 : Text;
    BEGIN
      FileName := FileManagement.OpenFileDialog('', '', FileManagement.GetPictureFilterText);
      ReplacePictureAsDocument(FileName);
    END;

    LOCAL PROCEDURE ReplacePictureAsDocument@1100528618(IFileName@1100528601 : Text);
    BEGIN
      IF IFileName <> '' THEN BEGIN
        RemovePicture;
        AddPictureAsDocument(IFileName);
      END;
    END;

    LOCAL PROCEDURE AddPictureAsDocument@1100528614(IFileName@1100528600 : Text);
    VAR
      ServiceSetup@1100528601 : Record 11012800;
      ExternalDocumentManagement@1100528602 : Codeunit 11012403;
      RecRef@1100528603 : RecordRef;
    BEGIN
      TestMaxNoOfPictures;
      ServiceSetup.GET;
      ServiceSetup.TESTFIELD("Object Picture Doc. Type");
      RecRef.GETTABLE(Rec);
      ExternalDocumentManagement.AddExternalDocument(RecRef, IFileName, ServiceSetup."Object Picture Doc. Type");
    END;

    PROCEDURE RemovePicture@1100528622();
    VAR
      DocumentProperties@1100528601 : Record 11012746;
      DocumentLink@1100528600 : Record 11012747;
    BEGIN
      GetPicturesAsDocumentProperties(DocumentProperties);
      IF DocumentProperties.FINDSET THEN
        REPEAT
          DocumentLink.SETRANGE("Document No.", DocumentProperties."No.");
          DocumentLink.SETRANGE("Internal Company", DocumentProperties."Internal Company");
          DocumentLink.SETRANGE("Record ID", RECORDID);
          DocumentLink.DELETEALL(TRUE);
        UNTIL DocumentProperties.NEXT = 0;
    END;

    LOCAL PROCEDURE TestMaxNoOfPictures@1100528619();
    VAR
      DocumentProperties@1100528603 : Record 11012746;
    BEGIN
      GetPicturesAsDocumentProperties(DocumentProperties);
      IF DocumentProperties.COUNT = 1 THEN
        ERROR(Text007);
    END;

    PROCEDURE GetPicturesAsDocumentProperties@1100528621(VAR ODocumentProperties@1100528600 : Record 11012746);
    VAR
      ServiceSetup@1100528605 : Record 11012800;
      DocumentLinkManagement@1100528604 : Codeunit 11012401;
      RecRef@1100528603 : RecordRef;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentLinkManagement.GetDocuments(ODocumentProperties, RecRef);
      ODocumentProperties.MARKEDONLY(TRUE);
      ServiceSetup.GET;
      ODocumentProperties.SETRANGE("Document Type", ServiceSetup."Object Picture Doc. Type");
      ODocumentProperties.SetFilterPicturesOnly;
    END;

    LOCAL PROCEDURE ValidateGPSCoordinate@1100529400(Value@1100529400 : Code[30]);
    VAR
      ServiceLocation@1100528400 : Record 11012801;
    BEGIN
      ServiceLocation.ValidateGPSCoordinate(Value);
    END;

    PROCEDURE GetComplexCode@1100529600(PreferredBuildingCode@1100529601 : Code[20]) : Code[20];
    VAR
      ServiceLocation@1100529600 : Record 11012801;
      Building@1100529602 : Record 11071819;
    BEGIN
      IF "Service Location No." <> '' THEN
        IF ServiceLocation.GET("Service Location No.") THEN
          EXIT(ServiceLocation."Complex Code");

      IF PreferredBuildingCode <> '' THEN
        IF Building.GET(PreferredBuildingCode) THEN
          EXIT(Building."Complex Code");

      EXIT('');
    END;

    PROCEDURE AddLatLng@1100525001() : Boolean;
    VAR
      BingMapsHandler@1100525001 : Codeunit 11012485;
      tmpLat@1100525002 : Text[255];
      tmpLng@1100525003 : Text[255];
      InstallationManagement@1100525006 : Codeunit 11012268;
    BEGIN
      IF NOT InstallationManagement.LicensePermissionForTableData(DATABASE::"Bing Maps Setup") THEN
        EXIT;

      IF NOT BingMapsHandler.SetupIsDoneAndEnabled THEN
        EXIT;

      IF (Latitude = '') OR (Longitude = '') THEN BEGIN
        CALCFIELDS("Location Address", "Location City", "Location Post Code");
        IF BingMapsHandler.GetLatLngFromAddress(tmpLat, tmpLng, "Location Address", "Location City", "Location Post Code") THEN BEGIN
          Latitude := tmpLat;
          Longitude := tmpLng;
          MODIFY;
          EXIT(TRUE);
        END;
        //ELSE BingMapsHandler.LocationError(TABLECAPTION, "No."); C047603.o
      END;
    END;

    LOCAL PROCEDURE CopyObjectMaterialInventory@1100527550();
    VAR
      ObjectMaterialInventory@1100527550 : Record 11071712;
      ToObjectMaterialInventory@1100527551 : Record 11071712;
      ObjectSpecificationLine@1100527552 : Record 11071781;
      ToObjectSpecificationLine@1100527553 : Record 11071781;
      LineNo@1100527554 : Integer;
      ObjectSpecificationMgt@1100527555 : Codeunit 11012848;
    BEGIN
      IF "Standard Object No." = '' THEN
        EXIT;

      ObjectMaterialInventory.SETRANGE(Type, ObjectMaterialInventory.Type::"Standard Object");
      ObjectMaterialInventory.SETRANGE(Code, "Standard Object No.");
      IF ObjectMaterialInventory.FINDSET THEN BEGIN
        ToObjectMaterialInventory.SETRANGE(Type, ObjectMaterialInventory.Type::Object);
        ToObjectMaterialInventory.SETRANGE(Code, "No.");
        IF ToObjectMaterialInventory.FINDLAST THEN
          LineNo := ToObjectMaterialInventory."Line No.";
        REPEAT
          LineNo += 10000;
          ToObjectMaterialInventory := ObjectMaterialInventory;
          ToObjectMaterialInventory.VALIDATE(Type, ObjectMaterialInventory.Type::Object);
          ToObjectMaterialInventory.VALIDATE(Code, "No.");
          ToObjectMaterialInventory."Line No." := LineNo;
          ToObjectMaterialInventory.INSERT(TRUE);
          ObjectSpecificationLine.SETRANGE("Specification Type", ObjectSpecificationLine."Specification Type"::"Object Line");
          ObjectSpecificationLine.SETRANGE(Code, "Standard Object No.");
          ObjectSpecificationLine.SETRANGE("Object Level", TRUE);
          ObjectSpecificationLine.SETRANGE(Type, ObjectSpecificationLine.Type::Line);
          ObjectSpecificationLine.SETRANGE("Object Line No.", ObjectMaterialInventory."Line No.");
          IF ObjectSpecificationLine.FINDSET THEN
            REPEAT
              ObjectSpecificationMgt.FindOrCreateObjectSpecGroupForMaterialInv("No.", ObjectSpecificationLine.GetObjSpecificationGroupCode, ToObjectSpecificationLine, LineNo);
              ObjectSpecificationMgt.FindOrCreateObjectSpecForMaterialInv("No.", ObjectSpecificationLine."Specification Code", ToObjectSpecificationLine, LineNo);
            UNTIL ObjectSpecificationLine.NEXT = 0;
        UNTIL ObjectMaterialInventory.NEXT = 0;
      END;
    END;

    BEGIN
    END.
  }
}

