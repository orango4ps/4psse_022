OBJECT Table 112 Sales Invoice Header
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.04,4PS14.00,NAVFI.DK.NO,4PSSE,4PSFI;
  }
  PROPERTIES
  {
    Permissions=;
    DataCaptionFields=No.,Sell-to Customer Name;
    OnInsert=BEGIN
               //**4PS Generated Code. Do Not Change.sn05
               //DPA_OnInsert;  //*26917.o  Do not determine default department for 'Posted' table
               //**4PS Generated Code.en05
             END;

    OnDelete=VAR
               PostedDeferralHeader@1002 : Record 1704;
               PostSalesDelete@1003 : Codeunit 363;
               DeferralUtilities@1001 : Codeunit 1720;
               SalesOfferAmount@1100485000 : Record 11012786;
             BEGIN
               PostSalesDelete.IsDocumentDeletionAllowed("Posting Date");
               TESTFIELD("No. Printed");
               LOCKTABLE;
               PostSalesDelete.DeleteSalesInvLines(Rec);

               SalesCommentLine.SETRANGE("Document Type",SalesCommentLine."Document Type"::"Posted Invoice");
               SalesCommentLine.SETRANGE("No.","No.");
               SalesCommentLine.DELETEALL;

               //**4PS.sn
               SalesOfferAmount.SETRANGE("Document Type",SalesOfferAmount."Document Type"::"Posted Invoice");
               SalesOfferAmount.SETRANGE("Document No.", "No.");
               SalesOfferAmount.DELETEALL;
               //**4PS.en

               ApprovalsMgmt.DeletePostedApprovalEntries(RECORDID);
               PostedDeferralHeader.DeleteForDoc(DeferralUtilities.GetSalesDeferralDocType,'','',
                 SalesCommentLine."Document Type"::"Posted Invoice","No.");
             END;

    CaptionML=[ENU=Sales Invoice Header;
               NOR=Salgsfakturahode;
               SVE=FîrsÑljningsfakturahuvud];
    LookupPageID=Page143;
    DrillDownPageID=Page143;
  }
  FIELDS
  {
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              NOR=Salg til-kundenr.;
                                                              SVE=Fîrs.kundnr];
                                                   NotBlank=Yes }
    { 3   ;   ;No.                 ;Code20        ;CaptionML=[ENU=No.;
                                                              NOR=Nr.;
                                                              SVE=Nr] }
    { 4   ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              NOR=Faktura til-kundenr.;
                                                              SVE=Faktureringskundnr];
                                                   NotBlank=Yes }
    { 5   ;   ;Bill-to Name        ;Text100       ;CaptionML=[ENU=Bill-to Name;
                                                              NOR=Faktura til-navn;
                                                              SVE=Faktureringsnamn] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[ENU=Bill-to Name 2;
                                                              NOR=Faktura til-navn 2;
                                                              SVE=Faktureringsnamn 2] }
    { 7   ;   ;Bill-to Address     ;Text100       ;CaptionML=[ENU=Bill-to Address;
                                                              NOR=Faktura til-adresse;
                                                              SVE=Faktureringsadress] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;CaptionML=[ENU=Bill-to Address 2;
                                                              NOR=Faktura til-adresse 2;
                                                              SVE=Faktureringsadress 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Bill-to City;
                                                              NOR=Faktura til-sted;
                                                              SVE=Faktureras ort] }
    { 10  ;   ;Bill-to Contact     ;Text100       ;CaptionML=[ENU=Bill-to Contact;
                                                              NOR=Faktura til-kontakt;
                                                              SVE=Faktureringskontaktperson] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              NOR=Deres referanse;
                                                              SVE=Er referens] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   CaptionML=[ENU=Ship-to Code;
                                                              NOR=Lever til-kode;
                                                              SVE=Leveransadresskod] }
    { 13  ;   ;Ship-to Name        ;Text100       ;CaptionML=[ENU=Ship-to Name;
                                                              NOR=Lever til-navn;
                                                              SVE=Leveransnamn] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              NOR=Lever til-navn 2;
                                                              SVE=Leveransnamn 2] }
    { 15  ;   ;Ship-to Address     ;Text100       ;CaptionML=[ENU=Ship-to Address;
                                                              NOR=Lever til-adresse;
                                                              SVE=Leveransadress] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              NOR=Lever til-adresse 2;
                                                              SVE=Leveransadress 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              NOR=Lever til-sted;
                                                              SVE=Leveransort] }
    { 18  ;   ;Ship-to Contact     ;Text100       ;CaptionML=[ENU=Ship-to Contact;
                                                              NOR=Lever til-kontakt;
                                                              SVE=Leveranskontaktperson] }
    { 19  ;   ;Order Date          ;Date          ;CaptionML=[ENU=Order Date;
                                                              NOR=Bestillingsdato;
                                                              SVE=Orderdatum] }
    { 20  ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              NOR=Bokfõringsdato;
                                                              SVE=Bokfîringsdatum] }
    { 21  ;   ;Shipment Date       ;Date          ;CaptionML=[ENU=Shipment Date;
                                                              NOR=Forsendelsesdato;
                                                              SVE=Utleveransdatum] }
    { 22  ;   ;Posting Description ;Text100       ;CaptionML=[ENU=Description;
                                                              NOR=Bokfõringsbeskrivelse;
                                                              SVE=Bokfîringsbeskrivning] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Payment Terms Code;
                                                              NOR=Betalingsbet.kode;
                                                              SVE=Betalningsvillkorskod] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato;
                                                              SVE=Fîrfallodatum] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;CaptionML=[ENU=Payment Discount %;
                                                              NOR=Kontantrabatt-%;
                                                              SVE=Kassarabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              NOR=Kont.rabattdato;
                                                              SVE=Kassarabattsdatum] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=[ENU=Shipment Method/Incoterm Code;
                                                              NOR=LeveringsmÜtekode;
                                                              SVE=Utleveransvillkorskod] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode;
                                                              SVE=LagerstÑllekod] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode;
                                                              SVE=GenvÑg dimension 1 kod];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode;
                                                              SVE=GenvÑg dimension 2 kod];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code20      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[ENU=Customer Posting Group;
                                                              NOR=Bokfõringsgruppe - kunde;
                                                              SVE=Kundbokfîringsmall];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod];
                                                   Editable=No }
    { 33  ;   ;Currency Factor     ;Decimal       ;CaptionML=[ENU=Currency Factor;
                                                              NOR=Valutafaktor;
                                                              SVE=Valutafaktor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0 }
    { 34  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   CaptionML=[ENU=Customer Price Group;
                                                              NOR=Kundeprisgruppe;
                                                              SVE=Kund prisgrupp] }
    { 35  ;   ;Prices Including VAT;Boolean       ;CaptionML=[ENU=Prices Including VAT;
                                                              NOR=Priser inkl. mva.;
                                                              SVE=Priser inkl. moms] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;CaptionML=[ENU=Invoice Disc. Code;
                                                              NOR=Fakturarabattkode;
                                                              SVE=Fakturarabattkod] }
    { 40  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              NOR=Kunderabattgruppe;
                                                              SVE=Kundrabattgrupp] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              NOR=SprÜkkode;
                                                              SVE=SprÜkkod] }
    { 43  ;   ;Salesperson Code    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Code;
                                                              NOR=Selgerkode;
                                                              SVE=SÑljarkod] }
    { 44  ;   ;Order No.           ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=CONST(Order));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Order No.;
                                                              NOR=Ordrenr.;
                                                              SVE=Ordernr];
                                                   Description=4PS: table relation added }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Comment Line" WHERE (Document Type=CONST(Posted Invoice),
                                                                                                 No.=FIELD(No.),
                                                                                                 Document Line No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              NOR=Antall skrevet ut;
                                                              SVE=Utskriven];
                                                   Editable=No }
    { 51  ;   ;On Hold             ;Code3         ;CaptionML=[ENU=On Hold;
                                                              NOR=Avvent;
                                                              SVE=Stoppad] }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              NOR=Utligningsbilagstype;
                                                              SVE=Kopplas till dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    NOR=" ,Betaling,Faktura,Kreditnota,Rentenota,Purring,Refusjon";
                                                                    SVE=" ,Betalning,Faktura,Kreditnota,RÑntefaktura,BetalningspÜminnelse,èterbetalning"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnLookup=BEGIN
                                                              CustLedgEntry.SETCURRENTKEY("Document No.");
                                                              CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                              CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                              PAGE.RUN(0,CustLedgEntry);
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              NOR=Utligningsbilagsnr.;
                                                              SVE=Kopplas till ver.nr] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   CaptionML=[ENU=Bal. Account No.;
                                                              NOR=Motkontonr.;
                                                              SVE=Motkonto] }
    { 60  ;   ;Amount              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Invoice Line".Amount WHERE (Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount;
                                                              NOR=Belõp;
                                                              SVE=Belopp];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Amount Including VAT;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Invoice Line"."Amount Including VAT" WHERE (Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount Including VAT;
                                                              NOR=Belõp inkl. mva.;
                                                              SVE=Belopp inkl. moms];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=VAT Registration No.;
                                                              NOR=Organisasjonsnr.;
                                                              SVE=Momsregistreringsnr] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              NOR=èrsaksspor;
                                                              SVE=Uppfîljningskod] }
    { 74  ;   ;Gen. Bus. Posting Group;Code20     ;TableRelation="Gen. Business Posting Group";
                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokfõringsgruppe - firma;
                                                              SVE=Gen. rîrelsebokfîringsmall] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              NOR=Trekanthandel;
                                                              SVE=EU trepartshandel] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart;
                                                              SVE=EU transaktionstyp] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=TransportmÜte;
                                                              SVE=TransportsÑtt] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=VAT Country/Region Code;
                                                              NOR=Lands-/omrÜdekode for mva;
                                                              SVE=Momskod fîr land/region] }
    { 79  ;   ;Sell-to Customer Name;Text100      ;CaptionML=[ENU=Sell-to Customer Name;
                                                              NOR=Salg til-kundenavn;
                                                              SVE=Fîrs.kundnamn] }
    { 80  ;   ;Sell-to Customer Name 2;Text50     ;CaptionML=[ENU=Sell-to Customer Name 2;
                                                              NOR=Salg til-kundenavn 2;
                                                              SVE=Fîrs.kundnamn 2] }
    { 81  ;   ;Sell-to Address     ;Text100       ;CaptionML=[ENU=Sell-to Address;
                                                              NOR=Salg til-adresse;
                                                              SVE=Fîrs.adress] }
    { 82  ;   ;Sell-to Address 2   ;Text50        ;CaptionML=[ENU=Sell-to Address 2;
                                                              NOR=Salg til-adresse 2;
                                                              SVE=Fîrs.adress 2] }
    { 83  ;   ;Sell-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to City;
                                                              NOR=Salg til-sted;
                                                              SVE=Fîrs.ort] }
    { 84  ;   ;Sell-to Contact     ;Text100       ;CaptionML=[ENU=Sell-to Contact;
                                                              NOR=Salg til-kontakt;
                                                              SVE=Fîrs.kontaktperson] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Bill-to Post Code;
                                                              NOR=Faktura til-postnr.;
                                                              SVE=Faktureras postnr] }
    { 86  ;   ;Bill-to County      ;Text30        ;CaptionML=[ENU=Bill-to County;
                                                              NOR=Faktura til-fylke/delstat;
                                                              SVE=Faktureras delstat];
                                                   CaptionClass='5,1,' + "Bill-to Country/Region Code" }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Bill-to Country/Region Code;
                                                              NOR=Lands-/omrÜdekode for Faktura til;
                                                              SVE=Faktureringsland/-region] }
    { 88  ;   ;Sell-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to Post Code;
                                                              NOR=Salg til-postnr.;
                                                              SVE=Fîrs.postnrkod] }
    { 89  ;   ;Sell-to County      ;Text30        ;CaptionML=[ENU=Sell-to County;
                                                              NOR=Salg til-fylke/delstat;
                                                              SVE=Fîrs.delstat];
                                                   CaptionClass='5,1,' + "Sell-to Country/Region Code" }
    { 90  ;   ;Sell-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Sell-to Country/Region Code;
                                                              NOR=Lands-/omrÜdekode for Salg til;
                                                              SVE=Fîrs.land/-region] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to Post Code;
                                                              NOR=Lever til-postnr.;
                                                              SVE=Leveranspostnrkod] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[ENU=Ship-to County;
                                                              NOR=Lever til-fylke/delstat;
                                                              SVE=Leveransdelstat];
                                                   CaptionClass='5,1,' + "Ship-to Country/Region Code" }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              NOR=Lands-/omrÜdekode for Lever til;
                                                              SVE=Kod fîr leveransland/-region] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              NOR=Motkontotype;
                                                              SVE=Motkontotyp];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    NOR=Finanskonto,Bankkonto;
                                                                    SVE=Redov.konto,Bankkonto];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   CaptionML=[ENU=Exit Point;
                                                              NOR=Utpunkt;
                                                              SVE=Utfîrselplats] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              NOR=Korreksjon;
                                                              SVE=RÑttningstransaktion] }
    { 99  ;   ;Document Date       ;Date          ;CaptionML=[ENU=Document Date;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum] }
    { 100 ;   ;External Document No.;Code35       ;CaptionML=[ENU=External Document No.;
                                                              NOR=Eksterndokumentnr.;
                                                              SVE=Externt dokumentnr] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   CaptionML=[ENU=Area;
                                                              NOR=OmrÜde;
                                                              SVE=OmrÜde] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon;
                                                              SVE=EU transaktionsspecifikation] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   CaptionML=[ENU=Payment Method Code;
                                                              NOR=BetalingsmÜte - kode;
                                                              SVE=BetalningssÑtt] }
    { 105 ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              NOR=Transportõrkode;
                                                              SVE=Speditîrkod] }
    { 106 ;   ;Package Tracking No.;Text30        ;CaptionML=[ENU=Package Tracking No.;
                                                              NOR=Pakkesporingsnr.;
                                                              SVE=Godsupplysningsnr] }
    { 107 ;   ;Pre-Assigned No. Series;Code20     ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Pre-Assigned No. Series;
                                                              NOR=ForhÜndstilordnet nr.serie;
                                                              SVE=Fîrhandstilldelad nr-serie] }
    { 108 ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 110 ;   ;Order No. Series    ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Order No. Series;
                                                              NOR=Ordrenr.serie;
                                                              SVE=Order nr-serie] }
    { 111 ;   ;Pre-Assigned No.    ;Code20        ;CaptionML=[ENU=Pre-Assigned No.;
                                                              NOR=ForhÜndstilordnet nr.;
                                                              SVE=Fîrhandstilldelat nr] }
    { 112 ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   TestTableRelation=No;
                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=User ID;
                                                              NOR=Bruker-ID;
                                                              SVE=AnvÑndar-ID] }
    { 113 ;   ;Source Code         ;Code10        ;TableRelation="Source Code";
                                                   CaptionML=[ENU=Source Code;
                                                              NOR=Kildespor;
                                                              SVE=Ursprungskod] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   CaptionML=[ENU=Tax Area Code;
                                                              NOR=Mva-omrÜdekode;
                                                              SVE=SkatteomrÜdeskod] }
    { 115 ;   ;Tax Liable          ;Boolean       ;CaptionML=[ENU=Tax Liable;
                                                              NOR=Skyldig mva.;
                                                              SVE=Skattepliktig] }
    { 116 ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokfõringsgruppe - firma;
                                                              SVE=Moms rîrelsebokfîringsmall] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;CaptionML=[ENU=VAT Base Discount %;
                                                              NOR=Mva-gr.lagsrabatt-%;
                                                              SVE=Nettobelopprabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              NOR=Fakturarabattberegning;
                                                              SVE=FakturarabattberÑkning];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    NOR=Ingen,%,Belõp;
                                                                    SVE=Ingen,%,Belopp];
                                                   OptionString=None,%,Amount }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              NOR=Fakturarabattverdi;
                                                              SVE=FakturarabattvÑrde];
                                                   AutoFormatType=1 }
    { 131 ;   ;Prepayment No. Series;Code20       ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Prepayment No. Series;
                                                              NOR=Nummerserie for forskudd;
                                                              SVE=Nummerserie fîr fîrskottsbet.] }
    { 136 ;   ;Prepayment Invoice  ;Boolean       ;CaptionML=[ENU=Prepayment Invoice;
                                                              NOR=Forskuddsfaktura;
                                                              SVE=Fîrskottsfaktura] }
    { 137 ;   ;Prepayment Order No.;Code20        ;CaptionML=[ENU=Prepayment Order No.;
                                                              NOR=Ordrenummer for forskudd;
                                                              SVE=Ordernr fîr fîrskottsbetalning] }
    { 151 ;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              NOR=Tilbudsnr.;
                                                              SVE=Offertnr];
                                                   Editable=No }
    { 166 ;   ;Last Email Sent Time;DateTime      ;FieldClass=FlowField;
                                                   CalcFormula=Max("O365 Document Sent History"."Created Date-Time" WHERE (Document Type=CONST(Invoice),
                                                                                                                           Document No.=FIELD(No.),
                                                                                                                           Posted=CONST(Yes)));
                                                   CaptionML=[ENU=Last Email Sent Time;
                                                              NOR=Klokkeslett for sending av siste e-post] }
    { 167 ;   ;Last Email Sent Status;Option      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("O365 Document Sent History"."Job Last Status" WHERE (Document Type=CONST(Invoice),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Posted=CONST(Yes),
                                                                                                                            Created Date-Time=FIELD(Last Email Sent Time)));
                                                   CaptionML=[ENU=Last Email Sent Status;
                                                              NOR=Status for sending av siste e-post];
                                                   OptionCaptionML=[ENU=Not Sent,In Process,Finished,Error;
                                                                    NOR=Ikke sendt,I gang,Ferdig,Feil];
                                                   OptionString=Not Sent,In Process,Finished,Error }
    { 168 ;   ;Sent as Email       ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("O365 Document Sent History" WHERE (Document Type=CONST(Invoice),
                                                                                                         Document No.=FIELD(No.),
                                                                                                         Posted=CONST(Yes),
                                                                                                         Job Last Status=CONST(Finished)));
                                                   CaptionML=[ENU=Sent as Email;
                                                              NOR=Sendt som e-post] }
    { 169 ;   ;Last Email Notif Cleared;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("O365 Document Sent History".NotificationCleared WHERE (Document Type=CONST(Invoice),
                                                                                                                              Document No.=FIELD(No.),
                                                                                                                              Posted=CONST(Yes),
                                                                                                                              Created Date-Time=FIELD(Last Email Sent Time)));
                                                   CaptionML=[ENU=Last Email Notif Cleared;
                                                              NOR=Varsling om siste e-post fjernet] }
    { 171 ;   ;Sell-to Phone No.   ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Sell-to Phone No.;
                                                              NOR=Salg til-telefonnr.] }
    { 172 ;   ;Sell-to E-Mail      ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 176 ;   ;Payment Instructions;BLOB          ;CaptionML=[ENU=Payment Instructions;
                                                              NOR=Betalingsinstruksjoner;
                                                              SVE=Betalningsinstruktioner] }
    { 177 ;   ;Payment Instructions Name;Text20   ;DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Payment Instructions Name;
                                                              NOR=Navn pÜˇbetalingsinstruksjoner] }
    { 200 ;   ;Work Description    ;BLOB          ;CaptionML=[ENU=Work Description;
                                                              NOR=Arbeidsbeskrivelse;
                                                              SVE=Arbetsbeskrivning] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID;
                                                              SVE=DimensionsuppsÑttnings-ID];
                                                   Editable=No }
    { 600 ;   ;Payment Service Set ID;Integer     ;CaptionML=[ENU=Payment Service Set ID;
                                                              NOR=Postsett-ID for betalingstjeneste;
                                                              SVE=UppsÑttnings-ID fîr betalningstjÑnst] }
    { 710 ;   ;Document Exchange Identifier;Text50;CaptionML=[ENU=Document Exchange Identifier;
                                                              NOR=Dokumentutvekslingsidentifikator;
                                                              SVE=DokumentvÑxlingsidentifierare] }
    { 711 ;   ;Document Exchange Status;Option    ;CaptionML=[ENU=Document Exchange Status;
                                                              NOR=Dokumentutvekslingsstatus;
                                                              SVE=DokumentvÑxlingsstatus];
                                                   OptionCaptionML=[ENU=Not Sent,Sent to Document Exchange Service,Delivered to Recipient,Delivery Failed,Pending Connection to Recipient;
                                                                    NOR=Ikke sendt,Sendt til dokumentutvekslingstjeneste,Levert til mottaker,Levering mislyktes,Venter pÜ tilkobling til mottaker;
                                                                    SVE=Ej skickad,Skickad till dokumentvÑxlingstjÑnst,Levererad till mottagare,Leverans misslyckades,VÑntar pÜ anslutning till mottagare];
                                                   OptionString=Not Sent,Sent to Document Exchange Service,Delivered to Recipient,Delivery Failed,Pending Connection to Recipient }
    { 712 ;   ;Doc. Exch. Original Identifier;Text50;
                                                   CaptionML=[ENU=Doc. Exch. Original Identifier;
                                                              NOR=Opprinnelig identifikator for dokumentutveksling;
                                                              SVE=Originalidentifierare fîr dok.vÑx.] }
    { 720 ;   ;Coupled to CRM      ;Boolean       ;CaptionML=[ENU=Coupled to Dynamics 365 for Sales;
                                                              NOR=Koblet til Dynamics 365 for Sales;
                                                              SVE=Kopplat till Dynamics CRM] }
    { 1200;   ;Direct Debit Mandate ID;Code35     ;TableRelation="SEPA Direct Debit Mandate" WHERE (Customer No.=FIELD(Bill-to Customer No.));
                                                   CaptionML=[ENU=Direct Debit Mandate ID;
                                                              NOR=ID for Direct Debit-belastningsfullmakt;
                                                              SVE=Medgivande-ID fîr autogiro] }
    { 1302;   ;Closed              ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=-Exist("Cust. Ledger Entry" WHERE (Entry No.=FIELD(Cust. Ledger Entry No.),
                                                                                                  Open=FILTER(Yes)));
                                                   CaptionML=[ENU=Closed;
                                                              NOR=Lukket;
                                                              SVE=StÑngd];
                                                   Editable=No }
    { 1303;   ;Remaining Amount    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Cust. Ledger Entry No.=FIELD(Cust. Ledger Entry No.)));
                                                   CaptionML=[ENU=Remaining Amount;
                                                              NOR=Restbelõp;
                                                              SVE=èterstÜende belopp];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 1304;   ;Cust. Ledger Entry No.;Integer     ;TableRelation="Cust. Ledger Entry"."Entry No.";
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Cust. Ledger Entry No.;
                                                              NOR=Kundepostnr.;
                                                              SVE=Kundreskontra lîpnr];
                                                   Editable=No }
    { 1305;   ;Invoice Discount Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Invoice Line"."Inv. Discount Amount" WHERE (Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Invoice Discount Amount;
                                                              NOR=Fakturarabattbelõp;
                                                              SVE=Fakturarabatt];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1310;   ;Cancelled           ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Cancelled Document" WHERE (Source ID=CONST(112),
                                                                                                 Cancelled Doc. No.=FIELD(No.)));
                                                   CaptionML=[ENU=Cancelled;
                                                              NOR=Annullert;
                                                              SVE=Annullerad];
                                                   Editable=No }
    { 1311;   ;Corrective          ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Cancelled Document" WHERE (Source ID=CONST(114),
                                                                                                 Cancelled By Doc. No.=FIELD(No.)));
                                                   CaptionML=[ENU=Corrective;
                                                              NOR=Korrigerende;
                                                              SVE=Korrigerande];
                                                   Editable=No }
    { 1312;   ;Reversed            ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Cust. Ledger Entry".Reversed WHERE (Entry No.=FIELD(Cust. Ledger Entry No.)));
                                                   CaptionML=[ENU=Reversed;
                                                              NOR=Tilbakefõrt;
                                                              SVE=èterfîrd];
                                                   Editable=No }
    { 5050;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign No.;
                                                              NOR=Kampanjenr.;
                                                              SVE=Kampanjnr] }
    { 5052;   ;Sell-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   CaptionML=[ENU=Sell-to Contact No.;
                                                              NOR=Salg til-kontaktnr.;
                                                              SVE=Fîrs.kontaktnr] }
    { 5053;   ;Bill-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   CaptionML=[ENU=Bill-to Contact No.;
                                                              NOR=Faktura til-kontaktnr.;
                                                              SVE=Faktureringskontaktnr] }
    { 5055;   ;Opportunity No.     ;Code20        ;TableRelation=Opportunity;
                                                   CaptionML=[ENU=Opportunity No.;
                                                              NOR=Salgsmulighetsnr.;
                                                              SVE=AffÑrsmîjlighetsnr] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              NOR=Ansvarssenter;
                                                              SVE=Ansvarsenhet] }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;CaptionML=[ENU=Allow Line Disc.;
                                                              NOR=Tillat linjerabatt;
                                                              SVE=TillÜt radrabatt] }
    { 7200;   ;Get Shipment Used   ;Boolean       ;CaptionML=[ENU=Get Shipment Used;
                                                              NOR=Hent brukt fõlgeseddel;
                                                              SVE=HÑmta anvÑnd utleverans] }
    { 8000;   ;Id                  ;GUID          ;CaptionML=[ENU=Id;
                                                              NOR=ID;
                                                              SVE=ID] }
    { 10605;  ;GLN                 ;Code13        ;CaptionML=[ENU=GLN;
                                                              NOR=GLN;
                                                              SVE=GLN];
                                                   Description=NAVNO (10605) }
    { 10606;  ;Account Code NO     ;Text30        ;CaptionML=[ENU=Account Code;
                                                              NOR=Kontokode;
                                                              SVE=Kontokod (DK)];
                                                   Description=NAVNO (10606) }
    { 10612;  ;E-Invoice Created   ;Boolean       ;CaptionML=[ENU=E-Invoice Created;
                                                              NOR=E-faktura er opprettet];
                                                   Description=NAVNO (10612);
                                                   Editable=No }
    { 10613;  ;E-Invoice           ;Boolean       ;CaptionML=[ENU=E-Invoice;
                                                              NOR=E-faktura;
                                                              SVE=E-faktura];
                                                   Description=NAVNO (106013) }
    { 13600;  ;EAN No.             ;Code13        ;CaptionML=[ENU=EAN No.;
                                                              SVE=EAN nr.];
                                                   Description=NAVDK (13600) }
    { 13601;  ;Electronic Invoice Created;Boolean ;CaptionML=ENU=Electronic Invoice Created;
                                                   Description=NAVDK (13601);
                                                   Editable=No }
    { 13602;  ;Account Code DK     ;Text30        ;CaptionML=[ENU=Account Code DK;
                                                              SVE=Kontokod (DK)];
                                                   Description=NAVDK (13602) }
    { 13604;  ;OIOUBL Profile Code ;Code10        ;TableRelation="OIOUBL Profile";
                                                   CaptionML=ENU=OIOUBL Profile Code;
                                                   Description=NAVDK (13604) }
    { 13605;  ;Sell-to Contact Phone No.;Text30   ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Sell-to Contact Phone No.;
                                                              SVE=Kîpares telefonnr];
                                                   Description=NAVDK (13605) }
    { 13606;  ;Sell-to Contact Fax No.;Text30     ;CaptionML=[ENU=Sell-to Contact Fax No.;
                                                              SVE=Kîpares Faxnr];
                                                   Description=NAVDK (13606) }
    { 13607;  ;Sell-to Contact E-Mail;Text80      ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Sell-to Contact E-Mail;
                                                              SVE=Kîpares e-post];
                                                   Description=NAVDK (13607) }
    { 13608;  ;Sell-to Contact Role;Option        ;CaptionML=ENU=Sell-to Contact Role;
                                                   OptionCaptionML=[ENU=" ,,,Purchase Responsible,,,Accountant,,,Budget Responsible,,,Requisitioner";
                                                                    SVE=" ,,,Inkîpsansvarig,,,Bokfîrare,,,Budgetansvarig,,,Anskaffning/rekvirera"];
                                                   OptionString=[ ,,,Purchase Responsible,,,Accountant,,,Budget Responsible,,,Requisitioner];
                                                   Description=NAVDK (13608) }
    { 13620;  ;Payment Channel     ;Option        ;CaptionML=[ENU=Payment Channel;
                                                              SVE=Betalningskanal];
                                                   OptionCaptionML=[ENU=" ,Payment Slip,Account Transfer,National Clearing,Direct Debit";
                                                                    SVE=" ,Talong,Kontoîverfîring,Bankîverfîring,Autogiro"];
                                                   OptionString=[ ,Payment Slip,Account Transfer,National Clearing,Direct Debit];
                                                   Description=NAVDK (13620) }
    { 11012000;;Project Invoice    ;Boolean       ;CaptionML=[ENU=Project Invoice;
                                                              NOR=Prosjektfaktura;
                                                              SVE=Projektfaktura] }
    { 11012005;;Job No.            ;Code20        ;TableRelation=Job;
                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 11012010;;Installment Invoice;Boolean       ;CaptionML=[ENU=Installment Invoice;
                                                              NOR=Avdragsfaktura;
                                                              SVE=Betalplansfaktura];
                                                   Editable=No }
    { 11012011;;Consumption Invoice;Boolean       ;CaptionML=ENU=Consumption Invoice }
    { 11012015;;Production Motivation Date;Date   ;TableRelation="Unit Price Production Mot."."Production Date" WHERE (Project No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Production Motivation Date;
                                                              NOR=Produksjonsmotivasjonsdato;
                                                              SVE=Datum fîr Produktionsorsak] }
    { 11012016;;Production Motivation Code;Code10 ;CaptionML=[ENU=Production Motivation Code;
                                                              NOR=Produksjonsmotivasjonskode;
                                                              SVE=Produktionsorsakskod] }
    { 11012020;;Invoice Text       ;Text250       ;CaptionML=[ENU=Invoice Text;
                                                              NOR=Fakturatekst;
                                                              SVE=Fakturatext] }
    { 11012030;;Interest Date      ;Date          ;CaptionML=[ENU=Interest Date;
                                                              NOR=Rentedato;
                                                              SVE=RÑntedatum] }
    { 11012040;;Related Sales Order No.;Code20    ;TableRelation="Sales Header".No. WHERE (Document Type=CONST(Order));
                                                   CaptionML=[ENU=Related Sales Order No.;
                                                              NOR=Relatert salgsordrenr;
                                                              SVE=Relaterat fîrs.ordernr] }
    { 11012258;;Company VAT Registration No.;Text20;
                                                   CaptionML=[ENU=Company VAT Registration No.;
                                                              NOR=Selskapets momsregistreringsnr;
                                                              SVE=Fîretagets momsregistreringsnr];
                                                   Editable=No }
    { 11012259;;Country/Region of Origin;Code10   ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region of Origin;
                                                              NOR=Opprinnelsesland/Opprinnelsesregion;
                                                              SVE=Ursprungsland/ursprungsregion];
                                                   Editable=No }
    { 11012260;;Country/Region of Destination;Code10;
                                                   TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region of Destination;
                                                              NOR=Destinasjonsland/destinasjonsregion;
                                                              SVE=Destinationsland/destinationsregion];
                                                   Editable=No }
    { 11012261;;Extended VAT Determination;Boolean;CaptionML=[ENU=Extended VAT Determination;
                                                              NOR=Utvidet momsbestemmelse;
                                                              SVE=Utîkad momsbestÑmning];
                                                   Editable=No }
    { 11012280;;Invoice Layout Code;Code10        ;TableRelation="Invoice Layout";
                                                   CaptionML=[ENU=Invoice Layout Code;
                                                              NOR=Fakturalayoutkode;
                                                              SVE=Fakturalayoutkod] }
    { 11012550;;Plant Invoice      ;Boolean       ;CaptionML=[ENU=Plant Invoice;
                                                              NOR=Maskinfaktura;
                                                              SVE=Maskinfaktura];
                                                   Editable=No }
    { 11012551;;Rental Period to Date;Date        ;CaptionML=[ENU=Rental Period to Date;
                                                              NOR=Leieperiode til dato;
                                                              SVE=Uthyrningsperiod till datum];
                                                   Editable=No }
    { 11012552;;Company Name       ;Text30        ;TableRelation=Company;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Company Name;
                                                              NOR=Navn pÜ selskap;
                                                              SVE=fîretagsnamn];
                                                   Editable=No }
    { 11012554;;Service Invoice    ;Boolean       ;CaptionML=[ENU=Service Invoice;
                                                              NOR=Servicefaktura;
                                                              SVE=Servicefaktura] }
    { 11012555;;Alternative Bill-to Address;Code10;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Bill-to Customer No.),
                                                                                               Billing Address=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                CheckInvoiceAddress;
                                                              END;

                                                   CaptionML=[ENU=Alternative Bill-to Address;
                                                              NOR=Alternativ Faktureringsadresse;
                                                              SVE=Alternativ faktureringsadress] }
    { 11012556;;Exported on        ;Date          ;CaptionML=[ENU=Exported on;
                                                              NOR=Eksportert den;
                                                              SVE=Exporterat den] }
    { 11012557;;Rental Unit Invoice;Boolean       ;CaptionML=[ENU=Rental Unit Invoice;
                                                              NOR=Leieenhetsfaktura;
                                                              SVE=Uthyrningsenhetsfaktura];
                                                   Editable=No }
    { 11012558;;Withhold % Last Installment;Decimal;
                                                   CaptionML=[ENU=Withhold % Last Installment;
                                                              NOR=Tilbakehold % Forrige Avdrag;
                                                              SVE=InnehÜll procentsats av senaste avbetalning] }
    { 11012559;;Public notary      ;Code20        ;TableRelation=Customer.No.;
                                                   CaptionML=[ENU=Public notary;
                                                              NOR=Notarius publicus;
                                                              SVE=Notarius publicus] }
    { 11012560;;Last Installment Amount;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Invoice Line"."Amount Including VAT" WHERE (Document No.=FIELD(No.),
                                                                                                                      Last Installment=CONST(Yes)));
                                                   CaptionML=[ENU=Last Installment Amount;
                                                              NOR=Siste avdragsbelõp;
                                                              SVE=Senaste avbetalningsbelopp];
                                                   Editable=No }
    { 11012561;;Notary Case Number ;Text30        ;CaptionML=[ENU=Notary Case Number;
                                                              NOR=Notariens Saksnummer;
                                                              SVE=Notariens Ñrendenummer];
                                                   Editable=No }
    { 11012562;;Calculate B Amounts based on;Option;
                                                   CaptionML=[ENU=Calculate B Amounts based on;
                                                              NOR=Beregn B-belõp basert pÜ;
                                                              SVE=BerÑkna B-belopp baserat pÜ];
                                                   OptionCaptionML=[ENU=Labor Amount,Invoice Amount;
                                                                    NOR=Arbeidskraftsbelõp,Faktureringsbelõp;
                                                                    SVE=Arbetskraftsbelopp,faktureringsbelopp];
                                                   OptionString=Labor Amount,Invoice Amount;
                                                   Editable=No }
    { 11012563;;Labor Amount (Subcontracting);Decimal;
                                                   CaptionML=[ENU=Labor Amount (Subcontracting);
                                                              NOR=Arbeidskraftsbelõp (Underentrepenõr);
                                                              SVE=Arbetskraftsbelopp (Underentreprenad)];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012564;;Blocked Amount (Subcontracting;Decimal;
                                                   CaptionML=[ENU=Blocked Amount (Subcontracting);
                                                              NOR=Sperret belõp (Underentrepenõr);
                                                              SVE=SpÑrrat belopp (Underentreprenad)];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012566;;Specific WKA Percentages;Boolean  ;CaptionML=[ENU=Specific WKA Percentages;
                                                              NOR=Spesifike WKA-Prosentsatser;
                                                              SVE=Specifika WKA-procentsatser] }
    { 11012567;;% Labor            ;Decimal       ;CaptionML=[ENU=% Labor;
                                                              NOR=% arbeidskraft;
                                                              SVE=Procent, arbetskraft];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   AutoFormatType=1 }
    { 11012568;;% to B Account     ;Decimal       ;CaptionML=[ENU=% to B Account;
                                                              NOR=% til B-konto;
                                                              SVE=Procent till B-konto];
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 11012570;;WKA Period         ;Text50        ;CaptionML=[ENU=WKA Period;
                                                              NOR=WKA-periode;
                                                              SVE=WKA-period] }
    { 11012580;;Amount VAT         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Invoice Line"."Line VAT Amount" WHERE (Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount VAT;
                                                              NOR=Mva-belõp;
                                                              SVE=Momsbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012585;;Sales Document Type;Option        ;CaptionML=[ENU=Sales Document Type;
                                                              NOR=Salgsdokumenttype;
                                                              SVE=Fîrs.dokumenttyp];
                                                   OptionCaptionML=[ENU=Standard,Sales Logistics Separated,Rental Contract;
                                                                    NOR=Standard,Salgslogistikk separert,Leiekontrakt;
                                                                    SVE=Standard,FîrsÑljningslogistik separerad,Uthyrningskontrakt];
                                                   OptionString=Standard,Sales Logistics Separated,RentalContract }
    { 11012590;;PDF Send Released  ;Boolean       ;CaptionML=[ENU=PDF Send Released;
                                                              NOR=PDF, send frigitte;
                                                              SVE=PDF, skicka slÑppta] }
    { 11012591;;PDF Document is Send;Boolean      ;OnValidate=VAR
                                                                OldRec@1100485000 : Record 112;
                                                              BEGIN
                                                                OldRec := Rec;

                                                                "PDF Date Send" := TODAY;
                                                                "PDF Sent by" := USERID;

                                                                PDFCreate();
                                                              END;

                                                   CaptionML=[ENU=PDF Document is Send;
                                                              NOR=PDF-dokumentet er sendt;
                                                              SVE=PDF-dokumentet har skickats];
                                                   Editable=No }
    { 11012592;;PDF Date Send      ;Date          ;CaptionML=[ENU=PDF Date Send;
                                                              NOR=PDF, dato sendt;
                                                              SVE=PDF, datum skickat];
                                                   Editable=No }
    { 11012593;;PDF Sent by        ;Text50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=PDF Sent by;
                                                              NOR=PDF, sendt av];
                                                   Editable=No }
    { 11012594;;PDF Print Code     ;Boolean       ;CaptionML=[ENU=PDF Print Code;
                                                              NOR=PDF-utskriftskode;
                                                              SVE=PDF-utskriftskod];
                                                   Editable=No }
    { 11012595;;XML-Export         ;Boolean       ;CaptionML=[ENU=XML-Export;
                                                              NOR=XML Õ eksporter;
                                                              SVE=XML Õ Exportera] }
    { 11012596;;XML Exported       ;Boolean       ;CaptionML=[ENU=XML Exported;
                                                              NOR=XML Õ eksportert;
                                                              SVE=XML har exporterats];
                                                   Editable=No }
    { 11012597;;Open Complaints    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Complaint Document" WHERE (Document Type=CONST(PI-S),
                                                                                                 Document No.=FIELD(No.),
                                                                                                 Complaint Status=FILTER(<>Finished)));
                                                   CaptionML=[ENU=Open Complaints;
                                                              NOR=èpne Klager;
                                                              SVE=ôppna incidenter];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 11012598;;Complaints         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Complaint Document" WHERE (Document Type=CONST(PI-S),
                                                                                                 Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Complaints;
                                                              NOR=Klage;
                                                              SVE=Incidenter];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 11012610;;Inserted By        ;Code50        ;TableRelation=User."User Name";
                                                   OnValidate=BEGIN
                                                                UserManagement.ValidateUserID("Inserted By"); //**4PS.n
                                                              END;

                                                   OnLookup=BEGIN
                                                              UserManagement.LookupUserID("Inserted By"); //**4PS.n
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Inserted By;
                                                              NOR=Satt inn av;
                                                              SVE=Infogad av] }
    { 11012804;;Service Contract No.;Code20       ;TableRelation=Service-Contract.No.;
                                                   CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr];
                                                   Editable=No }
    { 11012805;;Service Order No.  ;Code20        ;TableRelation="Service Order".No.;
                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr] }
    { 11012810;;Principal Reference;Text50        ;CaptionML=[ENU=Principal Reference;
                                                              NOR=Oppdragsgiverreferanse;
                                                              SVE=Uppdragsgivarreferens] }
    { 11012820;;Order No. Customer ;Text50        ;CaptionML=[ENU=Order No. Customer;
                                                              NOR=Ordrenr, (Kunde);
                                                              SVE=Ordernr, (kund)] }
    { 11012830;;Commision Date Customer;Date      ;CaptionML=[ENU=Commision Date Principal;
                                                              NOR=Kommisjonsdato, oppdragsgiver;
                                                              SVE=Provisionsdatum, uppdragsgivare] }
    { 11012840;;Ship-to Contact No.;Code20        ;TableRelation=Contact;
                                                   CaptionML=[ENU=Ship-to Contact No.;
                                                              NOR=Leveranse, Kontaktnr.;
                                                              SVE=Leverans, kontaktnr] }
    { 11012860;;Amount Payment in Advance;Decimal ;CaptionML=[ENU=Amount Payment in Advance;
                                                              NOR=Belõp, forskuddsbetaling;
                                                              SVE=Belopp, betalning i fîrskott];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012880;;Invoice Exported by XML;Boolean   ;CaptionML=[ENU=Invoice Exported by XML;
                                                              NOR=Faktura eksportert av XML;
                                                              SVE=Faktura exporterad till XML];
                                                   Editable=No }
    { 11020254;;Credit Restriction ;Code20        ;TableRelation="Credit Restriction";
                                                   CaptionML=[ENU=Credit Restriction;
                                                              NOR=Kreditrestriksjon;
                                                              SVE=Kreditrestriktion] }
    { 11020255;;Credit Restriction Date;Date      ;CaptionML=[ENU=Credit Restriction Date;
                                                              NOR=Kreditrestriksjonsdato;
                                                              SVE=Kreditrestriktionsdatum] }
    { 11020256;;Credit Restriction %;Decimal      ;CaptionML=[ENU=Credit Restriction %;
                                                              NOR=Kreditrestriksjon %;
                                                              SVE=Kreditrestriktion %];
                                                   DecimalPlaces=0:2 }
    { 11020257;;Credit Restriction Amount;Decimal ;CaptionML=[ENU=Credit Restriction Amount;
                                                              NOR=Kreditrestriksjonsbelõp;
                                                              SVE=Kreditrestriktionsbelopp];
                                                   DecimalPlaces=2:2 }
    { 11020280;;E-Mail (Invoices)  ;Text80        ;OnValidate=VAR
                                                                ContactDataValidation@1100528702 : Codeunit 11012275;
                                                                RecRef@1100528701 : RecordRef;
                                                                FldRef@1100528700 : FieldRef;
                                                              BEGIN
                                                                RecRef.GETTABLE(Rec);
                                                                FldRef := RecRef.FIELD(FIELDNO("E-Mail (Invoices)"));
                                                                ContactDataValidation.ValidateEmail(FldRef, "E-Mail (Invoices)");

                                                                IF "E-Mail (Invoices)" = '' THEN BEGIN
                                                                  "Invoice per E-Mail" := FALSE;
                                                                  IF "Electronic Invoicing" = "Electronic Invoicing"::"E-Mail" THEN
                                                                    "Electronic Invoicing" := "Electronic Invoicing"::Print;
                                                                END;
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email (Invoices);
                                                              SVE=E-post (Fakturor)] }
    { 11020281;;Invoice per E-Mail ;Boolean       ;OnValidate=BEGIN
                                                                IF "Invoice per E-Mail" THEN
                                                                  TESTFIELD("E-Mail (Invoices)");
                                                              END;

                                                   CaptionML=ENU=Invoice per Email;
                                                   Description=Obsolete }
    { 11020282;;E-Mail Sent by     ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              LoginManagement@1100528700 : Codeunit 418;
                                                            BEGIN
                                                              LoginManagement.LookupUserID("E-Mail Sent by");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Email Sent by;
                                                              SVE=E-post skickades av];
                                                   Editable=No }
    { 11020283;;E-Mail Sent on     ;Date          ;CaptionML=[ENU=Email Sent on;
                                                              SVE=E-post skickades den];
                                                   Editable=No }
    { 11020285;;Electronic Invoicing;Option       ;OnValidate=VAR
                                                                ServiceSetup@1100525000 : Record 11012800;
                                                                DispatchInterface@1100525001 : Codeunit 11071685;
                                                              BEGIN
                                                                IF "Electronic Invoicing" = "Electronic Invoicing"::"E-Mail" THEN
                                                                  TESTFIELD("E-Mail (Invoices)");

                                                                IF "Electronic Invoicing" = "Electronic Invoicing"::"Dispatch Woon" THEN BEGIN
                                                                  ServiceSetup.GET;
                                                                  ServiceSetup.TESTFIELD("Dispatch Woon Active", TRUE);
                                                                  DispatchInterface.TestPreliminariesSalesInvoiceHeader("No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Electronic Invoicing;
                                                              NOR=Elektronisk fakturering;
                                                              SVE=Elektronisk fakturering];
                                                   OptionCaptionML=[ENU=Print,,E-Mail,,GLN (XML),eVerbinding,Svefaktura (XML),OIOUBL (DK),,INSBOU (Web Service),Document management,,,Dispatch Woon;
                                                                    SVE=Skriv ut,,E-post,,GLN (XML),eVerbinding,Svefaktura (XML),OIOUBL (DK),,INSBOU (Web Service),Document management,,,Dispatch Woon];
                                                   OptionString=Print,,E-Mail,,GLN (XML),eVerbinding,Svefaktura (XML),OIOUBL (DK),,INSBOU (Web Service),DocumentManagement,,,Dispatch Woon }
    { 11020286;;Combine E-Mail Attachments;Boolean;CaptionML=[ENU=Combine Email Attachments;
                                                              SVE=Kombinera E-post bilagor] }
    { 11020287;;NAV 2009 Invoice   ;Boolean       ;CaptionML=ENU=NAV 2009 Invoice }
    { 11020290;;Batch Seq. No.     ;Code20        ;TableRelation="Invoice Proposal Batch Seq.";
                                                   CaptionML=ENU=Batch Seq. No.;
                                                   Editable=No }
    { 11020300;;Collective List No. (Res.Req.);Code20;
                                                   TableRelation="Resource Req. Collective-List";
                                                   CaptionML=ENU=Collective List No. (Resource Request);
                                                   Editable=No }
    { 11020320;;Advance Payments   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Invoice Line".Amount WHERE (Document No.=FIELD(No.),
                                                                                                      Advance Payment=CONST(Yes)));
                                                   CaptionML=ENU=Advance Payments;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11128014;;E-Invoice Layout Code;Code10       }
    { 11128020;;ROT/RUT Reduction  ;Boolean       ;CaptionML=SVE=ROT/RUT avdrag;
                                                   Description=I.012 }
    { 11128030;;Netting Exported   ;Boolean       ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Netting Exported;
                                                              SVE=Netting Exporterad];
                                                   Description=Certego Integration 7 (Netting) }
    { 11128031;;Netting Exported Date;Date        ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Netting Exported Date;
                                                              SVE=Netting Exporterad datum];
                                                   Description=Certego Integration 7 (Netting) }
    { 11128050;;Installment text   ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Job Ledger Entry".Description WHERE (Project Invoice=CONST(Yes),
                                                                                                            Installment Invoice=CONST(Yes),
                                                                                                            Principal=FIELD(Bill-to Customer No.),
                                                                                                            Document No.=FIELD(No.)));
                                                   OnLookup=VAR
                                                              ProjectInstallment@1100285100 : Record 11012018;
                                                            BEGIN
                                                              ProjectInstallment.SETRANGE(Principal,"Bill-to Customer No.");
                                                              ProjectInstallment.SETRANGE("Document (Invoiced)","No.");
                                                              IF "Job No." <> '' THEN
                                                                ProjectInstallment.SETRANGE("Project No.","Job No.");
                                                              PAGE.RUN(0,ProjectInstallment);
                                                            END;

                                                   CaptionML=[ENU=Description Project Installment;
                                                              NOR=Beskrivelse Prosjektavdrag;
                                                              SVE=Beskrivning Projektavbetalning];
                                                   Description=RFC-217;
                                                   Editable=No }
    { 11128910;;Retention %        ;Decimal       ;CaptionML=[ENU=Retention %;
                                                              NOR=Gjenvërende %;
                                                              SVE=KvarstÜende procent];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PSNA }
    { 11128920;;Retention % 2      ;Decimal       ;CaptionML=[ENU=Retention % 2;
                                                              NOR=Gjenvërende % 2;
                                                              SVE=KvarstÜende procent 2];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PSNA }
    { 11250712;;Finvoice Enabled   ;Boolean       ;CaptionML=ENU=Finvoice Enabled;
                                                   Description=4PSFI_FINVOICE }
    { 11250718;;Finvoice No. Exported;Integer     ;CaptionML=ENU=Finvoice No. Exported;
                                                   Description=4PSFI_FINVOICE }
    { 11250719;;Factoring No. Exported;Integer    ;CaptionML=ENU=Factoring No. Exported;
                                                   Description=4PSFI_FINVOICE }
    { 32000000;;Reference No.      ;Code20        ;CaptionML=[ENU=Reference No.;
                                                              SVE=Referensnummer];
                                                   Description=NAVFI (32000000);
                                                   Editable=Yes }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Order No.                                }
    {    ;Pre-Assigned No.                         }
    {    ;Sell-to Customer No.,External Document No.;
                                                   MaintainSQLIndex=No }
    {    ;Sell-to Customer No.,Order Date         ;MaintainSQLIndex=No }
    {    ;Sell-to Customer No.                     }
    {    ;Prepayment Order No.,Prepayment Invoice  }
    {    ;Bill-to Customer No.                     }
    {    ;Posting Date                             }
    {    ;Document Exchange Status                 }
    {    ;Due Date                                 }
    {    ;Service Contract No.                     }
    {    ;Batch Seq. No.                           }
    {    ;Invoice Exported by XML,Electronic Invoicing,Electronic Invoice Created }
    {    ;Service Order No.,No.                    }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Sell-to Customer No.,Bill-to Customer No.,Posting Date,Posting Description }
    { 2   ;Brick               ;No.,Sell-to Customer Name,Amount,Due Date,Amount Including VAT }
  }
  CODE
  {
    VAR
      SalesCommentLine@1001 : Record 44;
      SalesSetup@1007 : Record 311;
      CustLedgEntry@1003 : Record 21;
      DimMgt@1005 : Codeunit 408;
      ApprovalsMgmt@1008 : Codeunit 1535;
      UserSetupMgt@1002 : Codeunit 5700;
      PaymentReferenceLblDK@1060000 : TextConst '@@@=Translate to FIK-kode (FIK is danish abbreviation );ENU=FIK Code';
      DocTxt@1000 : TextConst 'ENU=Invoice;NOR=Faktura;SVE=Faktura';
      PaymentReference@1214 : Text;
      PaymentReferenceLbl@1215 : Text;
      DPA_Management@1100000999 : Codeunit 11012783;
      Text11012001@1100528200 : TextConst 'ENU=No %1 sent, because the %2 is set to %3.;NOR=Nr %1 sendt, fordi %2 er satt til %3';
      UserManagement@1100525000 : Codeunit 418;
      Text11012002@1100528400 : TextConst 'ENU=Invoice;NOR=Faktura;SVE=Faktura';
      DocumentMailing@1100525001 : Codeunit 260;
      Text11012003@1100525002 : TextConst 'ENU=Invoice does not originate from Buyer Management.';
      GLSetup@1100285501 : Record 98;
      gotGLSetup@1100285500 : Boolean;
      txtCreateSvefaktura@1100285502 : TextConst 'ENU=Create and send Svefaktura?;NOR=Lag og send Svefaktura?;SVE=Vill du skapa och skicka Svefaktura?';
      txtAlreadyCreatedSvefaktura@1100285503 : TextConst 'ENU=Electronic invoice has already been created. Would you like to create and send it again?;NOR=Efaktura har allerede blitt laget. Vil du lage og sende den igjen?;SVE=En svefaktura har redan skapats tidigare. Vill du skapa och skicka en pÜ nytt?';

    [External]
    PROCEDURE IsFullyOpen@26() : Boolean;
    BEGIN
      CALCFIELDS("Amount Including VAT","Remaining Amount");
      EXIT("Amount Including VAT" = "Remaining Amount");
    END;

    [Internal]
    PROCEDURE SendRecords@12();
    VAR
      DocumentSendingProfile@1001 : Record 60;
      DummyReportSelections@1000 : Record 77;
      IsHandled@1002 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeSendRecords(DummyReportSelections,Rec,DocTxt,IsHandled);
      IF NOT IsHandled THEN
        DocumentSendingProfile.SendCustomerRecords(
          DummyReportSelections.Usage::"S.Invoice",Rec,DocTxt,"Bill-to Customer No.","No.",
          FIELDNO("Bill-to Customer No."),FIELDNO("No."));
    END;

    [External]
    PROCEDURE SendProfile@72(VAR DocumentSendingProfile@1000 : Record 60);
    VAR
      DummyReportSelections@1003 : Record 77;
      IsHandled@1001 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeSendProfile(DummyReportSelections,Rec,DocTxt,IsHandled,DocumentSendingProfile);
      IF NOT IsHandled THEN
      BEGIN //**4PS.n
        DocumentMailing.SetGlobalLanguage("Language Code"); //**4PS.n
        DocumentSendingProfile.Send(
          DummyReportSelections.Usage::"S.Invoice",Rec,"No.","Bill-to Customer No.",
          DocTxt,FIELDNO("Bill-to Customer No."),FIELDNO("No."),NOT DocumentSendingProfile."Silent download");
        DocumentMailing.ResetGlobalLanguage; //**4PS.n
      END; //**4PS.n
    END;

    [External]
    PROCEDURE PrintRecords@1(ShowRequestPage@1000 : Boolean;AllowReportSelPage@1100525000 : Boolean);
    VAR
      DocumentSendingProfile@1002 : Record 60;
      DummyReportSelections@1001 : Record 77;
      IsHandled@1003 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforePrintRecords(DummyReportSelections,Rec,ShowRequestPage,IsHandled);
      IF NOT IsHandled THEN
        DocumentSendingProfile.TrySendToPrinter(
        //DummyReportSelections.Usage::"S.Invoice",Rec,FIELDNO("Bill-to Customer No."),ShowRequestPage); //**4PS.o
          DummyReportSelections.Usage::"S.Invoice",Rec,FIELDNO("Bill-to Customer No."),ShowRequestPage,AllowReportSelPage); //**4PS.n
    END;

    [External]
    PROCEDURE EmailRecords@17(ShowDialog@1000 : Boolean);
    VAR
      DocumentSendingProfile@1003 : Record 60;
      DummyReportSelections@1001 : Record 77;
      IsHandled@1002 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeEmailRecords(DummyReportSelections,Rec,DocTxt,ShowDialog,IsHandled);
      IF NOT IsHandled THEN
      BEGIN //**4PS.n
        DocumentMailing.SetGlobalLanguage("Language Code"); //**4PS.n
        DocumentSendingProfile.TrySendToEMail(
          DummyReportSelections.Usage::"S.Invoice",Rec,FIELDNO("No."),DocTxt,FIELDNO("Bill-to Customer No."),ShowDialog);
        DocumentMailing.ResetGlobalLanguage; //**4PS.n
      END; //**4PS.n
    END;

    [External]
    PROCEDURE GetDocTypeTxt@140() : Text[50];
    BEGIN
      EXIT(DocTxt);
    END;

    PROCEDURE EmailRecordFromBatchPost@1100528504();
    VAR
      SalesInvoiceHeader@1100528400 : Record 112;
    BEGIN
      //**4PS
      SalesInvoiceHeader.COPY(Rec);
      SalesInvoiceHeader.SETRECFILTER;
      SalesInvoiceHeader.EmailRecords(FALSE);
    END;

    PROCEDURE CreatePDF@1100528501(ReportID@1100528501 : Integer;PDFIsPrinted@1100528401 : Boolean;VAR TempEmailAttachment@1100528505 : TEMPORARY Record 11229294;VAR SalesInvoiceHeader@1100528500 : Record 112);
    VAR
      ReportSelections@1100525000 : Record 77;
      MailTemplateNo@1100528300 : Integer;
    BEGIN
      //**4PS
      MailTemplateNo := 1;
      ReportSelections.SaveAnyRecordReportAsPdf(
        SalesInvoiceHeader, MailTemplateNo, SalesInvoiceHeader."Shortcut Dimension 1 Code",
        ReportID, TRUE, PDFIsPrinted, DocTxt, SalesInvoiceHeader."No.", TempEmailAttachment);
    END;

    [External]
    PROCEDURE Navigate@2();
    VAR
      NavigateForm@1000 : Page 344;
    BEGIN
      NavigateForm.SetDoc("Posting Date","No.");
      NavigateForm.RUN;
    END;

    [External]
    PROCEDURE LookupAdjmtValueEntries@3();
    VAR
      ValueEntry@1000 : Record 5802;
    BEGIN
      ValueEntry.SETCURRENTKEY("Document No.");
      ValueEntry.SETRANGE("Document No.","No.");
      ValueEntry.SETRANGE("Document Type",ValueEntry."Document Type"::"Sales Invoice");
      ValueEntry.SETRANGE(Adjustment,TRUE);
      PAGE.RUNMODAL(0,ValueEntry);
    END;

    [External]
    PROCEDURE GetCustomerVATRegistrationNumber@14() : Text;
    BEGIN
      EXIT("VAT Registration No.");
    END;

    [External]
    PROCEDURE GetCustomerVATRegistrationNumberLbl@15() : Text;
    BEGIN
      IF "VAT Registration No." = '' THEN
        EXIT('');
      EXIT(FIELDCAPTION("VAT Registration No."));
    END;

    [External]
    PROCEDURE GetCustomerGlobalLocationNumber@8() : Text;
    VAR
      Customer@1000 : Record 18;
    BEGIN
      IF Customer.GET("Sell-to Customer No.") THEN
        EXIT(Customer.GLN);
      //NAVDK
      IF GLSetup."Danish Localization Active" THEN
        EXIT("EAN No.");
      //NAVNO
      IF GLSetup."Norwegian Localization Active" THEN
        EXIT(GLN);
      EXIT('');
    END;

    [External]
    PROCEDURE GetCustomerGlobalLocationNumberLbl@10() : Text;
    VAR
      Customer@1000 : Record 18;
    BEGIN
      IF Customer.GET("Sell-to Customer No.") THEN
        EXIT(Customer.FIELDCAPTION(GLN));
      //NAVDK
      IF GLSetup."Danish Localization Active" THEN
        EXIT(FIELDCAPTION("EAN No."));
      //NAVNO
      IF GLSetup."Norwegian Localization Active" THEN
        EXIT(FIELDCAPTION(GLN));
      EXIT('');
    END;

    PROCEDURE GetSellToCustomerFaxNo@209() : Text;
    VAR
      Customer@1000 : Record 18;
    BEGIN
      IF Customer.GET("Sell-to Customer No.") THEN
        EXIT(Customer."Fax No.");
    END;

    [External]
    PROCEDURE GetPaymentReference@9() : Text;
    BEGIN
      //NAVFI
      GetGLSetup;
      SalesSetup.GET;
      IF GLSetup."Finnish localization active" AND SalesSetup."Print Reference No." THEN
        EXIT("Reference No.");

      //NAVDK
      IF GLSetup."Danish Localization Active" THEN
        EXIT(GetFIK71String);
      OnGetPaymentReference(PaymentReference);
      EXIT(PaymentReference);
    END;

    [External]
    PROCEDURE GetPaymentReferenceLbl@11() : Text;
    BEGIN
      //NAVFI
      GetGLSetup;
      IF GLSetup."Finnish localization active" THEN
        EXIT(FIELDCAPTION("Reference No."));

      //NAVDK
      IF GLSetup."Danish Localization Active" THEN
        EXIT(PaymentReferenceLblDK);
      OnGetPaymentReferenceLbl(PaymentReferenceLbl);
      EXIT(PaymentReferenceLbl);
    END;

    [External]
    PROCEDURE GetLegalStatement@60() : Text;
    BEGIN
      //NAVFI
      GetGLSetup;
      IF GLSetup."Finnish localization active" AND "EU 3-Party Trade" THEN
        EXIT(FIELDCAPTION("EU 3-Party Trade"));

      SalesSetup.GET;
      EXIT(SalesSetup.GetLegalStatement);
    END;

    [External]
    PROCEDURE GetRemainingAmount@6() : Decimal;
    VAR
      CustLedgerEntry@1000 : Record 21;
    BEGIN
      CustLedgerEntry.SETRANGE("Customer No.","Bill-to Customer No.");
      CustLedgerEntry.SETRANGE("Posting Date","Posting Date");
      CustLedgerEntry.SETRANGE("Document Type",CustLedgerEntry."Document Type"::Invoice);
      CustLedgerEntry.SETRANGE("Document No.","No.");
      CustLedgerEntry.SETAUTOCALCFIELDS("Remaining Amount");

      IF NOT CustLedgerEntry.FINDFIRST THEN
        EXIT(0);

      EXIT(CustLedgerEntry."Remaining Amount");
    END;

    [External]
    PROCEDURE ShowDimensions@4();
    BEGIN
      DimMgt.ShowDimensionSet("Dimension Set ID",STRSUBSTNO('%1 %2',TABLECAPTION,"No."));
    END;

    [External]
    PROCEDURE SetSecurityFilterOnRespCenter@5();
    BEGIN
      IF UserSetupMgt.GetSalesFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetSalesFilter);
        FILTERGROUP(0);
      END;
    END;

    PROCEDURE AccountCodeNOLineSpecified@1080000() : Boolean;
    VAR
      SalesInvLine@1080000 : Record 113;
    BEGIN
      //NAVNO
      SalesInvLine.RESET;
      SalesInvLine.SETRANGE("Document No.","No.");
      SalesInvLine.SETFILTER(Type,'>%1',SalesInvLine.Type::" ");
      SalesInvLine.SETFILTER("Account Code NO",'<>%1&<>%2','',"Account Code NO");
      EXIT(NOT SalesInvLine.ISEMPTY);
    END;

    PROCEDURE TaxLineSpecified@1101100001() : Boolean;
    VAR
      SalesInvLine@1101100001 : Record 113;
    BEGIN
      //NAVDK
      SalesInvLine.RESET;
      SalesInvLine.SETRANGE("Document No.", "No.");
      SalesInvLine.SETFILTER(Type, '>%1', SalesInvLine.Type::" ");
      SalesInvLine.FIND('-');
      SalesInvLine.SETFILTER("VAT %", '<>%1', SalesInvLine."VAT %");
      EXIT(NOT SalesInvLine.ISEMPTY);
    END;

    PROCEDURE GetFIK71String@1060000() : Text;
    VAR
      CompanyInformation@1060004 : Record 79;
      FikManagement@1060005 : Codeunit 11128589;
      StringLen@1060002 : Integer;
      CheckSum@1060001 : Integer;
      Total@1060006 : Integer;
      Weight@1060003 : Text;
      String@1060000 : Text;
    BEGIN
      //NAVDK
      StringLen := 15;

      IF STRLEN("No.") > (StringLen - 1) THEN
        EXIT;

      IF DELCHR("No.",'=','0123456789') <> '' THEN
        EXIT;

      CompanyInformation.GET;
      IF CompanyInformation."Bank Creditor No." = '' THEN
        EXIT;

      String := PADSTR('',(StringLen - 1 - STRLEN("No.")),'0') + "No.";
      Weight := '12121212121212';
      FikManagement.CreateFIKCheckSum(String,Weight,Total,CheckSum);

      EXIT('+71<' + String + FORMAT(CheckSum) + '+' + CompanyInformation."Bank Creditor No.");
    END;

    [External]
    PROCEDURE GetDocExchStatusStyle@13() : Text;
    BEGIN
      CASE "Document Exchange Status" OF
        "Document Exchange Status"::"Not Sent":
          EXIT('Standard');
        "Document Exchange Status"::"Sent to Document Exchange Service":
          EXIT('Ambiguous');
        "Document Exchange Status"::"Delivered to Recipient":
          EXIT('Favorable');
        ELSE
          EXIT('Unfavorable');
      END;
    END;

    [External]
    PROCEDURE ShowActivityLog@116();
    VAR
      ActivityLog@1000 : Record 710;
    BEGIN
      ActivityLog.ShowEntries(RECORDID);
    END;

    [External]
    PROCEDURE GetSelectedPaymentsText@84() : Text;
    VAR
      PaymentServiceSetup@1000 : Record 1060;
    BEGIN
      EXIT(PaymentServiceSetup.GetSelectedPaymentsText("Payment Service Set ID"));
    END;

    [External]
    PROCEDURE GetWorkDescription@113() : Text;
    BEGIN
      CALCFIELDS("Work Description");
      EXIT(GetWorkDescriptionWorkDescriptionCalculated);
    END;

    [External]
    PROCEDURE GetWorkDescriptionWorkDescriptionCalculated@7() : Text;
    VAR
      TempBlob@1000 : TEMPORARY Record 99008535;
      CR@1004 : Text[1];
    BEGIN
      IF NOT "Work Description".HASVALUE THEN
        EXIT('');

      CR[1] := 10;
      TempBlob.Blob := "Work Description";
      EXIT(TempBlob.ReadAsText(CR,TEXTENCODING::UTF8));
    END;

    [External]
    PROCEDURE GetCurrencySymbol@145() : Text[10];
    VAR
      GeneralLedgerSetup@1000 : Record 98;
      Currency@1001 : Record 4;
    BEGIN
      IF GeneralLedgerSetup.GET THEN
        IF ("Currency Code" = '') OR ("Currency Code" = GeneralLedgerSetup."LCY Code") THEN
          EXIT(GeneralLedgerSetup.GetCurrencySymbol);

      IF Currency.GET("Currency Code") THEN
        EXIT(Currency.GetCurrencySymbol);

      EXIT("Currency Code");
    END;

    [External]
    PROCEDURE DocExchangeStatusIsSent@18() : Boolean;
    BEGIN
      EXIT("Document Exchange Status" <> "Document Exchange Status"::"Not Sent");
    END;

    [External]
    PROCEDURE ShowCanceledOrCorrCrMemo@22();
    BEGIN
      CALCFIELDS(Cancelled,Corrective);
      CASE TRUE OF
        Cancelled:
          ShowCorrectiveCreditMemo;
        Corrective:
          ShowCancelledCreditMemo;
      END;
    END;

    [External]
    PROCEDURE ShowCorrectiveCreditMemo@19();
    VAR
      CancelledDocument@1000 : Record 1900;
      SalesCrMemoHeader@1001 : Record 114;
    BEGIN
      CALCFIELDS(Cancelled);
      IF NOT Cancelled THEN
        EXIT;

      IF CancelledDocument.FindSalesCancelledInvoice("No.") THEN BEGIN
        SalesCrMemoHeader.GET(CancelledDocument."Cancelled By Doc. No.");
        PAGE.RUN(PAGE::"Posted Sales Credit Memo",SalesCrMemoHeader);
      END;
    END;

    [External]
    PROCEDURE ShowCancelledCreditMemo@20();
    VAR
      CancelledDocument@1000 : Record 1900;
      SalesCrMemoHeader@1001 : Record 114;
    BEGIN
      CALCFIELDS(Corrective);
      IF NOT Corrective THEN
        EXIT;

      IF CancelledDocument.FindSalesCorrectiveInvoice("No.") THEN BEGIN
        SalesCrMemoHeader.GET(CancelledDocument."Cancelled Doc. No.");
        PAGE.RUN(PAGE::"Posted Sales Credit Memo",SalesCrMemoHeader);
      END;
    END;

    [External]
    PROCEDURE GetDefaultEmailDocumentName@21() : Text[150];
    BEGIN
      EXIT(DocTxt);
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeEmailRecords@25(VAR ReportSelections@1003 : Record 77;VAR SalesInvoiceHeader@1002 : Record 112;DocTxt@1004 : Text;ShowDialog@1001 : Boolean;VAR IsHandled@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforePrintRecords@24(VAR ReportSelections@1003 : Record 77;VAR SalesInvoiceHeader@1002 : Record 112;ShowRequestPage@1001 : Boolean;VAR IsHandled@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeSendProfile@23(VAR ReportSelections@1003 : Record 77;VAR SalesInvoiceHeader@1002 : Record 112;DocTxt@1001 : Text;VAR IsHandled@1000 : Boolean;VAR DocumentSendingProfile@1004 : Record 60);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeSendRecords@16(VAR ReportSelections@1000 : Record 77;VAR SalesInvoiceHeader@1001 : Record 112;DocTxt@1002 : Text;VAR IsHandled@1003 : Boolean);
    BEGIN
    END;

    [Integration(TRUE)]
    LOCAL PROCEDURE OnGetPaymentReference@1214(VAR PaymentReference@1213 : Text);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetPaymentReferenceLbl@1213(VAR PaymentReferenceLbl@1213 : Text);
    BEGIN
    END;

    PROCEDURE CheckInvoiceAddress@1210190002();
    VAR
      AdrsRec@1210190000 : Record 222;
    BEGIN
      //**4PS
      IF "Alternative Bill-to Address" <> '' THEN BEGIN
        IF NOT AdrsRec.GET("Bill-to Customer No.", "Alternative Bill-to Address") THEN
          AdrsRec.INIT;
        "Bill-to Name" := AdrsRec.Name;
        "Bill-to Name 2" := AdrsRec."Name 2";
        "Bill-to Address" := AdrsRec.Address;
        "Bill-to Address 2" := AdrsRec."Address 2";
        "Bill-to Post Code" := AdrsRec."Post Code";
        "Bill-to City" := AdrsRec.City;
        "Bill-to Contact" := AdrsRec.Contact;
      END;
    END;

    PROCEDURE PDFPrint@1100485010();
    VAR
      lvCustomerRec@1100485001 : Record 18;
      PrintedCU@1000000000 : Codeunit 315;
      SalesInvHeader@1100485000 : Record 112;
      SalesInvLine@1100485003 : Record 113;
      DocPrint@1100485004 : Codeunit 229;
      TempReportSelection@1100485005 : TEMPORARY Record 77;
      SalesSetup@1100525000 : Record 311;
    BEGIN
      //**4PS
      SalesSetup.GET;
      WITH SalesInvHeader DO BEGIN
        COPY(Rec);
        SETRECFILTER;
        PrintedCU."PDF-BEGIN"(SalesInvHeader);
        DocPrint.GetReportSelectionForPrintUsage(
          TempReportSelection.Usage::"S.Invoice",'',FALSE,TempReportSelection);
        TempReportSelection.FIND('-');
        REPEAT
          REPORT.RUNMODAL(TempReportSelection."Report ID",FALSE,TRUE,SalesInvHeader);
        UNTIL TempReportSelection.NEXT = 0;

        lvCustomerRec.GET("Sell-to Customer No.");

        IF "XML-Export" OR lvCustomerRec."XML-Export" THEN
          IF SalesSetup."Export XMLport Sales Inv." <> 0 THEN BEGIN
            SalesInvLine.SETRANGE("Document No.","No.");
            XMLPORT.RUN(SalesSetup."Export XMLport Sales Inv.", FALSE, FALSE ,SalesInvLine);
            GET(SalesInvHeader."No.");
            "XML Exported" := TRUE;
            PrintedCU."PDF-MODIFY"(SalesInvHeader);
          END;
        GET(SalesInvHeader."No.");
        PrintedCU."PDF-END"(SalesInvHeader);

      END;
    END;

    PROCEDURE PDFSend@1000000001();
    VAR
      PrintedCU@1100485000 : Codeunit 315;
    BEGIN
      //**4PS
      TESTFIELD("PDF Send Released",TRUE);
      IF NOT "PDF Document is Send" THEN
        BEGIN
          VALIDATE("PDF Document is Send",TRUE);
          PrintedCU."PDF-MODIFY"(Rec);
        END;
    END;

    PROCEDURE PDFSetSendOK@1000000003();
    VAR
      PrintedCU@1100485000 : Codeunit 315;
    BEGIN
      //**4PS
      IF NOT "PDF Document is Send" THEN
        BEGIN
          VALIDATE("PDF Send Released",TRUE);
          PrintedCU."PDF-MODIFY"(Rec);
        END;
    END;

    PROCEDURE PDFResetSendOK@1000000002();
    VAR
      PrintedCU@1100485000 : Codeunit 315;
    BEGIN
      //**4PS
      IF NOT "PDF Document is Send" THEN
        BEGIN
          VALIDATE("PDF Send Released",FALSE);
          PrintedCU."PDF-MODIFY"(Rec);
        END;
    END;

    PROCEDURE XMLExport@1107100000();
    VAR
      SalesSetup@1100485001 : Record 311;
      SalesInvLine@1100485000 : Record 113;
      PrintedCU@1100485002 : Codeunit 315;
    BEGIN
      //**4PS
      SalesSetup.GET;
      IF SalesSetup."Export XMLport Sales Inv." <> 0 THEN BEGIN
        SalesInvLine.SETRANGE("Document No.","No.");
        XMLPORT.RUN(SalesSetup."Export XMLport Sales Inv.", FALSE, FALSE, SalesInvLine);
        "XML Exported" := TRUE;
        PrintedCU."PDF-MODIFY"(Rec);
      END;
    END;

    PROCEDURE XMLSetExport@1100485000();
    VAR
      PrintedCU@1100485000 : Codeunit 315;
    BEGIN
      //**4PS
      IF NOT "PDF Document is Send" THEN
        BEGIN
          VALIDATE("XML-Export",TRUE);
          PrintedCU."PDF-MODIFY"(Rec);
        END;
    END;

    PROCEDURE XMLResetExport@1100485001();
    VAR
      PrintedCU@1100485000 : Codeunit 315;
    BEGIN
      //**4PS
      IF NOT "PDF Document is Send" THEN
        BEGIN
          VALIDATE("XML-Export",FALSE);
          PrintedCU."PDF-MODIFY"(Rec);
        END;
    END;

    PROCEDURE PDFCreate@1000000000();
    VAR
      lvPrintPDFRec@1100485000 : Record 11020304;
    BEGIN
      //**4PS
      lvPrintPDFRec.RESET;
      lvPrintPDFRec."Document Code" := 'INV';
      lvPrintPDFRec."Document No" := "No.";
      lvPrintPDFRec.INSERT;
    END;

    PROCEDURE DPA_SetDefaultDpmtFromNoSeries@1100000995(xRecRef@1100525002 : RecordRef);
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      xRecRef.SETTABLE(xRec);
      DPA_Management.SetDepartmentCodeNoSeries(
        TABLENAME,
        "Shortcut Dimension 1 Code",
        "No. Series",
        xRec."No. Series" );
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(112) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 112');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Sales Invoice Header", "Shortcut Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Shortcut Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Shortcut Dimension 1 Code");
    END;

    PROCEDURE EditDocuments@1100528702(DocumentTemplateTypeFilter@1210190003 : Text[250];ContactNo@1210190004 : Code[20];ContactPersonNo@1210190005 : Code[20];SendMail@1210190002 : Boolean;Recipient@1100528700 : Text[120]);
    VAR
      SalesInvoiceLine@1100528701 : Record 113;
      Job@1100528704 : Record 11072003;
      ResponsibilityCenter@1100528705 : Record 5714;
      ProjectNo@1100528703 : Code[20];
      DocumentMailing@1210190000 : Codeunit 11012278;
      RecRef@1100525000 : RecordRef;
      DocumentLinkRIDs@1100525001 : ARRAY [5] OF RecordID;
    BEGIN
      //**4PS
      RecRef.GETTABLE(Rec);
      DocumentLinkRIDs[1] := RecRef.RECORDID;

      SalesInvoiceLine.SETRANGE("Document No.", "No.");
      IF SalesInvoiceLine.FINDSET THEN
        REPEAT
          ProjectNo := SalesInvoiceLine."Job No.";
        UNTIL (SalesInvoiceLine.NEXT = 0) OR (ProjectNo <> '');

      IF ProjectNo <> '' THEN BEGIN
        Job.GET(ProjectNo);
        RecRef.GETTABLE(Job);
        DocumentLinkRIDs[2] := RecRef.RECORDID;
      END;

      IF ResponsibilityCenter.GET("Responsibility Center") THEN BEGIN
        RecRef.GETTABLE(ResponsibilityCenter);
        DocumentLinkRIDs[3] := RecRef.RECORDID;
      END;

      DocumentMailing.EditDocuments(
        DocumentTemplateTypeFilter, DocumentLinkRIDs,
        "Shortcut Dimension 1 Code", ContactNo, ContactPersonNo, SendMail, Recipient);
    END;

    PROCEDURE SendInvoiceElectronic@1210190009(SelectSendOption@1100528701 : Boolean;FromBatchPost@1100528202 : Boolean);
    VAR
      SalesInvHeader@1210190002 : Record 112;
      SelectSendOptionSalesHdr@1210190004 : Page 11126492;
      SendSalesInvoiceGS1@1210190003 : Report 11020205;
      SendSalesInvoiceDigipoort@1100528201 : Report 11229762;
      INSBOUInterface@1100528800 : Codeunit 11012480;
      DispatchInterface@1100525000 : Codeunit 11071685;
      ExportSvefaktura@1100285500 : Codeunit 11128055;
      CreateDKElectronicInvoices@1000 : Report 11128570;
      GLSetup@1100285501 : Record 98;
      SalesRecSetup@1100285000 : Record 311;
      SvefakturaSetup@111280000 : Record 11128035;
    BEGIN
      //**4PS, DP00141, Digipoort Invoice
      SalesInvHeader.COPY(Rec);
      SalesInvHeader.SETRECFILTER;

      IF (SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::Print) THEN
      BEGIN
        IF GUIALLOWED THEN
          MESSAGE(Text11012001,
            SalesInvHeader.TABLECAPTION, SalesInvHeader.FIELDCAPTION("Electronic Invoicing"),
            SalesInvHeader."Electronic Invoicing");
        ERROR('');
      END;

      IF SelectSendOption THEN BEGIN
        SelectSendOptionSalesHdr.SetSelectEmail(
          SalesInvHeader."Electronic Invoicing" =
          SalesInvHeader."Electronic Invoicing"::"E-Mail");
        SelectSendOptionSalesHdr.SetSelectGLNXML(
          SalesInvHeader."Electronic Invoicing" =
          SalesInvHeader."Electronic Invoicing"::"GLN (XML)");
        SelectSendOptionSalesHdr.SetSelectDigipoort(
          SalesInvHeader."Electronic Invoicing" =
          SalesInvHeader."Electronic Invoicing"::eVerbinding);
          // 140702 <<
        SelectSendOptionSalesHdr.SetSelectSvefaktura(
          SalesInvHeader."Electronic Invoicing" =
          SalesInvHeader."Electronic Invoicing"::"Svefaktura (XML)");
          //140702 >>
        //>>NAVDK
        SelectSendOptionSalesHdr.SetSelectOIOUBL(
          SalesInvHeader."Electronic Invoicing" =
          SalesInvHeader."Electronic Invoicing"::"OIOUBL (DK)");
        //<<NAVDK
        SelectSendOptionSalesHdr.SetSelectINSBOU(
          SalesInvHeader."Electronic Invoicing" =
          SalesInvHeader."Electronic Invoicing"::"INSBOU (Web Service)");
        SelectSendOptionSalesHdr.SetSelectDispatchWoon(
          SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::"Dispatch Woon");
        IF (SelectSendOptionSalesHdr.RUNMODAL <> ACTION::LookupOK) THEN
          EXIT;
      END;

      //User must have option to stop the send option after the menu-choice in the page/form
      //For this "NOT SelectSendOption" can be used. because with selectoption the choice to stop is already there
      GLSetup.GET;  //NAVNO

      IF ((NOT SelectSendOption) AND (SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::"E-Mail")) OR
         (SelectSendOptionSalesHdr.GetSelectEmail)
      THEN BEGIN
        IF FromBatchPost THEN
          SalesInvHeader.EmailRecordFromBatchPost
        ELSE
          SalesInvHeader.EmailRecords(TRUE);
      END;

      IF ((NOT SelectSendOption) AND
          (NOT GLSetup."Norwegian Localization Active") AND  //NAVNO
          (SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::"GLN (XML)")) OR
         (SelectSendOptionSalesHdr.GetSelectGLNXML)
      THEN BEGIN
        SendSalesInvoiceGS1.USEREQUESTPAGE := NOT SelectSendOption;
        SendSalesInvoiceGS1.SetReportSelection(FromBatchPost);
        SendSalesInvoiceGS1.SETTABLEVIEW(SalesInvHeader);
        SendSalesInvoiceGS1.RUNMODAL;
      END;

      IF ((NOT SelectSendOption) AND
          (SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::eVerbinding)) OR
         (SelectSendOptionSalesHdr.GetSelectDigipoort)
      THEN BEGIN
        SendSalesInvoiceDigipoort.USEREQUESTPAGE := NOT SelectSendOption;
        SendSalesInvoiceDigipoort.SETTABLEVIEW(SalesInvHeader);
        SendSalesInvoiceDigipoort.RUNMODAL;
      END;

      IF ((NOT SelectSendOption) AND
          (SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::"INSBOU (Web Service)")) OR
         (SelectSendOptionSalesHdr.GetSelectINSBOU)
      THEN BEGIN
        INSBOUInterface.SendSalesInvoice(Rec);
      END;
      // 140702 ITERO.MH <<
      IF ((NOT SelectSendOption) AND (SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::"Svefaktura (XML)")) OR
         (SelectSendOptionSalesHdr.GetSelectSvefaktura)
      THEN BEGIN
        IF GUIALLOWED THEN BEGIN
          IF SalesInvHeader."Electronic Invoice Created" THEN BEGIN
            IF NOT CONFIRM(txtAlreadyCreatedSvefaktura) THEN
              EXIT;
          END ELSE BEGIN
            IF NOT CONFIRM(txtCreateSvefaktura) THEN
              EXIT;
          END;
        END;

        SvefakturaSetup.ExportInvoice(SalesInvHeader);
      //  SalesRecSetup.GET;
      //  IF SalesRecSetup."Svefaktura Invoice Report No." <> 0 THEN
      //    REPORT.RUNMODAL(SalesRecSetup."Svefaktura Invoice Report No.", GUIALLOWED , FALSE, SalesInvHeader)
      //  ELSE
      //    CODEUNIT.RUN(11128033, SalesInvHeader);x
      END;
      // 140702 ITERO.MH >>

      //>>4PSSE.DK
      IF ((NOT SelectSendOption) AND
          (SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::"OIOUBL (DK)")) OR
         (SelectSendOptionSalesHdr.GetSelectOIOUBL)
      THEN BEGIN
        CreateDKElectronicInvoices.USEREQUESTPAGE := NOT SelectSendOption;
        CreateDKElectronicInvoices.SETTABLEVIEW(SalesInvHeader);
        CreateDKElectronicInvoices.RUNMODAL;
      END;
      //<<4PSSE.DK
      IF ((NOT SelectSendOption) AND
          (SalesInvHeader."Electronic Invoicing" = SalesInvHeader."Electronic Invoicing"::"Dispatch Woon")) OR
          (SelectSendOptionSalesHdr.GetSelectDispatchWoon)
      THEN BEGIN
        DispatchInterface.CreateAndUploadEstimateFile(Rec);
      END;
    END;

    PROCEDURE AccountCodeLineSpecified@1101100000(CountryCode@1100285500 : Code[10]) : Boolean;
    VAR
      SalesInvLine@1101100000 : Record 113;
    BEGIN
      //NAVDK
      //NAVNO
      SalesInvLine.RESET;
      SalesInvLine.SETRANGE("Document No.", "No.");
      SalesInvLine.SETFILTER(Type, '>%1', SalesInvLine.Type::" ");
      CASE CountryCode OF
        'DK': SalesInvLine.SETFILTER("Account Code DK", '<>%1&<>%2', '', "Account Code DK");
        'NO': SalesInvLine.SETFILTER("Account Code NO", '<>%1&<>%2', '', "Account Code NO");
      END;
      EXIT(NOT SalesInvLine.ISEMPTY);
    END;

    PROCEDURE HasExternalDoc@1100285300() HasDocuments : Boolean;
    VAR
      RecordRef@1100285300 : RecordRef;
      DocumentLinkMgt@1100285301 : Codeunit 11012401;
    BEGIN
      //>>160121 ITERO.SB Added function "HasExternalDoc"
      RecordRef.GETTABLE(Rec);
      HasDocuments := DocumentLinkMgt.EntityHasDocumentLinks(RecordRef);
      //<<
    END;

    PROCEDURE AttachmentsMustBePrinted@1100528400() : Boolean;
    VAR
      DocumentProperties@1100528400 : Record 11012746;
    BEGIN
      //**4PS
      GetRelatedDocuments(Rec, DocumentProperties, FALSE);
      DocumentProperties.MARKEDONLY(TRUE);
      IF DocumentProperties.FINDSET THEN
        REPEAT
          IF NOT DocumentProperties.FileCanBeConvertedToPDF THEN
            DocumentProperties.MARK(FALSE);
        UNTIL DocumentProperties.NEXT = 0;

      EXIT(NOT DocumentProperties.ISEMPTY);
    END;

    PROCEDURE PrintInvoiceIncludingAttachments@1100528407(FromBatch@1100528402 : Boolean);
    VAR
      SalesInvoiceHeader@1100528400 : Record 112;
      TempReportSelections@1100528401 : TEMPORARY Record 77;
      TempEmailAttachment@1100528404 : TEMPORARY Record 11229294;
      DocumentPrint@1100528403 : Codeunit 229;
      PDFFileManagement@1100528405 : Codeunit 11020228;
      UserInteractionAllowed@1100528406 : Boolean;
    BEGIN
      //**4PS
      UserInteractionAllowed := NOT FromBatch;
      SalesInvoiceHeader.COPY(Rec);
      SalesInvoiceHeader.SETRECFILTER;
      DocumentPrint.GetReportSelectionForPrintUsage(
        TempReportSelections.Usage::"S.Invoice",SalesInvoiceHeader."Bill-to Customer No.",
        UserInteractionAllowed,TempReportSelections);
      TempReportSelections.FINDSET;
      REPEAT
        CreatePDF(TempReportSelections."Report ID", TRUE, TempEmailAttachment, SalesInvoiceHeader);
      UNTIL TempReportSelections.NEXT = 0;
      AddRelatedDocuments(
        TempEmailAttachment,SalesInvoiceHeader,TRUE,FALSE);
      PDFFileManagement.MergePDFEmailAttachmentsOnServer(TempEmailAttachment);

      OnAfterMergeMPDEmailAttachmentWhenPrint(Rec, TempEmailAttachment); // ITERO.MH 171124 TS005

      IF TempEmailAttachment.FINDFIRST THEN BEGIN
        TempEmailAttachment."Attachment Name" :=
          STRSUBSTNO('%1 %2.pdf', Text11012002, SalesInvoiceHeader."No.");
        IF UserInteractionAllowed THEN
          TempEmailAttachment.DownloadPdfAttachment
        ELSE
          TempEmailAttachment.PrintPdfAttachment;
        ERASE(TempEmailAttachment."Attachment Server File Path");
      END;
    END;

    PROCEDURE AddRelatedDocuments@1100528502(VAR TempEmailAttachment@1100528504 : TEMPORARY Record 11229294;SalesInvoiceHeader@1100528500 : Record 112;ConvertToPDF@1100528505 : Boolean;SendAsEmail@1100528508 : Boolean);
    VAR
      DocumentProperties@1100528501 : Record 11012746;
      ReportSelections@1100528506 : Record 77;
    BEGIN
      //**4PS
      GetRelatedDocuments(SalesInvoiceHeader, DocumentProperties, SendAsEmail);
      DocumentProperties.MARKEDONLY(TRUE);
      ReportSelections.AddRelatedDocuments(TempEmailAttachment, DocumentProperties, FALSE, ConvertToPDF);
    END;

    LOCAL PROCEDURE GetRelatedDocuments@1100528703(SalesInvoiceHeader@1100528701 : Record 112;VAR DocumentProperties@1100528700 : Record 11012746;SendAsEmail@1100528500 : Boolean);
    VAR
      DocumentRelation@1100528704 : Record 11012407;
    BEGIN
      //**4PS
      DocumentProperties.GetDocumentsFromDocumentRelations(DocumentProperties, DocumentRelation."Document Type"::"Posted Sales Invoice", SalesInvoiceHeader."No.", SendAsEmail);
    END;

    PROCEDURE UpdateEMailSentByAndOn@1100525000();
    BEGIN
      //**4PS
      "E-Mail Sent by" := USERID;
      "E-Mail Sent on" := TODAY;
      CODEUNIT.RUN(CODEUNIT::"Sales Invoice Header-Edit", Rec);
    END;

    PROCEDURE SaveDocumentToPDFInvoice@1100525001();
    VAR
      SalesInvoiceHeader@1100525004 : Record 112;
      TempReportSelections@1100525003 : TEMPORARY Record 77;
      TempEmailAttachment@1100525002 : TEMPORARY Record 11229294;
      DocumentPrint@1100525001 : Codeunit 229;
      Plot@1100525006 : Record 11012500;
      FileManagement@1100525013 : Codeunit 419;
      DropZoneManagement@1100525015 : Codeunit 11012281;
      RecReference@1100525017 : RecordRef;
    BEGIN
      SalesInvoiceHeader.COPY(Rec);
      SalesInvoiceHeader.SETRECFILTER;

      IF NOT HasBuyerManagementOrigin(SalesInvoiceHeader,Plot) THEN BEGIN
        MESSAGE(Text11012003);
        EXIT;
      END;

      DocumentPrint.GetReportSelectionForPrintUsage(TempReportSelections.Usage::"S.Invoice",
                                                    SalesInvoiceHeader."Bill-to Customer No.",
                                                    FALSE,
                                                    TempReportSelections);
      IF NOT TempReportSelections.FINDSET THEN
        EXIT;

      CreatePDF(TempReportSelections."Report ID", TRUE, TempEmailAttachment, SalesInvoiceHeader);

      IF NOT TempEmailAttachment.FINDFIRST THEN
        EXIT;

      TempEmailAttachment."Attachment Name" := STRSUBSTNO('%1 %2.pdf', Text11012002, SalesInvoiceHeader."No.");
      TempEmailAttachment."Attachment Client File Path"  := FileManagement.DownloadTempFile(TempEmailAttachment."Attachment Server File Path");

      RecReference.GET(Plot.RECORDID);
      DropZoneManagement.SetRecordReference(RecReference);
      DropZoneManagement.InitQueue();
      DropZoneManagement.CreateDocumentInQueue(TempEmailAttachment."Attachment Client File Path",
                                                '',
                                                TempEmailAttachment."Attachment Name",
                                                '',
                                                TODAY);
      DropZoneManagement.RegisterQueuedDocuments;
    END;

    LOCAL PROCEDURE HasBuyerManagementOrigin@1100525002(SalesInvoiceHeader@1100525000 : Record 112;VAR Plot@1100525004 : Record 11012500) : Boolean;
    VAR
      SalesInvoiceLine@1100525003 : Record 113;
    BEGIN
      SalesInvoiceLine.SETFILTER("Document No.",SalesInvoiceHeader."No.");
      SalesInvoiceLine.SETFILTER("Plot No.",'<>%1','');
      IF NOT SalesInvoiceLine.FINDFIRST THEN
        EXIT(FALSE);

      IF NOT (Plot.GET(SalesInvoiceHeader."Job No." ,SalesInvoiceLine."Plot No.")) THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE GetNoOfCommentLines@1100525023(ISalesInvoiceNo@1100525000 : Code[20]) : Integer;
    VAR
      SalesCommentLine@1100525001 : Record 44;
    BEGIN
      //*4PS
      IF ISalesInvoiceNo = '' THEN
        EXIT(0);

      FilterCommentLines(ISalesInvoiceNo, SalesCommentLine);
      EXIT(SalesCommentLine.COUNT);
    END;

    PROCEDURE ShowCommentLines@1100525024(ISalesInvoiceNo@1100525000 : Code[20]);
    VAR
      SalesCommentLine@1100525001 : Record 44;
    BEGIN
      //*4PS
      FilterCommentLines(ISalesInvoiceNo, SalesCommentLine);
      PAGE.RUNMODAL(PAGE::"Sales Comment Sheet", SalesCommentLine);
    END;

    PROCEDURE FilterCommentLines@1100525025(ISalesInvoiceNo@1100525000 : Code[20];VAR OSalesCommentLine@1100525001 : Record 44);
    BEGIN
      //*4PS
      OSalesCommentLine.RESET;
      OSalesCommentLine.FILTERGROUP(4);
      OSalesCommentLine.SETRANGE("Document Type", OSalesCommentLine."Document Type"::"Posted Invoice");
      OSalesCommentLine.SETRANGE("No.", ISalesInvoiceNo);
      OSalesCommentLine.SETRANGE("Document Line No.", 0);
      OSalesCommentLine.FILTERGROUP(0);
    END;

    LOCAL PROCEDURE GetGLSetup@1100285501();
    BEGIN
      //4PSSE.FI
      IF NOT gotGLSetup THEN
        gotGLSetup := GLSetup.GET;
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterMergeMPDEmailAttachmentWhenPrint@1101285000(VAR SalesInvoiceHeader@1101285000 : Record 112;VAR TempEmailAttachment@1101285001 : TEMPORARY Record 11229294);
    BEGIN
    END;

    BEGIN
    {
      4PS, dbeekman, 22-10-2008:
            - Report selection handled by cod229.GetReportSelection

      *** 4PSSE.I012 ***
      130711 Added field "ROT"
      140702 ITERO.MH ENH021 Added new option for Electronic invoice: Svefaktura (XML)
      140820 ITERO.MH ENH021 Added confirmation if sent again
      150928 ITERO.MH RFC001 Changed svefaktura-functionality to use report no. from setup instead.
      151109 ITERO.DL IME424 new key: "Invoice Exported by XML","Electronic Invoicing","Electronic Invoice Created"
      160121 ITERO.SB Added function "HasExternalDoc"
      160121 ITERO.AC IME445 Added Field 11128514 "E-Invoice Layout Code"
      161202 ITERO.WG Svefaktura changed to SweBase version
      170512 ITERO.DL RFC188 namechange ROT -> ROT/RUT
      170809 ITERO.FH Removed confirm dialog for generate new Svefaktura
      171124 ITERO.MH TS005 Added Ev.Publisher OnAfterMergeMPDEmailAttachmentWhenPrint
      180508 ORANGO.DL RFC217 added field for description of installment invoice field11128050, "Installment text"
      190904 ORANGO.DL support for Svefatura 3 (PEPPOL Biz 3.0) with code from NAV2018
      191210 ORANGO.PR Added fields for Netting(Certego Integration 7),field11128030, "Netting Exported", field11128031, "Netting Exported Date"
      200109 ORANGO.DL new key: "Service Order No.,No."
    }
    END.
  }
}

