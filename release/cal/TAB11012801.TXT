OBJECT Table 11012801 Service Location
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    Permissions=TableData 11012801=d;
    DataCaptionFields=No.,Description;
    OnInsert=VAR
               "4PSMobileSetup"@1210190000 : Record 11012676;
               ServPortSetup@1100525000 : Record 11126065;
             BEGIN
               ServSetup.GET;

               IF "No." = '' THEN BEGIN
                 ServSetup.TESTFIELD("Service Location Nos.");
                 NoSeriesMgt.InitSeries(ServSetup."Service Location Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               TESTFIELD("No.");

               "Creation Date" := TODAY;
               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
               "Modified by" := USERID;

               //db.sn, 18-12-12: C000433
               ProjSetupRec.GET;
               Deliver := ProjSetupRec.Deliver;
               IF (Deliver = Deliver::Location) THEN
                 "Ship To Location" := ProjSetupRec."Ship To Location";
               //db.en, 18-12-12: C000433

               VALIDATE("Location Structure Format", ServSetup."Def. Location Structure Format");

               IF IsFSAActive THEN BEGIN
                 "4PSMobileSetup".GET;
                 "Initial Minutes Working Hours" := "4PSMobileSetup"."Def. Init. Minutes Work. Hours";
                 "Round Working Hours on Minutes" := "4PSMobileSetup"."Def. Round Work. Hours on Min.";
                 "Round Travel Hours on Minutes" := "4PSMobileSetup"."Def. Round Trav. Hours on Min.";
               END;

               ServPortSetup.SETRANGE("Primary Key", '1');
               IF ServPortSetup.FINDFIRST THEN
                 IF ServPortSetup."Location Publ. on Serv. Portal" THEN
                   VALIDATE("Publish on Service Portal", ServPortSetup."Location Publ. on Serv. Portal");

               //**4PS Generated Code. Do Not Change.sn05
               DPA_OnInsert;
               //**4PS Generated Code.en05

               ExchangeFSA('I');
               ExchangeMOB('I');
               NormalizePostCodeHouseNo;

               IF "Post Code Group" = '' THEN
                 EvaluatePostCodeGroup
               ELSE BEGIN
                 DetermineTravelCostCode;
                 DetermineTravelDistance;
                 DetermineTravelTime;
               END;

               "Postal Address App. Letter" := "Postal Address App. Letter"::"Service Location";

               IF "Bill-to Customer No." = '' THEN
                 "Bill-to Customer No." := "Customer No.";
             END;

    OnModify=VAR
               ServiceLocationJobHistory@1100529900 : Record 11072555;
             BEGIN
               IF Blocked = xRec.Blocked THEN
                 TESTFIELD(Blocked,FALSE);

               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
               "Modified by" := USERID;

               ExchangeFSA('M');
               ExchangeMOB('M');

               NormalizePostCodeHouseNo;
               IF ((Rec."Supplying Company" <> xRec."Supplying Company") OR (Rec."Project No." <> xRec."Project No.") OR (Rec."Plot No." <> xRec."Plot No.")) THEN
                 ServiceLocationJobHistory.AddServiceLocationJobHistory(xRec);
             END;

    OnDelete=VAR
               RespRec@11012007 : Record 11012808;
               ContactRec@1100485002 : Record 11012841;
               CommLineRec@1210190002 : Record 97;
               ServTextRec@1100485003 : Record 11012882;
               TryOutRec@1210190004 : Record 11012761;
               RefNormRec@1100485005 : Record 11012856;
               ServCallRec@1100485008 : Record 11012822;
               ServOrderRec@1100485009 : Record 11012823;
               LocStructure@1100526200 : Record 11071719;
               ServiceObject@1100528600 : Record 11071691;
               SubcontrPortLocation@1100528100 : Record 11126403;
               RentalUnit@1100528700 : Record 11012940;
               JobServiceLocation@1100528601 : Record 11072219;
               ServiceContractLocation@1100527400 : Record 11072554;
             BEGIN
               ServCallRec.SETCURRENTKEY("Service Location No.");
               ServCallRec.SETRANGE("Service Location No.", "No.");
               ServCallRec.SETFILTER(Status, '<>%1', ServCallRec.Status::Finished);
               IF ServCallRec.FINDFIRST THEN
                 ServCallRec.TESTFIELD(Status, ServCallRec.Status::Finished);

               ServOrderRec.SETCURRENTKEY("Service Location No.");
               ServOrderRec.SETRANGE("Service Location No.", "No.");
               ServOrderRec.SETFILTER(Status, '<>%1', ServOrderRec.Status::Finished);
               IF ServOrderRec.FINDFIRST THEN
                 ServOrderRec.TESTFIELD(Status, ServOrderRec.Status::Finished);


               RespRec.SETRANGE("Service Location No.", "No.");
               RespRec.DELETEALL;

               ContactRec.SETRANGE("Service Location No.", "No.");
               ContactRec.DELETEALL;

               PrefEmplRec.SETRANGE("Service Location No.", "No.");
               PrefEmplRec.DELETEALL(TRUE);

               CommLineRec.SETRANGE("Table Name",CommLineRec."Table Name"::"Service Location");
               CommLineRec.SETRANGE("No.","No.");
               CommLineRec.DELETEALL;

               ServTextRec.SETRANGE("Table Name",ServTextRec."Table Name"::"Service Location");
               ServTextRec.SETRANGE("No.","No.");
               ServTextRec.DELETEALL;

               ServiceContractLocation.SETRANGE("Service Location No.", "No.");
               ServiceContractLocation.DELETEALL;

               IF FPSLicenseManagement.LicenseAndReadPermissionForTable(TryOutRec) THEN BEGIN
                 TryOutRec.SETCURRENTKEY("Service Location No.");
                 TryOutRec.SETRANGE("Service Location No.", "No.");
                 IF TryOutRec.FINDSET(TRUE,FALSE) THEN BEGIN
                   REPEAT
                     IF (TryOutRec."Project No." = '') AND
                        (TryOutRec."Estimate No." = '') AND
                        (TryOutRec."Service Contract No." = '') AND
                        (TryOutRec."Service Order No." = '') THEN BEGIN
                       TryOutRec.DELETE(TRUE);
                     END ELSE BEGIN
                       TryOutRec."Service Location No." := '';
                       TryOutRec.MODIFY(TRUE);
                     END;
                   UNTIL TryOutRec.NEXT = 0;
                 END;
               END;

               RefNormRec.SETCURRENTKEY("Service Location No.");
               RefNormRec.SETRANGE("Service Location No.", "No.");
               RefNormRec.DELETEALL;

               LocStructure.SETRANGE("Service Location No.","No.");
               LocStructure.DELETEALL(TRUE);

               ServiceObject.SETCURRENTKEY("Service Location No.");
               ServiceObject.SETRANGE("Service Location No.", "No.");
               IF GUIALLOWED THEN
                 IF NOT ServiceObject.ISEMPTY THEN
                   IF NOT CONFIRM(Text022) THEN
                     ERROR('');
               ServiceObject.DELETEALL(TRUE);

               SubcontrPortLocation.SETCURRENTKEY("Service Location No.");
               SubcontrPortLocation.SETRANGE("Service Location No.", "No.");
               SubcontrPortLocation.DELETEALL(TRUE);

               IF FPSLicenseManagement.LicenseAndReadPermissionForTable(RentalUnit) THEN BEGIN
                 RentalUnit.SETRANGE("Service Location No.", "No.");
                 IF RentalUnit.FINDFIRST THEN BEGIN
                   RentalUnit."Service Location No." := '';
                   RentalUnit.MODIFY;
                 END;
               END;

               JobServiceLocation.SETCURRENTKEY("Service Location No.");
               JobServiceLocation.SETRANGE("Service Location No.", "No.");
               IF JobServiceLocation.FINDFIRST THEN BEGIN
                 JobServiceLocation."Service Location No." := '';
                 JobServiceLocation.MODIFY;
               END;

               ExchangeFSA('D');
               ExchangeMOB('D');
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
               "Modified by" := USERID;

               ExchangeFSA('R');
               ExchangeMOB('R');
             END;

    CaptionML=[ENU=Service Location;
               NOR=Servicelokasjon;
               SVE=Serviceplats];
    LookupPageID=Page11012802;
    DrillDownPageID=Page11012802;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  ServSetup.GET;
                                                                  NoSeriesMgt.TestManual(ServSetup."Service Location Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr;
                                                              SVE=Nr] }
    { 2   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              NOR=S›kenavn;
                                                              SVE=S”knamn] }
    { 3   ;   ;Description         ;Text50        ;OnValidate=BEGIN
                                                                IF ("Search Name" = UPPERCASE(xRec.Description)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Description;

                                                                IF (CurrFieldNo = FIELDNO(Description)) AND (Description <> xRec.Description) THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 4   ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2;
                                                              SVE=Beskrivning 2] }
    { 12  ;   ;Creation Date       ;Date          ;CaptionML=[ENU=Creation Date;
                                                              NOR=Opprettet den;
                                                              SVE=Uppl„ggningsdatum];
                                                   Editable=No }
    { 13  ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                IF ("Starting Date" > "Ending Date") AND ("Ending Date" <> 0D) THEN
                                                                  FIELDERROR("Starting Date",STRSUBSTNO(Text000,FIELDCAPTION("Ending Date")));
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato;
                                                              SVE=Startdatum] }
    { 14  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                IF ("Starting Date" > "Ending Date") AND ("Ending Date" <> 0D) THEN
                                                                  FIELDERROR("Ending Date",STRSUBSTNO(Text001,FIELDCAPTION("Starting Date")));
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato;
                                                              SVE=Slutdatum] }
    { 20  ;   ;Responsible Employee;Code20        ;TableRelation=Resource;
                                                   CaptionML=[ENU=Responsible Employee;
                                                              NOR=Ansvarlig Ansatt;
                                                              SVE=Ansvarig] }
    { 28  ;   ;Modified by         ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserMgt@1210190001 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("Modified by");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Modified by;
                                                              NOR=Endret av;
                                                              SVE=Žndrad av];
                                                   Editable=No }
    { 29  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Oppdateringsdato;
                                                              SVE=Uppdateringsdatum];
                                                   Editable=No }
    { 30  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Service Location),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Kommentar;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 40  ;   ;Travel Distance     ;Decimal       ;CaptionML=[ENU=Travel Distance;
                                                              NOR=Reiseavstand;
                                                              SVE=Resstr„cka];
                                                   MinValue=0 }
    { 41  ;   ;Travel Time         ;Decimal       ;CaptionML=[ENU=Travel Time;
                                                              NOR=Reisetid;
                                                              SVE=Restid];
                                                   MinValue=0 }
    { 42  ;   ;Travel Cost         ;Decimal       ;CaptionML=[ENU=Travel Cost;
                                                              NOR=Reisekost;
                                                              SVE=Resekostnad];
                                                   MinValue=0 }
    { 50  ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                LocBillToCustNo@1100529600 : Code[20];
                                                              BEGIN
                                                                TestLinkedToRentalUnit(FIELDCAPTION("Customer No."));

                                                                IF "Customer No." <> xRec."Customer No." THEN BEGIN   //db.sn, 21-03-11
                                                                  "Contact Person No." := '';
                                                                  "Contact Person Name" := '';
                                                                END;                                                  //db.en, 21-03-11

                                                                IF NOT SkipUpdateAddress THEN BEGIN
                                                                  ValidateAddressData(1);
                                                                  DetermineProjectAddress;
                                                                  DetermineTravelCostCode;
                                                                  DetermineTravelDistance;
                                                                  DetermineTravelTime;
                                                                END;

                                                                IF NOT CustRec.GET("Customer No.") THEN
                                                                  CustRec.INIT;
                                                                IF CustRec."Bill-to Customer No." <> '' THEN
                                                                  LocBillToCustNo := CustRec."Bill-to Customer No."
                                                                ELSE
                                                                  LocBillToCustNo := "Customer No.";
                                                                IF ("Bill-to Customer No." = '') OR ("Customer No." = '') THEN BEGIN
                                                                  VALIDATE("Bill-to Customer No.", LocBillToCustNo);
                                                                  CheckInvoiceAddress;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Customer No.;
                                                              NOR=Kundenr;
                                                              SVE=Kundnr] }
    { 51  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[ENU=Territory Code;
                                                              NOR=Distriktskode;
                                                              SVE=Distriktskod] }
    { 52  ;   ;Type                ;Code10        ;TableRelation=Type;
                                                   CaptionML=[ENU=Type;
                                                              NOR=Radtype;
                                                              SVE=Radtyp] }
    { 53  ;   ;Customer Name       ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Customer Name;
                                                              NOR=Kundnavn;
                                                              SVE=Kundens namn];
                                                   Editable=No }
    { 58  ;   ;Name                ;Text100       ;CaptionML=[ENU=Name;
                                                              NOR=Navn;
                                                              SVE=Namn];
                                                   Editable=Yes }
    { 59  ;   ;Address             ;Text100       ;OnValidate=BEGIN
                                                                TestLinkedToRentalUnit(FIELDCAPTION(Address));

                                                                VALIDATE("Post Code");

                                                                IF (CurrFieldNo = FIELDNO(Address)) AND (Address <> xRec.Address) THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress];
                                                   Editable=Yes }
    { 60  ;   ;Address 2           ;Text50        ;OnValidate=BEGIN
                                                                IF (CurrFieldNo = FIELDNO("Address 2")) AND ("Address 2" <> xRec."Address 2") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2;
                                                              SVE=Adress 2];
                                                   Editable=Yes }
    { 61  ;   ;City                ;Text30        ;FieldClass=Normal;
                                                   TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                TestLinkedToRentalUnit(FIELDCAPTION(City));
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);

                                                                IF (CurrFieldNo = FIELDNO(City)) AND (City <> xRec.City) THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Poststed;
                                                              SVE=Ort];
                                                   Editable=Yes }
    { 62  ;   ;Contact Name        ;Text100       ;OnValidate=BEGIN
                                                                IF (CurrFieldNo = FIELDNO("Contact Name")) AND ("Contact Name" <> xRec."Contact Name") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   CaptionML=[ENU=Contact Name;
                                                              NOR=Kontaktnavn;
                                                              SVE=Kontaktnamn];
                                                   Editable=Yes }
    { 63  ;   ;County              ;Text30        ;FieldClass=Normal;
                                                   CaptionML=[ENU=County;
                                                              NOR=Delstat;
                                                              SVE=Delstat];
                                                   Editable=Yes }
    { 64  ;   ;Post Code           ;Code20        ;FieldClass=Normal;
                                                   TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=VAR
                                                                ExistingLocationNo@1100409000 : Code[20];
                                                              BEGIN
                                                                TestLinkedToRentalUnit(FIELDCAPTION("Post Code"));

                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);

                                                                NormalizePostCodeHouseNo();
                                                                IF GUIALLOWED AND
                                                                   (CurrFieldNo = FIELDNO("Post Code")) AND
                                                                   ("Post Code" <> '') AND
                                                                   (NOT PostCode.GET("Post Code", City))
                                                                THEN
                                                                  MESSAGE(Text009, PostCode.TABLECAPTION, "Post Code");
                                                                IF CurrFieldNo <> 0 THEN
                                                                  IF LocationExists(ExistingLocationNo) THEN
                                                                    MESSAGE(Text012, ExistingLocationNo);
                                                                EvaluatePostCodeGroup;

                                                                IF (CurrFieldNo = FIELDNO("Post Code")) AND ("Post Code" <> xRec."Post Code") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr;
                                                              SVE=Postnr];
                                                   Editable=Yes }
    { 65  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                IF (CurrFieldNo = FIELDNO("Country/Region Code")) AND ("Country/Region Code" <> xRec."Country/Region Code") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode;
                                                              SVE=Lands-/regionkod] }
    { 66  ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr-serie;
                                                              SVE=Nr-serier];
                                                   Editable=No }
    { 67  ;   ;Phone No.           ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Phone No.");

                                                                IF (CurrFieldNo = FIELDNO("Phone No.")) AND ("Phone No." <> xRec."Phone No.") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              NOR=Telefonnr;
                                                              SVE=Telefonnr] }
    { 68  ;   ;Fax No.             ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Fax No.");

                                                                IF (CurrFieldNo = FIELDNO("Fax No.")) AND ("Fax No." <> xRec."Fax No.") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   CaptionML=[ENU=Fax No.;
                                                              NOR=Telefaxnr;
                                                              SVE=Telefaxnr] }
    { 69  ;   ;E-Mail              ;Text80        ;OnValidate=VAR
                                                                RecRef@1100528501 : RecordRef;
                                                                FldRef@1100528500 : FieldRef;
                                                              BEGIN
                                                                RecRef.GETTABLE(Rec);
                                                                FldRef := RecRef.FIELD(FIELDNO("E-Mail"));
                                                                ContactDataValidation.ValidateEmail(FldRef, "E-Mail");

                                                                IF (CurrFieldNo = FIELDNO("E-Mail")) AND ("E-Mail" <> xRec."E-Mail") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 160 ;   ;Location Manager    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                UpdateResponsibility(xRec."Location Manager", "Location Manager");
                                                                CALCFIELDS("Location Manager Name");
                                                              END;

                                                   CaptionML=[ENU=Location Manager;
                                                              NOR=Lokasjonsleder;
                                                              SVE=Platschef] }
    { 161 ;   ;Location Manager Name;Text50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Location Manager)));
                                                   CaptionML=[ENU=Location Manager Name;
                                                              NOR=Lokasjonsleders navn;
                                                              SVE=Platschef, namn];
                                                   Editable=No }
    { 170 ;   ;Project No.         ;Code20        ;TableRelation=IF (Supplying Company=FILTER('')) Job;
                                                   OnValidate=BEGIN
                                                                CheckCompanyIC;
                                                                IF "Project No." <> '' THEN BEGIN
                                                                  IF ProjRec.GET("Project No.") THEN
                                                                    "Project Description" := ProjRec.Description;
                                                                END ELSE
                                                                  IF xRec."Project No." <> '' THEN
                                                                    "Project Description" := '';
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupProjectNo;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 171 ;   ;Supplying Company   ;Text30        ;TableRelation=Company;
                                                   OnValidate=BEGIN
                                                                IF "Supplying Company" = COMPANYNAME THEN
                                                                  ERROR(Text003);
                                                              END;

                                                   CaptionML=[ENU=Supplying Company;
                                                              NOR=Leverende  selskap;
                                                              SVE=Levererande f”retag] }
    { 173 ;   ;Project Description ;Text100       ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Project Description;
                                                              SVE=Projektbeskrivning] }
    { 175 ;   ;Plot No.            ;Code10        ;TableRelation=IF (Supplying Company=FILTER('')) Plot."Plot No." WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=VAR
                                                                ServiceLocation@1100527300 : Record 11012801;
                                                              BEGIN
                                                                CheckCompanyIC;
                                                                IF "Plot No." <> '' THEN BEGIN
                                                                  IF "Project No." <> '' THEN BEGIN
                                                                    ServiceLocation.SETRANGE("Project No.", "Project No.");
                                                                    ServiceLocation.SETRANGE("Plot No.", "Plot No.");
                                                                    IF NOT ServiceLocation.ISEMPTY THEN
                                                                      ERROR(Text026);
                                                                  END;
                                                                  IF PlotRec.GET("Project No.", "Plot No.") THEN;
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupPlotNo;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Plot No.;
                                                              NOR=Tegningnr;
                                                              SVE=Ritningnr] }
    { 180 ;   ;Estimator           ;Code20        ;TableRelation=Employee.No.;
                                                   CaptionML=[ENU=Estimator;
                                                              NOR=Kalkylat›r;
                                                              SVE=Kalkylator] }
    { 220 ;   ;Text                ;Text250       ;CaptionML=[ENU=Text;
                                                              NOR=Tekst;
                                                              SVE=Ben„mning] }
    { 230 ;   ;Service Location Folder;Text250    ;CaptionML=[ENU=Service Location Folder;
                                                              NOR=Servicelokasjonmappe;
                                                              SVE=Serviceplatsmapp] }
    { 240 ;   ;Mobile Phone No.    ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Mobile Phone No.");

                                                                IF (CurrFieldNo = FIELDNO("Mobile Phone No.")) AND ("Mobile Phone No." <> xRec."Mobile Phone No.") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Mobile Phone No.;
                                                              NOR=Mobiltelefonnr;
                                                              SVE=Mobiltelefonnr] }
    { 250 ;   ;Phone No. 2         ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Phone No. 2");

                                                                IF (CurrFieldNo = FIELDNO("Phone No. 2")) AND ("Phone No. 2" <> xRec."Phone No. 2") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No. 2;
                                                              NOR=Telefonnr 2;
                                                              SVE=Telefonnr 2] }
    { 260 ;   ;Collect Cost Plus Entry;Boolean    ;CaptionML=[ENU=Collect Cost Plus Entry;
                                                              NOR=Samle inn selvkosttransaksjon;
                                                              SVE=Samla in redovisad självkostnad] }
    { 275 ;   ;Remote Control      ;Boolean       ;CaptionML=[ENU=Remote Control;
                                                              NOR=Fjernkontroll;
                                                              SVE=Fj„rrkontroll] }
    { 280 ;   ;Address Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.),
                                                                                               Project Address=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                ValidateAddressData(2);
                                                              END;

                                                   CaptionML=[ENU=Address Code;
                                                              NOR=Adressekode;
                                                              SVE=Adresskod] }
    { 281 ;   ;Address Name        ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address".Name WHERE (Customer No.=FIELD(Customer No.),
                                                                                                    Code=FIELD(Address Code)));
                                                   CaptionML=[ENU=Address Name;
                                                              NOR=Adressenavn;
                                                              SVE=Adressnamn];
                                                   Editable=No }
    { 290 ;   ;Blocked             ;Boolean       ;CaptionML=[ENU=Blocked;
                                                              NOR=Blokkert;
                                                              SVE=Sp„rrad] }
    { 295 ;   ;Budget Hours (ServOrder);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Hours WHERE (Service Location No.=FIELD(No.),
                                                                                                            Source Type=FIELD(Source Type Filter),
                                                                                                            Cost Component=FIELD(Cost Component Filter),
                                                                                                            Index Date=FIELD(Period Filter),
                                                                                                            Budget Type=CONST(Order),
                                                                                                            Cost Type=CONST(Labor)));
                                                   CaptionML=[ENU=Budget Hours (Service Order);
                                                              NOR=Budsjetterte timer (Serviceordre);
                                                              SVE=Budgettimmar (serviceorder)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 296 ;   ;Budget Amount (ServOrder);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Amount WHERE (Service Location No.=FIELD(No.),
                                                                                                             Source Type=FIELD(Source Type Filter),
                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                             Index Date=FIELD(Period Filter),
                                                                                                             Budget Type=CONST(Order)));
                                                   CaptionML=[ENU=Budget Amount (Service Order);
                                                              NOR=Budsjettert bel›p (Serviceordre);
                                                              SVE=Budgetbelopp (serviceorder)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 300 ;   ;Actual Costs        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                    Posting Date=FIELD(Period Filter),
                                                                                                                    Source Type=FIELD(Source Type Filter),
                                                                                                                    Cost Component=FIELD(Cost Component Filter),
                                                                                                                    Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Costs;
                                                              NOR=Faktiske koster;
                                                              SVE=Verkliga kostnader];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 301 ;   ;Actual Hours        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry".Quantity WHERE (Service Location No.=FIELD(No.),
                                                                                                          Posting Date=FIELD(Period Filter),
                                                                                                          Source Type=FIELD(Source Type Filter),
                                                                                                          Cost Component=FIELD(Cost Component Filter),
                                                                                                          Cost Type=CONST(Labor),
                                                                                                          Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Hours;
                                                              NOR=Reelle timer;
                                                              SVE=Verkliga timmar];
                                                   Editable=No }
    { 302 ;   ;Revenues            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Revenue (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                       Posting Date=FIELD(Period Filter),
                                                                                                                       Source Type=FIELD(Source Type Filter),
                                                                                                                       Cost Component=FIELD(Cost Component Filter),
                                                                                                                       Revenue Present=CONST(Yes)));
                                                   CaptionML=[ENU=Revenues;
                                                              NOR=Inntekter;
                                                              SVE=Int„kter];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 303 ;   ;Actual Costs (Additional);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                    Posting Date=FIELD(Period Filter),
                                                                                                                    Source Type=FIELD(Source Type Filter),
                                                                                                                    Cost Component=FIELD(Cost Component Filter),
                                                                                                                    Additional Cost=CONST(Yes),
                                                                                                                    Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Costs (Additional);
                                                              NOR=Faktiske Kostnader (Ekstra);
                                                              SVE=Verkliga kostnader (extra)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 304 ;   ;Actual Costs (Contract);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                    Posting Date=FIELD(Period Filter),
                                                                                                                    Source Type=FIELD(Source Type Filter),
                                                                                                                    Cost Component=FIELD(Cost Component Filter),
                                                                                                                    Additional Cost=CONST(No),
                                                                                                                    Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Costs (Contract);
                                                              NOR=Faktiske Kostnader (Kontrakt);
                                                              SVE=Verkliga kostnader (kontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 305 ;   ;Actual Hours (Additional);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry".Quantity WHERE (Service Location No.=FIELD(No.),
                                                                                                          Posting Date=FIELD(Period Filter),
                                                                                                          Source Type=FIELD(Source Type Filter),
                                                                                                          Cost Component=FIELD(Cost Component Filter),
                                                                                                          Additional Cost=CONST(Yes),
                                                                                                          Cost Type=CONST(Labor),
                                                                                                          Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Hours (Additional);
                                                              NOR=Faktiske timer (Ekstra);
                                                              SVE=Verkliga timmar (extra)];
                                                   Editable=No }
    { 306 ;   ;Actual Hours (Contract);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry".Quantity WHERE (Service Location No.=FIELD(No.),
                                                                                                          Posting Date=FIELD(Period Filter),
                                                                                                          Source Type=FIELD(Source Type Filter),
                                                                                                          Cost Component=FIELD(Cost Component Filter),
                                                                                                          Additional Cost=CONST(No),
                                                                                                          Cost Type=CONST(Labor),
                                                                                                          Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Hours (Contract);
                                                              NOR=Faktiske timer (Kontrakt);
                                                              SVE=Verkliga timmar (kontrakt)];
                                                   Editable=No }
    { 307 ;   ;Revenues (Additional);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Revenue (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                       Posting Date=FIELD(Period Filter),
                                                                                                                       Source Type=FIELD(Source Type Filter),
                                                                                                                       Cost Component=FIELD(Cost Component Filter),
                                                                                                                       Additional Cost=CONST(Yes),
                                                                                                                       Revenue Present=CONST(Yes)));
                                                   CaptionML=[ENU=Revenues (Additional);
                                                              NOR=Inntekter (Ekstra);
                                                              SVE=Int„kter (extra)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 308 ;   ;Revenues (Contract) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Revenue (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                       Posting Date=FIELD(Period Filter),
                                                                                                                       Source Type=FIELD(Source Type Filter),
                                                                                                                       Cost Component=FIELD(Cost Component Filter),
                                                                                                                       Additional Cost=CONST(No),
                                                                                                                       Revenue Present=CONST(Yes)));
                                                   CaptionML=[ENU=Revenues (Contract);
                                                              NOR=Inntekter (Kontrakt);
                                                              SVE=Int„kter (kontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 309 ;   ;Last Time Modified  ;Time          ;CaptionML=[ENU=Last Time Modified;
                                                              NOR=Sist endret;
                                                              SVE=Uppdateringstid] }
    { 312 ;   ;Period Type Filter  ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Period Type Filter;
                                                              NOR=Periodetypefilter;
                                                              SVE=Periodtypfilter];
                                                   OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                                                    NOR=Dag,Uke,M†ned,Kvartal,r,bokf›ringsperiode;
                                                                    SVE=Dag,Vecka,M†nad,Kvartal,r,Bokf”ringsperiod];
                                                   OptionString=Day,Week,Month,Quarter,Year,Accounting Period }
    { 313 ;   ;Source Type Filter  ;Option        ;FieldClass=FlowFilter;
                                                   InitValue=Other;
                                                   CaptionML=[ENU=Source Type Filter;
                                                              NOR=Kildetypefilter;
                                                              SVE=Ursprungstypsfilter];
                                                   OptionCaptionML=[ENU=Call,Contract,Other,Estimate;
                                                                    NOR=Samtale,Kontrakt,Andre,Kalkyle;
                                                                    SVE=Samtal,Kontrakt,™vrigt,Kalkyl];
                                                   OptionString=Call,Contract,Other,Estimate }
    { 316 ;   ;Cost Component Filter;Code10       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Cost Component Filter;
                                                              NOR=Kostdel, filter;
                                                              SVE=Kostnadsdel, filter] }
    { 320 ;   ;Preferred Employee OLD;Code20      ;TableRelation="Resource (WOP)" WHERE (Type=CONST(Employee));
                                                   CaptionML=ENU=Preferred Employee OLD;
                                                   Description=OBSOLETE;
                                                   Editable=No }
    { 330 ;   ;Open (Purchase)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Outstanding Amount" WHERE (Service Location No.=FIELD(No.),
                                                                                                                             Service Source Type=FIELD(Source Type Filter),
                                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                                             Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open (Purchase);
                                                              NOR=pne innkj›p;
                                                              SVE=™ppna ink”p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 331 ;   ;Received/Not Invoiced;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Amt. Rcd. Not Invoiced" WHERE (Service Location No.=FIELD(No.),
                                                                                                                                 Service Source Type=FIELD(Source Type Filter),
                                                                                                                                 Cost Component=FIELD(Cost Component Filter),
                                                                                                                                 Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Received/Not Invoiced;
                                                              NOR=Mottatt/ikke fakturert;
                                                              SVE=Mottaget/inte fakturerat];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 332 ;   ;Open Ovh. Surch. Firm (Purch.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Overhead Surcharge Firm" WHERE (Service Location No.=FIELD(No.),
                                                                                                                                  Service Source Type=FIELD(Source Type Filter),
                                                                                                                                  Cost Component=FIELD(Cost Component Filter),
                                                                                                                                  Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Ovh. Surch. Firm Commitments (Purchase);
                                                              NOR=pen overheadkost, faste Forpliktelser (Innkj›p);
                                                              SVE=™ppen overheadkostnad, fasta †taganden (ink”p)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 333 ;   ;Open Ovh. Surch. Soft (Purch.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Overhead Surcharge Soft" WHERE (Service Location No.=FIELD(No.),
                                                                                                                                  Service Source Type=FIELD(Source Type Filter),
                                                                                                                                  Cost Component=FIELD(Cost Component Filter),
                                                                                                                                  Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Ovh. Surch. Soft Commitments (Purchase);
                                                              NOR=pen overheadkost, l›pende engasjementer (Innkj›p);
                                                              SVE=™ppen overheadkostnad, l”pande †taganden (ink”p)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 335 ;   ;Open Amount (Hours) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line"."Amount (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                Service Source Type=FIELD(Source Type Filter),
                                                                                                                Cost Component=FIELD(Cost Component Filter),
                                                                                                                Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Amount (Hours);
                                                              NOR=pne bel›p (Timer);
                                                              SVE=™ppna belopp (timmar)];
                                                   Editable=No }
    { 336 ;   ;Open Hours          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line"."Total Line" WHERE (Service Location No.=FIELD(No.),
                                                                                                              Service Source Type=FIELD(Source Type Filter),
                                                                                                              Cost Component=FIELD(Cost Component Filter),
                                                                                                              Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Hours;
                                                              NOR=pne timer;
                                                              SVE=™ppna timmar];
                                                   Editable=No }
    { 337 ;   ;Open Ovh. Surch. (Hours);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Surcharge"."Overhead Surcharge Service" WHERE (Service Location No.=FIELD(No.),
                                                                                                                                   Source Type=FIELD(Source Type Filter),
                                                                                                                                   Cost Component=FIELD(Cost Component Filter),
                                                                                                                                   Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Ovh. Surch. (Hours);
                                                              NOR=pen tilleggsgebyr for overhead (Timer);
                                                              SVE=™ppen overheadkostnad (timmar)];
                                                   Editable=No }
    { 340 ;   ;Open (Inventory)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Journal Line".Amount WHERE (Service Location No.=FIELD(No.),
                                                                                                     Posting Date=FIELD(Period Filter),
                                                                                                     Cost Component=FIELD(Cost Component Filter),
                                                                                                     Service Source Type=FIELD(Source Type Filter)));
                                                   CaptionML=[ENU=Open (Inventory);
                                                              NOR=pne (lager);
                                                              SVE=™ppna (lager)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 341 ;   ;Open Ovh. Surch. (Inventory);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Journal Surcharge"."Overhead Surcharge Service" WHERE (Service Location No.=FIELD(No.),
                                                                                                                                Posting Date=FIELD(Period Filter),
                                                                                                                                Cost Component=FIELD(Cost Component Filter),
                                                                                                                                Service Source Type=FIELD(Source Type Filter)));
                                                   CaptionML=[ENU=Open Ovh. Surch. (Inventory);
                                                              NOR=pen overheadkost (lager);
                                                              SVE=™ppen overheadkostnad (lager)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 380 ;   ;Name Estimator      ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Estimator)));
                                                   CaptionML=[ENU=Name Estimator;
                                                              NOR=Navn p† Kalkyleansvarlig;
                                                              SVE=Namn p† kalkylansvarig];
                                                   Editable=No }
    { 391 ;   ;Reference Date (Item);Date         ;CaptionML=[ENU=Reference Date Item Prices;
                                                              NOR=Referansedato for artikkelpriser;
                                                              SVE=Referensdatum f”r artikelpriser] }
    { 395 ;   ;Purch Discount Term Group 1;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Customer),
                                                                                                   Type=FILTER(Common|Purchase));
                                                   CaptionML=[ENU=Purchase Discount Term Group (Customer);
                                                              NOR=Innkj›p, Rabattvilk†rsgruppe (Kunde);
                                                              SVE=Ink”p, rabattvillkorsgrupp (kund)] }
    { 396 ;   ;Purch Discount Term Group 2;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Job),
                                                                                                   Type=FILTER(Common|Purchase));
                                                   CaptionML=[ENU=Purchase Discount Term Group (Job);
                                                              NOR=Innkj›p, Rabattvilk†rsgruppe (Jobb);
                                                              SVE=Ink”p, rabattvillkorsgrupp (jobb)] }
    { 397 ;   ;Sales Discount Term Group 1;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Customer),
                                                                                                   Type=FILTER(Common|Sales));
                                                   CaptionML=[ENU=Sales Discount Term Group (Customer);
                                                              NOR=Salg, rabattvilk†rsgruppe (Kunde);
                                                              SVE=F”rs„ljning, rabattvillkorsgrupp (kund)] }
    { 398 ;   ;Sales Discount Term Group 2;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Job),
                                                                                                   Type=FILTER(Common|Sales));
                                                   CaptionML=[ENU=Sales Discount Term Group (Job);
                                                              NOR=Salg, Rabattvilk†rsgruppe (Jobb);
                                                              SVE=F”rs„ljning, rabattvillkorsgrupp (jobb)] }
    { 400 ;   ;Purchase            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                         Service Location No.=FIELD(No.),
                                                                                                         Service Source Type=FIELD(Source Type Filter),
                                                                                                         Cost Component=FIELD(Cost Component Filter),
                                                                                                         Order Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Purchase;
                                                              NOR=Innkj›p;
                                                              SVE=Ink”p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 420 ;   ;Received/Not Inv. Hours;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Hours Rcd. Not Invoiced" WHERE (Service Location No.=FIELD(No.),
                                                                                                                                  Service Source Type=FIELD(Source Type Filter),
                                                                                                                                  Cost Component=FIELD(Cost Component Filter),
                                                                                                                                  Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Received/Not Inv. Hours;
                                                              NOR=Mottatte/ikke fakturerte timer;
                                                              SVE=Mottaget/inte fakt. Timmar];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 430 ;   ;Parent No.          ;Code20        ;TableRelation="Service Location";
                                                   OnValidate=BEGIN
                                                                IF "Parent No." = "No." THEN
                                                                  ERROR(Text004);
                                                                IF "Parent No." <> '' THEN  //db, 12-08-09: M16168
                                                                  CheckMainSubLocationStructure(Rec."No.", "Parent No.");
                                                              END;

                                                   CaptionML=[ENU=Main Location;
                                                              NOR=Hovedplassering;
                                                              SVE=Huvudplats] }
    { 440 ;   ;Picture OLD         ;BLOB          ;CaptionML=[ENU=Picture OLD;
                                                              NOR=Bilde;
                                                              SVE=Bild];
                                                   SubType=Bitmap }
    { 450 ;   ;Condition           ;Code10        ;TableRelation=Condition.Code;
                                                   CaptionML=[ENU=Condition;
                                                              NOR=Betingelse;
                                                              SVE=Villkor] }
    { 460 ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                                UpdatePrefLocations;  //db, 23-02-15: C013902
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 kode;
                                                              SVE=Global dimension 1 kod];
                                                   CaptionClass='1,1,1' }
    { 470 ;   ;Watch               ;Code10        ;TableRelation=Watch;
                                                   OnValidate=BEGIN
                                                                IF Watch <> '' THEN
                                                                  LookupCheckWatch(FALSE);
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupCheckWatch(TRUE);
                                                            END;

                                                   CaptionML=[ENU=Watch;
                                                              NOR=Observer;
                                                              SVE=Observera] }
    { 480 ;   ;Estimate No.        ;Code20        ;TableRelation=Estimate.No.;
                                                   CaptionML=[ENU=Estimate No.;
                                                              NOR=Kalkylenr;
                                                              SVE=Kalkylnr];
                                                   Editable=No }
    { 490 ;   ;Allowed Costs       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Amount WHERE (Service Location No.=FIELD(No.),
                                                                                                             Finished=CONST(Yes),
                                                                                                             Source Type=FIELD(Source Type Filter),
                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                             Index Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Allowed Costs;
                                                              NOR=Tillatte koster;
                                                              SVE=Till†tna kostnader];
                                                   Editable=No }
    { 491 ;   ;Allowed Costs (Ovh. Surch.);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line"."Overhead Surcharge" WHERE (Service Location No.=FIELD(No.),
                                                                                                                           Finished=CONST(Yes),
                                                                                                                           Source Type=FIELD(Source Type Filter),
                                                                                                                           Cost Component=FIELD(Cost Component Filter),
                                                                                                                           Index Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Allowed Costs (Overhead Surcharge);
                                                              NOR=Tillatte koster (Overheadkost);
                                                              SVE=Till†tna kostnader (overheadkostnad)];
                                                   Editable=No }
    { 492 ;   ;Allowed Hours       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Hours WHERE (Service Location No.=FIELD(No.),
                                                                                                            Finished=CONST(Yes),
                                                                                                            Source Type=FIELD(Source Type Filter),
                                                                                                            Cost Component=FIELD(Cost Component Filter),
                                                                                                            Index Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Allowed Hours;
                                                              NOR=Tillatte timer;
                                                              SVE=Till†tna timmar];
                                                   Editable=No }
    { 500 ;   ;Budget Ovh. Surch. (ServOrder);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line"."Overhead Surcharge" WHERE (Service Location No.=FIELD(No.),
                                                                                                                           Source Type=FIELD(Source Type Filter),
                                                                                                                           Cost Component=FIELD(Cost Component Filter),
                                                                                                                           Index Date=FIELD(Period Filter),
                                                                                                                           Budget Type=CONST(Order)));
                                                   CaptionML=[ENU=Budget Overhead Surcharge (Service Order);
                                                              NOR=Budsjettert Overheadkost (Serviceordre);
                                                              SVE=Budgetoverheadskostnad (serviceorder)];
                                                   Editable=No }
    { 510 ;   ;Budget Amount (ST Contract);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Amount WHERE (Service Location No.=FIELD(No.),
                                                                                                             Source Type=CONST(Contract),
                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                             Index Date=FIELD(Period Filter),
                                                                                                             Budget Type=CONST(Order)));
                                                   CaptionML=[ENU=Budget Amount (Source Type Contract);
                                                              NOR=Budsjettbel›p (Kildetype for Kontrakt);
                                                              SVE=Budgetbelopp (ursprungstypskontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 511 ;   ;Budget Ovh. Surch. (ST Contr);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line"."Overhead Surcharge" WHERE (Service Location No.=FIELD(No.),
                                                                                                                           Source Type=CONST(Contract),
                                                                                                                           Cost Component=FIELD(Cost Component Filter),
                                                                                                                           Index Date=FIELD(Period Filter),
                                                                                                                           Budget Type=CONST(Order)));
                                                   CaptionML=[ENU=Budget Overhead Surcharge (Source Type Contract);
                                                              NOR=Budsjett for overheadkost (kildetype for kontrakt);
                                                              SVE=Budgeterad overheadkostnad (ursprungstypskontrakt)];
                                                   Editable=No }
    { 531 ;   ;Date Out of Use     ;Date          ;CaptionML=[ENU=Date Out of Use;
                                                              NOR=Datoen kan ikke brukes;
                                                              SVE=Datumet kan inte användas] }
    { 540 ;   ;Initial Minutes Working Hours;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Initial Minutes Working Hours" <> 0 THEN
                                                                  TestIsFSAActive;
                                                              END;

                                                   CaptionML=[ENU=Initial Minutes Working Hours;
                                                              NOR=Startminutter, Arbeidstimer;
                                                              SVE=Startminuter, arbetstimmar];
                                                   MinValue=0 }
    { 541 ;   ;Round Working Hours on Minutes;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Round Working Hours on Minutes" <> 0 THEN
                                                                  TestIsFSAActive;
                                                              END;

                                                   CaptionML=[ENU=Round Working Hours on Minutes;
                                                              NOR=Rund av Arbeidstimer p† Minutter;
                                                              SVE=Omg†ng, arbetstimmar minuter];
                                                   MinValue=0 }
    { 542 ;   ;Round Travel Hours on Minutes;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Round Travel Hours on Minutes" <> 0 THEN
                                                                  TestIsFSAActive;
                                                              END;

                                                   CaptionML=[ENU=Round Travel Hours on Minutes;
                                                              NOR=Rund av Reisetimer p† Minutter;
                                                              SVE=Omg†ng, restimmar minuter];
                                                   MinValue=0 }
    { 550 ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              NOR=Spr†kkode;
                                                              SVE=Spr†kkod] }
    { 560 ;   ;Location Customer   ;Code20        ;CaptionML=[ENU=Location Customer;
                                                              NOR=Plassering, Kunde;
                                                              SVE=Lagerställe, kund] }
    { 570 ;   ;Post Code Group     ;Code20        ;TableRelation="Post Code Group".Code;
                                                   OnValidate=BEGIN
                                                                PostCode.GetTerritoryByPostCodeGroup(City,"Post Code","Territory Code");  //db, 11-02-13: C005566
                                                                PostCode.GetDepartmentCodeByPostCodeGroup(City, "Post Code", "Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Post Code Group;
                                                              NOR=Postnummergruppe;
                                                              SVE=Postnummergrupp];
                                                   Description=SERV_CONS }
    { 580 ;   ;Customer Feature    ;Text30        ;CaptionML=[ENU=Customer Feature;
                                                              NOR=Kundefunksjon;
                                                              SVE=Kundfunktion];
                                                   Description=SERV_CONS }
    { 585 ;   ;Location Structure Format;Code20   ;OnValidate=VAR
                                                                pos@1100528600 : Integer;
                                                                Level@1100528601 : Integer;
                                                              BEGIN
                                                                IF "Location Structure Format" = '' THEN
                                                                  EXIT;

                                                                Level := 1;
                                                                REPEAT
                                                                  pos += 1;
                                                                  IF COPYSTR("Location Structure Format", pos, 1) = '.' THEN
                                                                    Level += 1;
                                                                UNTIL pos = STRLEN("Location Structure Format");
                                                                IF Level > 3 THEN
                                                                  ERROR(Text008);
                                                              END;

                                                   CaptionML=[ENU=Location Structure Format;
                                                              NOR=Plassering, Strukturformat;
                                                              SVE=Lagerställe, strukturformat];
                                                   Description=SERV_CONS }
    { 590 ;   ;Contact No.         ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Contact Business Relation"."Contact No." WHERE (Link to Table=CONST(Customer),
                                                                                                                       No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Contact No.;
                                                              NOR=Kontaktnr;
                                                              SVE=Kontaktnr];
                                                   Editable=No }
    { 595 ;   ;Contact Person No.  ;Code20        ;TableRelation=Contact.No. WHERE (Type=CONST(Person),
                                                                                    Company No.=FIELD(Contact No.),
                                                                                    Blocked=CONST(No));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Contact Person Name");
                                                                "Contact Name" := "Contact Person Name";
                                                              END;

                                                   CaptionML=[ENU=Contact Person No.;
                                                              NOR=Kontaktperson;
                                                              SVE=Kontaktperson] }
    { 596 ;   ;Contact Person Name ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Person No.)));
                                                   CaptionML=[ENU=Contact Person Name;
                                                              NOR=Kontaktpersonens navn;
                                                              SVE=Kontaktpersonens namn];
                                                   Editable=No }
    { 600 ;   ;Complex Code        ;Code20        ;TableRelation=Complex;
                                                   CaptionML=[ENU=Complex Code;
                                                              NOR=Komplekskode;
                                                              SVE=Servicekomplexkod] }
    { 610 ;   ;Default Tender Code System OLD;Code10;
                                                   TableRelation="Coding System"."Coding System";
                                                   CaptionML=[ENU=Default Tender Code System (OBSOLETE);
                                                              NOR=Standard tilbudskodesystem (foreldet);
                                                              SVE=Standardandbudkodsystem];
                                                   Description=OBSOLETE }
    { 620 ;   ;House No.           ;Code20        ;CaptionML=[ENU=House No.;
                                                              NOR=Husnr.;
                                                              SVE=Husnr];
                                                   Description=SERV_CONS }
    { 630 ;   ;House No. Ext.      ;Code10        ;CaptionML=[ENU=House No. Extension;
                                                              NOR=Husnr ETA;
                                                              SVE=Husnr ÄTA];
                                                   Description=SERV_CONS }
    { 640 ;   ;Travel Cost Code    ;Code10        ;TableRelation="Travel Cost Code";
                                                   CaptionML=[ENU=Travel Cost Code;
                                                              NOR=Reisekostkode;
                                                              SVE=Resekostnadskod] }
    { 650 ;   ;Building Code       ;Code20        ;TableRelation=Building;
                                                   CaptionML=[ENU=Building;
                                                              NOR=Byggning;
                                                              SVE=Byggnad] }
    { 660 ;   ;Building Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Building.Description WHERE (Code=FIELD(Building Code)));
                                                   CaptionML=[ENU=Building Description;
                                                              NOR=Beskrivelse Bygning;
                                                              SVE=Beskrivning Byggnad];
                                                   Editable=No }
    { 670 ;   ;Publish on Service Portal;Boolean  ;CaptionML=[ENU=Publish on Portal;
                                                              NOR=Publiser p† Serviceportal;
                                                              SVE=Publicera p† serviceportalen] }
    { 680 ;   ;Maintenance Day     ;Option        ;CaptionML=[ENU=Maintenance Day;
                                                              NOR=Vedlikeholdsdag;
                                                              SVE=Underhållsdag];
                                                   OptionCaptionML=[ENU=" ,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday,Weekday,Weekend";
                                                                    NOR=" ,Mandag,Tirsdag,Onsdag,Torsdag,Fredag,L›rdag,S›ndag,Ukedag,Helg";
                                                                    SVE=" ,Måndag,Tisdag,Onsdag,Torsdag,Fredag,Lördag,Söndag,Veckodag,Helg"];
                                                   OptionString=[ ,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday,Weekday,Weekend] }
    { 690 ;   ;Starting Time Maint. Window;Time   ;OnValidate=BEGIN
                                                                TestMaintenanceTimes;
                                                              END;

                                                   CaptionML=[ENU=Starting Time Maintenance Window;
                                                              NOR=Vinduet Startid for Vedlikehold;
                                                              SVE=Underh†llsf”nster starttid] }
    { 700 ;   ;Ending Time Maint. Window;Time     ;OnValidate=BEGIN
                                                                TestMaintenanceTimes;
                                                              END;

                                                   CaptionML=[ENU=Ending Time Maintenance Window;
                                                              NOR=Vinduet Sluttid for Vedlikehold;
                                                              SVE=F”nstret sluttid f”r underh†ll] }
    { 710 ;   ;Deliver             ;Option        ;OnValidate=BEGIN
                                                                //db, 18-12-12: C000433
                                                                IF Deliver <> xRec.Deliver THEN
                                                                  "Ship To Location" := '';
                                                              END;

                                                   CaptionML=[ENU=Deliver;
                                                              NOR=Lever;
                                                              SVE=Leverera];
                                                   OptionCaptionML=[ENU=" ,Location,,Service Loc. Ship-to Address";
                                                                    NOR=" ,Plassering";
                                                                    SVE=" ,Lagerst„lle,,Serviceplats lev.adress"];
                                                   OptionString=[ ,Location,,Service Loc. Ship-to Address] }
    { 720 ;   ;Ship To Location    ;Code20        ;TableRelation=IF (Deliver=CONST(Location)) Location.Code
                                                                 ELSE IF (Deliver=CONST(Service Loc. Ship-to Address)) "Service Loc. Ship-to Address".Code WHERE (Service Location No.=FIELD(No.));
                                                   OnValidate=BEGIN
                                                                //db, 18-12-12: C000433
                                                                IF ("Ship To Location" <> '') THEN
                                                                  TESTFIELD(Deliver);
                                                              END;

                                                   CaptionML=[ENU=Ship To Location;
                                                              NOR=Lever til lokasjon;
                                                              SVE=Leverera till lagerst„lle] }
    { 730 ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                ShiptoAddress@1100529600 : Record 222;
                                                              BEGIN
                                                                IF "Bill-to Customer No." <> xRec."Bill-to Customer No." THEN BEGIN
                                                                  "Bill-to Contact Person" := '';
                                                                  IF ShiptoAddress.GetAlternativeBilltoAddress("Bill-to Customer No.", ShiptoAddress.Code) THEN
                                                                    "Alternative Bill-to Address" := ShiptoAddress.Code
                                                                  ELSE
                                                                    "Alternative Bill-to Address" := '';
                                                                END;
                                                                ValidateBillToCustAddressData;
                                                                CALCFIELDS("Bill-to Name", "Bill-to Contact No.");
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              SVE=Faktureringskundnr] }
    { 731 ;   ;Bill-to Name        ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to Name;
                                                              SVE=Faktureringsnamn];
                                                   Editable=No }
    { 732 ;   ;Bill-to Name 2      ;Text50        ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Bill-to Name 2;
                                                              SVE=Faktureringsnamn 2];
                                                   Editable=No }
    { 733 ;   ;Bill-to Address     ;Text100       ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Bill-to Address;
                                                              SVE=Faktureringsadress];
                                                   Editable=No }
    { 734 ;   ;Bill-to Address 2   ;Text50        ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Bill-to Address 2;
                                                              SVE=Faktureringsadress 2];
                                                   Editable=No }
    { 735 ;   ;Bill-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Bill-to Post Code;
                                                              SVE=Faktureras postnr];
                                                   Editable=No }
    { 736 ;   ;Bill-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Bill-to City;
                                                              SVE=Faktureras ort];
                                                   Editable=No }
    { 740 ;   ;Bill-to Contact No. ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Contact Business Relation"."Contact No." WHERE (Link to Table=CONST(Customer),
                                                                                                                       No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to Contact No.;
                                                              SVE=Faktureringskontaktnr];
                                                   Editable=No }
    { 750 ;   ;Bill-to Contact Person;Code20      ;TableRelation=Contact.No. WHERE (Company No.=FIELD(Bill-to Contact No.),
                                                                                    Type=CONST(Person));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Bill-to Contact Person Name");
                                                                "Bill-to Contact Name" := "Bill-to Contact Person Name";
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Bill-to Contact Person;
                                                              SVE=Faktura till kontaktperson] }
    { 751 ;   ;Bill-to Contact Person Name;Text100;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Bill-to Contact Person)));
                                                   CaptionML=[ENU=Bill-to Contact Person Name;
                                                              SVE=Faktura till kontaktperson, namn];
                                                   Editable=No }
    { 760 ;   ;Bill-to Contact Name;Text100       ;OnValidate=BEGIN
                                                                IF (CurrFieldNo = FIELDNO("Bill-to Contact Name")) AND ("Bill-to Contact Name" <> xRec."Bill-to Contact Name") THEN
                                                                  UpdateServiceOrders;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Bill-to Contact Name;
                                                              SVE=Fakturera till kontaktnamn] }
    { 770 ;   ;Alternative Bill-to Address;Code10 ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Bill-to Customer No.),
                                                                                               Billing Address=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                CheckInvoiceAddress;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Alternative Bill-to Address;
                                                              SVE=Alternativ faktureringsadress] }
    { 800 ;   ;Generate Document Portal Site;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Document Portal Site Generated", FALSE);
                                                              END;

                                                   CaptionML=[ENU=Generate Document Portal Site;
                                                              SVE=Generera dokumentportalsida] }
    { 810 ;   ;Document Portal Site Generated;Boolean;
                                                   CaptionML=[ENU=Document Portal Site Generated;
                                                              SVE=Dokumentportalssida, Genererad];
                                                   Editable=No }
    { 820 ;   ;Document Portal URL ;Text100       ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Document Portal URL;
                                                              SVE=Dokumentportal];
                                                   Editable=No }
    { 825 ;   ;Document Portal Language;Code10    ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Document Portal Site Generated", FALSE);
                                                              END;

                                                   CaptionML=[ENU=Document Portal Language;
                                                              SVE=Dokumentportalsspr†k] }
    { 830 ;   ;Warranty Project No.;Code20        ;TableRelation=IF (Warranty Company=FILTER('')) Job.No. WHERE (Internal Project=CONST(No));
                                                   OnValidate=BEGIN
                                                                CheckCompanyIC;
                                                                IF "Warranty Project No." <> xRec."Warranty Project No." THEN BEGIN
                                                                  VALIDATE("Warranty Element No", '');
                                                                  IF "Warranty Project No." <> '' THEN BEGIN
                                                                    ProjRec.GET("Warranty Project No.");
                                                                    IF NOT (ProjRec."Project Status" IN [ProjRec."Project Status"::Production, ProjRec."Project Status"::"Technical Finished"]) THEN
                                                                      ProjRec.FIELDERROR("Project Status");
                                                                  END ELSE
                                                                    "Warranty Expires On" := 0D;
                                                                  IF NOT ProjectElement.GET("Warranty Project No.", "Warranty Element No") THEN
                                                                    "Warranty Element No" := '';
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              PageNo@1100527400 : Integer;
                                                            BEGIN
                                                              CheckCompanyIC;
                                                              ProjRec."No." := "Warranty Project No.";
                                                              IF RefersToOtherCompany THEN
                                                                PageNo := PAGE::"Job List IC";
                                                              IF PAGE.RUNMODAL(PageNo, ProjRec) = ACTION::LookupOK THEN
                                                                VALIDATE("Warranty Project No.", ProjRec."No.");
                                                            END;

                                                   CaptionML=ENU=Warranty Project No. }
    { 840 ;   ;Warranty Element No ;Code20        ;TableRelation=IF (Warranty Company=FILTER('')) "Project Element".Element WHERE (Project No.=FIELD(Warranty Project No.));
                                                   OnValidate=VAR
                                                                FormatManagement@1100527401 : Codeunit 11012022;
                                                              BEGIN
                                                                IF "Warranty Element No" <> '' THEN BEGIN
                                                                  CheckCompanyIC;
                                                                  FormatManagement.FormatElem("Warranty Element No",2,'');
                                                                  ProjectElement.GET("Warranty Project No.", "Warranty Element No");
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              CheckCompanyIC;
                                                              ProjectElement."Project No." := "Warranty Project No.";
                                                              ProjectElement.Element := "Warranty Element No";
                                                              ProjectElement.SETRANGE("Project No.", "Warranty Project No.");
                                                              IF PAGE.RUNMODAL(0, ProjectElement) = ACTION::LookupOK THEN
                                                                VALIDATE("Warranty Element No", ProjectElement.Element);
                                                            END;

                                                   CaptionML=ENU=Warranty Element No }
    { 850 ;   ;Warranty Expires On ;Date          ;OnValidate=BEGIN
                                                                IF "Warranty Expires On" <> 0D THEN
                                                                  TESTFIELD("Warranty Project No.");
                                                              END;

                                                   CaptionML=ENU=Warranty Expires On }
    { 860 ;   ;Tenant No.          ;Code20        ;OnValidate=BEGIN
                                                                TestUniqueTentantID;
                                                              END;

                                                   CaptionML=[ENU=Tenant No.;
                                                              SVE=Klientnummer] }
    { 900 ;   ;Latitude            ;Code30        ;OnValidate=BEGIN
                                                                ValidateGPSCoordinate(Latitude);
                                                              END;

                                                   CaptionML=[ENU=Latitude;
                                                              NOR=Breddegrad;
                                                              SVE=Latitud];
                                                   CharAllowed=09.. }
    { 910 ;   ;Longitude           ;Code30        ;OnValidate=BEGIN
                                                                ValidateGPSCoordinate(Longitude);
                                                              END;

                                                   CaptionML=[ENU=Longitude;
                                                              NOR=Lengdegrad;
                                                              SVE=Longitud];
                                                   CharAllowed=09.. }
    { 920 ;   ;Revenues incl. Period;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Revenue (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                       Posting Date=FIELD(Cumulative Filter),
                                                                                                                       Source Type=FIELD(Source Type Filter),
                                                                                                                       Cost Component=FIELD(Cost Component Filter),
                                                                                                                       Revenue Present=CONST(Yes)));
                                                   CaptionML=ENU=Revenues up to and including Period;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 930 ;   ;Actual Costs incl. Period;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                    Posting Date=FIELD(Period Filter),
                                                                                                                    Source Type=FIELD(Source Type Filter),
                                                                                                                    Cost Component=FIELD(Cost Component Filter),
                                                                                                                    Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Costs up to and including Period;
                                                              SVE=Verkliga kostnader fram till och med period];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 940 ;   ;Image               ;Media         ;CaptionML=[ENU=Image;
                                                              NOR=Image;
                                                              SVE=Bild] }
    { 950 ;   ;Rental Unit         ;Code20        ;TableRelation="Rental Unit" WHERE (Project No.=FIELD(Project No.));
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Rental Unit;
                                                              SVE=Uthyrningsenhet] }
    { 960 ;   ;Vessel No.          ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.No. WHERE (No.=FIELD(No.)));
                                                   CaptionML=[ENU=Vessel No.;
                                                              SVE=Fartygsnr];
                                                   Editable=No }
    { 970 ;   ;Vessel Name         ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.Name WHERE (No.=FIELD(No.)));
                                                   CaptionML=[ENU=Vessel Name;
                                                              SVE=Fartygsnamn];
                                                   Editable=No }
    { 980 ;   ;Vessel Start Date   ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Start Date" WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Start Date;
                                                   Editable=No }
    { 990 ;   ;Vessel Main Category;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Main Category" WHERE (No.=FIELD(No.)));
                                                   CaptionML=[ENU=Vessel Main Category;
                                                              SVE=Huvudkategori f”r fartyg];
                                                   Editable=No }
    { 1000;   ;Vessel Category     ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.Category WHERE (No.=FIELD(No.)));
                                                   CaptionML=[ENU=Vessel Category;
                                                              SVE=Fartygskategori];
                                                   Editable=No }
    { 1010;   ;Vessel Flag         ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.Flag WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Flag;
                                                   Editable=No }
    { 1020;   ;Vessel MMSI         ;Text10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.MMSI WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel MMSI;
                                                   Editable=No }
    { 1030;   ;Vessel GRT          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.GRT WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel GRT;
                                                   Editable=No }
    { 1040;   ;Vessel Call Sign    ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Call Sign" WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Call Sign;
                                                   Editable=No }
    { 1050;   ;Vessel Classification;Code10       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.Classification WHERE (No.=FIELD(No.)));
                                                   CaptionML=[ENU=Vessel Classification;
                                                              SVE=Fartygsklassificering];
                                                   Editable=No }
    { 1060;   ;Vessel Reason Out of Use;Code10    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Reason Out of use" WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Reason Out of Use;
                                                   Editable=No }
    { 1070;   ;Vessel Date Out of Use;Date        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Date Out of Use" WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Date Out of Use;
                                                   Editable=No }
    { 1080;   ;Vessel Yard         ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.Yard WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Yard;
                                                   Editable=No }
    { 1090;   ;Vessel Build in     ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Build in" WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Build in;
                                                   Editable=No }
    { 2000;   ;Vessel Construction Date;Date      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Construction Date" WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Construction Date;
                                                   Editable=No }
    { 2010;   ;Vessel Plot No.     ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Plot No." WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Plot No.;
                                                   Editable=No }
    { 2020;   ;Vessel Owner Name   ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Owner Name" WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Owner Name;
                                                   Editable=No }
    { 2030;   ;Vessel Owner        ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.Owner WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Owner;
                                                   Editable=No }
    { 2040;   ;Vessel Contract Owner;Code20       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel."Contract Owner" WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Contract Owner;
                                                   Editable=No }
    { 2050;   ;Vessel Manager      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vessel.Manager WHERE (No.=FIELD(No.)));
                                                   CaptionML=ENU=Vessel Manager;
                                                   Editable=No }
    { 2060;   ;Tenant              ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContactRec@1100530700 : Record 5050;
                                                              BEGIN
                                                                IF Tenant <> '' THEN BEGIN
                                                                  IF ContactRec.GET(Tenant) THEN BEGIN
                                                                    "Tenant Name" := ContactRec.Name;
                                                                    "Tenant Name 2" := ContactRec."Name 2";
                                                                    "Tenant Phone" := ContactRec."Phone No.";
                                                                    "Tenant Phone 2" := ContactRec."Phone No. 2";
                                                                    "Tenant Mobile Phone" := ContactRec."Mobile Phone No.";
                                                                    "Tenant Mobile Phone 2" := ContactRec."Mobile Phone No. 2";
                                                                    "Tenant E-Mail" := ContactRec."E-Mail";
                                                                    "Tenant E-Mail 2" := ContactRec."E-Mail 2";
                                                                    "Tenant Phone Work" := ContactRec."Phone No. Work";
                                                                    "Tenant Phone Work 2" := ContactRec."Phone No. Work 2";
                                                                  END;
                                                                END ELSE BEGIN
                                                                  "Tenant Name" := '';
                                                                  "Tenant Name 2" := '';
                                                                  "Tenant Phone" := '';
                                                                  "Tenant Phone 2" := '';
                                                                  "Tenant Mobile Phone" := '';
                                                                  "Tenant Mobile Phone 2" := '';
                                                                  "Tenant E-Mail" := '';
                                                                  "Tenant E-Mail 2" := '';
                                                                  "Tenant Phone Work" := '';
                                                                  "Tenant Phone Work 2" := '';
                                                                END;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant }
    { 2070;   ;Tenant Name         ;Text100       ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant Name }
    { 2080;   ;Tenant Name 2       ;Text50        ;CaptionML=ENU=Tenant Name 2 }
    { 2090;   ;Tenant Phone        ;Text30        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant Phone }
    { 2100;   ;Tenant Phone 2      ;Text30        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant Phone 2 }
    { 2110;   ;Tenant Mobile Phone ;Text30        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant Mobile Phone }
    { 2120;   ;Tenant Mobile Phone 2;Text30       ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant Mobile Phone 2 }
    { 2130;   ;Tenant E-Mail       ;Text80        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant E-Mail }
    { 2140;   ;Tenant E-Mail 2     ;Text80        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant E-Mail 2 }
    { 2150;   ;Tenant Phone Work   ;Text30        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant Phone Work }
    { 2160;   ;Tenant Phone Work 2 ;Text30        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Tenant Phone Work 2 }
    { 11012000;;LT. Maint. Plan Location OBS;Boolean;
                                                   CaptionML=ENU=LT. Maint. Plan Location (OBSOLETE);
                                                   Description=OBSOLETE }
    { 11012010;;Def. LTMP Loc. Structure No.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Location Structure".No. WHERE (Service Location No.=FIELD(No.),
                                                                                                              Default for LTMP=CONST(Yes)));
                                                   CaptionML=[ENU=Default LTMP Location Structure No.;
                                                              NOR=Standard LTMP-Plassering Strukturnr.];
                                                   Editable=No }
    { 11012020;;Total Cost Amount  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Location No.=FIELD(No.),
                                                                                                                    Cost Present=CONST(Yes),
                                                                                                                    Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Total Cost Amount;
                                                              NOR=Totalt kostbel›p;
                                                              SVE=Totalt kostnadsbelopp];
                                                   Editable=No }
    { 11012030;;Period Filter      ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Period Filter;
                                                              NOR=Periodefilter;
                                                              SVE=Periodfilter] }
    { 11012035;;Cumulative Filter  ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Cumulative Filter;
                                                              SVE=Kumulativt filter] }
    { 11012040;;No. of Service Calls;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Call" WHERE (Service Location No.=FIELD(No.),
                                                                                           Receiving Date=FIELD(Period Filter)));
                                                   CaptionML=ENU=No. of Service Calls;
                                                   Editable=No }
    { 11012050;;Postal Address App. Letter;Option ;OnValidate=BEGIN
                                                                IF "Postal Address App. Letter" <> "Postal Address App. Letter"::"Customer Address" THEN
                                                                  VALIDATE("Customer Address Code", '');
                                                              END;

                                                   CaptionML=ENU=Postal Address App. Letter;
                                                   OptionCaptionML=ENU=Customer,Customer Address,Service Location;
                                                   OptionString=Customer,Customer Address,Service Location }
    { 11012060;;Customer Address Code;Code10      ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   OnValidate=BEGIN
                                                                IF "Customer Address Code" <> '' THEN
                                                                  TESTFIELD("Postal Address App. Letter", "Postal Address App. Letter"::"Customer Address");
                                                              END;

                                                   CaptionML=ENU=Customer Address Code }
    { 11012070;;Post Code Type     ;Option        ;CaptionML=[ENU=Post Code Type;
                                                              SVE=Postkodtyp];
                                                   OptionCaptionML=ENU=" ,Odd,Even,House Boat,House Trailer";
                                                   OptionString=[ ,Odd,Even,House Boat,House Trailer];
                                                   Editable=No }
    { 11012990;;Export to FSA      ;Boolean       ;CaptionML=[ENU=Export to Field Service;
                                                              NOR=Eksporter til Feltservice;
                                                              SVE=Exportera till f„ltservice];
                                                   Description=Indication new/changed. BDA= Buitendienstadmin. (Field Service Admin.) }
    { 11012991;;Date/Time Export to FSA;DateTime  ;CaptionML=[ENU=Date/Time Export to Field Service;
                                                              NOR=Dato/tid, Eksporter til Feltservice;
                                                              SVE=Datum/tid, export till f„ltservice] }
    { 11125625;;VAT Prod. Posting Group;Code20    ;TableRelation="VAT Product Posting Group";
                                                   OnValidate=BEGIN
                                                                CheckVATReverse(TRUE,FALSE);
                                                              END;

                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Moms produktbokf›ringsmal;
                                                              SVE=Moms produktbokf”ringsmall];
                                                   Description=4PS-BE }
    { 11125626;;Percentage Labor   ;Decimal       ;OnValidate=BEGIN
                                                                CheckVATReverse(TRUE,FALSE);
                                                              END;

                                                   CaptionML=[ENU=% Labor;
                                                              NOR=% arbeidskraft;
                                                              SVE=Procent, arbetskraft];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PS-BE;
                                                   AutoFormatType=1 }
    { 11125627;;Percentage to B Account;Decimal   ;OnValidate=BEGIN
                                                                CheckVATReverse(TRUE,FALSE);
                                                              END;

                                                   CaptionML=[ENU=% to B Account;
                                                              NOR=% til B-konto;
                                                              SVE=Procent till B-konto];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PS-BE }
    { 11125630;;Service Location Type;Code20      ;TableRelation="Service Location Type";
                                                   CaptionML=[ENU=Service Location Type;
                                                              SVE=Serviceplatstyp] }
    { 11125640;;Real Estate Unit Number;Code50    ;CaptionML=ENU=Real Estate Unit Number }
    { 11125641;;BAG Id             ;Code20        ;CaptionML=[ENU=BAG Id;
                                                              NOR=BAG-ID;
                                                              SVE=BAG-id] }
    { 11125650;;Warranty Company   ;Text30        ;TableRelation=Company;
                                                   OnValidate=VAR
                                                                CheckLicenceIC@1100527400 : Codeunit 11012780;
                                                              BEGIN
                                                                IF "Warranty Company" <> '' THEN
                                                                  CheckLicenceIC.CheckICEntry("Warranty Company");
                                                                IF "Warranty Company" <> xRec."Warranty Company" THEN BEGIN
                                                                  CheckCompanyIC;
                                                                  "Warranty Project No." := '';
                                                                  "Warranty Element No" := '';
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Warranty Company }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Customer No.                             }
    {    ;Post Code                                }
    {    ;Search Name                              }
    {    ;City,Address                             }
    {    ;Supplying Company,Project No.            }
    {    ;Post Code,House No.,House No. Ext.       }
    {    ;Building Code                            }
    {    ;Complex Code                             }
    {    ;Latitude,Longitude                       }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;No.,Description,Address,Customer No.,Image }
  }
  CODE
  {
    VAR
      Text000@11012009 : TextConst 'ENU=must occur before %1;NOR=m† inntreffe f›r %1;SVE=m†ste intr„ffa f”re %1';
      Text001@11012010 : TextConst 'ENU=Must occur after  %1;NOR=m† forekomme etter %1;SVE=M†ste intr„ffa efter %1';
      ServSetup@11012000 : Record 11012800;
      ProjSetupRec@1100525001 : Record 315;
      PrefEmplRec@1100485002 : Record 11012843;
      CustRec@1210190000 : Record 18;
      AdrsRec@11012004 : Record 222;
      PostCode@1210190001 : Record 225;
      ProjRec@1210190006 : Record 11072003;
      PlotRec@1210190007 : Record 11012500;
      NoSeriesMgt@1210190002 : Codeunit 396;
      Text003@1210190003 : TextConst 'ENU=Fill Supplying Company only when it differs from current Company;NOR=Fyll kun ut Leverende selskap hvis det skiller seg fra aktuelt selskap;SVE=Fyll endast i levererande företag om det skiljer sig från aktuellt företag';
      Text004@1100485000 : TextConst 'ENU=The Service Location cannot be linked to itself.;NOR=Servicelokasjonen kan ikke v‘re linket til seg selv.;SVE=Serviceplatsen kan inte vara länkad till sig själv.';
      Text005@1100485001 : TextConst 'ENU=The Service Location %1 is already a Sub Location of Service Location %2;NOR=Servicelokasjon %1 er allerede en Underplassering av Servicelokasjon %2;SVE=Serviceplats %1 är redan en underplats av serviceplats %2';
      Text006@1100485004 : TextConst 'ENU=%1 %2 created;NOR=%1 %2 er opprettet.;SVE=%1 %2 har skapats.';
      Text007@1100525002 : TextConst 'ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.;NOR=F›r du kan bruke Online Map m† du fylle ut vinduet Online Map - Innstillinger.\Se Konfigurasjon av Online Map i Hjelp;SVE=Innan du kan anv„nda Online Map m†ste du fylla i f”nstret Online Map - inst„llning.\Se Konfiguration av Online Map i hj„lpen';
      DPA_Management@1100000999 : Codeunit 11012783;
      Text008@1100528600 : TextConst 'ENU=Only 3 levels allowed;NOR=kun tre niv†er tillates;SVE=Endast tre niv†er till†ts';
      Text009@1100528300 : TextConst 'ENU=%1 %2 is not a valid %1.;NOR=%1 %2 er ikke en gyldig %1.;SVE=%1 %2 „r inte ett giltigt %1.';
      Text010@1210190008 : TextConst 'ENU=%1 Objects Created;NOR=%1 Objekter opprettet;SVE=%1 objekt skapade';
      Text011@1100528700 : TextConst 'ENU=%1 cannot be changed. %2 is linked to %3.;NOR=%1 kan ikke endres. %2 er linket til %3;SVE=%1 kan ite „ndras. %2 „r kopplad till %3.';
      Text012@1100409000 : TextConst 'ENU=Location already exists at No. %1;NOR=Plassering finnes allerede p† Nr. %1';
      Text020@1100525003 : TextConst 'ENU=Do you want to change Address Data: \\Old: \%1 \%2 \%3 \%4 \%5 \\New: \%6 \%7 \%8 \%9 \%10;NOR=Vil du endre adressedata? \\Gammel: \%1 \%2 \%3 \%4 \%5 \\Ny: \%6 \%7 \%8 \%9 \%10;SVE=Vill du „ndra adressdata? \\Gammal: \%1 \%2 \%3 \%4 \%5 \\Nya: \%6 \%7 \%8 \%9 \%10';
      Text021@1100525004 : TextConst 'ENU=Update changed Customer No.;NOR=Oppdatering endret Kundenr.';
      Text022@1100525000 : TextConst 'ENU=This will delete all linked objects, continue?';
      Text023@1100529400 : TextConst 'ENU=Invalid GPS coordinate';
      Text024@1100528601 : TextConst 'ENU=%1 is not unique;SVE=%1 „r inte unik';
      Text025@1100529600 : TextConst 'ENU=Do you want to update related Service Orders for this Service Location to reflect the new value of %1?';
      Text026@1100527301 : TextConst 'ENU=The Plot No. is already in use by another service location';
      Text999a@1100530000 : TextConst 'ENU=Change Data;NOR=Endre data;SVE=Ändra data';
      Text999b@1100530001 : TextConst 'ENU=Old;NOR=Gammel;SVE=Gammal';
      Text999c@1100530002 : TextConst 'ENU=New;NOR=Ny;SVE=Nytt';
      Text11012040@1100409001 : TextConst 'ENU=Do you want to replace existing preferred locations?;NOR=Vil du erstatte eksisterende foretrukne lokasjoner?;SVE=Vill du ers„tta befintliga, f”rvalda platser?';
      PhoneNumberFormatting@1100525006 : Codeunit 11012276;
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
      SkipUpdateAddress@1100527300 : Boolean;
      ContactDataValidation@1100528500 : Codeunit 11012275;
      ProjectElement@1100527401 : Record 11012010;
      GPSCoordinatesMgt@1100528100 : Codeunit 11012639;

    PROCEDURE AssistEdit@2(OldServLoc@11012000 : Record 11012801) : Boolean;
    VAR
      ServLoc@1100525000 : Record 11012801;
    BEGIN
      WITH ServLoc DO BEGIN
        ServLoc := Rec;
        ServSetup.GET;
        ServSetup.TESTFIELD("Service Location Nos.");
        IF NoSeriesMgt.SelectSeries(ServSetup."Service Location Nos.",OldServLoc."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := ServLoc;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimMgt@1100525000 : Codeunit 408;
      DimValRec@1100525001 : Record 349;
    BEGIN
      //db, 19-08-09: M15896
      IF ShortcutDimCode = '' THEN EXIT;
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.GetDimValueRec(FieldNumber, ShortcutDimCode, DimValRec, TRUE,'');
      IF NOT DimMgt.CheckDimValue(DimValRec."Dimension Code",ShortcutDimCode) THEN
        ERROR(DimMgt.GetDimErr);
    END;

    PROCEDURE EstimatorName@3() : Text[100];
    VAR
      EmplRec@11012000 : Record 5200;
      EstNameTxt@11012001 : Text[100];
    BEGIN
      IF EmplRec.GET(Estimator) THEN
        EstNameTxt := EmplRec.FullName
      ELSE
        EstNameTxt := '';
      EXIT(EstNameTxt);
    END;

    PROCEDURE UpdateLogbook@1000000000(lvServLocNo@1000000000 : Code[20]);
    VAR
      lvServLocRec@1000000001 : Record 11012801;
    BEGIN
      lvServLocRec.GET(lvServLocNo);
      lvServLocRec.TESTFIELD(Blocked, FALSE);
      lvServLocRec."Last Date Modified" := TODAY;
      lvServLocRec."Last Time Modified" := TIME;
      lvServLocRec."Modified by" := USERID;
      lvServLocRec.MODIFY;
    END;

    PROCEDURE ShowContact@1210190000(lvCust@1210190001 : Code[20]);
    VAR
      CustRec@1210190000 : Record 18;
      ContRec@1210190006 : Record 5050;
      OldRec@1100530000 : Record 11012801;
      Txt1@1100530001 : Text[250];
      Txt2@1100530002 : Text[250];
    BEGIN
      OldRec := Rec;

      CustRec.ShowContactName(lvCust, ContRec);

      IF ContRec.Name <> '' THEN BEGIN
        VALIDATE("Contact Person No.", ContRec."No.");  //db, 25-05-11
        "Contact Name" := ContRec.Name;
        "Phone No." := ContRec."Phone No. Work";
        "Phone No. 2" := ContRec."Phone No. Work 2";
        IF "Phone No." = '' THEN
          "Phone No." := ContRec."Phone No.";
        IF "Phone No. 2" = '' THEN
          "Phone No. 2" := ContRec."Phone No. 2";
        "Mobile Phone No." := ContRec."Mobile Phone No.";
        "Fax No." := ContRec."Fax No.";
        "E-Mail" := ContRec."E-Mail";

        //M24165 sn
        IF ("No." <> '') THEN BEGIN
          IF ((OldRec."Contact Name" + OldRec."Phone No." + OldRec."Phone No. 2"  +
               OldRec."E-Mail" + OldRec."Mobile Phone No." ) <>
              ("Contact Name" + "Phone No." + "Phone No. 2"  +
               "E-Mail" + "Mobile Phone No." )) AND
             ((OldRec."Contact Name" + OldRec."Phone No." + OldRec."Phone No. 2" +
               OldRec."E-Mail" + OldRec."Mobile Phone No.") <> '') THEN
          BEGIN
            Txt1 := STRSUBSTNO('%1: \%2: \%3 \%4 \%5 \%6 \%7 \\',
              Text999a, Text999b,
              OldRec."Contact Name", OldRec."Phone No.", OldRec."Phone No. 2",
              OldRec."E-Mail", OldRec."Mobile Phone No.");
            Txt2 := STRSUBSTNO('%1: \%2 \%3 \%4 \%5 \%6 \\',
              Text999c,
              "Contact Name", "Phone No.", "Phone No. 2",
              "E-Mail", "Mobile Phone No.");

            IF CONFIRM(Txt1 + Txt2, TRUE) = FALSE THEN BEGIN
              "Phone No." := OldRec."Phone No.";
              "Phone No. 2" := OldRec."Phone No. 2";
              "Mobile Phone No." := OldRec."Mobile Phone No.";
              "Fax No." := OldRec."Fax No.";
              "E-Mail" := OldRec."E-Mail";
            END ELSE BEGIN
              OldRec."Phone No." := "Phone No.";
              OldRec."Phone No. 2" := "Phone No. 2";
              OldRec."Mobile Phone No." := "Mobile Phone No.";
              OldRec."Fax No." := "Fax No.";
              OldRec."E-Mail" := "E-Mail";
            END;
          END;
        END;
        //M24165 en
      END;
    END;

    PROCEDURE ShowBillToContact@1100529602(BillToCustomerNo@1210190001 : Code[20]);
    VAR
      LocCustomer@1210190000 : Record 18;
      LocContact@1210190006 : Record 5050;
    BEGIN
      LocCustomer.ShowContactName(BillToCustomerNo, LocContact);

      IF LocContact.Name <> '' THEN BEGIN
        VALIDATE("Bill-to Contact Person", LocContact."No.");
        "Bill-to Contact Name" := LocContact.Name;
      END;
    END;

    PROCEDURE ValidateAddressData@1210190001(lvAction@1210190002 : Integer);
    VAR
      Contact@1100525000 : Record 5050;
    BEGIN
      IF lvAction = 1 THEN BEGIN
        IF "Customer No." <> xRec."Customer No." THEN BEGIN
          IF AdrsRec.GET("Customer No.","Address Code") THEN BEGIN
            Name := AdrsRec.Name;
            Address := AdrsRec.Address;
            "Address 2" := AdrsRec."Address 2";
            City := AdrsRec.City;
            "Contact Name":= AdrsRec.Contact;
            County := AdrsRec.County;
            "Country/Region Code":= AdrsRec."Country/Region Code";
            "Post Code" := AdrsRec."Post Code";
            "Phone No." := AdrsRec."Phone No.";
            "Mobile Phone No." := AdrsRec."Mobile Phone No.";
            "Fax No." := AdrsRec."Fax No.";
            "E-Mail" := AdrsRec."E-Mail";
            IF NOT CustRec.GET("Customer No.") THEN CustRec.INIT;
            "Territory Code" := CustRec."Territory Code";
            EvaluatePostCodeGroup;  //db, 11-02-13: C005566
            //db.sn, 28-09-10
            "Travel Cost" := AdrsRec."Travel Cost";
            //db.en, 28-09-10
          END ELSE BEGIN
            "Address Code" := '';
            IF Contact.GetContactByCustomer("Customer No.", Contact, FALSE) AND (Contact."Visit Address" <> '')
            THEN BEGIN
              Name := Contact.Name;
              Address := Contact."Visit Address";;
              "Address 2" := Contact."Visit Address 2";
              City := Contact."Visit Address City";
              "Contact Name" := '';
              County := Contact."Visit Address County";
              "Country/Region Code" := Contact."Visit Address Country/Region";
              "Post Code" := Contact."Visit Address Post Code";
              "Phone No." := Contact."Phone No.";
              "Phone No. 2" := Contact."Phone No. 2";
              "Mobile Phone No." := Contact."Mobile Phone No.";
              "Fax No." := Contact."Fax No.";
              "E-Mail" := Contact."E-Mail";
              "Territory Code" := Contact."Territory Code";
              EvaluatePostCodeGroup;
            END ELSE BEGIN
              IF CustRec.GET("Customer No.") THEN BEGIN
                Name := CustRec.Name;
                Address := CustRec.Address;
                "Address 2" := CustRec."Address 2";
                City := CustRec.City;
                "Contact Name" := CustRec.Contact;
                County := CustRec.County;
                "Country/Region Code":= CustRec."Country/Region Code";
                "Post Code" := CustRec."Post Code";
                "Phone No." := CustRec."Phone No.";
                "Phone No. 2" := CustRec."Phone No. 2";
                "Mobile Phone No." := CustRec."Mobile Phone No.";
                "Fax No." := CustRec."Fax No.";
                "E-Mail" := CustRec."E-Mail";
                "Territory Code" := CustRec."Territory Code";
                EvaluatePostCodeGroup;  //db, 11-02-13: C005566
              END;
            END;
          END;
        END;
      END;

      IF lvAction = 2 THEN BEGIN
        IF ("Address Code" <> '') AND
           (("Address Code" <> xRec."Address Code") OR ("Customer No." <> xRec."Customer No."))
        THEN BEGIN
          AdrsRec.GET("Customer No.","Address Code");
          Name := AdrsRec.Name;
          Address := AdrsRec.Address;
          "Address 2" := AdrsRec."Address 2";
          City := AdrsRec.City;
          "Contact Name":= AdrsRec.Contact;
          County := AdrsRec.County;
          "Country/Region Code":= AdrsRec."Country/Region Code";
          "Post Code" := AdrsRec."Post Code";
          "Phone No." := AdrsRec."Phone No.";
          "Mobile Phone No." := AdrsRec."Mobile Phone No.";
          "Fax No." := AdrsRec."Fax No.";
          "E-Mail" := AdrsRec."E-Mail";
          IF NOT CustRec.GET("Customer No.") THEN CustRec.INIT;
          "Territory Code" := CustRec."Territory Code";
          EvaluatePostCodeGroup;  //db, 11-02-13: C005566
          //DP00195 sn.
          "Travel Cost Code" := AdrsRec."Travel Cost Code";
          //DP00195 en.
        END ELSE BEGIN
          IF Contact.GetContactByCustomer("Customer No.", Contact, FALSE) AND (Contact."Visit Address" <> '')
          THEN BEGIN
            Name := Contact.Name;
            Address := Contact."Visit Address";;
            "Address 2" := Contact."Visit Address 2";
            City := Contact."Visit Address City";
            "Contact Name" := '';
            County := Contact."Visit Address County";
            "Country/Region Code" := Contact."Visit Address Country/Region";
            "Post Code" := Contact."Visit Address Post Code";
            "Phone No." := Contact."Phone No.";
            "Phone No. 2" := Contact."Phone No. 2";
            "Mobile Phone No." := Contact."Mobile Phone No.";
            "Fax No." := Contact."Fax No.";
            "E-Mail" := Contact."E-Mail";
            "Territory Code" := Contact."Territory Code";
            EvaluatePostCodeGroup;
          END ELSE BEGIN
            IF CustRec.GET("Customer No.") THEN BEGIN
              Name := CustRec.Name;
              Address := CustRec.Address;
              "Address 2" := CustRec."Address 2";
              City := CustRec.City;
              "Contact Name" := CustRec.Contact;
              County := CustRec.County;
              "Country/Region Code":= CustRec."Country/Region Code";
              "Post Code" := CustRec."Post Code";
              "Phone No." := CustRec."Phone No.";
              "Phone No. 2" := CustRec."Phone No. 2";
              "Mobile Phone No." := CustRec."Mobile Phone No.";
              "Fax No." := CustRec."Fax No.";
              "E-Mail" := CustRec."E-Mail";
              "Territory Code" := CustRec."Territory Code";
              EvaluatePostCodeGroup;  //db, 11-02-13: C005566
            END;
          END;
        END;
      END;

      IF (CurrFieldNo <> 0) AND ("No." <> '') THEN BEGIN
        IF ((xRec.Name + xRec.Address + xRec.City) <> (Name + Address + City)) AND
           ((xRec.Name + xRec.Address + xRec.City) <> '') THEN BEGIN
          IF CONFIRM(Text020, TRUE,
            xRec.Name, xRec.Address, (xRec."Post Code" + '  ' + xRec.City), xRec."Contact Name", xRec."Phone No.",
            Name, Address, ("Post Code" + '  ' + City), "Contact Name", "Phone No.") = FALSE THEN
          BEGIN
            IF CONFIRM(Text021) = FALSE THEN ERROR('');
            Name := xRec.Name;
            Address := xRec.Address;
            "Address 2" := xRec."Address 2";
            City := xRec.City;
            County := xRec.County;
            "Country/Region Code":= xRec."Country/Region Code";
            "Post Code" := xRec."Post Code";
            "Contact Name" := xRec."Contact Name";
            "Phone No." := xRec."Phone No.";
            "Phone No. 2" := xRec."Phone No. 2";
            "Mobile Phone No." := xRec."Mobile Phone No.";
            "Fax No." := xRec."Fax No.";
            "E-Mail" := xRec."E-Mail";
            "Territory Code" := xRec."Territory Code";  //db, 02-01-15: C020094
            EvaluatePostCodeGroup;
          END ELSE BEGIN
            xRec.Name := Name;
            xRec.Address := Address;
            xRec."Address 2" := "Address 2";
            xRec.City := City;
            xRec.County := County;
            xRec."Country/Region Code":= "Country/Region Code";
            xRec."Post Code" := "Post Code";
            xRec."Contact Name" := "Contact Name";
            xRec."Phone No." := "Phone No.";
            xRec."Phone No. 2" := "Phone No. 2";
            xRec."Mobile Phone No." := "Mobile Phone No.";
            xRec."Fax No." := "Fax No.";
            xRec."E-Mail" := "E-Mail";
            xRec."Territory Code" := "Territory Code";  //db, 02-01-15: C020094
            EvaluatePostCodeGroup;
          END;
        END;
      END;
    END;

    PROCEDURE CheckCompanyIC@32();
    VAR
      lvCompName@1210190000 : Text[50];
    BEGIN
      IF "Supplying Company" <> '' THEN
        lvCompName := "Supplying Company"
      ELSE IF "Warranty Company" <> '' THEN
        lvCompName := "Warranty Company"
      ELSE
        lvCompName := COMPANYNAME;

      ProjRec.CHANGECOMPANY(lvCompName);
      PlotRec.CHANGECOMPANY(lvCompName);
      ProjectElement.CHANGECOMPANY(lvCompName);
    END;

    PROCEDURE RefersToOtherCompany@1100525000() : Boolean;
    BEGIN
      EXIT((("Supplying Company" <> '') AND ("Supplying Company" <> COMPANYNAME)) OR
          (("Warranty Company" <> '') AND ("Warranty Company" <> COMPANYNAME)));
    END;

    PROCEDURE GetProjectDesc@1210190002() : Text[100];
    BEGIN
      CheckCompanyIC;

      IF NOT ProjRec.GET("Project No.") THEN ProjRec.INIT;
      EXIT(ProjRec.Description);
    END;

    PROCEDURE GetProjectDesc2@1210190003(lvServLoc@1210190000 : Code[20]) : Text[100];
    BEGIN
      IF NOT GET(lvServLoc) THEN INIT;
      EXIT( GetProjectDesc );
    END;

    PROCEDURE CheckMainSubLocationStructure@1100485000(iCodServiceLocationNo@1100485000 : Code[20];iCodNewServiceLocationNo@1100485002 : Code[20]);
    VAR
      lRecServiceLocation@1100485001 : Record 11012801;
    BEGIN
      lRecServiceLocation.SETRANGE("Parent No.", iCodServiceLocationNo);
      IF lRecServiceLocation.FINDSET THEN
        REPEAT
          IF lRecServiceLocation."No." = iCodNewServiceLocationNo THEN
            ERROR(Text005, lRecServiceLocation."No.", iCodServiceLocationNo);
          CheckMainSubLocationStructure(lRecServiceLocation."No.", iCodNewServiceLocationNo);
        UNTIL lRecServiceLocation.NEXT = 0;
    END;

    PROCEDURE CreateProject@1100485001(gvServLocRec@1100485004 : Record 11012801;gvProjRec@1100485003 : Record 11072003);
    VAR
      lvProjRec@1100485000 : Record 11072003;
      lvProjCustRec@1100485001 : Record 11012005;
    BEGIN
      WITH gvServLocRec DO BEGIN
        lvProjRec.INIT;
        lvProjRec."No." := gvProjRec."No.";
        lvProjRec."No. Series" := gvProjRec."No. Series";
        lvProjRec.VALIDATE(Description, gvProjRec.Description);
        lvProjRec.INSERT(TRUE);

        lvProjRec."Project Type" := lvProjRec.DetProjectTypeSeriesSimple(COMPANYNAME);  //db, 22-09-09: M16533

        IF "Customer No." <> '' THEN BEGIN
          lvProjCustRec.INIT;
          lvProjCustRec."Project No." := lvProjRec."No.";
          lvProjCustRec.VALIDATE(Principal, "Customer No.");
          lvProjCustRec.INSERT(TRUE);
          lvProjRec.VALIDATE("Bill-to Customer No.", "Customer No.");
        END;

        lvProjRec."Project Address Code" := "Address Code";
        lvProjRec."Created from Service Loc. No." := "No.";

        lvProjRec.Address := Address;
        lvProjRec."Address 2" := "Address 2";
        lvProjRec.City := City;
        lvProjRec."Post Code" := "Post Code";
        lvProjRec.County := County;
        lvProjRec."Country/Region Code":= "Country/Region Code";
        lvProjRec."Territory Code":= "Territory Code";

        lvProjRec.Contact := "Contact Name";
        lvProjRec."Phone No." := "Phone No.";
      //lvProjRec."Phone No. 2" := "Phone No. 2";
        lvProjRec."Mobile Phone No." := "Mobile Phone No.";
        lvProjRec."Fax No." := "Fax No.";
      //lvProjRec."E-Mail" := "E-Mail";

        IF "Global Dimension 1 Code" <> '' THEN
          lvProjRec.VALIDATE("Global Dimension 1 Code", "Global Dimension 1 Code");

        lvProjRec."Starting Date" := "Starting Date";
        lvProjRec."Ending Date" := "Ending Date";
        lvProjRec.MODIFY;

        MESSAGE(Text006, lvProjRec.TABLECAPTION, lvProjRec."No.");
      END;
    END;

    PROCEDURE CreateServContract@1100485008(gvServLocRec@1100485004 : Record 11012801;gvServContrRec@1100485005 : Record 11012812);
    VAR
      lvContrRec@1100485000 : Record 11012812;
    BEGIN
      WITH gvServLocRec DO BEGIN
        lvContrRec.INIT;
        lvContrRec."No." := gvServContrRec."No.";
        lvContrRec."No. Series" := gvServContrRec."No. Series";
        lvContrRec.VALIDATE(Description, gvServContrRec.Description);
        lvContrRec.INSERT(TRUE);

        lvContrRec."Service Type" := lvContrRec.DetServiceTypeSeriesSimple;  //db, 22-09-09: M16533

        lvContrRec.VALIDATE("Customer No.", "Customer No.");
        lvContrRec."Contact Name" := "Contact Name";
        lvContrRec."Phone No." := "Phone No.";
        lvContrRec."Phone No. 2" := "Phone No. 2";
        lvContrRec."Mobile Phone No." := "Mobile Phone No.";
        lvContrRec."Fax No." := "Fax No.";
        lvContrRec."E-Mail" := "E-Mail";
        IF "Global Dimension 1 Code" <> '' THEN
          lvContrRec.VALIDATE("Global Dimension 1 Code", "Global Dimension 1 Code");
        lvContrRec.MODIFY;

        MESSAGE(Text006, lvContrRec.TABLECAPTION, lvContrRec."No.");
      END;
    END;

    PROCEDURE GenerateServLocations@1100485002();
    VAR
      ImexRec@1210190007 : Record 11012056;
      PlotRec@1210190006 : Record 11012500;
      ProjRec@1210190005 : Record 11072003;
      CompRec@1210190004 : Record 2000000006;
      ServLocRec@1210190003 : Record 11012801;
      lvJobListFrm@1210190011 : Page 11072004;
      lvPlotListFrm@1210190008 : Page 11012506;
      lvProj@1210190002 : Code[20];
      lvPlot@1210190001 : Code[20];
      lvCompName@1210190000 : Text[50];
      sep_pos@1210190009 : Integer;
      Selection@1210190010 : Integer;
      AskQues@1210190012 : Integer;
      lvText001@1100485001 : TextConst 'ENU=Job,Plot;NOR=Jobb,Tegning;SVE=Jobb,Ritning';
      lvText002@1100485000 : TextConst 'ENU=Skip,Update;NOR=Hopp over,Oppdater;SVE=Hoppa över,Uppdatera';
      LocationAdded@1100485002 : Boolean;
      RecRef@1100525000 : RecordRef;
    BEGIN
      Selection := STRMENU(lvText001, 2);  //1=Project; 2=Plot
      IF Selection = 0 THEN EXIT;

      ImexRec.SETRANGE("User ID", USERID);
      ImexRec.SETFILTER("Process ID", 'GENSERVLOC*');
      ImexRec.SETRANGE(Type, ImexRec.Type::Export);
      ImexRec.DELETEALL;
      COMMIT;

      lvCompName := COMPANYNAME;
      IF PAGE.RUNMODAL(PAGE::Companies, CompRec) = ACTION::LookupOK THEN
        lvCompName := CompRec.Name;

      IF Selection = 1 THEN BEGIN
        ProjRec.CHANGECOMPANY(lvCompName);
        lvJobListFrm.InitSelectionCopyServLoc(lvCompName);
        lvJobListFrm.RUNMODAL;
      END;

      IF Selection = 2 THEN BEGIN
        PlotRec.CHANGECOMPANY(lvCompName);
        lvPlotListFrm.InitSelectionCopyServLoc(lvCompName);
        lvPlotListFrm.RUNMODAL;
      END;

      ImexRec.SETRANGE("User ID", USERID);
      ImexRec.SETFILTER("Process ID", 'GENSERVLOC*');
      ImexRec.SETRANGE(Type, ImexRec.Type::Export);
      IF ImexRec.FINDSET THEN BEGIN
        REPEAT
          IF ImexRec.Description = 'Job' THEN BEGIN
            lvProj := ImexRec.Condition;
            ProjRec.GET(lvProj);

            ServLocRec.RESET;
            ServLocRec.SETRANGE("Project No." , lvProj);
            ServLocRec.SETFILTER("Plot No.", '%1', '');
            IF NOT ServLocRec.FINDFIRST THEN BEGIN
              ServLocRec.RESET;
              ServLocRec.INIT;
              ServLocRec."No." := '';
              IF lvCompName <> COMPANYNAME THEN
                ServLocRec."Supplying Company" := lvCompName;
              ServLocRec."Project No." := lvProj;
              ServLocRec.INSERT(TRUE);
            END ELSE BEGIN
              IF AskQues = 0 THEN
                AskQues := STRMENU(lvText002, 1);  //1=skip; 2=update
            END;
            IF AskQues <> 1 THEN BEGIN
              ServLocRec.VALIDATE(Description, COPYSTR(ProjRec.Description,1,MAXSTRLEN(ServLocRec.Description)));
              ServLocRec.Address := ProjRec.Address;
              ServLocRec."Address 2" := ProjRec."Address 2";
              ServLocRec.City := ProjRec.City;
              ServLocRec."Post Code" := ProjRec."Post Code";
              ServLocRec.County := ProjRec.County;
              ServLocRec."Country/Region Code":= ProjRec."Country/Region Code";
              ServLocRec."Territory Code" := ProjRec."Territory Code";
              ServLocRec.Type := ProjRec.Type;
              ServLocRec.MODIFY;

              RecRef.GETTABLE(ProjRec);

              CreateDocumentLink(ServLocRec, RecRef, lvCompName);
            END;
          END;

          IF ImexRec.Description = 'Plot' THEN BEGIN
            sep_pos := STRPOS(ImexRec.Condition, '~');
            IF sep_pos <> 0 THEN BEGIN
              lvProj := COPYSTR(ImexRec.Condition, 1, sep_pos - 1);
              lvPlot := COPYSTR(ImexRec.Condition, sep_pos + 1, MAXSTRLEN(lvPlot));
              PlotRec.GET(lvProj, lvPlot);
              PlotRec.CALCFIELDS("Buyer Name", "Buyer Phone", "Buyer Phone 2",
                 "Buyer Mobile Phone", "Buyer E-Mail");

              ServLocRec.RESET;
              ServLocRec.SETRANGE("Project No." , lvProj);
              ServLocRec.SETRANGE("Plot No.", lvPlot);
              IF NOT ServLocRec.FINDFIRST THEN BEGIN
                ServLocRec.RESET;
                ServLocRec.INIT;
                ServLocRec."No." := '';
                IF lvCompName <> COMPANYNAME THEN
                  ServLocRec."Supplying Company" := lvCompName;
                ServLocRec."Project No." := lvProj;
                ServLocRec."Plot No." := lvPlot;
                ServLocRec.INSERT(TRUE);
                LocationAdded := TRUE;
              END ELSE BEGIN
                LocationAdded := FALSE;
                IF AskQues = 0 THEN
                  AskQues := STRMENU(lvText002, 1);  //1=skip; 2=update
              END;
              IF LocationAdded OR (AskQues <> 1) THEN BEGIN
                ServLocRec.VALIDATE(Description, PlotRec."Buyer Name");
                ServLocRec.Address := PlotRec.Address;
                ServLocRec.City := PlotRec.City;
                ServLocRec."Post Code" := PlotRec."Post Code";
                ServLocRec."Contact Name" := PlotRec.Buyer;
                ServLocRec."Phone No." := PlotRec."Buyer Phone";
                ServLocRec."Phone No. 2" := PlotRec."Buyer Phone 2";
                ServLocRec."Mobile Phone No." := PlotRec."Buyer Mobile Phone";
                ServLocRec."E-Mail" := PlotRec."Buyer E-Mail";
                ServLocRec.MODIFY;

                RecRef.GETTABLE(PlotRec);

                CreateDocumentLink(ServLocRec, RecRef, lvCompName);
              END;
            END;
          END;
        UNTIL ImexRec.NEXT = 0;
      END;
      ImexRec.DELETEALL;
    END;

    PROCEDURE LookupCheckWatch@1100485004(Lookup@1100485000 : Boolean);
    VAR
      WatchRec@1100485002 : Record 11012861;
      lvText000@1100485001 : TextConst 'ENU=%1 is not a valid %2.;NOR=%1 er ikke en gyldig %2.;SVE=%1 kan inte anv„ndas som %2.';
    BEGIN
      WatchRec.SETRANGE("Location Watch", TRUE);  //db, 16-05-11
      IF WatchRec.FINDSET(FALSE, FALSE) THEN
        REPEAT
          WatchRec.MARK := WatchRec.CheckFilters("Territory Code", "Global Dimension 1 Code", '', '');
        UNTIL WatchRec.NEXT = 0;

      WatchRec.MARKEDONLY := TRUE;
      IF Lookup THEN BEGIN
        IF WatchRec.GET(Watch) THEN;
        IF PAGE.RUNMODAL(0, WatchRec) = ACTION::LookupOK THEN BEGIN
          Watch := WatchRec.Code;
        END;
      END ELSE BEGIN
        WatchRec.SETFILTER(Code, Watch);  //db, 16-05-11
        IF WatchRec.FINDFIRST THEN BEGIN
          Watch := WatchRec.Code;
        END ELSE BEGIN
          ERROR(lvText000, Watch, FIELDCAPTION(Watch));
        END;
      END;
    END;

    PROCEDURE UpdateOrderAddressFromLocation@1100485005(lvServLoc@1100485002 : Code[20]);
    VAR
      ServLocRec@1100485000 : Record 11012801;
      lvText000@1100485003 : TextConst 'ENU="Do you want to update related Service Orders with Address Data ? ";NOR=Vil du oppdatere relaterte Serviceordre med Adressedata?;SVE="Vill du uppdatera relaterade serviceorder med adressdata? "';
      ServOrderRec@1100485001 : Record 11012823;
    BEGIN
      IF NOT CONFIRM(lvText000, FALSE) THEN EXIT;

      ServLocRec.SETRANGE("No.", lvServLoc);
      IF ServLocRec.FINDSET THEN BEGIN
        REPEAT
          ServOrderRec.SETCURRENTKEY("Service Location No.");
          ServOrderRec.SETRANGE("Service Location No.", ServLocRec."No.");
          ServOrderRec.SETFILTER(Status, '<%1', ServOrderRec.Status::"In Process");
          IF ServOrderRec.FINDSET(TRUE, FALSE) THEN BEGIN
            REPEAT
              ServOrderRec.ValidateAddressData(1);
              ServOrderRec.MODIFY;
            UNTIL ServOrderRec.NEXT = 0;
          END;
        UNTIL ServLocRec.NEXT = 0;
      END;
    END;

    PROCEDURE ExchangeFSA@1100485006(IMode@1100485003 : Code[1]);
    VAR
      lvFieldVisionExchangeMgtCU@1100485000 : Codeunit 11012091;
    BEGIN
      //**4PS.n
      IF IMode = 'I' THEN BEGIN
        "Export to FSA" := FALSE;
        "Date/Time Export to FSA" := 0DT;
      END;
      ProjSetupRec.GET;
      IF ProjSetupRec."Field Service Active" THEN BEGIN
        IF IMode <> 'D' THEN BEGIN
          IF IMode = 'I' THEN BEGIN  //* Call 14574.sn
            "Last Date Modified" := TODAY;
            "Last Time Modified" := TIME;
          END;                       //* Call 14574.en
          "Export to FSA" := TRUE;
          IF IMode = 'R' THEN
            lvFieldVisionExchangeMgtCU.StoreDeletedServLocation(xRec);
        END ELSE BEGIN
          lvFieldVisionExchangeMgtCU.StoreDeletedServLocation(Rec);
        END;
      END;
    END;

    LOCAL PROCEDURE ExchangeMOB@1100528703(Mode@1100528702 : Code[1]);
    VAR
      DeletedDataMgtMobile@1100528701 : Codeunit 11012440;
    BEGIN
      IF NOT IsFSAActive THEN
        EXIT;

      IF (Mode = 'D') THEN
        DeletedDataMgtMobile.StoreDeletedServiceLocation(Rec);

      IF (Mode = 'R') THEN
        DeletedDataMgtMobile.StoreDeletedServiceLocation(xRec);
    END;

    PROCEDURE CheckSeries@1100485007(lvSeries@1100485000 : Code[20]) : Boolean;
    VAR
      SerieRel@1210190000 : Record 310;
    BEGIN
      SerieRel.SETRANGE(Code, lvSeries);

      EXIT(SerieRel.FINDFIRST);
    END;

    LOCAL PROCEDURE CheckLocationDiscipline@1100485009(iServLoc@1100485001 : Code[20];iDisc@1100485002 : Code[20];iTradeSpec@1100485003 : Code[20]);
    VAR
      LocDiscRec@1100485000 : Record 11012844;
      DiscRec@1100525001 : Record 11020204;
      TradeSpecRec@1100525000 : Record 11020285;
    BEGIN
      //db, 20-02-13: C005107 (local function)
      WITH LocDiscRec DO BEGIN
        IF iDisc <> '' THEN BEGIN
          IF NOT GET(iServLoc, iDisc, '') THEN BEGIN
            INIT;
            "Service Location No." := iServLoc;
            Discipline := iDisc;
            IF DiscRec.GET(iDisc) THEN
              INSERT;
          END;
        END;
        IF iTradeSpec <> '' THEN BEGIN
          IF NOT GET(iServLoc, iDisc, iTradeSpec) THEN BEGIN
            INIT;
            "Service Location No." := iServLoc;
            Discipline := iDisc;
            "Trade Speciality" := iTradeSpec;
            IF TradeSpecRec.GET(iDisc, iTradeSpec) THEN
              INSERT;
          END;
        END;
      END;
    END;

    PROCEDURE IsFSAActive@1100525001() : Boolean;
    VAR
      JobsSetup@1100527000 : Record 315;
    BEGIN
      EXIT(JobsSetup.IsFSAActive);
    END;

    LOCAL PROCEDURE TestIsFSAActive@1100527000();
    VAR
      JobsSetup@1100527000 : Record 315;
    BEGIN
      JobsSetup.TestIsFSAActive;
    END;

    PROCEDURE CheckVATReverse@1100525002(lvFieldValidate@1100485002 : Boolean;lvFieldEntry@1100525000 : Boolean) : Boolean;
    VAR
      VATPostingSetup@1100485000 : Record 325;
      CustRec@1100485001 : Record 18;
    BEGIN
      IF NOT CustRec.GET("Customer No.") THEN
        CustRec.INIT;
      IF NOT VATPostingSetup.GET(CustRec."VAT Bus. Posting Group","VAT Prod. Posting Group") THEN
        VATPostingSetup.INIT;
      IF VATPostingSetup."VAT Calculation Type" = VATPostingSetup."VAT Calculation Type"::"Reverse Charge VAT" THEN BEGIN
        IF lvFieldEntry = TRUE THEN EXIT(TRUE);
        //default based on contract or customer not yet implemented
      END ELSE BEGIN
        IF lvFieldEntry = TRUE THEN EXIT(FALSE);
        IF lvFieldValidate = TRUE THEN BEGIN
          TESTFIELD("Percentage Labor", 0);
          TESTFIELD("Percentage to B Account", 0);
        END ELSE BEGIN
          "Percentage Labor" := 0;
          "Percentage to B Account" := 0;
        END;
      END;
    END;

    PROCEDURE DisplayMap@1100525004();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FIND('-') THEN
        MapMgt.MakeSelection(DATABASE::"Service Location",GETPOSITION)
      ELSE
        MESSAGE(Text007);
    END;

    PROCEDURE DPA_SetDefaultDpmtFromNoSeries@1100000995(xRecRef@1100525002 : RecordRef);
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      xRecRef.SETTABLE(xRec);
      DPA_Management.SetDepartmentCodeNoSeries(
        TABLENAME,
        "Global Dimension 1 Code",
        "No. Series",
        xRec."No. Series" );
    END;

    LOCAL PROCEDURE DPA_OnInsert@1100000991();
    VAR
      Dimension1Code@1100528400 : Code[20];
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      Dimension1Code :=
        DPA_Management.GetNoSeriesDepartmentCode(
          "No. Series",
          xRec."No. Series",
          DATABASE::"Service Location");
      IF Dimension1Code <> '' THEN
        "Global Dimension 1 Code" := Dimension1Code;

      IF "Global Dimension 1 Code" <> '' THEN
        VALIDATE("Global Dimension 1 Code");
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(11012801) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 11012801');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Service Location", "Global Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Global Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Global Dimension 1 Code");
    END;

    PROCEDURE DPA_SetFiltersForResource@1100528704(Context@1100525000 : Text[30];ResourceNo@1100525001 : Code[20]) : Boolean;
    VAR
      Resource@1100525002 : Record 11229278;
      UserSetup@1100525003 : Record 91;
    BEGIN
      Resource.SETRANGE("No.", ResourceNo);
      Resource.SETRANGE(Type, Resource.Type::Employee);
      Resource.SETRANGE(Company, COMPANYNAME);
      IF Resource.FINDFIRST THEN BEGIN
        UserSetup.SETRANGE("Employee No.", Resource."Source No.");
        IF UserSetup.FINDFIRST THEN
          DPA_Management.SetUserWSEmployee(UserSetup."User ID");
      END;

      EXIT(DPA_SetFilters(Context));
    END;

    PROCEDURE CreateDocumentLink@1100525005(ServiceLocation@1100525007 : Record 11012801;RecRef@1100525006 : RecordRef;CompName@1100525008 : Text[50]);
    VAR
      DocumentProperties@1100525005 : Record 11012746;
      DocumentLink@1100525004 : Record 11012747;
      DocumentLinkMgt@1100525002 : Codeunit 11012401;
      DocLinkRID@1100525000 : ARRAY [5] OF RecordID;
    BEGIN
      DocumentLink.RESET;
      DocumentLink.SETCURRENTKEY("Record ID"); //mg, 05-07-11: M27801
      DocumentLink.SETRANGE("Table No.", RecRef.NUMBER);
      DocumentLink.SETFILTER("Record ID", STRSUBSTNO('''%1''', RecRef.RECORDID()));
      DocumentLink.SETRANGE("Internal Company", CompName);
      IF DocumentLink.FINDSET THEN BEGIN
        REPEAT
          DocumentProperties.SETRANGE("No.", DocumentLink."Document No.");
          IF DocumentProperties.FINDFIRST THEN BEGIN
            RecRef.GETTABLE(ServiceLocation);
            DocLinkRID[2] := RecRef.RECORDID();

            DocumentLinkMgt.CreateDocumentLink(DocumentProperties, DocLinkRID);
            DocumentProperties.MODIFY(TRUE);
          END;
        UNTIL DocumentLink.NEXT = 0;
      END;
    END;

    PROCEDURE TravelTimeUnit@1100525007() : Code[10];
    VAR
      ServSetup@1100525000 : Record 11012800;
      DimValRec@1100525002 : Record 349;
      DimMgt@1100525001 : Codeunit 408;
    BEGIN
      ServSetup.GET;
      DimMgt.GetDimValueRec(2,ServSetup."Cost Object Travel Time",DimValRec,FALSE,'');
      EXIT(DimValRec."Unit of Measure");
    END;

    PROCEDURE TravelDistanceUnit@1100525006() : Code[10];
    VAR
      ServSetup@1100525000 : Record 11012800;
      DimValRec@1100525002 : Record 349;
      DimMgt@1100525001 : Codeunit 408;
    BEGIN
      ServSetup.GET;
      DimMgt.GetDimValueRec(2,ServSetup."Cost Object Travel Distance",DimValRec,FALSE,'');
      EXIT(DimValRec."Unit of Measure");
    END;

    PROCEDURE GetTryOut@1210190005(iAction@1210190000 : Integer) Result : Text[30];
    VAR
      TryOutRelationRec@1210190001 : Record 11012761;
    BEGIN
      //db, 05-05-11
      IF FPSLicenseManagement.LicenseAndReadPermissionForTable(TryOutRelationRec) THEN
        Result := TryOutRelationRec.GetTryOut('', '', "No.", '', '', '', '', '', iAction);

      EXIT(Result);
    END;

    PROCEDURE ShowTryOut@1210190004(iAction@1210190000 : Integer);
    VAR
      TryOutRelationRec@1210190001 : Record 11012761;
    BEGIN
      //db, 05-05-11
      TryOutRelationRec.ShowTryOut('', '', "No.", '', '', '', '', '', iAction);
    END;

    PROCEDURE EvaluatePostCodeGroup@1100525008();
    BEGIN
      //db, 11-02-13: C005566
      IF PostCode.GET("Post Code",City) THEN
        "Post Code Group" := PostCode.Group;
      DetermineTravelCostCode;
      DetermineTravelDistance;
      DetermineTravelTime;
      PostCode.GetTerritoryByPostCodeGroup(City,"Post Code","Territory Code");
      PostCode.GetDepartmentCodeByPostCodeGroup(City, "Post Code", "Global Dimension 1 Code");
      VALIDATE("Global Dimension 1 Code");
    END;

    PROCEDURE NormalizePostCodeHouseNo@1100526200();
    VAR
      ObjectImpWorkSheetMgt@1100526200 : Codeunit 11012839;
      PostCode@1100526201 : Code[20];
    BEGIN
      IF ObjectImpWorkSheetMgt.NormalizePostCode("Post Code", "Country/Region Code", PostCode) THEN
        "Post Code" := PostCode;
      "House No." := ObjectImpWorkSheetMgt.DetermineHouseNo(Address, "House No. Ext.");
    END;

    PROCEDURE GetTravelCostWithIndexDate@1100528600(IIndexDate@1100528601 : Date) : Decimal;
    VAR
      TravelCostRate@1100528600 : Record 11071802;
    BEGIN
      IF "Travel Cost Code" <> '' THEN BEGIN
        TravelCostRate.SETRANGE("Travel Cost Code", "Travel Cost Code");
        TravelCostRate.SETFILTER("Index Date", '<=%1', IIndexDate);
        IF TravelCostRate.FINDLAST THEN
          EXIT(TravelCostRate.Rate);
      END;
    END;

    PROCEDURE GetTravelCost@1100528601() : Decimal;
    BEGIN
      EXIT(GetTravelCostWithIndexDate(TODAY));
    END;

    PROCEDURE EditDocuments@1100528702(ContactNo@1210190003 : Code[20];ContactPersonNo@1210190004 : Code[20];SendMail@1210190002 : Boolean;Recipient@1100528700 : Text[120]);
    VAR
      DocumentTemplate@1210190001 : Record 11012401;
      DocumentMailing@1210190000 : Codeunit 11012278;
      RecRef@1100525000 : RecordRef;
      DocumentLinkRIDs@1100525001 : ARRAY [5] OF RecordID;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentLinkRIDs[1] := RecRef.RECORDID;

      DocumentMailing.EditDocuments(
        STRSUBSTNO('%1', DocumentTemplate.Type::"Service Location"), DocumentLinkRIDs,
        "Global Dimension 1 Code", ContactNo, ContactPersonNo, SendMail, Recipient);
    END;

    PROCEDURE GetRelatedObjects@1100528300(VAR OServiceObject@1100528300 : Record 11071691);
    VAR
      BuildingObjectRelation@1100528302 : Record 11071820;
    BEGIN
      OServiceObject.RESET;
      OServiceObject.SETCURRENTKEY("Service Location No.");
      OServiceObject.SETRANGE("Service Location No.", "No.");
      OServiceObject.SETRANGE(Blocked, FALSE);
      IF "Building Code" <> '' THEN BEGIN
        IF OServiceObject.FINDSET THEN
          REPEAT
            OServiceObject.MARK(TRUE);
          UNTIL OServiceObject.NEXT = 0;
        OServiceObject.SETCURRENTKEY("No.");
        OServiceObject.SETRANGE("Service Location No.");
        BuildingObjectRelation.SETRANGE("Building Code", "Building Code");
        IF BuildingObjectRelation.FINDSET THEN
          REPEAT
            OServiceObject."No." := BuildingObjectRelation."Object No.";
            OServiceObject.MARK(TRUE);
          UNTIL BuildingObjectRelation.NEXT = 0;
        OServiceObject.MARKEDONLY(TRUE);
      END;
    END;

    PROCEDURE ShowRelatedObjects@1100528301();
    VAR
      ServiceObject@1100528300 : Record 11071691;
    BEGIN
      GetRelatedObjects(ServiceObject);
      PAGE.RUNMODAL(0, ServiceObject);
    END;

    PROCEDURE ShowTodos@1100528700();
    VAR
      Todo@1100528700 : Record 5080;
    BEGIN
      Todo.SETRANGE("Service Location No.", "No.");
      Todo.SETRANGE("System To-do Type", Todo."System To-do Type"::Organizer);
      PAGE.RUNMODAL(PAGE::"Task List", Todo);
    END;

    PROCEDURE CreateLocationObjects@1210190007(VAR ITmpContractConsObjWizardLine@1210190000 : TEMPORARY Record 11071698);
    VAR
      ServiceObject@1210190001 : Record 11071691;
      ServiceSetup@1210190002 : Record 11012800;
      ObjectSpecificationMgt@1210190003 : Codeunit 11012848;
    BEGIN
      ITmpContractConsObjWizardLine.SETFILTER("Standard Object No.", '<>%1', '');
      IF NOT ITmpContractConsObjWizardLine.FINDSET THEN EXIT;
      REPEAT
        ServiceObject.INIT;
        ServiceObject."No." := '';
        ServiceObject.INSERT(TRUE);
        ServiceObject.VALIDATE("Standard Object No.", ITmpContractConsObjWizardLine."Standard Object No.");
        ServiceObject.VALIDATE(Description, ITmpContractConsObjWizardLine.Description);
        ServiceObject.VALIDATE("Description 2", ITmpContractConsObjWizardLine."Description 2");
        ServiceObject.VALIDATE("Service Location No.", "No.");
        ServiceObject.VALIDATE("In use since", ITmpContractConsObjWizardLine."In use since");
        ServiceObject.VALIDATE(Building, ITmpContractConsObjWizardLine.Building);
        ServiceObject.VALIDATE(Floor, ITmpContractConsObjWizardLine.Floor);
        ServiceObject.VALIDATE(Room, ITmpContractConsObjWizardLine.Room);
        ServiceObject.VALIDATE(Text, ITmpContractConsObjWizardLine.Comment);
        ServiceObject.VALIDATE("Warranty Starting Date Cust.", ITmpContractConsObjWizardLine."Warranty Starting Date");
        ServiceObject.VALIDATE("Customer Feature", ITmpContractConsObjWizardLine."Customer Feature");
        ServiceObject.MODIFY(TRUE);

        ServiceSetup.GET;
        IF ITmpContractConsObjWizardLine."Year of Manufacture" <> 0 THEN BEGIN
          ServiceSetup.TESTFIELD("Spec. Code Year of Manufact.");
          ObjectSpecificationMgt.SetObjectSpecValue(ServiceObject."No.", ServiceSetup."Spec. Code Year of Manufact.",
            FORMAT(ITmpContractConsObjWizardLine."Year of Manufacture"));
        END;
        IF ITmpContractConsObjWizardLine."Serial No." <> '' THEN BEGIN
          ServiceSetup.TESTFIELD("Spec. Code Serial No.");
          ObjectSpecificationMgt.SetObjectSpecValue(ServiceObject."No.", ServiceSetup."Spec. Code Serial No.",
            ITmpContractConsObjWizardLine."Serial No.");
        END;
      UNTIL ITmpContractConsObjWizardLine.NEXT = 0;
      IF GUIALLOWED THEN
        MESSAGE(Text010, ITmpContractConsObjWizardLine.COUNT);
    END;

    LOCAL PROCEDURE TestMaintenanceTimes@1100528602();
    BEGIN
      IF ("Starting Time Maint. Window" = 0T) OR ("Ending Time Maint. Window" = 0T) THEN
        EXIT;
      IF "Ending Time Maint. Window" <= "Starting Time Maint. Window" THEN
        FIELDERROR("Ending Time Maint. Window", STRSUBSTNO(Text001, FIELDCAPTION("Starting Time Maint. Window")));
    END;

    PROCEDURE ShowCard@1100409000();
    BEGIN
      PAGE.RUN(PAGE::"Service Location", Rec);
    END;

    LOCAL PROCEDURE LinkedToRentalUnit@1100528701() : Boolean;
    VAR
      RentalUnit@1100528700 : Record 11012940;
    BEGIN
      IF FPSLicenseManagement.LicenseAndReadPermissionForTable(RentalUnit) THEN BEGIN
        RentalUnit.SETCURRENTKEY("Service Location No.");
        RentalUnit.SETRANGE("Service Location No.", "No.");
        EXIT(RentalUnit.FINDFIRST);
      END;
    END;

    LOCAL PROCEDURE TestLinkedToRentalUnit@1100528707(FieldCaption@1100528700 : Text[250]);
    VAR
      RentalUnit@1100528701 : Record 11012940;
    BEGIN
      IF CurrFieldNo <> 0 THEN
        IF LinkedToRentalUnit THEN
          ERROR(Text011, FieldCaption, TABLECAPTION, RentalUnit.TABLECAPTION);
    END;

    PROCEDURE LocationExists@1100409001(VAR OExistingLocationNo@1100409000 : Code[20]) : Boolean;
    VAR
      ServiceLocation@1100528603 : Record 11012801;
    BEGIN
      IF ("Post Code" = '') OR ("House No." = '') THEN
        EXIT;
      ServiceLocation.SETCURRENTKEY("Post Code", "House No.", "House No. Ext.");
      ServiceLocation.SETRANGE("Post Code", "Post Code");
      ServiceLocation.SETRANGE("House No.", "House No.");
      ServiceLocation.SETRANGE("House No. Ext.", "House No. Ext.");
      ServiceLocation.SETFILTER("No.", '<>%1', "No.");
      IF ServiceLocation.FINDFIRST THEN BEGIN
        OExistingLocationNo := ServiceLocation."No.";
        EXIT(TRUE);
      END;
    END;

    PROCEDURE GetComplexCode@1100528603() : Code[20];
    VAR
      Building@1100528600 : Record 11071819;
    BEGIN
      IF "Complex Code" <> '' THEN
        EXIT("Complex Code");
      IF "Building Code" <> '' THEN BEGIN
        IF Building.GET("Building Code") THEN
          EXIT(Building."Complex Code");
      END;
    END;

    PROCEDURE UpdatePrefLocations@1100525009();
    VAR
      GeneralLedgerSetup@1100525002 : Record 98;
      DimensionValueLocation@1100525000 : Record 11020352;
      PrefServLoc@1100525003 : Record 11020391;
    BEGIN
      //db, 23-02-15: C013902
      GeneralLedgerSetup.GET;
      DimensionValueLocation.SETRANGE("Dimension Code",GeneralLedgerSetup."Global Dimension 1 Code");
      DimensionValueLocation.SETRANGE("Dimension Value Code","Global Dimension 1 Code");
      IF DimensionValueLocation.ISEMPTY THEN
        EXIT;

      PrefServLoc.SETRANGE("Service Location No.","No.");
      IF NOT PrefServLoc.ISEMPTY THEN
        IF "Global Dimension 1 Code" = xRec."Global Dimension 1 Code" THEN
          EXIT
        ELSE
          IF NOT CONFIRM(Text11012040) THEN
            EXIT;
      PrefServLoc.DELETEALL;
      IF DimensionValueLocation.FINDSET THEN BEGIN
        REPEAT
          PrefServLoc."Service Location No." := "No.";
          PrefServLoc."Location Code" := DimensionValueLocation."Location Code";
          PrefServLoc.Priority := DimensionValueLocation.Priority;
          PrefServLoc.INSERT;
        UNTIL DimensionValueLocation.NEXT = 0;
      END;
    END;

    PROCEDURE DetermineTravelCostCode@1100528604();
    VAR
      PostCodeGroup@1100528600 : Record 11020599;
      Customer@1100528601 : Record 18;
    BEGIN
      IF Customer.GET("Customer No.") AND (Customer."Travel Cost Code (Service)" <> '') THEN
        VALIDATE("Travel Cost Code", Customer."Travel Cost Code (Service)")
      ELSE
        IF PostCodeGroup.GET("Post Code Group") THEN
          IF PostCodeGroup."Travel Cost Code (Service)" <> '' THEN  //db, 18-09-15: C022427
            VALIDATE("Travel Cost Code", PostCodeGroup."Travel Cost Code (Service)");
    END;

    LOCAL PROCEDURE DetermineTravelDistance@1100528400();
    VAR
      ShipToAddress@1100528400 : Record 222;
      PostCodeGroup@1100528401 : Record 11020599;
    BEGIN
      IF ShipToAddress.GET("Customer No.", "Address Code") AND
         (ShipToAddress."Travel Distance" <> 0)
      THEN
         VALIDATE("Travel Distance", ShipToAddress."Travel Distance")
      ELSE
        IF PostCodeGroup.GET("Post Code Group") THEN
          IF PostCodeGroup."Travel Distance (Service)" <> 0 THEN
            VALIDATE("Travel Distance", PostCodeGroup."Travel Distance (Service)");
    END;

    LOCAL PROCEDURE DetermineTravelTime@1100528401();
    VAR
      ShipToAddress@1100528401 : Record 222;
      PostCodeGroup@1100528400 : Record 11020599;
    BEGIN
      IF ShipToAddress.GET("Customer No.", "Address Code") AND
         (ShipToAddress."Travel Time" <> 0)
      THEN
         VALIDATE("Travel Time", ShipToAddress."Travel Time")
      ELSE
        IF PostCodeGroup.GET("Post Code Group") THEN
          IF PostCodeGroup."Travel Time (Service)" <> 0 THEN
            VALIDATE("Travel Time", PostCodeGroup."Travel Time (Service)");
    END;

    PROCEDURE AssistEditServLocFolder@1100528000();
    VAR
      FileMgt@1100525002 : Codeunit 419;
      ExplorerPath@1100525000 : Text[250];
      DocumentMgtSetup@1100525001 : Record 11071831;
      OperatingSystemMgt@1100528000 : Codeunit 11012364;
    BEGIN
      DocumentMgtSetup.GET;
      IF NOT DocumentMgtSetup."Use Citrix Client" THEN
        ExplorerPath := OperatingSystemMgt.ClientEnviron('SYSTEMROOT') + '\Explorer.exe'
      ELSE
        ExplorerPath := OperatingSystemMgt.ClientEnviron('SYSTEMROOT') + '\Pexplorer.exe';
      IF "Service Location Folder" = '' THEN
        FileMgt.SelectDirectoryNameWithBackSlash("Service Location Folder")
      ELSE BEGIN
        OperatingSystemMgt.ClientShell(
          STRSUBSTNO('"%1"', ExplorerPath),
          STRSUBSTNO('"%1"', "Service Location Folder"),
          FALSE, FALSE);
      END;
    END;

    PROCEDURE ValidateGPSCoordinate@1100529400(Value@1100529400 : Code[30]);
    BEGIN
      GPSCoordinatesMgt.ValidateGPSCoordinate(Value);
      UpdateServiceOrderLatitudeLongitude;
    END;

    PROCEDURE GPSCoordinateIsValid@1100528402(Value@1100529400 : Code[30]) : Boolean;
    VAR
      I@1100529401 : Integer;
    BEGIN
      EXIT(GPSCoordinatesMgt.GPSCoordinateIsValid(Value));
    END;

    LOCAL PROCEDURE TestUniqueTentantID@1100528605();
    VAR
      ServiceLocation@1100528600 : Record 11012801;
    BEGIN
      IF "Tenant No." = '' THEN
        EXIT;
      ServiceLocation.SETRANGE("Tenant No.", "Tenant No.");
      ServiceLocation.SETFILTER("No.", '<>%1', "No.");
      IF NOT ServiceLocation.ISEMPTY THEN
        ERROR(Text024, FIELDCAPTION("Tenant No."));
    END;

    LOCAL PROCEDURE DetermineProjectAddress@1100528618();
    VAR
      ShiptoAddress@1100528600 : Record 222;
    BEGIN
      IF ShiptoAddress.GetProjectAddress("Customer No.", ShiptoAddress.Code) THEN
        VALIDATE("Address Code", ShiptoAddress.Code);
    END;

    LOCAL PROCEDURE UpdateResponsibility@1100528306(LocationManOld@1100528301 : Code[20];LocationManNew@1100528302 : Code[20]);
    VAR
      ServiceSetup@1100528303 : Record 11012800;
      ServiceResponsiblePersonDPT@1100528304 : Record 11072297;
    BEGIN
      ServiceSetup.GET;
      IF (ServiceSetup."Responsibility Location Man" = '') THEN
        EXIT;
      IF (LocationManOld = LocationManNew) THEN
        EXIT;
      IF (LocationManNew = '') THEN
        EXIT;

      ServiceResponsiblePersonDPT.SETRANGE("Source Type", ServiceResponsiblePersonDPT."Source Type"::ServLocation);
      ServiceResponsiblePersonDPT.SETRANGE("Source Code", "No.");
      ServiceResponsiblePersonDPT.SETRANGE("Employee No.", LocationManNew);
      ServiceResponsiblePersonDPT.SETRANGE(Responsibility, ServiceSetup."Responsibility Location Man");
      IF (NOT ServiceResponsiblePersonDPT.FINDFIRST) THEN BEGIN
        ServiceResponsiblePersonDPT.INIT;
        ServiceResponsiblePersonDPT."Source Type" := ServiceResponsiblePersonDPT."Source Type"::ServLocation;
        ServiceResponsiblePersonDPT."Source Code" := "No.";
        ServiceResponsiblePersonDPT."Line No." := ServiceResponsiblePersonDPT.GetLastLineNo + 10000;
        ServiceResponsiblePersonDPT.Responsibility := ServiceSetup."Responsibility Location Man";
        ServiceResponsiblePersonDPT."Employee No." := LocationManNew;
        ServiceResponsiblePersonDPT.INSERT;
      END;
    END;

    PROCEDURE IsDocumentPortalServiceLocation@1100528305() : Boolean;
    VAR
      DPTSetup@1100528300 : Record 11229823;
    BEGIN
      IF (NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DPTSetup)) THEN
        EXIT(FALSE);
      IF (DPTSetup.ISEMPTY) THEN
        EXIT(FALSE);
      DPTSetup.GET;
      EXIT((DPTSetup."Use Location Portal") AND
           ("Document Portal Site Generated") AND
           ("Document Portal URL" <> ''));
    END;

    PROCEDURE UpdateServiceOrders@1100528637();
    VAR
      ServiceSetup@1100528601 : Record 11012800;
      ServiceOrder@1100529600 : Record 11012823;
      ConfirmTxt@1100529602 : Text;
    BEGIN
      IF ("No." = '') OR (CurrFieldNo = 0) OR (NOT GUIALLOWED) THEN
        EXIT;

      ServiceSetup.GET;
      IF NOT ServiceSetup."Sync. Location by Order/Call" THEN
        EXIT;

      ServiceOrder.SETRANGE(Status, ServiceOrder.Status::Open);
      ServiceOrder.SETRANGE("Service Location No.", "No.");
      IF ServiceOrder.ISEMPTY THEN
        EXIT;

      CASE CurrFieldNo OF
        FIELDNO(Description):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION(Description));
        FIELDNO("Contact Name"):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Contact Name"));
        FIELDNO(Address):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION(Address));
        FIELDNO("Address 2"):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Address 2"));
        FIELDNO(City):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION(City));
        FIELDNO("Post Code"):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Post Code"));
        FIELDNO("Country/Region Code"):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Country/Region Code"));
        FIELDNO("Phone No."):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Phone No."));
        FIELDNO("Phone No. 2"):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Phone No. 2"));
        FIELDNO("Mobile Phone No."):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Mobile Phone No."));
        FIELDNO("E-Mail"):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("E-Mail"));
        FIELDNO("Fax No."):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Fax No."));
        FIELDNO("Bill-to Contact Name"):
          ConfirmTxt := STRSUBSTNO(Text025, FIELDCAPTION("Bill-to Contact Name"));
        ELSE
          EXIT;
      END;
      IF NOT CONFIRM(ConfirmTxt) THEN
        EXIT;

      ServiceOrder.FINDSET(TRUE, FALSE);
      CASE CurrFieldNo OF
        FIELDNO(Description):
          ServiceOrder.MODIFYALL(Name, Description);
        FIELDNO("Contact Name"):
          ServiceOrder.MODIFYALL("Contact Name", "Contact Name");
        FIELDNO(Address):
          BEGIN
            ServiceOrder.MODIFYALL(Address, Address);
            IF "Address 2" <> xRec."Address 2" THEN
              ServiceOrder.MODIFYALL("Address 2", "Address 2");
            IF "Post Code" <> xRec."Post Code" THEN
              ServiceOrder.MODIFYALL("Post Code", "Post Code");
            IF City <> xRec.City THEN
              ServiceOrder.MODIFYALL(City, City);
            IF "Country/Region Code" <> xRec."Country/Region Code" THEN
              ServiceOrder.MODIFYALL("Country/Region Code", "Country/Region Code");
            IF "Phone No." <> xRec."Phone No." THEN
              ServiceOrder.MODIFYALL("Phone No.", "Phone No.");
            IF "Fax No." <> xRec."Fax No." THEN
              ServiceOrder.MODIFYALL("Fax No.", "Fax No.");
          END;
        FIELDNO("Address 2"):
          ServiceOrder.MODIFYALL("Address 2", "Address 2");
        FIELDNO(City):
          BEGIN
            ServiceOrder.MODIFYALL(City, City);
            IF "Post Code" <> xRec."Post Code" THEN
              ServiceOrder.MODIFYALL("Post Code", "Post Code");
            IF "Country/Region Code" <> xRec."Country/Region Code" THEN
              ServiceOrder.MODIFYALL("Country/Region Code", "Country/Region Code");
          END;
        FIELDNO("Post Code"):
          BEGIN
            ServiceOrder.MODIFYALL("Post Code", "Post Code");
            IF City <> xRec.City THEN
              ServiceOrder.MODIFYALL(City, City);
            IF "Country/Region Code" <> xRec."Country/Region Code" THEN
              ServiceOrder.MODIFYALL("Country/Region Code", "Country/Region Code");
          END;
        FIELDNO("Country/Region Code"):
          ServiceOrder.MODIFYALL("Country/Region Code", "Country/Region Code");
        FIELDNO("Phone No."):
          ServiceOrder.MODIFYALL("Phone No.", "Phone No.");
        FIELDNO("Phone No. 2"):
          ServiceOrder.MODIFYALL("Phone No. 2", "Phone No. 2");
        FIELDNO("Mobile Phone No."):
          ServiceOrder.MODIFYALL("Mobile Phone No.", "Mobile Phone No.");
        FIELDNO("E-Mail"):
          ServiceOrder.MODIFYALL("E-Mail", "E-Mail");
        FIELDNO("Fax No."):
          ServiceOrder.MODIFYALL("Fax No.", "Fax No.");
        FIELDNO("Bill-to Contact Name"):
          ServiceOrder.MODIFYALL("Bill-to Contact Name", "Bill-to Contact Name");
      END;
    END;

    PROCEDURE AddLatLng@1100525051() : Boolean;
    VAR
      BingMapsHandler@1100525000 : Codeunit 11012485;
      tmpLatitude@1100525002 : Text[255];
      tmpLongitude@1100525003 : Text[255];
      Success@1100525004 : Boolean;
      InstallationManagement@1100525005 : Codeunit 11012268;
    BEGIN
      IF NOT InstallationManagement.LicensePermissionForTableData(DATABASE::"Bing Maps Setup") THEN
        EXIT;

      IF NOT BingMapsHandler.SetupIsDoneAndEnabled THEN
        EXIT;

      Success := FALSE;
      IF (Latitude = '') OR (Longitude = '') THEN
        IF BingMapsHandler.GetLatLngFromAddress(tmpLatitude, tmpLongitude, Address, City, "Post Code") THEN BEGIN
          Latitude := tmpLatitude;
          Longitude := tmpLongitude;
          MODIFY;
          Success := TRUE;
        END;
         //ELSE BingMapsHandler.LocationError(TABLECAPTION, "No."); C047603.o
      EXIT(Success);
    END;

    PROCEDURE SetSkipUpdateAddress@1100527301(SkipUpdate@1100527300 : Boolean);
    BEGIN
      SkipUpdateAddress := SkipUpdate;
    END;

    LOCAL PROCEDURE UpdateServiceOrderLatitudeLongitude@1100525003();
    VAR
      ServiceOrder@1100525002 : Record 11012823;
      ServiceOrderExtension@1100525003 : Record 11071727;
    BEGIN
      IF "No." = '' THEN
        EXIT;

      MODIFY;
      ServiceOrder.SETRANGE("Service Location No.", "No.");
      IF ServiceOrder.FINDSET THEN
        REPEAT
          IF ServiceOrderExtension.GET(ServiceOrder."No.") THEN
            ServiceOrderExtension.UpdateLongitudeLatitude;
        UNTIL ServiceOrder.NEXT = 0;
    END;

    PROCEDURE ShowTryOutCard@1100527400(iAction@1100527400 : Integer);
    VAR
      Tryout@1100527401 : Record 11012750;
      TryoutQuote@1100527402 : Record 11012758;
      TryoutSuccessor@1100527403 : Record 11012761;
    BEGIN
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(TryoutSuccessor) THEN EXIT;

      TryoutSuccessor.SETCURRENTKEY("Service Location No.");
      TryoutSuccessor.SETRANGE("Service Location No.", "No.");

      IF iAction = 1 THEN
        TryoutSuccessor.SETFILTER("Try-out No.", '<>%1', '');
      IF iAction = 2 THEN
        TryoutSuccessor.SETFILTER("Try-out Quote", '<>%1', '');

      IF TryoutSuccessor.FINDFIRST THEN BEGIN
        REPEAT
          IF iAction = 1 THEN BEGIN
            Tryout.GET(TryoutSuccessor."Try-out No.");
          END;
          IF iAction = 2 THEN BEGIN
            TryoutQuote.GET(TryoutSuccessor."Try-out Quote");
          END;
        UNTIL TryoutSuccessor.NEXT = 0;
      END ELSE BEGIN
        IF iAction = 1 THEN
          Tryout.SETRANGE(Code, '');
        IF iAction = 2 THEN
          TryoutQuote.SETRANGE(Code, '');
      END;

      IF (Tryout.Code = '') AND (TryoutQuote.Code = '') THEN
        EXIT;

      IF iAction = 1 THEN
        IF PAGE.RUNMODAL(PAGE::"Try-out", Tryout)  = ACTION::LookupOK THEN;
      IF iAction = 2 THEN
        IF PAGE.RUNMODAL(PAGE::"Try-out Quote", TryoutQuote) = ACTION::LookupOK THEN;
    END;

    PROCEDURE LookupProjectNo@1100527302();
    VAR
      PageNo@1100527301 : Integer;
    BEGIN
      CheckCompanyIC;
      ProjRec."No." := "Project No.";
      IF RefersToOtherCompany THEN
        PageNo := PAGE::"Job List IC";
      IF PAGE.RUNMODAL(PageNo, ProjRec) = ACTION::LookupOK THEN
        VALIDATE("Project No.", ProjRec."No.");
    END;

    PROCEDURE LookupPlotNo@1100527300();
    BEGIN
      CheckCompanyIC;
      IF "Project No." <> '' THEN
        PlotRec.SETRANGE("Project No.", "Project No.");
      PlotRec."Project No." := "Project No.";
      PlotRec."Plot No." := "Plot No.";
      IF PAGE.RUNMODAL(0, PlotRec) = ACTION::LookupOK THEN BEGIN
        VALIDATE("Project No.", PlotRec."Project No.");
        VALIDATE("Plot No.", PlotRec."Plot No.");
      END;
    END;

    PROCEDURE ValidateBillToCustAddressData@1100529901();
    BEGIN
      IF "Bill-to Customer No."  <> '' THEN BEGIN
        CheckInvoiceAddress;
        CustRec.GET("Bill-to Customer No.");
        CustRec.CheckCustomerStatus("Bill-to Customer No.");
      END;
    END;

    PROCEDURE CheckInvoiceAddress@1100529600();
    VAR
      AdrsRec@1210190000 : Record 222;
    BEGIN
      IF AdrsRec.GET("Bill-to Customer No.", "Alternative Bill-to Address") THEN BEGIN
        "Bill-to Name" := AdrsRec.Name;
        "Bill-to Name 2" := AdrsRec."Name 2";
        "Bill-to Address" := AdrsRec.Address;
        "Bill-to Address 2" := AdrsRec."Address 2";
        "Bill-to Post Code" := AdrsRec."Post Code";
        "Bill-to City" := AdrsRec.City;
      END ELSE BEGIN
        "Alternative Bill-to Address" := '';
        IF NOT CustRec.GET("Bill-to Customer No.") THEN
          CustRec.INIT;
        "Bill-to Name" := CustRec.Name;
        "Bill-to Name 2" := CustRec."Name 2";
        "Bill-to Address" := CustRec.Address;
        "Bill-to Address 2" := CustRec."Address 2";
        "Bill-to Post Code" := CustRec."Post Code";
        "Bill-to City" := CustRec.City;
      END;
    END;

    BEGIN
    {
      4PS01 HBK 06-08-09: Field added "Language Code"
    }
    END.
  }
}

