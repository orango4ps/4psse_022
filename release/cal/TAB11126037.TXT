OBJECT Table 11126037 Project Result Forecast Line
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TestFixed; //kzwerver, 130104, n, #C001457
               FillInAgvHourRateCalculation; //kzwerver, 130104, n, #C002661
             END;

    OnModify=BEGIN
               TestFixed; //kzwerver, 130104, n, #C001457
               FillInAgvHourRateCalculation; //kzwerver, 130104, n, #C002661
             END;

    OnDelete=BEGIN
               TestFixed; //kzwerver, 130104, n, #C001457
             END;

    CaptionML=[ENU=Project Result Forecast Line;
               NOR=Prognoserad for prosjektresultat;
               SVE=Prognosrad fîr projektresultat];
    LookupPageID=Page11126042;
    DrillDownPageID=Page11126042;
  }
  FIELDS
  {
    { 10  ;   ;Project No.         ;Code20        ;TableRelation=Job;
                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr];
                                                   NotBlank=Yes }
    { 20  ;   ;Date                ;Date          ;TableRelation="Project Result Forecast".Date WHERE (Project No.=FIELD(Project No.));
                                                   CaptionML=[ENU=Date;
                                                              NOR=Dato;
                                                              SVE=Datum];
                                                   NotBlank=Yes }
    { 30  ;   ;Line Type           ;Option        ;CaptionML=[ENU=Line Type;
                                                              NOR=Radtype;
                                                              SVE=Radtyp];
                                                   OptionCaptionML=[ENU=Purchase Actions,Labor Costs,Plant Costs,Miscellaneous Costs,,,,,,Revenues;
                                                                    NOR=Innkjõpshandlinger,Arbeidskraftskoster,Maskinkoster,Diverse koster,,,,,,Inntekter;
                                                                    SVE=InkîpsÜtgÑrder,Arbetskraftskostnader,Maskinkostnader,Diverse kostnader,,,,,,IntÑkter];
                                                   OptionString=Purchase Actions,Labor Costs,Plant Costs,Miscellaneous Costs,,,,,,Revenues;
                                                   Editable=No }
    { 35  ;   ;Summary             ;Boolean       ;CaptionML=[ENU=Summary;
                                                              NOR=Sammendrag;
                                                              SVE=Sammanfattning] }
    { 40  ;   ;Code                ;Code20        ;TableRelation=IF (Line Type=CONST(Purchase Actions),
                                                                     Summary=CONST(No)) "Project Purchase Action".Code WHERE (Project No.=FIELD(Project No.))
                                                                     ELSE IF (Line Type=CONST(Labor Costs),
                                                                              Summary=CONST(No)) "Dimension Value".Code WHERE (Global Dimension No.=CONST(2),
                                                                                                                               Cost Type=CONST(Labor))
                                                                                                                               ELSE IF (Line Type=CONST(Plant Costs),
                                                                                                                                        Summary=CONST(No)) "Dimension Value".Code WHERE (Global Dimension No.=CONST(2),
                                                                                                                                                                                         Cost Type=CONST(Plant))
                                                                                                                                                                                         ELSE IF (Line Type=CONST(Miscellaneous Costs),
                                                                                                                                                                                                  Summary=CONST(No)) "Dimension Value".Code WHERE (Global Dimension No.=CONST(2),
                                                                                                                                                                                                                                                   Cost Type=FILTER(<>Labor&<>Revenue))
                                                                                                                                                                                                                                                   ELSE IF (Line Type=CONST(Revenues),
                                                                                                                                                                                                                                                            Summary=CONST(No)) "Dimension Value".Code WHERE (Global Dimension No.=CONST(2),
                                                                                                                                                                                                                                                                                                             Cost Type=CONST(Revenue))
                                                                                                                                                                                                                                                                                                             ELSE IF (Summary=CONST(Yes)) "Cost Component".Code;
                                                   OnValidate=BEGIN
                                                                FillCostGroupCode;
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NOR=Kode;
                                                              SVE=Kod];
                                                   Editable=No }
    { 45  ;   ;Purchase Budget     ;Decimal       ;CaptionML=[ENU=Purchase Budget;
                                                              NOR=Innkjõpsbudsjett;
                                                              SVE=Inkîpsbudget];
                                                   Editable=No }
    { 50  ;   ;Budget              ;Decimal       ;CaptionML=[ENU=Budget;
                                                              NOR=Budsjett;
                                                              SVE=Budget];
                                                   Editable=No }
    { 55  ;   ;Budget Hours        ;Decimal       ;CaptionML=[ENU=Budget Hours;
                                                              NOR=Budsjett (Timer);
                                                              SVE=Budget (timmar)];
                                                   Editable=No }
    { 60  ;   ;Budget Extension    ;Decimal       ;CaptionML=[ENU=Budget Extension;
                                                              NOR=Budsjett, ETA;
                                                              SVE=Budget, éTA];
                                                   Editable=No }
    { 70  ;   ;Budget Options      ;Decimal       ;CaptionML=[ENU=Budget Options;
                                                              NOR=Budsjettalternativer;
                                                              SVE=Budgetalternativ];
                                                   Editable=No }
    { 75  ;   ;Budget Adjustments  ;Decimal       ;CaptionML=[ENU=Budget Adjustments;
                                                              NOR=Budsjettjusteringer;
                                                              SVE=Budgetjusteringar];
                                                   Editable=No }
    { 80  ;   ;Budget (Total)      ;Decimal       ;CaptionML=[ENU=Budget (Total);
                                                              NOR=Budsjett (total);
                                                              SVE=Budget (total)];
                                                   Editable=No }
    { 90  ;   ;Actual Cost         ;Decimal       ;CaptionML=[ENU=Actual Cost;
                                                              NOR=Faktisk kost;
                                                              SVE=Faktisk kostnad];
                                                   Editable=No }
    { 100 ;   ;Order Amount        ;Decimal       ;CaptionML=[ENU=Order Amount;
                                                              NOR=Ordrebelõp;
                                                              SVE=Orderbelopp];
                                                   Editable=No }
    { 110 ;   ;Risc Coverage Amount;Decimal       ;OnValidate=BEGIN
                                                                CalcResult;
                                                              END;

                                                   CaptionML=[ENU=Risc Coverage Amount;
                                                              NOR=Riskdekningsbelõp;
                                                              SVE=RisktÑckningsbelopp];
                                                   Editable=No }
    { 115 ;   ;Released Risk Coverage Amount;Decimal;
                                                   CaptionML=[ENU=Released Risk Coverage Amount;
                                                              NOR=Frigitt riskdekningsbelõp;
                                                              SVE=SlÑppt risktÑckningsbelopp];
                                                   Editable=No }
    { 117 ;   ;Remaining Risk Coverage Amount;Decimal;
                                                   CaptionML=[ENU=Remaining Risk Coverage Amount;
                                                              NOR=GjenstÜende riskdekningsbelõp;
                                                              SVE=èterst. risktÑckningsbel.];
                                                   Editable=No }
    { 120 ;   ;Result              ;Decimal       ;CaptionML=[ENU=Result;
                                                              NOR=Resultat;
                                                              SVE=Resultat];
                                                   Editable=No }
    { 130 ;   ;Result %            ;Decimal       ;CaptionML=[ENU=Result %;
                                                              NOR=Resultat (%);
                                                              SVE=Resultat (%)];
                                                   Editable=No }
    { 140 ;   ;Calc. Remaining Amount;Decimal     ;OnValidate=BEGIN
                                                                "Remaining Amount" := "Calc. Remaining Amount" + "Correction Remaining Amount";
                                                              END;

                                                   CaptionML=[ENU=Calculated Remaining Amount;
                                                              NOR=Estimert gjenstÜende belõp;
                                                              SVE=BerÑknat ÜterstÜende belopp];
                                                   Editable=No }
    { 143 ;   ;Remaining Hourly Rate;Decimal      ;CaptionML=[ENU=Remaining Hourly Rate;
                                                              NOR=GjenstÜende timesats;
                                                              SVE=èterstÜende timtaxa] }
    { 145 ;   ;Remaining Hours     ;Decimal       ;CaptionML=[ENU=Remaining Hours;
                                                              NOR=GjenstÜende timer;
                                                              SVE=Resterande timmar] }
    { 149 ;   ;Forecast Qty.       ;Decimal       ;CaptionML=[ENU=Forecast Qty.;
                                                              NOR=Prognose antall;
                                                              SVE=Prognos antal];
                                                   Editable=No }
    { 150 ;   ;Project Result Forecast;Decimal    ;CaptionML=[ENU=Project Result Forecast;
                                                              NOR=Prognose for prosjektresultat;
                                                              SVE=Prognos fîr projektresultat];
                                                   Editable=No }
    { 151 ;   ;Calc. Project Result Forecast;Decimal;
                                                   OnValidate=BEGIN
                                                                "Project Result Forecast" := "Calc. Project Result Forecast" + "Corr. Project Result Forecast"
                                                              END;

                                                   CaptionML=[ENU=Calculated Project Result Forecast;
                                                              NOR=Beregnet prosjektresultat Õ prognose;
                                                              SVE=BerÑkn. progn. fîr proj.reslt];
                                                   Editable=No }
    { 160 ;   ;Cost Component      ;Code20        ;TableRelation="Cost Component".Code;
                                                   CaptionML=[ENU=Cost Component;
                                                              NOR=Kostnadskomponent;
                                                              SVE=Kostnadsdel];
                                                   Editable=No }
    { 270 ;   ;Purchase Action Description;Text50 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Project Purchase Action".Description WHERE (Project No.=FIELD(Project No.),
                                                                                                                   Code=FIELD(Code)));
                                                   CaptionML=[ENU=Purchase Action Description;
                                                              NOR=Beskrivelse av Innkjõpshandling;
                                                              SVE=Beskrivning av inkîpsÜtgÑrd];
                                                   Editable=No }
    { 280 ;   ;Order No.           ;Code20        ;CaptionML=[ENU=Order No.;
                                                              NOR=Ordrenr.;
                                                              SVE=Ordernr];
                                                   Editable=No }
    { 290 ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Description];
                                                   Editable=No }
    { 300 ;   ;Comment             ;Text80        ;CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar] }
    { 310 ;   ;Allowed Hours       ;Decimal       ;CaptionML=[ENU=Allowed Hours;
                                                              NOR=Tillatte timer;
                                                              SVE=TillÜtna timmar];
                                                   Editable=No }
    { 320 ;   ;Actual Hours        ;Decimal       ;CaptionML=[ENU=Actual Hours;
                                                              NOR=Reelle timer;
                                                              SVE=Verkliga timmar];
                                                   Editable=No }
    { 330 ;   ;Allowed Hours Prev. Forecast;Decimal;
                                                   CaptionML=[ENU=Allowed Hours Prev. Forecast;
                                                              NOR=Tillatte timer forrige prognose;
                                                              SVE=TillÜtna fîreg. timmar Prognos];
                                                   Editable=No }
    { 340 ;   ;Allowed Costs       ;Decimal       ;CaptionML=[ENU=Allowed Costs;
                                                              NOR=Tillatte koster;
                                                              SVE=TillÜtna kostnader];
                                                   Editable=No }
    { 350 ;   ;Allowed Costs Prev. Forecast;Decimal;
                                                   CaptionML=[ENU=Allowed Costs Prev. Forecast;
                                                              NOR=Tillatte koster forrige prognose;
                                                              SVE=TillÜtna fîreg. kostnader Prognos];
                                                   Editable=No }
    { 360 ;   ;Progress Date       ;Date          ;CaptionML=[ENU=Progress Date;
                                                              NOR=Fremdriftsdato;
                                                              SVE=Fîrloppsdatum];
                                                   Editable=No }
    { 370 ;   ;Previous Progress Date;Date        ;CaptionML=[ENU=Previous Progress Date;
                                                              NOR=Dato for forrige Fremdrift;
                                                              SVE=Datum fîr fîregÜende fîrlopp];
                                                   Editable=No }
    { 380 ;   ;Budgetted Extension Hours;Decimal  ;CaptionML=[ENU=Budgetted Extension Hours;
                                                              NOR=Budsjetterte ETA-timer;
                                                              SVE=Budgeterade éTA-timmar];
                                                   Editable=No }
    { 390 ;   ;Budgetted Option Hours;Decimal     ;CaptionML=[ENU=Budgetted Option Hours;
                                                              NOR=Budsjetterte alternativtimer;
                                                              SVE=Budgeterade alternativtimmar];
                                                   Editable=No }
    { 400 ;   ;Budgetted Adjustment Hours;Decimal ;CaptionML=[ENU=Budgetted Adjustment Hours;
                                                              NOR=Budsjetterte justeringstimer;
                                                              SVE=Budgeterade justerade timmar];
                                                   Editable=No }
    { 410 ;   ;Cost Object Description;Text50     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Dimension Value".Name WHERE (Global Dimension No.=CONST(2),
                                                                                                    Code=FIELD(Code)));
                                                   CaptionML=[ENU=Cost Object Description;
                                                              NOR=Kostnadsobjekt, Beskrivelse;
                                                              SVE=Kostnadsobjekt, beskrivning];
                                                   Editable=No;
                                                   CaptionClass='1,11012000,2, , ' + Text000 }
    { 420 ;   ;Cost Component Description;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Cost Component".Description WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Cost Component Description;
                                                              NOR=Kostnadskomponent, Beskrivelse;
                                                              SVE=Kostnadsdel, beskrivning];
                                                   Editable=No }
    { 430 ;   ;Unit of Measure Code;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Dimension Value"."Unit of Measure" WHERE (Global Dimension No.=CONST(2),
                                                                                                                 Code=FIELD(Code)));
                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=MÜleenhetskode;
                                                              SVE=Enhetskod];
                                                   Editable=No }
    { 440 ;   ;Budget Hours (Total);Decimal       ;CaptionML=[ENU=Budget Hours (Total);
                                                              NOR=Budsjettimer (total);
                                                              SVE=Budget (timmar)];
                                                   Editable=No }
    { 450 ;   ;Purchase Budget (Cost Comp.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Budget (Total)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                          Date=FIELD(Date),
                                                                                                                          Cost Component=FIELD(Code),
                                                                                                                          Line Type=CONST(Purchase Actions)));
                                                   CaptionML=[ENU=Purchase Budget (Cost Comp.);
                                                              NOR=Innkjõpsbudsjett (kostnadskomponent);
                                                              SVE=Inkîpsbudget (kostnad fîretag)];
                                                   Editable=No }
    { 460 ;   ;Total Budg. Labor (Cost Comp.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Budget (Total)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                          Date=FIELD(Date),
                                                                                                                          Line Type=CONST(Labor Costs),
                                                                                                                          Cost Component=FIELD(Code)));
                                                   CaptionML=[ENU=Total Budg. Labor (Cost Comp.);
                                                              NOR=Total budsj. arbeidskraft (kostnadskomponent);
                                                              SVE=Total budg. Arbetskraft (kostnad fîretag)];
                                                   Editable=No }
    { 470 ;   ;Actual Cost Labor (Cost Comp.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Actual Cost" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Date=FIELD(Date),
                                                                                                                       Line Type=CONST(Labor Costs),
                                                                                                                       Cost Component=FIELD(Code)));
                                                   CaptionML=[ENU=Actual Cost Labor (Cost Comp.);
                                                              NOR=Faktiske arbeidskraftskoster (kostnadskomponent);
                                                              SVE=Faktisk arb.kr.kst.(kst,fîret)];
                                                   Editable=No }
    { 480 ;   ;Total Budg. Misc. (Cost Comp.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Budget (Total)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                          Date=FIELD(Date),
                                                                                                                          Line Type=CONST(Plant Costs),
                                                                                                                          Cost Component=FIELD(Code)));
                                                   CaptionML=[ENU=Total Budg. Misc. (Cost Comp.);
                                                              SVE=Totaal begroot overig KK];
                                                   Editable=No }
    { 490 ;   ;Actual Cost Misc. (Cost Comp.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Actual Cost" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Date=FIELD(Date),
                                                                                                                       Line Type=CONST(Plant Costs),
                                                                                                                       Cost Component=FIELD(Code)));
                                                   CaptionML=[ENU=Actual Cost Misc. (Cost Comp.);
                                                              SVE=Faktiska kostn. îvrigt (kst.komp.)];
                                                   Editable=No }
    { 500 ;   ;Act. Cost Purch. (Cost Comp.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Actual Cost" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Date=FIELD(Date),
                                                                                                                       Cost Component=FIELD(Code),
                                                                                                                       Line Type=CONST(Purchase Actions)));
                                                   CaptionML=[ENU=Act. Cost Purch. (Cost Comp.);
                                                              SVE=Faktiska kostn. upphandl. (kst.komp.)];
                                                   Editable=No }
    { 502 ;   ;Total Budg. Plant (Cost Comp.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Budget (Total)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                          Date=FIELD(Date),
                                                                                                                          Line Type=CONST(Miscellaneous Costs),
                                                                                                                          Cost Component=FIELD(Code)));
                                                   CaptionML=[ENU=Total Budg. Plant (Cost Comp.);
                                                              NOR=Total budsj. maskin (kostnadskomponent);
                                                              SVE=Total budg. Maskin (kostnad fîretag)];
                                                   Editable=No }
    { 504 ;   ;Actual Cost Plant (Cost Comp.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Actual Cost" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Date=FIELD(Date),
                                                                                                                       Line Type=CONST(Miscellaneous Costs),
                                                                                                                       Cost Component=FIELD(Code)));
                                                   CaptionML=[ENU=Actual Cost Plant (Cost Comp.);
                                                              NOR=Faktisk maskinkost (kostnadskomponent);
                                                              SVE=Faktisk maskin.kst.(kst,fîret.)];
                                                   Editable=No }
    { 530 ;   ;Progress %          ;Decimal       ;CaptionML=[ENU=Progress %;
                                                              NOR=Fremdrifts%;
                                                              SVE=Fîrloppsprocent];
                                                   Editable=No }
    { 540 ;   ;Budgetted Rate      ;Decimal       ;CaptionML=[ENU=Budgetted Rate;
                                                              NOR=Budsjettert sats;
                                                              SVE=Budgeterad taxa];
                                                   Editable=No }
    { 550 ;   ;Total Project Result Forecast;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Project Result Forecast" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                   Date=FIELD(Date),
                                                                                                                                   Summary=CONST(No),
                                                                                                                                   Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Project Result Forecast;
                                                              NOR=Totalprognose for prosjektresultat;
                                                              SVE=Tot. progn. proj.resultat];
                                                   Editable=No }
    { 560 ;   ;Line Type Filter    ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Line Type Filter;
                                                              NOR=Radtypefilter;
                                                              SVE=Radtypsfilter];
                                                   OptionCaptionML=[ENU=Purchase Actions,Labor Costs,Plant Costs,Miscellaneous Costs,,,,,,Revenues;
                                                                    NOR=Innkjõpshandlinger,Arbeidskraftskoster,Maskinkoster,Diverse koster,,,,,,Inntekter;
                                                                    SVE=InkîpsÜtgÑrder,Arbetskraftskostnader,Maskinkostnader,Diverse kostnader,,,,,,IntÑkter];
                                                   OptionString=Purchase Actions,Labor Costs,Plant Costs,Miscellaneous Costs,,,,,,Revenues;
                                                   Editable=No }
    { 570 ;   ;Total Purchase Budget;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Purchase Budget" WHERE (Project No.=FIELD(Project No.),
                                                                                                                           Date=FIELD(Date),
                                                                                                                           Summary=CONST(No),
                                                                                                                           Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Purchase Budget;
                                                              NOR=Totalt innkjõpsbudsjett;
                                                              SVE=Totalt inkîpsbudget];
                                                   Editable=No }
    { 580 ;   ;Total Actual Cost   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Actual Cost" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Date=FIELD(Date),
                                                                                                                       Summary=CONST(No),
                                                                                                                       Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Actual Cost;
                                                              NOR=Total faktisk kost;
                                                              SVE=Total faktisk kostnad];
                                                   Editable=No }
    { 590 ;   ;Total Order Amount  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Order Amount" WHERE (Project No.=FIELD(Project No.),
                                                                                                                        Date=FIELD(Date),
                                                                                                                        Summary=CONST(No),
                                                                                                                        Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Order Amount;
                                                              NOR=Totalt ordrebelõp;
                                                              SVE=Totalt orderbelopp];
                                                   Editable=No }
    { 600 ;   ;Total Risc Coverage Amount;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Remaining Risk Coverage Amount" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                          Date=FIELD(Date),
                                                                                                                                          Summary=CONST(No),
                                                                                                                                          Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Risc Coverage Amount;
                                                              NOR=Totalt Riskdekningsbelõp;
                                                              SVE=Totalt risktÑckningsbelopp];
                                                   Editable=No }
    { 610 ;   ;Total Purchase Result;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line".Result WHERE (Project No.=FIELD(Project No.),
                                                                                                                Date=FIELD(Date),
                                                                                                                Summary=CONST(No),
                                                                                                                Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Purchase Result;
                                                              NOR=Totalt Innkjõpsresultat;
                                                              SVE=Totalt inkîpsresultat];
                                                   Editable=No }
    { 620 ;   ;Total Remaining Amount;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Remaining Amount" WHERE (Project No.=FIELD(Project No.),
                                                                                                                            Date=FIELD(Date),
                                                                                                                            Summary=CONST(No),
                                                                                                                            Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Remaining Amount;
                                                              NOR=Totalt restbelõp;
                                                              SVE=Totalt Üterst. belopp];
                                                   Editable=No }
    { 630 ;   ;Total Budget        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Budget (Total)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                          Date=FIELD(Date),
                                                                                                                          Summary=CONST(No),
                                                                                                                          Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Budget;
                                                              NOR=Budsjett Total;
                                                              SVE=Total budget];
                                                   Editable=No }
    { 631 ;   ;Total Budget Hours  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Budget Hours (Total)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                Date=FIELD(Date),
                                                                                                                                Summary=CONST(No),
                                                                                                                                Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Budget Hours;
                                                              NOR=Budsjettimer totalt;
                                                              SVE=Budgettimmar totalt];
                                                   Editable=No }
    { 632 ;   ;Total Allowed Costs ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Allowed Costs" WHERE (Project No.=FIELD(Project No.),
                                                                                                                         Date=FIELD(Date),
                                                                                                                         Summary=CONST(No),
                                                                                                                         Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Allowed Costs;
                                                              NOR=Totalt tillatte koster;
                                                              SVE=Totalt tillÜtna kostnader];
                                                   Editable=No }
    { 633 ;   ;Total Allowed Hours ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Allowed Hours" WHERE (Project No.=FIELD(Project No.),
                                                                                                                         Date=FIELD(Date),
                                                                                                                         Summary=CONST(No),
                                                                                                                         Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Allowed Hours;
                                                              NOR=Totalt tillatte timer;
                                                              SVE=Totalt tillÜtna timmar];
                                                   Editable=No }
    { 634 ;   ;Total Actual Hours  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Actual Hours" WHERE (Project No.=FIELD(Project No.),
                                                                                                                        Date=FIELD(Date),
                                                                                                                        Summary=CONST(No),
                                                                                                                        Line Type=FIELD(Line Type Filter)));
                                                   CaptionML=[ENU=Total Actual Hours;
                                                              NOR=Totalt faktiske timer;
                                                              SVE=Totalt faktiska timmar];
                                                   Editable=No }
    { 700 ;   ;Record Progress     ;Boolean       ;CaptionML=[ENU=Record Progress;
                                                              NOR=Postens fremdrift;
                                                              SVE=Postens fîrlopp];
                                                   Editable=No }
    { 720 ;   ;Correction Remaining Amount;Decimal;OnValidate=BEGIN
                                                                IF (CurrFieldNo = FIELDNO("Correction Remaining Amount")) THEN BEGIN
                                                                  "Fix Project Result Forecast" := TRUE;
                                                                  CalcAmounts(TRUE);
                                                                END ELSE
                                                                  CalcAmounts(FALSE);
                                                              END;

                                                   CaptionML=[ENU=Correction Remaining Amount;
                                                              NOR=Korreksjon - gjenstÜende belõp;
                                                              SVE=Korr, ÜterstÜende belopp] }
    { 730 ;   ;Remaining Amount    ;Decimal       ;CaptionML=[ENU=Remaining Amount;
                                                              NOR=Restbelõp;
                                                              SVE=èterstÜende belopp];
                                                   Editable=No }
    { 740 ;   ;Corr. Project Result Forecast;Decimal;
                                                   OnValidate=BEGIN
                                                                IF (CurrFieldNo = FIELDNO("Corr. Project Result Forecast")) THEN
                                                                  CalcAmounts(TRUE)
                                                                ELSE
                                                                  CalcAmounts(FALSE);
                                                              END;

                                                   CaptionML=[ENU=Correction Project Forecast Result;
                                                              NOR=Korreksjon Õ prognose for prosjektresultat;
                                                              SVE=Korr, progn. projektresultat] }
    { 750 ;   ;Cost Group Code     ;Code10        ;TableRelation="Cost Group";
                                                   CaptionML=[ENU=Cost Group Code;
                                                              NOR=Kostgruppekode;
                                                              SVE=Kostnadsgruppkod] }
    { 760 ;   ;Cost Group Description;Text30      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Cost Group".Description WHERE (Code=FIELD(Cost Group Code)));
                                                   CaptionML=[ENU=Cost Group Description;
                                                              NOR=Beskrivelse av kostgruppe;
                                                              SVE=Kostnadsgrupp, beskrivning];
                                                   Editable=No }
    { 770 ;   ;Estimate Result Line;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Cost Group"."Estimate Result" WHERE (Code=FIELD(Cost Group Code)));
                                                   CaptionML=[ENU=Estimate Result Line;
                                                              NOR=Kalkyle, resultatrad;
                                                              SVE=Kalkyl, resultatrad];
                                                   Editable=No }
    { 780 ;   ;Unforeseen Line     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Cost Group".Unforeseen WHERE (Code=FIELD(Cost Group Code)));
                                                   CaptionML=[ENU=Unforeseen Line;
                                                              NOR=Uforutsett rad;
                                                              SVE=Ofîrutsedd rad];
                                                   Editable=No }
    { 785 ;   ;Plot Price Line     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Cost Group"."Plot Price" WHERE (Code=FIELD(Cost Group Code)));
                                                   CaptionML=;
                                                   Editable=No }
    { 790 ;   ;Fix Project Result Forecast;Boolean;CaptionML=[ENU=Fix Project Result Forecast;
                                                              NOR=Fast progn. for prosjektres.;
                                                              SVE=Fast progn. fîr projektres.] }
    { 800 ;   ;Action              ;Text6         ;CaptionML=[ENU=Action;
                                                              NOR=Handling;
                                                              SVE=ètgÑrd] }
    { 810 ;   ;Budget Revenues     ;Decimal       ;CaptionML=[ENU=Budget Revenues;
                                                              NOR=Budsjettinntekter;
                                                              SVE=BudgetintÑkter];
                                                   Editable=No }
    { 815 ;   ;Budget Qty. Revenues;Decimal       ;CaptionML=[ENU=Budget Qty. Revenues;
                                                              NOR=Budsjett, ant. inntekter;
                                                              SVE=Budget, ant. intÑkter];
                                                   Editable=No }
    { 820 ;   ;Actual Revenues     ;Decimal       ;CaptionML=[ENU=Actual Revenues;
                                                              NOR=Faktiske inntekter;
                                                              SVE=IntÑkter];
                                                   Editable=No }
    { 825 ;   ;Forecast Revenues   ;Decimal       ;CaptionML=[ENU=Forecast Revenues;
                                                              NOR=Prognose, inntekter;
                                                              SVE=Prognos, intÑkter] }
    { 830 ;   ;Fix Hour Rate       ;Boolean       ;CaptionML=[ENU=Fix Hour Rate;
                                                              NOR=Fast timesats;
                                                              SVE=Fast timtaxa] }
    { 840 ;   ;Avg. Hour Rate      ;Decimal       ;OnValidate=BEGIN
                                                                "Fix Hour Rate" := TRUE;
                                                              END;

                                                   CaptionML=[ENU=Avg. Hour Rate;
                                                              NOR=Gjennomsnittlig timesats;
                                                              SVE=Gen. Timtaxa] }
    { 841 ;   ;In Avg Hour Rate Calculation;Boolean;
                                                   CaptionML=ENU=In Average Hour Rate Calculation;
                                                   Editable=No }
    { 842 ;   ;Tot Act Hours In Avg Hour Rate;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Result Forecast Line"."Actual Hours" WHERE (Project No.=FIELD(Project No.),
                                                                                                                        Date=FIELD(Date),
                                                                                                                        Summary=CONST(No),
                                                                                                                        Line Type=FIELD(Line Type Filter),
                                                                                                                        In Avg Hour Rate Calculation=CONST(Yes)));
                                                   CaptionML=ENU=Total Actual Hours In Average Hour Rate;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Project No.,Date,Line Type,Summary,Code ;SumIndexFields=Project Result Forecast,Purchase Budget,Budget,Order Amount,Risc Coverage Amount,Result,Actual Cost,Calc. Remaining Amount,Budget Hours,Allowed Costs,Allowed Hours,Actual Hours,Remaining Amount,Budget Hours (Total),Budget (Total),Remaining Risk Coverage Amount;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
    {    ;Project No.,Date,Line Type,Cost Component;
                                                   SumIndexFields=Purchase Budget,Actual Cost,Budget (Total) }
    {    ;Project No.,Date,Line Type,Cost Group Code }
    {    ;Project No.,Date,Line Type,Summary,In Avg Hour Rate Calculation;
                                                   SumIndexFields=Actual Hours }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1100527350 : TextConst 'ENU=Description;SVE=Sannolikhet';

    PROCEDURE CalcAmounts@1100525000(ManualCorrection@1100528300 : Boolean);
    BEGIN
      "Remaining Risk Coverage Amount" := "Risc Coverage Amount" - "Released Risk Coverage Amount";

      CalcResult;
      CalcForecastAndRemainingAmt(ManualCorrection);
    END;

    PROCEDURE CalcResult@1100528702();
    BEGIN
      Result := 0;
      "Result %" := 0;

      CASE "Line Type" OF
        "Line Type"::"Purchase Actions":
          BEGIN
            IF "Order Amount" <> 0 THEN
              Result := "Budget (Total)" - ("Risc Coverage Amount" - "Released Risk Coverage Amount") - "Order Amount";
          END;
        "Line Type"::"Labor Costs":
          BEGIN
            CASE "Record Progress" OF
              TRUE: Result := "Allowed Costs" - "Actual Cost";
              FALSE: Result := IIF(("Actual Cost" > "Budget (Total)") OR ("Actual Hours" > "Budget Hours (Total)"),
                                     "Budget (Total)" - "Actual Cost", 0);
            END;
          END;
        "Line Type"::"Plant Costs":
          BEGIN
            CASE "Record Progress" OF
              TRUE: Result := "Allowed Costs" - "Actual Cost";
              FALSE: Result := IIF("Actual Cost" > "Budget (Total)", "Budget (Total)" - "Actual Cost", 0);
            END;
          END;
        "Line Type"::"Miscellaneous Costs":
          BEGIN
            CASE "Record Progress" OF
              TRUE: Result := "Allowed Costs" - "Actual Cost";
              FALSE: Result := IIF("Actual Cost" > "Budget (Total)", "Budget (Total)" - "Actual Cost", 0);
            END;
          END;
      END;

      IF "Budget (Total)" <> 0 THEN
        "Result %" := (Result / "Budget (Total)") * 100;
    END;

    PROCEDURE CalcForecastAndRemainingAmt@1100528709(ManualCorrection@1100528300 : Boolean);
    VAR
      JobsSetup@1100528700 : Record 315;
    BEGIN
      "Forecast Qty." := 0;
      IF (NOT "Fix Project Result Forecast") THEN
        "Project Result Forecast" := 0;
      "Calc. Remaining Amount" := 0;

      JobsSetup.GET;

      IF (NOT CorrectionFieldsAreEditable) THEN BEGIN
        "Project Result Forecast" := "Budget (Total)";
        "Fix Project Result Forecast" := TRUE;
      END;

      //For each line type the flow is as follows:
      // if Record progress, calculate Calc. Remaining Amount, and with that Calc. Project Result Forecast
      // if not Record progress, calculate Calc. Project Result Forecast, and with that Calc. Remaining Amount
      CASE "Line Type" OF
        "Line Type"::"Purchase Actions":
          BEGIN
            CASE "Record Progress" OF
              TRUE:
                BEGIN
                  //progress on purchase actions will never occur
                END;
              FALSE:
                BEGIN
                  IF ("Order No." = '') AND (NOT MorePOsPresentForPurchAction) THEN BEGIN
                    VALIDATE("Calc. Remaining Amount", "Budget (Total)");
                    IF ("Fix Project Result Forecast") AND (NOT ManualCorrection) THEN BEGIN
                      "Correction Remaining Amount" := "Budget (Total)" -
                                                       "Calc. Remaining Amount" -
                                                       "Project Result Forecast";
                      VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                    END;
                    VALIDATE("Calc. Project Result Forecast", "Budget (Total)" - "Actual Cost" - "Remaining Amount");
                  END ELSE BEGIN
                    IF ("Budget (Total)" <> 0) THEN BEGIN
                      VALIDATE("Calc. Remaining Amount",
                        IIF(("Actual Cost" < "Order Amount" + "Risc Coverage Amount")
                          AND NOT PurchaseOrderClosed,
                        "Order Amount" + "Remaining Risk Coverage Amount" - "Actual Cost", 0));
                      IF ("Fix Project Result Forecast") AND (NOT ManualCorrection) THEN BEGIN
                        "Correction Remaining Amount" := "Budget (Total)" - "Actual Cost" -
                                                         "Calc. Remaining Amount" - "Project Result Forecast";
                        VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                      END;
                      VALIDATE("Calc. Project Result Forecast", "Budget (Total)" - "Actual Cost" - "Remaining Amount");
                    END ELSE BEGIN
                      VALIDATE("Calc. Remaining Amount", "Order Amount" + "Risc Coverage Amount" - "Actual Cost");
                      //kzwerver, 120628, n, C000805
                      IF ("Fix Project Result Forecast") AND (NOT ManualCorrection) THEN BEGIN
                        //"Correction Remaining Amount" := "Budget (Total)" - "Actual Cost" -
                        //                                 "Calc. Remaining Amount" - "Project Result Forecast";
                        "Correction Remaining Amount" :=
                          IIF(("Actual Cost" < "Order Amount" + "Risc Coverage Amount")
                            AND NOT PurchaseOrderClosed,
                          ABS("Project Result Forecast") + Result,
                          ABS("Project Result Forecast") - "Actual Cost");
                        VALIDATE("Calc. Project Result Forecast", "Project Result Forecast");
                        VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                      END ELSE
                        VALIDATE("Calc. Project Result Forecast",
                          IIF(("Actual Cost" < "Order Amount" + "Risc Coverage Amount")
                            AND NOT PurchaseOrderClosed,
                          "Budget (Total)" - ABS(Result) - "Correction Remaining Amount",
                          "Budget (Total)" - "Actual Cost" - "Remaining Amount"));
                    END;
                  END;
                END;
              //endcase
            END;
          END;
        "Line Type"::"Labor Costs":
          BEGIN
            CASE "Record Progress" OF
              TRUE:
                BEGIN
                  CASE JobsSetup."Res. Forecast Labor (Progress)" OF
                    JobsSetup."Res. Forecast Labor (Progress)"::"Add Current Difference":
                      BEGIN
                        VALIDATE("Calc. Project Result Forecast",
                          "Budget (Total)" - ("Budget (Total)" + ("Actual Cost" - "Allowed Costs")));
                      END;
                    JobsSetup."Res. Forecast Labor (Progress)"::"Linear Difference (Amounts)":
                      BEGIN
                        "Forecast Qty." := SafeDivision("Actual Hours", "Allowed Hours") * "Budget Hours (Total)";
                        VALIDATE("Calc. Project Result Forecast",
                          IIF(
                            ("Allowed Hours" = 0) OR ("Actual Hours" = 0),
                            "Budget (Total)" - ("Budget (Total)" + ("Actual Cost" - "Allowed Costs")),
                            "Budget (Total)" - (("Forecast Qty." - "Actual Hours") * CalcAvgBudgetRate + "Actual Cost")));
                      END;
                    JobsSetup."Res. Forecast Labor (Progress)"::"Linear Difference (Hours)":
                      BEGIN
                        "Forecast Qty." :=
                          IIF(
                            ("Allowed Hours" = 0) AND ("Actual Hours" <> 0),
                            "Budget Hours (Total)" + ("Actual Hours" - "Allowed Hours"),
                            SafeDivision("Actual Hours", "Allowed Hours") * "Budget Hours (Total)");
                        CASE TRUE OF
                          ("Allowed Hours" <> 0) AND ("Actual Hours" <> 0):
                            VALIDATE("Calc. Project Result Forecast",
                              "Budget (Total)" - ((("Forecast Qty." - "Actual Hours") *
                              SafeDivision("Actual Cost", "Actual Hours")) + "Actual Cost"));
                          ("Allowed Hours" = 0) AND ("Actual Hours" <> 0):
                            VALIDATE("Calc. Project Result Forecast",
                              "Budget (Total)" - ((("Forecast Qty." - "Actual Hours") *
                              SafeDivision("Actual Cost", "Actual Hours")) + "Actual Cost"));
                        ELSE
                          VALIDATE("Calc. Project Result Forecast",
                            "Budget (Total)" - ("Budget (Total)" + ("Actual Cost" - "Allowed Costs")));
                        END;
                      END;
                  END;
                  VALIDATE("Calc. Remaining Amount", "Budget (Total)" - "Actual Cost" - "Project Result Forecast");
                END;
              FALSE:
                BEGIN
                  CASE JobsSetup."Res. Forecast Labor (No Prog.)" OF
                    JobsSetup."Res. Forecast Labor (No Prog.)"::"Forecast equals Zero":
                      BEGIN
                        VALIDATE("Calc. Remaining Amount",
                          IIF(
                            "Actual Cost" < "Budget (Total)",
                            "Budget (Total)" - "Actual Cost",  0));
                        IF ("Fix Project Result Forecast") THEN BEGIN
                          "Correction Remaining Amount" := "Budget (Total)" - "Actual Cost" -
                                                           "Calc. Remaining Amount" - "Project Result Forecast";
                          VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                        END;
                        VALIDATE("Calc. Project Result Forecast",
                          IIF(
                            ("Actual Hours" > "Budget Hours (Total)") OR (("Actual Cost" + "Remaining Amount") > "Budget (Total)") ,
                               "Budget (Total)" - "Remaining Amount" - "Actual Cost", 0));
                      END;
                    JobsSetup."Res. Forecast Labor (No Prog.)"::"Current Difference":
                      BEGIN
                        VALIDATE("Calc. Remaining Amount",
                          IIF(
                            "Budget Hours (Total)" > "Actual Hours",
                            ("Budget Hours (Total)" - "Actual Hours") * CalcAvgBudgetRate, 0));
                        VALIDATE("Calc. Project Result Forecast",  "Budget (Total)" - "Remaining Amount" - "Actual Cost");
                        IF ("Fix Project Result Forecast") AND (NOT ManualCorrection) THEN BEGIN
                          "Correction Remaining Amount" := "Budget (Total)" - "Actual Cost" -
                                                           "Calc. Remaining Amount" - "Project Result Forecast";
                          VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                        END;
                        VALIDATE("Calc. Project Result Forecast",  "Budget (Total)" - "Remaining Amount" - "Actual Cost");
                      END;
                    JobsSetup."Res. Forecast Labor (No Prog.)"::"Linear Difference":
                      BEGIN
                        VALIDATE("Calc. Remaining Amount",
                          IIF(
                            "Budget Hours (Total)" > "Actual Hours",
                            ("Budget Hours (Total)" - "Actual Hours") * SafeDivision("Actual Cost", "Actual Hours"), 0));
                        IF ("Fix Project Result Forecast") THEN BEGIN
                          "Correction Remaining Amount" := "Budget (Total)" - "Actual Cost" -
                                                           "Calc. Remaining Amount" - "Project Result Forecast";
                          VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                        END;
                        VALIDATE("Calc. Project Result Forecast",  "Budget (Total)" - "Remaining Amount" - "Actual Cost");
                      END;
                  END;
                END;
            END;
            IF (NOT "Fix Hour Rate") THEN
              IF ("Actual Hours" = 0) THEN
                "Avg. Hour Rate" := "Budgetted Rate"
              ELSE
                "Avg. Hour Rate" := SafeDivision("Actual Cost", "Actual Hours");
          END;
        "Line Type"::"Plant Costs":
          BEGIN
            CASE "Record Progress" OF
              TRUE:
                BEGIN
                  CASE JobsSetup."Res. Forecast Labor (Progress)" OF
                    JobsSetup."Res. Forecast Labor (Progress)"::"Add Current Difference":
                      BEGIN
                        VALIDATE("Calc. Project Result Forecast",
                            "Budget (Total)" - ("Budget (Total)" + ("Actual Cost" - "Allowed Costs")));
                        VALIDATE("Calc. Remaining Amount", "Budget (Total)" - "Actual Cost" - "Project Result Forecast");
                      END;
                    JobsSetup."Res. Forecast Labor (Progress)"::"Linear Difference (Amounts)",
                    JobsSetup."Res. Forecast Labor (Progress)"::"Linear Difference (Hours)":
                      BEGIN
                        VALIDATE("Calc. Project Result Forecast",
                          IIF(
                            "Allowed Costs" = 0,
                            "Budget (Total)" - ("Budget (Total)" + ("Actual Cost" - "Allowed Costs")),
                            (SafeDivision("Budget (Total)","Allowed Costs")) * ("Allowed Costs" - "Actual Cost")));
                        VALIDATE("Calc. Remaining Amount", "Budget (Total)" - "Actual Cost" - "Project Result Forecast");
                      END;
                  END;
                END;
              FALSE:
                BEGIN
                  VALIDATE("Calc. Remaining Amount",
                    IIF(
                      "Actual Cost" < "Budget (Total)",
                      "Budget (Total)" - "Actual Cost", 0));
                  CASE JobsSetup."Res. Forecast Labor (No Prog.)" OF
                    JobsSetup."Res. Forecast Labor (No Prog.)"::"Forecast equals Zero":
                      BEGIN
                        IF ("Fix Project Result Forecast") AND (NOT ManualCorrection) THEN BEGIN
                          "Correction Remaining Amount" := "Budget (Total)" - "Actual Cost" -
                                                           "Calc. Remaining Amount" - "Project Result Forecast";
                          VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                        END;
                        VALIDATE("Calc. Project Result Forecast",
                          IIF(
                            ("Actual Cost" + "Remaining Amount") > "Budget (Total)",
                            "Budget (Total)" - "Actual Cost" - "Remaining Amount",
                            0));
                      END;
                    JobsSetup."Res. Forecast Labor (No Prog.)"::"Current Difference",
                    JobsSetup."Res. Forecast Labor (No Prog.)"::"Linear Difference":
                      BEGIN
                        IF ("Fix Project Result Forecast") AND (NOT ManualCorrection) THEN BEGIN
                          "Correction Remaining Amount" := "Budget (Total)" - "Actual Cost" -
                                                           "Calc. Remaining Amount" - "Project Result Forecast";
                          VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                        END;
                        VALIDATE("Calc. Project Result Forecast", "Budget (Total)" - "Actual Cost" - "Remaining Amount");
                      END;
                  END;
                END;
            END;
          END;
        "Line Type"::"Miscellaneous Costs":
          BEGIN
            CASE "Record Progress" OF
              TRUE:
                BEGIN
                  //progress will never occur
                END;
              FALSE:
                BEGIN
                  VALIDATE("Calc. Remaining Amount",
                    IIF("Actual Cost" < "Budget (Total)",
                      "Budget (Total)" - "Actual Cost", 0));
                  IF ("Fix Project Result Forecast") AND (NOT ManualCorrection) THEN BEGIN
                    "Correction Remaining Amount" := "Budget (Total)" - "Actual Cost" -
                                                     "Calc. Remaining Amount" - "Project Result Forecast";
                    VALIDATE("Calc. Remaining Amount"); //recalc "Remaining Amount"
                  END;
                  VALIDATE("Calc. Project Result Forecast",
                    "Budget (Total)" - "Actual Cost" - "Remaining Amount");
                END;
            END;
          END;
      END;
    END;

    PROCEDURE CalcAvgBudgetRate@1100528700() : Decimal;
    BEGIN
      IF "Budget Hours (Total)" <> 0 THEN
        EXIT("Budget (Total)" / "Budget Hours (Total)");
      EXIT(0);
    END;

    PROCEDURE PurchaseBudgetCostComp@1100528701() : Decimal;
    BEGIN
      CASE "Line Type" OF
        "Line Type"::"Purchase Actions":
          BEGIN
            CALCFIELDS("Purchase Budget (Cost Comp.)");
            EXIT("Purchase Budget (Cost Comp.)");
          END;
      END;
      EXIT(0);
    END;

    PROCEDURE ActualCostsCostComp@1100528704() : Decimal;
    BEGIN
      CASE "Line Type" OF
        "Line Type"::"Purchase Actions":
          BEGIN
            CALCFIELDS("Act. Cost Purch. (Cost Comp.)");
            EXIT("Act. Cost Purch. (Cost Comp.)");
          END;
        "Line Type"::"Labor Costs":
          BEGIN
            CALCFIELDS("Actual Cost Labor (Cost Comp.)");
            EXIT("Actual Cost Labor (Cost Comp.)");
          END;
        "Line Type"::"Miscellaneous Costs":
          BEGIN
            CALCFIELDS("Actual Cost Misc. (Cost Comp.)");
            EXIT("Actual Cost Misc. (Cost Comp.)");
          END;
        "Line Type"::"Plant Costs":
          BEGIN
            CALCFIELDS("Actual Cost Plant (Cost Comp.)");
            EXIT("Actual Cost Plant (Cost Comp.)");
          END;
      END;
      EXIT(0);
    END;

    PROCEDURE BudgetCostComp@1100528705() : Decimal;
    BEGIN
      CASE "Line Type" OF
        "Line Type"::"Purchase Actions":
          BEGIN
            CALCFIELDS("Purchase Budget (Cost Comp.)");
            EXIT("Purchase Budget (Cost Comp.)");
          END;
        "Line Type"::"Labor Costs":
          BEGIN
            CALCFIELDS("Total Budg. Labor (Cost Comp.)");
            EXIT("Total Budg. Labor (Cost Comp.)");
          END;
        "Line Type"::"Miscellaneous Costs":
          BEGIN
            CALCFIELDS("Total Budg. Misc. (Cost Comp.)");
            EXIT("Total Budg. Misc. (Cost Comp.)");
          END;
        "Line Type"::"Plant Costs":
          BEGIN
            CALCFIELDS("Total Budg. Plant (Cost Comp.)");
            EXIT("Total Budg. Plant (Cost Comp.)");
          END;
      END;
      EXIT(0);
    END;

    LOCAL PROCEDURE IIF@1100528703(Condition@1100528700 : Boolean;ValueIfTrue@1100528701 : Decimal;ValueIfFalse@1100528702 : Decimal) : Decimal;
    BEGIN
      IF Condition THEN
        EXIT(ValueIfTrue);
      EXIT(ValueIfFalse);
    END;

    PROCEDURE MAX@1100528717(Value1@1100528700 : Decimal;Value2@1100528701 : Decimal) : Decimal;
    BEGIN
      IF Value1 > Value2 THEN
        EXIT(Value1);
      EXIT(Value2);
    END;

    PROCEDURE SafeDivision@1100528706(Numerator@1100528700 : Decimal;Denominator@1100528701 : Decimal) : Decimal;
    BEGIN
      IF Denominator = 0 THEN
        EXIT(0);
      EXIT(Numerator / Denominator);
    END;

    PROCEDURE GetCostObjectDescription@1210190000() : Text[50];
    VAR
      ProjectCostObject@1210190000 : Record 11012065;
      DimensionValue@1210190001 : Record 349;
      GeneralLedgerSetup@1210190002 : Record 98;
    BEGIN
      IF ProjectCostObject.GET("Project No.", Code) THEN
        EXIT(ProjectCostObject.Name);

      GeneralLedgerSetup.GET;
      IF DimensionValue.GET(GeneralLedgerSetup."Global Dimension 2 Code", Code) THEN
        EXIT(DimensionValue.Name);
      EXIT('');
    END;

    PROCEDURE PurchaseOrderClosed@1210190001() : Boolean;
    VAR
      PurchaseLine@1210190000 : Record 39;
      PurchaseHeader@1210190001 : Record 38;
    BEGIN
      IF "Line Type" <> "Line Type"::"Purchase Actions" THEN
        EXIT(FALSE);
      PurchaseLine.SETCURRENTKEY("Document Type","Job No.","Cost Type","Order Date","Purchase Action");
      PurchaseLine.SETRANGE("Document Type", PurchaseLine."Document Type"::Order);
      PurchaseLine.SETRANGE("Job No.", "Project No.");
      PurchaseLine.SETRANGE("Purchase Action", Code);
      PurchaseLine.SETRANGE("Order Date", 0D, Date);
      IF PurchaseLine.FINDFIRST THEN BEGIN
        PurchaseHeader.GET(PurchaseLine."Document Type", PurchaseLine."Document No.");
        IF (PurchaseHeader."Last Date Modified" <= Date) AND
           (PurchaseHeader.Status = PurchaseHeader.Status::Closed)
        THEN
          EXIT(TRUE);
      END;
      EXIT(FALSE);
    END;

    LOCAL PROCEDURE FillCostGroupCode@1100528401();
    VAR
      ProjectPurchaseAction@1100528400 : Record 11012026;
      CostObjectsByCostGroup@1100528402 : Record 11126039;
      CostObjectCode@1100528401 : Code[20];
    BEGIN
      IF Summary THEN
        EXIT;

      IF "Line Type" = "Line Type"::"Purchase Actions" THEN BEGIN
        ProjectPurchaseAction.GET("Project No.", Code);
        CostObjectCode := ProjectPurchaseAction."Default Cost Object Purchase";
      END ELSE
        CostObjectCode := Code;

      CostObjectsByCostGroup.SETCURRENTKEY("Cost Object Code");
      CostObjectsByCostGroup.SETRANGE("Cost Object Code", CostObjectCode);
      CostObjectsByCostGroup.FINDFIRST;
      "Cost Group Code" :=  CostObjectsByCostGroup."Cost Group Code";
    END;

    PROCEDURE CorrectionFieldsAreEditable@1100528300() : Boolean;
    VAR
      CostGroup@1100528300 : Record 11126038;
    BEGIN
      IF (Summary) THEN
        EXIT(TRUE);

      TESTFIELD("Cost Group Code");

      CostGroup.GET("Cost Group Code");
      IF (CostGroup."Estimate Result") THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE MorePOsPresentForPurchAction@1210190007() : Boolean;
    VAR
      PurchaseLine@1210190000 : Record 39;
      PrevDocumentNo@1210190001 : Code[20];
    BEGIN
      PurchaseLine.SETRANGE("Document Type", PurchaseLine."Document Type"::Order);
      PurchaseLine.SETRANGE("Job No.", "Project No.");
      PurchaseLine.SETRANGE("Purchase Action", Code);
      PurchaseLine.SETFILTER("Order Date", '..%1', Date);
      IF (NOT PurchaseLine.FINDSET) THEN
        EXIT(FALSE);

      REPEAT
        IF (PrevDocumentNo <> '') AND (PrevDocumentNo <> PurchaseLine."Document No.") THEN
          EXIT(TRUE);
        PrevDocumentNo := PurchaseLine."Document No."
      UNTIL (PurchaseLine.NEXT = 0);

      EXIT(FALSE);
    END;

    PROCEDURE GetTotalRevenueOfProjDate@1210190002(ProjNo@1210190000 : Code[20];Date@1210190001 : Date;FieldNo@1210190002 : Integer) Total : Decimal;
    VAR
      ProjForecastLine@1210190003 : Record 11126037;
    BEGIN
      //*Rev.n
      IF (ProjNo = '') OR (Date = 0D) THEN
        EXIT;

      ProjForecastLine.SETRANGE("Project No.", ProjNo);
      ProjForecastLine.SETRANGE(Date, Date);
      ProjForecastLine.SETRANGE("Line Type", ProjForecastLine."Line Type"::Revenues);
      ProjForecastLine.SETRANGE(Summary, FALSE);
      IF NOT ProjForecastLine.FINDSET THEN
        EXIT;
      REPEAT
        CASE FieldNo OF
          ProjForecastLine.FIELDNO("Budget Revenues"):
            Total := Total + ProjForecastLine."Budget Revenues";
          ProjForecastLine.FIELDNO("Actual Revenues"):
            Total := Total + ProjForecastLine."Actual Revenues";
        END;
      UNTIL ProjForecastLine.NEXT = 0;
    END;

    PROCEDURE TestFixed@1100409000();
    VAR
      ProjectResultForecast@1100409000 : Record 11126036;
    BEGIN
      //kzwerver, 130104, n, #C001457
      ProjectResultForecast.GET("Project No.", Date);
      ProjectResultForecast.TESTFIELD(Fixed, FALSE);
    END;

    PROCEDURE FillInAgvHourRateCalculation@1100409001();
    VAR
      AvgHourRateCalculation@1100409000 : Record 11126040;
    BEGIN
      //kzwerver, 130104, n, #C002661
      "In Avg Hour Rate Calculation" := FALSE;

      IF ("Line Type" = "Line Type"::"Labor Costs") AND
         (AvgHourRateCalculation.GET(Code)) AND
         (AvgHourRateCalculation."In Avg Hour Rate Calculation")
      THEN
        "In Avg Hour Rate Calculation" := TRUE;
    END;

    BEGIN
    END.
  }
}

