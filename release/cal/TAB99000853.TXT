OBJECT Table 99000853 Inventory Profile
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.04,4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Lagerprofil;
               ENU=Inventory Profile;
               NLD=Voorraadprofiel;
               NOR=Beholdningsprofil;
               SVE=Lagerprofil];
  }
  FIELDS
  {
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[DEU=Zeilennr.;
                                                              ENU=Line No.;
                                                              NLD=Regelnr.;
                                                              NOR=Linjenr.;
                                                              SVE=Radnr] }
    { 4   ;   ;Attribute Priority  ;Integer       ;CaptionML=[DEU=AttributprioritÑt;
                                                              ENU=Attribute Priority;
                                                              NLD=Attribuutprioriteit;
                                                              NOR=Attributtprioritet;
                                                              SVE=Attributprioritet] }
    { 5   ;   ;Order Priority      ;Integer       ;CaptionML=[DEU=AuftragsprioritÑt;
                                                              ENU=Order Priority;
                                                              NLD=Orderprioriteit;
                                                              NOR=Bestillingsprioritet;
                                                              SVE=Orderprioritet] }
    { 11  ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   CaptionML=[DEU=Artikelnr.;
                                                              ENU=Item No.;
                                                              NLD=Artikelnr.;
                                                              NOR=Varenr.;
                                                              SVE=Artikelnr] }
    { 12  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.),
                                                                                            Code=FIELD(Variant Code));
                                                   CaptionML=[DEU=Variantencode;
                                                              ENU=Variant Code;
                                                              NLD=Variant;
                                                              NOR=Variantkode;
                                                              SVE=Variantkod] }
    { 13  ;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   CaptionML=[DEU=Lagerortcode;
                                                              ENU=Location Code;
                                                              NLD=Vestiging;
                                                              NOR=Lokasjonskode;
                                                              SVE=LagerstÑllekod] }
    { 14  ;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   CaptionML=[DEU=Lagerplatzcode;
                                                              ENU=Bin Code;
                                                              NLD=Opslaglocatie;
                                                              NOR=Hyllekode;
                                                              SVE=Lagerplatskod] }
    { 15  ;   ;IsSupply            ;Boolean       ;CaptionML=[DEU=Ist-Vorrat;
                                                              ENU=IsSupply;
                                                              NLD=IsSupply;
                                                              NOR=IsSupply;
                                                              SVE=ér tillgÜng] }
    { 16  ;   ;Order Relation      ;Option        ;CaptionML=[DEU=Auftragsverbindung;
                                                              ENU=Order Relation;
                                                              NLD=Orderrelatie;
                                                              NOR=Bestillingsrelasjon;
                                                              SVE=Orderrelation];
                                                   OptionCaptionML=[DEU=Normal,Sicherheitsbestand,Minimalbestand;
                                                                    ENU=Normal,Safety Stock,Reorder Point;
                                                                    NLD=Normaal,Veiligheidsvoorraad,Bestelpunt;
                                                                    NOR=Normal,Sikkerhetslager,Gjenbestillingspunkt;
                                                                    SVE=Normal,SÑkerhetslager,BestÑllningspunkt];
                                                   OptionString=Normal,Safety Stock,Reorder Point }
    { 21  ;   ;Source Type         ;Integer       ;CaptionML=[DEU=Herkunftsart;
                                                              ENU=Source Type;
                                                              NLD=Bronsoort;
                                                              NOR=Kildetype;
                                                              SVE=Ursprungstyp] }
    { 22  ;   ;Source Order Status ;Integer       ;CaptionML=[DEU=Herkunftsstatus;
                                                              ENU=Source Order Status;
                                                              NLD=Bronorderstatus;
                                                              NOR=Kildeordrestatus;
                                                              SVE=KÑllorderstatus] }
    { 23  ;   ;Source ID           ;Code20        ;CaptionML=[DEU=Herkunfts-ID;
                                                              ENU=Source ID;
                                                              NLD=Voor id;
                                                              NOR=Kilde-ID;
                                                              SVE=Ursprungs-ID] }
    { 24  ;   ;Source Batch Name   ;Code10        ;CaptionML=[DEU=Herkunftsbuch.-Blattname;
                                                              ENU=Source Batch Name;
                                                              NLD=Voor batch;
                                                              NOR=Navn pÜ kildebunke;
                                                              SVE=Ursprungsjnlnamn] }
    { 25  ;   ;Source Ref. No.     ;Integer       ;CaptionML=[DEU=Herkunftsref.-Nr.;
                                                              ENU=Source Ref. No.;
                                                              NLD=Bronreferentienr.;
                                                              NOR=Kilderef.nr.;
                                                              SVE=Ursprungsref.nr] }
    { 26  ;   ;Source Prod. Order Line;Integer    ;CaptionML=[DEU=Herkunfts-FA-Zeile;
                                                              ENU=Source Prod. Order Line;
                                                              NLD=Bronprod.-orderregel;
                                                              NOR=Kildeprod.ordrelinje;
                                                              SVE=Ursprungsprod.orderrad] }
    { 27  ;   ;Primary Order Status;Integer       ;CaptionML=[DEU=Urspr. Auftragsstatus;
                                                              ENU=Primary Order Status;
                                                              NLD=Primaire orderstatus;
                                                              NOR=Opprinnelig ordrestatus;
                                                              SVE=PrimÑr orderstatus] }
    { 28  ;   ;Primary Order No.   ;Code20        ;CaptionML=[DEU=Urspr. Auftragsnr.;
                                                              ENU=Primary Order No.;
                                                              NLD=Primaire ordernr.;
                                                              NOR=Opprinnelig ordrenr.;
                                                              SVE=PrimÑr ordernr] }
    { 29  ;   ;Primary Order Line  ;Integer       ;CaptionML=[DEU=Urspr. Auftragszeile;
                                                              ENU=Primary Order Line;
                                                              NLD=Primaire orderregel;
                                                              NOR=Opprinnelig ordrelinje;
                                                              SVE=PrimÑr orderrad] }
    { 30  ;   ;Primary Order Type  ;Integer       ;CaptionML=[DEU=Urspr. Auftragsart;
                                                              ENU=Primary Order Type;
                                                              NLD=Primaire ordersoort;
                                                              NOR=Opprinnelig ordretype;
                                                              SVE=PrimÑrordertyp] }
    { 31  ;   ;Original Quantity   ;Decimal       ;CaptionML=[DEU=Urspr. Menge;
                                                              ENU=Original Quantity;
                                                              NLD=Oorspr. aantal;
                                                              NOR=Opprinnelig antall;
                                                              SVE=Ursprungligt antal];
                                                   DecimalPlaces=0:5 }
    { 32  ;   ;Remaining Quantity (Base);Decimal  ;CaptionML=[DEU=Restmenge (Basis);
                                                              ENU=Remaining Quantity (Base);
                                                              NLD=Resterend aantal (Basis);
                                                              NOR=Restantall (l.enh.);
                                                              SVE=èterstÜende antal (bas)];
                                                   DecimalPlaces=0:5 }
    { 33  ;   ;Untracked Quantity  ;Decimal       ;CaptionML=[DEU=Menge ohne Bedarfsverursacher;
                                                              ENU=Untracked Quantity;
                                                              NLD=Niet getraceerd aantal;
                                                              NOR=Ikke-sporet antall;
                                                              SVE=Antal, inte spÜrade];
                                                   DecimalPlaces=0:5 }
    { 34  ;   ;Original Due Date   ;Date          ;CaptionML=[DEU=Urspr. FÑlligkeitsdatum;
                                                              ENU=Original Due Date;
                                                              NLD=Oorspr. vervaldatum;
                                                              NOR=Opprinnelig forfallsdato;
                                                              SVE=Ursprungligt fîrfallodatum] }
    { 35  ;   ;Due Date            ;Date          ;CaptionML=[DEU=FÑlligkeitsdatum;
                                                              ENU=Due Date;
                                                              NLD=Vervaldatum;
                                                              NOR=Forfallsdato;
                                                              SVE=Fîrfallodatum] }
    { 36  ;   ;Planning Flexibility;Option        ;CaptionML=[DEU=PlanungsflexibilitÑt;
                                                              ENU=Planning Flexibility;
                                                              NLD=Planningsflexibiliteit;
                                                              NOR=Planleggingsfleksibilitet;
                                                              SVE=Planeringsflexibilitet];
                                                   OptionCaptionML=[DEU=UnbeschrÑnkt,Keine,Nur reduzieren;
                                                                    ENU=Unlimited,None,Reduce Only;
                                                                    NLD=Onbeperkt,Geen,Alleen reduceren;
                                                                    NOR=Ubegrenset,Ingen,Bare redusert;
                                                                    SVE=ObegrÑnsad,Ingen,Reducera enbart];
                                                   OptionString=Unlimited,None,Reduce Only }
    { 37  ;   ;Fixed Date          ;Date          ;CaptionML=[DEU=Festes Datum;
                                                              ENU=Fixed Date;
                                                              NLD=Vaste datum;
                                                              NOR=Fastsatt dato;
                                                              SVE=Fast datum] }
    { 38  ;   ;Action Message      ;Option        ;CaptionML=[DEU=Ereignismeldung;
                                                              ENU=Action Message;
                                                              NLD=Planningsboodschap;
                                                              NOR=Handlingsmelding;
                                                              SVE=ètgÑrdsmeddelande];
                                                   OptionCaptionML=[DEU=" ,Neu,Menge Ñndern,Neu berechnen,Neu berechnen & Menge Ñndern,Stornieren";
                                                                    ENU=" ,New,Change Qty.,Reschedule,Resched.& Chg. Qty.,Cancel";
                                                                    NLD=" ,Nieuw,Aantal wijzigen,Herplannen,Herplannen en aantal wijzigen,Annuleren";
                                                                    NOR=" ,Ny,Endre ant.,Tidsplanlegg pÜ nytt,Tidsplan. pÜ nytt og endre ant.,Avbryt";
                                                                    SVE=" ,Nytt,éndrat antal,Omplanera,Planera & Ñndra antal,Avbryt"];
                                                   OptionString=[ ,New,Change Qty.,Reschedule,Resched.& Chg. Qty.,Cancel] }
    { 39  ;   ;Binding             ;Option        ;CaptionML=[DEU=VerknÅpfung;
                                                              ENU=Binding;
                                                              NLD=Binding;
                                                              NOR=Bundet til;
                                                              SVE=Bindning];
                                                   OptionCaptionML=[DEU=" ,Eins-zu-Eins";
                                                                    ENU=" ,Order-to-Order";
                                                                    NLD=" ,Order-op-order";
                                                                    NOR=" ,Ordre-til-ordre";
                                                                    SVE=" ,Order-till-Order"];
                                                   OptionString=[ ,Order-to-Order];
                                                   Editable=No }
    { 40  ;   ;Quantity (Base)     ;Decimal       ;CaptionML=[DEU=Menge (Basis);
                                                              ENU=Quantity (Base);
                                                              NLD=Aantal (Basis);
                                                              NOR=Antall (lagerenhet);
                                                              SVE=Antal (bas)];
                                                   DecimalPlaces=0:5 }
    { 41  ;   ;Min. Quantity       ;Decimal       ;CaptionML=[DEU=Min. Menge;
                                                              ENU=Min. Quantity;
                                                              NLD=Min. aantal;
                                                              NOR=Min.antall;
                                                              SVE=Min. antal];
                                                   DecimalPlaces=0:5 }
    { 42  ;   ;Starting Date       ;Date          ;CaptionML=[DEU=Startdatum;
                                                              ENU=Starting Date;
                                                              NLD=Begindatum;
                                                              NOR=Startdato;
                                                              SVE=Startdatum] }
    { 43  ;   ;Planning Line No.   ;Integer       ;CaptionML=[DEU=Planungszeilennr.;
                                                              ENU=Planning Line No.;
                                                              NLD=Planningsregelnr.;
                                                              NOR=Planl.linjenr.;
                                                              SVE=Planeringsradnr] }
    { 44  ;   ;Unit of Measure Code;Code10        ;CaptionML=[DEU=Einheitencode;
                                                              ENU=Unit of Measure Code;
                                                              NLD=Eenheidscode;
                                                              NOR=Enhetskode;
                                                              SVE=Enhetskod] }
    { 45  ;   ;Qty. per Unit of Measure;Decimal   ;CaptionML=[DEU=Menge pro Einheit;
                                                              ENU=Qty. per Unit of Measure;
                                                              NLD=Aantal per eenheid;
                                                              NOR=Antall per enhet;
                                                              SVE=Antal per enhet];
                                                   DecimalPlaces=0:5 }
    { 46  ;   ;Quantity            ;Decimal       ;CaptionML=[DEU=Menge;
                                                              ENU=Quantity;
                                                              NLD=Aantal;
                                                              NOR=Antall;
                                                              SVE=Antal];
                                                   DecimalPlaces=0:5 }
    { 47  ;   ;Remaining Quantity  ;Decimal       ;CaptionML=[DEU=Restmenge;
                                                              ENU=Remaining Quantity;
                                                              NLD=Resterend aantal;
                                                              NOR=Restantall;
                                                              SVE=èterstÜende antal];
                                                   DecimalPlaces=0:5 }
    { 48  ;   ;Finished Quantity   ;Decimal       ;CaptionML=[DEU=Fertig gestellte Menge;
                                                              ENU=Finished Quantity;
                                                              NLD=Gereed aantal;
                                                              NOR=Ferdig antall;
                                                              SVE=FÑrdigt antal];
                                                   DecimalPlaces=0:5 }
    { 50  ;   ;Planning Level Code ;Integer       ;CaptionML=[DEU=Planungsebenennr.;
                                                              ENU=Planning Level Code;
                                                              NLD=Planningsniveau;
                                                              NOR=Planl.nivÜ - kode;
                                                              SVE=PlaneringsnivÜkod];
                                                   Editable=No }
    { 51  ;   ;Planning Line Phase ;Option        ;CaptionML=[DEU=Planungszeilenzustand;
                                                              ENU=Planning Line Phase;
                                                              NLD=Planningsregelfase;
                                                              NOR=Planl.linjefase;
                                                              SVE=Planeringsrad fas];
                                                   OptionCaptionML=[DEU=" ,Zeile erstellt,Arbeitsplan erstellt,Aufgelîst";
                                                                    ENU=" ,Line Created,Routing Created,Exploded";
                                                                    NLD=" ,Regel gemaakt,Bewerkingsplan gemaakt,Weergegeven";
                                                                    NOR=" ,Linje opprettet,Rute opprettet,Utfoldet";
                                                                    SVE=" ,Rad skapad,Oper.fîljd skapad,Expanderad"];
                                                   OptionString=[ ,Line Created,Routing Created,Exploded] }
    { 52  ;   ;Due Time            ;Time          ;CaptionML=[DEU=FÑlligkeitszeit;
                                                              ENU=Due Time;
                                                              NLD=Vervaltijd;
                                                              NOR=Forfallstidsp.;
                                                              SVE=FÑrdigtid] }
    { 53  ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[DEU=Verk. an Deb.-Nr.;
                                                              ENU=Sell-to Customer No.;
                                                              NLD=Orderklantnr.;
                                                              NOR=Salg til-kundenr.;
                                                              SVE=Fîrs.kundnr] }
    { 54  ;   ;Drop Shipment       ;Boolean       ;AccessByPermission=TableData 223=R;
                                                   CaptionML=[DEU=Direktlieferung;
                                                              ENU=Drop Shipment;
                                                              NLD=Doorverzending;
                                                              NOR=Direkte levering;
                                                              SVE=Direktutleverans] }
    { 55  ;   ;Special Order       ;Boolean       ;CaptionML=[DEU=Spezialauftrag;
                                                              ENU=Special Order;
                                                              NLD=Speciale order;
                                                              NOR=Spesialbestilling;
                                                              SVE=Specialorder] }
    { 56  ;   ;Ref. Order No.      ;Code20        ;CaptionML=[DEU=Ref.-Nr.;
                                                              ENU=Ref. Order No.;
                                                              NLD=Ref.-ordernr.;
                                                              NOR=Ref.ordrenr.;
                                                              SVE=Ref. ordernr];
                                                   Editable=No }
    { 57  ;   ;Ref. Line No.       ;Integer       ;CaptionML=[DEU=Ref. Zeilennr.;
                                                              ENU=Ref. Line No.;
                                                              NLD=Ref.-regelnr.;
                                                              NOR=Ref.linjenr.;
                                                              SVE=Ref.radnr];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 58  ;   ;Derived from Blanket Order;Boolean ;CaptionML=[DEU=öbern. von Rahmenauftr./-best.;
                                                              ENU=Derived from Blanket Order;
                                                              NLD=Afkomstig van raamcontract;
                                                              NOR=Stammer fra rammeordre;
                                                              SVE=HÑmtad frÜn avropsorder] }
    { 59  ;   ;Ref. Blanket Order No.;Code20      ;CaptionML=[DEU=Ref. Rahmenauftr.-/-bestellnr.;
                                                              ENU=Ref. Blanket Order No.;
                                                              NLD=Ref.-raamcontractnr.;
                                                              NOR=Ref.rammeordrenr.;
                                                              SVE=Ref. avropsordernr] }
    { 60  ;   ;Tracking Reference  ;Integer       ;CaptionML=[DEU=Verfolgungsreferenz;
                                                              ENU=Tracking Reference;
                                                              NLD=Traceringsreferentie;
                                                              NOR=Sporingsreferanse;
                                                              SVE=SpÜrningsreferens] }
    { 61  ;   ;Lot No.             ;Code50        ;CaptionML=[DEU=Chargennr.;
                                                              ENU=Lot No.;
                                                              NLD=Lotnr.;
                                                              NOR=Partinr.;
                                                              SVE=Partinr] }
    { 62  ;   ;Serial No.          ;Code50        ;CaptionML=[DEU=Seriennr.;
                                                              ENU=Serial No.;
                                                              NLD=Serienummer;
                                                              NOR=Serienr.;
                                                              SVE=Serienr] }
    { 63  ;   ;Max. Quantity       ;Decimal       ;CaptionML=[DEU=Max. Menge;
                                                              ENU=Max. Quantity;
                                                              NLD=Max. aantal;
                                                              NOR=Maks. antall;
                                                              SVE=Max. antal];
                                                   DecimalPlaces=0:5 }
    { 64  ;   ;Safety Stock Quantity;Decimal      ;CaptionML=[DEU=Sicherheitsbestand;
                                                              ENU=Safety Stock Quantity;
                                                              NLD=Veiligheidsvoorraad;
                                                              NOR=Sikkerhetslagerantall;
                                                              SVE=SÑkerhetslager];
                                                   DecimalPlaces=0:5 }
    { 65  ;   ;Is Exception Order  ;Boolean       ;CaptionML=[DEU=Ist Ausnahmeauftrag;
                                                              ENU=Is Exception Order;
                                                              NLD=Is uitzondering-order;
                                                              NOR=Er unntaksordre;
                                                              SVE=ér undantagsorder] }
    { 66  ;   ;Transfer Location Not Planned;Boolean;
                                                   CaptionML=[DEU=Umlagerungsort nicht geplant;
                                                              ENU=Transfer Location Not Planned;
                                                              NLD=Transferlocatie niet gepland;
                                                              NOR=Overfõringslokasjon ikke planlagt;
                                                              SVE=ôverfîringslagerplats har inte planerats] }
    { 67  ;   ;Expiration Date     ;Date          ;CaptionML=[DEU=Ablaufdatum;
                                                              ENU=Expiration Date;
                                                              NLD=Verloopdatum;
                                                              NOR=UtgÜr den;
                                                              SVE=UtgÜngsdatum];
                                                   Editable=No }
    { 68  ;   ;Ref. Order Type     ;Option        ;CaptionML=[DEU=Ref. Auftragsart;
                                                              ENU=Ref. Order Type;
                                                              NLD=Ref.-ordersoort;
                                                              NOR=Ref.ordretype;
                                                              SVE=Ref. ordertyp];
                                                   OptionCaptionML=[DEU=" ,Einkauf,Fertigungsauftrag,Umlagerung,Montage";
                                                                    ENU=" ,Purchase,Prod. Order,Transfer,Assembly";
                                                                    NLD=" ,Inkoop,Prod.order,Transfer,Assemblage";
                                                                    NOR=" ,Kjõp,Prod.ordre,Overfõring,Montering";
                                                                    SVE=" ,Inkîp,Prod.order,ôverfîring,Montering"];
                                                   OptionString=[ ,Purchase,Prod. Order,Transfer,Assembly];
                                                   Editable=No }
    { 69  ;   ;Disallow Cancellation;Boolean      ;CaptionML=[DEU=Keine Stornierung zulassen;
                                                              ENU=Disallow Cancellation;
                                                              NLD=Annulering niet toestaan;
                                                              NOR=Ikke tillat annullering;
                                                              SVE=TillÜt inte annullering] }
    { 70  ;   ;MPS Order           ;Boolean       ;CaptionML=[DEU=Prod.-Programmplanungsauftrag;
                                                              ENU=MPS Order;
                                                              NLD=MPS-order;
                                                              NOR=MPS-ordre;
                                                              SVE=Prod.prog.order] }
  }
  KEYS
  {
    {    ;Line No.                                ;Clustered=Yes }
    {    ;Item No.,Variant Code,Location Code,Due Date,Attribute Priority,Order Priority }
    {    ;Item No.,Variant Code,Location Code,IsSupply,Primary Order Status,Primary Order No.,Due Date,Order Priority }
    {    ;Source Type,Source Order Status,Source ID,Source Batch Name,Source Ref. No.,Source Prod. Order Line,IsSupply,Due Date }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=Tab99000853, TransferNachBedVerursPosten: UngÅltige Herkunftsart: %1.;ENU=Tab99000853, TransferToTrackingEntry: Illegal Source Type: %1.;NLD=Tab99000853, TransferToTrackingEntry: Ongeldige bronsoort: %1.;NOR=Tab99000853, TransferToTrackingEntry: Ugyldig kildetype: %1.;SVE=Tab99000853, TransferToTrackingEntry: Illegal Source Type: %1.';
      UOMMgt@1001 : Codeunit 5402;

    [External]
    PROCEDURE TransferFromItemLedgerEntry@1(VAR ItemLedgerEntry@1000 : Record 32;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveItemLedgerEntry@1002 : Codeunit 99000841;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      "Source Type" := DATABASE::"Item Ledger Entry";
      "Source Ref. No." := ItemLedgerEntry."Entry No.";
      "Item No." := ItemLedgerEntry."Item No.";
      "Variant Code" := ItemLedgerEntry."Variant Code";
      "Location Code" := ItemLedgerEntry."Location Code";
      Quantity := ItemLedgerEntry.Quantity;
      "Remaining Quantity" := ItemLedgerEntry."Remaining Quantity";
      "Finished Quantity" := Quantity - "Remaining Quantity";
      "Quantity (Base)" := ItemLedgerEntry.Quantity;
      "Remaining Quantity (Base)" := ItemLedgerEntry."Remaining Quantity";
      ItemLedgerEntry.CALCFIELDS("Reserved Quantity");
      ReserveItemLedgerEntry.FilterReservFor(ReservEntry,ItemLedgerEntry);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" := ItemLedgerEntry."Remaining Quantity" - ItemLedgerEntry."Reserved Quantity" + AutoReservedQty;
      "Unit of Measure Code" := ItemLedgerEntry."Unit of Measure Code";
      "Qty. per Unit of Measure" := 1;
      IsSupply := ItemLedgerEntry.Positive;
      "Due Date" := ItemLedgerEntry."Posting Date";
      "Lot No." := ItemLedgerEntry."Lot No.";
      "Serial No." := ItemLedgerEntry."Serial No.";
      IF TrackingExists THEN
        "Tracking Reference" := "Line No.";
      "Planning Flexibility" := "Planning Flexibility"::None;

      OnAfterTransferFromItemLedgerEntry(Rec,ItemLedgerEntry);
    END;

    [External]
    PROCEDURE TransferFromSalesLine@2(VAR SalesLine@1000 : Record 37;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveSalesLine@1002 : Codeunit 99000832;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      SalesLine.TESTFIELD(Type,SalesLine.Type::Item);
      SetSource(DATABASE::"Sales Line",SalesLine."Document Type",SalesLine."Document No.",SalesLine."Line No.",'',0);
      "Item No." := SalesLine."No.";
      "Variant Code" := SalesLine."Variant Code";
      "Location Code" := SalesLine."Location Code";
      "Bin Code" := SalesLine."Bin Code";
      SalesLine.CALCFIELDS("Reserved Qty. (Base)");
      ReserveSalesLine.FilterReservFor(ReservEntry,SalesLine);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      IF SalesLine."Document Type" = SalesLine."Document Type"::"Return Order" THEN BEGIN
        SalesLine."Reserved Qty. (Base)" := -SalesLine."Reserved Qty. (Base)";
        AutoReservedQty := -AutoReservedQty;
      END;
      "Untracked Quantity" := SalesLine."Outstanding Qty. (Base)" - SalesLine."Reserved Qty. (Base)" + AutoReservedQty;
      Quantity := SalesLine.Quantity;
      "Remaining Quantity" := SalesLine."Outstanding Quantity";
      "Finished Quantity" := SalesLine."Quantity Shipped";
      "Quantity (Base)" := SalesLine."Quantity (Base)";
      "Remaining Quantity (Base)" := SalesLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := SalesLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := SalesLine."Qty. per Unit of Measure";
      IF SalesLine."Document Type" = SalesLine."Document Type"::"Return Order" THEN
        ChangeSign;
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := SalesLine."Shipment Date";
      "Planning Flexibility" := "Planning Flexibility"::None;
      IF SalesLine."Blanket Order No." <> '' THEN BEGIN
        "Sell-to Customer No." := SalesLine."Sell-to Customer No.";
        "Derived from Blanket Order" := TRUE;
        "Ref. Blanket Order No." := SalesLine."Blanket Order No.";
      END;
      "Drop Shipment" := SalesLine."Drop Shipment";
      "Special Order" := SalesLine."Special Order";

      OnAfterTransferFromSalesLine(Rec,SalesLine);
    END;

    [External]
    PROCEDURE TransferFromComponent@7(VAR ProdOrderComp@1000 : Record 5407;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveProdOrderComp@1002 : Codeunit 99000838;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      SetSource(
        DATABASE::"Prod. Order Component",ProdOrderComp.Status,ProdOrderComp."Prod. Order No.",
        ProdOrderComp."Line No.",'',ProdOrderComp."Prod. Order Line No.");
      "Ref. Order Type" := "Ref. Order Type"::"Prod. Order";
      "Ref. Order No." := ProdOrderComp."Prod. Order No.";
      "Ref. Line No." := ProdOrderComp."Prod. Order Line No.";
      "Item No." := ProdOrderComp."Item No.";
      "Variant Code" := ProdOrderComp."Variant Code";
      "Location Code" := ProdOrderComp."Location Code";
      "Bin Code" := ProdOrderComp."Bin Code";
      "Due Date" := ProdOrderComp."Due Date";
      "Due Time" := ProdOrderComp."Due Time";
      "Planning Flexibility" := "Planning Flexibility"::None;
      "Planning Level Code" := ProdOrderComp."Planning Level Code";
      ProdOrderComp.CALCFIELDS("Reserved Qty. (Base)");
      IF ProdOrderComp.Status IN [ProdOrderComp.Status::Released,ProdOrderComp.Status::Finished] THEN
        ProdOrderComp.CALCFIELDS("Act. Consumption (Qty)");
      ReserveProdOrderComp.FilterReservFor(ReservEntry,ProdOrderComp);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" := ProdOrderComp."Remaining Qty. (Base)" - ProdOrderComp."Reserved Qty. (Base)" + AutoReservedQty;
      Quantity := ProdOrderComp."Expected Quantity";
      "Remaining Quantity" := ProdOrderComp."Remaining Quantity";
      "Finished Quantity" := ProdOrderComp."Act. Consumption (Qty)";
      "Quantity (Base)" := ProdOrderComp."Expected Qty. (Base)";
      "Remaining Quantity (Base)" := ProdOrderComp."Remaining Qty. (Base)";
      "Unit of Measure Code" := ProdOrderComp."Unit of Measure Code";
      "Qty. per Unit of Measure" := ProdOrderComp."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;

      OnAfterTransferFromComponent(Rec,ProdOrderComp);
    END;

    [External]
    PROCEDURE TransferFromPlanComponent@8(VAR PlanningComponent@1000 : Record 99000829;VAR TrackingReservEntry@1008 : Record 337);
    VAR
      ProdOrderComp@1001 : Record 5407;
      AsmLine@1009 : Record 901;
      ReservEntry@1002 : Record 337;
      ReservePlanningComponent@1003 : Codeunit 99000840;
      ReserveProdOrderComp@1004 : Codeunit 99000838;
      AsmLineReserve@1007 : Codeunit 926;
      ReservedQty@1005 : Decimal;
      AutoReservedQty@1006 : Decimal;
    BEGIN
      SetSource(
        DATABASE::"Planning Component",0,PlanningComponent."Worksheet Template Name",PlanningComponent."Line No.",
        PlanningComponent."Worksheet Batch Name",PlanningComponent."Worksheet Line No.");
      "Ref. Order Type" := PlanningComponent."Ref. Order Type";
      "Ref. Order No." := PlanningComponent."Ref. Order No.";
      "Ref. Line No." := PlanningComponent."Ref. Order Line No.";
      "Item No." := PlanningComponent."Item No.";
      "Variant Code" := PlanningComponent."Variant Code";
      "Location Code" := PlanningComponent."Location Code";
      "Bin Code" := PlanningComponent."Bin Code";
      "Due Date" := PlanningComponent."Due Date";
      "Due Time" := PlanningComponent."Due Time";
      "Planning Flexibility" := "Planning Flexibility"::None;
      "Planning Level Code" := PlanningComponent."Planning Level Code";
      ReservePlanningComponent.FilterReservFor(ReservEntry,PlanningComponent);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" :=
        PlanningComponent."Expected Quantity (Base)" - PlanningComponent."Reserved Qty. (Base)" + AutoReservedQty;
      CASE PlanningComponent."Ref. Order Type" OF
        PlanningComponent."Ref. Order Type"::"Prod. Order":
          IF ProdOrderComp.GET(
               PlanningComponent."Ref. Order Status",
               PlanningComponent."Ref. Order No.",
               PlanningComponent."Ref. Order Line No.",
               PlanningComponent."Line No.")
          THEN BEGIN
            "Original Quantity" := ProdOrderComp."Expected Quantity";
            ProdOrderComp.CALCFIELDS("Reserved Qty. (Base)");
            IF ProdOrderComp."Reserved Qty. (Base)" > 0 THEN BEGIN
              ReservedQty := ProdOrderComp."Reserved Qty. (Base)";
              ReserveProdOrderComp.FilterReservFor(ReservEntry,ProdOrderComp);
              CalcReservedQty(ReservEntry,ReservedQty);
              IF ReservedQty > "Untracked Quantity" THEN
                "Untracked Quantity" := 0
              ELSE
                "Untracked Quantity" := "Untracked Quantity" - ReservedQty;
            END;
          END ELSE BEGIN
            "Primary Order Type" := DATABASE::"Planning Component";
            "Primary Order Status" := PlanningComponent."Ref. Order Status";
            "Primary Order No." := PlanningComponent."Ref. Order No.";
          END;
        PlanningComponent."Ref. Order Type"::Assembly:
          IF AsmLine.GET(
               PlanningComponent."Ref. Order Status",
               PlanningComponent."Ref. Order No.",
               PlanningComponent."Ref. Order Line No.")
          THEN BEGIN
            "Original Quantity" := AsmLine.Quantity;
            AsmLine.CALCFIELDS("Reserved Qty. (Base)");
            IF AsmLine."Reserved Qty. (Base)" > 0 THEN BEGIN
              ReservedQty := AsmLine."Reserved Qty. (Base)";
              AsmLineReserve.FilterReservFor(ReservEntry,AsmLine);
              CalcReservedQty(ReservEntry,ReservedQty);
              IF ReservedQty > "Untracked Quantity" THEN
                "Untracked Quantity" := 0
              ELSE
                "Untracked Quantity" := "Untracked Quantity" - ReservedQty;
            END;
          END ELSE BEGIN
            "Primary Order Type" := DATABASE::"Planning Component";
            "Primary Order Status" := PlanningComponent."Ref. Order Status";
            "Primary Order No." := PlanningComponent."Ref. Order No.";
          END;
      END;
      Quantity := PlanningComponent."Expected Quantity";
      "Remaining Quantity" := PlanningComponent."Expected Quantity";
      "Finished Quantity" := 0;
      "Quantity (Base)" := PlanningComponent."Expected Quantity (Base)";
      "Remaining Quantity (Base)" := PlanningComponent."Expected Quantity (Base)";
      "Unit of Measure Code" := PlanningComponent."Unit of Measure Code";
      "Qty. per Unit of Measure" := PlanningComponent."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;

      OnAfterTransferFromPlanComponent(Rec,PlanningComponent);
    END;

    LOCAL PROCEDURE CalcReservedQty@20(VAR ReservEntry@1000 : Record 337;VAR ReservedQty@1002 : Decimal);
    VAR
      OppositeReservEntry@1001 : Record 337;
    BEGIN
      ReservEntry.SETCURRENTKEY(
        "Source ID","Source Ref. No.","Source Type","Source Subtype","Source Batch Name","Source Prod. Order Line",
        "Reservation Status");
      ReservEntry.SETRANGE("Reservation Status",ReservEntry."Reservation Status"::Reservation);
      ReservEntry.SETRANGE(Binding,ReservEntry.Binding::"Order-to-Order");
      IF ReservEntry.FIND('-') THEN BEGIN
        // Retrieving information about primary order:
        IF ReservEntry.Positive THEN
          OppositeReservEntry.GET(ReservEntry."Entry No.",NOT ReservEntry.Positive)
        ELSE
          OppositeReservEntry := ReservEntry;
        IF "Primary Order No." = '' THEN BEGIN
          "Primary Order Type" := OppositeReservEntry."Source Type";
          "Primary Order Status" := OppositeReservEntry."Source Subtype";
          "Primary Order No." := OppositeReservEntry."Source ID";
        END;

        Binding := ReservEntry.Binding;
        REPEAT
          ReservedQty := ReservedQty + ReservEntry."Quantity (Base)";
        UNTIL ReservEntry.NEXT = 0;
      END;
    END;

    [External]
    PROCEDURE TransferFromPurchaseLine@3(VAR PurchaseLine@1000 : Record 39;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReservePurchLine@1002 : Codeunit 99000834;
      AutoReservedQty@1003 : Decimal;
      Item@1000000000 : Record 27;
      QtyReleasedOnProjects@1000000001 : Decimal;
    BEGIN
      PurchaseLine.TESTFIELD(Type,PurchaseLine.Type::Item);
      SetSource(DATABASE::"Purchase Line",PurchaseLine."Document Type",PurchaseLine."Document No.",PurchaseLine."Line No.",'',0);
      "Item No." := PurchaseLine."No.";
      "Variant Code" := PurchaseLine."Variant Code";
      "Location Code" := PurchaseLine."Location Code";
      "Bin Code" := PurchaseLine."Bin Code";
      ReservePurchLine.FilterReservFor(ReservEntry,PurchaseLine);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingReservEntry);
      PurchaseLine.CALCFIELDS("Reserved Qty. (Base)");
      IF PurchaseLine."Document Type" = PurchaseLine."Document Type"::"Return Order" THEN BEGIN
        AutoReservedQty := -AutoReservedQty;
        PurchaseLine."Reserved Qty. (Base)" := -PurchaseLine."Reserved Qty. (Base)";
      END;

      IF PurchaseLine."Document Type" <> PurchaseLine."Document Type"::"Blanket Order" THEN BEGIN //**4PS.n
        "Untracked Quantity" := PurchaseLine."Outstanding Qty. (Base)" - PurchaseLine."Reserved Qty. (Base)" + AutoReservedQty;
        "Min. Quantity" := PurchaseLine."Reserved Qty. (Base)" - AutoReservedQty;
        Quantity := PurchaseLine.Quantity;
        "Remaining Quantity" := PurchaseLine."Outstanding Quantity";
        "Finished Quantity" := PurchaseLine."Quantity Received";
        "Quantity (Base)" := PurchaseLine."Quantity (Base)";
        "Remaining Quantity (Base)" := PurchaseLine."Outstanding Qty. (Base)";
      //**4PS.sn
      END ELSE BEGIN
        Item.GET(PurchaseLine."No.");
        QtyReleasedOnProjects := CalcQtyReleasedOnProjects(PurchaseLine);
        "Finished Quantity" := 0;

        IF PurchaseLine."Expected Receipt Date" > CALCDATE(Item."Demand Time Calculation", WORKDATE) THEN BEGIN
          Quantity := PurchaseLine.Quantity;
        END ELSE BEGIN
          Quantity := QtyReleasedOnProjects;
        END;
        "Remaining Quantity" := Quantity;
        "Quantity (Base)" :=  ROUND(Quantity * PurchaseLine."Qty. per Unit of Measure", 0.00001);
        "Remaining Quantity (Base)" := ROUND("Remaining Quantity" * PurchaseLine."Qty. per Unit of Measure", 0.00001);
        "Untracked Quantity" :=
          Quantity -
          PurchaseLine."Reserved Qty. (Base)" +
          AutoReservedQty;
        "Min. Quantity" :=
          PurchaseLine."Reserved Qty. (Base)" -
          AutoReservedQty;
      END;
      //**4PS.en
      "Unit of Measure Code" := PurchaseLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := PurchaseLine."Qty. per Unit of Measure";
      IF PurchaseLine."Document Type" = PurchaseLine."Document Type"::"Return Order" THEN BEGIN
        ChangeSign;
        "Planning Flexibility" := "Planning Flexibility"::None;
      END ELSE
        "Planning Flexibility" := PurchaseLine."Planning Flexibility";
      IsSupply := "Untracked Quantity" >= 0;
      "Due Date" := PurchaseLine."Expected Receipt Date";
      "Drop Shipment" := PurchaseLine."Drop Shipment";
      "Special Order" := PurchaseLine."Special Order";

      OnAfterTransferFromPurchaseLine(Rec,PurchaseLine);
    END;

    [External]
    PROCEDURE TransferFromProdOrderLine@4(VAR ProdOrderLine@1000 : Record 5406;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveProdOrderLine@1002 : Codeunit 99000837;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      SetSource(DATABASE::"Prod. Order Line",ProdOrderLine.Status,ProdOrderLine."Prod. Order No.",0,'',ProdOrderLine."Line No.");
      "Item No." := ProdOrderLine."Item No.";
      "Variant Code" := ProdOrderLine."Variant Code";
      "Location Code" := ProdOrderLine."Location Code";
      "Bin Code" := ProdOrderLine."Bin Code";
      "Due Date" := ProdOrderLine."Due Date";
      "Starting Date" := ProdOrderLine."Starting Date";
      "Planning Flexibility" := ProdOrderLine."Planning Flexibility";
      "Planning Level Code" := ProdOrderLine."Planning Level Code";
      ProdOrderLine.CALCFIELDS("Reserved Qty. (Base)");
      ReserveProdOrderLine.FilterReservFor(ReservEntry,ProdOrderLine);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" := ProdOrderLine."Remaining Qty. (Base)" - ProdOrderLine."Reserved Qty. (Base)" + AutoReservedQty;
      "Min. Quantity" := ProdOrderLine."Reserved Qty. (Base)" - AutoReservedQty;
      Quantity := ProdOrderLine.Quantity;
      "Remaining Quantity" := ProdOrderLine."Remaining Quantity";
      "Finished Quantity" := ProdOrderLine."Finished Quantity";
      "Quantity (Base)" := ProdOrderLine."Quantity (Base)";
      "Remaining Quantity (Base)" := ProdOrderLine."Remaining Qty. (Base)";
      "Unit of Measure Code" := ProdOrderLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ProdOrderLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" >= 0;

      OnAfterTransferFromProdOrderLine(Rec,ProdOrderLine);
    END;

    [External]
    PROCEDURE TransferFromAsmLine@12(VAR AsmLine@1000 : Record 901;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      AsmLineReserve@1002 : Codeunit 926;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      AsmLine.TESTFIELD(Type,AsmLine.Type::Item);
      SetSource(DATABASE::"Assembly Line",AsmLine."Document Type",AsmLine."Document No.",AsmLine."Line No.",'',0);
      "Ref. Order Type" := "Ref. Order Type"::Assembly;
      "Ref. Order No." := AsmLine."Document No.";
      "Ref. Line No." := AsmLine."Line No.";
      "Item No." := AsmLine."No.";
      "Variant Code" := AsmLine."Variant Code";
      "Location Code" := AsmLine."Location Code";
      "Bin Code" := AsmLine."Bin Code";
      AsmLine.CALCFIELDS("Reserved Qty. (Base)");
      AsmLineReserve.FilterReservFor(ReservEntry,AsmLine);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" := AsmLine."Remaining Quantity (Base)" - AsmLine."Reserved Qty. (Base)" + AutoReservedQty;
      Quantity := AsmLine.Quantity;
      "Remaining Quantity" := AsmLine."Remaining Quantity";
      "Finished Quantity" := AsmLine."Consumed Quantity";
      "Quantity (Base)" := AsmLine."Quantity (Base)";
      "Remaining Quantity (Base)" := AsmLine."Remaining Quantity (Base)";
      "Unit of Measure Code" := AsmLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := AsmLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := AsmLine."Due Date";
      "Planning Flexibility" := "Planning Flexibility"::None;

      OnAfterTransferFromAsmLine(Rec,AsmLine);
    END;

    [External]
    PROCEDURE TransferFromAsmHeader@13(VAR AsmHeader@1000 : Record 900;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      AsmHeaderReserve@1002 : Codeunit 925;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      SetSource(DATABASE::"Assembly Header",AsmHeader."Document Type",AsmHeader."No.",0,'',0);
      "Item No." := AsmHeader."Item No.";
      "Variant Code" := AsmHeader."Variant Code";
      "Location Code" := AsmHeader."Location Code";
      "Bin Code" := AsmHeader."Bin Code";
      AsmHeaderReserve.FilterReservFor(ReservEntry,AsmHeader);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingReservEntry);
      AsmHeader.CALCFIELDS("Reserved Qty. (Base)");
      "Untracked Quantity" := AsmHeader."Remaining Quantity (Base)" - AsmHeader."Reserved Qty. (Base)" + AutoReservedQty;
      "Min. Quantity" := AsmHeader."Reserved Qty. (Base)" - AutoReservedQty;
      Quantity := AsmHeader.Quantity;
      "Remaining Quantity" := AsmHeader."Remaining Quantity";
      "Finished Quantity" := AsmHeader."Assembled Quantity";
      "Quantity (Base)" := AsmHeader."Quantity (Base)";
      "Remaining Quantity (Base)" := AsmHeader."Remaining Quantity (Base)";
      "Unit of Measure Code" := AsmHeader."Unit of Measure Code";
      "Qty. per Unit of Measure" := AsmHeader."Qty. per Unit of Measure";
      "Planning Flexibility" := AsmHeader."Planning Flexibility";
      IsSupply := "Untracked Quantity" >= 0;
      "Due Date" := AsmHeader."Due Date";

      OnAfterTransferFromAsmHeader(Rec,AsmHeader);
    END;

    [External]
    PROCEDURE TransferFromRequisitionLine@5(VAR RequisitionLine@1000 : Record 246;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveReqLine@1002 : Codeunit 99000833;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      RequisitionLine.TESTFIELD(Type,RequisitionLine.Type::Item);
      SetSource(
        DATABASE::"Requisition Line",0,RequisitionLine."Worksheet Template Name",RequisitionLine."Line No.",
        RequisitionLine."Journal Batch Name",0);
      "Item No." := RequisitionLine."No.";
      "Variant Code" := RequisitionLine."Variant Code";
      "Location Code" := RequisitionLine."Location Code";
      "Bin Code" := RequisitionLine."Bin Code";
      RequisitionLine.CALCFIELDS("Reserved Qty. (Base)");
      ReserveReqLine.FilterReservFor(ReservEntry,RequisitionLine);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingEntry);
      "Untracked Quantity" := RequisitionLine."Quantity (Base)" - RequisitionLine."Reserved Qty. (Base)" + AutoReservedQty;
      "Min. Quantity" := RequisitionLine."Reserved Qty. (Base)" - AutoReservedQty;
      Quantity := RequisitionLine.Quantity;
      "Finished Quantity" := 0;
      "Remaining Quantity" := RequisitionLine.Quantity;
      "Quantity (Base)" := RequisitionLine."Quantity (Base)";
      "Remaining Quantity (Base)" := RequisitionLine."Quantity (Base)";
      "Unit of Measure Code" := RequisitionLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := RequisitionLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" >= 0;
      "Due Date" := RequisitionLine."Due Date";
      "Planning Flexibility" := RequisitionLine."Planning Flexibility";

      OnAfterTransferFromRequisitionLine(Rec,RequisitionLine);
    END;

    [External]
    PROCEDURE TransferFromOutboundTransfPlan@16(VAR RequisitionLine@1000 : Record 246;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveReqLine@1002 : Codeunit 99000833;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      RequisitionLine.TESTFIELD(Type,RequisitionLine.Type::Item);
      SetSource(
        DATABASE::"Requisition Line",1,RequisitionLine."Worksheet Template Name",RequisitionLine."Line No.",
        RequisitionLine."Journal Batch Name",0);
      "Item No." := RequisitionLine."No.";
      "Variant Code" := RequisitionLine."Variant Code";
      "Location Code" := RequisitionLine."Transfer-from Code";
      "Bin Code" := RequisitionLine."Bin Code";
      RequisitionLine.CALCFIELDS("Reserved Qty. (Base)");
      ReserveReqLine.FilterReservFor(ReservEntry,RequisitionLine);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingEntry);
      "Untracked Quantity" := RequisitionLine."Quantity (Base)" - RequisitionLine."Reserved Qty. (Base)" + AutoReservedQty;
      "Min. Quantity" := RequisitionLine."Reserved Qty. (Base)" - AutoReservedQty;
      Quantity := RequisitionLine.Quantity;
      "Finished Quantity" := 0;
      "Remaining Quantity" := RequisitionLine.Quantity;
      "Quantity (Base)" := RequisitionLine."Quantity (Base)";
      "Remaining Quantity (Base)" := RequisitionLine."Quantity (Base)";
      "Unit of Measure Code" := RequisitionLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := RequisitionLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" <= 0;
      "Due Date" := RequisitionLine."Transfer Shipment Date";

      OnAfterTransferFromOutboundTransfPlan(Rec,RequisitionLine);
    END;

    [External]
    PROCEDURE TransferFromOutboundTransfer@14(VAR TransLine@1000 : Record 5741;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      DummyTempTrackingEntry@1007 : TEMPORARY Record 337;
      CrntInvProfile@1008 : Record 99000853;
      ReserveTransLine@1002 : Codeunit 99000836;
      AutoReservedQty@1003 : Decimal;
      MinQtyInbnd@1005 : Decimal;
      MinQtyOutbnd@1006 : Decimal;
    BEGIN
      SetSource(DATABASE::"Transfer Line",0,TransLine."Document No.",TransLine."Line No.",'',0);
      "Item No." := TransLine."Item No.";
      "Variant Code" := TransLine."Variant Code";
      "Location Code" := TransLine."Transfer-from Code";

      TransLine.CALCFIELDS("Reserved Qty. Outbnd. (Base)","Reserved Qty. Inbnd. (Base)");
      ReserveTransLine.FilterReservFor(ReservEntry,TransLine,0);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingEntry);
      MinQtyOutbnd := TransLine."Reserved Qty. Outbnd. (Base)" - AutoReservedQty;

      CrntInvProfile := Rec;
      ReserveTransLine.FilterReservFor(ReservEntry,TransLine,1);
      AutoReservedQty := TransferBindings(ReservEntry,DummyTempTrackingEntry);
      MinQtyInbnd := TransLine."Reserved Qty. Inbnd. (Base)" - AutoReservedQty;
      Rec := CrntInvProfile;

      IF MinQtyInbnd > MinQtyOutbnd THEN
        "Min. Quantity" := MinQtyInbnd
      ELSE
        "Min. Quantity" := MinQtyOutbnd;

      "Untracked Quantity" := TransLine."Outstanding Qty. (Base)" - MinQtyOutbnd;
      Quantity := TransLine.Quantity;
      "Remaining Quantity" := TransLine."Outstanding Quantity";
      "Finished Quantity" := TransLine."Quantity Shipped";
      "Quantity (Base)" := TransLine."Quantity (Base)";
      "Remaining Quantity (Base)" := TransLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := TransLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := TransLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := TransLine."Shipment Date";
      "Planning Flexibility" := TransLine."Planning Flexibility";

      OnAfterTransferFromOutboundTransfer(Rec,TransLine);
    END;

    [External]
    PROCEDURE TransferFromInboundTransfer@15(VAR TransLine@1000 : Record 5741;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      DummyTempTrackingEntry@1007 : TEMPORARY Record 337;
      CrntInvProfile@1008 : Record 99000853;
      ReserveTransLine@1002 : Codeunit 99000836;
      AutoReservedQty@1003 : Decimal;
      MinQtyInbnd@1006 : Decimal;
      MinQtyOutbnd@1005 : Decimal;
    BEGIN
      SetSource(DATABASE::"Transfer Line",1,TransLine."Document No.",TransLine."Line No.",'',TransLine."Derived From Line No.");
      "Item No." := TransLine."Item No.";
      "Variant Code" := TransLine."Variant Code";
      "Location Code" := TransLine."Transfer-to Code";

      TransLine.CALCFIELDS("Reserved Qty. Outbnd. (Base)","Reserved Qty. Inbnd. (Base)");
      ReserveTransLine.FilterReservFor(ReservEntry,TransLine,1);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingReservEntry);
      MinQtyInbnd := TransLine."Reserved Qty. Inbnd. (Base)" - AutoReservedQty;

      CrntInvProfile := Rec;
      ReserveTransLine.FilterReservFor(ReservEntry,TransLine,0);
      AutoReservedQty := -TransferBindings(ReservEntry,DummyTempTrackingEntry);
      MinQtyOutbnd := TransLine."Reserved Qty. Outbnd. (Base)" - AutoReservedQty;
      Rec := CrntInvProfile;

      IF MinQtyInbnd > MinQtyOutbnd THEN
        "Min. Quantity" := MinQtyInbnd
      ELSE
        "Min. Quantity" := MinQtyOutbnd;

      "Untracked Quantity" := TransLine."Outstanding Qty. (Base)" - MinQtyInbnd;
      Quantity := TransLine.Quantity;
      "Remaining Quantity" := TransLine."Outstanding Quantity";
      "Finished Quantity" := TransLine."Quantity Received";
      "Quantity (Base)" := TransLine."Quantity (Base)";
      "Remaining Quantity (Base)" := TransLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := TransLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := TransLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" >= 0;
      "Starting Date" := TransLine."Shipment Date";
      "Due Date" := TransLine."Receipt Date";
      "Planning Flexibility" := TransLine."Planning Flexibility";

      OnAfterTransferFromInboundTransfer(Rec,TransLine);
    END;

    [External]
    PROCEDURE TransferFromServLine@17(VAR ServLine@1000 : Record 5902;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ServLineReserve@1002 : Codeunit 99000842;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      ServLine.TESTFIELD(Type,ServLine.Type::Item);
      SetSource(DATABASE::"Service Line",ServLine."Document Type",ServLine."Document No.",ServLine."Line No.",'',0);
      "Item No." := ServLine."No.";
      "Variant Code" := ServLine."Variant Code";
      "Location Code" := ServLine."Location Code";
      ServLine.CALCFIELDS("Reserved Qty. (Base)");
      ServLineReserve.FilterReservFor(ReservEntry,ServLine);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" := ServLine."Outstanding Qty. (Base)" - ServLine."Reserved Qty. (Base)" + AutoReservedQty;
      Quantity := ServLine.Quantity;
      "Remaining Quantity" := ServLine."Outstanding Quantity";
      "Finished Quantity" := ServLine."Quantity Shipped";
      "Quantity (Base)" := ServLine."Quantity (Base)";
      "Remaining Quantity (Base)" := ServLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := ServLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ServLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := ServLine."Needed by Date";
      "Planning Flexibility" := "Planning Flexibility"::None;

      OnAfterTransferFromServLine(Rec,ServLine);
    END;

    [External]
    PROCEDURE TransferFromJobPlanningLine@11(VAR JobPlanningLine@1000 : Record 11020401;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      JobPlanningLineReserve@1002 : Codeunit 1032;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      JobPlanningLine.TESTFIELD(Type,JobPlanningLine.Type::Item);
      SetSource(
        DATABASE::"Job Planning Line",JobPlanningLine.Status,JobPlanningLine."Job No.",JobPlanningLine."Job Contract Entry No.",'',0);
      "Item No." := JobPlanningLine."No.";
      "Variant Code" := JobPlanningLine."Variant Code";
      "Location Code" := JobPlanningLine."Location Code";
      JobPlanningLine.CALCFIELDS("Reserved Qty. (Base)");
      JobPlanningLineReserve.FilterReservFor(ReservEntry,JobPlanningLine);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" := JobPlanningLine."Remaining Qty. (Base)" - JobPlanningLine."Reserved Qty. (Base)" + AutoReservedQty;
      Quantity := JobPlanningLine.Quantity;
      "Remaining Quantity" := JobPlanningLine."Remaining Qty.";
      "Finished Quantity" := JobPlanningLine."Qty. Posted";
      "Quantity (Base)" := JobPlanningLine."Quantity (Base)";
      "Remaining Quantity (Base)" := JobPlanningLine."Remaining Qty. (Base)";
      "Unit of Measure Code" := JobPlanningLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := JobPlanningLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := JobPlanningLine."Planning Date";
      "Planning Flexibility" := "Planning Flexibility"::None;

      OnAfterTransferFromJobPlanningLine(Rec,JobPlanningLine);
    END;

    [External]
    PROCEDURE TransferBindings@10(VAR ReservEntry@1000 : Record 337;VAR TrackingEntry@1004 : Record 337) : Decimal;
    VAR
      OppositeReservEntry@1001 : Record 337;
      AutoReservedQty@1002 : Decimal;
      Found@1003 : Boolean;
      InsertTracking@1005 : Boolean;
    BEGIN
      ReservEntry.SETCURRENTKEY(
        "Source ID","Source Ref. No.","Source Type","Source Subtype","Source Batch Name","Source Prod. Order Line",
        "Reservation Status");
      IF ReservEntry.FINDSET THEN
        REPEAT
          InsertTracking := NOT
            ((ReservEntry."Reservation Status" = ReservEntry."Reservation Status"::Reservation) AND
             (ReservEntry.Binding = ReservEntry.Binding::" "));
          IF InsertTracking AND ReservEntry.TrackingExists AND
             (ReservEntry."Source Type" <> DATABASE::"Item Ledger Entry")
          THEN BEGIN
            TrackingEntry := ReservEntry;
            TrackingEntry.INSERT;
          END;
          IF ReservEntry."Reservation Status" < ReservEntry."Reservation Status"::Surplus
          THEN
            IF (ReservEntry.Binding = ReservEntry.Binding::"Order-to-Order")
            THEN BEGIN
              IF ReservEntry."Reservation Status" = ReservEntry."Reservation Status"::Reservation THEN
                AutoReservedQty := AutoReservedQty + ReservEntry."Quantity (Base)";
              IF NOT Found THEN BEGIN
                IF ReservEntry.Positive THEN
                  OppositeReservEntry.GET(ReservEntry."Entry No.",NOT ReservEntry.Positive)
                ELSE
                  OppositeReservEntry := ReservEntry;
                IF "Primary Order No." = '' THEN BEGIN
                  "Primary Order Type" := OppositeReservEntry."Source Type";
                  "Primary Order Status" := OppositeReservEntry."Source Subtype";
                  "Primary Order No." := OppositeReservEntry."Source ID";
                  IF OppositeReservEntry."Source Type" <> DATABASE::"Prod. Order Component" THEN
                    "Primary Order Line" := OppositeReservEntry."Source Ref. No.";
                END;
                Binding := ReservEntry.Binding;
                "Disallow Cancellation" := ReservEntry."Disallow Cancellation";
                Found := TRUE;
              END;
            END ELSE
              IF (ReservEntry."Reservation Status" = ReservEntry."Reservation Status"::Reservation) AND
                 (("Fixed Date" = 0D) OR ("Fixed Date" > ReservEntry."Shipment Date"))
              THEN
                "Fixed Date" := ReservEntry."Shipment Date";
        UNTIL ReservEntry.NEXT = 0;
      EXIT(AutoReservedQty);
    END;

    [External]
    PROCEDURE TransferQtyFromItemTrgkEntry@18(VAR ItemTrackingEntry@1000 : Record 337);
    BEGIN
      "Original Quantity" := 0;
      Quantity := ItemTrackingEntry.Quantity;
      "Quantity (Base)" := ItemTrackingEntry."Quantity (Base)";
      "Finished Quantity" := 0;
      "Min. Quantity" := 0;
      "Remaining Quantity" := ItemTrackingEntry.Quantity;
      "Remaining Quantity (Base)" := ItemTrackingEntry."Quantity (Base)";
      "Untracked Quantity" := ItemTrackingEntry."Quantity (Base)";
      IF NOT IsSupply THEN
        ChangeSign;
    END;

    [External]
    PROCEDURE ReduceQtyByItemTracking@19(VAR NewInvProfile@1000 : Record 99000853);
    BEGIN
      "Original Quantity" -= NewInvProfile."Original Quantity";
      Quantity -= NewInvProfile.Quantity;
      "Quantity (Base)" -= NewInvProfile."Quantity (Base)";
      "Finished Quantity" -= NewInvProfile."Finished Quantity";
      "Remaining Quantity" -= NewInvProfile."Remaining Quantity";
      "Remaining Quantity (Base)" -= NewInvProfile."Remaining Quantity (Base)";
      "Untracked Quantity" -= NewInvProfile."Untracked Quantity";
    END;

    [External]
    PROCEDURE ChangeSign@6();
    BEGIN
      "Original Quantity" := -"Original Quantity";
      "Remaining Quantity (Base)" := -"Remaining Quantity (Base)";
      "Untracked Quantity" := -"Untracked Quantity";
      "Quantity (Base)" := -"Quantity (Base)";
      Quantity := -Quantity;
      "Remaining Quantity" := -"Remaining Quantity";
      "Finished Quantity" := -"Finished Quantity";
    END;

    [External]
    PROCEDURE TransferToTrackingEntry@9(VAR TrkgReservEntry@1000 : Record 337;UseSecondaryFields@1001 : Boolean);
    VAR
      ReqLine@1002 : Record 246;
      IsHandled@1003 : Boolean;
    BEGIN
      CASE "Source Type" OF
        0:
          BEGIN
            // Surplus, Reorder Point
            TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Surplus;
            TrkgReservEntry."Suppressed Action Msg." := TRUE;
            EXIT;
          END;
        DATABASE::"Production Forecast Entry":
          BEGIN
            // Will be marked as Surplus
            TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Surplus;
            TrkgReservEntry.SetSource(DATABASE::"Production Forecast Entry",0,"Source ID",0,'',0);
            TrkgReservEntry."Suppressed Action Msg." := TRUE;
          END;
        DATABASE::"Sales Line":
          BEGIN
            IF "Source Order Status" = 4 THEN BEGIN
              // Blanket Order will be marked as Surplus
              TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Surplus;
              TrkgReservEntry."Suppressed Action Msg." := TRUE;
            END;
            TrkgReservEntry.SetSource(DATABASE::"Sales Line","Source Order Status","Source ID","Source Ref. No.",'',0);
          END;
        DATABASE::"Requisition Line":
          TrkgReservEntry.SetSource(
            DATABASE::"Requisition Line","Source Order Status","Source ID","Source Ref. No.","Source Batch Name",0);
        DATABASE::"Purchase Line":
          TrkgReservEntry.SetSource(
            DATABASE::"Purchase Line","Source Order Status","Source ID","Source Ref. No.",'',0);
        DATABASE::"Item Ledger Entry":
          TrkgReservEntry.SetSource(
            DATABASE::"Item Ledger Entry",0,'',"Source Ref. No.",'',0);
        DATABASE::"Prod. Order Line":
          TrkgReservEntry.SetSource(
            DATABASE::"Prod. Order Line","Source Order Status","Source ID",0,'',"Source Prod. Order Line");
        DATABASE::"Prod. Order Component":
          TrkgReservEntry.SetSource(
            DATABASE::"Prod. Order Component","Source Order Status","Source ID","Source Ref. No.",'',"Source Prod. Order Line");
        DATABASE::"Planning Component":
          IF UseSecondaryFields THEN BEGIN
            ReqLine.GET("Source ID","Source Batch Name","Source Prod. Order Line");
            CASE ReqLine."Ref. Order Type" OF
              ReqLine."Ref. Order Type"::"Prod. Order":
                TrkgReservEntry.SetSource(
                  DATABASE::"Prod. Order Component","Source Order Status","Ref. Order No.","Source Ref. No.",'',"Ref. Line No.");
              ReqLine."Ref. Order Type"::Assembly:
                TrkgReservEntry.SetSource(
                  DATABASE::"Assembly Line","Source Order Status","Ref. Order No.","Source Ref. No.",'',"Ref. Line No.");
            END;
          END ELSE
            TrkgReservEntry.SetSource(
              DATABASE::"Planning Component",0,"Source ID","Source Ref. No.","Source Batch Name","Source Prod. Order Line");
        DATABASE::"Assembly Line":
          BEGIN
            IF "Source Order Status" = 4 THEN BEGIN
              // Blanket Order will be marked as Surplus
              TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Surplus;
              TrkgReservEntry."Suppressed Action Msg." := TRUE;
            END;
            TrkgReservEntry.SetSource(DATABASE::"Assembly Line","Source Order Status","Source ID","Source Ref. No.",'',0);
          END;
        DATABASE::"Assembly Header":
          TrkgReservEntry.SetSource(DATABASE::"Assembly Header","Source Order Status","Source ID","Source Ref. No.",'',0);
        DATABASE::"Transfer Line":
          IF IsSupply THEN
            TrkgReservEntry.SetSource(DATABASE::"Transfer Line",1,"Source ID","Source Ref. No.",'',"Source Prod. Order Line")
          ELSE
            TrkgReservEntry.SetSource(DATABASE::"Transfer Line",0,"Source ID","Source Ref. No.",'',0);
        DATABASE::"Service Line":
          TrkgReservEntry.SetSource(DATABASE::"Service Line","Source Order Status","Source ID","Source Ref. No.",'',0);
        DATABASE::"Job Planning Line":
          TrkgReservEntry.SetSource(DATABASE::"Job Planning Line","Source Order Status","Source ID","Source Ref. No.",'',0);
        //**4PS.sn
        DATABASE::"Plant Order Line":
          TrkgReservEntry.SetSource(DATABASE::"Plant Order Line",0,"Source ID","Source Ref. No.",'',0);
        DATABASE::"Item Journal Line":
          TrkgReservEntry.SetSource(DATABASE::"Item Journal Line",0,"Source ID","Source Ref. No.","Source Batch Name",0);
        DATABASE::"Advice Order Line":
          TrkgReservEntry.SetSource(DATABASE::"Advice Order Line",0,"Source ID","Source Ref. No.",'',0);
        DATABASE::"Project Material Req. Line":
          TrkgReservEntry.SetSource(DATABASE::"Project Material Req. Line",0,"Source ID","Source Ref. No.",'',0);
        //**4PS.en
        ELSE BEGIN
          IsHandled := FALSE;
          OnTransferToTrackingEntrySourceTypeElseCase(Rec,TrkgReservEntry,UseSecondaryFields,IsHandled);
          IF NOT IsHandled THEN
            ERROR(Text000,"Source Type");
        END;
      END;

      TrkgReservEntry."Item No." := "Item No.";
      TrkgReservEntry."Location Code" := "Location Code";
      TrkgReservEntry.Description := '';
      TrkgReservEntry."Creation Date" := TODAY;
      TrkgReservEntry."Created By" := USERID;
      TrkgReservEntry."Qty. per Unit of Measure" := "Qty. per Unit of Measure";
      TrkgReservEntry."Variant Code" := "Variant Code";
      TrkgReservEntry.Binding := Binding;
      TrkgReservEntry."Disallow Cancellation" := "Disallow Cancellation";
      TrkgReservEntry."Lot No." := "Lot No.";
      TrkgReservEntry."Serial No." := "Serial No.";
      TrkgReservEntry."Expiration Date" := "Expiration Date";

      IF IsSupply THEN
        TrkgReservEntry."Quantity (Base)" := "Untracked Quantity"
      ELSE
        TrkgReservEntry."Quantity (Base)" := -"Untracked Quantity";

      TrkgReservEntry.Quantity :=
        ROUND(TrkgReservEntry."Quantity (Base)" / TrkgReservEntry."Qty. per Unit of Measure",UOMMgt.QtyRndPrecision);
      TrkgReservEntry.Positive := TrkgReservEntry."Quantity (Base)" > 0;

      IF TrkgReservEntry."Reservation Status" <> TrkgReservEntry."Reservation Status"::Surplus THEN
        IF ("Planning Level Code" > 0) OR
           (Binding = Binding::"Order-to-Order")
        THEN
          TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Reservation
        ELSE
          TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Tracking;

      IF TrkgReservEntry."Quantity (Base)" = 0 THEN BEGIN
        TrkgReservEntry."Expected Receipt Date" := GetExpectedReceiptDate;
        TrkgReservEntry."Shipment Date" := "Due Date";
      END ELSE
        IF TrkgReservEntry.Positive THEN
          TrkgReservEntry."Expected Receipt Date" := GetExpectedReceiptDate
        ELSE
          TrkgReservEntry."Shipment Date" := "Due Date";

      OnAfterTransferToTrackingEntry(TrkgReservEntry,Rec,UseSecondaryFields);
    END;

    [External]
    PROCEDURE ActiveInWarehouse@23() : Boolean;
    VAR
      WhseValidateSourceLine@1000 : Codeunit 5777;
    BEGIN
      IF "Source Type" = DATABASE::"Transfer Line" THEN
        EXIT(WhseValidateSourceLine.WhseLinesExist("Source Type",0,"Source ID","Source Ref. No.",0,Quantity));

      EXIT(WhseValidateSourceLine.WhseLinesExist("Source Type","Source Order Status","Source ID","Source Ref. No.",0,Quantity));
    END;

    LOCAL PROCEDURE GetExpectedReceiptDate@22() : Date;
    BEGIN
      IF "Action Message" IN ["Action Message"::Reschedule,"Action Message"::"Resched.& Chg. Qty."] THEN
        EXIT("Original Due Date");
      EXIT("Due Date");
    END;

    [External]
    PROCEDURE SetSource@28(SourceType@1000 : Integer;SourceSubtype@1001 : Integer;SourceID@1002 : Code[20];SourceRefNo@1003 : Integer;SourceBatchName@1004 : Code[10];SourceProdOrderLine@1005 : Integer);
    BEGIN
      "Source Type" := SourceType;
      "Source Order Status" := SourceSubtype;
      "Source ID" := SourceID;
      "Source Ref. No." := SourceRefNo;
      "Source Batch Name" := SourceBatchName;
      "Source Prod. Order Line" := SourceProdOrderLine;
    END;

    [External]
    PROCEDURE SetTrackingFilter@24(InventoryProfile@1001 : Record 99000853);
    BEGIN
      IF InventoryProfile."Serial No." <> '' THEN
        SETRANGE("Serial No.",InventoryProfile."Serial No.")
      ELSE
        SETRANGE("Serial No.");
      IF InventoryProfile."Lot No." <> '' THEN
        SETRANGE("Lot No.",InventoryProfile."Lot No.")
      ELSE
        SETRANGE("Lot No.");
    END;

    [External]
    PROCEDURE TrackingExists@21() : Boolean;
    BEGIN
      EXIT(("Lot No." <> '') OR ("Serial No." <> ''));
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromItemLedgerEntry@27(VAR InventoryProfile@1000 : Record 99000853;ItemLedgerEntry@1001 : Record 32);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromSalesLine@30(VAR InventoryProfile@1000 : Record 99000853;SalesLine@1001 : Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromComponent@31(VAR InventoryProfile@1000 : Record 99000853;ProdOrderComp@1001 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromPlanComponent@32(VAR InventoryProfile@1000 : Record 99000853;PlanningComponent@1001 : Record 99000829);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromPurchaseLine@33(VAR InventoryProfile@1000 : Record 99000853;PurchaseLine@1001 : Record 39);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromProdOrderLine@34(VAR InventoryProfile@1000 : Record 99000853;ProdOrderLine@1001 : Record 5406);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromAsmLine@35(VAR InventoryProfile@1000 : Record 99000853;AssemblyLine@1001 : Record 901);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromAsmHeader@36(VAR InventoryProfile@1000 : Record 99000853;AssemblyHeader@1001 : Record 900);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromRequisitionLine@37(VAR InventoryProfile@1000 : Record 99000853;RequisitionLine@1001 : Record 246);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromInboundTransfer@25(VAR InventoryProfile@1000 : Record 99000853;TransLine@1001 : Record 5741);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromOutboundTransfPlan@38(VAR InventoryProfile@1000 : Record 99000853;RequisitionLine@1001 : Record 246);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromOutboundTransfer@39(VAR InventoryProfile@1000 : Record 99000853;TransferLine@1001 : Record 5741);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromServLine@40(VAR InventoryProfile@1000 : Record 99000853;ServiceLine@1001 : Record 5902);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferFromJobPlanningLine@41(VAR InventoryProfile@1000 : Record 99000853;JobPlanningLine@1001 : Record 11020401);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferToTrackingEntry@26(VAR ReservationEntry@1000 : Record 337;InventoryProfile@1001 : Record 99000853;UseSecondaryFields@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnTransferToTrackingEntrySourceTypeElseCase@29(VAR InventoryProfile@1000 : Record 99000853;VAR ReservationEntry@1001 : Record 337;UseSecondaryFields@1002 : Boolean;VAR IsHandled@1003 : Boolean);
    BEGIN
    END;

    PROCEDURE TransferFromPlantOrderItemLine@1100485000(VAR PlantOrderLine@1000 : Record 11012557;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      //**4PS
      PlantOrderLine.TESTFIELD(Type,PlantOrderLine.Type::Item);
      "Source Type" := DATABASE::"Plant Order Line";
      "Source ID" := PlantOrderLine."Plant Order No.";
      "Source Ref. No." := PlantOrderLine."Line No.";
      "Item No." := PlantOrderLine."Item No.";
      "Variant Code" := PlantOrderLine."Variant Code";
      "Location Code" := PlantOrderLine."Location Code";
      "Bin Code" := PlantOrderLine.GetShelfNo;
      PlantOrderLine.CALCFIELDS("Reserved Item Qty. (Base)");
      FilterReservForPlantOrderItem(ReservEntry, PlantOrderLine);
      AutoReservedQty := - TransferBindings(ReservEntry,TrackingEntry);
      Quantity := PlantOrderLine.Quantity;
      "Untracked Quantity" := PlantOrderLine."Qty. for Item Reservation" - PlantOrderLine."Reserved Item Qty. (Base)" + AutoReservedQty;
      "Quantity (Base)" := PlantOrderLine."Qty. for Item Reservation";
      "Remaining Quantity (Base)" := PlantOrderLine."Qty. for Item Reservation";
      "Unit of Measure Code" := PlantOrderLine."Unit of Measure";
      "Qty. per Unit of Measure" := PlantOrderLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := PlantOrderLine."Transfer Date";
      "Planning Flexibility" := "Planning Flexibility"::None;
    END;

    PROCEDURE FilterReservForPlantOrderItem@1100485001(VAR FilterReservEntry@1000 : Record 337;PlantOrderLine@1001 : Record 11012557);
    BEGIN
      //**4PS
      FilterReservEntry.SETRANGE("Source Type",DATABASE::"Plant Order Line");
      FilterReservEntry.SETRANGE("Source Subtype",0);
      FilterReservEntry.SETRANGE("Source ID",PlantOrderLine."Plant Order No.");
      FilterReservEntry.SETRANGE("Source Batch Name",'');
      FilterReservEntry.SETRANGE("Source Prod. Order Line",0);
      FilterReservEntry.SETRANGE("Source Ref. No.",PlantOrderLine."Line No.");
    END;

    PROCEDURE TransferFromItemJnlLine@1100485003(VAR ItemJnlLine@1000 : Record 83;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      //**4PS
      "Source Type" := DATABASE::"Item Journal Line";
      "Source ID" := ItemJnlLine."Journal Template Name";
      "Source Batch Name" := ItemJnlLine."Journal Batch Name";
      "Source Ref. No." := ItemJnlLine."Line No.";
      "Item No." := ItemJnlLine."Item No.";
      "Variant Code" := ItemJnlLine."Variant Code";
      "Location Code" := ItemJnlLine."Location Code";
      "Bin Code" := ItemJnlLine."Bin Code";
      ItemJnlLine.CALCFIELDS("Reserved Qty. (Base)");
      FilterReservForItemJnlLine(ReservEntry, ItemJnlLine);
      AutoReservedQty := - TransferBindings(ReservEntry,TrackingEntry);
      IF ItemJnlLine."Entry Type" = ItemJnlLine."Entry Type"::Purchase THEN BEGIN
        ItemJnlLine."Reserved Qty. (Base)" := - ItemJnlLine."Reserved Qty. (Base)";
        AutoReservedQty := - AutoReservedQty;
      END;
      "Untracked Quantity" :=
        ItemJnlLine."Quantity (Base)" -
        ItemJnlLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      Quantity := ItemJnlLine.Quantity;
      "Finished Quantity" := 0;
      "Remaining Quantity" := ItemJnlLine.Quantity;
      "Quantity (Base)" := ItemJnlLine."Quantity (Base)";
      "Remaining Quantity (Base)" := ItemJnlLine."Quantity (Base)";
      "Unit of Measure Code" := ItemJnlLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ItemJnlLine."Qty. per Unit of Measure";
      IF ItemJnlLine."Entry Type" = ItemJnlLine."Entry Type"::Purchase THEN
        ChangeSign;
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := ItemJnlLine."Delivery Date";
      "Planning Flexibility" := "Planning Flexibility"::None;
      "Drop Shipment" := ItemJnlLine."Drop Shipment";
    END;

    PROCEDURE FilterReservForItemJnlLine@1100485004(VAR FilterReservEntry@1000 : Record 337;ItemJnlLine@1001 : Record 83);
    BEGIN
      //**4PS
      FilterReservEntry.SETRANGE("Source Type",DATABASE::"Item Journal Line");
      FilterReservEntry.SETRANGE("Source Subtype", ItemJnlLine."Entry Type");
      FilterReservEntry.SETRANGE("Source ID", ItemJnlLine."Journal Template Name");
      FilterReservEntry.SETRANGE("Source Batch Name",ItemJnlLine."Journal Batch Name");
      FilterReservEntry.SETRANGE("Source Prod. Order Line",0);
      FilterReservEntry.SETRANGE("Source Ref. No.",ItemJnlLine."Line No.");
    END;

    PROCEDURE CalcQtyReleasedOnProjects@1000000000(PurchaseLine@1000000000 : Record 39) : Decimal;
    VAR
      PurchLineContractCall@1000000001 : Record 39;
      ReleasedQty@1000000002 : Decimal;
    BEGIN
      //**4PS
      WITH PurchLineContractCall DO BEGIN
        SETCURRENTKEY("Document Type","Blanket Order No.","Blanket Order Line No.");
        SETRANGE("Document Type", "Document Type"::Order, "Document Type":: "Credit Memo");
        SETRANGE("Blanket Order No.", PurchaseLine."Document No.");
        SETRANGE("Blanket Order Line No.", PurchaseLine."Line No.");
        IF FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF PurchLineContractCall."Job No." <> '' THEN
              ReleasedQty += PurchLineContractCall.Quantity;
          UNTIL NEXT = 0;
      END;
      EXIT(ReleasedQty);
    END;

    PROCEDURE TransferFromProjMatReqLine@1100525001(VAR ProjMatReqLine@1000 : Record 11012526;VAR TrackingEntry@1004 : Record 337;RemainingQuantity@1100525000 : Decimal);
    BEGIN
      //**4PS
      "Source Type" := DATABASE::"Project Material Req. Line";
      "Source ID" := ProjMatReqLine."Project No.";
      "Source Ref. No." := ProjMatReqLine."Line No.";
      "Item No." := ProjMatReqLine."Item No.";
      "Variant Code" := ProjMatReqLine."Variant Code";
      "Location Code" := ProjMatReqLine.GetPreferredLocation(ProjMatReqLine."Project No.");
      "Bin Code" := '';

      Quantity := RemainingQuantity;
      "Untracked Quantity" := RemainingQuantity;
      "Quantity (Base)" := RemainingQuantity;
      "Remaining Quantity (Base)" := RemainingQuantity;

      "Unit of Measure Code" := ProjMatReqLine."Unit of Measure";
      "Qty. per Unit of Measure" := 1;
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := ProjMatReqLine."Delivery Date";
      "Planning Flexibility" := "Planning Flexibility"::None;

      ProjMatReqLine."Processed by" := USERID;
      ProjMatReqLine."Processed on" := CURRENTDATETIME;
      ProjMatReqLine.MODIFY(TRUE);
    END;

    BEGIN
    {
      4PS JVG 09-09-10: Incident 19937
      4PS, 06-07-2012, DP00121, Serial No. expanded to 40
    }
    END.
  }
}

