OBJECT Page 6648 Get Return Shipment Lines
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Get Return Shipment Lines;
               NOR=Hent returforsendelseslinjer;
               SVE=HÑmta returutleveransrader];
    SourceTable=Table6651;
    PageType=List;
    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
               END;

    OnAfterGetRecord=BEGIN
                       DocumentNoHideValue := FALSE;
                       DocumentNoOnFormat;
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = ACTION::LookupOK THEN
                         LookupOKOnPush;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje;
                                 SVE=Ra&d];
                      Image=Line }
      { 46      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Show Document;
                                 NOR=Vis dokument;
                                 SVE=Visa dokument];
                      ToolTipML=[ENU=Open the document that the selected line exists on.;
                                 NOR=èpne dokumentet som den valgte linjen finnes i.;
                                 SVE=ôppna dokumentet det den valda raden finns.];
                      ApplicationArea=#SalesReturnOrder;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ReturnShptHeader.GET("Document No.");
                                 PAGE.RUN(PAGE::"Posted Return Shipment",ReturnShptHeader);
                               END;
                                }
      { 47      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera dimensioner, till exempel omrÜde, projekt eller avdelning, som du kan tilldela fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 28      ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 NOR=Varesporingspos&ter;
                                 SVE=Artikelsp&Ür.transaktioner];
                      ToolTipML=[ENU=View serial or lot numbers that are assigned to items.;
                                 NOR=Vis serie- eller partinumre som er tilordnet til varer.;
                                 SVE=Visa serie- eller partinummer som har tilldelats artiklarna.];
                      ApplicationArea=#ItemTracking;
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 ShowItemTrackingLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the related document.;
                           NOR=Angir nummeret pÜ det relaterte dokumentet.;
                           SVE=Anger numret pÜ det relaterade dokumentet.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Document No.";
                HideValue=DocumentNoHideValue;
                StyleExpr='Strong' }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who delivered the items.;
                           NOR=Angir navnet pÜ leverandõren som leverte varene.;
                           SVE=Anger namnet pÜ leverantîren som levererade artiklarna.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Buy-from Vendor No." }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line type.;
                           NOR=Angir linjetypen.;
                           SVE=Anger radtypen.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr=Type }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="No." }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the variant of the item on the line.;
                           NOR=Angir varianten for varen pÜ linjen.;
                           SVE=Anger varianten av artikeln pÜ raden.];
                ApplicationArea=#Planning;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies either the name of or the description of the item, general ledger account or item charge.;
                           NOR=Angir navnet pÜ eller beskrivelsen av varen, finanskontoen eller varegebyret.;
                           SVE=Anger antingen namnet pÜ eller en beskrivning av artikeln, redovisningskontot eller artikelomkostnaden.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr=Description }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code explaining why the item was returned.;
                           NOR=Angir koden som forklarer hvorfor varen ble returnert.;
                           SVE=Anger koden som fîrklarar varfîr artikeln returnerades.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                Lookup=No;
                DrillDown=No;
                ToolTipML=[ENU=Specifies the currency that is used on the entry.;
                           NOR=Angir valutaen som brukes i posten.;
                           SVE=Anger valutakoden som anvÑnds i transaktionen.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location from where inventory items to the customer on the sales document are to be shipped by default.;
                           NOR=Angir plasseringen der lagervarer til kunden pÜ salgsdokumentet leveres fra som standard.;
                           SVE=Anger lagerstÑllet frÜn vilket lagerartiklar till kunden i fîrsÑljningsdokumentet levereras som standard.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Location Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how each unit of the item or resource is measured, such as in pieces or hours. By default, the value in the Base Unit of Measure field on the item or resource card is inserted.;
                           NOR=Angir hvordan hver enhet av varen eller ressursen mÜles, for eksempel i stykker eller timer. Verdien i feltet Lagerenhet pÜ vare- eller ressurskortet settes inn som standard.;
                           SVE=Anger hur varje enhet av artikeln eller resursen mÑts, till exempel i stycken eller timmar. Som standard infogas vÑrdet i fÑltet Basenhet pÜ artikel- eller resurskortet.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Unit of Measure Code" }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the item or resource's unit of measure, such as piece or hour.;
                           NOR=Angir navnet pÜ varens eller ressursens enhet, for eksempel stykk eller time.;
                           SVE=Anger namnet pÜ artikelns eller resursens mÜttenhet, t.ex. styck eller timme.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item ledger entry that the document or journal line is applied to.;
                           NOR=Angir nummeret for vareposten som dokumentet eller kladdelinjen er brukt for.;
                           SVE=Anger numret pÜ artikeltransaktionen som dokumentet eller journalraden Ñr kopplad till.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units of the item, general ledger account, or item charge on the line.;
                           NOR=Angir antall enheter av varen, finanskontoen eller varegebyret pÜ linjen.;
                           SVE=Anger antalet enheter av artikeln, redovisningskontot eller artikelomkostnaden pÜ raden.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr=Quantity }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the related job.;
                           NOR=Angir nummeret for det relaterte prosjektet.;
                           SVE=Anger det relaterade projektets nummer.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the related production order.;
                           NOR=Angir nummeret for den relaterte produksjonsordren.;
                           SVE=Anger den relaterade produktionsorderns nummer.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Prod. Order No.";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have been posted as invoiced.;
                           NOR=Angir hvor mange enheter av varen pÜ linjen som allerede er bokfõrt som fakturert.;
                           SVE=Anger hur mÜnga enheter av artikeln pÜ raden som redan har bokfîrts som fakturerade.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Quantity Invoiced" }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item that has been posted as shipped but has not yet been posted as invoiced.;
                           NOR=Angir antallet for varen som er bokfõrt som levert, men som ennÜ ikke er bokfõrt som fakturert.;
                           SVE=Anger antalet artiklar som har bokfîrts som utlevererade, men som inte Ñnnu har bokfîrts som fakturerade.];
                ApplicationArea=#SalesReturnOrder;
                SourceExpr="Return Qty. Shipped Not Invd." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchHeader@1000 : Record 38;
      ReturnShptHeader@1001 : Record 6650;
      TempReturnShptLine@1002 : TEMPORARY Record 6651;
      GetReturnShipments@1003 : Codeunit 6648;
      DocumentNoHideValue@19020538 : Boolean INDATASET;
      DPA_IsHardFilter@1100000999 : Boolean;

    [External]
    PROCEDURE SetPurchHeader@1(VAR PurchHeader2@1000 : Record 38);
    BEGIN
      PurchHeader.GET(PurchHeader2."Document Type",PurchHeader2."No.");
      PurchHeader.TESTFIELD("Document Type",PurchHeader."Document Type"::"Credit Memo");
    END;

    LOCAL PROCEDURE IsFirstDocLine@2() : Boolean;
    VAR
      ReturnShptLine@1000 : Record 6651;
    BEGIN
      TempReturnShptLine.RESET;
      TempReturnShptLine.COPYFILTERS(Rec);
      TempReturnShptLine.SETRANGE("Document No.","Document No.");
      IF NOT TempReturnShptLine.FINDFIRST THEN BEGIN
        ReturnShptLine.COPYFILTERS(Rec);
        ReturnShptLine.SETRANGE("Document No.","Document No.");
        IF NOT ReturnShptLine.FINDFIRST THEN
          EXIT(FALSE);
        TempReturnShptLine := ReturnShptLine;
        TempReturnShptLine.INSERT;
      END;
      IF "Line No." = TempReturnShptLine."Line No." THEN
        EXIT(TRUE);
    END;

    LOCAL PROCEDURE LookupOKOnPush@19031339();
    BEGIN
      CurrPage.SETSELECTIONFILTER(Rec);
      GetReturnShipments.SetPurchHeader(PurchHeader);
      GetReturnShipments.CreateInvLines(Rec);
    END;

    LOCAL PROCEDURE DocumentNoOnFormat@19001080();
    BEGIN
      IF NOT IsFirstDocLine THEN
        DocumentNoHideValue := TRUE;
    END;

    BEGIN
    END.
  }
}

