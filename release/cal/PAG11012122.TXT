OBJECT Page 11012122 Advice Order Lines
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Advice Order Lines;
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table11012055;
    DelayedInsert=Yes;
    PageType=List;
    UsageCategory=Tasks;
    PromotedActionCategoriesML=ENU=New,Process,Report,Logistics,Approval;
    OnInit=BEGIN
             "Vendor (Trade Item)Enabled" := TRUE;
             ManufacturerEnabled := TRUE;
             "Trade ItemEnabled" := TRUE;
             "Basic ItemEnabled" := TRUE;
             GlobalDim1Editable := TRUE;

             SetEditable;
           END;

    OnOpenPage=VAR
                 InstallationMng@1100525000 : Codeunit 11012268;
                 ServiceOrder@1100529600 : Record 11012823;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(ItemSetup) THEN BEGIN
                   "Basic ItemEnabled" := (FALSE);
                   "Trade ItemEnabled" := (FALSE);
                   ManufacturerEnabled := (FALSE);
                   "Vendor (Trade Item)Enabled" := (FALSE);
                 END;

                 IF NOT BypassFiltering THEN // jhoek.070910
                   IF gvRefRoute <> '' THEN BEGIN
                     //db, 29-01-04: changed because of call from purchase (order/quote)
                     SETCURRENTKEY("Purchase Route Reference");
                     SETRANGE("Purchase Route Reference", gvRefRoute);
                     Toggle(gvPhase);
                   END ELSE BEGIN
                     SETRANGE(Processed, FALSE);
                   END;

                 ProjSetup.GET;
                 PurchasesPayablesSetup.GET;

                 IF IgnoreServiceOrderFilters OR NOT (FPSLicenseManagement.LicenseAndReadPermissionForTable(ServiceOrder)) THEN
                   FiltersVisible := FALSE
                 ELSE
                   FiltersVisible := CurrPage.EDITABLE;
                 TableLinkedTradeItemInLicense := InstallationMng.LicensePermissionForTableData(DATABASE::"Linked Trade Item");
                 IF g_table = DATABASE::"Shipping Order Line" THEN
                   CopyBtnVisible := TRUE
                 ELSE
                   CopyBtnVisible := FALSE;
               END;

    OnFindRecord=VAR
                   Found@1100525000 : Boolean;
                 BEGIN
                   Found := FindPosition(Which);
                   EXIT(Found);
                 END;

    OnNextRecord=VAR
                   lAdviceOrderLine@1100525000 : Record 11012055;
                   NextStep@1100525001 : Integer;
                 BEGIN
                   lAdviceOrderLine.COPY(Rec);
                   NextStep := NextPosition(lAdviceOrderLine,Steps);
                   IF NextStep <> 0 THEN Rec.COPY(lAdviceOrderLine);
                   EXIT(NextStep);
                 END;

    OnAfterGetRecord=VAR
                       ServiceOrder@1100529600 : Record 11012823;
                     BEGIN
                       InventoryReservation("Item No.");
                       CALCFIELDS("Vendor Name (Trade Item)", "Vendor Name", "Manufacturer Name");
                       CALCFIELDS("Description Project", "Description Element", "Description Extension");  //db, 01-02-07
                       IF FPSLicenseManagement.LicenseAndReadPermissionForTable(ServiceOrder) THEN
                         CALCFIELDS("Description Service Order");
                       RefQuote := RouteRefMgtCU.GetQuoteOfReference("Purchase Route Reference");
                       RefPurchOrder := RouteRefMgtCU.GetPurchOrderOfReference("Purchase Route Reference");
                       GetItemSpecifications;
                       VendorPrice := GetVendorPrice(Vendor, "Price (LCY)", VendorCurrency);  //db, 20-11-08
                       StrategicPurchMgt.FindContractForAdviceOrder(Rec); //**4PS.n

                       OnAfterGetCurrentRecord;
                       SetControlAppearance;
                       CurrPage.PendingApprovalFactBox.PAGE.SetFilterOnRecordID(RECORDID);
                       CurrPage.ApprovalFactBox.PAGE.SetFilterOnRecordID(RECORDID);
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  InitRecord;
                  RefQuote := '';
                  RefPurchOrder := '';
                  VendorPrice := 0;      //db, 20-11-08
                  VendorCurrency := '';  //db, 20-11-08
                  OnAfterGetCurrentRecord;
                END;

    OnInsertRecord=BEGIN
                     VALIDATE("Line No.");
                     //** 0=signal for table trigger to determine first free number
                     //** autosplitkey not used because of problems with suppress processed orders
                     IF TableLinkedTradeItemInLicense THEN
                       LinkedTradeItem.AddTradeItemsAdviceOrderLine(Rec, 0);
                   END;

    OnModifyRecord=BEGIN
                     SetEditable;
                     IF TableLinkedTradeItemInLicense THEN
                       LinkedTradeItem.AddTradeItemsAdviceOrderLine(Rec, 1);
                   END;

    OnAfterGetCurrRecord=VAR
                           RecRef@1100529600 : RecordRef;
                         BEGIN
                           SetControlAppearance;
                           CurrPage.PendingApprovalFactBox.PAGE.SetFilterOnRecordID(RECORDID);
                           CurrPage.ApprovalFactBox.PAGE.SetFilterOnRecordID(RECORDID);

                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1210190032;1 ;ActionGroup;
                      CaptionML=[ENU=Advice &Order;
                                 NOR=Bestillings&underlag;
                                 SVE=Best„llnings&underlag] }
      { 1210190037;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Project List;
                                 NOR=Prosjekt Í liste;
                                 SVE=Projekt Í lista];
                      Image=List;
                      OnAction=VAR
                                 lvProjRec@1210190000 : Record 11072003;
                               BEGIN
                                 lvProjRec."No." := "Project No.";
                                 PAGE.RUNMODAL(0, lvProjRec);
                               END;
                                }
      { 1210190040;2 ;Action    ;
                      CaptionML=[ENU=&Purchase Route References;
                                 NOR=&Referanser for innkj›psrute;
                                 SVE=&Referenser f”r ink”psf”ljd];
                      Image=ContactReference;
                      OnAction=BEGIN
                                 ShowPurchRouteRef();
                               END;
                                }
      { 1100485045;2 ;Action    ;
                      AccessByPermission=TableData 11012823=R;
                      CaptionML=[ENU=Purchase Order (Service Order);
                                 NOR=Innkj›psordre (serviceordre);
                                 SVE=Ink”psorder (serviceorder)];
                      Image=ServiceMan;
                      OnAction=VAR
                                 ServiceOrder@1100528400 : Record 11012823;
                               BEGIN
                                 IF ServiceOrder.GET("Service Order No.") THEN
                                   ServiceOrder.ShowPurchaseOrdersForServiceOrder;
                               END;
                                }
      { 1100525000;2 ;Action    ;
                      CaptionML=[ENU=Purchase Order (Job);
                                 NOR=Innkj›psordre (jobb);
                                 SVE=Ink”psorder (jobb)];
                      Image=Job;
                      OnAction=VAR
                                 Job@1100528400 : Record 11072003;
                               BEGIN
                                 IF Job.GET("Project No.") THEN
                                   Job.ShowPurchaseOrdersForProject;
                               END;
                                }
      { 1100528901;2 ;Action    ;
                      CaptionML=[ENU=Purchase &Line details;
                                 NOR=Innkj›ps&raddetaljer;
                                 SVE=Ink”ps&raddetaljer];
                      Image=ViewCheck;
                      OnAction=BEGIN
                                 IF EditLineDetails(FieldEditable AND ("Process Status" < "Process Status"::Processed)) THEN
                                   CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100485046;2 ;Action    ;
                      CaptionML=[ENU=Item &Journal;
                                 NOR=&Varekladd;
                                 SVE=&Artikeljournal];
                      Image=Journals;
                      OnAction=VAR
                                 ItemJnlTemplate@1100485001 : Record 82;
                                 ItemJnlLine@1100485000 : Record 83;
                               BEGIN
                                 ProjSetup.GET;
                                 IF ItemJnlTemplate.GET(ProjSetup."Inventory Journal Template") THEN BEGIN
                                   ItemJnlLine.FILTERGROUP := 2;
                                   ItemJnlLine.SETRANGE("Journal Template Name",ItemJnlTemplate.Name);
                                   ItemJnlLine.FILTERGROUP := 0;
                                   IF "Record Type" = "Record Type"::Project THEN
                                     ItemJnlLine.SETRANGE("Job No.","Project No.");
                                   IF "Record Type" = "Record Type"::ServOrder THEN
                                     ItemJnlLine.SETRANGE("Service Order No.","Service Order No.");
                                   PAGE.RUN(ItemJnlTemplate."Page ID",ItemJnlLine);
                                 END ELSE BEGIN
                                   PAGE.RUN(PAGE::"Item Journal", ItemJnlLine);  //db, 18-05-05: called form determines default template
                                 END;
                               END;
                                }
      { 1100525143;2 ;Action    ;
                      CaptionML=[ENU=Item Availability by Period;
                                 NOR=Artikkelens tilgjengelighet etter periode;
                                 SVE=Artikelns tillg„nglighet efter period];
                      Image=Period;
                      OnAction=BEGIN
                                 ShowItemAvailbyPeriod;
                               END;
                                }
      { 1210190074;2 ;Action    ;
                      CaptionML=[ENU=Doc&uments;
                                 NOR=Dok&ument;
                                 SVE=Dok&ument];
                      Image=Documents;
                      OnAction=BEGIN
                                 ShowDocuments;
                               END;
                                }
      { 1100528902;2 ;Action    ;
                      CaptionML=[ENU=&Comment Lines (Advice Order Line);
                                 NOR=&Kommentarrader (bestillingsunderlagsrad);
                                 SVE=&Kommentarsrader (best„llningsunderlagsrad)];
                      Image=Comment;
                      OnAction=BEGIN
                                 EditCommentLines();
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100528400;1 ;Action    ;
                      Name=CopyBtn;
                      CaptionML=[ENU=Copy;
                                 NOR=KOPIER;
                                 SVE=Kopiera];
                      Promoted=Yes;
                      Visible=CopyBtnVisible;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 AdviceOrderLine@1100528400 : Record 11012055;
                                 MultipleCopyManagement@1100528401 : Codeunit 11012068;
                               BEGIN
                                 IF g_table = DATABASE::"Shipping Order Line" THEN BEGIN
                                   AdviceOrderLine.COPY(Rec);
                                   CurrPage.SETSELECTIONFILTER(AdviceOrderLine);
                                   MultipleCopyManagement.SetSelectionShippingOrder(g_table, g_int1, g_code1, g_int2, '');
                                   MultipleLinesCopied := MultipleCopyManagement.CopyAdviceOrderLineToShippingLine(AdviceOrderLine);
                                   CurrPage.CLOSE;
                                 END;
                               END;
                                }
      { 1210190006;1 ;Action    ;
                      CaptionML=[ENU=&Text;
                                 NOR=&Tekst;
                                 SVE=&Text];
                      Promoted=Yes;
                      Image=SNInfo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 EditText;
                               END;
                                }
      { 1100528208;1 ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning;
                                 SVE=Godk„nnande] }
      { 1100528205;2 ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn;
                                 SVE=Godk„nn];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528206;2 ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528204;2 ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger;
                                 SVE=Delegera];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528203;2 ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader;
                                 SVE=Kommentarer];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1100528500 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 1210190007;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=Fu&nksjon;
                                 SVE=Fu&nktion] }
      { 1210190011;2 ;Action    ;
                      CaptionML=[ENU=Select Budget Lines;
                                 NOR=Velg Budsjettrader;
                                 SVE=V„lj budgetrader];
                      Image=GetLines;
                      OnAction=BEGIN
                                 Budget;
                               END;
                                }
      { 1210190012;2 ;Action    ;
                      CaptionML=[ENU=Select Purchase Actions;
                                 NOR=Velg Innkj›pshandlinger;
                                 SVE=V„lj ink”ps†tg„rder];
                      Image=GetEntries;
                      OnAction=BEGIN
                                 PurchaseAction;
                               END;
                                }
      { 1210190016;2 ;ActionGroup;
                      CaptionML=[ENU=Display Selection;
                                 NOR=Visningsvalg;
                                 SVE=Visa val];
                      Image=Alerts }
      { 1210190017;3 ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=All Advice Orders;
                                 NOR=Alle bestillingsunderlag;
                                 SVE=Alla best„llningsunderlag];
                      Image=AllLines;
                      OnAction=BEGIN
                                 Toggle(0);
                               END;
                                }
      { 1210190018;3 ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=Open Advice Orders;
                                 NOR=pne bestillingsunderlag;
                                 SVE=™ppna best„llningsunderlag];
                      Image=OpenJournal;
                      OnAction=BEGIN
                                 Toggle(1);
                               END;
                                }
      { 1100485027;3 ;Action    ;
                      ShortCutKey=Shift+Ctrl+F9;
                      CaptionML=[ENU=Released Advice Orders;
                                 NOR=Frigitte bestillingsunderlag;
                                 SVE=Sl„ppta best„llningsunderlag];
                      Image=ReleaseShipment;
                      OnAction=BEGIN
                                 Toggle(3);
                               END;
                                }
      { 1210190019;3 ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Processed Advice Orders;
                                 NOR=Behandlede bestillingsunderlag;
                                 SVE=Behandlade best„llningsunderlag];
                      Image=Reuse;
                      OnAction=BEGIN
                                 Toggle(2);
                               END;
                                }
      { 1100528403;2 ;ActionGroup;
                      CaptionML=[ENU=Price;
                                 NOR=Pris;
                                 SVE=Pris];
                      Image=Price }
      { 1100525057;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Update Price;
                                 NOR=Aktualiser pris;
                                 SVE=F”rverkliga pris];
                      RunObject=Report 11020314;
                      Image=Price }
      { 1100525051;3 ;Action    ;
                      CaptionML=[ENU=Divide Agreed Amount;
                                 NOR=Del avtalt bel›p;
                                 SVE=Dela avtalat belopp];
                      Image=PriceAdjustment;
                      OnAction=VAR
                                 AdviceOrderLine@1100525001 : Record 11012055;
                               BEGIN
                                 GetRecSelection(AdviceOrderLine);
                                 DivideAgreedAmount(AdviceOrderLine); //mg, 08-02-11: M24388
                               END;
                                }
      { 1100528402;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Find Lowest Price Trade Items;
                      Image=PriceAdjustment;
                      OnAction=VAR
                                 AdviceOrderLine@1100528400 : Record 11012055;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(AdviceOrderLine);
                                 AdviceOrderLine.FindLowestPriceTradeItems;
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1100528401;2 ;ActionGroup;
                      CaptionML=[ENU=Lines;
                                 NOR=Rader;
                                 SVE=Rader];
                      Image=AllLines }
      { 1210190014;3 ;Action    ;
                      CaptionML=[ENU=Compress Advice Orders;
                                 NOR=Komprimer bestillingsunderlag;
                                 SVE=Komprimera best„llningsunderlag];
                      Image=Compress;
                      OnAction=BEGIN
                                 Compress;
                               END;
                                }
      { 1210190015;3 ;Action    ;
                      CaptionML=[ENU=Split Advice Orders;
                                 NOR=Del bestillingsunderlag;
                                 SVE=Dela best„llningsunderlag];
                      Image=Splitlines;
                      OnAction=BEGIN
                                 Split;
                               END;
                                }
      { 1100525013;3 ;Action    ;
                      CaptionML=[ENU=Divid&e Advice Orders;
                                 NOR=D&el opp bestillingsunderlag;
                                 SVE=D&ela best„llningsunderlag];
                      Image=Allocate;
                      OnAction=BEGIN
                                 Divide;
                               END;
                                }
      { 1100485044;2 ;Action    ;
                      CaptionML=[ENU=Release Advice Orders;
                                 NOR=Frigi bestillingsunderlag;
                                 SVE=Sl„pp best„llningsunderlag];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Approve;
                               END;
                                }
      { 1100525008;2 ;Action    ;
                      CaptionML=[ENU=Remove Advice Orders;
                                 NOR=Fjern bestillingsunderlag;
                                 SVE=Ta bort best„llningsunderlag];
                      Visible=FALSE;
                      Image=Delete;
                      OnAction=VAR
                                 AdviceOrderLine@1100528600 : Record 11012055;
                               BEGIN
                                 GetRecSelection(AdviceOrderLine);
                                 AdviceCu.RemoveAdviceOrders(AdviceOrderLine);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1100525014;2 ;Action    ;
                      CaptionML=[ENU=Calculate availability;
                                 NOR=Beregn tilgjengelighet;
                                 SVE=Ber„kna tillg„nglighet];
                      Image=ReleaseDoc;
                      OnAction=VAR
                                 AdviceOrderLine@1100525001 : Record 11012055;
                               BEGIN
                                 GetRecSelection(AdviceOrderLine);
                                 AdviceCu.UpdateLines(AdviceOrderLine);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1100525029;2 ;Action    ;
                      CaptionML=ENU=Modi&fy Collectively;
                      Image=ChangeBatch;
                      OnAction=BEGIN
                                 ModifyRun;
                               END;
                                }
      { 1210190023;2 ;Action    ;
                      CaptionML=[ENU=Process Advice Orders Collectively;
                                 NOR=Behandle bestillingsunderlag kollektivt;
                                 SVE=Behandla best„llningsunderlag kollektivt];
                      Image=TransferToLines;
                      OnAction=BEGIN
                                 ProcessRun;
                               END;
                                }
      { 1100485030;2 ;Action    ;
                      CaptionML=[ENU=Modify Vendor Collectively;
                                 NOR=Endre leverand›r kollektivt;
                                 SVE=Žndra leverant”r kollektivt];
                      Image=Vendor;
                      OnAction=BEGIN
                                 UpdateVendor;
                               END;
                                }
      { 1210190026;2 ;Action    ;
                      CaptionML=[ENU=Advice Orders Reports;
                                 NOR=Bestillingsunderlag, Rapporter;
                                 SVE=Best„llningsunderlag, rapporter];
                      Image=Report;
                      OnAction=VAR
                                 AORec@11012001 : Record 11012055;
                                 PrintDoc@11012002 : Codeunit 229;
                               BEGIN
                                 AORec."Project No." := "Project No.";
                                 PrintDoc.PrintProjAdvice(AORec);
                               END;
                                }
      { 1100525006;1 ;ActionGroup;
                      CaptionML=[ENU=Generate;
                                 NOR=Generer;
                                 SVE=Generera] }
      { 1210190058;2 ;Action    ;
                      CaptionML=[ENU=Generate Purchase Quote;
                                 NOR=Generer innkj›pstilbud;
                                 SVE=Generera ink”psoffert];
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ProcessGenQuote;
                               END;
                                }
      { 1210190021;2 ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Generate Purchase Orders;
                                 NOR=Generer innkj›psordre;
                                 SVE=Generera ink”psorder];
                      Promoted=Yes;
                      Image=MakeOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ProcessPurchase;
                               END;
                                }
      { 1210190022;2 ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Generate Inventory Orders;
                                 NOR=Generer lagerordre;
                                 SVE=Generera lagerorder];
                      Promoted=Yes;
                      Image=InventoryJournal;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ProcessInventory;
                               END;
                                }
      { 1100525031;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+F9;
                      CaptionML=ENU=Generate Purchase Requisitions;
                      Promoted=Yes;
                      Image=CreateMovement;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ProcessPurchaseRequisition;
                               END;
                                }
      { 1210190085;2 ;Action    ;
                      CaptionML=[ENU=Generate Plant Requests;
                                 NOR=Generer maskinforesp›rsel;
                                 SVE=Generera Maskinsbeg„ran];
                      Image=Components;
                      OnAction=VAR
                                 AdviceOrderLine@1100529000 : Record 11012055;
                                 AdviceOrderMgt@1100529001 : Codeunit 11012041;
                               BEGIN
                                 //mg, 07-07-11: RFC605
                                 AdviceOrderLine.COPY(Rec);
                                 CurrPage.SETSELECTIONFILTER(AdviceOrderLine);
                                 AdviceOrderMgt.ProcessPlantRequest(AdviceOrderLine);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1100525050;2 ;Action    ;
                      CaptionML=[ENU=Create ICK Order Files;
                                 NOR=Opprette ICK-ordrefiler;
                                 SVE=Skapa ICK-orderfiler];
                      Image=CreateLedgerBudget;
                      OnAction=BEGIN
                                 GenerateICKOrder;  //db, 17-08-10: M15519
                               END;
                                }
      { 1100528207;1 ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning;
                                 SVE=Beg„r godk„nnande];
                      Image=Action }
      { 1100528200;2 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesp›rsel;
                                 SVE=Skicka godk&„nnandebeg„ran];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesp›rsel.;
                                 SVE=Beg„r godk„nnande av dokumentet.];
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalManagement4PSConstr@1000 : Codeunit 11125349;
                               BEGIN
                                 IF ApprovalManagement4PSConstr.CheckAdviceOrderLineApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsBridge4PSConstruct.OnSendAdviceOrderLineForApproval(Rec);
                               END;
                                }
      { 1100528201;2 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesp›rsel;
                                 SVE=Annullera &godk„nnandebeg„ran];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesp›rselen.;
                                 SVE=Annullera godk„nnandebeg„ran.];
                      Enabled=CanCancelApprovalForRecord;
                      Image=CancelApprovalRequest;
                      OnAction=BEGIN
                                 ApprovalsBridge4PSConstruct.OnCancelAdviceOrderLineApprovalRequest(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=PRP;
                GroupType=Repeater }

    { 1100485002;2;Field  ;
                SourceExpr="Record Type" }

    { 2   ;2   ;Field     ;
                SourceExpr="Project No.";
                Editable=FALSE }

    { 1100525042;2;Field  ;
                SourceExpr="Description Project";
                Visible=FALSE }

    { 1210190025;2;Field  ;
                SourceExpr="Yard No.";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1210190063;2;Field  ;
                SourceExpr="System No.";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1210190028;2;Field  ;
                SourceExpr="Entity Type";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1210190069;2;Field  ;
                SourceExpr="Entity No.";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1210190071;2;Field  ;
                SourceExpr="Cable Transit Pos.";
                Visible=FALSE;
                Editable=FieldEditable }

    { 6   ;2   ;Field     ;
                SourceExpr=Element;
                Visible=FALSE;
                Editable=ElementEditable }

    { 1100525044;2;Field  ;
                SourceExpr="Description Element";
                Visible=FALSE }

    { 1210190004;2;Field  ;
                SourceExpr="Extension Contract";
                Visible=FALSE;
                Editable=ExtensionContractEditable }

    { 1100525046;2;Field  ;
                SourceExpr="Description Extension";
                Visible=FALSE }

    { 1100525017;2;Field  ;
                SourceExpr="Plot No.";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1100485000;2;Field  ;
                SourceExpr="Service Order No.";
                Editable=FALSE }

    { 1100525048;2;Field  ;
                SourceExpr="Description Service Order";
                Visible=FALSE }

    { 1100528501;2;Field  ;
                SourceExpr="Service Location No.";
                Visible=FALSE }

    { 1100528503;2;Field  ;
                SourceExpr="Service Location Description";
                Visible=FALSE }

    { 1100528500;2;Field  ;
                SourceExpr="Service Contract No.";
                Visible=FALSE }

    { 1100528504;2;Field  ;
                SourceExpr="Service Contract Description";
                Visible=FALSE }

    { 1100528900;2;Field  ;
                SourceExpr="G/L Account";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Line No.";
                Visible=FALSE }

    { 1210190038;2;Field  ;
                SourceExpr="Recipe Group";
                Visible=FALSE;
                Editable=FALSE }

    { 1210190046;2;Field  ;
                SourceExpr=Recipe;
                Visible=FALSE;
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Item No.";
                Editable=FieldEditable;
                OnValidate=BEGIN
                             InventoryReservation("Item No.");
                             SetEditable;
                             CurrPage.UPDATE;
                           END;

                OnLookup=BEGIN
                           HandleItemLookup(1);
                         END;
                          }

    { 1100529600;2;Field  ;
                SourceExpr="Item Operation Code";
                Visible=FALSE;
                Editable=FieldEditable }

    { 10  ;2   ;Field     ;
                SourceExpr=Manufacturer;
                Enabled=ManufacturerEnabled;
                Editable=FieldEditable }

    { 12  ;2   ;Field     ;
                SourceExpr="Basic Item";
                Enabled="Basic ItemEnabled";
                Editable=FieldEditable;
                OnValidate=BEGIN
                             InventoryReservation("Item No.");
                             CurrPage.UPDATE;
                           END;

                OnLookup=BEGIN
                           HandleItemLookup(2);
                         END;
                          }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor (Trade Item)";
                Enabled="Vendor (Trade Item)Enabled";
                Editable=FieldEditable }

    { 1210190086;2;Field  ;
                DrillDown=No;
                SourceExpr="Vendor Name (Trade Item)";
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Trade Item";
                Enabled="Trade ItemEnabled";
                Editable=FieldEditable;
                OnValidate=BEGIN
                             InventoryReservation("Item No.");
                             CurrPage.UPDATE;
                           END;

                OnLookup=VAR
                           lvTempAdviceOrderLine@1100525002 : TEMPORARY Record 11012055;
                         BEGIN
                           IF "Item No." <> '' THEN BEGIN
                             lvTempAdviceOrderLine.COPY(Rec);  //db, 21-08-09
                             lvTempAdviceOrderLine.VALIDATE("Item No.","Item No.");
                             g_ItemCode := lvTempAdviceOrderLine."Trade Item";
                             g_Vendor := lvTempAdviceOrderLine."Vendor (Trade Item)";
                           END ELSE BEGIN
                             g_ItemCode := '';
                             g_Vendor := '';
                           END;

                           HandleItemLookup(3);
                         END;

                OnAssistEdit=VAR
                               ZoomType@1100528600 : Integer;
                             BEGIN
                               ZoomType := 3;
                               AssistEditItemData(ZoomType);
                               IF ZoomType = -1 THEN
                                 CurrPage.UPDATE(TRUE);
                             END;
                              }

    { 1100485017;2;Field  ;
                SourceExpr="Item Brand";
                Visible=FALSE }

    { 1100485019;2;Field  ;
                SourceExpr="Item Type";
                Visible=FALSE }

    { 1100485021;2;Field  ;
                SourceExpr="Item Series";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Shelf No. (Item)";
                Visible=FALSE }

    { 1100525021;2;Field  ;
                SourceExpr="Shelf No. (SKU)";
                Visible=FALSE }

    { 1100525058;2;Field  ;
                SourceExpr="Subcontracting Activity";
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 22  ;2   ;Field     ;
                SourceExpr=Vendor;
                Editable=FieldEditable;
                OnValidate=BEGIN
                             CurrPage.UPDATE;  //DP00884: refresh VendorPrice
                           END;

                OnAssistEdit=BEGIN
                               LookupItemVendor(FieldEditable);
                             END;
                              }

    { 1210190088;2;Field  ;
                DrillDown=No;
                SourceExpr="Vendor Name";
                Visible=FALSE;
                Editable=FALSE }

    { 1100529002;2;Field  ;
                SourceExpr="Plant Company";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1210190078;2;Field  ;
                SourceExpr="Plant Location";
                Visible=FALSE;
                Editable=FieldEditable;
                OnAssistEdit=BEGIN
                               LookupPlantLocationWithAssistEdit;
                             END;
                              }

    { 1210190080;2;Field  ;
                SourceExpr="Plant Type";
                Visible=FALSE;
                Editable=FieldEditable }

    { 24  ;2   ;Field     ;
                SourceExpr="Cost Type";
                Editable=CostTypeEditable }

    { 26  ;2   ;Field     ;
                SourceExpr="Cost Object";
                Editable=FieldEditable;
                LookupPageID=Cost Object List }

    { 1100485025;2;Field  ;
                SourceExpr="Cost Component";
                Visible=FALSE;
                Editable=CostComponentEditable }

    { 1100485023;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                Editable=GlobalDim1Editable;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1100529000;2;Field  ;
                SourceExpr="FSC Type Code";
                Visible=FALSE;
                Editable=FieldEditable }

    { 28  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FieldEditable }

    { 30  ;2   ;Field     ;
                SourceExpr="Description 2";
                Editable=FieldEditable }

    { 1210190002;2;Field  ;
                SourceExpr="External Text Block";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              EditText;
                            END;
                             }

    { 1100525015;2;Field  ;
                SourceExpr="Price Agreement";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1100525019;2;Field  ;
                SourceExpr="Additional Cost (Service)";
                Visible=FALSE;
                Editable=AdditionalCostServiceEditable }

    { 32  ;2   ;Field     ;
                SourceExpr="Quantity (Budget)" }

    { 38  ;2   ;Field     ;
                SourceExpr="Quantity (Advice)";
                Editable=[QuantityAdviceEditable ] }

    { 40  ;2   ;Field     ;
                SourceExpr="Quantity (Processed)";
                Editable=FALSE }

    { 1100485014;2;Field  ;
                CaptionML=[ENU=Quantity Received;
                           NOR=Mottatt (antall);
                           SVE=Inlevererat antal];
                SourceExpr=ReceivedPurchaseQuantity('');
                Editable=FALSE }

    { 1100409001;2;Field  ;
                CaptionML=ENU=Reserved Inventory;
                SourceExpr=QtyReservedInventory();
                OnDrillDown=BEGIN
                              DrilDownReservedInventory();
                            END;
                             }

    { 1100409000;2;Field  ;
                CaptionML=ENU=Delivered Inventory;
                SourceExpr=QtyDeliveredInventory();
                OnDrillDown=BEGIN
                              DrillDownDeliveredInventory();
                            END;
                             }

    { 1100525040;2;Field  ;
                CaptionML=[ENU=Deliverable Quantity;
                           NOR=Leverbart antall;
                           SVE=Levererbart antal];
                SourceExpr=GetDeliverableQuantity() }

    { 34  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Editable=UnitOfMeasureEditable }

    { 42  ;2   ;Field     ;
                SourceExpr=Transaction;
                Editable=FieldEditable;
                OnValidate=BEGIN
                             InventoryReservation("Item No.");
                             IF InventoryQuan < "Quantity (Advice)" THEN
                               IF Transaction = Transaction::Inventory THEN
                                 MESSAGE(Text000);
                             SetEditable;
                           END;
                            }

    { 1210190065;2;Field  ;
                SourceExpr="Gross Price (LCY)";
                Visible=FALSE;
                Editable=FieldEditable;
                OnValidate=BEGIN
                             UpdatePriceAgreement;  //C047131
                           END;
                            }

    { 1100525053;2;Field  ;
                SourceExpr="Gross Price (FCY)";
                Visible=FALSE;
                Editable=FieldEditable;
                OnValidate=BEGIN
                             UpdatePriceAgreement;  //C047131
                           END;
                            }

    { 1210190067;2;Field  ;
                SourceExpr="Discount %";
                Visible=FALSE;
                Editable=FieldEditable;
                OnValidate=BEGIN
                             UpdatePriceAgreement;  //C047131
                           END;
                            }

    { 36  ;2   ;Field     ;
                SourceExpr="Price (LCY)";
                Editable=[PriceEditable ];
                OnValidate=BEGIN
                             UpdatePriceAgreement;  //C047131
                           END;
                            }

    { 1100525052;2;Field  ;
                SourceExpr="Price (FCY)";
                Visible=FALSE;
                Editable=[PriceEditable ];
                OnValidate=BEGIN
                             UpdatePriceAgreement;  //C047131
                           END;
                            }

    { 1100525003;2;Field  ;
                CaptionML=ENU=Vendor Price (FCY);
                SourceExpr=VendorPrice;
                Visible=FALSE;
                Editable=VendorPriceEditable;
                OnValidate=BEGIN
                             VALIDATE("Price (LCY)", ConvertVendorPrice(Vendor, VendorPrice));
                           END;
                            }

    { 1100525001;2;Field  ;
                CaptionML=ENU=Currency (Vendor);
                SourceExpr=VendorCurrency;
                Visible=FALSE;
                Editable=FALSE }

    { 1100525007;2;Field  ;
                SourceExpr="Sales Price (LCY)";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1100525055;2;Field  ;
                SourceExpr="Sales Price (FCY)";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1100525005;2;Field  ;
                SourceExpr="Amount (LCY)" }

    { 1100525056;2;Field  ;
                SourceExpr="Amount (FCY)";
                Visible=FALSE }

    { 1210190052;2;Field  ;
                SourceExpr="Process Status";
                Editable=ProcessStatusEditable;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 44  ;2   ;Field     ;
                SourceExpr=Processed;
                Editable=FALSE }

    { 1100528300;2;Field  ;
                SourceExpr="Supplying Company Inventory";
                Editable=SupplyingCompInvEditable;
                OnValidate=BEGIN
                             InventoryReservation("Item No.");
                           END;
                            }

    { 46  ;2   ;Field     ;
                CaptionML=[ENU=Inventory;
                           NOR=Lager;
                           SVE=Lager];
                SourceExpr=InventoryQuan;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              DrillDownInventory(ShowLocations::All);
                            END;
                             }

    { 1100525009;2;Field  ;
                CaptionML=[ENU=Inventory pref. locations;
                           NOR=Foretrukket Lagerplassering;
                           SVE=F”rvalda lagerst„llen];
                SourceExpr=InventoryPrefLocations;
                OnDrillDown=BEGIN
                              DrillDownInventory(ShowLocations::PrefLocations);
                            END;
                             }

    { 1100525011;2;Field  ;
                CaptionML=[ENU=Location Inventory;
                           NOR=Lagerplassering;
                           SVE=Lagerst„lle];
                SourceExpr=LocInventoryQuan;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              DrillDownInventory(ShowLocations::Location);
                            END;
                             }

    { 48  ;2   ;Field     ;
                CaptionML=[ENU=Reserved;
                           NOR=Reservert;
                           SVE=Reserverat];
                SourceExpr=ReservedQuan;
                Editable=FALSE;
                OnDrillDown=VAR
                              ItemJnlLineRec@1210190001 : Record 83;
                            BEGIN
                              IF ItemRec.GET("Item No.") THEN BEGIN
                                IF ("Supplying Company Inventory" <> '') THEN
                                  ItemJnlLineRec.CHANGECOMPANY("Supplying Company Inventory");

                                ItemJnlLineRec.SETRANGE("Item No.", ItemRec."No.");
                                ItemJnlLineRec."Job No." := "Project No.";
                                PAGE.RUN(0,ItemJnlLineRec);
                              END;
                            END;
                             }

    { 50  ;2   ;Field     ;
                CaptionML=[ENU=Base Unit of Measure;
                           NOR=Lagerenhet;
                           SVE=Basenhet];
                SourceExpr=InventoryUnit;
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Order Date";
                Editable=FieldEditable }

    { 54  ;2   ;Field     ;
                SourceExpr="Delivery Period";
                Editable=FieldEditable }

    { 56  ;2   ;Field     ;
                SourceExpr="Receipt Date";
                Editable=FieldEditable }

    { 1100525049;2;Field  ;
                SourceExpr="Requested Receipt Date";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1210190082;2;Field  ;
                SourceExpr="Expected return on";
                Visible=FALSE;
                Editable=FieldEditable }

    { 60  ;2   ;Field     ;
                SourceExpr="Location Code";
                Editable=LocationCodeEditable;
                OnValidate=BEGIN
                             IF Transaction = Transaction::Inventory THEN
                               LocRec.GET("Location Code");
                           END;
                            }

    { 1100526200;2;Field  ;
                SourceExpr="Bin Code";
                Editable=BinCodeEditable }

    { 58  ;2   ;Field     ;
                SourceExpr=Deliver;
                Editable=FieldEditable }

    { 62  ;2   ;Field     ;
                SourceExpr="Ship To Location";
                Editable=FieldEditable }

    { 64  ;2   ;Field     ;
                SourceExpr="Purchase Action";
                Editable=FieldEditable }

    { 66  ;2   ;Field     ;
                SourceExpr="Purchase Phase";
                Editable=FieldEditable }

    { 1210190050;2;Field  ;
                SourceExpr="Purchaser Code";
                Editable=FieldEditable }

    { 1210190000;2;Field  ;
                SourceExpr="Negotiation recommended";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1210190059;2;Field  ;
                SourceExpr="Ask for Quote";
                Editable=FieldEditable }

    { 1210190056;2;Field  ;
                CaptionML=[ENU=Quote No.;
                           NOR=Foresp›rselsnr.;
                           SVE=Offertnr];
                SourceExpr=RefQuote;
                Visible=FALSE;
                Editable=FALSE;
                OnLookup=VAR
                           lvPurchHeadRec@1210190000 : Record 38;
                         BEGIN
                           IF (RefQuote = '') THEN
                             EXIT;

                           IF (COPYSTR(RefQuote, 1, 1) = '<') THEN  // IF Quote No. is '<Nr.>', then more than one quote present
                             RouteRefMgtCU.ShowReferenceQuoteList("Purchase Route Reference")
                           ELSE BEGIN
                             lvPurchHeadRec.SETRANGE("Document Type", lvPurchHeadRec."Document Type"::Quote);
                             lvPurchHeadRec.SETRANGE("No.", RefQuote);
                             PAGE.RUNMODAL(PAGE::"Purchase Quote", lvPurchHeadRec);
                           END;
                         END;
                          }

    { 1210190061;2;Field  ;
                CaptionML=[ENU=Purchase Order;
                           NOR=Innkj›psordre;
                           SVE=Ink”psorder];
                SourceExpr=RefPurchOrder;
                Visible=FALSE;
                Editable=FALSE;
                OnLookup=VAR
                           lvPurchHeadRec@1210190000 : Record 38;
                         BEGIN
                           IF (RefPurchOrder = '') THEN
                             EXIT;

                           IF (COPYSTR(RefPurchOrder, 1, 1) = '<') THEN  // IF Order No. is '<Nr.>', then more than one order present
                             RouteRefMgtCU.ShowReferencePurchOrderList("Purchase Route Reference")
                           ELSE BEGIN
                             lvPurchHeadRec.SETRANGE("Document Type", lvPurchHeadRec."Document Type"::Order);
                             lvPurchHeadRec.SETRANGE("No.", RefPurchOrder);
                             PAGE.RUNMODAL(PAGE::"Purchase Order", lvPurchHeadRec);
                           END;
                         END;
                          }

    { 1210190054;2;Field  ;
                SourceExpr="Purchase Route Reference";
                Visible=FALSE }

    { 1210190009;2;Field  ;
                SourceExpr="Created by" }

    { 1100525038;2;Field  ;
                SourceExpr="Created by Employee No.";
                Visible=FALSE }

    { 1210190042;2;Field  ;
                SourceExpr="Date Created" }

    { 1210190044;2;Field  ;
                SourceExpr="Modified by" }

    { 1210190048;2;Field  ;
                SourceExpr="Last Date Modified" }

    { 1100485032;2;Field  ;
                SourceExpr="E-Plan Item";
                Visible=FALSE }

    { 1100485036;2;Field  ;
                SourceExpr="Scheme Code";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1100485034;2;Field  ;
                SourceExpr="Comments for Logistics";
                Visible=FALSE;
                Editable=FieldEditable }

    { 1100525030;2;Field  ;
                SourceExpr="Contract Type" }

    { 1100525027;2;Field  ;
                CaptionML=[ENU=Blanket Order;
                           NOR=Rammebestilling;
                           SVE=Avropsorder];
                SourceExpr=StrategicPurchMgt.NumberOfBlOrdersAdviceOrder(Rec);
                OnLookup=BEGIN
                           StrategicPurchMgt.LookupBlOrderAdviceOrder(Rec);
                         END;
                          }

    { 1100525032;2;Field  ;
                CaptionML=[ENU=Blanket Order Line;
                           NOR=Rammeordrerad;
                           SVE=Avropsorderrad];
                SourceExpr=StrategicPurchMgt.NumberOfBlOrderLinesAdvOrder(Rec);
                OnLookup=BEGIN
                           StrategicPurchMgt.LookupBlOrderLinesAdviceOrder(Rec);
                         END;
                          }

    { 1100525034;2;Field  ;
                CaptionML=[ENU=Quantity in Blanket Order;
                           NOR=Antall i rammeordre;
                           SVE=Antal i avropsorder];
                SourceExpr=StrategicPurchMgt.QtyInBlanketOrdersAdviceOrder(Rec) }

    { 1210190075;2;Field  ;
                CaptionML=[ENU=Documents;
                           NOR=Dokumenter;
                           SVE=Dokument];
                SourceExpr=HasDocumentLinks;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ShowDocuments;
                            END;
                             }

    { 1100525012;2;Field  ;
                SourceExpr="Vendor No. (Item Card)" }

    { 1100525010;2;Field  ;
                SourceExpr="Vendor Item No. (Item Card)" }

    { 1100525045;2;Field  ;
                SourceExpr="Bin Code (Project Inventory)" }

    { 1100525018;1;Group  ;
                CaptionML=ENU=Service Order Filters;
                Visible=FiltersVisible;
                GroupType=Group }

    { 1100525022;2;Field  ;
                CaptionML=[ENU=Source Type Filter;
                           NOR=Kildetypefilter;
                           SVE=Ursprungstypsfilter];
                SourceExpr=SourceTypeFilter;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER("No.", SourceTypeFilter);
                             SourceTypeFilter := ServiceOrder.GETFILTER("No.");
                             ApplyFilters;
                           END;
                            }

    { 1100525016;2;Field  ;
                CaptionML=[ENU=Starting Date Filter;
                           NOR=Startdatofilter;
                           SVE=Startdatumfilter];
                SourceExpr=StartingDateFilter;
                OnValidate=VAR
                             ServiceOrder@1100528600 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER("Starting Date", StartingDateFilter);
                             StartingDateFilter := ServiceOrder.GETFILTER("Starting Date");
                             ApplyFilters;
                           END;
                            }

    { 1100525047;2;Field  ;
                CaptionML=ENU=Starting Time Filter;
                SourceExpr=StartingTimeFilter;
                Importance=Additional;
                OnValidate=VAR
                             ServiceOrder@1100528600 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER("Starting Time", StartingTimeFilter);
                             StartingTimeFilter := ServiceOrder.GETFILTER("Starting Time");
                             ApplyFilters;
                           END;
                            }

    { 1100525033;2;Field  ;
                CaptionML=[ENU=Status Filter;
                           NOR=Statusfilter;
                           SVE=Statusfilter];
                SourceExpr=StatusFilter;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER(Status, StatusFilter);
                             StatusFilter := ServiceOrder.GETFILTER(Status);
                             ApplyFilters;
                           END;
                            }

    { 1100525020;2;Field  ;
                Lookup=Yes;
                CaptionML=[ENU=Actual Reference Point Filter;
                           SVE=Verklig referenstidspunkt, filter];
                SourceExpr=ActualReferencePointFilter;
                TableRelation="Reference Point".No. WHERE (Apply=CONST(ServOrder));
                OnValidate=VAR
                             ReferencePoint@1100528600 : Record 11020271;
                           BEGIN
                             ReferencePoint.SETFILTER("No.", ActualReferencePointFilter);
                             ActualReferencePointFilter := ReferencePoint.GETFILTER("No.");
                             ApplyFilters;
                           END;

                OnLookup=VAR
                           ReferencePoint@1100525000 : Record 11020271;
                         BEGIN
                           CurrPage.UPDATE(TRUE);
                           ReferencePoint.RESET;
                           IF PAGE.RUNMODAL(0,ReferencePoint) = ACTION::LookupOK THEN BEGIN
                             ActualReferencePointFilter := ActualReferencePointFilter + FORMAT(ReferencePoint."No.");
                           END;
                         END;
                          }

    { 1100525035;2;Field  ;
                CaptionML=[ENU=Priority Filter;
                           NOR=Prioritetsfilter;
                           SVE=Prioritetsfilter];
                SourceExpr=PriorityFilter;
                TableRelation="Service Priority".Code;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER(Priority, PriorityFilter);
                             PriorityFilter := ServiceOrder.GETFILTER(Priority);
                             ApplyFilters;
                           END;
                            }

    { 1100525036;2;Field  ;
                CaptionML=[ENU=Discipline Filter;
                           NOR=Disiplinfilter;
                           SVE=Disciplinfilter];
                SourceExpr=DisciplineFilter;
                TableRelation=Discipline;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER(Discipline, DisciplineFilter);
                             DisciplineFilter := ServiceOrder.GETFILTER(Discipline);
                             ApplyFilters;
                           END;
                            }

    { 1100525037;2;Field  ;
                CaptionML=[ENU=Trade Speciality Filter;
                           NOR=SNI-nummerfilter;
                           SVE=SNI-nummerfilter];
                SourceExpr=TradeSpecialityFilter;
                TableRelation="Trade Speciality".Code;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER("Trade Speciality", TradeSpecialityFilter);
                             TradeSpecialityFilter := ServiceOrder.GETFILTER("Trade Speciality");
                             ApplyFilters;
                           END;
                            }

    { 1100525039;2;Field  ;
                CaptionML=[ENU=Order Kind filter;
                           SVE=Ordertypfilter];
                SourceExpr=OrderKindFilter;
                TableRelation="Service Order Indication".Code WHERE (Indication=CONST(Kind));
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER("Order Kind", OrderKindFilter);
                             OrderKindFilter := ServiceOrder.GETFILTER("Order Kind");
                             ApplyFilters;
                           END;
                            }

    { 1100525024;2;Field  ;
                CaptionML=ENU=Planned Employee No. Filter;
                SourceExpr=EmployeeNoFilter;
                TableRelation="Resource (WOP)" WHERE (Type=CONST(Employee));
                Importance=Additional;
                OnValidate=VAR
                             ResourceWOP@1100525000 : Record 11229278;
                           BEGIN
                             ResourceWOP.SETFILTER("No.", EmployeeNoFilter);
                             ResourceWOP.SETRANGE(Type, ResourceWOP.Type::Employee);
                             EmployeeNoFilter := ResourceWOP.GETFILTER("No.");
                             ApplyFilters;
                           END;
                            }

    { 1100525041;2;Field  ;
                CaptionML=[ENU=Territory Filter;
                           NOR=Distriktsfilter;
                           SVE=Distriktsfilter];
                SourceExpr=TerritoryFilter;
                TableRelation=Territory;
                Importance=Additional;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER("Territory Code", TerritoryFilter);
                             TerritoryFilter := ServiceOrder.GETFILTER("Territory Code");
                             ApplyFilters;
                           END;
                            }

    { 1100525026;2;Field  ;
                CaptionML=ENU=City Filter;
                SourceExpr=CityFilter;
                Importance=Additional;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER(City, CityFilter);
                             CityFilter := ServiceOrder.GETFILTER(City);
                             ApplyFilters;
                           END;
                            }

    { 1100525043;2;Field  ;
                CaptionML=ENU=Post code Filter;
                SourceExpr=PostcodeFilter;
                TableRelation="Post Code";
                Importance=Additional;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER("Post Code", PostcodeFilter);
                             PostcodeFilter := ServiceOrder.GETFILTER("Post Code");
                             ApplyFilters;
                           END;
                            }

    { 1100525028;2;Field  ;
                CaptionML=ENU=Address Filter;
                SourceExpr=AddressFilter;
                Importance=Additional;
                OnValidate=VAR
                             ServiceOrder@1100525000 : Record 11012823;
                           BEGIN
                             ServiceOrder.SETFILTER(Address, AddressFilter);
                             AddressFilter := ServiceOrder.GETFILTER(Address);
                             ApplyFilters;
                           END;
                            }

    { 1100525025;2;Field  ;
                CaptionML=[ENU=Customer No. Filter;
                           NOR=Kundenr.filter;
                           SVE=Kundnr];
                SourceExpr=CustomerNoFilter;
                TableRelation=Customer.No.;
                OnValidate=VAR
                             Customer@1100525000 : Record 18;
                           BEGIN
                             Customer.SETFILTER("No.", CustomerNoFilter);
                             CustomerNoFilter := Customer.GETFILTER("No.");
                             ApplyFilters;
                           END;
                            }

    { 1100529400;2;Field  ;
                CaptionML=ENU=Master Company Filter;
                SourceExpr=ChargeToCompanyFilter;
                TableRelation=Company;
                Importance=Additional;
                OnValidate=VAR
                             Company@1100525000 : Record 2000000006;
                           BEGIN
                             Company.SETFILTER(Company.Name, ChargeToCompanyFilter);
                             ChargeToCompanyFilter := Company.GETFILTER(Name);
                             ApplyFilters;
                           END;
                            }

    { 1100525023;2;Field  ;
                CaptionML=ENU=Master Project Filter;
                SourceExpr=ChargeToProjectFilter;
                TableRelation=Job WHERE (Internal Project=CONST(No));
                Importance=Additional;
                OnValidate=VAR
                             Job@1100525000 : Record 11072003;
                           BEGIN
                             Job.SETFILTER("No.", ChargeToProjectFilter);
                             ChargeToProjectFilter := Job.GETFILTER("No.");
                             ApplyFilters;
                           END;

                OnLookup=BEGIN
                           OnLookupJobNo;
                           ApplyFilters;
                         END;
                          }

    { 1100528600;2;Field  ;
                SourceExpr="Price History 0 Exists" }

    { 1100525002;0;Container;
                ContainerType=FactBoxArea }

    { 1100525004;1;Part   ;
                SubPageLink=Project No.=FIELD(Project No.),
                            Line No.=FIELD(Line No.),
                            Record Type=FIELD(Record Type),
                            Service Order No.=FIELD(Service Order No.);
                PagePartID=Page11130138;
                PartType=Page }

    { 1100528800;1;Part   ;
                Name=Item Features;
                CaptionML=[ENU=Item Features;
                           NOR=Artikkelfunksjoner;
                           SVE=Artikelfunktioner];
                SubPageLink=Item No.=FIELD(Item No.);
                PagePartID=Page11229268;
                PartType=Page }

    { 1100528209;1;Part   ;
                Name=PendingApprovalFactBox;
                ApplicationArea=#Suite;
                SubPageView=WHERE(Table ID=CONST(11012055));
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100529601;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100528210;1;Part   ;
                Name=ApprovalFactBox;
                SubPageView=WHERE(Table ID=CONST(11012055));
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1100528202;1;Part   ;
                Name=WorkflowStatus;
                ApplicationArea=#Suite;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

  }
  CODE
  {
    VAR
      Text000@11012025 : TextConst 'ENU=Unsufficient Stock present;NOR=Utilstrekkelig lagerbalanse;SVE=Otillr„cklig lagerbalans';
      ProjSetup@1100525007 : Record 315;
      ItemSetup@1100525006 : Record 11012300;
      LocRec@1210190000 : Record 14;
      ItemRec@1210190003 : Record 27;
      AdviceCu@1210190015 : Codeunit 11012041;
      RouteRefMgtCU@1210190012 : Codeunit 11012045;
      InventoryQuan@11012010 : Decimal;
      ReservedQuan@11012011 : Decimal;
      InventoryUnit@11012012 : Code[10];
      RefQuote@1210190011 : Code[20];
      RefPurchOrder@1210190014 : Code[20];
      gvPhase@1210190001 : Integer;
      gvRefRoute@1210190002 : Code[20];
      VendorPrice@1100525001 : Decimal;
      VendorCurrency@1100525000 : Code[20];
      LocInventoryQuan@1100525002 : Decimal;
      ShowLocations@1100525005 : 'All,PrefLocations,Location';
      g_ItemCode@1100525004 : Code[20];
      g_Vendor@1100525003 : Code[20];
      ContractFilter@1100525008 : ' ,No Contract,Contract,Contract with Discount Agreement,General Blanket Order,Project Blanket Order,Service Blanket Order';
      StrategicPurchMgt@1100525009 : Codeunit 11020211;
      BypassFiltering@1100525010 : Boolean;
      AdditionalCostServiceEditable@19048170 : Boolean INDATASET;
      "Basic ItemEnabled"@19042756 : Boolean INDATASET;
      "Trade ItemEnabled"@19042429 : Boolean INDATASET;
      ManufacturerEnabled@19015155 : Boolean INDATASET;
      "Vendor (Trade Item)Enabled"@19043796 : Boolean INDATASET;
      FieldEditable@1210190004 : Boolean INDATASET;
      ElementEditable@1210190005 : Boolean INDATASET;
      ExtensionContractEditable@1210190006 : Boolean INDATASET;
      CostTypeEditable@1210190009 : Boolean INDATASET;
      CostComponentEditable@1210190010 : Boolean INDATASET;
      QuantityAdviceEditable@1210190013 : Boolean INDATASET;
      UnitOfMeasureEditable@1210190016 : Boolean INDATASET;
      PriceEditable@1210190017 : Boolean INDATASET;
      VendorPriceEditable@1210190018 : Boolean INDATASET;
      LocationCodeEditable@1210190019 : Boolean INDATASET;
      BinCodeEditable@1210190020 : Boolean INDATASET;
      DPA_IsHardFilter@1100000999 : Boolean;
      ProcessStatusEditable@1210190022 : Boolean INDATASET;
      SupplyingCompInvEditable@1210190021 : Boolean INDATASET;
      FiltersVisible@1100528000 : Boolean INDATASET;
      SourceTypeFilter@1100525013 : Text[250];
      StartingDateFilter@1100525011 : Text[250];
      StartingTimeFilter@1100525026 : Text[250];
      StatusFilter@1100525019 : Text[250];
      ActualReferencePointFilter@1100525012 : Text[250];
      PriorityFilter@1100525020 : Code[250];
      DisciplineFilter@1100525021 : Code[250];
      TradeSpecialityFilter@1100525022 : Code[250];
      OrderKindFilter@1100525023 : Code[250];
      EmployeeNoFilter@1100525015 : Code[250];
      TerritoryFilter@1100525024 : Code[250];
      CityFilter@1100525018 : Text[250];
      PostcodeFilter@1100525025 : Code[250];
      AddressFilter@1100525017 : Text[250];
      CustomerNoFilter@1100525016 : Code[250];
      ChargeToCompanyFilter@1100529400 : Text[250];
      ChargeToProjectFilter@1100525014 : Code[250];
      PurchasesPayablesSetup@1100528500 : Record 312;
      OpenApprovalEntriesExist@1100528205 : Boolean;
      CanCancelApprovalForRecord@1100528204 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1100528203 : Boolean;
      ApprovalManagement4PSConstr@1100528202 : Codeunit 11125349;
      ApprovalsBridge4PSConstruct@1100528201 : Codeunit 11125348;
      ShowWorkflowStatus@1100528200 : Boolean;
      LinkedTradeItem@1100529600 : Record 11020466;
      TableLinkedTradeItemInLicense@1100525027 : Boolean;
      g_table@1100528410 : Integer;
      g_code1@1100528409 : Code[20];
      g_code2@1100528408 : Code[20];
      g_code3@1100528407 : Code[20];
      g_code4@1100528406 : Code[20];
      g_code5@1100528405 : Code[20];
      g_code6@1100528404 : Code[20];
      g_code7@1100528403 : Code[20];
      g_code8@1100528402 : Code[20];
      g_int1@1100528401 : Integer;
      g_int2@1100528400 : Integer;
      CopyBtnVisible@1100528411 : Boolean INDATASET;
      MultipleLinesCopied@1100528412 : Boolean;
      IgnoreServiceOrderFilters@1100528413 : Boolean;
      GlobalDim1Editable@1100529601 : Boolean INDATASET;
      FPSLicenseManagement@1100529602 : Codeunit 11229289;

    PROCEDURE Budget@8();
    BEGIN
      IF "Record Type" = "Record Type"::Project THEN
        AdviceCu.SelectProjectBudget("Project No.", '', '');
      IF "Record Type" = "Record Type"::ServOrder THEN
        AdviceCu.SelectServiceBudget("Service Order No.");
    END;

    PROCEDURE PurchaseAction@10();
    BEGIN
      IF "Record Type" = "Record Type"::Project THEN
        AdviceCu.SelectPurchaseAction("Project No.");
    END;

    PROCEDURE ProcessGenQuote@1210190006();
    VAR
      AdviceOrderLine@1210190000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      AdviceCu.ProcessGenQuote(AdviceOrderLine);
    END;

    PROCEDURE ProcessPurchase@2();
    VAR
      AdviceOrderLine@1100525000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      AdviceCu.SetPurchaserFromAdviceOrder(TRUE);
      AdviceCu.ProcessPurchase(AdviceOrderLine, FALSE, TRUE);  //PBRun= false, ItemRun=true
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE ProcessInventory@3();
    VAR
      AdviceOrderLine@1100525003 : Record 11012055;
      AdviceOrderLine2@1100525002 : Record 11012055;
      Counter@1100525001 : Integer;
      Text001@1100525004 : TextConst 'ENU=Do you want to recalculate the lines first?;NOR=Vil du rekalkulere radene f›rst?;SVE=Vill du omber„kna raderna f”rst?';
      Text002@1100525000 : TextConst 'ENU=There are %1 inverntory entries created in Item Journal.;NOR=%1 lagertransaksjoner er opprettet i artikkeljournalen.;SVE=%1 lagertransaktioner har skapats i artikeljournalen.';
    BEGIN
      GetRecSelection(AdviceOrderLine);
      CLEAR(AdviceCu); //CALL C019988 newline
      ProjSetup.GET;
      IF (ProjSetup."Inventory Calc. Advice Order" = ProjSetup."Inventory Calc. Advice Order"::Availability) THEN BEGIN
        IF CONFIRM(Text001) THEN BEGIN
          AdviceCu.SetSkipMessage;
          IF NOT AdviceOrderLine.ISEMPTY THEN                              //CALL C019988 newline
            AdviceCu.PreSetToTypeAndBatch(AdviceOrderLine, FALSE, TRUE);   //CALL C019988 newline

          IF AdviceOrderLine.FINDSET(TRUE,TRUE) THEN
            REPEAT
              AdviceOrderLine2 := AdviceOrderLine;
              AdviceOrderLine2.SETRECFILTER;
              AdviceOrderLine2.GetDefaultTransaction;
              AdviceOrderLine2.MODIFY;
              AdviceOrderLine2.MARK(TRUE);
              Counter += AdviceCu.ProcessInventory(AdviceOrderLine2, FALSE, TRUE);  //PBRun= false, ItemRun=true
            UNTIL AdviceOrderLine.NEXT = 0;
          MESSAGE(Text002,Counter);
        END ELSE
          AdviceCu.ProcessInventory(AdviceOrderLine, FALSE, TRUE);  //PBRun= false, ItemRun=true
      END ELSE
        AdviceCu.ProcessInventory(AdviceOrderLine, FALSE, TRUE);  //PBRun= false, ItemRun=true
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE ProcessPurchaseRequisition@1100525009();
    VAR
      AdviceOrderLine@1100525000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      AdviceCu.ProcessPurchaseRequisition(AdviceOrderLine);
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE ModifyRun@1100525003();
    VAR
      AdviceOrderLine@1100525000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      IF AdviceOrderLine.FINDSET THEN;
        AdviceCu.ModifyRun(AdviceOrderLine);
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE ProcessRun@12();
    BEGIN
      AdviceCu.ProcessRun(TRUE);  //ItemRun=true
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE Toggle@11(Phase@11012000 : Integer);
    BEGIN
      IF Phase = 0 THEN
        SETRANGE(Processed);
      IF Phase = 1 THEN
        SETRANGE(Processed, FALSE);
      IF Phase = 2 THEN
        SETRANGE(Processed, TRUE);
      IF Phase = 3 THEN BEGIN
        SETRANGE("Process Status", "Process Status"::Released);
        SETRANGE(Processed, FALSE);
      END ELSE BEGIN
        SETRANGE("Process Status");
      END;
    END;

    PROCEDURE Compress@1();
    VAR
      AdviceOrderLine@1100525000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      IF AdviceOrderLine.ISEMPTY THEN BEGIN
        AdviceOrderLine.RESET;
        AdviceOrderLine.COPY(Rec);
      END;
      AdviceCu.CompressLines(AdviceOrderLine);
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE Split@9();
    VAR
      AdviceOrderLine@1210190000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      IF AdviceOrderLine.FINDSET THEN; //mg, 22-01-2014: C010838
      AdviceCu.SplitLines(AdviceOrderLine);
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE Divide@1100525000();
    VAR
      AdviceOrderLine@1210190000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      IF AdviceOrderLine.FINDSET THEN; //mg, 22-01-2014: C010838
      AdviceCu.SplitLinesPrefLoc(AdviceOrderLine);
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE Approve@1100485002();
    VAR
      AdviceOrderLine@1210190000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      AdviceCu.ApproveLines(AdviceOrderLine);
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE InventoryReservation@4(lItem@11012000 : Code[20]);
    BEGIN
      LocInventoryQuan := 0;
      InventoryQuan := 0;
      ReservedQuan := 0;
      InventoryUnit := '';

      IF ("Supplying Company Inventory" <> '') THEN
        ItemRec.CHANGECOMPANY("Supplying Company Inventory");

      IF ItemRec.GET(lItem) THEN BEGIN
        //**4PS.sn
        IF "Record Type" = "Record Type"::Project THEN
          ItemRec.SETRANGE("Project Filter","Project No.");
        //**4PS.en
        ItemRec.CALCFIELDS(Inventory, "Qty. on Item Journal Project", "Qty. on Item Journal Service");
      //  LocInventoryQuan := GetInventory(Location,ItemRec,FALSE);
        InventoryQuan := GetInventory('',ItemRec,TRUE);
        ReservedQuan := ItemRec."Qty. on Item Journal Project" + ItemRec."Qty. on Item Journal Service";
        InventoryUnit := ItemRec."Base Unit of Measure";
      END;

      IF ("Supplying Company Inventory" <> '') THEN
        ItemRec.CHANGECOMPANY(COMPANYNAME);
    END;

    PROCEDURE EditText@1210190000();
    BEGIN
      AdviceCu.EditText(Rec);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE HandleItemLookup@1100485000(ZoomType@1210190000 : Integer);
    BEGIN
      LookupItemData(ZoomType,g_ItemCode,g_Vendor);  //db, 30-11-10: M23941
      IF ZoomType = -1 THEN  //db, 09-03-07 (call 8283)
        CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE ShowPurchRouteRef@1210190004();
    BEGIN
      RouteRefMgtCU.ShowReferenceList("Purchase Route Reference");
    END;

    PROCEDURE SetSelection@1210190001(lvPhase@1210190000 : Integer;lvRefRoute@1210190001 : Code[20]);
    BEGIN
      //db, 29-01-04: change because of call from purchase (order/quote)
      gvPhase := lvPhase;
      gvRefRoute := lvRefRoute;
    END;

    PROCEDURE UpdateVendor@1100485001();
    VAR
      ModifyItemVendor@1100485000 : Page 11020420;
      AdviceOrderLine@1100525000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      ModifyItemVendor.SetAdviceOrderRec(AdviceOrderLine);
      ModifyItemVendor.RUNMODAL;
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE DrillDownInventory@1100525001(ShowLocations@1100525003 : 'All,PrefLocations,Location');
    BEGIN
      AdviceCu.DrillDownInventory(Rec, ShowLocations);  //db, 09-02-09
    END;

    PROCEDURE SetContractFilter@1100525002(ContractFilter@1100525000 : ' ,No Contract,Contract,Contract with Discount Agreement,General Blanket Order,Project Blanket Order,Service Blanket Order');
    BEGIN
      CASE ContractFilter OF
        ContractFilter::" ":
          SETRANGE("Contract Type");
        ContractFilter::"No Contract":
          SETRANGE("Contract Type","Contract Type"::"No Contract");
        ContractFilter::Contract:
          SETRANGE("Contract Type","Contract Type"::Contract);
        ContractFilter::"Contract with Discount Agreement":
          SETRANGE("Contract Type","Contract Type"::"Contract with Discount Terms");
        ContractFilter::"General Blanket Order":
          SETRANGE("Contract Type","Contract Type"::"General Blanket Order");
        ContractFilter::"Project Blanket Order":
          SETRANGE("Contract Type","Contract Type"::"Project Blanket Order");
        ContractFilter::"Service Blanket Order":
          SETRANGE("Contract Type","Contract Type"::"Service Blanket Order");
      END;
    END;

    PROCEDURE ShowItemAvailbyPeriod@1100525006();
    VAR
      Item@1100525000 : Record 27;
    BEGIN
      IF "Item No." = '' THEN EXIT;
      IF Item.GET("Item No.") THEN BEGIN
        PAGE.RUN(PAGE::"Item Availability by Periods",Item);
      END;
    END;

    PROCEDURE GenerateICKOrder@1100525004();
    VAR
      AdviceOrderLine@1100525000 : Record 11012055;
    BEGIN
      GetRecSelection(AdviceOrderLine);
      AdviceCu.GenerateICKOrder(AdviceOrderLine);  //db, 17-08-10: M15519
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE SetBypassFiltering@1100525005(BypassFiltering2@1100525000 : Boolean);
    BEGIN
      BypassFiltering := BypassFiltering2;
    END;

    LOCAL PROCEDURE ShowDocuments@1210190002();
    VAR
      RecRef@1210190000 : RecordRef;
      DocumentFilters@1210190001 : Codeunit 11012432;
    BEGIN
      TESTFIELD("Line No.");
      RecRef.GETTABLE(Rec);
      DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, TRUE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrentRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    LOCAL PROCEDURE GetAddCostServiceEditable@19077114(FieldEditable@1100528400 : Boolean) AddCostServiceEditable : Boolean;
    VAR
      ServiceOrder@1100525000 : Record 11012823;
    BEGIN
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(ServiceOrder) THEN
        EXIT(FALSE);

      AddCostServiceEditable := FieldEditable;

      IF NOT ServiceOrder.GET("Service Order No.") THEN
        ServiceOrder.INIT;

      IF ServiceOrder."Service Contract No." <> '' THEN
        AddCostServiceEditable :=
          ((ServiceOrder."Source Type" <> ServiceOrder."Source Type"::Direct) OR
          (ServiceOrder."Service Contract No." = ''));
    END;

    LOCAL PROCEDURE SetEditable@1210190005();
    VAR
      JobsSetup@1100525001 : Record 315;
      ServiceSetup@1100525000 : Record 11012800;
    BEGIN
      IF JobsSetup.GET THEN;
      IF FPSLicenseManagement.LicenseAndReadPermissionForTable(ServiceSetup) THEN
        IF ServiceSetup.GET THEN;
      FieldEditable := AdviceOrderFieldsEditable;
      ProcessStatusEditable := AdviceOrderProcessStatusEditable;
      AdditionalCostServiceEditable := GetAddCostServiceEditable(FieldEditable);
      ElementEditable := FieldEditable AND ("Record Type" = "Record Type"::Project);
      ExtensionContractEditable := FieldEditable AND ("Record Type" = "Record Type"::Project);
      QuantityAdviceEditable := FieldEditable AND ("Process Status" < "Process Status"::Processed);
      CostTypeEditable := FieldEditable AND ("Item No." + "Basic Item" + "Trade Item" = '');
      UnitOfMeasureEditable := FieldEditable AND ("Quantity (Processed)" = 0);
      PriceEditable := FieldEditable AND ("Quantity (Budget)" = 0);
      VendorPriceEditable := FieldEditable AND (VendorCurrency <> '');
      LocationCodeEditable := FieldEditable AND FieldIsEditable(FIELDNO("Location Code"));
      BinCodeEditable := FieldEditable AND FieldIsEditable(FIELDNO("Bin Code"));
      CostComponentEditable :=
        FieldEditable AND
        ((("Project No." <> '') AND JobsSetup."Cost Component Editable") OR
        (("Service Order No." <> '') AND ServiceSetup."Cost Component Editable") OR
        (("Project No." = '') AND ("Service Order No." = '')));

      SupplyingCompInvEditable :=
        FieldEditable AND
        ("Cost Type" = "Cost Type"::Material) AND
        ("Item No." <> '') AND
        (Transaction = Transaction::Inventory) AND
        ("Process Status" < "Process Status"::Processed);

      GlobalDim1Editable := FieldEditable AND ("Project No." = '') AND ("Service Order No." = '');
    END;

    LOCAL PROCEDURE ApplyFilters@1100528600();
    BEGIN
      //** DP00576
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE ServiceOrderExtensionFound@1100528603(IServiceOrderNo@1100528600 : Code[20];ICompanyTextFilter@1100529400 : Text[250];IProjectTextFilter@1100528602 : Text[250]) : Boolean;
    VAR
      ServiceOrderExtension@1100528603 : Record 11071727;
    BEGIN
      //** DP00576
      IF (IProjectTextFilter = '') AND (ICompanyTextFilter = '') THEN
        EXIT(TRUE);

      ServiceOrderExtension.SETRANGE("Service Order No.", IServiceOrderNo);

      IF (IProjectTextFilter <> '') THEN
        ServiceOrderExtension.SETFILTER("Master Project", IProjectTextFilter);
      IF (ICompanyTextFilter  <> '') THEN
        ServiceOrderExtension.SETFILTER("Master Company", ICompanyTextFilter );

      IF NOT ServiceOrderExtension.ISEMPTY THEN
          EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetRecSelection@1100528604(VAR OAdviceOrderLine@1100528600 : Record 11012055);
    BEGIN
      //BackupAdviceOrderLine.COPY(Rec);               //** Call C026687 old
      //CurrPage.SETSELECTIONFILTER(Rec);            //** Call C026687 old
      //OAdviceOrderLine.COPY(Rec);                  //** Call C026687 old
      ApplyFiltersToGetMarkedOnly(OAdviceOrderLine); //** Call C026687 new
      IF OAdviceOrderLine.GET("Record Type","Project No.","Service Order No.",'',"Line No.") THEN; //DP01378
      //Rec.COPY(BackupAdviceOrderLine);               //** Call C026687 old
    END;

    LOCAL PROCEDURE FindPosition@1100409003(Which@1100409001 : Text) : Boolean;
    VAR
      lAdviceOrderLine@1100409000 : Record 11012055;
      i@1100409002 : Integer;
    BEGIN
      //** Call C026687 new
      lAdviceOrderLine.COPY(Rec);
      IF Which = '' THEN Which := '=';
      FOR i := 1 TO STRLEN(Which) DO
      CASE Which[i] OF
        '-': BEGIN
          IF Rec.FIND('-') THEN REPEAT
            IF ShowThisRecord(Rec) THEN EXIT(TRUE);
          UNTIL Rec.NEXT = 0;
        END;
        '+': BEGIN
          IF Rec.FIND('+') THEN REPEAT
            IF ShowThisRecord(Rec) THEN EXIT(TRUE);
          UNTIL Rec.NEXT(-1) = 0;
        END;
        '=': BEGIN
          IF Rec.FIND THEN
            IF ShowThisRecord(Rec) THEN EXIT(TRUE);
        END;
        '>': BEGIN
          IF NextPosition(Rec, 1) <> 0 THEN
            EXIT(TRUE);
        END;
        '<': BEGIN
          IF NextPosition(Rec, -1) <> 0 THEN
            EXIT(TRUE);
        END;
      END;
      Rec.COPY(lAdviceOrderLine);
      EXIT(FALSE);
    END;

    LOCAL PROCEDURE NextPosition@1100409004(VAR lAdviceOrderLine@1100409000 : Record 11012055;Steps@1100409001 : Integer) StepsCount : Integer;
    VAR
      RecRef2@1100409003 : Record 11012055;
      RecRef3@1100409004 : Record 11012055;
      Direction@1100409002 : Integer;
    BEGIN
      //** Call C026687 new
      IF Steps = 0 THEN EXIT;
      IF Steps > 0 THEN
        Direction := 1
      ELSE
        Direction := -1;
      RecRef2.COPY(lAdviceOrderLine);
      RecRef3.COPY(lAdviceOrderLine);
      REPEAT
        IF lAdviceOrderLine.NEXT(Direction) = 0 THEN BEGIN
          lAdviceOrderLine.COPY(RecRef3);
          EXIT;
        END;
        IF ShowThisRecord(lAdviceOrderLine) THEN BEGIN
          RecRef3.COPY(lAdviceOrderLine);
          StepsCount += Direction;
        END;
      UNTIL ABS(StepsCount) >= ABS(Steps);
      IF StepsCount = 0 THEN
        lAdviceOrderLine.COPY(RecRef2)
      ELSE
        lAdviceOrderLine.COPY(RecRef3);
    END;

    LOCAL PROCEDURE ShowThisRecord@1100525008(lAdviceOrderLine@1100528200 : Record 11012055) : Boolean;
    VAR
      ServiceOrder@1100525000 : Record 11012823;
    BEGIN
      //** DP00576
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(ServiceOrder) THEN
        EXIT(TRUE);
      IF IgnoreServiceOrderFilters THEN
        EXIT(TRUE);

      IF (SourceTypeFilter = '') AND
         (StartingDateFilter = '') AND
         (StartingTimeFilter = '') AND
         (StatusFilter = '') AND
         (ActualReferencePointFilter = '') AND
         (PriorityFilter = '') AND
         (DisciplineFilter = '') AND
         (TradeSpecialityFilter = '') AND
         (OrderKindFilter = '') AND
         (EmployeeNoFilter = '') AND
         (TerritoryFilter = '') AND
         (CityFilter = '') AND
         (PostcodeFilter = '') AND
         (AddressFilter = '') AND
         (CustomerNoFilter = '') AND
         (ChargeToCompanyFilter = '') AND
         (ChargeToProjectFilter = '')
      THEN
        EXIT(TRUE);

      IF lAdviceOrderLine."Service Order No." = '' THEN
        EXIT(FALSE);

      ServiceOrder.SETRANGE("No.", lAdviceOrderLine."Service Order No.");

      IF SourceTypeFilter <> '' THEN
        ServiceOrder.SETFILTER("Source Type", SourceTypeFilter);
      IF StartingDateFilter <> '' THEN
        ServiceOrder.SETFILTER("Starting Date", StartingDateFilter);
      IF StartingTimeFilter <> '' THEN
        ServiceOrder.SETFILTER("Starting Time", StartingTimeFilter);
      IF StatusFilter <> '' THEN
        ServiceOrder.SETFILTER(Status, StatusFilter);
      IF ActualReferencePointFilter <> '' THEN
        ServiceOrder.SETFILTER("Actual Reference Point", ActualReferencePointFilter);
      IF PriorityFilter <> '' THEN
        ServiceOrder.SETFILTER(Priority, PriorityFilter);
      IF DisciplineFilter <> '' THEN
        ServiceOrder.SETFILTER(Discipline, DisciplineFilter);
      IF TradeSpecialityFilter <> '' THEN
        ServiceOrder.SETFILTER("Trade Speciality", TradeSpecialityFilter);
      IF OrderKindFilter <> '' THEN
        ServiceOrder.SETFILTER("Order Kind", OrderKindFilter);
      IF EmployeeNoFilter <> '' THEN
        ServiceOrder.SETFILTER("Employee No.",EmployeeNoFilter);
      IF TerritoryFilter <> '' THEN
        ServiceOrder.SETFILTER("Territory Code",TerritoryFilter);
      IF CityFilter <> '' THEN
        ServiceOrder.SETFILTER(City,CityFilter);
      IF PostcodeFilter <> '' THEN
        ServiceOrder.SETFILTER("Post Code",PostcodeFilter);
      IF AddressFilter <> '' THEN
        ServiceOrder.SETFILTER(Address,AddressFilter);
      IF CustomerNoFilter <> '' THEN
        ServiceOrder.SETFILTER("Customer No.",CustomerNoFilter);

      IF NOT ServiceOrder.FINDFIRST THEN
        EXIT(FALSE);

      IF NOT ServiceOrderExtensionFound(ServiceOrder."No.", ChargeToCompanyFilter, ChargeToProjectFilter) THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ApplyFiltersToGetMarkedOnly@1100525018(VAR AdviceOrderLine@1100525001 : Record 11012055);
    VAR
      ServiceOrder@1100528601 : Record 11012823;
    BEGIN
      //** Call C026687 new
      //This Selection is necessary in case the user has selected records using: <CTRL>-A
      //In that case the extra filtering would be ignored.

      AdviceOrderLine.RESET;
      AdviceOrderLine.CLEARMARKS;
      AdviceOrderLine.MARKEDONLY(FALSE);

      CurrPage.SETSELECTIONFILTER(AdviceOrderLine);

      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(ServiceOrder) THEN
        EXIT;
      IF IgnoreServiceOrderFilters THEN
        EXIT;
      IF (SourceTypeFilter = '') AND
         (StartingDateFilter = '') AND
         (StartingTimeFilter = '') AND
         (StatusFilter = '') AND
         (ActualReferencePointFilter = '') AND
         (PriorityFilter = '') AND
         (DisciplineFilter = '') AND
         (TradeSpecialityFilter = '') AND
         (OrderKindFilter = '') AND
         (EmployeeNoFilter = '') AND
         (TerritoryFilter = '') AND
         (CityFilter = '') AND
         (PostcodeFilter = '') AND
         (AddressFilter = '') AND
         (CustomerNoFilter = '') AND
         (ChargeToCompanyFilter = '') AND
         (ChargeToProjectFilter = '') THEN
      BEGIN
        EXIT;
      END;

      IF SourceTypeFilter <> '' THEN
        ServiceOrder.SETFILTER("Source Type", SourceTypeFilter);
      IF StartingDateFilter <> '' THEN
        ServiceOrder.SETFILTER("Starting Date", StartingDateFilter);
      IF StartingTimeFilter <> '' THEN
        ServiceOrder.SETFILTER("Starting Time", StartingTimeFilter);
      IF StatusFilter <> '' THEN
        ServiceOrder.SETFILTER(Status, StatusFilter);
      IF ActualReferencePointFilter <> '' THEN
        ServiceOrder.SETFILTER("Actual Reference Point", ActualReferencePointFilter);
      IF PriorityFilter <> '' THEN
        ServiceOrder.SETFILTER(Priority, PriorityFilter);
      IF DisciplineFilter <> '' THEN
        ServiceOrder.SETFILTER(Discipline, DisciplineFilter);
      IF TradeSpecialityFilter <> '' THEN
        ServiceOrder.SETFILTER("Trade Speciality", TradeSpecialityFilter);
      IF OrderKindFilter <> '' THEN
        ServiceOrder.SETFILTER("Order Kind", OrderKindFilter);
      IF EmployeeNoFilter <> '' THEN
        ServiceOrder.SETFILTER("Employee No.",EmployeeNoFilter);
      IF TerritoryFilter <> '' THEN
        ServiceOrder.SETFILTER("Territory Code",TerritoryFilter);
      IF CityFilter <> '' THEN
        ServiceOrder.SETFILTER(City,CityFilter);
      IF PostcodeFilter <> '' THEN
        ServiceOrder.SETFILTER("Post Code",PostcodeFilter);
      IF AddressFilter <> '' THEN
        ServiceOrder.SETFILTER(Address,AddressFilter);
      IF CustomerNoFilter <> '' THEN
        ServiceOrder.SETFILTER("Customer No.",CustomerNoFilter);

      IF ServiceOrder.FINDSET THEN BEGIN
        AdviceOrderLine.FILTERGROUP(7);
        REPEAT
          IF ServiceOrderExtensionFound(ServiceOrder."No.", ChargeToCompanyFilter, ChargeToProjectFilter) THEN
          BEGIN
            AdviceOrderLine.SETRANGE("Service Order No.", ServiceOrder."No.");
            IF AdviceOrderLine.FINDSET THEN
              REPEAT
                AdviceOrderLine.MARK(TRUE);
              UNTIL AdviceOrderLine.NEXT = 0;
          END;
        UNTIL ServiceOrder.NEXT = 0;
        AdviceOrderLine.SETRANGE("Service Order No.");
        AdviceOrderLine.FILTERGROUP(0);
      END;

      AdviceOrderLine.MARKEDONLY(TRUE);
    END;

    LOCAL PROCEDURE CheckCompanyIC@1100529402(VAR ProjRec@1100529401 : Record 11072003);
    VAR
      Company@1100529400 : Record 2000000006;
      lvCompName@1210190027 : Text[50];
    BEGIN
      lvCompName := COMPANYNAME;
      IF (ChargeToCompanyFilter <> '') AND (MAXSTRLEN(Company.Name) >= STRLEN(ChargeToCompanyFilter)) THEN
        IF Company.GET(ChargeToCompanyFilter) THEN
          lvCompName := ChargeToCompanyFilter;
      ProjRec.CHANGECOMPANY(lvCompName);
    END;

    LOCAL PROCEDURE OnLookupJobNo@1100525012();
    VAR
      ProjRec@1100529400 : Record 11072003;
      PageNo@1100525001 : Integer;
    BEGIN
      CheckCompanyIC(ProjRec);
      IF ChargeToProjectFilter <> '' THEN
        ProjRec.SETFILTER("No.", ChargeToProjectFilter);
      IF ProjRec.FINDFIRST THEN;
      ProjRec.SETRANGE("No.");
      IF RefersTospecificCompany THEN
        PageNo := PAGE::"Job List IC";
      IF PAGE.RUNMODAL(PageNo, ProjRec) = ACTION::LookupOK THEN
        ChargeToProjectFilter := ProjRec."No.";
    END;

    LOCAL PROCEDURE RefersTospecificCompany@1100529401() : Boolean;
    VAR
      Company@1100529400 : Record 2000000006;
    BEGIN
      IF (ChargeToCompanyFilter <> '') AND (MAXSTRLEN(Company.Name) >= STRLEN(ChargeToCompanyFilter)) THEN
        IF (Company.GET(ChargeToCompanyFilter)) THEN
          IF (Company.Name <> COMPANYNAME) THEN
            EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
      ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
    END;

    PROCEDURE DetermineInterface@11012002(l_table@11012046 : Integer;l_code1@11012047 : Code[20];l_code2@11012048 : Code[20];l_code3@11012049 : Code[20];l_code4@11012050 : Code[20];l_int1@11012051 : Integer;l_code5@11012052 : Code[20];l_code6@11012053 : Code[20];l_int2@1210190042 : Integer;l_code7@1210190000 : Code[20];l_code8@1210190001 : Code[20]);
    BEGIN
      // This function has been copied from page 48.
      // For consistency reasons the name of the function and of the variables have not been changed.
      g_table := l_table;
      g_code1 := l_code1;
      g_code2 := l_code2;
      g_code3 := l_code3;
      g_code4 := l_code4;
      g_int1 := l_int1;
      g_code5 := l_code5;
      g_code6 := l_code6;
      g_int2 := l_int2;
      g_code7 := l_code7;
      g_code8 := l_code8;
    END;

    PROCEDURE MultipleLinesHaveBeenCopied@1100528400() : Boolean;
    BEGIN
      EXIT(MultipleLinesCopied);
    END;

    PROCEDURE SetIgnoreServiceOrderFilters@1100528401(IgnoreServiceOrderFilters2@1100528400 : Boolean);
    BEGIN
      IgnoreServiceOrderFilters := IgnoreServiceOrderFilters2;
    END;

    LOCAL PROCEDURE UpdatePriceAgreement@1100528501();
    BEGIN
      //C047131
      IF PurchasesPayablesSetup."Price Agreement" <> PurchasesPayablesSetup."Price Agreement"::" " THEN
        VALIDATE("Price Agreement", TRUE);

      CurrPage.UPDATE;  //refresh VendorPrice
    END;

    BEGIN
    END.
  }
}

