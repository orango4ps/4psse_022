OBJECT Table 11012058 Intercompany Entry
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    DataPerCompany=No;
    Permissions=TableData 11012058=d;
    OnInsert=VAR
               Employee@1100527000 : Record 5200;
             BEGIN
               CheckPostingDateAllowed();
               //"Currency Code" := GenLedgerSetup.GetLCYCode;  //DP02206 (should be filled by Supplying Company)

               Employee.CHANGECOMPANY("Supplying Company");
               IF Employee.GET("Employee No.") THEN
                 "Trade Association" := Employee."Trade Association";
             END;

    CaptionML=[ENU=Intercompany Entry;
               NOR=Konsernintern transaksjon;
               SVE=Koncernintern transaktion];
    LookupPageID=Page11012113;
  }
  FIELDS
  {
    { 1   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.;
                                                              SVE=Radnr] }
    { 2   ;   ;Supplying Company   ;Text30        ;TableRelation=Company;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Supplying Company;
                                                              NOR=Leverende  selskap;
                                                              SVE=Levererande fîretag] }
    { 3   ;   ;Receiving Company   ;Text30        ;TableRelation=Company;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Receiving Company;
                                                              NOR=Mottakselskap;
                                                              SVE=Mottagningsfîretag] }
    { 4   ;   ;Account No.         ;Code20        ;TableRelation="G/L Account".No.;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Account No.;
                                                              NOR=Kontonr.;
                                                              SVE=Nr] }
    { 5   ;   ;Bal. Account No.    ;Code20        ;TableRelation="G/L Account".No.;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Bal. Account No.;
                                                              NOR=Motkontonr.;
                                                              SVE=Motkonto] }
    { 6   ;   ;Description         ;Text100       ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 7   ;   ;Project No.         ;Code20        ;TableRelation=Job.No.;
                                                   OnLookup=BEGIN
                                                              ProjRec.CHANGECOMPANY("Receiving Company");
                                                              ProjRec."No." := "Project No.";
                                                              PAGE.RUNMODAL(0, ProjRec);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 8   ;   ;Cost Object         ;Code20        ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                UpdateDimension(2);
                                                              END;

                                                   OnLookup=BEGIN
                                                              DimValRec.CHANGECOMPANY("Receiving Company");
                                                              DimValRec.Code := "Cost Object";
                                                              DimValRec.SETRANGE("Global Dimension No.", 2);
                                                              PAGE.RUNMODAL(0, DimValRec);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              NOR=Kostnadsobjekt;
                                                              SVE=Kostnadsobjekt];
                                                   CaptionClass='1,1,2' }
    { 9   ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall;
                                                              SVE=Antal];
                                                   DecimalPlaces=0:5 }
    { 10  ;   ;Unit of Measure Code;Code10        ;CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=MÜleenhetskode;
                                                              SVE=Enhetskod] }
    { 12  ;   ;Price               ;Decimal       ;CaptionML=[ENU=Price;
                                                              NOR=Pris;
                                                              SVE=Pris];
                                                   AutoFormatType=2 }
    { 13  ;   ;Amount              ;Decimal       ;CaptionML=[ENU=Amount;
                                                              NOR=Belõp;
                                                              SVE=Belopp];
                                                   AutoFormatType=1 }
    { 14  ;   ;Document No.        ;Code20        ;CaptionML=[ENU=Document No.;
                                                              NOR=Bilagsnr.;
                                                              SVE=Verifikationsnr] }
    { 15  ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Vendor No.;
                                                              NOR=Leverandõrnr.;
                                                              SVE=Leverantîrsnr] }
    { 16  ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              NOR=Bokfõringsdato;
                                                              SVE=Bokfîringsdatum] }
    { 17  ;   ;Element             ;Code20        ;TableRelation="Project Element".Element WHERE (Project No.=FIELD(Project No.));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 18  ;   ;Extension Contract  ;Code10        ;TableRelation="Extension Contract"."Contract No." WHERE (Project No.=FIELD(Project No.));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Extension Contract;
                                                              NOR=ETA;
                                                              SVE=éTA] }
    { 20  ;   ;Item No.            ;Code20        ;TableRelation=Item.No.;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.;
                                                              SVE=Artikelnr] }
    { 21  ;   ;Basic Item          ;Code20        ;TableRelation="Basic Item"."Product Code" WHERE (Manufacturer=FIELD(Manufacturer));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Basic Item;
                                                              NOR=Fabrikantartikkel;
                                                              SVE=Basartikel] }
    { 22  ;   ;Trade Item          ;Code20        ;TableRelation="Trade Item"."Item Code" WHERE (Vendor=FIELD("Vendor (Trade Item)"));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Trade Item;
                                                              NOR=Katalogartikkel;
                                                              SVE=Anskaffningsartikel] }
    { 24  ;   ;Manufacturer        ;Code15        ;TableRelation="ETIM Vendor - Central Mgt".Code;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Manufacturer;
                                                              NOR=Fabrikant;
                                                              SVE=Tillverkare] }
    { 25  ;   ;Vendor (Trade Item) ;Code15        ;TableRelation="ETIM Vendor - Central Mgt".Code;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Vendor (Trade Item);
                                                              NOR=Leverandõr (katalogartikkel);
                                                              SVE=Leverantîr (skaffningsartikel)] }
    { 30  ;   ;Account Type        ;Option        ;CaptionML=[ENU=Account Type;
                                                              NOR=Kontotype;
                                                              SVE=Kontotyp];
                                                   OptionCaptionML=[ENU=G/L Account,Customer,Vendor,Bank Account,Fixed Asset;
                                                                    NOR=Finans,Kunde,Leverandõr,Bank,Aktiva;
                                                                    SVE=Redov.konto,Kund,Leverantîr,Bankkonto,AnlÑggningstillgÜng];
                                                   OptionString=G/L Account,Customer,Vendor,Bank Account,Fixed Asset }
    { 31  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                UpdateDimension(1);
                                                              END;

                                                   OnLookup=BEGIN
                                                              DimValRec.CHANGECOMPANY("Receiving Company");
                                                              DimValRec.Code := "Global Dimension 1 Code";
                                                              DimValRec.SETRANGE("Global Dimension No.", 1);
                                                              PAGE.RUNMODAL(0, DimValRec);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 kode;
                                                              SVE=Global dimension 1 kod];
                                                   CaptionClass='1,1,1' }
    { 32  ;   ;Gen. Posting Type   ;Option        ;CaptionML=[ENU=Gen. Posting Type;
                                                              NOR=Bokfõringstype;
                                                              SVE=Typ av bokfîring];
                                                   OptionCaptionML=[ENU=" ,Purchase,Sale,Settlement";
                                                                    NOR=" ,Kjõp,Salg,Avregning";
                                                                    SVE=" ,Inkîp,FîrsÑljning,AvrÑkning"];
                                                   OptionString=[ ,Purchase,Sale,Settlement] }
    { 33  ;   ;Gen. Bus. Posting Group;Code20     ;TableRelation="Gen. Business Posting Group";
                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokfõringsgruppe - firma;
                                                              SVE=Gen. rîrelsebokfîringsmall] }
    { 34  ;   ;Gen. Prod. Posting Group;Code20    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokfõringsgruppe - vare;
                                                              SVE=Produktbokfîringsmall] }
    { 35  ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Moms Bevegelsebokfõringsmal;
                                                              SVE=Moms rîrelsebokfîringsmall] }
    { 36  ;   ;VAT Prod. Posting Group;Code20     ;TableRelation="VAT Product Posting Group";
                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Mva-bokfõringsgruppe - vare;
                                                              SVE=Moms produktbokfîringsmall] }
    { 37  ;   ;Posting Group       ;Code20        ;TableRelation=IF (Account Type=CONST(Customer)) "Customer Posting Group"
                                                                 ELSE IF (Account Type=CONST(Vendor)) "Vendor Posting Group"
                                                                 ELSE IF (Account Type=CONST(Fixed Asset)) "FA Posting Group"
                                                                 ELSE IF (Account Type=CONST(G/L Account),
                                                                          Plant Type=FILTER(<>'')) "Plant Posting Group";
                                                   CaptionML=[ENU=Posting Group;
                                                              NOR=Bokfõringsgruppe;
                                                              SVE=Bokfîringsmall] }
    { 40  ;   ;Post in Company     ;Text30        ;TableRelation=Company;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Post in Company;
                                                              NOR=Bokfõr i selskap;
                                                              SVE=Bokfîr i fîretag] }
    { 60  ;   ;IC Hours Tag No.    ;Integer       ;CaptionML=[ENU=IC Hours Tag No.;
                                                              NOR=IC-timer taggnr;
                                                              SVE=IC-timmar taggnr] }
    { 70  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              NOR=Utligningsbilagstype;
                                                              SVE=Kopplas till dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder";
                                                                    NOR=" ,Betaling,Faktura,Kreditnota,Rentefaktura,PÜminnelse";
                                                                    SVE=" ,Betalning,Faktura,Kreditnota,RÑntefaktura,PÜminnelse"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder] }
    { 80  ;   ;Applies-to Doc. No. ;Code20        ;CaptionML=[ENU=Applies-to Doc. No.;
                                                              NOR=Utligningsbilagsnr.;
                                                              SVE=Kopplas till ver.nr] }
    { 90  ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              NOR=Dokumenttype;
                                                              SVE=Dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    NOR=" ,Betaling,Faktura,Kreditnota,Rentenota,Purring,Refusjon";
                                                                    SVE=" ,Betalning,Faktura,Kreditnota,RÑntefaktura,BetalningspÜminnelse,èterbetalning"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 100 ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              NOR=èrsaksspor;
                                                              SVE=Uppfîljningskod] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID;
                                                              SVE=DimensionsuppsÑttnings-ID];
                                                   Editable=No }
    { 11012000;;Surcharge          ;Boolean       ;CaptionML=[ENU=Surcharge;
                                                              NOR=Tilleggsgebyr;
                                                              SVE=TillÑggsavgift] }
    { 11012010;;Interest Date      ;Date          ;CaptionML=[ENU=Interest Date;
                                                              NOR=Rentedato;
                                                              SVE=RÑntedatum] }
    { 11012020;;Wage Component     ;Code10        ;TableRelation="Wage Component";
                                                   CaptionML=[ENU=Wage Component;
                                                              NOR=Lõnnsart;
                                                              SVE=Lîneart] }
    { 11012030;;Description 2      ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2;
                                                              SVE=Beskrivning 2] }
    { 11012140;;Try-out No.        ;Code20        ;TableRelation=Try-out;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Try-out No.;
                                                              NOR=Prospektnr.;
                                                              SVE=Anbudsnr] }
    { 11012150;;Estimate No.       ;Code20        ;TableRelation=Estimate;
                                                   CaptionML=[ENU=Estimate No.;
                                                              NOR=Kalkylenr;
                                                              SVE=Kalkylnr] }
    { 11012160;;Currency Code      ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod] }
    { 11012320;;Execution Date Hours;Date         ;CaptionML=[ENU=Execution Date;
                                                              NOR=Gjennomfõringsdato;
                                                              SVE=Utfîrandedatum] }
    { 11012330;;Origin Salary Application;Boolean ;CaptionML=[ENU=Origin Salary Application;
                                                              NOR=Opprinnelig Lõnnsprogram;
                                                              SVE=Ursprungligt lîneprogram];
                                                   Editable=No }
    { 11012550;;Rental Period      ;Text30        ;CaptionML=[ENU=Rental Period;
                                                              NOR=Leieperiode til dato;
                                                              SVE=Uthyrningsperiod] }
    { 11012551;;Plant Type         ;Code20        ;TableRelation="Plant Type";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Plant Type;
                                                              NOR=Maskintype;
                                                              SVE=Maskintyp] }
    { 11012552;;Plant No.          ;Code10        ;TableRelation=IF (Bulk=CONST(No)) "Plant Number".No. WHERE (Plant Type=FIELD(Plant Type));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Plant No.;
                                                              NOR=Maskinnr.;
                                                              SVE=Maskinnr] }
    { 11012553;;Bulk               ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Plant Type".Bulk WHERE (Code=FIELD(Plant Type)));
                                                   CaptionML=[ENU=Bulk;
                                                              NOR=Bulk;
                                                              SVE=Bulk];
                                                   Editable=No }
    { 11012554;;Cost Component Plant;Code10       ;TableRelation="Cost Component Plant";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Cost Component Plant;
                                                              NOR=Kostdel, maskin;
                                                              SVE=Kostnadsdel, Maskin] }
    { 11012555;;Plant Invoice      ;Boolean       ;CaptionML=[ENU=Plant Invoice;
                                                              NOR=Maskinfaktura;
                                                              SVE=Maskinfaktura];
                                                   Editable=No }
    { 11012556;;Rental Period to Date;Date        ;CaptionML=[ENU=Rental Period to Date;
                                                              NOR=Leieperiode til dato;
                                                              SVE=Uthyrningsperiod till datum] }
    { 11012560;;Plant Location     ;Code20        ;TableRelation="Plant Location";
                                                   ValidateTableRelation=No;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Plant Location;
                                                              SVE=Maskinplats] }
    { 11012570;;Plant Invoice Origin;Option       ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Plant Invoice Origin;
                                                              SVE=Maskinfaktura, ursprung];
                                                   OptionCaptionML=[ENU=,Plant Inventory,Plant Order,Exit Order,Rental Correction,Plant Hours,Transport Order,Returned Loss,Service Order,Rental Agreement,Surcharge,Service Cost;
                                                                    SVE=,Maskinlager,Maskinorder,Slutorder,Uthyrningskorrigering,Maskintimmar,Transportorder,Returnerad fîrlust,Serviceorder,Hyresavtal,TillÑggsavgift,Servicekostnad];
                                                   OptionString=,Plant Inventory,Plant Order,Exit Order,Rental Correction,Plant Hours,Transport Order,Returned Loss,Service order,RentalAgreement,Surcharge,Service Cost;
                                                   BlankZero=Yes;
                                                   Description=Options must be the same in the tables 37, 113, 115, 11012572, 11020501, 11071889, 11072056 !!!!;
                                                   Editable=No }
    { 11012800;;Service Order No.  ;Code20        ;TableRelation="Service Order".No.;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr] }
    { 11012801;;Service Location No.;Code20       ;TableRelation="Service Location".No.;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Service Location No.;
                                                              NOR=Servicelokasjon Nr.;
                                                              SVE=Serviceplatsnr];
                                                   Editable=No }
    { 11012804;;Service Contract No.;Code20       ;TableRelation=Service-Contract.No.;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr];
                                                   Editable=No }
    { 11012805;;Additional Cost (Service);Boolean ;OnValidate=BEGIN
                                                                TESTFIELD("Service Order No.");
                                                                VALIDATE("Service Order No.");
                                                              END;

                                                   CaptionML=[ENU=Additional Cost (Service);
                                                              NOR=Tilleggskoster (service);
                                                              SVE=TillÑggskostnader (service)] }
    { 11012840;;Cost Component     ;Code20        ;TableRelation="Cost Component".Code;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Cost Component;
                                                              NOR=Kostnadskomponent;
                                                              SVE=Kostnadsdel] }
    { 11012880;;Year               ;Integer       ;CaptionML=[ENU=Year;
                                                              NOR=èr;
                                                              SVE=èr] }
    { 11012881;;Week               ;Integer       ;CaptionML=[ENU=Week;
                                                              NOR=Uke;
                                                              SVE=Vecka] }
    { 11012882;;Monday             ;Decimal       ;CaptionML=[ENU=Monday;
                                                              NOR=Mandag;
                                                              SVE=MÜndag];
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 11012883;;Tuesday            ;Decimal       ;CaptionML=[ENU=Tuesday;
                                                              NOR=Tirsdag;
                                                              SVE=Tisdag];
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 11012884;;Wednesday          ;Decimal       ;CaptionML=[ENU=Wednesday;
                                                              NOR=Onsdag;
                                                              SVE=Onsdag];
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 11012885;;Thursday           ;Decimal       ;CaptionML=[ENU=Thursday;
                                                              NOR=Torsdag;
                                                              SVE=Torsdag];
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 11012886;;Friday             ;Decimal       ;CaptionML=[ENU=Friday;
                                                              NOR=Fredag;
                                                              SVE=Fredag];
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 11012887;;Saturday           ;Decimal       ;CaptionML=[ENU=Saturday;
                                                              NOR=Lõrdag;
                                                              SVE=Lîrdag];
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 11012888;;Sunday             ;Decimal       ;CaptionML=[ENU=Sunday;
                                                              NOR=Sõndag;
                                                              SVE=Sîndag];
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 11012890;;Type Plant Hour Cost;Option       ;CaptionML=[ENU=Type Plant Hour Cost;
                                                              NOR=Type koster for maskintimer;
                                                              SVE=Typ av kostnader fîr Maskinstimmar];
                                                   OptionCaptionML=[ENU=" ,Hours,Expenses";
                                                                    NOR=" ,Timer,Utgifter";
                                                                    SVE=" ,Timmar,Utgifter"];
                                                   OptionString=[ ,Hours,Expenses] }
    { 11012940;;Rental Unit        ;Code20        ;TableRelation="Rental Unit"."Rental Unit" WHERE (Project No.=FIELD(Project No.));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Rental Unit;
                                                              NOR=Leieenhet;
                                                              SVE=Uthyrningsenhet] }
    { 11012993;;Employee No.       ;Code20        ;TableRelation=Employee.No.;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Employee No.;
                                                              NOR=Ansattnr;
                                                              SVE=AnstÑllningsnr];
                                                   NotBlank=Yes }
    { 11012994;;Service Type Receiving Comp.;Code20;
                                                   CaptionML=[ENU=Service Type Receiving Comp.;
                                                              NOR=Servicetype, Mottaksselskap;
                                                              SVE=Servicetyp, mottag. fîretag] }
    { 11012995;;Project Type Receiving Comp.;Code20;
                                                   CaptionML=[ENU=Project Type Receiving Comp.;
                                                              NOR=Prosjekttype, Mottaksselskap;
                                                              SVE=Mottagningsfîretag fîr projekttyp] }
    { 11012996;;Cost Type Receiving Comp.;Option  ;CaptionML=[ENU=Cost Type Receiving Comp.;
                                                              NOR=Kostnadstype, Mottaksselskap;
                                                              SVE=Kostnadstyp, mottagningsfîretag];
                                                   OptionCaptionML=[ENU=Labor,Material,Subcontracting,Plant,Sundry,Revenue;
                                                                    NOR=Arbeidskraft,Materiale,Underentrepenõr,Maskin,Diverse,Inntekt;
                                                                    SVE=Arbetskraft,Material,Underentreprenad,Maskin,Diverse,IntÑkt];
                                                   OptionString=Labor,Material,Subcontracting,Plant,Sundry,Revenue }
    { 11012997;;Use IC Vendor Posting Group;Boolean;
                                                   CaptionML=[ENU=Use IC Vendor Posting Group;
                                                              NOR=Bruk Bokfõringsgruppe for IC-leverandõr;
                                                              SVE=AnvÑnd IC-leverantîrsbokfîringsmall] }
    { 11013000;;Trade Association  ;Code10        ;CaptionML=[ENU=Trade Association;
                                                              NOR=Bransjeorganisasjon;
                                                              SVE=Branschorganisation] }
  }
  KEYS
  {
    {    ;Line No.                                ;Clustered=Yes }
    {    ;Post in Company,IC Hours Tag No.,Document No.,Employee No. }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      HumanResourcesSetup@1210190000 : Record 5218;
      GenLedgerSetup@1210190004 : Record 98;
      ProjRec@1210190024 : Record 11072003;
      ProjTypeRec@1100525001 : Record 11012009;
      ServTypeRec@1100525002 : Record 11012814;
      JobJnlLine@1210190022 : Record 11072008;
      JobJnlLine2@1210190021 : Record 11072008;
      ServOrderRec@1210190030 : Record 11012823;
      ServJnlLine@1210190029 : Record 11012820;
      ServJnlLine2@1210190031 : Record 11012820;
      GenJnlLine@1210190025 : Record 81;
      GenJnlLine2@1210190020 : Record 81;
      DimValRec@1210190002 : Record 349;
      ICRelationRec@1210190006 : Record 11012057;
      ICEntryRec@1210190026 : Record 11012058;
      SurchargeRec@1210190015 : Record 11020208;
      SurchDimValRec@1210190016 : Record 349;
      EmplRec@1100485000 : Record 5200;
      GenJournalTemplate@1100485002 : Record 80;
      GenJournalBatch@1100409000 : Record 232;
      CompanyData@1100485005 : Record 11020674;
      ItemRec@1100525000 : Record 27;
      WageCompRec@1100525003 : Record 11012014;
      TmpCompressJobJnlLineRec@1100485006 : TEMPORARY Record 11072008;
      PostJobJnl@1210190019 : Codeunit 11072003;
      PostGenJnl@1210190018 : Codeunit 12;
      PostServJnl@1210190028 : Codeunit 11012802;
      DimMgt@1210190005 : Codeunit 408;
      Text000@1210190013 : TextConst 'ENU=Processing Intercompany Entries  @1@@@@@@@@@@@@@;NOR=Behandler konserninterne transaksjoner  @1@@@@@@@@@@@@@;SVE=Behandlar koncerninterna transaktioner  @1@@@@@@@@@@@@@';
      LicenceCu@1210190023 : Codeunit 11012780;
      Window@1210190012 : Dialog;
      Progress@1210190011 : Integer;
      NoOfRecords@1210190010 : Integer;
      Counter@1210190009 : Integer;
      CompressNextLineNo@1100485007 : Integer;
      LastUpdateTime@1210190008 : Time;
      EntryNo@1210190017 : Integer;
      NextLeaveEntryNo@1100485004 : Integer;
      Text001@1100485003 : TextConst 'ENU=Insert ''%1'' for company ''%2'' is not allowed. The posting date %3 is not within allowed range of this company.;NOR=Det er ikke tillatt Ü sette inn ''%1'' for Bedriften ''%2''. Bokfõringsdatoen %3 ligger ikke innenfor det tillatte intervallet for dette selskapet.;SVE=Det Ñr inte tillÜtet att infoga ''%1'' fîr fîretaget ''%2''. Bokfîringsdatumet %3 ligger inte inom det tillÜtna intervallet fîr detta fîretag.';
      NextIntercompanyLedgerEntryNo@1100528400 : Integer;
      DPA_Management@1100000999 : Codeunit 11012783;
      Text002@1100525004 : TextConst 'ENU=This Shortcut Dimension is not defined in the %1.;NOR=Denne snarveisdimensjonen er ikke definert i %1.;SVE=GenvÑg dimension Ñr inte definierad i %1.';

    PROCEDURE ProcessICEntries@1();
    VAR
      Reason@1100527000 : Record 231;
      lvOrigin@1100525000 : 'Project,Service';
      IntercompanyLedgerEntryNo@1100528400 : Integer;
      HomeCurrency@1100528900 : Text;
    BEGIN
      LicenceCu.CheckICProcess;

      CLEAR(PostGenJnl);
      CLEAR(PostJobJnl);
      CLEAR(PostServJnl);

      HumanResourcesSetup.GET;
      GenLedgerSetup.GET;
      HomeCurrency := GenLedgerSetup.GetLCYCode;  //DP02206

      GenLedgerSetup.TESTFIELD("Intercompany Journal Template");
      GenLedgerSetup.TESTFIELD("Intercompany Batch Name");
      GenJournalTemplate.GET(GenLedgerSetup."Intercompany Journal Template");
      GenJournalBatch.GET(GenLedgerSetup."Intercompany Journal Template", GenLedgerSetup."Intercompany Batch Name");
      GenJournalBatch.TESTFIELD("Copy VAT Setup to Jnl. Lines", FALSE);

      ICEntryRec.COPY(Rec);

      LastUpdateTime := TIME;

      IF GUIALLOWED THEN
        Window.OPEN(Text000);

      ICEntryRec.LOCKTABLE;
      ICEntryRec.SETRANGE("Post in Company", COMPANYNAME);
      NoOfRecords := ICEntryRec.COUNT;
      Counter := 0;
      EntryNo := 10000;
      IF GenJnlLine.FINDLAST THEN
        EntryNo := GenJnlLine."Line No." + 10000;

      IF ICEntryRec.FINDSET(TRUE,FALSE) THEN BEGIN
        IF CompanyData.GET(COMPANYNAME) THEN;
        TmpCompressJobJnlLineRec.RESET;
        TmpCompressJobJnlLineRec.DELETEALL;
        CompressNextLineNo := 1;
        REPEAT
          Counter := Counter + 1;
          IF GUIALLOWED THEN
            UpdateProgressWindow(Counter);

          IntercompanyLedgerEntryNo := InsertIntercompanyLedgerEntry(ICEntryRec);
          CLEAR(GenJnlLine);
          WITH GenJnlLine DO BEGIN
            "Intercompany Transaction" := TRUE;
            "Supplying Company" := ICEntryRec."Supplying Company";
            "Journal Template Name" := GenLedgerSetup."Intercompany Journal Template";
            "Journal Batch Name" := GenLedgerSetup."Intercompany Batch Name";
            "Reason Code" := GenJournalTemplate."Reason Code";
            IF ICEntryRec."Reason Code" <> '' THEN BEGIN
              IF Reason.GET(ICEntryRec."Reason Code") THEN
                "Reason Code" := ICEntryRec."Reason Code";
            END;

            IF ICRelationRec.GET(ICEntryRec."Supplying Company", ICEntryRec."Receiving Company") THEN
              "Source Code" := ICRelationRec."Source Code"
            ELSE
              "Source Code" := GenJournalTemplate."Source Code";

            "Line No." := EntryNo;
            "Posting Date" := ICEntryRec."Posting Date";
            "Account Type" := ICEntryRec."Account Type";
            "Shortcut Dimension 1 Code" := ICEntryRec."Global Dimension 1 Code";
            "Shortcut Dimension 2 Code" := ICEntryRec."Cost Object";
            "Dimension Set ID" := ICEntryRec."Dimension Set ID";
            "Cost Component" := ICEntryRec."Cost Component";
            "Job No." := ICEntryRec."Project No.";
            Element := ICEntryRec.Element;
            IF ("Job No." <> '') AND (Element = '') THEN
              Element := GetStandardProjElement("Job No.", ICEntryRec."Receiving Company");
            "Extension Contract" := ICEntryRec."Extension Contract";
            "System-Created Entry" := TRUE;
            VALIDATE("Account No.", ICEntryRec."Bal. Account No.");
            "Applies-to Doc. Type" := ICEntryRec."Applies-to Doc. Type";
            "Applies-to Doc. No." := ICEntryRec."Applies-to Doc. No.";
            "Bal. Account Type" := "Bal. Account Type"::"G/L Account";
            VALIDATE("Bal. Account No.", ICEntryRec."Account No.");
            IF (ICEntryRec."Currency Code" <> HomeCurrency) THEN  //DP02206
              VALIDATE("Currency Code", ICEntryRec."Currency Code");
            IF ICEntryRec."Item No." <> '' THEN
              IF ItemRec.GET(ICEntryRec."Item No.") THEN
               "Item No." := ICEntryRec."Item No."; //Fill only if item exist in this company
            "Basic Item" := ICEntryRec."Basic Item";
            "Trade Item" := ICEntryRec."Trade Item";
            Manufacturer := ICEntryRec.Manufacturer;
            "Vendor (Trade Item)" := ICEntryRec."Vendor (Trade Item)";
            Quantity := ICEntryRec.Quantity;
            "Unit of Measure Code" := ICEntryRec."Unit of Measure Code";
            "System-Created Entry" := TRUE;
            VALIDATE("Gen. Prod. Posting Group",ICEntryRec."Gen. Prod. Posting Group");
            VALIDATE("Gen. Bus. Posting Group",ICEntryRec."Gen. Bus. Posting Group");
            VALIDATE("VAT Prod. Posting Group",ICEntryRec."VAT Prod. Posting Group");
            VALIDATE("VAT Bus. Posting Group",ICEntryRec."VAT Bus. Posting Group");
            VALIDATE("Gen. Posting Type",ICEntryRec."Gen. Posting Type");
            IF ("Gen. Posting Type" = 0) AND
               ("VAT Prod. Posting Group" = '') AND
               ("VAT Bus. Posting Group" = '') THEN
            BEGIN
               GenJnlLine."Block VAT Posting" := TRUE;
            END;
            "Bal. Gen. Prod. Posting Group" := '';
            "Bal. Gen. Bus. Posting Group" := '';
            "Bal. VAT Prod. Posting Group" := '';
            "Bal. VAT Bus. Posting Group" := '';
            "Bal. Gen. Posting Type" := 0;
            IF "Account Type" = "Account Type"::"G/L Account" THEN
              FillCurrencyAndAmountOfGenJnlLine(
                GenJnlLine, ICEntryRec."Currency Code", ICEntryRec.Amount)
            ELSE
              // Currency Code of GenJournalLine may be filled by validation of Account No.
              FillAmountOfGenJnlLine(GenJnlLine, ICEntryRec.GetAmountLCYPostInCompany);

            Description := ICEntryRec.Description;
            "Description 2" := ICEntryRec."Description 2";
            "Document Type" := ICEntryRec."Document Type";
            "Document No." := ICEntryRec."Document No.";
            "Interest Date" := ICEntryRec."Interest Date";
            "Wage Component" := ICEntryRec."Wage Component";
            IF WageCompRec.GET("Wage Component") THEN
              IF WageCompRec."Component Type" = WageCompRec."Component Type"::Expenses THEN
                IF ICEntryRec.GetPriceLCYPostInCompany <> 0 THEN
                  Quantity := ICEntryRec.GetAmountLCYPostInCompany / ICEntryRec.GetPriceLCYPostInCompany;
            "Employee No." := ICEntryRec."Employee No.";
            "Plant Location" := ICEntryRec."Plant Location";
            "Plant Type" := ICEntryRec."Plant Type";
            "Plant No." := ICEntryRec."Plant No.";
            "Cost Component Plant" := ICEntryRec."Cost Component Plant";
            "Plant Invoice Origin" := ICEntryRec."Plant Invoice Origin";
            "Posting Group" := ICEntryRec."Posting Group";
            "Service Order No." := ICEntryRec."Service Order No.";
            GetServiceCategory;
            "Service Contract No." := ICEntryRec."Service Contract No.";
            "Service Location No." := ICEntryRec."Service Location No.";
            "Additional Cost (Service)" := ICEntryRec."Additional Cost (Service)";
            Surcharge :=  ICEntryRec.Surcharge;
            IF "Service Order No." <> '' THEN
              "Origin Type" := "Origin Type"::Service;
            "Rental Unit" := ICEntryRec."Rental Unit";
            "Origin Salary Application" := ICEntryRec."Origin Salary Application";

            GenJnlLine.CreateDim(
              DimMgt.TypeToTableID1(GenJnlLine."Account Type"),GenJnlLine."Account No.",
              DimMgt.TypeToTableID1("Bal. Account Type"),GenJnlLine."Bal. Account No.",
              DATABASE::"Plant Number", DimMgt.MakeCombinedPlantNo(GenJnlLine."Plant Type",GenJnlLine."Plant No."),
              DATABASE::"Plant Type", GenJnlLine."Plant Type",
              DATABASE::Job, GenJnlLine."Job No.",
              DATABASE::"Service Order", GenJnlLine."Service Order No.",
              DATABASE::"Salesperson/Purchaser", GenJnlLine."Salespers./Purch. Code",
              DATABASE::Campaign, GenJnlLine."Campaign No.");

            "Dimension Set ID" := DimMgt.GetDeltaDimSetID("Dimension Set ID",ICEntryRec."Dimension Set ID",0);
            DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
            DimMgt.GetDimValueRec(2, "Shortcut Dimension 2 Code", DimValRec,
                                  ("Job No." <> '') OR ("Service Order No." <> ''),'');

            GenJnlLine2 := GenJnlLine;
            IF (("Job No." = '') AND ("Service Order No." = '') AND
                ("Plant Type" = '') AND ("Account Type" = "Account Type"::"G/L Account")) AND
                ((GenJnlLine2."Account No." <> '') AND (GenJnlLine2."Bal. Account No." <> '')) THEN
            BEGIN
              VALIDATE("Bal. Account No.", '');
              VALIDATE("Account No.", GenJnlLine2."Account No.");
              IF (ICEntryRec."Currency Code" <> HomeCurrency) THEN  //DP02206
                VALIDATE("Currency Code", ICEntryRec."Currency Code");
              "Dimension Set ID" := DimMgt.GetDeltaDimSetID("Dimension Set ID",ICEntryRec."Dimension Set ID",0);
              DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

              PostGenJnl.RunWithCheck(GenJnlLine);

              GenJnlLine := GenJnlLine2;
              VALIDATE("Bal. Account No.", '');
              VALIDATE("Account No.", GenJnlLine2."Bal. Account No.");
              IF (ICEntryRec."Currency Code" <> HomeCurrency) THEN  //DP02206
                VALIDATE("Currency Code", ICEntryRec."Currency Code");
              "Dimension Set ID" := DimMgt.GetDeltaDimSetID("Dimension Set ID",ICEntryRec."Dimension Set ID",0);
              DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

              VALIDATE(Amount, -1 * GenJnlLine2.Amount);

              PostGenJnl.RunWithCheck(GenJnlLine);
            END ELSE
              PostGenJnl.RunWithCheck(GenJnlLine);
            GenJnlLine := GenJnlLine2;

            IF "Job No." <> '' THEN BEGIN
              PostProject(IntercompanyLedgerEntryNo);
              IF NOT ICEntryRec.Surcharge THEN
                PostSurcharge(0);
            END;
            IF "Service Order No." <> '' THEN BEGIN
              PostService(IntercompanyLedgerEntryNo);
              IF NOT ICEntryRec.Surcharge THEN
                PostSurcharge(1);
            END;
            IF "Plant Type" <> '' THEN
              PostPlant(IntercompanyLedgerEntryNo);

            IF ICEntryRec."IC Hours Tag No." > 0 THEN
              CreatePostedHours;

            //Extra WIP postings in supplying company is applied to linked hours
            //Input hours in receiving company.
            //This posting will only be created when field:"??????? Type Receiving Comp." is filled in receiving company.
            IF ("Job No."= '') AND ("Service Order No." = '') AND ("Plant Type" = '') AND
               (ICEntryRec."Supplying Company" = ICEntryRec."Post in Company") THEN
            BEGIN
              IF ICEntryRec."Service Type Receiving Comp." <> '' THEN BEGIN
                ServTypeRec.CHANGECOMPANY("Receiving Company");
                ServTypeRec.GET(ICEntryRec."Service Type Receiving Comp.");
                IF ServTypeRec."Post Complementary Costs" THEN BEGIN
                  AssignServiceToProjectEntry(ServJnlLine, '');
                  ComplementaryWIPICEntry(lvOrigin::Service, GenJnlLine);
                END;
              END;
              IF ICEntryRec."Project Type Receiving Comp." <> '' THEN BEGIN
                ProjTypeRec.CHANGECOMPANY("Receiving Company");
                ProjTypeRec.GET(ICEntryRec."Project Type Receiving Comp.");
                IF ProjTypeRec."Post Complementary Costs" THEN BEGIN
                  ComplementaryWIPICEntry(lvOrigin::Project, GenJnlLine);
                END;
              END;
            END;
          END;
        UNTIL ICEntryRec.NEXT = 0;

        PostCompressedPlantJobEntries();
        ICEntryRec.DELETEALL(TRUE);
      END;

      IF GUIALLOWED THEN
        Window.CLOSE;
    END;

    LOCAL PROCEDURE FillCurrencyAndAmountOfGenJnlLine@1100528409(VAR GenJournalLine@1100528400 : Record 81;CurrencyCode@1100528404 : Code[10];Amount2@1100528401 : Decimal);
    VAR
      GeneralLedgerSetup@1100528405 : Record 98;
    BEGIN
      GeneralLedgerSetup.GET;
      IF CurrencyCode <> GeneralLedgerSetup."LCY Code" THEN
        GenJournalLine.VALIDATE("Currency Code", CurrencyCode);
      GenJournalLine.VALIDATE(Amount, Amount2);
    END;

    LOCAL PROCEDURE FillAmountOfGenJnlLine@1100528404(VAR GenJournalLine@1100528400 : Record 81;AmountLCY@1100528401 : Decimal);
    VAR
      CurrencyExchangeRate@1100528403 : Record 330;
    BEGIN
      IF GenJournalLine."Currency Code" = '' THEN
        GenJournalLine.VALIDATE(Amount, AmountLCY)
      ELSE BEGIN
        GenJournalLine.Amount := ROUND(
          CurrencyExchangeRate.ExchangeAmtLCYToFCY(
            0, '', GenJournalLine."Posting Date", GenJournalLine."Currency Code",
            AmountLCY, GenJournalLine."Currency Factor",
            GenJournalLine."Account Type" = GenJournalLine."Account Type"::Customer),
          GetAmountRoundingPrecision(GenJournalLine."Currency Code"));
        GenJournalLine.VALIDATE(Amount);
      END;
    END;

    PROCEDURE UpdateDimension@1210190000(GlobalDimension@1210190000 : Integer);
    VAR
      DimManagement@1100525000 : Codeunit 408;
    BEGIN
      DimManagement.SetCompany("Post in Company");

      IF GlobalDimension = 1 THEN
        DimManagement.ValidateShortcutDimValues(1,"Global Dimension 1 Code","Dimension Set ID");

      IF GlobalDimension = 2 THEN
        DimManagement.ValidateShortcutDimValues(2,"Cost Object","Dimension Set ID");
    END;

    PROCEDURE PostProject@1210190005(IntercompanyLedgerEntryNo@1100528400 : Integer);
    VAR
      lvGenJnlLine@1100525000 : Record 81;
    BEGIN
      WITH GenJnlLine DO BEGIN
        JobJnlLine.INIT;
        JobJnlLine."Posting Date" := "Posting Date";
        JobJnlLine."Document Date" := "Document Date";
        JobJnlLine."Job No." := "Job No.";
        JobJnlLine."No." := "Account No.";
        JobJnlLine.Description := Description;
        JobJnlLine."Description 2" := "Description 2";
        JobJnlLine."Posting Group" := "Posting Group";
        JobJnlLine."Shortcut Dimension 1 Code" := "Shortcut Dimension 1 Code";
        JobJnlLine."Shortcut Dimension 2 Code" := "Shortcut Dimension 2 Code";
        JobJnlLine."Dimension Set ID" := "Dimension Set ID";
        JobJnlLine."Gen. Bus. Posting Group" := "Gen. Bus. Posting Group";
        JobJnlLine."Gen. Prod. Posting Group" := "Gen. Prod. Posting Group";
        JobJnlLine."Document No." := "Document No.";
        JobJnlLine."External Document No." := "External Document No.";
        JobJnlLine.Vendor := ICEntryRec."Vendor No.";
        JobJnlLine.Type := JobJnlLine.Type::"G/L Account";
        JobJnlLine.Quantity := Quantity;
        JobJnlLine."Unit of Measure Code" := "Unit of Measure Code";
        IF DimValRec."Cost Type" = DimValRec."Cost Type"::Revenue THEN BEGIN
          JobJnlLine."Entry Type" := JobJnlLine."Entry Type"::Sale;
          IF Quantity = 0 THEN BEGIN
            JobJnlLine."Unit Price (LCY)" := -"VAT Base Amount (LCY)";
            JobJnlLine."Unit Price" := -"VAT Base Amount"
          END ELSE BEGIN
            JobJnlLine."Unit Price (LCY)" := -ROUND(
              "VAT Base Amount (LCY)" / Quantity, GetUnitAmountRoundingPrecision(''));
            JobJnlLine."Unit Price" := -ROUND(
              "VAT Base Amount" / Quantity, GetUnitAmountRoundingPrecision("Currency Code"));
          END;
          JobJnlLine."Total Price (LCY)" := -ROUND(
            "VAT Base Amount (LCY)", GetAmountRoundingPrecision(''));
          JobJnlLine."Total Price" := -ROUND(
            "VAT Base Amount", GetAmountRoundingPrecision("Currency Code"));
          JobJnlLine."Source Currency Total Price" := -ROUND(
            "Source Currency Amount", GetAmountRoundingPrecision("Currency Code"));
        END ELSE BEGIN
          JobJnlLine."Entry Type" := JobJnlLine."Entry Type"::Usage;
          IF Quantity = 0 THEN BEGIN
            JobJnlLine."Direct Unit Cost (LCY)" := "VAT Base Amount (LCY)";
            JobJnlLine."Unit Cost" := "VAT Base Amount";
          END ELSE BEGIN
            JobJnlLine."Direct Unit Cost (LCY)" := ROUND(
              "VAT Base Amount (LCY)" / Quantity, GetUnitAmountRoundingPrecision(''));
            JobJnlLine."Unit Cost" := ROUND(
              "VAT Base Amount" / Quantity, GetUnitAmountRoundingPrecision("Currency Code"));
          END;
          JobJnlLine."Total Cost (LCY)" := ROUND(
            "VAT Base Amount (LCY)", GetAmountRoundingPrecision(''));
          JobJnlLine."Total Cost" := ROUND(
            "VAT Base Amount", GetAmountRoundingPrecision("Currency Code"));
          JobJnlLine."Source Currency Total Cost" := ROUND(
            "Source Currency Amount", GetAmountRoundingPrecision("Currency Code"));
        END;
        JobJnlLine."Reason Code" := "Reason Code";
        JobJnlLine."Source Code" := "Source Code";
        JobJnlLine."Posting No. Series" := "Posting No. Series";
        JobJnlLine."Source Currency Code" := "Currency Code";
        IF ICEntryRec."Supplying Company" <> COMPANYNAME THEN
          JobJnlLine."Supplying Company" := ICEntryRec."Supplying Company";
        JobJnlLine."Employee No." := "Employee No.";
        JobJnlLine.Element := Element;
        JobJnlLine."Extension Contract" := "Extension Contract";
        JobJnlLine."Item No." := "Item No.";
        JobJnlLine."Basic Item" := "Basic Item";
        JobJnlLine."Trade Item" := "Trade Item";
        JobJnlLine."Vendor (Trade Item)" := "Vendor (Trade Item)";
        JobJnlLine.Manufacturer := Manufacturer;
        JobJnlLine."Service Order No." := "Service Order No.";
        JobJnlLine."Service Contract No." := "Service Contract No.";
        JobJnlLine."Service Location No." := "Service Location No.";
        JobJnlLine."Rental Unit" := "Rental Unit";
        JobJnlLine."Rental Period" := ICEntryRec."Rental Period";
        JobJnlLine."Wage Component" := "Wage Component";
        IF WageCompRec.GET("Wage Component") THEN BEGIN
          IF WageCompRec."Component Type" = WageCompRec."Component Type"::Expenses THEN BEGIN
            IF DimValRec."Cost Type" = DimValRec."Cost Type"::Labor THEN BEGIN
              JobJnlLine.Quantity := 0;
              JobJnlLine."Unit Cost (LCY)" := JobJnlLine."Direct Unit Cost (LCY)";
            END;
          END;
        END;
        JobJnlLine."Cost Component" := "Cost Component";
        JobJnlLine."Execution Date" := ICEntryRec."Execution Date Hours";
        JobJnlLine."Created from Intercompany":= TRUE;
        JobJnlLine.Surcharge := Surcharge;
        JobJnlLine."Advance Payment" := "Advance Payment";

        IF NOT CheckCompressPlantJobEntries() THEN BEGIN
          PostJobJnl.SetOriginSalaryApplication("Origin Salary Application");
          JobJnlLine."Intercompany Ledger Entry No." := IntercompanyLedgerEntryNo;
          PostJobJnl.RunWithCheck(JobJnlLine);
          lvGenJnlLine := GenJnlLine;
          ProjRec.CHANGECOMPANY("Receiving Company");
          ProjRec.GET("Job No.");
          ProjTypeRec.CHANGECOMPANY("Receiving Company");
          ProjTypeRec.GET(ProjRec."Project Type");
          IF ProjTypeRec."Post Complementary Costs" OR
             (ProjTypeRec."Post Complementary Revenues" AND
             NOT JobJnlLine."Advance Payment")
          THEN BEGIN
            ComplementaryWIPProj(JobJnlLine);
          END;
          GenJnlLine := lvGenJnlLine;
          PostJobJnl.SetOriginSalaryApplication(FALSE);
        END ELSE BEGIN
          CompressPlantJobEntries(JobJnlLine);
        END;
      END;
    END;

    PROCEDURE PostPlant@1210190003(IntercompanyLedgerEntryNo@1100528400 : Integer);
    VAR
      PlantLedgEntryRec@1210190001 : Record 11012572;
      PlantTypeRec@1210190002 : Record 11012551;
      PostPlantEntryCU@1210190000 : Codeunit 11012569;
    BEGIN
      WITH GenJnlLine DO BEGIN
        PlantLedgEntryRec.INIT;
        PlantLedgEntryRec."Vendor No." := ICEntryRec."Vendor No.";
        PlantLedgEntryRec."Document No." := "Document No.";
        PlantLedgEntryRec."Posting Date" := "Posting Date";
        PlantLedgEntryRec."Document Date" := "Document Date";
        PlantLedgEntryRec."Account No." := "Account No.";
        PlantLedgEntryRec.Description := Description;
        PlantLedgEntryRec."Description 2" := "Description 2";
        PlantLedgEntryRec.Quantity := Quantity;
        IF Quantity <> 0 THEN
          PlantLedgEntryRec."Direct Unit Cost" := ROUND(
            "VAT Base Amount (LCY)" / Quantity, GetUnitAmountRoundingPrecision(''))
        ELSE
          PlantLedgEntryRec."Direct Unit Cost" := "VAT Base Amount (LCY)";
        PlantLedgEntryRec."Unit Cost" := PlantLedgEntryRec."Direct Unit Cost";
        PlantLedgEntryRec."Total Cost" := ROUND(
          "VAT Base Amount (LCY)", GetAmountRoundingPrecision(''));
        PlantLedgEntryRec."Unit of Measure Code" := "Unit of Measure Code";
        PlantLedgEntryRec."Department Code" := "Shortcut Dimension 1 Code";
        PlantLedgEntryRec."Cost Object" := "Shortcut Dimension 2 Code";
        PlantLedgEntryRec."Dimension Set ID" := "Dimension Set ID";
        PlantLedgEntryRec."Source Code" := "Source Code";
        PlantLedgEntryRec."Reason Code" := "Reason Code";
        PlantLedgEntryRec."Plant Location" := "Plant Location";
        PlantLedgEntryRec."Plant Type" := "Plant Type";
        PlantLedgEntryRec."Plant No." := "Plant No.";
        PlantLedgEntryRec."Cost Component" := "Cost Component Plant";
        PlantLedgEntryRec."Plant Invoice Origin" := "Plant Invoice Origin";
        IF PlantLedgEntryRec."Plant Type" <> '' THEN BEGIN
          IF PlantTypeRec.GET(PlantLedgEntryRec."Plant Type") THEN
            PlantLedgEntryRec."Plant Posting Group" := PlantTypeRec.PlantPostingGrp(PlantLedgEntryRec."Plant No.", '', '');
        END;
        PlantLedgEntryRec."Intercompany Ledger Entry No." := IntercompanyLedgerEntryNo;
        PostPlantEntryCU.RUN(PlantLedgEntryRec);
      END;

      IF (ICEntryRec."Receiving Company" = COMPANYNAME) AND
         (ICEntryRec."Receiving Company" = ICEntryRec."Post in Company") AND
         (ICEntryRec.Year <> 0) AND (ICEntryRec.Week <> 0) AND
         ("Type Plant Hour Cost" IN ["Type Plant Hour Cost"::Hours, "Type Plant Hour Cost"::Expenses])
      THEN
        InsertPlantHourCostLine;
    END;

    PROCEDURE InsertPlantHourCostLine@1100485026() : Integer;
    VAR
      lvPlantHourCostHeadRec@1100485000 : Record 11012577;
      lvPlantHourCostLineRec@1100485002 : Record 11012578;
      lvPlantHourCostLineRec2@1100485003 : Record 11012578;
      lvSupplyingCompany@1100525000 : Text[30];
    BEGIN
      WITH ICEntryRec DO BEGIN
        lvSupplyingCompany := "Supplying Company";

        //Create Plant Hour Cost Header if necessary (if not already exist)
        IF NOT lvPlantHourCostHeadRec.GET(Year, Week, lvSupplyingCompany, "Employee No.") THEN BEGIN
          lvPlantHourCostHeadRec.INIT;
          lvPlantHourCostHeadRec.Year := Year;
          lvPlantHourCostHeadRec.Week := Week;
          lvPlantHourCostHeadRec."Employee Company" := lvSupplyingCompany;
          lvPlantHourCostHeadRec."Employee No." := "Employee No.";
          lvPlantHourCostHeadRec.INSERT(FALSE);
        END;

        //Create Plant Hour Cost Line
        lvPlantHourCostLineRec.INIT;
        lvPlantHourCostLineRec.Year := Year;
        lvPlantHourCostLineRec.Week := Week;
        lvPlantHourCostLineRec."Employee Company" := lvSupplyingCompany;
        lvPlantHourCostLineRec."Employee No." := "Employee No.";
        lvPlantHourCostLineRec."Plant Type" := "Plant Type";
        lvPlantHourCostLineRec."Plant No." := "Plant No.";
        lvPlantHourCostLineRec."Cost Component" := "Cost Component Plant";
        IF ("Type Plant Hour Cost" <> "Type Plant Hour Cost"::Expenses) THEN BEGIN
          lvPlantHourCostLineRec.Monday := Monday;
          lvPlantHourCostLineRec.Tuesday := Tuesday;
          lvPlantHourCostLineRec.Wednesday := Wednesday;
          lvPlantHourCostLineRec.Thursday := Thursday;
          lvPlantHourCostLineRec.Friday := Friday;
          lvPlantHourCostLineRec.Saturday := Saturday;
          lvPlantHourCostLineRec.Sunday := Sunday;
          lvPlantHourCostLineRec."Total Line" := Quantity;
          lvPlantHourCostLineRec."Unit Cost" := ICEntryRec.GetPriceLCYPostInCompany;
          lvPlantHourCostLineRec.Origin := lvPlantHourCostLineRec.Origin::HourAcc;
        END ELSE BEGIN
          lvPlantHourCostLineRec."Cost Object" := "Cost Object";
          lvPlantHourCostLineRec."Wage Component Expenses" := "Wage Component";
          lvPlantHourCostLineRec.Quantity := Quantity;
          lvPlantHourCostLineRec."Unit Rate" := ICEntryRec.GetPriceLCYPostInCompany;
          lvPlantHourCostLineRec.Amount := ICEntryRec.GetAmountLCYPostInCompany;
        END;
        lvPlantHourCostLineRec2.SETRANGE(Year, Year);
        lvPlantHourCostLineRec2.SETRANGE(Week, Week);
        lvPlantHourCostLineRec2.SETRANGE("Employee Company",lvSupplyingCompany);
        lvPlantHourCostLineRec2.SETRANGE("Employee No.","Employee No.");
        IF lvPlantHourCostLineRec2.FINDLAST THEN
          lvPlantHourCostLineRec."Line No." := lvPlantHourCostLineRec2."Line No." + 10000
        ELSE
          lvPlantHourCostLineRec."Line No." := 10000;

        lvPlantHourCostLineRec.Status := lvPlantHourCostLineRec.Status::Posted;

        lvPlantHourCostLineRec.INSERT(FALSE);

        EXIT(lvPlantHourCostLineRec."Line No.");
      END;
    END;

    PROCEDURE PostService@1210190002(IntercompanyLedgerEntryNo@1100528400 : Integer);
    VAR
      lvGenJnlLine@1100525000 : Record 81;
      lvType@1100525001 : Code[20];
    BEGIN
      WITH GenJnlLine DO BEGIN
        ServJnlLine.INIT;
        ServJnlLine."Service Contract No." := "Service Contract No.";
        ServJnlLine."Service Order No." := "Service Order No.";
        ServJnlLine."Service Location No." := "Service Location No.";
        ServJnlLine."Service Category" := "Service Category";
        ServJnlLine."Additional Cost" := "Additional Cost (Service)";
        ServJnlLine."Document No." := "Document No.";
        ServJnlLine."G/L Account" := "Account No.";
        ServJnlLine."Posting Date" := "Posting Date";
        ServJnlLine."Shortcut Dimension 1 Code" := "Shortcut Dimension 1 Code";
        ServJnlLine."Shortcut Dimension 2 Code" := "Shortcut Dimension 2 Code";
        ServJnlLine."Dimension Set ID" := "Dimension Set ID";
        ServJnlLine.Description := Description;
        ServJnlLine."Description 2" := "Description 2";
        ServJnlLine.Quantity := Quantity;
        ServJnlLine."Unit of Measure Code" := "Unit of Measure Code";
        ServJnlLine."Currency Code" := "Currency Code";
        IF DimValRec."Cost Type" = DimValRec."Cost Type"::Revenue THEN BEGIN
          IF Quantity = 0 THEN BEGIN
            ServJnlLine."Sales Price (LCY)" := -"VAT Base Amount (LCY)";
            ServJnlLine."Sales Price" := -"VAT Base Amount";
          END ELSE BEGIN
            ServJnlLine."Sales Price (LCY)" := -ROUND(
              "VAT Base Amount (LCY)" / Quantity, GetUnitAmountRoundingPrecision(''));
            ServJnlLine."Sales Price" := -ROUND(
              "VAT Base Amount" / Quantity, GetUnitAmountRoundingPrecision("Currency Code"));
          END;
          ServJnlLine."Total Revenue (LCY)" := -ROUND(
            "VAT Base Amount (LCY)", GetAmountRoundingPrecision(''));
          ServJnlLine."Total Revenue" := -ROUND(
            "VAT Base Amount", GetAmountRoundingPrecision("Currency Code"));
        END ELSE BEGIN
          IF Quantity = 0 THEN BEGIN
            ServJnlLine."Unit Cost (LCY)" := "VAT Base Amount (LCY)";
            ServJnlLine."Unit Cost" := "VAT Base Amount";
          END ELSE BEGIN
            ServJnlLine."Unit Cost (LCY)" := ROUND(
              "VAT Base Amount (LCY)" / Quantity, GetUnitAmountRoundingPrecision(''));
            ServJnlLine."Unit Cost" := ROUND(
              "VAT Base Amount" / Quantity, GetUnitAmountRoundingPrecision("Currency Code"));
          END;
          ServJnlLine."Total Cost (LCY)" := ROUND(
            "VAT Base Amount (LCY)", GetAmountRoundingPrecision(''));
          ServJnlLine."Total Cost" := ROUND(
            "VAT Base Amount", GetAmountRoundingPrecision("Currency Code"));
        END;
        IF ICEntryRec."Supplying Company" <> COMPANYNAME THEN
          ServJnlLine."Supplying Company" := ICEntryRec."Supplying Company";
        ServJnlLine."Employee No." := "Employee No.";
        ServJnlLine."Wage Component" := "Wage Component";
        IF WageCompRec.GET("Wage Component") THEN
          IF WageCompRec."Component Type" = WageCompRec."Component Type"::Expenses THEN
            IF DimValRec."Cost Type" = DimValRec."Cost Type"::Labor THEN
              ServJnlLine.Quantity := 0;
        ServJnlLine."Source Code" := "Source Code";
        ServJnlLine."Reason Code" := "Reason Code";
        ServJnlLine."Item No." := "Item No.";
        ServJnlLine."Basic Item" := "Basic Item";
        ServJnlLine."Trade Item" := "Trade Item";
        ServJnlLine."Vendor (Trade Item)" := "Vendor (Trade Item)";
        ServJnlLine.Manufacturer := Manufacturer;
        ServJnlLine."Project No." := "Job No.";
        ServJnlLine."Vendor No." := ICEntryRec."Vendor No.";
        ServJnlLine."Wage Component" := "Wage Component";
        ServJnlLine."Cost Component" := "Cost Component";
        ServJnlLine."Rental Period" := ICEntryRec."Rental Period";
        ServJnlLine.Surcharge := Surcharge;
        ServJnlLine."Intercompany Ledger Entry No." := IntercompanyLedgerEntryNo;
        ServJnlLine."Execution Date" := ICEntryRec."Execution Date Hours";
        PostServJnl.RunWithCheck(ServJnlLine);

        lvGenJnlLine := GenJnlLine;
        ServOrderRec.CHANGECOMPANY("Receiving Company");
        ServOrderRec.GET("Service Order No.");
        IF "Additional Cost (Service)" = TRUE THEN
          lvType := ServOrderRec."Service Type (Other)"
        ELSE
          lvType := ServOrderRec."Service Type";

        ServTypeRec.CHANGECOMPANY("Receiving Company");
        ServTypeRec.GET(lvType);
        IF ServTypeRec."Post Complementary Costs" OR
           (ProjTypeRec."Post Complementary Revenues" AND
           NOT JobJnlLine."Advance Payment")
        THEN BEGIN
          AssignServiceToProjectEntry(ServJnlLine, '');
          ComplementaryWIPServ(JobJnlLine,ServOrderRec);
        END;
        GenJnlLine := lvGenJnlLine;
      END;
    END;

    PROCEDURE PostSurcharge@1210190006(lvOrigin@1210190000 : 'Project,Service');
    VAR
      lvType@1210190008 : Code[20];
      lvOrigDim1@1210190007 : Code[20];
      lvOrigDim2@1210190006 : Code[20];
      lvDim1@1210190005 : Code[20];
      lvDim2@1210190004 : Code[20];
      lvAccount@1210190003 : Code[20];
      lvDepartmentCode@1100525004 : Code[20];
      lvCostComp@1100525005 : Code[20];
      lvDesc@1210190002 : Text[100];
      lvDesc2@1100485000 : Text[50];
      lvCostTotal@1210190001 : Decimal;
      lvTotSurchAmount@1100485002 : Decimal;
      lvTotSurchAmount2@1100485003 : Decimal;
      lvGenJnlLineSurcharge1@1100525000 : Record 81;
      lvGenJnlLineSurcharge2@1100525001 : Record 81;
      lvGenJnlLine@1100525002 : Record 81;
      CalcSurcharge@1100525003 : Boolean;
      DimSetID@1100409000 : Integer;
    BEGIN
      WITH GenJnlLine DO BEGIN

        ICRelationRec."Vendor Posting Group" := '';
        IF ICEntryRec."Use IC Vendor Posting Group" THEN BEGIN
          IF ICRelationRec.GET(ICEntryRec."Supplying Company", ICEntryRec."Receiving Company") THEN;
        END;

        IF lvOrigin = lvOrigin::Project THEN BEGIN
          IF "Service Order No." <> '' THEN EXIT;
          ProjRec.GET("Job No.");
          lvType := ProjRec."Project Type";
          ProjTypeRec.CHANGECOMPANY(ICEntryRec."Receiving Company");
          ProjTypeRec.GET(lvType);
        END;
        IF lvOrigin = lvOrigin::Service THEN BEGIN
          ServOrderRec.GET("Service Order No.");
          IF "Additional Cost (Service)" = TRUE THEN
            lvType := ServOrderRec."Service Type (Other)"
          ELSE
            lvType := ServOrderRec."Service Type";
          ServTypeRec.CHANGECOMPANY(ICEntryRec."Receiving Company");
          ServTypeRec.GET(lvType);
        END;

        lvOrigDim1 := "Shortcut Dimension 1 Code";
        lvOrigDim2 := "Shortcut Dimension 2 Code";
        DimMgt.GetDimValueRec(2, lvOrigDim2, DimValRec, TRUE, '');

        CLEAR(EmplRec);
        EmplRec.CHANGECOMPANY(ICEntryRec."Supplying Company");

        IF ("Employee No." <> '') THEN
          IF EmplRec.GET("Employee No.") THEN;

        IF (DimValRec."Cost Type" = DimValRec."Cost Type"::Labor) AND ("Employee No." <> '') THEN
          IF (EmplRec.External) AND (EmplRec."External Post No Surcharge") THEN
            EXIT;

        IF ("Employee No." <> '') AND
           (GenLedgerSetup."Source Department Surcharge" =
            GenLedgerSetup."Source Department Surcharge"::Employee) THEN
        BEGIN
          lvDepartmentCode := EmplRec."Global Dimension 1 Code";
        END ELSE BEGIN
          lvDepartmentCode := lvOrigDim1;
        END;

        IF SurchargeRec.GetSurcharges(
          lvOrigin, lvType, "Job No.", TRUE, DimValRec."Cost Type",
          DimValRec.Code, "Wage Component",
          lvDepartmentCode, EmplRec."Trade Association",
          "Cost Component", "Posting Date",
          SurchargeRec) THEN
        BEGIN
          REPEAT
            CalcSurcharge := TRUE;
            IF SurchargeRec."No Surcharge over InterCompany" THEN
              CalcSurcharge := FALSE;

            IF CalcSurcharge THEN BEGIN
              SurchargeRec.GetSurchargeDimVal(DimValRec, SurchDimValRec);
              SurchargeRec.TESTFIELD("Coverage Account");

              IF lvOrigin = lvOrigin::Project THEN BEGIN
                JobJnlLine2 := JobJnlLine;
                JobJnlLine2."Intercompany Ledger Entry No." := 0;
                JobJnlLine2.InitSurcharge(
                  JobJnlLine2, DimValRec, SurchDimValRec,
                  SurchargeRec, lvOrigDim1, lvType, lvTotSurchAmount,
                  ICRelationRec."Vendor Posting Group");
                lvDim1 := JobJnlLine2."Shortcut Dimension 1 Code";
                lvDim2 := JobJnlLine2."Shortcut Dimension 2 Code";
                DimSetID := JobJnlLine2."Dimension Set ID";
                lvCostComp := JobJnlLine2."Cost Component";
                lvDesc := JobJnlLine2.Description;
                lvDesc2 := JobJnlLine2."Description 2";
                lvCostTotal := JobJnlLine2."Total Cost (LCY)";
                lvAccount:= JobJnlLine2."No.";
              END;

              IF lvOrigin = lvOrigin::Service THEN BEGIN
                ServJnlLine2 := ServJnlLine;
                ServJnlLine2."Intercompany Ledger Entry No." := 0;
                ServJnlLine2.InitSurcharge(
                  ServJnlLine2, DimValRec, SurchDimValRec,
                  SurchargeRec, lvOrigDim1, lvType, lvTotSurchAmount,
                  ICRelationRec."Vendor Posting Group");
                lvDim1 := ServJnlLine2."Shortcut Dimension 1 Code";
                lvDim2 := ServJnlLine2."Shortcut Dimension 2 Code";
                DimSetID := ServJnlLine2."Dimension Set ID";
                lvCostComp := ServJnlLine2."Cost Component";
                lvDesc := ServJnlLine2.Description;
                lvDesc2 := ServJnlLine2."Description 2";
                lvCostTotal := ServJnlLine2."Total Cost (LCY)";
                lvAccount:= ServJnlLine2."G/L Account";
              END;

              IF lvOrigin = lvOrigin::Project THEN BEGIN
                IF NOT CheckCompressPlantJobEntries() THEN BEGIN
                  PostJobJnl.SetOriginSalaryApplication("Origin Salary Application");
                  PostJobJnl.RunWithCheck(JobJnlLine2);
                  PostJobJnl.SetOriginSalaryApplication(FALSE);
                END ELSE BEGIN
                  CompressPlantJobEntries(JobJnlLine2);
                END;
              END;

              IF lvOrigin = lvOrigin::Service THEN BEGIN
                PostServJnl.RunWithCheck(ServJnlLine2);
                IF "Job No." <> '' THEN BEGIN
                  ProjRec.GET("Job No.");
                  lvType := ProjRec."Project Type";
                  JobJnlLine2 := JobJnlLine;
                  JobJnlLine2.InitSurcharge(
                    JobJnlLine2, DimValRec, SurchDimValRec,
                    SurchargeRec, lvOrigDim1, lvType, lvTotSurchAmount2,
                    ICRelationRec."Vendor Posting Group");
                  JobJnlLine2."Direct Unit Cost (LCY)" := lvCostTotal;
                  JobJnlLine2."Unit Cost (LCY)" := lvCostTotal;
                  JobJnlLine2."Total Cost (LCY)" := lvCostTotal;
                  JobJnlLine2."No." := lvAccount;
                  PostJobJnl.SetOriginSalaryApplication("Origin Salary Application");
                  PostJobJnl.RunWithCheck(JobJnlLine2);
                  PostJobJnl.SetOriginSalaryApplication(FALSE);
                END;
              END;

              GenJnlLine2.INIT;
              GenJnlLine2."Line No." := EntryNo;
              GenJnlLine2."Intercompany Transaction" := TRUE;
              GenJnlLine2."Journal Template Name" := "Journal Template Name";
              GenJnlLine2."Journal Batch Name" := "Journal Batch Name";
              GenJnlLine2."Source Code" := "Source Code";
              GenJnlLine2."Reason Code" := "Reason Code";
              GenJnlLine2."Account Type" := GenJnlLine2."Account Type"::"G/L Account";
              GenJnlLine2."Account No." := lvAccount;
              GenJnlLine2."Posting Date" := "Posting Date";
              GenJnlLine2."Document Type" := "Document Type";
              GenJnlLine2."Document No." := "Document No.";
              GenJnlLine2."Document Date" := "Document Date";
              GenJnlLine2."System-Created Entry" := TRUE;
              GenJnlLine2."Job No." := "Job No.";
              IF ("Job No." <> '') AND (SurchargeRec."Element Surcharge" <> '') THEN
                GenJnlLine2.Element := SurchargeRec."Element Surcharge"
              ELSE
                GenJnlLine2.Element := Element;
              GenJnlLine2."Extension Contract" := "Extension Contract";
              GenJnlLine2."Service Order No." := "Service Order No.";
              GenJnlLine2."Service Location No." := "Service Location No.";
              GenJnlLine2."Service Contract No." := "Service Contract No.";
              GenJnlLine2."Service Category" := "Service Category";
              GenJnlLine2."Additional Cost (Service)" := "Additional Cost (Service)";
              GenJnlLine2."Rental Unit" := "Rental Unit";
              GenJnlLine2."Shortcut Dimension 1 Code" := lvDim1;
              GenJnlLine2."Shortcut Dimension 2 Code" := lvDim2;
              GenJnlLine2."Dimension Set ID" := DimSetID;
              GenJnlLine2."Cost Component" := lvCostComp;
              GenJnlLine2.Description := lvDesc;
              GenJnlLine2."Description 2" := lvDesc2;
              GenJnlLine2.Amount := lvCostTotal;
              GenJnlLine2.VALIDATE(Amount);
              GenJnlLine2."Interest Date" := "Interest Date";

              lvGenJnlLineSurcharge1 := GenJnlLine2;

              //Post Debit Line
              PostGenJnl.RunWithoutCheck(GenJnlLine2);

              //Post Credit Line
              GenJnlLine2."Account No." := SurchargeRec."Coverage Account";
              GenJnlLine2."Shortcut Dimension 1 Code" := '';
              CASE SurchargeRec."Source Type Department" OF
                SurchargeRec."Source Type Department"::Employee:
                  IF EmplRec.GET("Employee No.") THEN
                    GenJnlLine2."Shortcut Dimension 1 Code" := EmplRec."Global Dimension 1 Code";
                SurchargeRec."Source Type Department"::Job:
                  GenJnlLine2."Shortcut Dimension 1 Code" := lvDim1;
                SurchargeRec."Source Type Department"::Fixed:
                  GenJnlLine2."Shortcut Dimension 1 Code" := SurchargeRec."Coverage Department"
              END;
              GenJnlLine2."Shortcut Dimension 2 Code" := lvDim2;
              DimMgt.ValidateShortcutDimValues(1,GenJnlLine2."Shortcut Dimension 1 Code",GenJnlLine2."Dimension Set ID");

              IF SurchargeRec."Compress Coverage Posting" THEN BEGIN
                GenJnlLine2."Cost Component" := '';
                GenJnlLine2."Job No." := '';
                GenJnlLine2.Element := '';
                GenJnlLine2."Extension Contract" := '';
                GenJnlLine2."Service Order No." := '';
                GenJnlLine2."Service Location No." := '';
                GenJnlLine2."Service Contract No." := '';
                GenJnlLine2."Service Category" := '';
                GenJnlLine2."Rental Unit" := '';
              END;

              GenJnlLine2.Amount := lvCostTotal * -1;

              lvGenJnlLineSurcharge2 := GenJnlLine2;
              PostGenJnl.RunWithoutCheck(GenJnlLine2);
              lvGenJnlLine := GenJnlLine;

              IF lvOrigin = lvOrigin::Project THEN
                IF ProjTypeRec."Post Complementary Surcharge" THEN
                  PostComplementaryWIPSurcharges(lvOrigin,DimValRec,lvGenJnlLineSurcharge2,lvGenJnlLineSurcharge1);

              IF lvOrigin = lvOrigin::Service THEN
                IF ServTypeRec."Post Complementary Surcharge" THEN
                  PostComplementaryWIPSurcharges(lvOrigin,DimValRec,lvGenJnlLineSurcharge2,lvGenJnlLineSurcharge1);

              GenJnlLine := lvGenJnlLine;

            END;
          UNTIL SurchargeRec.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE GetStandardProjElement@1210190004(IProjectNo@1210190003 : Code[20];IRecevComp@1100485000 : Text[30]) lvElement@1210190002 : Code[20];
    VAR
      lvProjElementRec@1210190000 : Record 11012010;
      lvText001@1210190001 : TextConst 'ENU=Standard element of project %1 not present;NOR=Standardelement for prosjektet %1 finnes ikke;SVE=Standardelement fîr projektet %1 finns inte';
      lvProjRec@1100485001 : Record 11072003;
    BEGIN
      lvElement := '';
      IF IRecevComp <> '' THEN
        lvProjRec.CHANGECOMPANY(IRecevComp);
      lvProjRec.GET(IProjectNo);
      IF NOT lvProjRec."Posting Element Mandatory" THEN
        EXIT;

      IF IRecevComp <> '' THEN
        lvProjElementRec.CHANGECOMPANY(IRecevComp);
      lvProjElementRec.SETRANGE("Project No.", IProjectNo);
      lvProjElementRec.SETRANGE(Level, 0);
      IF lvProjElementRec.FIND('-') THEN
        lvElement := lvProjElementRec.Element;

      IF lvElement = '' THEN
        ERROR(lvText001, IProjectNo);
    END;

    PROCEDURE UpdateProgressWindow@9(NewProgress@11012000 : Integer);
    BEGIN
      IF NoOfRecords > 0 THEN BEGIN
        NewProgress := ROUND(NewProgress / NoOfRecords * 100,1);
        IF (NewProgress <> Progress) OR (TIME > LastUpdateTime + 5000) THEN BEGIN
          Window.UPDATE(1,100 * NewProgress);
          LastUpdateTime := TIME;
        END;
        Progress := NewProgress;
      END;
    END;

    PROCEDURE CreatePostedHours@1210190007();
    VAR
      lPostedHourHeaderSourceCompany@1210190004 : Record 11012084;
      lPostedHourLineSourceCompany@1210190000 : Record 11012085;
      lPostedHourHeader@1210190002 : Record 11012084;
      lPostedHourLine@1210190001 : Record 11012085;
      lGenerateDays@1210190006 : Codeunit 11012028;
      lLineNo@1210190003 : Integer;
    BEGIN
      WITH lPostedHourLineSourceCompany DO BEGIN
        CHANGECOMPANY(ICEntryRec."Receiving Company");
        SETCURRENTKEY("Receiving Company", "IC Tag No.");
        SETFILTER("Receiving Company", '%1', '');
        SETRANGE("IC Tag No.", ICEntryRec."IC Hours Tag No.");
        FINDFIRST;

        lPostedHourHeaderSourceCompany.CHANGECOMPANY(ICEntryRec."Receiving Company");
        lPostedHourHeaderSourceCompany.GET(Year, Week, "Employee No.");

        lPostedHourHeader := lPostedHourHeaderSourceCompany;
        IF lPostedHourHeader.INSERT THEN;

        lPostedHourLine.SETRANGE(Year, Year);
        lPostedHourLine.SETRANGE(Week, Week);
        lPostedHourLine.SETRANGE("Employee No.", "Employee No.");
        IF lPostedHourLine.FINDLAST THEN
          lLineNo := lPostedHourLine."Line No." + 1
        ELSE
          lLineNo := 1;
        lPostedHourLine := lPostedHourLineSourceCompany;
        lPostedHourLine."Line No." := lLineNo;
        lPostedHourLine.Status := lPostedHourLine.Status::Open;
        lPostedHourLine."Cost Plus Entry Created" := FALSE;
        lPostedHourLine."Supplying Company" := '';
        lPostedHourLine."Receiving Company" := ICEntryRec."Receiving Company";
        lPostedHourLine."Processing Date" := TODAY;
        lPostedHourLine.INSERT;

        IF HumanResourcesSetup."Posting Days Mandatory" THEN BEGIN
          lPostedHourHeader.SETRANGE(Year, Year);
          lPostedHourHeader.SETRANGE(Week, Week);
          lPostedHourHeader.SETRANGE("Employee No.", "Employee No.");
          lPostedHourHeader.SETRANGE("Document No.", "Document No.");
          lGenerateDays.SetDialog;
          lGenerateDays.RUN(lPostedHourHeader);
        END;
        PostLeaveHours(lPostedHourLine);

      END;
    END;

    PROCEDURE CheckProjStatusReceivingComp@1100485000();
    VAR
      lvProjSetupRec@1100485001 : Record 315;
      lvProjRec@1100485000 : Record 11072003;
    BEGIN
      IF ("Project No." = '') THEN
        EXIT;

      IF ("Post in Company" <> '') THEN BEGIN
        lvProjSetupRec.CHANGECOMPANY("Post in Company");
        lvProjRec.CHANGECOMPANY("Post in Company");
      END;

      lvProjSetupRec.GET;
      lvProjRec.GET("Project No.");

      IF (lvProjSetupRec."Provisions at Closure") THEN
        lvProjRec.CheckProjectStatus(-1)
      ELSE
        lvProjRec.CheckProjectStatus(0);
    END;

    PROCEDURE CheckProjElemBlockedRecComp@1100485001();
    VAR
      lvProjElemRec@1100485000 : Record 11012010;
    BEGIN
      IF ("Project No." = '') THEN
        EXIT;

      IF (Element = '') THEN
        EXIT;

      IF ("Post in Company" <> '') THEN BEGIN
        lvProjElemRec.CHANGECOMPANY("Post in Company");
      END;

      lvProjElemRec.GET("Project No.", Element);
      lvProjElemRec.CheckProjectElementBlocked;
    END;

    PROCEDURE CheckServOrderStatusReceivComp@1100525002();
    VAR
      lvServOrderRec@1100485000 : Record 11012823;
    BEGIN
      IF ("Service Order No." = '') THEN
        EXIT;

      IF ("Post in Company" <> '') THEN
        lvServOrderRec.CHANGECOMPANY("Post in Company");

      lvServOrderRec.GET("Service Order No.");
      lvServOrderRec.CheckStatus(1);
    END;

    PROCEDURE CheckPostingDateAllowed@1100485002();
    VAR
      lvUserSetupRec@1100485000 : Record 91;
      lvGLSetupRec@1100485001 : Record 98;
      lvAllowPostingFrom@1100485002 : Date;
      lvAllowPostingTo@1100485003 : Date;
    BEGIN
      IF ("Post in Company" <> '') THEN BEGIN
        lvUserSetupRec.CHANGECOMPANY("Post in Company");
        lvGLSetupRec.CHANGECOMPANY("Post in Company");
      END;

      IF USERID <> '' THEN
        IF lvUserSetupRec.GET(USERID) THEN BEGIN
          lvAllowPostingFrom := lvUserSetupRec."Allow Posting From";
          lvAllowPostingTo := lvUserSetupRec."Allow Posting To";
        END;
      IF (lvAllowPostingFrom = 0D) AND (lvAllowPostingTo = 0D) THEN BEGIN
        lvGLSetupRec.GET;
        lvAllowPostingFrom := lvGLSetupRec."Allow Posting From";
        lvAllowPostingTo := lvGLSetupRec."Allow Posting To";
      END;
      IF lvAllowPostingTo = 0D THEN
        lvAllowPostingTo := DMY2DATE(31,12,9999);

      IF ("Posting Date" < lvAllowPostingFrom) OR ("Posting Date" > lvAllowPostingTo) THEN
        ERROR(Text001, TABLECAPTION, "Post in Company", "Posting Date");
    END;

    PROCEDURE CheckGlobalDimAllowed@1100525005(FieldNumber@1100525001 : Integer;ShortcutDimCode@1100525000 : Code[20]);
    VAR
      lvGLSetupRec@1100525003 : Record 98;
      GLSetupShortcutDimCode@1100525004 : ARRAY [8] OF Code[20];
      ErrorTxt@1100525002 : Text[300];
    BEGIN
      lvGLSetupRec.CHANGECOMPANY("Receiving Company");
      lvGLSetupRec.GET;

      GLSetupShortcutDimCode[1] := lvGLSetupRec."Shortcut Dimension 1 Code";
      GLSetupShortcutDimCode[2] := lvGLSetupRec."Shortcut Dimension 2 Code";
      GLSetupShortcutDimCode[3] := lvGLSetupRec."Shortcut Dimension 3 Code";
      GLSetupShortcutDimCode[4] := lvGLSetupRec."Shortcut Dimension 4 Code";
      GLSetupShortcutDimCode[5] := lvGLSetupRec."Shortcut Dimension 5 Code";
      GLSetupShortcutDimCode[6] := lvGLSetupRec."Shortcut Dimension 6 Code";
      GLSetupShortcutDimCode[7] := lvGLSetupRec."Shortcut Dimension 7 Code";
      GLSetupShortcutDimCode[8] := lvGLSetupRec."Shortcut Dimension 8 Code";

      IF GLSetupShortcutDimCode[FieldNumber] = '' THEN
        ERROR(Text002,lvGLSetupRec.TABLECAPTION);

      IF NOT DimMgt.CheckDimValueCompany(GLSetupShortcutDimCode[FieldNumber],
        ShortcutDimCode, "Receiving Company") THEN
      BEGIN
        ErrorTxt := DimMgt.GetDimErr();
        ErrorTxt := ErrorTxt + ' ' + FIELDCAPTION("Receiving Company") + ': ' + "Receiving Company";
        ERROR(ErrorTxt);
      END;
    END;

    PROCEDURE PostLeaveHours@1100485090(lPostedHourLine@1100485003 : Record 11012085);
    VAR
      LeaveLedgEntry@1100485001 : Record 11020235;
    BEGIN
      WITH GenJnlLine DO BEGIN

        IF (lPostedHourLine."Leave Type" = '') OR (lPostedHourLine."Supplying Company" <> '') THEN
          EXIT;

        IF NextLeaveEntryNo = 0 THEN BEGIN
          LeaveLedgEntry.LOCKTABLE;
          IF LeaveLedgEntry.FIND('+') THEN
            NextLeaveEntryNo := LeaveLedgEntry."Entry No.";
        END;
        NextLeaveEntryNo := NextLeaveEntryNo + 1;

        LeaveLedgEntry.INIT;
        LeaveLedgEntry."Entry No." := NextLeaveEntryNo;
        LeaveLedgEntry."Posting Date" := "Posting Date";
        LeaveLedgEntry."Document No." := "Document No.";
        IF lPostedHourLine."Leave Factor" = 0 THEN
          LeaveLedgEntry."No. of Hours" := ROUND(lPostedHourLine."Total Line")
        ELSE
          LeaveLedgEntry."No. of Hours" := ROUND(lPostedHourLine."Total Line" * lPostedHourLine."Leave Factor");
        LeaveLedgEntry."Employee No." := "Employee No.";
        LeaveLedgEntry."Leave Type" := lPostedHourLine."Leave Type";
        LeaveLedgEntry."User ID" := USERID;
        LeaveLedgEntry."Document Date" := "Posting Date";
        LeaveLedgEntry."Source Code" := "Source Code";
        LeaveLedgEntry."Reason Code" := "Reason Code";
        LeaveLedgEntry.INSERT(TRUE);
      END;
    END;

    PROCEDURE CheckCompressPlantJobEntries@1100485003() : Boolean;
    BEGIN
      IF ICEntryRec."Plant Invoice" AND (ICEntryRec."Project No." <> '') AND (CompanyData."Compr. Proj.Ledg. Plant Entr.") THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE CompressPlantJobEntries@5819(IJobJnlLineRec@1100485001 : Record 11072008);
    VAR
      lvText11012001@1100485000 : TextConst 'ENU=Plant %1 %2;NOR=Maskin %1 %2;SVE=Maskin %1 %2';
    BEGIN
      //* Like in codeunit 80, but here also compress per documentno. (invoice) (in cu80 always one at a time)

      WITH TmpCompressJobJnlLineRec DO BEGIN
        SETRANGE("Document No.",IJobJnlLineRec."Document No.");
        SETRANGE("No.",IJobJnlLineRec."No.");
        SETRANGE("Posting Group",IJobJnlLineRec."Posting Group");
        SETRANGE("Gen. Prod. Posting Group",IJobJnlLineRec."Gen. Prod. Posting Group");
        SETRANGE("Gen. Bus. Posting Group",IJobJnlLineRec."Gen. Bus. Posting Group");
        SETRANGE("Shortcut Dimension 1 Code",IJobJnlLineRec."Shortcut Dimension 1 Code");
        SETRANGE("Shortcut Dimension 2 Code",IJobJnlLineRec."Shortcut Dimension 2 Code");
        SETRANGE("Dimension Set ID",IJobJnlLineRec."Dimension Set ID");
        IF FINDFIRST THEN BEGIN
          "Total Cost (LCY)" := "Total Cost (LCY)" + IJobJnlLineRec."Total Cost (LCY)";
          "Source Currency Total Cost" := "Source Currency Total Cost" + IJobJnlLineRec."Source Currency Total Cost";
          MODIFY;
        END ELSE BEGIN
          TRANSFERFIELDS(IJobJnlLineRec);
          "Line No." := CompressNextLineNo;
          Description := STRSUBSTNO(lvText11012001,
            ICEntryRec.FIELDCAPTION("Rental Period to Date"), ICEntryRec."Rental Period to Date");
          Quantity := 0;
          "Unit of Measure Code" := '';
          INSERT;
          CompressNextLineNo := CompressNextLineNo + 1;
        END;
      END;
    END;

    PROCEDURE PostCompressedPlantJobEntries@1100485006();
    BEGIN
      WITH TmpCompressJobJnlLineRec DO BEGIN
        RESET;
        IF FINDSET(TRUE, FALSE) THEN BEGIN
          REPEAT
            PostJobJnl.RUN(TmpCompressJobJnlLineRec);
          UNTIL NEXT = 0;
          DELETEALL;
        END;
      END;
    END;

    PROCEDURE ComplementaryWIPProj@1100525000(lvJobJnlLine@1100485004 : Record 11072008);
    VAR
      Vendor@1100525003 : Record 23;
    BEGIN
      IF (lvJobJnlLine."Total Cost (LCY)" = 0) AND
         (lvJobJnlLine."Total Price (LCY)" = 0) THEN
        EXIT;

      DimMgt.GetDimValueRec(2, lvJobJnlLine."Shortcut Dimension 2 Code", DimValRec, TRUE, '');
      IF DimValRec."Cost Type" <> DimValRec."Cost Type"::Revenue THEN BEGIN
        IF (lvJobJnlLine."Total Cost (LCY)" = 0) OR
           (NOT ProjTypeRec."Post Complementary Costs") THEN
          EXIT;
      END ELSE BEGIN
        IF (lvJobJnlLine."Total Price (LCY)" = 0) OR
           (NOT ProjTypeRec."Post Complementary Revenues") OR
           lvJobJnlLine."Advance Payment"
        THEN
          EXIT;
      END;

      // vendor postinggroup should come from setup
      IF NOT ICRelationRec.GET(ICEntryRec."Supplying Company", ICEntryRec."Receiving Company") THEN
        ICRelationRec."Vendor Posting Group" := '';

      IF NOT ICEntryRec."Use IC Vendor Posting Group" THEN
        ICRelationRec."Vendor Posting Group" := '';

      IF (ICRelationRec."Vendor Posting Group" = '') AND (lvJobJnlLine.Vendor <> '') THEN
        IF Vendor.GET(lvJobJnlLine.Vendor) THEN
          ICRelationRec."Vendor Posting Group" := Vendor."Vendor Posting Group";

      PostComplWIP(
        lvJobJnlLine,
        ProjTypeRec.GetComplWIPCoverAcc(DimValRec."Cost Type",ICRelationRec."Vendor Posting Group",''),
        ProjTypeRec.GetComplWipAcc(DimValRec."Cost Type",ICRelationRec."Vendor Posting Group",''));
    END;

    PROCEDURE ComplementaryWIPServ@1100485005(iJobJnlLine@1100485004 : Record 11072008;ServiceOrder@1100528500 : Record 11012823);
    VAR
      Vendor@1100525003 : Record 23;
    BEGIN
      IF (iJobJnlLine."Total Cost (LCY)" = 0) AND
         (iJobJnlLine."Total Price (LCY)" = 0) THEN
        EXIT;

      DimMgt.GetDimValueRec(2, iJobJnlLine."Shortcut Dimension 2 Code", DimValRec, TRUE, '');
      IF DimValRec."Cost Type" <> DimValRec."Cost Type"::Revenue THEN BEGIN
        IF (iJobJnlLine."Total Cost (LCY)" = 0) OR
           (NOT ServTypeRec."Post Complementary Costs") THEN
          EXIT;
      END ELSE BEGIN
        IF (iJobJnlLine."Total Price (LCY)" = 0) OR
           (NOT ServTypeRec."Post Complementary Revenues") OR
           iJobJnlLine."Advance Payment"
        THEN
          EXIT;
      END;

      // vendor postinggroup should come from setup
      IF NOT ICRelationRec.GET(ICEntryRec."Supplying Company", ICEntryRec."Receiving Company") THEN
        ICRelationRec."Vendor Posting Group" := '';

      IF NOT ICEntryRec."Use IC Vendor Posting Group" THEN
        ICRelationRec."Vendor Posting Group" := '';

      IF (ICRelationRec."Vendor Posting Group" = '') AND (iJobJnlLine.Vendor <> '') THEN
        IF Vendor.GET(iJobJnlLine.Vendor) THEN
          ICRelationRec."Vendor Posting Group" := Vendor."Vendor Posting Group";

      PostComplWIP(
        iJobJnlLine,
        ServTypeRec.GetComplWIPCoverAcc(DimValRec."Cost Type",ICRelationRec."Vendor Posting Group",'',ServiceOrder),
        ServTypeRec.GetComplWipAcc(DimValRec."Cost Type",ICRelationRec."Vendor Posting Group",''));
    END;

    PROCEDURE PostComplWIP@1100525003(lvJobJnlLine@1100525000 : Record 11072008;iWIPBalanceAccount@1100525002 : Code[20];iWIPAccountCosts@1100525003 : Code[20]);
    BEGIN
      WITH lvJobJnlLine DO BEGIN
        GenJnlLine.INIT;
        GenJnlLine."Source Code" := "Source Code";
        GenJnlLine."Reason Code":= "Reason Code";
        GenJnlLine."Account Type" := GenJnlLine."Account Type"::"G/L Account";
        GenJnlLine."Bal. Account No." := iWIPBalanceAccount;
        GenJnlLine."Account No." := iWIPAccountCosts;
        GenJnlLine."Posting Date" := "Posting Date";
        GenJnlLine."Document No." := "Document No.";
        GenJnlLine."System-Created Entry" := TRUE;
        GenJnlLine."Document Date" := "Document Date";
        GenJnlLine.Description := Description;
        GenJnlLine."Description 2" := "Description 2";
        GenJnlLine.VALIDATE(Amount, "Total Cost (LCY)");
        IF DimValRec."Cost Type" = DimValRec."Cost Type"::Revenue THEN
          GenJnlLine.VALIDATE(Amount, "Total Price (LCY)")
        ELSE
          GenJnlLine.VALIDATE(Amount, "Total Cost (LCY)");
        GenJnlLine."Shortcut Dimension 1 Code" := "Shortcut Dimension 1 Code";
        GenJnlLine."Shortcut Dimension 2 Code" := "Shortcut Dimension 2 Code";
        GenJnlLine."Dimension Set ID" := "Dimension Set ID";
        GenJnlLine."Cost Component" := "Cost Component";
        GenJnlLine."Closed Project No." := "Job No.";
        GenJnlLine."Closed Service Order No." := "Service Order No.";
        GenJnlLine."Closed Service Contract No." := "Service Contract No.";
        GenJnlLine."Origin Type" :=  GenJnlLine."Origin Type"::Project;

        PostGenJnl.RunWithCheck(GenJnlLine);
      END;
    END;

    PROCEDURE PostComplementaryWIPSurcharges@1100525004(lvOrigin@1100525000 : 'Project,Service';DimVal@1100528500 : Record 349;iGenJnlLineDebet@1100525002 : Record 81;iGenJnlLineCredit@1100525003 : Record 81);
    BEGIN
      ICRelationRec."Vendor Posting Group" := '';

      iGenJnlLineDebet."Shortcut Dimension 1 Code" := iGenJnlLineCredit."Shortcut Dimension 1 Code";
      DimMgt.ValidateShortcutDimValues(1,iGenJnlLineDebet."Shortcut Dimension 1 Code",iGenJnlLineDebet."Dimension Set ID");

      IF lvOrigin = lvOrigin::Project THEN BEGIN
        iGenJnlLineCredit."Account No." := ProjTypeRec.GetComplWipAccSurch(DimVal."Cost Type",'');
        PostGenJnl.RunWithoutCheck(iGenJnlLineCredit);

        iGenJnlLineDebet."Account No." := ProjTypeRec.GetComplWIPCoverAccSurch(DimVal."Cost Type",'');
        PostGenJnl.RunWithoutCheck(iGenJnlLineDebet);
      END;

      IF lvOrigin = lvOrigin::Service THEN BEGIN
        iGenJnlLineCredit."Account No." := ServTypeRec.GetComplWipAccSurch(DimVal."Cost Type",'');
        PostGenJnl.RunWithoutCheck(iGenJnlLineCredit);

        iGenJnlLineDebet."Account No." :=  ServTypeRec.GetComplWIPCoverAccSurch(DimVal."Cost Type",'');
        PostGenJnl.RunWithoutCheck(iGenJnlLineDebet);
      END;
    END;

    PROCEDURE AssignServiceToProjectEntry@1100525006(iServJnlRec@1210190000 : Record 11012820;IRentalUnit@1100485000 : Code[20]);
    BEGIN
      WITH iServJnlRec DO BEGIN
        JobJnlLine.INIT;
        JobJnlLine."Line No." := "Line No.";
        JobJnlLine."Employee No." := "Employee No.";
        JobJnlLine."Document No." := "Document No.";
        JobJnlLine.Type := JobJnlLine.Type::"G/L Account";
        JobJnlLine."Job No." := "Project No.";
        JobJnlLine."Rental Unit" := IRentalUnit;
        JobJnlLine."Service Order No." := "Service Order No.";
        JobJnlLine."Service Contract No." := "Service Contract No.";
        JobJnlLine."Service Location No." := "Service Location No.";
        JobJnlLine."Shortcut Dimension 1 Code" := "Shortcut Dimension 1 Code";
        JobJnlLine."Shortcut Dimension 2 Code" := "Shortcut Dimension 2 Code";
        JobJnlLine."Dimension Set ID" := "Dimension Set ID";
        JobJnlLine."Source Code" := "Source Code";
        JobJnlLine."Reason Code" := "Reason Code";
        JobJnlLine."Posting Date" := "Posting Date";
        JobJnlLine.Description := Description;
        JobJnlLine."No." := "WIP Account Costs";
        JobJnlLine.Quantity := Quantity;
        JobJnlLine."Unit of Measure Code" := "Unit of Measure Code";
        JobJnlLine."Unit Cost (LCY)" := "Unit Cost (LCY)";
        JobJnlLine."Total Cost (LCY)" := "Total Cost (LCY)";
        JobJnlLine."Currency Code" := '';
        JobJnlLine."Currency Factor" := 1;
        JobJnlLine."Unit Cost" := JobJnlLine."Unit Cost (LCY)";    //* Currency Factor is 1
        JobJnlLine."Total Cost" := JobJnlLine."Total Cost (LCY)";
        JobJnlLine.Surcharge := Surcharge;
        JobJnlLine."Wage Component" := "Wage Component";
        JobJnlLine."Cost Component" := "Cost Component";
      END;
    END;

    PROCEDURE ComplementaryWIPICEntry@1100525001(lvOrigin@1100525000 : 'Project,Service';iGenJnlLine@1100525002 : Record 81);
    VAR
      lvWIPBalanceAccount@1100525006 : Code[20];
      lvWIPAccountCosts@1100525005 : Code[20];
      lvPostingSetup@1100525003 : Record 11020565;
    BEGIN
      IF lvPostingSetup.GET(iGenJnlLine."Source Code", "Supplying Company", "Receiving Company") THEN BEGIN

        //Post Debit Line
        lvPostingSetup.TESTFIELD("Prod. Account Debit");
        lvWIPBalanceAccount := lvPostingSetup."Prod. Account Debit";

        //Post Credit Line
        lvPostingSetup.TESTFIELD("Prod. Account Credit");
        lvWIPAccountCosts := lvPostingSetup."Prod. Account Credit";

        iGenJnlLine."Account No." := lvWIPBalanceAccount;
        iGenJnlLine."Bal. Account No." := lvWIPAccountCosts;

        PostGenJnl.RunWithoutCheck(iGenJnlLine);
      END;
    END;

    PROCEDURE ShowDimensions@25();
    BEGIN
      DimMgt.SetCompany("Post in Company");
      DimMgt.SetTableID(DATABASE::"Intercompany Entry");
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet("Dimension Set ID",STRSUBSTNO('%1',"Line No."));
      DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Global Dimension 1 Code","Cost Object");
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(11012058) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 11012058');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Intercompany Entry", "Global Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Global Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Global Dimension 1 Code");
    END;

    LOCAL PROCEDURE GetAmountRoundingPrecision@1100528406(CurrencyCode@1100528400 : Code[10]) : Decimal;
    VAR
      Currency@1100528401 : Record 4;
    BEGIN
      GetCurrency(CurrencyCode, Currency);
      EXIT(Currency."Amount Rounding Precision");
    END;

    LOCAL PROCEDURE GetUnitAmountRoundingPrecision@1100528407(CurrencyCode@1100528400 : Code[10]) : Decimal;
    VAR
      Currency@1100528401 : Record 4;
    BEGIN
      GetCurrency(CurrencyCode, Currency);
      EXIT(Currency."Unit-Amount Rounding Precision");
    END;

    LOCAL PROCEDURE GetCurrency@3(CurrencyCode@1100525001 : Code[10];VAR Currency@1100525000 : Record 4);
    VAR
      GeneralLedgerSetup@1100528400 : Record 98;
    BEGIN
      IF CurrencyCode = '' THEN BEGIN
        CLEAR(Currency);
        Currency.InitRoundingPrecision
      END ELSE BEGIN
        GeneralLedgerSetup.GET;
        IF (NOT Currency.GET(CurrencyCode)) OR
           (CurrencyCode = GeneralLedgerSetup."LCY Code")
        THEN
          Currency.InitRoundingPrecision;
      END;
    END;

    PROCEDURE GetAmountLCYPostInCompany@1100528400() : Decimal;
    BEGIN
      EXIT(ExchangeAmtFCYToLCYPostInCompany(Amount, FALSE));
    END;

    PROCEDURE GetPriceLCYPostInCompany@1100528401() : Decimal;
    BEGIN
      EXIT(ExchangeAmtFCYToLCYPostInCompany(Price, TRUE));
    END;

    LOCAL PROCEDURE ExchangeAmtFCYToLCYPostInCompany@1100528405(Amt@1100528400 : Decimal;IsUnitAmount@1100528405 : Boolean) : Decimal;
    VAR
      GeneralLedgerSetup@1100528401 : Record 98;
      CurrencyExchangeRate@1100528403 : Record 330;
      Currency@1100528406 : Record 4;
      CurrencyFactor@1100528402 : Decimal;
      AmtLCYPostInCompany@1100528404 : Decimal;
      RoundingPrecision@1100528407 : Decimal;
    BEGIN
      IF "Currency Code" = '' THEN
        EXIT(Amt);
      IF NOT GeneralLedgerSetup.GET THEN
        EXIT(Amt);
      IF "Currency Code" = GeneralLedgerSetup."LCY Code" THEN
        EXIT(Amt);
      IF NOT Currency.GET("Currency Code") THEN
        EXIT(Amt); // If currency cannot be found in table Currency, it is supposed to be local currency.

      CurrencyFactor := CurrencyExchangeRate.ExchangeRate(
        0, '', "Posting Date", "Currency Code", "Account Type" = "Account Type"::Customer);
      IF IsUnitAmount THEN
        RoundingPrecision := GeneralLedgerSetup."Unit-Amount Rounding Precision"
      ELSE
        RoundingPrecision := GeneralLedgerSetup."Amount Rounding Precision";
      AmtLCYPostInCompany := ROUND(
        CurrencyExchangeRate.ExchangeAmtFCYToLCY(
          0, '', "Posting Date", "Currency Code", Amt, CurrencyFactor,
          "Account Type" = "Account Type"::Customer),
        RoundingPrecision);
      EXIT(AmtLCYPostInCompany);
    END;

    LOCAL PROCEDURE InsertIntercompanyLedgerEntry@1100528403(IntercompanyEntry@1100528401 : Record 11012058) : Integer;
    VAR
      IntercompanyLedgerEntry@1100528400 : Record 11229313;
    BEGIN
      IF NextIntercompanyLedgerEntryNo = 0 THEN BEGIN
        IntercompanyLedgerEntry.LOCKTABLE;
        IF IntercompanyLedgerEntry.FINDLAST THEN
          NextIntercompanyLedgerEntryNo := IntercompanyLedgerEntry."Entry No." + 1
        ELSE
          NextIntercompanyLedgerEntryNo := 1;
      END;
      IntercompanyLedgerEntry.TRANSFERFIELDS(IntercompanyEntry);
      IntercompanyLedgerEntry."Entry No." := NextIntercompanyLedgerEntryNo;
      IntercompanyLedgerEntry.INSERT;
      NextIntercompanyLedgerEntryNo := NextIntercompanyLedgerEntryNo + 1;
      EXIT(IntercompanyLedgerEntry."Entry No.");
    END;

    PROCEDURE GetICAccountNoOfCurrentCompany@1100528402() : Code[20];
    VAR
      IntercompanyRelation@1100528400 : Record 11012057;
    BEGIN
      IntercompanyRelation.GET("Supplying Company", "Receiving Company");
      EXIT(IntercompanyRelation.GetICAccountOfCurrentCompany)
    END;

    PROCEDURE AddICRelationDims@1100529400(IntercompanyRelation@1100529400 : Record 11012057);
    VAR
      DimMgt@1100529401 : Codeunit 408;
      DimSetIDArr@1100529404 : ARRAY [10] OF Integer;
      DimSetToAdd@1100529402 : Integer;
    BEGIN
      IF "Post in Company" = "Receiving Company" THEN
        DimSetToAdd := IntercompanyRelation."Dimension Set ID Receiving C."
      ELSE
        DimSetToAdd := IntercompanyRelation."Dimension Set ID Supplying C.";

      IF DimSetToAdd = 0 THEN
        EXIT;

      DimSetIDArr[1] := "Dimension Set ID";
      DimSetIDArr[2] := DimSetToAdd;

      DimMgt.SetCompany("Post in Company");
      "Dimension Set ID" := DimMgt.GetCombinedDimensionSetID(DimSetIDArr,"Global Dimension 1 Code","Cost Object");
    END;

    BEGIN
    END.
  }
}

