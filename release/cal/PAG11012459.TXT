OBJECT Page 11012459 Complaint Management
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=&Beschwerderegistrierung;
               ENU=Complaint Management;
               NLD=Klachtregistratie;
               NOR=KlagehÜndtering;
               SVE=Incidenthantering];
    SourceTable=Table11012450;
    PopulateAllFields=Yes;
    PageType=Card;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[DEU=Neu, Prozess, Bericht, Mail-Dokumente;
                                ENU=New,Process,Report,Mail Documents;
                                NLD=Nieuw,Proces,Lijst,Documenten mailen;
                                NOR=Ny,Behandle,Rapport,Send dokument;
                                SVE=Ny,Behandla,Rapport,Maila dokument];
    OnInit=BEGIN
             "Source No. 2Editable" := TRUE;
             "Source No.Editable" := TRUE;
             "Source TypeEditable" := TRUE;
             UnitEditable := TRUE;
             "Delivered ObjectEditable" := TRUE;
             DeliveryEditable := TRUE;
             "Plot No.Editable" := TRUE;
             "Project No.Editable" := TRUE;
             DocumentSubformEditable := TRUE;
             SFComplaintCommisionsEditable := TRUE;
             ComplaintNoteSubformEditable := TRUE;
             ShowPlantInventButtonVisible := TRUE;
           END;

    OnOpenPage=VAR
                 lCount@1100409000 : Integer;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 //Find out from where the page is opened
                 FOR lCount:= 1 TO 2 DO
                 BEGIN
                   IF gCalledFrom = 0 THEN BEGIN
                     IF lCount  = 1 THEN
                        FILTERGROUP(3);
                     IF lCount  = 2 THEN
                        FILTERGROUP(0);
                     gDeliveredObject := GETFILTER("Delivered Object");
                     IF gDeliveredObject <> '' THEN BEGIN
                       gProjNo := GETFILTER("Project No.");
                       gPlotNo := GETFILTER("Plot No.");
                       gCalledFrom := gCalledFrom::DeliveredObject;
                     END ELSE BEGIN
                       gDelivery := GETFILTER(Delivery);
                       IF gDelivery <> '' THEN BEGIN
                         gProjNo := GETFILTER("Project No.");
                         gPlotNo := GETFILTER("Plot No.");
                         gCalledFrom := gCalledFrom::Delivery;
                       END ELSE BEGIN
                         gPlotNo := GETFILTER("Plot No.");
                         IF gPlotNo <> '' THEN BEGIN
                           gProjNo := GETFILTER("Project No.");
                           gCalledFrom :=  gCalledFrom::Plot;
                         END ELSE BEGIN
                           gPlotNo := GETFILTER("Plot No.");
                           IF gPlotNo <> '' THEN
                             gCalledFrom := gCalledFrom::Project;
                         END;
                       END;
                     END;
                   END;
                 END;
                 FILTERGROUP(0);
                 //
               END;

    OnAfterGetRecord=BEGIN
                       SetEditableOnStatus();
                     END;

    OnNewRecord=VAR
                  DeliveredObject@1100529001 : Record 11012101;
                  Proj@1100529002 : Record 11072003;
                BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  CASE gCalledFrom OF
                    gCalledFrom::Project:
                      "Project No." := gProjNo;
                    gCalledFrom::Plot:
                      BEGIN
                        "Project No." := gProjNo;
                        "Plot No." := gPlotNo;
                      END;
                    gCalledFrom::Delivery:
                      BEGIN
                        "Project No." := gProjNo;
                        "Plot No." := gPlotNo;
                        Delivery := gDelivery;
                        IF DeliveryRec.GET("Project No.","Plot No.",Delivery) THEN
                          "Delivery Date" := DT2DATE(DeliveryRec."Delivery Date");
                       END;
                    gCalledFrom::DeliveredObject:
                      BEGIN
                        "Delivered Object" := gDeliveredObject;
                        IF NOT Proj.GET(gProjNo) THEN
                          gProjNo := '';
                        IF ("Delivered Object" <> '') AND DeliveredObject.GET("Delivered Object") THEN BEGIN
                          IF (DeliveredObject."Original Project" <> '') AND (Proj.GET(DeliveredObject."Original Project")) THEN
                            gProjNo := DeliveredObject."Original Project";
                        END;
                        "Project No." := gProjNo;
                        "Plot No." := gPlotNo;
                         VALIDATE("Delivered Object", gDeliveredObject);
                      END;
                  END;

                  "Complaint about" := gCalledFrom;
                  GetContact_BilltoContact;
                  SetEditableOnStatus();
                END;

    OnModifyRecord=BEGIN
                     SetEditableOnStatus();
                   END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateRegisterExternalDocumentFB;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100485094;1 ;ActionGroup;
                      CaptionML=[DEU=&Beschwerdenregistrierung;
                                 ENU=&Complaints;
                                 NLD=&Klachtregistratie;
                                 NOR=&Klager;
                                 SVE=&KlagomÜl] }
      { 1210190007;2 ;Action    ;
                      CaptionML=[DEU=AuftrÑge;
                                 ENU=Orders;
                                 NLD=Opdrachten;
                                 NOR=Ordrer;
                                 SVE=Order];
                      RunObject=Page 11012454;
                      RunPageLink=Complaint No.=FIELD(No.);
                      Promoted=Yes;
                      Image=ServiceAgreement;
                      PromotedCategory=Process;
                      RunPageMode=Edit }
      { 1210190008;2 ;Action    ;
                      CaptionML=[DEU=Belege NAV;
                                 ENU=Documents NAV;
                                 NLD=Documenten NAV;
                                 NOR=Dokumenter NAV;
                                 SVE=Dokument NAV];
                      RunObject=Page 11020412;
                      RunPageLink=Complaint No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Process;
                      RunPageMode=Edit }
      { 1100525013;2 ;Action    ;
                      CaptionML=[DEU=Garantie;
                                 ENU=Warranty;
                                 NLD=Garantie;
                                 NOR=Garanti;
                                 SVE=Garanti];
                      RunObject=Page 11124859;
                      RunPageView=SORTING(Job No.);
                      RunPageLink=Job No.=FIELD(Project No.);
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Process;
                      RunPageMode=Edit }
      { 1210190002;2 ;Action    ;
                      CaptionML=[DEU=Belege;
                                 ENU=Documents;
                                 NLD=Documenten;
                                 NOR=Dokumenter;
                                 SVE=Dokument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 RecRef@1100525002 : RecordRef;
                                 DocumentFilters@1100525003 : Codeunit 11012432;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, '', FALSE, TRUE);
                               END;
                                }
      { 1100525029;2 ;Action    ;
                      CaptionML=[DEU=QualitÑt, Umwelt- und Arbeitsschutz-Abweichungen;
                                 ENU=QA Deviations;
                                 NLD=KAM-afwijkingen;
                                 NOR=Kvalitetssikringsavvik;
                                 SVE=KvalitetssÑkringsavvikelser];
                      Image=Tools;
                      OnAction=VAR
                                 QADeviationCard@1100525000 : Page 11125986;
                               BEGIN
                                 TESTFIELD("No.");
                                 TESTFIELD("Project No.");
                                 QADeviationCard.SetComplaintProjectFilter("No.", "Project No.");
                                 QADeviationCard.SetSourceNonEditable(TRUE);
                                 QADeviationCard.RUNMODAL;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100485911;1 ;Action    ;
                      CaptionML=[DEU=&Textverarbeiter;
                                 ENU=&Text Editor;
                                 NLD=&Tekstverwerker;
                                 NOR=&Tekstredigering;
                                 SVE=&Texteditor];
                      Promoted=Yes;
                      Image=SNInfo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 IF Status = Status::Finished THEN
                                   FIELDERROR(Status);
                                 CurrPage.ComplaintNoteSubform.PAGE.EditText;
                               END;
                                }
      { 1100485036;1 ;ActionGroup;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions;
                                 NLD=F&uncties;
                                 NOR=Fu&nksjon;
                                 SVE=Fu&nktion] }
      { 1100525020;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Beschwerde kopieren;
                                 ENU=Copy Complaint;
                                 NLD=Klacht kopiâren;
                                 NOR=Kopier klage;
                                 SVE=Kopiera klagomÜl];
                      Image=Copy;
                      OnAction=VAR
                                 CopyComplaintFrm@1100525000 : Page 11020414;
                               BEGIN
                                 //kzwerver, 110801, n, # 26039
                                 CopyComplaintFrm.SetDefaults("No.");
                                 CopyComplaintFrm.StdDialogRunModal;
                               END;
                                }
      { 1100525023;2 ;Action    ;
                      CaptionML=[DEU=Kleinprojekt koppeln;
                                 ENU=Link Small Project;
                                 NLD=Klusproject koppelen;
                                 NOR=Koble lite prosjekt;
                                 SVE=LÑnka mindre projekt];
                      Image=Link;
                      OnAction=BEGIN
                                 //kzwerver, 110802, c, #26039
                                 Rec.LinkSmallProject;
                               END;
                                }
      { 1100525024;2 ;Action    ;
                      CaptionML=[DEU=Kleinprojekt entkoppeln;
                                 ENU=Unlink Small Project;
                                 NLD=Klusproject ontkoppelen;
                                 NOR=Fjern kobling til lite prosjekt;
                                 SVE=Ta bort lÑnk till mindre projekt];
                      Image=UnLinkAccount;
                      OnAction=BEGIN
                                 //kzwerver, 110802, c, #26039
                                 Rec.UnLinkSmallProject;
                               END;
                                }
      { 1100485045;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Erstellen Rechnung;
                                 ENU=Generate &Invoice;
                                 NLD=Aanmaken &factuur;
                                 NOR=Generer &faktura;
                                 SVE=Generera &faktura];
                      Image=Invoice;
                      OnAction=BEGIN
                                 {//C008960.so
                                 IF ("Sales Invoice" = '') AND
                                    ("Inquiry Costs" <> 0)  THEN BEGIN
                                   CLEAR(GenerateDelObjectsInvoice);
                                   GenerateDelObjectsInvoice.RUN(Rec);
                                 END ELSE BEGIN
                                   IF ("Inquiry Costs" = 0) THEN
                                     MESSAGE(Text004)
                                   ELSE
                                     MESSAGE(Text001);
                                 END
                                 }//C008960.eo

                                 //C008960.sn
                                 IF ("Inquiry Costs" <> 0)  THEN BEGIN
                                   IF CheckAlreadyInvoiced(0) THEN BEGIN
                                     MESSAGE(Text001)
                                   END ELSE BEGIN
                                     CLEAR(GenerateDelObjectsInvoice);
                                     GenerateDelObjectsInvoice.RUN(Rec);
                                   END;
                                 END ELSE
                                   MESSAGE(Text004)
                                 //C008960.en
                               END;
                                }
      { 1100485046;2 ;Action    ;
                      CaptionML=[DEU=Erstellen Gutschrift;
                                 ENU=Generate &Credit Memo;
                                 NLD=Aanmaken &credit nota;
                                 NOR=Generer &kreditnota;
                                 SVE=Generera &kreditnota];
                      Image=CreateCreditMemo;
                      OnAction=BEGIN
                                 {//C008960.so
                                 IF ("Sales Invoice" <> '') AND
                                    ("Credit Memo" = '') THEN BEGIN
                                   CLEAR(GenerateDelObjectsInvoice);
                                   "Inquiry Costs" := -1.0 * "Inquiry Costs";
                                   GenerateDelObjectsInvoice.RUN(Rec);
                                   "Inquiry Costs" := -1.0 * "Inquiry Costs";
                                   MODIFY();
                                 END ELSE BEGIN
                                   IF ("Credit Memo" = '') THEN
                                     MESSAGE(Text002)
                                   ELSE
                                     MESSAGE(Text005);
                                 END;
                                 }//C008960.eo

                                 //C008960.sn
                                 IF ("Sales Invoice" <> '') AND ("Inquiry Costs" <> 0) THEN BEGIN
                                   IF CheckAlreadyInvoiced(1) THEN BEGIN
                                     MESSAGE(Text005)
                                   END ELSE BEGIN
                                     "Inquiry Costs" := -1.0 * "Inquiry Costs";
                                     CLEAR(GenerateDelObjectsInvoice);
                                     GenerateDelObjectsInvoice.RUN(Rec);
                                     "Inquiry Costs" := -1.0 * "Inquiry Costs";
                                     MODIFY;
                                   END;
                                 END ELSE
                                   MESSAGE(Text002);
                                 //C008960.en
                               END;
                                }
      { 1100485047;2 ;Action    ;
                      CaptionML=[DEU=Erstellen Kleinprojekte;
                                 ENU=Generate &Small Projects;
                                 NLD=Aanmaken &klusprojecten;
                                 NOR=Generer &lite prosjekt;
                                 SVE=Generera &mindre projekt];
                      Image=Job;
                      OnAction=BEGIN
                                 IF "Small Project No." = '' THEN BEGIN
                                   TESTFIELD("No.");
                                   IF Status = Status::Finished THEN
                                     FIELDERROR(Status);
                                   CLEAR(GenerateDelObjectsSmallProj);
                                   GenerateDelObjectsSmallProj.RUN(Rec);
                                 END ELSE BEGIN
                                   MESSAGE(Text006);
                                 END;
                               END;
                                }
      { 1100485117;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Folgebeschwerde erstellen;
                                 ENU=Create &Follow-up Complaint;
                                 NLD=Vervolgklacht aanmaken;
                                 NOR=Opprette &oppfõlgingsklage;
                                 SVE=Skapa &uppfîljningsklagomÜl];
                      Image=Splitlines;
                      OnAction=BEGIN
                                 MakeFollowUpComplaint();
                               END;
                                }
      { 1100485122;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Aufs neue behandeln;
                                 ENU=Take in Process again;
                                 NLD=Opnieuw in behandeling nemen;
                                 NOR=Ta inn prosessen igjen;
                                 SVE=Ta in processen igen];
                      Image=ReOpen;
                      OnAction=BEGIN
                                 TESTFIELD("No.");
                                 TESTFIELD(Status, Status::Finished);

                                 IF CONFIRM(Text007, FALSE) THEN BEGIN
                                   Status := Status::"In Process";
                                   MODIFY;
                                 END;
                               END;
                                }
      { 1210190004;2 ;Action    ;
                      CaptionML=[DEU=Bearbeiten Word-Dokumente;
                                 ENU=Edit Word Documents;
                                 NLD=Bewerk worddocumenten;
                                 NOR=Rediger Word-dokument;
                                 SVE=Redigera Word-dokument];
                      Image=Word;
                      OnAction=VAR
                                 Contact@1100485000 : Record 5050;
                               BEGIN
                                 TESTFIELD("Contact No.");
                                 IF Contact.GET("Contact No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(Contact."Company No.", Contact."No.", FALSE, '')
                                   ELSE
                                     EditDocuments(Contact."No.", '', FALSE, '');
                                 END;
                               END;
                                }
      { 1100525030;1 ;ActionGroup;
                      CaptionML=[DEU=Belege e-mailen;
                                 ENU=Mail Documents;
                                 NLD=Documenten mailen;
                                 NOR=Send dokumenter;
                                 SVE=E-postdokument] }
      { 1100525026;2 ;Action    ;
                      CaptionML=[DEU=Auftraggeber;
                                 ENU=Principal;
                                 NLD=Opdrachtgever;
                                 NOR=Oppdragsgiver;
                                 SVE=Uppdragsgivare];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Contact@1100525000 : Record 5050;
                                 Customer@1100525001 : Record 18;
                               BEGIN
                                 IF ("Delivered Object" <> '') THEN BEGIN
                                   TESTFIELD("Delivered Object Principal");
                                   Contact.GET("Delivered Object Principal");
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail")
                                   ELSE
                                     EditDocuments(Contact."No.", '', TRUE, Contact."E-Mail");
                                 END ELSE BEGIN
                                   TESTFIELD("Project Principal");
                                   IF Contact.GetContactByCustomer("Project Principal", Contact, TRUE) THEN BEGIN
                                     Customer.GET(GetContactProjectPrincipal);
                                     EditDocuments(Contact."No.", '', TRUE, Customer."E-Mail");
                                   END;
                                 END;
                               END;
                                }
      { 1100525027;2 ;Action    ;
                      CaptionML=[DEU=KÑufer;
                                 ENU=Buyer;
                                 NLD=Koper;
                                 NOR=Kjõper;
                                 SVE=Kîpare];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Contact@1100525000 : Record 5050;
                               BEGIN
                                 TESTFIELD(Buyer);
                                 IF Contact.GET(Buyer) THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail")
                                   ELSE
                                     EditDocuments(Contact."No.", '', TRUE, Contact."E-Mail");
                                 END;
                               END;
                                }
      { 1100525025;2 ;Action    ;
                      CaptionML=[DEU=Kontakt;
                                 ENU=Contact;
                                 NLD=Relatie;
                                 NOR=Contact;
                                 SVE=Kontakt];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Contact@1100525000 : Record 5050;
                               BEGIN
                                 TESTFIELD("Contact No.");
                                 IF Contact.GET("Contact No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(Contact."Company No.", Contact."No.", TRUE, "Contact E-Mail")
                                   ELSE
                                     EditDocuments(Contact."No.", '', TRUE, "Contact E-Mail");
                                 END;
                               END;
                                }
      { 1100525031;2 ;Action    ;
                      CaptionML=[DEU=Rech. an Kontakt;
                                 ENU=Bill to Contact;
                                 NLD=Factureren aan;
                                 NOR=Faktureringskontaktperson;
                                 SVE=Faktureringskontaktperson];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Contact@1100525000 : Record 5050;
                               BEGIN
                                 TESTFIELD("Bill to Contact");
                                 IF Contact.GET("Bill to Contact") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail")
                                   ELSE
                                     EditDocuments(Contact."No.", '', TRUE, Contact."E-Mail");
                                 END;
                               END;
                                }
      { 1100485999;0 ;ActionContainer;
                      CaptionML=[DEU=D&rucken;
                                 ENU=&Print;
                                 NLD=&Afdrukken;
                                 NOR=Skriv &ut;
                                 SVE=Skriv &ut];
                      ActionContainerType=Reports }
      { 1100485908;1 ;Action    ;
                      CaptionML=[DEU=Berichte Beschwerden;
                                 ENU=Complaint Reports;
                                 NLD=Rapporten klachten;
                                 NOR=Klagerapporter;
                                 SVE=KlagomÜlsrapporter];
                      Image=Reminder;
                      OnAction=VAR
                                 ComplaintRec@1100485001 : Record 11012450;
                                 PrintDoc@1100485000 : Codeunit 229;
                               BEGIN
                                 ComplaintRec.COPY(Rec);
                                 ComplaintRec.SETRANGE("No.", "No.");
                                 PrintDoc.PrintComplaint(ComplaintRec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100485002;1;Group  ;
                CaptionML=[DEU=Allgemein;
                           ENU=General;
                           NLD=Algemeen;
                           NOR=Generell;
                           SVE=AllmÑnt] }

    { 6   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             NoOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1100485015;2;Field  ;
                SourceExpr="Call Date" }

    { 1100525021;2;Field  ;
                SourceExpr="Incident Date" }

    { 1100528400;2;Field  ;
                SourceExpr="Feedback Date" }

    { 1100485006;2;Field  ;
                SourceExpr="Requisition System" }

    { 1100485069;2;Field  ;
                SourceExpr="Entered By" }

    { 1100525008;2;Field  ;
                SourceExpr="Entered By Name";
                Importance=Additional }

    { 1100485020;2;Field  ;
                SourceExpr=Description;
                Importance=Promoted }

    { 1100525018;2;Field  ;
                SourceExpr=Reference;
                Importance=Additional }

    { 1100485021;2;Field  ;
                SourceExpr="Complaint Kind" }

    { 1100525005;2;Field  ;
                SourceExpr="Complaint Kind Description";
                Importance=Additional }

    { 1100485022;2;Field  ;
                SourceExpr="Complaint Type" }

    { 1100525007;2;Field  ;
                SourceExpr="Complaint Type Description";
                Importance=Additional }

    { 1100485025;2;Field  ;
                SourceExpr=Urgency }

    { 1100525001;2;Field  ;
                SourceExpr="Urgency Description";
                Importance=Additional }

    { 1100485033;2;Field  ;
                SourceExpr=Handling }

    { 1100485023;2;Field  ;
                SourceExpr="Caused by" }

    { 1100525003;2;Field  ;
                SourceExpr="Caused by Description";
                Importance=Additional }

    { 1100485109;2;Field  ;
                SourceExpr="Expected Solving Date" }

    { 1100485072;2;Field  ;
                SourceExpr="Solving Date" }

    { 1100485074;2;Field  ;
                SourceExpr="Lead Time in Days";
                Importance=Additional }

    { 1100485027;2;Field  ;
                SourceExpr=Status }

    { 1100485013;2;Field  ;
                SourceExpr="Project No.";
                Editable="Project No.Editable";
                OnValidate=BEGIN
                             ProjectNoOnAfterValidate;
                           END;
                            }

    { 1100525012;2;Field  ;
                CaptionML=[DEU=Projektbeschreibung;
                           ENU=Project Description;
                           NLD=Omschrijving project;
                           NOR=Prosjektbeskrivelse;
                           SVE=Projektbeskrivning];
                SourceExpr=GetProjectDescription();
                Importance=Additional }

    { 1100485011;2;Field  ;
                SourceExpr="Plot No.";
                Editable="Plot No.Editable";
                OnValidate=BEGIN
                             PlotNoOnAfterValidate;
                           END;
                            }

    { 1100485905;2;Field  ;
                SourceExpr="House Model";
                Visible=FALSE;
                Editable=FALSE }

    { 1100485007;2;Field  ;
                SourceExpr=Delivery;
                Importance=Additional;
                Editable=DeliveryEditable;
                OnValidate=BEGIN
                             DeliveryOnAfterValidate;
                           END;
                            }

    { 1100525011;2;Field  ;
                SourceExpr="Delivery Description";
                Importance=Additional }

    { 1100485000;2;Field  ;
                SourceExpr="Delivered Object";
                Editable="Delivered ObjectEditable";
                OnValidate=BEGIN
                             DeliveredObjectOnAfterValidate;
                           END;
                            }

    { 1100529000;2;Field  ;
                DrillDown=No;
                SourceExpr="Original Project (Del. Obj.)";
                Importance=Additional }

    { 1100485906;2;Field  ;
                SourceExpr="Delivery Date";
                Editable=FALSE }

    { 1100485005;2;Field  ;
                SourceExpr=Unit;
                Importance=Additional;
                Editable=UnitEditable }

    { 1100525010;2;Field  ;
                CaptionML=[DEU=Beschreibung Raum;
                           ENU=Unit Description;
                           NLD=Omschrijving ruimte;
                           NOR=Enhetsbeskrivelse;
                           SVE=Enhetsbeskrivning];
                SourceExpr=UnitDescriptionOnFormat;
                Importance=Additional }

    { 1100485902;2;Field  ;
                SourceExpr="External Contract No." }

    { 1100485009;2;Field  ;
                SourceExpr="Source Type";
                Importance=Additional;
                Editable="Source TypeEditable";
                OnValidate=BEGIN
                             SourceTypeOnAfterValidate;
                           END;
                            }

    { 1100485099;2;Field  ;
                SourceExpr="Source No.";
                Importance=Additional;
                Editable="Source No.Editable";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1100485101;2;Field  ;
                SourceExpr="Source No. 2";
                Importance=Additional;
                Editable="Source No. 2Editable";
                OnAssistEdit=BEGIN
                               ShowPlantInventory();
                             END;
                              }

    { 1100485102;2;Field  ;
                CaptionML=[DEU=Herkunftsbeschreibung;
                           ENU=Source Description;
                           NLD=Omschrijving (bron);
                           NOR=Kildebeskrivelse;
                           SVE=Ursprungsbeskrivning];
                SourceExpr=GetSourceDescription();
                Importance=Additional;
                Editable=FALSE }

    { 1100485115;2;Field  ;
                SourceExpr="Source Contact No.";
                OnLookup=BEGIN
                           LookupSourceContact(Status <> Status::Finished);
                         END;
                          }

    { 1100525009;2;Field  ;
                SourceExpr="Source Contact Name";
                Importance=Promoted }

    { 1100485110;2;Field  ;
                SourceExpr="Source Phone No." }

    { 3   ;1   ;Part      ;
                Name=ComplaintNoteSubform;
                SubPageLink=Complaint No.=FIELD(No.);
                PagePartID=Page11012453;
                Editable=ComplaintNoteSubformEditable }

    { 1100525014;1;Group  ;
                CaptionML=[DEU=Adresse;
                           ENU=Address;
                           NLD=NAW;
                           NOR=Adresse;
                           SVE=Adress] }

    { 1100525015;2;Field  ;
                SourceExpr="Complaint Address";
                Importance=Promoted }

    { 1100525016;2;Field  ;
                SourceExpr="Complaint Post Code";
                Importance=Promoted }

    { 1100525017;2;Field  ;
                SourceExpr="Complaint City";
                Importance=Promoted }

    { 1907563401;1;Group  ;
                CaptionML=[DEU=Kontakt;
                           ENU=Contact;
                           NLD=Relatie;
                           NOR=Kontakt;
                           SVE=Kontakt] }

    { 1100485051;2;Field  ;
                SourceExpr="Project Principal";
                Importance=Promoted }

    { 1100485097;2;Field  ;
                SourceExpr="Delivered Object Principal" }

    { 1100485048;2;Field  ;
                CaptionClass=Text19036891;
                Visible=FALSE }

    { 1100485900;2;Field  ;
                SourceExpr=Buyer;
                Importance=Promoted }

    { 1100485086;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact Name";
                Importance=Promoted }

    { 1100485083;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact Name 2";
                Importance=Additional }

    { 1100525000;2;Field  ;
                SourceExpr="Contact Address" }

    { 1100525002;2;Field  ;
                SourceExpr="Contact Address 2";
                Importance=Additional }

    { 1100525004;2;Field  ;
                SourceExpr="Contact Post Code" }

    { 1100525006;2;Field  ;
                SourceExpr="Contact City" }

    { 1100485080;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact Phone" }

    { 1100485081;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact Phone 2";
                Importance=Additional }

    { 1100485082;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact Mobile Phone" }

    { 1100485084;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact Mobile Phone 2";
                Importance=Additional }

    { 1100485078;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact Phone Work" }

    { 1100485076;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact Phone Work 2";
                Importance=Additional }

    { 1100485087;2;Field  ;
                DrillDown=No;
                SourceExpr="Contact E-Mail" }

    { 1905885101;1;Group  ;
                CaptionML=[DEU=Fakturierung;
                           ENU=Invoicing;
                           NLD=Facturering;
                           NOR=Fakturering;
                           SVE=Fakturering] }

    { 1100485037;2;Field  ;
                SourceExpr="Inquiry Costs" }

    { 1100485003;2;Field  ;
                SourceExpr="Bill to Contact";
                Importance=Promoted }

    { 1100485035;2;Field  ;
                SourceExpr="Bill to Contact Name";
                Importance=Promoted }

    { 1100485039;2;Field  ;
                DrillDown=Yes;
                SourceExpr="Sales Invoice";
                OnDrillDown=VAR
                              lSalesHeaderRec@1100485000 : Record 36;
                            BEGIN
                              lSalesHeaderRec.SETRANGE("Document Type",lSalesHeaderRec."Document Type"::Invoice);
                              lSalesHeaderRec.SETRANGE("No.","Sales Invoice");
                              IF NOT lSalesHeaderRec.FINDFIRST THEN
                                lSalesHeaderRec.SETFILTER("No.", '%1', '');

                              PAGE.RUNMODAL(PAGE::"Sales List",lSalesHeaderRec)
                            END;
                             }

    { 1100485043;2;Field  ;
                SourceExpr="Posted Sales Invoice" }

    { 1100485041;2;Field  ;
                SourceExpr="Credit Memo";
                OnDrillDown=VAR
                              lSalesHeaderRec@1100485000 : Record 36;
                            BEGIN
                              lSalesHeaderRec.SETRANGE("Document Type",lSalesHeaderRec."Document Type"::"Credit Memo");
                              lSalesHeaderRec.SETRANGE("No.","Credit Memo");
                              IF NOT lSalesHeaderRec.FINDFIRST THEN
                                lSalesHeaderRec.SETFILTER("No.", '%1', '');

                              PAGE.RUNMODAL(PAGE::"Sales List",lSalesHeaderRec)
                            END;
                             }

    { 1100485061;2;Field  ;
                SourceExpr="Posted Credit Memo";
                DrillDownPageID=Posted Sales Credit Memos }

    { 1906028501;1;Group  ;
                CaptionML=[DEU=Kleinprojekt;
                           ENU=Small Project;
                           NLD=Klusproject;
                           NOR=Lite prosjekt;
                           SVE=Mindre projekt] }

    { 1100485053;2;Field  ;
                SourceExpr="Preferred Start Date" }

    { 1100485055;2;Field  ;
                SourceExpr="Preferred End Date" }

    { 1100485059;2;Field  ;
                SourceExpr="Main Project No.";
                Importance=Promoted }

    { 1100525019;2;Field  ;
                SourceExpr="Small Project Company";
                LookupPageID=Small Project }

    { 1100485057;2;Field  ;
                SourceExpr="Small Project No.";
                Importance=Promoted;
                LookupPageID=Small Project }

    { 1100529900;0;Container;
                ContainerType=FactBoxArea }

    { 1100529901;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                Enabled=RegisterExternalDocumentFBEnabled;
                PartType=Page }

    { 1100528401;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130340;
                PartType=Page }

    { 1100525022;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PlotRec@1100485007 : Record 11012500;
      ProjectRec@1100485008 : Record 11072003;
      DelObjectRec@1100485009 : Record 11012101;
      DeliveryRec@1100485000 : Record 11012507;
      DeliveredObject@1100485018 : Record 11012101;
      CurrFinished@1100485004 : Boolean;
      gCalledFrom@1100485017 : ' ,Project,Plot,Delivery,DeliveredObject';
      gProjNo@1100485016 : Code[20];
      gPlotNo@1100485015 : Code[10];
      gDelivery@1100485014 : Code[20];
      gDeliveredObject@1100485013 : Code[20];
      GenerateDelObjectsInvoice@1100485002 : Codeunit 11012052;
      GenerateDelObjectsSmallProj@1100485001 : Codeunit 11012053;
      Text001@1100485006 : TextConst 'DEU=Die Untersuchungskosten sind bereits fakturiert.;ENU=Research is already invoiced;NLD=De onderzoekskosten zijn al gefactureerd.;NOR=Forskning er allerede fakturert;SVE=Forskning har redan fakturerats';
      Text002@1100485005 : TextConst 'DEU=Es ist kein Rechnungsbetrag vorhanden.;ENU=No invoice amount  present;NLD=Er is geen factuurbedrag.;NOR=Det finnes ikke noe fakturabelõp;SVE=Det finns inget fakturabelopp';
      Text004@1100485003 : TextConst 'DEU=Es wurden keine Untersuchungskosten eingegeben.;ENU=Research is not filled;NLD=Er zijn geen onderzoekskosten opgevoerd.;NOR=Forskning er ikke fylt ut;SVE=Forskning har inte fyllts i';
      Text005@1100485011 : TextConst 'DEU=Die Untersuchungskosten wurden bereits kreditiert.;ENU=Research is already credited;NLD=De onderzoekskosten zijn al gecrediteerd.;NOR=Forskning er allerede kreditert;SVE=Forskning har redan krediterats';
      Text006@1100485012 : TextConst 'DEU=Es wurde bereits ein Kleinprojekt erstellt.;ENU=A Small Project is already generated.;NLD=Er is al een klusproject aangemaakt.;NOR=Et lite prosjekt er allerede generert.;SVE=Ett mindre projekt har redan genererats.';
      Text007@1100485010 : TextConst 'DEU=Abgewickelte Beschwerde erneut îffnen. Sind Sie sich sicher?;ENU=Reopen finished Complaint, are you sure?;NLD=Afgehandelde klacht heropenen, weet u het zeker?;NOR=GjenÜpne ferdigbehandlet klage. Er du sikker?;SVE=ôppning av fÑrdigbehandlat klagomÜl igen. ér du sÑker?';
      DPA_IsHardFilter@1100000999 : Boolean;
      ShowPlantInventButtonVisible@19072277 : Boolean INDATASET;
      ComplaintNoteSubformEditable@19004042 : Boolean INDATASET;
      SFComplaintCommisionsEditable@19027898 : Boolean INDATASET;
      DocumentSubformEditable@19071872 : Boolean INDATASET;
      "Project No.Editable"@19028701 : Boolean INDATASET;
      "Plot No.Editable"@19050786 : Boolean INDATASET;
      DeliveryEditable@19049955 : Boolean INDATASET;
      "Delivered ObjectEditable"@19069576 : Boolean INDATASET;
      UnitEditable@19008302 : Boolean INDATASET;
      "Source TypeEditable"@19055870 : Boolean INDATASET;
      "Source No.Editable"@19065946 : Boolean INDATASET;
      "Source No. 2Editable"@19019850 : Boolean INDATASET;
      Text19036891@19020901 : TextConst 'DEU=Auftraggeber besteht aus 2 Åberlappenden Feldern;ENU=Principal consists of 2 overlaying fields.;NLD=Opdrachtgever bestaat uit 2 overlappende velden;NOR=Oppdragsgiver bestÜr av 2 overlappende felt.;SVE=Uppdragsgivare bestÜr av 2 îverliggande fÑlt.';
      RegisterExternalDocumentFBEnabled@1100525000 : Boolean INDATASET;

    PROCEDURE SetCalledFromProject@1100485001(IProjNo@1100485000 : Code[20]);
    BEGIN
      gCalledFrom := gCalledFrom::Project;
      gProjNo := IProjNo;
    END;

    PROCEDURE SetCalledFromPlot@1100485004(IProjNo@1100485000 : Code[20];IPlotNo@1100485001 : Code[10]);
    BEGIN
      gCalledFrom := gCalledFrom::Plot;
      gProjNo := IProjNo;
      gPlotNo := IPlotNo;
    END;

    PROCEDURE SetCalledFromDelivery@1100485006(IProjNo@1100485000 : Code[20];IPlotNo@1100485001 : Code[10];IDelivery@1100485002 : Code[20]);
    BEGIN
      gCalledFrom := gCalledFrom::Delivery;
      gProjNo := IProjNo;
      gPlotNo := IPlotNo;
      gDelivery := IDelivery;
    END;

    PROCEDURE SetCalledFromDeliveredObject@1100485007(IDeliveredObject@1100485000 : Code[20];IProjNo@1100485002 : Code[20];IPlotNo@1100485001 : Code[10]);
    BEGIN
      gCalledFrom := gCalledFrom::DeliveredObject;
      gDeliveredObject := IDeliveredObject;

      gProjNo := IProjNo;
      gPlotNo := IPlotNo;
    END;

    PROCEDURE GetContact_BilltoContact@1100485000();
    BEGIN
      IF "Delivered Object" <> ''  THEN BEGIN
        DelObjectRec.GET("Delivered Object");
        Buyer := DelObjectRec.Buyer;
        VALIDATE("Delivered Object Principal", DelObjectRec.Principal);
      END ELSE BEGIN
        IF "Plot No." <> '' THEN BEGIN
          PlotRec.GET("Project No.","Plot No.");
          Buyer := PlotRec.Buyer;
          VALIDATE("Project Principal", PlotRec.Principal);
        END ELSE BEGIN
          IF "Project No." <> '' THEN BEGIN
            ProjectRec.GET("Project No.");
            VALIDATE("Project Principal", ProjectRec."Bill-to Customer No.");
          END;
        END;
      END;

      "Bill to Contact" := "Contact No.";
    END;

    PROCEDURE WordDoc@1(DocType@11012000 : Option);
    BEGIN
    END;

    PROCEDURE SetEditableOnStatus@1100485011();
    BEGIN
      //* Als de status 'Afgehandeld' is dan is wijzigen niet meer toegestaan. Hier dan alle muteerbare velden uit kop op
      //* niet-editable zetten. NB: Currform.Editable(False) werkt/kan niet want dan werkt F3 (nieuw record) niet meer als
      //* je op een afgehandelde klacht staat, ook kan een afgehandelde klacht dan niet verwijderd worden.

      CurrFinished := (Status = Status::Finished);
      SetProjPlotDelivFieldsEditable();  //* "Project No."/"Plot No."/Delivery/"Delivered Object"/Unit
      SetSourceNoFieldsEditable();  //* "Source Type"/"Source No."/"Source No. 2"

      ComplaintNoteSubformEditable := (NOT CurrFinished);
      SFComplaintCommisionsEditable := (NOT CurrFinished);
      DocumentSubformEditable := (NOT CurrFinished);
    END;

    PROCEDURE SetProjPlotDelivFieldsEditable@1100485002();
    VAR
      lvComplaintCommRec@1100485000 : Record 11012456;
    BEGIN
      "Project No.Editable" := ("Delivered Object" = '') AND (NOT CurrFinished);
      "Plot No.Editable" := ("Delivered Object" = '') AND (NOT CurrFinished);
      DeliveryEditable := ("Delivered Object" = '') AND (NOT CurrFinished);
      "Delivered ObjectEditable" := (Delivery = '') AND (NOT CurrFinished);
      UnitEditable := (NOT CurrFinished);

      CASE gCalledFrom OF
        gCalledFrom::Project:
          IF (gProjNo <> '') THEN
            "Project No.Editable" := (FALSE);
        gCalledFrom::Plot:
          BEGIN
            IF (gProjNo <> '') THEN
              "Project No.Editable" := (FALSE);
            IF (gProjNo <> '') AND (gPlotNo <> '') THEN
              "Plot No.Editable" := (FALSE);
          END;
        gCalledFrom::Delivery:
          BEGIN
            IF (gProjNo <> '') THEN
              "Project No.Editable" := (FALSE);
            IF (gProjNo <> '') AND (gPlotNo <> '') THEN
              "Plot No.Editable" := (FALSE);
            IF (gProjNo <> '') AND (gDelivery <> '') THEN
              DeliveryEditable := (FALSE);
          END;
        gCalledFrom::DeliveredObject:
          IF (gDeliveredObject <> '') THEN
            "Delivered ObjectEditable" := (FALSE);
      END;

      IF "Project No.Editable" OR "Plot No.Editable" OR
         DeliveryEditable OR "Delivered ObjectEditable" THEN BEGIN
        lvComplaintCommRec.SETRANGE("Complaint No.", "No.");
        IF lvComplaintCommRec.FIND('-') THEN BEGIN
          "Project No.Editable" := (FALSE);
          "Plot No.Editable" := (FALSE);
          lvComplaintCommRec.SETFILTER("Commision Status", '<>%1', lvComplaintCommRec."Commision Status"::"To Provide");
          IF lvComplaintCommRec.FIND('-') THEN BEGIN
            DeliveryEditable := (FALSE);
            "Delivered ObjectEditable" := (FALSE);
          END;
        END;
      END;

      IF UnitEditable THEN BEGIN
        IF "Plot No." = '' THEN
          UnitEditable := FALSE
        ELSE BEGIN
          CALCFIELDS("House Model");
          IF "House Model" = '' THEN
            UnitEditable := FALSE;
        END;
      END;
    END;

    PROCEDURE SetSourceNoFieldsEditable@1100485003();
    BEGIN
      "Source TypeEditable" := (NOT CurrFinished);
      "Source No.Editable" := ("Source Type" <> "Source Type"::" ") AND (NOT CurrFinished);
      "Source No. 2Editable" := (NOT CurrFinished) AND (("Source Type" IN ["Source Type"::Plant,"Source Type"::RentalUnit]));
      ShowPlantInventButtonVisible := ("Source Type" = "Source Type"::Plant);
    END;

    PROCEDURE MakeFollowUpComplaint@1100485005();
    VAR
      lvComplaintRec@1100485000 : Record 11012450;
      lvPos@1100485003 : Integer;
      lvFollowUpNo@1100485001 : Code[20];
      lvFollowUpSign@1100485002 : Text[1];
      lvText000@1100485004 : TextConst 'DEU=Mîchten Sie eine Folgebeschwerde erstellen?;ENU=Do you want to create a follow-up complaint?;NLD=Wilt u een vervolgklacht aanmaken?;NOR=Vil du opprette en oppfõlgingsklage?;SVE=Vill du skapa ett uppfîljningsklagomÜl?';
      lvText001@1100485005 : TextConst 'DEU=Beschwerde ist nocht nicht abgewickelt.;ENU=Complaint is not yet finished.;NLD=Klacht is nog niet afgehandeld.;NOR=Klagen er ikke ferdig.;SVE=KlagomÜlet Ñr inte fÑrdigbehandlat.';
    BEGIN
      TESTFIELD("No.");

      IF Status = Status::Finished THEN BEGIN
        IF NOT CONFIRM(lvText000) THEN
          EXIT;
      END ELSE BEGIN
        IF NOT CONFIRM(lvText001 + ' ' + lvText000) THEN
          EXIT;
      END;

      lvFollowUpSign := '-';
      lvComplaintRec.RESET;
      lvPos := STRPOS("No.", lvFollowUpSign);
      IF lvPos = 0 THEN
        lvComplaintRec.SETFILTER("No.", '%1', ("No." + lvFollowUpSign + '*'))
      ELSE
        lvComplaintRec.SETFILTER("No.", '%1', (COPYSTR("No.", 1, lvPos) + '*'));
      IF lvComplaintRec.FINDLAST THEN
        lvFollowUpNo := INCSTR(lvComplaintRec."No.")
      ELSE
        lvFollowUpNo := "No." + lvFollowUpSign + '01';

      lvComplaintRec.INIT;
      lvComplaintRec."No." := lvFollowUpNo;
      lvComplaintRec."Project No." := "Project No.";
      lvComplaintRec."Plot No." := "Plot No.";
      lvComplaintRec.Unit := Unit;
      lvComplaintRec.Delivery := Delivery;
      lvComplaintRec."Delivered Object" := "Delivered Object";
      lvComplaintRec.Urgency := Urgency;
      lvComplaintRec.Status := lvComplaintRec.Status::Received;
      lvComplaintRec."Complaint Kind" := "Complaint Kind";
      lvComplaintRec."Complaint Type" := "Complaint Type";
      lvComplaintRec."Source Type" := "Source Type";
      lvComplaintRec."Source No." := "Source No.";
      lvComplaintRec."Source No. 2" := "Source No. 2";
      lvComplaintRec."Source Contact No." := "Source Contact No.";
      lvComplaintRec."Source Contact Name" := "Source Contact Name";
      lvComplaintRec."Source Phone No." := "Source Phone No.";
      lvComplaintRec.INSERT(TRUE);

      "No." :=lvComplaintRec."No.";
    END;

    LOCAL PROCEDURE DeliveryOnAfterValidate@19046841();
    BEGIN
      SetProjPlotDelivFieldsEditable();
    END;

    LOCAL PROCEDURE PlotNoOnAfterValidate@19015094();
    BEGIN
      SetProjPlotDelivFieldsEditable();
    END;

    LOCAL PROCEDURE ProjectNoOnAfterValidate@19041008();
    BEGIN
      SetProjPlotDelivFieldsEditable();
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      CurrPage.UPDATE;  //* Nodig tbv subforms bij wijzigen van klachtnummer (melding C-010100)
                        //* Vooral bij 'Opdrachten' nieuwe regels nog op oude klachtnummer (waarschijnlijk door vreemde index 1).
    END;

    LOCAL PROCEDURE DeliveredObjectOnAfterValidate@19077246();
    BEGIN
      SetProjPlotDelivFieldsEditable();
    END;

    LOCAL PROCEDURE SourceTypeOnAfterValidate@19035402();
    BEGIN
      SetSourceNoFieldsEditable();
    END;

    LOCAL PROCEDURE SourceNoOnBeforeInput@19040274();
    BEGIN
      //IF ("Source Type" = "Source Type"::RentalUnit) AND (NOT "Project No.EDITABLE") THEN
      //  CurrPage."Source No.".UPDATEEDITABLE := FALSE;
    END;

    LOCAL PROCEDURE UnitDescriptionOnFormat@19067197() : Text[50];
    VAR
      Text@1100409000 : Text[50];
    BEGIN
      Text := GetUnitDescription();
      EXIT(Text);
    END;

    LOCAL PROCEDURE CheckAlreadyInvoiced@1100525000(DocumentType@1100525000 : 'Invoice,CreditMemo') : Boolean;
    VAR
      SalesHeader@1100525001 : Record 36;
      SalesInvoiceHeader@1100525002 : Record 112;
      SalesCrMemoHeader@1100525003 : Record 114;
    BEGIN
      //C008960
      IF DocumentType = DocumentType::Invoice THEN BEGIN
        IF "Sales Invoice" = '' THEN
          EXIT(FALSE);
        IF SalesHeader.GET(SalesHeader."Document Type"::Invoice, "Sales Invoice") THEN
          EXIT(TRUE);
        CALCFIELDS("Posted Sales Invoice");
        IF "Posted Sales Invoice" = '' THEN
          EXIT(FALSE);
        IF SalesInvoiceHeader.GET("Posted Sales Invoice") THEN BEGIN
          SalesInvoiceHeader.CALCFIELDS(Amount);
          IF SalesInvoiceHeader.Amount <> 0 THEN
            EXIT(TRUE);
        END;
      END ELSE BEGIN
        IF "Credit Memo" = '' THEN
          EXIT(FALSE);
        IF SalesHeader.GET(SalesHeader."Document Type"::"Credit Memo", "Sales Invoice") THEN
          EXIT(TRUE);
        CALCFIELDS("Posted Credit Memo");
        IF "Posted Credit Memo" = '' THEN
          EXIT(FALSE);
        IF SalesCrMemoHeader.GET("Posted Credit Memo") THEN BEGIN
          SalesCrMemoHeader.CALCFIELDS(Amount);
          IF SalesCrMemoHeader.Amount <> 0 THEN
            EXIT(TRUE);
        END;
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE UpdateRegisterExternalDocumentFB@1100525001();
    VAR
      RecRef@1100525000 : RecordRef;
    BEGIN
      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode('');
      RegisterExternalDocumentFBEnabled := ("No." <> '');
    END;

    BEGIN
    {
      4PS - Field House Model must be present to create correct loopkup for field Unit
      //20060705-JE : Modified [Form-OnNewRecord], Modified function [SetCalledFromDeliveredObject]
      //20060705-JE : added Menu-Item[Tekstblok] on MenuButton [Complaints]
    }
    END.
  }
}

