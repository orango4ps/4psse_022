OBJECT Page 5094 Marketing Setup
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.01,4PS14.00,4PSSE;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Marketing Setup;
               NOR=Markedsf›ringsoppsett;
               SVE=Marknadsf”ringsinst„llningar];
    ApplicationArea=#Basic,#Suite,#RelationshipMgmt;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5079;
    PageType=Card;
    UsageCategory=Administration;
    OnInit=VAR
             PermissionManager@1000 : Codeunit 9002;
           BEGIN
             SoftwareAsAService := PermissionManager.SoftwareAsAService;

             //**4PS.sn
             VendorsEditable := TRUE;
             CustomersEditable := TRUE;
             PersonsEditable := TRUE;
             CompaniesEditable := TRUE;
             CBinitButtonVisible := TRUE;
             //**4PS.en
           END;

    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;

                 CheckCompanyRelationCentralMgt();  //**4PS.n

                 AttachmentStorageLocationEnabl := "Attachment Storage Type" = "Attachment Storage Type"::"Disk File";
                 ExchangeAccountPasswordTemp := '';
                 IF ("Exchange Account User Name" <> '') AND (NOT ISNULLGUID("Exchange Account Password Key")) THEN
                   ExchangeAccountPasswordTemp := '**********';
               END;

    OnAfterGetCurrRecord=BEGIN
                           //**4PS.sn
                           LeadingCompany := CompRelationRec.GetLeadingCompany(DATABASE::"Marketing Setup","Central Management");

                           AllowDecentralCompPersEDITABLE := ((LeadingCompany = COMPANYNAME) AND (Companies OR Persons) );
                           AllowDecentralCustomersEDITABL := ((LeadingCompany = COMPANYNAME) AND Customers);
                           AllowDecentralVendorsEDITABLE := ((LeadingCompany = COMPANYNAME) AND Vendors);

                           CBinitButtonVisible := "Central Management";
                           CompaniesEditable := (LeadingCompany = COMPANYNAME);
                           "Company FeaturesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND (Companies) );
                           "Company Alt. AddressesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND (Companies) );
                           "Industry GroupsEDITABLE" := ((LeadingCompany = COMPANYNAME) AND (Companies) );
                           TradenamesEDITABLE := ((LeadingCompany = COMPANYNAME) AND (Companies) );
                           PersonsEditable := (LeadingCompany = COMPANYNAME);
                           "Contactperson FeaturesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND (Persons));
                           "Person FeaturesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND (Persons));
                           "Person Alt. AddressesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND (Persons) );
                           "Function GroupsEDITABLE" := ((LeadingCompany = COMPANYNAME) AND (Persons) );
                           "Mailing GroupsEDITABLE" := ((LeadingCompany = COMPANYNAME) AND (Companies OR Persons) );
                           CustomersEditable :=  (LeadingCompany = COMPANYNAME);
                           "Customer AddressesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND Customers);
                           CreditLimitbyDateEDITABLE := ((LeadingCompany = COMPANYNAME) AND Customers);
                           CustomerDefaultDimensionsEDITABLE := ((LeadingCompany = COMPANYNAME) AND Customers);
                           VendorsEditable := (LeadingCompany = COMPANYNAME);
                           "Order AddressesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND Vendors);
                           "Payment AgreementsEDITABLE" := ((LeadingCompany = COMPANYNAME) AND Vendors);
                           "Vendor EmployeesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND Vendors);
                           "Vendor CategoriesEDITABLE" := ((LeadingCompany = COMPANYNAME) AND Vendors);  //DP00268
                           CommentsEDITABLE := ((LeadingCompany = COMPANYNAME) AND (Vendors OR Customers OR Persons));
                           SalespersonsEDITABLE := ((LeadingCompany = COMPANYNAME) AND (Vendors OR Customers));
                           VendorCategoriesContactEditabe := (LeadingCompany = COMPANYNAME) AND Companies;
                           //**4PS.en
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 100     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Setup;
                                 NOR=&Oppsett;
                                 SVE=&Inst„llning];
                      Image=Setup }
      { 10      ;2   ;Action    ;
                      CaptionML=[ENU=Social Engagement Setup;
                                 NOR=Konfigurer Social Engagement;
                                 SVE=Inst„llning f”r Social Engagement];
                      ToolTipML=[ENU=Set up the Microsoft Social Engagement server URL, agree to the license terms, and enable the Social Listening for Customers, Vendors, and/or Items.;
                                 NOR=Konfigurer URL-adressen for Microsoft Social Engagement-serveren, godta vilk†rene i lisensavtalen, og aktiver sosial lytting for kunder, leverand›rer og/eller varer.;
                                 SVE=Konfigurera URL:n till Microsoft Social Engagement-servern, acceptera licensvillkoren och aktivera Social Listening f”r kunder, leverant”rer och/eller artiklar.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 870;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SocialListening;
                      PromotedCategory=Process }
      { 101     ;2   ;Action    ;
                      CaptionML=[ENU=Duplicate Search String Setup;
                                 NOR=Oppsett for dupl. s›kestrenger;
                                 SVE=Dubbletts”kstr„nginst„llningar];
                      ToolTipML=[ENU=View or edit the list of search strings to use when searching for duplicates.;
                                 NOR=Vis eller rediger listen over s›kestrenger som skal brukes i s›k etter duplikater.;
                                 SVE=Visa eller redigera listan med s”kstr„ngar som ska anv„ndas vid s”kning efter kopior.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5138;
                      Image=CompareContacts }
      { 1100525000;2 ;Action    ;
                      CaptionML=[ENU=Central Management Field Setup;
                                 SVE=Central hantering, f„ltinst„llning];
                      RunObject=Page 11072437;
                      Image=Setup }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 50      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner;
                                 SVE=Fu&nktion];
                      Image=Action }
      { 7       ;2   ;Action    ;
                      Name=Validate EmailLogging Setup;
                      CaptionML=[ENU=Validate Email Logging Setup;
                                 NOR=Valider oppsett for loggf›ring av e-post;
                                 SVE=Validera konfiguration f”r e-postloggning];
                      ToolTipML=[ENU=Test that email logging is set up correctly.;
                                 NOR=Test at loggf›ring av e-post er riktig konfigurert.;
                                 SVE=Testa att e-postloggning har konfigurerats p† r„tt s„tt.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=ValidateEmailLoggingSetup;
                      OnAction=VAR
                                 ErrorMessage@1001 : Text;
                               BEGIN
                                 IF ValidateEmailLoggingSetup(Rec,ErrorMessage) THEN
                                   MESSAGE(Text012)
                                 ELSE
                                   ERROR(ErrorMessage);
                               END;
                                }
      { 51      ;2   ;Action    ;
                      Name=Clear EmailLogging Setup;
                      CaptionML=[ENU=Clear Email Logging Setup;
                                 NOR=Fjern oppsett for loggf›ring av e-post;
                                 SVE=Rensa konfiguration f”r e-postloggning];
                      ToolTipML=[ENU=Clear what is currently set up for email logging.;
                                 NOR=Fjern det som for ›yeblikket er konfigurert for loggf›ring av e-post.;
                                 SVE=Rensa det som f”r n„rvarande har konfigurerats f”r e-postloggning.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=ClearLog;
                      OnAction=BEGIN
                                 IF CONFIRM(Text009,TRUE) THEN
                                   ClearEmailLoggingSetup(Rec);
                               END;
                                }
      { 52      ;2   ;Action    ;
                      CaptionML=[ENU=Generate Integration IDs for Connector for Microsoft Dynamics;
                                 NOR=Generer integrerings-IDer for Connector for Microsoft Dynamics;
                                 SVE=Generera integrerings-ID:n f”r Connector for Microsoft Dynamics];
                      ToolTipML=[ENU=Generate identifiers (GUID) for records that can be used by Dynamics 365 for Sales and in Dynamics 365.;
                                 NOR=Generer identifikatorer (GUID) for poster som kan brukes av Dynamics 365 for Sales og i Dynamics 365.;
                                 SVE=Skapa identifierare (GUID) f”r poster som kan anv„ndas i Dynamics 365 for Sales och i Dynamics 365.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=CreateSerialNo;
                      OnAction=VAR
                                 IntegrationManagement@1000 : Codeunit 5150;
                               BEGIN
                                 IF CONFIRM(Text004,TRUE) THEN BEGIN
                                   IntegrationManagement.SetupIntegrationTables;
                                   MESSAGE(Text005);
                                 END;
                               END;
                                }
      { 1101200014;1 ;Action    ;
                      Name=CBinitButton;
                      CaptionML=[ENU=&Initialise Central Management;
                                 SVE=&Starta central hantering];
                      Visible=CBinitButtonVisible;
                      Image=Track;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CentralMgt@11012000 : Codeunit 11012010;
                               BEGIN
                                 //**4PS
                                 CentralMgt.InitContactManagement;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=Allm„nt];
                Visible=NOT SoftwareAsAService;
                GroupType=Group }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how you want to store attachments. The following options exist:;
                           NOR=Angir hvordan du vil lagre vedlegg. F›lgende alternativer finnes.;
                           SVE=Anger hur du vill att bilagor ska lagras. F”ljande alternativ finns:];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Attachment Storage Type";
                OnValidate=BEGIN
                             AttachmentStorageTypeOnAfterVa;
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the drive and path to the location where you want attachments stored if you selected Disk File in the Attachment Storage Type field.;
                           NOR=Angir stasjonen for og banen til de lagrede vedleggene hvis du valgte Diskfil i feltet Lagringstype for vedlegg.;
                           SVE=Anger enhet och s”kv„g till platsen d„r bilagor ska lagras om du v„ljer Fil i f„ltet Bilagt dok. lagringstyp.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Attachment Storage Location";
                Enabled=AttachmentStorageLocationEnabl;
                OnValidate=BEGIN
                             AttachmentStorageLocationOnAft;
                           END;
                            }

    { 11012000;2;Field    ;
                SourceExpr="Mailing Groups for Contact" }

    { 11012002;2;Field    ;
                SourceExpr="Sector for Relation" }

    { 1100485002;2;Field  ;
                SourceExpr="Required Features Alert" }

    { 1210190012;2;Field  ;
                SourceExpr="Generate Project allowed" }

    { 1100485000;2;Field  ;
                SourceExpr="Contact Feature Gr. Funnel" }

    { 1100528401;2;Field  ;
                SourceExpr="Only Create Obl. Features Aut." }

    { 1100525003;2;Field  ;
                SourceExpr="Relational Structure" }

    { 1210190016;2;Field  ;
                SourceExpr="Format Full Name Person" }

    { 1100525007;2;Field  ;
                SourceExpr="Tradenames in Name Validation" }

    { 1100528700;2;Field  ;
                SourceExpr="Phone Number Meta Data XML";
                OnAssistEdit=VAR
                               FileManagement@1100528704 : Codeunit 419;
                               FilterString@1100525000 : Text;
                             BEGIN
                               //**4PS
                               FilterString := FileManagement.GetToFilterText('', '.xml');
                               "Phone Number Meta Data XML" := FileManagement.OpenFileDialog('', "Phone Number Meta Data XML", FilterString);
                             END;
                              }

    { 1100409000;2;Field  ;
                SourceExpr="Document Type for Inv. Doc." }

    { 1904626001;1;Group  ;
                CaptionML=[ENU=Inheritance;
                           NOR=Arv;
                           SVE=Arv] }

    { 6   ;2   ;Group     ;
                CaptionML=[ENU=Inherit;
                           NOR=Arv;
                           SVE=Žrva] }

    { 13  ;3   ;Field     ;
                CaptionML=[ENU=Salesperson Code;
                           NOR=Selgerkode;
                           SVE=S„ljarkod];
                ToolTipML=[ENU=Specifies that you want to copy the salesperson code from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           NOR=Angir at du vil kopiere selgerkoden fra kontaktkortet for et selskap til kontaktkortet for den enkelte selgeren eller personene som jobber for det selskapet.;
                           SVE=Anger att du vill att s„ljarkoden kopieras fr†n ett f”retags kontaktkort till det kontaktkort som tillh”r den enskilde kontaktpersonen eller personen som arbetar f”r f”retaget.];
                ApplicationArea=#Suite,#RelationshipMgmt;
                SourceExpr="Inherit Salesperson Code" }

    { 1100528702;3;Field  ;
                CaptionML=[ENU=Sales Representative Code;
                           SVE=F”rs.representantkod];
                SourceExpr="Inherit Sales Rep. Code" }

    { 1100528704;3;Field  ;
                CaptionML=[ENU=Purchaser Code;
                           SVE=Ink”parkod];
                SourceExpr="Inherit Purchaser Code" }

    { 14  ;3   ;Field     ;
                CaptionML=[ENU=Territory Code;
                           NOR=Distriktskode;
                           SVE=Distriktskod];
                ToolTipML=[ENU=Specifies that you want to copy the territory code from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           NOR=Angir at du vil kopiere distriktskoden fra kontaktkortet for et selskap til kontaktkortet for den enkelte selgeren eller personene som jobber for det selskapet.;
                           SVE=Anger att du vill att distriktskoden kopieras fr†n ett f”retags kontaktkort till det kontaktkort som tillh”r den enskilde kontaktpersonen eller personen som arbetar f”r f”retaget.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Territory Code" }

    { 15  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           NOR=Lands-/omr†dekode;
                           SVE=Lands-/regionkod];
                ToolTipML=[ENU=Specifies that you want to copy the country/region code from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           NOR=Angir at du vil kopiere lands-/omr†dekoden fra kontaktkortet for et selskap til kontaktkortet for den enkelte selgeren eller personene som jobber for det selskapet.;
                           SVE=Anger att du vill att lands-/regionkoden kopieras fr†n ett f”retags kontaktkort till det kontaktkort som tillh”r den enskilde kontaktpersonen eller personen som arbetar f”r f”retaget.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Country/Region Code" }

    { 16  ;3   ;Field     ;
                CaptionML=[ENU=Language Code;
                           NOR=Spr†kkode;
                           SVE=Spr†kkod];
                ToolTipML=[ENU=Specifies that you want to copy the language code from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           NOR=Angir at du vil kopiere spr†kkoden fra kontaktkortet for et selskap til kontaktkortet for den enkelte selgeren eller personene som jobber for det selskapet.;
                           SVE=Anger att du vill att spr†kkoden kopieras fr†n ett f”retags kontaktkort till det kontaktkort som tillh”r den enskilde kontaktpersonen eller personen som arbetar f”r f”retaget.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Language Code" }

    { 17  ;3   ;Field     ;
                CaptionML=[ENU=Address Details;
                           NOR=Adresseopplysninger;
                           SVE=Adressdetaljer];
                ToolTipML=[ENU=Specifies that you want to copy the address details from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           NOR=Angir at du vil kopiere adresseopplysningene fra kontaktkortet for et selskap til kontaktkortet for den enkelte selgeren eller personene som jobber for det selskapet.;
                           SVE=Anger att du vill att adressinformationen kopieras fr†n ett f”retags kontaktkort till det kontaktkort som tillh”r den enskilde kontaktpersonen eller personen som arbetar f”r f”retaget.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Address Details" }

    { 79  ;3   ;Field     ;
                CaptionML=[ENU=Communication Details;
                           NOR=Kommunikasjonsopplysninger;
                           SVE=Kommunikationsdetaljer];
                ToolTipML=[ENU=Specifies that you want to copy the communication details, such as telex and fax numbers, from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           NOR=Angir at du vil kopiere kommunikasjonsopplysningene, for eksempel teleks- og faksnumre, fra kontaktkortet for et selskap til kontaktkortet for den enkelte selgeren eller personene som jobber for det selskapet.;
                           SVE=Anger att du vill att kommunikationsinformation, till exempel telex- och faxnummer, kopieras fr†n ett f”retags kontaktkort till det kontaktkort som tillh”r den enskilde kontaktpersonen eller personen som arbetar f”r f”retaget.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Communication Details" }

    { 1100525001;3;Field  ;
                CaptionML=[ENU=Visit Address Details;
                           SVE=Bes”ksadressdetaljer];
                SourceExpr="Inherit Visit Address Details" }

    { 1210190001;3;Field  ;
                SourceExpr="Inherit No. at Successor" }

    { 1902985101;1;Group  ;
                CaptionML=[ENU=Defaults;
                           NOR=Standardverdier;
                           SVE=Standard] }

    { 80  ;2   ;Group     ;
                CaptionML=[ENU=Default;
                           NOR=Standard;
                           SVE=Standard] }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=Salesperson Code;
                           NOR=Selgerkode;
                           SVE=S„ljarkod];
                ToolTipML=[ENU=Specifies the salesperson code to assign automatically to contacts when they are created.;
                           NOR=Angir selgerkoden som skal tilordnes kontakter automatisk n†r de opprettes.;
                           SVE=Inneh†ller s„ljarkoden som automatiskt tilldelas till kontakter, n„r de skapas.];
                ApplicationArea=#Suite,#RelationshipMgmt;
                SourceExpr="Default Salesperson Code" }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=Territory Code;
                           NOR=Distriktskode;
                           SVE=Distriktskod];
                ToolTipML=[ENU=Specifies the territory code to automatically assign to contacts when they are created.;
                           NOR=Angir distriktskoden som skal tilordnes kontakter automatisk n†r de opprettes.;
                           SVE=Inneh†ller distriktskoden som automatiskt tilldelas till kontakter, n„r de skapas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Territory Code" }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           NOR=Lands-/omr†dekode;
                           SVE=Lands-/regionkod];
                ToolTipML=[ENU=Specifies the country/region code to assign automatically to contacts when they are created.;
                           NOR=Angir lands-/omr†dekoden som skal tilordnes kontakter automatisk n†r de opprettes.;
                           SVE=Inneh†ller lands-/regionkoden som automatiskt tilldelas till kontakter, n„r de skapas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Country/Region Code" }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Language Code;
                           NOR=Spr†kkode;
                           SVE=Spr†kkod];
                ToolTipML=[ENU=Specifies the language code to assign automatically to contacts when they are created.;
                           NOR=Angir spr†kkoden som skal tilordnes kontakter automatisk n†r de opprettes.;
                           SVE=Inneh†ller spr†kkoden som automatiskt tilldelas till kontakter, n„r de skapas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Language Code" }

    { 102 ;3   ;Field     ;
                CaptionML=[ENU=Correspondence Type;
                           NOR=Korrespondansetype;
                           SVE=Korrespondenstyp];
                ToolTipML=[ENU=Specifies the preferred type of correspondence for the interaction. NOTE: If you use the Web client, you must not select the Hard Copy option because printing is not possible from the web client.;
                           NOR=Angir den foretrukkede typen korrespondanse for samhandlingen. MERK: Hvis du bruker webklienten, m† du ikke velge alternativet Brev, fordi utskrift ikke er mulig fra webklienten.;
                           SVE=Anger den f”rvalda korrespondenstypen f”r interaktionen. Obs! Om du anv„nder webbklienten ska du inte v„lja alternativet Utskrift eftersom det inte g†r att skriva ut fr†n webbklienten.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Correspondence Type" }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Company Salutation Code;
                           NOR=Hilsningskode for selskap;
                           SVE=F”retagsh„lsningskod];
                ToolTipML=[ENU=Specifies the salutation code to assign automatically to contact companies when they are created.;
                           NOR=Angir hilsningskoden som skal tilordnes automatisk for † kontakte firmaer n†r de opprettes.;
                           SVE=Inneh†ller h„lsningskoden som automatiskt tilldelas till kontaktf”retag, n„r de skapas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Def. Company Salutation Code" }

    { 86  ;3   ;Field     ;
                CaptionML=[ENU=Person Salutation Code;
                           NOR=Hilsningskode for person;
                           SVE=Personh„lsningskod];
                ToolTipML=[ENU=Specifies the salutation code to assign automatically to contact persons when they are created.;
                           NOR=Angir hilsningskoden som skal tilordnes automatisk for † kontakte personer n†r de opprettes.;
                           SVE=Inneh†ller h„lsningskoden som automatiskt tilldelas till kontaktpersoner, n„r de skapas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Person Salutation Code" }

    { 1210190000;3;Field  ;
                CaptionML=[ENU=Male Salutation Code;
                           SVE=H„lsningsfraskod f”r m„n];
                SourceExpr="Default Male Salutation Code" }

    { 1210190004;3;Field  ;
                CaptionML=[ENU=Female Salutation Code;
                           SVE=H„lsningsfraskod f”r kvinnor];
                SourceExpr="Default Female Salutation Code" }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Sales Cycle Code;
                           NOR=Salgssykluskode;
                           SVE=F”rs.cykelkod];
                ToolTipML=[ENU=Specifies the sales cycle code to automatically assign to opportunities when they are created.;
                           NOR=Angir salgssykluskoden som skal tilordnes salgsmuligheter automatisk n†r de opprettes.;
                           SVE=Inneh†ller f”rs„ljningscykelkoden som automatiskt tilldelas till aff„rsm”jligheter, n„r de skapas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Sales Cycle Code" }

    { 1210190003;3;Field  ;
                CaptionML=[ENU=Due Date Activities;
                           SVE=F”rfallodatum, aktiviteter];
                SourceExpr="Default Due Date Activities" }

    { 124 ;3   ;Field     ;
                CaptionML=[ENU=Task Date Calculation;
                           NOR=Beregning av oppgavedato;
                           SVE=Ber„kning av uppgiftsdatum];
                ToolTipML=[ENU=Specifies the task date calculation formula to use to calculate the ending date for tasks in Business Central if you haven't entered any due date in the Outlook task. If you leave the field blank, today's date is applied.;
                           NOR=Angir formelen for oppgavedatoberegning du vil skal brukes til † beregne sluttdatoen for oppgaver i Business Central hvis du ikke har oppgitt forfallsdato i Outlook-oppgaven. Hvis du lar feltet st† tomt, brukes dagens dato.;
                           SVE=Anger datumber„kningsformeln f”r uppgiften som anv„nds vid ber„kning slutdatum f”r uppgifter i Business Central om du inte har angett n†got f”rfallodatum i Outlook-uppgiften. Om du l„mnar f„ltet tomt anv„nds dagens datum.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default To-do Date Calculation" }

    { 1906323901;1;Group  ;
                CaptionML=[ENU=Interactions;
                           NOR=Samhandlinger;
                           SVE=Interaktioner] }

    { 55  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the language ID of the Windows language to use for naming the merge fields shown when editing an attachment in Microsoft Word.;
                           NOR=Angir spr†k-ID-en for Windows-spr†ket som skal brukes til † navngi flettefeltene som vises n†r du redigerer et vedlegg i Microsoft Word.;
                           SVE=Anger spr†k-ID f”r det Windows-spr†k som ska anv„ndas f”r att namnge de kopplingsf„lt som visas n„r du redigerar ett bifogat dokument i Microsoft Word.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Mergefield Language ID";
                OnLookup=VAR
                           LanguageManagement@1000 : Codeunit 43;
                         BEGIN
                           LanguageManagement.LookupApplicationLanguage("Mergefield Language ID");
                         END;
                          }

    { 1100525005;2;Field  ;
                SourceExpr="By-pass Phone Call Wizard" }

    { 83  ;2   ;Group     ;
                CaptionML=[ENU=Bus. Relation Code for;
                           NOR=Forr.forbindelseskode for;
                           SVE=Aff„rsrelationskod f”r];
                GroupType=Group }

    { 56  ;3   ;Field     ;
                CaptionML=[ENU=Customers;
                           NOR=Kunder;
                           SVE=Kunder];
                ToolTipML=[ENU=Specifies the business relation code that identifies that a contact is also a customer.;
                           NOR=Angir koden for forretningsforbindelsen som angir at en kontakt ogs† er kunde.;
                           SVE=Anger den aff„rsrelationskod som anger att en kontakt „ven „r en kund.];
                ApplicationArea=#Basic,#Suite,#RelationshipMgmt;
                SourceExpr="Bus. Rel. Code for Customers" }

    { 58  ;3   ;Field     ;
                CaptionML=[ENU=Vendors;
                           NOR=Leverand›rer;
                           SVE=Leverant”rer];
                ToolTipML=[ENU=Specifies the business relation code that identifies that a contact is also a vendor.;
                           NOR=Angir koden for forretningsforbindelsen som angir at en kontakt ogs† er leverand›r.;
                           SVE=Anger den aff„rsrelationskod som anger att en kontakt „ven „r en leverant”r.];
                ApplicationArea=#Basic,#Suite,#RelationshipMgmt;
                SourceExpr="Bus. Rel. Code for Vendors" }

    { 60  ;3   ;Field     ;
                CaptionML=[ENU=Bank Accounts;
                           NOR=Bankkonti;
                           SVE=Bankkonton];
                ToolTipML=[ENU=Specifies the business relation code that identifies that a contact is also a bank account.;
                           NOR=Angir koden for forretningsforbindelsen som angir at en kontakt ogs† er bankkonto.;
                           SVE=Anger den aff„rsrelationskod som anger att en kontakt „ven „r ett bankkonto.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Bus. Rel. Code for Bank Accs." }

    { 1100485046;3;Field  ;
                CaptionML=[ENU=Employers;
                           SVE=Arbetsgivare];
                SourceExpr="Bus. Rel. Code for Employers" }

    { 1210190059;3;Field  ;
                CaptionML=[ENU=Employees;
                           SVE=Personal];
                SourceExpr="Bus. Rel. Code for Employees" }

    { 1210190006;3;Field  ;
                CaptionML=[ENU=Shortcut Dimension Employees;
                           SVE=Genv„g till dimension f”r anst„llda];
                SourceExpr="Shortcut Dimension Employees" }

    { 1904569201;1;Group  ;
                CaptionML=[ENU=Numbering;
                           NOR=Nummerering;
                           SVE=Numrering] }

    { 1210190002;2;Field  ;
                SourceExpr="Company Nos." }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to contacts.;
                           NOR=Angir koden for nummerserien som skal brukes under tilordning av numre til kontakter.;
                           SVE=Anger koden f”r den nummerserie som ska anv„ndas f”r att tilldela nummer till kontakter.];
                ApplicationArea=#Basic,#Suite,#RelationshipMgmt;
                SourceExpr="Contact Nos." }

    { 1210190005;2;Field  ;
                SourceExpr="Person Nos." }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to campaigns.;
                           NOR=Angir koden for nummerserien som skal brukes under tilordning av numre til kampanjer.;
                           SVE=Anger koden f”r den nummerserie som ska anv„ndas f”r att tilldela nummer till kampanjer.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign Nos." }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to segments.;
                           NOR=Angir koden for nummerserien som skal brukes under tilordning av numre til segmenter.;
                           SVE=Anger koden f”r den nummerserie som ska anv„ndas f”r att tilldela nummer till segment.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Segment Nos." }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to tasks.;
                           NOR=Angir koden for nummerserien som skal brukes under tilordning av numre til oppgaver.;
                           SVE=Anger koden f”r nummerserien som anv„nds f”r att tilldela nummer till uppgifter.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="To-do Nos." }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to opportunities.;
                           NOR=Angir koden for nummerserien som skal brukes under tilordning av numre til salgsmuligheter.;
                           SVE=Anger koden f”r den nummerserie som ska anv„ndas f”r att tilldela nummer till aff„rsm”jligheter.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Opportunity Nos." }

    { 1210190044;2;Field  ;
                SourceExpr="Try-out Nos." }

    { 1210190043;2;Field  ;
                SourceExpr="Try-out Quote Nos." }

    { 1100529000;2;Field  ;
                SourceExpr="Build Pl.Loc.Code T-out Qt. fr" }

    { 1210190018;2;Field  ;
                SourceExpr="Reference Tool Nos." }

    { 1100485042;2;Field  ;
                SourceExpr="Contact Nos. Employers" }

    { 1100485044;2;Field  ;
                SourceExpr="Contact Nos. Employees" }

    { 1903832701;1;Group  ;
                CaptionML=[ENU=Duplicates;
                           NOR=Duplikater;
                           SVE=Dubbletter] }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the automatic update of search strings used to search for duplicates. You can set up search strings in the Duplicate Search String Setup table.;
                           NOR=Angir den automatiske oppdateringen av s›kestrenger som skal brukes til † s›ke etter duplikater. Du kan definere s›kestrenger i tabellen Oppsett for dupl. s›kestrenger.;
                           SVE=Anger den automatiska uppdateringen av s”kstr„ngar som anv„nds f”r att s”ka efter kopior. Du kan skapa s”kstr„ngar i tabellen Kopiera s”kstr„nginst„llning.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Maintain Dupl. Search Strings" }

    { 77  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you want to search automatically for duplicates each time a contact is created or modified.;
                           NOR=Angir at du vil s›ke automatisk etter duplikater hver gang en kontakt opprettes eller endres.;
                           SVE=Anger att du vill s”ka automatiskt efter dubbletter varje g†ng som en kontakt registreras eller „ndras.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Autosearch for Duplicates" }

    { 73  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the level of precision to apply when searching for duplicates.;
                           NOR=Angir hvilket presisjonsniv† du vil bruke n†r du s›ker etter duplikater.;
                           SVE=Anger den precisionsniv† f”r s”kning efter dubbletter.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Search Hit %" }

    { 1100528100;2;Field  ;
                SourceExpr="Check for Duplicate COC Nos." }

    { 1900887301;1;Group  ;
                CaptionML=[ENU=Email Logging;
                           NOR=Loggf›ring av e-post;
                           SVE=E-postloggning];
                GroupType=Group }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the email address that you want to use in discovery of an Exchange Server. You specify a valid email address, which enables the discovery of the associated Exchange Server. You can validate the email address after you enter an address.;
                           NOR=Angir e-postadressen du vil bruke i oppdagelsen av en Exchange Server. Du angir en gyldig e-postadresse, som aktiverer oppdagelse av en tilknyttet Exchange Serveren. Du kan validere e-postadressen n†r du har skrevet inn en adresse.;
                           SVE=Anger den e-postadress som du vill anv„nda om en Exchange Server uppt„cks. Du anger en giltig e-postadress som g”r det m”jligt att uppt„cka den associerade Exchange Server. Du kan kontrollera e-postadressen n„r du har angett en adress.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Autodiscovery E-Mail Address";
                OnValidate=BEGIN
                             IF "Autodiscovery E-Mail Address" <> xRec."Autodiscovery E-Mail Address" THEN BEGIN
                               OnAfterMarketingSetupEmailLoggingUsed;
                               ExchangeWebServicesClient.InvalidateService
                             END;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the address of your Exchange service. Setting this URL makes the email validation done by Validate Email Logging Setup faster.;
                           NOR=Angir adressen for Exchange-tjenesten. N†r du definerer denne URL-adressen, g†r valideringen av e-post med funksjonen Valider oppsett for loggf›ring av e-post raskere.;
                           SVE=Anger adressen till Exchange-tj„nsten. Om du anger den h„r URL:en g†r valideringen av e-post som utf”rs av Validera konfiguration f”r e-postloggning snabbare.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Exchange Service URL";
                OnValidate=BEGIN
                             IF "Exchange Service URL" <> xRec."Exchange Service URL" THEN BEGIN
                               OnAfterMarketingSetupEmailLoggingUsed;
                               ExchangeWebServicesClient.InvalidateService
                             END;
                           END;
                            }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the user account that has access to Exchange.;
                           NOR=Angir navnet p† brukerkontoen som har tilgang til Exchange.;
                           SVE=Anger namnet p† anv„ndarkontot som har tillg†ng till Exchange.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Exchange Account User Name";
                OnValidate=BEGIN
                             IF "Exchange Account User Name" <> xRec."Exchange Account User Name" THEN BEGIN
                               OnAfterMarketingSetupEmailLoggingUsed;
                               ExchangeWebServicesClient.InvalidateService;
                             END;
                           END;
                            }

    { 18  ;2   ;Field     ;
                ExtendedDatatype=Masked;
                CaptionML=[ENU=Exchange Account Password;
                           NOR=Passord for Exchange-konto;
                           SVE=L”senord f”r Exchange-konto];
                ToolTipML=[ENU=Specifies the password of the user account that has access to Exchange.;
                           NOR=Angir passordet for brukerkontoen som har tilgang til Exchange.;
                           SVE=Anger l”senordet f”r anv„ndarkontot som har tillg†ng till Exchange.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=ExchangeAccountPasswordTemp;
                OnValidate=BEGIN
                             OnAfterMarketingSetupEmailLoggingUsed;
                             SetExchangeAccountPassword(ExchangeAccountPasswordTemp);
                             COMMIT;
                             ExchangeWebServicesClient.InvalidateService;
                           END;
                            }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of email messages that you want to process in one run of a job queue that has been set up to handle email logging. By default, the number of messages to process is 0, which means that email messages are not batched together. You can modify this value when you are fine tuning your process so that the execution of a job queue does not take too long. Any email message that is not logged in any particular run will be handled in a subsequent run that has been scheduled.;
                           NOR=Angir antall e-postmeldinger som du vil behandle i ‚n kj›ring av en prosjektk› som er konfigurert til † behandle loggf›ring av e-post. Antall meldinger som skal behandles, er som standard 0, noe som betyr at e-postmeldinger ikke er sammen i bunker. Du kan endre denne verdien n†r du finjusterer prosessen, slik at kj›ringen av en prosjektk› ikke tar for lang tid. Enhver e-postmelding som ikke er loggf›rt i en bestemt kj›ring, blir behandlet i en etterf›lgende kj›ring som er planlagt.;
                           SVE=Anger antalet e-postmeddelanden som du vill bearbeta i en k”rning av en jobbk” som har st„llts in f”r att hantera e-postloggning. Som standard „r antalet meddelanden noll vilket inneb„r att meddelandena inte grupperas tillsammans. Du kan „ndra detta v„rde n„r du finjusterar s† att en jobbk” inte tar f”r l†ng tid. Ett e-postmeddelande, som inte har registrerats i n†gon viss k”rning, ska hanteras i en efterf”ljande k”rning som har planerats.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Email Batch Size";
                OnValidate=BEGIN
                             OnAfterMarketingSetupEmailLoggingUsed;
                           END;
                            }

    { 5   ;2   ;Group     ;
                GroupType=Group }

    { 104 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the queue folder in Microsoft Outlook.;
                           NOR=Angir navnet p† k›mappen i Microsoft Outlook.;
                           SVE=Anger namnet p† k”mappen i Microsoft Outlook.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Queue Folder Path";
                OnAssistEdit=VAR
                               ExchangeFolder@1002 : Record 5320;
                             BEGIN
                               IF GetExchangeFolder(ExchangeFolder,Text014) THEN
                                 SetQueueFolder(ExchangeFolder);
                             END;
                              }

    { 19  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the storage folder in Microsoft Outlook.;
                           NOR=Angir navnet p† lagringsmappen i Microsoft Outlook.;
                           SVE=Anger namnet p† lagringsmappen i Microsoft Outlook.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Storage Folder Path";
                OnAssistEdit=VAR
                               ExchangeFolder@1002 : Record 5320;
                             BEGIN
                               IF GetExchangeFolder(ExchangeFolder,Text015) THEN
                                 SetStorageFolder(ExchangeFolder);
                             END;
                              }

    { 1904248801;1;Group  ;
                CaptionML=[ENU=Central Management;
                           SVE=Central hantering] }

    { 1000000030;2;Field  ;
                SourceExpr="Central Management";
                OnValidate=BEGIN
                             CentralManagementOnAfterValida;
                           END;
                            }

    { 1000000028;2;Field  ;
                CaptionML=[ENU=Leading Company;
                           SVE=Ledande f”retag];
                SourceExpr=LeadingCompany;
                Editable=FALSE;
                OnValidate=BEGIN
                             LeadingCompanyOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               //**4PS
                               CurrPage.SAVERECORD;
                               COMMIT;
                               PAGE.RUNMODAL(0, CompRelationRec);
                               CurrPage.UPDATE;
                             END;
                              }

    { 1000000023;2;Field  ;
                SourceExpr=Companies;
                Editable=CompaniesEditable;
                OnValidate=BEGIN
                             CompaniesOnAfterValidate;
                           END;
                            }

    { 1100528400;2;Field  ;
                SourceExpr="Allow Decentral Comp./Pers.";
                Editable=AllowDecentralCompPersEDITABLE }

    { 1000000016;2;Field  ;
                SourceExpr="Company Features";
                Editable="Company FeaturesEDITABLE" }

    { 1100485010;2;Field  ;
                SourceExpr="Company Alt. Addresses";
                Editable="Company Alt. AddressesEDITABLE" }

    { 1100485014;2;Field  ;
                SourceExpr="Industry Groups";
                Editable="Industry GroupsEDITABLE" }

    { 1100525008;2;Field  ;
                SourceExpr=Tradenames;
                Editable=TradenamesEDITABLE }

    { 1000000022;2;Field  ;
                SourceExpr=Persons;
                Editable=PersonsEditable;
                OnValidate=BEGIN
                             PersonsOnAfterValidate;
                           END;
                            }

    { 1100528701;2;Field  ;
                SourceExpr="Contactperson Features";
                Editable="Contactperson FeaturesEDITABLE" }

    { 1000000018;2;Field  ;
                SourceExpr="Person Features";
                Editable="Person FeaturesEDITABLE" }

    { 1100485018;2;Field  ;
                SourceExpr="Person Alt. Addresses";
                Editable="Person Alt. AddressesEDITABLE" }

    { 1100485016;2;Field  ;
                SourceExpr="Function Groups";
                Editable="Function GroupsEDITABLE" }

    { 1100485012;2;Field  ;
                SourceExpr="Mailing Groups";
                Editable="Mailing GroupsEDITABLE" }

    { 1000000020;2;Field  ;
                SourceExpr=Customers;
                Editable=CustomersEditable;
                OnValidate=BEGIN
                             CustomersOnAfterValidate;
                           END;
                            }

    { 1100528402;2;Field  ;
                SourceExpr="Allow Decentral Customers";
                Editable=AllowDecentralCustomersEDITABL }

    { 1210190014;2;Field  ;
                SourceExpr="Customer Addresses";
                Editable="Customer AddressesEDITABLE" }

    { 1100528600;2;Field  ;
                SourceExpr="Customer Default Dimensions";
                Editable=CustomerDefaultDimensionsEDITABLE }

    { 1100528300;2;Field  ;
                SourceExpr="Credit Limit by Date";
                Editable=CreditLimitbyDateEDITABLE }

    { 1000000021;2;Field  ;
                SourceExpr=Vendors;
                Editable=VendorsEditable;
                OnValidate=BEGIN
                             VendorsOnAfterValidate;
                           END;
                            }

    { 1100528404;2;Field  ;
                SourceExpr="Allow Decentral Vendors";
                Editable=AllowDecentralVendorsEDITABLE }

    { 1100485024;2;Field  ;
                SourceExpr="Order Addresses";
                Editable="Order AddressesEDITABLE" }

    { 1100485050;2;Field  ;
                SourceExpr="Payment Agreements";
                Editable="Payment AgreementsEDITABLE" }

    { 1100528703;2;Field  ;
                SourceExpr="Vendor Employees";
                Editable="Vendor EmployeesEDITABLE" }

    { 1100528900;2;Field  ;
                SourceExpr="Vendor Categories";
                Editable="Vendor CategoriesEDITABLE" }

    { 1100485022;2;Field  ;
                SourceExpr=Comments;
                Editable=CommentsEDITABLE }

    { 1100485030;2;Field  ;
                SourceExpr=Salespersons;
                Editable=SalespersonsEDITABLE }

    { 1100529600;2;Field  ;
                SourceExpr="Vendor Categories (Contact)";
                Editable=VendorCategoriesContactEditabe }

    { 1101285001;2;Field  ;
                SourceExpr="Activate Bankgiro" }

    { 1101285000;2;Field  ;
                SourceExpr="Path to Bankgiro" }

    { 1100525006;1;Group  ;
                CaptionML=[ENU=DMS;
                           SVE=DMS] }

    { 1100525004;2;Field  ;
                SourceExpr="D3 Folder Code" }

    { 1100525002;2;Field  ;
                SourceExpr="D3 Field No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ExchangeWebServicesClient@1000 : Codeunit 5320;
      ExchangeAccountPasswordTemp@1018 : Text;
      AttachmentStorageLocationEnabl@19012985 : Boolean INDATASET;
      Text004@1003 : TextConst 'ENU=You are about to add integration data to tables. This process may take several minutes. Do you want to continue?;NOR=Du er i ferd med † legge til integreringsdata i tabellene. Denne prosessen kan ta flere minutter. Vil du fortsette?;SVE=Du „r p† v„g att l„gga till integreringsdata i tabellerna. Det kan ta flera minuter. Vill du forts„tta?';
      Text005@1004 : TextConst 'ENU=The integration data has been added to the tables.;NOR=Integreringsdataene er lagt til i tabellene.;SVE=Integreringsdata har lagts till i tabellerna.';
      Text006@1005 : TextConst 'ENU=A valid email address is needed to find an instance of Exchange Server.;NOR=Det er n›dvendig med en gyldig e-postadresse for † finne en forekomst av Exchange Server.;SVE=En giltig e-postadress beh”vs f”r att hitta en instans av Exchange Server.';
      Text007@1006 : TextConst 'ENU=Exchange Server cannot be found.;NOR=Finner ikke Exchange Server.;SVE=Det gick inte att hitta Exchange Server.';
      Text008@1002 : TextConst 'ENU=The specified Exchange folder does not exist.;NOR=Den angitte Exchange-mappen finnes ikke.;SVE=Den angivna Exchange-mappen finns inte.';
      Text009@1001 : TextConst 'ENU=This clears the fields in your email logging setup. Do you want to continue?;NOR=Feltene i oppsettet for loggf›ring av e-post vil bli nullstilt. Vil du fortsette?;SVE=Det h„r rensar f„lten i konfigurationen f”r e-postloggning. Vill du forts„tta?';
      Text010@1007 : TextConst 'ENU=The specified Queue folder does not exist or cannot be accessed.;NOR=Den angitte k›mappen finnes ikke eller er ikke tilgjengelig.;SVE=Den angivna k”mappen finns inte eller g†r inte att kontakta.';
      Text011@1008 : TextConst 'ENU=The specified Storage folder does not exist or cannot be accessed.;NOR=Den angitte lagringsmappen finnes ikke eller er ikke tilgjengelig.;SVE=Den angivna lagringsmappen finns inte eller g†r inte att kontakta.';
      Text012@1009 : TextConst 'ENU=Email logging setup was successfully validated and completed.;NOR=Oppsett for loggf›ring av e-post er validert og fullf›rt.;SVE=Konfigurationen f”r e-postloggning validerades och slutf”rdes.';
      Text013@1010 : TextConst 'ENU=Validating #1#;NOR=Validerer #1#;SVE=Validerar #1#';
      Text014@1011 : TextConst 'ENU=Select Queue folder;NOR=Velg k›mappe;SVE=V„lj k”mapp';
      Text015@1012 : TextConst 'ENU=Select Storage folder;NOR=Velg lagringsmappe;SVE=V„lj lagringsmapp';
      Text016@1015 : TextConst 'ENU=Interaction Template Setup;NOR=Oppsett av samhandlingsmal;SVE=Interaktionsmall inst„llningar';
      SoftwareAsAService@1013 : Boolean;
      CompRelationRec@1210190001 : Record 11012059;
      LeadingCompany@1210190002 : Text[50];
      CBinitButtonVisible@19068158 : Boolean INDATASET;
      CompaniesEditable@19063993 : Boolean INDATASET;
      PersonsEditable@19060297 : Boolean INDATASET;
      CustomersEditable@19000338 : Boolean INDATASET;
      VendorsEditable@19018639 : Boolean INDATASET;
      "Company FeaturesEDITABLE"@1210190101 : Boolean INDATASET;
      "Mailing GroupsEDITABLE"@1210190102 : Boolean INDATASET;
      "Industry GroupsEDITABLE"@1210190003 : Boolean INDATASET;
      TradenamesEDITABLE@1100525001 : Boolean;
      "Company Alt. AddressesEDITABLE"@1210190004 : Boolean INDATASET;
      "Contactperson FeaturesEDITABLE"@1100528700 : Boolean INDATASET;
      "Person FeaturesEDITABLE"@1210190005 : Boolean INDATASET;
      "Function GroupsEDITABLE"@1210190006 : Boolean INDATASET;
      "Person Alt. AddressesEDITABLE"@1210190007 : Boolean INDATASET;
      "Customer AddressesEDITABLE"@1210190008 : Boolean INDATASET;
      "Order AddressesEDITABLE"@1210190009 : Boolean INDATASET;
      CommentsEDITABLE@1210190010 : Boolean INDATASET;
      "Payment AgreementsEDITABLE"@1210190011 : Boolean INDATASET;
      "Vendor EmployeesEDITABLE"@1100528701 : Boolean INDATASET;
      "Vendor CategoriesEDITABLE"@1100528900 : Boolean INDATASET;
      SalespersonsEDITABLE@1210190012 : Boolean INDATASET;
      AllowDecentralCompPersEDITABLE@1210190013 : Boolean INDATASET;
      AllowDecentralCustomersEDITABL@1210190014 : Boolean INDATASET;
      AllowDecentralVendorsEDITABLE@1210190015 : Boolean INDATASET;
      CustomerDefaultDimensionsEDITABLE@1100528600 : Boolean;
      CreditLimitbyDateEDITABLE@1100528601 : Boolean;
      VendorCategoriesContactEditabe@1100529600 : Boolean INDATASET;

    [External]
    PROCEDURE SetAttachmentStorageType@1();
    BEGIN
      IF ("Attachment Storage Type" = "Attachment Storage Type"::Embedded) OR
         ("Attachment Storage Location" <> '')
      THEN BEGIN
        MODIFY;
        COMMIT;
        REPORT.RUN(REPORT::"Relocate Attachments");
      END;
    END;

    [External]
    PROCEDURE SetAttachmentStorageLocation@3();
    BEGIN
      IF "Attachment Storage Location" <> '' THEN BEGIN
        MODIFY;
        COMMIT;
        REPORT.RUN(REPORT::"Relocate Attachments");
      END;
    END;

    LOCAL PROCEDURE AttachmentStorageTypeOnAfterVa@19041025();
    BEGIN
      AttachmentStorageLocationEnabl := "Attachment Storage Type" = "Attachment Storage Type"::"Disk File";
      SetAttachmentStorageType;
    END;

    LOCAL PROCEDURE AttachmentStorageLocationOnAft@19001696();
    BEGIN
      SetAttachmentStorageLocation;
    END;

    [Internal]
    PROCEDURE InitExchangeService@2();
    VAR
      Credentials@1001 : DotNet "'Microsoft.Exchange.WebServices, Version=15.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Exchange.WebServices.Data.WebCredentials";
      Result@1000 : Boolean;
    BEGIN
      IF "Autodiscovery E-Mail Address" = '' THEN
        ERROR(Text006);

      IF "Exchange Account User Name" <> '' THEN BEGIN
        CreateExchangeAccountCredentials(Credentials);
        Result :=
          ExchangeWebServicesClient.InitializeOnServer("Autodiscovery E-Mail Address",
            "Exchange Service URL",Credentials.Credentials());
      END ELSE
        Result := ExchangeWebServicesClient.InitializeOnClient("Autodiscovery E-Mail Address","Exchange Service URL");

      IF NOT Result THEN
        ERROR(Text007);
    END;

    LOCAL PROCEDURE GetExchangeFolder@4(VAR ExchangeFolder@1000 : Record 5320;FoldersCaption@1002 : Text) : Boolean;
    VAR
      ExchangeFoldersPage@1001 : Page 5320;
    BEGIN
      InitExchangeService;
      ExchangeFoldersPage.Initialize(ExchangeWebServicesClient,FoldersCaption);
      ExchangeFoldersPage.LOOKUPMODE(TRUE);
      IF ACTION::LookupOK = ExchangeFoldersPage.RUNMODAL THEN BEGIN
        ExchangeFoldersPage.GETRECORD(ExchangeFolder);
        IF NOT ExchangeWebServicesClient.FolderExists(ExchangeFolder.ReadUniqueID) THEN
          ERROR(Text008);
        EXIT(TRUE);
      END;
      EXIT(FALSE);
    END;

    [Internal]
    PROCEDURE ClearEmailLoggingSetup@5(VAR MarketingSetup@1000 : Record 5079);
    VAR
      ServicePassword@1001 : Record 1261;
    BEGIN
      ExchangeWebServicesClient.InvalidateService;

      CLEAR(MarketingSetup."Autodiscovery E-Mail Address");
      CLEAR(MarketingSetup."Email Batch Size");

      CLEAR(MarketingSetup."Queue Folder Path");
      IF MarketingSetup."Queue Folder UID".HASVALUE THEN
        CLEAR(MarketingSetup."Queue Folder UID");

      CLEAR(MarketingSetup."Storage Folder Path");
      IF MarketingSetup."Storage Folder UID".HASVALUE THEN
        CLEAR(MarketingSetup."Storage Folder UID");

      CLEAR(MarketingSetup."Exchange Account User Name");
      CLEAR(MarketingSetup."Exchange Service URL");
      IF NOT ISNULLGUID(MarketingSetup."Exchange Account Password Key") THEN
        IF ServicePassword.GET(MarketingSetup."Exchange Account Password Key") THEN
          ServicePassword.DELETE(TRUE);
      CLEAR(MarketingSetup."Exchange Account Password Key");

      MarketingSetup.MODIFY;
    END;

    LOCAL PROCEDURE ValidateEmailLoggingSetup@6(VAR MarketingSetup@1004 : Record 5079;VAR ErrorMsg@1001 : Text) : Boolean;
    VAR
      EmailLoggingDispatcher@1005 : Codeunit 11072027;
      ProgressWindow@1000 : Dialog;
      Credentials@1006 : DotNet "'Microsoft.Exchange.WebServices, Version=15.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Exchange.WebServices.Data.WebCredentials";
      ValidationCaption@1002 : Text;
      CanInitialize@1003 : Boolean;
    BEGIN
      ExchangeWebServicesClient.InvalidateService;

      ValidationCaption := FIELDCAPTION("Autodiscovery E-Mail Address");
      ProgressWindow.OPEN(Text013,ValidationCaption);

      IF "Exchange Account User Name" <> '' THEN BEGIN
        CreateExchangeAccountCredentials(Credentials);
        CanInitialize := ExchangeWebServicesClient.InitializeOnServer("Autodiscovery E-Mail Address",
            "Exchange Service URL",Credentials.Credentials());
      END ELSE
        CanInitialize := ExchangeWebServicesClient.InitializeOnClient("Autodiscovery E-Mail Address","Exchange Service URL");

      IF NOT CanInitialize THEN BEGIN
        ErrorMsg := Text006;
        EXIT(FALSE);
      END;

      ValidationCaption := FIELDCAPTION("Queue Folder Path");
      ProgressWindow.UPDATE;
      IF NOT ExchangeWebServicesClient.FolderExists(MarketingSetup.GetQueueFolderUID) THEN BEGIN
        ErrorMsg := Text010;
        EXIT(FALSE);
      END;

      ValidationCaption := FIELDCAPTION("Storage Folder Path");
      ProgressWindow.UPDATE;
      IF NOT ExchangeWebServicesClient.FolderExists(MarketingSetup.GetStorageFolderUID) THEN BEGIN
        ErrorMsg := Text011;
        EXIT(FALSE);
      END;

      // Emails cannot be automatically logged unless Interaction Template Setup configured correctly.
      ValidationCaption := Text016;
      ProgressWindow.UPDATE;
      IF NOT EmailLoggingDispatcher.CheckInteractionTemplateSetup(ErrorMsg) THEN
        EXIT(FALSE);

      ProgressWindow.CLOSE;
      CLEAR(ErrorMsg);
      MarketingSetup.MODIFY;

      OnAfterMarketingSetupEmailLoggingCompleted;
      EXIT(TRUE);
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterMarketingSetupEmailLoggingUsed@7();
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterMarketingSetupEmailLoggingCompleted@9();
    BEGIN
    END;

    PROCEDURE CheckCompanyRelationCentralMgt@1210190000();
    VAR
      lvCompRelRec@1210190000 : Record 11012059;
    BEGIN
      //**4PS
      IF (NOT "Central Management") THEN
        EXIT;

      IF NOT lvCompRelRec.GET(COMPANYNAME) THEN BEGIN
        VALIDATE("Central Management", FALSE);
        MODIFY;
      END;
    END;

    LOCAL PROCEDURE CustomersOnAfterValidate@19063669();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE VendorsOnAfterValidate@19062552();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE PersonsOnAfterValidate@19056432();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE CompaniesOnAfterValidate@19018983();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE LeadingCompanyOnAfterValidate@19048552();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE CentralManagementOnAfterValida@19078251();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    BEGIN
    {
      X016: Multiple central management companies for 1 operating company (db, 22-08-11)

      *** I0024 ***
      130828 Added field "Path to Bankgiro" General
      151118 Added field "Activate Bankgiro"
    }
    END.
  }
}

