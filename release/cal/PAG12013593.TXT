OBJECT Page 12013593 ExFlow Purch. Doc. Worksheet
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF512000,EXFFI1.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Document Worksheet;
               SVE=Dokument import journal];
    SaveValues=Yes;
    SourceTable=Table12013587;
    DataCaptionExpr=GetCaption;
    SourceTableView=SORTING(Journal Batch Name,Inbound Document No.);
    PageType=Worksheet;
    CardPageID=ExFlow Purchase Doc.;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=Manage,Process,Page,Create;
                                SVE=Hantera,Process,Sida,Skapa];
    OnOpenPage=VAR
                 JnlSelected@1100285000 : Boolean;
               BEGIN
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   ExfJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 ExfJnlManagement.TemplateSelection(PAGE::"ExFlow Purch. Doc. Worksheet",Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR(txt002);

                 IF ForceOpenJnlBatchName <> '' THEN
                   CurrentJnlBatchName := ForceOpenJnlBatchName;

                 ExfJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);

                       SETRANGE("Document Type");
                     END;

    OnNewRecord=VAR
                  lrecExfJnlBatch@1100285000 : Record 12013590;
                BEGIN
                  CLEAR(ShortcutDimCode);
                  FILTERGROUP := 2;
                  lrecExfJnlBatch.GET(GETFILTER("Journal Template Name"), CurrentJnlBatchName);
                  FILTERGROUP := 0;
                  "Journal Template Name" := lrecExfJnlBatch."Journal Template Name";
                  "Journal Batch Name" := CurrentJnlBatchName;
                  IF lrecExfJnlBatch."Import Type" <> lrecExfJnlBatch."Import Type"::"XML File" THEN
                    SetupNewLine(xRec);
                END;

    OnAfterGetCurrRecord=BEGIN
                           PreviewPDF;
                         END;

    ActionList=ACTIONS
    {
      { 1100285049;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100285116;1 ;ActionGroup;
                      Name=Import;
                      CaptionML=[ENU=Import;
                                 SVE=Import] }
      { 1100285121;2 ;Action    ;
                      Name=Import Documents;
                      ShortCutKey=Ctrl+D;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import &Documents;
                                 SVE=Importera &dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 FILTERGROUP := 2;
                                 ExFImportMgt.ImportDocuments(GETFILTER("Journal Template Name"), CurrentJnlBatchName, FALSE);
                                 FILTERGROUP := 0;

                                 IF "Inbound Document No." = 0 THEN
                                   IF FINDFIRST THEN;

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100285108;2 ;Action    ;
                      Name=Copy Document;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 SVE=Kopiera dokument];
                      Image=CopyDocument;
                      OnAction=VAR
                                 CopyPurchDoc@1100285000 : Report 12013652;
                               BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                               END;
                                }
      { 1100285062;2 ;Action    ;
                      Name=Import Lines from Excel;
                      CaptionML=[ENU=Import Lines from Excel;
                                 SVE=Importera rader fr†n Excel];
                      Image=Import;
                      OnAction=VAR
                                 ImportDataRowNo@1100285001 : Codeunit 12013622;
                                 ExFlowDataMgt@1100285000 : Codeunit 12013621;
                               BEGIN
                                 ImportDataRowNo.SetImportWorkHeader("Inbound Document No.");
                                 ExFlowDataMgt.StartImport(1);
                               END;
                                }
      { 1100285092;2 ;Action    ;
                      Name=Get latest coding from vendor;
                      CaptionML=[ENU=Get latest coding from vendor;
                                 SVE=H„mta senaste konteringen f”r leverant”r];
                      Image=CopyWorksheet;
                      OnAction=VAR
                                 ExFlow@1100285000 : Codeunit 12013601;
                               BEGIN
                                 ExFlow.GetLatestCodingFromVendor(Rec);
                               END;
                                }
      { 1100285085;2 ;Action    ;
                      Name=Return to Readsoft Online;
                      CaptionML=[ENU=Return to Readsoft Online;
                                 SVE=Skicka tillbaka till Readsoft Online];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Return;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lExflowPurchDocumentHeader@1100285000 : Record 12013587;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(lExflowPurchDocumentHeader);
                                 ExFImportMgt.ReturnToROFromExfPurchDocHeader(lExflowPurchDocumentHeader,FALSE);
                               END;
                                }
      { 1100285063;1 ;ActionGroup;
                      Name=Functions;
                      CaptionML=[ENU=F&unctions;
                                 SVE=Fu&nktion];
                      ActionContainerType=NewDocumentItems }
      { 1100285081;2 ;Action    ;
                      Name=Move Documents;
                      CaptionML=[ENU=Move Document to other Company;
                                 SVE=Flytta dokument till annat bolag];
                      Image=Export;
                      OnAction=VAR
                                 lrecExfPurchDocHead@1100285002 : Record 12013587;
                                 ExFlowImportManager@1100285001 : Codeunit 12013604;
                               BEGIN
                                 lrecExfPurchDocHead.RESET;
                                 CurrPage.SETSELECTIONFILTER(lrecExfPurchDocHead);
                                 IF lrecExfPurchDocHead.FIND('-') THEN
                                   ExFlowImportManager.TransferInvoice(lrecExfPurchDocHead);
                               END;
                                }
      { 1100285096;2 ;Action    ;
                      Name=Move selected documents to other;
                      CaptionML=[ENU=Move selected documents to other batch;
                                 SVE=Flytta valda dokument till annan journal];
                      Image=Export;
                      OnAction=VAR
                                 lrecExfPurchDocHead@1100285000 : Record 12013587;
                                 ExFlowImportManager@1100285002 : Codeunit 12013604;
                               BEGIN
                                 lrecExfPurchDocHead.RESET;
                                 CurrPage.SETSELECTIONFILTER(lrecExfPurchDocHead);
                                 IF lrecExfPurchDocHead.FIND('-') THEN
                                   ExFlowImportManager.TransferToOtherJnl(lrecExfPurchDocHead);
                               END;
                                }
      { 1100285125;2 ;Action    ;
                      Name=Veryfy Documents;
                      ShortCutKey=Ctrl+R;
                      CaptionML=[ENU=Ve&rify Document;
                                 SVE=Ve&rifiera dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CheckRulesSyntax;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lrecExfPurchDocHead@1100285002 : Record 12013587;
                                 VerifyImportJournal@1100285001 : Report 12013589;
                               BEGIN
                                 CurrPage.SAVERECORD;

                                 lrecExfPurchDocHead.RESET;
                                 lrecExfPurchDocHead.SETRANGE("Inbound Document No.", "Inbound Document No.");
                                 VerifyImportJournal.SETTABLEVIEW(lrecExfPurchDocHead);
                                 VerifyImportJournal.RUNMODAL;

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100285059;2 ;Action    ;
                      Name=Batch Verify Documents;
                      ShortCutKey=Ctrl+Alt+R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Batch Ve&rify Documents;
                                 SVE=Batch Ve&rifiera dokument];
                      Promoted=Yes;
                      Image=CheckRulesSyntax;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lrecExfPurchDocHead@1100285002 : Record 12013587;
                                 VerifyImportJournal@1100285001 : Report 12013589;
                               BEGIN
                                 CurrPage.SAVERECORD;

                                 lrecExfPurchDocHead.RESET;
                                 lrecExfPurchDocHead.COPYFILTERS(Rec);
                                 lrecExfPurchDocHead.SETRANGE("Journal Template Name", "Journal Template Name");
                                 lrecExfPurchDocHead.SETRANGE("Journal Batch Name", "Journal Batch Name");
                                 VerifyImportJournal.SETTABLEVIEW(lrecExfPurchDocHead);
                                 VerifyImportJournal.RUNMODAL;

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100285060;2 ;Action    ;
                      Name=Edit OCR Import Queue;
                      CaptionML=[ENU=Edit/View OCR Import Queue;
                                 SVE=Redigera/Visa importk”];
                      RunObject=Page 12013667;
                      Image=Edit }
      { 1100285123;1 ;ActionGroup;
                      Name=Order;
                      CaptionML=[ENU=Order;
                                 SVE=Order] }
      { 1100285050;2 ;Action    ;
                      Name=Match OCR Lines;
                      ShortCutKey=Ctrl+M;
                      CaptionML=[ENU=Match OCR Lines;
                                 SVE=Matcha tolkade rader];
                      Image=MapAccounts;
                      OnAction=VAR
                                 ExFlowSetup@1100285000 : Record 12013601;
                                 MatchDocWorkSheet@1100285001 : Page 12057125;
                               BEGIN
                                 TESTFIELD("Document Type","Document Type"::Invoice);
                                 ExFlowSetup.GET;
                                 ExFlowSetup.TESTFIELD("Order Applies-to",ExFlowSetup."Order Applies-to"::"Receipts Lines");
                                 MatchDocWorkSheet.SetExfPurchHead(Rec);
                                 MatchDocWorkSheet.RUNMODAL;
                               END;
                                }
      { 1100285119;2 ;Action    ;
                      Name=&Get Receipt/Return Shpmt./Order;
                      CaptionML=[ENU=&Get Receipt/Return Shpmt./Order Lines;
                                 SVE=H„mta inl&everans/returutleverans/orderrader];
                      Image=Receipt;
                      OnAction=BEGIN
                                 CurrPage.SAVERECORD;
                                 SELECTLATESTVERSION;

                                 CASE "Document Type" OF
                                   "Document Type"::Invoice:
                                     CurrPage."Inbnd Exflow Doc. Line Subform".PAGE.GetReceipt;
                                   "Document Type"::"Credit Memo":
                                     CurrPage."Inbnd Exflow Doc. Line Subform".PAGE.GetReturnShipment;
                                 END;
                                 GET("Inbound Document No.");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100285084;1 ;ActionGroup;
                      Name=Email;
                      CaptionML=[ENU=Email;
                                 SVE=Epost] }
      { 1100285095;2 ;Action    ;
                      Name=Email PDF Document;
                      CaptionML=[ENU=Email PDF Document;
                                 SVE=Eposta PDF dokument];
                      Image=MailAttachment;
                      OnAction=VAR
                                 ExfPurchDocHead@1100285000 : Record 12013587;
                                 ExFlowMailMgt@1100285001 : Codeunit 12013627;
                               BEGIN
                                 ExfPurchDocHead.COPY(Rec);
                                 ExfPurchDocHead.SETRECFILTER;
                                 ExFlowMailMgt.MailImportWkshHeader(ExfPurchDocHead);
                               END;
                                }
      { 1100285124;2 ;Action    ;
                      Name=Batch Send Receipt Reminders;
                      CaptionML=[ENU=Batch Send Receipt Reminders;
                                 SVE=Batch skicka inleveransp†minnelser];
                      Image=OverdueMail;
                      OnAction=VAR
                                 ExFlowEmailMgt@1100285001 : Codeunit 12013627;
                               BEGIN
                                 ExFlowEmailMgt.EmailUnreceiptedOrders("Journal Batch Name", 0);
                               END;
                                }
      { 1100285109;2 ;Action    ;
                      Name=See email log;
                      CaptionML=[ENU=See email log;
                                 SVE=Visa epost logg];
                      Image=EntriesList;
                      OnAction=VAR
                                 ExFlowMailMgt@1100285000 : Codeunit 12013627;
                               BEGIN
                                 ExFlowMailMgt.OpenEmailLog(Rec);
                               END;
                                }
      { 1100285058;1 ;ActionGroup;
                      Name=Create;
                      CaptionML=[ENU=C&reate;
                                 SVE=S&kapa];
                      ActionContainerType=NewDocumentItems }
      { 1100285126;2 ;Action    ;
                      Name=Create Invoice/Cr.Memo;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=C&reate Invoice/Cr.Memo;
                                 SVE=S&kapa faktura/kreditnota];
                      Promoted=Yes;
                      Image=Post;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ExFlowToInvYesNo@1100285002 : Codeunit 12013591;
                               BEGIN
                                 CurrPage.SAVERECORD;
                                 ExFlowToInvYesNo.RUN(Rec);

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100285113;2 ;Action    ;
                      Name=Batch Create Invoices/Cr.Memos;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Batch Create Invoices/Cr.Memos;
                                 SVE=&Batch skapa fakturor/kreditnotor];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostBatch;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lrecExfPurchDocHead@1100285001 : Record 12013587;
                               BEGIN
                                 CurrPage.SAVERECORD;

                                 lrecExfPurchDocHead.SETRANGE("Journal Template Name","Journal Template Name");
                                 lrecExfPurchDocHead.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 REPORT.RUNMODAL(REPORT::"Batch Create Purchase Invoices",TRUE,TRUE,lrecExfPurchDocHead);

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1100285093;2 ;Action    ;
                      Name=Pre Inward Registration;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Pre Inward Registrated Invoice/Cr.Memo;
                                 SVE=Skapa f”rankomstregistrerad faktura/kreditnota];
                      Promoted=No;
                      Image=Post;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lrecExfPurchDocHead1@1100285000 : Record 12013587;
                                 VerifyImportJournal@1100285002 : Report 12013589;
                                 lrecExfPurchDocHead@1100285001 : Record 12013587;
                               BEGIN
                                 IF CheckPrePostStatus AND ("Pre Posting" <> lrecExfPurchDocHead."Pre Posting"::"Pre Posted") THEN BEGIN
                                   CurrPage.SAVERECORD;
                                   SetPrePostStatus("Inbound Document No.");
                                   lrecExfPurchDocHead.RESET;
                                   lrecExfPurchDocHead.SETRANGE("Inbound Document No.", "Inbound Document No.");
                                   VerifyImportJournal.SETTABLEVIEW(lrecExfPurchDocHead);
                                   VerifyImportJournal.RUNMODAL;
                                 END;
                               END;
                                }
      { 1100285053;0 ;ActionContainer;
                      Name=<Action1100285053>;
                      ActionContainerType=RelatedInformation }
      { 1100285054;1 ;ActionGroup;
                      Name=<Action1100285054>;
                      CaptionML=[ENU=&Invoice;
                                 SVE=Fa&ktura] }
      { 1100285055;2 ;Action    ;
                      Name=Card;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 SVE=Kort];
                      RunObject=Page 12013588;
                      RunPageLink=Inbound Document No.=FIELD(Inbound Document No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=New }
      { 1100285082;2 ;Action    ;
                      Name=Show Contract;
                      CaptionML=[ENU=Show Contract;
                                 SVE=Visa kontrakt];
                      Image=Check;
                      OnAction=VAR
                                 ExFlowContractMatching@1100285000 : Record 12013633;
                               BEGIN
                                 IF "Contract No." = 0 THEN
                                   ERROR(txt003);

                                 ExFlowContractMatching.GET("Contract No.");
                                 PAGE.RUN(PAGE::"ExFlow Contracts Matching", ExFlowContractMatching);
                               END;
                                }
      { 1100285048;2 ;Action    ;
                      Name=Dimensions;
                      CaptionML=[ENU=Dimensions;
                                 SVE=Dimensioner];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                               END;
                                }
      { 1100285051;2 ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 SVE=Statistik];
                      Image=Statistics;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"ExFlow Purchase Statistics", Rec);
                               END;
                                }
      { 1100285105;2 ;Action    ;
                      Name=Show Fraudulent Vendor ID;
                      CaptionML=[ENU=Show Fraudulent Vendor ID Details;
                                 SVE=Visa Bluffleverant”rs ID detaljer];
                      Image=Setup;
                      OnAction=VAR
                                 ExWatchMgt@1100285000 : Codeunit 12013685;
                               BEGIN
                                 ExWatchMgt.ViewBlacklistedVendIDs;
                               END;
                                }
      { 1100285094;2 ;Action    ;
                      Name=Search ExFlow Documents;
                      CaptionML=[ENU=Search ExFlow Documents;
                                 SVE=S”k ExFlow Dokument];
                      RunObject=Page 12057134;
                      Image=ViewDetails }
      { 1100285056;1 ;ActionGroup;
                      Name=Files;
                      CaptionML=[ENU=Files;
                                 SVE=Filer] }
      { 1100285057;2 ;Action    ;
                      Name=Show Import Details (OCR);
                      CaptionML=[ENU=Show Import Details (OCR);
                                 SVE=Visa Importdetaljer (OCR)];
                      Image=Setup;
                      OnAction=BEGIN
                                 ShowImportCard;
                               END;
                                }
      { 1100285061;2 ;Action    ;
                      Name=Show Document Image;
                      ShortCutKey=Ctrl+I;
                      CaptionML=[ENU=Show Document Image;
                                 SVE=Visa dokument];
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowImage;
                               END;
                                }
      { 1100285052;2 ;Action    ;
                      Name=Attachments;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=Attachments;
                                 SVE=Bilagor];
                      RunObject=Page 12013598;
                      RunPageLink=Inbound Document No.=FIELD(Inbound Document No.);
                      Image=Documents }
    }
  }
  CONTROLS
  {
    { 1100285000;0;Container;
                ContainerType=ContentArea }

    { 1100285106;1;Field  ;
                CaptionML=[ENU=Batch Name;
                           SVE=Journalnamn];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             ExfJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                             CurrentJnlBatchNameOnAfterVali;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           ExfJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1100285043;1;Group  ;
                GroupType=Repeater }

    { 1100285002;2;Field  ;
                SourceExpr="Inbound Document No.";
                Visible=False }

    { 1100285046;2;Field  ;
                SourceExpr="Error category code";
                Visible=FALSE }

    { 1100285104;2;Field  ;
                SourceExpr="Error category code changed";
                Visible=FALSE }

    { 1100285083;2;Field  ;
                SourceExpr="PO Matched Document";
                Visible=False }

    { 1100285003;2;Field  ;
                SourceExpr="Validation Error";
                Visible=False }

    { 1100285004;2;Field  ;
                SourceExpr="Error Message";
                OnAssistEdit=BEGIN
                               IF "Error Message" <> '' THEN
                                 MESSAGE(STRSUBSTNO(txt001,"Error Message"));
                             END;
                              }

    { 1100285005;2;Field  ;
                SourceExpr="ExFlow Entry Type";
                Visible=false }

    { 1100285077;2;Field  ;
                SourceExpr=Approval;
                Visible=False }

    { 1100285078;2;Field  ;
                SourceExpr="Check Order Line (OCR)";
                Visible=False }

    { 1100285079;2;Field  ;
                SourceExpr="Receipt No. Mandatory";
                Visible=False }

    { 1100285031;2;Field  ;
                SourceExpr="Potential UOM Mismatch";
                Visible=FALSE }

    { 1100285080;2;Field  ;
                SourceExpr="Block Document" }

    { 1100285006;2;Field  ;
                SourceExpr="Posting Date" }

    { 1100285007;2;Field  ;
                SourceExpr="ExFlow Document Type" }

    { 1100285008;2;Field  ;
                SourceExpr="Buy-from Vendor No.";
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100285009;2;Field  ;
                SourceExpr="Buy-from Vendor Name";
                Editable=FALSE }

    { 1100285087;2;Field  ;
                SourceExpr="Vendor Document No." }

    { 1100285112;2;Field  ;
                SourceExpr="Vendor Document No. 2" }

    { 1101285001;2;Field  ;
                SourceExpr="Message Type" }

    { 1101285000;2;Field  ;
                SourceExpr="Invoice Message" }

    { 1100285010;2;Field  ;
                SourceExpr=Factoring;
                Visible=False }

    { 1100285012;2;Field  ;
                SourceExpr="Document Date" }

    { 1100285013;2;Field  ;
                SourceExpr="Due Date" }

    { 1100285011;2;Field  ;
                SourceExpr="Due Days (Import)";
                Visible=False }

    { 1100285014;2;Field  ;
                SourceExpr="Order No.";
                OnLookup=BEGIN
                           //340324
                           OrderNoLookup;
                           //340324
                           CurrPage.UPDATE(TRUE);
                         END;
                          }

    { 1100285015;2;Field  ;
                SourceExpr="Order No. (Import)";
                Visible=False }

    { 1100285032;2;Field  ;
                SourceExpr="Prepayment Order No.";
                Visible=FALSE }

    { 1100285091;2;Field  ;
                SourceExpr="Pre Post No.";
                OnValidate=BEGIN
                             IF xRec."Pre Post No." <> "Pre Post No." THEN
                                "Pre Post No." := xRec."Pre Post No.";
                           END;

                OnLookup=VAR
                           PurchHeader@1100285000 : Record 38;
                           PurchaseInvoice@1100285001 : Page 51;
                         BEGIN
                           IF "Pre Post No." <> '' THEN BEGIN
                             IF PurchHeader.GET("Document Type","Pre Post No.") THEN BEGIN
                                PurchaseInvoice.SETRECORD(PurchHeader);
                                PurchaseInvoice.SETTABLEVIEW(PurchHeader);
                                PurchaseInvoice.LOOKUPMODE := TRUE;
                               IF PurchaseInvoice.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                  PurchaseInvoice.GETRECORD(PurchHeader);
                               END;

                             END;
                           END;
                           CurrPage.UPDATE(TRUE);
                         END;
                          }

    { 1100285086;2;Field  ;
                BlankZero=Yes;
                SourceExpr="Pre Posting";
                OnValidate=BEGIN
                             IF xRec."Pre Posting" = "Pre Posting"::"Pre Posted" THEN BEGIN
                                  "Pre Posting" := "Pre Posting"::"Pre Posted";
                               END ELSE
                              IF (xRec."Pre Posting" <> "Pre Posting"::"Pre Posted") AND ("Pre Posting" = "Pre Posting"::"Pre Posted") THEN BEGIN
                                  "Pre Posting" := xRec."Pre Posting";
                             END
                           END;
                            }

    { 1100285034;2;Field  ;
                SourceExpr="Contract No.";
                Visible=FALSE }

    { 1100285076;2;Field  ;
                SourceExpr="On Hold";
                Visible=False }

    { 1100285016;2;Field  ;
                SourceExpr="Pay-to Vendor No.";
                Visible=False }

    { 1100285017;2;Field  ;
                SourceExpr="Pay-to Name";
                Visible=False;
                Editable=FALSE }

    { 1100285030;2;Field  ;
                SourceExpr="Posting Description";
                Visible=FALSE }

    { 1100285001;2;Field  ;
                SourceExpr="Location Code";
                Visible=False }

    { 1100285018;2;Field  ;
                SourceExpr="Payment Terms Code";
                Visible=False }

    { 1100285019;2;Field  ;
                SourceExpr="Vendor ID" }

    { 1100285020;2;Field  ;
                SourceExpr="First Approver";
                Visible=False;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100285021;2;Field  ;
                SourceExpr="Template Rule";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100285022;2;Field  ;
                SourceExpr="Prop. Line G/L Account";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100285074;2;Field  ;
                SourceExpr="Predefined Purch. Code";
                Visible=False }

    { 1100285075;2;Field  ;
                SourceExpr="Diffline Purch. Code";
                Visible=False }

    { 1100285023;2;Field  ;
                SourceExpr="Propose Line";
                Visible=FALSE }

    { 1100285111;2;Field  ;
                SourceExpr="Propose VAT Line";
                Visible=FALSE }

    { 1100285110;2;Field  ;
                SourceExpr="Propose Diff. Line";
                Visible=FALSE }

    { 1100285064;2;Field  ;
                SourceExpr="Job No.";
                Visible=False;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100285033;2;Field  ;
                SourceExpr="Job No. (Import)";
                Visible=FALSE }

    { 1100285024;2;Field  ;
                SourceExpr="Document Amount Including VAT";
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100285025;2;Field  ;
                SourceExpr="Document Amount VAT";
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100285099;2;Field  ;
                SourceExpr="Document Amount";
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100285114;2;Field  ;
                SourceExpr="Calculated VAT %" }

    { 1100285098;2;Field  ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 1100285026;2;Field  ;
                SourceExpr="Prices Including VAT";
                Visible=FALSE }

    { 1100285100;2;Field  ;
                SourceExpr="EU 3-Party Trade";
                Visible=FALSE }

    { 1100285036;2;Field  ;
                SourceExpr="Misc Amount 1";
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100285037;2;Field  ;
                SourceExpr="Misc Amount 2";
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100285027;2;Field  ;
                SourceExpr="Currency Code";
                OnAssistEdit=VAR
                               ChangeExchangeRate@1100285000 : Page 511;
                             BEGIN
                               //342588
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                               //342588
                             END;
                              }

    { 1100285117;2;Field  ;
                SourceExpr="Currency Code (Import)" }

    { 1100285028;2;Field  ;
                SourceExpr="Admin Comment" }

    { 1100285029;2;Field  ;
                SourceExpr=Reference }

    { 1100285102;2;Field  ;
                SourceExpr="Pay to Account (Import)";
                Editable=False }

    { 1100285107;2;Field  ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 1100285038;2;Field  ;
                SourceExpr="Has Attachments" }

    { 1100285039;2;Field  ;
                SourceExpr="Image File Name";
                Editable=False;
                OnAssistEdit=VAR
                               EXVerifyDoc@1100285000 : Codeunit 12013594;
                             BEGIN
                               CurrPage.SAVERECORD;
                               EXVerifyDoc.UploadImage(Rec,'','');
                               CurrPage.UPDATE(TRUE);
                             END;
                              }

    { 1100285118;2;Field  ;
                SourceExpr="PO Matching E-Mails";
                Visible=FALSE }

    { 1100285097;2;Field  ;
                CaptionML=[ENU=Only File Name;
                           SVE=Enbart filnamn];
                SourceExpr=DisplayFileName;
                Visible=FALSE;
                Editable=FALSE }

    { 1100285073;2;Field  ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 1100285072;2;Field  ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 1100285071;2;Field  ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                             UpdatePurchLinesShortcutDim(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                           UpdatePurchLinesShortcutDim(3,ShortcutDimCode[3]);
                         END;
                          }

    { 1100285070;2;Field  ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                             UpdatePurchLinesShortcutDim(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                           UpdatePurchLinesShortcutDim(4,ShortcutDimCode[4]);
                         END;
                          }

    { 1100285069;2;Field  ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                             UpdatePurchLinesShortcutDim(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                           UpdatePurchLinesShortcutDim(5,ShortcutDimCode[5]);
                         END;
                          }

    { 1100285068;2;Field  ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                             UpdatePurchLinesShortcutDim(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                           UpdatePurchLinesShortcutDim(6,ShortcutDimCode[6]);
                         END;
                          }

    { 1100285067;2;Field  ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                             UpdatePurchLinesShortcutDim(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                           UpdatePurchLinesShortcutDim(7,ShortcutDimCode[7]);
                         END;
                          }

    { 1100285066;2;Field  ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                             UpdatePurchLinesShortcutDim(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                           UpdatePurchLinesShortcutDim(8,ShortcutDimCode[8]);
                         END;
                          }

    { 1100285040;2;Field  ;
                SourceExpr="Date Created";
                Visible=False }

    { 1100285041;2;Field  ;
                SourceExpr="Time Created";
                Visible=False }

    { 1100285044;1;Part   ;
                Name=Inbnd Exflow Doc. Line Subform;
                CaptionML=[ENU=Import Lines;
                           SVE=Import rader];
                SubPageLink=Inbound Document No.=FIELD(Inbound Document No.);
                PagePartID=Page12013591;
                PartType=Page }

    { 1100285122;1;Field  ;
                Name=ErrorMessage2;
                SourceExpr="Error Message";
                OnAssistEdit=BEGIN
                               IF "Error Message" <> '' THEN
                                 MESSAGE(STRSUBSTNO(txt001,"Error Message"));
                             END;
                              }

    { 1100285047;0;Container;
                ContainerType=FactBoxArea }

    { 1100285115;1;Part   ;
                Name=PdfPreviewPart;
                CaptionML=[ENU=PDF Preview;
                           SVE=PDF F”rhandsgranskning];
                PagePartID=Page12057078;
                PartType=Page }

    { 1100285035;1;Part   ;
                SubPageLink=Inbound Document No.=FIELD(Inbound Document No.);
                PagePartID=Page12057115;
                Visible=FALSE;
                PartType=Page }

    { 1100285065;1;Part   ;
                SubPageLink=Entry No.=FIELD(Inbound Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page12013599;
                ProviderID=1100285044;
                PartType=Page }

    { 1100285045;1;Part   ;
                SubPageLink=Inbound Document No.=FIELD(Inbound Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page12013626;
                ProviderID=1100285044;
                Editable=False;
                PartType=Page }

    { 1100285101;1;Part   ;
                CaptionML=[ENU=Warning messages;
                           SVE=Varningsmeddelanden];
                SubPageLink=Inbound Document No.=FIELD(Inbound Document No.);
                PagePartID=Page12057117;
                PartType=Page }

    { 1100285090;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1100285089;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1100285088;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1100285042;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1100285103;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ExfJnlManagement@1100285010 : Codeunit 12013587;
      ExFImportMgt@1100285009 : Codeunit 12013604;
      CurrentJnlBatchName@1100285005 : Code[10];
      ShortcutDimCode@1100285004 : ARRAY [8] OF Code[20];
      ForceOpenJnlBatchName@1100285000 : Code[10];
      OpenedFromBatch@1100285002 : Boolean;
      txt001@1100285001 : TextConst 'ENU=%1;SVE=%1';
      txt002@1100285003 : TextConst 'ENU=No journal selected.;SVE=Ingen journal vald.';
      CurrDocID@1100285006 : Integer;
      txt003@1100285008 : TextConst 'ENU=No Contract matched against the selected document;SVE=Inget kontrakt kopplat till det valda dokumentet';
      PrePostView@1100285007 : Boolean;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      ExfJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE MySetSelectionFilter@1100285000(VAR vrecExfPurchDocHead@1100285000 : Record 12013587);
    VAR
      lrecExfPurchDocHead@1100285001 : Record 12013587;
    BEGIN
      CurrPage.SETSELECTIONFILTER(lrecExfPurchDocHead);
      IF lrecExfPurchDocHead.MARK THEN
        vrecExfPurchDocHead.COPY(lrecExfPurchDocHead)
      ELSE BEGIN
        vrecExfPurchDocHead.COPY(Rec);
        vrecExfPurchDocHead.CLEARMARKS;
        lrecExfPurchDocHead.FIND('-');
        REPEAT
          vrecExfPurchDocHead := lrecExfPurchDocHead;
          vrecExfPurchDocHead.MARK(TRUE);
        UNTIL lrecExfPurchDocHead.NEXT = 0;
      END;
    END;

    PROCEDURE GetCaption@1100285002() : Text[100];
    BEGIN
      EXIT(STRSUBSTNO('%1 %2', "ExFlow Document Type", "Inbound Document No."));
    END;

    PROCEDURE SetCurrJnlBatch@1100285001(_CurrentJnlBatchName@1100285000 : Code[10]);
    BEGIN
      ForceOpenJnlBatchName := _CurrentJnlBatchName;
    END;

    LOCAL PROCEDURE PreviewPDF@1100285003();
    VAR
      PDFPrewMgt@1100285001 : Codeunit 12057081;
      NewEncodedPDF@1100285000 : Text;
    BEGIN
      IF (CurrDocID <> "Inbound Document No.") AND CurrPage.PdfPreviewPart.PAGE.IsVisible THEN BEGIN
        PDFPrewMgt.SetPDFFromExPurchDoc(Rec,NewEncodedPDF);
        CurrPage.PdfPreviewPart.PAGE.SetNewPDF(NewEncodedPDF);
      END;
      CurrDocID := "Inbound Document No.";
    END;

    PROCEDURE CheckPrePostStatus@1100285004() : Boolean;
    VAR
      ExFSetup@1100285000 : Record 12013601;
    BEGIN
      IF ExFSetup.GET THEN
        EXIT(ExFSetup."Automatic Pre. Reg. of Inwards");
    END;

    LOCAL PROCEDURE SetPrePostStatus@1100285005(InbDocNo@1100285001 : Integer);
    VAR
      lrecExfPurchDocHead@1100285000 : Record 12013587;
    BEGIN
      lrecExfPurchDocHead.SETRANGE("Inbound Document No.", "Inbound Document No.");
      IF lrecExfPurchDocHead.FINDFIRST THEN BEGIN
         lrecExfPurchDocHead."Pre Posting" := lrecExfPurchDocHead."Pre Posting"::"Pre Post";
         lrecExfPurchDocHead.MODIFY;
         COMMIT;
      END;
    END;

    BEGIN
    END.
  }
}

