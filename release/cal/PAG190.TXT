OBJECT Page 190 Incoming Documents
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.04;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Incoming Documents;
               NOR=InngÜende dokumenter;
               SVE=Inkommande dokument];
    ApplicationArea=#Basic,#Suite;
    SourceTable=Table130;
    DataCaptionFields=Description;
    PageType=List;
    UsageCategory=Lists;
    AdditionalSearchTermsML=[ENU=electronic document,e-invoice,ocr,ecommerce,document exchange,import invoice;
                             NOR=elektronisk dokument,e-faktura,ocr,netthandel,dokumentutveksling,fakturaimport;
                             SVE=elektroniskt dokument,e-faktura,ocr,e-handel,dokumentutbyte,importera faktura];
    CardPageID=Incoming Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Release,Status,Show;
                                NOR=Ny,Prosess,Rapport,Frigivelse,Status,Visning;
                                SVE=Ny,Process,Rapport,SlÑpp,Status,Visa];
    OnOpenPage=BEGIN
                 IsDataExchTypeEditable := TRUE;
                 IF GUIALLOWED THEN BEGIN
                   HasCamera := CameraProvider.IsAvailable;
                   IF HasCamera THEN
                     CameraProvider := CameraProvider.Create;
                 END;
                 EnableReceiveFromOCR := WaitingToReceiveFromOCR;
                 UpdateOCRSetupVisibility;

                 FILTERGROUP(0);
                 SetProcessedDocumentsVisibility(GETFILTER(Processed) = FORMAT(TRUE));
               END;

    OnAfterGetRecord=BEGIN
                       URL := GetURL;
                       StatusStyleText := GetStatusStyleText;
                     END;

    OnNewRecord=BEGIN
                  URL := '';
                  StatusStyleText := GetStatusStyleText;
                END;

    OnAfterGetCurrRecord=BEGIN
                           IsDataExchTypeEditable := NOT (Status IN [Status::Created,Status::Posted]);
                           StatusStyleText := GetStatusStyleText;
                           SetControlVisibility;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromIncomingDocument(Rec);
                           SetToProcessedIsEnable := NOT Processed;
                         END;

    ActionList=ACTIONS
    {
      { 22      ;    ;ActionContainer;
                      CaptionML=[ENU=New;
                                 NOR=Ny;
                                 SVE=Nytt];
                      ActionContainerType=NewDocumentItems }
      { 56      ;1   ;Action    ;
                      Name=CreateFromCamera;
                      CaptionML=[ENU=Create from Camera;
                                 NOR=Opprett fra kamera;
                                 SVE=Skapa frÜn kamera];
                      ToolTipML=[ENU=Create a new incoming document record by taking a picture.;
                                 NOR=Oppretter en ny post for innkommende dokument ved Ü ta et bilde.;
                                 SVE=Skapa en ny inkommande dokumentpost genom att ta ett foto.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=HasCamera;
                      PromotedIsBig=Yes;
                      Image=Camera;
                      PromotedCategory=New;
                      OnAction=VAR
                                 CameraOptions@1000 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraOptions";
                               BEGIN
                                 IF NOT HasCamera THEN
                                   EXIT;
                                 CameraOptions := CameraOptions.CameraOptions;
                                 CameraOptions.Quality := 100; // 100%
                                 CameraProvider.RequestPictureAsync(CameraOptions);
                               END;
                                }
      { 50      ;1   ;Action    ;
                      Name=CreateFromAttachment;
                      CaptionML=[ENU=Create from File;
                                 NOR=Opprett fra fil;
                                 SVE=Skapa frÜn fil];
                      ToolTipML=[ENU=Create a new incoming document record by first selecting the file it will be based on. The selected file will be attached.;
                                 NOR=Oppretter en ny post for innkommende dokument ved fõrst Ü velge filen det skal baseres pÜ, Den valgte filen legges ved.;
                                 SVE=Skapa en ny inkommande dokumentpost genom att fîrst vÑlja filen den baseras pÜ. Den valda filen bifogas.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExportAttachment;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CreateFromAttachment;
                               END;
                                }
      { 33      ;    ;ActionContainer;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon;
                                 SVE=Relaterad information];
                      ActionContainerType=RelatedInformation }
      { 28      ;1   ;ActionGroup;
                      CaptionML=[ENU=Setup;
                                 NOR=Oppsett;
                                 SVE=Konfiguration] }
      { 32      ;2   ;Action    ;
                      Name=Setup;
                      CaptionML=[ENU=Setup;
                                 NOR=Oppsett;
                                 SVE=InstÑllning];
                      ToolTipML=[ENU=Define the general journal type to use when creating journal lines. You can also specify whether it requires approval to create documents and journal lines.;
                                 NOR=Definerer hvilken type finanskladd som brukes ved oppretting av kladdelinjer. Du kan ogsÜ angi om det kreves godkjenning for Ü opprette dokumenter og kladdelinjer.;
                                 SVE=Definierar redovisningsjournaltypen som anvÑnds nÑr du skapar journalrader. Det gÜr Ñven att ange om den mÜste godkÑnnas innan det gÜr att skapa dokument och journalrader.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 191;
                      Image=Setup;
                      PromotedCategory=Category5 }
      { 42      ;2   ;Action    ;
                      Name=DataExchangeTypes;
                      CaptionML=[ENU=Data Exchange Types;
                                 NOR=Datautvekslingstyper;
                                 SVE=Typer av dataintegration];
                      ToolTipML=[ENU=View the data exchange types that are available to convert electronic documents to documents in Dynamics 365.;
                                 NOR=Viser datautvekslingstypene som er tilgjengelige for Ü konvertere elektroniske dokumenter til dokumenter i Dynamics 365.;
                                 SVE=Visa dataintegrationstyperna som finns tillgÑngliga fîr att konvertera elektroniska dokument till dokument i Dynamics 365.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1213;
                      Image=Entries;
                      PromotedCategory=Category5 }
      { 46      ;2   ;Action    ;
                      Name=OCRSetup;
                      CaptionML=[ENU=OCR Service Setup;
                                 NOR=Oppsett for OCR-tjeneste;
                                 SVE=OCR-serviceinstÑllningar];
                      ToolTipML=[ENU=Open the OCR Service Setup window, for example to change credentials or enable the service.;
                                 NOR=èpner vinduet Oppsett for OCR-tjeneste, for eksempel for Ü endre legitimasjon eller aktivere tjenesten.;
                                 SVE=ôppna fînstret OCR-serviceinstÑllningar fîr att till exempel Ñndra autentiseringsuppgifter eller aktivera tjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=ShowOCRSetup;
                      Image=ServiceSetup;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"OCR Service Setup");
                                 CurrPage.UPDATE;
                                 IF ClientTypeManagement.GetCurrentClientType = CLIENTTYPE::Web THEN
                                   IF OCRIsEnabled THEN BEGIN
                                     OnCloseIncomingDocumentsFromActions(Rec);
                                     CurrPage.CLOSE;
                                   END;
                               END;
                                }
      { 66      ;1   ;Action    ;
                      Name=ApprovalEntries;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OpenApprovalEntriesPage(RECORDID);
                               END;
                                }
      { 29      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 54      ;1   ;ActionGroup;
                      CaptionML=[ENU=Process;
                                 NOR=Prosess;
                                 SVE=Process] }
      { 45      ;2   ;Action    ;
                      Name=CreateDocument;
                      CaptionML=[ENU=Create Document;
                                 NOR=Opprett dokument;
                                 SVE=Skapa dokument];
                      ToolTipML=[ENU=Create a document, such as a purchase invoice, automatically by converting the electronic document that is attached to the incoming document record.;
                                 NOR=Opprette et dokument automatisk, for eksempel en kjõpsfaktura, ved Ü konvertere det elektroniske dokumentet som er vedlagt posten for det innkommende dokumentet.;
                                 SVE=Skapa ett dokument, till exempel en inkîpsfaktura, automatiskt genom att konvertera det elektroniska dokumentet som Ñr bifogat till den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=AutomaticCreationActionsAreEnabled;
                      PromotedIsBig=Yes;
                      Image=CreateDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::CreateDocument);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 51      ;2   ;Action    ;
                      Name=CreateGenJnlLine;
                      CaptionML=[ENU=Create Journal Line;
                                 NOR=Opprett kladdelinje;
                                 SVE=Skapa journalrad];
                      ToolTipML=[ENU=Create a journal line automatically by converting the electronic document that is attached to the incoming document record.;
                                 NOR=Oppretter en kladdelinje automatisk ved Ü konvertere det elektroniske dokumentet som er vedlagt posten for det innkommende dokumentet.;
                                 SVE=Skapa en journalrad automatiskt genom att konvertera det elektroniska dokumentet som Ñr bifogat till den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=AutomaticCreationActionsAreEnabled;
                      PromotedIsBig=Yes;
                      Image=TransferToGeneralJournal;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::CreateGenJnlLineWithDataExchange);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      Name=CreateManually;
                      CaptionML=[ENU=Create Manually;
                                 NOR=Opprett manuelt;
                                 SVE=Skapa manuellt];
                      ToolTipML=[ENU=Create a document, such as a purchase invoice, manually from information in the file that is attached to the incoming document record.;
                                 NOR=Oppretter et dokument manuelt, for eksempel en kjõpsfaktura, fra informasjonen i filen som er vedlagt posten for det innkommende dokumentet.;
                                 SVE=Skapa ett dokument, till exempel en inkîpsfaktura, manuellt frÜn information i filen som Ñr bifogad till den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CreateCreditMemo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::CreateManually);
                               END;
                                }
      { 39      ;2   ;Action    ;
                      Name=AttachFile;
                      CaptionML=[ENU=Attach File;
                                 NOR=Tilknytt fil;
                                 SVE=Bifoga fil];
                      ToolTipML=[ENU=Attach a file to the incoming document record.;
                                 NOR=Legger ved en fil i posten for det innkommende dokumentet.;
                                 SVE=Bifoga du en fil till den inkommande dokumentposten.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Attach;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ImportAttachment(Rec);
                               END;
                                }
      { 49      ;2   ;Action    ;
                      Name=TextToAccountMapping;
                      CaptionML=[ENU=Map Text to Account;
                                 NOR=Tilordne tekst til konto;
                                 SVE=Mappa text till konto];
                      ToolTipML=[ENU=Create a mapping of text on incoming documents to identical text on specific debit, credit, and balancing accounts in the general ledger or on bank accounts so that the resulting document or journal lines are prefilled with the specified information.;
                                 NOR=Oppretter en tilordning av tekst pÜ inngÜende dokumenter til identisk tekst pÜ bestemte debet-, kredit- og motkonti i Finans eller pÜ bankkonti, slik at de resulterende dokument- eller kladdelinjene forhÜndsutfylles med den angitte informasjonen.;
                                 SVE=Skapa en mappning av text i inkommande dokument till identisk text pÜ vissa debet-, kredit- och balanskonton i redovisningen eller pÜ bankkonton, sÜ att de resulterande dokument- eller journalraderna fylls i automatiskt med den angivna informationen.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1254;
                      Image=MapAccounts;
                      PromotedCategory=Category5 }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑpp] }
      { 30      ;2   ;Action    ;
                      Name=Release;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑpp];
                      ToolTipML=[ENU=Release the incoming document to indicate that it has been approved by the incoming document approver. Note that this is not related to approval workflows.;
                                 NOR=Frigir det innkommende dokumentet for Ü angi at det er godkjent av godkjenner av innkommende dokument. Legg merke til at dette ikke er knyttet til arbeidsflyter for godkjenning.;
                                 SVE=SlÑpp det inkommande dokumentet fîr att indikera att det har godkÑnts av godkÑnnaren fîr inkommande dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::Release);
                               END;
                                }
      { 67      ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Reopen;
                                 NOR=èpne pÜ nytt;
                                 SVE=ôppna igen];
                      ToolTipML=[ENU=Reopen the incoming document record after it has been approved by the incoming document approver. Note that this is not related to approval workflows.;
                                 NOR=èpner posten for det innkommende dokumentet pÜ nytt etter at det er godkjent av godkjenner av innkommende dokument. Legg merke til at dette ikke er knyttet til arbeidsflyter for godkjenning.;
                                 SVE=ôppna den inkommande dokumentposten pÜ nytt nÑr den har godkÑnts av godkÑnnaren fîr inkommande dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::Reopen);
                               END;
                                }
      { 31      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      ToolTipML=[ENU=Reject to approve the incoming document. Note that this is not related to approval workflows.;
                                 NOR=Avviser Ü godkjenne det innkommende dokumentet. Legg merke til at dette ikke er knyttet til arbeidsflyter for godkjenning.;
                                 SVE=Avvisa fîr att godkÑnna det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::Reject);
                               END;
                                }
      { 68      ;1   ;ActionGroup;
                      CaptionML=[ENU=Status;
                                 NOR=Status;
                                 SVE=Status] }
      { 65      ;2   ;Action    ;
                      Name=SetToProcessed;
                      CaptionML=[ENU=Set To Processed;
                                 NOR=Satt til Behandlet;
                                 SVE=Ange som bearbetad];
                      ToolTipML=[ENU=Set the incoming document to processed. It will then be shown in the Incoming Documents window when the Show All view is selected.;
                                 NOR=Setter det innkommende dokumentet til behandlet. Dette vises det i vinduet Innkommende dokumenter nÜr Vis alle-visningen er valgt.;
                                 SVE=StÑll in det inkommande dokumentet som bearbetat. Det visas sedan i fînstret Inkommande dokument nÑr vyn Vissa alla Ñr vald.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=SetToProcessedIsEnable;
                      PromotedIsBig=Yes;
                      Image=Archive;
                      PromotedCategory=Category5;
                      Scope=Repeater;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(IncomingDocument);
                                 IncomingDocument.MODIFYALL(Processed,TRUE);
                               END;
                                }
      { 64      ;2   ;Action    ;
                      Name=SetToUnprocessed;
                      CaptionML=[ENU=Set To Unprocessed;
                                 NOR=Satt til Ubehandlet;
                                 SVE=Ange som obearbetad];
                      ToolTipML=[ENU=Set the incoming document to unprocessed. It will then be shown in the Incoming Documents window when the Show Unprocessed view is selected.;
                                 NOR=Setter det innkommende dokumentet til Ubehandlet. Dette vises det i vinduet Innkommende dokumenter nÜr visningen Vis Ubehandlet er valgt.;
                                 SVE=StÑll in det inkommande dokumentet som obearbetat. Det visas sedan i fînstret Inkommande dokument nÑr vyn Visa obearbetade Ñr vald.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=NOT SetToProcessedIsEnable;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Category5;
                      Scope=Repeater;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(IncomingDocument);
                                 IncomingDocument.MODIFYALL(Processed,FALSE);
                               END;
                                }
      { 61      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning;
                                 SVE=BegÑr godkÑnnande];
                      Image=SendApprovalRequest }
      { 60      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforespõrsel;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      ToolTipML=[ENU=Request approval of the incoming document. You can send an approval request as part of a workflow if this has been set up in your organization.;
                                 NOR=Ber om godkjenning for det innkommende dokumentet. Du kan sende en godkjenningsforespõrsel som en del av en arbeidsflyt hvis dette er konfigurert i organisasjonen.;
                                 SVE=BegÑr godkÑnnande av det inkommande dokumentet. Det gÜr att skicka begÑran om godkÑnnande som en del av ett arbetsflîde om det Ñr konfigurerat i organisationen.];
                      ApplicationArea=#Suite;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      Scope=Repeater;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 TestReadyForApproval;
                                 IF ApprovalsMgmt.CheckIncomingDocApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendIncomingDocForApproval(Rec);
                               END;
                                }
      { 59      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforespõrsel;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      ToolTipML=[ENU=Cancel requesting approval of the incoming document.;
                                 NOR=Avbryter godkjenningsforespõrsel for det innkommende dokumentet.;
                                 SVE=Avbryt begÑran om godkÑnnande av det inkommande dokumentet.];
                      ApplicationArea=#Suite;
                      Enabled=CanCancelApprovalForRecord;
                      Image=CancelApprovalRequest;
                      Scope=Repeater;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelIncomingDocApprovalRequest(Rec);
                               END;
                                }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=Incoming Documents;
                                 NOR=InngÜende dokumenter;
                                 SVE=Inkommande dokument] }
      { 58      ;2   ;Action    ;
                      Name=OpenDocument;
                      CaptionML=[ENU=Open Record;
                                 NOR=èpne post;
                                 SVE=ôppna post];
                      ToolTipML=[ENU=Open the document, journal line, or entry that the incoming document is linked to.;
                                 NOR=èpner dokumentet, kladdelinjen eller posten som er det innkommende dokumentet er knyttet til.;
                                 SVE=ôppna dokumentet, journalraden eller transaktionen som det inkommande dokumentet Ñr lÑnkat till.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewDetails;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowRecord;
                               END;
                                }
      { 40      ;2   ;Action    ;
                      Name=RemoveReferencedRecord;
                      CaptionML=[ENU=Remove Reference to Record;
                                 NOR=Fjern referanse til post;
                                 SVE=Ta bort referens till post];
                      ToolTipML=[ENU=Remove the link that exists from the incoming document to a document, journal line, or entry.;
                                 NOR=Fjerner koblingen som finnes mellom det innkommende dokumentet til et dokument, en kladdelinje eller en post.;
                                 SVE=Ta bort lÑnken frÜn det inkommande dokumentet till ett dokument, en journalrad eller en transaktion.];
                      ApplicationArea=#Basic,#Suite;
                      PromotedIsBig=Yes;
                      Image=ClearLog;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 RemoveReferencedRecords;
                               END;
                                }
      { 55      ;2   ;Action    ;
                      Name=Navigate;
                      CaptionML=[ENU=Navigate;
                                 NOR=Naviger;
                                 SVE=Analysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppfõringer og dokumenter som finnes for dokumentnummeret og bokfõringsdatoen i den valgte oppfõringen eller dokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet fîr den valda transaktionen eller det valda dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      Scope=Repeater;
                      OnAction=VAR
                                 NavigatePage@1000 : Page 344;
                               BEGIN
                                 TESTFIELD(Posted);
                                 NavigatePage.SetDoc("Posting Date","Document No.");
                                 NavigatePage.RUN;
                               END;
                                }
      { 52      ;2   ;ActionGroup;
                      Name=Document;
                      CaptionML=[ENU=Record;
                                 NOR=Post;
                                 SVE=Post];
                      Visible=FALSE;
                      Enabled=FALSE;
                      Image=Document }
      { 23      ;3   ;Action    ;
                      Name=Journal;
                      CaptionML=[ENU=Journal Line;
                                 NOR=Kladdelinje;
                                 SVE=Journalrad];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Journal;
                      Scope=Repeater;
                      OnAction=VAR
                                 GenJournalBatch@1001 : Record 232;
                                 GenJnlManagement@1002 : Codeunit 230;
                               BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::CreateGenJnlLine);
                                 IncomingDocumentsSetup.Fetch;
                                 GenJournalBatch.GET(IncomingDocumentsSetup."General Journal Template Name",IncomingDocumentsSetup."General Journal Batch Name");
                                 GenJnlManagement.TemplateSelectionFromBatch(GenJournalBatch);
                               END;
                                }
      { 26      ;3   ;Action    ;
                      Name=PurchaseInvoice;
                      CaptionML=[ENU=Purchase Invoice;
                                 NOR=Kjõpsfaktura;
                                 SVE=Inkîpsfaktura];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Purchase;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::CreatePurchInvoice);
                               END;
                                }
      { 27      ;3   ;Action    ;
                      Name=PurchaseCreditMemo;
                      CaptionML=[ENU=Purchase Credit Memo;
                                 NOR=Kjõpskreditnota;
                                 SVE=Inkîpskreditnota];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CreditMemo;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::CreatePurchCreditMemo);
                               END;
                                }
      { 24      ;3   ;Action    ;
                      Name=SalesInvoice;
                      CaptionML=[ENU=Sales Invoice;
                                 NOR=Salgsfaktura;
                                 SVE=FîrsÑljningsfaktura];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Sales;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::CreateSalesInvoice);
                               END;
                                }
      { 25      ;3   ;Action    ;
                      Name=SalesCreditMemo;
                      CaptionML=[ENU=Sales Credit Memo;
                                 NOR=Salgskreditnota;
                                 SVE=FîrsÑljningskreditnota];
                      ToolTipML=[ENU=Open the record that the incoming document is linked to.;
                                 NOR=èpne posten som det innkommende dokumentet er koblet til.;
                                 SVE=ôppna posten som Ñr kopplad till det inkommande dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CreditMemo;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::CreateSalesCreditMemo);
                               END;
                                }
      { 44      ;1   ;ActionGroup;
                      CaptionML=[ENU=OCR;
                                 NOR=OCR;
                                 SVE=OCR] }
      { 41      ;2   ;Action    ;
                      Name=SetReadyForOCR;
                      CaptionML=[ENU=Send to Job Queue;
                                 NOR=Send til jobbkõ;
                                 SVE=Skicka till jobbkî];
                      ToolTipML=[ENU=Set the incoming document to be sent to its recipient as soon as possible.;
                                 NOR=Angir at det innkommende dokumentet skal sendes til mottakerne sÜ snart som mulig.;
                                 SVE=StÑll in det inkommande dokumentet sÜ att det skickas till mottagaren sÜ snart som mîjligt.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=OCRServiceIsEnabled;
                      Image=Translation;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::SetReadyForOcr);
                               END;
                                }
      { 43      ;2   ;Action    ;
                      Name=UndoSetReadyForOCR;
                      CaptionML=[ENU=Remove from Job Queue;
                                 NOR=Fjern fra jobbkõ;
                                 SVE=Ta bort frÜn jobbkî];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektkõen.;
                                 SVE=Ta bort den schemalagda bearbetningen av den hÑr rapporten frÜn jobbkîn.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=OCRServiceIsEnabled;
                      Image=Translation;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::UndoReadyForOcr);
                               END;
                                }
      { 12      ;2   ;Action    ;
                      Name=SendToOcr;
                      CaptionML=[ENU=Send to OCR Service;
                                 NOR=Send til OCR-tjeneste;
                                 SVE=Skicka till OCR-tjÑnst];
                      ToolTipML=[ENU=Send the attached PDF or image file to the OCR service immediately.;
                                 NOR=Sender umiddelbart den vedlagte PDF- eller bildefilen til OCR-tjenesten.;
                                 SVE=Skicka omedelbart bifogad PDF eller bildfil till OCR-tjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=OCRServiceIsEnabled;
                      Image=Translations;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 IncomingDocumentMultiSelectAction(MultiSelectAction::SendToOcr);
                               END;
                                }
      { 47      ;2   ;Action    ;
                      Name=ReceiveFromOCR;
                      CaptionML=[ENU=Receive from OCR Service;
                                 NOR=Motta fra OCR-tjeneste;
                                 SVE=Ta emot frÜn OCR-tjÑnst];
                      ToolTipML=[ENU=Get any electronic documents that are ready to receive from the OCR service.;
                                 NOR=Henter elektroniske dokumenter som er klare til Ü motta fra OCR-tjenesten.;
                                 SVE=HÑmta klara elektroniska dokument frÜn OCR-tjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=OCRServiceIsEnabled;
                      Enabled=EnableReceiveFromOCR;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"OCR - Receive from Service");
                               END;
                                }
      { 73      ;1   ;ActionGroup;
                      CaptionML=[ENU=Set View;
                                 NOR=Settvisning;
                                 SVE=Ange vy] }
      { 71      ;2   ;Action    ;
                      Name=ShowAll;
                      CaptionML=[ENU=Show All;
                                 NOR=Vis alle;
                                 SVE=Visa alla];
                      ToolTipML=[ENU=Show both processed and non-processed incoming documents.;
                                 NOR=Vis bÜde behandlede og ikke-behandlede innkommende dokumenter.;
                                 SVE=Visa bÜde bearbetade och ej bearbetade inkommande dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=NOT ShowAllDocsIsEnable;
                      PromotedIsBig=Yes;
                      Image=AllLines;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 SetProcessedDocumentsVisibility(TRUE);
                               END;
                                }
      { 72      ;2   ;Action    ;
                      Name=ShowUnprocessed;
                      CaptionML=[ENU=Show Unprocessed;
                                 NOR=Vis Ubehandlet;
                                 SVE=Visa obearbetade];
                      ToolTipML=[ENU=Show only unprocessed incoming documents.;
                                 NOR=Vis bare ubehandlede innkommende dokumenter.;
                                 SVE=Vissa enbart obearbetade inkommande dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=ShowAllDocsIsEnable;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 SetProcessedDocumentsVisibility(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the entry, as assigned from the specified number series when the entry was created.;
                           NOR=Angir nummeret for oppfõringen, som tilordnet fra den angitte nummerserien da oppfõringen ble opprettet.;
                           SVE=Anger transaktionsnumret, som tilldelas frÜn den angivna nummerserien nÑr transaktionen skapas.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Entry No.";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the incoming document. You must enter the description manually.;
                           NOR=Angir beskrivelsen av innkommende dokumenter. Du mÜ angi beskrivelsen manuelt.;
                           SVE=Anger beskrivningen av det inkommande dokumentet. Du mÜste ange beskrivningen manuellt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor on the incoming document. The field may be filled automatically.;
                           NOR=Angir navnet pÜ leverandõren pÜ det innkommende dokumentet. Feltet kan fylles ut automatisk.;
                           SVE=Anger namnet pÜ leverantîren i det inkommande dokumentet. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Name" }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that is printed on the incoming document. This is the date when the vendor created the invoice, for example. The field may be filled automatically.;
                           NOR=Angir datoen som skrives pÜ det innkommende dokumentet. Dette er for eksempel datoen da leverandõren opprettet fakturaen. Feltet kan fylles ut automatisk.;
                           SVE=Anger datumet som skrivs ut pÜ det inkommande dokumentet. Det hÑr Ñr till exempel datumet nÑr leverantîren skapade fakturan. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date" }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the original document you received from the vendor. You can require the document number for posting, or let it be optional. By default, it's required, so that this document references the original. Making document numbers optional removes a step from the posting process. For example, if you attach the original invoice as a PDF, you might not need to enter the document number. To specify whether document numbers are required, in the Purchases & Payables Setup window, select or clear the Ext. Doc. No. Mandatory field.;
                           NOR=Angir dokumentnummeret for det opprinnelige dokumentet du mottok fra leverandõren. Du kan kreve dokumentnummeret for bokfõring eller la det vëre valgfritt. Det er obligatorisk som standard, slik at dette dokumentet refererer til originalen. Hvis dokumentnumre gjõres valgfrie, fjernes et trinn fra bokfõringsprosessen. Hvis du for eksempel legger ved den opprinnelige fakturaen som en PDF-fil, kan det hende du ikke behõver Ü angi dokumentnummeret. Hvis du vil angi om dokumentnummeret er obligatorisk, gÜr du til vinduet for kjõpsoppsett, og merker av for eller fjerner merket for feltet Eksternt dokumentnr. obligatorisk.;
                           SVE=Anger dokumentnumret fîr det ursprungliga dokumentet som du har fÜtt frÜn leverantîren. Du kan krÑva dokumentnumret fîr bokfîring eller lÜta det vara frivilligt. Som standard krÑvs det i syfte att lÜta detta dokument referera till det ursprungliga. Vid valfria dokumentnummer fîrsvinner ett steg frÜn bokfîringsprocessen. Om du till exempel bifogar den ursprungliga fakturan som en PDF kanske du inte behîver ange dokumentnumret. Fîr att ange om dokumentnummer krÑvs, vÑlj eller rensa fÑltet Externt dok.nr obligatoriskt i fînstret Inkîp & InkîpsinstÑllningar.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Invoice No." }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code, if the document contains that code. The field may be filled automatically.;
                           NOR=Angir valutakoden hvis dokumentet inneholder denne koden. Feltet kan fylles ut automatisk.;
                           SVE=Anger valutakoden om dokumentet innehÜller den koden. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code" }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount including VAT for the whole document. The field may be filled automatically.;
                           NOR=Angir belõpet inkl. mva for hele dokumentet. Feltet kan fylles ut automatisk.;
                           SVE=Anger beloppet inklusive moms fîr hela dokumentet. FÑltet gÜr att fylla i automatiskt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Incl. VAT" }

    { 34  ;2   ;Field     ;
                ExtendedDatatype=URL;
                CaptionML=[ENU=Link to Document;
                           NOR=Koble til dokument;
                           SVE=LÑnk till dokument];
                ToolTipML=[ENU=Specifies the location of the file that represents the incoming document.;
                           NOR=Angir plasseringen til filen som representerer det innkommende dokumentet.;
                           SVE=Anger sîkvÑg till filen som motsvarar det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=URL;
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             SetURL(URL);
                           END;
                            }

    { 140 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the data exchange type that is used to process the incoming document when it is an electronic document.;
                           NOR=Angir datautvekslingstypen som brukes til Ü behandle det innkommende dokumentet nÜr det er et elektronisk dokument.;
                           SVE=Anger typen av dataintegration som anvÑnds fîr att behandla det inkommande dokument, nÑr det Ñr ett elektroniskt dokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Data Exchange Type";
                Visible=FALSE;
                Editable=IsDataExchTypeEditable }

    { 17  ;2   ;Field     ;
                DrillDown=Yes;
                ToolTipML=[ENU=Specifies the status of the incoming document record.;
                           NOR=Angir statusen for den innkommende dokumentposten.;
                           SVE=Anger status fîr den inkommande dokumentposten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Status;
                StyleExpr=StatusStyleText;
                OnDrillDown=VAR
                              ErrorMessage@1000 : Record 700;
                            BEGIN
                              ErrorMessage.SetContext(RECORDID);
                              ErrorMessage.ShowErrorMessages(FALSE);
                            END;
                             }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the incoming document record when it takes part in the OCR process.;
                           NOR=Angir statusen for den innkommende dokumentposten nÜr den tar del i OCR-prosessen.;
                           SVE=Anger status fîr den inkommande dokumentposten nÑr den ingÜr i OCR-processen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OCR Status";
                OnDrillDown=VAR
                              OCRServiceSetup@1000 : Record 1270;
                              OCRServiceMgt@1001 : Codeunit 1294;
                            BEGIN
                              IF NOT OCRServiceSetup.ISEMPTY THEN
                                HYPERLINK(OCRServiceMgt.GetStatusHyperLink(Rec));
                            END;
                             }

    { 69  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the process stage of the track ID in relation to the OCR service.;
                           NOR=Angir prosessfasen for feltspor-ID-en i forhold til OCR-tjenesten.;
                           SVE=Anger processtadiet fîr spÜrnings-ID i relation till OCR-tjÑnsten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OCR Track ID";
                Editable=FALSE }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the incoming document line was created.;
                           NOR=Angir nÜr den innkommende dokumentlinjen ble opprettet.;
                           SVE=Anger nÑr den inkommande dokumentraden skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Created Date-Time";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the user who created the incoming document line.;
                           NOR=Angir navnet til brukeren som opprettet den innkommende dokumentlinjen.;
                           SVE=Anger namnet pÜ anvÑndaren som skapade den inkommande dokumentraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Created By User Name";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the incoming document was approved.;
                           NOR=Angir nÜr det innkommende dokumentet ble godkjent.;
                           SVE=Anger nÑr det inkommande dokument godkÑndes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Released Date-Time";
                Visible=FALSE }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the user who approved the incoming document.;
                           NOR=Angir navnet til brukeren som godkjente det innkommende dokumentet.;
                           SVE=Anger namnet pÜ anvÑndaren som godkÑnde den inkommande dokumentraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Released By User Name";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the incoming document line was last modified.;
                           NOR=Angir nÜr den innkommende dokumentlinjen sist ble endret.;
                           SVE=Anger nÑr den inkommande dokumentraden senast Ñndrades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Date-Time Modified";
                Visible=FALSE }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the user who last modified the incoming document line.;
                           NOR=Angir navnet til brukeren som sist endret den innkommende dokumentlinjen.;
                           SVE=Anger namnet pÜ anvÑndaren som senast Ñndrade den inkommande dokumentraden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Modified By User Name";
                Visible=FALSE }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the related document or journal line was posted.;
                           NOR=Angir nÜr det tilknyttede dokumentet eller kladdelinjen ble bokfõrt.;
                           SVE=Anger nÑr den relaterade dokument- eller journalraden bokfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posted Date-Time";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of document or journal that the incoming document can be connected to.;
                           NOR=Angir hvilken type dokument eller kladd det innkommende dokumentet kan kobles til.;
                           SVE=Anger vilken typ av dokument eller journal som det inkommande dokumentet gÜr att koppla till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Type" }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the related document or journal line that is created for the incoming document.;
                           NOR=Angir nummeret pÜ tilknyttet dokument eller kladdelinje som opprettes for det innkommende dokumentet.;
                           SVE=Anger numret pÜ relaterat dokument eller journalrad som skapas fîr det inkommande dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document No." }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the document or journal line that relates to the incoming document was posted.;
                           NOR=Angir nÜr dokumentet eller kladdelinjen som er knyttet til det innkommende dokumentet, ble bokfõrt.;
                           SVE=Anger nÑr dokument eller journalraden som relaterar till det inkommande dokument bokfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                DrillDown=Yes;
                ToolTipML=[ENU=Specifies if the incoming document has been processed.;
                           NOR=Angir om det innkommende dokumentet er behandlet.;
                           SVE=Anger om det inkommande dokument har bearbetats.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Processed;
                StyleExpr=StatusStyleText;
                OnDrillDown=VAR
                              ErrorMessage@1000 : Record 700;
                            BEGIN
                              ErrorMessage.SetContext(RECORDID);
                              ErrorMessage.ShowErrorMessages(FALSE);
                            END;
                             }

    { 18  ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 7   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Incoming Document Entry No.=FIELD(Entry No.);
                PagePartID=Page193;
                PartType=Page;
                ShowFilter=No }

    { 19  ;1   ;Part      ;
                ApplicationArea=#Notes;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

    { 20  ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                Visible=FALSE;
                PartType=System;
                SystemPartID=MyNotes }

    { 21  ;1   ;Part      ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      IncomingDocumentsSetup@1001 : Record 131;
      AutomaticProcessingQst@1005 : TextConst 'ENU=The Data Exchange Type field is filled on at least one of the selected Incoming Documents.\\Are you sure you want to create documents manually?;NOR=Feltet Datautvekslingstype er utfylt pÜ minst ett av de valgte inngÜende dokumentene.\\Er du sikker pÜ at du vil opprette dokumenter manuelt?;SVE=FÑltet Typ av dataintegration Ñr ifyllt i minst ett av de valda Inkommande dokumenten.\\Vill du skapa dokument manuellt?';
      ClientTypeManagement@1015 : Codeunit 4030;
      CameraProvider@1008 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraProvider" WITHEVENTS RUNONCLIENT;
      HasCamera@1003 : Boolean;
      URL@1006 : Text;
      StatusStyleText@1004 : Text;
      MultiSelectAction@1002 : 'CreateGenJnlLine,CreatePurchInvoice,CreatePurchCreditMemo,CreateSalesInvoice,CreateSalesCreditMemo,Release,Reopen,Reject,CreateDocument,SetReadyForOcr,UndoReadyForOcr,SendToOcr,CreateGenJnlLineWithDataExchange,CreateManually';
      IsDataExchTypeEditable@1000 : Boolean;
      OpenApprovalEntriesExist@1009 : Boolean;
      EnableReceiveFromOCR@1007 : Boolean;
      CanCancelApprovalForRecord@1010 : Boolean;
      ShowOCRSetup@1011 : Boolean;
      OCRServiceIsEnabled@1012 : Boolean;
      AutomaticCreationActionsAreEnabled@1013 : Boolean;
      SetToProcessedIsEnable@1014 : Boolean;
      ShowAllDocsIsEnable@1022 : Boolean;

    LOCAL PROCEDURE IncomingDocumentMultiSelectAction@10(ActionName@1000 : Option);
    VAR
      IncomingDocument@1001 : Record 130;
      ReleaseIncomingDocument@1002 : Codeunit 132;
    BEGIN
      IF NOT AskUserPermission(ActionName) THEN
        EXIT;

      CurrPage.SETSELECTIONFILTER(IncomingDocument);
      IF IncomingDocument.FINDSET THEN
        REPEAT
          CASE ActionName OF
            MultiSelectAction::CreateDocument:
              IncomingDocument.CreateDocumentWithDataExchange;
            MultiSelectAction::CreateManually:
              IncomingDocument.CreateManually;
            MultiSelectAction::CreateGenJnlLine:
              IncomingDocument.CreateGenJnlLine;
            MultiSelectAction::CreateGenJnlLineWithDataExchange:
              IncomingDocument.CreateGeneralJournalLineWithDataExchange;
            MultiSelectAction::CreatePurchInvoice:
              IncomingDocument.CreatePurchInvoice;
            MultiSelectAction::CreatePurchCreditMemo:
              IncomingDocument.CreatePurchCreditMemo;
            MultiSelectAction::CreateSalesInvoice:
              IncomingDocument.CreateSalesInvoice;
            MultiSelectAction::CreateSalesCreditMemo:
              IncomingDocument.CreateSalesCreditMemo;
            MultiSelectAction::Release:
              ReleaseIncomingDocument.PerformManualRelease(IncomingDocument);
            MultiSelectAction::Reopen:
              ReleaseIncomingDocument.PerformManualReopen(IncomingDocument);
            MultiSelectAction::Reject:
              ReleaseIncomingDocument.PerformManualReject(IncomingDocument);
            MultiSelectAction::SetReadyForOcr:
              IncomingDocument.SendToJobQueue(FALSE);
            MultiSelectAction::UndoReadyForOcr:
              IncomingDocument.RemoveFromJobQueue(FALSE);
            MultiSelectAction::SendToOcr:
              IncomingDocument.SendToOCR(FALSE);
          END;
        UNTIL IncomingDocument.NEXT = 0;
    END;

    LOCAL PROCEDURE AskUserPermission@7(ActionName@1000 : Option) : Boolean;
    VAR
      IncomingDocument@1001 : Record 130;
    BEGIN
      CurrPage.SETSELECTIONFILTER(IncomingDocument);
      IF ActionName IN [MultiSelectAction::Reject,
                        MultiSelectAction::Release,
                        MultiSelectAction::SetReadyForOcr,
                        MultiSelectAction::CreateDocument]
      THEN
        EXIT(TRUE);

      IF Status <> Status::New THEN
        EXIT(TRUE);

      IncomingDocument.SETFILTER("Data Exchange Type",'<>%1','');
      IF IncomingDocument.ISEMPTY THEN
        EXIT(TRUE);

      EXIT(CONFIRM(AutomaticProcessingQst));
    END;

    LOCAL PROCEDURE SetControlVisibility@9();
    VAR
      ApprovalsMgmt@1000 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      EnableReceiveFromOCR := WaitingToReceiveFromOCR;
      UpdateOCRSetupVisibility;
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
      AutomaticCreationActionsAreEnabled := "Data Exchange Type" <> '';
    END;

    [Integration(TRUE,TRUE)]
    LOCAL PROCEDURE OnCloseIncomingDocumentsFromActions@3(VAR IncomingDocument@1000 : Record 130);
    BEGIN
    END;

    LOCAL PROCEDURE SetProcessedDocumentsVisibility@1(ShowProcessedItems@1000 : Boolean);
    BEGIN
      FILTERGROUP(0);

      IF ShowProcessedItems THEN BEGIN
        SETRANGE(Processed);
        ShowAllDocsIsEnable := TRUE;
      END ELSE BEGIN
        SETRANGE(Processed,FALSE);
        ShowAllDocsIsEnable := FALSE;
      END;
    END;

    LOCAL PROCEDURE UpdateOCRSetupVisibility@5();
    BEGIN
      OCRServiceIsEnabled := OCRIsEnabled;
      ShowOCRSetup := NOT OCRServiceIsEnabled;
    END;

    EVENT CameraProvider@1008::PictureAvailable@11(PictureName@1001 : Text;PictureFilePath@1000 : Text);
    BEGIN
      CreateIncomingDocumentFromServerFile(PictureName,PictureFilePath);
    END;

    BEGIN
    END.
  }
}

