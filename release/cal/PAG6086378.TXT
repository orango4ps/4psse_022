OBJECT Page 6086378 Mileage
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EMW16.00.10.3.00.05;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Kilometerleistung;
               ENU=Mileage;
               NLD=Kilometrage];
    SourceTable=Table6086338;
    SourceTableView=SORTING(Posted)
                    WHERE(Posted=CONST(No),
                          Settlement No.=FILTER(''));
    PageType=List;
    UsageCategory=Lists;
    CardPageID=Mileage Card;
    PromotedActionCategoriesML=[DEU=Neu, Prozess, Bericht, Kilometerleistung, Verwaltung;
                                ENU=New,Process,Report,Mileage,Administration;
                                NLD=Nieuw,Verwerk,Rapport,Mileage,Administratie];
    ShowFilter=Yes;
    OnInit=BEGIN
             EnableActions := COUNT > 0;
           END;

    OnOpenPage=VAR
                 UserResp@1160040001 : Record 6086379;
                 EMOnlineMgt@1160040002 : Codeunit 6086305;
                 EMNavVersionMgt@6086300 : Codeunit 6086319;
                 UpgradeMgt@1160040000 : Codeunit 6086334;
               BEGIN
                 EMOnlineMgt.IsCompanyActive(FALSE);
                 UpgradeMgt.CheckDataVersion;
                 EnableFields;
                 CheckUnProcessedInbox;
                 EnablePostingPreview := EMNavVersionMgt.CheckPreviewAllowed(FALSE);

                 IF UserResp.GetResponsibilityFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETFILTER("Continia User ID",UserResp.GetResponsibilityFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       EnableActions := TRUE;
                       HasComments := HasApprovalComment OR HasMileageComment;
                       ShortcutFieldFunctions.ShowShortcutFieldValues(ShortcutFieldValues,DATABASE::Mileage,0,'',"Entry No.");

                       //DO NOT FORMAT DIFFERENTLY. SEARCH/REPLACE FOR COMPATIBILITY
                       CASE Status OF
                         Status::Open: StyleFormat := 'Attention';
                         Status::Released: StyleFormat := 'Favorable';
                         ELSE StyleFormat := 'None';
                       END;
                     END;

    OnNewRecord=BEGIN
                  IF "Entry No." = 0 THEN
                    "Entry No." := GetEntryNo;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1160040028;1 ;ActionGroup;
                      Name=Mileage;
                      CaptionML=[DEU=Kilometerleistung;
                                 ENU=Mileage;
                                 NLD=Kilometrage] }
      { 1160040033;2 ;Action    ;
                      Name=Mileage Inbox;
                      CaptionML=[DEU=Kilometerleistungseingangsfach;
                                 ENU=Mileage Inbox;
                                 NLD=Kilometrage inbox];
                      Promoted=Yes;
                      Image=ErrorLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Mileage Inbox");
                               END;
                                }
      { 1160040061;2 ;Action    ;
                      Name=Attachments;
                      ShortCutKey=Shift+Ctrl+T;
                      CaptionML=[DEU=Dateianhang;
                                 ENU=Attachments;
                                 NLD=Bijlagen];
                      Promoted=Yes;
                      Image=Attachments;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowAttachments;
                                 CurrPage.CaptureUI.PAGE.UpdateDefaultImage;
                               END;
                                }
      { 1160040032;2 ;Action    ;
                      Name=Dimensions;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions;
                                 NLD=Dimensies;
                                 SVE=Dimensioner];
                      Promoted=Yes;
                      Enabled=EnableActions;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 LookupDimensions(TRUE);
                               END;
                                }
      { 1160040035;2 ;Action    ;
                      Name=Attendees;
                      CaptionML=[DEU=Statusfilter;
                                 ENU=Attendees;
                                 NLD=Deelnemers];
                      Enabled=EnableActions;
                      Image=Users;
                      OnAction=BEGIN
                                 DrillDownAttendees;
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1160040046;2 ;Action    ;
                      Name=Extra Fields;
                      CaptionML=[DEU=ZusÑtzliche Felder;
                                 ENU=Extra Fields;
                                 NLD=Extra velden];
                      Enabled=EnableActions;
                      Image=SelectField;
                      OnAction=BEGIN
                                 LookupExtraFields(TRUE);
                               END;
                                }
      { 1160040009;2 ;Action    ;
                      Name=Details;
                      CaptionML=[DEU=Details;
                                 ENU=Details;
                                 NLD=Details;
                                 SVE=Detaljer];
                      RunObject=Page 6086372;
                      RunPageLink=Mileage Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Enabled=EnableActions;
                      Image=Split;
                      PromotedCategory=Category4 }
      { 1160040070;2 ;Separator  }
      { 1160040022;2 ;Action    ;
                      Name=Approvals;
                      CaptionML=[DEU=Genehmigungen;
                                 ENU=Approvals;
                                 NLD=Goedkeuringen;
                                 SVE=GodkÑnnanden];
                      Enabled=EnableActions;
                      Image=Approvals;
                      OnAction=BEGIN
                                 EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Mileage,FORMAT("Entry No."));
                               END;
                                }
      { 1160040021;1 ;ActionGroup;
                      Name=Functions;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions;
                                 NLD=F&unctie;
                                 SVE=F&unktion] }
      { 1160040066;2 ;Action    ;
                      Name=Reopen;
                      CaptionML=[DEU=Stat&us zurÅcksetzen;
                                 ENU=Re&open;
                                 NLD=Heropenen;
                                 SVE=&ôppna igen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Mileage@1160040004 : Record 6086338;
                                 Question@1160040002 : Text[1024];
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Mileage);
                                 IF Mileage.COUNT = 1 THEN
                                   Question := STRSUBSTNO(ConfirmReopenSingle,1)
                                 ELSE
                                   Question := STRSUBSTNO(ConfirmReopenMultiple,Mileage.COUNT);

                                 IF NOT CONFIRM(Question,TRUE) THEN
                                   EXIT;

                                 IF Mileage.FINDSET(TRUE,FALSE) THEN
                                   REPEAT
                                     CODEUNIT.RUN(CODEUNIT::"Mileage - Complete",Mileage);
                                   UNTIL Mileage.NEXT = 0;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040060;2 ;Action    ;
                      Name=Send to Expense User;
                      ShortCutKey=Shift+Ctrl+X;
                      CaptionML=[DEU=An &Ausgabenbenutzer senden;
                                 ENU=Send to E&xpense User;
                                 NLD=Verzenden naar gebruiker];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendTo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Mileage@1160040005 : Record 6086338;
                                 NoOfMilSelected@1160040003 : Integer;
                                 NoOfMilSent@1160040002 : Integer;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Mileage);
                                 NoOfMilSelected := Mileage.COUNT;
                                 IF Mileage.COUNT > 1 THEN
                                   IF NOT CONFIRM(ConfirmSendToMultipleUsers,TRUE,Mileage.COUNT) THEN
                                     EXIT;

                                 IF Mileage.COUNT = 1 THEN
                                   CODEUNIT.RUN(CODEUNIT::"Mileage-Send to Expense User",Rec)
                                 ELSE BEGIN
                                   Mileage.FINDSET(TRUE,FALSE);
                                   REPEAT
                                     COMMIT;
                                     IF CODEUNIT.RUN(CODEUNIT::"Mileage-Send to Expense User",Mileage) THEN
                                       NoOfMilSent += 1;
                                   UNTIL Mileage.NEXT = 0;

                                   MESSAGE(NoOfExpSentToExpUserMsg,NoOfMilSent,NoOfMilSelected);
                                 END;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040057;2 ;Action    ;
                      Name=Send for &Approval;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[DEU=Zur &Genehmigung senden;
                                 ENU=Send for &Approval;
                                 NLD=Verzend ter goedkeuring;
                                 SVE=Skicka fîr godkÑnnande];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Mileage@1160040002 : Record 6086338;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Mileage);
                                 EMApprovalsBridge.SendMilApprovalRequest(Mileage);
                                 SetStatusFilter;
                               END;
                                }
      { 1160040055;2 ;Action    ;
                      Name=Force Approval;
                      CaptionML=[DEU=G&enehmigung erzwingen;
                                 ENU=&Force Approval;
                                 NLD=&Forceer goedkeuring;
                                 SVE=Tvinga godkÑnnande];
                      Promoted=Yes;
                      Image=Approval;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Mileage@1160040003 : Record 6086338;
                                 Question@1160040002 : Text[1024];
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Mileage);
                                 IF Mileage.COUNT = 1 THEN
                                   Question := STRSUBSTNO(ContForceReleaselSingle)
                                 ELSE
                                   Question := STRSUBSTNO(ConfirmForceReleaseMultiple,Mileage.COUNT);

                                 IF NOT CONFIRM(Question,TRUE) THEN
                                   EXIT;

                                 IF Mileage.FINDSET(TRUE,FALSE) THEN
                                   REPEAT
                                     Mileage.TESTFIELD(Status,Mileage.Status::Open);
                                     EMApprovalsBridge.CancelApprovalRequest(DATABASE::Mileage,FORMAT(Mileage."Entry No."));
                                     EMApprovalsBridge.ForceApproval(DATABASE::Mileage,FORMAT(Mileage."Entry No."));
                                   UNTIL Mileage.NEXT = 0;

                                 SetStatusFilter;
                               END;
                                }
      { 1160040038;2 ;Separator  }
      { 1160040031;2 ;Action    ;
                      Name=Forward Approval;
                      Ellipsis=Yes;
                      CaptionML=[DEU=&Genehmigung weiterleiten;
                                 ENU=&Forward Approval;
                                 NLD=Doorsturen goedkeuring;
                                 SVE=Vidarebefordra godkÑnnande];
                      Image=Delegate;
                      OnAction=BEGIN
                                 EMApprovalsBridge.Forward(DATABASE::Mileage,FORMAT("Entry No."));
                                 SetStatusFilter;
                               END;
                                }
      { 1160040067;2 ;Separator  }
      { 1160040043;2 ;Action    ;
                      Name=Add to Settlement;
                      CaptionML=[DEU=Dem Ausgleich hinzufÅgen;
                                 ENU=Add to Settlement;
                                 NLD=Voeg toe aan afrekening];
                      Image=Add;
                      OnAction=VAR
                                 Mileage@1160040000 : Record 6086338;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Mileage);
                                 AttachMilToSettlement(Mileage);
                               END;
                                }
      { 1160040040;2 ;Separator  }
      { 1160040068;2 ;Action    ;
                      Name=Synchronize;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[DEU=Synchronisieren;
                                 ENU=Synchronize;
                                 NLD=Synchroniseer;
                                 SVE=Synkronisera];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"EM Online Mgt.");

                                 CheckUnProcessedInbox;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1160040053;2 ;Separator  }
      { 1160040050;2 ;Action    ;
                      Name=Send Reminder E-mail;
                      CaptionML=[DEU=Erinnerungs-E-Mail senden;
                                 ENU=Send Reminder &E-mail;
                                 NLD=Verzend herinneringse-mail];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendConfirmation;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 Mileage@1160040002 : Record 6086338;
                                 ReminderEmail@1160040003 : Codeunit 6086314;
                                 OptionNo@1160040001 : Integer;
                               BEGIN
                                 OptionNo := STRMENU(Options,1,Instructions);

                                 IF OptionNo = 0 THEN
                                   EXIT;

                                 IF OptionNo = 2 THEN
                                   CurrPage.SETSELECTIONFILTER(Mileage)
                                 ELSE
                                   Mileage.RESET;

                                 ReminderEmail.SendMilNotificationEmails(Mileage,OptionNo = 2);
                               END;
                                }
      { 1160040020;2 ;Action    ;
                      Name=Move to another company;
                      CaptionML=[DEU=Zu anderem Unternehmen verschieben;
                                 ENU=Move to another company;
                                 NLD=Verplaats naar een ander bedrijf];
                      Image=Intercompany;
                      OnAction=VAR
                                 MoveToCompany@1160040000 : Codeunit 6086359;
                                 RecRef@1160040002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 MoveToCompany.HandleMovement(RecRef);

                                 IF ISEMPTY THEN
                                   CurrPage.CaptureUI.PAGE.ClearImage;
                               END;
                                }
      { 1160040058;1 ;ActionGroup;
                      Name=Posting;
                      CaptionML=[DEU=Bu&chung;
                                 ENU=P&osting;
                                 NLD=Boeken;
                                 SVE=B&okfîring] }
      { 1160040059;2 ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[DEU=Buchungsvorschlag erstellen;
                                 ENU=P&ost;
                                 NLD=B&oeken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewInvoice;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Mileage@1160040005 : Record 6086338;
                               BEGIN
                                 Mileage := Rec;
                                 CODEUNIT.RUN(CODEUNIT::"Mileage-Post (Yes/No)",Mileage);
                                 CurrPage.UPDATE(FALSE);

                                 IF ISEMPTY THEN
                                   CurrPage.CaptureUI.PAGE.ClearImage;
                               END;
                                }
      { 1160040030;2 ;Action    ;
                      Name=Post Batch;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Batch-Erstellung Buchungsvorschlag;
                                 ENU=Post &Batch;
                                 NLD=B&atchboeken];
                      Promoted=Yes;
                      Image=PostBatch;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Mileage",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);

                                 IF ISEMPTY THEN
                                   CurrPage.CaptureUI.PAGE.ClearImage;
                               END;
                                }
      { 6086300 ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[DEU=Buchungsvorschau;
                                 ENU=Preview Posting;
                                 NLD=Boekingsvoorbeeld];
                      Promoted=No;
                      Enabled=EnablePostingPreview;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 Mileage@6086301 : Record 6086338;
                                 MileagePostYesNo@6086300 : Codeunit 6086351;
                               BEGIN
                                 Mileage := Rec;
                                 MileagePostYesNo.Preview(Mileage);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                ContainerType=ContentArea }

    { 1160040000;1;Group  ;
                GroupType=Repeater }

    { 1160040024;2;Field  ;
                Name=EntryNo;
                SourceExpr="Entry No.";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040042;2;Field  ;
                Name=HasComments;
                CaptionML=[DEU=Bemerkung;
                           ENU=Comment;
                           NLD=Opmerking;
                           SVE=Kommentar];
                SourceExpr=HasComments;
                Editable=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040003;2;Field  ;
                Name=ContiniaUserID;
                SourceExpr="Continia User ID";
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           UserResp@1160040002 : Record 6086379;
                         BEGIN
                           EXIT(UserResp.LookupUser(Text));
                         END;
                          }

    { 1160040071;2;Field  ;
                Name=ContiniaUserName;
                SourceExpr="Continia User Name";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040026;2;Field  ;
                Name=RegistrationDate;
                SourceExpr="Registration Date";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040029;2;Field  ;
                Name=SettlementNo;
                SourceExpr="Settlement No.";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040025;2;Field  ;
                Name=Description;
                SourceExpr=Description;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040056;2;Field  ;
                Name=NoofAttachments;
                SourceExpr="No. of Attachments";
                Visible=false }

    { 1160040062;2;Field  ;
                Name=AttendeesDisplayText;
                CaptionML=[DEU=Statusfilter;
                           ENU=Attendees;
                           NLD=Deelnemers];
                SourceExpr=GetAttendeesForDisplay;
                Importance=Additional;
                OnDrillDown=BEGIN
                              DrillDownAttendees;
                              CurrPage.UPDATE(TRUE);
                            END;
                             }

    { 1160040045;2;Field  ;
                Name=Status;
                SourceExpr=Status;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040069;2;Field  ;
                Name=OnHold;
                SourceExpr="On Hold";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040037;2;Field  ;
                Name=ApprovalBy;
                CaptionML=[DEU=Genehmigung durch;
                           ENU=Approval by;
                           NLD=Goedkeuring door;
                           SVE=GodkÑnnande av];
                SourceExpr=EMApprovalMgt.GetNextApproverName(DATABASE::Mileage,FORMAT("Entry No."));
                Style=Attention;
                StyleExpr=StyleFormat;
                OnDrillDown=BEGIN
                              EMApprovalMgt.DrillDownApprovalEntries(DATABASE::Mileage,FORMAT("Entry No."));
                            END;
                             }

    { 1160040011;2;Field  ;
                Name=FromAddress;
                SourceExpr="From Address";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040034;2;Field  ;
                Name=ToAddress;
                SourceExpr="To Address";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040017;2;Field  ;
                Name=VehicleCode;
                SourceExpr="Vehicle Code";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040054;2;Field  ;
                Name=VehicleRegistrationNo;
                SourceExpr="Vehicle Registration No.";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040072;2;Field  ;
                Name=TotalDistance;
                SourceExpr="Total Distance";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040015;2;Field  ;
                Name=CalculatedDistance;
                SourceExpr="Calculated Distance";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040073;2;Field  ;
                Name=Amount(LCY);
                SourceExpr="Amount (LCY)";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040074;2;Field  ;
                Name=NoRefund;
                SourceExpr="No Refund";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040007;2;Field  ;
                Name=ReimbursementMethod;
                SourceExpr="Reimbursement Method";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040001;2;Field  ;
                Name=GlobalDimension1Code;
                SourceExpr="Global Dimension 1 Code";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040002;2;Field  ;
                Name=GlobalDimension2Code;
                SourceExpr="Global Dimension 2 Code";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040064;2;Field  ;
                Name=JobNo;
                SourceExpr="Job No.";
                Visible=JobNoVisible;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040065;2;Field  ;
                Name=JobTaskNo;
                SourceExpr="Job Task No.";
                Visible=JobNoVisible;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040036;2;Field  ;
                Name=Billable;
                SourceExpr=Billable;
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040039;2;Field  ;
                Name=JobLineType;
                SourceExpr="Job Line Type";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=TRUE }

    { 1160040005;2;Field  ;
                Name=TravelTime;
                SourceExpr="Travel Time";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040076;2;Field  ;
                SourceExpr="Admin Comment";
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040004;2;Field  ;
                Name=ShortcutFieldValues1;
                SourceExpr=ShortcutFieldValues[1];
                CaptionClass=GetShortcutFieldCaption(1);
                Visible=CustomfieldVisible1;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(1,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[1]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(1,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040006;2;Field  ;
                Name=ShortcutFieldValues2;
                SourceExpr=ShortcutFieldValues[2];
                CaptionClass=GetShortcutFieldCaption(2);
                Visible=CustomfieldVisible2;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(2,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[2]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(2,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040008;2;Field  ;
                Name=ShortcutFieldValues3;
                SourceExpr=ShortcutFieldValues[3];
                CaptionClass=GetShortcutFieldCaption(3);
                Visible=CustomfieldVisible3;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(3,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[3]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(3,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040010;2;Field  ;
                Name=ShortcutFieldValues4;
                SourceExpr=ShortcutFieldValues[4];
                CaptionClass=GetShortcutFieldCaption(4);
                Visible=CustomfieldVisible4;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(4,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[4]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(4,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040012;2;Field  ;
                Name=ShortcutFieldValues5;
                SourceExpr=ShortcutFieldValues[5];
                CaptionClass=GetShortcutFieldCaption(5);
                Visible=CustomfieldVisible5;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(5,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[5]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(5,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040014;2;Field  ;
                Name=ShortcutFieldValues6;
                SourceExpr=ShortcutFieldValues[6];
                CaptionClass=GetShortcutFieldCaption(6);
                Visible=CustomfieldVisible6;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(6,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[6]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(6,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040016;2;Field  ;
                Name=ShortcutFieldValues7;
                SourceExpr=ShortcutFieldValues[7];
                CaptionClass=GetShortcutFieldCaption(7);
                Visible=CustomfieldVisible7;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(7,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[7]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(7,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040018;2;Field  ;
                Name=ShortcutFieldValues8;
                SourceExpr=ShortcutFieldValues[8];
                CaptionClass=GetShortcutFieldCaption(8);
                Visible=CustomfieldVisible8;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(8,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[8]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(8,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040019;2;Field  ;
                Name=ShortcutFieldValues9;
                SourceExpr=ShortcutFieldValues[9];
                CaptionClass=GetShortcutFieldCaption(9);
                Visible=CustomfieldVisible9;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(9,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[9]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(9,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040023;2;Field  ;
                Name=ShortcutFieldValues10;
                SourceExpr=ShortcutFieldValues[10];
                CaptionClass=GetShortcutFieldCaption(10);
                Visible=CustomfieldVisible10;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnValidate=BEGIN
                             ShortcutFieldFunctions.ValidateShortcutFieldValue(10,DATABASE::Mileage,0,'',"Entry No.",ShortcutFieldValues[10]);
                             SendToExpenseUser;
                           END;

                OnLookup=BEGIN
                           EXIT(ShortcutFieldFunctions.LookupShortcutFieldValue(10,DATABASE::Mileage,0,'',"Entry No.",FALSE,Text));
                         END;
                          }

    { 1160040013;2;Field  ;
                Name=CurrentReminderLevel;
                SourceExpr="Current Reminder Level";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040052;2;Field  ;
                Name=MileageAccountType;
                SourceExpr="Mileage Account Type";
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 12  ;2   ;Field     ;
                Name=MileageAccount;
                Lookup=Yes;
                SourceExpr="Mileage Account";
                Visible=False;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040044;2;Field  ;
                Name=GenProdPostingGroup;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040047;2;Field  ;
                Name=VATProdPostingGroup;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040048;2;Field  ;
                Name=GenBusPostingGroup;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040049;2;Field  ;
                Name=VATBusPostingGroup;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 13  ;2   ;Field     ;
                Name=MilAccountManuallyChanged;
                SourceExpr="Mil. Account Manually Changed";
                Visible=False;
                Style=Attention;
                StyleExpr=StyleFormat }

    { 1160040051;2;Field  ;
                Name=NextReminder;
                CaptionML=[DEU=NÑchste Erinnerung;
                           ENU=Next Reminder;
                           NLD=Volgende herinnering];
                SourceExpr=NextReminderDate;
                Visible=false;
                Style=Attention;
                StyleExpr=StyleFormat;
                OnDrillDown=BEGIN
                              ShowReminders;
                            END;
                             }

    { 1160040027;2;Field  ;
                Name=ResponsefromDataloen;
                SourceExpr="Response from Dataloen";
                Visible=false }

    { 1160040063;2;Field  ;
                Name=ExternalPostingAccountType;
                SourceExpr="External Posting Account Type";
                Visible=FALSE }

    { 1160040075;2;Field  ;
                Name=ExternalPostingAccountNo;
                SourceExpr="External Posting Account No.";
                Visible=FALSE;
                OnLookup=BEGIN
                           EXIT(LookupExternalPostingAccount(Text));
                         END;
                          }

    { 1160040041;1;Part   ;
                Name=Expense Comment Subpage;
                SubPageLink=Doc. Ref. No.=FIELD(Entry No.),
                            Table ID=CONST(6086338);
                PagePartID=Page6086361;
                Editable=false;
                PartType=Page }

    { 2   ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 1   ;1   ;Part      ;
                Name=CaptureUI;
                CaptionML=[DEU=Dateianhang;
                           ENU=Attachments;
                           NLD=Bijlagen;
                           SVE=Bilagor];
                SubPageLink=Entry No.=FIELD(Entry No.);
                PagePartID=Page6086357;
                PartType=Page }

  }
  CODE
  {
    VAR
      ShortcutFieldFunctions@1160040010 : Codeunit 6086304;
      EMApprovalMgt@1160040000 : Codeunit 6086312;
      EMApprovalsBridge@1000 : Codeunit 6086369;
      CustomFieldNames@1160040006 : ARRAY [10] OF Text[50];
      ShortcutFieldCaptions@1160040001 : ARRAY [10] OF Text[250];
      ShortcutFieldValues@1160040002 : ARRAY [10] OF Text[250];
      StatusFilter@1160040004 : 'All,Open,PendingExpUser,PendingApproval,Released,ReadyToInvoice';
      CustomFieldVisible1@1160040005 : Boolean INDATASET;
      CustomFieldVisible10@1009 : Boolean INDATASET;
      CustomFieldVisible2@1001 : Boolean INDATASET;
      CustomFieldVisible3@1002 : Boolean INDATASET;
      CustomFieldVisible4@1003 : Boolean INDATASET;
      CustomFieldVisible5@1004 : Boolean INDATASET;
      CustomFieldVisible6@1005 : Boolean INDATASET;
      CustomFieldVisible7@1006 : Boolean INDATASET;
      CustomFieldVisible8@1007 : Boolean INDATASET;
      CustomFieldVisible9@1008 : Boolean INDATASET;
      EnableActions@1010 : Boolean INDATASET;
      EnablePostingPreview@6086301 : Boolean INDATASET;
      HasComments@1160040019 : Boolean;
      JobNoVisible@1160040011 : Boolean INDATASET;
      StyleFormat@1160040003 : Text[30] INDATASET;
      ConfirmForceReleaseMultiple@1160040008 : TextConst 'DEU=Dies erzwingt die Genehmigung der Kilometerleistung %1.\\Mîchten Sie fortfahren?;ENU=This will force the approval of %1 mileage.\\Do you want to continue?;NLD=%1 kilometrages worden geforceerd goedgekeurd.\\Wilt u doorgaan?';
      ConfirmReopenMultiple@1160040028 : TextConst 'DEU=Dadurch wird die Kilometerleistung %1 erneut geîffnet.\\Mîchten Sie fortfahren?;ENU=This will reopen %1 mileage.\\Do you want to continue?;NLD=%1 kilometrage worden heropend.\\Wilt u doorgaan?';
      ConfirmReopenSingle@1160040029 : TextConst 'DEU=Mîchten Sie die Kilometerleistung erneut îffnen?;ENU=Do you want to reopen the mileage?;NLD=Wilt u de kilometrage heropenen?';
      ConfirmSendToMultipleUsers@1160040027 : TextConst 'DEU=Dies sendet die Kilometerleistung %1 an den Ausgabenbenutzer.\\Mîchten Sie fortfahren?;ENU=This will send %1 mileage to the expense user.\\Do you want to continue?;NLD=%1 kilometrage worden verzonden naar de gebruiker.\\Wilt u doorgaan?';
      ContForceReleaselSingle@1160040007 : TextConst 'DEU=Mîchten Sie die Genehmigung dieser Kilometerleistung erzwingen?;ENU=Do you want to force the approval of this mileage?;NLD=Wilt u de goedkeuring van deze kilometrage forceren?';
      Instructions@1160040009 : TextConst 'DEU=Mîchten Sie eine Status-E-Mail an alle oder nur an die ausgewÑhlten Benutzer senden?;ENU=Do you want to send a status e-mail to all the Users or only to the selected ones?;NLD=Wilt u een status e-mail verzenden aan alle gebruikers of alleen aan de geselecteerde gebruikers?';
      NoOfExpSentToExpUserMsg@1160040017 : TextConst 'DEU=%1 von %2 an Ausgabenbenutzer gesendet.;ENU=%1 out of %2 sent to expense users.;NLD=%1 van %2 verzonden naar gebruikers.';
      Options@1160040015 : TextConst 'DEU=An alle Benutzer senden, Nur an ausgewÑhlte Benutzer senden (erzwungen);ENU=Send to All Users,Send to Selected Users only (forced);NLD=Verzend naar alle gebruikers,Verzend naar geselecteerde gebruikers (geforceerd)';

    LOCAL PROCEDURE SetStatusFilter@5();
    VAR
      PrevEntryNo@1160040000 : Integer;
    BEGIN
      PrevEntryNo := "Entry No.";

      FILTERGROUP(2);

      SETRANGE(Posted,FALSE);

      CASE StatusFilter OF
        StatusFilter::All:
          SETRANGE(Status);
        StatusFilter::ReadyToInvoice:
          BEGIN
            SETRANGE(Status,Status::Released);
            SETRANGE(Posted,FALSE);
          END
        ELSE
          SETRANGE(Status,StatusFilter-1);
      END;

      FILTERGROUP(0);

      SETRANGE("Entry No.",PrevEntryNo);
      IF FINDFIRST THEN;
      SETRANGE("Entry No.");

      IF ISEMPTY THEN
        CurrPage.CaptureUI.PAGE.ClearImage;

      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE EnableFields@1160040003();
    VAR
      EMSetup@1160040000 : Record 6086300;
    BEGIN
      EMSetup.GET;
      CustomFieldNames[1] := EMSetup."Shortcut Field 1 Code (Mil.)";
      CustomFieldNames[2] := EMSetup."Shortcut Field 2 Code (Mil.)";
      CustomFieldNames[3] := EMSetup."Shortcut Field 3 Code (Mil.)";
      CustomFieldNames[4] := EMSetup."Shortcut Field 4 Code (Mil.)";
      CustomFieldNames[5] := EMSetup."Shortcut Field 5 Code (Mil.)";
      CustomFieldNames[6] := EMSetup."Shortcut Field 6 Code (Mil.)";
      CustomFieldNames[7] := EMSetup."Shortcut Field 7 Code (Mil.)";
      CustomFieldNames[8] := EMSetup."Shortcut Field 8 Code (Mil.)";
      CustomFieldNames[9] := EMSetup."Shortcut Field 9 Code (Mil.)";
      CustomFieldNames[10] := EMSetup."Shortcut Field 10 Code (Mil.)";

      CustomFieldVisible1 := CustomFieldNames[1] <> '';
      CustomFieldVisible2 := CustomFieldNames[2] <> '';
      CustomFieldVisible3 := CustomFieldNames[3] <> '';
      CustomFieldVisible4 := CustomFieldNames[4] <> '';
      CustomFieldVisible5 := CustomFieldNames[5] <> '';
      CustomFieldVisible6 := CustomFieldNames[6] <> '';
      CustomFieldVisible7 := CustomFieldNames[7] <> '';
      CustomFieldVisible8 := CustomFieldNames[8] <> '';
      CustomFieldVisible9 := CustomFieldNames[9] <> '';
      CustomFieldVisible10 := CustomFieldNames[10] <> '';

      JobNoVisible := ShortcutFieldFunctions.JobNoVisible(DATABASE::Mileage);
    END;

    LOCAL PROCEDURE GetShortcutFieldCaption@1160040001(ShortcutFieldNo@1160040000 : Integer) : Text[250];
    BEGIN
      IF ShortcutFieldCaptions[1] = '' THEN
        ShortcutFieldFunctions.GetShortcutFieldCaptionsArray(ShortcutFieldCaptions,DATABASE::Mileage);

      EXIT(ShortcutFieldCaptions[ShortcutFieldNo]);
    END;

    PROCEDURE GetSelectionFilter@1160040004(VAR Mileage@1160040000 : Record 6086338);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Mileage);
    END;

    BEGIN
    END.
  }
}

