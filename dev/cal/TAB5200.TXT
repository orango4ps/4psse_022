OBJECT Table 5200 Employee
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.03,4PS14.00,4PSSE;
  }
  PROPERTIES
  {
    Permissions=TableData 349=ri,
                TableData 11012449=r;
    DataCaptionFields=No.,First Name,Middle Name,Last Name;
    OnInsert=VAR
               ResourcesSetup@1000 : Record 314;
               Resource@1001 : Record 156;
             BEGIN
               "Last Modified Date Time" := CURRENTDATETIME;
               HumanResSetup.GET;
               IF "No." = '' THEN BEGIN
                 HumanResSetup.TESTFIELD("Employee Nos.");
                 NoSeriesMgt.InitSeries(HumanResSetup."Employee Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               IF HumanResSetup."Automatically Create Resource" THEN BEGIN
                 ResourcesSetup.GET;
                 Resource.INIT;
                 IF NoSeriesMgt.ManualNoAllowed(ResourcesSetup."Resource Nos.") THEN BEGIN
                   Resource."No." := "No.";
                   Resource.INSERT(TRUE);
                 END ELSE
                   Resource.INSERT(TRUE);
                 "Resource No." := Resource."No.";
               END;

               DimMgt.UpdateDefaultDim(
                 DATABASE::Employee,"No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code");
               UpdateSearchName;

               //**4PS.sn
               HumanResSetup.GET;
               IF External THEN
                 "Calculate Wage Costs" := "Calculate Wage Costs"::"Fixed Rate"
               ELSE
                 "Calculate Wage Costs" := HumanResSetup."Calculate Wage Costs";
               IF NOT SkipAccHoursDefaultOnInsert THEN
                 "Account Hours" := HumanResSetup."Default Account Hours";
               "Show in Hours Portal" := HumanResSetup."Show in Hours Portal";
               IF NOT InsertFromContact THEN
                 InsertNewContact(Rec);

               ExchangeFSA('I');

               //**4PS Generated Code. Do Not Change.sn05
               DPA_OnInsert;
               //**4PS Generated Code.en05

               ProjectSiteMgt.LogEmployee(1, Rec);
               //**4PS.en
             END;

    OnModify=BEGIN
               "Last Modified Date Time" := CURRENTDATETIME;
               UpdateSearchName;

               //**4PS.sn
               IF External THEN
                 "Calculate Wage Costs" := "Calculate Wage Costs"::"Fixed Rate";

               IF (External <> xRec.External) OR ("Calculate Wage Costs" <> xRec."Calculate Wage Costs") THEN BEGIN
                 HoursAccLineRec.SETRANGE("Employee No.","No.");
                 HoursAccLineRec.MODIFYALL(External,External);
                 HoursAccLineRec.MODIFYALL("Calculate Wage Costs", "Calculate Wage Costs");
                 HoursAccLineRec.RESET;
               END;

               UpdateDimension(FALSE);
               OnModifyRelation(Rec, xRec);
               CheckExportToFSA(0);
               ExchangeFSA('M');

               ProjectSiteMgt.LogEmployee(2, Rec);
               UpdateResource(1, xRec, Rec);  //DP00465  1=Modify
               //**4PS.en
             END;

    OnDelete=VAR
               ProjPlanTeamResourceRec@1100485010 : Record 11012440;
               lEmplCostPriceRec@1100485001 : Record 11020315;
               lEmplCostObjCostPriceRec@1100485000 : Record 11020259;
               lEmpCostObjWageSalesPriceRec@1100525000 : Record 11020378;
               lEmpCostObjSalesPriceRec@1100525001 : Record 11020377;
               AssignedActivityCapacity@1100528400 : Record 11125710;
               SDWorxCobraIDAssociation@1100528500 : Record 11012389;
               EmployeeExtension@1100528100 : Record 11229470;
             BEGIN
               //**4PS.sn
               AssignedActivityCapacity.SETCURRENTKEY("Resource Type", "Resource Code");
               AssignedActivityCapacity.SETRANGE("Resource Type", AssignedActivityCapacity."Resource Type"::Employee);
               AssignedActivityCapacity.SETRANGE("Resource Code", "No.");
               IF NOT AssignedActivityCapacity.ISEMPTY THEN
                 ERROR(Text11012014, TABLECAPTION, "No.", AssignedActivityCapacity.TABLECAPTION);

               SDWorxCobraIDAssociation.SETRANGE(Type, SDWorxCobraIDAssociation.Type::Person);
               SDWorxCobraIDAssociation.SETRANGE("NAV No.", "No.");
               IF SDWorxCobraIDAssociation.FINDSET THEN
                 SDWorxCobraIDAssociation.DELETEALL;
               //**4PS.en

               AlternativeAddr.SETRANGE("Employee No.","No.");
               AlternativeAddr.DELETEALL;

               EmployeeQualification.SETRANGE("Employee No.","No.");
               EmployeeQualification.DELETEALL;

               Relative.SETRANGE("Employee No.","No.");
               Relative.DELETEALL;

               EmployeeAbsence.SETRANGE("Employee No.","No.");
               EmployeeAbsence.DELETEALL;

               MiscArticleInformation.SETRANGE("Employee No.","No.");
               MiscArticleInformation.DELETEALL;

               ConfidentialInformation.SETRANGE("Employee No.","No.");
               ConfidentialInformation.DELETEALL;

               HumanResComment.SETRANGE("No.","No.");
               HumanResComment.DELETEALL;

               //**4PS.sn
               UpdateDimension(TRUE);

               OnDeleteRelation(Rec);

               HourAccRec.SETRANGE("Employee No.","No.");
               HourAccRec.DELETEALL;

               HoursAccLineRec.SETRANGE("Employee No.","No.");
               HoursAccLineRec.DELETEALL;

               IF FPSLicenseManagement.LicenseAndReadPermissionForTable(EmplTimeTableRec) THEN BEGIN
                 EmplTimeTableRec.SETRANGE("Employee No.", "No.");
                 EmplTimeTableRec.DELETEALL;
               END;

               lEmplCostPriceRec.SETRANGE("Employee No.", "No.");
               lEmplCostPriceRec.DELETEALL;

               lEmplCostObjCostPriceRec.SETRANGE("Employee No.", "No.");
               lEmplCostObjCostPriceRec.DELETEALL;

               lEmpCostObjSalesPriceRec.SETRANGE("Employee No.", "No.");
               lEmpCostObjSalesPriceRec.DELETEALL;

               lEmpCostObjWageSalesPriceRec.SETRANGE("Employee No.", "No.");
               lEmpCostObjWageSalesPriceRec.DELETEALL;
               ProjPlanTeamResourceRec.SETCURRENTKEY("Resource Code");
               ProjPlanTeamResourceRec.SETRANGE("Resource Type", ProjPlanTeamResourceRec."Resource Type"::Employee);
               ProjPlanTeamResourceRec.SETRANGE("Resource Code", "No.");
               ProjPlanTeamResourceRec.DELETEALL;

               ExchangeFSA('D');
               ProjectSiteMgt.LogEmployee(3, Rec);
               UpdateResource(2, xRec, Rec);  //DP00465  2=Delete
               //**4PS.en
               DimMgt.DeleteDefaultDim(DATABASE::Employee,"No.");

               //**4PS.sn
               IF EmployeeExtension.GET("No.") THEN
                 EmployeeExtension.DELETE(TRUE);
               //**4PS.en
             END;

    OnRename=VAR
               DocumentProperties@1100525000 : Record 11012746;
             BEGIN
               DimMgt.RenameDefaultDim(DATABASE::Employee,xRec."No.","No.");
               "Last Modified Date Time" := CURRENTDATETIME;
               "Last Date Modified" := TODAY;
               UpdateSearchName;

               //**4PS.sn
               DocumentProperties.HandleRenameofEmployee(COMPANYNAME,xRec."No.","No.");
               ExchangeFSA('R');

               UpdateResource(3, xRec, Rec);
               RenameSiteMgtHoursEmployeeNo;
               //**4PS.en
             END;

    CaptionML=[ENU=Employee;
               NOR=Ansatt;
               SVE=Personal];
    LookupPageID=Page5201;
    DrillDownPageID=Page5201;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   OnValidate=VAR
                                                                lvEmpl@1100485000 : Record 5200;
                                                              BEGIN
                                                                IF NoChangedAsResultOfFiltering THEN //**4PS.n
                                                                  EXIT;                              //**4PS.n

                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  HumanResSetup.GET;
                                                                  NoSeriesMgt.TestManual(HumanResSetup."Employee Nos.");
                                                                  "No. Series" := '';

                                                                  //**4PS.sn
                                                                  UpdateDimension(TRUE);
                                                                  UpdateDimension(FALSE);

                                                                  lvEmpl := xRec;
                                                                  IF (lvEmpl."No." <> '') AND (lvEmpl.FIND) THEN
                                                                    OnRenameRelation(Rec, xRec);
                                                                  //**4PS.en
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.;
                                                              SVE=Nr] }
    { 2   ;   ;First Name          ;Text30        ;OnValidate=BEGIN
                                                                ContactDataValidation.ValidateName("First Name"); //**4PS.n

                                                                FillFullName(); //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=First Name;
                                                              NOR=Fornavn;
                                                              SVE=Tilltalsnamn] }
    { 3   ;   ;Middle Name         ;Text30        ;TableRelation="Middle Name";
                                                   OnValidate=BEGIN
                                                                FillFullName(); //**4PS.n
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Middle Name;
                                                              NOR=Mellomnavn;
                                                              SVE=Andra namn] }
    { 4   ;   ;Last Name           ;Text30        ;OnValidate=BEGIN
                                                                //**4PS.sn
                                                                ContactDataValidation.ValidateName("Last Name");

                                                                FillFullName();

                                                                IF ("Search Name" = UPPERCASE(xRec."Last Name")) OR ("Search Name" = '') THEN
                                                                  "Search Name" := "Last Name";
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Last Name;
                                                              NOR=Etternavn;
                                                              SVE=Efternamn] }
    { 5   ;   ;Initials            ;Text30        ;OnValidate=BEGIN
                                                                ContactDataValidation.ValidateInitials(Initials); //**4PS.n

                                                                IF ("Search Name" = UPPERCASE(xRec.Initials)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Initials;

                                                                FillFullName(); //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Initials;
                                                              NOR=Initialer;
                                                              SVE=Initialer] }
    { 6   ;   ;Job Title           ;Text50        ;CaptionML=[ENU=Job Title;
                                                              NOR=Stilling;
                                                              SVE=Yrkestitel] }
    { 7   ;   ;Search Name         ;Code250       ;OnValidate=BEGIN
                                                                IF "Search Name" = '' THEN
                                                                  "Search Name" := SetSearchNameToFullnameAndInitials;
                                                              END;

                                                   CaptionML=[ENU=Search Name;
                                                              NOR=Sõkenavn;
                                                              SVE=Sîknamn] }
    { 8   ;   ;Address             ;Text100       ;CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress] }
    { 9   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2;
                                                              SVE=Adress 2] }
    { 10  ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode(City,"Post Code",County,"Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Sted;
                                                              SVE=Ort] }
    { 11  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);

                                                                CheckPostCodeHouseNo; //**4PS.n
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode(City,"Post Code",County,"Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr.;
                                                              SVE=Postnr] }
    { 12  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              NOR=Fylke/delstat;
                                                              SVE=Delstat];
                                                   CaptionClass='5,1,' + "Country/Region Code" }
    { 13  ;   ;Phone No.           ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Phone No."); //**4PS.n
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              NOR=Telefonnr.;
                                                              SVE=Telefonnr] }
    { 14  ;   ;Mobile Phone No.    ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Mobile Phone No."); //**4PS.n
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Mobile Phone No.;
                                                              NOR=Telefonnr. mobil;
                                                              SVE=Mobiltelefonnr] }
    { 15  ;   ;E-Mail              ;Text80        ;OnValidate=VAR
                                                                MailManagement@1000 : Codeunit 9520;
                                                                RecRef@1100528700 : RecordRef;
                                                                FldRef@1100528701 : FieldRef;
                                                              BEGIN
                                                                MailManagement.ValidateEmailAddressField("E-Mail");

                                                                //**4PS.sn
                                                                RecRef.GETTABLE(Rec);
                                                                FldRef := RecRef.FIELD(FIELDNO("E-Mail"));
                                                                ContactDataValidation.ValidateEmail(FldRef, "E-Mail");
                                                                //**4PS.en
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 16  ;   ;Alt. Address Code   ;Code10        ;TableRelation="Alternative Address".Code WHERE (Employee No.=FIELD(No.));
                                                   CaptionML=[ENU=Alt. Address Code;
                                                              NOR=Alt. adressekode;
                                                              SVE=Alt. adresskod] }
    { 17  ;   ;Alt. Address Start Date;Date       ;CaptionML=[ENU=Alt. Address Start Date;
                                                              NOR=Alt. adresse startdato;
                                                              SVE=Alt. adress startdatum] }
    { 18  ;   ;Alt. Address End Date;Date         ;CaptionML=[ENU=Alt. Address End Date;
                                                              NOR=Alt. adresse sluttdato;
                                                              SVE=Alt. adress slutdatum] }
    { 19  ;   ;Picture             ;BLOB          ;ObsoleteState=Pending;
                                                   ObsoleteReason=Replaced by Image field;
                                                   CaptionML=[ENU=Picture;
                                                              NOR=Foto;
                                                              SVE=Foto];
                                                   SubType=Bitmap }
    { 20  ;   ;Birth Date          ;Date          ;OnValidate=VAR
                                                                RecRef@1100528700 : RecordRef;
                                                                FldRef@1100528701 : FieldRef;
                                                              BEGIN
                                                                //**4PS.sn
                                                                RecRef.GETTABLE(Rec);
                                                                FldRef := RecRef.FIELD(FIELDNO("Birth Date"));
                                                                ContactDataValidation.ValidateBirthDate(FldRef);
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Birth Date;
                                                              NOR=Fõdselsdato;
                                                              SVE=Fîdelsedatum] }
    { 21  ;   ;Social Security No. ;Text30        ;CaptionML=[ENU=Social Security No.;
                                                              NOR=Personnr.;
                                                              SVE=Personnr] }
    { 22  ;   ;Union Code          ;Code10        ;TableRelation=Union;
                                                   CaptionML=[ENU=Union Code;
                                                              NOR=Fagforeningskode;
                                                              SVE=Fackfîreningskod] }
    { 23  ;   ;Union Membership No.;Text30        ;CaptionML=[ENU=Union Membership No.;
                                                              NOR=Fagforening medlemsnr.;
                                                              SVE=Medlemsnr fackfîrening] }
    { 24  ;   ;Gender              ;Option        ;CaptionML=[ENU=Gender;
                                                              NOR=Kjõnn;
                                                              SVE=Kîn];
                                                   OptionCaptionML=[ENU=" ,Female,Male";
                                                                    NOR=" ,Kvinne,Mann";
                                                                    SVE=" ,Kvinna,Man"];
                                                   OptionString=[ ,Female,Male] }
    { 25  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                PostCode.CheckClearPostCodeCityCounty(City,"Post Code",County,"Country/Region Code",xRec."Country/Region Code");
                                                              END;

                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/omrÜdekode;
                                                              SVE=Lands-/regionkod] }
    { 26  ;   ;Manager No.         ;Code20        ;TableRelation=Employee;
                                                   CaptionML=[ENU=Manager No.;
                                                              NOR=Leder nr.;
                                                              SVE=Chefsnr] }
    { 27  ;   ;Emplymt. Contract Code;Code10      ;TableRelation="Employment Contract";
                                                   CaptionML=[ENU=Emplymt. Contract Code;
                                                              NOR=Ansettelseskontraktkode;
                                                              SVE=AnstÑllningskontrakt] }
    { 28  ;   ;Statistics Group Code;Code10       ;TableRelation="Employee Statistics Group";
                                                   CaptionML=[ENU=Statistics Group Code;
                                                              NOR=Statistikkgruppekode;
                                                              SVE=Statistikgrupp] }
    { 29  ;   ;Employment Date     ;Date          ;CaptionML=[ENU=Employment Date;
                                                              NOR=Ansettelsesdato;
                                                              SVE=AnstÑllningsdatum] }
    { 31  ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                EmployeeQualification.SETRANGE("Employee No.","No.");
                                                                EmployeeQualification.MODIFYALL("Employee Status",Status);
                                                                MODIFY;
                                                                //MODIFY(TRUE); //**4PS.n (db, 04-09-06: skip sql-problem between table 5200-5050; previously used to activate exchange)
                                                                //**4PS.sn
                                                                IF Status = Status::Terminated THEN
                                                                  "Account Hours" := "Account Hours"::"Not allowed";
                                                                IF Status = Status::Active THEN BEGIN
                                                                  IF "Inactive Date" <> 0D THEN
                                                                    "Inactive Date" := 0D;
                                                                  VALIDATE("Termination Date")
                                                                END ELSE BEGIN
                                                                  IF "Inactive Date" = 0D THEN
                                                                    "Inactive Date" := TODAY;
                                                                END;
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[ENU=Active,Inactive,Terminated;
                                                                    NOR=Aktiv,Inaktiv,Sluttet;
                                                                    SVE=Aktiv,Inaktiv,Avslutad];
                                                   OptionString=Active,Inactive,Terminated }
    { 32  ;   ;Inactive Date       ;Date          ;OnValidate=BEGIN
                                                                //**4PS.sn
                                                                IF Status <> Status::Active THEN BEGIN
                                                                  TESTFIELD("Inactive Date");
                                                                END ELSE BEGIN
                                                                  IF "Inactive Date" <> 0D THEN
                                                                    FIELDERROR(Status);
                                                                END;
                                                                //**4PS.sn
                                                              END;

                                                   CaptionML=[ENU=Inactive Date;
                                                              NOR=Inaktiv dato;
                                                              SVE=Inaktivitetsdatum] }
    { 33  ;   ;Cause of Inactivity Code;Code10    ;TableRelation="Cause of Inactivity";
                                                   CaptionML=[ENU=Cause of Inactivity Code;
                                                              NOR=èrsak til uvirksomhet;
                                                              SVE=Orsak till inaktivitet] }
    { 34  ;   ;Termination Date    ;Date          ;OnValidate=BEGIN
                                                                //**4PS.sn
                                                                IF Status = Status::Active THEN BEGIN
                                                                  IF ("Termination Date" < TODAY) AND ("Termination Date" <> 0D) THEN
                                                                    ERROR(Text11012018)
                                                                END;
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Termination Date;
                                                              NOR=Sluttet dato;
                                                              SVE=AvgÜngsdatum] }
    { 35  ;   ;Grounds for Term. Code;Code10      ;TableRelation="Grounds for Termination";
                                                   CaptionML=[ENU=Grounds for Term. Code;
                                                              NOR=SluttÜrsakskode;
                                                              SVE=AvgÜngskod] }
    { 36  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                IF ("Global Dimension 1 Code" = '') THEN  //**4PS.n  //DP00465.c
                                                                  CheckExportToFSA(FIELDNO("Global Dimension 1 Code"));       //**4PS.n

                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 - kode;
                                                              SVE=Global dimension 1 kod];
                                                   CaptionClass='1,1,1' }
    { 37  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                IF ("Global Dimension 2 Code" = '') THEN  //**4PS.n  //DP00465.c
                                                                  CheckExportToFSA(FIELDNO("Global Dimension 2 Code"));       //**4PS.n

                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              NOR=Global dimensjon 2 - kode;
                                                              SVE=Global dimension 2 kod];
                                                   CaptionClass='1,1,2' }
    { 38  ;   ;Resource No.        ;Code20        ;TableRelation=Resource WHERE (Type=CONST(Person));
                                                   OnValidate=BEGIN
                                                                IF ("Resource No." <> '') AND Res.WRITEPERMISSION THEN BEGIN
                                                                  CheckIfAnEmployeeIsLinkedToTheResource("Resource No.");
                                                                  EmployeeResUpdate.ResUpdate(Rec);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Resource No.;
                                                              NOR=Ressursnr.;
                                                              SVE=Resursnr] }
    { 39  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Human Resource Comment Line" WHERE (Table Name=CONST(Employee),
                                                                                                          No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 40  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den;
                                                              SVE=Uppdateringsdatum];
                                                   Editable=No }
    { 41  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter;
                                                              SVE=Datumfilter] }
    { 42  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              NOR=Filter for global dimensjon 1;
                                                              SVE=Global dimension 1 filter];
                                                   CaptionClass='1,3,1' }
    { 43  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              NOR=Filter for global dimensjon 2;
                                                              SVE=Global dimension 2 filter];
                                                   CaptionClass='1,3,2' }
    { 44  ;   ;Cause of Absence Filter;Code10     ;FieldClass=FlowFilter;
                                                   TableRelation="Cause of Absence";
                                                   CaptionML=[ENU=Cause of Absence Filter;
                                                              NOR=Filter Ürsak til fravër;
                                                              SVE=Filter fîr Orsak till frÜnvaro] }
    { 45  ;   ;Total Absence (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Employee Absence"."Quantity (Base)" WHERE (Employee No.=FIELD(No.),
                                                                                                               Cause of Absence Code=FIELD(Cause of Absence Filter),
                                                                                                               From Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Total Absence (Base);
                                                              NOR=Totalt fravër (basis);
                                                              SVE=Total frÜnvaro (bas)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 46  ;   ;Extension           ;Text30        ;CaptionML=[ENU=Extension;
                                                              NOR=Direktenr.;
                                                              SVE=Anknytning] }
    { 47  ;   ;Employee No. Filter ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Employee;
                                                   CaptionML=[ENU=Employee No. Filter;
                                                              NOR=Filter - ansattnr.;
                                                              SVE=AnstÑllningsnrfilter] }
    { 48  ;   ;Pager               ;Text30        ;CaptionML=[ENU=Pager;
                                                              NOR=Personsõker;
                                                              SVE=Personsîkare] }
    { 49  ;   ;Fax No.             ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Fax No."); //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Fax No.;
                                                              NOR=Faksnr.;
                                                              SVE=Telefaxnr] }
    { 50  ;   ;Company E-Mail      ;Text80        ;OnValidate=VAR
                                                                MailManagement@1000 : Codeunit 9520;
                                                              BEGIN
                                                                MailManagement.ValidateEmailAddressField("Company E-Mail");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Company Email;
                                                              NOR=Selskapets e-post;
                                                              SVE=Fîretag e-post] }
    { 51  ;   ;Title               ;Text30        ;OnValidate=BEGIN
                                                                FillFullName(); //**4PS.n
                                                              END;

                                                   OnLookup=VAR
                                                              TitleRecord@1100528702 : Record 11020688;
                                                              TitleList@1100528701 : Page 11125031;
                                                            BEGIN
                                                              //**4PS.sn
                                                              TitleRecord.SETRANGE("Title Behind the Name", FALSE);
                                                              TitleRecord.Title := Title;
                                                              IF TitleRecord.FIND('=') THEN
                                                                TitleList.SETRECORD(TitleRecord);
                                                              TitleList.SETTABLEVIEW(TitleRecord);
                                                              TitleList.LOOKUPMODE(TRUE);
                                                              IF TitleList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                TitleList.GETRECORD(TitleRecord);
                                                                Title := TitleRecord.Title;
                                                              END;
                                                              //**4PS.en
                                                            END;

                                                   CaptionML=[ENU=Title;
                                                              NOR=Tittel;
                                                              SVE=Titel] }
    { 52  ;   ;Salespers./Purch. Code;Code20      ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salespers./Purch. Code;
                                                              NOR=Selger/innkjõper - kode;
                                                              SVE=SÑljare/inkîpare kod] }
    { 53  ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 54  ;   ;Last Modified Date Time;DateTime   ;CaptionML=[ENU=Last Modified Date Time;
                                                              NOR=Dato/klokkeslett for siste endring;
                                                              SVE=Senast Ñndrad, datum och tid];
                                                   Editable=No }
    { 55  ;   ;Employee Posting Group;Code20      ;TableRelation="Employee Posting Group";
                                                   CaptionML=[ENU=Employee Posting Group;
                                                              NOR=Bokfõringsgruppe - ansatt;
                                                              SVE=Bokf.mall personal] }
    { 56  ;   ;Bank Branch No.     ;Text20        ;CaptionML=[ENU=Bank Branch No.;
                                                              NOR=Bankregistreringsnr.;
                                                              SVE=Bankfilialsnr] }
    { 57  ;   ;Bank Account No.    ;Text30        ;CaptionML=[ENU=Bank Account No.;
                                                              NOR=Bankkontonr.;
                                                              SVE=Bankkontonr] }
    { 58  ;   ;IBAN                ;Code50        ;OnValidate=VAR
                                                                CompanyInfo@1000 : Record 79;
                                                              BEGIN
                                                                CompanyInfo.CheckIBAN(IBAN);
                                                              END;

                                                   CaptionML=[ENU=IBAN;
                                                              NOR=IBAN;
                                                              SVE=IBAN] }
    { 59  ;   ;Balance             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Employee Ledger Entry".Amount WHERE (Employee No.=FIELD(No.),
                                                                                                                   Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                   Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                   Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Balance;
                                                              NOR=Saldo;
                                                              SVE=Saldo];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 60  ;   ;SWIFT Code          ;Code20        ;TableRelation="SWIFT Code";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=SWIFT Code;
                                                              NOR=SWIFT-kode;
                                                              SVE=SWIFT-kod] }
    { 80  ;   ;Application Method  ;Option        ;CaptionML=[ENU=Application Method;
                                                              NOR=Utligningsmetode;
                                                              SVE=Kopplingsmetod];
                                                   OptionCaptionML=[ENU=Manual,Apply to Oldest;
                                                                    NOR=èpen post,Saldo;
                                                                    SVE=Registrering fakturanr,Koppla till Ñldsta faktura];
                                                   OptionString=Manual,Apply to Oldest }
    { 140 ;   ;Image               ;Media         ;ExtendedDatatype=Person;
                                                   CaptionML=[ENU=Image;
                                                              NOR=Bilde;
                                                              SVE=Bild] }
    { 150 ;   ;Privacy Blocked     ;Boolean       ;CaptionML=[ENU=Privacy Blocked;
                                                              NOR=Personvern sperret;
                                                              SVE=Sekretessblockerad] }
    { 1100;   ;Cost Center Code    ;Code20        ;TableRelation="Cost Center";
                                                   CaptionML=[ENU=Cost Center Code;
                                                              NOR=Kostsenterkode;
                                                              SVE=Kod fîr kostnadsstÑlle] }
    { 1101;   ;Cost Object Code    ;Code20        ;TableRelation="Cost Object";
                                                   CaptionML=[ENU=Cost Object Code;
                                                              NOR=Kostobjektkode;
                                                              SVE=Kod fîr kostnadsbÑrare] }
    { 8000;   ;Id                  ;GUID          ;CaptionML=[ENU=Id;
                                                              NOR=ID;
                                                              SVE=ID] }
    { 11012000;;Norm Hours         ;Decimal       ;CaptionML=[ENU=Norm Hours;
                                                              NOR=Normtimer;
                                                              SVE=Norm (timmar)];
                                                   DecimalPlaces=0:3 }
    { 11012010;;Norm Days          ;Decimal       ;CaptionML=[ENU=Norm Days;
                                                              NOR=Normdager;
                                                              SVE=Normdagar];
                                                   DecimalPlaces=0:3 }
    { 11012015;;Norm Hours Year    ;Decimal       ;CaptionML=[ENU=Norm Hours per Year;
                                                              NOR=Normtimer per Ür;
                                                              SVE=Normtimmar per Ür];
                                                   DecimalPlaces=0:0 }
    { 11012021;;Show in Hours Portal;Boolean      ;CaptionML=[ENU=Show in Hours Portal;
                                                              NOR=Vis i timeportal;
                                                              SVE=Visa i timportal] }
    { 11012025;;Account Hours      ;Option        ;CaptionML=[ENU=Account Hours;
                                                              NOR=Kontotimer;
                                                              SVE=Kontotimmar];
                                                   OptionCaptionML=[ENU=Required according to Norm,Optional,Not allowed;
                                                                    NOR=Kreves i henhold til norm,Valgfri,Ikke tillatt;
                                                                    SVE=KrÑvs enligt Norm,Valfri,Inte tillÜten];
                                                   OptionString=Required according to Norm,Optional,Not allowed }
    { 11012030;;Trade Association  ;Code10        ;TableRelation="Trade Association".Code;
                                                   CaptionML=[ENU=Trade Association;
                                                              NOR=Bransjeorganisasjon;
                                                              SVE=Branschorganisation] }
    { 11012040;;External           ;Boolean       ;OnValidate=BEGIN
                                                                //**4PS
                                                                IF External <> xRec.External THEN BEGIN
                                                                  Employer := '';
                                                                   "External Post No Surcharge" := FALSE;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=External;
                                                              NOR=Eksternt;
                                                              SVE=Externt] }
    { 11012050;;Employer           ;Code20        ;TableRelation=IF (External=CONST(No)) Employer.Code
                                                                 ELSE IF (External=CONST(Yes)) Vendor.No.;
                                                   CaptionML=[ENU=Employer;
                                                              NOR=Arbeidsgiver;
                                                              SVE=Arbetsgivare] }
    { 11012060;;External Rental Hour Rate;Decimal ;CaptionML=[ENU=External Rental Hour Rate;
                                                              NOR=Timesats for ekstern leie;
                                                              SVE=Timtaxa fîr extern uthyrning];
                                                   AutoFormatType=2 }
    { 11012065;;External Post No Surcharge;Boolean;OnValidate=BEGIN
                                                                //**4PS
                                                                IF (NOT External) AND ("External Post No Surcharge") THEN
                                                                  ERROR(Text11012004);
                                                              END;

                                                   CaptionML=[ENU=External Post No Surcharge;
                                                              NOR=Ekstern bokfõring uten tilleggsgebyr;
                                                              SVE=Extern bokfîring utan tillÑggsavgift] }
    { 11012070;;Permissions of a   ;Option        ;CaptionML=[ENU=Permissions of a;
                                                              NOR=Tillatelser tilhõrende;
                                                              SVE=Behîrigheter som tillhîr];
                                                   OptionCaptionML=[ENU=" ,Project Manager,Site Manager,Project Engineer,Estimator,Supervisor,Buyercontact,Purchaser";
                                                                    NOR=" ,Prosjektleder,Byggeleder,Prosjektingeniõr,Kalkulatõr,Arbeidsleder,Kundeansvarlig,Innkjõpare";
                                                                    SVE=" ,Projektledare,Arbetsledaren,Projekttekniker,Kalkylansvarig,Arbetsledare,Kundansvarig,Inkîpare"];
                                                   OptionString=[ ,Project Manager,Site Manager,Project Engineer,Estimator,Supervisor,Buyercontact,Purchaser];
                                                   BlankZero=Yes }
    { 11012080;;Calculate Wage Costs;Option       ;CaptionML=[ENU=Calculate Wage Costs;
                                                              NOR=Beregn lõnnskoster;
                                                              SVE=BerÑkna lînekostnader];
                                                   OptionCaptionML=[ENU=Fixed Rate,Actual Rate;
                                                                    NOR=Fast sats,Faktisk sats;
                                                                    SVE=Fast avgift,Verklig avgift];
                                                   OptionString=Fixed Rate,Actual Rate }
    { 11012090;;Path Name Files to Site Man.;Text100;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                FileMgt.AddBackSlashToDirectoryName("Path Name Files to Site Man.");
                                                              END;

                                                   CaptionML=[ENU=Path Name Files to Site Man.;
                                                              NOR=Banenavn for filer til byggeledelse;
                                                              SVE=SîkvÑg fîr filer till byggledning.] }
    { 11012091;;Supplying Company Site Man.;Text30;TableRelation=Company;
                                                   OnValidate=VAR
                                                                lvEmplRec@1100485000 : Record 5200;
                                                              BEGIN
                                                                //**4PS
                                                                IF "Supplying Company Site Man." <> '' THEN BEGIN
                                                                  IF "Supplying Company Site Man." = COMPANYNAME THEN
                                                                    ERROR(Text11012005, FIELDCAPTION("Supplying Company Site Man."))
                                                                  ELSE BEGIN
                                                                    lvEmplRec.CHANGECOMPANY("Supplying Company Site Man.");
                                                                    IF NOT lvEmplRec.GET("No.") THEN
                                                                      FIELDERROR("Supplying Company Site Man.", STRSUBSTNO(Text11012006,"Supplying Company Site Man.","No."));
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Supplying Company Site Man.;
                                                              NOR=Leverende selskap Õ byggeledelse;
                                                              SVE=Arbetsledare fîr levererande fîretag] }
    { 11012100;;Search Directory   ;BLOB          ;CaptionML=[ENU=Search Directory;
                                                              NOR=Sõk katalog;
                                                              SVE=Sîkkatalog];
                                                   SubType=User-Defined }
    { 11012110;;Element            ;Code20        ;TableRelation="Base Element".Code;
                                                   OnValidate=VAR
                                                                ElementFormat@1210190000 : Codeunit 11012022;
                                                              BEGIN
                                                                //**4PS
                                                                ElementFormat.FormatElem(Element,2,'');
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 11012120;;Participant No. (Losa);Text10     ;TableRelation="Losa Cobra Participant"."Participant No.";
                                                   CaptionML=[ENU=Participant No. (Losa);
                                                              NOR=Deltagernr (Losa);
                                                              SVE=Deltagarens nr (Losa)] }
    { 11012130;;Salary No.         ;Code20        ;CaptionML=[ENU=Salary No.;
                                                              NOR=Lõnnsnr.;
                                                              SVE=Lînenr] }
    { 11012135;;Company No. SCAB   ;Code10        ;TableRelation="SCAB Company";
                                                   CaptionML=[ENU=Company No. SCAB;
                                                              NOR=Selskap SCAB-nummer;
                                                              SVE=Fîretagsnr, SCAB] }
    { 11012140;;Company No. Paymaster;Code10      ;TableRelation="Paymaster Company UAR";
                                                   CaptionML=[ENU=Company No. Paymaster;
                                                              NOR=Selskap Paymaster-nummer;
                                                              SVE=Fîretagsnr, Paymaster];
                                                   Description=4PS Rail }
    { 11012150;;Administration No. Paymaster;Code10;
                                                   TableRelation="Paymaster Administration UAR"."Administration No." WHERE (Company No.=FIELD(Company No. Paymaster));
                                                   CaptionML=[ENU=Administration No. Paymaster;
                                                              NOR=Administrasjon Paymaster-nummer;
                                                              SVE=Administrationsnr, Paymaster];
                                                   Description=4PS Rail }
    { 11012160;;Default Cost Component;Code10     ;TableRelation="Cost Components by Employee"."Cost Component" WHERE (Employee No.=FIELD(No.));
                                                   CaptionML=[ENU=Default Cost Component;
                                                              NOR=Standard kostnadskomponent;
                                                              SVE=Standardkostnadsdel];
                                                   Description=4PS Rail }
    { 11012170;;Name Abbreviation  ;Text30        ;CaptionML=[ENU=Name Abbreviation;
                                                              NOR=Navnforkortelse;
                                                              SVE=Namnfîrkortning] }
    { 11012175;;Full Name          ;Text100       ;CaptionML=[ENU=Full Name;
                                                              NOR=Fullstendig navn;
                                                              SVE=FullstÑndigt namn];
                                                   Editable=No }
    { 11012180;;UTA                ;Boolean       ;CaptionML=[ENU=Clerical Staff;
                                                              NOR=Kontorpersonale;
                                                              SVE=Kontorspersonal] }
    { 11012185;;Skip Cost Code as Department;Boolean;
                                                   CaptionML=[ENU=Skip Cost Code as Department;
                                                              NOR=Hopp over kostkode som avdeling;
                                                              SVE=Hoppa îver kostnadskod som avdelning] }
    { 11012190;;Title behind the Name;Text30      ;TableRelation="Academic Title" WHERE (Title Behind the Name=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                FillFullName(); //**4PS03.n
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Title behind the name;
                                                              NOR=Tittel bak navnet;
                                                              SVE=Rubrik bakom namnet] }
    { 11012200;;Manager Name       ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Manager No.)));
                                                   CaptionML=ENU=Manager Name;
                                                   Editable=No }
    { 11012400;;Document Editor    ;Code20        ;TableRelation=Employee;
                                                   CaptionML=[ENU=Document Editor;
                                                              NOR=Dokument-editor;
                                                              SVE=Dokumenteditor] }
    { 11012420;;Responsibility Center;Code10      ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              NOR=Ansvarssenter;
                                                              SVE=Ansvarsenhet] }
    { 11012430;;Print Man Day Register;Boolean    ;InitValue=Yes;
                                                   CaptionML=ENU=Print Man Day Register }
    { 11012440;;Commuter Time      ;Decimal       ;CaptionML=[ENU=Commute Time;
                                                              NOR=Pendlingstid;
                                                              SVE=Pendlingstid] }
    { 11012450;;Discipline         ;Code10        ;TableRelation=Discipline;
                                                   CaptionML=[ENU=Discipline;
                                                              NOR=Disiplin;
                                                              SVE=Disciplin] }
    { 11012451;;Discipline Description;Text30     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Discipline.Description WHERE (Code=FIELD(Discipline)));
                                                   CaptionML=[ENU=Discipline Description;
                                                              NOR=Disiplinbeskrivelse;
                                                              SVE=Disciplinbeskrivning];
                                                   Editable=No }
    { 11012460;;Licence Plate      ;Code20        ;CaptionML=[ENU=Licence Plate;
                                                              NOR=Nummerskilt;
                                                              SVE=Registreringsskylt] }
    { 11012500;;Controllers        ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Hour Controller" WHERE (Employee No.=FIELD(No.)));
                                                   CaptionML=[ENU=Controllers;
                                                              NOR=Kontrollõrer;
                                                              SVE=Kontrollanter];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 11012505;;Contact Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Contact;
                                                   CaptionML=[ENU=Contact Filter;
                                                              NOR=Kontaktfilter;
                                                              SVE=Kontaktfilter] }
    { 11012510;;Contact Company Filter;Code20     ;FieldClass=FlowFilter;
                                                   TableRelation=Contact WHERE (Type=CONST(Company));
                                                   CaptionML=[ENU=Contact Company Filter;
                                                              NOR=Filter for kontaktselskap;
                                                              SVE=Kontaktfîretag filter] }
    { 11012520;;Campaign Filter    ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign Filter;
                                                              NOR=Kampanjefilter;
                                                              SVE=Kampanjfilter] }
    { 11012530;;Team Filter        ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Team;
                                                   CaptionML=[ENU=Team Filter;
                                                              NOR=Filter for prosjektgruppe;
                                                              SVE=Teamfilter] }
    { 11012535;;Salesperson Filter ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Filter;
                                                              NOR=Selgerfilter;
                                                              SVE=SÑljarfilter] }
    { 11012540;;To-do Entry Exists 2;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (Responsible Person=FIELD(No.),
                                                                                  Contact No.=FIELD(Contact Filter),
                                                                                  Contact Company No.=FIELD(Contact Company Filter),
                                                                                  Campaign No.=FIELD(Campaign Filter),
                                                                                  Salesperson Code=FIELD(Salesperson Filter),
                                                                                  Team Code=FIELD(Team Filter),
                                                                                  Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=To-do Entry Resp. Person Exists;
                                                              NOR=Oppgavetransaksjon for ansvarlig person finnes;
                                                              SVE=Uppgift fîr ansvarig person finns];
                                                   Editable=No }
    { 11012600;;Imos Type          ;Option        ;CaptionML=[ENU=Imos Type;
                                                              NOR=Imos-type;
                                                              SVE=Imos-typ];
                                                   OptionCaptionML=[ENU=,Planner,Engineer;
                                                                    NOR=,Planlegger,Ingeniõr;
                                                                    SVE=,Planerare,Tekniker];
                                                   OptionString=,Planner,Engineer;
                                                   Description=IMOS }
    { 11012601;;Imos Login         ;Code10        ;CaptionML=[ENU=Imos Login;
                                                              NOR=Imos-innlogging;
                                                              SVE=Imos-inloggning];
                                                   Description=IMOS }
    { 11012602;;Imos Password      ;Text20        ;CaptionML=[ENU=Imos Password;
                                                              NOR=Imos-passord;
                                                              SVE=Imos-lîsenord];
                                                   Description=IMOS }
    { 11012603;;Imos Car           ;Code20        ;TableRelation=Location;
                                                   CaptionML=[ENU=Imos Car;
                                                              NOR=Imos-bil;
                                                              SVE=Imos-bil];
                                                   Description=IMOS }
    { 11012604;;Imos Planner District Code;Code20 ;TableRelation="District (iMOS)";
                                                   CaptionML=[ENU=Imos Planner District Code;
                                                              NOR=Distriktskode for Imos-planlegging;
                                                              SVE=Distriktskod fîr Imos-planering];
                                                   Description=IMOS }
    { 11012605;;Imos Hour Model    ;Code20        ;TableRelation="Hour Model (iMOS)";
                                                   CaptionML=[ENU=Imos Hour Model;
                                                              NOR=Imos-timemodell;
                                                              SVE=Imos-timmodell];
                                                   Description=IMOS }
    { 11012610;;Pre-Registration Hours;Boolean    ;CaptionML=[ENU=Pre-Registration Hours;
                                                              NOR=ForhÜndsregistreringstimer;
                                                              SVE=Fîrregistreringstimmar] }
    { 11012620;;Super Approver     ;Boolean       ;CaptionML=ENU=Super Approver Hour Accounting }
    { 11012630;;Driver Type        ;Option        ;CaptionML=[ENU=Driver Type;
                                                              NOR=SjÜfõrtype;
                                                              SVE=Fîrartyp];
                                                   OptionCaptionML=[ENU=Passenger,Driver without passengers,Driver with passengers;
                                                                    NOR=Passasjerer,SjÜfõr uten passasjerer,SjÜfõr med passasjerer;
                                                                    SVE=Passagerare,Fîrare utan passagerare,Fîrare med passagerare];
                                                   OptionString=Passenger,Driver without passengers,Driver with passengers }
    { 11012650;;Company Phone No.  ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Company Phone No."); //**4PS.n
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Company Phone No.;
                                                              SVE=Fîretagets telefonnummer] }
    { 11012660;;Company Mobile Phone No.;Text30   ;OnValidate=BEGIN
                                                                //**4PS.sn
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Company Mobile Phone No.");
                                                                //**4PS.en
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=ENU=Company Mobile Phone No. }
    { 11012670;;Hour Line Templ. Code Service;Code20;
                                                   TableRelation="Hour Line Template".Code WHERE (Type=CONST(Service));
                                                   OnValidate=VAR
                                                                HourLineTemplate@1100525000 : Record 11229799;
                                                                Checktype@1100525001 : 'Project,Indirect,Service,Plant,Unmanned Plant';
                                                              BEGIN
                                                                IF NOT HourLineTemplate.ValidateCodeforSource(COMPANYNAME,FALSE,"Hour Line Templ. Code Service",Checktype::Service,TRUE) THEN
                                                                  FIELDERROR("Hour Line Templ. Code Service");
                                                              END;

                                                   OnLookup=VAR
                                                              HourLineTemplate@1100525000 : Record 11229799;
                                                              LookupCompany@1100525002 : Text[30];
                                                              LookupType@1100525001 : 'Project,Indirect,Service,Plant,Unmanned Plant';
                                                            BEGIN
                                                              LookupCompany := COMPANYNAME;
                                                              LookupType := LookupType::Service;
                                                              IF HourLineTemplate.LookupCodeforSource(LookupCompany,FALSE,"Hour Line Templ. Code Service", LookupType,TRUE) THEN
                                                                VALIDATE("Hour Line Templ. Code Service");
                                                            END;

                                                   CaptionML=ENU=Hour Line Template Code (Service) }
    { 11012680;;Hour Line Templ. Code Project;Code20;
                                                   TableRelation="Hour Line Template".Code WHERE (Type=CONST(Project));
                                                   OnValidate=VAR
                                                                HourLineTemplate@1100525000 : Record 11229799;
                                                                CheckType@1100525001 : 'Project,Indirect,Service,Plant,Unmanned Plant';
                                                              BEGIN
                                                                IF NOT HourLineTemplate.ValidateCodeforSource(COMPANYNAME,FALSE,"Hour Line Templ. Code Project",CheckType::Project,TRUE) THEN
                                                                  FIELDERROR("Hour Line Templ. Code Project");
                                                              END;

                                                   OnLookup=VAR
                                                              HourLineTemplate@1100525000 : Record 11229799;
                                                              LookupCompany@1100525001 : Text[30];
                                                              LookupType@1100525002 : 'Project,Indirect,Service,Plant,Unmanned Plant';
                                                            BEGIN
                                                              LookupCompany := COMPANYNAME;
                                                              LookupType := LookupType::Project;
                                                              IF HourLineTemplate.LookupCodeforSource(LookupCompany,FALSE,"Hour Line Templ. Code Project",LookupType,TRUE) THEN
                                                                VALIDATE("Hour Line Templ. Code Project");
                                                            END;

                                                   CaptionML=ENU=Hour Line Template Code (Project) }
    { 11012800;;Location Code      ;Code10        ;TableRelation=Location WHERE (Service Car=CONST(Yes));
                                                   OnValidate=VAR
                                                                Location@1100525001 : Record 14;
                                                              BEGIN
                                                                IF "Location Code" <> '' THEN
                                                                  Location.GET("Location Code");
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Plasseringkode;
                                                              SVE=LagerstÑllekod] }
    { 11012810;;Ascert Code        ;Code20        ;CaptionML=ENU=Ascert Code;
                                                   Description=Safety & Health }
    { 11012990;;Export to FSA      ;Boolean       ;CaptionML=[ENU=Export to Field Service;
                                                              NOR=Eksporter til Feltservice;
                                                              SVE=Exportera till fÑltservice];
                                                   Description=Indication new/changed. BDA= Buitendienstadmin. (Field Service Admin.), provisional this is only Field Vision. }
    { 11012991;;Date/Time Export to FSA;DateTime  ;CaptionML=[ENU=Date/Time Export to Field Service;
                                                              NOR=Dato/tid, Eksporter til Feltservice;
                                                              SVE=Datum/tid, export till fÑltservice];
                                                   Description=Idem }
    { 11012993;;Login Code FSA     ;Text20        ;CaptionML=[ENU=Login Code FSA;
                                                              NOR=Innloggingskode FSA;
                                                              SVE=Inloggningskod FSA];
                                                   Description=FieldVision, not used for 4PS-Mobile }
    { 11012994;;Password FSA       ;Text20        ;CaptionML=[ENU=Password FSA;
                                                              NOR=Passord FSA;
                                                              SVE=Lîsenord FSA];
                                                   Description=FieldVision, not used for 4PS-Mobile }
    { 11012995;;CAO                ;Code10        ;TableRelation="Site Mngmnt. CAO".Code;
                                                   CaptionML=[ENU=CAO;
                                                              NOR=CAO;
                                                              SVE=KA] }
    { 11012996;;Company Car        ;Boolean       ;CaptionML=[ENU=Company Car;
                                                              NOR=Firmabil;
                                                              SVE=TjÑnstefordon] }
    { 11012997;;Check Hours        ;Boolean       ;CaptionML=[ENU=Check Hours;
                                                              NOR=Kontroller timer;
                                                              SVE=Kontrollera timmar] }
    { 11012998;;Year Filter        ;Integer       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Year Filter;
                                                              NOR=èrsfilter;
                                                              SVE=èrsfilter] }
    { 11012999;;Week Filter        ;Integer       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Week Filter;
                                                              NOR=Ukefilter;
                                                              SVE=Veckofilter] }
    { 11020729;;Territory Code     ;Code10        ;TableRelation=Territory.Code;
                                                   CaptionML=[ENU=Territory Code;
                                                              NOR=Distriktskode;
                                                              SVE=Distriktskod];
                                                   Description=MERCASH }
    { 11020767;;Company Mobile     ;Text30        ;CaptionML=ENU=Company Mobile;
                                                   Description=MERCASH SGN1485 }
    { 11128230;;Labour Rule        ;Code10        ;TableRelation="Labour Rule";
                                                   CaptionML=[ENU=Labour Rule;
                                                              NOR=Arbeidstidsregel;
                                                              SVE=Arbetstidsregel];
                                                   Description=SESB.I028 }
    { 11128231;;Default Line Type  ;Option        ;CaptionML=[ENU=Default Line Type;
                                                              NOR=Standard radtype;
                                                              SVE=Standard radtyp];
                                                   OptionCaptionML=[ENU=Project,Service,Indirect,,Plant;
                                                                    NOR=Prosjekt,Service,Indirekte,,Maskin;
                                                                    SVE=Projekt,Service,Indirekt,,Maskin];
                                                   OptionString=Project,Service,Indirect,,Plant;
                                                   Description=SESB.I029 }
    { 11128232;;Last Updated       ;DateTime      ;CaptionML=SVE=Senast uppdaterad;
                                                   Description=4PSHM }
    { 11128233;;Allow other department indir;Boolean;
                                                   CaptionML=ENU=Allow other department than 'own' at indirect Hour Accounting;
                                                   Description=RFC086 }
    { 11128234;;User Default Team Code;Code10     ;TableRelation="Team Code";
                                                   CaptionML=ENU=User Default Team Code;
                                                   Description=RFC150 }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Status,Union Code                        }
    {    ;Status,Emplymt. Contract Code            }
    {    ;Last Name,First Name,Middle Name         }
    {    ;Global Dimension 1 Code,Global Dimension 2 Code }
    {    ;Global Dimension 2 Code,Global Dimension 1 Code }
    {    ;Discipline,No.                           }
    {    ;Salary No.                               }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,First Name,Last Name,Initials,Job Title }
    { 2   ;Brick               ;Last Name,First Name,Job Title,Image     }
  }
  CODE
  {
    VAR
      Text11012000@1210190001 : TextConst 'ENU=The combination of %1 %2 and House No. %3 is already used at %4 %5;NOR=Kombinasjonen av %1 %2 og husnr %3 er i bruk allerede i %4 %5;SVE=Kombinationen av %1 %2 och husnr %3 anvÑnds redan i %4 %5';
      RMSetup@1210190003 : Record 5079;
      ContBusRel@1210190007 : Record 5054;
      Cont@1210190006 : Record 5050;
      HumanResSetup@1000 : Record 5218;
      Res@1002 : Record 156;
      PostCode@1003 : Record 225;
      AlternativeAddr@1004 : Record 5201;
      EmployeeQualification@1005 : Record 5203;
      Relative@1006 : Record 5205;
      EmployeeAbsence@1007 : Record 5207;
      MiscArticleInformation@1008 : Record 5214;
      ConfidentialInformation@1009 : Record 5216;
      HumanResComment@1010 : Record 5208;
      SalespersonPurchaser@1011 : Record 13;
      HourAccRec@11012012 : Record 11012038;
      HoursAccLineRec@11012013 : Record 11012039;
      NoSeriesMgt@1012 : Codeunit 396;
      EmployeeResUpdate@1013 : Codeunit 5200;
      EmployeeSalespersonUpdate@1014 : Codeunit 5201;
      DimMgt@1015 : Codeunit 408;
      Text000@1016 : TextConst 'ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.;NOR=Du mÜ fylle ut vinduet Oppsett av Online Map fõr du kan bruke Online Map.\Se Konfigurere Online Map i Hjelp.;SVE=Innan du kan anvÑnda Online Map mÜste du fylla i fînstret Online Map - instÑllning.\Se Konfiguration av Online Map i hjÑlpen';
      BlockedEmplForJnrlErr@1001 : TextConst '@@@="%1 = employee no.";ENU=You cannot create this document because employee %1 is blocked due to privacy.;NOR=Du kan ikkeˇopprette denneˇdokumenttypen fordi ansatt %1 er sperret pÜ grunn av personvern.';
      BlockedEmplForJnrlPostingErr@1017 : TextConst '@@@="%1 = employee no.";ENU=You cannot post this document because employee %1 is blocked due to privacy.;NOR=Du kan ikkeˇbokfõre denneˇdokumenttypen fordi ansatt %1 er sperret pÜ grunn av personvern.';
      EmployeeLinkedToResourceErr@1018 : TextConst '@@@="%1 = employee no.";ENU=You cannot link multiple employees to the same resource. Employee %1 is already linked to that resource.;NOR=Du kan ikke koble flere ansatte til den samme ressursen. Den ansatte (%1) er allerede koblet til den ressursen.';
      ContactDataValidation@1100528700 : Codeunit 11012275;
      PhoneNumberFormatting@1100528701 : Codeunit 11012276;
      RecRef@1100485010 : RecordRef;
      CentralDataMngmnt@1100485009 : Codeunit 11012010;
      Text11012004@1100485100 : TextConst 'ENU="The surcharges can only be skipped for Externals ";NOR=Tilleggsgebyrene kan kun hoppes over for eksterne;SVE="TillÑggsavgifterna kan endast hoppas îver fîr externa "';
      InsertFromContact@1100485006 : Boolean;
      EmplTimeTableRec@1100485002 : Record 11012923;
      Text11012005@1100485003 : TextConst 'ENU=Only fill %1 when it differs from the current company.;NOR=Fyll ut kun i %1 nÜr det skiller seg fra den aktuelle bedriften.;SVE=Fyll endast i %1 nÑr det skiljer sig frÜn det aktuella fîretaget.';
      Text11012006@1100485004 : TextConst 'ENU=''%1'' not allowed, Employee must also be present there;NOR=%1'' er ikke tillatt. Ansatt mÜ ogsÜ vëre her.;SVE=''%1'' Ñr inte tillÜtet. éven anstÑlld mÜste finnas med hÑr.';
      Text11012011@1100485011 : TextConst 'ENU=Can not add, this should be done in Central Company %1.;NOR=Kan ikke legge til, dette skal gjõres i Sentralt selskap %1.;SVE=Det gÜr inte att lÑgga till, detta ska gîras i centralfîretaget %1.';
      Text11012012@1100485012 : TextConst 'ENU=Can not update %1, this should be done in Central Company %2;NOR=Kan ikke oppdatere %1. Dette skal gjõres i Sentralt selskap %2.;SVE=Det gÜr inte att uppdatera %1. Detta ska gîras i centralfîretaget %2.';
      Text11012014@1100525000 : TextConst 'ENU="You cannot delete %1 %2; at least one %3 exists for this %1.";NOR="Du kan ikke fjerne %1 %2; det finnes minst en %3 for denne %1.";SVE=Du kan inte ta bort %1 %2 eftersom det finns minst en %3 fîr denna %1.';
      DPA_Management@1100000999 : Codeunit 11012783;
      Text11012018@1100525004 : TextConst 'ENU=Termination Date in the past not possible for active Employee.;NOR=Sluttdato i det fortiden er ikke mulig for aktiv ansatt.;SVE=Avslutningsdatum i det fîrflutna Ñr inte mîjligt fîr en aktiv anstÑlld.';
      FileMgt@1100525005 : Codeunit 419;
      SkipAccHoursDefaultOnInsert@1210190000 : Boolean;
      ProjectSiteMgt@1100528300 : Codeunit 11012282;
      SkipModify@1100528400 : Boolean;
      Text11012019@1100529600 : TextConst 'ENU=Employee %1 not employed since %2';
      Text11012020@1100529601 : TextConst 'ENU=Employee %1 inactive since %2';
      FPSLicenseManagement@1100528500 : Codeunit 11229289;

    [External]
    PROCEDURE AssistEdit@2() : Boolean;
    BEGIN
      HumanResSetup.GET;
      HumanResSetup.TESTFIELD("Employee Nos.");
      IF NoSeriesMgt.SelectSeries(HumanResSetup."Employee Nos.",xRec."No. Series","No. Series") THEN BEGIN
        NoSeriesMgt.SetSeries("No.");
        EXIT(TRUE);
      END;
    END;

    [External]
    PROCEDURE FullName@1() : Text[100];
    VAR
      NewFullName@1000 : Text[100];
      Handled@1001 : Boolean;
    BEGIN
      OnBeforeGetFullName(Rec,NewFullName,Handled);
      IF Handled THEN
        EXIT(NewFullName);

      //**4PS.so
      //  IF "Middle Name" = '' THEN
      //    EXIT("First Name" + ' ' + "Last Name")
      //  ELSE
      //    EXIT("First Name" + ' ' + "Middle Name" + ' ' + "Last Name");
      //**4PS.eo
      //**4PS.sn
      EXIT("Full Name");
      //**4PS.en
    END;

    [External]
    PROCEDURE FillFullName@1210190008() : Text[100];
    VAR
      lFullName@1210190000 : Text[250];
    BEGIN
      //**4PS
      HumanResSetup.GET;
      CASE HumanResSetup."Format Full Name" OF
        HumanResSetup."Format Full Name"::First:
          BEGIN
            AddToFullName(lFullName, "First Name");
            AddToFullName(lFullName, "Middle Name");
            AddToFullName(lFullName, "Last Name");
          END;
        HumanResSetup."Format Full Name"::Initials:
          BEGIN
            AddToFullName(lFullName, Initials);
            AddToFullName(lFullName, "Middle Name");
            AddToFullName(lFullName, "Last Name");
          END;
        HumanResSetup."Format Full Name"::Title:
          BEGIN
            AddToFullName(lFullName, Title);
            AddToFullName(lFullName, Initials);
            AddToFullName(lFullName, "Middle Name");
            AddToFullName(lFullName, "Last Name");
            AddToFullName(lFullName, "Title behind the Name");
          END;
        HumanResSetup."Format Full Name"::InitialsFirst:
          BEGIN
            AddToFullName(lFullName, Initials);
            IF "First Name" <> '' THEN
              AddToFullName(lFullName, '(' + "First Name" + ')');
            AddToFullName(lFullName, "Middle Name");
            AddToFullName(lFullName, "Last Name");
          END;
      END;

      "Full Name" := lFullName;
    END;

    [External]
    PROCEDURE AddToFullName@1100485006(VAR lFullName@1100485001 : Text[100];lAddTxt@1100485000 : Text[100]);
    BEGIN
      //**4PS
      IF lAddTxt = '' THEN
        EXIT;

      IF lFullName <> '' THEN
        lFullName := lFullName + ' ';
      lFullName := lFullName + lAddTxt;
    END;

    [External]
    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Employee,"No.",FieldNumber,ShortcutDimCode);
      IF NOT SkipModify THEN //**4PS.n
        MODIFY;
    END;

    [External]
    PROCEDURE DisplayMap@7();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FINDFIRST THEN
        MapMgt.MakeSelection(DATABASE::Employee,GETPOSITION)
      ELSE
        MESSAGE(Text000);
    END;

    LOCAL PROCEDURE UpdateSearchName@4();
    VAR
      PrevSearchName@1000 : Code[250];
    BEGIN
      PrevSearchName := xRec.FullName + ' ' + xRec.Initials;
      IF ((("First Name" <> xRec."First Name") OR ("Middle Name" <> xRec."Middle Name") OR ("Last Name" <> xRec."Last Name") OR
           (Initials <> xRec.Initials)) AND ("Search Name" = PrevSearchName))
      THEN
        "Search Name" := SetSearchNameToFullnameAndInitials;
    END;

    LOCAL PROCEDURE SetSearchNameToFullnameAndInitials@3() : Code[250];
    BEGIN
      EXIT(FullName + ' ' + Initials);
    END;

    [External]
    PROCEDURE GetBankAccountNo@5() : Text;
    BEGIN
      IF IBAN <> '' THEN
        EXIT(DELCHR(IBAN,'=<>'));

      IF "Bank Account No." <> '' THEN
        EXIT("Bank Account No.");
    END;

    [External]
    PROCEDURE CheckBlockedEmployeeOnJnls@8(IsPosting@1000 : Boolean);
    BEGIN
      IF IsOnBeforeCheckBlockedEmployeeHandled(IsPosting) THEN
        EXIT;
      IF "Privacy Blocked" THEN BEGIN
        IF IsPosting THEN
          ERROR(BlockedEmplForJnrlPostingErr,"No.");
        ERROR(BlockedEmplForJnrlErr,"No.")
      END;
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeGetFullName@6(Employee@1000 : Record 5200;VAR NewFullName@1001 : Text[100];VAR Handled@1002 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE CheckIfAnEmployeeIsLinkedToTheResource@10(ResourceNo@1000 : Code[20]);
    VAR
      Employee@1001 : Record 5200;
    BEGIN
      Employee.SETFILTER("No.",'<>%1',"No.");
      Employee.SETRANGE("Resource No.",ResourceNo);
      IF Employee.FINDFIRST THEN
        ERROR(EmployeeLinkedToResourceErr,Employee."No.");
    END;

    LOCAL PROCEDURE IsOnBeforeCheckBlockedEmployeeHandled@9(IsPosting@1000 : Boolean) IsHandled : Boolean;
    BEGIN
      OnBeforeCheckBlockedEmployee(Rec,IsPosting,IsHandled);
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckBlockedEmployee@11(Employee@1000 : Record 5200;IsPosting@1001 : Boolean;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [External]
    PROCEDURE CompleteEmployeeName@11012100(parCode@1210190014 : Code[20]) : Text[100];
    VAR
      EmployeeRec@11012001 : Record 5200;
    BEGIN
      //**4PS
      IF EmployeeRec.GET(parCode) THEN
        EXIT(EmployeeRec."Full Name")
      ELSE
        EXIT('');
    END;

    [External]
    PROCEDURE CheckPostCodeHouseNo@1210190000();
    VAR
      lEmplRec@1210190000 : Record 5200;
      lHousNo@1210190018 : Text[50];
      lFormatAddress@1210190011 : Codeunit 365;
    BEGIN
      //**4PS
      IF (Address = '') OR ("Post Code" ='') THEN
        EXIT;

      lHousNo := lFormatAddress.HouseNo(Address);
      IF lHousNo = '' THEN
        EXIT;

      lEmplRec.SETFILTER("No.",'<>%1',"No.");
      lEmplRec.SETRANGE("Post Code", "Post Code");
      IF lEmplRec.FINDSET THEN
        REPEAT
          IF lFormatAddress.HouseNo(lEmplRec.Address) = lHousNo THEN
            MESSAGE(Text11012000, FIELDCAPTION("Post Code"), "Post Code", lHousNo, TABLECAPTION, lEmplRec."No.");
        UNTIL lEmplRec.NEXT = 0;
    END;

    [External]
    PROCEDURE UpdateDimension@1210190001(DeleteBln@1210190000 : Boolean);
    VAR
      DimValRec@1210190012 : Record 349;
    BEGIN
      //**4PS
      RMSetup.GET;
      IF RMSetup."Shortcut Dimension Employees" <> '' THEN
        IF DeleteBln = TRUE THEN BEGIN
          IF DimValRec.GET(RMSetup."Shortcut Dimension Employees", "No.") THEN
            DimValRec.DELETE(TRUE);
        END ELSE
          IF DimValRec.GET(RMSetup."Shortcut Dimension Employees", "No.") THEN BEGIN
            DimValRec.Name := COPYSTR(FullName, 1, MAXSTRLEN(DimValRec.Name));
            DimValRec.MODIFY(TRUE);
          END ELSE BEGIN
            DimValRec.INIT;
            DimValRec."Dimension Code" := RMSetup."Shortcut Dimension Employees";
            DimValRec.Code := "No.";
            DimValRec.Name := COPYSTR(FullName, 1, MAXSTRLEN(DimValRec.Name));
            DimValRec.INSERT(TRUE);
          END;
    END;

    [External]
    PROCEDURE InsertNewContact@1100528705(VAR Employee@1100528700 : Record 5200);
    VAR
      Contact@1100528701 : Record 5050;
      ContactBusinessRelation@1100528702 : Record 5054;
    BEGIN
      RMSetup.GET;
      IF (RMSetup."Bus. Rel. Code for Employees" = '') OR (RMSetup."Contact Nos. Employees" = '') THEN
        EXIT;

      IF NOT CentralDataMngmnt.InsertingPersonIsAllowed THEN
        ERROR(Text11012011, CentralDataMngmnt.CentralCompany);

      Contact.INIT;
      OnTransferFields(Contact, Employee);

      Contact.VALIDATE("First Name");
      Contact."No." := '';
      Contact."No. Series" := '';

      RMSetup.TESTFIELD("Contact Nos. Employees");
      NoSeriesMgt.InitSeries(RMSetup."Contact Nos. Employees",'',0D,Contact."No.",Contact."No. Series");
      Contact.Type := Contact.Type::Person;
      Contact.TypeChange;
      Contact.SetSkipDefault;
      Contact.INSERT(TRUE);

      ContactBusinessRelation.INIT;
      ContactBusinessRelation."Contact No." := Contact."No.";
      ContactBusinessRelation."Business Relation Code" := RMSetup."Bus. Rel. Code for Employees";
      ContactBusinessRelation."Link to Table" := ContactBusinessRelation."Link to Table"::Employee;
      ContactBusinessRelation."No." := Employee."No.";
      ContactBusinessRelation.INSERT(TRUE);
    END;

    [External]
    PROCEDURE OnModifyRelation@1210190003(VAR Employee@1000 : Record 5200;OldEmployee@1100485002 : Record 5200);
    VAR
      ContactBusinessRelation@1100528700 : Record 5054;
      Contact@1100528701 : Record 5050;
      OldContact@1210190000 : Record 5050;
      FieldCaption@1100485001 : Text[132];
      RecRef@1100528702 : RecordRef;
    BEGIN
      //**4PS
      RMSetup.GET;
      IF RMSetup."Bus. Rel. Code for Employees" = '' THEN
        EXIT;

      ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      ContactBusinessRelation.SETRANGE("Link to Table", ContactBusinessRelation."Link to Table"::Employee);
      ContactBusinessRelation.SETRANGE("No.", Employee."No.");
      IF NOT ContactBusinessRelation.FINDFIRST THEN BEGIN
        InsertNewContact(Employee);
        EXIT;
      END;

      Contact.GET(ContactBusinessRelation."Contact No.");
      OldContact := Contact;

      FieldCaption := CheckTransferFields(Employee, OldEmployee);
      IF FieldCaption <> '' THEN BEGIN
        RecRef.GETTABLE(Contact);
        //X016.sn
        IF NOT CentralDataMngmnt.DataInputAllowed(RecRef) THEN
          ERROR(Text11012012, FieldCaption, CentralDataMngmnt.CentralCompany);

        //X016.en
        MODIFY; //Necessary for SQL
        OnTransferFields(Contact, Employee);
        Contact.VALIDATE("First Name");
        Contact.OnModifyFunc(OldContact, TRUE);
        Contact."Relation changed by" :=
          Contact."Relation changed by"::Employee;  //db, 05-09-06: next line also executes function OnModify(xRec)
        Contact.MODIFY(TRUE);
      END;
    END;

    [External]
    PROCEDURE OnDeleteRelation@1210190002(VAR Employee@1000 : Record 5200);
    VAR
      ContactBusinessRelation@1100528700 : Record 5054;
    BEGIN
      //**4PS
      ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      ContactBusinessRelation.SETRANGE("Link to Table", ContactBusinessRelation."Link to Table"::Employee);
      ContactBusinessRelation.SETRANGE("No.", Employee."No.");
      ContactBusinessRelation.DELETEALL(TRUE);
    END;

    [External]
    PROCEDURE OnRenameRelation@1100530000(VAR Empl@1000 : Record 5200;OldEmpl@1100530000 : Record 5200);
    BEGIN
      //**4PS MC-026864
      RMSetup.GET;
      IF RMSetup."Bus. Rel. Code for Employees" = '' THEN
        EXIT;

      WITH ContBusRel DO BEGIN
        SETCURRENTKEY("Link to Table","No.");
        SETRANGE("Link to Table","Link to Table"::Employee);
        SETRANGE("No.", OldEmpl."No.");
        IF FINDSET(TRUE, FALSE) THEN BEGIN
          "No." := Empl."No.";
          MODIFY(TRUE);
        END;
      END;
    END;

    [External]
    PROCEDURE OnTransferFields@1210190007(VAR Cont@1210190000 : Record 5050;VAR Empl@1210190001 : Record 5200);
    BEGIN
      //**4PS
      WITH Cont DO BEGIN
      // The sequence of the fields below corresponds with the field
      // sequence of the employee table definition.
      // If change, change also function in codeunit 5055.
        "First Name" := Empl."First Name";
        "Middle Name" := Empl."Middle Name";
        Surname := COPYSTR(Empl."Last Name", 1, MAXSTRLEN(Surname));
        Initials := Empl.Initials;
        "Search Name" := COPYSTR(Empl."Search Name",1,MAXSTRLEN(Cont."Search Name"));
        Address := Empl.Address;
        "Address 2" := Empl."Address 2";
        City := Empl.City;
        "Post Code" := Empl."Post Code";
        County := Empl.County;
        "Phone No." := Empl."Phone No.";
        "Mobile Phone No." := Empl."Mobile Phone No.";
        "E-Mail" := Empl."E-Mail";
        VALIDATE("Birth Date 1", Empl."Birth Date");
        IF Gender <> Empl.Gender THEN
          VALIDATE(Gender, Empl.Gender); //This updates salutation on sex change
        "Country/Region Code" := Empl."Country/Region Code";
        "Fax No." := Empl."Fax No.";
        Title := Empl.Title;
        "Salesperson Code" := Empl."Salespers./Purch. Code";
        "Name Abbreviation" := Empl."Name Abbreviation";
        "Title Behind the Name" := Empl."Title behind the Name";
        Name := CalculatedName(1);
        "Relation changed by" := "Relation changed by"::Employee;
      END;
    END;

    [External]
    PROCEDURE CheckTransferFields@1100485005(Empl@1210190001 : Record 5200;OldEmpl@1100485000 : Record 5200) : Text[132];
    BEGIN
      //**4PS
      WITH OldEmpl DO BEGIN
        IF "First Name" <> Empl."First Name" THEN
          EXIT(FIELDCAPTION("First Name"));
        IF "Middle Name" <> Empl."Middle Name" THEN
          EXIT(FIELDCAPTION("Middle Name"));
        IF "Last Name" <> Empl."Last Name" THEN
          EXIT(FIELDCAPTION("Last Name"));
        IF Initials <> Empl.Initials THEN
          EXIT(FIELDCAPTION(Initials));
        IF "Search Name" <> Empl."Search Name" THEN
          EXIT(FIELDCAPTION("Search Name"));
        IF Address <> Empl.Address THEN
          EXIT(FIELDCAPTION(Address));
        IF "Address 2" <> Empl."Address 2" THEN
          EXIT(FIELDCAPTION("Address 2"));
        IF City <> Empl.City THEN
          EXIT(FIELDCAPTION(City));
        IF "Post Code" <> Empl."Post Code" THEN
          EXIT(FIELDCAPTION("Post Code"));
        IF County <> Empl.County THEN
          EXIT(FIELDCAPTION(County));
        IF "Phone No." <> Empl."Phone No." THEN
          EXIT(FIELDCAPTION("Phone No."));
        IF "Mobile Phone No." <> Empl."Mobile Phone No." THEN
          EXIT(FIELDCAPTION("Mobile Phone No."));
        IF "E-Mail" <> Empl."E-Mail" THEN
          EXIT(FIELDCAPTION("E-Mail"));
        IF "Birth Date" <> Empl."Birth Date" THEN
          EXIT(FIELDCAPTION("Birth Date"));
        IF Gender <> Empl.Gender THEN
          EXIT(FIELDCAPTION(Gender));
        IF "Country/Region Code" <> Empl."Country/Region Code" THEN
          EXIT(FIELDCAPTION("Country/Region Code"));
        IF "Fax No." <> Empl."Fax No." THEN
          EXIT(FIELDCAPTION("Fax No."));
        IF Title <> Empl.Title THEN
          EXIT(FIELDCAPTION(Title));
        IF "Salespers./Purch. Code" <> Empl."Salespers./Purch. Code" THEN
          EXIT(FIELDCAPTION("Salespers./Purch. Code"));
        IF "Name Abbreviation" <> Empl."Name Abbreviation" THEN
          EXIT(FIELDCAPTION("Name Abbreviation"));
        IF "Title behind the Name" <> Empl."Title behind the Name" THEN
          EXIT(FIELDCAPTION("Title behind the Name"));
      END;
    END;

    [External]
    PROCEDURE ExchangeFSA@1100485002(IMode@1100485003 : Code[1]);
    VAR
      lvProjSetupRec@1100485001 : Record 315;
    BEGIN
      //**4PS.n
      IF IMode = 'I' THEN BEGIN
        "Export to FSA" := FALSE;
        "Date/Time Export to FSA" := 0DT;
      END;
      lvProjSetupRec.GET;
      IF lvProjSetupRec."Field Service Active" THEN BEGIN
        //* Deleting only permitted when Field Service Active is set to 'False'
        //* (or when not switched at all). When export to FSA is 'False' at exporting,
        //* field date/time will be made empty. From that moment the employee can be deleted.
        //* Most of time an employee will not be deleted. When fired the employee will be set to inactive.
        //* Probably many years later the employee will be deleted from the system, but at that time
        //* the status is already exported to Field Service.
        //* Note: There are also changes maded in the XML-port for this.
      //    "Active in FSA" moved to Resource table. Reconsider this whenever the link with FieldVision will be transferred to NAV2013.
      //     Now switch off for DP00465 do not take into account FV (Andre)
      //  IF IMode <> 'D' THEN BEGIN
      //    IF "Active in FSA" OR ((NOT "Active in FSA") AND ("Date/Time Export to FSA" <> 0DT)) THEN
      //      "Export to FSA" := TRUE;
      //    IF IMode = 'R' THEN BEGIN
      //      IF (xRec."Date/Time Export to FSA" <> 0DT) THEN
      //        ERROR(Text11012007 + '\ \' + Text11012008);
      //    END;
      //  END ELSE BEGIN
      //    IF ("Date/Time Export to FSA" <> 0DT) THEN
      //      ERROR(Text11012007 + '\ \' + Text11012008);
      //  END;
      END;
    END;

    [External]
    PROCEDURE ShowContact@1210190011();
    VAR
      ContBusRel@1000 : Record 5054;
      Cont@1001 : Record 5050;
    BEGIN
      //**4PS
      IF "No." = '' THEN EXIT;

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Employee);
      ContBusRel.SETRANGE("No.","No.");
      IF NOT ContBusRel.FINDFIRST THEN EXIT;

      Cont.GET(ContBusRel."Contact No.");
      //PAGE.RUN(PAGE::"Contact Card",Cont); //**4PS.o
      Cont.RunContactForm; //**4PS.n
    END;

    [External]
    PROCEDURE AvailableHours@1100485001() Hours : Decimal;
    VAR
      DateRec@1100485000 : Record 2000000007;
      TimeTableRec@1100485003 : Record 11012923;
    BEGIN
      IF NOT TimeTableRec.READPERMISSION THEN
        EXIT(0);

      TimeTableRec.SETRANGE("Employee No.", "No.");
      IF NOT TimeTableRec.FINDFIRST THEN
        EXIT(0);

      IF GETFILTER("Date Filter" ) = '' THEN
        EXIT(0);

      Hours := 0;
      DateRec.SETRANGE("Period Type", DateRec."Period Type"::Date);
      DateRec.SETFILTER("Period Start", GETFILTER("Date Filter"));
      DateRec.SETRANGE("Period No.", 1);
      IF DateRec.FINDSET THEN BEGIN
        REPEAT
          TimeTableRec.SETFILTER("Effective Date", '..%1', DateRec."Period Start");
          IF TimeTableRec.FINDLAST THEN
            Hours := Hours + TimeTableRec.Monday;
        UNTIL DateRec.NEXT = 0;
      END;

      DateRec.SETRANGE("Period No.", 2);
      IF DateRec.FINDSET THEN BEGIN
        REPEAT
          TimeTableRec.SETFILTER("Effective Date", '..%1', DateRec."Period Start");
          IF TimeTableRec.FINDLAST THEN
            Hours := Hours + TimeTableRec.Tuesday;
        UNTIL DateRec.NEXT = 0;
      END;

      DateRec.SETRANGE("Period No.", 3);
      IF DateRec.FINDSET THEN BEGIN
        REPEAT
          TimeTableRec.SETFILTER("Effective Date", '..%1', DateRec."Period Start");
          IF TimeTableRec.FINDLAST THEN
            Hours := Hours + TimeTableRec.Wednesday;
        UNTIL DateRec.NEXT = 0;
      END;

      DateRec.SETRANGE("Period No.", 4);
      IF DateRec.FINDSET THEN BEGIN
        REPEAT
          TimeTableRec.SETFILTER("Effective Date", '..%1', DateRec."Period Start");
          IF TimeTableRec.FINDLAST THEN
            Hours := Hours + TimeTableRec.Thursday;
        UNTIL DateRec.NEXT = 0;
      END;

      DateRec.SETRANGE("Period No.", 5);
      IF DateRec.FINDSET THEN BEGIN
        REPEAT
          TimeTableRec.SETFILTER("Effective Date", '..%1', DateRec."Period Start");
          IF TimeTableRec.FINDLAST THEN
            Hours := Hours + TimeTableRec.Friday;
        UNTIL DateRec.NEXT = 0;
      END;

      DateRec.SETRANGE("Period No.", 6);
      IF DateRec.FINDSET THEN BEGIN
        REPEAT
          TimeTableRec.SETFILTER("Effective Date", '..%1', DateRec."Period Start");
          IF TimeTableRec.FINDLAST THEN
            Hours := Hours + TimeTableRec.Saturday;
        UNTIL DateRec.NEXT = 0;
      END;

      DateRec.SETRANGE("Period No.", 7);
      IF DateRec.FINDSET THEN BEGIN
        REPEAT
          TimeTableRec.SETFILTER("Effective Date", '..%1', DateRec."Period Start");
          IF TimeTableRec.FINDLAST THEN
            Hours := Hours + TimeTableRec.Sunday;
        UNTIL DateRec.NEXT = 0;
      END;

      EXIT(Hours);
    END;

    [External]
    PROCEDURE CheckExportToFSA@1100485010(ICurrFieldNo@1100485002 : Integer);
    VAR
      MandatoryFields@1100485001 : Record 11125651;
      Resource@1100525000 : Record 11229278;
    BEGIN
      //**4PS
      //* When 'ICurrFieldNo = 0' then check all fields, else only specific field.

      //DP00465.so
      //IF NOT "Active in FSA" THEN
      //  EXIT;
      //lvProjSetupRec.GET;
      //IF (NOT lvProjSetupRec."Field Service Active") AND (NOT lvProjSetupRec."4PS-Mobile Active") THEN BEGIN
      //  IF "Active in FSA" THEN
      //    //"Active in FSA" := FALSE;  //* No (error)message, just switch off //16397.o
      //    ERROR(Text11012015, FIELDCAPTION("Active in FSA"));  //16397.n
      //  EXIT;
      //END;
      //DP00465.eo
      //DP00465.sn
      Resource.SETCURRENTKEY(Type, Company, "Source No.");
      Resource.SETRANGE(Type, Resource.Type::Employee);
      Resource.SETRANGE(Company, COMPANYNAME);
      Resource.SETRANGE("Source No.", "No.");
      Resource.SETRANGE("Active in FSA", TRUE);
      IF Resource.ISEMPTY THEN
        EXIT;
      //DP00465.en


      MandatoryFields.CheckMandatoryFieldsEmployee(Rec, ICurrFieldNo);
    END;

    [External]
    PROCEDURE SetInsertFromContact@1100485993(FromContact@1000 : Boolean);
    BEGIN
      //**4PS
      InsertFromContact := FromContact;
    END;

    [External]
    PROCEDURE GetExternalRentalHourRate@1100485003(iRefDate@1100485001 : Date) HourRate : Decimal;
    VAR
      lvExtRentalRateRec@1100485000 : Record 11020315;
    BEGIN
      //**4PS05.sn
      lvExtRentalRateRec.SETRANGE("Employee No.", "No.");
      lvExtRentalRateRec.SETRANGE("Starting Date", 0D, iRefDate);
      IF lvExtRentalRateRec.FINDLAST THEN
        EXIT(lvExtRentalRateRec."Cost Price (LCY)")
      ELSE
        EXIT(0);
      //**4PS05.en
    END;

    [External]
    PROCEDURE RunCreatePlantLocation@1100485004(IEmplRec@1100485002 : Record 5200);
    VAR
      PlantMgtCompRec@1100525005 : Record 11020586;
      TmpPlantMgtCompRec@1100525004 : TEMPORARY Record 11020586;
      PlantMgtCompListFrm@1100525003 : Page 11124918;
      NoOfPlantComps@1100525002 : Integer;
      NoCreated@1100525001 : Integer;
      lvPlantLocCode@1100485000 : Code[20];
      lvText11012001@1100525000 : TextConst 'ENU=Do you want to create a Plant Location of Employee ''%1''?;NOR=Vil du opprette en maskinlokasjon for ansatt ''%1''?;SVE=Vill du skapa en Maskinsplats fîr anstÑlld ''%1''?';
      lvText11012003@1100485003 : TextConst 'ENU=Plant Location ''%1'' is created in plant company ''%2''.;NOR=Maskinlokasjon ''%1'' er opprettet i maskinselskap ''%2''.;SVE=Lagerplats ''%1'' Ñr skapad i Maskinsfîretag ''%2''.';
      lvText11012004@1100485004 : TextConst 'ENU=Plant Location ''%1'' is created in %2 plant companies.;NOR=Maskinlokasjon ''%1'' er opprettet i %2 maskinselskaper.;SVE=Lagerplats ''%1'' Ñr skapad i %2 Maskinsfîretag.';
    BEGIN
      //**4PS
      IF NOT CONFIRM(lvText11012001, TRUE, IEmplRec."No.") THEN
        EXIT;

      NoCreated := 0;
      PlantMgtCompRec."Plant Company" := PlantMgtCompRec.GetPlantCompany(TRUE, NoOfPlantComps, '');
      IF NoOfPlantComps = 1 THEN BEGIN
        lvPlantLocCode := CreatePlantLocation(IEmplRec, PlantMgtCompRec."Plant Company");
        IF lvPlantLocCode <> '' THEN
          NoCreated := 1;
      END ELSE BEGIN
        PlantMgtCompRec.RESET;
        PlantMgtCompListFrm.SetMultiCreate();
        PlantMgtCompListFrm.SETRECORD(PlantMgtCompRec);
        PlantMgtCompListFrm.LOOKUPMODE(TRUE);
        IF PlantMgtCompListFrm.RUNMODAL = ACTION::LookupOK THEN BEGIN
          IF NOT PlantMgtCompListFrm.GetMarkedRecords(TmpPlantMgtCompRec) THEN BEGIN
            PlantMgtCompListFrm.GETRECORD(PlantMgtCompRec);
            lvPlantLocCode := CreatePlantLocation(IEmplRec, PlantMgtCompRec."Plant Company");
            IF lvPlantLocCode <> '' THEN
              NoCreated := 1;
          END ELSE BEGIN
            TmpPlantMgtCompRec.FINDSET;
            REPEAT
              lvPlantLocCode := CreatePlantLocation(IEmplRec, TmpPlantMgtCompRec."Plant Company");
              IF lvPlantLocCode <> '' THEN BEGIN
                NoCreated := NoCreated + 1;
                PlantMgtCompRec."Plant Company" := TmpPlantMgtCompRec."Plant Company";
              END;
            UNTIL TmpPlantMgtCompRec. NEXT = 0;
          END;
        END;
      END;

      IF NoCreated > 0 THEN BEGIN
        IF NoCreated = 1 THEN
          MESSAGE(lvText11012003, lvPlantLocCode, PlantMgtCompRec."Plant Company")
        ELSE
          MESSAGE(lvText11012004, lvPlantLocCode, NoCreated);
      END;
    END;

    [External]
    PROCEDURE CreatePlantLocation@1100485007(IEmplRec@1100485000 : Record 5200;IPlantCompany@1100485010 : Text[30]) : Code[20];
    VAR
      lvEmplSetupRec@1100485007 : Record 5218;
      lvPlantSetupRec@1100485004 : Record 11012550;
      CompanyData@1100485006 : Record 11020674;
      lvPlantLocRec@1100485001 : Record 11012554;
      lvPlantLocRec2@1100485002 : Record 11012554;
      lvText11012001@1100529000 : TextConst 'ENU=must be present/filled (via field ''%1'' of %2  in plant company ''%3'')';
      lvText11012003@1100485009 : TextConst 'ENU=Plant Location ''%1'' is already present in Company ''%2'' with Employee ''%3'' and Company Name ''%4''.;NOR=Maskinlokasjonen ''%1'' finnes allerede i bedriften ''%2'' med ansatt ''%3'' og selskapsnavn ''%4''.;SVE=Maskinutplaceringen ''%1'' finns redan i fîretaget ''%2'' med den anstÑllda ''%3'' och fîretagsnamnet ''%4''.';
      lvDimValRec@1100525000 : Record 349;
      CompanyPlantLocNoSeries@1100529002 : Record 11229940;
      NoSeriesMgt@1100529001 : Codeunit 396;
    BEGIN
      //**4PS
      //* Add employee location to 'plant company' from 'employee company', this can be another company
      //* so do not use 'VALIDATE'/'INSERT/MODIFY(TRUE)' on table Plant Location!

      WITH IEmplRec DO BEGIN
        TESTFIELD("No.");
        TESTFIELD(Status, Status::Active);

        lvEmplSetupRec.GET;
        lvEmplSetupRec.TESTFIELD("Build Plant Location Code from");

        IF NOT CompanyData.GET(COMPANYNAME) THEN  //* Current company, so not plant company
          CompanyData."Company Name" := COMPANYNAME;

        IF (CompanyData."Company No." = '') AND
           (lvEmplSetupRec."Build Plant Location Code from" = lvEmplSetupRec."Build Plant Location Code from"::CompNoEmplNo)
        THEN
          CompanyData.TESTFIELD("Company No.");
        IF lvEmplSetupRec."Build Plant Location Code from" = lvEmplSetupRec."Build Plant Location Code from"::NoSeries THEN BEGIN
          CompanyPlantLocNoSeries.CHANGECOMPANY(IPlantCompany);
          IF NOT CompanyPlantLocNoSeries.GET(COMPANYNAME) THEN BEGIN
            CompanyPlantLocNoSeries.INIT;
            CompanyPlantLocNoSeries."Company Name" := COMPANYNAME;
          END;
          IF CompanyPlantLocNoSeries."Plant Location Nos. Employees" = '' THEN
            CompanyPlantLocNoSeries.FIELDERROR("Plant Location Nos. Employees",
              STRSUBSTNO(lvText11012001, lvPlantSetupRec.FIELDCAPTION("Plant Location Nos."), lvPlantSetupRec.TABLECAPTION, IPlantCompany));
        END;

        lvPlantSetupRec.CHANGECOMPANY(IPlantCompany);
        lvPlantSetupRec.GET;

        lvPlantLocRec2.CHANGECOMPANY(IPlantCompany);

        lvPlantLocRec.CHANGECOMPANY(IPlantCompany);
        lvPlantLocRec.INIT;
        lvPlantLocRec.InitRecord;
        CASE lvEmplSetupRec."Build Plant Location Code from" OF
          lvEmplSetupRec."Build Plant Location Code from"::EmplNo:
            lvPlantLocRec.Code := "No.";
          lvEmplSetupRec."Build Plant Location Code from"::CompNoEmplNo:
            lvPlantLocRec.Code := CompanyData."Company No." + "No.";
          lvEmplSetupRec."Build Plant Location Code from"::NoSeries:
            BEGIN
              IF IPlantCompany <> COMPANYNAME THEN
                NoSeriesMgt.SetFromOtherCompany(IPlantCompany);
              lvPlantLocRec.Code := NoSeriesMgt.GetNextNo(CompanyPlantLocNoSeries."Plant Location Nos. Employees", 0D, TRUE);
              lvPlantLocRec."No. Series" := CompanyPlantLocNoSeries."Plant Location Nos. Employees";
            END;
          ELSE
            lvPlantLocRec.Code := '';
        END;
        lvPlantLocRec.TESTFIELD(Code);
        IF lvPlantLocRec2.GET(lvPlantLocRec.Code) THEN
          ERROR(lvText11012003, lvPlantLocRec.Code, IPlantCompany, lvPlantLocRec2."Employee No.", lvPlantLocRec2."Company Name");

        lvPlantLocRec."Creation Date" := TODAY;
        lvPlantLocRec.Depot :=  FALSE;
        lvPlantLocRec."Employee No." :=  "No.";
        IF IPlantCompany <> COMPANYNAME THEN BEGIN
          lvPlantLocRec."Company Name" := COMPANYNAME;
          //
          //* Only allowed to fill customer no. (mandatory with number from company table) when companyname is filled.
          CompanyData.TESTFIELD("Customer No.");
          lvPlantLocRec."Customer No." := CompanyData."Customer No.";
        END;
        lvPlantLocRec.Description :=  COPYSTR(IEmplRec."Full Name",1,MAXSTRLEN(lvPlantLocRec.Description));
        lvPlantLocRec."Search Name" := COPYSTR(IEmplRec."Search Name",1,MAXSTRLEN(lvPlantLocRec."Search Name"));
        //C013440.so
        //lvPlantLocRec.Address := Address;
        //lvPlantLocRec."Address 2" := "Address 2";
        //lvPlantLocRec."Post Code" := "Post Code";
        //C013440.eo
        lvPlantLocRec.City := City;
        lvPlantLocRec."Country/Region Code" := "Country/Region Code";
        //C013440.so
        //lvPlantLocRec."Phone No." := "Phone No.";
        //lvPlantLocRec."Fax No." := "Fax No.";
        //C013440.eo
        //C013440.sn
        lvPlantLocRec."Phone No." := COPYSTR("Company Mobile Phone No." + ' / ' + "Company Phone No.", 1, MAXSTRLEN(lvPlantLocRec."Phone No."));
        lvPlantLocRec."E-Mail" := "Company E-Mail";
        //C013440.en
        lvPlantLocRec."Starting Date" := "Employment Date";
        IF "Global Dimension 1 Code" <> '' THEN BEGIN  //*24614.sn
          IF IPlantCompany = COMPANYNAME THEN
            lvPlantLocRec."Department Code" := "Global Dimension 1 Code"
          ELSE BEGIN
            lvDimValRec.CHANGECOMPANY(IPlantCompany);
            lvDimValRec.SETCURRENTKEY(Code, "Global Dimension No.");
            lvDimValRec.SETRANGE(Code, "Global Dimension 1 Code");
            lvDimValRec.SETRANGE("Global Dimension No.", 1);
            IF lvDimValRec.FINDFIRST THEN
              lvPlantLocRec."Department Code" := "Global Dimension 1 Code";
          END;
        END;                                           //*24614.en
        lvPlantLocRec.NormalizePostCodeHouseNo;//DP00195
        lvPlantLocRec.FillDefaultFromDepotPlantNeed;
        lvPlantLocRec.INSERT;
        EXIT(lvPlantLocRec.Code);
      END;
    END;

    [External]
    PROCEDURE DetermineAccountHours@1210190005();
    VAR
      Employee@1210190000 : Record 5200;
    BEGIN
      //**4PS
      SkipAccHoursDefaultOnInsert := TRUE;
      IF Status IN [Status::Inactive, Status::Terminated] THEN
        "Account Hours" := "Account Hours"::"Not allowed"
      ELSE BEGIN
        IF ("Norm Hours" <> 0) OR ("Norm Days" <> 0) THEN
          "Account Hours" := "Account Hours"::"Required according to Norm"
        ELSE BEGIN
          Employee := Rec;
          IF NOT Employee.FIND THEN
            SkipAccHoursDefaultOnInsert := FALSE;
        END;
      END;
    END;

    [External]
    PROCEDURE DPA_SetDefaultDpmtFromNoSeries@1100000995(xRecRef@1100525002 : RecordRef);
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      xRecRef.SETTABLE(xRec);
      DPA_Management.SetDepartmentCodeNoSeries(
        TABLENAME,
        "Global Dimension 1 Code",
        "No. Series",
        xRec."No. Series" );
    END;

    LOCAL PROCEDURE DPA_OnInsert@1100000991();
    VAR
      Dimension1Code@1100528400 : Code[20];
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      Dimension1Code :=
        DPA_Management.GetNoSeriesDepartmentCode(
          "No. Series",
          xRec."No. Series",
          DATABASE::Employee);
      IF Dimension1Code <> '' THEN
        "Global Dimension 1 Code" := Dimension1Code;

      IF "Global Dimension 1 Code" <> '' THEN BEGIN
        SkipModify := TRUE;
        VALIDATE("Global Dimension 1 Code");
        SkipModify := FALSE;
      END;
    END;

    [External]
    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    [External]
    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    [External]
    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Global Dimension 1 Filter"));
    END;

    [External]
    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(5200) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 5200');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    [External]
    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::Employee, "Global Dimension 1 Code", IsHardFilter);
    END;

    [External]
    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Global Dimension 1 Code"));
    END;

    [External]
    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Global Dimension 1 Code");
    END;

    [External]
    PROCEDURE EditDocuments@1100528702(ContactNo@1210190004 : Code[20];ContactPersonNo@1210190005 : Code[20];SendMail@1210190002 : Boolean;Recipient@1100528700 : Text[120]);
    VAR
      DocumentMailing@1210190000 : Codeunit 11012278;
      RecRef@1100525000 : RecordRef;
      DocumentLinkRIDs@1100525001 : ARRAY [5] OF RecordID;
    BEGIN
      //**4PS
      RecRef.GETTABLE(Rec);
      DocumentLinkRIDs[1] := RecRef.RECORDID;

      DocumentMailing.EditDocuments('', DocumentLinkRIDs, '', ContactNo, ContactPersonNo, SendMail, Recipient);
    END;

    LOCAL PROCEDURE NoChangedAsResultOfFiltering@1100528700() : Boolean;
    BEGIN
      //**4PS
      IF ("No." <> xRec."No.") AND (GETFILTER("No.") = "No.") THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE GetResourceNo@1100525002() : Code[20];
    BEGIN
      //**4PS
      EXIT(GetResourceNoWithCompany(COMPANYNAME));
    END;

    [External]
    PROCEDURE GetResourceNoWithCompany@1100528600(ICompanyName@1100528601 : Text[30]) : Code[20];
    VAR
      ResourceWOP@1100528600 : Record 11229278;
    BEGIN
      //**4PS
      IF "No." <> '' THEN BEGIN
        ResourceWOP.SETCURRENTKEY(Type, Company, "Source No.");
        ResourceWOP.SETRANGE(Type, ResourceWOP.Type::Employee);
        ResourceWOP.SETRANGE(Company, ICompanyName);
        ResourceWOP.SETRANGE("Source No.", "No.");
        IF ResourceWOP.FINDFIRST THEN
          EXIT(ResourceWOP."No.");
      END;
      EXIT('');
    END;

    [External]
    PROCEDURE ShowResourceEmployee@1100525003();
    VAR
      Resource@1100525001 : Record 11229278;
    BEGIN
      //**4PS
      Resource."No." := GetResourceNo();
      IF Resource."No." <> '' THEN
        Resource.GET(Resource."No.");
      Resource.SETRANGE(Company, COMPANYNAME);
      PAGE.RUNMODAL(PAGE::"Employee Resource List", Resource);
    END;

    [External]
    PROCEDURE UpdateResource@1100525001(UpdateMode@1100525002 : ',Modify,Delete,Rename';xEmpl@1100525003 : Record 5200;Empl@1100525004 : Record 5200);
    VAR
      WorkOrderPlanningSetup@1100525000 : Record 11229277;
      ResourceMgt@1100525001 : Codeunit 11229277;
    BEGIN
      //**4PS
      IF NOT WorkOrderPlanningSetup.ISEMPTY THEN
        ResourceMgt.UpdateResourceEmployee(UpdateMode, xEmpl, Empl);
    END;

    [External]
    PROCEDURE CheckEmployeeStatus@1100529600(EmployeeNo@1100529600 : Code[20];CheckDate@1100529601 : Date);
    VAR
      EmployeeLoc@1100529602 : Record 5200;
    BEGIN
      //**4PS
      IF EmployeeNo = '' THEN
        EXIT;
      EmployeeLoc.GET(EmployeeNo);
      IF CheckDate = 0D THEN
        CheckDate := WORKDATE;
      IF (EmployeeLoc."Termination Date" <> 0D) AND (EmployeeLoc."Termination Date" < CheckDate) THEN
        ERROR(Text11012019, EmployeeNo, EmployeeLoc."Termination Date");
      IF (EmployeeLoc."Inactive Date" <> 0D) AND (EmployeeLoc."Inactive Date" < CheckDate) THEN
        ERROR(Text11012020, EmployeeNo, EmployeeLoc."Inactive Date");
    END;

    [External]
    PROCEDURE GetTableOfEmployeesWithCertainDiscipline@1100528500(VAR EmployeeWithCertainDiscipline@1100528500 : Record 5200;DisciplineFilter@1100528501 : Text);
    VAR
      Employee@1100528502 : Record 5200;
      ResourceWOP@1100528503 : Record 11229278;
    BEGIN
      //**4PS
      Employee.SETFILTER(Discipline,DisciplineFilter);
      IF Employee.FINDSET THEN
        REPEAT
          EmployeeWithCertainDiscipline := Employee;
          EmployeeWithCertainDiscipline.INSERT;
        UNTIL Employee.NEXT = 0;

      IF DisciplineFilter = '' THEN
        EXIT;

      ResourceWOP.SETRANGE(Type, ResourceWOP.Type::Employee);
      ResourceWOP.SETRANGE(Company,COMPANYNAME);
      ResourceWOP.SETFILTER("Discipline Filter",DisciplineFilter);
      ResourceWOP.SETRANGE("Discipline Exist",TRUE);
      IF ResourceWOP.FINDSET THEN
        REPEAT
          IF Employee.GET(ResourceWOP."Source No.") THEN BEGIN
            EmployeeWithCertainDiscipline := Employee;
            IF EmployeeWithCertainDiscipline.INSERT THEN;
          END;
        UNTIL ResourceWOP.NEXT = 0;
    END;

    [External]
    PROCEDURE GetEmployeeDisciplines@1100528501() Disciplines : Code[250];
    VAR
      ResourceWOP@1100528503 : Record 11229278;
      ResourceDiscipline@1100528501 : Record 11229286;
    BEGIN
      //**4PS
      Disciplines := Discipline;

      ResourceWOP.SETRANGE(Type, ResourceWOP.Type::Employee);
      ResourceWOP.SETRANGE(Company,COMPANYNAME);
      ResourceWOP.SETRANGE("Source No.","No.");
      ResourceWOP.SETRANGE("Discipline Exist",TRUE);
      IF ResourceWOP.FINDSET THEN
        REPEAT
          ResourceDiscipline.SETRANGE("Resource No.",ResourceWOP."No.");
          IF ResourceDiscipline.FINDSET THEN
            REPEAT
              IF ResourceDiscipline.Discipline <> Discipline THEN
                IF Disciplines = '' THEN
                  Disciplines := ResourceDiscipline.Discipline
                ELSE
                  Disciplines += '|' + ResourceDiscipline.Discipline;
            UNTIL ResourceDiscipline.NEXT = 0;
        UNTIL ResourceWOP.NEXT = 0;
    END;

    LOCAL PROCEDURE RenameSiteMgtHoursEmployeeNo@1100527650();
    VAR
      SiteMngmntHoursEmployee@1100527650 : Record 11012357;
    BEGIN
      IF ("No." <> xRec."No.") AND SiteMngmntHoursEmployee.GET(COMPANYNAME, xRec."No.") THEN
        SiteMngmntHoursEmployee.RENAME(COMPANYNAME, "No.");
    END;

    BEGIN
    {
      SESB.I028 Cost Codes and Wage Component filter
         VKO 03.07.2013 Field 11128230 "Labour Rule" added

      SESB.I029 Default value type of time
         ASH 03.07.2013 Field 11128231 "Default Line Type" added

      4PSSE.IME-093, WvG, fixed update fill name when changing first name

      4PSSE.IMSE-047B, GH  added Key: Salary No.

      140416 ITERO.MH 4PSHM Added field "Last updated" and code onInsert() and onModify()
      140530 ITERO.DL 4PS-039 Department authorization R2
      170419 ITERO.DL RFC089 Hour accounting to other department (Glob.Dim.1) than own
      180427 ORANGO.DL RFC150 Default value for Team code
    }
    END.
  }
}

