OBJECT Table 11071806 Service Survey Structure Line
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF "Object Line" THEN BEGIN
                 IF "Line No." = 0 THEN
                   "Line No." := GetNextLineNo();
                 Level := GetLevel;
               END;
               TestUniqueEntryNo;
             END;

    OnDelete=VAR
               ServiceSurvey@1100528602 : Record 11071803;
               ServiceSurveyStructureLine@1100528600 : Record 11071806;
               ServSurvLocationObject@1100528601 : Record 11071813;
             BEGIN
               IF NOT "Object Line" THEN BEGIN
                 ServiceSurveyStructureLine.SETRANGE("Survey No.","Survey No.");
                 ServiceSurveyStructureLine.SETRANGE("Location Code", "Location Code");
                 ServiceSurveyStructureLine.SETRANGE("Structure No.", "Structure No.");
                 ServiceSurveyStructureLine.SETRANGE(Code, Code);
                 ServiceSurveyStructureLine.SETRANGE("Object Line", TRUE);

                 DeleteLowerLevelParts;

                 IF NOT ServiceSurveyStructureLine.ISEMPTY THEN
                   ServiceSurveyStructureLine.DELETEALL(TRUE);
               END ELSE BEGIN
                 ServiceSurvey.GET("Survey No.");
                 IF ServiceSurvey."Input Method" = ServiceSurvey."Input Method"::Structure THEN BEGIN
                   ServiceSurveyStructureLine.SETRANGE("Survey No.", "Survey No.");
                   ServiceSurveyStructureLine.SETRANGE("Location Code", "Location Code");
                   ServiceSurveyStructureLine.SETFILTER("Structure No.", '<>%1', "Structure No.");
                   ServiceSurveyStructureLine.SETRANGE("Seq. No.", "Seq. No.");
                   IF ServiceSurveyStructureLine.ISEMPTY THEN BEGIN
                     ServSurvLocationObject.SETRANGE("Survey No.", "Survey No.");
                     ServSurvLocationObject.SETRANGE("Location Code", "Location Code");
                     ServSurvLocationObject.SETRANGE("Seq. No.", "Seq. No.");
                     ServSurvLocationObject.SetRemovedFromStructureLine(TRUE);
                     IF ServSurvLocationObject.FINDSET THEN
                       REPEAT
                         ServSurvLocationObject.DELETE(TRUE);
                       UNTIL ServSurvLocationObject.NEXT = 0;
                   END;
                 END;
               END;
             END;

    CaptionML=[ENU=Service Survey Structure Line;
               NOR=Strukturrad for servicekartlegging;
               SVE=Srv.kartl. strukturlinje];
    LookupPageID=Page11229423;
  }
  FIELDS
  {
    { 10  ;   ;Survey No.          ;Code20        ;TableRelation="Service Survey";
                                                   CaptionML=[ENU=Survey No.;
                                                              NOR=Kartlegging nr.;
                                                              SVE=Kartl„ggningsnr];
                                                   NotBlank=Yes }
    { 20  ;   ;Location Code       ;Code10        ;TableRelation="Service Survey Location"."Location Code" WHERE (Survey No.=FIELD(Survey No.));
                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode;
                                                              SVE=Lagerst„llekod] }
    { 30  ;   ;Structure No.       ;Integer       ;TableRelation="Serv. Survey Loc. Structure"."Structure No." WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                      Location Code=FIELD(Location Code));
                                                   CaptionML=[ENU=Structure No.;
                                                              NOR=Strukturnr;
                                                              SVE=Strukturnr] }
    { 40  ;   ;Code                ;Code10        ;OnValidate=VAR
                                                                ServiceSurveyLocation@1100528600 : Record 11071804;
                                                                FormatManagement@1100528601 : Codeunit 11012022;
                                                              BEGIN
                                                                ServiceSurveyLocation.GET("Survey No.", "Location Code");
                                                                IF STRPOS(ServiceSurveyLocation."Location Structure Format", '.') > 0 THEN
                                                                  FormatManagement.CreateCalcLocStructureElement(
                                                                    "Survey No.", "Location Code", "Structure No.", "Element Level 1", "Element Level 2", Code, Level);
                                                                "Code Description" := GetCodeDescription;
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NOR=Kode;
                                                              SVE=Kod];
                                                   NotBlank=Yes }
    { 50  ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.;
                                                              SVE=Radnr] }
    { 52  ;   ;Code Description    ;Text100       ;CaptionML=[ENU=Code Description;
                                                              NOR=Kodebeskrivelse;
                                                              SVE=Kod,,,,,Beskrivning] }
    { 55  ;   ;Description         ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object".Description WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                       Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning];
                                                   Editable=No }
    { 57  ;   ;Description 2       ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Description 2" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                           Location Code=FIELD(Location Code),
                                                                                                                           Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2;
                                                              SVE=Beskrivning 2];
                                                   Editable=No }
    { 60  ;   ;Standard Object No. ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Standard Object No." WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                 Location Code=FIELD(Location Code),
                                                                                                                                 Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Standard Object No.;
                                                              NOR=Standardobjektnr;
                                                              SVE=Standardobjektsnr];
                                                   Editable=No }
    { 70  ;   ;Standard Object Description;Text100;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object".Description WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=[ENU=Standard Object Description;
                                                              NOR=Standard objektsbeskrivelse;
                                                              SVE=Standardobjektsbeskrivning];
                                                   Editable=No }
    { 75  ;   ;Standard Object Description 2;Text50;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Description 2" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=[ENU=Standard Object Description 2;
                                                              SVE=Standardobjektsbeskrivning 2];
                                                   Editable=No }
    { 80  ;   ;Quantity            ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object".Quantity WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                    Location Code=FIELD(Location Code),
                                                                                                                    Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall;
                                                              SVE=Antal];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 90  ;   ;Quantity per Object ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Quantity per Object" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                 Location Code=FIELD(Location Code),
                                                                                                                                 Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Quantity per Object;
                                                              NOR=Kvantum per objekt;
                                                              SVE=Antal per objekt];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 100 ;   ;Element Level 1     ;Code20        ;CaptionML=[ENU=Element Level 1;
                                                              NOR=Elementniv† 1;
                                                              SVE=Elementniv† 1];
                                                   Editable=No }
    { 110 ;   ;Element Level 2     ;Code20        ;CaptionML=[ENU=Element Level 2;
                                                              NOR=Elementniv† 2;
                                                              SVE=Elementniv† 2];
                                                   Editable=No }
    { 120 ;   ;Level               ;Integer       ;CaptionML=[ENU=Level;
                                                              NOR=Niv†;
                                                              SVE=Niv†];
                                                   Editable=No }
    { 130 ;   ;Object Line         ;Boolean       ;CaptionML=[ENU=Object Line;
                                                              NOR=Objektrad;
                                                              SVE=Objektrad] }
    { 140 ;   ;Service Package     ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Service Package" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                             Location Code=FIELD(Location Code),
                                                                                                                             Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Service Package;
                                                              NOR=Servicepakke;
                                                              SVE=Servicepaket];
                                                   Editable=No }
    { 150 ;   ;Seq. No.            ;Integer       ;TableRelation="Serv. Surv. Location Object"."Seq. No." WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                 Location Code=FIELD(Location Code));
                                                   CaptionML=[ENU=Seq. No.;
                                                              NOR=Sekv. nr;
                                                              SVE=Sekv. nr] }
    { 160 ;   ;Object Customer     ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Object Customer" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                             Location Code=FIELD(Location Code),
                                                                                                                             Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Object Customer;
                                                              NOR=Objektkunde;
                                                              SVE=Objektkund];
                                                   Editable=No }
    { 170 ;   ;In use since        ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."In use since" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                          Location Code=FIELD(Location Code),
                                                                                                                          Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=In use since;
                                                              NOR=I bruk siden;
                                                              SVE=Anv„nds sedan];
                                                   Editable=No }
    { 180 ;   ;Warranty Starting Date;Date        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Warranty Starting Date" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                    Location Code=FIELD(Location Code),
                                                                                                                                    Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Warranty Starting Date;
                                                              NOR=Garantiens startdato;
                                                              SVE=Garanti, startdatum];
                                                   Editable=No }
    { 190 ;   ;Warranty Code       ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Warranty Code" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                           Location Code=FIELD(Location Code),
                                                                                                                           Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Warranty Code;
                                                              NOR=Garantikode;
                                                              SVE=Garantikod];
                                                   Editable=No }
    { 200 ;   ;Building            ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object".Building WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                    Location Code=FIELD(Location Code),
                                                                                                                    Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Building;
                                                              NOR=Byggning;
                                                              SVE=Byggnad];
                                                   Editable=No }
    { 210 ;   ;Floor               ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object".Floor WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                 Location Code=FIELD(Location Code),
                                                                                                                 Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Floor;
                                                              NOR=Gulv;
                                                              SVE=V†ning];
                                                   Editable=No }
    { 220 ;   ;Room                ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object".Room WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                Location Code=FIELD(Location Code),
                                                                                                                Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Room;
                                                              NOR=Rom;
                                                              SVE=Rum];
                                                   Editable=No }
    { 230 ;   ;Customer Feature    ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Customer Feature" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                              Location Code=FIELD(Location Code),
                                                                                                                              Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Customer Feature;
                                                              NOR=Kundefunksjon;
                                                              SVE=Kundfunktion];
                                                   Editable=No }
    { 235 ;   ;Serial No.          ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Serial No." WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                        Location Code=FIELD(Location Code),
                                                                                                                        Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Serial No.;
                                                              NOR=Serienr;
                                                              SVE=Serienr];
                                                   Editable=No }
    { 240 ;   ;Year of Manufacture ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Year of Manufacture" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                 Location Code=FIELD(Location Code),
                                                                                                                                 Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Year of Manufacture;
                                                              NOR=Produksjons†r;
                                                              SVE=Tillverknings†r];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 250 ;   ;Net Cost Price      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Cost" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                      Location Code=FIELD(Location Code),
                                                                                                                      Seq. No.=FIELD(Seq. No.),
                                                                                                                      Include in Contract=CONST(Yes)));
                                                   CaptionML=[ENU=Cost Price;
                                                              NOR=Selvkost;
                                                              SVE=Sj„lvkostnadspris];
                                                   Editable=No }
    { 260 ;   ;Surcharge Amount    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Surcharge" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                           Location Code=FIELD(Location Code),
                                                                                                                           Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Surcharge Amount;
                                                              NOR=Tilleggsgebyrsbel›p;
                                                              SVE=Till„ggsbelopp];
                                                   Editable=No }
    { 270 ;   ;Cost Price          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Cost Price" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                        Location Code=FIELD(Location Code),
                                                                                                                        Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Cost Price;
                                                              NOR=Selvkost;
                                                              SVE=Sj„lvkostnadspris];
                                                   Editable=No }
    { 280 ;   ;Sales Surcharge Amount;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sales Surcharge" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                 Location Code=FIELD(Location Code),
                                                                                                                                 Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Sales Surcharge Amount;
                                                              NOR=Tillegsavgiftbel›p for salg;
                                                              SVE=F”rs„ljningstill„ggsbelopp];
                                                   Editable=No }
    { 290 ;   ;Base Sales Price    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Base Sales Price" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                              Location Code=FIELD(Location Code),
                                                                                                                              Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Base Sales Price;
                                                              NOR=Grunnleggende salgspris;
                                                              SVE=Basf”rs„ljningspris];
                                                   Editable=No }
    { 300 ;   ;Correction Factor   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Correction Factor" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                               Location Code=FIELD(Location Code),
                                                                                                                               Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Correction Factor;
                                                              NOR=Korreksjonsfaktor;
                                                              SVE=Korrigeringsfaktor];
                                                   Editable=No }
    { 310 ;   ;Sales Price         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Calculated Sales Price" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                    Location Code=FIELD(Location Code),
                                                                                                                                    Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Sales Price;
                                                              NOR=Salgspris;
                                                              SVE=F”rs„ljningspris];
                                                   Editable=No }
    { 320 ;   ;Cost Amount         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Cost Amount" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                         Location Code=FIELD(Location Code),
                                                                                                                         Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Cost Amount;
                                                              NOR=Kostbel›p;
                                                              SVE=Kostnadsbelopp];
                                                   Editable=No }
    { 330 ;   ;Sales Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Calculated Sales Amount" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                     Location Code=FIELD(Location Code),
                                                                                                                                     Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Sales Amount;
                                                              NOR=Salgsbel›p;
                                                              SVE=F”rs„ljningsbelopp];
                                                   Editable=No }
    { 340 ;   ;Customer Object Group;Code10       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Customer Object Group" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                   Location Code=FIELD(Location Code),
                                                                                                                                   Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Customer Object Group;
                                                              NOR=Opjektgruppe for kunde;
                                                              SVE=Kundobjektsgrupp];
                                                   Editable=No }
    { 350 ;   ;Service Rate        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Service Rate" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                          Location Code=FIELD(Location Code),
                                                                                                                          Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Service Rate;
                                                              NOR=Servicerate;
                                                              SVE=Serviceavgift];
                                                   Editable=No }
    { 360 ;   ;Service Amount      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Service Amount" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                            Location Code=FIELD(Location Code),
                                                                                                                            Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Service Amount;
                                                              NOR=Servicebel›p;
                                                              SVE=Servicebelopp];
                                                   Editable=No }
    { 370 ;   ;Include in Contract ;Boolean       ;FieldClass=FlowField;
                                                   InitValue=Yes;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Include in Contract OLD" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                     Location Code=FIELD(Location Code),
                                                                                                                                     Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Include in Contract;
                                                              NOR=Inkluder i kontrakt;
                                                              SVE=Inkludera i kontrakt];
                                                   Editable=No }
    { 380 ;   ;Objects Created     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Objects Created" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                             Location Code=FIELD(Location Code),
                                                                                                                             Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Objects Created;
                                                              NOR=Objekt opprettet;
                                                              SVE=Skapade objekt];
                                                   Editable=No }
    { 390 ;   ;Service Contract No.;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Service Contract No." WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                  Location Code=FIELD(Location Code),
                                                                                                                                  Seq. No.=FIELD(Seq. No.)));
                                                   TableRelation=Service-Contract;
                                                   CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr];
                                                   Editable=No }
    { 400 ;   ;Subcontracting      ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object".Subcontracting WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                          Location Code=FIELD(Location Code),
                                                                                                                          Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Subcontracting;
                                                              NOR=Underentrepen›r;
                                                              SVE=Underentreprenad];
                                                   Editable=No }
    { 410 ;   ;Additional Activities;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Serv. Surv. Object Add. Act." WHERE (Survey No.=FIELD(Survey No.),
                                                                                                           Location Code=FIELD(Location Code),
                                                                                                           Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Additional Activities;
                                                              NOR=Tilleggsaktiviteter;
                                                              SVE=Ytterligare aktiviteter];
                                                   Editable=No }
    { 420 ;   ;Hours               ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Hours" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                       Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Hours;
                                                              NOR="Timer ";
                                                              SVE=Timmar];
                                                   Editable=No }
    { 430 ;   ;Total Hours         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Total Hours" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                         Location Code=FIELD(Location Code),
                                                                                                                         Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=[ENU=Total Hours;
                                                              NOR=Timer totalt;
                                                              SVE=Totalt timmar];
                                                   Editable=No }
    { 440 ;   ;Object Group        ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Object Group" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=[ENU=Object Group;
                                                              NOR=Objektgruppe;
                                                              SVE=Objektgrupp];
                                                   Editable=No }
    { 450 ;   ;Tender Code System 1;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Tender Code System 1" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                  Location Code=FIELD(Location Code),
                                                                                                                                  Seq. No.=FIELD(Seq. No.)));
                                                   TableRelation="Coding System"."Coding System";
                                                   CaptionML=[ENU=Tender Code System 1;
                                                              NOR=Tilbudskodesystem 1;
                                                              SVE=Standardandbudkodsystem];
                                                   Editable=No }
    { 460 ;   ;Tender Code 1       ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Tender Code 1" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                           Location Code=FIELD(Location Code),
                                                                                                                           Seq. No.=FIELD(Seq. No.)));
                                                   TableRelation="Code per Coding System".Code WHERE (Coding System=FIELD(Tender Code System 1));
                                                   CaptionML=[ENU=Tender Code 1;
                                                              NOR=Tilbudskode 1;
                                                              SVE=Anbudskod];
                                                   Editable=No }
    { 470 ;   ;Tender Code System 2;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Tender Code System 2" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                  Location Code=FIELD(Location Code),
                                                                                                                                  Seq. No.=FIELD(Seq. No.)));
                                                   TableRelation="Coding System"."Coding System";
                                                   CaptionML=[ENU=Tender Code System 2;
                                                              NOR=Tilbudskodesystem 2;
                                                              SVE=Anbudskodsystem 2];
                                                   Editable=No }
    { 480 ;   ;Tender Code 2       ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Serv. Surv. Location Object"."Tender Code 2" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                           Location Code=FIELD(Location Code),
                                                                                                                           Seq. No.=FIELD(Seq. No.)));
                                                   TableRelation="Code per Coding System".Code WHERE (Coding System=FIELD(Tender Code System 2));
                                                   CaptionML=[ENU=Tender Code 2;
                                                              NOR=Tilbudskode 2;
                                                              SVE=Anbudskod 2];
                                                   Editable=No }
    { 490 ;   ;Brand Code          ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Brand Code" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=[ENU=Brand;
                                                              NOR=Varemerke;
                                                              SVE=M„rke];
                                                   Editable=No }
    { 495 ;   ;Brand Description   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Object Brand".Description WHERE (Code=FIELD(Brand Code)));
                                                   CaptionML=[ENU=Brand Description;
                                                              SVE=M„rke];
                                                   Editable=No }
    { 500 ;   ;Model Code          ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Model Code" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=ENU=Model Code;
                                                   Editable=No }
    { 505 ;   ;Model Description   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Object Model".Description WHERE (Code=FIELD(Model Code)));
                                                   CaptionML=[ENU=Model Description;
                                                              NOR=Modellbeskrivelse;
                                                              SVE=Modell];
                                                   Editable=No }
    { 510 ;   ;Type Code           ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Type Code" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=[ENU=Type Code;
                                                              NOR=Typekode;
                                                              SVE=Typkod];
                                                   Editable=No }
    { 515 ;   ;Type Description    ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Object Type".Description WHERE (Code=FIELD(Type Code)));
                                                   CaptionML=[ENU=Type Description;
                                                              NOR=Typebeskrivelse;
                                                              SVE=Radtypbeskrivning];
                                                   Editable=No }
    { 520 ;   ;Net Cost Price (Material);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Material" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                          Location Code=FIELD(Location Code),
                                                                                                                          Seq. No.=FIELD(Seq. No.),
                                                                                                                          Include in Contract=CONST(Yes)));
                                                   CaptionML=[ENU=Cost Price (Material);
                                                              NOR=Kostpris (Materiale)];
                                                   Editable=No }
    { 530 ;   ;Net Cost Price (Labor);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Labor" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                       Seq. No.=FIELD(Seq. No.),
                                                                                                                       Include in Contract=CONST(Yes)));
                                                   CaptionML=[ENU=Cost Price (Labor);
                                                              NOR=Kostpris (Arbeidskraft)];
                                                   Editable=No }
    { 540 ;   ;Net Cost Price (Subcontr.);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Subcontracting" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                Location Code=FIELD(Location Code),
                                                                                                                                Seq. No.=FIELD(Seq. No.),
                                                                                                                                Include in Contract=CONST(Yes)));
                                                   CaptionML=[ENU=Cost Price (Subcontracting);
                                                              NOR=Kostpris (Underentrepen›r)];
                                                   Editable=No }
    { 550 ;   ;Net Cost Price (Plant);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Plant" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                       Seq. No.=FIELD(Seq. No.),
                                                                                                                       Include in Contract=CONST(Yes)));
                                                   CaptionML=[ENU=Cost Price (Plant);
                                                              NOR=Kostpris (Maskin)];
                                                   Editable=No }
    { 560 ;   ;Net Cost Price (Sundry);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sundry" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                        Location Code=FIELD(Location Code),
                                                                                                                        Seq. No.=FIELD(Seq. No.),
                                                                                                                        Include in Contract=CONST(Yes)));
                                                   CaptionML=[ENU=Cost Price (Sundry);
                                                              NOR=Kostpris (Diverse)];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Survey No.,Location Code,Structure No.,Code,Line No.;
                                                   Clustered=Yes }
    {    ;Survey No.,Code,Line No.                 }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1100528600 : TextConst 'ENU=Structure Line already exists;NOR=Strukturrad finnes allerede;SVE=Strukturrad finns redan';

    PROCEDURE GetNextLineNo@1100528600() : Decimal;
    VAR
      ServiceSurveyStructureLine@1100528600 : Record 11071806;
    BEGIN
      ServiceSurveyStructureLine.SETRANGE("Survey No.", "Survey No.");
      ServiceSurveyStructureLine.SETRANGE("Location Code", "Location Code");
      ServiceSurveyStructureLine.SETRANGE("Structure No.", "Structure No.");
      ServiceSurveyStructureLine.SETRANGE(Code, Code);
      IF ServiceSurveyStructureLine.FINDLAST THEN
        EXIT(ServiceSurveyStructureLine."Line No." +1)
      ELSE
        EXIT(1);
    END;

    PROCEDURE DeleteLowerLevelParts@1100528601();
    VAR
      ServiceSurveyStructureLine@1100528600 : Record 11071806;
    BEGIN
      IF Level = 3 THEN
        EXIT;

      ServiceSurveyStructureLine.SETRANGE("Survey No.", "Survey No.");
      ServiceSurveyStructureLine.SETRANGE("Location Code", "Location Code");
      CASE Level OF
        0:
          BEGIN
            ServiceSurveyStructureLine.SETRANGE("Element Level 1", Code);
            ServiceSurveyStructureLine.SETRANGE("Element Level 2", '');
          END;
        1:
          BEGIN
            ServiceSurveyStructureLine.SETRANGE("Element Level 1", "Element Level 1");
            ServiceSurveyStructureLine.SETRANGE("Element Level 2", Code);
          END;
        2:
          BEGIN
            ServiceSurveyStructureLine.SETRANGE("Element Level 1", "Element Level 1");
            ServiceSurveyStructureLine.SETRANGE("Element Level 2", "Element Level 2");
          END;
      END;
      ServiceSurveyStructureLine.SETRANGE(Level, Level + 1);
      ServiceSurveyStructureLine.SETRANGE("Object Line", FALSE);
      ServiceSurveyStructureLine.DELETEALL(TRUE);
    END;

    PROCEDURE GetLevel@1100528604() : Integer;
    VAR
      ServiceSurveyStructureLine@1100528600 : Record 11071806;
    BEGIN
      ServiceSurveyStructureLine := Rec;
      ServiceSurveyStructureLine.SETRECFILTER;
      ServiceSurveyStructureLine.SETRANGE("Line No.", 0);
      IF ServiceSurveyStructureLine.FINDFIRST THEN
        EXIT(ServiceSurveyStructureLine.Level);
    END;

    PROCEDURE TestUniqueEntryNo@1100528602();
    VAR
      ServiceSurveyStructureLine@1100528600 : Record 11071806;
    BEGIN
      IF "Seq. No." = 0 THEN
        EXIT;
      ServiceSurveyStructureLine.SETRANGE("Survey No.", "Survey No.");
      ServiceSurveyStructureLine.SETRANGE("Location Code", "Location Code");
      ServiceSurveyStructureLine.SETRANGE("Structure No.", "Structure No.");
      ServiceSurveyStructureLine.SETRANGE("Seq. No.", "Seq. No.");
      IF NOT ServiceSurveyStructureLine.ISEMPTY THEN
        ERROR(Text000);
    END;

    PROCEDURE GetObjectRecordSet@1100528603(VAR IServiceSurveyStructureLine@1100528601 : Record 11071806;VAR OServSurvLocationObject@1100528600 : Record 11071813);
    VAR
      ServiceSurveyStructureLine@1100528602 : Record 11071806;
    BEGIN
      ServiceSurveyStructureLine.COPY(IServiceSurveyStructureLine);
      OServSurvLocationObject.RESET;
      ServiceSurveyStructureLine.SETRANGE("Object Line", TRUE);
      IF ServiceSurveyStructureLine.FINDSET THEN
        REPEAT
          IF OServSurvLocationObject.GET(
            ServiceSurveyStructureLine."Survey No.", ServiceSurveyStructureLine."Location Code", ServiceSurveyStructureLine."Seq. No.")
          THEN
            OServSurvLocationObject.MARK(TRUE);
        UNTIL ServiceSurveyStructureLine.NEXT = 0;
      OServSurvLocationObject.MARKEDONLY(TRUE);
    END;

    PROCEDURE GetObjectRecordSetFromTmp@1100528606(VAR IServiceSurveyStructureLine@1100528601 : TEMPORARY Record 11071806;VAR OServSurvLocationObject@1100528600 : Record 11071813);
    VAR
      TmpServiceSurveyStructureLine@1100528602 : TEMPORARY Record 11071806;
    BEGIN
      TmpServiceSurveyStructureLine.COPY(IServiceSurveyStructureLine, TRUE);
      OServSurvLocationObject.RESET;
      TmpServiceSurveyStructureLine.SETRANGE("Object Line", TRUE);
      IF TmpServiceSurveyStructureLine.FINDSET THEN
        REPEAT
          IF OServSurvLocationObject.GET(
            TmpServiceSurveyStructureLine."Survey No.", TmpServiceSurveyStructureLine."Location Code",
            TmpServiceSurveyStructureLine."Seq. No.")
          THEN
            OServSurvLocationObject.MARK(TRUE);
        UNTIL TmpServiceSurveyStructureLine.NEXT = 0;
      OServSurvLocationObject.MARKEDONLY(TRUE);
    END;

    PROCEDURE AttachSelObjectsToContract@1100528605(VAR IServiceSurveyStructureLine@1100528601 : Record 11071806);
    VAR
      ServSurvLocationObject@1100528600 : Record 11071813;
    BEGIN
      GetObjectRecordSet(IServiceSurveyStructureLine, ServSurvLocationObject);
      ServSurvLocationObject.AttachSelObjectsToContract(ServSurvLocationObject);
    END;

    PROCEDURE RoundSalesAmountSelObjects@1100528607(VAR IServiceSurveyStructureLine@1100528600 : Record 11071806);
    VAR
      ServSurvLocationObject@1100528601 : Record 11071813;
    BEGIN
      GetObjectRecordSet(IServiceSurveyStructureLine, ServSurvLocationObject);
      ServSurvLocationObject.RoundSalesAmount(ServSurvLocationObject);
    END;

    PROCEDURE GetCodeDescription@1100528608() : Text[100];
    VAR
      ServiceSurveyStructureLine@1100528600 : Record 11071806;
    BEGIN
      IF NOT "Object Line" THEN
        EXIT("Code Description")
      ELSE BEGIN
        ServiceSurveyStructureLine.SETRANGE("Survey No.", "Survey No.");
        ServiceSurveyStructureLine.SETRANGE("Location Code", "Location Code");
        ServiceSurveyStructureLine.SETRANGE("Structure No.", "Structure No.");
        ServiceSurveyStructureLine.SETRANGE(Code, Code);
        ServiceSurveyStructureLine.SETRANGE("Object Line", FALSE);
        IF ServiceSurveyStructureLine.FINDFIRST THEN
          EXIT(ServiceSurveyStructureLine."Code Description");
      END;
    END;

    BEGIN
    END.
  }
}

