OBJECT Table 11012151 Estimate
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00,4PSSE;
  }
  PROPERTIES
  {
    Permissions=TableData 11012151=d,
                TableData 11012188=rimd;
    DataCaptionFields=No.,Description;
    OnInsert=VAR
               EstimateStatus@1100525000 : Record 11020456;
             BEGIN
               EstSetup.GET;
               ProjSetup.GET;   //C034137
               InheritFromRawSetup;  //C035780
               IF "No." = '' THEN BEGIN
                 EstSetup.TESTFIELD("Estimate Nos.");
                 NoSeriesMgt.InitSeries(EstSetup."Estimate Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               TESTFIELD("No.");
               InitRecord;  //db, 05-11-18

               //C035780.sn
               InheritFromEstSetup;
               IF "Estimate Template Code" <> '' THEN
                 FillEstimateFromTemplate;  //DP02264
               InheritFromEstSource("Estimate Source",FALSE);  //C037344: db, 11-05-17 (overrule default setup: no)
               InheritFromCustomer;
               //C035780.en

               InitRates;  //db, 05-11-18

               //>> LAHE 121206
               EstimateStatus.RESET;
               EstimateStatus.SETRANGE("Default for Estimate",TRUE);
               IF EstimateStatus.FINDFIRST THEN
                 VALIDATE(Status,EstimateStatus.Code);
               IF UserSetup.GET(USERID) THEN
                 VALIDATE(Estimator,UserSetup."Employee No.");
               //<< LAHE 121206

               //**4PS Generated Code. Do Not Change.sn05
               DPA_OnInsert;
               //**4PS Generated Code.en05
               EstimateStatus.SETRANGE("Default for Estimate", TRUE);
               IF EstimateStatus.FINDFIRST THEN
                 Status := EstimateStatus.Code;
             END;

    OnModify=BEGIN
               IF Fixed = xRec.Fixed THEN
                 TESTFIELD(Fixed,FALSE);
               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
               "Modified by" := USERID;
             END;

    OnDelete=VAR
               SubEstimate@1100525007 : Record 11072074;
               EstimatePart@1100525008 : Record 11072073;
               EstimateLine@1100525009 : Record 11072072;
               EstimateRecipeLine@1100525010 : Record 11072075;
               EstimateCode@1100528001 : Record 11229772;
               EstimateSurcharge@1100528000 : Record 11229771;
               TextRec@1210190005 : Record 11020595;
               QuanSheetRec@1210190006 : Record 11012186;
               QuanModelRec@1210190008 : Record 11012197;
               ModelRec@1210190009 : Record 11012196;
               RateRec@11012006 : Record 11012160;
               RespRec@11012007 : Record 11012159;
               PrinRec@1210190000 : Record 11012170;
               SumRec@11012008 : Record 11012172;
               SumLineRec@11012010 : Record 11012171;
               SumRelRec@11012011 : Record 11012173;
               EstFeatureRec@11012012 : Record 11012177;
               EstFeaturePartRec@11012013 : Record 11012178;
               ConfigPartRec@11012014 : Record 11012176;
               ConfigLevelRec@1210190003 : Record 11012191;
               ConfigRowQuanRec@1210190004 : Record 11012192;
               CompRecNEW@1100525011 : Record 11020458;
               CompQuoteRec@1210190011 : Record 11012193;
               CommLineRec@1210190002 : Record 97;
               EstimateElementRAW@1100525001 : Record 11125679;
               EstElemVATSpecRAW@1100525005 : Record 11125678;
               EstimateLineRAW@1100528903 : Record 11125698;
               CommentLineRAW@1100525012 : Record 11125684;
               EstimateRoomRAW@1100525013 : Record 11125696;
               EstimateRAWSurcharge@1100528901 : Record 11012236;
               EstimateApplianceCodeRAW@1100528902 : Record 11125697;
               QuantSheetHeader@1100525004 : Record 11020462;
               QuantRelation@1100525003 : Record 11020463;
               QuantSheetLine@1100525002 : Record 11020464;
               EstLineTotal@1100528900 : Record 11072077;
               EstPartTotal@1100525006 : Record 11229767;
               EstimateCurrExchangeRate@1100528600 : Record 11229770;
               SalesPricebyEstimate@1100528500 : Record 11229774;
               PlotbySubEstimate@1100528501 : Record 11229775;
             BEGIN
               TESTFIELD(Fixed,FALSE);

               SubEstimate.SETRANGE("Estimate No.","No.");
               SubEstimate.DELETEALL;

               EstimatePart.SETRANGE("Estimate No.","No.");
               EstimatePart.DELETEALL;

               EstPartTotal.SETRANGE("Estimate No.", "No.");
               EstPartTotal.DELETEALL;

               EstimateLine.SETRANGE("Estimate No.","No.");
               EstimateLine.DELETEALL;

               EstLineTotal.SETRANGE("Estimate No.","No.");
               EstLineTotal.DELETEALL;

               IF "No." <> '' THEN BEGIN
                 EstimateRecipeLine.SETRANGE("Estimate No.","No.");
                 EstimateRecipeLine.DELETEALL;

                 TextRec.SETRANGE("Table Name",TextRec."Table Name"::Estimate);
                 TextRec.SETRANGE("Estimate No.","No.");
                 TextRec.DELETEALL;

                 EstimateSurcharge.SETRANGE("Estimate No.","No.");
                 EstimateSurcharge.DELETEALL;

                 EstimateCode.SETRANGE("Estimate No.","No.");
                 EstimateCode.DELETEALL;
               END;

               QuanSheetRec.SETRANGE("Estimate No.","No.");
               QuanSheetRec.DELETEALL;

               QuanModelRec.SETRANGE("Estimate No.","No.");
               QuanModelRec.DELETEALL;

               ModelRec.SETRANGE("Estimate No.","No.");
               ModelRec.DELETEALL;

               RateRec.SETRANGE("Estimate No.","No.");
               RateRec.DELETEALL(TRUE);  //db, 08-11-12: C003765 (delete RateByDate)

               RespRec.SETRANGE("Estimate No.","No.");
               RespRec.DELETEALL;

               PrinRec.SETRANGE("Estimate No.","No.");
               PrinRec.DELETEALL;

               SumRec.SETRANGE("Estimate No.","No.");
               SumRec.DELETEALL;

               SumLineRec.SETRANGE("Estimate No.","No.");
               SumLineRec.DELETEALL;

               SumRelRec.SETRANGE("Estimate No.","No.");
               SumRelRec.DELETEALL;

               EstFeatureRec.SETRANGE("Estimate No.","No.");
               EstFeatureRec.DELETEALL;

               EstFeaturePartRec.SETRANGE("Estimate No.","No.");
               EstFeaturePartRec.DELETEALL;

               CompRecNEW.SETRANGE("Estimate No.","No.");
               CompRecNEW.DELETEALL;

               CompQuoteRec.SETRANGE("Estimate No.","No.");
               CompQuoteRec.DELETEALL;

               ConfigPartRec.SETRANGE("Estimate No.","No.");
               ConfigPartRec.DELETEALL;

               ConfigLevelRec.SETRANGE("Estimate No.","No.");
               ConfigLevelRec.DELETEALL;

               ConfigRowQuanRec.SETRANGE("Estimate No.","No.");
               ConfigRowQuanRec.DELETEALL;

               CommLineRec.SETRANGE("Table Name",CommLineRec."Table Name"::Estimate);
               CommLineRec.SETRANGE("No.","No.");
               CommLineRec.DELETEALL;

               SalesPricebyEstimate.SETRANGE("Estimate No.","No.");
               SalesPricebyEstimate.DELETEALL;  //DP02089

               PlotbySubEstimate.SETRANGE("Estimate No.","No.");
               PlotbySubEstimate.DELETEALL;  //DP02088

               IF FPSLicenseManagement.LicenseAndReadPermissionForTable(TryOutRec) THEN BEGIN
                 TryOutRec.SETCURRENTKEY("Estimate No.");
                 TryOutRec.SETRANGE("Estimate No.", "No.");
                 IF TryOutRec.FINDSET(TRUE,FALSE) THEN BEGIN
                   REPEAT
                     IF (TryOutRec."Project No." = '') AND
                        (TryOutRec."Service Location No." = '') AND
                        (TryOutRec."Service Contract No." = '') AND
                        (TryOutRec."Service Order No." = '') THEN BEGIN
                       TryOutRec.DELETE(TRUE);
                     END ELSE BEGIN
                       TryOutRec."Estimate No." := '';
                       TryOutRec.MODIFY(TRUE);
                     END;
                   UNTIL TryOutRec.NEXT = 0;
                 END;
               END;

               IF "RAW Estimate" THEN BEGIN
                 EstimateElementRAW.SETRANGE("Estimate No.", "No.");
                 EstimateElementRAW.DELETEALL;

                 EstimateLineRAW.SETRANGE("Estimate No.", "No.");
                 EstimateLineRAW.DELETEALL;

                 EstElemVATSpecRAW.SETRANGE("Estimate No.", "No.");
                 EstElemVATSpecRAW.DELETEALL;   //db, 08-09-10

                 CommentLineRAW.SETFILTER("Table No.", '%1|%2', DATABASE::"Estimate Paragraph RAW",  DATABASE::"Estimate Line RAW");
                 CommentLineRAW.SETRANGE("Estimate No.", "No.");
                 CommentLineRAW.DELETEALL;

                 EstimateRoomRAW.SETRANGE("Estimate No.", "No.");
                 EstimateRoomRAW.DELETEALL(TRUE);  //db, 26-05-16

                 //DP01676.sn
                 EstimateRAWSurcharge.SETRANGE("Estimate No.", "No.");
                 EstimateRAWSurcharge.DELETEALL(TRUE);

                 EstimateApplianceCodeRAW.SETRANGE("Estimate No.", "No.");
                 EstimateApplianceCodeRAW.DELETEALL(TRUE);
                 //DP01676.en
               END;

               QuantSheetHeader.SETRANGE("Estimate No.","No.");
               QuantSheetHeader.DELETEALL;

               QuantSheetLine.SETRANGE("Estimate No.","No.");
               QuantSheetLine.DELETEALL;

               QuantRelation.SETRANGE("Estimate No.","No.");
               QuantRelation.DELETEALL;

               EstimateCurrExchangeRate.SETRANGE("Estimate No.","No.");
               EstimateCurrExchangeRate.DELETEALL;
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
               "Modified by" := USERID;
             END;

    CaptionML=[ENU=Estimate;
               NOR=Kalkyle;
               SVE=Kalkyl];
    LookupPageID=Page11012160;
    DrillDownPageID=Page11012160;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  IF "RAW Estimate" THEN BEGIN
                                                                    EstimateRAWSetup.GET;
                                                                    NoSeriesMgt.TestManual(EstimateRAWSetup."Estimate Nos.");
                                                                  END ELSE BEGIN
                                                                    EstSetup.GET;
                                                                    NoSeriesMgt.TestManual(EstSetup."Estimate Nos.");
                                                                  END;
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr;
                                                              SVE=Nr] }
    { 2   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              NOR=S›kenavn;
                                                              SVE=S”knamn] }
    { 3   ;   ;Description         ;Text50        ;OnValidate=BEGIN
                                                                IF ("Search Name" = UPPERCASE(xRec.Description)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Description;
                                                              END;

                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 4   ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2;
                                                              SVE=Beskrivning 2] }
    { 10  ;   ;Status              ;Code10        ;TableRelation="Estimate Status";
                                                   CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status] }
    { 12  ;   ;Creation Date       ;Date          ;CaptionML=[ENU=Creation Date;
                                                              NOR=Opprettet den;
                                                              SVE=Uppl„ggningsdatum];
                                                   Editable=No }
    { 13  ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                IF ("Starting Date" > "Ending Date") AND ("Ending Date" <> 0D) THEN
                                                                  FIELDERROR("Starting Date",STRSUBSTNO(Text000,FIELDCAPTION("Ending Date")));
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato;
                                                              SVE=Startdatum] }
    { 14  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                IF ("Starting Date" > "Ending Date") AND ("Ending Date" <> 0D) THEN
                                                                  FIELDERROR("Ending Date",STRSUBSTNO(Text001,FIELDCAPTION("Starting Date")));
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato;
                                                              SVE=Slutdatum] }
    { 15  ;   ;Tender Date         ;Date          ;CaptionML=[ENU=Tender Date;
                                                              NOR=Tilbudsdato;
                                                              SVE=Anbudsdatum] }
    { 16  ;   ;Register Date       ;Date          ;CaptionML=[ENU=Register Date;
                                                              NOR=Registrer Dato;
                                                              SVE=Registrera datum] }
    { 17  ;   ;Open Budget Sent on ;Date          ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Open Budget Sent on }
    { 20  ;   ;Responsible Employee;Code20        ;TableRelation=Resource;
                                                   CaptionML=[ENU=Responsible Employee;
                                                              NOR=Ansvarlig Ansatt;
                                                              SVE=Ansvarig] }
    { 27  ;   ;Created by          ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Created by;
                                                              NOR=Opprettet av;
                                                              SVE=Skapad av];
                                                   Description=DP01931;
                                                   Editable=No }
    { 28  ;   ;Modified by         ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserCode@1210190000 : Code[50];
                                                              UserMgt@1210190001 : Codeunit 418;
                                                            BEGIN
                                                              UserCode := "Modified by";
                                                              UserMgt.LookupUserID(UserCode);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Modified by;
                                                              NOR=Endret av;
                                                              SVE=Žndrad av];
                                                   Editable=No }
    { 29  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den;
                                                              SVE=Uppdateringsdatum];
                                                   Editable=No }
    { 30  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Estimate),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 50  ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                EstPrincRec@11012000 : Record 11012170;
                                                              BEGIN
                                                                IF ("Customer No." <> xRec."Customer No.") AND ("Customer No." <> '') THEN BEGIN
                                                                  CustRec.GET("Customer No.");
                                                                  InheritFromCustomer;  //C035780
                                                                  //db.sn, 09-03-15: C017681
                                                                  VALIDATE("Purch Discount Term Group 1", CustRec."Purch Discount Term Group");
                                                                  VALIDATE("Sales Discount Term Group 1", CustRec."Sales Discount Term Group");
                                                                  //db.en, 09-03-15: C017681
                                                                  //DP00381.sn
                                                                  IF NOT "RAW Estimate" THEN BEGIN //DP00433
                                                                    //db, 06-05-14: T004687 (seperate surcharges for Estimate and CostPlusEntry)
                                                                    VALIDATE("Surcharge % Labor", CustRec."Surcharge % Labor (Est)");
                                                                    VALIDATE("Surcharge % Material", CustRec."Surcharge % Material (Est)");
                                                                    VALIDATE("Surcharge % Subcontracting", CustRec."Surcharge % Subcontr. (Est)");
                                                                    VALIDATE("Surcharge % Plant", CustRec."Surcharge % Plant (Est)");
                                                                    VALIDATE("Surcharge % Sundry", CustRec."Surcharge % Sundry (Est)");
                                                                  END;
                                                                  GetSalesRate;
                                                                  //DP00381.en
                                                                  IF NOT EstPrincRec.GET("No.", "Customer No.") THEN BEGIN
                                                                    EstPrincRec.INIT;
                                                                    EstPrincRec."Estimate No." := "No.";
                                                                    EstPrincRec.Principal := "Customer No.";
                                                                    EstPrincRec.INSERT;
                                                                  END;
                                                                  UpdateSalesPricesByEstimateType;  //DP02089

                                                                  ContBusRel.RESET;
                                                                  ContBusRel.SETCURRENTKEY("Link to Table", "No.");
                                                                  ContBusRel.SETRANGE("Link to Table", ContBusRel."Link to Table"::Customer);
                                                                  ContBusRel.SETRANGE("No.", "Customer No.");
                                                                  IF ContBusRel.FINDFIRST THEN
                                                                    IF ContRec.GET(ContBusRel."Contact No.") THEN BEGIN
                                                                      ContRec.TESTFIELD(Blocked, FALSE);
                                                                      "Contact No." := ContBusRel."Contact No.";
                                                                    END;

                                                                  //>> LAHE 121213
                                                                  IF Address = '' THEN BEGIN
                                                                    Address := CustRec.Address;
                                                                    "Address 2" := CustRec."Address 2";
                                                                    City := CustRec.City;
                                                                    "Post Code" := CustRec."Post Code";
                                                                    "Country/Region Code" := CustRec."Country/Region Code";
                                                                  END;
                                                                  //<< LAHE 121213
                                                                  "Price List Code" := CustRec."Price List Code"; // LAHE 130116

                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Customer No.;
                                                              NOR=Kundenr;
                                                              SVE=Kundnr] }
    { 51  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[ENU=Territory Code;
                                                              NOR=Distriktskode;
                                                              SVE=Distriktskod] }
    { 52  ;   ;Type                ;Code10        ;TableRelation=Type;
                                                   CaptionML=[ENU=Type;
                                                              NOR=Type;
                                                              SVE=Typ] }
    { 53  ;   ;Customer Name       ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Customer Name;
                                                              NOR=Kundnavn;
                                                              SVE=Kundnamn];
                                                   Editable=No }
    { 58  ;   ;Name                ;Text100       ;CaptionML=[ENU=Name;
                                                              NOR=Navn;
                                                              SVE=Namn];
                                                   Editable=Yes }
    { 59  ;   ;Address             ;Text100       ;OnValidate=VAR
                                                                lDummy@1210190000 : Text[30];
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress];
                                                   Editable=Yes }
    { 60  ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2;
                                                              SVE=Adress 2];
                                                   Editable=Yes }
    { 61  ;   ;City                ;Text30        ;FieldClass=Normal;
                                                   TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Sted;
                                                              SVE=Ort];
                                                   Editable=Yes }
    { 63  ;   ;County              ;Text30        ;FieldClass=Normal;
                                                   CaptionML=[ENU=County;
                                                              NOR=Delstat;
                                                              SVE=Delstat];
                                                   Editable=Yes }
    { 64  ;   ;Post Code           ;Code20        ;FieldClass=Normal;
                                                   TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr;
                                                              SVE=Postnr];
                                                   Editable=Yes }
    { 65  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode;
                                                              SVE=Lands-/regionkod] }
    { 66  ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 71  ;   ;Hours (RAW)         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Cumulative Hours" WHERE (Estimate No.=FIELD(No.),
                                                                                                                 Cost Type=CONST(Labor)));
                                                   CaptionML=[ENU=Hours (RAW);
                                                              NOR=Timer (RAW);
                                                              SVE=Timmar (RAW)];
                                                   Description=RAW;
                                                   Editable=No }
    { 72  ;   ;Hours (Cost)        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Hours" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Hours;
                                                              NOR="Timer ";
                                                              SVE=Timmar];
                                                   Editable=No }
    { 73  ;   ;Hours (Sales)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Hours (Sales)" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Hours (Sales);
                                                              SVE=Timmar];
                                                   Editable=No }
    { 81  ;   ;Labor (RAW)         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Cumulative Labor" WHERE (Estimate No.=FIELD(No.),
                                                                                                                 Cost Type=CONST(Labor)));
                                                   OnValidate=VAR
                                                                ROTInformation@1100285001 : Record 11128101;
                                                                AmountPerPerson@1100285000 : Decimal;
                                                                SalesSetup@1100285100 : Record 311;
                                                              BEGIN

                                                                // 4PSSE.I012 <<
                                                                ROTInformation.RESET();
                                                                ROTInformation.SETRANGE(Type, ROTInformation.Type::"Quick Estimate");
                                                                ROTInformation.SETRANGE("Document No.", "No.");
                                                                "Amount ROT" := 0;
                                                                IF ROTInformation.FINDSET(FALSE) THEN BEGIN
                                                                  SalesSetup.GET;  //RFC188
                                                                  REPEAT
                                                                    //>>RFC188
                                                                   //AmountPerPerson := 0.5 * "Labor (RAW)" ;
                                                                    //IF (AmountPerPerson > 50000) THEN AmountPerPerson := 50000; // Max ROT per person: SEK 50000
                                                                    AmountPerPerson := SalesSetup."ROT Percentage"/100 * "Labor (RAW)";
                                                                    IF (AmountPerPerson > SalesSetup."ROT Amount Max") THEN AmountPerPerson := SalesSetup."ROT Amount Max"; // Max ROT per person: SEK 50000
                                                                    //<<RFC188
                                                                    "Amount ROT" += AmountPerPerson;
                                                                  UNTIL ROTInformation.NEXT = 0;
                                                                END;
                                                                IF ("Amount ROT" > "Labor (RAW)") THEN "Amount ROT" := "Labor (RAW)"; // Can never exceed Labor cost max.
                                                                // >>
                                                              END;

                                                   CaptionML=[ENU=Labor (RAW);
                                                              NOR=Arbeidskraft (RAW);
                                                              SVE=Arbetskraft (RAW)];
                                                   Description=RAW;
                                                   Editable=No }
    { 82  ;   ;Labor Cost Amount   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Labor" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Labor Cost Amount;
                                                              SVE=Arbetskraft];
                                                   Editable=No }
    { 83  ;   ;Labor Sales Amount  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Labor (Sales)" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Labor Sales Amount;
                                                              NOR=Bel›p salg arbied;
                                                              SVE=Arbetskraft f”rs„ljningsbelopp];
                                                   Editable=No }
    { 92  ;   ;Material (RAW)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Cumulative Material" WHERE (Estimate No.=FIELD(No.),
                                                                                                                    Cost Type=CONST(Material)));
                                                   CaptionML=[ENU=Material (RAW);
                                                              NOR=Materiale (RAW);
                                                              SVE=Material (RAW)];
                                                   Description=RAW;
                                                   Editable=No }
    { 95  ;   ;Material Cost Amount;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Material" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Material Cost Amount;
                                                              SVE=Material];
                                                   Editable=No }
    { 96  ;   ;Material Sales Amount;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Material (Sales)" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Material Sales Amount;
                                                              NOR=Bel›p salg materialer;
                                                              SVE=F”rs„ljningsbelopp material];
                                                   Editable=No }
    { 101 ;   ;Subcontracting (RAW);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Cumulative Subcontracting" WHERE (Estimate No.=FIELD(No.),
                                                                                                                          Cost Type=CONST(Subcontracting)));
                                                   CaptionML=[ENU=Subcontracting (RAW);
                                                              NOR=Underentrepen›r (RAW);
                                                              SVE=Underentreprenad (RAW)];
                                                   Description=RAW;
                                                   Editable=No }
    { 102 ;   ;Subcontracting Cost Amount;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Subcontracting" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Subcontracting Cost Amount;
                                                              SVE=Underentreprenad];
                                                   Editable=No }
    { 103 ;   ;Subcontracting Sales Amount;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Subcontr. (Sales)" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Subcontracting Sales Amount;
                                                              NOR=Bel›p salg underentrepren›r;
                                                              SVE=Underentreprenad, f”rs„ljningsbelopp];
                                                   Editable=No }
    { 111 ;   ;Plant (RAW)         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Cumulative Plant" WHERE (Estimate No.=FIELD(No.),
                                                                                                                 Cost Type=CONST(Plant)));
                                                   CaptionML=[ENU=Plant (RAW);
                                                              NOR=Maskin (RAW);
                                                              SVE=Maskin (RAW)];
                                                   Description=RAW;
                                                   Editable=No }
    { 112 ;   ;Plant Cost Amount   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Plant" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Plant Cost Amount;
                                                              SVE=Maskin];
                                                   Editable=No }
    { 113 ;   ;Plant Sales Amount  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Plant (Sales)" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Plant Sales Amount;
                                                              NOR=Bel›p maskinsalg;
                                                              SVE=Maskinf”rs„ljningsbelopp];
                                                   Editable=No }
    { 115 ;   ;Sundry (RAW)        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Cumulative Sundry" WHERE (Estimate No.=FIELD(No.),
                                                                                                                  Cost Type=CONST(Sundry)));
                                                   CaptionML=[ENU=Sundry (RAW);
                                                              NOR=Diverse (RAW);
                                                              SVE=Diverse (RAW)];
                                                   Description=RAW;
                                                   Editable=No }
    { 116 ;   ;Sundry Cost Amount  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Sundry" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Sundry Cost Amount;
                                                              SVE=Diverse];
                                                   Editable=No }
    { 117 ;   ;Sundry Sales Amount ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Sundry (Sales)" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Sundry Sales Amount;
                                                              SVE=F”rs„ljningsbelopp, diverse];
                                                   Editable=No }
    { 121 ;   ;Total (RAW)         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Cumulative Total" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Total (RAW);
                                                              NOR=Totalt (RAW);
                                                              SVE=Totalt (RAW)];
                                                   Description=RAW;
                                                   Editable=No }
    { 130 ;   ;Rate Group          ;Code10        ;TableRelation="Rate Group".No.;
                                                   OnValidate=VAR
                                                                EstRateRec@11012000 : Record 11012160;
                                                              BEGIN
                                                                //db.sn, 02-06-14: C012973
                                                                EstSetup.GET;
                                                                IF EstSetup."Rates Based On" <> EstSetup."Rates Based On"::"Rate Group" THEN EXIT;
                                                                //db.en, 02-06-14: C012973

                                                                IF "Rate Group" = xRec."Rate Group" THEN
                                                                  EXIT;

                                                                EstRateRec.SETRANGE("Estimate No.","No.");
                                                                IF EstRateRec.FINDFIRST THEN
                                                                  ERROR(Text002)
                                                                ELSE
                                                                  GetRateByRateGroup;  //C025953
                                                              END;

                                                   CaptionML=[ENU=Rate Group;
                                                              NOR=Kostgruppe;
                                                              SVE=Kostnadsgrupp] }
    { 131 ;   ;Rate Code           ;Code10        ;TableRelation="Estimate Rate"."Rate Code" WHERE (Estimate No.=FIELD(No.));
                                                   CaptionML=[ENU=Rate Code;
                                                              NOR=Avgiftskode;
                                                              SVE=Avgiftskod] }
    { 140 ;   ;Recipe Group        ;Code10        ;TableRelation="Recipe Group".No.;
                                                   OnValidate=BEGIN
                                                                ValidateRecipeGroup;  //db, 07-02-14: C013041
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Recipe Group;
                                                              NOR=Maltype;
                                                              SVE=Malltyp] }
    { 150 ;   ;Fixed               ;Boolean       ;OnValidate=BEGIN
                                                                IF Fixed <> xRec.Fixed THEN
                                                                  IF UserSetup.GET(USERID) THEN
                                                                    IF UserSetup."No Access Estimate Fixed" THEN
                                                                      ERROR(Text11012002,FIELDCAPTION(Fixed));  //db, 25-07-14: C010030
                                                              END;

                                                   CaptionML=[ENU=Fixed;
                                                              NOR=Fast;
                                                              SVE=Fast] }
    { 180 ;   ;Estimator           ;Code20        ;TableRelation=Employee.No.;
                                                   OnValidate=BEGIN
                                                                UpdateResponsibility(FIELDNO(Estimator), xRec.Estimator, Estimator);  //db, 12-09-13: C007282
                                                              END;

                                                   CaptionML=[ENU=Estimator;
                                                              NOR=Kalkylat›r;
                                                              SVE=Kalkylator] }
    { 190 ;   ;Consultancy Firm No.;Code20        ;TableRelation=Contact.No.;
                                                   CaptionML=[ENU=Consultancy Firm No.;
                                                              NOR=Konsulentfirmaets nr.;
                                                              SVE=Konsultfirmans nr] }
    { 200 ;   ;Consultancy Firm Name;Text100      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Consultancy Firm No.)));
                                                   CaptionML=[ENU=Consultancy Firm Name;
                                                              NOR=Konsulentfirmaets navn;
                                                              SVE=Konsultfirmans namn];
                                                   Editable=No }
    { 210 ;   ;Norm Group          ;Code10        ;TableRelation="Norm Group".Code;
                                                   CaptionML=[ENU=Norm Group;
                                                              NOR=Normgruppe;
                                                              SVE=Normgrupp] }
    { 215 ;   ;Norm Group (Sales)  ;Code10        ;TableRelation="Norm Group".Code;
                                                   CaptionML=[ENU=Norm Group (Sales);
                                                              SVE=Kopiera till] }
    { 230 ;   ;Part Group          ;Code10        ;TableRelation="Estimate Group".No. WHERE (Type=CONST(Part));
                                                   CaptionML=[ENU=Part Group;
                                                              NOR=Del gruppe;
                                                              SVE=Delgrupp] }
    { 240 ;   ;Element             ;Code20        ;TableRelation="Base Element".Code;
                                                   OnValidate=BEGIN
                                                                FormatMgt.FormatElem(Element,2,'');
                                                                IF Element <> '' THEN
                                                                  IF "Project No." <> '' THEN BEGIN
                                                                    IF NOT ProjElemRec.GET("Project No.", Element) THEN
                                                                      ElemRec.GET(Element);
                                                                  END ELSE
                                                                    ElemRec.GET(Element);

                                                                UpdateProjElem(1);
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF "Project No." <> '' THEN BEGIN
                                                                ProjElemRec.SETRANGE("Project No.", "Project No.");
                                                                ProjElemRec.Element := Element;
                                                                IF PAGE.RUNMODAL(PAGE::"Project Element List", ProjElemRec) = ACTION::LookupOK THEN
                                                                  VALIDATE(Element, ProjElemRec.Element);
                                                              END ELSE BEGIN
                                                                ElemRec.Code := Element;
                                                                IF PAGE.RUNMODAL(PAGE::Elements, ElemRec) = ACTION::LookupOK THEN
                                                                  VALIDATE(Element, ElemRec.Code);
                                                              END;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 250 ;   ;Copy Part Lines     ;Boolean       ;CaptionML=[ENU=Copy Part Lines;
                                                              NOR=Kopier Delrader;
                                                              SVE=Kopiera delrader] }
    { 260 ;   ;Project No.         ;Code20        ;TableRelation=Job.No.;
                                                   OnValidate=BEGIN
                                                                UpdateProjElem(0);
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 280 ;   ;Discipline          ;Code10        ;TableRelation=Discipline;
                                                   OnValidate=BEGIN
                                                                UpdateSubEstimates(FIELDNO(Discipline));  //DP02460
                                                              END;

                                                   CaptionML=[ENU=Discipline;
                                                              NOR=Disiplin;
                                                              SVE=Disciplin] }
    { 290 ;   ;Finished            ;Boolean       ;OnValidate=BEGIN
                                                                UpdateSubEstimates(FIELDNO(Finished));  //DP01931
                                                              END;

                                                   CaptionML=[ENU=Estimate Finished;
                                                              NOR=Kalkyle ferdig;
                                                              SVE=Kalkyl f„rdig] }
    { 300 ;   ;Text                ;Text250       ;CaptionML=[ENU=Text;
                                                              NOR=Tekst;
                                                              SVE=Ben„mning] }
    { 310 ;   ;Last Time Modified  ;Time          ;CaptionML=[ENU=Last Time Modified;
                                                              NOR=Sist endret;
                                                              SVE=Uppdateringstid];
                                                   Editable=No }
    { 330 ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=BEGIN
                                                                //call 28971
                                                                IF "Contact No." <> xRec."Contact No." THEN
                                                                  "Contact Person No." := '';

                                                                IF "Contact No." <> '' THEN BEGIN
                                                                  ContRec.GET("Contact No.");
                                                                  ContRec.TESTFIELD(Blocked, FALSE);
                                                                  IF (ContRec.Type = ContRec.Type::Person) AND
                                                                     (ContRec."Company No." <> '') THEN
                                                                    ERROR(Text013);
                                                                //
                                                                  ContBusRel.RESET;
                                                                  ContBusRel.SETCURRENTKEY("Contact No.", "Business Relation Code");
                                                                  ContBusRel.SETRANGE("Contact No.", "Contact No.");
                                                                  ContBusRel.SETRANGE("Link to Table", ContBusRel."Link to Table"::Customer);
                                                                  IF ContBusRel.FINDFIRST THEN
                                                                    VALIDATE("Customer No.", ContBusRel."No.")
                                                                  ELSE
                                                                    VALIDATE("Customer No.", '');
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Contact No.;
                                                              NOR=Kontaktnr;
                                                              SVE=Kontaktnr] }
    { 331 ;   ;Contact Name        ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=[ENU=Contact Name;
                                                              NOR=Kontaktnavn;
                                                              SVE=Kontaktnamn];
                                                   Editable=No }
    { 340 ;   ;Purchaser Code      ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Purchaser Name");
                                                              END;

                                                   CaptionML=[ENU=Purchaser Code;
                                                              NOR=Innkj›perkode;
                                                              SVE=Ink”parkod] }
    { 341 ;   ;Purchaser Name      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Purchaser Code)));
                                                   CaptionML=[ENU=Purchaser Name;
                                                              NOR=Innkj›perens navn;
                                                              SVE=Ink”parens namn];
                                                   Editable=No }
    { 350 ;   ;Coding System       ;Code10        ;TableRelation="Coding System";
                                                   OnValidate=VAR
                                                                EstLineRec@1210190002 : Record 11072072;
                                                                RcpLineRec@1210190001 : Record 11072075;
                                                                EstimateCode@1100528000 : Record 11229772;
                                                                EstimateLineRAW@1100528900 : Record 11125698;
                                                              BEGIN
                                                                IF "RAW Estimate" THEN BEGIN  //DP01676
                                                                  EstimateLineRAW.SETRANGE("Estimate No.", "No.");
                                                                  EstimateLineRAW.MODIFYALL(Code, '');
                                                                END ELSE BEGIN
                                                                  EstLineRec.SETRANGE("Estimate No.", "No.");
                                                                  EstLineRec.MODIFYALL(Code, '');
                                                                  //
                                                                  RcpLineRec.SETRANGE("Estimate No.", "No.");
                                                                  RcpLineRec.MODIFYALL(Code, '');
                                                                END;

                                                                EstimateCode.SETRANGE("Estimate No.", "No.");
                                                                EstimateCode.SETRANGE("Coding System", "Coding System");
                                                                IF EstimateCode.FINDSET THEN BEGIN
                                                                  REPEAT
                                                                    IF "RAW Estimate" THEN BEGIN  //DP01676
                                                                      IF EstimateLineRAW.GET(EstimateCode."Estimate No.", EstimateCode."Tender Paragraph No.", EstimateCode."Estimate Line") THEN
                                                                      BEGIN
                                                                        EstimateLineRAW.Code := EstimateCode.Code;
                                                                        EstimateLineRAW.MODIFY;
                                                                      END;
                                                                    END ELSE BEGIN
                                                                      IF EstimateCode."Recipe Line" = 0 THEN BEGIN
                                                                        IF EstLineRec.GET(EstimateCode."Estimate No.", EstimateCode."Sub-Estimate No.",
                                                                                          EstimateCode."Part Group", EstimateCode.Part,
                                                                                          EstimateCode."Estimate Line") THEN
                                                                        BEGIN
                                                                          EstLineRec.Code := EstimateCode.Code;
                                                                          EstLineRec.MODIFY;
                                                                        END;
                                                                      END ELSE BEGIN
                                                                        IF RcpLineRec.GET(EstimateCode."Estimate No.", EstimateCode."Sub-Estimate No.",
                                                                                          EstimateCode."Part Group", EstimateCode.Part,
                                                                                          EstimateCode."Estimate Line", EstimateCode."Recipe Group",
                                                                                          EstimateCode.Recipe, EstimateCode."Recipe Line") THEN
                                                                        BEGIN
                                                                          RcpLineRec.Code := EstimateCode.Code;
                                                                          RcpLineRec.MODIFY;
                                                                        END;
                                                                      END;
                                                                    END;
                                                                  UNTIL EstimateCode.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Coding System;
                                                              NOR=Kodingssystem;
                                                              SVE=Kodningssystem] }
    { 360 ;   ;Code                ;Code20        ;OnValidate=VAR
                                                                UpdateMgt@1100525001 : Codeunit 11012229;
                                                                CodingSystem@1100525002 : Record 11012088;
                                                              BEGIN
                                                                TESTFIELD("Coding System");

                                                                IF Code <> '' THEN BEGIN
                                                                  CodingSystem.GET("Coding System");
                                                                  IF CodingSystem."Deviant Code allowed" = FALSE THEN BEGIN  //db, 26-06-15
                                                                    FormatMgt.SetSelection("Coding System");
                                                                    FormatMgt.FormatElem(Code,4,'');
                                                                    CodeRec.GET("Coding System", Code);
                                                                  END;
                                                                END;

                                                                MODIFY;
                                                                UpdateMgt.UpdateCode("No.", '', '', Code);  //DP00381
                                                              END;

                                                   OnLookup=BEGIN
                                                              TESTFIELD("Coding System");
                                                              CodeRec.SETRANGE("Coding System", "Coding System");
                                                              CodeRec.Code := Code;
                                                              IF PAGE.RUNMODAL(PAGE::"Codes per Coding System", CodeRec) = ACTION::LookupOK THEN
                                                                VALIDATE(Code, CodeRec.Code);
                                                            END;

                                                   CaptionML=[ENU=Code;
                                                              NOR=Kode;
                                                              SVE=Kod] }
    { 370 ;   ;Estimate Based On   ;Option        ;CaptionML=[ENU=Estimate Based On;
                                                              NOR=Kalkyle Basert p†;
                                                              SVE=Kalkyl baserad p†];
                                                   OptionCaptionML=[ENU=Item,Cost Object;
                                                                    NOR=Artikkel,Kostnadsobjekt;
                                                                    SVE=Artikel,kostnadsobjekt];
                                                   OptionString=Item,CostObject }
    { 380 ;   ;Name Estimator      ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Estimator)));
                                                   CaptionML=[ENU=Name Estimator;
                                                              NOR=Navn p† Kalkyleansvarlig;
                                                              SVE=Namn p† kalkylansvarig];
                                                   Editable=No }
    { 390 ;   ;Reference Date (Rate);Date         ;OnValidate=VAR
                                                                lvEstRateRec@1210190000 : Record 11012160;
                                                                lvDateRateRec@1210190001 : Record 11012188;
                                                              BEGIN
                                                                lvEstRateRec.SETRANGE("Estimate No.", "No.");
                                                                IF lvEstRateRec.FINDSET(TRUE, FALSE) THEN BEGIN
                                                                  REPEAT
                                                                    lvDateRateRec.SETCURRENTKEY("Estimate No.", "Rate Code", "Starting Date");
                                                                    lvDateRateRec.SETRANGE("Record Type", lvDateRateRec."Record Type"::Estimate);
                                                                    lvDateRateRec.SETRANGE("Estimate No.", lvEstRateRec."Estimate No.");
                                                                    lvDateRateRec.SETRANGE("Rate Code", lvEstRateRec."Rate Code");
                                                                    lvDateRateRec.SETRANGE("Starting Date",0D,"Reference Date (Rate)");
                                                                    IF lvDateRateRec.FINDLAST THEN BEGIN
                                                                      lvEstRateRec."Cost Rate" := lvDateRateRec."Cost Rate";
                                                                      lvEstRateRec."Sales Rate" := lvDateRateRec."Sales Rate";  //db, 02-06-14: C012973
                                                                      lvEstRateRec."Currency Code" := lvDateRateRec."Currency Code";
                                                                      lvEstRateRec."Cost Rate (FCY)" := lvDateRateRec."Cost Rate (FCY)";
                                                                      lvEstRateRec."Sales Rate (FCY)" := lvDateRateRec."Sales Rate (FCY)";
                                                                      lvEstRateRec.MODIFY(TRUE);
                                                                    END;
                                                                  UNTIL lvEstRateRec.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Reference Date Rates;
                                                              NOR=Referansedato for satser;
                                                              SVE=Avgiftsreferensdatum] }
    { 400 ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");  //db, 19-08-09
                                                                IF ("Global Dimension 1 Code" <> xRec."Global Dimension 1 Code") AND ("Global Dimension 1 Code" <> '') THEN BEGIN
                                                                  GetCostRate;  //DP00381
                                                                  GetSalesRate;  //DP00381
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 kode;
                                                              SVE=Global dimension 1 kod];
                                                   CaptionClass='1,1,1' }
    { 410 ;   ;Estimate Model Total;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Model".Quantity WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Estimate Model Total;
                                                              NOR=Totalt for Kalkylemodell;
                                                              SVE=Totalt f”r kalkylmodell];
                                                   Editable=No }
    { 420 ;   ;Condition           ;Code10        ;TableRelation=Condition.Code;
                                                   CaptionML=[ENU=Condition;
                                                              NOR=Betingelse;
                                                              SVE=Villkor] }
    { 430 ;   ;Tender No.          ;Code20        ;CaptionML=[ENU=Tender No.;
                                                              NOR=Tilbudsnr.;
                                                              SVE=Anbudsnr] }
    { 440 ;   ;Service Location No.;Code20        ;TableRelation="Service Location".No.;
                                                   OnValidate=BEGIN
                                                                //db, 06-11-08
                                                                IF ServLocRec.GET("Service Location No.") THEN BEGIN
                                                                  IF "Customer No." = '' THEN BEGIN
                                                                    VALIDATE("Customer No.", ServLocRec."Customer No.");
                                                                  END ELSE BEGIN
                                                                    IF ServLocRec."Customer No." <> '' THEN
                                                                      TESTFIELD("Customer No.", ServLocRec."Customer No.");
                                                                  END;
                                                                  IF CurrFieldNo = FIELDNO("Service Location No.") THEN
                                                                    CheckAddressServiceLocation;  //db, 10-12-09: M14821
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Service Location No.;
                                                              NOR=Servicelokasjon Nr.;
                                                              SVE=Serviceplatsnr] }
    { 445 ;   ;Service Order No.   ;Code20        ;TableRelation="Service Order".No. WHERE (No.=FIELD(Service Order No.));
                                                   OnValidate=VAR
                                                                ServiceOrder@1100525000 : Record 11012823;
                                                              BEGIN
                                                                //C043087
                                                                IF NOT ServiceOrder.GET("Service Order No.") THEN ServiceOrder.INIT;
                                                                "Service Location No." := ServiceOrder."Service Location No.";
                                                                "Service Contract No." := ServiceOrder."Service Contract No.";
                                                                UpdateLowerLevelServOrder;
                                                              END;

                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr];
                                                   Description=C043087 }
    { 460 ;   ;Contact Person No.  ;Code20        ;TableRelation=Contact WHERE (Company No.=FIELD(Contact No.),
                                                                                Type=CONST(Person),
                                                                                Blocked=CONST(No));
                                                   CaptionML=[ENU=Contact Person No.;
                                                              NOR=Kontaktperson;
                                                              SVE=Kontaktperson] }
    { 470 ;   ;Contact Person Name ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Person No.)));
                                                   CaptionML=[ENU=Contact Person Name;
                                                              NOR=Kontaktpersonens navn;
                                                              SVE=Kontaktpersonens namn];
                                                   Editable=No }
    { 475 ;   ;Contact Person Gender;Option       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Gender WHERE (No.=FIELD(Contact Person No.)));
                                                   CaptionML=[ENU=Contact Person Gender;
                                                              SVE=Kontaktperson, k”n];
                                                   OptionCaptionML=[ENU=" ,Female,Male";
                                                                    NOR=" ,Kvinne,Mann";
                                                                    SVE=" ,Kvinna,Man"];
                                                   OptionString=[ ,Female,Male];
                                                   Editable=No }
    { 480 ;   ;Reference Date (Item);Date         ;CaptionML=[ENU=Reference Date Item Prices;
                                                              NOR=Referansedato for artikkelpriser;
                                                              SVE=Referensdatum f”r artikelpriser] }
    { 481 ;   ;Reference Date (Company);Date      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Inventory Setup"."Reference Date (Item)");
                                                   CaptionML=[ENU=Reference Date Item Prices (Company);
                                                              NOR=Referansedato for artikkelpriser (Selskap);
                                                              SVE=Referensdatum f”r artikelpriser (f”retag)];
                                                   Editable=No }
    { 482 ;   ;Reference Date (Customer);Date     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Reference Date (Item)" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Reference Date Item Prices (Customer);
                                                              NOR=Referansedato for artikkelpriser (Kunde);
                                                              SVE=Referensdatum f”r artikelpriser (kund)];
                                                   Editable=No }
    { 485 ;   ;Reference Date (Sales Price);Date  ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Reference Date Sales Prices;
                                                   Description=DP02089 }
    { 490 ;   ;Quantity Model Exist;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Estimate Model" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Quantity Model Exist;
                                                              NOR=Antallsmodell finnes;
                                                              SVE=Antalsmodell finns];
                                                   Editable=No }
    { 500 ;   ;Estimate Source     ;Code20        ;TableRelation=Estimate.No.;
                                                   CaptionML=[ENU=Estimate Source;
                                                              NOR=Kalkyle Í kilde;
                                                              SVE=Kalkyl Í k„lla] }
    { 510 ;   ;Summary Source (Cost);Code10       ;TableRelation="Summary Sheet".Summary WHERE (Estimate No.=FIELD(Estimate Source),
                                                                                                Summary Type=CONST(Cost));
                                                   CaptionML=[ENU=Summary Source (Cost);
                                                              NOR=Summeringskilde (Kostnad);
                                                              SVE=Summeringsk„lla (kostnad)] }
    { 511 ;   ;Summary Source (Sales);Code10      ;TableRelation="Summary Sheet".Summary WHERE (Estimate No.=FIELD(Estimate Source),
                                                                                                Summary Type=CONST(Sales));
                                                   CaptionML=[ENU=Summary Source (Sales);
                                                              NOR=Summeringskilde (Salg);
                                                              SVE=Summeringsk„lla (f”rs„ljning)] }
    { 520 ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              NOR=Kunderabattgruppe;
                                                              SVE=Kundrabattgrupp] }
    { 530 ;   ;Service Contract No.;Code20        ;TableRelation=Service-Contract.No.;
                                                   OnValidate=VAR
                                                                ServiceContractDepartment@1210190000 : Record 11012809;
                                                                CaptionManagement@1210190001 : Codeunit 42;
                                                              BEGIN
                                                                IF ServContrRec.GET("Service Contract No.") THEN BEGIN
                                                                  IF "Customer No." = '' THEN BEGIN
                                                                    VALIDATE("Customer No.", ServContrRec."Customer No.");
                                                                  END ELSE BEGIN
                                                                    IF ServContrRec."Customer No." <> '' THEN
                                                                      TESTFIELD("Customer No.", ServContrRec."Customer No.");
                                                                  END;

                                                                  VALIDATE("Purch Discount Term Group 1", ServContrRec."Purch Discount Term Group 1");
                                                                  VALIDATE("Purch Discount Term Group 2", ServContrRec."Purch Discount Term Group 2");
                                                                  VALIDATE("Sales Discount Term Group 1", ServContrRec."Sales Discount Term Group 1");
                                                                  VALIDATE("Sales Discount Term Group 2", ServContrRec."Sales Discount Term Group 2");
                                                                  GetSalesRate;

                                                                  IF "Global Dimension 1 Code" <> '' THEN
                                                                    IF ServContrRec."Global Dimension 1 Code" <> "Global Dimension 1 Code" THEN
                                                                      IF NOT ServiceContractDepartment.GET("Service Contract No.", "Global Dimension 1 Code") THEN
                                                                        IF NOT CONFIRM(Text012, FALSE, CaptionManagement.CaptionClassTranslate(GLOBALLANGUAGE, '1,1,1'),
                                                                          "Global Dimension 1 Code", ServiceContractDepartment.TABLECAPTION) THEN
                                                                          ERROR('');

                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr] }
    { 550 ;   ;Order No. Customer  ;Text50        ;CaptionML=[ENU=Order No. Customer;
                                                              NOR=Ordrenr, (Kunde);
                                                              SVE=Ordernr, (kund)] }
    { 570 ;   ;Plant Company       ;Text30        ;TableRelation="Plant Management Company"."Plant Company";
                                                   OnValidate=BEGIN
                                                                //DP01208.sn
                                                                IF "Plant Company" = COMPANYNAME THEN
                                                                  "Plant Company" := '';
                                                                IF "Plant Company" <> xRec."Plant Company" THEN
                                                                  TESTFIELD("Plant Location", '');
                                                                //DP01208.en
                                                              END;

                                                   CaptionML=[ENU=Plant Company;
                                                              NOR=Maskinselskap;
                                                              SVE=Maskinf”retag];
                                                   Description=DP01208+DP02115 }
    { 580 ;   ;Plant Location      ;Code20        ;TableRelation=IF (Customer No.=FILTER(<>''),
                                                                     Project No.=FILTER(<>'')) "Plant Location" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                       Project No.=FIELD(Project No.))
                                                                                                                       ELSE IF (Customer No.=FILTER(<>'')) "Plant Location" WHERE (Customer No.=FIELD(Customer No.))
                                                                                                                       ELSE IF (Project No.=FILTER(<>'')) "Plant Location" WHERE (Project No.=FIELD(Project No.))
                                                                                                                       ELSE "Plant Location";
                                                   OnValidate=VAR
                                                                PlantLocation@1100525000 : Record 11012554;
                                                              BEGIN
                                                                IF "Plant Location" <> xRec."Plant Location" THEN BEGIN
                                                                  CalcfieldTransferedToPlantNeed;
                                                                  TESTFIELD("Transf. to Plant Need",FALSE);
                                                                  IF "Plant Location" <> '' THEN BEGIN
                                                                    //DP01208.sn
                                                                    IF "Plant Company" <> '' THEN
                                                                      PlantLocation.CHANGECOMPANY("Plant Company");
                                                                    PlantLocation.GET("Plant Location");
                                                                    IF PlantLocation."Estimate Company" <> '' THEN BEGIN
                                                                      IF "Plant Company" <> '' THEN
                                                                        PlantLocation.TESTFIELD("Estimate Company", "Plant Company")
                                                                      ELSE
                                                                        PlantLocation.TESTFIELD("Estimate Company", COMPANYNAME);
                                                                    END;
                                                                    //DP01208.en
                                                                    "Kind of Plant Rate" := PlantLocation."Kind of Rate";  //DP01047
                                                                    IF "Customer No." = '' THEN
                                                                      VALIDATE("Customer No.",PlantLocation."Customer No.");
                                                                    IF "Project No." = '' THEN
                                                                      VALIDATE("Project No.",PlantLocation."Project No.");
                                                                  END;
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Plant Location;
                                                              NOR=Maskinplassering;
                                                              SVE=Maskinutplacering] }
    { 590 ;   ;Transf. to Plant Need;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Plant Need" WHERE (Transf. from Estimate=FIELD(No.)));
                                                   CaptionML=[ENU=Transf. to Plant Need;
                                                              NOR=Overf›r til maskinbehov;
                                                              SVE=™verf. till Maskinsbehov];
                                                   Editable=No }
    { 600 ;   ;Requested Quote Receipt Date;Date  ;CaptionML=[ENU=Requested Quote Receipt Date;
                                                              NOR=Kvitteringsdato for anmodet tilbud;
                                                              SVE=Inleveransdatum f”r beg„rd offert] }
    { 610 ;   ;Vendors React before;Date          ;CaptionML=[ENU=Vendors React before;
                                                              NOR=Leverand›rer reagerer innen;
                                                              SVE=Leverant”rer reagerar innan] }
    { 620 ;   ;Purch Discount Term Group 1;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Customer),
                                                                                                   Type=FILTER(Common|Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch Discount Term Group 1" = '' THEN BEGIN
                                                                  "Priority Purch Disc Term Grp 1" := '';
                                                                END ELSE BEGIN
                                                                  "Priority Purch Disc Term Grp 0" := '0';
                                                                  "Priority Purch Disc Term Grp 1" := '1';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Purchase Discount Term Group (Customer);
                                                              NOR=Innkj›p, Rabattvilk†rsgruppe (Kunde);
                                                              SVE=Ink”p, rabattvillkorsgrupp (kund)] }
    { 621 ;   ;Purch Discount Term Group 2;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Job),
                                                                                                   Type=FILTER(Common|Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch Discount Term Group 2" = '' THEN BEGIN
                                                                  "Priority Purch Disc Term Grp 2" := '';
                                                                END ELSE BEGIN
                                                                  "Priority Purch Disc Term Grp 0" := '0';
                                                                  "Priority Purch Disc Term Grp 2" := '2';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Purchase Discount Term Group (Job);
                                                              NOR=Innkj›p, Rabattvilk†rsgruppe (Jobb);
                                                              SVE=Ink”p, rabattvillkorsgrupp (jobb)] }
    { 625 ;   ;Priority Purch Disc Term Grp 0;Code1;
                                                   CaptionML=[ENU=Priority Purchase Discount Term Group (Company);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Innkj›p (Selskap);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r ink”p (f”retag)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 626 ;   ;Priority Purch Disc Term Grp 1;Code1;
                                                   CaptionML=[ENU=Priority Purchase Discount Term Group (Customer);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Innkj›p (Kunde);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r ink”p (kund)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 627 ;   ;Priority Purch Disc Term Grp 2;Code1;
                                                   CaptionML=[ENU=Priority Purchase Discount Term Group (Job);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Innkj›p (Jobb);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r ink”p (jobb)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 630 ;   ;Sales Discount Term Group 1;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Customer),
                                                                                                   Type=FILTER(Common|Sales));
                                                   OnValidate=BEGIN
                                                                IF "Sales Discount Term Group 1" = '' THEN BEGIN
                                                                  "Priority Sales Disc Term Grp 1" := '';
                                                                END ELSE BEGIN
                                                                  "Priority Sales Disc Term Grp 0" := '0';
                                                                  "Priority Sales Disc Term Grp 1" := '1';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Discount Sales Term Group (Customer);
                                                              NOR=Rabatt Salgsvilk†rgruppe (Kunde);
                                                              SVE=Rabattf”rs„kringsvillkor, grupp (kund)] }
    { 631 ;   ;Sales Discount Term Group 2;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Job),
                                                                                                   Type=FILTER(Common|Sales));
                                                   OnValidate=BEGIN
                                                                IF "Sales Discount Term Group 2" = '' THEN BEGIN
                                                                  "Priority Sales Disc Term Grp 2" := '';
                                                                END ELSE BEGIN
                                                                  "Priority Sales Disc Term Grp 0" := '0';
                                                                  "Priority Sales Disc Term Grp 2" := '2';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Sales Discount Term Group (Job);
                                                              NOR=Salg, Rabattvilk†rsgruppe (Jobb);
                                                              SVE=F”rs„ljning, rabattvillkorsgrupp (jobb)] }
    { 635 ;   ;Priority Sales Disc Term Grp 0;Code1;
                                                   CaptionML=[ENU=Priority Sales Discount Term Group (Company);
                                                              NOR=Prioritert rabattvilk†rsgruppe for salg (selskap);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r f”rs„ljning (f”retag)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 636 ;   ;Priority Sales Disc Term Grp 1;Code1;
                                                   CaptionML=[ENU=Priority Sales Discount Term Group (Customer);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Salg (Kunde);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r f”rs„ljning (kund)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 637 ;   ;Priority Sales Disc Term Grp 2;Code1;
                                                   CaptionML=[ENU=Priority Sales Discount Term Group (Job);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Salg (Jobb);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r f”rs„ljning (jobb)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 640 ;   ;Full Cost/Sales Price Updated;Boolean;
                                                   CaptionML=[ENU=Full Cost/Sales Price Updated;
                                                              NOR=Full kost/oppdatert salgspris;
                                                              SVE=Full kostnad/uppdaterat F”rs„ljningspris] }
    { 650 ;   ;Project Planning Activity Code;Code10;
                                                   TableRelation="Project Planning Base Activity";
                                                   OnValidate=VAR
                                                                ProjectPlanningActivity@1100528401 : Record 11012431;
                                                                ProjectPlanningBaseActivity@1100528402 : Record 11012434;
                                                                FormatManagement@1100528400 : Codeunit 11012022;
                                                              BEGIN
                                                                FormatManagement.FormatElem("Project Planning Activity Code", 20, '');
                                                                IF "Project Planning Activity Code" <> '' THEN
                                                                  IF "Project No." <> '' THEN BEGIN
                                                                    IF NOT ProjectPlanningActivity.GET("Project No." + "Project Planning Activity Code") THEN
                                                                      ProjectPlanningBaseActivity.GET("Project Planning Activity Code");
                                                                  END ELSE
                                                                    ProjectPlanningBaseActivity.GET("Project Planning Activity Code");

                                                                UpdateProjPlanActCode;
                                                              END;

                                                   OnLookup=VAR
                                                              ProjectPlanningActivity@1100528401 : Record 11012431;
                                                              ProjectPlanningBaseActivity@1100528400 : Record 11012434;
                                                            BEGIN
                                                              IF "Project No." <> '' THEN BEGIN
                                                                ProjectPlanningActivity.SETRANGE("Project No.", "Project No.");
                                                                ProjectPlanningActivity.Code := "Project Planning Activity Code";
                                                                IF PAGE.RUNMODAL(PAGE::"Project Planning Activity List", ProjectPlanningActivity) = ACTION::LookupOK THEN
                                                                  VALIDATE("Project Planning Activity Code", ProjectPlanningActivity.Code);
                                                              END ELSE BEGIN
                                                                ProjectPlanningBaseActivity.Code := "Project Planning Activity Code";
                                                                IF PAGE.RUNMODAL(PAGE::"Proj. Planning Base Activities", ProjectPlanningBaseActivity) = ACTION::LookupOK THEN
                                                                  VALIDATE("Project Planning Activity Code", ProjectPlanningBaseActivity.Code);
                                                              END;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Project Planning Activity Code;
                                                              NOR=Prosjektplan, Aktivitetskode;
                                                              SVE=Projektplan, aktivitetskod] }
    { 660 ;   ;Not Posted Hours    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line"."Total Line" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Not Posted Hours;
                                                              NOR=Ikke Bokf›rte timer];
                                                   Editable=No }
    { 665 ;   ;Posted Hours        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Posted Hour Line"."Total Line" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Posted Hours;
                                                              NOR=Bokf›rte timer;
                                                              SVE=Bokf”rda timmar];
                                                   Editable=No }
    { 670 ;   ;Extension Contract  ;Code10        ;TableRelation="Extension Contract"."Contract No." WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                UpdateExtensionContract;  //DP00260
                                                              END;

                                                   CaptionML=[ENU=Extension Contract;
                                                              NOR=ETA;
                                                              SVE=ŽTA] }
    { 690 ;   ;Apply Surcharge Recipe;Boolean     ;CaptionML=ENU=Apply Surcharge Recipe }
    { 700 ;   ;Surcharge % Labor   ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurcharge(0);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Labor;
                                                              NOR=Tilleggsgebyrsprosent, arbeidskraft;
                                                              SVE=Till„ggsavgiftsprocent, arbetskraft];
                                                   BlankZero=Yes }
    { 701 ;   ;Surcharge % Material;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurcharge(1);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Material;
                                                              NOR=Tilleggsgebyrsprosent, Materiale;
                                                              SVE=Till„ggsavgiftsprocent, material];
                                                   BlankZero=Yes }
    { 702 ;   ;Surcharge % Subcontracting;Decimal ;OnValidate=BEGIN
                                                                UpdateSurcharge(2);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Subcontracting;
                                                              NOR=Tilleggsgebyrsprosent, underentrepen›r;
                                                              SVE=Till„ggsavgiftsprocent, underentreprenad];
                                                   BlankZero=Yes }
    { 703 ;   ;Surcharge % Plant   ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurcharge(3);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Plant;
                                                              NOR=Tilleggsgebyrsprosent, maskin;
                                                              SVE=Till„ggsavgiftsprocent, Maskin];
                                                   BlankZero=Yes }
    { 704 ;   ;Surcharge % Sundry  ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurcharge(4);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Sundry;
                                                              NOR=P†slagssatser, diverse;
                                                              SVE=Till„ggsavgiftsprocent, diverse];
                                                   BlankZero=Yes }
    { 710 ;   ;RAW Estimate        ;Boolean       ;CaptionML=[ENU=RAW Estimate;
                                                              NOR=RAW-kalkyle;
                                                              SVE=RAW-kalkyl];
                                                   Description=RAW }
    { 711 ;   ;Summary Cost (RAW)  ;Option        ;InitValue=Percentage;
                                                   OnValidate=BEGIN
                                                                //DP01488
                                                                TESTFIELD("Percentage (Discount)", 0);
                                                                TESTFIELD("Percentage (GeneralCost)", 0);
                                                                TESTFIELD("Percentage (Profit/Risk)", 0);
                                                                TESTFIELD("Percentage (ExecutionCost)", 0);
                                                              END;

                                                   CaptionML=ENU=Summary Cost (RAW);
                                                   OptionCaptionML=ENU=Amount,Percentage;
                                                   OptionString=Amount,Percentage;
                                                   Description=RAW }
    { 715 ;   ;Percentage (Discount);Decimal      ;OnValidate=BEGIN
                                                                //DP01488
                                                                TESTFIELD(Fixed, FALSE);
                                                                TestParagraphExists(FIELDNO("Percentage (Discount)"));
                                                                CheckPercentageAllowed(FIELDNO("Percentage (Discount)"));
                                                              END;

                                                   CaptionML=ENU=Percentage (Discount);
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=RAW }
    { 720 ;   ;Percentage (GeneralCost);Decimal   ;OnValidate=BEGIN
                                                                TESTFIELD(Fixed, FALSE);
                                                                IF "RAW Estimate" THEN BEGIN  //DP02080
                                                                  TestParagraphExists(FIELDNO("Percentage (GeneralCost)"));
                                                                  CheckPercentageAllowed(FIELDNO("Percentage (GeneralCost)"));
                                                                END ELSE BEGIN
                                                                  TestPartExists(FIELDNO("Percentage (GeneralCost)"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Percentage (General Cost);
                                                              NOR=Prosent (Tilleggsgebyr);
                                                              SVE=Procent (till„ggsavgift)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=DP02080 }
    { 721 ;   ;Percentage (Profit/Risk);Decimal   ;OnValidate=BEGIN
                                                                TESTFIELD(Fixed, FALSE);
                                                                IF "RAW Estimate" THEN BEGIN  //DP02080
                                                                  TestParagraphExists(FIELDNO("Percentage (Profit/Risk)"));
                                                                  CheckPercentageAllowed(FIELDNO("Percentage (Profit/Risk)"));
                                                                END ELSE BEGIN
                                                                  TestPartExists(FIELDNO("Percentage (Profit/Risk)"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Percentage (Profit/Risk);
                                                              NOR=Prosent (Fortjeneste/risk);
                                                              SVE=Procent (vinst/risk)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=DP02080 }
    { 722 ;   ;Percentage (ExecutionCost);Decimal ;OnValidate=BEGIN
                                                                //DP01486
                                                                TESTFIELD(Fixed, FALSE);
                                                                IF "RAW Estimate" THEN BEGIN  //DP02080
                                                                  TestParagraphExists(FIELDNO("Percentage (ExecutionCost)"));
                                                                  CheckPercentageAllowed(FIELDNO("Percentage (ExecutionCost)"));
                                                                END ELSE BEGIN
                                                                  TestPartExists(FIELDNO("Percentage (ExecutionCost)"));
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Percentage (Execution Cost);
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=DP02080 }
    { 730 ;   ;VAT Prod. Posting Group (H);Code20 ;TableRelation="VAT Product Posting Group";
                                                   CaptionML=[ENU=VAT Prod. Posting Group (High);
                                                              NOR=Mva.-prod. bokf›ringsmall (h›y);
                                                              SVE=Momsprod. Bokf”ringsmall (h”g)];
                                                   Description=RAW }
    { 731 ;   ;VAT Prod. Posting Group (L);Code20 ;TableRelation="VAT Product Posting Group";
                                                   CaptionML=[ENU=VAT Prod. Posting Group (Low);
                                                              NOR=Mva-.prod. bokf›ringsmal (lav);
                                                              SVE=Momsprod. Bokf”ringsmall (l†g)];
                                                   Description=RAW }
    { 732 ;   ;VAT Prod. Posting Group (Z);Code20 ;TableRelation="VAT Product Posting Group";
                                                   CaptionML=[ENU=VAT Prod. Posting Group (Zero);
                                                              NOR=Mva.-prod. bokf›ringsmall (null);
                                                              SVE=Momsprod. Bokf”ringsmall (noll)];
                                                   Description=RAW }
    { 735 ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Moms Bevegelsebokf›ringsmal;
                                                              SVE=Moms r”relsebokf”ringsmall];
                                                   Description=RAW }
    { 737 ;   ;VAT Amount (Full)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."VAT Amount" WHERE (Estimate No.=FIELD(No.),
                                                                                                           VAT Calculation Type=CONST(Full VAT)));
                                                   CaptionML=[ENU=VAT Amount (Full);
                                                              NOR=Mva.-bel›p (fullstendig);
                                                              SVE=Momsbelopp (fullst„ndigt)];
                                                   Description=RAW;
                                                   Editable=No }
    { 738 ;   ;VAT Amount (Reverse Charge);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."VAT Amount" WHERE (Estimate No.=FIELD(No.),
                                                                                                           VAT Calculation Type=CONST(Reverse Charge VAT)));
                                                   CaptionML=[ENU=VAT Amount VAT Amount (Reverse Charge);
                                                              NOR=Mva.-bel›p Mva.-bel›p (reversert gebyr);
                                                              SVE=Momsbelopp momsbelopp (omv„nd skatteplikt)];
                                                   Description=RAW;
                                                   Editable=No }
    { 739 ;   ;VAT Amount (Normal) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."VAT Amount" WHERE (Estimate No.=FIELD(No.),
                                                                                                           VAT Calculation Type=CONST(Normal VAT)));
                                                   CaptionML=[ENU=VAT Amount (Normal);
                                                              NOR=Mva.-bel›p (normalt);
                                                              SVE=Momsbelopp (normalt)];
                                                   Description=RAW;
                                                   Editable=No }
    { 740 ;   ;Subtotal (Actual)   ;Decimal       ;CaptionML=[ENU=Subtotal (Actual);
                                                              NOR=Delsum (Faktisk);
                                                              SVE=Delsumma (verklig)];
                                                   Description=RAW;
                                                   Editable=No }
    { 741 ;   ;Subtotal (Calculated);Decimal      ;CaptionML=[ENU=Subtotal (Calculated);
                                                              NOR=Delsum (Kalkulert);
                                                              SVE=Delsumma (ber„knad)];
                                                   Description=RAW;
                                                   Editable=No }
    { 750 ;   ;Contract Amount (Actual);Decimal   ;CaptionML=[ENU=Contract Amount (Actual);
                                                              NOR=Kontraktsbel›p (Faktisk);
                                                              SVE=Kontraktsbelopp (verkligt)];
                                                   Description=RAW;
                                                   Editable=No }
    { 751 ;   ;Contract Amount (Calculated);Decimal;
                                                   CaptionML=[ENU=Contract Amount (Calculated);
                                                              NOR=Kontraktsbel›p (Kalkulert);
                                                              SVE=Kontraktsbelopp (ber„knat)];
                                                   Description=RAW;
                                                   Editable=No }
    { 760 ;   ;Contractor Name     ;Text100       ;CaptionML=[ENU=Contractor Name;
                                                              NOR=Entrepen›rens navn;
                                                              SVE=Entrepren”rens namn];
                                                   Description=RAW }
    { 761 ;   ;Contractor City     ;Text30        ;CaptionML=[ENU=Contractor City;
                                                              NOR=Entrepen›rens by;
                                                              SVE=Entrepren”rens ort];
                                                   Description=RAW }
    { 762 ;   ;Contractor 2 Name   ;Text100       ;CaptionML=[ENU=Contractor 2 Name;
                                                              NOR=Entrepen›r 2 navn;
                                                              SVE=Entrepren”r 2 namn];
                                                   Description=RAW }
    { 763 ;   ;Contractor 2 City   ;Text30        ;CaptionML=[ENU=Contractor 2 City;
                                                              NOR=Entrepen›r 2 poststed;
                                                              SVE=Entrepren”r 2 ort];
                                                   Description=RAW }
    { 764 ;   ;Contractor 3 Name   ;Text100       ;CaptionML=[ENU=Contractor 3 Name;
                                                              NOR=Entrepen›r 3 navn;
                                                              SVE=Entrepren”r 3 namn];
                                                   Description=RAW }
    { 765 ;   ;Contractor 3 City   ;Text30        ;CaptionML=[ENU=Contractor 3 City;
                                                              NOR=Entrepen›r 3 poststed;
                                                              SVE=Entrepren”r 3 ort];
                                                   Description=RAW }
    { 766 ;   ;Contractor Address  ;Text100       ;CaptionML=[ENU=Contractor Address;
                                                              NOR=Entrepen›rens adresse;
                                                              SVE=Entrepren”rens adress];
                                                   Description=RAW }
    { 767 ;   ;Contractor 2 Address;Text100       ;CaptionML=[ENU=Contractor 2 Address;
                                                              NOR=Entrepen›r 2 adresse;
                                                              SVE=Entrepren”r 2 adress];
                                                   Description=RAW }
    { 768 ;   ;Contractor 3 Address;Text100       ;CaptionML=[ENU=Contractor 3 Address;
                                                              NOR=Entrepen›r 3 adresse;
                                                              SVE=Entrepren”r 3 adress];
                                                   Description=RAW }
    { 770 ;   ;Construction Spec. No.;Code20      ;TableRelation="Construction Specification RAW".No.;
                                                   CaptionML=[ENU=Construction Spec. No.;
                                                              NOR=Konstruksjonsspesifikasjonsnr;
                                                              SVE=Konstruktionsspec. nr];
                                                   Description=RAW;
                                                   Editable=No }
    { 771 ;   ;Construction Spec. No. (Cust.);Text27;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Construction Specification RAW"."Specification ID" WHERE (No.=FIELD(Construction Spec. No.)));
                                                   CaptionML=[ENU=Construction Spec. No. (Cust.);
                                                              NOR=Konstruksjonsspesifikasjonsnr. (Kunde);
                                                              SVE=Konstruktionsspec.nr (kund)];
                                                   Description=RAW;
                                                   Editable=No }
    { 775 ;   ;Construction Spec. No. (Note);Code20;
                                                   TableRelation="Construction Specification RAW".No. WHERE (Information Notice=CONST(Yes));
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Construction Spec. No. (Information Notice);
                                                   Description=RAW;
                                                   Editable=No }
    { 780 ;   ;Summary (Sales)     ;Code10        ;TableRelation="Summary Sheet".Summary WHERE (Estimate No.=FIELD(No.),
                                                                                                Summary Type=CONST(Sales));
                                                   CaptionML=[ENU=Summary (Sales);
                                                              NOR=Sum (salg);
                                                              SVE=Summa (f”rs„ljning)] }
    { 781 ;   ;Summary (Cost)      ;Code10        ;TableRelation="Summary Sheet".Summary WHERE (Estimate No.=FIELD(No.),
                                                                                                Summary Type=CONST(Cost));
                                                   CaptionML=[ENU=Summary (Cost);
                                                              NOR=Sum (kost);
                                                              SVE=Summa (kostnad)] }
    { 790 ;   ;Item Sales Price Based On;Option   ;CaptionML=ENU=Item Sales Price Based On;
                                                   OptionCaptionML=[ENU=Cost Price,Gross Price - Sales Discount;
                                                                    NOR=Selvkostpris,Bruttopris Í Salgsrabatt;
                                                                    SVE=Sj„lvkostnadspris,Bruttopris Í F”rs„ljningsrabatt];
                                                   OptionString=CostPrice,GrossMin }
    { 795 ;   ;Subcontracting in Hours;Boolean    ;OnValidate=BEGIN
                                                                UpdateEstimateLines(FIELDNO("Subcontracting in Hours"));  //C053751
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Subcontracting in Hours;
                                                   Description=C053751 }
    { 800 ;   ;Plant Rates in Hours;Boolean       ;OnValidate=BEGIN
                                                                UpdateEstimateLines(FIELDNO("Plant Rates in Hours"));  //C053751
                                                              END;

                                                   CaptionML=[ENU=Plant Rates in Hours;
                                                              NOR=Maskingebyrer i timer;
                                                              SVE=Maskinavgifter i timmar];
                                                   Description=DP01047 }
    { 810 ;   ;Kind of Plant Rate  ;Option        ;InitValue=Intern;
                                                   CaptionML=ENU=Kind of Plant Rate;
                                                   OptionCaptionML=[ENU=Internal,External;
                                                                    NOR=Internt,Eksternt;
                                                                    SVE=Internt,Externt];
                                                   OptionString=Intern,Extern;
                                                   Description=DP01047 }
    { 900 ;   ;Surcharge Amount Labor;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Surcharge Amount Labor" WHERE (Estimate No.=FIELD(No.),
                                                                                                                       Cost Type=CONST(Labor)));
                                                   CaptionML=[ENU=Surcharge Amount Labor;
                                                              NOR=Tilleggsgebyr, arbeidskraft;
                                                              SVE=Till„ggsbelopp, arbetskraft];
                                                   Description=RAW;
                                                   Editable=No }
    { 901 ;   ;Surcharge Amount Material;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Surcharge Amount Material" WHERE (Estimate No.=FIELD(No.),
                                                                                                                          Cost Type=CONST(Material)));
                                                   CaptionML=[ENU=Surcharge Amount Material;
                                                              NOR=Tilleggsgebyr, Materiale;
                                                              SVE=Till„ggsbelopp, material];
                                                   Description=RAW;
                                                   Editable=No }
    { 902 ;   ;Surcharge Amount Subcontr.;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Surcharge Amount Subcontr." WHERE (Estimate No.=FIELD(No.),
                                                                                                                           Cost Type=CONST(Subcontracting)));
                                                   CaptionML=[ENU=Surcharge Amount Subcontr.;
                                                              NOR=Tilleggsgebyr, Underentrepren›r;
                                                              SVE=Till„ggsbelopp, underentrepren”r];
                                                   Description=RAW;
                                                   Editable=No }
    { 903 ;   ;Surcharge Amount Plant;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Surcharge Amount Plant" WHERE (Estimate No.=FIELD(No.),
                                                                                                                       Cost Type=CONST(Plant)));
                                                   CaptionML=[ENU=Surcharge Amount Plant;
                                                              NOR=Tilleggsgebyr, maskin;
                                                              SVE=Till„ggsbelopp, Maskin];
                                                   Description=RAW;
                                                   Editable=No }
    { 904 ;   ;Total Surcharge Amount;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line RAW"."Total Surcharge Amount" WHERE (Estimate No.=FIELD(No.)));
                                                   CaptionML=[ENU=Total Surcharge Amount;
                                                              NOR=Tilleggsgebyr Totalt;
                                                              SVE=Till„ggsbelopp totalt];
                                                   Description=RAW;
                                                   Editable=No }
    { 910 ;   ;Information Note Date;Date         ;CaptionML=ENU=Information Note Date;
                                                   Description=C037108 (RAW) }
    { 915 ;   ;Information Note Time;Time         ;CaptionML=ENU=Information Note Time;
                                                   Description=C037108 (RAW) }
    { 925 ;   ;Calculate Surcharge on;Option      ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Calculate Surcharge on;
                                                   OptionCaptionML=ENU=Cost and Sales,Cost Only;
                                                   OptionString=CostSales,CostOnly;
                                                   Description=DP02080+C056578 }
    { 930 ;   ;Surcharge Method    ;Option        ;OnValidate=BEGIN
                                                                //DP02080
                                                                IF NOT "RAW Estimate" THEN BEGIN
                                                                  IF "Surcharge Method" = "Surcharge Method"::Summary THEN BEGIN
                                                                    "Percentage (GeneralCost)" := 0;
                                                                    "Percentage (Profit/Risk)" := 0;
                                                                    "Percentage (ExecutionCost)" := 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Surcharge Method;
                                                   OptionCaptionML=ENU=Summary,Surcharge By Part,Predefined Part;
                                                   OptionString=Summary,Surcharge By Part,Predefined Part;
                                                   Description=DP02080 }
    { 935 ;   ;Part (Surcharge)    ;Code20        ;TableRelation="Estimate Base Part".Code WHERE (Part Group=FIELD(Part Group));
                                                   OnValidate=BEGIN
                                                                IF "Part (Surcharge)" <> '' THEN
                                                                  TestPartExists(FIELDNO("Part (Surcharge)"));  //DP02080
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Part (Surcharge);
                                                   Description=DP02080 }
    { 940 ;   ;Last Date Recalculated;Date        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Last Date recalculated;
                                                   Description=DP02080;
                                                   Editable=No }
    { 941 ;   ;Last Time Recalculated;Time        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Last Time recalculated;
                                                   Description=DP02080;
                                                   Editable=No }
    { 950 ;   ;Estimate Template Code;Code10      ;TableRelation="Estimate Template".Code;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Estimate Template Code;
                                                   NotBlank=Yes;
                                                   Description=DP02264 }
    { 1000;   ;Expected Est. Completion Date;Date ;CaptionML=[ENU=Expected Est. Completion Date;
                                                              NOR=Forventet sluttdato for kalkyle;
                                                              SVE=F”rv„ntad slutf”randedatum f”r kalkyl] }
    { 1010;   ;Report Currency Code;Code10        ;TableRelation=Currency;
                                                   OnValidate=VAR
                                                                EstimatePartNEW@1100528600 : Record 11072073;
                                                              BEGIN
                                                                IF "Report Currency Code" <> xRec."Report Currency Code" THEN BEGIN
                                                                  MODIFY;
                                                                  EstimatePartNEW.SETRANGE("Estimate No.", "No.");
                                                                  IF EstimatePartNEW.FINDSET THEN
                                                                    REPEAT
                                                                      EstimatePartNEW.VALIDATE("Offer Amount");
                                                                      EstimatePartNEW.MODIFY;
                                                                    UNTIL EstimatePartNEW.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Report Currency Code }
    { 1020;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod] }
    { 1030;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              NOR=Spr†kkode;
                                                              SVE=Spr†kkod] }
    { 1040;   ;Margin % (Offer Price);Decimal     ;CaptionML=ENU=Margin % (Offer Price) }
    { 1045;   ;Markup % (Offer Price);Decimal     ;CaptionML=ENU=Markup % (Offer Price) }
    { 1050;   ;Offer Price Based On;Option        ;CaptionML=ENU=Offer Price Based On;
                                                   OptionCaptionML=[ENU=Cost,Sales;
                                                                    NOR=Kostnad,Salg;
                                                                    SVE=Kostnad,F”rs„ljning];
                                                   OptionString=Cost,Sales }
    { 1060;   ;Apply SurchMat PriceZero Only;Boolean;
                                                   CaptionML=ENU=Apply Surcharge Material only for Item without Sales Condition;
                                                   Description=DP01243 }
    { 1061;   ;Apply SalesPrice for SurchMat;Boolean;
                                                   CaptionML=ENU=Apply Sales Condition instead of Surcharge Material;
                                                   Description=DP01243 }
    { 1070;   ;Apply Product Discount;Boolean     ;CaptionML=ENU=Apply Product Discount;
                                                   Description=DP01727 }
    { 1080;   ;Apply Linked Recipe ;Boolean       ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Apply Linked Recipe;
                                                              SVE=Uppsk. radl„ngd f„ltrubrik];
                                                   Description=DP02082 }
    { 1090;   ;Preferred Supplier  ;Code20        ;TableRelation=Vendor.No.;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Preferred Supplier;
                                                   Description=C051377 }
    { 1091;   ;Name Vendor         ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Name WHERE (No.=FIELD(Preferred Supplier)));
                                                   CaptionML=[ENU=Name Vendor;
                                                              SVE=Leverant”rens namn];
                                                   Description=C051377;
                                                   Editable=No }
    { 1092;   ;Vendor (Trade Item) ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor."Vendor (Trade Item)" WHERE (No.=FIELD(Preferred Supplier)));
                                                   CaptionML=[ENU=Vendor (Trade Item);
                                                              SVE=Leverant”r (skaffningsartikel)];
                                                   Description=C051377;
                                                   Editable=No }
    { 11128101;;Amount ROT         ;Decimal       ;CaptionML=ENU=Amount ROT/RUT;
                                                   Description=4PSSE.I012 }
    { 11128270;;Price List Code    ;Code10        ;TableRelation="Customer Price List" WHERE (Display Price List=CONST(Yes));
                                                   CaptionML=[ENU=Price List Code;
                                                              NOR=Prislistekode;
                                                              SVE=Prislistekod];
                                                   Description=EVRY }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Customer No.                             }
    {    ;City,Address                             }
    {    ;Project No.,Element                      }
    {    ;Plant Location                           }
    {    ;Status                                   }
    {    ;Expected Est. Completion Date            }
    {    ;Contact No.,Contact Person No.           }
    {    ;Last Date Modified,Estimator             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@11012009 : TextConst 'ENU=must occur before %1;NOR=m† inntreffe f›r %1;SVE=m†ste intr„ffa f”re %1';
      Text001@11012010 : TextConst 'ENU=Must occur after  %1;NOR=M† inntreffe etter %1;SVE=M†ste intr„ffa efter %1';
      Text002@11012011 : TextConst 'ENU=Rates already present.;NOR=Avgifter finnes allerede.;SVE=Avgifter finns redan.';
      UserSetup@1100409000 : Record 91;
      ProjSetup@1100525002 : Record 315;
      ServiceSetup@1100485000 : Record 11012800;
      EstSetup@11012000 : Record 11012150;
      GWWSetup@1100525004 : Record 11012260;
      EstimateRAWSetup@1100525003 : Record 11125673;
      CompInfoRec@1100525005 : Record 79;
      EstRec@1210190004 : Record 11012151;
      EstRateRec@1210190009 : Record 11012160;
      CustRec@1100485003 : Record 18;
      ElemRec@1210190012 : Record 11012060;
      CodeRec@1210190014 : Record 11012089;
      ProjElemRec@1210190011 : Record 11012010;
      PostCode@11012003 : Record 225;
      ContBusRel@1210190017 : Record 5054;
      ContRec@1210190016 : Record 5050;
      TryOutRec@1100485002 : Record 11012761;
      ServLocRec@1100525001 : Record 11012801;
      ServContrRec@1100525000 : Record 11012812;
      NoSeriesMgt@1210190005 : Codeunit 396;
      FormatMgt@1210190013 : Codeunit 11012022;
      Text003@1100525009 : TextConst 'ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.;NOR=F›r du kan bruke Online Map m† du fylle ut vinduet Online Map - Innstillinger.\Se Konfigurasjon av Online Map i Hjelp;SVE=Innan du kan anv„nda Online Map m†ste du fylla i f”nstret Online Map - inst„llning.\Se Konfiguration av Online Map i hj„lpen';
      Text010@1100525006 : TextConst 'ENU=Do you want to change Address Data: \\Old: \%1 \%2 \\New:  \%3 \%4';
      Text011@1100525007 : TextConst 'ENU=cannot be assigned because %1 %2 does not exist;NOR=kan ikke stilles inn siden element %1 ikke finnes.;SVE=kan inte st„llas in eftersom element %1 inte finns.';
      DPA_Management@1100000999 : Codeunit 11012783;
      Text012@1210190000 : TextConst 'ENU=%1 %2 doesn''t exist in %3, continue?;NOR=%1 %2 finnes ikke i %3. Fortsette?;SVE=%1 %2 finns inte i %3. Forts„tta?';
      Text013@1210190001 : TextConst 'ENU=Only Relations of Type Company or Person without Company allowed;NOR=Kun relasjoner av typen selskap eller Person uten selskap tillates;SVE=Endast relationer av typen F”retag eller Person utan f”retag till†ts';
      Text014@1100529000 : TextConst 'ENU=must be zero, already estimate lines present for %1 ''%2''';
      Text999@1100525008 : TextConst 'ENU=This option is only available for estimates with 1 sub-estimate and 1 part: Estimate Index will be started.';
      Text11012002@1100409001 : TextConst 'ENU=You have no permission to change %1;NOR=Du mangler tillatelse til † endre %1;SVE=Du saknar beh”righet att „ndra %1';
      SkipStatusWarning@1100529400 : Boolean;
      WriteDateTimeRecalculated@1100528900 : Boolean;
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
      Text11012005@1100528901 : TextConst 'ENU=Do you want to create the estimate based on a template?';
      CurrencyCode@1100528903 : Code[10];
      SwitchCurrency@1100528902 : Boolean;
      "-EVRY-"@1100285002 : Integer;
      EstimateStatus@1100285001 : Record 11020456;

    PROCEDURE AssistEdit@2(OldEst@11012000 : Record 11012151) : Boolean;
    BEGIN
      WITH EstRec DO BEGIN
        EstRec := Rec;
        IF "RAW Estimate" THEN BEGIN
          EstimateRAWSetup.GET;
          EstimateRAWSetup.TESTFIELD("Estimate Nos.");
          IF NoSeriesMgt.SelectSeries(EstimateRAWSetup."Estimate Nos.",OldEst."No. Series","No. Series") THEN BEGIN
            NoSeriesMgt.SetSeries("No.");
            Rec := EstRec;
            EXIT(TRUE);
          END;
        END ELSE BEGIN
          EstSetup.GET;
          EstSetup.TESTFIELD("Estimate Nos.");
          IF NoSeriesMgt.SelectSeries(EstSetup."Estimate Nos.",OldEst."No. Series","No. Series") THEN BEGIN
            NoSeriesMgt.SetSeries("No.");
            Rec := EstRec;
            EXIT(TRUE);
          END;
        END;
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimMgt@1100525000 : Codeunit 408;
      DimValRec@1100525001 : Record 349;
    BEGIN
      //db, 19-08-09: M15896
      IF ShortcutDimCode = '' THEN EXIT;
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.GetDimValueRec(FieldNumber, ShortcutDimCode, DimValRec, TRUE,'');
      IF NOT DimMgt.CheckDimValue(DimValRec."Dimension Code",ShortcutDimCode) THEN
        ERROR(DimMgt.GetDimErr);
    END;

    PROCEDURE EstimatorName@3() : Text[100];
    VAR
      EmplRec@11012000 : Record 5200;
      EstNameTxt@11012001 : Text[100];
    BEGIN
      IF EmplRec.GET(Estimator) THEN
        EstNameTxt := EmplRec.FullName
      ELSE
        EstNameTxt := '';
      EXIT(EstNameTxt);
    END;

    PROCEDURE UpdateLogbook@1000000000(lvEstNo@1000000000 : Code[20]);
    VAR
      lvEstRec@1000000001 : Record 11012151;
      DiffTime@1100529403 : Decimal;
      MaxDiff@1100529402 : Decimal;
      NewDateTime@1100529401 : DateTime;
      OldDateTime@1100529400 : DateTime;
      DummyDate@1100529404 : Date;
      DummyTime@1100529405 : Time;
    BEGIN
      SELECTLATESTVERSION;  //C041101 (db, 20-02-18: get last time-stamp maybe set by other nst)
      IF lvEstRec.GET(lvEstNo) THEN BEGIN
        //C032265.sn
        IF NOT WriteDateTimeRecalculated THEN BEGIN  //DP02080
          IF NOT SkipStatusWarning THEN
            IF lvEstRec.GetStatusWarning(lvEstNo) THEN EXIT;
          OldDateTime := CREATEDATETIME(lvEstRec."Last Date Modified", lvEstRec."Last Time Modified");
          NewDateTime := CREATEDATETIME(TODAY, TIME);
          IF (lvEstRec."Last Date Modified" <> DummyDate) AND
             (lvEstRec."Last Time Modified" <> DummyTime) THEN BEGIN  //db, 23-09-16
            OldDateTime := CREATEDATETIME(lvEstRec."Last Date Modified", lvEstRec."Last Time Modified");
            DiffTime := NewDateTime - OldDateTime;
            MaxDiff := 3000;  //skip logbook for update within approximately 3 seconds
            IF DiffTime < MaxDiff THEN EXIT;
          END;
        END;
        //C032265.en
        lvEstRec."Last Date Modified" := TODAY;
        lvEstRec."Last Time Modified" := TIME;
        //DP02080.sn
        IF WriteDateTimeRecalculated THEN BEGIN
          lvEstRec."Last Date Recalculated" := lvEstRec."Last Date Modified";
          lvEstRec."Last Time Recalculated" := lvEstRec."Last Time Modified";
        END;
        //DP02080.en
        lvEstRec."Modified by" := USERID;
        lvEstRec.MODIFY;
      END;
    END;

    PROCEDURE UpdateProjElem@1100485000(lvAction@1100485000 : Integer);
    VAR
      SubEstimate@1100525000 : Record 11072074;
      EstimateElementRAW@1100525001 : Record 11125679;
      EstimateLineRAW@1100528900 : Record 11125698;
    BEGIN
      IF "Project No." = '' THEN
        "Extension Contract" := '';  //DP00260

      IF "RAW Estimate" THEN BEGIN
        //C040309
        IF lvAction = 0 THEN BEGIN
          EstimateLineRAW.SETRANGE("Estimate No.", "No.");
          EstimateLineRAW.SETFILTER("Project No.", '%1|%2', '', xRec."Project No.");
          IF EstimateLineRAW.FINDSET(TRUE, FALSE) THEN BEGIN
            REPEAT
              EstimateLineRAW."Project No." := "Project No.";
              EstimateLineRAW.MODIFY;
            UNTIL EstimateLineRAW.NEXT = 0;
          END;
        END;
        IF lvAction = 1 THEN BEGIN
          EstimateElementRAW.SETRANGE("Estimate No.", "No.");
          EstimateElementRAW.SETFILTER("Base Element", '%1|%2', '', xRec.Element);
          IF EstimateElementRAW.FINDSET(TRUE, FALSE) THEN BEGIN
            REPEAT
              EstimateElementRAW.VALIDATE("Base Element", Element);
              EstimateElementRAW.MODIFY;
            UNTIL EstimateElementRAW.NEXT = 0;
          END;
        END;
      END ELSE BEGIN
        SubEstimate.SETRANGE("Estimate No.", "No.");
        IF lvAction = 0 THEN
          SubEstimate.SETFILTER("Project No.", '%1|%2', '', xRec."Project No.")
        ELSE
          SubEstimate.SETFILTER(Element, '%1|%2', '', xRec.Element);
        IF SubEstimate.FINDSET(TRUE, FALSE) THEN BEGIN
          REPEAT
            IF lvAction = 0 THEN
              SubEstimate.VALIDATE("Project No.", "Project No.")
            ELSE
              SubEstimate.VALIDATE(Element, Element);
            IF "Project No."= '' THEN
              SubEstimate."Extension Contract" := '';  //DP00260
            SubEstimate.MODIFY;
          UNTIL SubEstimate.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE UpdateSubEstimates@1100528500(CalledBy@1100485000 : Integer);
    VAR
      SubEstimate@1100525000 : Record 11072074;
    BEGIN
      //DP01931
      IF "RAW Estimate" THEN BEGIN
      END ELSE BEGIN
        SubEstimate.SETRANGE("Estimate No.", "No.");
        IF SubEstimate.FINDSET(TRUE, FALSE) THEN BEGIN
          REPEAT
            IF CalledBy = FIELDNO(Finished) THEN
              SubEstimate.VALIDATE(Finished, Finished);
            IF CalledBy = FIELDNO(Discipline) THEN
              SubEstimate.VALIDATE(Discipline, Discipline);  //DP02460
            SubEstimate.MODIFY;
          UNTIL SubEstimate.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE UpdateLowerLevelServOrder@1100525023();
    VAR
      SubEstimate@1100525000 : Record 11072074;
      EstimateLineRAW@1100525001 : Record 11125698;
      EstimateLine@1100525002 : Record 11072072;
    BEGIN
      //C043087
      IF "RAW Estimate" THEN BEGIN
        //DP01676.sn
        EstimateLineRAW.SETRANGE("Estimate No.", "No.");
        EstimateLineRAW.SETFILTER("Service Order No.", '%1|%2', '', xRec."Service Order No.");
        IF EstimateLineRAW.FINDSET(TRUE, FALSE) THEN BEGIN
          REPEAT
            EstimateLineRAW."Service Order No." := "Service Order No.";
            EstimateLineRAW.MODIFY;
          UNTIL EstimateLineRAW.NEXT = 0;
        END;
        //DP01676.en
      END ELSE BEGIN
        SubEstimate.SETRANGE("Estimate No.", "No.");
        SubEstimate.SETFILTER("Service Order No.", '%1|%2', '', xRec."Service Order No.");
        SubEstimate.SETFILTER("Transfer to Service", '%1|%2', SubEstimate."Transfer to Service"::" ", SubEstimate."Transfer to Service"::ServOrder);
        IF SubEstimate.FINDSET(TRUE, FALSE) THEN BEGIN
          REPEAT
            SubEstimate."Transfer to Service" := SubEstimate."Transfer to Service"::ServOrder;
            SubEstimate."Service Order No." := "Service Order No.";
            SubEstimate."Service Location No." := "Service Location No.";
            SubEstimate.MODIFY;
            //
            EstimateLine.SETRANGE("Estimate No.", SubEstimate."Estimate No.");
            EstimateLine.SETRANGE("Sub-Estimate No.", SubEstimate."Sub-Estimate No.");
            IF EstimateLine.FINDSET(TRUE, FALSE) THEN BEGIN
              REPEAT
                EstimateLine."Service Order No." := "Service Order No.";
                EstimateLine.MODIFY;
              UNTIL EstimateLine.NEXT = 0;
            END;
          UNTIL SubEstimate.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE CheckRateConditions@1100485012();
    VAR
      UpdateMgt@1100525001 : Codeunit 11012229;
      RateGrp@1100525000 : Code[20];
    BEGIN
      IF NOT CustRec.GET("Customer No.") THEN EXIT;

      RateGrp := "Rate Group";
      IF CustRec."Rate Group" <> '' THEN
        RateGrp := CustRec."Rate Group";

      IF RateGrp <> "Rate Group" THEN BEGIN
        UpdateMgt.UpdateRate("No.", "Rate Group", RateGrp);  //C025953
        "Rate Group" := RateGrp;
      END;
    END;

    PROCEDURE LookupServiceContract@1210190007();
    VAR
      ServiceSetup@1100525000 : Record 11012800;
    BEGIN
      ServiceSetup.GET;
      ServContrRec.RESET;
      IF "Customer No." <> '' THEN
        ServContrRec.SETFILTER("Customer No.", '%1|%2', "Customer No.", '');
      IF NOT ServContrRec.GET("Service Contract No.") THEN ServContrRec.INIT;
      IF PAGE.RUNMODAL(PAGE::"Service Contracts List", ServContrRec) = ACTION::LookupOK THEN
        VALIDATE("Service Contract No.", ServContrRec."No.");
    END;

    PROCEDURE LookupServiceLocation@1100525000();
    BEGIN
      ServLocRec.RESET;
      IF "Service Contract No." <> '' THEN BEGIN
        ServContrRec.GET("Service Contract No.");
        ServLocRec.SETFILTER("Customer No.", ServContrRec."Customer No.");
      END ELSE BEGIN
        IF "Customer No." <> '' THEN
          ServLocRec.SETFILTER("Customer No.", '%1|%2', "Customer No.", '');
      END;

      IF NOT ServLocRec.GET("Service Location No.") THEN ServLocRec.INIT;
      IF PAGE.RUNMODAL(PAGE::"Service Location List", ServLocRec) = ACTION::LookupOK THEN BEGIN
        VALIDATE("Service Location No.", ServLocRec."No.");
        CheckAddressServiceLocation;  //db, 10-12-09: M14821
      END;
    END;

    PROCEDURE LookupServiceOrder@1100525017();
    VAR
      ServOrderRec@1100525000 : Record 11012823;
    BEGIN
      //db, 01-07-10: M17238
      ServOrderRec.RESET;
      GetFilterTransferToServOrder(ServOrderRec);
      PAGE.RUNMODAL(0, ServOrderRec);
    END;

    PROCEDURE GetNumServiceOrder@1100525015() : Text[30];
    VAR
      ServOrderRec@1100525000 : Record 11012823;
      NumOrder@1100525002 : Integer;
    BEGIN
      //db, 01-07-10: M17238
      IF "No." = '' THEN EXIT('');  //C026176

      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(ServOrderRec) THEN
        EXIT('');

      ServOrderRec.RESET;
      NumOrder := GetFilterTransferToServOrder(ServOrderRec);

      IF NumOrder = 0 THEN
        EXIT('');

      IF NumOrder = 1 THEN
        EXIT(ServOrderRec."No.");

      EXIT(STRSUBSTNO('[%1]', NumOrder));
    END;

    PROCEDURE GetFilterTransferToServOrder@1100525021(VAR ServOrderRec@1100525000 : Record 11012823) NumOrder : Integer;
    VAR
      TmpOrderRec@1100525003 : TEMPORARY Record 11012823;
      SubEstRecNew@1100525001 : Record 11072074;
    BEGIN
      IF "RAW Estimate" THEN BEGIN
        TmpOrderRec."No." := "Service Order No.";  //db, 31-01-20
        IF TmpOrderRec.INSERT THEN;
      END ELSE BEGIN
        SubEstRecNew.SETRANGE("Estimate No.", "No.");
        SubEstRecNew.SETRANGE("Transfer to Service", SubEstRecNew."Transfer to Service"::ServOrder);
        IF SubEstRecNew.FINDSET THEN BEGIN
          REPEAT
            IF SubEstRecNew."Service Order No." <> '' THEN BEGIN
              TmpOrderRec."No." := SubEstRecNew."Service Order No.";
              IF TmpOrderRec.INSERT THEN;
            END;
          UNTIL SubEstRecNew.NEXT = 0;
          //
          ServOrderRec.SETCURRENTKEY("Estimate No.");
          ServOrderRec.SETRANGE("Estimate No.", "No.");
          IF ServOrderRec.FINDSET THEN BEGIN
            REPEAT
              TmpOrderRec."No." := ServOrderRec."No.";
              IF TmpOrderRec.INSERT THEN;
            UNTIL ServOrderRec.NEXT = 0;
          END;
        END;
      END;

      IF TmpOrderRec.FINDFIRST THEN BEGIN
        REPEAT
          ServOrderRec."No." := TmpOrderRec."No.";
          ServOrderRec.MARK := TRUE;
          NumOrder := NumOrder + 1;
        UNTIL TmpOrderRec.NEXT = 0;
        ServOrderRec.SETCURRENTKEY("No.");
        ServOrderRec.SETRANGE("Estimate No.");  //db, 10-09-10
        ServOrderRec.MARKEDONLY(TRUE);
      END;

      EXIT(NumOrder);
    END;

    PROCEDURE CheckAddressServiceLocation@1100525003();
    BEGIN
      //db, 10-12-09: M14821
      IF (ServLocRec.Address <> Address) OR (ServLocRec.City <> City) THEN BEGIN
        IF CONFIRM(Text010, TRUE,
          Address, ("Post Code" + '  ' + City),
          ServLocRec.Address, (ServLocRec."Post Code" + '  ' + ServLocRec.City)) THEN
        BEGIN
          Address := ServLocRec.Address;
          "Address 2" := ServLocRec."Address 2";
          City := ServLocRec.City;
          "Post Code" := ServLocRec."Post Code";
          County := ServLocRec.County;
          "Country/Region Code":= ServLocRec."Country/Region Code";
          "Territory Code":= ServLocRec."Territory Code";
        END;
      END;
    END;

    PROCEDURE CalculateAdditionalCost@1100525001(iType@1100525001 : Integer;iTotal@1100525003 : Decimal) Result : Decimal;
    VAR
      lvPerc@1100525002 : Decimal;
    BEGIN
      IF (iType = 0) OR (iType = 1) THEN
        lvPerc := lvPerc + "Percentage (GeneralCost)";
      IF (iType = 0) OR (iType = 2) THEN
        lvPerc := lvPerc + "Percentage (Profit/Risk)";
      IF (iType = 0) OR (iType = 3) THEN
        lvPerc := lvPerc + "Percentage (ExecutionCost)";  //DP01486
      IF (iType = 0) OR (iType = 4) THEN
        lvPerc := lvPerc - "Percentage (Discount)";  //DP01488

      Result := ROUND(iTotal * (lvPerc/100));
      IF (iType = 0) THEN
        Result := iTotal + Result;
      EXIT(Result);
    END;

    PROCEDURE SafeDivision@1100525004(Numerator@1100525000 : Decimal;Denominator@1100525001 : Decimal) : Decimal;
    BEGIN
      IF Denominator = 0 THEN
        EXIT(0);
      EXIT(Numerator / Denominator);
    END;

    PROCEDURE SurchargePct@1100525005() Result : Decimal;
    BEGIN
      CALCFIELDS("Labor (RAW)", "Material (RAW)", "Subcontracting (RAW)", "Plant (RAW)", "Total Surcharge Amount");
      Result := SafeDivision("Total Surcharge Amount", "Labor (RAW)" + "Material (RAW)" + "Subcontracting (RAW)" + "Plant (RAW)") * 100;
    END;

    PROCEDURE MarginPct@1100525006() Result : Decimal;
    BEGIN
      CALCFIELDS(
        "Labor (RAW)",
        "Surcharge Amount Labor",
        "Material (RAW)",
        "Surcharge Amount Material",
        "Subcontracting (RAW)",
        "Surcharge Amount Subcontr.",
        "Plant (RAW)",
        "Surcharge Amount Plant",
        "Total Surcharge Amount");

      Result :=
        SafeDivision(
          "Total Surcharge Amount",
          "Labor (RAW)" +
          "Surcharge Amount Labor" +
          "Material (RAW)" +
          "Surcharge Amount Material" +
          "Subcontracting (RAW)" +
          "Surcharge Amount Subcontr." +
          "Plant (RAW)" +
          "Surcharge Amount Plant") * 100;
    END;

    PROCEDURE SurchargePctLabor@1100525007() : Decimal;
    BEGIN
      CALCFIELDS("Labor (RAW)", "Surcharge Amount Labor");
      EXIT(SafeDivision("Surcharge Amount Labor", "Labor (RAW)") * 100);
    END;

    PROCEDURE SurchargePctMaterial@1100525008() : Decimal;
    BEGIN
      CALCFIELDS("Material (RAW)", "Surcharge Amount Material");
      EXIT(SafeDivision("Surcharge Amount Material", "Material (RAW)") * 100);
    END;

    PROCEDURE SurchargePctSubcontracting@1100525009() : Decimal;
    BEGIN
      CALCFIELDS("Subcontracting (RAW)", "Surcharge Amount Subcontr.");
      EXIT(SafeDivision("Surcharge Amount Subcontr.", "Subcontracting (RAW)") * 100);
    END;

    PROCEDURE SurchargePctPlant@1100525010() : Decimal;
    BEGIN
      CALCFIELDS("Plant (RAW)", "Surcharge Amount Plant");
      EXIT(SafeDivision("Surcharge Amount Plant", "Plant (RAW)") * 100);
    END;

    PROCEDURE InitRecord@1100525011();
    BEGIN
      //db, 05-11-18
      "Creation Date" := TODAY;
      "Created by" := USERID;
      "Reference Date (Rate)" := TODAY;
      "Reference Date (Sales Price)" := TODAY;
      "Open Budget Sent on" := 0D;
      Fixed := FALSE;
      Finished := FALSE;

      IF UserSetup.GET(USERID) THEN
        Estimator := UserSetup.Estimator;
    END;

    PROCEDURE InitRates@1100528503();
    BEGIN
      //db, 05-11-18
      EstSetup.GET;
      IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN BEGIN
        xRec."Rate Group" := '';
        VALIDATE("Rate Group");
      END;
      IF (EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Budget Rate") THEN BEGIN
        EstRateRec.SETRANGE("Estimate No.","No.");
        IF NOT EstRateRec.FINDFIRST THEN BEGIN
          GetCostRate;
          GetSalesRate;
        END;
      END;
    END;

    PROCEDURE TestParagraphExists@1100525012(FieldNo@1100525000 : Integer);
    VAR
      EstimateElementRAW@1100525001 : Record 11125679;
    BEGIN
      //db, 22-02-16: skip hardcode check
      EstimateRAWSetup.GET;

      EstimateElementRAW.SETCURRENTKEY("Estimate No.", "Tender Paragraph No.", "Construction Spec. Line No.");
      EstimateElementRAW.SETRANGE("Estimate No.", "No.");
      EstimateElementRAW.SETRANGE("Construction Spec. Line No.", '00');

      CASE FieldNo OF
        Rec.FIELDNO("Percentage (Discount)"):  //DP01488
          BEGIN
            EstimateRAWSetup.TESTFIELD("Paragraph No.(Discount)");
            EstimateElementRAW.SETRANGE("Tender Paragraph No.", EstimateRAWSetup."Paragraph No.(Discount)");
            IF EstimateElementRAW.ISEMPTY THEN
              FIELDERROR("Percentage (Discount)", STRSUBSTNO(Text011, EstimateRAWSetup.FIELDCAPTION("Paragraph No.(Discount)"), EstimateRAWSetup."Paragraph No.(Discount)"));
          END;
        Rec.FIELDNO("Percentage (GeneralCost)"):
          BEGIN
            EstimateRAWSetup.TESTFIELD("Paragraph No.(GeneralCost)");
            EstimateElementRAW.SETRANGE("Tender Paragraph No.", EstimateRAWSetup."Paragraph No.(GeneralCost)");
            IF EstimateElementRAW.ISEMPTY THEN
              FIELDERROR("Percentage (GeneralCost)", STRSUBSTNO(Text011, EstimateRAWSetup.FIELDCAPTION("Paragraph No.(GeneralCost)"), EstimateRAWSetup."Paragraph No.(GeneralCost)"));
          END;
        Rec.FIELDNO("Percentage (Profit/Risk)"):
          BEGIN
            EstimateRAWSetup.TESTFIELD("Paragraph No.(Profit/Risk)");
            EstimateElementRAW.SETRANGE("Tender Paragraph No.", EstimateRAWSetup."Paragraph No.(Profit/Risk)");
            IF EstimateElementRAW.ISEMPTY THEN
              FIELDERROR("Percentage (Profit/Risk)", STRSUBSTNO(Text011, EstimateRAWSetup.FIELDCAPTION("Paragraph No.(Profit/Risk)"), EstimateRAWSetup."Paragraph No.(Profit/Risk)"));
          END;
        Rec.FIELDNO("Percentage (ExecutionCost)"):  //DP01486
          BEGIN
            EstimateRAWSetup.TESTFIELD("Paragraph No.(ExecutionCost)");
            EstimateElementRAW.SETRANGE("Tender Paragraph No.", EstimateRAWSetup."Paragraph No.(ExecutionCost)");
            IF EstimateElementRAW.ISEMPTY THEN
              FIELDERROR("Percentage (ExecutionCost)", STRSUBSTNO(Text011, EstimateRAWSetup.FIELDCAPTION("Paragraph No.(ExecutionCost)"), EstimateRAWSetup."Paragraph No.(ExecutionCost)"));
          END;
      END;
    END;

    PROCEDURE TestPartExists@1100528501(FieldNo@1100525000 : Integer);
    VAR
      SubEstimate@1100525001 : Record 11072074;
      EstimatePart@1100528500 : Record 11072073;
    BEGIN
      //DP02080
      IF "Surcharge Method" <> "Surcharge Method"::"Predefined Part" THEN EXIT;  //db, 12-08-19

      SubEstimate.SETRANGE("Estimate No.", "No.");
      IF SubEstimate.FINDSET THEN BEGIN
        REPEAT
          EstimatePart.SETRANGE("Estimate No.", SubEstimate."Estimate No.");
          EstimatePart.SETRANGE("Sub-Estimate No.", SubEstimate."Sub-Estimate No.");
          EstimatePart.SETRANGE("Part Group", SubEstimate."Part Group");
          EstimatePart.SETRANGE(Part, "Part (Surcharge)");
          IF EstimatePart.ISEMPTY THEN BEGIN
            CASE FieldNo OF
              Rec.FIELDNO("Part (Surcharge)"):
                FIELDERROR("Part (Surcharge)", STRSUBSTNO(Text011, EstimatePart.FIELDCAPTION(Part), "Part (Surcharge)"));
              Rec.FIELDNO("Percentage (GeneralCost)"):
                FIELDERROR("Percentage (GeneralCost)", STRSUBSTNO(Text011, FIELDCAPTION("Part (Surcharge)"), "Part (Surcharge)"));
              Rec.FIELDNO("Percentage (Profit/Risk)"):
                FIELDERROR("Percentage (Profit/Risk)", STRSUBSTNO(Text011, FIELDCAPTION("Part (Surcharge)"), "Part (Surcharge)"));
              Rec.FIELDNO("Percentage (ExecutionCost)"):
                FIELDERROR("Percentage (ExecutionCost)", STRSUBSTNO(Text011, FIELDCAPTION("Part (Surcharge)"), "Part (Surcharge)"));
            END;
          END;
        UNTIL SubEstimate.NEXT = 0;
      END;
    END;

    PROCEDURE DisplayMap@8();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FIND('-') THEN
        MapMgt.MakeSelection(DATABASE::Estimate,GETPOSITION)
      ELSE
        MESSAGE(Text003);
    END;

    PROCEDURE CheckSummaryPresent@1100525013();
    VAR
      SumRec@1100525000 : Record 11012172;
      CopyFrm@1100525001 : Page 11012239;
      lvText000@1100525002 : TextConst 'ENU=Generate Summary by Sub-Estimate;NOR=Generer sammendrag etter Delkalkyle;SVE=Generera sammandrag efter delkalkyl';
      SubEstRecNEW@1100525004 : Record 11072074;
      NumSubEst@1100525005 : Integer;
      SplitSummary@1100525008 : ' ,yes,no';
    BEGIN
      //C031337: review check copy/split
      SumRec."Estimate No." := "No.";
      SumRec.SETRANGE("Estimate No.", "No.");
      IF NOT SumRec.FINDFIRST THEN BEGIN
        SubEstRecNEW.SETRANGE("Estimate No.", "No.");
        NumSubEst := SubEstRecNEW.COUNT;
        IF NumSubEst < 2 THEN
          SplitSummary := SplitSummary::no;
        //check cost
        IF ("Summary Source (Cost)" <> '') THEN BEGIN
          CopyFrm.FillDefaultsSource("Estimate Source", '', "Summary Source (Cost)", "No.", "Summary Source (Cost)");
          CopyFrm.CopySummary;
          IF SplitSummary = SplitSummary::" " THEN BEGIN
            IF CONFIRM(lvText000,TRUE) THEN
              SplitSummary := SplitSummary::yes
            ELSE
              SplitSummary := SplitSummary::no;
          END;
          IF SplitSummary = SplitSummary::yes THEN
            CopyFrm.GenerateSummary;
        END;
        //check sales
        IF ("Summary Source (Sales)" <> '') THEN BEGIN
          CopyFrm.FillDefaultsSource("Estimate Source", '', "Summary Source (Sales)", "No.", "Summary Source (Sales)");
          CopyFrm.CopySummary;
          IF SplitSummary = SplitSummary::" " THEN BEGIN
            IF CONFIRM(lvText000,TRUE) THEN
              SplitSummary := SplitSummary::yes
            ELSE
              SplitSummary := SplitSummary::no;
          END;
          IF SplitSummary = SplitSummary::yes THEN
            CopyFrm.GenerateSummary;
        END;
      END;
      COMMIT;
      PAGE.RUNMODAL(PAGE::"Summary Sheet List (Restr.)", SumRec, SumRec.Summary);
    END;

    PROCEDURE ShowTargetAmount@1100525018();
    VAR
      TargetAmtRec@1100525001 : Record 11012199;
      TargetAmtFrm@1100525000 : Page 11012243;
    BEGIN
      //db, 24-08-10
      IF ("No." = '') THEN
        EXIT;

      TargetAmtFrm.InitSelections("No.");
      TargetAmtRec.FILTERGROUP(6);
      TargetAmtRec.SETRANGE("Estimate No.", "No.");
      TargetAmtRec.FILTERGROUP(0);
      TargetAmtFrm.SETTABLEVIEW(TargetAmtRec);
      TargetAmtFrm.RUNMODAL;
    END;

    PROCEDURE DPA_SetDefaultDpmtFromNoSeries@1100000995(xRecRef@1100525002 : RecordRef);
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      xRecRef.SETTABLE(xRec);
      DPA_Management.SetDepartmentCodeNoSeries(
        TABLENAME,
        "Global Dimension 1 Code",
        "No. Series",
        xRec."No. Series" );
    END;

    LOCAL PROCEDURE DPA_OnInsert@1100000991();
    VAR
      Dimension1Code@1100528400 : Code[20];
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      Dimension1Code :=
        DPA_Management.GetNoSeriesDepartmentCode(
          "No. Series",
          xRec."No. Series",
          DATABASE::Estimate);
      IF Dimension1Code <> '' THEN
        "Global Dimension 1 Code" := Dimension1Code;

      IF "Global Dimension 1 Code" <> '' THEN
        VALIDATE("Global Dimension 1 Code");
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::Estimate, "Global Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Global Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Global Dimension 1 Code");
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(11012151) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 11012151');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION)
    END;

    PROCEDURE DPA_CanFindRecWithDPAFltrAppld@1210190002() : Boolean;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT(FIND);

      IF NOT DPA_Management.HasTableHardFilter(11012151) THEN
        EXIT(FIND);

      DPA_SetFilters('Table 11012151');
        EXIT(FIND);
    END;

    PROCEDURE EditDocuments@1100528702(ContactNo@1210190003 : Code[20];ContactPersonNo@1210190004 : Code[20];SendMail@1210190002 : Boolean;Recipient@1100528700 : Text[120]);
    VAR
      DocumentTemplate@1210190001 : Record 11012401;
      DocumentMailing@1210190000 : Codeunit 11012278;
      RecRef@1100525000 : RecordRef;
      DocumentLinkRIDs@1100525001 : ARRAY [5] OF RecordID;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentLinkRIDs[1] := RecRef.RECORDID;

      DocumentMailing.EditDocuments(
        STRSUBSTNO('%1', DocumentTemplate.Type::Estimate), DocumentLinkRIDs,
        "Global Dimension 1 Code", ContactNo, ContactPersonNo, SendMail, Recipient);
    END;

    PROCEDURE GetTryOut@1210190000(iAction@1210190000 : Integer) Result : Text[30];
    VAR
      TryOutRelationRec@1210190001 : Record 11012761;
    BEGIN
      //db, 05-05-11
      IF "No." = '' THEN EXIT('');  //C026176

      IF FPSLicenseManagement.LicenseAndReadPermissionForTable(TryOutRelationRec) THEN
        Result := TryOutRelationRec.GetTryOut('', "No.", '', '', '', '', '', '', iAction);

      EXIT(Result);
    END;

    PROCEDURE ShowTryOut@1210190001(iAction@1210190000 : Integer) Result : Text[30];
    VAR
      TryOutRelationRec@1210190001 : Record 11012761;
    BEGIN
      //db, 05-05-11
      Result := TryOutRelationRec.ShowTryOut('', "No.", '', '', '', '', '', '', iAction);
      EXIT(Result);  //db, 22-01-15: C020309
    END;

    PROCEDURE UpdateProjPlanActCode@1210190022();
    VAR
      SubEstRecNew@1100525000 : Record 11072074;
    BEGIN
      SubEstRecNew.SETRANGE("Estimate No.", "No.");
      SubEstRecNew.SETFILTER("Project Planning Activity Code", '%1|%2', '', xRec."Project Planning Activity Code");
      IF SubEstRecNew.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          SubEstRecNew.VALIDATE("Project Planning Activity Code", "Project Planning Activity Code");
          SubEstRecNew.MODIFY;
        UNTIL SubEstRecNew.NEXT = 0;
      END;
    END;

    PROCEDURE UpdateExtensionContract@1100525019();
    VAR
      SubEstRecNew@1100525000 : Record 11072074;
    BEGIN
      //DP00260
      SubEstRecNew.SETRANGE("Estimate No.", "No.");
      SubEstRecNew.SETFILTER("Extension Contract", '%1|%2', '', xRec."Extension Contract");
      IF SubEstRecNew.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF SubEstRecNew."Project No." <> '' THEN
            SubEstRecNew.VALIDATE("Extension Contract", "Extension Contract");
          SubEstRecNew.MODIFY;
        UNTIL SubEstRecNew.NEXT = 0;
      END;
    END;

    PROCEDURE LookupRateCode@1210190006();
    VAR
      EstRateRec@1210190000 : Record 11012160;
      EstimateRateList@1100528800 : Page 11012168;
    BEGIN
      // 33429.so
      //db, 07-02-12: M32465
      //EstRateRec.SETRANGE("Estimate No.", "No.");
      //PAGE.RUNMODAL(0, EstRateRec);
      // 33429.eo

      // 33429.sn
      EstRateRec.SETRANGE("Estimate No.", "No.");
      EstimateRateList.SETTABLEVIEW(EstRateRec);
      IF EstRateRec.GET("No.", "Rate Code") THEN
        EstimateRateList.SETRECORD(EstRateRec);
      EstimateRateList.LOOKUPMODE(TRUE);
      IF EstimateRateList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        GET("No.");
        EstimateRateList.GETRECORD(EstRateRec);
        VALIDATE("Rate Code", EstRateRec."Rate Code");
      END ELSE
        GET("No.");
      // 33429.en
    END;

    PROCEDURE GetRateByRateGroup@1100525029();
    VAR
      EstRateRec@1100525003 : Record 11012160;
      RateGroupRec@1100525002 : Record 11012162;
      DateRateRec@1100525001 : Record 11012188;
      DateRateRec2@1100525000 : Record 11012188;
      TmpEstimateRate@1100528900 : TEMPORARY Record 11012160;
      EstimateLine@1100528901 : Record 11072072;
    BEGIN
      //C025953
      //DP01931: first update RateByDate, then copy RateGroup; afterwards update actual Rate and remove unused Rate Codes
      DateRateRec.RESET;
      DateRateRec.SETRANGE("Record Type", DateRateRec."Record Type"::Estimate);
      DateRateRec.SETRANGE("Estimate No.", "No.");
      DateRateRec.DELETEALL;
      //
      DateRateRec.RESET;
      DateRateRec.SETRANGE("Record Type", DateRateRec."Record Type"::Standard);
      DateRateRec.SETRANGE("Rate Group", "Rate Group");
      IF DateRateRec.FIND('-') THEN BEGIN
        REPEAT
          DateRateRec2.COPY(DateRateRec);
          DateRateRec2."Record Type" := DateRateRec."Record Type"::Estimate;
          DateRateRec2."Estimate No." := "No.";
          DateRateRec2."Rate Group" := '';
          IF DateRateRec2.INSERT THEN;
        UNTIL DateRateRec.NEXT = 0;
      END;
      //
      //DP01931.sn
      EstRateRec.SETRANGE("Estimate No.", "No.");
      IF EstRateRec.FINDSET THEN BEGIN
        REPEAT
          TmpEstimateRate := EstRateRec;
          TmpEstimateRate.INSERT;
        UNTIL EstRateRec.NEXT = 0;
      END;
      //DP01931.en
      //
      RateGroupRec.SETRANGE("Rate Group", "Rate Group");
      IF RateGroupRec.FINDSET THEN BEGIN
        REPEAT
          IF EstRateRec.GET("No.", RateGroupRec."Rate Code") THEN BEGIN
            EstRateRec.Description := RateGroupRec.Description;
            EstRateRec."Cost Rate" := RateGroupRec."Cost Rate";
            EstRateRec."Sales Rate" := RateGroupRec."Sales Rate";
            EstRateRec."Rate Type" := RateGroupRec."Rate Type";
            EstRateRec."Team Size" := RateGroupRec."Team Size";
            EstRateRec."Cost Object" := RateGroupRec."Cost Object";
            EstRateRec.MODIFY;
          END ELSE BEGIN
            EstRateRec."Estimate No." := "No.";
            EstRateRec."Rate Code" := RateGroupRec."Rate Code";
            EstRateRec.Description := RateGroupRec.Description;
            EstRateRec."Cost Rate" := RateGroupRec."Cost Rate";
            EstRateRec."Sales Rate" := RateGroupRec."Sales Rate";
            EstRateRec."Rate Type" := RateGroupRec."Rate Type";
            EstRateRec."Team Size" := RateGroupRec."Team Size";
            EstRateRec."Cost Object" := RateGroupRec."Cost Object";
            EstRateRec.INSERT;
          END;
          //DP01931.sn
          DateRateRec.RESET;
          DateRateRec.SETRANGE("Record Type", DateRateRec."Record Type"::Estimate);
          DateRateRec.SETRANGE("Estimate No.", "No.");  //C050858
          DateRateRec.SETRANGE("Rate Code", RateGroupRec."Rate Code");
          DateRateRec.SETRANGE("Starting Date", 0D, "Reference Date (Rate)");
          IF DateRateRec.FINDLAST THEN BEGIN
            EstRateRec."Cost Rate" := DateRateRec."Cost Rate";
            EstRateRec."Sales Rate" := DateRateRec."Sales Rate";
            EstRateRec.MODIFY;
          END;
          IF TmpEstimateRate.GET(EstRateRec."Estimate No.", EstRateRec."Rate Code") THEN
            TmpEstimateRate.DELETE;
          //DP01931.en
        UNTIL RateGroupRec.NEXT = 0;
      END;
      //
      //DP01931.sn
      TmpEstimateRate.SETRANGE("Estimate No.", "No.");
      IF TmpEstimateRate.FINDSET THEN BEGIN
        REPEAT
          EstimateLine.SETRANGE("Estimate No.", TmpEstimateRate."Estimate No.");
          EstimateLine.SETRANGE("Rate Code", TmpEstimateRate."Rate Code");
          IF EstimateLine.ISEMPTY THEN BEGIN
            EstRateRec.GET(TmpEstimateRate."Estimate No.", TmpEstimateRate."Rate Code");
            EstRateRec.DELETE;
          END;
        UNTIL TmpEstimateRate.NEXT = 0;
        TmpEstimateRate.DELETEALL;
      END;
      //DP01931.en
    END;

    PROCEDURE GetCostRate@1100528901();
    VAR
      RefDate@1100525000 : Date;
      BudgetRateRec@1100525002 : Record 11012000;
      DepartmentBudgetRateRec@1100525001 : Record 11071895;
    BEGIN
      //DP00381
      EstSetup.GET;
      IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN EXIT;  //db, 02-06-14: C012973

      RefDate := "Reference Date (Rate)";
      IF RefDate = 0D THEN
        RefDate := TODAY;

      BudgetRateRec.SETRANGE("Apply as Estimate Rate", TRUE);  //db, 13-12-13
      BudgetRateRec.SETRANGE("Starting Date", 0D, RefDate);
      BudgetRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, RefDate);
      IF BudgetRateRec.FINDSET THEN BEGIN
        REPEAT
          IF NOT EstRateRec.GET("No.", BudgetRateRec.Code) THEN BEGIN
            EstRateRec.INIT;
            EstRateRec."Estimate No." := "No.";
            EstRateRec."Rate Code" := BudgetRateRec.Code;
            EstRateRec.Description := BudgetRateRec.Description;
            EstRateRec.INSERT;
          END;
          //db.sn, 13-12-13
          EstRateRec.VALIDATE("Cost Rate", BudgetRateRec."Estimate Rate");
          EstRateRec."Rate Type" := BudgetRateRec."Rate Type";
          EstRateRec."Team Size" := BudgetRateRec."Team Size";
          EstRateRec."Cost Object" := BudgetRateRec."Cost Object";
          EstRateRec.MODIFY;
          //db.en, 13-12-13
        UNTIL BudgetRateRec.NEXT = 0;
      END;

      DepartmentBudgetRateRec.SETRANGE("Department Code", "Global Dimension 1 Code");
      DepartmentBudgetRateRec.SETRANGE("Starting Date", 0D, RefDate);
      DepartmentBudgetRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, RefDate);
      IF DepartmentBudgetRateRec.FINDSET THEN BEGIN
        REPEAT
          //IF NOT EstRateRec.GET("No.", DepartmentBudgetRateRec."Rate Code") THEN BEGIN
          //  EstRateRec.INIT;
          //  EstRateRec."Estimate No." := "No.";
          //  EstRateRec."Rate Code" := DepartmentBudgetRateRec."Rate Code";
          //  EstRateRec.Description := DepartmentBudgetRateRec.Description;
          //  EstRateRec.INSERT;
          //END;
          //db.sn, 13-12-13
          IF EstRateRec.GET("No.", DepartmentBudgetRateRec."Rate Code") THEN BEGIN  //db, 21-02-14: C012274
            EstRateRec.VALIDATE("Cost Rate", DepartmentBudgetRateRec."Estimate Rate");
            EstRateRec."Rate Type" := DepartmentBudgetRateRec."Rate Type";
            EstRateRec."Team Size" := DepartmentBudgetRateRec."Team Size";
            EstRateRec."Cost Object" := DepartmentBudgetRateRec."Cost Object";
            EstRateRec.MODIFY;
          END;
          //db.en, 13-12-13
        UNTIL DepartmentBudgetRateRec.NEXT = 0;
      END;
    END;

    PROCEDURE GetSalesRate@1100528900();
    VAR
      HourRateRec@1100528901 : Record 11012022;
      CustHourRateRec@1100528900 : Record 11012023;
      DepartmentHourRateRec@1100525001 : Record 11071896;
      DepartmentCustHourRateRec@1100525002 : Record 11071897;
      ServiceContractHourRate@1100525003 : Record 11012815;
      ProjectPrincipalHourRate@1100528500 : Record 11012024;
      RefDate@1100525000 : Date;
      GLSetup@1100525004 : Record 98;
      SalesRate@1100525005 : Decimal;
    BEGIN
      //DP00381
      EstSetup.GET;
      IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN EXIT;  //db, 02-06-14: C012973

      RefDate := "Reference Date (Rate)";
      IF RefDate = 0D THEN
        RefDate := TODAY;

      HourRateRec.SETRANGE("Starting Date", 0D, RefDate);
      HourRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, RefDate);
      IF HourRateRec.FINDSET THEN BEGIN
        REPEAT
          IF EstRateRec.GET("No.", HourRateRec.Code) THEN BEGIN  //db, 21-02-14: C012274
            IF EstRateRec."Rate Type" = EstRateRec."Rate Type"::Minuts THEN BEGIN  //C036195
              GLSetup.GET;
              SalesRate := ROUND((HourRateRec."Hour Rate"/60), GLSetup."Amount Rounding Precision");
              EstRateRec.VALIDATE("Sales Rate", SalesRate);
            END ELSE BEGIN
              EstRateRec.VALIDATE("Sales Rate", HourRateRec."Hour Rate");
            END;
            EstRateRec.MODIFY;
          END;
        UNTIL HourRateRec.NEXT = 0;
      END;

      DepartmentHourRateRec.SETRANGE("Department Code", "Global Dimension 1 Code");
      DepartmentHourRateRec.SETRANGE("Starting Date", 0D, RefDate);
      DepartmentHourRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, RefDate);
      IF DepartmentHourRateRec.FINDSET THEN BEGIN
        REPEAT
          IF EstRateRec.GET("No.", DepartmentHourRateRec."Hour Rate Code") THEN BEGIN  //db, 21-02-14: C012274
            IF EstRateRec."Rate Type" = EstRateRec."Rate Type"::Minuts THEN BEGIN  //C036195
              GLSetup.GET;
              SalesRate := ROUND((DepartmentHourRateRec."Hour Rate"/60), GLSetup."Amount Rounding Precision");
              EstRateRec.VALIDATE("Sales Rate", SalesRate);
            END ELSE BEGIN
              EstRateRec.VALIDATE("Sales Rate", DepartmentHourRateRec."Hour Rate");
            END;
            EstRateRec.MODIFY;
          END;
        UNTIL DepartmentHourRateRec.NEXT = 0;
      END;

      CustHourRateRec.SETRANGE("Customer No.", "Customer No.");
      CustHourRateRec.SETRANGE("Starting Date", 0D, RefDate);
      CustHourRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, RefDate);
      IF CustHourRateRec.FINDSET THEN BEGIN
        REPEAT
          IF EstRateRec.GET("No.", CustHourRateRec."Hour Rate Code") THEN BEGIN  //db, 21-02-14: C012274
            IF EstRateRec."Rate Type" = EstRateRec."Rate Type"::Minuts THEN BEGIN  //C036195
              GLSetup.GET;
              SalesRate := ROUND((CustHourRateRec."Hour Rate"/60), GLSetup."Amount Rounding Precision");
              EstRateRec.VALIDATE("Sales Rate", SalesRate);
            END ELSE BEGIN
              EstRateRec.VALIDATE("Sales Rate", CustHourRateRec."Hour Rate");
            END;
            EstRateRec.MODIFY;
          END;
        UNTIL CustHourRateRec.NEXT = 0;
      END;

      DepartmentCustHourRateRec.SETRANGE("Department Code", "Global Dimension 1 Code");
      DepartmentCustHourRateRec.SETRANGE("Customer No.", "Customer No.");
      DepartmentCustHourRateRec.SETRANGE("Starting Date", 0D, RefDate);
      DepartmentCustHourRateRec.SETFILTER("Ending Date",'%1|>=%2',0D, RefDate);
      IF DepartmentCustHourRateRec.FINDSET THEN BEGIN
        REPEAT
          IF EstRateRec.GET("No.", DepartmentCustHourRateRec."Hour Rate Code") THEN BEGIN  //db, 21-02-14: C012274
            IF EstRateRec."Rate Type" = EstRateRec."Rate Type"::Minuts THEN BEGIN  //C036195
              GLSetup.GET;
              SalesRate := ROUND((DepartmentCustHourRateRec."Hour Rate"/60), GLSetup."Amount Rounding Precision");
              EstRateRec.VALIDATE("Sales Rate", SalesRate);
            END ELSE BEGIN
              EstRateRec.VALIDATE("Sales Rate", DepartmentCustHourRateRec."Hour Rate");
            END;
            EstRateRec.MODIFY;
          END;
        UNTIL DepartmentCustHourRateRec.NEXT = 0;
      END;

      //C041796.sn
      ProjectPrincipalHourRate.SETRANGE("Project No.", "Project No.");
      ProjectPrincipalHourRate.SETRANGE(Principal, "Customer No.");
      ProjectPrincipalHourRate.SETRANGE("Starting Date", 0D, RefDate);
      ProjectPrincipalHourRate.SETFILTER("Ending Date",'%1|>=%2',0D, RefDate);
      IF ProjectPrincipalHourRate.FINDSET THEN BEGIN
        REPEAT
          IF EstRateRec.GET("No.", ProjectPrincipalHourRate."Hour Rate Code") THEN BEGIN
            IF EstRateRec."Rate Type" = EstRateRec."Rate Type"::Minuts THEN BEGIN
              GLSetup.GET;
              SalesRate := ROUND((ProjectPrincipalHourRate."Hour Rate"/60), GLSetup."Amount Rounding Precision");
              EstRateRec.VALIDATE("Sales Rate", SalesRate);
            END ELSE BEGIN
              EstRateRec.VALIDATE("Sales Rate", ProjectPrincipalHourRate."Hour Rate");
            END;
            EstRateRec.MODIFY;
          END;
        UNTIL ProjectPrincipalHourRate.NEXT = 0;
      END;
      //C041796.en

      //C011627.sn
      ServiceContractHourRate.SETRANGE("Service Contract No.", "Service Contract No.");
      ServiceContractHourRate.SETRANGE("Starting Date", 0D, RefDate);
      ServiceContractHourRate.SETFILTER("Ending Date",'%1|>=%2',0D, RefDate);
      IF ServiceContractHourRate.FINDSET THEN BEGIN
        REPEAT
          IF EstRateRec.GET("No.", ServiceContractHourRate."Hour Rate Code") THEN BEGIN  //db, 21-02-14: C012274
            IF EstRateRec."Rate Type" = EstRateRec."Rate Type"::Minuts THEN BEGIN  //C036195
              GLSetup.GET;
              SalesRate := ROUND((ServiceContractHourRate."Hour Rate"/60), GLSetup."Amount Rounding Precision");
              EstRateRec.VALIDATE("Sales Rate", SalesRate);
            END ELSE BEGIN
              EstRateRec.VALIDATE("Sales Rate", ServiceContractHourRate."Hour Rate");
            END;
            EstRateRec.MODIFY;
          END;
        UNTIL ServiceContractHourRate.NEXT = 0;
      END;
      //C011627.en
    END;

    PROCEDURE UpdateSurcharge@1100528902(CostType@1100485000 : Integer);
    VAR
      SubEstRec@1100485001 : Record 11072074;
    BEGIN
      //DP00381
      IF "RAW Estimate" THEN EXIT;

      SubEstRec.SETRANGE("Estimate No.", "No.");
      IF CostType = 0 THEN
        SubEstRec.SETFILTER("Surcharge % Labor", '%1|%2', 0, xRec."Surcharge % Labor");
      IF CostType = 1 THEN
        SubEstRec.SETFILTER("Surcharge % Material", '%1|%2', 0, xRec."Surcharge % Material");
      IF CostType = 2 THEN
        SubEstRec.SETFILTER("Surcharge % Subcontracting", '%1|%2', 0, xRec."Surcharge % Subcontracting");
      IF CostType = 3 THEN
        SubEstRec.SETFILTER("Surcharge % Plant", '%1|%2', 0, xRec."Surcharge % Plant");
      IF CostType = 4 THEN
        SubEstRec.SETFILTER("Surcharge % Sundry", '%1|%2', 0, xRec."Surcharge % Sundry");
      IF SubEstRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF CostType = 0 THEN
            SubEstRec.VALIDATE("Surcharge % Labor", "Surcharge % Labor");
          IF CostType = 1 THEN
            SubEstRec.VALIDATE("Surcharge % Material", "Surcharge % Material");
          IF CostType = 2 THEN
            SubEstRec.VALIDATE("Surcharge % Subcontracting", "Surcharge % Subcontracting");
          IF CostType = 3 THEN
            SubEstRec.VALIDATE("Surcharge % Plant", "Surcharge % Plant");
          IF CostType = 4 THEN
            SubEstRec.VALIDATE("Surcharge % Sundry", "Surcharge % Sundry");
          SubEstRec.MODIFY;
        UNTIL SubEstRec.NEXT = 0;
      END;
    END;

    PROCEDURE UpdateResponsibility@1100525002(IFieldNo@1100525000 : Integer;IOldEmplNo@1100525001 : Code[20];INewEmplNo@1100525002 : Code[20]);
    VAR
      lvEstRespPersRec@1100525004 : Record 11012159;
      lvEstRespPersRec2@1100525006 : Record 11012159;
      lvRespCode@1100525003 : Code[10];
      JobSetup@1100525005 : Record 315;
    BEGIN
      //db, 12-09-13: C007282
      IF INewEmplNo = IOldEmplNo THEN
        EXIT;

      JobSetup.GET;
      CASE IFieldNo OF
        FIELDNO(Estimator):
          lvRespCode := JobSetup."Responsibility Estimator";
      END;

      IF lvRespCode = '' THEN
        EXIT;

      //db.sn, 08-05-14: C015005
      lvEstRespPersRec.SETRANGE("Estimate No.", "No.");
      lvEstRespPersRec.SETRANGE(Responsibility, lvRespCode);
      lvEstRespPersRec.SETFILTER("Employee No.", '%1|%2', INewEmplNo, IOldEmplNo);
      lvEstRespPersRec.DELETEALL(FALSE);

      IF INewEmplNo <> '' THEN BEGIN
        lvEstRespPersRec2.INIT;
        lvEstRespPersRec2."Estimate No." := "No.";
        lvEstRespPersRec2.Responsibility := lvRespCode;
        lvEstRespPersRec2."Employee No." := INewEmplNo;
        lvEstRespPersRec2.INSERT;
      END;
      //db.en, 08-05-14: C015005
    END;

    PROCEDURE LookupRecipeGroup@1100525020();
    VAR
      RecipeGroupRec@1100525000 : Record 11020580;
    BEGIN
      //db, 07-02-14: C013041
      IF PAGE.RUNMODAL(0, RecipeGroupRec) = ACTION::LookupOK THEN
        "Recipe Group":= RecipeGroupRec."No.";
    END;

    PROCEDURE ValidateRecipeGroup@1100525022();
    VAR
      RecipeGroupRec@1100525000 : Record 11020580;
    BEGIN
      //db, 07-02-14: C013041
      IF "Recipe Group" = '' THEN EXIT;
      RecipeGroupRec.GET("Recipe Group");
    END;

    PROCEDURE InheritFromRawSetup@1100525032();
    VAR
      EstimateRAWSurcharges@1100525001 : Record 11012236;
      EstimateRAWSurcharges2@1100525000 : Record 11012236;
    BEGIN
      //C035780
      IF "RAW Estimate" THEN BEGIN
        CompInfoRec.GET;
        "Contractor Name" := CompInfoRec.Name;
        "Contractor Address" := CompInfoRec.Address;
        "Contractor City" := CompInfoRec.City;
        GWWSetup.GET;
        "VAT Prod. Posting Group (H)" := GWWSetup."VAT Prod. Posting Group (H)";
        "VAT Prod. Posting Group (L)" := GWWSetup."VAT Prod. Posting Group (L)";
        "VAT Prod. Posting Group (Z)" := GWWSetup."VAT Prod. Posting Group (Z)";
        EstimateRAWSetup.GET;
        IF "No." = '' THEN BEGIN
          EstimateRAWSetup.TESTFIELD("Estimate Nos.");
          NoSeriesMgt.InitSeries(EstimateRAWSetup."Estimate Nos.",xRec."No. Series",0D,"No.","No. Series");
        END;
        "Surcharge % Labor" :=  EstimateRAWSetup."Surcharge % Labor";
        "Surcharge % Material" := EstimateRAWSetup."Surcharge % Material";
        "Surcharge % Subcontracting" := EstimateRAWSetup."Surcharge % Subcontracting";
        "Surcharge % Plant" := EstimateRAWSetup."Surcharge % Plant";
        //
        EstimateRAWSurcharges.SETRANGE("Estimate No.", '');
        IF EstimateRAWSurcharges.FINDSET THEN BEGIN
          REPEAT
            EstimateRAWSurcharges2 := EstimateRAWSurcharges;
            EstimateRAWSurcharges2."Estimate No." := "No.";
            IF EstimateRAWSurcharges2."Global Dimension 2 Code" <> '' THEN
              IF EstimateRAWSurcharges2.INSERT THEN;  //db, 02-07-18 (problem with insert from Try-out Quote)
          UNTIL EstimateRAWSurcharges.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE InheritFromEstSetup@1100525035();
    BEGIN
      //C035780
      EstSetup.GET;
      "Part Group" := EstSetup."Part Group";
      "Recipe Group" := EstSetup."Recipe Group";
      "Norm Group" := EstSetup."Norm Group";
      "Norm Group (Sales)" := EstSetup."Norm Group (Sales)";
      "Rate Group" := EstSetup."Rate Group";
      "Rate Code" := EstSetup."Rate Code";
      "Copy Part Lines" := EstSetup."Copy Part Lines";
      "Estimate Based On" := EstSetup."Estimate Based On";
      "Plant Rates in Hours" := EstSetup."Plant Rates in Hours";
      "Kind of Plant Rate" := EstSetup."Kind of Plant Rate";
      "Plant Company" := EstSetup."Plant Company";  //DP01407
      "Item Sales Price Based On":= EstSetup."Item Sales Price Based On";
      "Apply Linked Recipe" := EstSetup."Apply Linked Recipe";  //DP02082
      IF NOT "RAW Estimate" THEN BEGIN
        "Surcharge % Labor" := EstSetup."Surcharge % Labor";
        "Surcharge % Material" := EstSetup."Surcharge % Material";
        "Surcharge % Subcontracting" := EstSetup."Surcharge % Subcontracting";
        "Surcharge % Plant" := EstSetup."Surcharge % Plant";
        "Surcharge % Sundry" := EstSetup."Surcharge % Sundry";
        "Estimate Source" := EstSetup."Estimate Source";
        "Summary Source (Cost)" := EstSetup."Summary Source (Cost)";
        "Summary Source (Sales)" := EstSetup."Summary Source (Sales)";
      END;
      //DP02080.sn
      "Surcharge Method" := EstSetup."Surcharge Method";
      "Part (Surcharge)" := EstSetup."Part (Surcharge)";
      "Percentage (GeneralCost)" := EstSetup."Percentage (GeneralCost)";
      "Percentage (Profit/Risk)" := EstSetup."Percentage (Profit/Risk)";
      "Percentage (ExecutionCost)" := EstSetup."Percentage (ExecutionCost)";
      //DP02080.en

      ProjSetup.GET;
      "Apply SurchMat PriceZero Only" := ProjSetup."Apply SurchMat PriceZero Only";
      "Apply SalesPrice for SurchMat" := ProjSetup."Apply SalesPrice for SurchMat";
      "Subcontracting in Hours" := ProjSetup."Subcontracting in Hours";  //C053751
    END;

    PROCEDURE InheritFromEstSource@1100525033(EstFrom@1100525001 : Code[20];OverruleDefaultSetup@1100525002 : Boolean);
    VAR
      OrigEstRec@1100525000 : Record 11012151;
    BEGIN
      //C035780
      //function called by report 11012758 (Select Try-Out Successor)
      IF NOT OrigEstRec.GET(EstFrom) THEN EXIT;

      IF OverruleDefaultSetup THEN BEGIN  //C037344: db, 11-05-17
        "Part Group" := OrigEstRec."Part Group";
        "Recipe Group" := OrigEstRec."Recipe Group";
        "Norm Group" := OrigEstRec."Norm Group";
        "Norm Group (Sales)" := OrigEstRec."Norm Group (Sales)";
        "Rate Group" := OrigEstRec."Rate Group";
        "Rate Code" := OrigEstRec."Rate Code";
        "Copy Part Lines" := OrigEstRec."Copy Part Lines";
        "Estimate Based On" := OrigEstRec."Estimate Based On";
        "Plant Rates in Hours" := OrigEstRec."Plant Rates in Hours";
        "Kind of Plant Rate" := OrigEstRec."Kind of Plant Rate";
        "Item Sales Price Based On" := OrigEstRec."Item Sales Price Based On";
        "Apply Linked Recipe" := OrigEstRec."Apply Linked Recipe";  //DP02082
        IF NOT "RAW Estimate" THEN BEGIN
          "Surcharge % Labor" := OrigEstRec."Surcharge % Labor";
          "Surcharge % Material" := OrigEstRec."Surcharge % Material";
          "Surcharge % Subcontracting" := OrigEstRec."Surcharge % Subcontracting";
          "Surcharge % Plant" := OrigEstRec."Surcharge % Plant";
          "Surcharge % Sundry" := OrigEstRec."Surcharge % Sundry";
        END;
        "Apply SurchMat PriceZero Only" := OrigEstRec."Apply SurchMat PriceZero Only";
        "Apply SalesPrice for SurchMat" := OrigEstRec."Apply SalesPrice for SurchMat";
      END;

      "Reference Date (Item)" := OrigEstRec."Reference Date (Item)";
      "Customer Disc. Group" := OrigEstRec."Customer Disc. Group";
      "Purch Discount Term Group 1" := OrigEstRec."Purch Discount Term Group 1";
      "Purch Discount Term Group 2" := OrigEstRec."Purch Discount Term Group 2";
      "Sales Discount Term Group 1" := OrigEstRec."Sales Discount Term Group 1";
      "Sales Discount Term Group 2" := OrigEstRec."Sales Discount Term Group 2";
      "Priority Purch Disc Term Grp 0" := OrigEstRec."Priority Purch Disc Term Grp 0";
      "Priority Purch Disc Term Grp 1" := OrigEstRec."Priority Purch Disc Term Grp 1";
      "Priority Purch Disc Term Grp 2" := OrigEstRec."Priority Purch Disc Term Grp 2";
      "Priority Sales Disc Term Grp 0" := OrigEstRec."Priority Sales Disc Term Grp 0";
      "Priority Sales Disc Term Grp 1" := OrigEstRec."Priority Sales Disc Term Grp 1";
      "Priority Sales Disc Term Grp 2" := OrigEstRec."Priority Sales Disc Term Grp 2";
      Element := OrigEstRec.Element;
      "Coding System" := OrigEstRec."Coding System";
      Code := OrigEstRec.Code;
      "Apply Surcharge Recipe" := OrigEstRec."Apply Surcharge Recipe";
      "Offer Price Based On" := OrigEstRec."Offer Price Based On";  //C049497
    END;

    PROCEDURE InheritFromCustomer@1100525036();
    VAR
      SummarySheet@1100528500 : Record 11012172;
      EstimateSource@1100528501 : Text;
    BEGIN
      //C035780
      IF CustRec.GET("Customer No.") THEN BEGIN
        IF "RAW Estimate" THEN BEGIN
          CustRec.TESTFIELD("VAT Bus. Posting Group");
          "VAT Bus. Posting Group" := CustRec."VAT Bus. Posting Group";
        END;
        "Item Sales Price Based On" := CustRec."Item Price Estimate";
        "Customer Disc. Group" := CustRec."Customer Disc. Group";
        IF CustRec."Rate Group" <> '' THEN
          "Rate Group" := CustRec."Rate Group";  //C055597
        //C050838.sn
        EstimateSource := CustRec."Estimate Source";
        IF EstimateSource = '' THEN BEGIN
          EstSetup.GET;
          EstimateSource := EstSetup."Estimate Source";
        END;
        IF SummarySheet.GET(EstimateSource, CustRec."Summary (Cost)") THEN BEGIN
          "Estimate Source" := SummarySheet."Estimate No.";
          "Summary Source (Cost)" := SummarySheet.Summary;
        END;
        IF SummarySheet.GET(EstimateSource, CustRec."Summary (Sales)") THEN BEGIN
          "Estimate Source" := SummarySheet."Estimate No.";
          "Summary Source (Sales)" := SummarySheet.Summary;
        END;
        //C050838.en
        IF CustRec."Reference Date (Item)" <> 0D THEN
          "Reference Date (Item)" := CustRec."Reference Date (Item)";
      END ELSE BEGIN
        EstSetup.GET;
        "Estimate Source" := EstSetup."Estimate Source";
        "Summary Source (Cost)" := EstSetup."Summary Source (Cost)";
        "Summary Source (Sales)" := EstSetup."Summary Source (Sales)";
      END;
    END;

    PROCEDURE OpenCard@1100526100();
    BEGIN
      //db, 06-03-15: C019947
      IF "RAW Estimate" THEN BEGIN
        PAGE.RUN(PAGE::"Estimate RAW Card",Rec);
      END ELSE BEGIN
        PAGE.RUN(PAGE::"Estimate Card",Rec);
      END;
    END;

    PROCEDURE SetCurrencySwitchForUpdateLines@1100528906(iCurrencyCode@1100528900 : Code[10];iSwitchCurrency@1100528901 : Boolean);
    BEGIN
      //C054524
      CurrencyCode := iCurrencyCode;
      SwitchCurrency := iSwitchCurrency;
    END;

    PROCEDURE UpdateBudgetRate@1100525025();
    VAR
      EstimateRate@1100525000 : Record 11012160;
    BEGIN
      //DP00883
      EstimateRate.SETRANGE("Estimate No.", "No.");
      IF EstimateRate.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          EstimateRate.VALIDATE("Currency Code", "Currency Code");
          EstimateRate.MODIFY;
        UNTIL EstimateRate.NEXT = 0;
      END;

      UpdateBudgetLineCurrencyData("No.", '');
    END;

    PROCEDURE UpdateBudgetLineCurrencyData@1100525026(iEstimate@1100525001 : Code[20];iRateCode@1100525002 : Code[10]);
    VAR
      EstimateLine@1100525000 : Record 11072072;
      RecipeLine@1100525003 : Record 11072075;
    BEGIN
      //DP00883
      EstimateLine.SETFILTER("Estimate No.", iEstimate);
      EstimateLine.SETFILTER("Rate Code", iRateCode);
      IF SwitchCurrency THEN
        EstimateLine.SETFILTER("Currency Code", '%1|%2', '', CurrencyCode);  //C054524
      EstimateLine.SETFILTER(Recipe, '%1', '');
      IF EstimateLine.FINDSET THEN BEGIN
        REPEAT
          IF EstimateLine."Currency Agreement" THEN BEGIN  //C054524
            EstimateLine."Cost Rate" := EstimateLine.ExchangeAmtFCYToLCY(EstimateLine."Cost Rate (FCY)", FALSE, TRUE, FALSE);
            EstimateLine."Sales Rate" := EstimateLine.ExchangeAmtFCYToLCY(EstimateLine."Sales Rate (FCY)", FALSE, TRUE, FALSE);
            EstimateLine."Gross Price" := EstimateLine.ExchangeAmtFCYToLCY(EstimateLine."Gross Price (FCY)", FALSE, TRUE, FALSE);
            EstimateLine."Net Cost Price" := EstimateLine.ExchangeAmtFCYToLCY(EstimateLine."Net Cost Price (FCY)", FALSE, TRUE, FALSE);
            EstimateLine."Net Sales Price" := EstimateLine.ExchangeAmtFCYToLCY(EstimateLine."Net Sales Price (FCY)", FALSE, TRUE, FALSE);
          END ELSE BEGIN
            IF SwitchCurrency THEN
              EstimateLine."Currency Code" := "Currency Code";
            EstimateLine."Cost Rate (FCY)" := EstimateLine.ExchangeAmtLCYToFCY(EstimateLine."Cost Rate", FALSE, TRUE, FALSE);
            EstimateLine."Sales Rate (FCY)" := EstimateLine.ExchangeAmtLCYToFCY(EstimateLine."Sales Rate", FALSE, TRUE, FALSE);
            EstimateLine."Gross Price (FCY)" := EstimateLine.ExchangeAmtLCYToFCY(EstimateLine."Gross Price", FALSE, TRUE, FALSE);
            EstimateLine."Net Cost Price (FCY)" := EstimateLine.ExchangeAmtLCYToFCY(EstimateLine."Net Cost Price", FALSE, TRUE, FALSE);
            EstimateLine."Net Sales Price (FCY)" := EstimateLine.ExchangeAmtLCYToFCY(EstimateLine."Net Sales Price", FALSE, TRUE, FALSE);
          END;
          EstimateLine.CalculateTotals;
          EstimateLine.MODIFY;
        UNTIL EstimateLine.NEXT = 0;
      END;

      RecipeLine.SETFILTER("Estimate No.", iEstimate);
      RecipeLine.SETFILTER("Rate Code", iRateCode);
      IF RecipeLine.FINDSET THEN BEGIN
        REPEAT
          RecipeLine."Currency Code" := "Currency Code";
          RecipeLine."Cost Rate (FCY)" := RecipeLine.ExchangeAmtLCYToFCY(RecipeLine."Cost Rate", FALSE, TRUE, FALSE);
          RecipeLine."Sales Rate (FCY)" := RecipeLine.ExchangeAmtLCYToFCY(RecipeLine."Sales Rate", FALSE, TRUE, FALSE);
          RecipeLine."Gross Price (FCY)" := RecipeLine.ExchangeAmtLCYToFCY(RecipeLine."Gross Price", FALSE, TRUE, FALSE);
          RecipeLine."Net Cost Price (FCY)" := RecipeLine.ExchangeAmtLCYToFCY(RecipeLine."Net Cost Price", FALSE, TRUE, FALSE);
          RecipeLine."Net Sales Price (FCY)" := RecipeLine.ExchangeAmtLCYToFCY(RecipeLine."Net Sales Price", FALSE, TRUE, FALSE);
          RecipeLine.CalculateTotals;
          RecipeLine.MODIFY;
        UNTIL RecipeLine.NEXT = 0;
      END;
    END;

    PROCEDURE StructurePresent@1100525014(CurrEst@1100525002 : Code[20]) : Boolean;
    VAR
      EstPartRec@1100525000 : Record 11072073;
      NumPart@1100525001 : Integer;
    BEGIN
      //DP00909
      EstPartRec.SETRANGE("Estimate No.", CurrEst);
      NumPart := EstPartRec.COUNT;
      EXIT(NumPart>1);
    END;

    PROCEDURE ModelPresent@1100525016(CurrEst@1100525000 : Code[20]) : Boolean;
    VAR
      EstModelRec@1100525001 : Record 11012196;
      NumModel@1100525002 : Integer;
    BEGIN
      //DP00909
      EstModelRec.SETRANGE("Estimate No.", CurrEst);
      NumModel := EstModelRec.COUNT;
      EXIT(NumModel>1);
    END;

    PROCEDURE StartEstimateLines@1100525027();
    VAR
      EstPartRec@1100525001 : Record 11072073;
      EstimateManagementRTC@1100525000 : Codeunit 11130010;
    BEGIN
      //DP00909
      IF StructurePresent("No.") THEN BEGIN
        MESSAGE(Text999);
        ShowIndex("No.",'','','',FALSE);
        EXIT;
      END;

      GenerateSubEstimateWithPartLevelZero;
      EstPartRec.SETRANGE("Estimate No.", "No.");
      EstPartRec.FINDFIRST;
      EstimateManagementRTC.EditViewEstimateLines(EstPartRec."Estimate No.", EstPartRec."Sub-Estimate No.",
        EstPartRec."Part Group", EstPartRec.Part, 0, FALSE);  //C033558
    END;

    PROCEDURE StartRAWEstimate@1100528913();
    VAR
      EstimateParagraphRAW@1100528900 : Record 11125679;
    BEGIN
      //DP01676
      EstimateParagraphRAW.SETRANGE("Estimate No.", "No.");
      PAGE.RUNMODAL(PAGE::"Estimate Paragraphs RAW", EstimateParagraphRAW);
    END;

    PROCEDURE GenerateSubEstimateWithPartLevelZero@1100525024();
    VAR
      SubEstRec@1100525000 : Record 11072074;
      DummyCode@1100525001 : Code[20];
    BEGIN
      //DP00909
      SubEstRec.SETRANGE("Estimate No.", "No.");
      IF NOT SubEstRec.FINDFIRST THEN BEGIN
        DummyCode := '1';
        SubEstRec.INIT;
        SubEstRec."Estimate No." := "No.";
        SubEstRec.VALIDATE("Sub-Estimate No.", DummyCode);
        SubEstRec.Description := SubEstRec.TABLECAPTION + ' ' + DummyCode;
        SubEstRec.InitRecord;  //C053828
        SubEstRec.INSERT(TRUE);
        SubEstRec.SetOptionToCreatePartLevelZero;
        SubEstRec.CheckPartLevelZeroExist;
        COMMIT;
      END;
    END;

    PROCEDURE ShowIndex@1100525028(iEst@1100525000 : Code[20];iSubEst@1100525001 : Code[20];iPartGrp@1100525002 : Code[20];iPart@1100525003 : Code[20];CalledFromLine@1100525005 : Boolean);
    VAR
      EstimatePart@1100485000 : Record 11072073;
      IndexPage@1100525004 : Page 11020468;
    BEGIN
      //DP00909
      EstimatePart.SETRANGE("Estimate No.",iEst);
      EstimatePart."Estimate No." := iEst;
      EstimatePart."Sub-Estimate No." := iSubEst;
      EstimatePart."Part Group" := iPartGrp;
      EstimatePart.Part := iPart;
      IndexPage.SETRECORD(EstimatePart);
      IndexPage.SETTABLEVIEW(EstimatePart);
      IF CalledFromLine THEN BEGIN
        IndexPage.CalledFromLevel(DATABASE::"Estimate Line");
      END ELSE BEGIN
        IF iPart <> '' THEN BEGIN
          IndexPage.CalledFromLevel(DATABASE::"Estimate Part");
        END ELSE BEGIN
          IF iSubEst <> '' THEN BEGIN
            IndexPage.CalledFromLevel(DATABASE::"Sub-Estimate");
          END ELSE BEGIN
            IndexPage.CalledFromLevel(DATABASE::Estimate);
          END;
        END;
      END;
      IndexPage.RUN; //C017535
    END;

    PROCEDURE GetDataCaptionEstimateLevel@1100528001(iEstimate@1100525001 : Code[20];iSubEstimate@1100525002 : Code[20];iPartGroup@1100525003 : Code[20];iPart@1100525004 : Code[20]) : Text[250];
    VAR
      Estimate@1100525000 : Record 11012151;
      SubEstimate@1100525005 : Record 11072074;
      EstimatePart@1100525006 : Record 11072073;
    BEGIN
      //DP00909
      IF NOT Estimate.GET(iEstimate) THEN Estimate.INIT;
      IF iSubEstimate = '' THEN
        EXIT(STRSUBSTNO('%1 - %2', Estimate."No.", Estimate.Description));

      IF NOT SubEstimate.GET(iEstimate, iSubEstimate) THEN SubEstimate.INIT;
      IF iPart = '' THEN
        EXIT(STRSUBSTNO('%1 - %2 - %3 - %4', Estimate."No.", Estimate.Description, SubEstimate."Sub-Estimate No.", SubEstimate.Description));

      IF NOT EstimatePart.GET(iEstimate, iSubEstimate, iPartGroup, iPart) THEN EstimatePart.INIT;
      EXIT(STRSUBSTNO('%1 - %2 - %3 - %4 - %5 - %6', Estimate."No.", Estimate.Description, SubEstimate."Sub-Estimate No.", SubEstimate.Description,
        EstimatePart.Part, EstimatePart.Description));
    END;

    PROCEDURE StartCopyEstimate@1100525030(ActivateCard@1100525003 : Boolean);
    VAR
      CopyEstimate@1100525002 : Page 11012210;
      NewEstimate@1100525001 : Code[20];
      Estimate@1100525000 : Record 11012151;
      CopyEstimateRaw@1100525004 : Page 11125697;
    BEGIN
      //C027531: db, 24-12-15
      IF "RAW Estimate" THEN BEGIN  //C028591 (db, 19-01-16)
        CopyEstimateRaw.FillDefaults("No.");
        CopyEstimateRaw.StdDialogRunModal;
        NewEstimate := CopyEstimateRaw.GetNewEstimate;
      END ELSE BEGIN
        CopyEstimate.FillDefaults("No.");
        CopyEstimate.StdDialogRunModal;
        NewEstimate := CopyEstimate.GetNewEstimate;
      END;
      IF Estimate.GET(NewEstimate) THEN BEGIN
        IF ActivateCard THEN
          Estimate.OpenCard
        ELSE;
          GET(NewEstimate);
      END;
    END;

    PROCEDURE StartCopySubEstimateByModel@1100525031(ActivateCard@1100525003 : Boolean);
    VAR
      CopyPage@1100525002 : Page 11012215;
      NewEstimate@1100525001 : Code[20];
      Estimate@1100525000 : Record 11012151;
    BEGIN
       //C027729: db, 24-12-15
      CopyPage.FillDefaults("No.");
      CopyPage.StdDialogRunModal;
      NewEstimate := CopyPage.GetNewEstimate;
      IF Estimate.GET(NewEstimate) THEN
        GET(NewEstimate);
    END;

    LOCAL PROCEDURE CheckPercentageAllowed@1100529000(FieldNumber@1100529000 : Integer);
    VAR
      EstimateLineRAW@1100529001 : Record 11125698;
    BEGIN
      //C026965
      EstimateRAWSetup.GET;

      EstimateLineRAW.SETRANGE("Estimate No.", "No.");
      EstimateLineRAW.SETRANGE("Summary Line", FALSE);
      CASE FieldNumber OF
        FIELDNO("Percentage (Discount)"):  //DP01488
          BEGIN
            IF "Percentage (Discount)" <> 0 THEN BEGIN
              TESTFIELD("Summary Cost (RAW)", "Summary Cost (RAW)"::Percentage);  //DP01488
              EstimateLineRAW.SETRANGE("Tender Paragraph No.", EstimateRAWSetup."Paragraph No.(Discount)");
              IF NOT EstimateLineRAW.ISEMPTY THEN
                FIELDERROR("Percentage (Discount)",
                  STRSUBSTNO(Text014, EstimateLineRAW.FIELDCAPTION("Tender Paragraph No."), EstimateRAWSetup."Paragraph No.(Discount)"));
            END;
          END;
        FIELDNO("Percentage (GeneralCost)"):
          BEGIN
            IF "Percentage (GeneralCost)" <> 0 THEN BEGIN
              TESTFIELD("Summary Cost (RAW)", "Summary Cost (RAW)"::Percentage);  //DP01488
              EstimateLineRAW.SETRANGE("Tender Paragraph No.", EstimateRAWSetup."Paragraph No.(GeneralCost)");
              IF NOT EstimateLineRAW.ISEMPTY THEN
                FIELDERROR("Percentage (GeneralCost)",
                  STRSUBSTNO(Text014, EstimateLineRAW.FIELDCAPTION("Tender Paragraph No."), EstimateRAWSetup."Paragraph No.(GeneralCost)"));
            END;
          END;
        FIELDNO("Percentage (Profit/Risk)"):
          BEGIN
            IF "Percentage (Profit/Risk)" <> 0 THEN BEGIN
              TESTFIELD("Summary Cost (RAW)", "Summary Cost (RAW)"::Percentage);  //DP01488
              EstimateLineRAW.SETRANGE("Tender Paragraph No.", EstimateRAWSetup."Paragraph No.(Profit/Risk)");
              IF NOT EstimateLineRAW.ISEMPTY THEN
                FIELDERROR("Percentage (Profit/Risk)",
                  STRSUBSTNO(Text014, EstimateLineRAW.FIELDCAPTION("Tender Paragraph No."), EstimateRAWSetup."Paragraph No.(Profit/Risk)"));
            END;
          END;
        FIELDNO("Percentage (ExecutionCost)"):  //DP01486
          BEGIN
            IF "Percentage (ExecutionCost)" <> 0 THEN BEGIN
              TESTFIELD("Summary Cost (RAW)", "Summary Cost (RAW)"::Percentage);  //DP01488
              EstimateLineRAW.SETRANGE("Tender Paragraph No.", EstimateRAWSetup."Paragraph No.(ExecutionCost)");
              IF NOT EstimateLineRAW.ISEMPTY THEN
                FIELDERROR("Percentage (ExecutionCost)",
                  STRSUBSTNO(Text014, EstimateLineRAW.FIELDCAPTION("Tender Paragraph No."), EstimateRAWSetup."Paragraph No.(ExecutionCost)"));
            END;
          END;
      END;
    END;

    PROCEDURE LookupPlantLocation@1100529400();
    VAR
      PlantLocation@1100529400 : Record 11012554;
    BEGIN
      //DP02115
      IF "Plant Company" <> '' THEN
         PlantLocation.CHANGECOMPANY("Plant Company");
      IF "Project No." <> '' THEN
        PlantLocation.SETRANGE("Project No.", "Project No.")
      ELSE
        PlantLocation.SETRANGE("Customer No.", "Customer No.");
      IF PAGE.RUNMODAL(0, PlantLocation) = ACTION::LookupOK THEN
        VALIDATE("Plant Location", PlantLocation.Code);
    END;

    PROCEDURE GetCostAmount@1100529200(CalculateFlowFields@1100529200 : Boolean) : Decimal;
    BEGIN
      IF CalculateFlowFields THEN BEGIN
        CALCFIELDS("Labor Cost Amount","Material Cost Amount","Subcontracting Cost Amount","Plant Cost Amount","Sundry Cost Amount");
      END;

      EXIT("Labor Cost Amount" + "Material Cost Amount" + "Subcontracting Cost Amount" + "Plant Cost Amount" + "Sundry Cost Amount");
    END;

    PROCEDURE GetSalesAmount@1100529202(CalculateFlowFields@1100529200 : Boolean) : Decimal;
    BEGIN
      IF CalculateFlowFields THEN BEGIN
        CALCFIELDS("Labor Sales Amount","Material Sales Amount","Subcontracting Sales Amount","Plant Sales Amount","Sundry Sales Amount");
      END;

      EXIT("Labor Sales Amount" + "Material Sales Amount" + "Subcontracting Sales Amount" + "Plant Sales Amount" + "Sundry Sales Amount");
    END;

    PROCEDURE GetStatusWarning@1100529401(iEstimate@1100529401 : Code[20]) StatusWarning : Boolean;
    VAR
      Estimate@1100529400 : Record 11012151;
    BEGIN
      //C032265
      IF NOT Estimate.GET(iEstimate) THEN Estimate.INIT;
      StatusWarning := (Estimate.Status = 'SKIP');
    END;

    PROCEDURE SetSkipStatusWarning@1100529402(iStatusWarning@1100529400 : Boolean);
    BEGIN
      //C032265
      SkipStatusWarning := iStatusWarning;
    END;

    PROCEDURE SetDateTimeRecalculated@1100528904(iWriteDateTimeRecalculated@1100528900 : Boolean);
    BEGIN
      //DP02080
      WriteDateTimeRecalculated := iWriteDateTimeRecalculated;
    END;

    PROCEDURE CalcfieldTransferedToPlantNeed@1100529001();
    VAR
      PlantNeed@1100529000 : Record 11012579;
    BEGIN
      IF ("Plant Company" = '') OR ("Plant Company" = COMPANYNAME) THEN
        CALCFIELDS("Transf. to Plant Need")
      ELSE BEGIN
        PlantNeed.CHANGECOMPANY("Plant Company");
        PlantNeed.SETCURRENTKEY("Transf. from Estimate");
        PlantNeed.SETRANGE("Transf. from Estimate", "No.");
        "Transf. to Plant Need" := (NOT PlantNeed.ISEMPTY);
      END;
    END;

    PROCEDURE UpdateSalesPricesByEstimateType@1100528903();
    VAR
      SalesPricebyEstimateType@1100528900 : Record 11229773;
      SalesPricebyEstimate@1100528901 : Record 11229774;
      Customer@1100528902 : Record 18;
    BEGIN
      //DP02089
      IF NOT Customer.GET("Customer No.") THEN EXIT;
      //
      SalesPricebyEstimateType.SETRANGE("Sales Type", SalesPricebyEstimateType."Sales Type"::"All Customers");
      IF SalesPricebyEstimateType.FINDSET THEN BEGIN
        REPEAT
          IF SalesPricebyEstimate.GET("No.", SalesPricebyEstimateType."Estimate Type", SalesPricebyEstimateType."House Model",
            SalesPricebyEstimateType."Recipe Group", SalesPricebyEstimateType.Recipe, SalesPricebyEstimateType."Starting Date")
          THEN
            SalesPricebyEstimate.DELETE;
          //
          SalesPricebyEstimate."Estimate No." := "No.";
          SalesPricebyEstimate."Estimate Type" := SalesPricebyEstimateType."Estimate Type";
          SalesPricebyEstimate."House Model" := SalesPricebyEstimateType."House Model";
          SalesPricebyEstimate."Recipe Group" := SalesPricebyEstimateType."Recipe Group";
          SalesPricebyEstimate.Recipe := SalesPricebyEstimateType.Recipe;
          SalesPricebyEstimate."Starting Date" := SalesPricebyEstimateType."Starting Date";
          SalesPricebyEstimate."Ending Date" := SalesPricebyEstimateType."Ending Date";
          SalesPricebyEstimate.Price := SalesPricebyEstimateType.Price;
          SalesPricebyEstimate.INSERT;
        UNTIL SalesPricebyEstimateType.NEXT = 0;
      END;
      //
      SalesPricebyEstimateType.SETRANGE("Sales Type", SalesPricebyEstimateType."Sales Type"::"Customer Price Group");
      SalesPricebyEstimateType.SETRANGE("Sales Code", Customer."Customer Price Group");
      IF SalesPricebyEstimateType.FINDSET THEN BEGIN
        REPEAT
          IF SalesPricebyEstimate.GET("No.", SalesPricebyEstimateType."Estimate Type", SalesPricebyEstimateType."House Model",
            SalesPricebyEstimateType."Recipe Group", SalesPricebyEstimateType.Recipe, SalesPricebyEstimateType."Starting Date")
          THEN
            SalesPricebyEstimate.DELETE;
          //
          SalesPricebyEstimate."Estimate No." := "No.";
          SalesPricebyEstimate."Estimate Type" := SalesPricebyEstimateType."Estimate Type";
          SalesPricebyEstimate."House Model" := SalesPricebyEstimateType."House Model";
          SalesPricebyEstimate."Recipe Group" := SalesPricebyEstimateType."Recipe Group";
          SalesPricebyEstimate.Recipe := SalesPricebyEstimateType.Recipe;
          SalesPricebyEstimate."Starting Date" := SalesPricebyEstimateType."Starting Date";
          SalesPricebyEstimate."Ending Date" := SalesPricebyEstimateType."Ending Date";
          SalesPricebyEstimate.Price := SalesPricebyEstimateType.Price;
          SalesPricebyEstimate.INSERT;
        UNTIL SalesPricebyEstimateType.NEXT = 0;
      END;
      //
      //
      SalesPricebyEstimateType.SETRANGE("Sales Type", SalesPricebyEstimateType."Sales Type"::Customer);
      SalesPricebyEstimateType.SETRANGE("Sales Code", Customer."No.");
      IF SalesPricebyEstimateType.FINDSET THEN BEGIN
        REPEAT
          IF SalesPricebyEstimate.GET("No.", SalesPricebyEstimateType."Estimate Type", SalesPricebyEstimateType."House Model",
            SalesPricebyEstimateType."Recipe Group", SalesPricebyEstimateType.Recipe, SalesPricebyEstimateType."Starting Date")
          THEN
            SalesPricebyEstimate.DELETE;
          //
          SalesPricebyEstimate."Estimate No." := "No.";
          SalesPricebyEstimate."Estimate Type" := SalesPricebyEstimateType."Estimate Type";
          SalesPricebyEstimate."House Model" := SalesPricebyEstimateType."House Model";
          SalesPricebyEstimate."Recipe Group" := SalesPricebyEstimateType."Recipe Group";
          SalesPricebyEstimate.Recipe := SalesPricebyEstimateType.Recipe;
          SalesPricebyEstimate."Starting Date" := SalesPricebyEstimateType."Starting Date";
          SalesPricebyEstimate."Ending Date" := SalesPricebyEstimateType."Ending Date";
          SalesPricebyEstimate.Price := SalesPricebyEstimateType.Price;
          SalesPricebyEstimate.INSERT;
        UNTIL SalesPricebyEstimateType.NEXT = 0;
      END;
    END;

    PROCEDURE ApplyEstimateTemplate@1100485004(VAR EstimateTemplate@1100525000 : Record 11229776) CreateFromTemplate : Boolean;
    BEGIN
      //DP02264
      //- activate this function on EstimateCard; Fill TemplateCode on page
      //- Check if TemplateCode is filled OnInsert; then activate FillEstimateFromTemplate
      IF NOT GUIALLOWED THEN EXIT(FALSE);

      IF EstimateTemplate.FINDFIRST THEN BEGIN
        IF CONFIRM(Text11012005) THEN BEGIN
          IF EstimateTemplate.COUNT = 1 THEN BEGIN
            CreateFromTemplate := TRUE;
          END ELSE BEGIN
            COMMIT;
            IF PAGE.RUNMODAL(0, EstimateTemplate) = ACTION::LookupOK THEN
              CreateFromTemplate := TRUE;
          END;
        END;
      END;
      EXIT(CreateFromTemplate);
    END;

    PROCEDURE FillEstimateFromTemplate@1100528905();
    VAR
      EstimateTemplate@1100528900 : Record 11229776;
    BEGIN
      //DP02264
      IF "Estimate Template Code" <> '' THEN
        EstimateTemplate.GET("Estimate Template Code")
      ELSE
        IF NOT ApplyEstimateTemplate(EstimateTemplate) THEN EXIT;

      "Estimate Template Code" := EstimateTemplate.Code;
      IF EstimateTemplate.Status <> '' THEN
        Status := EstimateTemplate.Status;
      IF EstimateTemplate.Type <> '' THEN
        Type := EstimateTemplate.Type;
      IF EstimateTemplate.Discipline <> '' THEN
        Discipline := EstimateTemplate.Discipline;
      IF EstimateTemplate."Coding System" <> '' THEN
        "Coding System" := EstimateTemplate."Coding System";
      IF EstimateTemplate."Global Dimension 1 Code" <> '' THEN
        "Global Dimension 1 Code" := EstimateTemplate."Global Dimension 1 Code";
      IF EstimateTemplate."Country/Region Code" <> '' THEN
        "Country/Region Code" := EstimateTemplate."Country/Region Code";
      "Estimate Based On" := EstimateTemplate."Estimate Based On";
      "Item Sales Price Based On" := EstimateTemplate."Item Sales Price Based On";
      IF EstimateTemplate."Rate Group" <> '' THEN
        "Rate Group" := EstimateTemplate."Rate Group";
      IF EstimateTemplate."Recipe Group" <> '' THEN
        "Recipe Group" := EstimateTemplate."Recipe Group";
      IF EstimateTemplate."Norm Group" <> '' THEN
        "Norm Group" := EstimateTemplate."Norm Group";
      IF EstimateTemplate."Norm Group (Sales)" <> '' THEN
        "Norm Group (Sales)" := EstimateTemplate."Norm Group (Sales)";
      IF EstimateTemplate."Part Group" <> '' THEN
        "Part Group" := EstimateTemplate."Part Group";
      IF EstimateTemplate."Surcharge % Labor" <> 0 THEN
        "Surcharge % Labor" := EstimateTemplate."Surcharge % Labor";
      IF EstimateTemplate."Surcharge % Material" <> 0 THEN
        "Surcharge % Material" := EstimateTemplate."Surcharge % Material";
      IF EstimateTemplate."Surcharge % Subcontracting" <> 0 THEN
        "Surcharge % Subcontracting" := EstimateTemplate."Surcharge % Subcontracting";
      IF EstimateTemplate."Surcharge % Plant" <> 0 THEN
        "Surcharge % Plant" := EstimateTemplate."Surcharge % Plant";
      IF EstimateTemplate."Surcharge % Sundry" <> 0 THEN
        "Surcharge % Sundry" := EstimateTemplate."Surcharge % Sundry";
    END;

    LOCAL PROCEDURE UpdateEstimateLines@1100528504(CalledFromFieldNo@1100528500 : Integer);
    VAR
      EstimateLine@1100528501 : Record 11072072;
      EstimateRecipeLine@1100528502 : Record 11072075;
      EstimateLineRAW@1100528503 : Record 11125698;
    BEGIN
      //C053751
      IF "RAW Estimate" THEN BEGIN
        EstimateLineRAW.SETRANGE("Estimate No.", "No.");
        IF CalledFromFieldNo = FIELDNO("Plant Rates in Hours") THEN
          EstimateLineRAW.SETRANGE("Cost Type", EstimateLineRAW."Cost Type"::Plant);
        IF CalledFromFieldNo = FIELDNO("Subcontracting in Hours") THEN
          EstimateLineRAW.SETRANGE("Cost Type", EstimateLineRAW."Cost Type"::Subcontracting);
        IF EstimateLineRAW.FINDSET(TRUE) THEN BEGIN
          REPEAT
            IF CalledFromFieldNo = FIELDNO("Plant Rates in Hours") THEN
              EstimateLineRAW.VALIDATE("Plant Rates in Hours", "Plant Rates in Hours");
            IF CalledFromFieldNo = FIELDNO("Subcontracting in Hours") THEN
              EstimateLineRAW.VALIDATE("Subcontracting in Hours", "Subcontracting in Hours");
            EstimateLineRAW.MODIFY;
          UNTIL EstimateLineRAW.NEXT = 0;
        END;
      END ELSE BEGIN
        EstimateLine.SETRANGE("Estimate No.", "No.");
        EstimateLine.SETFILTER(Recipe, '%1', '');
        IF CalledFromFieldNo = FIELDNO("Plant Rates in Hours") THEN
          EstimateLine.SETRANGE("Cost Type (Hours)", EstimateLine."Cost Type (Hours)"::Plant);
        IF CalledFromFieldNo = FIELDNO("Subcontracting in Hours") THEN
          EstimateLine.SETRANGE("Cost Type (Hours)", EstimateLine."Cost Type (Hours)"::Subcontracting);
        IF EstimateLine.FINDSET(TRUE) THEN BEGIN
          REPEAT
            IF CalledFromFieldNo = FIELDNO("Plant Rates in Hours") THEN
              EstimateLine.VALIDATE("Plant Rates in Hours", "Plant Rates in Hours");
            IF CalledFromFieldNo = FIELDNO("Subcontracting in Hours") THEN
              EstimateLine.VALIDATE("Subcontracting in Hours", "Subcontracting in Hours");
            EstimateLine.MODIFY;
          UNTIL EstimateLine.NEXT = 0;
        END;
        //
        EstimateRecipeLine.SETRANGE("Estimate No.", "No.");
        IF CalledFromFieldNo = FIELDNO("Plant Rates in Hours") THEN
          EstimateRecipeLine.SETRANGE("Cost Type (Hours)", EstimateRecipeLine."Cost Type (Hours)"::Plant);
        IF CalledFromFieldNo = FIELDNO("Subcontracting in Hours") THEN
          EstimateRecipeLine.SETRANGE("Cost Type (Hours)", EstimateRecipeLine."Cost Type (Hours)"::Subcontracting);
        IF EstimateRecipeLine.FINDSET(TRUE) THEN BEGIN
          REPEAT
            IF CalledFromFieldNo = FIELDNO("Plant Rates in Hours") THEN
              EstimateRecipeLine.VALIDATE("Plant Rates in Hours", "Plant Rates in Hours");
            IF CalledFromFieldNo = FIELDNO("Subcontracting in Hours") THEN
              EstimateRecipeLine.VALIDATE("Subcontracting in Hours", "Subcontracting in Hours");
            EstimateRecipeLine.MODIFY;
          UNTIL EstimateRecipeLine.NEXT = 0;
        END;
      END;
    END;

    BEGIN
    {
      -SE EVRY-
      LAHE 121206 Status from Default, Employee from UserSetup
      LAHE 121213 Address from Customer if empty.
      LAHE 121214 Added Key: "Last Date Modified,Estimator"
      LAHE 130116 "Price List Code"

      *** 4PSSE.I012 ***
      130710 Added field "Amount ROT" and code under Labor.onValidate();
      170405 ITERO.DL RFC188 enhance ROT-handling
      170512 ITERO.DL RFC188 caption change ROT -> ROT/RUT
    }
    END.
  }
}

