OBJECT Table 36 Sales Header
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.05,4PS14.00,NAVSE.FI.DK.NO,4PSSE,4PSFI;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Sell-to Customer Name;
    OnInsert=VAR
               O365SalesInvoiceMgmt@1000 : Codeunit 2310;
               StandardCodesMgt@1001 : Codeunit 170;
             BEGIN
               InitInsert;
               InsertMode := TRUE;
               "Inserted By" := USERID; //**4PS.n

               SetSellToCustomerFromFilter;

               IF GetFilterContNo <> '' THEN
                 VALIDATE("Sell-to Contact No.",GetFilterContNo);

               VALIDATE("Payment Instructions Id",O365SalesInvoiceMgmt.GetDefaultPaymentInstructionsId);

               IF "Salesperson Code" = '' THEN
                 SetDefaultSalesperson;

               IF "Sell-to Customer No." <> '' THEN
                 StandardCodesMgt.CheckShowSalesRecurringLinesNotification(Rec);

               // Remove view filters so that the cards does not show filtered view notification
               SETVIEW('');

               //**4PS.sn
               SalesLogisticsSepaRentContract();
               "Calculate B Amounts based on" := SalesSetup."Calculate B Amounts based on";
               VALIDATE("Selection Code is Current Doc.");
               //**4PS.en

               //**4PS Generated Code. Do Not Change.sn05
               DPA_OnInsert;
               //**4PS Generated Code.en05
             END;

    OnModify=BEGIN
               VALIDATE("Selection Code is Current Doc.");  //**4PS.n
             END;

    OnDelete=VAR
               CustInvoiceDisc@1002 : Record 19;
               PostSalesDelete@1003 : Codeunit 363;
               ArchiveManagement@1000 : Codeunit 5063;
               lShippingDetailsRec@1210190000 : Record 11012120;
               PlantInventoryRec2@1100485000 : Record 11012555;
               PlantOrderRec2@1100485001 : Record 11012556;
               ExitOrderRec2@1100485002 : Record 11012559;
               ReturnLossOrderRec@1100525002 : Record 11012655;
               ReturnLossOrderRec2@1100525003 : Record 11012655;
               AdjRec2@1100485003 : Record 11012565;
               PlantHourLineRec2@1100485004 : Record 11012574;
               lvTransOrderRec@1100485005 : Record 11020507;
               lvTransOrderRec2@1100485006 : Record 11020507;
               PlantRentalAgrInvPeriod@1100529006 : Record 11229937;
               PlantRentalAgrInvPeriod2@1100529005 : Record 11229937;
               ExtPlantRentInvoiceLine@1100529007 : Record 11126150;
               ExtPlantRentInvoiceLine2@1100529008 : Record 11126150;
               lvSalesRentalInvoiceLine@1100485007 : Record 11012788;
               lvSalesRentalInvoiceLine2@1100485008 : Record 11012788;
               lvOfferAmountRec@1100485009 : Record 11012786;
               lvSalesRentalRemovalLineRec@1100485010 : Record 11012789;
               lvSalesRentalAppointmentRec@1100485012 : Record 11012991;
               UnitPriceProductionMot@1100485014 : Record 11020425;
               lvServiceContractRec@1100528600 : Record 11012812;
               SalesHeaderExtension@1100528700 : Record 11071868;
               ContractAmountsByDate@1100528800 : Record 11071708;
               ContractInstallment@1100528801 : Record 11071707;
               RentalPackage@1100529000 : Record 11012941;
               RentalPackage2@1100529002 : Record 11012941;
               RentalRateLine@1100529001 : Record 11012942;
               HistRentalPackage@1100529003 : Record 11229848;
               Complaint@1100409000 : Record 11012450;
               ResourceReqCollectiveList@1100529004 : Record 11124904;
               PlantLedgerEntry@1100529600 : Record 11012572;
               PlantLedgerEntry2@1100529601 : Record 11012572;
             BEGIN
               IF NOT UserSetupMgt.CheckRespCenter(0,"Responsibility Center") THEN
                 ERROR(
                   Text022,
                   RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter);

               ArchiveManagement.AutoArchiveSalesDocument(Rec);
               PostSalesDelete.DeleteHeader(
                 Rec,SalesShptHeader,SalesInvHeader,SalesCrMemoHeader,ReturnRcptHeader,
                 SalesInvHeaderPrepmt,SalesCrMemoHeaderPrepmt);
               UpdateOpportunity;

               //**4PS.sn
               IF ("Document Type" = "Document Type"::Order) AND
                  ("Sales Document Type" = "Sales Document Type"::"Sales Logistics Separated")
               THEN
                 ArchiveManagement.ArchSalesDocumentNoConfirm(Rec);
               //**4PS.en

               VALIDATE("Applies-to ID",'');
               VALIDATE("Incoming Document Entry No.",0);

               ApprovalsMgmt.OnDeleteRecordInApprovalRequest(RECORDID);
               SalesLine.RESET;
               SalesLine.LOCKTABLE;

               WhseRequest.SETRANGE("Source Type",DATABASE::"Sales Line");
               WhseRequest.SETRANGE("Source Subtype","Document Type");
               WhseRequest.SETRANGE("Source No.","No.");
               IF NOT WhseRequest.ISEMPTY THEN
                 WhseRequest.DELETEALL(TRUE);

               SalesLine.SETRANGE("Document Type","Document Type");
               SalesLine.SETRANGE("Document No.","No.");

               //**4PS.sn C025689
               SalesLine.SETFILTER("Production Motivation Date",'<>%1',0D);
               IF SalesLine.FINDSET THEN
                 REPEAT
                   IF UnitPriceProductionMot.GET(SalesLine."Job No.","Sell-to Customer No.",SalesLine."Production Motivation Date",SalesLine."Production Motivation Code") THEN
                     IF UnitPriceProductionMot.Invoiced THEN BEGIN
                       UnitPriceProductionMot.Invoiced := FALSE;
                       UnitPriceProductionMot.MODIFY;
                     END;
                 UNTIL SalesLine.NEXT = 0;
               SalesLine.SETRANGE("Production Motivation Date");

               //**4PSmg, 15-04-11: Delete Sales Line bottom-up for Service Invoice Proposal roll-back
               IF "Service Invoice" THEN BEGIN
                 DeleteSalesLines(TRUE);
                 IF "Consumption Invoice" THEN BEGIN
                   IF lvServiceContractRec.GET("Service Contract No.") THEN BEGIN
                     ContractInstallment.SETRANGE("Service Contract No.", lvServiceContractRec."No.");
                     ContractInstallment.SETFILTER("Invoice From", '<=%1', lvServiceContractRec."Invoiced Until");
                     ContractInstallment.SETFILTER("Ending Date", '>=%1|%2', lvServiceContractRec."Invoiced Until"+1, 0D);
                     IF ContractInstallment.FINDFIRST THEN BEGIN
                       ContractAmountsByDate.SETRANGE("Service Contract No.", lvServiceContractRec."No.");
                       ContractAmountsByDate.SETRANGE(Type, ContractAmountsByDate.Type::Installment);
                       ContractAmountsByDate.SETRANGE("Installment Line No.", ContractInstallment."Line No.");
                       ContractAmountsByDate.SETRANGE("Index Date", lvServiceContractRec."Invoiced Until"+1);
                       IF ContractAmountsByDate.FINDFIRST THEN
                         ContractAmountsByDate.DELETE(TRUE);
                     END;
                   END;
                 END;
               END;
               //**4PS.en

               SalesLine.SETRANGE(Type,SalesLine.Type::"Charge (Item)");

               //DeleteSalesLines; //**4PS.o
               DeleteSalesLines(FALSE); //**4PS.n
               SalesLine.SETRANGE(Type);
               //DeleteSalesLines; //**4PS.o
               DeleteSalesLines(FALSE); //**4PS.n

               SalesCommentLine.SETRANGE("Document Type","Document Type");
               SalesCommentLine.SETRANGE("No.","No.");
               SalesCommentLine.DELETEALL;

               //**4PS.sn
               CASE "Document Type" OF
                 "Document Type"::Order:
                   BEGIN
                     IF FPSLicenseManagement.LicenseAndReadPermissionForTable(lShippingDetailsRec) THEN BEGIN
                       lShippingDetailsRec.SETRANGE(Source, lShippingDetailsRec.Source::SalesOrder);
                       lShippingDetailsRec.SETRANGE("Order No.", "No.");
                       lShippingDetailsRec.DELETEALL(TRUE);
                     END;
                   END;
               END;

               IF "Plant Invoice" THEN BEGIN
                 PlantInventoryRec.RESET;
                 PlantInventoryRec.SETCURRENTKEY("Invoice Status","Last Invoice No.","Last Invoice Line No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   PlantInventoryRec.SETRANGE("Invoice Status",PlantInventoryRec."Invoice Status"::Proposal)
                 ELSE
                   PlantInventoryRec.SETRANGE("Invoice Status",PlantInventoryRec."Invoice Status"::"Temporary");
                 PlantInventoryRec.SETRANGE("Last Invoice No.","No.");
                 IF PlantInventoryRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     PlantInventoryRec2 := PlantInventoryRec;
                     PlantInventoryRec2."Last Invoice No." := PlantInventoryRec."Previous Invoice No.";
                     PlantInventoryRec2."Last Invoice Line No." := PlantInventoryRec."Previous Invoice Line No.";
                     PlantInventoryRec2."Invoiced until" := PlantInventoryRec."Previous Invoiced Until";
                     PlantInventoryRec2."No. of Invoiced Days" := PlantInventoryRec."Previous No. of Invoiced Days";
                     PlantInventoryRec2."Previous Invoice No." := '';
                     PlantInventoryRec2."Previous Invoice Line No." := 0;
                     PlantInventoryRec2."Previous Invoiced Until" := 0D;
                     PlantInventoryRec2."Previous No. of Invoiced Days" := 0;
                     IF PlantInventoryRec2."Last Invoice No." = '' THEN
                       PlantInventoryRec2."Invoice Status" := 0
                     ELSE
                       PlantInventoryRec2."Invoice Status" := PlantInventoryRec2."Invoice Status"::Posted;
                     PlantInventoryRec2."Completely Invoiced" := FALSE;
                     PlantInventoryRec2.MODIFY;
                   UNTIL PlantInventoryRec.NEXT = 0;
                 END;

                 PlantOrderRec.RESET;
                 PlantOrderRec.SETCURRENTKEY("From Location Invoice Status","From Location Invoice No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   PlantOrderRec.SETRANGE("From Location Invoice Status",PlantOrderRec."From Location Invoice Status"::Proposal)
                 ELSE
                   PlantOrderRec.SETRANGE("From Location Invoice Status",PlantOrderRec."From Location Invoice Status"::"Temporary");
                 PlantOrderRec.SETRANGE("From Location Invoice No.","No.");
                 IF PlantOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     PlantOrderRec2 := PlantOrderRec;
                     PlantOrderRec2."From Location Invoiced" := FALSE;
                     PlantOrderRec2."From Location Invoice No." := '';
                     PlantOrderRec2."From Location Invoice Status" := 0;
                     PlantOrderRec2.MODIFY;
                   UNTIL PlantOrderRec.NEXT = 0;
                 END;

                 PlantOrderRec.RESET;
                 PlantOrderRec.SETCURRENTKEY("To Location Invoice Status","To Location Invoice No.");
                 PlantOrderRec.SETRANGE("To Location Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   PlantOrderRec.SETRANGE("To Location Invoice Status",PlantOrderRec."To Location Invoice Status"::Proposal)
                 ELSE
                   PlantOrderRec.SETRANGE("To Location Invoice Status",PlantOrderRec."To Location Invoice Status"::"Temporary");
                 IF PlantOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     PlantOrderRec2 := PlantOrderRec;
                     PlantOrderRec2."To Location Invoiced" := FALSE;
                     PlantOrderRec2."To Location Invoice No." := '';
                     PlantOrderRec2."To Location Invoice Status" := 0;
                     PlantOrderRec2.MODIFY;
                   UNTIL PlantOrderRec.NEXT = 0;
                 END;

                 PlantOrderRec.RESET;
                 PlantOrderRec.SETCURRENTKEY("Order Cost Invoice Status","Order Cost Invoice No.");
                 PlantOrderRec.SETRANGE("Order Cost Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   PlantOrderRec.SETRANGE("Order Cost Invoice Status",PlantOrderRec."Order Cost Invoice Status"::Proposal)
                 ELSE
                   PlantOrderRec.SETRANGE("Order Cost Invoice Status",PlantOrderRec."Order Cost Invoice Status"::"Temporary");
                 IF PlantOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     PlantOrderRec2 := PlantOrderRec;
                     PlantOrderRec2."Order Cost Invoiced" := FALSE;
                     PlantOrderRec2."Order Cost Invoice No." := '';
                     PlantOrderRec2."Order Cost Invoice Status" := 0;
                     PlantOrderRec2.MODIFY;
                   UNTIL PlantOrderRec.NEXT = 0;
                 END;

                 ExitOrderRec.RESET;
                 ExitOrderRec.SETCURRENTKEY("Invoice Status","Invoice No.");
                 ExitOrderRec.SETRANGE("Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   ExitOrderRec.SETRANGE("Invoice Status",ExitOrderRec."Invoice Status"::Proposal)
                 ELSE
                   ExitOrderRec.SETRANGE("Invoice Status",ExitOrderRec."Invoice Status"::"Temporary");
                 IF ExitOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     ExitOrderRec2 := ExitOrderRec;
                     ExitOrderRec2.Invoiced := FALSE;
                     ExitOrderRec2."Invoice No." := '';
                     ExitOrderRec2."Invoice Status" := 0;
                     ExitOrderRec2.MODIFY;
                   UNTIL ExitOrderRec.NEXT = 0;
                 END;

                 ReturnLossOrderRec.RESET;
                 ReturnLossOrderRec.SETCURRENTKEY("Invoice Status","Invoice No.");
                 ReturnLossOrderRec.SETRANGE("Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   ReturnLossOrderRec.SETRANGE("Invoice Status",ReturnLossOrderRec."Invoice Status"::Proposal)
                 ELSE
                   ReturnLossOrderRec.SETRANGE("Invoice Status",ReturnLossOrderRec."Invoice Status"::"Temporary");
                 IF ReturnLossOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     ReturnLossOrderRec2 := ReturnLossOrderRec;
                     ReturnLossOrderRec2.Invoiced := FALSE;
                     ReturnLossOrderRec2."Invoice No." := '';
                     ReturnLossOrderRec2."Invoice Status" := 0;
                     ReturnLossOrderRec2.MODIFY;
                   UNTIL ReturnLossOrderRec.NEXT = 0;
                 END;

                 AdjRec.RESET;
                 AdjRec.SETCURRENTKEY("Invoice Status Debit Location","Invoice No. Debit Location");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   AdjRec.SETRANGE("Invoice Status Debit Location",AdjRec."Invoice Status Debit Location"::Proposal)
                 ELSE
                   AdjRec.SETRANGE("Invoice Status Debit Location",AdjRec."Invoice Status Debit Location"::"Temporary");
                 AdjRec.SETRANGE("Invoice No. Debit Location","No.");
                 IF AdjRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     AdjRec2 := AdjRec;
                     AdjRec2."Debet Location Invoiced" := FALSE;
                     AdjRec2."Invoice No. Debit Location" := '';
                     AdjRec2."Invoice Status Debit Location" := 0;
                     AdjRec2."Completely Invoiced" := FALSE;
                     AdjRec2.MODIFY;
                   UNTIL AdjRec.NEXT = 0;
                 END;

                 AdjRec.RESET;
                 AdjRec.SETCURRENTKEY("Invoice Status Credit Location","Invoice.No.Credit Location");
                 AdjRec.SETRANGE("Invoice.No.Credit Location","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   AdjRec.SETRANGE("Invoice Status Credit Location",AdjRec."Invoice Status Credit Location"::Proposal)
                 ELSE
                   AdjRec.SETRANGE("Invoice Status Credit Location",AdjRec."Invoice Status Credit Location"::"Temporary");
                 IF AdjRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     AdjRec2 := AdjRec;
                     AdjRec2."Credit Location Invoiced" := FALSE;
                     AdjRec2."Invoice.No.Credit Location" := '';
                     AdjRec2."Invoice Status Credit Location" := 0;
                     AdjRec2."Completely Invoiced" := FALSE;
                     AdjRec2.MODIFY;
                   UNTIL AdjRec.NEXT = 0;
                 END;

                 PlantHourLineRec.RESET;
                 PlantHourLineRec.SETCURRENTKEY("Invoice Status","Invoice No.");
                 PlantHourLineRec.SETRANGE("Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   PlantHourLineRec.SETRANGE("Invoice Status",PlantHourLineRec."Invoice Status"::Proposal)
                 ELSE
                   PlantHourLineRec.SETRANGE("Invoice Status",PlantHourLineRec."Invoice Status"::"Temporary");
                 IF PlantHourLineRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     PlantHourLineRec2 := PlantHourLineRec;
                     PlantHourLineRec2.Invoiced := FALSE;
                     PlantHourLineRec2."Invoice No." := '';
                     PlantHourLineRec2."Invoice Line No." := 0;
                     PlantHourLineRec2."Invoice Status" := 0;
                     PlantHourLineRec2.MODIFY;
                   UNTIL PlantHourLineRec.NEXT = 0;
                 END;

                 lvTransOrderRec.RESET;
                 lvTransOrderRec.SETCURRENTKEY("From Location Invoice Status","From Location Invoice No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   lvTransOrderRec.SETRANGE("From Location Invoice Status",lvTransOrderRec."From Location Invoice Status"::Proposal)
                 ELSE
                   lvTransOrderRec.SETRANGE("From Location Invoice Status",lvTransOrderRec."From Location Invoice Status"::"Temporary");
                 lvTransOrderRec.SETRANGE("From Location Invoice No.","No.");
                 IF lvTransOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     lvTransOrderRec2 := lvTransOrderRec;
                     lvTransOrderRec2."From Location Invoiced" := FALSE;
                     lvTransOrderRec2."From Location Invoice No." := '';
                     lvTransOrderRec2."From Location Invoice Status" := 0;
                     lvTransOrderRec2.FillStatusInvoiced(TRUE);
                     lvTransOrderRec2.MODIFY;
                   UNTIL lvTransOrderRec.NEXT = 0;
                 END;

                 lvTransOrderRec.RESET;
                 lvTransOrderRec.SETCURRENTKEY("To Location Invoice Status","To Location Invoice No.");
                 lvTransOrderRec.SETRANGE("To Location Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   lvTransOrderRec.SETRANGE("To Location Invoice Status",lvTransOrderRec."To Location Invoice Status"::Proposal)
                 ELSE
                   lvTransOrderRec.SETRANGE("To Location Invoice Status",lvTransOrderRec."To Location Invoice Status"::"Temporary");
                 IF lvTransOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     lvTransOrderRec2 := lvTransOrderRec;
                     lvTransOrderRec2."To Location Invoiced" := FALSE;
                     lvTransOrderRec2."To Location Invoice No." := '';
                     lvTransOrderRec2."To Location Invoice Status" := 0;
                     lvTransOrderRec2.FillStatusInvoiced(TRUE);
                     lvTransOrderRec2.MODIFY;
                   UNTIL lvTransOrderRec.NEXT = 0;
                 END;

                 lvTransOrderRec.RESET;
                 lvTransOrderRec.SETCURRENTKEY("Internal Invoice Status","Internal Invoice No.");
                 lvTransOrderRec.SETRANGE("Internal Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   lvTransOrderRec.SETRANGE("Internal Invoice Status",lvTransOrderRec."Internal Invoice Status"::Proposal)
                 ELSE
                   lvTransOrderRec.SETRANGE("Internal Invoice Status",lvTransOrderRec."Internal Invoice Status"::"Temporary");
                 IF lvTransOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     lvTransOrderRec2 := lvTransOrderRec;
                     lvTransOrderRec2."Internal Invoiced" := FALSE;
                     lvTransOrderRec2."Internal Invoice No." := '';
                     lvTransOrderRec2."Internal Invoice Status" := 0;
                     lvTransOrderRec2.FillStatusInvoiced(TRUE);
                     lvTransOrderRec2.MODIFY;
                   UNTIL lvTransOrderRec.NEXT = 0;
                 END;

                 lvTransOrderRec.RESET;
                 lvTransOrderRec.SETCURRENTKEY("Project Invoice Status","Project Invoice No.");
                 lvTransOrderRec.SETRANGE("Project Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   lvTransOrderRec.SETRANGE("Project Invoice Status",lvTransOrderRec."Project Invoice Status"::Proposal)
                 ELSE
                   lvTransOrderRec.SETRANGE("Project Invoice Status",lvTransOrderRec."Project Invoice Status"::"Temporary");
                 IF lvTransOrderRec.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     lvTransOrderRec2 := lvTransOrderRec;
                     lvTransOrderRec2."Project Invoiced" := FALSE;
                     lvTransOrderRec2."Project Invoice No." := '';
                     lvTransOrderRec2."Project Invoice Status" := 0;
                     lvTransOrderRec2.FillStatusInvoiced(TRUE);
                     lvTransOrderRec2.MODIFY;
                   UNTIL lvTransOrderRec.NEXT = 0;
                 END;

                 PlantRentalAgrInvPeriod.RESET;
                 PlantRentalAgrInvPeriod.SETCURRENTKEY("Invoice Status","Last Invoice No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   PlantRentalAgrInvPeriod.SETRANGE("Invoice Status",PlantRentalAgrInvPeriod."Invoice Status"::Proposal)
                 ELSE
                   PlantRentalAgrInvPeriod.SETRANGE("Invoice Status",PlantRentalAgrInvPeriod."Invoice Status"::"Temporary");
                 PlantRentalAgrInvPeriod.SETRANGE("Last Invoice No.","No.");
                 IF PlantRentalAgrInvPeriod.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     PlantRentalAgrInvPeriod2 := PlantRentalAgrInvPeriod;
                     PlantRentalAgrInvPeriod2."Last Invoice No." := PlantRentalAgrInvPeriod."Previous Invoice No.";
                     PlantRentalAgrInvPeriod2."Invoiced until" := PlantRentalAgrInvPeriod."Previous Invoiced Until";
                     PlantRentalAgrInvPeriod2."Previous Invoice No." := '';
                     PlantRentalAgrInvPeriod2."Previous Invoiced Until" := 0D;
                     IF PlantRentalAgrInvPeriod2."Last Invoice No." = '' THEN
                       PlantRentalAgrInvPeriod2."Invoice Status" := 0
                     ELSE
                       PlantRentalAgrInvPeriod2."Invoice Status" := PlantRentalAgrInvPeriod2."Invoice Status"::Posted;
                     PlantRentalAgrInvPeriod2."Completely Invoiced" := FALSE;
                     PlantRentalAgrInvPeriod2.MODIFY;
                   UNTIL PlantRentalAgrInvPeriod.NEXT = 0;
                 END;

                 ExtPlantRentInvoiceLine.RESET;
                 ExtPlantRentInvoiceLine.SETCURRENTKEY("Sales Invoice Status","Sales Invoice No.");
                 ExtPlantRentInvoiceLine.SETRANGE("Sales Invoice No.","No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   ExtPlantRentInvoiceLine.SETRANGE("Sales Invoice Status",ExtPlantRentInvoiceLine."Sales Invoice Status"::Proposal)
                 ELSE
                   ExtPlantRentInvoiceLine.SETRANGE("Sales Invoice Status",ExtPlantRentInvoiceLine."Sales Invoice Status"::"Temporary");
                 IF ExtPlantRentInvoiceLine.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     ExtPlantRentInvoiceLine2 := ExtPlantRentInvoiceLine;
                     ExtPlantRentInvoiceLine2."Invoiced (Sales)" := FALSE;
                     ExtPlantRentInvoiceLine2."Sales Invoice No." := '';
                     ExtPlantRentInvoiceLine2."Sales Invoice Status" := 0;
                     ExtPlantRentInvoiceLine2.MODIFY(FALSE);
                   UNTIL ExtPlantRentInvoiceLine.NEXT = 0;
                 END;

                 PlantLedgerEntry.SETRANGE("Invoice No.", "No.");
                 IF "Document Type" = "Document Type"::"Invoice Proposal" THEN
                   PlantLedgerEntry.SETRANGE("Invoice Status", PlantLedgerEntry."Invoice Status"::Proposal)
                 ELSE
                   PlantLedgerEntry.SETRANGE("Invoice Status", PlantLedgerEntry."Invoice Status"::"Temporary");
                 IF PlantLedgerEntry.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     PlantLedgerEntry2 := PlantLedgerEntry;
                     PlantLedgerEntry2.Invoiced := FALSE;
                     PlantLedgerEntry2."Invoice No." := '';
                     PlantLedgerEntry2."Invoice Line No." := 0;
                     PlantLedgerEntry2."Invoice Status" := 0;
                     PlantLedgerEntry2.MODIFY;
                   UNTIL PlantLedgerEntry.NEXT = 0;
                 END;
               END;

               IF "Document Type" IN ["Document Type"::Invoice, "Document Type"::"Credit Memo"] THEN BEGIN
                 IF "Sales Document Type" = "Sales Document Type"::"Sales Logistics Separated" THEN BEGIN
                   lvSalesRentalInvoiceLine.RESET;
                   lvSalesRentalInvoiceLine.SETCURRENTKEY("Invoice Status","Last Invoice No.","Last Invoice Line No.");
                   lvSalesRentalInvoiceLine.SETRANGE("Invoice Status",lvSalesRentalInvoiceLine."Invoice Status"::"Temporary");
                   lvSalesRentalInvoiceLine.SETRANGE("Last Invoice No.","No.");
                   IF lvSalesRentalInvoiceLine.FINDSET(TRUE, TRUE) THEN BEGIN
                     REPEAT
                       lvSalesRentalInvoiceLine2 := lvSalesRentalInvoiceLine;
                       lvSalesRentalInvoiceLine2."Last Invoice No." := lvSalesRentalInvoiceLine."Previous Invoice No.";
                       lvSalesRentalInvoiceLine2."Last Invoice Line No." := lvSalesRentalInvoiceLine."Previous Invoice Line No.";
                       lvSalesRentalInvoiceLine2."Invoiced until" := lvSalesRentalInvoiceLine."Previous Invoiced Until";
                       lvSalesRentalInvoiceLine2."Total Time Units Invoiced" := lvSalesRentalInvoiceLine."Previous No. of Time Units Inv";
                       lvSalesRentalInvoiceLine2."Previous Invoice No." := '';
                       lvSalesRentalInvoiceLine2."Previous Invoice Line No." := 0;
                       lvSalesRentalInvoiceLine2."Previous Invoiced Until" := 0D;
                       lvSalesRentalInvoiceLine2."Previous No. of Time Units Inv" := 0;
                       IF lvSalesRentalInvoiceLine2."Last Invoice No." = '' THEN
                         lvSalesRentalInvoiceLine2."Invoice Status" := 0
                       ELSE
                         lvSalesRentalInvoiceLine2."Invoice Status" := lvSalesRentalInvoiceLine2."Invoice Status"::Posted;
                       lvSalesRentalInvoiceLine2."Completely Invoiced" := FALSE;
                       lvSalesRentalInvoiceLine2.MODIFY;
                     UNTIL lvSalesRentalInvoiceLine.NEXT = 0;
                   END;
                 END;
               END;

               IF "Rental Unit Invoice" THEN BEGIN  //DP00617
                 RentalPackage.SETCURRENTKEY("Invoice Status", "Last Invoice No.");
                 RentalPackage.SETRANGE("Invoice Status", RentalPackage."Invoice Status"::"Temporary");
                 RentalPackage.SETRANGE("Last Invoice No.", "No.");
                 IF RentalPackage.FINDSET(TRUE, TRUE) THEN BEGIN
                   REPEAT
                     RentalPackage2 := RentalPackage;
                     RentalPackage2."Last Invoice No." := RentalPackage."Previous Invoice No.";
                     RentalPackage2."Invoice Type" := RentalPackage."Previous Invoice Type";
                     RentalPackage2."Invoiced Until" := RentalPackage."Previous Invoiced Until";
                     RentalPackage2."Previous Invoice No." := '';
                     RentalPackage2."Previous Invoiced Until" := 0D;
                     IF RentalPackage2."Last Invoice No." = '' THEN
                       RentalPackage2."Invoice Status" := 0
                     ELSE
                       RentalPackage2."Invoice Status" := RentalPackage2."Invoice Status"::Posted;
                     RentalPackage2."Completely Invoiced" := FALSE;
                     RentalPackage2.MODIFY;
                     //
                     RentalRateLine.SETRANGE("Project No.", RentalPackage."Project No.");
                     RentalRateLine.SETRANGE("Rental Unit", RentalPackage."Rental Unit");
                     RentalRateLine.SETRANGE("Starting Date Package", RentalPackage."Starting Date");
                     RentalRateLine.SETRANGE("Last Invoice No.", "No.");
                     RentalRateLine.SETRANGE("Invoice Status", RentalRateLine."Invoice Status"::"Temporary");
                     IF RentalRateLine.FINDSET(TRUE, FALSE) THEN BEGIN
                       REPEAT
                         RentalRateLine."Last Invoice No." := RentalRateLine."Previous Invoice No.";
                         RentalRateLine."Invoice Type" := RentalRateLine."Previous Invoice Type";
                         RentalRateLine."Invoiced Until" := RentalRateLine."Previous Invoiced Until";
                         RentalRateLine."Previous Invoice No." := '';
                         RentalRateLine."Previous Invoiced Until" := 0D;
                         IF RentalRateLine."Last Invoice No." = '' THEN
                           RentalRateLine."Invoice Status" := 0
                         ELSE
                           RentalRateLine."Invoice Status" := RentalRateLine."Invoice Status"::Posted;
                         RentalRateLine.MODIFY;
                       UNTIL RentalRateLine.NEXT = 0;
                     END;
                     //
                     HistRentalPackage.SETRANGE("Project No.", RentalPackage."Project No.");
                     HistRentalPackage.SETRANGE("Rental Unit", RentalPackage."Rental Unit");
                     HistRentalPackage.SETRANGE("Starting Date", RentalPackage."Starting Date");
                     HistRentalPackage.SETRANGE("Invoice Status", HistRentalPackage."Invoice Status"::"Temporary");
                     HistRentalPackage.SETRANGE("Invoice No.", "No.");
                     IF HistRentalPackage.FINDSET(TRUE,FALSE) THEN BEGIN
                       REPEAT
                         IF HistRentalPackage."Delayed Index. Invoice" THEN BEGIN
                           RentalPackage2."Invoice Delayed Indexation" := TRUE;
                           RentalPackage2.MODIFY;
                         END;
                         HistRentalPackage.DELETE(TRUE);  // True, including lines
                       UNTIL HistRentalPackage.NEXT = 0;
                     END;
                   UNTIL RentalPackage.NEXT = 0;
                 END;
               END;

               IF ResourceRequestInvoice THEN BEGIN
                 ResourceReqCollectiveList.SETRANGE("No.", "Collective List No. (Res.Req.)");
                 ResourceReqCollectiveList.SETRANGE("Invoice No.", "No.");
                 ResourceReqCollectiveList.SETRANGE("Invoice Status", ResourceReqCollectiveList."Invoice Status"::"Temporary");
                 IF ResourceReqCollectiveList.FINDFIRST THEN BEGIN
                   ResourceReqCollectiveList.Status := ResourceReqCollectiveList.Status::Open;
                   ResourceReqCollectiveList."Invoice No." := '';
                   ResourceReqCollectiveList."Invoice Status" := 0;
                   ResourceReqCollectiveList.MODIFY;
                 END;
               END;

               lvOfferAmountRec.SETRANGE("Document Type", "Document Type");
               lvOfferAmountRec.SETRANGE("Document No.", "No.");
               lvOfferAmountRec.DELETEALL;

               IF "Document Type" = "Document Type"::Order THEN BEGIN
                 lvSalesRentalRemovalLineRec.SETRANGE("Document No.", "No.");
                 lvSalesRentalRemovalLineRec.DELETEALL;
               END;

               lvSalesRentalAppointmentRec.SETRANGE("Document Type", "Document Type");
               lvSalesRentalAppointmentRec.SETRANGE("Document No.", "No.");
               lvSalesRentalAppointmentRec.DELETEALL(TRUE);

               SalesHeaderExtension.SETRANGE("Document Type", "Document Type");
               SalesHeaderExtension.SETRANGE("Document No.", "No.");
               SalesHeaderExtension.DELETEALL;

               //T005606.sn
               CASE "Document Type" OF
                 "Document Type"::Invoice:
                   BEGIN
                     Complaint.SETCURRENTKEY("Sales Invoice");
                     Complaint.SETRANGE("Sales Invoice","No.");
                     IF NOT Complaint.ISEMPTY THEN
                       Complaint.MODIFYALL("Sales Invoice",'');
                   END;
                 "Document Type"::"Credit Memo":
                   BEGIN
                     Complaint.SETCURRENTKEY("Credit Memo");
                     Complaint.SETRANGE("Credit Memo","No.");
                     IF NOT Complaint.ISEMPTY THEN
                       Complaint.MODIFYALL("Credit Memo",'');
                   END;
               END;
               //T005606.en
               //**4PS.en

               IF (SalesShptHeader."No." <> '') OR
                  (SalesInvHeader."No." <> '') OR
                  (SalesCrMemoHeader."No." <> '') OR
                  (ReturnRcptHeader."No." <> '') OR
                  (SalesInvHeaderPrepmt."No." <> '') OR
                  (SalesCrMemoHeaderPrepmt."No." <> '')
               THEN
                 MESSAGE(PostedDocsToPrintCreatedMsg);

               IF IdentityManagement.IsInvAppId AND CustInvoiceDisc.GET(SalesHeader."Invoice Disc. Code") THEN
                 CustInvoiceDisc.DELETE; // Cleanup of autogenerated cust. invoice discounts
             END;

    OnRename=BEGIN
               ERROR(Text003,TABLECAPTION);
             END;

    CaptionML=[ENU=Sales Header;
               NOR=Salgshode;
               SVE=F”rs„ljningshuvud];
    LookupPageID=Page45;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              NOR=Bilagstype;
                                                              SVE=Dokumenttyp];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Invoice Proposal;
                                                                    NOR=Tilbud,Ordre,Faktura,Kreditnota,Rammeordre,Ordreretur;
                                                                    SVE=Offert,Order,Faktura,Kreditnota,Avropsorder,Returorder,Fakturaf”rslag];
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Invoice Proposal;
                                                   Description=[4PS: Raam  -> Afroep  ] }
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                StandardCodesMgt@1000 : Codeunit 170;
                                                              BEGIN
                                                                CheckCreditLimitIfLineNotInsertedYet;
                                                                IF "No." = '' THEN
                                                                  InitRecord;
                                                                TestStatusOpen;
                                                                IF ("Sell-to Customer No." <> xRec."Sell-to Customer No.") AND
                                                                   (xRec."Sell-to Customer No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Opportunity No." <> '') AND ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) THEN
                                                                    ERROR(
                                                                      Text062,
                                                                      FIELDCAPTION("Sell-to Customer No."),
                                                                      FIELDCAPTION("Opportunity No."),
                                                                      "Opportunity No.",
                                                                      "Document Type");
                                                                  IF GetHideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,SellToCustomerTxt);
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF "Sell-to Customer No." = '' THEN BEGIN
                                                                      IF SalesLine.FINDFIRST THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Sell-to Customer No."));
                                                                      INIT;
                                                                      OnValidateSellToCustomerNoAfterInit(Rec,xRec);
                                                                      GetSalesSetup;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;

                                                                    CheckShipmentInfo(SalesLine,FALSE);
                                                                    CheckPrepmtInfo(SalesLine);
                                                                    CheckReturnInfo(SalesLine,FALSE);

                                                                    SalesLine.RESET;
                                                                    FillWKAPercentages; //**4PS.n
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Sell-to Customer No." <> "Sell-to Customer No.")
                                                                THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Purch. Order Line No.",'<>0');
                                                                  IF NOT SalesLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Sell-to Customer No."));
                                                                  SalesLine.RESET;
                                                                END;

                                                                GetCust("Sell-to Customer No.");
                                                                Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                Cust.TESTFIELD("Gen. Bus. Posting Group");
                                                                OnAfterCheckSellToCust(Rec,xRec,Cust);

                                                                CopySellToCustomerAddressFieldsFromCustomer(Cust);

                                                                IF "Sell-to Customer No." = xRec."Sell-to Customer No." THEN
                                                                  IF ShippedSalesLinesExist OR ReturnReceiptExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;

                                                                "Sell-to IC Partner Code" := Cust."IC Partner Code";
                                                                "Send IC Document" := ("Sell-to IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);

                                                                //**4PS.sn
                                                                IF "Sales Document Type" = "Sales Document Type"::"Sales Logistics Separated" THEN BEGIN
                                                                  IF Cust."Plant Depot Logistics" <> '' THEN
                                                                    VALIDATE("Plant Depot Logistics", Cust."Plant Depot Logistics");
                                                                  IF Cust."Location Code Logistics" <>  '' THEN
                                                                    VALIDATE("Location Code Logistics", Cust."Location Code Logistics");
                                                                END;
                                                                "Extended VAT Determination" := Cust."Extended VAT Determination"; //hs, 12-11-2007
                                                                //**4PS.en
                                                                IF Cust."Bill-to Customer No." <> '' THEN
                                                                  VALIDATE("Bill-to Customer No.",Cust."Bill-to Customer No.")
                                                                ELSE BEGIN
                                                                  IF "Bill-to Customer No." = "Sell-to Customer No." THEN
                                                                    SkipBillToContact := TRUE;
                                                                  VALIDATE("Bill-to Customer No.","Sell-to Customer No.");
                                                                  SkipBillToContact := FALSE;
                                                                END;
                                                                VALIDATE("Ship-to Code",Cust."Ship-to Code");

                                                                GetShippingTime(FIELDNO("Sell-to Customer No."));

                                                                SkipRecreateSalesLines := FALSE; //**4PS C008869

                                                                IF (xRec."Sell-to Customer No." <> "Sell-to Customer No.") OR
                                                                   (xRec."Currency Code" <> "Currency Code") OR
                                                                   (xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group") OR
                                                                   (xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group") OR
                                                                   AskRecreateSalesLines //**4PS C008869
                                                                THEN
                                                                  RecreateSalesLines(SellToCustomerTxt);

                                                                AskRecreateSalesLines := FALSE; //**4PS C008869

                                                                IF NOT SkipSellToContact THEN
                                                                  UpdateSellToCont("Sell-to Customer No.");

                                                                IF "No." <> '' THEN
                                                                  StandardCodesMgt.CheckShowSalesRecurringLinesNotification(Rec);

                                                                IF (xRec."Sell-to Customer No." <> '') AND (xRec."Sell-to Customer No." <> "Sell-to Customer No.") THEN
                                                                  RecallModifyAddressNotification(GetModifyCustomerAddressNotificationId);

                                                                //**4PS.sn
                                                                GetRetentions;
                                                                "Inserted By" := USERID;
                                                                ShowSalesOrders;
                                                                //**4PS.en

                                                                OnValidateSellToCustomerNo(Rec, xRec);//4PSSE
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              NOR=Salg til-kundenr.;
                                                              SVE=F”rs.kundnr] }
    { 3   ;   ;No.                 ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=FIELD(Document Type));
                                                   OnValidate=BEGIN
                                                                //**4PS: Table relation added for lookup in reports like 11012565
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  GetSalesSetup;
                                                                  NoSeriesMgt.TestManual(GetNoSeriesCode);
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.;
                                                              SVE=Nr] }
    { 4   ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                ProjectPrincipal@1210190000 : Record 11012005;
                                                              BEGIN
                                                                TestStatusOpen;
                                                                BilltoCustomerNoChanged := xRec."Bill-to Customer No." <> "Bill-to Customer No.";
                                                                IF BilltoCustomerNoChanged THEN
                                                                  IF xRec."Bill-to Customer No." = '' THEN
                                                                    InitRecord
                                                                  ELSE BEGIN
                                                                    IF GetHideValidationDialog OR NOT GUIALLOWED THEN
                                                                      Confirmed := TRUE
                                                                    ELSE
                                                                      Confirmed := CONFIRM(ConfirmChangeQst,FALSE,BillToCustomerTxt);
                                                                    IF Confirmed THEN BEGIN
                                                                      SalesLine.SETRANGE("Document Type","Document Type");
                                                                      SalesLine.SETRANGE("Document No.","No.");

                                                                      CheckShipmentInfo(SalesLine,TRUE);
                                                                      CheckPrepmtInfo(SalesLine);
                                                                      CheckReturnInfo(SalesLine,TRUE);

                                                                      SalesLine.RESET;
                                                                    END ELSE
                                                                      "Bill-to Customer No." := xRec."Bill-to Customer No.";
                                                                  END;

                                                                GetCust("Bill-to Customer No.");
                                                                Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                Cust.TESTFIELD("Customer Posting Group");
                                                                PostingSetupMgt.CheckCustPostingGroupReceivablesAccount("Customer Posting Group");
                                                                CheckCreditLimit;
                                                                OnAfterCheckBillToCust(Rec,xRec,Cust);

                                                                VALIDATE("Alternative Bill-to Address",''); //**4PS.n

                                                                CopyBillToCustomerAddressFieldsFromCustomer(Cust);


                                                                //**4PS.sn
                                                                IF ProjectPrincipal.GET("Job No.", "Sell-to Customer No.") THEN BEGIN
                                                                  IF ProjectPrincipal."Specific Payment Terms Code" <> '' THEN
                                                                    "Payment Terms Code" := ProjectPrincipal."Specific Payment Terms Code";
                                                                END;
                                                                //**4PS.en

                                                                IF NOT BilltoCustomerNoChanged THEN
                                                                  IF ShippedSalesLinesExist THEN BEGIN
                                                                    TESTFIELD("Customer Disc. Group",xRec."Customer Disc. Group");
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                  END;

                                                                CreateDim(
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Job,"Job No.", //**4PS.n
                                                                  DATABASE::"Service Order","Service Order No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Service-Contract","Service Contract No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                                  //DATABASE::Location,"Location Code"); //**4PS.n  //*C007227.o

                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");
                                                                VALIDATE("Prepayment %");

                                                                //**4PS.sn
                                                                VALIDATE("Credit Restriction", Cust."Credit Restriction");
                                                                //**4PS.en

                                                                IF (xRec."Sell-to Customer No." = "Sell-to Customer No.") AND
                                                                   (xRec."Bill-to Customer No." <> "Bill-to Customer No.")
                                                                THEN BEGIN
                                                                  RecreateSalesLines(BillToCustomerTxt);
                                                                  BilltoCustomerNoChanged := FALSE;
                                                                END;
                                                                IF NOT SkipBillToContact THEN
                                                                  UpdateBillToCont("Bill-to Customer No.");

                                                                "Bill-to IC Partner Code" := Cust."IC Partner Code";
                                                                "Send IC Document" := ("Bill-to IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);

                                                                IF (xRec."Bill-to Customer No." <> '') AND (xRec."Bill-to Customer No." <> "Bill-to Customer No.") THEN
                                                                  RecallModifyAddressNotification(GetModifyBillToCustomerAddressNotificationId);
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              NOR=Faktura til-kundenr.;
                                                              SVE=Faktureringskundnr];
                                                   NotBlank=Yes }
    { 5   ;   ;Bill-to Name        ;Text100       ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                Customer@1000 : Record 18;
                                                              BEGIN
                                                                IF ShouldLookForCustomerByName("Bill-to Customer No.") THEN
                                                                  VALIDATE("Bill-to Customer No.",Customer.GetCustNo("Bill-to Name"));
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Bill-to Name;
                                                              NOR=Faktura til-navn;
                                                              SVE=Faktureringsnamn] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[ENU=Bill-to Name 2;
                                                              NOR=Faktura til-navn 2;
                                                              SVE=Faktureringsnamn 2] }
    { 7   ;   ;Bill-to Address     ;Text100       ;OnValidate=BEGIN
                                                                ModifyBillToCustomerAddress;
                                                              END;

                                                   CaptionML=[ENU=Bill-to Address;
                                                              NOR=Faktura til-adresse;
                                                              SVE=Faktureringsadress] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;OnValidate=BEGIN
                                                                ModifyBillToCustomerAddress;
                                                              END;

                                                   CaptionML=[ENU=Bill-to Address 2;
                                                              NOR=Faktura til-adresse 2;
                                                              SVE=Faktureringsadress 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;TableRelation=IF (Bill-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Bill-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Bill-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                ModifyBillToCustomerAddress;
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Bill-to City;
                                                              NOR=Faktura til-sted;
                                                              SVE=Faktureras ort] }
    { 10  ;   ;Bill-to Contact     ;Text100       ;OnValidate=BEGIN
                                                                ModifyBillToCustomerAddress;
                                                              END;

                                                   OnLookup=VAR
                                                              Contact@1001 : Record 5050;
                                                            BEGIN
                                                              LookupContact("Bill-to Customer No.","Bill-to Contact No.",Contact);
                                                              IF PAGE.RUNMODAL(0,Contact) = ACTION::LookupOK THEN
                                                                VALIDATE("Bill-to Contact No.",Contact."No.");
                                                            END;

                                                   CaptionML=[ENU=Bill-to Contact;
                                                              NOR=Faktura til-kontakt;
                                                              SVE=Faktureringskontakt] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              NOR=Deres referanse;
                                                              SVE=Er referens] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.),
                                                                                               Shipping Address=CONST(Yes));
                                                   OnValidate=VAR
                                                                ShipToAddr@1000 : Record 222;
                                                              BEGIN
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Purch. Order Line No.",'<>0');
                                                                  IF NOT SalesLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Ship-to Code"));
                                                                  SalesLine.RESET;
                                                                END;

                                                                IF NOT IsCreditDocType THEN
                                                                  IF "Ship-to Code" <> '' THEN BEGIN
                                                                    IF xRec."Ship-to Code" <> '' THEN
                                                                    BEGIN
                                                                      GetCust("Sell-to Customer No.");
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",Cust."Location Code");
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                    END;
                                                                    ShipToAddr.GET("Sell-to Customer No.","Ship-to Code");
                                                                    CopyShipToCustomerAddressFieldsFromShipToAddr(ShipToAddr);
                                                                  END ELSE
                                                                    IF "Sell-to Customer No." <> '' THEN BEGIN
                                                                      GetCust("Sell-to Customer No.");
                                                                      CopyShipToCustomerAddressFieldsFromCustomer(Cust);
                                                                    END;

                                                                GetShippingTime(FIELDNO("Ship-to Code"));

                                                                IF (xRec."Sell-to Customer No." = "Sell-to Customer No.") AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN
                                                                  IF (xRec."VAT Country/Region Code" <> "VAT Country/Region Code") OR
                                                                     (xRec."Tax Area Code" <> "Tax Area Code")
                                                                  THEN
                                                                    RecreateSalesLines(FIELDCAPTION("Ship-to Code"))
                                                                  ELSE BEGIN
                                                                    IF xRec."Shipping Agent Code" <> "Shipping Agent Code" THEN
                                                                      MessageIfSalesLinesExist(FIELDCAPTION("Shipping Agent Code"));
                                                                    IF xRec."Shipping Agent Service Code" <> "Shipping Agent Service Code" THEN
                                                                      MessageIfSalesLinesExist(FIELDCAPTION("Shipping Agent Service Code"));
                                                                    IF xRec."Tax Liable" <> "Tax Liable" THEN
                                                                      VALIDATE("Tax Liable");
                                                                  END;

                                                                FillDefaultEMailShipment; //**4PS.n
                                                                FillDefaultEMailOrderConfirm; //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              NOR=Lever til-kode;
                                                              SVE=Leveransadresskod] }
    { 13  ;   ;Ship-to Name        ;Text100       ;CaptionML=[ENU=Ship-to Name;
                                                              NOR=Lever til-navn;
                                                              SVE=Leveransnamn] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              NOR=Lever til-navn 2;
                                                              SVE=Leveransnamn 2] }
    { 15  ;   ;Ship-to Address     ;Text100       ;CaptionML=[ENU=Ship-to Address;
                                                              NOR=Lever til-adresse;
                                                              SVE=Leveransadress] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              NOR=Lever til-adresse 2;
                                                              SVE=Leveransadress 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              NOR=Lever til-sted;
                                                              SVE=Leveransort] }
    { 18  ;   ;Ship-to Contact     ;Text100       ;OnValidate=BEGIN
                                                                //**4PS.sn
                                                                IF "Ship-to Contact" = '' THEN
                                                                  "Ship-to Contact No." := '';
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Ship-to Contact;
                                                              NOR=Lever til-kontakt;
                                                              SVE=Leveranskontakt] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                IF ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) AND
                                                                   NOT ("Order Date" = xRec."Order Date")
                                                                THEN
                                                                  PriceMessageIfSalesLinesExist(FIELDCAPTION("Order Date"));
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Order Date;
                                                              NOR=Ordredato;
                                                              SVE=Orderdatum] }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=VAR
                                                                IsHandled@1000 : Boolean;
                                                              BEGIN
                                                                TESTFIELD("Posting Date");
                                                                TestNoSeriesDate(
                                                                  "Posting No.","Posting No. Series",
                                                                  FIELDCAPTION("Posting No."),FIELDCAPTION("Posting No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepayment No.","Prepayment No. Series",
                                                                  FIELDCAPTION("Prepayment No."),FIELDCAPTION("Prepayment No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepmt. Cr. Memo No.","Prepmt. Cr. Memo No. Series",
                                                                  FIELDCAPTION("Prepmt. Cr. Memo No."),FIELDCAPTION("Prepmt. Cr. Memo No. Series"));

                                                                IsHandled := FALSE;
                                                                OnValidatePostingDateOnBeforeAssignDocumentDate(Rec,IsHandled);
                                                                IF NOT IsHandled THEN
                                                                  IF "Incoming Document Entry No." = 0 THEN
                                                                    VALIDATE("Document Date","Posting Date");

                                                                VALIDATE("Interest Date"); //**4PS.n

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN
                                                                  PriceMessageIfSalesLinesExist(FIELDCAPTION("Posting Date"));

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    ConfirmUpdateCurrencyFactor;
                                                                END;

                                                                IF "Posting Date" <> xRec."Posting Date" THEN
                                                                  IF DeferralHeadersExist THEN
                                                                    ConfirmUpdateDeferralDate;
                                                                SynchronizeAsmHeader;
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato;
                                                              SVE=Bokf”ringsdatum] }
    { 21  ;   ;Shipment Date       ;Date          ;OnValidate=BEGIN
                                                                UpdateSalesLinesByFieldNo(FIELDNO("Shipment Date"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Shipment Date;
                                                              NOR=Forsendelsesdato;
                                                              SVE=Utleveransdatum] }
    { 22  ;   ;Posting Description ;Text100       ;CaptionML=[ENU=Posting Description;
                                                              NOR=Bokf›ringsbeskrivelse;
                                                              SVE=Bokf”ringsbeskrivning] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=VAR
                                                                IsHandled@1000 : Boolean;
                                                              BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF IsCreditDocType AND NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                    //**4PS.sn
                                                                    VALIDATE("Pmt. Discount Date 2",0D);
                                                                    VALIDATE("Payment Discount % 2",0);
                                                                    VALIDATE("Pmt. Discount Date 3",0D);
                                                                    VALIDATE("Payment Discount % 3",0);
                                                                    //**4PS.en
                                                                  END ELSE BEGIN
                                                                    IsHandled := FALSE;
                                                                    OnValidatePaymentTermsCodeOnBeforeCalcDueDate(Rec,xRec,FIELDNO("Payment Terms Code"),CurrFieldNo,IsHandled);
                                                                    IF NOT IsHandled THEN
                                                                      "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    IsHandled := FALSE;
                                                                    OnValidatePaymentTermsCodeOnBeforeCalcPmtDiscDate(Rec,xRec,FIELDNO("Payment Terms Code"),CurrFieldNo,IsHandled);
                                                                    IF NOT IsHandled THEN
                                                                      "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                    BEGIN //**4PS.n
                                                                      VALIDATE("Payment Discount %",PaymentTerms."Discount %");
                                                                    //**4PS.sn
                                                                      "Pmt. Discount Date 2" := CALCDATE(PaymentTerms."Discount Date Calculation 2","Document Date");
                                                                      IF xRec."Document Date" = "Document Date" THEN
                                                                        VALIDATE("Payment Discount % 2",PaymentTerms."Discount % 2");
                                                                      "Pmt. Discount Date 3" := CALCDATE(PaymentTerms."Discount Date Calculation 3","Document Date");
                                                                      IF xRec."Document Date" = "Document Date" THEN
                                                                        VALIDATE("Payment Discount % 3",PaymentTerms."Discount % 3");
                                                                    END;
                                                                    //**4PS.en
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                    //**4PS.sn
                                                                    VALIDATE("Pmt. Discount Date 2",0D);
                                                                    VALIDATE("Payment Discount % 2",0);
                                                                    VALIDATE("Pmt. Discount Date 3",0D);
                                                                    VALIDATE("Payment Discount % 3",0);
                                                                    //**4PS.en
                                                                  END;
                                                                END;
                                                                IF xRec."Payment Terms Code" = "Prepmt. Payment Terms Code" THEN BEGIN
                                                                  IF xRec."Prepayment Due Date" = 0D THEN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                  VALIDATE("Prepmt. Payment Terms Code","Payment Terms Code");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              NOR=Betalingsbet.kode;
                                                              SVE=Betalningsvillkorskod] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato;
                                                              SVE=F”rfallodatum] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TestStatusOpen;
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Payment Discount %;
                                                              NOR=Kontantrabatt-%;
                                                              SVE=Kassarabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              NOR=Kont.rabattdato;
                                                              SVE=Kassarabattsdatum] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                              END;

                                                   CaptionML=[ENU=Shipment Method/Incoterm Code;
                                                              NOR=Leveringsm†tekode;
                                                              SVE=Utleveransvillkorskod] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   (xRec."Sell-to Customer No." = "Sell-to Customer No.")
                                                                THEN
                                                                  MessageIfSalesLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;
                                                                UpdateOutboundWhseHandlingTime;

                                                                //**4PS.sn
                                                                UpdateVATData;
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode;
                                                              SVE=Lagerst„llekod] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1),
                                                                                               Blocked=CONST(No));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode;
                                                              SVE=Genv„g dimension 1 kod];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2),
                                                                                               Blocked=CONST(No));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode;
                                                              SVE=Genv„g dimension 2 kod];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code20      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[ENU=Customer Posting Group;
                                                              NOR=Bokf›ringsgruppe - kunde;
                                                              SVE=Kundbokf”ringsmall];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date")]) OR ("Currency Code" <> xRec."Currency Code") THEN
                                                                  TestStatusOpen;
                                                                IF (CurrFieldNo <> FIELDNO("Currency Code")) AND ("Currency Code" = xRec."Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN
                                                                    UpdateCurrencyFactor
                                                                  ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdateSalesLinesByFieldNo(FIELDNO("Currency Factor"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              NOR=Valutafaktor;
                                                              SVE=Valutafaktor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 34  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Customer Price Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Price Group;
                                                              NOR=Kundeprisgruppe;
                                                              SVE=Kund prisgrupp] }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                SalesLine@1000 : Record 37;
                                                                Currency@1001 : Record 4;
                                                                ConfirmManagement@1006 : Codeunit 27;
                                                                RecalculatePrice@1002 : Boolean;
                                                                VatFactor@1005 : Decimal;
                                                                LineInvDiscAmt@1004 : Decimal;
                                                                InvDiscRounding@1003 : Decimal;
                                                              BEGIN
                                                                TestStatusOpen;

                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type","Document Type");
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Job Contract Entry No.",'<>%1',0);
                                                                  IF SalesLine.FIND('-') THEN BEGIN
                                                                    SalesLine.TESTFIELD("Job No.",'');
                                                                    SalesLine.TESTFIELD("Job Contract Entry No.",0);
                                                                  END;

                                                                  SalesLine.RESET;
                                                                  SalesLine.SETRANGE("Document Type","Document Type");
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Unit Price",'<>%1',0);
                                                                  SalesLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF SalesLine.FINDFIRST THEN BEGIN
                                                                    IF GetHideValidationDialog OR NOT GUIALLOWED THEN
                                                                      RecalculatePrice := TRUE
                                                                    ELSE
                                                                      RecalculatePrice :=
                                                                        ConfirmManagement.ConfirmProcess(
                                                                          STRSUBSTNO(
                                                                            Text024,
                                                                            FIELDCAPTION("Prices Including VAT"),SalesLine.FIELDCAPTION("Unit Price")),
                                                                          TRUE);
                                                                    //>>NAVNO
                                                                    GLSetup.GET;
                                                                    IF GLSetup."Norwegian Localization Active" THEN
                                                                      IF NOT RecalculatePrice THEN
                                                                        ERROR('');
                                                                    //<<NAVNO
                                                                    OnAfterConfirmSalesPrice(Rec,SalesLine,RecalculatePrice);
                                                                    SalesLine.SetSalesHeader(Rec);
                                                                    //>>NAVDK
                                                                    GLSetup.GET;
                                                                    IF GLSetup."Danish Localization Active" THEN
                                                                      IF RecalculatePrice AND "Prices Including VAT" THEN
                                                                        SalesLine.MODIFYALL(Amount,0,TRUE);
                                                                    //<<NAVDK

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");
                                                                    SalesLine.LOCKTABLE;
                                                                    LOCKTABLE;
                                                                    SalesLine.FINDSET;
                                                                    REPEAT
                                                                      SalesLine.TESTFIELD("Quantity Invoiced",0);
                                                                      SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        SalesLine."VAT Difference" := 0;
                                                                        SalesLine.UpdateAmounts;
                                                                      END ELSE BEGIN
                                                                        VatFactor := 1 + SalesLine."VAT %" / 100;
                                                                        IF VatFactor = 0 THEN
                                                                          VatFactor := 1;
                                                                        IF NOT "Prices Including VAT" THEN
                                                                          VatFactor := 1 / VatFactor;
                                                                        SalesLine."Unit Price" :=
                                                                          ROUND(SalesLine."Unit Price" * VatFactor,Currency."Unit-Amount Rounding Precision");
                                                                        SalesLine."Line Discount Amount" :=
                                                                          ROUND(
                                                                            SalesLine.Quantity * SalesLine."Unit Price" * SalesLine."Line Discount %" / 100,
                                                                            Currency."Amount Rounding Precision");
                                                                        LineInvDiscAmt := InvDiscRounding + SalesLine."Inv. Discount Amount" * VatFactor;
                                                                        SalesLine."Inv. Discount Amount" := ROUND(LineInvDiscAmt,Currency."Amount Rounding Precision");
                                                                        InvDiscRounding := LineInvDiscAmt - SalesLine."Inv. Discount Amount";
                                                                        IF "Prices Including VAT" THEN
                                                                          SalesLine."Line Amount" := SalesLine."Amount Including VAT" + SalesLine."Inv. Discount Amount"
                                                                        ELSE
                                                                          SalesLine."Line Amount" := SalesLine.Amount + SalesLine."Inv. Discount Amount";
                                                                      END;
                                                                      OnValidatePricesIncludingVATOnBeforeSalesLineModify(Rec,SalesLine,Currency,RecalculatePrice);
                                                                      SalesLine.MODIFY;
                                                                    UNTIL SalesLine.NEXT = 0;
                                                                  END;
                                                                  OnAfterChangePricesIncludingVAT(Rec);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including VAT;
                                                              NOR=Priser inkl. mva.;
                                                              SVE=Priser inkl. moms] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   AccessByPermission=TableData 19=R;
                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              NOR=Fakturarabattkode;
                                                              SVE=Fakturarabattkod] }
    { 40  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Customer Disc. Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              NOR=Kunderabattgruppe;
                                                              SVE=Kundrabattgrupp] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[ENU=Language Code;
                                                              NOR=Spr†kkode;
                                                              SVE=Spr†kkod] }
    { 43  ;   ;Salesperson Code    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                ApprovalEntry@1001 : Record 454;
                                                                SaveDim1@1100525000 : Code[20];
                                                              BEGIN
                                                                ValidateSalesPersonOnSalesHeader(Rec,FALSE,FALSE);

                                                                ApprovalEntry.SETRANGE("Table ID",DATABASE::"Sales Header");
                                                                ApprovalEntry.SETRANGE("Document Type","Document Type");
                                                                ApprovalEntry.SETRANGE("Document No.","No.");
                                                                ApprovalEntry.SETFILTER(Status,'%1|%2',ApprovalEntry.Status::Created,ApprovalEntry.Status::Open);
                                                                IF NOT ApprovalEntry.ISEMPTY THEN
                                                                  ERROR(Text053,FIELDCAPTION("Salesperson Code"));

                                                                //**4PS.sn
                                                                IF (NOT DimMgt.HasDefaultDim(DATABASE::"Salesperson/Purchaser","Salesperson Code")) AND
                                                                   (NOT DimMgt.HasDefaultDim(DATABASE::"Salesperson/Purchaser",xRec."Salesperson Code"))
                                                                THEN
                                                                  EXIT;

                                                                SaveDim1 := "Shortcut Dimension 1 Code";
                                                                //**4PS.en

                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Job,"Job No.", //**4PS.n
                                                                  DATABASE::"Service Order","Service Order No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Service-Contract","Service Contract No.", //**4PS.n 09-06-2010
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                                  //DATABASE::Location,"Location Code");  //**4PS.n  //*C007227.o

                                                                VALIDATE("Shortcut Dimension 1 Code", SaveDim1);   //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              NOR=Selgerkode;
                                                              SVE=S„ljarkod] }
    { 45  ;   ;Order Class         ;Code10        ;CaptionML=[ENU=Order Class;
                                                              NOR=Ordreklasse;
                                                              SVE=Orderstatistiknr] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Comment Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                 No.=FIELD(No.),
                                                                                                 Document Line No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              NOR=Antall skrevet ut;
                                                              SVE=Utskriven];
                                                   Editable=No }
    { 51  ;   ;On Hold             ;Code3         ;CaptionML=[ENU=On Hold;
                                                              NOR=Avvent;
                                                              SVE=Stoppad] }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              NOR=Utligningsbilagstype;
                                                              SVE=Kopplas till dokumenttyp];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    NOR=" ,Betaling,Faktura,Kreditnota,Rentenota,Purring,Refusjon";
                                                                    SVE=" ,Betalning,Faktura,Kreditnota,R„ntefaktura,Betalningsp†minnelse,terbetalning"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=BEGIN
                                                                //18910 IF "Applies-to Doc. No." <> '' THEN  //**4PS.n
                                                                //        TESTFIELD("Installment Invoice", FALSE);  //**4PS.n

                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   ("Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  CustLedgEntry.SetAmountToApply("Applies-to Doc. No.","Bill-to Customer No.");
                                                                  CustLedgEntry.SetAmountToApply(xRec."Applies-to Doc. No.","Bill-to Customer No.");
                                                                END ELSE
                                                                  IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    CustLedgEntry.SetAmountToApply("Applies-to Doc. No.","Bill-to Customer No.")
                                                                  ELSE
                                                                    IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND ("Applies-to Doc. No." = '') THEN
                                                                      CustLedgEntry.SetAmountToApply(xRec."Applies-to Doc. No.","Bill-to Customer No.");
                                                              END;

                                                   OnLookup=VAR
                                                              GenJnlLine@1000 : Record 81;
                                                              GenJnlApply@1002 : Codeunit 225;
                                                              ApplyCustEntries@1001 : Page 232;
                                                            BEGIN
                                                              TESTFIELD("Bal. Account No.",'');
                                                              CustLedgEntry.SetApplyToFilters("Bill-to Customer No.","Applies-to Doc. Type","Applies-to Doc. No.",Amount);
                                                              OnAfterSetApplyToFilters(CustLedgEntry,Rec);

                                                              ApplyCustEntries.SetSales(Rec,CustLedgEntry,SalesHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyCustEntries.SETTABLEVIEW(CustLedgEntry);
                                                              ApplyCustEntries.SETRECORD(CustLedgEntry);
                                                              ApplyCustEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyCustEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyCustEntries.GetCustLedgEntry(CustLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",CustLedgEntry."Currency Code",GenJnlLine."Account Type"::Customer,TRUE);
                                                                "Applies-to Doc. Type" := CustLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := CustLedgEntry."Document No.";
                                                                OnAfterAppliesToDocNoOnLookup(Rec,CustLedgEntry);
                                                              END;
                                                              CLEAR(ApplyCustEntries);
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              NOR=Utligningsbilagsnr.;
                                                              SVE=Kopplas till ver.nr] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              NOR=Motkontonr.;
                                                              SVE=Motkonto] }
    { 56  ;   ;Recalculate Invoice Disc.;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Recalculate Invoice Disc.=CONST(Yes)));
                                                   CaptionML=[ENU=Recalculate Invoice Disc.;
                                                              NOR=Beregn fakturarabatt p† nytt;
                                                              SVE=Ber„kna om fakturarabatt];
                                                   Editable=No }
    { 57  ;   ;Ship                ;Boolean       ;CaptionML=[ENU=Ship;
                                                              NOR=Levere;
                                                              SVE=Leverera];
                                                   Editable=No }
    { 58  ;   ;Invoice             ;Boolean       ;CaptionML=[ENU=Invoice;
                                                              NOR=Faktura;
                                                              SVE=Faktura] }
    { 59  ;   ;Print Posted Documents;Boolean     ;CaptionML=[ENU=Print Posted Documents;
                                                              NOR=Skriv ut bokf›rte dokumenter;
                                                              SVE=Skriv ut bokf”rda dokument] }
    { 60  ;   ;Amount              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line".Amount WHERE (Document Type=FIELD(Document Type),
                                                                                              Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount;
                                                              NOR=Bel›p;
                                                              SVE=Belopp];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Amount Including VAT;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Amount Including VAT" WHERE (Document Type=FIELD(Document Type),
                                                                                                              Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount Including VAT;
                                                              NOR=Bel›p inkl. mva.;
                                                              SVE=Belopp inkl. moms];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 62  ;   ;Shipping No.        ;Code20        ;CaptionML=[ENU=Shipping No.;
                                                              NOR=F›lgeseddelnr.;
                                                              SVE=Leveransnr] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              NOR=Bokf›ringsnr.;
                                                              SVE=Bokf”ring med nr] }
    { 64  ;   ;Last Shipping No.   ;Code20        ;TableRelation="Sales Shipment Header";
                                                   CaptionML=[ENU=Last Shipping No.;
                                                              NOR=Siste f›lges.nr.;
                                                              SVE=Senaste leveransnr];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[ENU=Last Posting No.;
                                                              NOR=Siste bokf›ringsnr.;
                                                              SVE=Senast bokf”rt med nr];
                                                   Editable=No }
    { 66  ;   ;Prepayment No.      ;Code20        ;CaptionML=[ENU=Prepayment No.;
                                                              NOR=Forskuddsnummer;
                                                              SVE=Nr f”r f”rskottsbetalning] }
    { 67  ;   ;Last Prepayment No. ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[ENU=Last Prepayment No.;
                                                              NOR=Siste forskuddsnummer;
                                                              SVE=Nr f”r senaste f”rskottsbetalning] }
    { 68  ;   ;Prepmt. Cr. Memo No.;Code20        ;CaptionML=[ENU=Prepmt. Cr. Memo No.;
                                                              NOR=Kreditnotanummer for forskudd;
                                                              SVE=Kreditnotanr f”r f”rbet.] }
    { 69  ;   ;Last Prepmt. Cr. Memo No.;Code20   ;TableRelation="Sales Cr.Memo Header";
                                                   CaptionML=[ENU=Last Prepmt. Cr. Memo No.;
                                                              NOR=Siste kreditnotanummer for forskudd;
                                                              SVE=Kreditnotanr f”r senaste f”rbet.] }
    { 70  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                Customer@1000 : Record 18;
                                                                VATRegistrationLog@1200 : Record 249;
                                                                VATRegistrationNoFormat@1300 : Record 381;
                                                                VATRegNoSrvConfig@1001 : Record 248;
                                                                VATRegistrationLogMgt@1400 : Codeunit 249;
                                                                ResultRecRef@1050 : RecordRef;
                                                                ApplicableCountryCode@1600 : Code[10];
                                                              BEGIN
                                                                "VAT Registration No." := UPPERCASE("VAT Registration No.");
                                                                IF "VAT Registration No." = xRec."VAT Registration No." THEN
                                                                  EXIT;

                                                                GLSetup.GetRecordOnce;
                                                                CASE GLSetup."Bill-to/Sell-to VAT Calc." OF
                                                                  GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No.":
                                                                    IF NOT Customer.GET("Bill-to Customer No.") THEN
                                                                      EXIT;
                                                                  GLSetup."Bill-to/Sell-to VAT Calc."::"Sell-to/Buy-from No.":
                                                                    IF NOT Customer.GET("Sell-to Customer No.") THEN
                                                                      EXIT;
                                                                END;

                                                                IF "VAT Registration No." = Customer."VAT Registration No." THEN
                                                                  EXIT;

                                                                IF NOT VATRegistrationNoFormat.Test("VAT Registration No.",Customer."Country/Region Code",Customer."No.",DATABASE::Customer) THEN
                                                                  EXIT;

                                                                Customer."VAT Registration No." := "VAT Registration No.";
                                                                ApplicableCountryCode := Customer."Country/Region Code";
                                                                IF ApplicableCountryCode = '' THEN
                                                                  ApplicableCountryCode := VATRegistrationNoFormat."Country/Region Code";

                                                                IF NOT VATRegNoSrvConfig.VATRegNoSrvIsEnabled THEN BEGIN
                                                                  Customer.MODIFY(TRUE);
                                                                  EXIT;
                                                                END;

                                                                VATRegistrationLogMgt.CheckVIESForVATNo(ResultRecRef,VATRegistrationLog,Customer,Customer."No.",
                                                                  ApplicableCountryCode,VATRegistrationLog."Account Type"::Customer);

                                                                IF VATRegistrationLog.Status = VATRegistrationLog.Status::Valid THEN BEGIN
                                                                  MESSAGE(ValidVATNoMsg);
                                                                  Customer.MODIFY(TRUE);
                                                                END ELSE
                                                                  MESSAGE(InvalidVatRegNoMsg);
                                                              END;

                                                   CaptionML=[ENU=VAT Registration No.;
                                                              NOR=Organisasjonsnr.;
                                                              SVE=Momsregistreringsnr] }
    { 71  ;   ;Combine Shipments   ;Boolean       ;CaptionML=[ENU=Combine Shipments;
                                                              NOR=Opprett samlefaktura;
                                                              SVE=Samlingsfakturering] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              NOR=rsaksspor;
                                                              SVE=Uppf”ljningskod] }
    { 74  ;   ;Gen. Bus. Posting Group;Code20     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN BEGIN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGrp."Def. VAT Bus. Posting Group";
                                                                  RecreateSalesLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokf›ringsgruppe - firma;
                                                              SVE=Gen. r”relsebokf”ringsmall] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              NOR=Trekanthandel;
                                                              SVE=EU trepartshandel] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLinesByFieldNo(FIELDNO("Transaction Type"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart;
                                                              SVE=EU transaktionstyp] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLinesByFieldNo(FIELDNO("Transport Method"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=Transportm†te;
                                                              SVE=Transports„tt] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=VAT Country/Region Code;
                                                              NOR=Lands-/omr†dekode for mva;
                                                              SVE=Momskod f”r land/region] }
    { 79  ;   ;Sell-to Customer Name;Text100      ;TableRelation=Customer;
                                                   OnValidate=VAR
                                                                Customer@1000 : Record 18;
                                                                IdentityManagement@1001 : Codeunit 9801;
                                                              BEGIN
                                                                IF NOT IdentityManagement.IsInvAppId AND ShouldLookForCustomerByName("Sell-to Customer No.") THEN
                                                                  VALIDATE("Sell-to Customer No.",Customer.GetCustNo("Sell-to Customer Name"));
                                                                GetShippingTime(FIELDNO("Sell-to Customer Name"));
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Sell-to Customer Name;
                                                              NOR=Salg til-kundenavn;
                                                              SVE=F”rs.kundnamn] }
    { 80  ;   ;Sell-to Customer Name 2;Text50     ;CaptionML=[ENU=Sell-to Customer Name 2;
                                                              NOR=Salg til-kundenavn 2;
                                                              SVE=F”rs.kundnamn 2] }
    { 81  ;   ;Sell-to Address     ;Text100       ;OnValidate=BEGIN
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to Address"));
                                                                ModifyCustomerAddress;
                                                              END;

                                                   CaptionML=[ENU=Sell-to Address;
                                                              NOR=Salg til-adresse;
                                                              SVE=F”rs.adress] }
    { 82  ;   ;Sell-to Address 2   ;Text50        ;OnValidate=BEGIN
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to Address 2"));
                                                                ModifyCustomerAddress;
                                                              END;

                                                   CaptionML=[ENU=Sell-to Address 2;
                                                              NOR=Salg til-adresse 2;
                                                              SVE=F”rs.adress 2] }
    { 83  ;   ;Sell-to City        ;Text30        ;TableRelation=IF (Sell-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Sell-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Sell-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to City"));
                                                                ModifyCustomerAddress;
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to City;
                                                              NOR=Salg til-sted;
                                                              SVE=F”rs.ort] }
    { 84  ;   ;Sell-to Contact     ;Text100       ;OnValidate=BEGIN
                                                                ModifyCustomerAddress;
                                                              END;

                                                   OnLookup=VAR
                                                              Contact@1001 : Record 5050;
                                                            BEGIN
                                                              IF "Document Type" <> "Document Type"::Quote THEN
                                                                IF "Sell-to Customer No." = '' THEN
                                                                  EXIT;

                                                              LookupContact("Sell-to Customer No.","Sell-to Contact No.",Contact);
                                                              IF PAGE.RUNMODAL(0,Contact) = ACTION::LookupOK THEN
                                                                VALIDATE("Sell-to Contact No.",Contact."No.");
                                                            END;

                                                   CaptionML=[ENU=Sell-to Contact;
                                                              NOR=Salg til-kontakt;
                                                              SVE=F”rs.kontakt] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                ModifyBillToCustomerAddress;
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Bill-to Post Code;
                                                              NOR=Faktura til-postnr.;
                                                              SVE=Faktureras postnr] }
    { 86  ;   ;Bill-to County      ;Text30        ;OnValidate=BEGIN
                                                                ModifyBillToCustomerAddress;
                                                              END;

                                                   CaptionML=[ENU=Bill-to County;
                                                              NOR=Faktura til-fylke/delstat;
                                                              SVE=Faktureras delstat];
                                                   CaptionClass='5,1,' + "Bill-to Country/Region Code" }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                ModifyBillToCustomerAddress;
                                                              END;

                                                   CaptionML=[ENU=Bill-to Country/Region Code;
                                                              NOR=Lands-/omr†dekode for Faktura til;
                                                              SVE=Faktureringsland/-region] }
    { 88  ;   ;Sell-to Post Code   ;Code20        ;TableRelation=IF (Sell-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Sell-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Sell-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to Post Code"));
                                                                ModifyCustomerAddress;
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to Post Code;
                                                              NOR=Salg til-postnr.;
                                                              SVE=F”rs.postnrkod] }
    { 89  ;   ;Sell-to County      ;Text30        ;OnValidate=BEGIN
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to County"));
                                                                ModifyCustomerAddress;
                                                              END;

                                                   CaptionML=[ENU=Sell-to County;
                                                              NOR=Salg til-fylke/delstat;
                                                              SVE=F”rs.delstat];
                                                   CaptionClass='5,1,' + "Sell-to Country/Region Code" }
    { 90  ;   ;Sell-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                UpdateShipToAddressFromSellToAddress(FIELDNO("Ship-to Country/Region Code"));
                                                                ModifyCustomerAddress;
                                                                VALIDATE("Ship-to Country/Region Code");
                                                              END;

                                                   CaptionML=[ENU=Sell-to Country/Region Code;
                                                              NOR=Lands-/omr†dekode for Salg til;
                                                              SVE=F”rs.land/-region] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode("Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to Post Code;
                                                              NOR=Lever til-postnr.;
                                                              SVE=Leveranspostnrkod] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[ENU=Ship-to County;
                                                              NOR=Lever til-fylke/delstat;
                                                              SVE=Leveransdelstat];
                                                   CaptionClass='5,1,' + "Ship-to Country/Region Code" }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                UpdateCountryOfDestination; //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              NOR=Lands-/omr†dekode for Lever til;
                                                              SVE=Kod f”r leveransland/-region] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              NOR=Motkontotype;
                                                              SVE=Motkontotyp];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    NOR=Finanskonto,Bankkonto;
                                                                    SVE=Redov.konto,Bankkonto];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLinesByFieldNo(FIELDNO("Exit Point"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Exit Point;
                                                              NOR=Utpunkt;
                                                              SVE=Utf”rselplats] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              NOR=Korreksjon;
                                                              SVE=R„ttningstransaktion] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                IF xRec."Document Date" <> "Document Date" THEN
                                                                  UpdateDocumentDate := TRUE;
                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");

                                                                IF UpdateDocumentDate AND ("Document Type" = "Document Type"::Quote) AND ("Document Date" <> 0D) THEN
                                                                  CalcQuoteValidUntilDate;

                                                                //**4PS.sn
                                                                VALIDATE("Credit Restriction");
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum] }
    { 100 ;   ;External Document No.;Code35       ;CaptionML=[ENU=External Document No.;
                                                              NOR=Eksterndokumentnr.;
                                                              SVE=Externt dokumentnr] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdateSalesLinesByFieldNo(FIELDNO(Area),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Area;
                                                              NOR=Omr†de;
                                                              SVE=Omr†de] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLinesByFieldNo(FIELDNO("Transaction Specification"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon;
                                                              SVE=EU transaktionsspecifikation] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=VAR
                                                                SEPADirectDebitMandate@1000 : Record 1230;
                                                              BEGIN
                                                                PaymentMethod.INIT;
                                                                IF "Payment Method Code" <> '' THEN
                                                                  PaymentMethod.GET("Payment Method Code");
                                                                IF PaymentMethod."Direct Debit" THEN BEGIN
                                                                  "Direct Debit Mandate ID" := SEPADirectDebitMandate.GetDefaultMandate("Bill-to Customer No.","Due Date");
                                                                  IF "Payment Terms Code" = '' THEN
                                                                    "Payment Terms Code" := PaymentMethod."Direct Debit Pmt. Terms Code";
                                                                END ELSE
                                                                  "Direct Debit Mandate ID" := '';
                                                                "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                "Bal. Account No." := PaymentMethod."Bal. Account No.";
                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                  CLEAR("Payment Service Set ID");
                                                                END;
                                                                "Payment Channel" := PaymentMethod."Payment Channel";  //NAVDK
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              NOR=Betalingsm†te - kode;
                                                              SVE=Betalningss„tt] }
    { 105 ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF xRec."Shipping Agent Code" = "Shipping Agent Code" THEN
                                                                  EXIT;

                                                                "Shipping Agent Service Code" := '';
                                                                GetShippingTime(FIELDNO("Shipping Agent Code"));

                                                                OnValidateShippingAgentCodeOnBeforeUpdateLines(Rec,CurrFieldNo,HideValidationDialog);
                                                                UpdateSalesLinesByFieldNo(FIELDNO("Shipping Agent Code"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              NOR=Transport›rkode;
                                                              SVE=Spedit”rkod] }
    { 106 ;   ;Package Tracking No.;Text30        ;CaptionML=[ENU=Package Tracking No.;
                                                              NOR=Pakkesporingsnr.;
                                                              SVE=Godsupplysningsnr] }
    { 107 ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code20        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  GetSalesSetup;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                GetSalesSetup;
                                                                TestNoSeries;
                                                                IF NoSeriesMgt.LookupSeries(GetPostingNoSeriesCode,"Posting No. Series") THEN
                                                                  VALIDATE("Posting No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Posting No. Series;
                                                              NOR=Bokf›ringsnr.serie;
                                                              SVE=Bokf”ringsnr-serie] }
    { 109 ;   ;Shipping No. Series ;Code20        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Shipping No. Series" <> '' THEN BEGIN
                                                                  GetSalesSetup;
                                                                  SalesSetup.TESTFIELD("Posted Shipment Nos.");
                                                                  NoSeriesMgt.TestSeries(SalesSetup."Posted Shipment Nos.","Shipping No. Series");
                                                                END;
                                                                TESTFIELD("Shipping No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                GetSalesSetup;
                                                                SalesSetup.TESTFIELD("Posted Shipment Nos.");
                                                                IF NoSeriesMgt.LookupSeries(SalesSetup."Posted Shipment Nos.","Shipping No. Series") THEN
                                                                  VALIDATE("Shipping No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Shipping No. Series;
                                                              NOR=F›lgeseddelnr.serie;
                                                              SVE=Leverans nr-serie] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                ValidateTaxAreaCode;
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Tax Area Code"));
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Tax Area Code;
                                                              NOR=Mva-omr†dekode;
                                                              SVE=Skatteomr†deskod] }
    { 115 ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Tax Liable"));
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              NOR=Skyldig mva.;
                                                              SVE=Skattepliktig] }
    { 116 ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group" THEN
                                                                  RecreateSalesLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - firma;
                                                              SVE=Moms r”relsebokf”ringsmall] }
    { 117 ;   ;Reserve             ;Option        ;InitValue=Optional;
                                                   AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Reserve;
                                                              NOR=Reserver;
                                                              SVE=Reservera];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    NOR=Aldri,Alternativt,Alltid;
                                                                    SVE=Aldrig,Valfri,Alltid];
                                                   OptionString=Never,Optional,Always }
    { 118 ;   ;Applies-to ID       ;Code50        ;OnValidate=VAR
                                                                TempCustLedgEntry@1000 : TEMPORARY Record 21;
                                                                CustEntrySetApplID@1001 : Codeunit 101;
                                                              BEGIN
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.",Open);
                                                                  CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  CustLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF CustLedgEntry.FINDFIRST THEN
                                                                    CustEntrySetApplID.SetApplId(CustLedgEntry,TempCustLedgEntry,'');
                                                                  CustLedgEntry.RESET;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              NOR=Utlignings-ID;
                                                              SVE=Koppla till ID] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TestStatusOpen;
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN
                                                                  ERROR(
                                                                    Text007,
                                                                    FIELDCAPTION("VAT Base Discount %"),
                                                                    GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                    GLSetup.TABLECAPTION);

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                SalesLine.SETRANGE("Document Type","Document Type");
                                                                SalesLine.SETRANGE("Document No.","No.");
                                                                SalesLine.SETFILTER(Type,'<>%1',SalesLine.Type::" ");
                                                                SalesLine.SETFILTER(Quantity,'<>0');
                                                                SalesLine.LOCKTABLE;
                                                                LOCKTABLE;
                                                                IF SalesLine.FINDSET THEN BEGIN
                                                                  //MODIFY; //**4PS.o
                                                                  MODIFY(TRUE); //**4PS.n
                                                                  REPEAT
                                                                    IF (SalesLine."Quantity Invoiced" <> SalesLine.Quantity) OR
                                                                       ("Shipping Advice" <> "Shipping Advice"::Partial) OR
                                                                       (SalesLine.Type <> SalesLine.Type::"Charge (Item)") OR
                                                                       (CurrFieldNo <> 0)
                                                                    THEN BEGIN
                                                                      SalesLine.UpdateAmounts;
                                                                      SalesLine.MODIFY;
                                                                    END;
                                                                  UNTIL SalesLine.NEXT = 0;
                                                                END;
                                                                SalesLine.RESET;
                                                              END;

                                                   CaptionML=[ENU=VAT Base Discount %;
                                                              NOR=Mva-gr.lagsrabatt-%;
                                                              SVE=Nettobelopprabatt %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[ENU=Open,Released,Pending Approval,Pending Prepayment,,,,,Closed;
                                                                    NOR=pen,Frigitt,Venter p† godkjenning,Venter p† forskudd;
                                                                    SVE=™ppen,Sl„ppt,V„ntar p† godk„nnande,V„ntar p† f”rskottsbetalning,,,,,St„ngd];
                                                   OptionString=Open,Released,Pending Approval,Pending Prepayment,,,,,Closed;
                                                   Editable=No }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              NOR=Fakturarabattberegning;
                                                              SVE=Fakturarabattber„kning];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    NOR=Ingen,%,Bel›p;
                                                                    SVE=Ingen,%,Belopp];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              NOR=Fakturarabattverdi;
                                                              SVE=Fakturarabattv„rde];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 123 ;   ;Send IC Document    ;Boolean       ;OnValidate=BEGIN
                                                                IF "Send IC Document" THEN BEGIN
                                                                  IF "Bill-to IC Partner Code" = '' THEN
                                                                    TESTFIELD("Sell-to IC Partner Code");
                                                                  TESTFIELD("IC Direction","IC Direction"::Outgoing);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Send IC Document;
                                                              NOR=Send KI-dokument;
                                                              SVE=Skicka konc.int. dokument] }
    { 124 ;   ;IC Status           ;Option        ;CaptionML=[ENU=IC Status;
                                                              NOR=KI-status;
                                                              SVE=Konc.int. status];
                                                   OptionCaptionML=[ENU=New,Pending,Sent;
                                                                    NOR=Ny,I k›,Sendt;
                                                                    SVE=Ny,V„ntar,Skickad];
                                                   OptionString=New,Pending,Sent }
    { 125 ;   ;Sell-to IC Partner Code;Code20     ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=Sell-to IC Partner Code;
                                                              NOR=KI-partnerkode for Salg til;
                                                              SVE=Konc.int. partnerkod f”r f”rs.];
                                                   Editable=No }
    { 126 ;   ;Bill-to IC Partner Code;Code20     ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=Bill-to IC Partner Code;
                                                              NOR=KI-partnerkode for Faktura til;
                                                              SVE=Konc.int. partnerkod f”r fakt.];
                                                   Editable=No }
    { 129 ;   ;IC Direction        ;Option        ;OnValidate=BEGIN
                                                                IF "IC Direction" = "IC Direction"::Incoming THEN
                                                                  "Send IC Document" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=IC Direction;
                                                              NOR=KI-retning;
                                                              SVE=Konc.int. riktning];
                                                   OptionCaptionML=[ENU=Outgoing,Incoming;
                                                                    NOR=Utg†ende,Inng†ende;
                                                                    SVE=Utg†ende,Ing†ende];
                                                   OptionString=Outgoing,Incoming }
    { 130 ;   ;Prepayment %        ;Decimal       ;OnValidate=BEGIN
                                                                IF xRec."Prepayment %" <> "Prepayment %" THEN
                                                                  UpdateSalesLinesByFieldNo(FIELDNO("Prepayment %"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Prepayment %;
                                                              NOR=Forskuddsprosent;
                                                              SVE=F”rskottsbetalning %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 131 ;   ;Prepayment No. Series;Code20       ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepayment No. Series" <> '' THEN BEGIN
                                                                  GetSalesSetup;
                                                                  SalesSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series");
                                                                END;
                                                                TESTFIELD("Prepayment No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                GetSalesSetup;
                                                                SalesSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series") THEN
                                                                  VALIDATE("Prepayment No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepayment No. Series;
                                                              NOR=Nummerserie for forskudd;
                                                              SVE=Nummerserie f”r f”rskottsbet.] }
    { 132 ;   ;Compress Prepayment ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Compress Prepayment;
                                                              NOR=Komprimer forskudd;
                                                              SVE=Komprimera f”rskottsbetalning] }
    { 133 ;   ;Prepayment Due Date ;Date          ;CaptionML=[ENU=Prepayment Due Date;
                                                              NOR=Forfallsdato for forskudd;
                                                              SVE=F”rfallodatum f”r f”rskottsbet.] }
    { 134 ;   ;Prepmt. Cr. Memo No. Series;Code20 ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                  GetSalesSetup;
                                                                  SalesSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series");
                                                                END;
                                                                TESTFIELD("Prepmt. Cr. Memo No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                GetSalesSetup;
                                                                SalesSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series") THEN
                                                                  VALIDATE("Prepmt. Cr. Memo No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepmt. Cr. Memo No. Series;
                                                              NOR=Nummerserie for kreditnota for forskudd;
                                                              SVE=Nr-serie f”r kreditnota f”r f”rbet.] }
    { 135 ;   ;Prepmt. Posting Description;Text100;CaptionML=[ENU=Prepmt. Posting Description;
                                                              NOR=Beskrivelse av bokf›ring av forskudd;
                                                              SVE=F”rskottsbet: bokf”ringsbeskr.] }
    { 138 ;   ;Prepmt. Pmt. Discount Date;Date    ;CaptionML=[ENU=Prepmt. Pmt. Discount Date;
                                                              NOR=Rabattdato for betaling for forskudd;
                                                              SVE=Betalningsrabattdatum f”r f”rskottsbetalning] }
    { 139 ;   ;Prepmt. Payment Terms Code;Code10  ;TableRelation="Payment Terms";
                                                   OnValidate=VAR
                                                                PaymentTerms@1000 : Record 3;
                                                                IsHandled@1001 : Boolean;
                                                              BEGIN
                                                                IF ("Prepmt. Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Prepmt. Payment Terms Code");
                                                                  IF IsCreditDocType AND NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN BEGIN
                                                                    VALIDATE("Prepayment Due Date","Document Date");
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    IsHandled := FALSE;
                                                                    OnValidatePaymentTermsCodeOnBeforeCalcDueDate(Rec,xRec,FIELDNO("Prepmt. Payment Terms Code"),CurrFieldNo,IsHandled);
                                                                    IF NOT IsHandled THEN
                                                                      "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    IsHandled := FALSE;
                                                                    OnValidatePaymentTermsCodeOnBeforeCalcPmtDiscDate(Rec,xRec,FIELDNO("Prepmt. Payment Terms Code"),CurrFieldNo,IsHandled);
                                                                    IF NOT IsHandled THEN
                                                                      "Prepmt. Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Prepmt. Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Prepayment Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Terms Code;
                                                              NOR=Kode for betalingsbetingelser for forskudd;
                                                              SVE=Betalningsvillkorskod f”r f”rskottsbetalning] }
    { 140 ;   ;Prepmt. Payment Discount %;Decimal ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TestStatusOpen;
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Discount %;
                                                              NOR=Rabattprosent for betaling for forskudd;
                                                              SVE=Kassarabatter i % f”r f”rskottsbetalning];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 151 ;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              NOR=Tilbudsnr.;
                                                              SVE=Offertnr];
                                                   Editable=No }
    { 152 ;   ;Quote Valid Until Date;Date        ;CaptionML=[ENU=Quote Valid To Date;
                                                              NOR=Gyldig til-dato for tilbud] }
    { 153 ;   ;Quote Sent to Customer;DateTime    ;CaptionML=[ENU=Quote Sent to Customer;
                                                              NOR=Tilbud sendt til kunder];
                                                   Editable=No }
    { 154 ;   ;Quote Accepted      ;Boolean       ;OnValidate=BEGIN
                                                                IF "Quote Accepted" THEN BEGIN
                                                                  "Quote Accepted Date" := WORKDATE;
                                                                  OnAfterSalesQuoteAccepted(Rec);
                                                                END ELSE
                                                                  "Quote Accepted Date" := 0D;
                                                              END;

                                                   CaptionML=[ENU=Quote Accepted;
                                                              NOR=Tilbud akseptert;
                                                              SVE=Offert accepterad] }
    { 155 ;   ;Quote Accepted Date ;Date          ;CaptionML=[ENU=Quote Accepted Date;
                                                              NOR=Dato for tilbud akseptert];
                                                   Editable=No }
    { 160 ;   ;Job Queue Status    ;Option        ;OnLookup=VAR
                                                              JobQueueEntry@1000 : Record 472;
                                                            BEGIN
                                                              IF "Job Queue Status" = "Job Queue Status"::" " THEN
                                                                EXIT;
                                                              JobQueueEntry.ShowStatusMsg("Job Queue Entry ID");
                                                            END;

                                                   CaptionML=[ENU=Job Queue Status;
                                                              NOR=Jobbk›status;
                                                              SVE=Status f”r jobbk”];
                                                   OptionCaptionML=[ENU=" ,Scheduled for Posting,Error,Posting";
                                                                    NOR=" ,Planlagt for bokf›ring,Feil,Bokf›ring";
                                                                    SVE=" ,Planerat f”r bokf”ring,Fel,Bokf”ring"];
                                                   OptionString=[ ,Scheduled for Posting,Error,Posting];
                                                   Editable=No }
    { 161 ;   ;Job Queue Entry ID  ;GUID          ;CaptionML=[ENU=Job Queue Entry ID;
                                                              NOR=Post-ID for jobbk›;
                                                              SVE=Transaktions-ID f”r jobbk”];
                                                   Editable=No }
    { 165 ;   ;Incoming Document Entry No.;Integer;TableRelation="Incoming Document";
                                                   OnValidate=VAR
                                                                IncomingDocument@1000 : Record 130;
                                                              BEGIN
                                                                IF "Incoming Document Entry No." = xRec."Incoming Document Entry No." THEN
                                                                  EXIT;
                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  IncomingDocument.RemoveReferenceToWorkingDocument(xRec."Incoming Document Entry No.")
                                                                ELSE
                                                                  IncomingDocument.SetSalesDoc(Rec);
                                                              END;

                                                   CaptionML=[ENU=Incoming Document Entry No.;
                                                              NOR=L›penummer for inng†ende dokument;
                                                              SVE=L”pnr f”r inkommande dokument] }
    { 166 ;   ;Last Email Sent Time;DateTime      ;FieldClass=FlowField;
                                                   CalcFormula=Max("O365 Document Sent History"."Created Date-Time" WHERE (Document Type=FIELD(Document Type),
                                                                                                                           Document No.=FIELD(No.),
                                                                                                                           Posted=CONST(No)));
                                                   CaptionML=[ENU=Last Email Sent Time;
                                                              NOR=Klokkeslett for sending av siste e-post] }
    { 167 ;   ;Last Email Sent Status;Option      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("O365 Document Sent History"."Job Last Status" WHERE (Document Type=FIELD(Document Type),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Posted=CONST(No),
                                                                                                                            Created Date-Time=FIELD(Last Email Sent Time)));
                                                   CaptionML=[ENU=Last Email Sent Status;
                                                              NOR=Status for sending av siste e-post];
                                                   OptionCaptionML=[ENU=Not Sent,In Process,Finished,Error;
                                                                    NOR=Ikke sendt,I gang,Ferdig,Feil];
                                                   OptionString=Not Sent,In Process,Finished,Error }
    { 168 ;   ;Sent as Email       ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("O365 Document Sent History" WHERE (Document Type=FIELD(Document Type),
                                                                                                         Document No.=FIELD(No.),
                                                                                                         Posted=CONST(No),
                                                                                                         Job Last Status=CONST(Finished)));
                                                   CaptionML=[ENU=Sent as Email;
                                                              NOR=Sendt som e-post] }
    { 169 ;   ;Last Email Notif Cleared;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("O365 Document Sent History".NotificationCleared WHERE (Document Type=FIELD(Document Type),
                                                                                                                              Document No.=FIELD(No.),
                                                                                                                              Posted=CONST(No),
                                                                                                                              Created Date-Time=FIELD(Last Email Sent Time)));
                                                   CaptionML=[ENU=Last Email Notif Cleared;
                                                              NOR=Varsling om siste e-post fjernet] }
    { 170 ;   ;IsTest              ;Boolean       ;CaptionML=[ENU=IsTest;
                                                              NOR=IsTest];
                                                   Editable=No }
    { 171 ;   ;Sell-to Phone No.   ;Text30        ;OnValidate=VAR
                                                                Char@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Char";
                                                                i@1001 : Integer;
                                                              BEGIN
                                                                FOR i := 1 TO STRLEN("Sell-to Phone No.") DO
                                                                  IF Char.IsLetter("Sell-to Phone No."[i]) THEN
                                                                    ERROR(PhoneNoCannotContainLettersErr);
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Sell-to Phone No.;
                                                              NOR=Salg til-telefonnr.] }
    { 172 ;   ;Sell-to E-Mail      ;Text80        ;OnValidate=VAR
                                                                MailManagement@1000 : Codeunit 9520;
                                                              BEGIN
                                                                MailManagement.ValidateEmailAddressField("Sell-to E-Mail");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 175 ;   ;Payment Instructions Id;Integer    ;TableRelation="O365 Payment Instructions";
                                                   CaptionML=[ENU=Payment Instructions Id;
                                                              NOR=ID for betalingsinstruksjoner] }
    { 200 ;   ;Work Description    ;BLOB          ;CaptionML=[ENU=Work Description;
                                                              NOR=Arbeidsbeskrivelse;
                                                              SVE=Arbetsbeskrivning] }
    { 300 ;   ;Amt. Ship. Not Inv. (LCY);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Shipped Not Invoiced (LCY)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                    Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount Shipped Not Invoiced (LCY) Incl. VAT;
                                                              NOR=Bel›p levert, ikke fakturert (NOK), inkl. mva.];
                                                   Editable=No }
    { 301 ;   ;Amt. Ship. Not Inv. (LCY) Base;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Shipped Not Inv. (LCY) No VAT" WHERE (Document Type=FIELD(Document Type),
                                                                                                                       Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount Shipped Not Invoiced (LCY);
                                                              NOR=Bel›p levert, ikke fakturert (NOK)];
                                                   Editable=No }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnValidate=BEGIN
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID;
                                                              SVE=Dimensionsupps„ttnings-ID];
                                                   Editable=No }
    { 600 ;   ;Payment Service Set ID;Integer     ;CaptionML=[ENU=Payment Service Set ID;
                                                              NOR=Postsett-ID for betalingstjeneste;
                                                              SVE=Upps„ttnings-ID f”r betalningstj„nst] }
    { 1200;   ;Direct Debit Mandate ID;Code35     ;TableRelation="SEPA Direct Debit Mandate" WHERE (Customer No.=FIELD(Bill-to Customer No.),
                                                                                                    Closed=CONST(No),
                                                                                                    Blocked=CONST(No));
                                                   CaptionML=[ENU=Direct Debit Mandate ID;
                                                              NOR=ID for Direct Debit-belastningsfullmakt;
                                                              SVE=Medgivande-ID f”r autogiro] }
    { 1305;   ;Invoice Discount Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Inv. Discount Amount" WHERE (Document No.=FIELD(No.),
                                                                                                              Document Type=FIELD(Document Type)));
                                                   CaptionML=[ENU=Invoice Discount Amount;
                                                              NOR=Fakturarabattbel›p;
                                                              SVE=Fakturarabatt];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5043;   ;No. of Archived Versions;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Max("Sales Header Archive"."Version No." WHERE (Document Type=FIELD(Document Type),
                                                                                                               No.=FIELD(No.),
                                                                                                               Doc. No. Occurrence=FIELD(Doc. No. Occurrence)));
                                                   CaptionML=[ENU=No. of Archived Versions;
                                                              NOR=Ant. arkiverte versjoner;
                                                              SVE=Ant. arkiverade versioner];
                                                   Editable=No }
    { 5048;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[ENU=Doc. No. Occurrence;
                                                              NOR=Forekomst av bilagsnr.;
                                                              SVE=Dok.nr f”rekomst] }
    { 5050;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=BEGIN
                                                                //**4PS.sn
                                                                IF (NOT DimMgt.HasDefaultDim(DATABASE::Campaign,"Campaign No.")) AND
                                                                   (NOT DimMgt.HasDefaultDim(DATABASE::Campaign,xRec."Campaign No."))
                                                                THEN
                                                                  EXIT;
                                                                //**4PS.en

                                                                CreateDim(
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Job,"Job No.", //**4PS.n
                                                                  DATABASE::"Service Order","Service Order No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Service-Contract","Service Contract No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                                  //DATABASE::Location,"Location Code");  //**4PS.n  //*C007227.o
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              NOR=Kampanjenr.;
                                                              SVE=Kampanjnr] }
    { 5051;   ;Sell-to Customer Template Code;Code10;
                                                   TableRelation="Customer Template";
                                                   OnValidate=VAR
                                                                SellToCustTemplate@1000 : Record 5105;
                                                              BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Quote);
                                                                TestStatusOpen;

                                                                IF NOT InsertMode AND
                                                                   ("Sell-to Customer Template Code" <> xRec."Sell-to Customer Template Code") AND
                                                                   (xRec."Sell-to Customer Template Code" <> '')
                                                                THEN BEGIN
                                                                  IF GetHideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,FIELDCAPTION("Sell-to Customer Template Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF InitFromTemplate("Sell-to Customer Template Code",FIELDCAPTION("Sell-to Customer Template Code")) THEN
                                                                      EXIT
                                                                  END ELSE BEGIN
                                                                    "Sell-to Customer Template Code" := xRec."Sell-to Customer Template Code";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF SellToCustTemplate.GET("Sell-to Customer Template Code") THEN
                                                                  CopyFromSellToCustTemplate(SellToCustTemplate);

                                                                IF NOT InsertMode AND
                                                                   ((xRec."Sell-to Customer Template Code" <> "Sell-to Customer Template Code") OR
                                                                    (xRec."Currency Code" <> "Currency Code"))
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Sell-to Customer Template Code"));
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer Template Code;
                                                              NOR=Salg til-kunde - malkode;
                                                              SVE=F”rs.kundmallkod] }
    { 5052;   ;Sell-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                                Opportunity@1000 : Record 5092;
                                                              BEGIN
                                                                TestStatusOpen;

                                                                IF "Sell-to Contact No." <> '' THEN
                                                                  IF Cont.GET("Sell-to Contact No.") THEN
                                                                    Cont.CheckIfPrivacyBlockedGeneric;

                                                                IF ("Sell-to Contact No." <> xRec."Sell-to Contact No.") AND
                                                                   (xRec."Sell-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Sell-to Contact No." = '') AND ("Opportunity No." <> '') THEN
                                                                    ERROR(Text049,FIELDCAPTION("Sell-to Contact No."));
                                                                  IF GetHideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,FIELDCAPTION("Sell-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF InitFromContact("Sell-to Contact No.","Sell-to Customer No.",FIELDCAPTION("Sell-to Contact No.")) THEN
                                                                      EXIT;
                                                                    IF "Opportunity No." <> '' THEN BEGIN
                                                                      Opportunity.GET("Opportunity No.");
                                                                      IF Opportunity."Contact No." <> "Sell-to Contact No." THEN BEGIN
                                                                        MODIFY;
                                                                        Opportunity.VALIDATE("Contact No.","Sell-to Contact No.");
                                                                        Opportunity.MODIFY;
                                                                      END
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Sell-to Customer No." <> '') AND ("Sell-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Sell-to Contact No.");
                                                                  IF ContBusinessRelation.FindByRelation(ContBusinessRelation."Link to Table"::Customer,"Sell-to Customer No.") THEN
                                                                    IF (ContBusinessRelation."Contact No." <> Cont."Company No.") AND (ContBusinessRelation."Contact No." <> Cont."No.") THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Sell-to Customer No.");
                                                                END;

                                                                IF "Sell-to Contact No." <> '' THEN
                                                                  IF Cont.GET("Sell-to Contact No.") THEN
                                                                    IF ("Salesperson Code" = '') AND (Cont."Salesperson Code" <> '') THEN
                                                                      VALIDATE("Salesperson Code",Cont."Salesperson Code");

                                                                UpdateSellToCust("Sell-to Contact No.");
                                                                UpdateSellToCustTemplateCode;
                                                                UpdateShipToContact;
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Sell-to Customer No." <> '' THEN
                                                                IF Cont.GET("Sell-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE
                                                                  IF ContBusinessRelation.FindByRelation(ContBusinessRelation."Link to Table"::Customer,"Sell-to Customer No.") THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');

                                                              IF "Sell-to Contact No." <> '' THEN
                                                                IF Cont.GET("Sell-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Sell-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Sell-to Contact No.;
                                                              NOR=Salg til-kontaktnr.;
                                                              SVE=F”rs.kontaktnr] }
    { 5053;   ;Bill-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                                IsHandled@1000 : Boolean;
                                                              BEGIN
                                                                TestStatusOpen;

                                                                IF "Bill-to Contact No." <> '' THEN
                                                                  IF Cont.GET("Bill-to Contact No.") THEN
                                                                    Cont.CheckIfPrivacyBlockedGeneric;

                                                                IF ("Bill-to Contact No." <> xRec."Bill-to Contact No.") AND
                                                                   (xRec."Bill-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IsHandled := FALSE;
                                                                  OnBeforeConfirmBillToContactNoChange(Rec,xRec,CurrFieldNo,Confirmed,IsHandled);
                                                                  IF NOT IsHandled THEN
                                                                    IF GetHideValidationDialog OR (NOT GUIALLOWED) THEN
                                                                      Confirmed := TRUE
                                                                    ELSE
                                                                      Confirmed := CONFIRM(ConfirmChangeQst,FALSE,FIELDCAPTION("Bill-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF InitFromContact("Bill-to Contact No.","Bill-to Customer No.",FIELDCAPTION("Bill-to Contact No.")) THEN
                                                                      EXIT;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Contact No." := xRec."Bill-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Bill-to Customer No." <> '') AND ("Bill-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Bill-to Contact No.");
                                                                  IF ContBusinessRelation.FindByRelation(ContBusinessRelation."Link to Table"::Customer,"Bill-to Customer No.") THEN
                                                                    IF (ContBusinessRelation."Contact No." <> Cont."Company No.") AND (ContBusinessRelation."Contact No." <> Cont."No.") THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Bill-to Customer No.");
                                                                END;

                                                                UpdateBillToCust("Bill-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Bill-to Customer No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE
                                                                  IF ContBusinessRelation.FindByRelation(ContBusinessRelation."Link to Table"::Customer,"Bill-to Customer No.") THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');

                                                              IF "Bill-to Contact No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Bill-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Bill-to Contact No.;
                                                              NOR=Faktura til-kontaktnr.;
                                                              SVE=Faktureringskontaktnr] }
    { 5054;   ;Bill-to Customer Template Code;Code10;
                                                   TableRelation="Customer Template";
                                                   OnValidate=VAR
                                                                BillToCustTemplate@1001 : Record 5105;
                                                              BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Quote);
                                                                TestStatusOpen;

                                                                IF NOT InsertMode AND
                                                                   ("Bill-to Customer Template Code" <> xRec."Bill-to Customer Template Code") AND
                                                                   (xRec."Bill-to Customer Template Code" <> '')
                                                                THEN BEGIN
                                                                  IF GetHideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(ConfirmChangeQst,FALSE,FIELDCAPTION("Bill-to Customer Template Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF InitFromTemplate("Bill-to Customer Template Code",FIELDCAPTION("Bill-to Customer Template Code")) THEN
                                                                      EXIT
                                                                  END ELSE BEGIN
                                                                    "Bill-to Customer Template Code" := xRec."Bill-to Customer Template Code";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                VALIDATE("Ship-to Code",'');
                                                                IF BillToCustTemplate.GET("Bill-to Customer Template Code") THEN BEGIN
                                                                  BillToCustTemplate.TESTFIELD("Customer Posting Group");
                                                                  "Customer Posting Group" := BillToCustTemplate."Customer Posting Group";
                                                                  "Invoice Disc. Code" := BillToCustTemplate."Invoice Disc. Code";
                                                                  "Customer Price Group" := BillToCustTemplate."Customer Price Group";
                                                                  "Customer Disc. Group" := BillToCustTemplate."Customer Disc. Group";
                                                                  "Allow Line Disc." := BillToCustTemplate."Allow Line Disc.";
                                                                  VALIDATE("Payment Terms Code",BillToCustTemplate."Payment Terms Code");
                                                                  VALIDATE("Payment Method Code",BillToCustTemplate."Payment Method Code");
                                                                  "Prices Including VAT" := BillToCustTemplate."Prices Including VAT";
                                                                  "Shipment Method Code" := BillToCustTemplate."Shipment Method Code";
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Job,"Job No.", //**4PS.n
                                                                  DATABASE::"Service Order","Service Order No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Service-Contract","Service Contract No.", //**4PS.n 09-06-2010
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");
                                                                  //DATABASE::Location,"Location Code");  //**4PS.n  //*C007227.o

                                                                OnValidateBilltoCustomerTemplateCodeBeforeRecreateSalesLines(Rec,CurrFieldNo);

                                                                IF NOT InsertMode AND
                                                                  (xRec."Sell-to Customer Template Code" = "Sell-to Customer Template Code") AND
                                                                  (xRec."Bill-to Customer Template Code" <> "Bill-to Customer Template Code")
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Bill-to Customer Template Code"));
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer Template Code;
                                                              NOR=Faktura til-kundenr. - malkode;
                                                              SVE=Mallkod f”r faktureringskund] }
    { 5055;   ;Opportunity No.     ;Code20        ;TableRelation=IF (Document Type=FILTER(<>Order)) Opportunity.No. WHERE (Contact No.=FIELD(Sell-to Contact No.),
                                                                                                                           Closed=CONST(No))
                                                                                                                           ELSE IF (Document Type=CONST(Order)) Opportunity.No. WHERE (Contact No.=FIELD(Sell-to Contact No.),
                                                                                                                                                                                       Sales Document No.=FIELD(No.),
                                                                                                                                                                                       Sales Document Type=CONST(Order));
                                                   OnValidate=BEGIN
                                                                LinkSalesDocWithOpportunity(xRec."Opportunity No.");
                                                              END;

                                                   CaptionML=[ENU=Opportunity No.;
                                                              NOR=Salgsmulighetsnr.;
                                                              SVE=Aff„rsm”jlighetsnr] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF NOT UserSetupMgt.CheckRespCenter(0,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text027,
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter);

                                                                UpdateLocationCode('');

                                                                //**4PS.sn
                                                                IF (xRec."Location Code" <> '') AND ("Location Code" = '') THEN
                                                                  "Location Code" := xRec."Location Code";  //skip empty default
                                                                //**4PS.en

                                                                UpdateOutboundWhseHandlingTime;
                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Job,"Job No.", //**4PS.n
                                                                  DATABASE::"Service Order","Service Order No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Service-Contract","Service Contract No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                                  //DATABASE::Location,"Location Code");  //**4PS.n  //*C007227.o

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                //RecreateSalesLines(FIELDCAPTION("Responsibility Center"));        //**4PS.o
                                                                  MessageIfSalesLinesExist(FIELDCAPTION("Responsibility Center"));  //**4PS.n
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              NOR=Ansvarssenter;
                                                              SVE=Ansvarsenhet] }
    { 5750;   ;Shipping Advice     ;Option        ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF InventoryPickConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(Text066,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION);
                                                                IF WhseShpmntConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(Text070,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION);
                                                                WhseSourceHeader.SalesHeaderVerifyChange(Rec,xRec);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipping Advice;
                                                              NOR=Leverings›nske;
                                                              SVE=Leveranstyp];
                                                   OptionCaptionML=[ENU=Partial,Complete;
                                                                    NOR=Delvis,Fullstendig;
                                                                    SVE=Delvis,Fullst„ndig];
                                                   OptionString=Partial,Complete }
    { 5751;   ;Shipped Not Invoiced;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Qty. Shipped Not Invoiced=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipped Not Invoiced;
                                                              NOR=Levert, ikke fakturert;
                                                              SVE=Levererat ej fakturerat];
                                                   Editable=No }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Sales Line"."Completely Shipped" WHERE (Document Type=FIELD(Document Type),
                                                                                                            Document No.=FIELD(No.),
                                                                                                            Type=FILTER(<>' '),
                                                                                                            Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Completely Shipped;
                                                              NOR=Fullstendig levert;
                                                              SVE=F„rdigt levererat];
                                                   Editable=No }
    { 5753;   ;Posting from Whse. Ref.;Integer    ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Posting from Whse. Ref.;
                                                              NOR=Bokf›ring fra lagerref.;
                                                              SVE=Bokf. fr†n dist.lager ref.] }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[ENU=Location Filter;
                                                              NOR=Lokasjonsfilter;
                                                              SVE=Lagerst„llefilter] }
    { 5755;   ;Shipped             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Qty. Shipped (Base)=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipped;
                                                              NOR=Levert;
                                                              SVE=Levererat];
                                                   Editable=No }
    { 5756;   ;Last Shipment Date  ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Sales Shipment Header"."Shipment Date" WHERE (No.=FIELD(Last Shipping No.)));
                                                   CaptionML=[ENU=Last Shipment Date;
                                                              NOR=Siste leveringsdato] }
    { 5790;   ;Requested Delivery Date;Date       ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Promised Delivery Date" <> 0D THEN
                                                                  ERROR(
                                                                    Text028,
                                                                    FIELDCAPTION("Requested Delivery Date"),
                                                                    FIELDCAPTION("Promised Delivery Date"));

                                                                IF "Requested Delivery Date" <> xRec."Requested Delivery Date" THEN
                                                                  UpdateSalesLinesByFieldNo(FIELDNO("Requested Delivery Date"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Requested Delivery Date;
                                                              NOR=nsket leveringsdato;
                                                              SVE=Beg„rt leveransdatum] }
    { 5791;   ;Promised Delivery Date;Date        ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Promised Delivery Date" <> xRec."Promised Delivery Date" THEN
                                                                  UpdateSalesLinesByFieldNo(FIELDNO("Promised Delivery Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Promised Delivery Date;
                                                              NOR=Lovet leveringsdato;
                                                              SVE=Lovat leveransdatum] }
    { 5792;   ;Shipping Time       ;DateFormula   ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Shipping Time" <> xRec."Shipping Time" THEN
                                                                  UpdateSalesLinesByFieldNo(FIELDNO("Shipping Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipping Time;
                                                              NOR=Leveringstid;
                                                              SVE=Leveranstid] }
    { 5793;   ;Outbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF ("Outbound Whse. Handling Time" <> xRec."Outbound Whse. Handling Time") AND
                                                                   (xRec."Sell-to Customer No." = "Sell-to Customer No.")
                                                                THEN
                                                                  UpdateSalesLinesByFieldNo(FIELDNO("Outbound Whse. Handling Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 7320=R;
                                                   CaptionML=[ENU=Outbound Whse. Handling Time;
                                                              NOR=Utg†ende lagerh†ndteringstid;
                                                              SVE=Avg†ende lagerhanteringstid] }
    { 5794;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                GetShippingTime(FIELDNO("Shipping Agent Service Code"));
                                                                UpdateSalesLinesByFieldNo(FIELDNO("Shipping Agent Service Code"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Service Code;
                                                              NOR=Transport›rservicekode;
                                                              SVE=Spedit”r servicekod] }
    { 5795;   ;Late Order Shipping ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                                                                         Document No.=FIELD(No.),
                                                                                         Shipment Date=FIELD(Date Filter),
                                                                                         Outstanding Quantity=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Late Order Shipping;
                                                              NOR=Forsinket levering;
                                                              SVE=Sen orderleverans];
                                                   Editable=No }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter;
                                                              SVE=Datumfilter] }
    { 5800;   ;Receive             ;Boolean       ;CaptionML=[ENU=Receive;
                                                              NOR=Motta;
                                                              SVE=Inleverera] }
    { 5801;   ;Return Receipt No.  ;Code20        ;CaptionML=[ENU=Return Receipt No.;
                                                              NOR=Returseddelnr.;
                                                              SVE=Returinleveransnr] }
    { 5802;   ;Return Receipt No. Series;Code20   ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Return Receipt No. Series" <> '' THEN BEGIN
                                                                  GetSalesSetup;
                                                                  SalesSetup.TESTFIELD("Posted Return Receipt Nos.");
                                                                  NoSeriesMgt.TestSeries(SalesSetup."Posted Return Receipt Nos.","Return Receipt No. Series");
                                                                END;
                                                                TESTFIELD("Return Receipt No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                GetSalesSetup;
                                                                SalesSetup.TESTFIELD("Posted Return Receipt Nos.");
                                                                IF NoSeriesMgt.LookupSeries(SalesSetup."Posted Return Receipt Nos.","Return Receipt No. Series") THEN
                                                                  VALIDATE("Return Receipt No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Return Receipt No. Series;
                                                              NOR=Returseddel - nr.serie;
                                                              SVE=Returinleverans nr-serie] }
    { 5803;   ;Last Return Receipt No.;Code20     ;TableRelation="Return Receipt Header";
                                                   CaptionML=[ENU=Last Return Receipt No.;
                                                              NOR=Siste returseddelnr.;
                                                              SVE=Senaste returinleveransnr];
                                                   Editable=No }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Allow Line Disc."));
                                                              END;

                                                   CaptionML=[ENU=Allow Line Disc.;
                                                              NOR=Tillat linjerabatt;
                                                              SVE=Till†t radrabatt] }
    { 7200;   ;Get Shipment Used   ;Boolean       ;CaptionML=[ENU=Get Shipment Used;
                                                              NOR=Hent brukt f›lgeseddel;
                                                              SVE=H„mta anv„nd utleverans];
                                                   Editable=No }
    { 8000;   ;Id                  ;GUID          ;CaptionML=[ENU=Id;
                                                              NOR=ID;
                                                              SVE=ID] }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter2(0,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(
                                                                    Text061,"Assigned User ID",
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter2("Assigned User ID"));
                                                              END;

                                                   DataClassification=EndUserIdentifiableInformation;
                                                   CaptionML=[ENU=Assigned User ID;
                                                              NOR=Tilordnet bruker-ID;
                                                              SVE=Tilldelat anv„ndar-ID] }
    { 10605;  ;GLN                 ;Code13        ;OnValidate=BEGIN
                                                                IF NOT EInvoiceDocumentEncode.IsValidEANNo(GLN,TRUE) THEN
                                                                  FIELDERROR(GLN,Text10606);
                                                              END;

                                                   CaptionML=[ENU=GLN;
                                                              NOR=GLN;
                                                              SVE=GLN];
                                                   Description=NAVNO (10605) }
    { 10606;  ;Account Code NO     ;Text30        ;OnValidate=BEGIN
                                                                IF "Account Code NO" <> xRec."Account Code NO" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Account Code NO"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Account Code;
                                                              NOR=Kontokode;
                                                              SVE=Kontokod (DK)];
                                                   Description=NAVNO (10606) }
    { 10613;  ;E-Invoice           ;Boolean       ;CaptionML=[ENU=E-Invoice;
                                                              NOR=E-faktura;
                                                              SVE=E-faktura];
                                                   Description=NAVNO (10613) }
    { 11200;  ;Source Inv. No.     ;Code20        ;OnValidate=BEGIN
                                                                IF FromSalesInvHeader.GET("Source Inv. No.") THEN BEGIN
                                                                  FromSalesInvHeader.CALCFIELDS("Amount Including VAT");
                                                                  FromSalesInvHeader.CALCFIELDS(Amount);
                                                                  "Source Inv. VAT" := FromSalesInvHeader."Amount Including VAT" - FromSalesInvHeader.Amount;
                                                                  "Source Inv. Total" := FromSalesInvHeader."Amount Including VAT";
                                                                END ELSE BEGIN
                                                                  "Source Inv. VAT" := 0;
                                                                  "Source Inv. Total" := 0;
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF PAGE.RUNMODAL(0,FromSalesInvHeader) = ACTION::LookupOK THEN BEGIN
                                                                "Source Inv. No." := FromSalesInvHeader."No.";
                                                                "Source Inv. VAT" := FromSalesInvHeader."Amount Including VAT" - FromSalesInvHeader.Amount;
                                                                "Source Inv. Total" := FromSalesInvHeader."Amount Including VAT";
                                                              END;
                                                            END;

                                                   CaptionML=ENU=Source Inv. No.;
                                                   Description=NAVSE (11200) }
    { 11201;  ;Source Inv. VAT     ;Decimal       ;CaptionML=ENU=Source Inv. VAT;
                                                   Description=NAVSE (11201);
                                                   Editable=No }
    { 11202;  ;Source Inv. Total   ;Decimal       ;CaptionML=ENU=Source Inv. Total;
                                                   Description=NAVSE (11202);
                                                   Editable=No }
    { 13600;  ;EAN No.             ;Code13        ;OnValidate=BEGIN
                                                                IF "EAN No." = '' THEN
                                                                  EXIT;

                                                                IF NOT OIOXMLDocumentEncode.IsValidEANNo("EAN No.") THEN
                                                                  FIELDERROR("EAN No.",Text13606);
                                                              END;

                                                   CaptionML=[ENU=EAN No.;
                                                              SVE=EAN nr.];
                                                   Description=NAVDK (13600) }
    { 13602;  ;Account Code DK     ;Text30        ;OnValidate=BEGIN
                                                                //SalesLine.RESET;
                                                                //SalesLine.SETRANGE("Document Type","Document Type");
                                                                //SalesLine.SETRANGE("Document No.","No.");
                                                                //SalesLine.SETFILTER(Type, '>%1', SalesLine.Type::" ");
                                                                //SalesLine.SETFILTER("Account Code DK", '%1|%2', xRec."Account Code DK", '');
                                                                //SalesLine.MODIFYALL("Account Code DK", "Account Code DK");
                                                                IF "Account Code DK" <> xRec."Account Code DK" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Account Code DK"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Account Code DK;
                                                              SVE=Kontokod (DK)];
                                                   Description=NAVDK (13602);
                                                   Editable=No }
    { 13604;  ;OIOUBL Profile Code ;Code10        ;TableRelation="OIOUBL Profile";
                                                   CaptionML=ENU=OIOUBL Profile Code;
                                                   Description=NAVDK (13604) }
    { 13605;  ;Sell-to Contact Phone No.;Text30   ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Sell-to Contact Phone No.;
                                                              SVE=K”pares telefonnr];
                                                   Description=NAVDK (13605);
                                                   Editable=No }
    { 13606;  ;Sell-to Contact Fax No.;Text30     ;CaptionML=[ENU=Sell-to Contact Fax No.;
                                                              SVE=K”pares Faxnr];
                                                   Description=NAVDK (13606);
                                                   Editable=No }
    { 13607;No;Sell-to Contact E-Mail;Text80      ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Sell-to Contact E-Mail;
                                                              SVE=K”pares e-post];
                                                   Description=NAVDK (13607);
                                                   Editable=No }
    { 13608;  ;Sell-to Contact Role;Option        ;CaptionML=ENU=Sell-to Contact Role;
                                                   OptionCaptionML=[ENU=" ,,,Purchase Responsible,,,Accountant,,,Budget Responsible,,,Requisitioner";
                                                                    SVE=" ,,,Ink”psansvarig,,,Bokf”rare,,,Budgetansvarig,,,Anskaffning/rekvirera"];
                                                   OptionString=[ ,,,Purchase Responsible,,,Accountant,,,Budget Responsible,,,Requisitioner];
                                                   Description=NAVDK (13608) }
    { 13620;  ;Payment Channel     ;Option        ;OnValidate=BEGIN
                                                                IF "Payment Channel" = "Payment Channel"::"Payment Slip" THEN
                                                                  ERROR(Text13607,FIELDCAPTION("Payment Channel"),"Payment Channel");
                                                              END;

                                                   CaptionML=[ENU=Payment Channel;
                                                              SVE=Betalningskanal];
                                                   OptionCaptionML=[ENU=" ,Payment Slip,Account Transfer,National Clearing,Direct Debit";
                                                                    SVE=" ,Talong,Konto”verf”ring,Bank”verf”ring,Autogiro"];
                                                   OptionString=[ ,Payment Slip,Account Transfer,National Clearing,Direct Debit];
                                                   Description=NAVDK (13620) }
    { 11012000;;Project Invoice    ;Boolean       ;CaptionML=[ENU=Project Invoice;
                                                              NOR=Prosjektfaktura;
                                                              SVE=Projektfaktura];
                                                   Editable=No }
    { 11012005;;Job No.            ;Code20        ;TableRelation=Job;
                                                   OnValidate=VAR
                                                                lvProjSetupRec@1210190000 : Record 315;
                                                                lvProjRec@1210190001 : Record 11072003;
                                                                lvProjPrinRec@1100485000 : Record 11012005;
                                                                lvPlantLocRec@1100485001 : Record 11012554;
                                                                lvBlockingCodeRec@1100485002 : Record 11012027;
                                                                lvCustRec@1210190002 : Record 18;
                                                                ROTInformation@1100285000 : Record 11128101;
                                                              BEGIN
                                                                //**4PS.sn
                                                                IF "Job No." <> '' THEN BEGIN
                                                                  lvProjRec.GET("Job No.");
                                                                  IF "Installment Invoice" = FALSE THEN
                                                                    IF NOT "Plant Invoice" AND
                                                                       NOT ("Project Invoice" AND lvProjRec."Small Project" AND lvProjRec."Plant Job Order") THEN BEGIN
                                                                      lvProjPrinRec.GET("Job No.", "Sell-to Customer No.");
                                                                    END;                                                                                         //** 4PS02.en

                                                                  IF ("Document Type" IN ["Document Type"::Invoice, "Document Type"::"Credit Memo"]) AND
                                                                     (NOT "Project Invoice") AND (NOT "Plant Invoice") AND (NOT "Service Invoice")
                                                                  THEN BEGIN
                                                                    lvProjSetupRec.GET;
                                                                    IF (lvProjRec."Blocking Code" <> '') AND
                                                                       (
                                                                        (lvProjRec."Project Status" = lvProjRec."Project Status"::"Technical Finished") OR
                                                                        (lvProjRec."Project Status" = lvProjRec."Project Status"::"Administrative Finished") OR
                                                                        ((lvProjRec."Project Status" = lvProjRec."Project Status"::Finished) AND lvProjSetupRec."Provisions at Closure")
                                                                        )
                                                                    THEN
                                                                      lvBlockingCodeRec.CheckBlocked(lvProjRec."Blocking Code", lvBlockingCodeRec.Switch::"Sales Invoice", lvProjRec, TRUE)
                                                                    ELSE
                                                                      IF (lvProjSetupRec."Provisions at Closure") THEN
                                                                        lvProjRec.CheckProjectStatus(-1)
                                                                      ELSE
                                                                        lvProjRec.CheckProjectStatus(1);
                                                                  END;
                                                                  TESTFIELD("Service Order No.", '');
                                                                END;
                                                                IF "Job No." <> xRec."Job No." THEN BEGIN
                                                                  IF "Currency Code" <> '' THEN BEGIN
                                                                    UpdateCurrencyFactor;
                                                                    IF (CurrFieldNo = FIELDNO("Job No.")) THEN
                                                                      ConfirmUpdateCurrencyFactor
                                                                    ELSE
                                                                      VALIDATE("Currency Factor");
                                                                  END;
                                                                  FillDefaultSalesPerson();
                                                                  FillDefaultInvoiceLayoutCode();
                                                                  FillDefaultServiceWarrantyCode; //**4PS.n DP00121
                                                                END;
                                                                FillWKAPercentages;
                                                                //**4PS.en

                                                                // 25692.sn
                                                                IF ("Job No." <> '') THEN BEGIN
                                                                  IF lvProjPrinRec.GET("Job No.", "Sell-to Customer No.") THEN BEGIN
                                                                    IF lvProjPrinRec."Specific Payment Terms Code" <> '' THEN BEGIN
                                                                      VALIDATE("Payment Terms Code", lvProjPrinRec."Specific Payment Terms Code")
                                                                    END ELSE BEGIN
                                                                      IF lvCustRec.GET("Bill-to Customer No.") THEN BEGIN
                                                                        IF lvCustRec."Payment Terms Code" <> '' THEN
                                                                          VALIDATE("Payment Terms Code", lvCustRec."Payment Terms Code");
                                                                      END;
                                                                    END;
                                                                  END;
                                                                END;
                                                                IF ("Job No." = '') AND (xRec."Job No." <> '') THEN BEGIN
                                                                  IF lvCustRec.GET("Bill-to Customer No.") THEN BEGIN
                                                                    IF lvCustRec."Payment Terms Code" <> '' THEN
                                                                     VALIDATE("Payment Terms Code", lvCustRec."Payment Terms Code");
                                                                  END;
                                                                END;
                                                                // 25692.en

                                                                //** 4PS01.sn
                                                                IF lvProjPrinRec.GET("Job No.", "Sell-to Customer No.") THEN
                                                                  "Principal Reference" :=  lvProjPrinRec."Principal Reference";
                                                                //** 4PS01.en
                                                                //MessageIfSalesLinesExist(FIELDCAPTION("Job No."));  //**4PS.o
                                                                //**4PS01.sn
                                                                IF NOT SalesLogisticsSepaRentContract() THEN
                                                                  MessageIfSalesLinesExist(FIELDCAPTION("Job No."))
                                                                ELSE BEGIN
                                                                  TestStatusOpen;
                                                                  IF "Plant Location Code" <> '' THEN BEGIN
                                                                    lvPlantLocRec.CHANGECOMPANY(CompanyLogistics);
                                                                    lvPlantLocRec.GET("Plant Location Code");
                                                                    IF "Job No." <> lvPlantLocRec."Project No." THEN
                                                                      FIELDERROR("Job No.", STRSUBSTNO(Text11012002, lvPlantLocRec."Project No.", "Plant Location Code"));
                                                                  END;
                                                                END;
                                                                //**4PS01.en

                                                                // ****** 4PSSE.I012 130711 *** <<
                                                                // If Credit Memo or Invoice, trigger the ROT field if there is a ROT Information in the project (=Job)
                                                                IF ("Job No." <> '') THEN BEGIN
                                                                   IF ("Document Type" = SalesHeader."Document Type"::Invoice) OR
                                                                      ("Document Type" = SalesHeader."Document Type"::"Credit Memo") THEN BEGIN
                                                                      IF ("Document Type" = "Document Type"::Invoice) THEN BEGIN
                                                                      // Only create in RotInformation if Invoice, not Credit Memo
                                                                         ROTInformation.RESET();
                                                                         ROTInformation.SETRANGE(Type, ROTInformation.Type::Project);
                                                                         ROTInformation.SETRANGE("Document No.", "Job No.");
                                                                         IF (ROTInformation.FINDSET(TRUE)) THEN REPEAT
                                                                            ROTInformation.Type := ROTInformation.Type::Invoice;
                                                                            ROTInformation."Document No." := "No.";
                                                                            IF NOT ROTInformation.INSERT() THEN ROTInformation.MODIFY(); // If changing Job No. it may have been already created.
                                                                         UNTIL ROTInformation.NEXT = 0;
                                                                      END;
                                                                      "ROT/RUT reduction" := TRUE;  // Sets the flag on Invoice and on Credit Memo
                                                                   END ELSE
                                                                      "ROT/RUT reduction" := FALSE; // No ROT
                                                                END ELSE
                                                                   "ROT/RUT reduction" := FALSE; // No ROT

                                                                // ****** 4PSSE.I012 130711 *** >>
                                                                GetRetentions; //**4PS.n
                                                                CreateDim(
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Service Order","Service Order No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Service-Contract","Service Contract No.", //**4PS.n 09-06-2010
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                                  //DATABASE::Location,"Location Code");  //**4PS.n  //*C007227.o
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 11012010;;Installment Invoice;Boolean       ;CaptionML=[ENU=Installment Invoice;
                                                              NOR=Avdragsfaktura;
                                                              SVE=Betalplansfaktura];
                                                   Editable=No }
    { 11012011;;Consumption Invoice;Boolean       ;CaptionML=ENU=Consumption Invoice }
    { 11012015;;Production Motivation Date;Date   ;TableRelation="Unit Price Production Mot."."Production Date" WHERE (Project No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Production Motivation Date;
                                                              NOR=Produksjonsmotivasjonsdato;
                                                              SVE=Datum f”r Produktionsorsak];
                                                   Editable=No }
    { 11012016;;Production Motivation Code;Code10 ;CaptionML=[ENU=Production Motivation Code;
                                                              NOR=Produksjonsmotivasjonskode;
                                                              SVE=Produktionsorsakskod];
                                                   Editable=No }
    { 11012020;;Invoice Text       ;Text250       ;CaptionML=[ENU=Invoice Text;
                                                              NOR=Fakturatekst;
                                                              SVE=Fakturatext] }
    { 11012030;;Interest Date      ;Date          ;OnValidate=BEGIN
                                                                //**4PS.n
                                                                IF ("Interest Date" > "Posting Date") THEN
                                                                  FIELDERROR("Interest Date",STRSUBSTNO(Text11012001, "Interest Date", FIELDCAPTION("Posting Date"),"Posting Date"));
                                                              END;

                                                   CaptionML=[ENU=Interest Date;
                                                              NOR=Rentedato;
                                                              SVE=R„ntedatum] }
    { 11012040;;Related Sales Order No.;Code20    ;TableRelation="Sales Header".No. WHERE (Document Type=CONST(Order));
                                                   OnValidate=VAR
                                                                lvSalesHeader@1210190000 : Record 36;
                                                              BEGIN
                                                                //**4PS
                                                                IF lvSalesHeader.GET(lvSalesHeader."Document Type"::Order, "Related Sales Order No.") THEN BEGIN
                                                                  IF "Sell-to Customer No." = '' THEN
                                                                    VALIDATE("Sell-to Customer No.", lvSalesHeader."Sell-to Customer No.");
                                                                  TESTFIELD("Sell-to Customer No.", lvSalesHeader."Sell-to Customer No.");
                                                                  VALIDATE("Job No.", lvSalesHeader."Job No.");
                                                                //  VALIDATE("Received on Project", lvSalesHeader."Received on Project");
                                                                  VALIDATE("Payment Terms Code",lvSalesHeader."Payment Terms Code");
                                                                  "Invoice Text" := lvSalesHeader."Invoice Text";
                                                                  "Your Reference" := lvSalesHeader."Your Reference";  //C004230.n
                                                                  //**4PS.sn DP00613
                                                                  IF lvSalesHeader."Direct Debit Mandate ID" <> '' THEN
                                                                    "Direct Debit Mandate ID" := lvSalesHeader."Direct Debit Mandate ID";
                                                                  //**4PS.en DP00613
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              lvSalesHeader@1210190000 : Record 36;
                                                            BEGIN
                                                              //**4PS
                                                              lvSalesHeader.RESET;
                                                              lvSalesHeader.SETRANGE("Document Type", "Document Type"::Order);
                                                              IF "Sell-to Customer No." <> '' THEN
                                                                lvSalesHeader.SETRANGE("Sell-to Customer No.", "Sell-to Customer No.");
                                                              IF PAGE.RUNMODAL(PAGE::"Sales List", lvSalesHeader) = ACTION::LookupOK THEN
                                                                VALIDATE("Related Sales Order No.", lvSalesHeader."No.");
                                                            END;

                                                   CaptionML=[ENU=Related Sales Order No.;
                                                              NOR=Relatert salgsordrenr;
                                                              SVE=Relaterat f”rs.ordernr] }
    { 11012258;;Company VAT Registration No.;Text20;
                                                   CaptionML=[ENU=Company VAT Registration No.;
                                                              NOR=Selskapets momsregistreringsnr;
                                                              SVE=F”retagets momsregistreringsnr];
                                                   Editable=No }
    { 11012259;;Country of Origin  ;Code10        ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                UpdateVATGroup; //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Country of Origin;
                                                              NOR=Opprinnelsesland;
                                                              SVE=Ursprungsland];
                                                   Editable=No }
    { 11012260;;Country of Destination;Code10     ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                UpdateVATGroup; //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Country of Destination;
                                                              NOR=Destinasjonsland;
                                                              SVE=Destinationsland];
                                                   Editable=No }
    { 11012261;;Extended VAT Determination;Boolean;CaptionML=[ENU=Extended VAT Determination;
                                                              NOR=Utvidet momsbestemmelse;
                                                              SVE=Ut”kad momsbest„mning];
                                                   Editable=No }
    { 11012262;;Invoice From       ;Option        ;CaptionML=[ENU=Invoice From;
                                                              NOR=Faktura fra;
                                                              SVE=Faktura fr†n];
                                                   OptionCaptionML=[ENU=" ,Logistic,Sales";
                                                                    NOR=" ,Logistikk,Salg";
                                                                    SVE=" ,Logistik,F”rs„ljning"];
                                                   OptionString=[ ,Logistic,Sales] }
    { 11012265;;Offer Amount       ;Decimal       ;CaptionML=[ENU=Offer Amount;
                                                              NOR=Tilbudsbel›p;
                                                              SVE=Anbudsbelopp] }
    { 11012270;;Selection Code     ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=FILTER(Quote|Order),
                                                                                           Sales Document Type=FIELD(Sales Document Type),
                                                                                           Selection Code=FILTER(<>''),
                                                                                           Selection Code is Current Doc.=CONST(Yes));
                                                   OnValidate=VAR
                                                                lvSalesHeadRec@1100485000 : Record 36;
                                                                lvText11012001@1100485001 : TextConst 'ENU=''%1'' is still used;NOR=''%1'' brukes fortsatt;SVE=''%1'' anv„nds fortfarande';
                                                              BEGIN
                                                                //**4PS
                                                                IF NOT ("Document Type" IN ["Document Type"::Quote, "Document Type"::Order]) THEN
                                                                  EXIT;

                                                                IF "Selection Code is Current Doc." AND ("Selection Code" <> xRec."Selection Code") THEN BEGIN
                                                                  lvSalesHeadRec.SETFILTER("Document Type", '%1|%2', "Document Type"::Quote, "Document Type"::Order);
                                                                  lvSalesHeadRec.SETRANGE("Sales Document Type", "Sales Document Type");
                                                                  lvSalesHeadRec.SETRANGE("Selection Code", xRec."Selection Code");
                                                                  lvSalesHeadRec.SETRANGE("Selection Code is Current Doc.", FALSE);  //* Do not check current record
                                                                  IF lvSalesHeadRec.FINDFIRST THEN
                                                                    lvSalesHeadRec.FIELDERROR("Selection Code", STRSUBSTNO(lvText11012001, xRec."Selection Code"));
                                                                END;

                                                                VALIDATE("Selection Code is Current Doc.");
                                                              END;

                                                   CaptionML=[ENU=Selection Code;
                                                              NOR=Utvalgskode;
                                                              SVE=Valkod] }
    { 11012271;;Selection Code is Current Doc.;Boolean;
                                                   FieldClass=Normal;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                IF ("Document Type" IN ["Document Type"::Quote, "Document Type"::Order]) AND
                                                                   ("Selection Code" = "No.") AND ("Selection Code" <> '')
                                                                THEN
                                                                  "Selection Code is Current Doc." := TRUE
                                                                ELSE
                                                                  "Selection Code is Current Doc." := FALSE;
                                                              END;

                                                   CaptionML=[ENU=Selection Code is Current Doc.;
                                                              NOR=Utvalgskoden er aktuelt dok.;
                                                              SVE=Valkoden „r aktuellt dok.];
                                                   Editable=No }
    { 11012280;;Invoice Layout Code;Code10        ;TableRelation="Invoice Layout";
                                                   CaptionML=[ENU=Invoice Layout Code;
                                                              NOR=Fakturalayoutkode;
                                                              SVE=Fakturalayoutkod] }
    { 11012300;;Return Order No.   ;Code20        ;CaptionML=[ENU=Return Order No.;
                                                              NOR=Bestillingsreturnr.;
                                                              SVE=Returordernr] }
    { 11012377;;Valid Until        ;Date          ;CaptionML=[ENU=Valid Until;
                                                              NOR=Gyldig til;
                                                              SVE=Giltigt till] }
    { 11012390;;Extra Shipments Allowed;Boolean   ;CaptionML=[ENU=Extra Shipments Allowed;
                                                              NOR=Ekstra forsendelser tillatt;
                                                              SVE=Till†tna extra utleveranser] }
    { 11012391;;Shipping Details   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Shipping Details" WHERE (Source=FILTER(SalesOrder),
                                                                                               Order No.=FIELD(No.)));
                                                   CaptionML=[ENU=Shipping Details;
                                                              NOR=Leveringsdetaljer;
                                                              SVE=Leveransinformation];
                                                   Editable=No }
    { 11012495;;Rental Contract Modified on;Date  ;CaptionML=[ENU=Rental Contract Modified on;
                                                              NOR=Leiekontrakten endret den;
                                                              SVE=Uthyrningskontraktet „ndrades];
                                                   Editable=No }
    { 11012500;;Elected Alternative No.;Integer   ;OnValidate=BEGIN
                                                                //**4PS
                                                                TestStatusOpen;
                                                              END;

                                                   CaptionML=[ENU=Elected Alternative No.;
                                                              NOR=Valgt alternativnr;
                                                              SVE=Valt alternativnr];
                                                   MinValue=0 }
    { 11012505;;Plant Location Code;Code20        ;OnValidate=BEGIN
                                                                //**4PS
                                                                ValidatePlantLocation();
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS
                                                              LookupPlantLocation();
                                                            END;

                                                   CaptionML=[ENU=Plant Location;
                                                              NOR=Maskinplassering;
                                                              SVE=Maskinplats];
                                                   Description=Plant location in logistic company (to Location) }
    { 11012506;;Plant Depot Logistics;Code20      ;OnValidate=BEGIN
                                                                //**4PS
                                                                ValidatePlantDepotLogistics();
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS
                                                              LookupPlantDepotLogistics();
                                                            END;

                                                   CaptionML=[ENU=Plant Depot Logistics;
                                                              NOR=Maskindepot, logistikk;
                                                              SVE=Maskindep†, logistik];
                                                   Description=Plant depot logistics (from location) }
    { 11012507;;Location Code Logistics;Code10    ;OnValidate=BEGIN
                                                                //**4PS
                                                                ValidateLocationCodeLogistics();
                                                              END;

                                                   OnLookup=BEGIN
                                                              //**4PS
                                                              LookupLocationCodeLogistics();
                                                            END;

                                                   CaptionML=[ENU=Location Code Logistics;
                                                              NOR=Logistikk for lokasjonkode;
                                                              SVE=Logistik f”r lagerst„llekod];
                                                   Description=Location/depot logistics (from location) for items }
    { 11012511;;Arrival Date       ;Date          ;OnValidate=BEGIN
                                                                //**4PS
                                                                IF ("Arrival Date" = 0D) THEN BEGIN
                                                                  "Removal Date" := 0D;
                                                                  "Rental Starting Date" := 0D;
                                                                  "Rental Ending Date" := 0D;
                                                                END ELSE BEGIN
                                                                  IF ("Rental Starting Date" < "Arrival Date") OR ("Rental Starting Date" = xRec."Arrival Date") THEN
                                                                    VALIDATE("Rental Starting Date", "Arrival Date");
                                                                  IF ("Removal Date" < "Arrival Date") AND ("Removal Date" <> 0D) THEN
                                                                    VALIDATE("Removal Date", "Arrival Date");
                                                                END;
                                                                "Shipment Date" := "Arrival Date";
                                                              END;

                                                   CaptionML=[ENU=Arrival Date;
                                                              NOR=Ankomstdato;
                                                              SVE=Ankomstdatum] }
    { 11012512;;Removal Date       ;Date          ;OnValidate=BEGIN
                                                                //**4PS
                                                                IF ("Arrival Date" = 0D) THEN
                                                                  "Removal Date" := 0D
                                                                ELSE BEGIN
                                                                  IF ("Removal Date" < "Arrival Date") AND ("Removal Date" <> 0D) THEN
                                                                    FIELDERROR("Removal Date", STRSUBSTNO(Text11012003,FIELDCAPTION("Arrival Date")));
                                                                  IF ("Rental Ending Date" > "Removal Date") OR ("Rental Ending Date" = 0D) OR ("Rental Ending Date" = xRec."Removal Date") THEN
                                                                    VALIDATE("Rental Ending Date", "Removal Date");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Removal Date;
                                                              NOR=Fjerningsdato;
                                                              SVE=Borttagningsdatum] }
    { 11012513;;Rental Starting Date;Date         ;OnValidate=BEGIN
                                                                //**4PS
                                                                IF ("Arrival Date" = 0D) THEN
                                                                  "Rental Starting Date" := 0D
                                                                ELSE BEGIN
                                                                  IF "Rental Starting Date" < "Arrival Date" THEN
                                                                    FIELDERROR("Rental Starting Date", STRSUBSTNO(Text11012003,FIELDCAPTION("Arrival Date")));
                                                                  IF ("Rental Starting Date" > "Removal Date") AND ("Removal Date" <> 0D)THEN
                                                                    VALIDATE("Removal Date", "Rental Starting Date");
                                                                  IF ("Rental Starting Date" > "Rental Ending Date") AND ("Rental Ending Date" <> 0D) THEN
                                                                    VALIDATE("Rental Ending Date", "Rental Starting Date");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Rental Starting Date;
                                                              NOR=Startdato for Leie;
                                                              SVE=Startdatum f”r uthyrning] }
    { 11012514;;Rental Ending Date ;Date          ;OnValidate=BEGIN
                                                                //**4PS
                                                                IF ("Arrival Date" = 0D) THEN
                                                                  "Rental Ending Date" := 0D
                                                                ELSE BEGIN
                                                                  IF "Rental Ending Date" > "Removal Date" THEN
                                                                    FIELDERROR("Rental Ending Date", STRSUBSTNO(Text11012004,FIELDCAPTION("Removal Date")));
                                                                  IF ("Rental Ending Date" < "Rental Starting Date") AND ("Rental Ending Date" <> 0D)THEN
                                                                    FIELDERROR("Rental Ending Date", STRSUBSTNO(Text11012003,FIELDCAPTION("Rental Starting Date")));
                                                                  IF ("Rental Ending Date" < "Arrival Date") AND ("Rental Ending Date" <> 0D)THEN
                                                                    FIELDERROR("Rental Ending Date", STRSUBSTNO(Text11012003,FIELDCAPTION("Arrival Date")));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Rental Ending Date;
                                                              NOR=Sluttdato for Leleie;
                                                              SVE=Slutdatum f”r uthyrning] }
    { 11012515;;Rental Contract Invoice Status;Option;
                                                   OnValidate=BEGIN
                                                                //* Not allowed to manually change to Invoiced (or higher)
                                                                IF ("Rental Contract Invoice Status" >= "Rental Contract Invoice Status"::"Temporary") AND
                                                                   (xRec."Rental Contract Invoice Status" < "Rental Contract Invoice Status"::"Temporary")
                                                                THEN
                                                                  FIELDERROR("Rental Contract Invoice Status");

                                                                //* Not allowed to set status back to Invoiced
                                                                IF ("Rental Contract Invoice Status" < "Rental Contract Invoice Status"::"Temporary") AND
                                                                   (xRec."Rental Contract Invoice Status" >= "Rental Contract Invoice Status"::"Temporary")
                                                                THEN
                                                                  TESTFIELD("Rental Contract Invoice Status", xRec."Rental Contract Invoice Status");

                                                                IF ("Rental Contract Invoice Status" = "Rental Contract Invoice Status"::Chargeable) THEN
                                                                  TESTFIELD(Status, Status::Released);
                                                              END;

                                                   CaptionML=[ENU=Rental Contract Invoice Status;
                                                              NOR=Leiekontrakt, fakturastatus;
                                                              SVE=Uthyrningskontrakt, fakturastatus];
                                                   OptionCaptionML=[ENU=Open,Chargeable,Temporary,Invoiced;
                                                                    NOR=pen,Belastbar,Midlertidig,Fakturert;
                                                                    SVE=™ppen,Debiterbar,Tillf„llig,Fakturerad];
                                                   OptionString=Open,Chargeable,Temporary,Invoiced }
    { 11012548;;Plant Location Filter;Code250     ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Plant Location Filter;
                                                              NOR=Maskinlokasjonsfilter;
                                                              SVE=Maskinplatsfilter] }
    { 11012549;;Plant Loc. Filter On Invoice;Boolean;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Plant Location=FIELD(Plant Location Filter)));
                                                   CaptionML=[ENU=Plant Loc. Filter On Invoice;
                                                              NOR=Maskinlokasjonsfilter p† faktura;
                                                              SVE=Maskinplats Filtrera p† faktura];
                                                   Description=Indication location from filter present on invoice line(s), to search invoices of location;
                                                   Editable=No }
    { 11012550;;Plant Invoice      ;Boolean       ;CaptionML=[ENU=Plant Invoice;
                                                              NOR=Maskinfaktura;
                                                              SVE=Maskinfaktura];
                                                   Editable=No }
    { 11012551;;Rental Period to Date;Date        ;CaptionML=[ENU=Rental Period to Date;
                                                              NOR=Leieperiode til dato;
                                                              SVE=Uthyrningsperiod till datum];
                                                   Editable=No }
    { 11012552;;Company Name       ;Text30        ;TableRelation=Company;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Company Name;
                                                              NOR=Navn p† selskap;
                                                              SVE=f”retagsnamn];
                                                   Editable=No }
    { 11012554;;Service Invoice    ;Boolean       ;CaptionML=[ENU=Service Invoice;
                                                              NOR=Servicefaktura;
                                                              SVE=Servicefaktura] }
    { 11012555;;Alternative Bill-to Address;Code10;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Bill-to Customer No.),
                                                                                               Billing Address=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                CheckInvoiceAddress;
                                                                FillDefaultEMailInvoice;
                                                              END;

                                                   CaptionML=[ENU=Alternative Bill-to Address;
                                                              NOR=Alternativ Faktureringsadresse;
                                                              SVE=Alternativ faktureringsadress] }
    { 11012557;;Rental Unit Invoice;Boolean       ;CaptionML=[ENU=Rental Unit Invoice;
                                                              NOR=Leieenhetsfaktura;
                                                              SVE=Uthyrningsenhetsfaktura];
                                                   Editable=No }
    { 11012558;;Withhold % Last Installment;Decimal;
                                                   CaptionML=[ENU=Withhold % Last Installment;
                                                              NOR=Tilbakehold % Forrige Avdrag;
                                                              SVE=Inneh†ll procentsats av senaste avbetalning];
                                                   Editable=No }
    { 11012559;;Public notary      ;Code20        ;TableRelation=Customer.No.;
                                                   CaptionML=[ENU=Public notary;
                                                              NOR=Notarius publicus;
                                                              SVE=Notarius publicus];
                                                   Editable=No }
    { 11012561;;Notary Case Number ;Text30        ;CaptionML=[ENU=Notary Case Number;
                                                              NOR=Notariens Saksnummer;
                                                              SVE=Notariens „rendenummer];
                                                   Editable=No }
    { 11012562;;Calculate B Amounts based on;Option;
                                                   CaptionML=[ENU=Calculate B Amounts based on;
                                                              NOR=Beregn B-bel›p basert p†;
                                                              SVE=Ber„kna B-belopp baserat p†];
                                                   OptionCaptionML=[ENU=Labor Amount,Invoice Amount;
                                                                    NOR=Arbeidskraftsbel›p,Faktureringsbel›p;
                                                                    SVE=Arbetskraftsbelopp,faktureringsbelopp];
                                                   OptionString=Labor Amount,Invoice Amount }
    { 11012566;;Specific WKA Percentages;Boolean  ;OnValidate=BEGIN
                                                                //**4PS
                                                                FillWKAPercentages;
                                                              END;

                                                   CaptionML=[ENU=Specific WKA Percentages;
                                                              NOR=Spesifike WKA-Prosentsatser;
                                                              SVE=Specifika WKA-procentsatser] }
    { 11012567;;% Labor            ;Decimal       ;CaptionML=[ENU=% Labor;
                                                              NOR=% arbeidskraft;
                                                              SVE=Procent, arbetskraft];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   AutoFormatType=1 }
    { 11012568;;% to B Account     ;Decimal       ;CaptionML=[ENU=% to B Account;
                                                              NOR=% til B-konto;
                                                              SVE=Procent till B-konto];
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 11012570;;WKA Period         ;Text50        ;CaptionML=[ENU=WKA Period;
                                                              NOR=WKA-periode;
                                                              SVE=WKA-period] }
    { 11012580;;Amount VAT         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Line VAT Amount" WHERE (Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount VAT;
                                                              NOR=Mva-bel›p;
                                                              SVE=Momsbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012585;;Sales Document Type;Option        ;CaptionML=[ENU=Sales Document Type;
                                                              NOR=Salgsdokumenttype;
                                                              SVE=F”rs.dokumenttyp];
                                                   OptionCaptionML=[ENU=Standard,Sales Logistics Separated,Rental Contract;
                                                                    NOR=Standard,Salgslogistikk separert,Leiekontrakt;
                                                                    SVE=Standard,F”rs„ljningslogistik separerad,Uthyrningskontrakt];
                                                   OptionString=Standard,Sales Logistics Separated,RentalContract }
    { 11012610;;Inserted By        ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Inserted By;
                                                              NOR=Satt inn av;
                                                              SVE=Infogad av];
                                                   Editable=No }
    { 11012620;;Invoice Frequency Rental;DateFormula;
                                                   CaptionML=[ENU=Invoice Frequency Rental;
                                                              NOR=Faktureringsintervall for leie;
                                                              SVE=Faktureringsintervall f”r uthyrning] }
    { 11012700;;Service Warranty Code;Code10      ;TableRelation="Service Warranty";
                                                   CaptionML=[ENU=Service Warranty Code;
                                                              NOR=Servicegarantikode;
                                                              SVE=Servicegarantikod] }
    { 11012800;;Service Call No.   ;Code20        ;TableRelation="Service Call".No.;
                                                   CaptionML=[ENU=Service Call No.;
                                                              NOR=Servicesamtalenr.;
                                                              SVE=Servicesamtalsnr];
                                                   Editable=No }
    { 11012801;;Description Service Call;Text50   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Call".Description WHERE (No.=FIELD(Service Call No.)));
                                                   CaptionML=[ENU=Description Service Call;
                                                              NOR=Beskrivelse av servicesamtale;
                                                              SVE=Servicesamtalsbeskrivning];
                                                   Editable=No }
    { 11012804;;Service Contract No.;Code20       ;TableRelation=Service-Contract.No.;
                                                   OnValidate=BEGIN
                                                                //**4PS
                                                                GetRetentions;

                                                                CreateDim(
                                                                  DATABASE::"Service-Contract","Service Contract No.",
                                                                  DATABASE::"Service Order","Service Order No.",
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                                  //DATABASE::Location,"Location Code");  //**4PS.n  //*C007227.o

                                                                GetServicePaymentTermsCode;
                                                              END;

                                                   CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr] }
    { 11012805;;Service Order No.  ;Code20        ;TableRelation="Service Order".No.;
                                                   OnValidate=BEGIN
                                                                //**4PS.n
                                                                IF "Service Order No." <> '' THEN BEGIN
                                                                  ServOrderRec.GET("Service Order No.");
                                                                  ServOrderRec.TestServiceContractMandatory;
                                                                  IF NOT SkipCheckCustomerNoOnServiceOrder THEN BEGIN
                                                                    IF ServOrderRec.UseBilltoAsSelltoCustomer THEN
                                                                      ServOrderRec.TESTFIELD("Bill-to Customer No.", "Sell-to Customer No.")
                                                                    ELSE
                                                                      ServOrderRec.TESTFIELD("Customer No.", "Sell-to Customer No.");
                                                                  END;
                                                                  IF (CurrFieldNo <> 0) THEN
                                                                    ServOrderRec.TESTFIELD("Bill-to Customer No.", "Bill-to Customer No.");
                                                                  TESTFIELD("Job No.", '');
                                                                  "Service Contract No." := ServOrderRec."Service Contract No.";
                                                                  IF ("Document Type" IN ["Document Type"::Invoice, "Document Type"::"Credit Memo"]) AND
                                                                     (NOT "Project Invoice") AND (NOT "Plant Invoice") AND (NOT "Service Invoice") THEN
                                                                    ServOrderRec.CheckStatus(1);
                                                                  GetServicePaymentTermsCode;
                                                                END ELSE BEGIN
                                                                  "Service Contract No." := '';
                                                                  CheckInvoiceAddress;
                                                                  GetServicePaymentTermsCode;
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::"Service Order","Service Order No.",
                                                                  DATABASE::"Service-Contract","Service Contract No.",
                                                                  DATABASE::Job,"Job No.",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                              END;

                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr] }
    { 11012810;;Principal Reference;Text50        ;CaptionML=[ENU=Principal Reference;
                                                              NOR=Oppdragsgiverreferanse;
                                                              SVE=Uppdragsgivarreferens] }
    { 11012820;;Order No. Customer ;Text50        ;CaptionML=[ENU=Order No. Customer;
                                                              NOR=Ordrenr, (Kunde);
                                                              SVE=Ordernr, (kund)] }
    { 11012830;;Commision Date Customer;Date      ;CaptionML=[ENU=Commision Date Principal;
                                                              NOR=Kommisjonsdato, oppdragsgiver;
                                                              SVE=Provisionsdatum, uppdragsgivare] }
    { 11012840;;Ship-to Contact No.;Code20        ;TableRelation=Contact;
                                                   CaptionML=[ENU=Ship-to Contact No.;
                                                              NOR=Leveranse, Kontaktnr.;
                                                              SVE=Leverans, kontaktnr] }
    { 11012850;;Ship-to Phone No.  ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone No.;
                                                              NOR=Lever til-telefonnummer;
                                                              SVE=Leveranstelefonnr] }
    { 11012860;;Amount Payment in Advance;Decimal ;CaptionML=[ENU=Amount Payment in Advance;
                                                              NOR=Bel›p, forskuddsbetaling;
                                                              SVE=Belopp, betalning i f”rskott];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11012870;;Salesperson Name   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Salesperson Code)));
                                                   CaptionML=[ENU=Salesperson Name;
                                                              NOR=Navn p† selger;
                                                              SVE=S„ljarnamn];
                                                   Editable=No }
    { 11012880;;Contract Type      ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Service-Contract."Contract Type" WHERE (No.=FIELD(Service Contract No.)));
                                                   CaptionML=[ENU=Contract Type;
                                                              NOR=Kontraktstype;
                                                              SVE=Kontraktstyp];
                                                   Editable=No }
    { 11012998;;Sales Representative Code;Code20  ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Sales Representative Code;
                                                              NOR=Salgsrepresentantkode;
                                                              SVE=F”rs.representantkod] }
    { 11012999;;Name Sales Representative;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Sales Representative Code)));
                                                   CaptionML=[ENU=Name Sales Representative;
                                                              NOR=Navn p† selger;
                                                              SVE=S„ljarens namn];
                                                   Editable=No }
    { 11020254;;Credit Restriction ;Code20        ;TableRelation="Credit Restriction";
                                                   OnValidate=VAR
                                                                CreditRestriction@1100485000 : Record 11020254;
                                                              BEGIN
                                                                //**4PS.sn
                                                                IF ("Credit Restriction" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  CreditRestriction.GET("Credit Restriction");
                                                                  //IF ("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) THEN BEGIN  CALL 27619
                                                                  IF ("Document Type" = "Document Type"::"Return Order") THEN BEGIN  //CALL 27619
                                                                    VALIDATE("Credit Restriction Date",0D);
                                                                    VALIDATE("Credit Restriction %",0);
                                                                  END ELSE BEGIN
                                                                    "Credit Restriction Date" := CALCDATE(CreditRestriction."Due Dateformula", "Document Date");
                                                                    VALIDATE("Credit Restriction %", CreditRestriction."Credit Restriction %");
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Credit Restriction Date",0D);
                                                                  VALIDATE("Credit Restriction %",0);
                                                                END;
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Credit Restriction;
                                                              NOR=Kreditrestriksjon;
                                                              SVE=Kreditrestriktion] }
    { 11020255;;Credit Restriction Date;Date      ;CaptionML=[ENU=Credit Restriction Date;
                                                              NOR=Kreditrestriksjonsdato;
                                                              SVE=Kreditrestriktionsdatum] }
    { 11020256;;Credit Restriction %;Decimal      ;OnValidate=BEGIN
                                                                //**4PS.sn
                                                                "Credit Restriction Amount" := "Amount Including VAT" * ("Credit Restriction %"/100);
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Credit Restriction %;
                                                              NOR=Kreditrestriksjon %;
                                                              SVE=Kreditrestriktion %];
                                                   DecimalPlaces=0:2 }
    { 11020257;;Credit Restriction Amount;Decimal ;CaptionML=[ENU=Credit Restriction Amount;
                                                              NOR=Kreditrestriksjonsbel›p;
                                                              SVE=Kreditrestriktionsbelopp];
                                                   DecimalPlaces=2:2 }
    { 11020258;;Payment Discount % 2;Decimal      ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TestStatusOpen;
                                                              END;

                                                   CaptionML=[ENU=Payment Discount % 2;
                                                              NOR=Kontantrabatt % 2;
                                                              SVE=Kassarabatt % 2];
                                                   DecimalPlaces=0:5 }
    { 11020259;;Pmt. Discount Date 2;Date         ;CaptionML=[ENU=Pmt. Discount Date 2;
                                                              NOR=Kontantrabattdato 2;
                                                              SVE=Kassa Rabattdatum 2] }
    { 11020260;;Payment Discount % 3;Decimal      ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TestStatusOpen;
                                                              END;

                                                   CaptionML=[ENU=Payment Discount % 3;
                                                              NOR=Kontantrabatt % 3;
                                                              SVE=Kassarabatt % 3];
                                                   DecimalPlaces=0:5 }
    { 11020261;;Pmt. Discount Date 3;Date         ;CaptionML=[ENU=Pmt. Discount Date 3;
                                                              NOR=Kontantrabattdato 3;
                                                              SVE=Kassa Rabattdatum 3] }
    { 11020270;;Delivery Time      ;Time          ;CaptionML=[ENU=Delivery Time;
                                                              NOR=Leveransetid;
                                                              SVE=Leveranstid] }
    { 11020290;;Batch Seq. No.     ;Code20        ;TableRelation="Invoice Proposal Batch Seq.";
                                                   OnValidate=VAR
                                                                InvoiceProposalBatchSeq@1100528600 : Record 11229907;
                                                                PaymentMethod@1100528601 : Record 289;
                                                              BEGIN
                                                                IF "Batch Seq. No." <> '' THEN BEGIN
                                                                  IF NOT PaymentMethod.GET("Payment Method Code") THEN
                                                                    PaymentMethod.INIT;
                                                                  IF PaymentMethod."Direct Debit" THEN BEGIN
                                                                    InvoiceProposalBatchSeq.GET("Batch Seq. No.");
                                                                    InvoiceProposalBatchSeq.TESTFIELD("Transaction Date");
                                                                    VALIDATE("Due Date", InvoiceProposalBatchSeq."Transaction Date");
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Batch Seq. No.;
                                                   Editable=No }
    { 11020300;;Collective List No. (Res.Req.);Code20;
                                                   TableRelation="Resource Req. Collective-List";
                                                   CaptionML=ENU=Collective List No. (Resource Request);
                                                   Editable=No }
    { 11020310;;Event Code         ;Code20        ;TableRelation="Event Code";
                                                   CaptionML=[ENU=Event Code;
                                                              SVE=H„ndelsekod] }
    { 11020320;;Advance Payments   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line".Amount WHERE (Document Type=FIELD(Document Type),
                                                                                              Document No.=FIELD(No.),
                                                                                              Advance Payment=CONST(Yes)));
                                                   CaptionML=ENU=Advance Payments;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 11128014;;E-Invoice Layout Code;Code10       }
    { 11128020;;ROT/RUT reduction  ;Boolean       ;CaptionML=SVE=ROT/RUT avdrag;
                                                   Description=I.012 }
    { 11128050;;Installment text   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Job Ledger Entry".Description WHERE (Project Invoice=CONST(Yes),
                                                                                                            Installment Invoice=CONST(Yes),
                                                                                                            Principal=FIELD(Bill-to Customer No.),
                                                                                                            Document No.=FIELD(No.)));
                                                   OnLookup=VAR
                                                              ProjectInstallment@1100285100 : Record 11012018;
                                                            BEGIN
                                                              ProjectInstallment.SETRANGE(Principal,"Bill-to Customer No.");
                                                              ProjectInstallment.SETRANGE("Document (Invoiced)","No.");
                                                              IF "Job No." <> '' THEN
                                                                ProjectInstallment.SETRANGE("Project No.","Job No.");
                                                              PAGE.RUN(0,ProjectInstallment);
                                                            END;

                                                   CaptionML=[ENU=Description Project Installment;
                                                              NOR=Beskrivelse Prosjektavdrag;
                                                              SVE=Beskrivning Projektavbetalning];
                                                   Description=RFC-217;
                                                   Editable=No }
    { 11128910;;Retention %        ;Decimal       ;CaptionML=[ENU=Retention %;
                                                              NOR=Gjenv‘rende %;
                                                              SVE=Kvarst†ende procent];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PSNA }
    { 11128920;;Retention % 2      ;Decimal       ;CaptionML=[ENU=Retention % 2;
                                                              NOR=Gjenv‘rende % 2;
                                                              SVE=Kvarst†ende procent 2];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PSNA }
    { 11128930;;Retention Payment Terms Code;Code10;
                                                   TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Retention Payment Terms Code;
                                                              NOR=Betalingsvilk†rskode for gjenv‘rende;
                                                              SVE=Kvarst†ende betalningsvillkorskod];
                                                   Description=4PSNA }
    { 11128940;;Retention Payment Terms Code 2;Code10;
                                                   TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Retention Payment Terms Code 2;
                                                              NOR=Betalingsvilk†rskode 2 for gjenv‘rende;
                                                              SVE=Kvarst†ende betalningsvillkorskod 2];
                                                   Description=4PSNA }
    { 11128941;;Ship-to Options    ;Option        ;CaptionML=ENU=Ship-to Options;
                                                   OptionCaptionML=[ENU=Default (Sell-to Address),Alternate Shipping Address,Custom Address;
                                                                    NOR=Standard (Salg til-adresse),Alternativ leveringsadresse,Kundeadresse;
                                                                    SVE=Standard (f”rs„ljningsadress),Alternativ leveransadress,Kundadress];
                                                   OptionString=Default (Sell-to Address),Alternate Shipping Address,Custom Address;
                                                   Description=C034505 }
    { 11128942;;Bill-to Options    ;Option        ;CaptionML=ENU=Bill-to Options;
                                                   OptionCaptionML=[ENU=Default (Customer),Another Customer;
                                                                    NOR=Standard (kunde),En annen kunde;
                                                                    SVE=Standard (kund),Annan kund];
                                                   OptionString=Default (Customer),Another Customer;
                                                   Description=C034505 }
    { 11128950;;Reason Code 2      ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=ENU=Reason Code 2 }
    { 11128960;No;Comments for Logistics;Text50   ;CaptionML=[ENU=Comments for Logistics;
                                                              NOR=Kommentarer for logistikk;
                                                              SVE=Kommentarer f”r logistik] }
    { 11250712;;Finvoice Enabled   ;Boolean       ;CaptionML=ENU=Finvoice Enabled;
                                                   Description=4PSFI_FINVOICE }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                        }
    {    ;Document Type,Sell-to Customer No.       }
    {    ;Document Type,Bill-to Customer No.       }
    {    ;Document Type,Combine Shipments,Bill-to Customer No.,Currency Code,EU 3-Party Trade,Dimension Set ID }
    {    ;Sell-to Customer No.,External Document No. }
    {    ;Document Type,Sell-to Contact No.        }
    {    ;Bill-to Contact No.                      }
    {    ;Incoming Document Entry No.              }
    {    ;Document Date                            }
    {    ;Shipment Date,Status,Location Code,Responsibility Center }
    {    ;Service Contract No.                     }
    {    ;Batch Seq. No.                           }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;No.,Sell-to Customer Name,Amount,Sell-to Contact,Amount Including VAT }
  }
  CODE
  {
    VAR
      Text003@1003 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.;SVE=Du kan inte byta namn p† %1.';
      ConfirmChangeQst@1004 : TextConst '@@@="%1 = a Field Caption like Currency Code";ENU=Do you want to change %1?;NOR=Vil du endre %1?;SVE=Vill du „ndra %1?';
      Text005@1005 : TextConst 'ENU=You cannot reset %1 because the document still has one or more lines.;NOR=Du kan ikke nullstille %1 fordi dokumentet fremdeles har ‚n eller flere linjer.;SVE=Du kan inte †terst„lla %1 d„rf”r att dokumentet har en eller flera rader.';
      Text006@1006 : TextConst 'ENU=You cannot change %1 because the order is associated with one or more purchase orders.;NOR=Du kan ikke endre %1 fordi ordren er knyttet til ‚n eller flere bestillinger.;SVE=Du kan inte „ndra %1 d„rf”r ordern „r kopplad till en eller flera ink”psorder.';
      Text007@1007 : TextConst 'ENU=%1 cannot be greater than %2 in the %3 table.;NOR=%1 kan ikke v‘re st›rre enn %2 i tabellen %3.;SVE=%1 kan inte vara st”rre „n %2 i tabellen %3.';
      Text009@1009 : TextConst 'ENU=Deleting this document will cause a gap in the number series for shipments. An empty shipment %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis dokumentet slettes, vil det oppst† et hull i nummerserien for f›lgesedler. Det opprettes en tom f›lgeseddel %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Borttag av dokument kommer att orsaka en lucka i nr-serien f”r utleveranser. En tom returutleverans %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      Text012@1012 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted invoices. An empty posted invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis dokumentet slettes, vil det oppst† et hull i nummerserien for bokf›rte fakturaer. Det opprettes en tom bokf›rt faktura %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Borttag av detta dokument kommer att orsaka en lucka i nr-serien f”r bokf”rda fakturor. En tom bokf”rd faktura %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      Text014@1014 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted credit memos. An empty posted credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis dokumentet slettes, vil det oppst† et hull i nummerserien for bokf›rte kreditnotaer. Det opprettes en tom bokf›rt kreditnota %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Borttag av detta dokument kommer att orsaka en lucka i nr-serien f”r bokf”rda kreditnotor. En tom bokf”rd kreditnota %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      RecreateSalesLinesMsg@1015 : TextConst '@@@=%1: FieldCaption;ENU=If you change %1, the existing sales lines will be deleted and new sales lines based on the new information on the header will be created.\\Do you want to continue?;NOR=Hvis du endrer %1, slettes eksisterende salgslinjer mens det opprettes nye salgslinjer basert p† nye opplysninger i hodet.\\Vil du fortsette?;SVE=Om du „ndrar %1 kommer befintliga f”rs„ljningsrader att tas bort och nya f”rs„ljningsrader baserade p† den nya informationen i huvudet kommer att skapas.\\Vill du „ndra %1?';
      ResetItemChargeAssignMsg@1075 : TextConst '@@@=%1: FieldCaption;ENU=If you change %1, the existing sales lines will be deleted and new sales lines based on the new information on the header will be created.\The amount of the item charge assignment will be reset to 0.\\Do you want to continue?;NOR=Hvis du endrer %1, slettes eksisterende salgslinjer mens det opprettes nye salgslinjer basert p† nye opplysninger i overskriften.\Bel›pet for varegebyrtilordningen blir tilbakestilt til 0.\\Vil du fortsette?';
      LinesNotUpdatedMsg@1018 : TextConst '@@@=You have changed Order Date on the sales header, but it has not been changed on the existing sales lines.;ENU=You have changed %1 on the sales header, but it has not been changed on the existing sales lines.;NOR=Du har endret %1 i salgshodet, men det har ikke blitt endret p† salgslinjene.;SVE=Du har „ndrat %1 p† f”rs.huvudet men det har inte „ndrats p† befintliga f”rs.rader.\';
      Text019@1019 : TextConst 'ENU=You must update the existing sales lines manually.;NOR=Du m† oppdatere eksisterende salgslinjer manuelt.;SVE=Du m†ste uppdatera de befintliga f”rs„ljningsraderna manuellt.';
      AffectExchangeRateMsg@1020 : TextConst 'ENU=The change may affect the exchange rate that is used for price calculation on the sales lines.;NOR=Endringen kan p†virke valutakursen som brukes til prisberegning p† salgslinjene.;SVE=Žndringen kan p†verka v„xelkursen som anv„nts vid prisber„kningen av f”rs„ljningsraderna.';
      Text021@1021 : TextConst 'ENU=Do you want to update the exchange rate?;NOR=Vil du oppdatere valutakursen?;SVE=Vill du uppdatera valutakursen?';
      Text022@1022 : TextConst 'ENU=You cannot delete this document. Your identification is set up to process from %1 %2 only.;NOR=Du kan ikke slette dette dokumentet. Identifikasjonen din er angitt til bare † behandle fra %1 %2.;SVE=Du kan inte ta bort dokumentet. Ditt ID „r upplagt f”r bearbetning fr†n endast %1 %2.';
      Text024@1024 : TextConst 'ENU=You have modified the %1 field. The recalculation of VAT may cause penny differences, so you must check the amounts afterward. Do you want to update the %2 field on the lines to reflect the new value of %1?;NOR=Du har endret feltet %1. Gjenberegningen av mva. kan gi noen kroners differanse, og du m† kontrollere bel›pene etterp†. Vil du oppdatere feltet %2 p† linjene slik at de gjenspeiler den nye verdien for %1?;SVE=Du har „ndrat f„ltet %1. Omr„kningen av moms kan orsaka ”resskillnader, s† du m†ste kontrollera beloppen efter†t. Vill du uppdatera f„ltet %2 p† raderna f”r att †terspegla det nya v„rdet av %1?';
      Text027@1027 : TextConst 'ENU=Your identification is set up to process from %1 %2 only.;NOR=Identifikasjonen din er angitt til bare † behandle fra %1 %2.;SVE=Ditt ID „r upplagt f”r bearbetning fr†n endast %1 %2.';
      Text028@1028 : TextConst 'ENU=You cannot change the %1 when the %2 has been filled in.;NOR=Du kan ikke endre %1 n†r %2 er fyllt ut.;SVE=Du kan inte „ndra %1 n„r %2 har fyllts i.';
      Text030@1030 : TextConst 'ENU=Deleting this document will cause a gap in the number series for return receipts. An empty return receipt %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis du sletter dette dokumentet, vil det medf›re et hull i nummerserien for retursedler. Det opprettes en tom returseddel %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Borttag av detta dokument kommer att orsaka en lucka i nummerserien f”r returinleveranser. En tom returinleverans %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      Text031@1031 : TextConst '@@@=You have modified Shipment Date.\\Do you want to update the lines?;ENU=You have modified %1.\\Do you want to update the lines?;NOR=Du har endret %1.\\Vil du oppdatere linjene?;SVE=Du har „ndrat %1.\\';
      SalesSetup@1033 : Record 311;
      GLSetup@1034 : Record 98;
      GLAcc@1035 : Record 15;
      SalesHeader@1036 : Record 36;
      SalesLine@1037 : Record 37;
      CustLedgEntry@1038 : Record 21;
      Cust@1039 : Record 18;
      PaymentTerms@1040 : Record 3;
      PaymentMethod@1041 : Record 289;
      CurrExchRate@1042 : Record 330;
      SalesCommentLine@1043 : Record 44;
      PostCode@1045 : Record 225;
      BankAcc@1046 : Record 270;
      SalesShptHeader@1047 : Record 110;
      SalesInvHeader@1048 : Record 112;
      SalesCrMemoHeader@1049 : Record 114;
      ReturnRcptHeader@1050 : Record 6660;
      SalesInvHeaderPrepmt@1101 : Record 112;
      SalesCrMemoHeaderPrepmt@1100 : Record 114;
      GenBusPostingGrp@1051 : Record 250;
      RespCenter@1053 : Record 5714;
      InvtSetup@1054 : Record 313;
      Location@1055 : Record 14;
      WhseRequest@1056 : Record 5765;
      ReservEntry@1001 : Record 337;
      TempReservEntry@1000 : TEMPORARY Record 337;
      CompanyInfo@1002 : Record 79;
      Salesperson@1932 : Record 13;
      UserSetupMgt@1058 : Codeunit 5700;
      NoSeriesMgt@1059 : Codeunit 396;
      CustCheckCreditLimit@1060 : Codeunit 312;
      DimMgt@1065 : Codeunit 408;
      IdentityManagement@1010 : Codeunit 9801;
      ApprovalsMgmt@1082 : Codeunit 1535;
      WhseSourceHeader@1073 : Codeunit 5781;
      SalesLineReserve@1066 : Codeunit 99000832;
      PostingSetupMgt@1085 : Codeunit 48;
      CurrencyDate@1068 : Date;
      HideValidationDialog@1069 : Boolean;
      Confirmed@1070 : Boolean;
      Text035@1076 : TextConst 'ENU=You cannot Release Quote or Make Order unless you specify a customer on the quote.\\Do you want to create customer(s) now?;NOR=Du kan ikke frigi tilbud eller opprette ordrer hvis du ikke angir en kunde i tilbudet.\\Vil du opprette kunde(r) n†?;SVE=Du kan inte Sl„ppa offert eller Skapa order om du inte anger en kund p† offerten.\\Vill du skapa kunden nu?';
      Text037@1078 : TextConst 'ENU=Contact %1 %2 is not related to customer %3.;NOR=Kontakten %1 %2 er ikke knyttet til kunden %3.;SVE=Kontakt %1 %2 tillh”r inte kund %3.';
      Text038@1074 : TextConst 'ENU=Contact %1 %2 is related to a different company than customer %3.;NOR=Kontakten %1 %2 er knyttet til et annet selskap enn kunden %3.;SVE=Kontakt %1 %2 tillh”r ett annat f”retag „n kund %3.';
      Text039@1086 : TextConst 'ENU=Contact %1 %2 is not related to a customer.;NOR=Kontakten %1 %2 er ikke knyttet til en kunde.;SVE=Kontakt %1 %2 tillh”r inte en kund.';
      Text040@1083 : TextConst 'ENU=A won opportunity is linked to this order.\It has to be changed to status Lost before the Order can be deleted.\Do you want to change the status for this opportunity now?;NOR=Det er knyttet salgsmulighetssuksess til denne ordren.\Den m† endre status til Mistet f›r ordren kan slettes.\Vil du endre status for denne salgsmuligheten n†?;SVE=En vunnen aff„rsm”jlighet „r kopplad till den h„r ordern.\M”jligheten m†ste „ndras till F”rlorad innan det g†r att ta bort ordern.\Vill du „ndra m”jlighetens status nu?';
      Text044@1088 : TextConst 'ENU=The status of the opportunity has not been changed. The program has aborted deleting the order.;NOR=Statusen for salgsmuligheten er ikke endret. Programmet har avbrutt sletting av ordren.;SVE=Status p† aff„rsm”jligheten har inte „ndrats. Programmet avbr”t borttag av order.';
      FromSalesInvHeader@1100583000 : Record 112;
      EInvoiceDocumentEncode@1080003 : Codeunit 11128501;
      UserSetupRec@1100485002 : Record 91;
      SkipSellToContact@1016 : Boolean;
      SkipBillToContact@1025 : Boolean;
      Text045@1081 : TextConst 'ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8.";NOR="Du kan ikke endre feltet %1 fordi %2 %3 har %4 = %5 og %6 er allerede tilordnet %7 %8.";SVE="Du kan inte „ndra f„ltet %1 d„rf”r att %2 %3 har %4 = %5 och %6 har redan tilldelats %7 %8."';
      Text048@1091 : TextConst 'ENU=Sales quote %1 has already been assigned to opportunity %2. Would you like to reassign this quote?;NOR=Tilbudet %1 er allerede tilordnet salgsmuligheten %2. Vil du tilordne dette tilbudet p† nytt?;SVE=F”rs„ljningsofferten %1 har redan tilldelats aff„rsm”jligheten %2. Vill du g”ra en annan tilldelning av offerten?';
      Text049@1092 : TextConst 'ENU=The %1 field cannot be blank because this quote is linked to an opportunity.;NOR=Feltet %1 kan ikke v‘re tomt fordi dette tilbudet er koblet til en salgsmulighet.;SVE=F„ltet %1 kan inte vara tomt eftersom offerten „r l„nkad till en aff„rsm”jlighet.';
      PlantSetup@11012031 : Record 11012550;
      PlantHourLineRec@1210190000 : Record 11012574;
      PlantInventoryRec@11012032 : Record 11012555;
      PlantOrderRec@11012033 : Record 11012556;
      InsertMode@1093 : Boolean;
      ExitOrderRec@11012034 : Record 11012559;
      AdjRec@11012035 : Record 11012565;
      HideCreditCheckDialogue@1097 : Boolean;
      Text051@1071 : TextConst 'ENU=The sales %1 %2 already exists.;NOR=Salget %1 %2 finnes allerede.;SVE=F”rs„ljningarna %1 %2 finns redan.';
      Text053@1102 : TextConst 'ENU=You must cancel the approval process if you wish to change the %1.;NOR=Du m† avbryte godkjenningsprosessen hvis du vil endre %1.;SVE=Du m†ste avbryta godk„nnandeprocessen om du vill „ndra %1.';
      Text056@1105 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment invoices. An empty prepayment invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis du sletter dette dokumentet, f†r du et tomrom i nummerserien for forskuddsfakturaer. Det opprettes en tom forskuddsfaktura %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Om du tar bort det h„r dokumentet uppst†r en lucka i nummerserien f”r f”rskottsfakturor. En tom f”rskottsfaktura %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      Text057@1108 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment credit memos. An empty prepayment credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;NOR=Hvis du sletter dette dokumentet, f†r du et tomrom i nummerserien for kreditnotaer for forskudd. Det opprettes en tom kreditnota %1 for † fylle dette hullet i nummerserien.\\Vil du fortsette?;SVE=Om du tar bort det h„r dokumentet uppst†r en lucka i nummerserien f”r kreditnotor f”r f”rskottsbetalning. En tom f”rskottskreditnota %1 kommer att skapas f”r att fylla luckan i nummerserien.\\Vill du forts„tta?';
      Text061@1110 : TextConst 'ENU=%1 is set up to process from %2 %3 only.;NOR=%1 er konfigurert for behandling bare fra %2 %3.;SVE=%1 har endast konfigurerats f”r behandling fr†n %2 %3.';
      Text062@1072 : TextConst 'ENU=You cannot change %1 because the corresponding %2 %3 has been assigned to this %4.;NOR=Du kan ikke endre %1 fordi den tilh›rende %2 %3 er tilordnet til denne %4.;SVE=Du kan inte „ndra %1 eftersom motsvarande %2 %3 har tilldelats till denna %4.';
      Text063@1077 : TextConst 'ENU=Reservations exist for this order. These reservations will be canceled if a date conflict is caused by this change.\\Do you want to continue?;NOR=Det finnes reservasjoner for denne bestillingen. Reservasjonene vil bli slettet hvis denne endringen for†rsaker en datokonflikt.\\Vil du fortsette?;SVE=Det finns reservationer f”r den h„r ordern. Reservationerna tas bort om „ndringen leder till en datumkonflikt.\\Vill du forts„tta?';
      Text064@1090 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?;NOR=Du kan ha endret en dimensjon.\\Vil du oppdatere linjene?;SVE=Du kanske har „ndrat en dimension.\\Vill du uppdatera raderna?';
      UpdateDocumentDate@1120 : Boolean;
      Text066@1095 : TextConst 'ENU=You cannot change %1 to %2 because an open inventory pick on the %3.;NOR=Du kan ikke endre %1 til %2 p† grunn av et †pent lagerplukk p† %3.;SVE=Det g†r inte att „ndra %1 till %2 p† grund av en ”ppen lagerplockning p† %3.';
      Text070@1096 : TextConst 'ENU=You cannot change %1  to %2 because an open warehouse shipment exists for the %3.;NOR=Du kan ikke endre %1 til %2 fordi det finnes en †pen lagerlevering for %3.;SVE=Det g†r inte att „ndra %1 till %2 p† grund av att det finns en ”ppen dist.lagerutleverans f”r %3.';
      BilltoCustomerNoChanged@1121 : Boolean;
      SelectNoSeriesAllowed@1067 : Boolean;
      PrepaymentInvoicesNotPaidErr@1011 : TextConst '@@@=You cannot post the document of type Order with the number 1001 before all related prepayment invoices are posted.;ENU=You cannot post the document of type %1 with the number %2 before all related prepayment invoices are posted.;NOR=Du kan ikke bokf›re dokumentet av typen %1 med nummeret %2 f›r alle relaterte forskuddsfakturaer blir bokf›rt.;SVE=Det finns obetalda f”rskottsfakturor som „r relaterade till dokumentet med typen %1 och numret %2.';
      Text072@1013 : TextConst 'ENU=There are unpaid prepayment invoices related to the document of type %1 with the number %2.;NOR=Det finnes ubetalte forskuddsfakturaer relatert til dokumentet av typen %1 med nummer %2.;SVE=Det finns obetalda f”rskottsfakturor som „r relaterade till dokumentet med typen %1 och numret %2.';
      DeferralLineQst@1044 : TextConst 'ENU=Do you want to update the deferral schedules for the lines?;NOR=Vil du oppdatere tidsplanene for periodisering for linjene?;SVE=Vill du uppdatera periodiseringsschemana f”r raderna?';
      SynchronizingMsg@1026 : TextConst 'ENU=Synchronizing ...\ from: Sales Header with %1\ to: Assembly Header with %2.;NOR=Synkroniserer ...\ fra: Salgshode med %1\ til: Monteringshode med %2.;SVE=Synkroniserar...\ fr†n: F”rs„ljningshuvud med %1\ till: Monteringsrubrik med %2.';
      EstimateTxt@1023 : TextConst 'ENU=Estimate;NOR=Estimat;SVE=Kalkyl';
      ShippingAdviceErr@1029 : TextConst 'ENU=This document cannot be shipped completely. Change the value in the Shipping Advice field to Partial.;NOR=Dette dokumentet kan ikke leveres fullstendig. Endre verdien i feltet Leverings›nske til Delvis.;SVE=Ordern m†ste vara en fullst„ndig utleverans.';
      PostedDocsToPrintCreatedMsg@1084 : TextConst 'ENU=One or more related posted documents have been generated during deletion to fill gaps in the posting number series. You can view or print the documents from the respective document archive.;NOR=Ett eller flere relaterte bokf›rte dokumenter har blitt generert under slettingen for † fylle hull i bokf›ringsnummerseriene. Du kan vise eller skrive ut dokumentene fra det respektive dokumentarkivet.;SVE=Ett eller flera relaterade bokf”rda dokument har genererats under borttagningen f”r att fylla i tomrummen i bokf”ringsnummerserien. Du kan visa eller skriva ut dokumenten fr†n respektive dokumentarkiv.';
      DocumentNotPostedClosePageQst@1061 : TextConst 'ENU=The document has been saved but is not yet posted.\\Are you sure you want to exit?;NOR=Dokumentet er lagret, men er ikke bokf›rt enn†.\\Er du sikker p† at du vil avslutte?;SVE=Dokumentet har inte bokf”rts.\Vill du avsluta?';
      OIOXMLDocumentEncode@1101100001 : Codeunit 11128570;
      Text13606@1101100002 : TextConst 'ENU=does not contain a valid, 13-digit EAN No.;SVE=inneh†ller inte ett giltigt 13-siffrors EAN nr';
      Text13607@1101100003 : TextConst 'ENU=%1 %2 is not supported in this version of OIOXML.;NOR=%1 %2 st›ttes ikke i denne versjon av OIOXML.;SVE=%1 %2 st”ds inte i denna version av OIOXML.';
      Text10606@1080000 : TextConst 'ENU=The GLN No. field does not contain a valid, 13-digit GLN  number;NOR=GLN-nr.-feltet inneholder ikke et gyldig, 13-sifret GLN-nummer';
      SelectCustomerTemplateQst@1008 : TextConst 'ENU=Do you want to select the customer template?;NOR=Vil du velge kundemalen?;SVE=Vill du v„lja kundmallen?';
      ModifyCustomerAddressNotificationLbl@1062 : TextConst 'ENU=Update the address;NOR=Oppdater adressen';
      DontShowAgainActionLbl@1064 : TextConst 'ENU=Don''t show again;NOR=Ikke vis igjen';
      ModifyCustomerAddressNotificationMsg@1063 : TextConst '@@@="%1=customer name";ENU=The address you entered for %1 is different from the customer''s existing address.;NOR=Adressen du angav for %1, er forskjellig fra kundens eksisterende adresse.';
      ValidVATNoMsg@1254 : TextConst 'ENU=The VAT registration number is valid.;NOR=Organisasjonsnummeret er gyldig.';
      InvalidVatRegNoMsg@1255 : TextConst 'ENU=The VAT registration number is not valid. Try entering the number again.;NOR=Organisasjonsnummeret er ikke gyldig. Pr›v † oppdatere nummeret p† nytt.';
      SellToCustomerTxt@1052 : TextConst 'ENU=Sell-to Customer;NOR=Salg til-kunde;SVE=F”rs„ljningskund';
      BillToCustomerTxt@1057 : TextConst 'ENU=Bill-to Customer;NOR=Faktura til-kunde;SVE=Faktureringskund';
      ModifySellToCustomerAddressNotificationNameTxt@1087 : TextConst 'ENU=Update Sell-to Customer Address;NOR=Oppdater Salg til-kundeadresse';
      ModifySellToCustomerAddressNotificationDescriptionTxt@1098 : TextConst 'ENU=Warn if the sell-to address on sales documents is different from the customer''s existing address.;NOR=Varsle hvis Salg til-adressen p† salgsdokumenter er forskjellig fra kundens eksisterende adresse.';
      ModifyBillToCustomerAddressNotificationNameTxt@1089 : TextConst 'ENU=Update Bill-to Customer Address;NOR=Oppdater Faktura til-kundeadresse';
      ModifyBillToCustomerAddressNotificationDescriptionTxt@1099 : TextConst 'ENU=Warn if the bill-to address on sales documents is different from the customer''s existing address.;NOR=Varsle hvis faktura til-adressen p† salgsdokumenter er forskjellig fra kundens eksisterende adresse.';
      DuplicatedCaptionsNotAllowedErr@1094 : TextConst 'ENU=Field captions must not be duplicated when using this method. Use UpdateSalesLinesByFieldNo instead.;NOR=Felttitlene m† ikke dupliseres n†r du bruker denne metoden. Bruk i stedet UpdateSalesLinesByFieldNo.';
      PhoneNoCannotContainLettersErr@1080 : TextConst 'ENU=You cannot enter letters in this field.;NOR=Du kan ikke angi bokstaver i dette feltet.';
      MissingExchangeRatesQst@1032 : TextConst '@@@=%1 - currency code, %2 - posting date;ENU=There are no exchange rates for currency %1 and date %2. Do you want to add them now? Otherwise, the last change you made will be reverted.;NOR=Det finnes ingen valutakurser for valutaen %1 og datoen %2. Vil du legge dem til n†? Ellers tilbakestilles den siste endringen du gjorde.;SVE=Vill du uppdatera raderna?';
      SplitMessageTxt@1079 : TextConst '@@@=Some message text 1.\Some message text 2.;ENU=%1\%2;NOR=%1\%2';
      StatusCheckSuspended@1103 : Boolean;
      Text11012001@1210190004 : TextConst 'ENU=(%1) may not be greater than the de %2 (%3);NOR=(%1) kan ikke v‘re mer enn %2 (%3);SVE=(%1) f†r inte vara mer „n %2 (%3)';
      CompanyLogistics@1100485000 : Text[30];
      Text11012002@1100485001 : TextConst 'ENU=must be equal to the Project No. ''%1'' of the Plant Location ''%2'';NOR=m† v‘re lik prosjektnr. ''%1'' for maskinlokasjonen ''%2'';SVE=m†ste vara lika med projektnr ''%1'' i Maskinplatsen ''%2''';
      Text11012003@1100485004 : TextConst 'ENU=may not be before the %1;NOR=kan ikke v‘re f›r %1;SVE=f†r inte vara f”re %1';
      Text11012004@1100485003 : TextConst 'ENU=may not be after the %1;NOR=kan ikke v‘re etter %1;SVE=f†r inte vara efter %1';
      ServOrderRec@1100485005 : Record 11012823;
      DPA_Management@1100000999 : Codeunit 11012783;
      TempDocumentEntry@1210190001 : TEMPORARY Record 265;
      ServiceSetup@1100526200 : Record 11012800;
      Text11012005@1100525000 : TextConst 'ENU=This function can not be used for generated Invoices;NOR=Denne funksjonen kan ikke brukes for genererte fakturaer;SVE=Den h„r funktionen kan inte anv„ndas f”r skapade fakturor';
      Text11012006@1100525001 : TextConst 'ENU=This function can not be used for generated credit memo''s;NOR=Denne funksjonen kan ikke brukes for genererte kreditnotaer';
      AskRecreateSalesLines@1100525003 : Boolean;
      SkipRecreateSalesLines@1100525002 : Boolean;
      Text11128576@1100285001 : TextConst 'ENU=does not contain a valid, 13-digit EAN no.;NOR=inneholder ikke et gyldig 13-tegns Gtin nr.;SVE=inneh†ller inte ett giltigt 13-teckens EAN nr.';
      Text11128577@1100285000 : TextConst 'ENU=%1 %2 is not supported in this version of OIOUBL.;SVE=%1 %2 st”ds inte i denna version av OIOXML.';
      SkipModify@1100528400 : Boolean;
      Text11012007@1100528401 : TextConst 'ENU=Creating PDF File from %1 %2.';
      AdvancePayment@1100529600 : Boolean;
      SkipPrintingAttachmentsAfterPostingInvoice@1100528402 : Boolean;
      SkipCheckCustomerNoOnServiceOrder@1100528600 : Boolean;
      FPSLicenseManagement@1100528500 : Codeunit 11229289;
      Text11012008@1100527450 : TextConst 'ENU=No customer selected';

    [External]
    PROCEDURE InitInsert@61();
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeInitInsert(Rec,xRec,IsHandled);
      IF NOT IsHandled THEN
        IF "No." = '' THEN BEGIN
          TestNoSeries;
          NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series","Posting Date","No.","No. Series");
        END;

      OnInitInsertOnBeforeInitRecord(Rec,xRec);
      InitRecord;
    END;

    [External]
    PROCEDURE InitRecord@10();
    VAR
      ArchiveManagement@1000 : Codeunit 5063;
      IsHandled@1001 : Boolean;
    BEGIN
      GetSalesSetup;
      IsHandled := FALSE;
      OnBeforeInitRecord(Rec,IsHandled);
      IF NOT IsHandled THEN
        CASE "Document Type" OF
          "Document Type"::Quote,"Document Type"::Order:
            BEGIN
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Invoice Nos.");
              NoSeriesMgt.SetDefaultSeries("Shipping No. Series",SalesSetup."Posted Shipment Nos.");
              IF "Document Type" = "Document Type"::Order THEN BEGIN
                IF SalesSetup."Posted Prepmt. Inv. Nos." <> '' THEN  //**4PS.n
                  NoSeriesMgt.SetDefaultSeries("Prepayment No. Series",SalesSetup."Posted Prepmt. Inv. Nos.");
                IF SalesSetup."Posted Prepmt. Cr. Memo Nos." <> '' THEN  //**4PS.n
                  NoSeriesMgt.SetDefaultSeries("Prepmt. Cr. Memo No. Series",SalesSetup."Posted Prepmt. Cr. Memo Nos.");
              END;
            END;
          "Document Type"::Invoice:
            BEGIN
              //**4PS.sn
              IF "Plant Invoice" THEN BEGIN
                IF "Sell-to Customer No." = '' THEN BEGIN
                  IF ("No. Series" <> '') AND
                     (SalesSetup."Internal Plant Invoice Nos." = SalesSetup."Posted Internal Plant Invoices")
                  THEN
                    "Posting No. Series" := "No. Series"
                  ELSE
                    NoSeriesMgt.SetDefaultSeries("Posting No. Series", SalesSetup."Posted Internal Plant Invoices");
                END ELSE BEGIN
                  IF ("No. Series" <> '') AND
                     (SalesSetup."Plant Invoice Nos." = SalesSetup."Posted Plant Invoice Nos.")

                  THEN
                    "Posting No. Series" := "No. Series"
                  ELSE
                    NoSeriesMgt.SetDefaultSeries("Posting No. Series", SalesSetup."Posted Plant Invoice Nos.");
                END;
              END ELSE BEGIN
              //**4PS.en
                IF ("No. Series" <> '') AND
                   (SalesSetup."Invoice Nos." = SalesSetup."Posted Invoice Nos.")
                THEN
                  "Posting No. Series" := "No. Series"
                ELSE
                  NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Invoice Nos.");
              END;  //**4PS.n
              IF SalesSetup."Shipment on Invoice" THEN
                NoSeriesMgt.SetDefaultSeries("Shipping No. Series",SalesSetup."Posted Shipment Nos.");
            END;
          "Document Type"::"Return Order":
            BEGIN
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Credit Memo Nos.");
              NoSeriesMgt.SetDefaultSeries("Return Receipt No. Series",SalesSetup."Posted Return Receipt Nos.");
            END;
          "Document Type"::"Credit Memo":
            BEGIN
              //**4PS.sn
              IF "Plant Invoice" THEN BEGIN
                IF "Sell-to Customer No." = '' THEN BEGIN
                  IF ("No. Series" <> '') AND
                     (SalesSetup."Internal Plant Credit Memos" = SalesSetup."Posted Int. Plant Credit Memos")
                  THEN
                    "Posting No. Series" := "No. Series"
                  ELSE
                    NoSeriesMgt.SetDefaultSeries("Posting No. Series", SalesSetup."Posted Int. Plant Credit Memos");
                END ELSE BEGIN
                  IF ("No. Series" <> '') AND
                     (SalesSetup."Plant Credit Memo Nos." = SalesSetup."Posted Plant Credit Memos")
                  THEN
                    "Posting No. Series" := "No. Series"
                  ELSE
                    NoSeriesMgt.SetDefaultSeries("Posting No. Series", SalesSetup."Posted Plant Credit Memos");
                END;
              END ELSE BEGIN
              //**4PS.en
                IF ("No. Series" <> '') AND
                   (SalesSetup."Credit Memo Nos." = SalesSetup."Posted Credit Memo Nos.")
                THEN
                  "Posting No. Series" := "No. Series"
                ELSE
                  NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Credit Memo Nos.");
              END; //**4PS.n
              IF SalesSetup."Return Receipt on Credit Memo" THEN
                NoSeriesMgt.SetDefaultSeries("Return Receipt No. Series",SalesSetup."Posted Return Receipt Nos.");
            END;
        END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::Quote] THEN
        BEGIN
          "Shipment Date" := WORKDATE;
          "Order Date" := WORKDATE;
          "Arrival Date" := "Shipment Date";  //**4PS.n
          "Rental Starting Date" := "Arrival Date";  //**4PS.n
        END;
      IF "Document Type" = "Document Type"::"Return Order" THEN
        "Order Date" := WORKDATE;

      IF NOT ("Document Type" IN ["Document Type"::"Blanket Order","Document Type"::Quote]) AND
         ("Posting Date" = 0D)
      THEN
        "Posting Date" := WORKDATE;

      IF SalesSetup."Default Posting Date" = SalesSetup."Default Posting Date"::"No Date" THEN
        "Posting Date" := 0D;

      "Document Date" := WORKDATE;
      IF "Document Type" = "Document Type"::Quote THEN
        CalcQuoteValidUntilDate;

      UpdateLocationCode(Cust."Location Code");

      IF IsCreditDocType THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;

      "Posting Description" := FORMAT("Document Type") + ' ' + "No.";

      UpdateOutboundWhseHandlingTime;

      "Responsibility Center" := UserSetupMgt.GetRespCenter(0,"Responsibility Center");
      "Doc. No. Occurrence" := ArchiveManagement.GetNextOccurrenceNo(DATABASE::"Sales Header","Document Type","No.");

      //**4PS.sn
      IF "Salesperson Code" = '' THEN
        IF UserSetupRec.GET(USERID) THEN
          "Salesperson Code" := UserSetupRec.Salesperson;
      //**4PS.en

      OnAfterInitRecord(Rec);
    END;

    LOCAL PROCEDURE InitNoSeries@77();
    BEGIN
      IF xRec."Shipping No." <> '' THEN BEGIN
        "Shipping No. Series" := xRec."Shipping No. Series";
        "Shipping No." := xRec."Shipping No.";
      END;
      IF xRec."Posting No." <> '' THEN BEGIN
        "Posting No. Series" := xRec."Posting No. Series";
        "Posting No." := xRec."Posting No.";
      END;
      IF xRec."Return Receipt No." <> '' THEN BEGIN
        "Return Receipt No. Series" := xRec."Return Receipt No. Series";
        "Return Receipt No." := xRec."Return Receipt No.";
      END;
      IF xRec."Prepayment No." <> '' THEN BEGIN
        "Prepayment No. Series" := xRec."Prepayment No. Series";
        "Prepayment No." := xRec."Prepayment No.";
      END;
      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
      END;

      OnAfterInitNoSeries(Rec);
    END;

    [Internal]
    PROCEDURE AssistEdit@1(OldSalesHeader@1000 : Record 36) : Boolean;
    VAR
      SalesHeader2@1001 : Record 36;
    BEGIN
      WITH SalesHeader DO BEGIN
        COPY(Rec);
        GetSalesSetup;
        TestNoSeries;
        IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldSalesHeader."No. Series","No. Series") THEN BEGIN
          IF ("Sell-to Customer No." = '') AND ("Sell-to Contact No." = '') THEN BEGIN
            HideCreditCheckDialogue := FALSE;
            CheckCreditMaxBeforeInsert;
            HideCreditCheckDialogue := TRUE;
          END;
          NoSeriesMgt.SetSeries("No.");
          IF SalesHeader2.GET("Document Type","No.") THEN
            ERROR(Text051,LOWERCASE(FORMAT("Document Type")),"No.");
          Rec := SalesHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    [External]
    PROCEDURE TestNoSeries@6();
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      GetSalesSetup;
      IsHandled := FALSE;
      OnBeforeTestNoSeries(Rec,IsHandled);
      IF NOT IsHandled THEN
      CASE "Document Type" OF
          //**4PS.sn
          "Document Type"::"Invoice Proposal":
            IF "Plant Invoice" THEN BEGIN
              PlantSetup.GET;
              PlantSetup.TESTFIELD("Invoice Suggestion Nos.");
            END ELSE IF "Service Invoice" THEN BEGIN
              ServiceSetup.GET;
              ServiceSetup.TESTFIELD("Invoice Proposal Nos.");
            END;
          //**4PS.en
          "Document Type"::Quote:
            SalesSetup.TESTFIELD("Quote Nos.");
          "Document Type"::Order:
            SalesSetup.TESTFIELD("Order Nos.");
          "Document Type"::Invoice:
            BEGIN
              //**4PS.sn
              IF "Plant Invoice" THEN
                IF "Sell-to Customer No." = '' THEN BEGIN
                  SalesSetup.TESTFIELD("Internal Plant Invoice Nos.");
                  SalesSetup.TESTFIELD("Posted Internal Plant Invoices");
                END ELSE BEGIN
                  SalesSetup.TESTFIELD("Plant Invoice Nos.");
                  SalesSetup.TESTFIELD("Posted Plant Invoice Nos.");
                END
              ELSE BEGIN
              //**4PS.en
                SalesSetup.TESTFIELD("Invoice Nos.");
                SalesSetup.TESTFIELD("Posted Invoice Nos.");
              END;  //**4PS.n
            END;
          "Document Type"::"Return Order":
            SalesSetup.TESTFIELD("Return Order Nos.");
          "Document Type"::"Credit Memo":
            BEGIN
              //**4PS.sn
              IF "Plant Invoice" THEN
                IF "Sell-to Customer No." = '' THEN BEGIN
                  SalesSetup.TESTFIELD(SalesSetup."Internal Plant Credit Memos");
                  SalesSetup.TESTFIELD(SalesSetup."Posted Int. Plant Credit Memos");
                END ELSE BEGIN
                  SalesSetup.TESTFIELD(SalesSetup."Plant Credit Memo Nos.");
                  SalesSetup.TESTFIELD(SalesSetup."Posted Plant Credit Memos");
                END
              ELSE BEGIN
              //**4PS.en
                SalesSetup.TESTFIELD("Credit Memo Nos.");
                SalesSetup.TESTFIELD("Posted Credit Memo Nos.");
              END;  //**4PS.n
            END;
          "Document Type"::"Blanket Order":
            SalesSetup.TESTFIELD("Blanket Order Nos.");
        END;

      OnAfterTestNoSeries(Rec);
    END;

    [External]
    PROCEDURE GetNoSeriesCode@9() : Code[20];
    VAR
      NoSeriesCode@1000 : Code[20];
      IsHandled@1001 : Boolean;
    BEGIN
      GetSalesSetup;
      IsHandled := FALSE;
      OnBeforeGetNoSeriesCode(Rec,SalesSetup,NoSeriesCode,IsHandled);
      IF IsHandled THEN
        EXIT;

      CASE "Document Type" OF
        //**4PS.sn
        "Document Type"::"Invoice Proposal":
          BEGIN
            IF "Plant Invoice" THEN
              NoSeriesCode := PlantSetup."Invoice Suggestion Nos.";
            IF "Service Invoice" THEN
              NoSeriesCode := ServiceSetup."Invoice Proposal Nos.";
          END;
        //**4PS.en
        "Document Type"::Quote:
          NoSeriesCode := SalesSetup."Quote Nos.";
        "Document Type"::Order:
          NoSeriesCode := SalesSetup."Order Nos.";
        "Document Type"::Invoice:
          //**4PS.sn
          IF "Plant Invoice" THEN
            IF "Sell-to Customer No." = '' THEN
              NoSeriesCode := SalesSetup."Internal Plant Invoice Nos."
            ELSE
              NoSeriesCode := SalesSetup."Plant Invoice Nos."
          ELSE
          //**4PS.en
            NoSeriesCode := SalesSetup."Invoice Nos.";
        "Document Type"::"Return Order":
          NoSeriesCode := SalesSetup."Return Order Nos.";
        "Document Type"::"Credit Memo":
          //**4PS.sn
          IF "Plant Invoice" THEN
            IF "Sell-to Customer No." = '' THEN
              NoSeriesCode := SalesSetup."Internal Plant Credit Memos"
            ELSE
              NoSeriesCode := SalesSetup."Plant Credit Memo Nos."
          ELSE
          //**4PS.en
            NoSeriesCode := SalesSetup."Credit Memo Nos.";
        "Document Type"::"Blanket Order":
          NoSeriesCode := SalesSetup."Blanket Order Nos.";
      END;
      OnAfterGetNoSeriesCode(Rec,SalesSetup,NoSeriesCode);
      EXIT(NoSeriesMgt.GetNoSeriesWithCheck(NoSeriesCode,SelectNoSeriesAllowed,"No. Series"));
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@8() PostingNos : Code[20];
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      GetSalesSetup;
      IsHandled := FALSE;
      OnBeforeGetPostingNoSeriesCode(Rec,SalesSetup,PostingNos,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF IsCreditDocType THEN
        PostingNos := SalesSetup."Posted Credit Memo Nos."
      ELSE
        PostingNos := SalesSetup."Posted Invoice Nos.";

      OnAfterGetPostingNoSeriesCode(Rec,PostingNos);
    END;

    LOCAL PROCEDURE GetPostingPrepaymentNoSeriesCode@59() PostingNos : Code[20];
    BEGIN
      IF IsCreditDocType THEN
        PostingNos := SalesSetup."Posted Prepmt. Cr. Memo Nos."
      ELSE
        PostingNos := SalesSetup."Posted Prepmt. Inv. Nos.";

      OnAfterGetPrepaymentPostingNoSeriesCode(Rec,PostingNos);
    END;

    LOCAL PROCEDURE TestNoSeriesDate@40(No@1000 : Code[20];NoSeriesCode@1001 : Code[20];NoCapt@1002 : Text[1024];NoSeriesCapt@1004 : Text[1024]);
    VAR
      NoSeries@1005 : Record 308;
    BEGIN
      IF (No <> '') AND (NoSeriesCode <> '') THEN BEGIN
        NoSeries.GET(NoSeriesCode);
        IF NoSeries."Date Order" THEN
          ERROR(
            Text045,
            FIELDCAPTION("Posting Date"),NoSeriesCapt,NoSeriesCode,
            NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
            NoCapt,No);
      END;
    END;

    [External]
    PROCEDURE ConfirmDeletion@11() : Boolean;
    VAR
      SourceCode@1002 : Record 230;
      SourceCodeSetup@1001 : Record 242;
      PostSalesDelete@1000 : Codeunit 363;
      ConfirmManagement@1003 : Codeunit 27;
    BEGIN
      SourceCodeSetup.GET;
      SourceCodeSetup.TESTFIELD("Deleted Document");
      SourceCode.GET(SourceCodeSetup."Deleted Document");

      PostSalesDelete.InitDeleteHeader(
        Rec,SalesShptHeader,SalesInvHeader,SalesCrMemoHeader,ReturnRcptHeader,
        SalesInvHeaderPrepmt,SalesCrMemoHeaderPrepmt,SourceCode.Code);

      IF SalesShptHeader."No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text009,SalesShptHeader."No."),TRUE) THEN
          EXIT;
      IF SalesInvHeader."No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text012,SalesInvHeader."No."),TRUE) THEN
          EXIT;
      IF SalesCrMemoHeader."No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text014,SalesCrMemoHeader."No."),TRUE) THEN
          EXIT;
      IF ReturnRcptHeader."No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text030,ReturnRcptHeader."No."),TRUE) THEN
          EXIT;
      IF "Prepayment No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text056,SalesInvHeaderPrepmt."No."),TRUE) THEN
          EXIT;
      IF "Prepmt. Cr. Memo No." <> '' THEN
        IF NOT ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text057,SalesCrMemoHeaderPrepmt."No."),TRUE) THEN
          EXIT;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetCust@2(CustNo@1000 : Code[20]);
    VAR
      O365SalesInitialSetup@1001 : Record 2110;
    BEGIN
      IF NOT (("Document Type" = "Document Type"::Quote) AND (CustNo = '')) THEN BEGIN
        IF CustNo <> Cust."No." THEN
          Cust.GET(CustNo);
      END ELSE
        CLEAR(Cust);
      IF IdentityManagement.IsInvAppId AND O365SalesInitialSetup.GET THEN
        Cust."Payment Terms Code" := O365SalesInitialSetup."Default Payment Terms Code";
    END;

    LOCAL PROCEDURE GetSalesSetup@248();
    BEGIN
      SalesSetup.GET;
      OnAfterGetSalesSetup(Rec,SalesSetup,CurrFieldNo);
    END;

    [External]
    PROCEDURE SalesLinesExist@3() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      EXIT(NOT SalesLine.ISEMPTY);
    END;

    LOCAL PROCEDURE RecreateSalesLines@4(ChangedFieldName@1000 : Text[100]);
    VAR
      TempSalesLine@1001 : TEMPORARY Record 37;
      ItemChargeAssgntSales@1004 : Record 5809;
      TempItemChargeAssgntSales@1003 : TEMPORARY Record 5809;
      TempInteger@1006 : TEMPORARY Record 2000000026;
      TempATOLink@1009 : TEMPORARY Record 904;
      ATOLink@1010 : Record 904;
      TransferExtendedText@1005 : Codeunit 378;
      ExtendedTextAdded@1002 : Boolean;
      ConfirmText@1007 : Text;
      IsHandled@1008 : Boolean;
      LastLine@1100528500 : Integer;
    BEGIN
      //**4PS.sn
      IF SkipRecreateSalesLines THEN BEGIN
        AskRecreateSalesLines := TRUE;
        EXIT;
      END;
      //**4PS.en

      IF NOT SalesLinesExist THEN
        EXIT;

      OnRecreateSalesLinesOnBeforeConfirm(Rec,xRec,ChangedFieldName,HideValidationDialog,Confirmed,IsHandled);
      IF NOT IsHandled THEN
        IF GetHideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE BEGIN
          IF HasItemChargeAssignment THEN
            ConfirmText := ResetItemChargeAssignMsg
          ELSE
            ConfirmText := RecreateSalesLinesMsg;
          Confirmed := CONFIRM(ConfirmText,FALSE,ChangedFieldName);
        END;

      IF Confirmed THEN BEGIN
        SalesLine.LOCKTABLE;
        ItemChargeAssgntSales.LOCKTABLE;
        ReservEntry.LOCKTABLE;
        //MODIFY; //**4PS.o
        MODIFY(TRUE); //**4PS.n

        //**4PS.sn
        SalesLine.RESET;
        SalesLine.SETRANGE("Document Type","Document Type");
        SalesLine.SETRANGE("Document No.","No.");
        SalesLine.SETFILTER(Recipe, '<>%1', '');
        IF SalesLine.FINDLAST THEN
          LastLine := SalesLine."Line No.";
        //**4PS.en

        OnBeforeRecreateSalesLines(Rec);
        SalesLine.RESET;
        SalesLine.SETRANGE("Document Type","Document Type");
        SalesLine.SETRANGE("Document No.","No.");
        SalesLine.SETFILTER(Recipe, '%1', ''); //**4PS.n
        OnRecreateSalesLinesOnAfterSetSalesLineFilters(SalesLine);
        IF SalesLine.FINDSET THEN BEGIN
          TempReservEntry.DELETEALL;
          RecreateReservEntryReqLine(TempSalesLine,TempATOLink,ATOLink);
          TransferItemChargeAssgntSalesToTemp(ItemChargeAssgntSales,TempItemChargeAssgntSales);
          SalesLine.DELETEALL(TRUE);
          TempDocumentEntry.DELETEALL; //**4PS.n

          SalesLine.INIT;
          SalesLine."Line No." := LastLine; //**4PS.n
          TempSalesLine.FINDSET;
          ExtendedTextAdded := FALSE;
          SalesLine.BlockDynamicTracking(TRUE);
          REPEAT
            IF TempSalesLine."Attached to Line No." = 0 THEN BEGIN
      //      CreateSalesLine(TempSalesLine); //**4PS.o
              CreateSalesLine(TempSalesLine,ChangedFieldName); //**4PS.n
              InsertOldLineNoAndNewLineNo(TempSalesLine."Line No.",SalesLine."Line No.");  //**4PS.n
              ExtendedTextAdded := FALSE;
              OnAfterRecreateSalesLine(SalesLine,TempSalesLine);

              IF SalesLine.Type = SalesLine.Type::Item THEN
                RecreateSalesLinesFillItemChargeAssignment(SalesLine,TempSalesLine,TempItemChargeAssgntSales);

              IF SalesLine.Type = SalesLine.Type::"Charge (Item)" THEN BEGIN
                TempInteger.INIT;
                TempInteger.Number := SalesLine."Line No.";
                TempInteger.INSERT;
              END;
            END ELSE
              IF NOT ExtendedTextAdded THEN BEGIN
                TransferExtendedText.SalesCheckIfAnyExtText(SalesLine,TRUE);
                TransferExtendedText.InsertSalesExtText(SalesLine);
                OnAfterTransferExtendedTextForSalesLineRecreation(SalesLine,TempSalesLine);

                SalesLine.FINDLAST;
                ExtendedTextAdded := TRUE;
              END;
            SalesLineReserve.CopyReservEntryFromTemp(TempReservEntry,TempSalesLine,SalesLine."Line No.");
            RecreateReqLine(TempSalesLine,SalesLine."Line No.",FALSE);
            SynchronizeForReservations(SalesLine,TempSalesLine);
            IF TempATOLink.AsmExistsForSalesLine(TempSalesLine) THEN BEGIN
              ATOLink := TempATOLink;
              ATOLink."Document Line No." := SalesLine."Line No.";
              ATOLink.INSERT;
              ATOLink.UpdateAsmFromSalesLineATOExist(SalesLine);
              TempATOLink.DELETE;
            END;
          UNTIL TempSalesLine.NEXT = 0;

          CreateItemChargeAssgntSales(TempItemChargeAssgntSales,TempSalesLine,TempInteger);

          TempSalesLine.SETRANGE(Type);
          TempSalesLine.DELETEALL;
          OnAfterDeleteAllTempSalesLines;
          ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
          TempItemChargeAssgntSales.DELETEALL;
        END;
        //**4PS.sn
        SalesLine.RESET;
        SalesLine.SETRANGE("Document Type","Document Type");
        SalesLine.SETRANGE("Document No.","No.");
        SalesLine.SETFILTER(Recipe, '<>%1', '');
        IF SalesLine.FINDSET THEN BEGIN
          REPEAT
            SalesLine.VALIDATE("Currency Code", "Currency Code");
            SalesLine.CalculateSalesRecipe;
            SalesLine.MODIFY;
          UNTIL SalesLine.NEXT = 0;
        END;
        //**4PS.en
      END ELSE
        Rec := xRec;

      SalesLine.BlockDynamicTracking(FALSE);
    END;

    LOCAL PROCEDURE RecreateSalesLinesFillItemChargeAssignment@216(SalesLine@1000 : Record 37;TempSalesLine@1001 : TEMPORARY Record 37;VAR TempItemChargeAssgntSales@1002 : TEMPORARY Record 5809);
    BEGIN
      ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type",TempSalesLine."Document Type");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.",TempSalesLine."Document No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.",TempSalesLine."Line No.");
      IF TempItemChargeAssgntSales.FINDSET THEN
        REPEAT
          IF NOT TempItemChargeAssgntSales.MARK THEN BEGIN
            TempItemChargeAssgntSales."Applies-to Doc. Line No." := SalesLine."Line No.";
            TempItemChargeAssgntSales.Description := SalesLine.Description;
            TempItemChargeAssgntSales.MODIFY;
            TempItemChargeAssgntSales.MARK(TRUE);
          END;
        UNTIL TempItemChargeAssgntSales.NEXT = 0;
    END;

    [External]
    PROCEDURE MessageIfSalesLinesExist@5(ChangedFieldName@1000 : Text[100]);
    VAR
      MessageText@1001 : Text;
    BEGIN
      IF SalesLinesExist AND NOT GetHideValidationDialog THEN BEGIN
        MessageText := STRSUBSTNO(LinesNotUpdatedMsg,ChangedFieldName);
        MessageText := STRSUBSTNO(SplitMessageTxt,MessageText,Text019);
        MESSAGE(MessageText);
      END;
    END;

    [External]
    PROCEDURE PriceMessageIfSalesLinesExist@7(ChangedFieldName@1000 : Text[100]);
    VAR
      MessageText@1001 : Text;
      IsHandled@1002 : Boolean;
    BEGIN
      OnBeforePriceMessageIfSalesLinesExist(Rec,ChangedFieldName,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF SalesLinesExist AND NOT GetHideValidationDialog THEN BEGIN
        MessageText := STRSUBSTNO(LinesNotUpdatedMsg,ChangedFieldName);
        IF "Currency Code" <> '' THEN
          MessageText := STRSUBSTNO(SplitMessageTxt,MessageText,AffectExchangeRateMsg);
        MESSAGE(MessageText);
      END;
    END;

    [External]
    PROCEDURE UpdateCurrencyFactor@12();
    VAR
      UpdateCurrencyExchangeRates@1001 : Codeunit 1281;
      ConfirmManagement@1002 : Codeunit 27;
      Updated@1000 : Boolean;
    BEGIN
      //**4PS.n dp00116, Changed Property 'Local' from Yes to No
      OnBeforeUpdateCurrencyFactor(Rec,Updated);
      IF Updated THEN
        EXIT;

      IF "Currency Code" <> '' THEN BEGIN
        IF "Posting Date" <> 0D THEN
          CurrencyDate := "Posting Date"
        ELSE
          CurrencyDate := WORKDATE;

        IF UpdateCurrencyExchangeRates.ExchangeRatesForCurrencyExist(CurrencyDate,"Currency Code") THEN BEGIN
        //"Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code"); //**4PS.o
          "Currency Factor" := CurrExchRate.ExchangeRate(1,"Job No.",CurrencyDate,"Currency Code",TRUE); //**4PS.n
          IF "Currency Code" <> xRec."Currency Code" THEN
            RecreateSalesLines(FIELDCAPTION("Currency Code"));
        END ELSE BEGIN
          IF ConfirmManagement.ConfirmProcess(
               STRSUBSTNO(MissingExchangeRatesQst,"Currency Code",CurrencyDate),TRUE)
          THEN BEGIN
            COMMIT;
            UpdateCurrencyExchangeRates.OpenExchangeRatesPage("Currency Code");
            UpdateCurrencyFactor;
          END ELSE
            RevertCurrencyCodeAndPostingDate;
        END;
      END ELSE BEGIN
        "Currency Factor" := 0;
        IF "Currency Code" <> xRec."Currency Code" THEN
          RecreateSalesLines(FIELDCAPTION("Currency Code"));
      END;

      OnAfterUpdateCurrencyFactor(Rec,GetHideValidationDialog);
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13();
    BEGIN
      OnBeforeConfirmUpdateCurrencyFactor(Rec,HideValidationDialog);

      IF GetHideValidationDialog OR NOT GUIALLOWED THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(Text021,FALSE);
      IF Confirmed THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
    END;

    [External]
    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    [External]
    PROCEDURE GetHideValidationDialog@123() : Boolean;
    VAR
      IdentityManagement@1000 : Codeunit 9801;
    BEGIN
      EXIT(HideValidationDialog OR IdentityManagement.IsInvAppId);
    END;

    LOCAL PROCEDURE UpdateLocationCode@223(LocationCode@1000 : Code[10]);
    VAR
      IsHandled@1001 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeUpdateLocationCode(Rec,LocationCode,IsHandled);
      IF NOT IsHandled THEN
        VALIDATE("Location Code",UserSetupMgt.GetLocation(0,LocationCode,"Responsibility Center"));
    END;

    [External]
    PROCEDURE UpdateSalesLines@15(ChangedFieldName@1000 : Text[100];AskQuestion@1001 : Boolean);
    VAR
      Field@1002 : Record 2000000041;
    BEGIN
      Field.SETRANGE(TableNo,DATABASE::"Sales Header");
      Field.SETRANGE("Field Caption",ChangedFieldName);
      Field.SETFILTER(ObsoleteState,'<>%1',Field.ObsoleteState::Removed);
      Field.FIND('-');
      IF Field.NEXT <> 0 THEN
        ERROR(DuplicatedCaptionsNotAllowedErr);
      UpdateSalesLinesByFieldNo(Field."No.",AskQuestion);

      OnAfterUpdateSalesLines(Rec);
    END;

    [External]
    PROCEDURE UpdateSalesLinesByFieldNo@154(ChangedFieldNo@1000 : Integer;AskQuestion@1001 : Boolean);
    VAR
      Field@1006 : Record 2000000041;
      JobTransferLine@1004 : Codeunit 11072016;
      PermissionManager@1003 : Codeunit 9002;
      Question@1002 : Text[250];
      NotRunningOnSaaS@1005 : Boolean;
      IsHandled@1007 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeUpdateSalesLinesByFieldNo(Rec,ChangedFieldNo,AskQuestion,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF NOT SalesLinesExist THEN
        EXIT;

      IF NOT Field.GET(DATABASE::"Sales Header",ChangedFieldNo) THEN
        Field.GET(DATABASE::"Sales Line",ChangedFieldNo);

      NotRunningOnSaaS := TRUE;
      CASE ChangedFieldNo OF
        FIELDNO("Shipping Agent Code"),
        FIELDNO("Shipping Agent Service Code"):
          NotRunningOnSaaS := NOT PermissionManager.SoftwareAsAService;
      END;
      IF AskQuestion THEN BEGIN
        Question := STRSUBSTNO(Text031,Field."Field Caption");
        IF GUIALLOWED AND NOT GetHideValidationDialog THEN
          IF NotRunningOnSaaS THEN
            IF DIALOG.CONFIRM(Question,TRUE) THEN
              CASE ChangedFieldNo OF
                FIELDNO("Shipment Date"),
                FIELDNO("Shipping Agent Code"),
                FIELDNO("Shipping Agent Service Code"),
                FIELDNO("Shipping Time"),
                FIELDNO("Requested Delivery Date"),
                FIELDNO("Promised Delivery Date"),
                FIELDNO("Outbound Whse. Handling Time"):
                  ConfirmResvDateConflict;
              END
            ELSE
              EXIT
          ELSE
            ConfirmResvDateConflict;
      END;

      SalesLine.LOCKTABLE;
      //MODIFY; //**4PS.o
      MODIFY(TRUE); //**4PS.n

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      IF SalesLine.FINDSET THEN
        REPEAT
          OnBeforeSalesLineByChangedFieldNo(Rec,SalesLine,ChangedFieldNo,IsHandled);
          IF NOT IsHandled THEN
            CASE ChangedFieldNo OF
              FIELDNO("Shipment Date"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Shipment Date","Shipment Date");
              FIELDNO("Currency Factor"):
                IF SalesLine.Type <> SalesLine.Type::" " THEN BEGIN
                  SalesLine.VALIDATE("Unit Price");
                  SalesLine.VALIDATE("Unit Cost (LCY)");
                  IF SalesLine."Job No." <> '' THEN
                    JobTransferLine.FromSalesHeaderToPlanningLine(SalesLine,"Currency Factor");
                END;
              FIELDNO("Transaction Type"):
                SalesLine.VALIDATE("Transaction Type","Transaction Type");
              FIELDNO("Transport Method"):
                SalesLine.VALIDATE("Transport Method","Transport Method");
              FIELDNO("Exit Point"):
                SalesLine.VALIDATE("Exit Point","Exit Point");
              FIELDNO(Area):
                SalesLine.VALIDATE(Area,Area);
              FIELDNO("Transaction Specification"):
                SalesLine.VALIDATE("Transaction Specification","Transaction Specification");
              FIELDNO("Shipping Agent Code"):
                SalesLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
              FIELDNO("Shipping Agent Service Code"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
              FIELDNO("Shipping Time"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Shipping Time","Shipping Time");
              FIELDNO("Prepayment %"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Prepayment %","Prepayment %");
              FIELDNO("Requested Delivery Date"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Requested Delivery Date","Requested Delivery Date");
              FIELDNO("Promised Delivery Date"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Promised Delivery Date","Promised Delivery Date");
              FIELDNO("Outbound Whse. Handling Time"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Outbound Whse. Handling Time","Outbound Whse. Handling Time");
              SalesLine.FIELDNO("Deferral Code"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Deferral Code");

              //>>NAVDK
              FIELDNO("Account Code DK"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Account Code DK","Account Code DK");
              //<<NAVDK
              //>>NAVNO
              FIELDNO("Account Code NO"):
                IF SalesLine."No." <> '' THEN
                  SalesLine.VALIDATE("Account Code NO","Account Code NO");
              //<<NAVNO

              ELSE
                OnUpdateSalesLineByChangedFieldName(Rec,SalesLine,Field.FieldName,ChangedFieldNo);
            END;
          SalesLineReserve.AssignForPlanning(SalesLine);
          OnUpdateSalesLinesByFieldNoOnBeforeSalesLineModify(SalesLine,ChangedFieldNo,CurrFieldNo);
          SalesLine.MODIFY(TRUE);
        UNTIL SalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ConfirmResvDateConflict@41();
    VAR
      ResvEngMgt@1000 : Codeunit 99000831;
    BEGIN
      IF ResvEngMgt.ResvExistsForSalesHeader(Rec) THEN
        IF NOT CONFIRM(Text063,FALSE) THEN
          ERROR('');
    END;

    [External]
    PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20];Type5@1008 : Integer;No5@1009 : Code[20];Type6@1100525000 : Integer;No6@1100525001 : Code[20];Type7@1100525005 : Integer;No7@1100525004 : Code[20];Type8@1100525003 : Integer;No8@1100525002 : Code[20]);
    VAR
      SourceCodeSetup@1010 : Record 242;
      TableID@1011 : ARRAY [10] OF Integer;
      No@1012 : ARRAY [10] OF Code[20];
      OldDimSetID@1013 : Integer;
    BEGIN
      SourceCodeSetup.GET;
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      TableID[5] := Type5;
      No[5] := No5;
      OnAfterCreateDimTableIDs(Rec,CurrFieldNo,TableID,No);

      //**4PS.sn
      TableID[6] := Type6;
      No[6] := No6;
      TableID[7] := Type7;  //** 4PS.n 09-06-2010 sn
      No[7] := No7;
      TableID[8] := Type8;
      No[8] := No8;         //** 4PS.n 09-06-2010 en
      //TableID[9] := Type9;  //*C007227.o
      //No[9] := No9;         //*C007227.o
      //**4PS.en
      //"Shortcut Dimension 1 Code" := ''; //**4PS.o Must be kept for Department Authorization
      "Shortcut Dimension 2 Code" := '';
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.GetRecDefaultDimID(
          Rec,CurrFieldNo,TableID,No,SourceCodeSetup.Sales,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      OnCreateDimOnBeforeUpdateLines(Rec,xRec,CurrFieldNo);

      IF (OldDimSetID <> "Dimension Set ID") AND SalesLinesExist THEN BEGIN
        MODIFY;
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    [External]
    PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1005 : Integer;
    BEGIN
      //**4PS.sn
      IF FieldNumber = 1 THEN
        DimMgt.CheckDepartmentAuthorization(DATABASE::"Sales Header", ShortcutDimCode);
      //**4PS.en

      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
      IF "No." <> '' THEN
        //MODIFY; //**4PS.o
        IF NOT SkipModify THEN //**4PS.n
          MODIFY(TRUE); //**4PS.n

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        //MODIFY; //**4PS.o
        IF NOT SkipModify THEN //**4PS.n
          MODIFY(TRUE); //**4PS.n
        IF SalesLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;

      OnAfterValidateShortcutDimCode(Rec,xRec,FieldNumber,ShortcutDimCode);
    END;

    LOCAL PROCEDURE ShippedSalesLinesExist@22() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Quantity Shipped",'<>0');
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE ReturnReceiptExist@5800() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Return Qty. Received",'<>0');
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE DeleteSalesLines@20(IBottomUp@1100528600 : Boolean);
    VAR
      ReservMgt@1000 : Codeunit 99000845;
    BEGIN
      SalesLine.ASCENDING(NOT IBottomUp); //**4PS.n

      IF SalesLine.FINDSET THEN BEGIN
        ReservMgt.DeleteDocumentReservation(DATABASE::"Sales Line","Document Type","No.",GetHideValidationDialog);
        REPEAT
          SalesLine.SuspendStatusCheck(TRUE);
          SalesLine.DELETE(TRUE);
        UNTIL SalesLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ClearItemAssgntSalesFilter@17(VAR TempItemChargeAssgntSales@1000 : TEMPORARY Record 5809);
    BEGIN
      TempItemChargeAssgntSales.SETRANGE("Document Line No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.");
    END;

    [External]
    PROCEDURE CheckCustomerCreated@18(Prompt@1000 : Boolean) : Boolean;
    VAR
      Cont@1001 : Record 5050;
      ConfirmManagement@1002 : Codeunit 27;
    BEGIN
      IF ("Bill-to Customer No." <> '') AND ("Sell-to Customer No." <> '') THEN
        EXIT(TRUE);

      IF Prompt THEN
        IF NOT ConfirmManagement.ConfirmProcess(Text035,TRUE) THEN
          EXIT(FALSE);

      IF "Sell-to Customer No." = '' THEN BEGIN
        TESTFIELD("Sell-to Contact No.");
        TESTFIELD("Sell-to Customer Template Code");
        GetContact(Cont,"Sell-to Contact No.");
        Cont.CreateCustomer("Sell-to Customer Template Code");
        COMMIT;
        GET("Document Type"::Quote,"No.");
      END;

      IF "Bill-to Customer No." = '' THEN BEGIN
        TESTFIELD("Bill-to Contact No.");
        TESTFIELD("Bill-to Customer Template Code");
        GetContact(Cont,"Bill-to Contact No.");
        Cont.CreateCustomer("Bill-to Customer Template Code");
        COMMIT;
        GET("Document Type"::Quote,"No.");
      END;

      EXIT(("Bill-to Customer No." <> '') AND ("Sell-to Customer No." <> ''));
    END;

    LOCAL PROCEDURE CheckShipmentInfo@116(VAR SalesLine@1000 : Record 37;BillTo@1001 : Boolean);
    BEGIN
      IF "Document Type" = "Document Type"::Order THEN
        SalesLine.SETFILTER("Quantity Shipped",'<>0')
      ELSE
        IF "Document Type" = "Document Type"::Invoice THEN BEGIN
          IF NOT BillTo THEN
            SalesLine.SETRANGE("Sell-to Customer No.",xRec."Sell-to Customer No.");
          SalesLine.SETFILTER("Shipment No.",'<>%1','');
        END;

      IF SalesLine.FINDFIRST THEN
        IF "Document Type" = "Document Type"::Order THEN
          TestQuantityShippedField(SalesLine)
        ELSE
          SalesLine.TESTFIELD("Shipment No.",'');
      SalesLine.SETRANGE("Shipment No.");
      SalesLine.SETRANGE("Quantity Shipped");
    END;

    LOCAL PROCEDURE CheckPrepmtInfo@119(VAR SalesLine@1000 : Record 37);
    BEGIN
      IF "Document Type" = "Document Type"::Order THEN BEGIN
        SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
        IF SalesLine.FIND('-') THEN
          SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
        SalesLine.SETRANGE("Prepmt. Amt. Inv.");
      END;
    END;

    LOCAL PROCEDURE CheckReturnInfo@121(VAR SalesLine@1000 : Record 37;BillTo@1001 : Boolean);
    BEGIN
      IF "Document Type" = "Document Type"::"Return Order" THEN
        SalesLine.SETFILTER("Return Qty. Received",'<>0')
      ELSE
        IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
          IF NOT BillTo THEN
            SalesLine.SETRANGE("Sell-to Customer No.",xRec."Sell-to Customer No.");
          SalesLine.SETFILTER("Return Receipt No.",'<>%1','');
        END;

      IF SalesLine.FINDFIRST THEN
        IF "Document Type" = "Document Type"::"Return Order" THEN
          SalesLine.TESTFIELD("Return Qty. Received",0)
        ELSE
          SalesLine.TESTFIELD("Return Receipt No.",'');
    END;

    LOCAL PROCEDURE CopyFromSellToCustTemplate@281(SellToCustTemplate@1000 : Record 5105);
    BEGIN
      SellToCustTemplate.TESTFIELD("Gen. Bus. Posting Group");
      "Gen. Bus. Posting Group" := SellToCustTemplate."Gen. Bus. Posting Group";
      "VAT Bus. Posting Group" := SellToCustTemplate."VAT Bus. Posting Group";
      IF "Bill-to Customer No." = '' THEN
        VALIDATE("Bill-to Customer Template Code","Sell-to Customer Template Code");

      OnAfterCopyFromSellToCustTemplate(Rec,SellToCustTemplate);
    END;

    LOCAL PROCEDURE RecreateReqLine@33(OldSalesLine@1000 : Record 37;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    VAR
      ReqLine@1003 : Record 246;
      TempReqLine@1004 : TEMPORARY Record 246;
    BEGIN
      IF ToTemp THEN BEGIN
        ReqLine.SETCURRENTKEY("Order Promising ID","Order Promising Line ID","Order Promising Line No.");
        ReqLine.SETRANGE("Order Promising ID",OldSalesLine."Document No.");
        ReqLine.SETRANGE("Order Promising Line ID",OldSalesLine."Line No.");
        IF ReqLine.FINDSET THEN
          REPEAT
            TempReqLine := ReqLine;
            TempReqLine.INSERT;
          UNTIL ReqLine.NEXT = 0;
        ReqLine.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReqLine);
        TempReqLine.SETCURRENTKEY("Order Promising ID","Order Promising Line ID","Order Promising Line No.");
        TempReqLine.SETRANGE("Order Promising ID",OldSalesLine."Document No.");
        TempReqLine.SETRANGE("Order Promising Line ID",OldSalesLine."Line No.");
        IF TempReqLine.FINDSET THEN
          REPEAT
            ReqLine := TempReqLine;
            ReqLine."Order Promising Line ID" := NewSourceRefNo;
            ReqLine.INSERT;
          UNTIL TempReqLine.NEXT = 0;
        TempReqLine.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE UpdateSellToCont@24(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1004 : Record 18;
      OfficeContact@1001 : Record 5050;
      OfficeMgt@1002 : Codeunit 1630;
    BEGIN
      //**4PS.sn call 33756
      IF "Project Invoice" OR "Service Invoice" THEN
        EXIT;
      //**4PS.en

      IF OfficeMgt.GetContact(OfficeContact,CustomerNo) THEN BEGIN
        HideValidationDialog := TRUE;
        UpdateSellToCust(OfficeContact."No.");
        HideValidationDialog := FALSE;
      END ELSE
        IF Cust.GET(CustomerNo) THEN BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Sell-to Contact No." := Cust."Primary Contact No."
          ELSE BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
            ContBusRel.SETRANGE("No.","Sell-to Customer No.");
            IF ContBusRel.FINDFIRST THEN
              "Sell-to Contact No." := ContBusRel."Contact No."
            ELSE
              "Sell-to Contact No." := '';
          END;
          "Sell-to Contact" := Cust.Contact;
          //NAVDK
          "Sell-to Contact Phone No." := Cust."Phone No.";
          "Sell-to Contact Fax No." := Cust."Fax No.";
          "Sell-to Contact E-Mail" := Cust."E-Mail";
          "Sell-to Contact Role" := "Sell-to Contact Role"::" ";
          //<<NAVDK
        END;
      IF "Sell-to Contact No." <> '' THEN
        IF OfficeContact.GET("Sell-to Contact No.") THEN
          OfficeContact.CheckIfPrivacyBlockedGeneric;

      OnAfterUpdateSellToCont(Rec,Cust,OfficeContact);
    END;

    LOCAL PROCEDURE UpdateBillToCont@27(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1001 : Record 18;
      Contact@1002 : Record 5050;
    BEGIN
      //IF NOT "Project Invoice" THEN //**4PS.n
      IF NOT "Project Invoice" AND NOT "Service Invoice" THEN //**4PS.n call 33756
        IF Cust.GET(CustomerNo) THEN BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Bill-to Contact No." := Cust."Primary Contact No."
          ELSE BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
            ContBusRel.SETRANGE("No.","Bill-to Customer No.");
            IF ContBusRel.FINDFIRST THEN
              "Bill-to Contact No." := ContBusRel."Contact No."
            ELSE
              "Bill-to Contact No." := '';
          END;
          "Bill-to Contact" := Cust.Contact;
        END;
      IF "Bill-to Contact No." <> '' THEN
        IF Contact.GET("Bill-to Contact No.") THEN
          Contact.CheckIfPrivacyBlockedGeneric;

      OnAfterUpdateBillToCont(Rec,Cust,Contact);
    END;

    LOCAL PROCEDURE UpdateSellToCust@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Customer@1006 : Record 18;
      Cont@1005 : Record 5050;
      CustTemplate@1004 : Record 5105;
      SearchContact@1003 : Record 5050;
      ContactBusinessRelationFound@1001 : Boolean;
    BEGIN
      IF NOT Cont.GET(ContactNo) THEN BEGIN
        "Sell-to Contact" := '';
        EXIT;
      END;
      "Sell-to Contact No." := Cont."No.";

      IF Cont.Type = Cont.Type::Person THEN
        ContactBusinessRelationFound := ContBusinessRelation.FindByContact(ContBusinessRelation."Link to Table"::Customer,Cont."No.");
      IF NOT ContactBusinessRelationFound THEN
        ContactBusinessRelationFound :=
          ContBusinessRelation.FindByContact(ContBusinessRelation."Link to Table"::Customer,Cont."Company No.");

      IF ContactBusinessRelationFound THEN BEGIN
        IF ("Sell-to Customer No." <> '') AND ("Sell-to Customer No." <> ContBusinessRelation."No.") THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Sell-to Customer No.");

        IF "Sell-to Customer No." = '' THEN BEGIN
          SkipSellToContact := TRUE;
          VALIDATE("Sell-to Customer No.",ContBusinessRelation."No.");
          SkipSellToContact := FALSE;
        END;
      END ELSE BEGIN
        IF "Document Type" = "Document Type"::Quote THEN BEGIN
          IF Cont."Company No." <> '' THEN
            SearchContact.GET(Cont."Company No.")
          ELSE
            SearchContact := Cont;
          "Sell-to Customer Name" := SearchContact."Company Name";
          "Sell-to Customer Name 2" := SearchContact."Name 2";
          "Sell-to Phone No." := SearchContact."Phone No.";
          "Sell-to E-Mail" := SearchContact."E-Mail";
          SetShipToAddress(
            SearchContact."Company Name",SearchContact."Name 2",SearchContact.Address,SearchContact."Address 2",
            SearchContact.City,SearchContact."Post Code",SearchContact.County,SearchContact."Country/Region Code");
          IF ("Sell-to Customer Template Code" = '') AND (NOT CustTemplate.ISEMPTY) THEN
            VALIDATE("Sell-to Customer Template Code",Cont.FindCustomerTemplate);
        END ELSE
          ERROR(Text039,Cont."No.",Cont.Name);
        "Sell-to Contact" := Cont.Name;
      END;

      IF (Cont.Type = Cont.Type::Company) AND Customer.GET("Sell-to Customer No.") THEN
        "Sell-to Contact" := Customer.Contact
      ELSE
        IF Cont.Type = Cont.Type::Company THEN
          "Sell-to Contact" := ''
        ELSE
          "Sell-to Contact" := Cont.Name;

      IF "Document Type" = "Document Type"::Quote THEN BEGIN
        IF Customer.GET("Sell-to Customer No.") OR Customer.GET(ContBusinessRelation."No.") THEN BEGIN
          IF Customer."Copy Sell-to Addr. to Qte From" = Customer."Copy Sell-to Addr. to Qte From"::Company THEN BEGIN
            IF Cont."Company No." <> '' THEN
              Cont.GET(Cont."Company No.");
          END;
        END ELSE BEGIN
          IF Cont."Company No." <> '' THEN
            Cont.GET(Cont."Company No.");
        END;
        "Sell-to Address" := Cont.Address;
        "Sell-to Address 2" := Cont."Address 2";
        "Sell-to City" := Cont.City;
        "Sell-to Post Code" := Cont."Post Code";
        "Sell-to County" := Cont.County;
        "Sell-to Country/Region Code" := Cont."Country/Region Code";
      END;
      IF ("Sell-to Customer No." = "Bill-to Customer No.") OR
         ("Bill-to Customer No." = '')
      THEN
        IF "Service Contract No." = '' THEN //**4PS.n, call 31960
          VALIDATE("Bill-to Contact No.","Sell-to Contact No.");

      OnAfterUpdateSellToCust(Rec,Cont);
    END;

    LOCAL PROCEDURE UpdateBillToCust@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Cust@1004 : Record 18;
      Cont@1003 : Record 5050;
      CustTemplate@1002 : Record 5105;
      SearchContact@1001 : Record 5050;
      ContactBusinessRelationFound@1007 : Boolean;
    BEGIN
      IF NOT Cont.GET(ContactNo) THEN BEGIN
        "Bill-to Contact" := '';
        EXIT;
      END;
      "Bill-to Contact No." := Cont."No.";

      IF Cust.GET("Bill-to Customer No.") AND (Cont.Type = Cont.Type::Company) THEN
        "Bill-to Contact" := Cust.Contact
      ELSE
        IF Cont.Type = Cont.Type::Company THEN
          "Bill-to Contact" := ''
        ELSE
          "Bill-to Contact" := Cont.Name;

      IF Cont.Type = Cont.Type::Person THEN
        ContactBusinessRelationFound := ContBusinessRelation.FindByContact(ContBusinessRelation."Link to Table"::Customer,Cont."No.");
      IF NOT ContactBusinessRelationFound THEN
        ContactBusinessRelationFound :=
          ContBusinessRelation.FindByContact(ContBusinessRelation."Link to Table"::Customer,Cont."Company No.");

      IF ContactBusinessRelationFound THEN BEGIN
        IF "Bill-to Customer No." = '' THEN BEGIN
          SkipBillToContact := TRUE;
          VALIDATE("Bill-to Customer No.",ContBusinessRelation."No.");
          SkipBillToContact := FALSE;
          "Bill-to Customer Template Code" := '';
        END ELSE
          IF "Bill-to Customer No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Bill-to Customer No.");
      END ELSE BEGIN
        IF "Document Type" = "Document Type"::Quote THEN BEGIN
          IF Cont."Company No." <> '' THEN
            SearchContact.GET(Cont."Company No.")
          ELSE
            SearchContact.GET(Cont."No.");

          "Bill-to Name" := SearchContact."Company Name";
          "Bill-to Name 2" := SearchContact."Name 2";
          "Bill-to Address" := SearchContact.Address;
          "Bill-to Address 2" := SearchContact."Address 2";
          "Bill-to City" := SearchContact.City;
          "Bill-to Post Code" := SearchContact."Post Code";
          "Bill-to County" := SearchContact.County;
          "Bill-to Country/Region Code" := SearchContact."Country/Region Code";
          "VAT Registration No." := SearchContact."VAT Registration No.";
          VALIDATE("Currency Code",SearchContact."Currency Code");
          "Language Code" := SearchContact."Language Code";

          OnUpdateBillToCustOnAfterSalesQuote(Rec,SearchContact);

          IF ("Bill-to Customer Template Code" = '') AND (NOT CustTemplate.ISEMPTY) THEN
            VALIDATE("Bill-to Customer Template Code",Cont.FindCustomerTemplate);
        END ELSE
          ERROR(Text039,Cont."No.",Cont.Name);
      END;
    END;

    LOCAL PROCEDURE UpdateSellToCustTemplateCode@1000();
    BEGIN
      IF ("Document Type" = "Document Type"::Quote) AND ("Sell-to Customer No." = '') AND ("Sell-to Customer Template Code" = '' ) AND
         (GetFilterContNo = '')
      THEN
        VALIDATE("Sell-to Customer Template Code",SelectSalesHeaderCustomerTemplate);
    END;

    LOCAL PROCEDURE GetShippingTime@23(CalledByFieldNo@1000 : Integer);
    VAR
      ShippingAgentServices@1001 : Record 5790;
    BEGIN
      IF (CalledByFieldNo <> CurrFieldNo) AND (CurrFieldNo <> 0) THEN
        EXIT;

      IF ShippingAgentServices.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
        "Shipping Time" := ShippingAgentServices."Shipping Time"
      ELSE BEGIN
        GetCust("Sell-to Customer No.");
        "Shipping Time" := Cust."Shipping Time"
      END;
      IF NOT (CalledByFieldNo IN [FIELDNO("Shipping Agent Code"),FIELDNO("Shipping Agent Service Code")]) THEN
        VALIDATE("Shipping Time");
    END;

    LOCAL PROCEDURE GetContact@159(VAR Contact@1000 : Record 5050;ContactNo@1001 : Code[20]);
    BEGIN
      Contact.GET(ContactNo);
      IF (Contact.Type = Contact.Type::Person) AND (Contact."Company No." <> '') THEN
        Contact.GET(Contact."Company No.");
    END;

    PROCEDURE GetSellToCustomerFaxNo@209() : Text;
    VAR
      Customer@1000 : Record 18;
    BEGIN
      IF Customer.GET("Sell-to Customer No.") THEN
        EXIT(Customer."Fax No.");
    END;

    [Internal]
    PROCEDURE CheckCreditMaxBeforeInsert@28();
    VAR
      SalesHeader@1001 : Record 36;
      ContBusinessRelation@1002 : Record 5054;
      Cont@1003 : Record 5050;
      CustCheckCreditLimit@1000 : Codeunit 312;
      IsHandled@1004 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeCheckCreditMaxBeforeInsert(Rec,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF HideCreditCheckDialogue THEN
        EXIT;

      IF (GetFilterCustNo <> '') OR ("Sell-to Customer No." <> '') THEN BEGIN
        IF "Sell-to Customer No." <> '' THEN
          Cust.GET("Sell-to Customer No.")
        ELSE
          Cust.GET(GetFilterCustNo);
        IF Cust."Bill-to Customer No." <> '' THEN
          SalesHeader."Bill-to Customer No." := Cust."Bill-to Customer No."
        ELSE
          SalesHeader."Bill-to Customer No." := Cust."No.";
        CustCheckCreditLimit.SalesHeaderCheck(SalesHeader);
      END ELSE
        IF GetFilterContNo <> '' THEN BEGIN
          Cont.GET(GetFilterContNo);
          IF ContBusinessRelation.FindByContact(ContBusinessRelation."Link to Table"::Customer,Cont."Company No.") THEN BEGIN
            Cust.GET(ContBusinessRelation."No.");
            IF Cust."Bill-to Customer No." <> '' THEN
              SalesHeader."Bill-to Customer No." := Cust."Bill-to Customer No."
            ELSE
              SalesHeader."Bill-to Customer No." := Cust."No.";
            CustCheckCreditLimit.SalesHeaderCheck(SalesHeader);
          END;
        END;

      OnAfterCheckCreditMaxBeforeInsert(Rec);
    END;

    [External]
    PROCEDURE CreateInvtPutAwayPick@29();
    VAR
      WhseRequest@1000 : Record 5765;
    BEGIN
      IF "Document Type" = "Document Type"::Order THEN
        IF NOT IsApprovedForPosting THEN
          EXIT;
      TESTFIELD(Status,Status::Released);

      WhseRequest.RESET;
      WhseRequest.SETCURRENTKEY("Source Document","Source No.");
      CASE "Document Type" OF
        "Document Type"::Order:
          BEGIN
            IF "Shipping Advice" = "Shipping Advice"::Complete THEN
              CheckShippingAdvice;
            WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Sales Order");
          END;
        "Document Type"::"Return Order":
          WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Sales Return Order");
      END;
      WhseRequest.SETRANGE("Source No.","No.");
      REPORT.RUNMODAL(REPORT::"Create Invt Put-away/Pick/Mvmt",TRUE,FALSE,WhseRequest);
    END;

    [External]
    PROCEDURE CreateTask@30();
    VAR
      TempTask@1000 : TEMPORARY Record 5080;
    BEGIN
      TESTFIELD("Sell-to Contact No.");
      TempTask.CreateTaskFromSalesHeader(Rec);
    END;

    [External]
    PROCEDURE UpdateShipToAddress@31();
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      OnBeforeUpdateShipToAddress(Rec,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF IsCreditDocType THEN
        IF "Location Code" <> '' THEN BEGIN
          Location.GET("Location Code");
          SetShipToAddress(
            Location.Name,Location."Name 2",Location.Address,Location."Address 2",Location.City,
            Location."Post Code",Location.County,Location."Country/Region Code");
          "Ship-to Contact" := Location.Contact;
          "Ship-to Contact No." := ''; //**4PS.n
        END ELSE BEGIN
          CompanyInfo.GET;
          "Ship-to Code" := '';
          SetShipToAddress(
            CompanyInfo."Ship-to Name",CompanyInfo."Ship-to Name 2",CompanyInfo."Ship-to Address",CompanyInfo."Ship-to Address 2",
            CompanyInfo."Ship-to City",CompanyInfo."Ship-to Post Code",CompanyInfo."Ship-to County",
            CompanyInfo."Ship-to Country/Region Code");
          "Ship-to Contact" := CompanyInfo."Ship-to Contact";
          "Ship-to Contact No." := ''; //**4PS.n
        END;

      OnAfterUpdateShipToAddress(Rec,xRec,CurrFieldNo);
    END;

    [External]
    PROCEDURE ShowDocDim@32();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      DimMgt.SetTableID(DATABASE::"Sales Header"); //**4PS.n
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF SalesLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    [External]
    PROCEDURE UpdateAllLineDim@34(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      ATOLink@1003 : Record 904;
      NewDimSetID@1002 : Integer;
      ShippedReceivedItemLineDimChangeConfirmed@1004 : Boolean;
      IsHandled@1005 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeUpdateAllLineDim(Rec,NewParentDimSetID,OldParentDimSetID,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT GetHideValidationDialog AND GUIALLOWED THEN
        IF NOT CONFIRM(Text064) THEN
          EXIT;

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.LOCKTABLE;
      IF SalesLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(SalesLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF SalesLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            SalesLine."Dimension Set ID" := NewDimSetID;

            IF NOT GetHideValidationDialog AND GUIALLOWED THEN
              VerifyShippedReceivedItemLineDimChange(ShippedReceivedItemLineDimChangeConfirmed);

            DimMgt.UpdateGlobalDimFromDimSetID(
              SalesLine."Dimension Set ID",SalesLine."Shortcut Dimension 1 Code",SalesLine."Shortcut Dimension 2 Code");
            SalesLine.MODIFY;
            ATOLink.UpdateAsmDimFromSalesLine(SalesLine);
          END;
        UNTIL SalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE VerifyShippedReceivedItemLineDimChange@105(VAR ShippedReceivedItemLineDimChangeConfirmed@1000 : Boolean);
    BEGIN
      IF SalesLine.IsShippedReceivedItemDimChanged THEN
        IF NOT ShippedReceivedItemLineDimChangeConfirmed THEN
          ShippedReceivedItemLineDimChangeConfirmed := SalesLine.ConfirmShippedReceivedItemDimChange;
    END;

    [External]
    PROCEDURE LookupAdjmtValueEntries@37(QtyType@1000 : 'General,Invoicing');
    VAR
      ItemLedgEntry@1004 : Record 32;
      SalesLine@1001 : Record 37;
      SalesShptLine@1005 : Record 111;
      ReturnRcptLine@1002 : Record 6661;
      TempValueEntry@1003 : TEMPORARY Record 5802;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      TempValueEntry.RESET;
      TempValueEntry.DELETEALL;

      CASE "Document Type" OF
        "Document Type"::Order,"Document Type"::Invoice:
          BEGIN
            IF SalesLine.FINDSET THEN
              REPEAT
                IF (SalesLine.Type = SalesLine.Type::Item) AND (SalesLine.Quantity <> 0) THEN
                  WITH SalesShptLine DO BEGIN
                    IF SalesLine."Shipment No." <> '' THEN BEGIN
                      SETRANGE("Document No.",SalesLine."Shipment No.");
                      SETRANGE("Line No.",SalesLine."Shipment Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Order No.","Order Line No.");
                      SETRANGE("Order No.",SalesLine."Document No.");
                      SETRANGE("Order Line No.",SalesLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Qty. Shipped Not Invoiced",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL SalesLine.NEXT = 0;
          END;
        "Document Type"::"Return Order","Document Type"::"Credit Memo":
          BEGIN
            IF SalesLine.FINDSET THEN
              REPEAT
                IF (SalesLine.Type = SalesLine.Type::Item) AND (SalesLine.Quantity <> 0) THEN
                  WITH ReturnRcptLine DO BEGIN
                    IF SalesLine."Return Receipt No." <> '' THEN BEGIN
                      SETRANGE("Document No.",SalesLine."Return Receipt No.");
                      SETRANGE("Line No.",SalesLine."Return Receipt Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Return Order No.","Return Order Line No.");
                      SETRANGE("Return Order No.",SalesLine."Document No.");
                      SETRANGE("Return Order Line No.",SalesLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Return Qty. Rcd. Not Invd.",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL SalesLine.NEXT = 0;
          END;
      END;
      PAGE.RUNMODAL(0,TempValueEntry);
    END;

    [External]
    PROCEDURE GetCustomerVATRegistrationNumber@63() : Text;
    BEGIN
      EXIT("VAT Registration No.");
    END;

    [External]
    PROCEDURE GetCustomerVATRegistrationNumberLbl@62() : Text;
    BEGIN
      EXIT(FIELDCAPTION("VAT Registration No."));
    END;

    [External]
    PROCEDURE GetCustomerGlobalLocationNumber@164() : Text;
    BEGIN
      EXIT('');
    END;

    [External]
    PROCEDURE GetCustomerGlobalLocationNumberLbl@161() : Text;
    BEGIN
      EXIT('');
    END;

    LOCAL PROCEDURE CreateTempAdjmtValueEntries@38(VAR TempValueEntry@1001 : TEMPORARY Record 5802;ItemLedgEntryNo@1000 : Integer);
    VAR
      ValueEntry@1002 : Record 5802;
    BEGIN
      WITH ValueEntry DO BEGIN
        SETCURRENTKEY("Item Ledger Entry No.");
        SETRANGE("Item Ledger Entry No.",ItemLedgEntryNo);
        IF FINDSET THEN
          REPEAT
            IF Adjustment THEN BEGIN
              TempValueEntry := ValueEntry;
              IF TempValueEntry.INSERT THEN;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    [Internal]
    PROCEDURE GetPstdDocLinesToRevere@39();
    VAR
      SalesPostedDocLines@1000 : Page 5850;
    BEGIN
      GetCust("Sell-to Customer No.");
      SalesPostedDocLines.SetToSalesHeader(Rec);
      SalesPostedDocLines.SETRECORD(Cust);
      SalesPostedDocLines.LOOKUPMODE := TRUE;
      IF SalesPostedDocLines.RUNMODAL = ACTION::LookupOK THEN
        SalesPostedDocLines.CopyLineToDoc;

      CLEAR(SalesPostedDocLines);
    END;

    [External]
    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      SalesInvDisc@1000 : Codeunit 60;
    BEGIN
      GetSalesSetup;
      IF SalesSetup."Calc. Inv. Discount" THEN
        SalesInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    [External]
    PROCEDURE SetSecurityFilterOnRespCenter@43();
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeSetSecurityFilterOnRespCenter(Rec,IsHandled);
      IF (NOT IsHandled) AND (UserSetupMgt.GetSalesFilter <> '') THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetSalesFilter);
        FILTERGROUP(0);
      END;

      SETRANGE("Date Filter",0D,WORKDATE - 1);
    END;

    LOCAL PROCEDURE SynchronizeForReservations@42(VAR NewSalesLine@1000 : Record 37;OldSalesLine@1001 : Record 37);
    BEGIN
      NewSalesLine.CALCFIELDS("Reserved Quantity");
      IF NewSalesLine."Reserved Quantity" = 0 THEN
        EXIT;
      IF NewSalesLine."Location Code" <> OldSalesLine."Location Code" THEN
        NewSalesLine.VALIDATE("Location Code",OldSalesLine."Location Code");
      IF NewSalesLine."Bin Code" <> OldSalesLine."Bin Code" THEN
        NewSalesLine.VALIDATE("Bin Code",OldSalesLine."Bin Code");
      IF NewSalesLine.MODIFY THEN;
    END;

    [External]
    PROCEDURE InventoryPickConflict@46(DocType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocNo@1003 : Code[20];ShippingAdvice@1004 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseActivityLine@1000 : Record 5767;
      SalesLine@1001 : Record 37;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseActivityLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.");
      WarehouseActivityLine.SETRANGE("Source Type",DATABASE::"Sales Line");
      WarehouseActivityLine.SETRANGE("Source Subtype",DocType);
      WarehouseActivityLine.SETRANGE("Source No.",DocNo);
      IF WarehouseActivityLine.ISEMPTY THEN
        EXIT(FALSE);
      SalesLine.SETRANGE("Document Type",DocType);
      SalesLine.SETRANGE("Document No.",DocNo);
      SalesLine.SETRANGE(Type,SalesLine.Type::Item);
      IF SalesLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    [External]
    PROCEDURE WhseShpmntConflict@52(DocType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocNo@1001 : Code[20];ShippingAdvice@1000 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseShipmentLine@1003 : Record 7321;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseShipmentLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.","Source Line No.");
      WarehouseShipmentLine.SETRANGE("Source Type",DATABASE::"Sales Line");
      WarehouseShipmentLine.SETRANGE("Source Subtype",DocType);
      WarehouseShipmentLine.SETRANGE("Source No.",DocNo);
      IF WarehouseShipmentLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckCreditLimit@47();
    VAR
      SalesHeader@1000 : Record 36;
      IsHandled@1001 : Boolean;
    BEGIN
      SalesHeader := Rec;

      IF GUIALLOWED AND
         (CurrFieldNo <> 0) AND CheckCreditLimitCondition AND SalesHeader.FIND
      THEN BEGIN
        "Amount Including VAT" := 0;
        IF "Document Type" = "Document Type"::Order THEN
          IF BilltoCustomerNoChanged THEN BEGIN
            SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
            SalesLine.SETRANGE("Document No.","No.");
            SalesLine.CALCSUMS("Outstanding Amount","Shipped Not Invoiced");
            "Amount Including VAT" := SalesLine."Outstanding Amount" + SalesLine."Shipped Not Invoiced";
          END;

        IsHandled := FALSE;
        OnBeforeCheckCreditLimit(Rec,IsHandled);
        IF NOT IsHandled THEN
          CustCheckCreditLimit.SalesHeaderCheck(Rec);

        CALCFIELDS("Amount Including VAT");
      END;
    END;

    LOCAL PROCEDURE CheckCreditLimitCondition@289() : Boolean;
    VAR
      RunCheck@1000 : Boolean;
    BEGIN
      RunCheck := ("Document Type" <= "Document Type"::Invoice) OR ("Document Type" = "Document Type"::"Blanket Order");
      OnAfterCheckCreditLimitCondition(Rec,RunCheck);
      EXIT(RunCheck);
    END;

    [Internal]
    PROCEDURE CheckItemAvailabilityInLines@142();
    VAR
      SalesLine@1000 : Record 37;
      ItemCheckAvail@1001 : Codeunit 311;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETRANGE(Type,SalesLine.Type::Item);
      SalesLine.SETFILTER("No.",'<>%1','');
      SalesLine.SETFILTER("Outstanding Quantity",'<>%1',0);
      OnCheckItemAvailabilityInLinesOnAfterSetFilters(SalesLine);
      IF SalesLine.FINDSET THEN
        REPEAT
          IF ItemCheckAvail.SalesLineCheck(SalesLine) THEN
            ItemCheckAvail.RaiseUpdateInterruptedError;
        UNTIL SalesLine.NEXT = 0;
    END;

    [External]
    PROCEDURE QtyToShipIsZero@49() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Qty. to Ship",'<>0');
      EXIT(SalesLine.ISEMPTY);
    END;

    [Internal]
    PROCEDURE IsApprovedForPosting@53() : Boolean;
    VAR
      PrepaymentMgt@1001 : Codeunit 441;
      Approved@1000 : Boolean;
    BEGIN
      IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN BEGIN
        IF PrepaymentMgt.TestSalesPrepayment(Rec) THEN
          ERROR(PrepaymentInvoicesNotPaidErr,"Document Type","No.");
        IF "Document Type" = "Document Type"::Order THEN
          IF PrepaymentMgt.TestSalesPayment(Rec) THEN
            ERROR(Text072,"Document Type","No.");
        Approved := TRUE;
        OnAfterIsApprovedForPosting(Rec,Approved);
        EXIT(Approved);
      END;
    END;

    [External]
    PROCEDURE IsApprovedForPostingBatch@54() : Boolean;
    VAR
      PrepaymentMgt@1000 : Codeunit 441;
      Approved@1001 : Boolean;
    BEGIN
      IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN BEGIN
        IF PrepaymentMgt.TestSalesPrepayment(Rec) THEN
          Approved := FALSE;
        IF PrepaymentMgt.TestSalesPayment(Rec) THEN
          Approved := FALSE;
        Approved := TRUE;
        OnAfterIsApprovedForPostingBatch(Rec,Approved);
        EXIT(Approved);
      END;
    END;

    [External]
    PROCEDURE GetLegalStatement@60() : Text;
    BEGIN
      //NAVFI
      GLSetup.GET;
      IF GLSetup."Finnish localization active" AND "EU 3-Party Trade" THEN
        EXIT(FIELDCAPTION("EU 3-Party Trade"));
      //NAVFI
      GetSalesSetup;
      EXIT(SalesSetup.GetLegalStatement);
    END;

    [External]
    PROCEDURE SendToPosting@57(PostingCodeunitID@1000 : Integer) IsSuccess : Boolean;
    VAR
      ErrorMessageMgt@1001 : Codeunit 28;
      ErrorMessageHandler@1002 : Codeunit 29;
    BEGIN
      IF NOT IsApprovedForPosting THEN
        EXIT;

      COMMIT;
      ErrorMessageMgt.Activate(ErrorMessageHandler);
      IsSuccess := CODEUNIT.RUN(PostingCodeunitID,Rec);
      IF NOT IsSuccess THEN
        ErrorMessageHandler.ShowErrors;
    END;

    [External]
    PROCEDURE CancelBackgroundPosting@48();
    VAR
      SalesPostViaJobQueue@1000 : Codeunit 88;
    BEGIN
      SalesPostViaJobQueue.CancelQueueEntry(Rec);
    END;

    [Internal]
    PROCEDURE EmailRecords@135(ShowDialog@1000 : Boolean);
    VAR
      DocumentSendingProfile@1003 : Record 60;
      DummyReportSelections@1001 : Record 77;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          BEGIN
            DocumentSendingProfile.TrySendToEMail(
              DummyReportSelections.Usage::"S.Quote",Rec,FIELDNO("No."),
              GetDocTypeTxt,FIELDNO("Bill-to Customer No."),ShowDialog);
            FIND;
            "Quote Sent to Customer" := CURRENTDATETIME;
            MODIFY;
          END;
        "Document Type"::Invoice:
          DocumentSendingProfile.TrySendToEMail(
            DummyReportSelections.Usage::"S.Invoice Draft",Rec,FIELDNO("No."),
            GetDocTypeTxt,FIELDNO("Bill-to Customer No."),ShowDialog);
      END;

      OnAfterSendSalesHeader(Rec,ShowDialog);
    END;

    [External]
    PROCEDURE GetDocTypeTxt@140() : Text[50];
    VAR
      IdentityManagement@1000 : Codeunit 9801;
    BEGIN
      IF "Document Type" = "Document Type"::Quote THEN
        IF IdentityManagement.IsInvAppId THEN
          EXIT(EstimateTxt);
      EXIT(FORMAT("Document Type"));
    END;

    [External]
    PROCEDURE LinkSalesDocWithOpportunity@79(OldOpportunityNo@1000 : Code[20]);
    VAR
      SalesHeader@1001 : Record 36;
      Opportunity@1002 : Record 5092;
      ConfirmManagement@1003 : Codeunit 27;
    BEGIN
      IF "Opportunity No." <> OldOpportunityNo THEN BEGIN
        IF "Opportunity No." <> '' THEN
          IF Opportunity.GET("Opportunity No.") THEN BEGIN
            Opportunity.TESTFIELD(Status,Opportunity.Status::"In Progress");
            IF Opportunity."Sales Document No." <> '' THEN BEGIN
              IF ConfirmManagement.ConfirmProcess(
                   STRSUBSTNO(Text048,Opportunity."Sales Document No.",Opportunity."No."),TRUE)
              THEN BEGIN
                IF SalesHeader.GET("Document Type"::Quote,Opportunity."Sales Document No.") THEN BEGIN
                  SalesHeader."Opportunity No." := '';
                  SalesHeader.MODIFY;
                END;
                UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::Quote,"No.");
              END ELSE
                "Opportunity No." := OldOpportunityNo;
            END ELSE
              UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::Quote,"No.");
          END;
        IF (OldOpportunityNo <> '') AND Opportunity.GET(OldOpportunityNo) THEN
          UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::" ",'');
      END;
    END;

    LOCAL PROCEDURE UpdateOpportunityLink@80(Opportunity@1000 : Record 5092;SalesDocumentType@1001 : Option;SalesHeaderNo@1002 : Code[20]);
    BEGIN
      Opportunity."Sales Document Type" := SalesDocumentType;
      Opportunity."Sales Document No." := SalesHeaderNo;
      Opportunity.MODIFY;
    END;

    [External]
    PROCEDURE SynchronizeAsmHeader@56();
    VAR
      AsmHeader@1003 : Record 900;
      ATOLink@1002 : Record 904;
      Window@1000 : Dialog;
    BEGIN
      ATOLink.SETCURRENTKEY(Type,"Document Type","Document No.");
      ATOLink.SETRANGE(Type,ATOLink.Type::Sale);
      ATOLink.SETRANGE("Document Type","Document Type");
      ATOLink.SETRANGE("Document No.","No.");
      IF ATOLink.FINDSET THEN
        REPEAT
          IF AsmHeader.GET(ATOLink."Assembly Document Type",ATOLink."Assembly Document No.") THEN
            IF "Posting Date" <> AsmHeader."Posting Date" THEN BEGIN
              Window.OPEN(STRSUBSTNO(SynchronizingMsg,"No.",AsmHeader."No."));
              AsmHeader.VALIDATE("Posting Date","Posting Date");
              AsmHeader.MODIFY;
              Window.CLOSE;
            END;
        UNTIL ATOLink.NEXT = 0;
    END;

    [External]
    PROCEDURE CheckShippingAdvice@55();
    VAR
      SalesLine@1000 : Record 37;
      Item@1003 : Record 27;
      QtyToShipBaseTotal@1002 : Decimal;
      Result@1001 : Boolean;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETRANGE("Drop Shipment",FALSE);
      SalesLine.SETRANGE(Type,SalesLine.Type::Item);
      Result := TRUE;
      IF SalesLine.FINDSET THEN
        REPEAT
          Item.GET(SalesLine."No.");
          IF SalesLine.IsShipment AND (Item.Type = Item.Type::Inventory) THEN BEGIN
            QtyToShipBaseTotal += SalesLine."Qty. to Ship (Base)";
            IF SalesLine."Quantity (Base)" <>
               SalesLine."Qty. to Ship (Base)" + SalesLine."Qty. Shipped (Base)"
            THEN
              Result := FALSE;
          END;
        UNTIL SalesLine.NEXT = 0;
      IF QtyToShipBaseTotal = 0 THEN
        Result := TRUE;

      OnAfterCheckShippingAdvice(Rec,Result);
      IF NOT Result THEN
        ERROR(ShippingAdviceErr);
    END;

    LOCAL PROCEDURE GetFilterCustNo@64() : Code[20];
    VAR
      MinValue@1002 : Code[20];
      MaxValue@1001 : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Customer No.") <> '' THEN BEGIN
        IF TryGetFilterCustNoRange(MinValue,MaxValue) THEN
          IF MinValue = MaxValue THEN
            EXIT(MaxValue);
      END;
    END;

    [TryFunction]
    LOCAL PROCEDURE TryGetFilterCustNoRange@128(VAR MinValue@1001 : Code[20];VAR MaxValue@1000 : Code[20]);
    BEGIN
      MinValue := GETRANGEMIN("Sell-to Customer No.");
      MaxValue := GETRANGEMAX("Sell-to Customer No.");
    END;

    LOCAL PROCEDURE GetFilterCustNoByApplyingFilter@129() : Code[20];
    VAR
      SalesHeader@1002 : Record 36;
      MinValue@1001 : Code[20];
      MaxValue@1000 : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Customer No.") <> '' THEN BEGIN
        SalesHeader.COPYFILTERS(Rec);
        SalesHeader.SETCURRENTKEY("Sell-to Customer No.");
        IF SalesHeader.FINDFIRST THEN
          MinValue := SalesHeader."Sell-to Customer No.";
        IF SalesHeader.FINDLAST THEN
          MaxValue := SalesHeader."Sell-to Customer No.";
        IF MinValue = MaxValue THEN
          EXIT(MaxValue);
      END;
    END;

    LOCAL PROCEDURE GetFilterContNo@65() : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Contact No.") <> '' THEN
        IF GETRANGEMIN("Sell-to Contact No.") = GETRANGEMAX("Sell-to Contact No.") THEN
          EXIT(GETRANGEMAX("Sell-to Contact No."));
    END;

    LOCAL PROCEDURE CheckCreditLimitIfLineNotInsertedYet@66();
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeCheckCreditLimitIfLineNotInsertedYet(Rec,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF "No." = '' THEN BEGIN
        HideCreditCheckDialogue := FALSE;
        CheckCreditMaxBeforeInsert;
        HideCreditCheckDialogue := TRUE;
      END;
    END;

    [External]
    PROCEDURE InvoicedLineExists@156() : Boolean;
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER(Type,'<>%1',SalesLine.Type::" ");
      SalesLine.SETFILTER("Quantity Invoiced",'<>%1',0);
      EXIT(NOT SalesLine.ISEMPTY);
    END;

    [External]
    PROCEDURE CreateDimSetForPrepmtAccDefaultDim@73();
    VAR
      SalesLine@1000 : Record 37;
      TempSalesLine@1003 : TEMPORARY Record 37;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>%1',0);
      IF SalesLine.FINDSET THEN
        REPEAT
          CollectParamsInBufferForCreateDimSet(TempSalesLine,SalesLine);
        UNTIL SalesLine.NEXT = 0;
      TempSalesLine.RESET;
      TempSalesLine.MARKEDONLY(FALSE);
      IF TempSalesLine.FINDSET THEN
        REPEAT
          SalesLine.CreateDim(DATABASE::"G/L Account",TempSalesLine."No.",
            DATABASE::Job,TempSalesLine."Job No.",
            DATABASE::"Responsibility Center",TempSalesLine."Responsibility Center",
            0,'',0,'',0,'',0,''); //**4PS.n
        UNTIL TempSalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE CollectParamsInBufferForCreateDimSet@72(VAR TempSalesLine@1000 : TEMPORARY Record 37;SalesLine@1001 : Record 37);
    VAR
      GenPostingSetup@1003 : Record 252;
      DefaultDimension@1002 : Record 352;
    BEGIN
      TempSalesLine.SETRANGE("Gen. Bus. Posting Group",SalesLine."Gen. Bus. Posting Group");
      TempSalesLine.SETRANGE("Gen. Prod. Posting Group",SalesLine."Gen. Prod. Posting Group");
      IF NOT TempSalesLine.FINDFIRST THEN BEGIN
        GenPostingSetup.GET(SalesLine."Gen. Bus. Posting Group",SalesLine."Gen. Prod. Posting Group");
        DefaultDimension.SETRANGE("Table ID",DATABASE::"G/L Account");
        DefaultDimension.SETRANGE("No.",GenPostingSetup.GetSalesPrepmtAccount);
        InsertTempSalesLineInBuffer(TempSalesLine,SalesLine,GenPostingSetup."Sales Prepayments Account",DefaultDimension.ISEMPTY);
      END ELSE
        IF NOT TempSalesLine.MARK THEN BEGIN
          TempSalesLine.SETRANGE("Job No.",SalesLine."Job No.");
          TempSalesLine.SETRANGE("Responsibility Center",SalesLine."Responsibility Center");
          IF TempSalesLine.ISEMPTY THEN
            InsertTempSalesLineInBuffer(TempSalesLine,SalesLine,TempSalesLine."No.",FALSE);
        END;
    END;

    LOCAL PROCEDURE InsertTempSalesLineInBuffer@71(VAR TempSalesLine@1001 : TEMPORARY Record 37;SalesLine@1000 : Record 37;AccountNo@1002 : Code[20];DefaultDimensionsNotExist@1003 : Boolean);
    BEGIN
      TempSalesLine.INIT;
      TempSalesLine."Line No." := SalesLine."Line No.";
      TempSalesLine."No." := AccountNo;
      TempSalesLine."Job No." := SalesLine."Job No.";
      TempSalesLine."Responsibility Center" := SalesLine."Responsibility Center";
      TempSalesLine."Gen. Bus. Posting Group" := SalesLine."Gen. Bus. Posting Group";
      TempSalesLine."Gen. Prod. Posting Group" := SalesLine."Gen. Prod. Posting Group";
      TempSalesLine.MARK := DefaultDimensionsNotExist;
      TempSalesLine.INSERT;
    END;

    [External]
    PROCEDURE OpenSalesOrderStatistics@70();
    BEGIN
      CalcInvDiscForHeader;
      CreateDimSetForPrepmtAccDefaultDim;
      COMMIT;
      PAGE.RUNMODAL(PAGE::"Sales Order Statistics",Rec);
    END;

    [External]
    PROCEDURE GetCardpageID@58() : Integer;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(PAGE::"Sales Quote");
        "Document Type"::Order:
          EXIT(PAGE::"Sales Order");
        "Document Type"::Invoice:
          EXIT(PAGE::"Sales Invoice");
        "Document Type"::"Credit Memo":
          EXIT(PAGE::"Sales Credit Memo");
        "Document Type"::"Blanket Order":
          EXIT(PAGE::"Blanket Sales Order");
        "Document Type"::"Return Order":
          EXIT(PAGE::"Sales Return Order");
      END;
    END;

    [External]
    PROCEDURE CheckAvailableCreditLimit@67() : Decimal;
    VAR
      Customer@1000 : Record 18;
      AvailableCreditLimit@1002 : Decimal;
    BEGIN
      IF ("Bill-to Customer No." = '') AND ("Sell-to Customer No." = '') THEN
        EXIT(0);

      IF NOT Customer.GET("Bill-to Customer No.") THEN
        //Customer.GET("Sell-to Customer No."); //**4PS.o
        //**4PS.sn
        IF NOT Customer.GET("Sell-to Customer No.") THEN
          EXIT(0);
        //**4PS.en

      AvailableCreditLimit := Customer.CalcAvailableCredit;

      IF AvailableCreditLimit < 0 THEN
        OnCustomerCreditLimitExceeded
      ELSE
        OnCustomerCreditLimitNotExceeded;

      EXIT(AvailableCreditLimit);
    END;

    [External]
    PROCEDURE SetStatus@99(NewStatus@1000 : Option);
    BEGIN
      Status := NewStatus;
      MODIFY;
    END;

    LOCAL PROCEDURE TestSalesLineFieldsBeforeRecreate@68();
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeTestSalesLineFieldsBeforeRecreate(Rec,IsHandled,SalesLine);
      IF IsHandled THEN
        EXIT;

      SalesLine.TESTFIELD("Job No.",'');
      SalesLine.TESTFIELD("Job Contract Entry No.",0);
      SalesLine.TESTFIELD("Quantity Invoiced",0);
      SalesLine.TESTFIELD("Return Qty. Received",0);
      SalesLine.TESTFIELD("Shipment No.",'');
      SalesLine.TESTFIELD("Return Receipt No.",'');
      SalesLine.TESTFIELD("Blanket Order No.",'');
      SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
      SalesLine.TESTFIELD("Service Location No.",''); //**4PS.n
      TestQuantityShippedField(SalesLine);
    END;

    LOCAL PROCEDURE RecreateReservEntryReqLine@75(VAR TempSalesLine@1000 : TEMPORARY Record 37;VAR TempATOLink@1003 : TEMPORARY Record 904;VAR ATOLink@1002 : Record 904);
    BEGIN
      REPEAT
        TestSalesLineFieldsBeforeRecreate;
        IF (SalesLine."Location Code" <> "Location Code") AND (NOT SalesLine.IsNonInventoriableItem) THEN
          SalesLine.VALIDATE("Location Code","Location Code");
        TempSalesLine := SalesLine;
        IF SalesLine.Nonstock THEN BEGIN
          SalesLine.Nonstock := FALSE;
          SalesLine.MODIFY;
        END;

        IF ATOLink.AsmExistsForSalesLine(TempSalesLine) THEN BEGIN
          TempATOLink := ATOLink;
          TempATOLink.INSERT;
          ATOLink.DELETE;
        END;

        TempSalesLine.INSERT;
        OnAfterInsertTempSalesLine(SalesLine,TempSalesLine);
        SalesLineReserve.CopyReservEntryToTemp(TempReservEntry,SalesLine);
        RecreateReqLine(SalesLine,0,TRUE);
      UNTIL SalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE TransferItemChargeAssgntSalesToTemp@69(VAR ItemChargeAssgntSales@1001 : Record 5809;VAR TempItemChargeAssgntSales@1000 : TEMPORARY Record 5809);
    BEGIN
      ItemChargeAssgntSales.SETRANGE("Document Type","Document Type");
      ItemChargeAssgntSales.SETRANGE("Document No.","No.");
      IF ItemChargeAssgntSales.FINDSET THEN BEGIN
        REPEAT
          TempItemChargeAssgntSales.INIT;
          TempItemChargeAssgntSales := ItemChargeAssgntSales;
          TempItemChargeAssgntSales.INSERT;
        UNTIL ItemChargeAssgntSales.NEXT = 0;
        ItemChargeAssgntSales.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE CreateSalesLine@78(VAR TempSalesLine@1000 : TEMPORARY Record 37;ChangedFieldName@1100525000 : Text[100]);
    VAR
      IsHandled@1001 : Boolean;
    BEGIN
      OnBeforeCreateSalesLine(TempSalesLine,IsHandled);
      IF IsHandled THEN
        EXIT;

      SalesLine.INIT;
      SalesLine."Line No." := SalesLine."Line No." + 10000;
      SalesLine.VALIDATE(Type,TempSalesLine.Type);
      OnCreateSalesLineOnAfterAssignType(SalesLine,TempSalesLine);
      SalesLine."System-Created Entry" := TempSalesLine."System-Created Entry"; //**4PS.n
      //IF TempSalesLine."No." = '' THEN BEGIN //**4PS.o
      IF (TempSalesLine."No." = '') AND (TempSalesLine."Plant Type" = '') THEN BEGIN //**4PS.n
        SalesLine.VALIDATE(Description,TempSalesLine.Description);
        SalesLine.VALIDATE("Description 2",TempSalesLine."Description 2");
      END ELSE BEGIN
        //**4PS.sn
        IF TempSalesLine."Plant Type" <> '' THEN BEGIN
          SalesLine.VALIDATE("Plant Type", TempSalesLine."Plant Type");
          SalesLine."Number of Time Units" := TempSalesLine."Number of Time Units";
        END ELSE
        //**4PS.en
          SalesLine.VALIDATE("No.",TempSalesLine."No.");
        IF SalesLine.Type <> SalesLine.Type::" " THEN BEGIN
          SalesLine.VALIDATE("Unit of Measure Code",TempSalesLine."Unit of Measure Code");
          SalesLine.VALIDATE("Variant Code",TempSalesLine."Variant Code");
          IF TempSalesLine.Quantity <> 0 THEN BEGIN
            SalesLine.VALIDATE(Quantity,TempSalesLine.Quantity);
            SalesLine.VALIDATE("Qty. to Assemble to Order",TempSalesLine."Qty. to Assemble to Order");
          END;
          SalesLine."Purchase Order No." := TempSalesLine."Purchase Order No.";
          SalesLine."Purch. Order Line No." := TempSalesLine."Purch. Order Line No.";
          SalesLine."Drop Shipment" := SalesLine."Purch. Order Line No." <> 0;
        END;
        SalesLine.VALIDATE("Shipment Date",TempSalesLine."Shipment Date");
      END;

      //**4PS.sn
      IF "Document Type" = "Document Type"::Quote THEN
        IF (SalesLine.Type <> 0) THEN
          IF ChangedFieldName = FIELDCAPTION("Sell-to Customer Template Code") THEN
            SalesLine.VALIDATE("Unit Price",TempSalesLine."Unit Price");
      SalesLine."Plant No." := TempSalesLine."Plant No.";
      SalesLine."Job No." := TempSalesLine."Job No.";
      SalesLine."Employee No." := TempSalesLine."Employee No." ;
      SalesLine."Shortcut Dimension 1 Code" := TempSalesLine."Shortcut Dimension 1 Code";
      SalesLine."Shortcut Dimension 2 Code" := TempSalesLine."Shortcut Dimension 2 Code";
      SalesLine."Project Invoice" := TempSalesLine."Project Invoice";
      SalesLine."Installment Invoice" := TempSalesLine."Installment Invoice";
      SalesLine."Service Invoice" := TempSalesLine."Service Invoice";
      SalesLine."Recipe Group" := TempSalesLine."Recipe Group"; //C051724
      SalesLine.Recipe := TempSalesLine.Recipe;  //C051724
      SalesLine."Item No." := TempSalesLine."Item No.";
      SalesLine."Basic Item" := TempSalesLine."Basic Item";
      SalesLine."Trade Item" := TempSalesLine."Trade Item";
      SalesLine.Manufacturer := TempSalesLine.Manufacturer;
      SalesLine."Vendor (Trade Item)" := TempSalesLine."Vendor (Trade Item)";
      SalesLine."Service Contract No." := TempSalesLine."Service Contract No.";
      SalesLine."Service Order No." := TempSalesLine."Service Order No.";
      SalesLine."Service Location No." := TempSalesLine."Service Location No.";
      SalesLine."Rental Unit" := TempSalesLine."Rental Unit";
      SalesLine."Additional Cost (Service)" := TempSalesLine."Additional Cost (Service)";
      SalesLine."Removal Contribution" := TempSalesLine."Removal Contribution";
      SalesLine.Element := TempSalesLine.Element;
      SalesLine."Cost Component" := TempSalesLine."Cost Component";
      SalesLine."Extension Contract" := TempSalesLine."Extension Contract";
      SalesLine."Blanket Order No." := TempSalesLine."Blanket Order No.";
      SalesLine."Blanket Order Line No." := TempSalesLine."Blanket Order Line No.";
      SalesLine."Location Code" := TempSalesLine."Location Code";
      SalesLine."Employee No." := TempSalesLine."Employee No.";
      SalesLine."Rental Unit" := TempSalesLine."Rental Unit";
      SalesLine."Additional Cost (Service)" := TempSalesLine."Additional Cost (Service)";
      SalesLine."Removal Contribution" := TempSalesLine."Removal Contribution";
      SalesLine."Arrival Date" := TempSalesLine."Arrival Date";
      SalesLine."Removal Date" := TempSalesLine."Removal Date";
      SalesLine."Rental Starting Date" := TempSalesLine."Rental Starting Date";
      SalesLine."Rental Ending Date" := TempSalesLine."Rental Ending Date";
      SalesLine."Alternative No." := TempSalesLine."Alternative No.";
      SalesLine.Optional := TempSalesLine.Optional;
      SalesLine."Original Quantity" := TempSalesLine."Original Quantity";
      SalesLine."BOM Item No." := TempSalesLine."BOM Item No.";
      SalesLine."Level BOM" := TempSalesLine."Level BOM";
      SalesLine."Loan Code" := TempSalesLine."Loan Code";
      SalesLine."Loan Type" := TempSalesLine."Loan Type";

      IF TempSalesLine."Part of Line" <> 0 THEN
        ConvPartOfLinetoNewPartOfLine(TempSalesLine."Part of Line",SalesLine."Part of Line");
      //**4PS.en

      OnBeforeSalesLineInsert(SalesLine,TempSalesLine);
      SalesLine.INSERT;
      OnAfterCreateSalesLine(SalesLine,TempSalesLine);
    END;

    LOCAL PROCEDURE CreateItemChargeAssgntSales@83(VAR TempItemChargeAssgntSales@1000 : TEMPORARY Record 5809;VAR TempSalesLine@1002 : TEMPORARY Record 37;VAR TempInteger@1003 : TEMPORARY Record 2000000026);
    VAR
      ItemChargeAssgntSales@1001 : Record 5809;
    BEGIN
      ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
      TempSalesLine.SETRANGE(Type,SalesLine.Type::"Charge (Item)");
      IF TempSalesLine.FINDSET THEN
        REPEAT
          TempItemChargeAssgntSales.SETRANGE("Document Line No.",TempSalesLine."Line No.");
          IF TempItemChargeAssgntSales.FINDSET THEN BEGIN
            REPEAT
              TempInteger.FINDFIRST;
              ItemChargeAssgntSales.INIT;
              ItemChargeAssgntSales := TempItemChargeAssgntSales;
              ItemChargeAssgntSales."Document Line No." := TempInteger.Number;
              ItemChargeAssgntSales.VALIDATE("Unit Cost",0);
              ItemChargeAssgntSales.INSERT;
            UNTIL TempItemChargeAssgntSales.NEXT = 0;
            TempInteger.DELETE;
          END;
        UNTIL TempSalesLine.NEXT = 0;

      ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
      TempItemChargeAssgntSales.DELETEALL;
    END;

    LOCAL PROCEDURE UpdateOutboundWhseHandlingTime@88();
    BEGIN
      IF "Location Code" <> '' THEN BEGIN
        IF Location.GET("Location Code") THEN
          "Outbound Whse. Handling Time" := Location."Outbound Whse. Handling Time";
      END ELSE
        IF InvtSetup.GET THEN
          "Outbound Whse. Handling Time" := InvtSetup."Outbound Whse. Handling Time";
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckSalesPostRestrictions@115();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCustomerCreditLimitExceeded@74();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCustomerCreditLimitNotExceeded@76();
    BEGIN
    END;

    [Integration(TRUE)]
    LOCAL PROCEDURE OnCheckSalesReleaseRestrictions@81();
    BEGIN
    END;

    [External]
    PROCEDURE CheckSalesReleaseRestrictions@162();
    VAR
      ApprovalsMgmt@1000 : Codeunit 1535;
    BEGIN
      OnCheckSalesReleaseRestrictions;
      ApprovalsMgmt.PrePostApprovalCheckSales(Rec);
    END;

    [External]
    PROCEDURE DeferralHeadersExist@82() : Boolean;
    VAR
      DeferralHeader@1000 : Record 1701;
      DeferralUtilities@1001 : Codeunit 1720;
    BEGIN
      DeferralHeader.SETRANGE("Deferral Doc. Type",DeferralUtilities.GetSalesDeferralDocType);
      DeferralHeader.SETRANGE("Gen. Jnl. Template Name",'');
      DeferralHeader.SETRANGE("Gen. Jnl. Batch Name",'');
      DeferralHeader.SETRANGE("Document Type","Document Type");
      DeferralHeader.SETRANGE("Document No.","No.");
      EXIT(NOT DeferralHeader.ISEMPTY);
    END;

    [External]
    PROCEDURE SetSellToCustomerFromFilter@186();
    VAR
      SellToCustomerNo@1000 : Code[20];
    BEGIN
      SellToCustomerNo := GetFilterCustNo;
      IF SellToCustomerNo = '' THEN BEGIN
        FILTERGROUP(2);
        SellToCustomerNo := GetFilterCustNo;
        IF SellToCustomerNo = '' THEN
          SellToCustomerNo := GetFilterCustNoByApplyingFilter;
        FILTERGROUP(0);
      END;
      IF SellToCustomerNo <> '' THEN
        VALIDATE("Sell-to Customer No.",SellToCustomerNo);
    END;

    [External]
    PROCEDURE CopySellToCustomerFilter@44();
    VAR
      SellToCustomerFilter@1000 : Text;
    BEGIN
      SellToCustomerFilter := GETFILTER("Sell-to Customer No.");
      IF SellToCustomerFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Sell-to Customer No.",SellToCustomerFilter);
        FILTERGROUP(0)
      END;
    END;

    LOCAL PROCEDURE ConfirmUpdateDeferralDate@85();
    BEGIN
      IF GetHideValidationDialog OR NOT GUIALLOWED THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(DeferralLineQst,FALSE);
      IF Confirmed THEN
        UpdateSalesLinesByFieldNo(SalesLine.FIELDNO("Deferral Code"),FALSE);
    END;

    [External]
    PROCEDURE BatchConfirmUpdateDeferralDate@130(VAR BatchConfirm@1000 : ' ,Skip,Update';ReplacePostingDate@1004 : Boolean;PostingDateReq@1003 : Date);
    BEGIN
      IF (NOT ReplacePostingDate) OR (PostingDateReq = "Posting Date") OR (BatchConfirm = BatchConfirm::Skip) THEN
        EXIT;

      IF NOT DeferralHeadersExist THEN
        EXIT;

      "Posting Date" := PostingDateReq;
      CASE BatchConfirm OF
        BatchConfirm::" ":
          BEGIN
            ConfirmUpdateDeferralDate;
            IF Confirmed THEN
              BatchConfirm := BatchConfirm::Update
            ELSE
              BatchConfirm := BatchConfirm::Skip;
          END;
        BatchConfirm::Update:
          UpdateSalesLinesByFieldNo(SalesLine.FIELDNO("Deferral Code"),FALSE);
      END;
      COMMIT;
    END;

    [External]
    PROCEDURE GetSelectedPaymentServicesText@84() : Text;
    VAR
      PaymentServiceSetup@1000 : Record 1060;
    BEGIN
      EXIT(PaymentServiceSetup.GetSelectedPaymentsText("Payment Service Set ID"));
    END;

    [External]
    PROCEDURE SetDefaultPaymentServices@86();
    VAR
      PaymentServiceSetup@1000 : Record 1060;
      SetID@1001 : Integer;
    BEGIN
      IF NOT PaymentServiceSetup.CanChangePaymentService(Rec) THEN
        EXIT;

      IF PaymentServiceSetup.GetDefaultPaymentServices(SetID) THEN
        VALIDATE("Payment Service Set ID",SetID);
    END;

    [External]
    PROCEDURE ChangePaymentServiceSetting@87();
    VAR
      PaymentServiceSetup@1000 : Record 1060;
      SetID@1001 : Integer;
    BEGIN
      SetID := "Payment Service Set ID";
      IF PaymentServiceSetup.SelectPaymentService(SetID) THEN BEGIN
        VALIDATE("Payment Service Set ID",SetID);
        MODIFY(TRUE);
      END;
    END;

    [External]
    PROCEDURE IsCreditDocType@110() : Boolean;
    VAR
      CreditDocType@1000 : Boolean;
    BEGIN
      CreditDocType := "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"];
      OnBeforeIsCreditDocType(Rec,CreditDocType);
      EXIT(CreditDocType);
    END;

    [External]
    PROCEDURE HasSellToAddress@94() : Boolean;
    BEGIN
      CASE TRUE OF
        "Sell-to Address" <> '':
          EXIT(TRUE);
        "Sell-to Address 2" <> '':
          EXIT(TRUE);
        "Sell-to City" <> '':
          EXIT(TRUE);
        "Sell-to Country/Region Code" <> '':
          EXIT(TRUE);
        "Sell-to County" <> '':
          EXIT(TRUE);
        "Sell-to Post Code" <> '':
          EXIT(TRUE);
        "Sell-to Contact" <> '':
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE HasShipToAddress@103() : Boolean;
    BEGIN
      CASE TRUE OF
        "Ship-to Address" <> '':
          EXIT(TRUE);
        "Ship-to Address 2" <> '':
          EXIT(TRUE);
        "Ship-to City" <> '':
          EXIT(TRUE);
        "Ship-to Country/Region Code" <> '':
          EXIT(TRUE);
        "Ship-to County" <> '':
          EXIT(TRUE);
        "Ship-to Post Code" <> '':
          EXIT(TRUE);
        "Ship-to Contact" <> '':
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE HasBillToAddress@95() : Boolean;
    BEGIN
      CASE TRUE OF
        "Bill-to Address" <> '':
          EXIT(TRUE);
        "Bill-to Address 2" <> '':
          EXIT(TRUE);
        "Bill-to City" <> '':
          EXIT(TRUE);
        "Bill-to Country/Region Code" <> '':
          EXIT(TRUE);
        "Bill-to County" <> '':
          EXIT(TRUE);
        "Bill-to Post Code" <> '':
          EXIT(TRUE);
        "Bill-to Contact" <> '':
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE HasItemChargeAssignment@170() : Boolean;
    VAR
      ItemChargeAssgntSales@1000 : Record 5809;
    BEGIN
      ItemChargeAssgntSales.SETRANGE("Document Type","Document Type");
      ItemChargeAssgntSales.SETRANGE("Document No.","No.");
      ItemChargeAssgntSales.SETFILTER("Amount to Assign",'<>%1',0);
      EXIT(NOT ItemChargeAssgntSales.ISEMPTY);
    END;

    LOCAL PROCEDURE CopySellToCustomerAddressFieldsFromCustomer@90(VAR SellToCustomer@1000 : Record 18);
    BEGIN
      "Sell-to Customer Template Code" := '';
      "Sell-to Customer Name" := Cust.Name;
      "Sell-to Customer Name 2" := Cust."Name 2";
      "Sell-to Phone No." := Cust."Phone No.";
      "Sell-to E-Mail" := Cust."E-Mail";
      IF SellToCustomerIsReplaced OR ShouldCopyAddressFromSellToCustomer(SellToCustomer) THEN BEGIN
        "Sell-to Address" := SellToCustomer.Address;
        "Sell-to Address 2" := SellToCustomer."Address 2";
        "Sell-to City" := SellToCustomer.City;
        "Sell-to Post Code" := SellToCustomer."Post Code";
        "Sell-to County" := SellToCustomer.County;
        "Sell-to Country/Region Code" := SellToCustomer."Country/Region Code";
      END;
      IF NOT SkipSellToContact THEN
        "Sell-to Contact" := SellToCustomer.Contact;

      //**4PS.sn
      IF NOT SkipSellToContact THEN
        "Sell-to Contact No." := '';
      //**4PS.en

      "Gen. Bus. Posting Group" := SellToCustomer."Gen. Bus. Posting Group";
      "VAT Bus. Posting Group" := SellToCustomer."VAT Bus. Posting Group";
      "Tax Area Code" := SellToCustomer."Tax Area Code";
      "Tax Liable" := SellToCustomer."Tax Liable";
      "VAT Registration No." := SellToCustomer."VAT Registration No.";
      "VAT Country/Region Code" := SellToCustomer."Country/Region Code";
      "Shipping Advice" := SellToCustomer."Shipping Advice";
      "Responsibility Center" := UserSetupMgt.GetRespCenter(0,SellToCustomer."Responsibility Center");
      OnCopySelltoCustomerAddressFieldsFromCustomerOnAfterAssignRespCenter(Rec,SellToCustomer,CurrFieldNo);
      UpdateLocationCode(SellToCustomer."Location Code");

      //**4PS.sn
      "Transaction Type" := Cust."Transaction Type";
      "Transaction Specification" := Cust."Transaction Specification";
      "Transport Method" := Cust."Transport Method";
      "Exit Point" := Cust."Exit Point";
      FillDefaultServiceWarrantyCode;
      SkipRecreateSalesLines := TRUE;
      //**4PS.en
      "Account Code DK" := Cust."Account Code DK";  //NAVDK
      //>>NAVNO
      "Account Code NO" := Cust."Account Code NO";
      GLN := Cust.GLN;
      "E-Invoice" := Cust."E-Invoice";
      //<<NAVNO

      OnAfterCopySellToCustomerAddressFieldsFromCustomer(Rec,SellToCustomer,CurrFieldNo);
    END;

    LOCAL PROCEDURE CopyShipToCustomerAddressFieldsFromCustomer@98(VAR SellToCustomer@1000 : Record 18);
    VAR
      SellToCustTemplate@1001 : Record 5105;
      IsHandled@1002 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeCopyShipToCustomerAddressFieldsFromCustomer(Rec,SellToCustomer,IsHandled);
      IF IsHandled THEN
        EXIT;

      "Ship-to Name" := Cust.Name;
      "Ship-to Name 2" := Cust."Name 2";
      IF SellToCustomerIsReplaced OR ShipToAddressEqualsOldSellToAddress THEN BEGIN
        "Ship-to Address" := SellToCustomer.Address;
        "Ship-to Address 2" := SellToCustomer."Address 2";
        "Ship-to City" := SellToCustomer.City;
        "Ship-to Post Code" := SellToCustomer."Post Code";
        "Ship-to County" := SellToCustomer.County;
        VALIDATE("Ship-to Country/Region Code",SellToCustomer."Country/Region Code");
      END;
      "Ship-to Contact" := Cust.Contact;
      IF Cust."Shipment Method Code" <> '' THEN
        VALIDATE("Shipment Method Code",Cust."Shipment Method Code");
      IF NOT SellToCustTemplate.GET("Sell-to Customer Template Code") THEN BEGIN
        "Tax Area Code" := Cust."Tax Area Code";
        "Tax Liable" := Cust."Tax Liable";
      END;
      IF Cust."Location Code" <> '' THEN
        VALIDATE("Location Code",Cust."Location Code");
      "Shipping Agent Code" := Cust."Shipping Agent Code";
      "Shipping Agent Service Code" := Cust."Shipping Agent Service Code";

      OnAfterCopyShipToCustomerAddressFieldsFromCustomer(Rec,SellToCustomer);
    END;

    LOCAL PROCEDURE CopyShipToCustomerAddressFieldsFromShipToAddr@165(ShipToAddr@1000 : Record 222);
    VAR
      IsHandled@1001 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeCopyShipToCustomerAddressFieldsFromShipToAddr(Rec,ShipToAddr,IsHandled);
      IF IsHandled THEN
        EXIT;

      "Ship-to Name" := ShipToAddr.Name;
      "Ship-to Name 2" := ShipToAddr."Name 2";
      "Ship-to Address" := ShipToAddr.Address;
      "Ship-to Address 2" := ShipToAddr."Address 2";
      "Ship-to City" := ShipToAddr.City;
      "Ship-to Post Code" := ShipToAddr."Post Code";
      "Ship-to County" := ShipToAddr.County;
      IF "Ship-to Country/Region Code" <> ShipToAddr."Country/Region Code" THEN //**4PS Call C035382
        VALIDATE("Ship-to Country/Region Code",ShipToAddr."Country/Region Code");
      "Ship-to Contact" := ShipToAddr.Contact;
      "Ship-to Contact No." := ''; //**4PS.n
      IF ShipToAddr."Shipment Method Code" <> '' THEN
        VALIDATE("Shipment Method Code",ShipToAddr."Shipment Method Code");
      IF ShipToAddr."Location Code" <> '' THEN
        VALIDATE("Location Code",ShipToAddr."Location Code");
      "Shipping Agent Code" := ShipToAddr."Shipping Agent Code";
      "Shipping Agent Service Code" := ShipToAddr."Shipping Agent Service Code";
      IF ShipToAddr."Tax Area Code" <> '' THEN
        "Tax Area Code" := ShipToAddr."Tax Area Code";
      "Tax Liable" := ShipToAddr."Tax Liable";
      OnAfterCopyShipToCustomerAddressFieldsFromShipToAddr(Rec,ShipToAddr);
    END;

    LOCAL PROCEDURE CopyBillToCustomerAddressFieldsFromCustomer@93(VAR BillToCustomer@1000 : Record 18);
    BEGIN
      "Bill-to Customer Template Code" := '';
      "Bill-to Name" := BillToCustomer.Name;
      "Bill-to Name 2" := BillToCustomer."Name 2";
      IF BillToCustomerIsReplaced OR ShouldCopyAddressFromBillToCustomer(BillToCustomer) THEN BEGIN
        "Bill-to Address" := BillToCustomer.Address;
        "Bill-to Address 2" := BillToCustomer."Address 2";
        "Bill-to City" := BillToCustomer.City;
        "Bill-to Post Code" := BillToCustomer."Post Code";
        "Bill-to County" := BillToCustomer.County;
        "Bill-to Country/Region Code" := BillToCustomer."Country/Region Code";
      END;
      IF NOT SkipBillToContact THEN
        "Bill-to Contact" := BillToCustomer.Contact;
      "Payment Terms Code" := BillToCustomer."Payment Terms Code";
      "Prepmt. Payment Terms Code" := BillToCustomer."Payment Terms Code";

      IF "Document Type" IN ["Document Type"::"Credit Memo","Document Type"::"Return Order"] THEN BEGIN
        "Payment Method Code" := '';
        IF PaymentTerms.GET("Payment Terms Code") THEN
          IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
            "Payment Method Code" := BillToCustomer."Payment Method Code"
      END ELSE
        "Payment Method Code" := BillToCustomer."Payment Method Code";

      GLSetup.GET;
      IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN BEGIN
        "VAT Bus. Posting Group" := BillToCustomer."VAT Bus. Posting Group";
        "VAT Country/Region Code" := BillToCustomer."Country/Region Code";
        "VAT Registration No." := BillToCustomer."VAT Registration No.";
        "Gen. Bus. Posting Group" := BillToCustomer."Gen. Bus. Posting Group";
      END;
      "Customer Posting Group" := BillToCustomer."Customer Posting Group";
      "Currency Code" := BillToCustomer."Currency Code";
      "Customer Price Group" := BillToCustomer."Customer Price Group";
      "Prices Including VAT" := BillToCustomer."Prices Including VAT";
      "Allow Line Disc." := BillToCustomer."Allow Line Disc.";
      "Invoice Disc. Code" := BillToCustomer."Invoice Disc. Code";
      "Customer Disc. Group" := BillToCustomer."Customer Disc. Group";
      "Language Code" := BillToCustomer."Language Code";
      //SetSalespersonCode(BillToCustomer."Salesperson Code","Salesperson Code"); //**4PS.o
      FillDefaultSalesPerson();  //**4PS.n
      "Combine Shipments" := BillToCustomer."Combine Shipments";
      Reserve := BillToCustomer.Reserve;
      IF "Document Type" = "Document Type"::Order THEN
        "Prepayment %" := BillToCustomer."Prepayment %";
      "Tax Area Code" := BillToCustomer."Tax Area Code";
      "Tax Liable" := BillToCustomer."Tax Liable";

      FillDefaultInvoiceLayoutCode();  //**4PS.n

        //>>NAVNO
        GLN := Cust.GLN;
        "E-Invoice" := Cust."E-Invoice";
        //<<NANO
        "EAN No." := Cust."EAN No."; //NAVDK
        //4PSFI_FINVOICE+
        GLSetup.GET;
        IF GLSetup."Finnish localization active" THEN
          "Finvoice Enabled" := Cust."Finvoice Enabled";
        //4PSFI_FINVOICE-
      "OIOUBL Profile Code" := Cust."OIOUBL Profile Code";  //NAVDK

      OnAfterSetFieldsBilltoCustomer(Rec,BillToCustomer);
    END;

    [External]
    PROCEDURE SetShipToAddress@117(ShipToName@1000 : Text[100];ShipToName2@1001 : Text[50];ShipToAddress@1002 : Text[100];ShipToAddress2@1003 : Text[50];ShipToCity@1004 : Text[30];ShipToPostCode@1005 : Code[20];ShipToCounty@1006 : Text[30];ShipToCountryRegionCode@1007 : Code[10]);
    BEGIN
      "Ship-to Name" := ShipToName;
      "Ship-to Name 2" := ShipToName2;
      "Ship-to Address" := ShipToAddress;
      "Ship-to Address 2" := ShipToAddress2;
      "Ship-to City" := ShipToCity;
      "Ship-to Post Code" := ShipToPostCode;
      "Ship-to County" := ShipToCounty;
      "Ship-to Country/Region Code" := ShipToCountryRegionCode;
    END;

    LOCAL PROCEDURE ShouldCopyAddressFromSellToCustomer@101(SellToCustomer@1000 : Record 18) : Boolean;
    BEGIN
      EXIT((NOT HasSellToAddress) AND SellToCustomer.HasAddress);
    END;

    LOCAL PROCEDURE ShouldCopyAddressFromBillToCustomer@102(BillToCustomer@1000 : Record 18) : Boolean;
    BEGIN
      EXIT((NOT HasBillToAddress) AND BillToCustomer.HasAddress);
    END;

    LOCAL PROCEDURE SellToCustomerIsReplaced@96() : Boolean;
    BEGIN
      EXIT((xRec."Sell-to Customer No." <> '') AND (xRec."Sell-to Customer No." <> "Sell-to Customer No."));
    END;

    LOCAL PROCEDURE BillToCustomerIsReplaced@97() : Boolean;
    BEGIN
      EXIT((xRec."Bill-to Customer No." <> '') AND (xRec."Bill-to Customer No." <> "Bill-to Customer No."));
    END;

    LOCAL PROCEDURE UpdateShipToAddressFromSellToAddress@50(FieldNumber@1000 : Integer);
    BEGIN
      IF ("Ship-to Code" = '') AND ShipToAddressEqualsOldSellToAddress THEN
        CASE FieldNumber OF
          FIELDNO("Ship-to Address"):
            "Ship-to Address" := "Sell-to Address";
          FIELDNO("Ship-to Address 2"):
            "Ship-to Address 2" := "Sell-to Address 2";
          FIELDNO("Ship-to City"),FIELDNO("Ship-to Post Code"):
            BEGIN
              "Ship-to City" := "Sell-to City";
              "Ship-to Post Code" := "Sell-to Post Code";
              "Ship-to County" := "Sell-to County";
              "Ship-to Country/Region Code" := "Sell-to Country/Region Code";
            END;
          FIELDNO("Ship-to County"):
            "Ship-to County" := "Sell-to County";
          FIELDNO("Ship-to Country/Region Code"):
            "Ship-to Country/Region Code" := "Sell-to Country/Region Code";
        END;
    END;

    LOCAL PROCEDURE ShipToAddressEqualsOldSellToAddress@51() : Boolean;
    BEGIN
      EXIT(IsShipToAddressEqualToSellToAddress(xRec,Rec));
    END;

    [External]
    PROCEDURE ShipToAddressEqualsSellToAddress@111() : Boolean;
    BEGIN
      EXIT(IsShipToAddressEqualToSellToAddress(Rec,Rec));
    END;

    LOCAL PROCEDURE IsShipToAddressEqualToSellToAddress@113(SalesHeaderWithSellTo@1000 : Record 36;SalesHeaderWithShipTo@1001 : Record 36) : Boolean;
    VAR
      Result@1002 : Boolean;
    BEGIN
      Result :=
        (SalesHeaderWithSellTo."Sell-to Address" = SalesHeaderWithShipTo."Ship-to Address") AND
        (SalesHeaderWithSellTo."Sell-to Address 2" = SalesHeaderWithShipTo."Ship-to Address 2") AND
        (SalesHeaderWithSellTo."Sell-to City" = SalesHeaderWithShipTo."Ship-to City") AND
        (SalesHeaderWithSellTo."Sell-to County" = SalesHeaderWithShipTo."Ship-to County") AND
        (SalesHeaderWithSellTo."Sell-to Post Code" = SalesHeaderWithShipTo."Ship-to Post Code") AND
        (SalesHeaderWithSellTo."Sell-to Country/Region Code" = SalesHeaderWithShipTo."Ship-to Country/Region Code") AND
        (SalesHeaderWithSellTo."Sell-to Contact" = SalesHeaderWithShipTo."Ship-to Contact");

      OnAfterIsShipToAddressEqualToSellToAddress(SalesHeaderWithSellTo,SalesHeaderWithShipTo,Result);
      EXIT(Result);
    END;

    [External]
    PROCEDURE BillToAddressEqualsSellToAddress@232() : Boolean;
    BEGIN
      EXIT(IsBillToAddressEqualToSellToAddress(Rec,Rec));
    END;

    LOCAL PROCEDURE IsBillToAddressEqualToSellToAddress@233(SalesHeaderWithSellTo@1000 : Record 36;SalesHeaderWithBillTo@1001 : Record 36) : Boolean;
    BEGIN
      IF (SalesHeaderWithSellTo."Sell-to Address" = SalesHeaderWithBillTo."Bill-to Address") AND
         (SalesHeaderWithSellTo."Sell-to Address 2" = SalesHeaderWithBillTo."Bill-to Address 2") AND
         (SalesHeaderWithSellTo."Sell-to City" = SalesHeaderWithBillTo."Bill-to City") AND
         (SalesHeaderWithSellTo."Sell-to County" = SalesHeaderWithBillTo."Bill-to County") AND
         (SalesHeaderWithSellTo."Sell-to Post Code" = SalesHeaderWithBillTo."Bill-to Post Code") AND
         (SalesHeaderWithSellTo."Sell-to Country/Region Code" = SalesHeaderWithBillTo."Bill-to Country/Region Code") AND
         (SalesHeaderWithSellTo."Sell-to Contact No." = SalesHeaderWithBillTo."Bill-to Contact No.") AND
         (SalesHeaderWithSellTo."Sell-to Contact" = SalesHeaderWithBillTo."Bill-to Contact")
      THEN
        EXIT(TRUE);
    END;

    [External]
    PROCEDURE CopySellToAddressToShipToAddress@112();
    BEGIN
      "Ship-to Address" := "Sell-to Address";
      "Ship-to Address 2" := "Sell-to Address 2";
      "Ship-to City" := "Sell-to City";
      "Ship-to Contact" := "Sell-to Contact";
      "Ship-to Country/Region Code" := "Sell-to Country/Region Code";
      "Ship-to County" := "Sell-to County";
      "Ship-to Post Code" := "Sell-to Post Code";

      OnAfterCopySellToAddressToShipToAddress(Rec);
    END;

    [External]
    PROCEDURE CopySellToAddressToBillToAddress@92();
    BEGIN
      IF "Bill-to Customer No." = "Sell-to Customer No." THEN BEGIN
        "Bill-to Address" := "Sell-to Address";
        "Bill-to Address 2" := "Sell-to Address 2";
        "Bill-to Post Code" := "Sell-to Post Code";
        "Bill-to Country/Region Code" := "Sell-to Country/Region Code";
        "Bill-to City" := "Sell-to City";
        "Bill-to County" := "Sell-to County";
        OnAfterCopySellToAddressToBillToAddress(Rec);
      END;
    END;

    LOCAL PROCEDURE UpdateShipToContact@149();
    BEGIN
      IF NOT (CurrFieldNo IN [FIELDNO("Sell-to Contact"),FIELDNO("Sell-to Contact No.")]) THEN
        EXIT;

      IF IsCreditDocType THEN
        EXIT;

      VALIDATE("Ship-to Contact","Sell-to Contact");
    END;

    [External]
    PROCEDURE ConfirmCloseUnposted@104() : Boolean;
    VAR
      InstructionMgt@1000 : Codeunit 1330;
    BEGIN
      IF Status <> Status::Closed THEN //**4PS.n
        IF SalesLinesExist THEN
          IF InstructionMgt.IsUnpostedEnabledForRecord(Rec) THEN
            EXIT(InstructionMgt.ShowConfirm(DocumentNotPostedClosePageQst,InstructionMgt.QueryPostOnCloseCode));
      EXIT(TRUE)
    END;

    LOCAL PROCEDURE UpdateOpportunity@108();
    VAR
      Opp@1002 : Record 5092;
      OpportunityEntry@1001 : Record 5093;
      ConfirmManagement@1000 : Codeunit 27;
    BEGIN
      IF NOT ("Opportunity No." <> '') OR NOT ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) THEN
        EXIT;

      IF NOT Opp.GET("Opportunity No.") THEN
        EXIT;

      IF "Document Type" = "Document Type"::Order THEN BEGIN
        IF NOT ConfirmManagement.ConfirmProcess(Text040,TRUE) THEN
          ERROR(Text044);

        OpportunityEntry.SETRANGE("Opportunity No.","Opportunity No.");
        OpportunityEntry.MODIFYALL(Active,FALSE);

        OpportunityEntry.INIT;
        OpportunityEntry.VALIDATE("Opportunity No.",Opp."No.");

        OpportunityEntry.LOCKTABLE;
        OpportunityEntry."Entry No." := GetOpportunityEntryNo;
        OpportunityEntry."Sales Cycle Code" := Opp."Sales Cycle Code";
        OpportunityEntry."Contact No." := Opp."Contact No.";
        OpportunityEntry."Contact Company No." := Opp."Contact Company No.";
        OpportunityEntry."Salesperson Code" := Opp."Salesperson Code";
        OpportunityEntry."Campaign No." := Opp."Campaign No.";
        OpportunityEntry."Action Taken" := OpportunityEntry."Action Taken"::Lost;
        OpportunityEntry.Active := TRUE;
        OpportunityEntry."Completed %" := 100;
        OpportunityEntry."Estimated Value (LCY)" := GetOpportunityEntryEstimatedValue;
        OpportunityEntry."Estimated Close Date" := Opp."Date Closed";
        OpportunityEntry.INSERT(TRUE);
      END;
      Opp.FIND;
      Opp."Sales Document Type" := Opp."Sales Document Type"::" ";
      Opp."Sales Document No." := '';
      Opp.MODIFY;
      "Opportunity No." := '';
    END;

    LOCAL PROCEDURE GetOpportunityEntryNo@106() : Integer;
    VAR
      OpportunityEntry@1000 : Record 5093;
    BEGIN
      IF OpportunityEntry.FINDLAST THEN
        EXIT(OpportunityEntry."Entry No." + 1);
      EXIT(1);
    END;

    LOCAL PROCEDURE GetOpportunityEntryEstimatedValue@107() : Decimal;
    VAR
      OpportunityEntry@1000 : Record 5093;
    BEGIN
      OpportunityEntry.SETRANGE("Opportunity No.","Opportunity No.");
      IF OpportunityEntry.FINDLAST THEN
        EXIT(OpportunityEntry."Estimated Value (LCY)");
    END;

    [External]
    PROCEDURE InitFromSalesHeader@109(SourceSalesHeader@1000 : Record 36);
    BEGIN
      "Document Date" := SourceSalesHeader."Document Date";
      "Shipment Date" := SourceSalesHeader."Shipment Date";
      "Shortcut Dimension 1 Code" := SourceSalesHeader."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := SourceSalesHeader."Shortcut Dimension 2 Code";
      "Dimension Set ID" := SourceSalesHeader."Dimension Set ID";
      "Location Code" := SourceSalesHeader."Location Code";
      SetShipToAddress(
        SourceSalesHeader."Ship-to Name",SourceSalesHeader."Ship-to Name 2",SourceSalesHeader."Ship-to Address",
        SourceSalesHeader."Ship-to Address 2",SourceSalesHeader."Ship-to City",SourceSalesHeader."Ship-to Post Code",
        SourceSalesHeader."Ship-to County",SourceSalesHeader."Ship-to Country/Region Code");
      "Ship-to Contact" := SourceSalesHeader."Ship-to Contact";

      OnAfterInitFromSalesHeader(Rec,SourceSalesHeader);

      FillDefaultEMailInvoice; //**4PS.n
    END;

    LOCAL PROCEDURE InitFromContact@126(ContactNo@1000 : Code[20];CustomerNo@1001 : Code[20];ContactCaption@1002 : Text) : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      IF (ContactNo = '') AND (CustomerNo = '') THEN BEGIN
        IF NOT SalesLine.ISEMPTY THEN
          ERROR(Text005,ContactCaption);
        INIT;
        GetSalesSetup;
        "No. Series" := xRec."No. Series";
        OnInitFromContactOnBeforeInitRecord(Rec,xRec);
        InitRecord;
        InitNoSeries;
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE InitFromTemplate@118(TemplateCode@1000 : Code[20];TemplateCaption@1001 : Text) : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      IF TemplateCode = '' THEN BEGIN
        IF NOT SalesLine.ISEMPTY THEN
          ERROR(Text005,TemplateCaption);
        INIT;
        GetSalesSetup;
        "No. Series" := xRec."No. Series";
        OnInitFromTemplateOnBeforeInitRecord(Rec,xRec);
        InitRecord;
        InitNoSeries;
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE ValidateTaxAreaCode@36();
    VAR
      TaxArea@1000 : Record 318;
      IdentityManagement@1001 : Codeunit 9801;
    BEGIN
      IF "Tax Area Code" = '' THEN
        EXIT;
      IF IdentityManagement.IsInvAppId THEN BEGIN
        IF NOT TaxArea.GET("Tax Area Code") THEN BEGIN
          TaxArea.SETFILTER(Code,"Tax Area Code" + '*');
          IF NOT TaxArea.FINDFIRST THEN
            TaxArea.CreateTaxArea("Tax Area Code","Sell-to City","Sell-to County");
          "Tax Area Code" := TaxArea.Code;
        END;

        IF Cust.GET("Sell-to Customer No.") THEN
          IF Cust."Tax Area Code" = '' THEN BEGIN
            Cust."Tax Area Code" := "Tax Area Code";
            Cust.MODIFY;
          END;
      END ELSE
        TaxArea.GET("Tax Area Code");
    END;

    [External]
    PROCEDURE SetWorkDescription@120(NewWorkDescription@1000 : Text);
    VAR
      TempBlob@1001 : TEMPORARY Record 99008535;
    BEGIN
      CLEAR("Work Description");
      IF NewWorkDescription = '' THEN
        EXIT;
      TempBlob.Blob := "Work Description";
      TempBlob.WriteAsText(NewWorkDescription,TEXTENCODING::UTF8);
      "Work Description" := TempBlob.Blob;
      MODIFY;
    END;

    [External]
    PROCEDURE GetWorkDescription@114() : Text;
    BEGIN
      CALCFIELDS("Work Description");
      EXIT(GetWorkDescriptionWorkDescriptionCalculated);
    END;

    [External]
    PROCEDURE GetWorkDescriptionWorkDescriptionCalculated@160() : Text;
    VAR
      TempBlob@1000 : TEMPORARY Record 99008535;
      CR@1004 : Text[1];
    BEGIN
      CALCFIELDS("Work Description");
      IF NOT "Work Description".HASVALUE THEN
        EXIT('');

      CR[1] := 10;
      TempBlob.Blob := "Work Description";
      EXIT(TempBlob.ReadAsText(CR,TEXTENCODING::UTF8));
    END;

    LOCAL PROCEDURE LookupContact@122(CustomerNo@1000 : Code[20];ContactNo@1003 : Code[20];VAR Contact@1001 : Record 5050);
    VAR
      ContactBusinessRelation@1002 : Record 5054;
      FilterByContactCompany@1004 : Boolean;
    BEGIN
      ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      IF ContactBusinessRelation.FindByRelation(ContactBusinessRelation."Link to Table"::Customer,CustomerNo) THEN
      ContactBusinessRelation.SETRANGE("No.",CustomerNo);
      IF ContactBusinessRelation.FINDFIRST THEN
        Contact.SETRANGE("Company No.",ContactBusinessRelation."Contact No.")
      ELSE
        IF "Document Type" = "Document Type"::Quote THEN
          FilterByContactCompany := TRUE
        ELSE
          Contact.SETRANGE("Company No.",'');
      IF ContactNo <> '' THEN
        IF Contact.GET(ContactNo) THEN
          IF FilterByContactCompany THEN
            Contact.SETRANGE("Company No.",Contact."Company No.");
    END;

    [External]
    PROCEDURE SetAllowSelectNoSeries@100();
    BEGIN
      SelectNoSeriesAllowed := TRUE;
    END;

    LOCAL PROCEDURE SetDefaultSalesperson@124();
    VAR
      UserSetup@1000 : Record 91;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN
        EXIT;

      IF UserSetup."Salespers./Purch. Code" <> '' THEN
        IF Salesperson.GET(UserSetup."Salespers./Purch. Code") THEN
          IF NOT Salesperson.VerifySalesPersonPurchaserPrivacyBlocked(Salesperson) THEN
            VALIDATE("Salesperson Code",UserSetup."Salespers./Purch. Code");
    END;

    [External]
    PROCEDURE SelltoCustomerNoOnAfterValidate@125(VAR SalesHeader@1000 : Record 36;VAR xSalesHeader@1001 : Record 36);
    BEGIN
      IF SalesHeader.GETFILTER("Sell-to Customer No.") = xSalesHeader."Sell-to Customer No." THEN
        IF SalesHeader."Sell-to Customer No." <> xSalesHeader."Sell-to Customer No." THEN
          SalesHeader.SETRANGE("Sell-to Customer No.");
    END;

    [External]
    PROCEDURE SelectSalesHeaderCustomerTemplate@127() : Code[10];
    VAR
      Contact@1001 : Record 5050;
      ConfirmManagement@1000 : Codeunit 27;
    BEGIN
      Contact.GET("Sell-to Contact No.");
      IF (Contact.Type = Contact.Type::Person) AND (Contact."Company No." <> '')THEN
        Contact.GET(Contact."Company No.");
      IF NOT Contact.ContactToCustBusinessRelationExist THEN
        IF ConfirmManagement.ConfirmProcessUI(SelectCustomerTemplateQst,FALSE) THEN BEGIN
          COMMIT;
          EXIT(Contact.LookupCustomerTemplate);
        END;
    END;

    LOCAL PROCEDURE ModifyBillToCustomerAddress@194();
    VAR
      Customer@1000 : Record 18;
    BEGIN
      GetSalesSetup;
      IF SalesSetup."Ignore Updated Addresses" THEN
        EXIT;
      IF IsCreditDocType THEN
        EXIT;
      IF ("Bill-to Customer No." <> "Sell-to Customer No.") AND Customer.GET("Bill-to Customer No.") THEN
        IF HasBillToAddress AND HasDifferentBillToAddress(Customer) THEN
          ShowModifyAddressNotification(GetModifyBillToCustomerAddressNotificationId,
            ModifyCustomerAddressNotificationLbl,ModifyCustomerAddressNotificationMsg,
            'CopyBillToCustomerAddressFieldsFromSalesDocument',"Bill-to Customer No.",
            "Bill-to Name",FIELDNAME("Bill-to Customer No."));
    END;

    LOCAL PROCEDURE ModifyCustomerAddress@150();
    VAR
      Customer@1000 : Record 18;
    BEGIN
      GetSalesSetup;
      IF SalesSetup."Ignore Updated Addresses" THEN
        EXIT;
      IF IsCreditDocType THEN
        EXIT;
      IF Customer.GET("Sell-to Customer No.") AND HasSellToAddress AND HasDifferentSellToAddress(Customer) THEN
        ShowModifyAddressNotification(GetModifyCustomerAddressNotificationId,
          ModifyCustomerAddressNotificationLbl,ModifyCustomerAddressNotificationMsg,
          'CopySellToCustomerAddressFieldsFromSalesDocument',"Sell-to Customer No.",
          "Sell-to Customer Name",FIELDNAME("Sell-to Customer No."));
    END;

    LOCAL PROCEDURE ShowModifyAddressNotification@157(NotificationID@1001 : GUID;NotificationLbl@1004 : Text;NotificationMsg@1005 : Text;NotificationFunctionTok@1006 : Text;CustomerNumber@1002 : Code[20];CustomerName@1003 : Text[100];CustomerNumberFieldName@1008 : Text);
    VAR
      MyNotifications@1009 : Record 1518;
      NotificationLifecycleMgt@1007 : Codeunit 1511;
      PageMyNotifications@1010 : Page 1518;
      ModifyCustomerAddressNotification@1000 : Notification;
    BEGIN
      IF NOT MyNotifications.GET(USERID,NotificationID) THEN
        PageMyNotifications.InitializeNotificationsWithDefaultState;

      IF NOT MyNotifications.IsEnabled(NotificationID) THEN
        EXIT;

      ModifyCustomerAddressNotification.ID := NotificationID;
      ModifyCustomerAddressNotification.MESSAGE := STRSUBSTNO(NotificationMsg,CustomerName);
      ModifyCustomerAddressNotification.ADDACTION(NotificationLbl,CODEUNIT::"Document Notifications",NotificationFunctionTok);
      ModifyCustomerAddressNotification.ADDACTION(
        DontShowAgainActionLbl,CODEUNIT::"Document Notifications",'HideNotificationForCurrentUser');
      ModifyCustomerAddressNotification.SCOPE := NOTIFICATIONSCOPE::LocalScope;
      ModifyCustomerAddressNotification.SETDATA(FIELDNAME("Document Type"),FORMAT("Document Type"));
      ModifyCustomerAddressNotification.SETDATA(FIELDNAME("No."),"No.");
      ModifyCustomerAddressNotification.SETDATA(CustomerNumberFieldName,CustomerNumber);
      NotificationLifecycleMgt.SendNotification(ModifyCustomerAddressNotification,RECORDID);
    END;

    [External]
    PROCEDURE RecallModifyAddressNotification@148(NotificationID@1001 : GUID);
    VAR
      MyNotifications@1002 : Record 1518;
      ModifyCustomerAddressNotification@1000 : Notification;
    BEGIN
      IF IsCreditDocType OR (NOT MyNotifications.IsEnabled(NotificationID)) THEN
        EXIT;

      ModifyCustomerAddressNotification.ID := NotificationID;
      ModifyCustomerAddressNotification.RECALL;
    END;

    [External]
    PROCEDURE GetModifyCustomerAddressNotificationId@193() : GUID;
    BEGIN
      EXIT('509FD112-31EC-4CDC-AEBF-19B8FEBA526F');
    END;

    [External]
    PROCEDURE GetModifyBillToCustomerAddressNotificationId@191() : GUID;
    BEGIN
      EXIT('2096CE78-6A74-48DB-BC9A-CD5C21504FC1');
    END;

    [External]
    PROCEDURE GetLineInvoiceDiscountResetNotificationId@307() : GUID;
    BEGIN
      EXIT('35AB3090-2E03-4849-BBF9-9664DE464605');
    END;

    [External]
    PROCEDURE SetModifyCustomerAddressNotificationDefaultState@89();
    VAR
      MyNotifications@1000 : Record 1518;
    BEGIN
      MyNotifications.InsertDefault(GetModifyCustomerAddressNotificationId,
        ModifySellToCustomerAddressNotificationNameTxt,ModifySellToCustomerAddressNotificationDescriptionTxt,TRUE);
    END;

    [External]
    PROCEDURE SetModifyBillToCustomerAddressNotificationDefaultState@91();
    VAR
      MyNotifications@1000 : Record 1518;
    BEGIN
      MyNotifications.InsertDefault(GetModifyBillToCustomerAddressNotificationId,
        ModifyBillToCustomerAddressNotificationNameTxt,ModifyBillToCustomerAddressNotificationDescriptionTxt,TRUE);
    END;

    [External]
    PROCEDURE DontNotifyCurrentUserAgain@141(NotificationID@1001 : GUID);
    VAR
      MyNotifications@1000 : Record 1518;
    BEGIN
      IF NOT MyNotifications.Disable(NotificationID) THEN
        CASE NotificationID OF
          GetModifyCustomerAddressNotificationId:
            MyNotifications.InsertDefault(NotificationID,ModifySellToCustomerAddressNotificationNameTxt,
              ModifySellToCustomerAddressNotificationDescriptionTxt,FALSE);
          GetModifyBillToCustomerAddressNotificationId:
            MyNotifications.InsertDefault(NotificationID,ModifyBillToCustomerAddressNotificationNameTxt,
              ModifyBillToCustomerAddressNotificationDescriptionTxt,FALSE);
        END;
    END;

    [External]
    PROCEDURE HasDifferentSellToAddress@195(Customer@1000 : Record 18) : Boolean;
    BEGIN
      EXIT(("Sell-to Address" <> Customer.Address) OR
        ("Sell-to Address 2" <> Customer."Address 2") OR
        ("Sell-to City" <> Customer.City) OR
        ("Sell-to Country/Region Code" <> Customer."Country/Region Code") OR
        ("Sell-to County" <> Customer.County) OR
        ("Sell-to Post Code" <> Customer."Post Code") OR
        ("Sell-to Contact" <> Customer.Contact));
    END;

    [External]
    PROCEDURE HasDifferentBillToAddress@192(Customer@1000 : Record 18) : Boolean;
    BEGIN
      EXIT(("Bill-to Address" <> Customer.Address) OR
        ("Bill-to Address 2" <> Customer."Address 2") OR
        ("Bill-to City" <> Customer.City) OR
        ("Bill-to Country/Region Code" <> Customer."Country/Region Code") OR
        ("Bill-to County" <> Customer.County) OR
        ("Bill-to Post Code" <> Customer."Post Code") OR
        ("Bill-to Contact" <> Customer.Contact));
    END;

    [External]
    PROCEDURE HasDifferentShipToAddress@1059(Customer@1000 : Record 18) : Boolean;
    BEGIN
      EXIT(("Ship-to Address" <> Customer.Address) OR
        ("Ship-to Address 2" <> Customer."Address 2") OR
        ("Ship-to City" <> Customer.City) OR
        ("Ship-to Country/Region Code" <> Customer."Country/Region Code") OR
        ("Ship-to County" <> Customer.County) OR
        ("Ship-to Post Code" <> Customer."Post Code") OR
        ("Ship-to Contact" <> Customer.Contact));
    END;

    [External]
    PROCEDURE ShowInteractionLogEntries@131();
    VAR
      InteractionLogEntry@1000 : Record 11072027;
    BEGIN
      IF "Bill-to Contact No." <> '' THEN
        InteractionLogEntry.SETRANGE("Contact No.","Bill-to Contact No.");
      CASE "Document Type" OF
        "Document Type"::Order:
          InteractionLogEntry.SETRANGE("Document Type",InteractionLogEntry."Document Type"::"Sales Ord. Cnfrmn.");
        "Document Type"::Quote:
          InteractionLogEntry.SETRANGE("Document Type",InteractionLogEntry."Document Type"::"Sales Qte.");
      END;

      InteractionLogEntry.SETRANGE("Document No.","No.");
      PAGE.RUN(PAGE::"Interaction Log Entries",InteractionLogEntry);
    END;

    [External]
    PROCEDURE GetBillToNo@132() : Code[20];
    BEGIN
      IF ("Document Type" = "Document Type"::Quote) AND
         ("Bill-to Customer No." = '') AND ("Bill-to Contact No." <> '') AND
         ("Bill-to Customer Template Code" <> '')
      THEN
        EXIT("Bill-to Contact No.");
      EXIT("Bill-to Customer No.");
    END;

    [External]
    PROCEDURE GetCurrencySymbol@146() : Text[10];
    VAR
      GeneralLedgerSetup@1000 : Record 98;
      Currency@1001 : Record 4;
    BEGIN
      IF GeneralLedgerSetup.GET THEN
        IF ("Currency Code" = '') OR ("Currency Code" = GeneralLedgerSetup."LCY Code") THEN
          EXIT(GeneralLedgerSetup.GetCurrencySymbol);

      IF Currency.GET("Currency Code") THEN
        EXIT(Currency.GetCurrencySymbol);

      EXIT("Currency Code");
    END;

    LOCAL PROCEDURE SetSalespersonCode@433(SalesPersonCodeToCheck@1000 : Code[20];VAR SalesPersonCodeToAssign@1001 : Code[20]);
    BEGIN
      IF SalesPersonCodeToCheck <> '' THEN BEGIN
        IF Salesperson.GET(SalesPersonCodeToCheck) THEN
          IF Salesperson.VerifySalesPersonPurchaserPrivacyBlocked(Salesperson) THEN
            SalesPersonCodeToAssign := ''
          ELSE
            SalesPersonCodeToAssign := SalesPersonCodeToCheck;
      END ELSE
        SalesPersonCodeToAssign := '';
    END;

    [External]
    PROCEDURE ValidateSalesPersonOnSalesHeader@218(SalesHeader2@1000 : Record 36;IsTransaction@1001 : Boolean;IsPostAction@1002 : Boolean);
    BEGIN
      IF SalesHeader2."Salesperson Code" <> '' THEN
        IF Salesperson.GET(SalesHeader2."Salesperson Code") THEN
          IF Salesperson.VerifySalesPersonPurchaserPrivacyBlocked(Salesperson) THEN BEGIN
            IF IsTransaction THEN
              ERROR(Salesperson.GetPrivacyBlockedTransactionText(Salesperson,IsPostAction,TRUE));
            IF NOT IsTransaction THEN
              ERROR(Salesperson.GetPrivacyBlockedGenericText(Salesperson,TRUE));
          END;
    END;

    LOCAL PROCEDURE RevertCurrencyCodeAndPostingDate@167();
    BEGIN
      "Currency Code" := xRec."Currency Code";
      "Posting Date" := xRec."Posting Date";
    END;

    LOCAL PROCEDURE ShouldLookForCustomerByName@181(CustomerNo@1000 : Code[20]) : Boolean;
    VAR
      Customer@1001 : Record 18;
    BEGIN
      IF CustomerNo = '' THEN
        EXIT(TRUE);

      IF NOT Customer.GET(CustomerNo) THEN
        EXIT(TRUE);

      EXIT(NOT Customer."Disable Search by Name");
    END;

    LOCAL PROCEDURE CalcQuoteValidUntilDate@172();
    VAR
      BlankDateFormula@1000 : DateFormula;
    BEGIN
      GetSalesSetup;
      IF SalesSetup."Quote Validity Calculation" <> BlankDateFormula THEN
        "Quote Valid Until Date" := CALCDATE(SalesSetup."Quote Validity Calculation","Document Date");
    END;

    [External]
    PROCEDURE TestQuantityShippedField@190(SalesLine@1000 : Record 37);
    BEGIN
      SalesLine.TESTFIELD("Quantity Shipped",0);
      OnAfterTestQuantityShippedField(SalesLine);
    END;

    [External]
    PROCEDURE TestStatusOpen@134();
    BEGIN
      OnBeforeTestStatusOpen(Rec);

      IF StatusCheckSuspended THEN
        EXIT;

      TESTFIELD(Status,Status::Open);

      OnAfterTestStatusOpen(Rec);
    END;

    [External]
    PROCEDURE SuspendStatusCheck@133(Suspend@1000 : Boolean);
    BEGIN
      StatusCheckSuspended := Suspend;
    END;

    [External]
    PROCEDURE CheckForBlockedLines@220();
    VAR
      CurrentSalesLine@1000 : Record 37;
      Item@1001 : Record 27;
      Resource@1002 : Record 156;
    BEGIN
      CurrentSalesLine.SETCURRENTKEY("Document Type","Document No.",Type);
      CurrentSalesLine.SETRANGE("Document Type","Document Type");
      CurrentSalesLine.SETRANGE("Document No.","No.");
      CurrentSalesLine.SETFILTER(Type,'%1|%2',CurrentSalesLine.Type::Item,CurrentSalesLine.Type::Resource);
      CurrentSalesLine.SETFILTER("No.",'<>''''');

      IF CurrentSalesLine.FINDSET THEN
        REPEAT
          CASE CurrentSalesLine.Type OF
            CurrentSalesLine.Type::Item:
              BEGIN
                Item.GET(CurrentSalesLine."No.");
                Item.TESTFIELD(Blocked,FALSE);
              END;
            CurrentSalesLine.Type::Resource:
              BEGIN
                Resource.GET(CurrentSalesLine."No.");
                Resource.CheckResourcePrivacyBlocked(FALSE);
                Resource.TESTFIELD(Blocked,FALSE);
              END;
          END;
        UNTIL CurrentSalesLine.NEXT = 0;
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterInitRecord@21(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterInitNoSeries@35(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCheckCreditLimitCondition@290(VAR SalesHeader@1000 : Record 36;VAR RunCheck@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCheckCreditMaxBeforeInsert@237(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCheckBillToCust@321(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36;Customer@1002 : Record 18);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCheckSellToCust@319(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36;Customer@1002 : Record 18);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCheckShippingAdvice@330(VAR SalesHeader@1000 : Record 36;VAR Result@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterConfirmSalesPrice@183(VAR SalesHeader@1000 : Record 36;VAR SalesLine@1001 : Record 37;VAR RecalculateLines@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterRecreateSalesLine@152(VAR SalesLine@1000 : Record 37;VAR TempSalesLine@1001 : TEMPORARY Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterDeleteAllTempSalesLines@155();
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterInitFromSalesHeader@246(VAR SalesHeader@1000 : Record 36;SourceSalesHeader@1001 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterInsertTempSalesLine@158(SalesLine@1000 : Record 37;VAR TempSalesLine@1001 : TEMPORARY Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterIsApprovedForPosting@219(SalesHeader@1000 : Record 36;VAR Approved@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterIsApprovedForPostingBatch@221(SalesHeader@1000 : Record 36;VAR Approved@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetNoSeriesCode@166(VAR SalesHeader@1000 : Record 36;SalesReceivablesSetup@1001 : Record 311;VAR NoSeriesCode@1002 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetPostingNoSeriesCode@175(SalesHeader@1000 : Record 36;VAR PostingNos@1001 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetPrepaymentPostingNoSeriesCode@178(SalesHeader@1000 : Record 36;VAR PostingNos@1001 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetSalesSetup@249(SalesHeader@1000 : Record 36;VAR SalesReceivablesSetup@1001 : Record 311;CalledByFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTestNoSeries@136(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateShipToAddress@137(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36;CurrentFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateCurrencyFactor@180(VAR SalesHeader@1000 : Record 36;HideValidationDialog@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAppliesToDocNoOnLookup@163(VAR SalesHeader@1000 : Record 36;CustLedgerEntry@1001 : Record 21);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnUpdateSalesLineByChangedFieldName@139(SalesHeader@1000 : Record 36;VAR SalesLine@1001 : Record 37;ChangedFieldName@1002 : Text[100];ChangedFieldNo@1003 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCreateDimTableIDs@138(VAR SalesHeader@1000 : Record 36;CallingFieldNo@1001 : Integer;VAR TableID@1003 : ARRAY [10] OF Integer;VAR No@1002 : ARRAY [10] OF Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterValidateShortcutDimCode@176(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36;FieldNumber@1003 : Integer;VAR ShortcutDimCode@1002 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCreateSalesLine@147(VAR SalesLine@1000 : Record 37;VAR TempSalesLine@1001 : TEMPORARY Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterIsShipToAddressEqualToSellToAddress@230(SellToSalesHeader@1000 : Record 36;ShipToSalesHeader@1001 : Record 36;VAR Result@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSalesQuoteAccepted@143(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterChangePricesIncludingVAT@187(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSendSalesHeader@144(VAR SalesHeader@1000 : Record 36;ShowDialog@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSetApplyToFilters@227(VAR CustLedgerEntry@1000 : Record 21;SalesHeader@1001 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterSetFieldsBilltoCustomer@151(VAR SalesHeader@1000 : Record 36;Customer@1001 : Record 18);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTransferExtendedTextForSalesLineRecreation@145(VAR SalesLine@1000 : Record 37;VAR TempSalesLine@1001 : TEMPORARY Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyFromSellToCustTemplate@184(VAR SalesHeader@1000 : Record 36;SellToCustTemplate@1001 : Record 5105);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopySellToAddressToShipToAddress@198(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopySellToAddressToBillToAddress@200(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopySellToCustomerAddressFieldsFromCustomer@177(VAR SalesHeader@1000 : Record 36;SellToCustomer@1001 : Record 18;CurrentFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyShipToCustomerAddressFieldsFromCustomer@173(VAR SalesHeader@1000 : Record 36;SellToCustomer@1001 : Record 18);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyShipToCustomerAddressFieldsFromShipToAddr@174(VAR SalesHeader@1000 : Record 36;ShipToAddress@1001 : Record 222);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckCreditLimit@196(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckCreditMaxBeforeInsert@235(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckCreditLimitIfLineNotInsertedYet@238(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeConfirmBillToContactNoChange@229(VAR SalesHeader@1000 : Record 36;VAR xSalesHeader@1001 : Record 36;CurrentFieldNo@1002 : Integer;VAR Confirmed@1003 : Boolean;VAR IsHandled@1004 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeConfirmUpdateCurrencyFactor@241(VAR SalesHeader@1000 : Record 36;VAR HideValidationDialog@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCopyShipToCustomerAddressFieldsFromCustomer@231(VAR SalesHeader@1000 : Record 36;Customer@1001 : Record 18;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCopyShipToCustomerAddressFieldsFromShipToAddr@260(VAR SalesHeader@1000 : Record 36;ShipToAddress@1001 : Record 222;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCreateSalesLine@244(VAR TempSalesLine@1000 : TEMPORARY Record 37;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeGetNoSeriesCode@309(VAR SalesHeader@1000 : Record 36;SalesSetup@1001 : Record 311;VAR NoSeriesCode@1002 : Code[20];VAR IsHandled@1003 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeGetPostingNoSeriesCode@212(VAR SalesHeader@1003 : Record 36;SalesSetup@1002 : Record 311;VAR NoSeriesCode@1001 : Code[20];VAR IsHandled@1000 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeInitInsert@208(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeInitRecord@210(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeIsCreditDocType@226(SalesHeader@1000 : Record 36;VAR CreditDocType@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeUpdateCurrencyFactor@153(VAR SalesHeader@1000 : Record 36;VAR Updated@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforePriceMessageIfSalesLinesExist@243(SalesHeader@1000 : Record 36;ChangedFieldCaption@1001 : Text;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeRecreateSalesLines@197(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeSalesLineByChangedFieldNo@168(VAR SalesHeader@1000 : Record 36;VAR SalesLine@1001 : Record 37;ChangedFieldNo@1003 : Integer;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeSalesLineInsert@169(VAR SalesLine@1000 : Record 37;VAR TempSalesLine@1001 : TEMPORARY Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeTestNoSeries@213(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeSetSecurityFilterOnRespCenter@207(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeUpdateAllLineDim@236(VAR SalesHeader@1000 : Record 36;NewParentDimSetID@1002 : Integer;OldParentDimSetID@1001 : Integer;VAR IsHandled@1003 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeUpdateLocationCode@228(VAR SalesHeader@1000 : Record 36;LocationCode@1002 : Code[10];VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeUpdateSalesLinesByFieldNo@303(VAR SalesHeader@1000 : Record 36;ChangedFieldNo@1001 : Integer;VAR AskQuestion@1002 : Boolean;VAR IsHandled@1003 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeUpdateShipToAddress@254(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnCheckItemAvailabilityInLinesOnAfterSetFilters@242(VAR SalesLine@1000 : Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnCopySelltoCustomerAddressFieldsFromCustomerOnAfterAssignRespCenter@182(VAR SalesHeader@1000 : Record 36;Customer@1001 : Record 18;CallingFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnCreateDimOnBeforeUpdateLines@222(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36;CurrentFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnCreateSalesLineOnAfterAssignType@185(VAR SalesLine@1000 : Record 37;VAR TempSalesLine@1001 : TEMPORARY Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnInitFromContactOnBeforeInitRecord@245(VAR SalesHeader@1000 : Record 36;VAR xSalesHeader@1001 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnInitFromTemplateOnBeforeInitRecord@250(VAR SalesHeader@1000 : Record 36;VAR xSalesHeader@1001 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnInitInsertOnBeforeInitRecord@179(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnUpdateBillToCustOnAfterSalesQuote@188(VAR SalesHeader@1000 : Record 36;Contact@1001 : Record 5050);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateBilltoCustomerTemplateCodeBeforeRecreateSalesLines@171(VAR SalesHeader@1000 : Record 36;CallingFieldNo@1001 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateSellToCustomerNoAfterInit@206(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterTestQuantityShippedField@189(SalesLine@1000 : Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeTestSalesLineFieldsBeforeRecreate@217(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean;VAR SalesLine@1002 : Record 37);
    BEGIN
    END;

    [Integration(TRUE)]
    LOCAL PROCEDURE OnBeforeTestStatusOpen@202(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration(TRUE)]
    LOCAL PROCEDURE OnAfterTestStatusOpen@201(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateBillToCont@199(VAR SalesHeader@1000 : Record 36;Customer@1001 : Record 18;Contact@1002 : Record 5050);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateSellToCont@203(VAR SalesHeader@1000 : Record 36;Customer@1001 : Record 18;Contact@1002 : Record 5050);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateSellToCust@204(VAR SalesHeader@1000 : Record 36;Contact@1001 : Record 5050);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateSalesLines@205(VAR SalesHeader@1000 : Record 36);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnRecreateSalesLinesOnAfterSetSalesLineFilters@239(VAR SalesLine@1000 : Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnRecreateSalesLinesOnBeforeConfirm@211(VAR SalesHeader@1000 : Record 36;xSalesHeader@1001 : Record 36;ChangedFieldName@1002 : Text[100];HideValidationDialog@1003 : Boolean;VAR Confirmed@1004 : Boolean;VAR IsHandled@1005 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnUpdateSalesLinesByFieldNoOnBeforeSalesLineModify@240(VAR SalesLine@1000 : Record 37;ChangedFieldNo@1001 : Integer;CurrentFieldNo@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidatePaymentTermsCodeOnBeforeCalcDueDate@224(VAR SalesHeader@1000 : Record 36;VAR xSalesHeader@1001 : Record 36;CalledByFieldNo@1002 : Integer;CallingFieldNo@1003 : Integer;VAR IsHandled@1004 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidatePaymentTermsCodeOnBeforeCalcPmtDiscDate@225(VAR SalesHeader@1000 : Record 36;VAR xSalesHeader@1001 : Record 36;CalledByFieldNo@1002 : Integer;CallingFieldNo@1003 : Integer;VAR IsHandled@1004 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidatePostingDateOnBeforeAssignDocumentDate@234(VAR SalesHeader@1000 : Record 36;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidatePricesIncludingVATOnBeforeSalesLineModify@214(VAR SalesHeader@1000 : Record 36;VAR SalesLine@1001 : Record 37;Currency@1002 : Record 4;RecalculatePrice@1003 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateShippingAgentCodeOnBeforeUpdateLines@215(VAR SalesHeader@1000 : Record 36;CallingFieldNo@1001 : Integer;HideValidationDialog@1002 : Boolean);
    BEGIN
    END;

    PROCEDURE CheckInvoiceAddress@1210190002();
    VAR
      AdrsRec@1210190000 : Record 222;
    BEGIN
      //**4PS
      IF "Alternative Bill-to Address" <> '' THEN BEGIN
        AdrsRec.GET("Bill-to Customer No.", "Alternative Bill-to Address");
        "Bill-to Name" := AdrsRec.Name;
        "Bill-to Name 2" := AdrsRec."Name 2";
        "Bill-to Address" := AdrsRec.Address;
        "Bill-to Address 2" := AdrsRec."Address 2";
        "Bill-to City" := AdrsRec.City;
        "Bill-to Post Code" := AdrsRec."Post Code";
        "Bill-to County" := AdrsRec.County;
        "Bill-to Country/Region Code" := AdrsRec."Country/Region Code";
        "Bill-to Contact" := AdrsRec.Contact;
      END ELSE BEGIN
        TESTFIELD("Bill-to Customer No.");
        Cust.GET("Bill-to Customer No.");
        "Bill-to Name" := Cust.Name;
        "Bill-to Name 2" := Cust."Name 2";
        "Bill-to Address" := Cust.Address;
        "Bill-to Address 2" := Cust."Address 2";
        "Bill-to City" := Cust.City;
        "Bill-to Post Code" := Cust."Post Code";
        "Bill-to County" := Cust.County;
        "Bill-to Country/Region Code" := Cust."Country/Region Code";
        "Bill-to Contact" := Cust.Contact;
      END;
    END;

    PROCEDURE FillWKAPercentages@1100485000();
    VAR
      lProjPrincipalRec@1100485000 : Record 11012005;
      lProjRec@1100485001 : Record 11072003;
    BEGIN
      //**4PS
      IF NOT ("Document Type" IN ["Document Type"::Invoice, "Document Type"::"Credit Memo"]) THEN
        EXIT;

      IF (CurrFieldNo = 0) OR "Specific WKA Percentages" THEN
        EXIT;

      "% Labor" := 0;
      "% to B Account" := 0;
      IF ("Sell-to Customer No." = '') OR ("Job No." = '') THEN
        EXIT;

      lProjRec.GET("Job No.");
      IF lProjRec."Contract Type" <> lProjRec."Contract Type"::Subcontracting THEN
        EXIT;

      "% Labor" := lProjRec."% Labor";
      "% to B Account" := lProjRec."% to B Account";
      "Calculate B Amounts based on" := lProjRec."Calculate B Amounts based on";

      IF NOT lProjPrincipalRec.GET("Job No.", "Sell-to Customer No.") THEN
        EXIT;

      IF lProjPrincipalRec."Specific WKA Percentages" THEN BEGIN
        "% Labor" := lProjPrincipalRec."% Labor";
        "% to B Account" := lProjPrincipalRec."% to B Account";
      END;
    END;

    PROCEDURE DetermineRemovalContribution@1100485002();
    VAR
      lvSalesLineRec@1100485003 : Record 37;
      lvSalesLineRec2@1100485002 : Record 37;
      lvItemRec@1100485001 : Record 27;
      lvTradeItemRec@1100485000 : Record 11012317;
      lvCostObject@1100485004 : Code[20];
      lvRemovalContribution@1100485005 : Decimal;
      lvServSetup@1100485007 : Record 11012800;
      lvProjCustRec@1100485006 : Record 11012005;
      lvDimValRec@1100485009 : Record 349;
      lvPostingSetup@1100485008 : Record 252;
      lvSalesReceivablesSetup@1100525000 : Record 311;
    BEGIN
      //**4PS
      lvSalesLineRec.SETRANGE("Document Type", "Document Type");
      lvSalesLineRec.SETRANGE("Document No.", "No.");
      lvSalesLineRec.SETRANGE("Removal Contribution", TRUE);
      lvSalesLineRec.SETRANGE("Quantity Shipped", 0);  //skip processed lines after re-open order
      lvSalesLineRec.SETRANGE("Cost Plus Line No.", 0);
      lvSalesLineRec.DELETEALL(TRUE);

      lvSalesReceivablesSetup.GET;
      IF NOT lvSalesReceivablesSetup."Charge Removal Contribution" THEN
        EXIT;

      lvSalesLineRec.SETRANGE("Removal Contribution", FALSE);
      lvSalesLineRec.SETRANGE("Cost Plus Line No.");
      IF lvSalesLineRec.FINDSET(FALSE, FALSE) THEN BEGIN
        REPEAT
          lvCostObject := '';
          lvRemovalContribution := 0;

          IF lvSalesLineRec."Trade Item" <> '' THEN BEGIN
            lvTradeItemRec.GET(lvSalesLineRec."Vendor (Trade Item)", lvSalesLineRec."Trade Item");
            lvCostObject := lvTradeItemRec."Cost Object (Removal)";
            lvRemovalContribution := lvTradeItemRec."Removal Contribution";
            IF lvRemovalContribution <> 0 THEN
              lvTradeItemRec.TESTFIELD("Cost Object (Removal)");
          END ELSE BEGIN
            IF lvSalesLineRec."Item No." <> '' THEN BEGIN
              lvItemRec.GET(lvSalesLineRec."Item No.");
              lvCostObject := lvItemRec."Cost Object (Removal)";
              lvRemovalContribution := lvItemRec."Removal Contribution";
              IF lvRemovalContribution <> 0 THEN
                lvItemRec.TESTFIELD("Cost Object (Removal)");
            END;
          END;

          IF lvRemovalContribution <> 0 THEN BEGIN
            lvSalesLineRec2.SETRANGE("Document Type", "Document Type");
            lvSalesLineRec2.SETRANGE("Document No.", "No.");
            lvSalesLineRec2.SETRANGE("Removal Contribution", TRUE);
            lvSalesLineRec2.SETRANGE("Attached to Line No. (RC)", lvSalesLineRec."Line No.");
            IF NOT lvSalesLineRec2.ISEMPTY THEN
              lvRemovalContribution := 0;
          END;

          IF lvRemovalContribution <> 0 THEN BEGIN
            lvSalesLineRec2.RESET;
            lvSalesLineRec2.SuspendUpdateVATAmounts(TRUE);
            lvSalesLineRec2.INIT;
            lvSalesLineRec2."System-Created Entry" := TRUE;
            lvSalesLineRec2."Document Type" := lvSalesLineRec."Document Type";
            lvSalesLineRec2."Document No." := lvSalesLineRec."Document No.";
            lvSalesLineRec2."Line No." := lvSalesLineRec."Line No.";
            REPEAT
              lvSalesLineRec2."Line No." := lvSalesLineRec2."Line No." + 1;
            UNTIL lvSalesLineRec2.INSERT;

            lvSalesLineRec2."Attached to Line No." := lvSalesLineRec."Line No.";  //C057041
            lvSalesLineRec2.Type := lvSalesLineRec2.Type::"G/L Account";
            lvSalesLineRec2."Additional Cost (Service)" := lvSalesLineRec."Additional Cost (Service)";
            lvSalesLineRec2.VALIDATE("Job No.", lvSalesLineRec."Job No.");
            lvSalesLineRec2.VALIDATE(Element, lvSalesLineRec.Element);
            lvSalesLineRec2."Extension Contract" := lvSalesLineRec."Extension Contract";
            lvSalesLineRec2.VALIDATE("Service Order No.", lvSalesLineRec."Service Order No.");
            lvSalesLineRec2.VALIDATE("Service Contract No.", lvSalesLineRec."Service Contract No.");
            lvSalesLineRec2."Service Location No." := lvSalesLineRec."Service Location No.";
            IF lvSalesLineRec."Shortcut Dimension 1 Code" <> '' THEN
              lvSalesLineRec2.VALIDATE("Shortcut Dimension 1 Code", lvSalesLineRec."Shortcut Dimension 1 Code");
            lvSalesLineRec2.VALIDATE("Shortcut Dimension 2 Code", lvCostObject);

            //db.sn, 09-01-07
            IF lvSalesLineRec."Service Order No." <> '' THEN BEGIN
              lvServSetup.GET;
              lvSalesLineRec2.VALIDATE("Shortcut Dimension 2 Code", lvServSetup."Cost Object Revenues");
            END ELSE BEGIN
              IF lvSalesLineRec."Job No." <> '' THEN BEGIN
                IF lvProjCustRec.GET(lvSalesLineRec."Job No.", lvSalesLineRec."Bill-to Customer No.") THEN
                  lvSalesLineRec2.VALIDATE("Shortcut Dimension 2 Code", lvProjCustRec."Cost Object");
              END;
            END;
            IF lvSalesLineRec2."No." = '' THEN BEGIN
              lvPostingSetup.GET(lvSalesLineRec."Gen. Bus. Posting Group", lvSalesLineRec."Gen. Prod. Posting Group");
              lvPostingSetup.TESTFIELD(lvPostingSetup."Sales Account Removal Contr.");
              lvSalesLineRec2.VALIDATE("No.", lvPostingSetup."Sales Account Removal Contr.");
            END;
            DimMgt.GetDimValueRec(2, lvCostObject, lvDimValRec, TRUE, lvSalesLineRec."Job No.");
            lvSalesLineRec2."Cost Object Cost Plus Line" := lvCostObject;
            lvSalesLineRec2."Cost Type Cost Plus Line" := lvDimValRec."Cost Type";
            lvSalesLineRec2.Description := lvDimValRec.Name;
            //db.en, 09-01-07

            lvSalesLineRec2.VALIDATE("Gen. Prod. Posting Group", lvSalesLineRec."Gen. Prod. Posting Group");
            lvSalesLineRec2.VALIDATE("VAT Prod. Posting Group", lvSalesLineRec."VAT Prod. Posting Group");
            lvSalesLineRec2.VALIDATE("VAT Bus. Posting Group", lvSalesLineRec."VAT Bus. Posting Group");
            lvSalesLineRec2.VALIDATE(Quantity, lvSalesLineRec.Quantity * lvSalesLineRec."Qty. per Unit of Measure");
            IF lvSalesLineRec."Document Type" = lvSalesLineRec."Document Type"::Order THEN BEGIN
              lvSalesLineRec2.VALIDATE("Qty. to Ship", lvSalesLineRec."Qty. to Ship" * lvSalesLineRec."Qty. per Unit of Measure");
              lvSalesLineRec2.VALIDATE("Qty. to Invoice", lvSalesLineRec."Qty. to Invoice" * lvSalesLineRec."Qty. per Unit of Measure");
            END;
            lvSalesLineRec2.VALIDATE("Unit Price", lvRemovalContribution);
            lvSalesLineRec2."Commission No." := lvSalesLineRec."Commission No.";
            lvSalesLineRec2."Settl.Sheet No." := lvSalesLineRec."Settl.Sheet No.";
            lvSalesLineRec2."Removal Contribution" := TRUE;
            lvSalesLineRec2."Project Invoice" := lvSalesLineRec."Project Invoice";
            lvSalesLineRec2."Service Invoice" := lvSalesLineRec."Service Invoice";
            lvSalesLineRec2."Attached to Line No. (RC)" := lvSalesLineRec."Line No.";
            lvSalesLineRec2.SuspendUpdateVATAmounts(FALSE);
            lvSalesLineRec2.UpdateAmounts;
            lvSalesLineRec2."Return Reason Code" := lvSalesLineRec."Return Reason Code";
            lvSalesLineRec2.MODIFY(TRUE);
          END;
        UNTIL lvSalesLineRec.NEXT = 0;
      END;
    END;

    PROCEDURE UpdateCountryOfDestination@1100485007();
    BEGIN
      //**4PS
      //VALIDATE("Country of Destination","VAT Country/Region Code");  //*22767.o

      //*22767.n
      IF "Ship-to Country/Region Code" <> '' THEN
        VALIDATE("Country of Destination","Ship-to Country/Region Code")
      ELSE
        VALIDATE("Country of Destination","Sell-to Country/Region Code");
    END;

    PROCEDURE UpdateVATData@1100485001();
    VAR
      Location@1100485000 : Record 14;
      CompanyInfo@1100485001 : Record 79;
    BEGIN
      //**4PS.n
      IF ("Location Code Logistics" <> '') THEN BEGIN
        IF SalesLogisticsSepaRentContract THEN
          Location.CHANGECOMPANY(CompanyLogistics);
        Location.GET("Location Code Logistics");
        "Company VAT Registration No." := Location."VAT Registration No.";
        IF NOT GLSetup."Default Ext. Sales VAT Determ." OR
           ("Invoice From" <> "Invoice From"::Sales)
        THEN
          VALIDATE("Country of Origin", Location."Country/Region Code");
      END ELSE BEGIN
        IF "Location Code" <> '' THEN BEGIN
          Location.GET("Location Code");
          "Company VAT Registration No." := Location."VAT Registration No.";
          IF NOT GLSetup."Default Ext. Sales VAT Determ." OR
             ("Invoice From" <> "Invoice From"::Sales)
          THEN
            VALIDATE("Country of Origin", Location."Country/Region Code");
        END ELSE BEGIN
          CompanyInfo.GET;
          "Company VAT Registration No." := CompanyInfo."VAT Registration No.";
          IF NOT GLSetup."Default Ext. Sales VAT Determ." OR
             ("Invoice From" <> "Invoice From"::Sales)
          THEN
            VALIDATE("Country of Origin", CompanyInfo."Country/Region Code");
        END;
      END;

      UpdateCountryOfDestination;
    END;

    PROCEDURE UpdateVATGroup@1100485003();
    VAR
      CountryOfOrigin@1100485000 : Record 9;
      CountryOfDestination@1100485001 : Record 9;
      Customer@1100485002 : Record 18;
    BEGIN
      //**4PS.n
      IF "Sell-to Customer No." = '' THEN
        EXIT;

      Customer.GET("Sell-to Customer No.");
      VALIDATE("VAT Bus. Posting Group",Customer."VAT Bus. Posting Group");

      IF NOT "Extended VAT Determination" THEN
        EXIT;

      IF "Country of Origin" = '' THEN
        EXIT;

      CountryOfOrigin.GET("Country of Origin");

      CountryOfOrigin.TESTFIELD("VAT Bus. Posting Group");
      CountryOfOrigin.TESTFIELD("VAT Bus. Posting Group EU");
      CountryOfOrigin.TESTFIELD("VAT Bus. Posting Group Imp/Exp");

      IF "Country of Origin" = "Country of Destination" THEN
        VALIDATE("VAT Bus. Posting Group",CountryOfOrigin."VAT Bus. Posting Group")
      ELSE
        IF CountryOfDestination.GET("Country of Destination") AND
           (CountryOfOrigin."Intrastat Code" <> '') AND
           (CountryOfDestination."Intrastat Code" <> '')
        THEN
          VALIDATE("VAT Bus. Posting Group",CountryOfOrigin."VAT Bus. Posting Group EU")
        ELSE
          VALIDATE("VAT Bus. Posting Group",CountryOfOrigin."VAT Bus. Posting Group Imp/Exp");
    END;

    PROCEDURE SalesLogisticsSepaRentContract@1100485006() : Boolean;
    VAR
      PlantMgtCompRec@1100485000 : Record 11020586;
    BEGIN
      //**4PS.n
      //* 'Sales/logistics separated' (Sales rental quotes/-orders) or 'rental contracts'
      IF ("Sales Document Type" = "Sales Document Type"::"Sales Logistics Separated") AND
         ("Document Type" IN ["Document Type"::Quote, "Document Type"::Order])
      THEN BEGIN
        IF CompanyLogistics = '' THEN BEGIN
          PlantMgtCompRec."Plant Company" := PlantMgtCompRec.GetPlantCompanySalesRental(TRUE);
          CompanyLogistics := PlantMgtCompRec."Plant Company";
        END;
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE ValidatePlantLocation@1100485004();
    VAR
      lvPlantLocRec@1100485001 : Record 11012554;
    BEGIN
      //**4PS.n
      TestStatusOpen;
      IF "Plant Location Code" = '' THEN
        EXIT;

      TESTFIELD("Job No.");
      IF NOT SalesLogisticsSepaRentContract() THEN
        FIELDERROR("Plant Location Code");

      lvPlantLocRec.CHANGECOMPANY(CompanyLogistics);
      lvPlantLocRec.GET("Plant Location Code");
      lvPlantLocRec.TESTFIELD(Depot, FALSE);
      IF (CompanyLogistics <> COMPANYNAME) THEN
        lvPlantLocRec.TESTFIELD("Company Name", COMPANYNAME)
      ELSE
        lvPlantLocRec.TESTFIELD("Company Name", '');
      lvPlantLocRec.TESTFIELD("Project No.", "Job No.");
    END;

    PROCEDURE LookupPlantLocation@1100485005();
    VAR
      lvPlantLocRec@1100485001 : Record 11012554;
    BEGIN
      //**4PS.n
      IF NOT SalesLogisticsSepaRentContract() THEN
        EXIT;

      lvPlantLocRec.CHANGECOMPANY(CompanyLogistics);
      lvPlantLocRec.FILTERGROUP(6);
      lvPlantLocRec.SETRANGE(Depot, FALSE);
      IF (CompanyLogistics <> COMPANYNAME) THEN
        lvPlantLocRec.SETRANGE("Company Name", COMPANYNAME)
      ELSE
        lvPlantLocRec.SETRANGE("Company Name", '');
      lvPlantLocRec.FILTERGROUP(0);
      IF "Job No." <> '' THEN
        lvPlantLocRec.SETRANGE("Project No.", "Job No.");
      lvPlantLocRec.Code := "Plant Location Code";
      IF PAGE.RUNMODAL(0, lvPlantLocRec) = ACTION::LookupOK THEN
        VALIDATE("Plant Location Code", lvPlantLocRec.Code);
    END;

    PROCEDURE ValidatePlantDepotLogistics@1100485010();
    VAR
      lvPlantLocRec@1100485001 : Record 11012554;
    BEGIN
      //**4PS.n
      TestStatusOpen;
      IF "Plant Depot Logistics" = '' THEN
        EXIT;

      IF NOT SalesLogisticsSepaRentContract() THEN
        FIELDERROR("Plant Depot Logistics");

      lvPlantLocRec.CHANGECOMPANY(CompanyLogistics);
      lvPlantLocRec.GET("Plant Depot Logistics");
      lvPlantLocRec.TESTFIELD(Depot, TRUE);
    END;

    PROCEDURE LookupPlantDepotLogistics@1100485009();
    VAR
      lvPlantLocRec@1100485001 : Record 11012554;
    BEGIN
      //**4PS.n
      IF NOT SalesLogisticsSepaRentContract() THEN
        EXIT;

      lvPlantLocRec.CHANGECOMPANY(CompanyLogistics);
      lvPlantLocRec.FILTERGROUP(6);
      lvPlantLocRec.SETRANGE(Depot, TRUE);
      lvPlantLocRec.FILTERGROUP(0);
      lvPlantLocRec.Code := "Plant Depot Logistics";
      IF PAGE.RUNMODAL(0, lvPlantLocRec) = ACTION::LookupOK THEN
        VALIDATE("Plant Depot Logistics", lvPlantLocRec.Code);
    END;

    PROCEDURE ValidateLocationCodeLogistics@1100485019();
    VAR
      lvLocRec@1100485001 : Record 14;
    BEGIN
      //**4PS.n
      TestStatusOpen;
      IF "Location Code Logistics" = '' THEN
        EXIT;

      IF NOT SalesLogisticsSepaRentContract() THEN
        FIELDERROR("Location Code Logistics");

      lvLocRec.CHANGECOMPANY(CompanyLogistics);
      lvLocRec.GET("Location Code Logistics");
      lvLocRec.TESTFIELD("Use As In-Transit", FALSE);

      UpdateVATData; //hs
    END;

    PROCEDURE LookupLocationCodeLogistics@1100485018();
    VAR
      lvLocRec@1100485001 : Record 14;
    BEGIN
      //**4PS.n
      IF NOT SalesLogisticsSepaRentContract() THEN
        EXIT;

      lvLocRec.CHANGECOMPANY(CompanyLogistics);
      lvLocRec.FILTERGROUP(6);
      lvLocRec.SETRANGE("Use As In-Transit", FALSE);
      lvLocRec.FILTERGROUP(0);
      lvLocRec.Code := "Location Code Logistics";
      IF PAGE.RUNMODAL(0, lvLocRec) = ACTION::LookupOK THEN
        VALIDATE("Location Code Logistics", lvLocRec.Code);
    END;

    PROCEDURE LookupShipToContactPerson@1210190001();
    VAR
      ContBusinessRelation@1210190032 : Record 5054;
      Cont@1210190033 : Record 5050;
    BEGIN
      //**4PS
      IF ("Sell-to Customer No." <> '') AND (Cont.GET("Sell-to Contact No.")) THEN
        Cont.SETRANGE("Company No.",Cont."Company No.")
      ELSE
        IF "Sell-to Customer No." <> '' THEN BEGIN
          ContBusinessRelation.RESET;
          ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
          ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
          ContBusinessRelation.SETRANGE("No.","Sell-to Customer No.");
          IF ContBusinessRelation.FIND('-') THEN
            Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.");
        END ELSE
          Cont.SETFILTER("Company No.",'<>''''');

      IF "Sell-to Contact No." <> '' THEN
        IF Cont.GET("Sell-to Contact No.") THEN;
      IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
        "Ship-to Contact No." := Cont."No.";
        "Ship-to Phone No." := Cont."Phone No.";
        "Ship-to Contact" := Cont.Name;
        IF "Document Type" = "Document Type"::"Credit Memo" THEN
          VALIDATE("Sell-to Contact No.",Cont."No.");
      END;
    END;

    PROCEDURE ShowSalesOrders@1100485011();
    VAR
      lvSalesHeader@1100485000 : Record 36;
    BEGIN
      //**4PS
      IF NOT (CurrFieldNo IN [FIELDNO("Sell-to Customer No."), FIELDNO("Sell-to Contact No.")]) OR
        ("Sales Document Type" <> "Sales Document Type"::"Sales Logistics Separated")
      THEN
        EXIT;

      lvSalesHeader.SETCURRENTKEY("Document Type","Sell-to Customer No.");
      lvSalesHeader.SETRANGE("Document Type", lvSalesHeader."Document Type"::Order);
      lvSalesHeader.SETRANGE("Sell-to Customer No.", "Sell-to Customer No.");
      lvSalesHeader.SETRANGE("Sales Document Type", lvSalesHeader."Sales Document Type"::"Sales Logistics Separated");
      IF NOT lvSalesHeader.FINDLAST THEN
        EXIT;

      PAGE.RUN(0, lvSalesHeader);
    END;

    PROCEDURE LookupJobNo@1100525000(EditableMode@1100525001 : Boolean);
    VAR
      lProjRec@1100525000 : Record 11072003;
    BEGIN
      //**4PS
      lProjRec.CHANGECOMPANY("Company Name");
      lProjRec."No." := "Job No.";
      IF EditableMode THEN BEGIN
        IF ("Document Type" IN ["Document Type"::Invoice, "Document Type"::"Credit Memo"]) AND
           ("Project Invoice" OR "Plant Invoice" OR "Service Invoice")
        THEN  // Always field not editable in created invoices!
          EditableMode := FALSE;
      END;
      IF (NOT EditableMode) THEN
        PAGE.RUNMODAL(0,lProjRec)
      ELSE BEGIN
        IF PAGE.RUNMODAL(0,lProjRec) = ACTION::LookupOK THEN
          VALIDATE("Job No.",lProjRec."No.")
      END;
    END;

    PROCEDURE LookupServiceOrderNo@1100525003(EditableMode@1100525001 : Boolean);
    VAR
      lServOrderRec@1100525000 : Record 11012823;
    BEGIN
      //**4PS
      lServOrderRec.CHANGECOMPANY("Company Name");
      lServOrderRec."No." := "Service Order No.";
      IF EditableMode THEN BEGIN
        IF ("Document Type" IN ["Document Type"::Invoice, "Document Type"::"Credit Memo"]) AND
           ("Project Invoice" OR "Plant Invoice" OR "Service Invoice")
        THEN  // Always field not editable in created invoices!
          EditableMode := FALSE;
      END;
      IF (NOT EditableMode) THEN
        PAGE.RUNMODAL(0,lServOrderRec)
      ELSE BEGIN
        IF PAGE.RUNMODAL(0,lServOrderRec) = ACTION::LookupOK THEN
          VALIDATE("Service Order No.",lServOrderRec."No.")
      END;
    END;

    PROCEDURE FillDefaultSalesPerson@1100525001();
    VAR
      lCustRec@1100525000 : Record 18;
      lProjRec@1100525001 : Record 11072003;
    BEGIN
      //**4PS
      IF ("Job No." <> '') AND (NOT "Plant Invoice") AND ("Company Name" = '') THEN BEGIN
        IF lProjRec.GET("Job No.") THEN BEGIN
          IF lProjRec."Salesperson Code" <> '' THEN BEGIN
            "Salesperson Code" := lProjRec."Salesperson Code";
            EXIT;
          END;
        END;
      END;
      IF "Bill-to Customer No." <> '' THEN BEGIN
        IF lCustRec.GET("Bill-to Customer No.") THEN BEGIN
          IF lCustRec."Salesperson Code" <> '' THEN
            "Salesperson Code" := lCustRec."Salesperson Code";
          IF lCustRec."Sales Representative Code" <> '' THEN
            "Sales Representative Code" := lCustRec."Sales Representative Code";
        END;
      END;
    END;

    PROCEDURE FillDefaultInvoiceLayoutCode@1100525002();
    VAR
      lCustRec@1100525001 : Record 18;
      lProjRec@1100525000 : Record 11072003;
    BEGIN
      //**4PS
      IF NOT ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo","Document Type"::"Invoice Proposal"]) THEN
        EXIT;
      IF ("Job No." <> '') AND (NOT "Plant Invoice") AND ("Company Name" = '') THEN BEGIN
        IF lProjRec.GET("Job No.") THEN BEGIN
          IF lProjRec."Invoice Layout Code" <> '' THEN BEGIN
            "Invoice Layout Code" := lProjRec."Invoice Layout Code";
            EXIT;
          END;
        END;
      END;
      IF "Bill-to Customer No." <> '' THEN BEGIN
        IF lCustRec.GET("Bill-to Customer No.") THEN
          "Invoice Layout Code" := lCustRec."Invoice Layout Code";
      END;
    END;

    LOCAL PROCEDURE FillDefaultEMailInvoice@1100528700();
    VAR
      Customer@1100528700 : Record 18;
      ShipToAddress@1100528702 : Record 222;
      SalesHeaderExtension@1100528701 : Record 11071868;
    BEGIN
      //**4PS
      IF NOT ("Document Type" IN ["Document Type"::Order, "Document Type"::"Return Order",
                                  "Document Type"::Invoice, "Document Type"::"Credit Memo",
                                  "Document Type"::"Invoice Proposal"])
      THEN
        EXIT;

      IF "Bill-to Customer No." = '' THEN
        EXIT;

      SalesHeaderExtension.GetSalesHeadExtension("Document Type", "No.");

      Customer.GET("Bill-to Customer No.");

      SalesHeaderExtension."E-Mail (Invoices)" := Customer."E-Mail (Invoices)";
      SalesHeaderExtension."Electronic Invoicing" := Customer."Electronic Invoicing";
      SalesHeaderExtension."Combine E-Mail Attachments" := Customer."Combine E-Mail Attachments";
      SalesHeaderExtension."E-Mail (Order Confirmations)" := Customer."E-Mail (Order Confirmations)";
      SalesHeaderExtension."E-Mail (Shipments)" := Customer."E-Mail (Shipments)";

      IF "Alternative Bill-to Address" <> '' THEN
        IF ShipToAddress.GET("Bill-to Customer No.", "Alternative Bill-to Address") THEN
          IF ShipToAddress."E-Mail (Invoices)" <> '' THEN
            SalesHeaderExtension."E-Mail (Invoices)" := ShipToAddress."E-Mail (Invoices)";

      SalesHeaderExtension.UpdateSalesHeadExtension("Document Type", "No.");
    END;

    LOCAL PROCEDURE FillDefaultEMailShipment@1100528701();
    VAR
      Customer@1100528700 : Record 18;
      ShipToAddress@1100528702 : Record 222;
      SalesHeaderExtension@1100528701 : Record 11071868;
    BEGIN
      //**4PS
      IF NOT ("Document Type" IN ["Document Type"::Order]) THEN
        EXIT;

      IF "Sell-to Customer No." = '' THEN
        EXIT;

      SalesHeaderExtension.GetSalesHeadExtension("Document Type", "No.");

      Customer.GET("Sell-to Customer No.");

      SalesHeaderExtension."E-Mail (Shipments)" := Customer."E-Mail (Shipments)";
      SalesHeaderExtension."Shipment per E-Mail" := Customer."Shipment per E-Mail";

      IF "Ship-to Code" <> '' THEN
        IF ShipToAddress.GET("Sell-to Customer No.", "Ship-to Code") THEN
          IF ShipToAddress."E-Mail (Shipments)" <> '' THEN
            SalesHeaderExtension."E-Mail (Shipments)" := ShipToAddress."E-Mail (Shipments)";

      SalesHeaderExtension.UpdateSalesHeadExtension("Document Type", "No.");
    END;

    LOCAL PROCEDURE FillDefaultEMailOrderConfirm@1100528705();
    VAR
      Customer@1100528700 : Record 18;
      ShipToAddress@1100528702 : Record 222;
      SalesHeaderExtension@1100528701 : Record 11071868;
    BEGIN
      //**4PS
      IF NOT ("Document Type" IN ["Document Type"::Order, "Document Type"::Quote]) THEN
        EXIT;

      IF "Sell-to Customer No." = '' THEN
        EXIT;

      SalesHeaderExtension.GetSalesHeadExtension("Document Type", "No.");

      Customer.GET("Sell-to Customer No.");

      SalesHeaderExtension."E-Mail (Order Confirmations)" := Customer."E-Mail (Order Confirmations)";
      SalesHeaderExtension."Order Confirmation per E-Mail" := Customer."Order Confirmation per E-Mail";

      IF "Ship-to Code" <> '' THEN
        IF ShipToAddress.GET("Sell-to Customer No.", "Ship-to Code") THEN
          IF ShipToAddress."E-Mail (Order Confirmations)" <> '' THEN
            SalesHeaderExtension."E-Mail (Order Confirmations)" := ShipToAddress."E-Mail (Order Confirmations)";

      SalesHeaderExtension.UpdateSalesHeadExtension("Document Type", "No.");
    END;

    PROCEDURE DPA_SetDefaultDpmtFromNoSeries@1100000995(xRecRef@1100525002 : RecordRef);
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      xRecRef.SETTABLE(xRec);
      DPA_Management.SetDepartmentCodeNoSeries(
        TABLENAME,
        "Shortcut Dimension 1 Code",
        "No. Series",
        xRec."No. Series" );
    END;

    LOCAL PROCEDURE DPA_OnInsert@1100000991();
    VAR
      Dimension1Code@1100528400 : Code[20];
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      Dimension1Code :=
        DPA_Management.GetNoSeriesDepartmentCode(
          "No. Series",
          xRec."No. Series",
          DATABASE::"Sales Header");
      IF Dimension1Code <> '' THEN
        "Shortcut Dimension 1 Code" := Dimension1Code;

      IF "Shortcut Dimension 1 Code" <> '' THEN BEGIN
        SkipModify := TRUE;
        VALIDATE("Shortcut Dimension 1 Code");
        SkipModify := FALSE;
      END;
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(36) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 36');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Sales Header", "Shortcut Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Shortcut Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Shortcut Dimension 1 Code");
    END;

    PROCEDURE ConvPartOfLinetoNewPartOfLine@1210190003(LineNoIn@1100525000 : Integer;VAR LineNoOut@1100525001 : Integer);
    BEGIN
      //**4PS
      TempDocumentEntry.SETRANGE("Entry No.",LineNoIn);
      IF TempDocumentEntry.FINDFIRST THEN
        LineNoOut := TempDocumentEntry."No. of Records";
    END;

    PROCEDURE InsertOldLineNoAndNewLineNo@1210190000(LineNoOld@1100525000 : Integer;LineNoNew@1100525001 : Integer);
    BEGIN
      //**4PS
      TempDocumentEntry."Entry No." := LineNoOld;
      TempDocumentEntry."No. of Records" := LineNoNew;
      TempDocumentEntry.INSERT;
    END;

    PROCEDURE EditDocuments@1100528702(DocumentType@1100528702 : Option;DocumentTemplateTypeFilter@1210190003 : Text[250];ContactNo@1210190004 : Code[20];ContactPersonNo@1210190005 : Code[20];SendMail@1210190002 : Boolean;Recipient@1100528700 : Text[120]);
    VAR
      SalesLine@1100528701 : Record 37;
      Job@1100528704 : Record 11072003;
      ServiceOrder@1100528706 : Record 11012823;
      ResponsibilityCenter@1100528705 : Record 5714;
      ProjectNo@1100528703 : Code[20];
      DocumentMailing@1210190000 : Codeunit 11012278;
      RecRef@1100525000 : RecordRef;
      DocumentLinkRIDs@1100525001 : ARRAY [5] OF RecordID;
    BEGIN
      //**4PS
      RecRef.GETTABLE(Rec);
      DocumentLinkRIDs[1] := RecRef.RECORDID;

      ProjectNo := "Job No.";
      IF ProjectNo = '' THEN BEGIN
        SalesLine.SETRANGE("Document Type", DocumentType);
        SalesLine.SETRANGE("Document No.", "No.");
        IF SalesLine.FINDSET THEN
          REPEAT
            ProjectNo := SalesLine."Job No.";
          UNTIL (SalesLine.NEXT = 0) OR (ProjectNo <> '');
      END;

      IF ProjectNo <> '' THEN BEGIN
        Job.GET(ProjectNo);
        RecRef.GETTABLE(Job);
        DocumentLinkRIDs[2] := RecRef.RECORDID;
      END ELSE BEGIN
        IF "Service Order No." <> '' THEN BEGIN
          ServiceOrder.GET("Service Order No.");
          RecRef.GETTABLE(ServiceOrder);
          DocumentLinkRIDs[2] := RecRef.RECORDID;
        END;
      END;

      IF ResponsibilityCenter.GET("Responsibility Center") THEN BEGIN
        RecRef.GETTABLE(ResponsibilityCenter);
        DocumentLinkRIDs[3] := RecRef.RECORDID;
      END;

      DocumentMailing.EditDocuments(
        DocumentTemplateTypeFilter, DocumentLinkRIDs,
        "Shortcut Dimension 1 Code", ContactNo, ContactPersonNo, SendMail, Recipient);
    END;

    PROCEDURE SendOrderElectronic@1210190009();
    VAR
      SalesHeader@1210190002 : Record 36;
      DocumentPrint@1100528500 : Codeunit 229;
    BEGIN
      //**4PS.n, RFC dp00113
      SalesHeader.COPY(Rec);
      SalesHeader.SETRECFILTER;
      DocumentPrint.EmailSalesHeader(SalesHeader);
    END;

    PROCEDURE FillDefaultServiceWarrantyCode@1100528500();
    VAR
      Project@1100528500 : Record 11072003;
    BEGIN
      //**4PS
      IF "Job No." <> '' THEN BEGIN
        Project.CHANGECOMPANY("Company Name");
        Project.GET("Job No.");
        IF Project."Service Warranty Code" <> '' THEN BEGIN
          "Service Warranty Code" := Project."Service Warranty Code";
          EXIT;
        END;
      END;

      GetCust("Sell-to Customer No.");
      "Service Warranty Code" := Cust."Service Warranty Code";
    END;

    PROCEDURE CountNoOfShipments@1100528703() : Integer;
    VAR
      SalesShipmentHeader@1100528700 : Record 110;
    BEGIN
      //**4PS
      SalesShipmentHeader.SETCURRENTKEY("Order No.");
      SalesShipmentHeader.SETRANGE("Order No.", "No.");
      EXIT(SalesShipmentHeader.COUNT);
    END;

    PROCEDURE AssitEditPackageTracking@1100528704();
    VAR
      PostedSalesShipments@1100528700 : Page 142;
      SalesShipmentHeader@1100528701 : Record 110;
    BEGIN
      //**4PS
      SalesShipmentHeader.SETCURRENTKEY("Order No.");
      SalesShipmentHeader.SETRANGE("Order No.", "No.");
      PostedSalesShipments.SETTABLEVIEW(SalesShipmentHeader);
      PostedSalesShipments.RUNMODAL;
    END;

    PROCEDURE PostPlantInvoiceProposalViaIC@1100525004() : Boolean;
    BEGIN
      //**4PS
      IF ("Document Type" = "Document Type"::"Invoice Proposal") AND
         ("Plant Invoice") AND
         (("Company Name" <> COMPANYNAME) AND ("Company Name" <> '')) THEN
      BEGIN
        PlantSetup.GET;
        IF PlantSetup.CheckPostInvoiceProposalViaIC("Company Name") THEN
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE UpdatePostingAndDocDateFromSetup@1100525005(NewPostingDate@1100525000 : Date);
    VAR
      PrevCurrencyFactor@1100527300 : Decimal;
    BEGIN
      //**4PS
      SalesSetup.GET;

      IF SalesSetup."Replace Posting Date" OR SalesSetup."Replace Document Date" THEN BEGIN
        IF NewPostingDate = 0D THEN
          NewPostingDate := WORKDATE;

        IF SalesSetup."Replace Posting Date" OR ("Posting Date" = 0D) THEN
          IF NewPostingDate <> "Posting Date" THEN BEGIN
            "Posting Date" := NewPostingDate;
            IF "Currency Code" <> '' THEN BEGIN
              PrevCurrencyFactor := "Currency Factor";
              "Currency Factor" := CurrExchRate.ExchangeRate(1, "Job No.", NewPostingDate, "Currency Code", TRUE);
              IF "Currency Factor" <> PrevCurrencyFactor THEN
                VALIDATE("Currency Factor");
            END;
          END;

        IF SalesSetup."Replace Document Date" OR ("Document Date" = 0D) THEN
          IF "Document Date" <> NewPostingDate THEN
            VALIDATE("Document Date",NewPostingDate);
      END;
    END;

    PROCEDURE UpdatePostingAndDocDateFromInput@1100525013(ReplacePostingDate@1100525002 : Boolean;ReplaceDocumentDate@1100525001 : Boolean;NewPostingDate@1100525000 : Date);
    VAR
      DocumentDate@1100525003 : Date;
    BEGIN
      //**4PS
      DocumentDate := "Document Date";

      IF ReplacePostingDate OR ("Posting Date" = 0D) THEN BEGIN
        "Posting Date" := NewPostingDate;
        VALIDATE("Currency Code");
      END;

      IF ReplaceDocumentDate OR ("Document Date" = 0D) THEN
        VALIDATE("Document Date",NewPostingDate);

      IF ReplacePostingDate AND (NOT (ReplaceDocumentDate OR ("Document Date" = 0D))) THEN
        VALIDATE("Document Date",DocumentDate);
    END;

    PROCEDURE IsGeneratedInvoice@1100525006() : Boolean;
    BEGIN
      //**4PS
      EXIT("Project Invoice" OR "Plant Invoice" OR "Service Invoice" OR ResourceRequestInvoice);
    END;

    PROCEDURE CheckGeneratedInvoice@1100525007();
    BEGIN
      //**4PS
      IF IsGeneratedInvoice THEN
        IF "Document Type" = "Document Type"::Invoice THEN
          ERROR(Text11012005)
        ELSE
          ERROR(Text11012006);
    END;

    PROCEDURE GetSelectionFilter@1100525010(VAR SalesHeader@1100525000 : Record 36) : Code[250];
    VAR
      SelectionFilter@1003 : Code[250];
      RecordCount@1004 : Integer;
    BEGIN
      //**4PS.n
      RecordCount := SalesHeader.COUNT;
      IF RecordCount > 0 THEN BEGIN
        SalesHeader.FINDSET;
        WHILE RecordCount > 0 DO BEGIN
          RecordCount := RecordCount - 1;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          SelectionFilter := SelectionFilter + SalesHeader."No.";
          IF RecordCount > 0 THEN
            SalesHeader.NEXT;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE GetServicePaymentTermsCode@1100529200();
    VAR
      PaymentTermsCode@1100529201 : Code[20];
      Customer@1100529204 : Record 18;
      ServiceContract@1100529200 : Record 11012812;
      ServiceOrder@1100529203 : Record 11012823;
    BEGIN
      //**4PS
      IF Customer.GET("Bill-to Customer No.") THEN
        PaymentTermsCode := Customer."Payment Terms Code";
      IF ServiceContract.GET("Service Contract No.") AND (ServiceContract."Payment Terms Code" <> '') THEN
        PaymentTermsCode := ServiceContract."Payment Terms Code";
      IF ServiceOrder.GET("Service Order No.") AND (ServiceOrder."Payment Terms Code" <> '') THEN
        PaymentTermsCode := ServiceOrder."Payment Terms Code";

      IF "Payment Terms Code" <> PaymentTermsCode THEN
        VALIDATE("Payment Terms Code",PaymentTermsCode);
    END;

    PROCEDURE ReleaseSalesDocuments@1100528400();
    VAR
      ReleaseSalesDocument@1100528400 : Codeunit 414;
    BEGIN
      //**4PS
      IF FINDSET THEN
        REPEAT
          ReleaseSalesDocument.PerformManualRelease(Rec);
        UNTIL NEXT = 0;
    END;

    PROCEDURE GetDirectDebitMandateServiceOrProject@1100528501(ServOrderNo@1100529000 : Code[20];ServContractNo@1100529001 : Code[20];ProjectNo@1100529002 : Code[20];ProjPrincipal@1100409000 : Code[20]);
    VAR
      ServiceOrder@1100529003 : Record 11012823;
      ServiceContract@1100528500 : Record 11012812;
      ProjectPrincipal@1100529004 : Record 11012005;
      SEPADirectDebitMandate@1100525001 : Record 1230;
      NewMandateID@1100525000 : Code[35];
    BEGIN
      //**4PS DP00613 + DP00640 (Also serv.order and project-principal. Only for create invoices)
      IF ServOrderNo <> '' THEN BEGIN
        IF ServiceOrder.GET(ServOrderNo) THEN BEGIN
          IF ServiceOrder."Direct Debit Mandate ID" <> '' THEN
            NewMandateID := ServiceOrder."Direct Debit Mandate ID";
        END;
      END ELSE BEGIN
        IF ServContractNo <> '' THEN BEGIN
          IF ServiceContract.GET(ServContractNo) THEN BEGIN
            IF ServiceContract."Direct Debit Mandate ID" <> '' THEN
              NewMandateID := ServiceContract."Direct Debit Mandate ID";
          END;
        END ELSE BEGIN
          IF (ProjectNo <> '') AND (ProjPrincipal <> '') THEN BEGIN
            IF ProjectPrincipal.GET(ProjectNo, ProjPrincipal) THEN BEGIN
              IF ProjectPrincipal."Direct Debit Mandate ID" <> '' THEN
                NewMandateID := ProjectPrincipal."Direct Debit Mandate ID";
            END;
          END;
        END;
      END;

      IF NewMandateID = '' THEN
        EXIT;

      SEPADirectDebitMandate.GET(NewMandateID);
      VALIDATE("Direct Debit Mandate ID",NewMandateID);
    END;

    PROCEDURE CreateTempClientFolderForPDF@1100528403() TempClientFolderName : Text;
    VAR
      OperatingSystemMgt@1100528401 : Codeunit 11012364;
      FileManagement@1100528400 : Codeunit 419;
    BEGIN
      //**4PS
      TempClientFolderName :=
        STRSUBSTNO('%1\%2', DELCHR(OperatingSystemMgt.ClientEnviron('TEMP'), '>', '\'), CREATEGUID);
      FileManagement.CreateClientFolderRecursively(TempClientFolderName);
    END;

    PROCEDURE DeleteTempClientFolderForPDF@1100528409(TempClientFolderName@1100528402 : Text);
    VAR
      FileManagement@1100528400 : Codeunit 419;
    BEGIN
      //**4PS
      IF FileManagement.ClientDirectoryExists(TempClientFolderName) THEN
        FileManagement.DeleteClientFolder(TempClientFolderName);
    END;

    PROCEDURE SaveInvoiceProposalAsPDF@1100528401(TempClientFolderName@1100528401 : Text;VAR DocumentDescription@1100528402 : Text[50];VAR FullPDFFileName@1100528405 : Text);
    VAR
      TempReportSelections@1100528404 : TEMPORARY Record 77;
      DocumentProperties@1100528408 : Record 11012746;
      SalesHeader@1100528411 : Record 36;
      EMailSetup@1100528400 : Record 11229911;
      DocumentPrint@1100528403 : Codeunit 229;
      DatetimeMgt@1100528409 : Codeunit 11020218;
      MailTemplateManagement@1100528300 : Codeunit 11012622;
      Window@1100528410 : Dialog;
      TempPDFFileName@1100528407 : Text;
    BEGIN
      //**4PS
      TESTFIELD("Document Type", "Document Type"::"Invoice Proposal");
      IF GUIALLOWED THEN
        Window.OPEN(STRSUBSTNO(Text11012007, "Document Type", "No."));
      IF "Plant Invoice" THEN
        DocumentPrint.GetReportSelectionForPrintUsage(1559, '', FALSE, TempReportSelections);
      IF "Service Invoice" THEN
        DocumentPrint.GetReportSelectionForPrintUsage(3017, '', FALSE, TempReportSelections);
      TempReportSelections.FINDFIRST;
      TempReportSelections.CALCFIELDS("Report Caption");
      DocumentDescription := COPYSTR(
        TempReportSelections."Report Caption", 1, MAXSTRLEN(DocumentProperties.Description));
      TempPDFFileName := STRSUBSTNO('%1 (%2)', "No.", DatetimeMgt.GetTimestamp);
      FullPDFFileName := STRSUBSTNO('%1\%2.pdf', TempClientFolderName, TempPDFFileName);
      SalesHeader.COPY(Rec);
      SalesHeader.SETRECFILTER;
      DocumentPrint.SaveAnyRecordReportAsPdfOnClient(SalesHeader, MailTemplateManagement.GetMailTemplateNoFromSalesHeader(SalesHeader),
        SalesHeader."Shortcut Dimension 1 Code", TempReportSelections."Report ID", FullPDFFileName, SalesHeader."No.", SalesHeader.TABLECAPTION);
      IF GUIALLOWED THEN
        Window.CLOSE;
    END;

    PROCEDURE AddProposalPDFToInvoice@1100528402(DocumentDescription@1100528400 : Text[50];FullPDFFileName@1100528401 : Text);
    VAR
      QueuedExternalDocument@1100528402 : Record 11012148;
      DocumentProperties@1100528403 : Record 11012746;
      FileSystemOnPremiseSetup@1100528406 : Record 11125739;
      FileManagement@1100528408 : Codeunit 419;
      RelateToType@1100528404 : 'Document,Purchase Quote,Purchase Order,Try-out Quote,Blanket Order,,,,Service Order,Sales Invoice,Sales Cr.Memo,Posted Sales Invoice,Posted Sales Cr.Memo,Sales Quote,Sales Order';
      ErrorMessage@1100528405 : Text;
      FullDestinationFileName@1100528407 : Text;
    BEGIN
      //**4PS
      TESTFIELD("Document Type", "Document Type"::Invoice);
      IF FileSystemOnPremiseSetup.GET THEN BEGIN
        FullDestinationFileName :=
          FileSystemOnPremiseSetup."Default Ext. Doc. Directory" + FileManagement.GetFileName(FullPDFFileName);
        IF FileManagement.ClientFileExists(FullDestinationFileName) THEN
          FileManagement.DeleteClientFile(FullDestinationFileName);
      END;
      ClearQueueTablesForCurrentUser;
      AddQueuedExternalDocument(QueuedExternalDocument, DocumentDescription, FullPDFFileName);
      AddQueuedDocumentLink;
      DocumentProperties."External Document" := TRUE;
      QueuedExternalDocument.RegisterDocument(
        DocumentProperties, TRUE, RelateToType::"Sales Invoice", "No.", ErrorMessage, DocumentProperties);
      ClearQueueTablesForCurrentUser;
    END;

    LOCAL PROCEDURE ClearQueueTablesForCurrentUser@1100528404();
    VAR
      QueuedExternalDocument@1100528400 : Record 11012148;
      QueuedDocumentLink@1100528401 : Record 11125736;
    BEGIN
      //**4PS
      QueuedExternalDocument.SETRANGE(User, USERID);
      QueuedExternalDocument.DELETEALL(TRUE);
      QueuedDocumentLink.SETRANGE(User, USERID);
      QueuedDocumentLink.DELETEALL(TRUE);
    END;

    LOCAL PROCEDURE AddQueuedExternalDocument@1100528407(VAR QueuedExternalDocument@1100528402 : Record 11012148;DocumentDescription@1100528403 : Text[50];FullPDFFileName@1100528400 : Text);
    VAR
      FileManagement@1100528401 : Codeunit 419;
    BEGIN
      //**4PS
      QueuedExternalDocument.Description := DocumentDescription;
      QueuedExternalDocument."Line No." := 0;
      QueuedExternalDocument.User := USERID;
      QueuedExternalDocument.Folder := FileManagement.GetDirectoryNameWithBackSlash(FullPDFFileName);
      QueuedExternalDocument."File Name" := FileManagement.GetFileName(FullPDFFileName);
      QueuedExternalDocument.Source := QueuedExternalDocument.Source::User;
      QueuedExternalDocument.INSERT(TRUE);
    END;

    LOCAL PROCEDURE AddQueuedDocumentLink@1100528413();
    VAR
      QueuedDocumentLink@1100528400 : Record 11125736;
      RecRef@1100528401 : RecordRef;
      DocumentLinkManagement@1100528402 : Codeunit 11012401;
    BEGIN
      //**4PS
      RecRef.GETTABLE(Rec);
      QueuedDocumentLink.User := USERID;
      QueuedDocumentLink."Seq. No." := 10000;
      QueuedDocumentLink."Table No." := RecRef.RECORDID.TABLENO;
      QueuedDocumentLink."Filter Expression" := DocumentLinkManagement.GetFilterExpression(RecRef.RECORDID);
      QueuedDocumentLink."Record ID" := RecRef.RECORDID;
      QueuedDocumentLink.Source := TRUE;
      QueuedDocumentLink.INSERT;
    END;

    PROCEDURE GetRetentions@10009000();
    VAR
      ProjectPrincipal@1100409000 : Record 11012005;
      ServiceContract@1100409001 : Record 11012812;
    BEGIN
      //**4PS
      IF AdvancePayment THEN
        EXIT;

      IF "Job No." <> '' THEN BEGIN
        IF NOT ProjectPrincipal.GET("Job No.","Sell-to Customer No.") THEN
          EXIT;

        IF (ProjectPrincipal."Retention %" <> 0) OR (ProjectPrincipal."Retention % 2" <> 0) THEN BEGIN
          "Retention %" := ProjectPrincipal."Retention %";
          "Retention % 2" := ProjectPrincipal."Retention % 2";
          "Retention Payment Terms Code" := ProjectPrincipal."Retention Payment Terms Code";
          "Retention Payment Terms Code 2" := ProjectPrincipal."Retention Payment Terms Code 2";
        END;
      END;

      IF "Service Contract No." <> '' THEN BEGIN
        IF NOT ServiceContract.GET("Service Contract No.") THEN
          EXIT;

        IF (ServiceContract."Retention %" <> 0) OR (ServiceContract."Retention % 2" <> 0) THEN BEGIN
          "Retention %" := ServiceContract."Retention %";
          "Retention % 2" := ServiceContract."Retention % 2";
          "Retention Payment Terms Code" := ServiceContract."Retention Payment Terms Code";
          "Retention Payment Terms Code 2" := ServiceContract."Retention Payment Terms Code 2";
        END;
      END;
    END;

    PROCEDURE MessageIfSalesHeaderExtensionIsChangedAndSalesLinesExist@1100528410(ChangedFieldName@1100528400 : Text);
    BEGIN
      //**4PS
      HideValidationDialog := NOT GUIALLOWED;
      MessageIfSalesLinesExist(ChangedFieldName);
    END;

    PROCEDURE GetServiceLocationNo@1100528405() : Code[20];
    VAR
      SalesHeaderExtension@1100528400 : Record 11071868;
    BEGIN
      //**4PS
      IF SalesHeaderExtension.GET("Document Type", "No.") THEN
        EXIT(SalesHeaderExtension."Service Location No.");
    END;

    PROCEDURE PrintInvoiceIncludingAttachments@1100528408();
    VAR
      SalesHeader@1100528400 : Record 36;
      TempReportSelections@1100528401 : TEMPORARY Record 77;
      TempEmailAttachment@1100528404 : TEMPORARY Record 11229294;
      DocumentPrint@1100528403 : Codeunit 229;
      PDFFileManagement@1100528405 : Codeunit 11020228;
    BEGIN
      //**4PS
      IF NOT ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) THEN
        EXIT;

      SalesHeader.COPY(Rec);
      SalesHeader.SETRECFILTER;
      IF "Document Type" = "Document Type"::Invoice THEN
        DocumentPrint.GetReportSelectionForPrintUsage(5000, '', TRUE, TempReportSelections)
      ELSE
        DocumentPrint.GetReportSelectionForPrintUsage(5001, '', TRUE, TempReportSelections);

      TempReportSelections.FINDFIRST;
      REPEAT
        CreatePDF(TempReportSelections."Report ID", TRUE, TempEmailAttachment, SalesHeader);
      UNTIL TempReportSelections.NEXT = 0;
      AddRelatedDocumentsOfInvoice(
        TempEmailAttachment,SalesHeader,TRUE,FALSE);
      PDFFileManagement.MergePDFEmailAttachmentsOnServer(TempEmailAttachment);

      IF TempEmailAttachment.FINDFIRST THEN BEGIN
        TempEmailAttachment."Attachment Name" :=
          STRSUBSTNO('%1 %2.pdf', FORMAT("Document Type"), SalesHeader."No.");
        TempEmailAttachment.DownloadPdfAttachment;
        ERASE(TempEmailAttachment."Attachment Server File Path");
      END;
    END;

    LOCAL PROCEDURE CreatePDF@1100528411(ReportID2@1100528501 : Integer;PDFIsPrinted@1100528401 : Boolean;VAR TempEmailAttachment@1100528505 : TEMPORARY Record 11229294;VAR SalesHeader@1100528500 : Record 36);
    VAR
      GenericReport@1100528506 : Record 11071914;
      MailTemplateManagement@1100528400 : Codeunit 11012622;
      DocumentPrint@1100528508 : Codeunit 229;
      GenericReportID@1100528502 : Integer;
      ReportID@1100528507 : Integer;
    BEGIN
      //**4PS
      IF GenericReport.GetCalledGenericReport(ReportID2, GenericReportID) THEN BEGIN
        ReportID := GenericReportID;
        SalesHeader.FILTERGROUP(20);
        SalesHeader.SETRANGE("Document Type", SalesHeader."Document Type");
        // Filtergroup 20 is only used for determining document type in the generic report.
        // Filtergroup 0 cannot be used for this in NAV 2017 and later, because
        // filters on sales header, sales invoice header and sales cr.memo header are all remembered.
        SalesHeader.FILTERGROUP(0);
      END ELSE
        ReportID := ReportID2;
      DocumentPrint.SaveAnyRecordReportAsPdf(
        SalesHeader, MailTemplateManagement.GetMailTemplateNoFromSalesHeader(SalesHeader),
        SalesHeader."Shortcut Dimension 1 Code",  ReportID, TRUE, PDFIsPrinted, SalesHeader."No.", SalesHeader.TABLECAPTION, TempEmailAttachment);
    END;

    LOCAL PROCEDURE AddRelatedDocumentsOfInvoice@1100528502(VAR TempEmailAttachment@1100528504 : TEMPORARY Record 11229294;SalesHeader@1100528500 : Record 36;ConvertToPDF@1100528505 : Boolean;SendAsEmail@1100528508 : Boolean);
    VAR
      DocumentProperties@1100528501 : Record 11012746;
      ReportSelections@1100528506 : Record 77;
    BEGIN
      //**4PS
      GetRelatedDocumentsOfInvoice(SalesHeader, DocumentProperties, SendAsEmail);
      DocumentProperties.MARKEDONLY(TRUE);
      ReportSelections.AddRelatedDocuments(TempEmailAttachment, DocumentProperties, FALSE, ConvertToPDF);
    END;

    LOCAL PROCEDURE GetRelatedDocumentsOfInvoice@1100528406(SalesHeader@1100528701 : Record 36;VAR DocumentProperties@1100528700 : Record 11012746;SendAsEmail@1100528500 : Boolean);
    VAR
      DocumentRelation@1100528704 : Record 11012407;
    BEGIN
      //**4PS
      IF NOT (SalesHeader."Document Type" IN [SalesHeader."Document Type"::Invoice,SalesHeader."Document Type"::"Credit Memo"]) THEN
        EXIT;

      IF SalesHeader."Document Type" = SalesHeader."Document Type"::Invoice THEN
        DocumentProperties.GetDocumentsFromDocumentRelations(DocumentProperties, DocumentRelation."Document Type"::"Sales Invoice", SalesHeader."No.", SendAsEmail)
      ELSE
        DocumentProperties.GetDocumentsFromDocumentRelations(DocumentProperties, DocumentRelation."Document Type"::"Sales Cr.Memo", SalesHeader."No.", SendAsEmail);
    END;

    PROCEDURE ResourceRequestInvoice@1100529000() : Boolean;
    BEGIN
      //**4PS
      IF "Document Type" IN ["Document Type"::Invoice, "Document Type"::"Credit Memo"] THEN
        EXIT("Collective List No. (Res.Req.)" <> '');
      EXIT(FALSE);
    END;

    PROCEDURE LookupShipToAddr@1100525031();
    VAR
      ShipToAddr@1001 : Record 222;
    BEGIN
      //**4PS
      ShipToAddr.SETRANGE("Customer No.","Sell-to Customer No.");
      PAGE.RUNMODAL(0,ShipToAddr);
    END;

    PROCEDURE LookupContacts@1100525030();
    VAR
      Cont@1002 : Record 5050;
      ContBusRelation@1001 : Record 5054;
    BEGIN
      //**4PS
      IF "Sell-to Customer No." <> '' THEN BEGIN
        IF Cont.GET("Sell-to Contact No.") THEN
          Cont.SETRANGE("Company No.",Cont."Company No.")
        ELSE BEGIN
          ContBusRelation.RESET;
          ContBusRelation.SETCURRENTKEY("Link to Table","No.");
          ContBusRelation.SETRANGE("Link to Table",ContBusRelation."Link to Table"::Customer);
          ContBusRelation.SETRANGE("No.","Sell-to Customer No.");
          IF ContBusRelation.FINDFIRST THEN
            Cont.SETRANGE("Company No.",ContBusRelation."Contact No.")
          ELSE
            Cont.SETRANGE("No.",'');
        END;
        IF Cont.GET("Sell-to Contact No.") THEN ;
      END ELSE
        Cont.SETRANGE("No.",'');
      PAGE.RUNMODAL(0,Cont);
    END;

    PROCEDURE CalcNoOfShipToAddr@1100525008(CustNo@1000 : Code[20]) : Integer;
    BEGIN
      //**4PS
      GetCust(CustNo);
      Cust.CALCFIELDS("No. of Ship-to Addresses");
      EXIT(Cust."No. of Ship-to Addresses");
    END;

    PROCEDURE CalcNoOfContacts@1100525009() : Integer;
    VAR
      Cont@1000 : Record 5050;
      ContBusRelation@1001 : Record 5054;
    BEGIN
      //**4PS
      Cont.SETCURRENTKEY("Company No.");
      IF "Sell-to Customer No." <> '' THEN BEGIN
        IF Cont.GET("Sell-to Contact No.") THEN BEGIN
          Cont.SETRANGE("Company No.",Cont."Company No.");
          EXIT(Cont.COUNT);
        END;
        ContBusRelation.RESET;
        ContBusRelation.SETCURRENTKEY("Link to Table","No.");
        ContBusRelation.SETRANGE("Link to Table",ContBusRelation."Link to Table"::Customer);
        ContBusRelation.SETRANGE("No.","Sell-to Customer No.");
        IF ContBusRelation.FINDFIRST THEN BEGIN
          Cont.SETRANGE("Company No.",ContBusRelation."Contact No.");
          EXIT(Cont.COUNT);
        END;
      END;
      EXIT(0);
    END;

    PROCEDURE UpdateEMailSentByAndOn@1100525011();
    VAR
      SalesHeaderExtension@1100525001 : Record 11071868;
      SalesHeaderExtensionExists@1100525000 : Boolean;
    BEGIN
      //**4PS
      SalesHeaderExtensionExists := SalesHeaderExtension.GET("Document Type", "No.");
      IF NOT SalesHeaderExtensionExists THEN
        SalesHeaderExtension.GetSalesHeadExtension("Document Type", "No.");
      SalesHeaderExtension."E-Mail Order Confirm. Sent by" := USERID;
      SalesHeaderExtension."E-Mail Order Confirm. Sent on" := TODAY;
      IF NOT SalesHeaderExtensionExists THEN
        SalesHeaderExtension.INSERT
      ELSE
        SalesHeaderExtension.MODIFY;
    END;

    PROCEDURE CheckLocationBlocked@1100527000(ILocationCode@1100527000 : Code[10]);
    VAR
      Location@1100527001 : Record 14;
    BEGIN
      //**4PS
      IF Location.GET(ILocationCode) THEN
        Location.TESTFIELD(Blocked,FALSE);
    END;

    PROCEDURE SetAdvancePayment@1100529600(AdvancePaymentNew@1100529600 : Boolean);
    BEGIN
      //**4PS
      AdvancePayment := AdvancePaymentNew;
    END;

    PROCEDURE SetSkipPrintingAttachmentsAfterPostingInvoice@1100528412(SkipPrintingAttachmentsAfterPostingInvoice2@1100528400 : Boolean);
    BEGIN
      //**4PS
      SkipPrintingAttachmentsAfterPostingInvoice := SkipPrintingAttachmentsAfterPostingInvoice2;
    END;

    PROCEDURE GetSkipPrintingAttachmentsAfterPostingInvoice@1100528414() : Boolean;
    BEGIN
      //**4PS
      EXIT(SkipPrintingAttachmentsAfterPostingInvoice);
    END;

    PROCEDURE SetSkipCheckCustomerNoOnServiceOrder@1100528600(SkipCheckCustomerNoOnServiceOrder2@1100528600 : Boolean);
    BEGIN
      //**4PS
      SkipCheckCustomerNoOnServiceOrder := SkipCheckCustomerNoOnServiceOrder2;
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateSellToCustomerNo@1101285000(VAR Rec@1101285000 : Record 36;VAR xRec@1101285001 : Record 36);
    BEGIN
    END;

    [External]
    PROCEDURE ChooseTradename@1100527450();
    VAR
      Customer@1100527450 : Record 18;
      ContactTradename@1100527451 : Record 11229299;
      ContactTradenames@1100527452 : Page 11229488;
    BEGIN
      //**4PS
      IF NOT Customer.GET("Sell-to Customer No.") THEN
        ERROR(Text11012008);
      Customer.GetTradename(ContactTradename);
      ContactTradenames.EDITABLE(FALSE);
      ContactTradenames.SETTABLEVIEW(ContactTradename);
      ContactTradenames.LOOKUPMODE := TRUE;
      IF ContactTradenames.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ContactTradenames.GETRECORD(ContactTradename);
        IF NOT ("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) THEN
          IF "Ship-to Name" = "Sell-to Customer Name" THEN
            "Ship-to Name" := ContactTradename.Tradename;
        "Sell-to Customer Name" := ContactTradename.Tradename;
        IF "Bill-to Customer No." = "Sell-to Customer No." THEN
          "Bill-to Name" := ContactTradename.Tradename;
      END;
    END;

    BEGIN
    {
      4PS01 07-11-2006 JD The field Principal Reference (from table Project Principal) must be filled when the project number changes.
      4PS02 30-01-2008 JD Testcall 2374 Only allowed a Job no. in header of which customer is project-principal.
      4PS03 24-09-2009 PS Status options Pending Approval,Pending Prepayment removed (set empty).
      4PS DP00613, "Direct Debit Mandate ID" is copied from related Sales Order to the Invoice;

      Not allowed to add more fields to this table

      *** 4PSSE.I012 ***
      130711 Added field "ROT"
             Added code under "Job No.".onValidate() to trigger "ROT" if Rot-project
      140121 Correction for making ROT-project

      160121 ITERO.AC IME445 Added Field 11128514 "E-Invoice Layout Code"
      170405 ITERO.DL RFC188 enhance ROT-handling and extend with RUT
      180508 ORANGO.DL RFC217 added corresponding field as tab112
    }
    END.
  }
}

