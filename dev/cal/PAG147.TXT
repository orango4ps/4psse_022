OBJECT Page 147 Posted Purchase Credit Memos
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00,4PSSE;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Posted Purchase Credit Memos;
               NOR=Bokfõrte kjõpskreditnotaer;
               SVE=Bokfîrda inkîpskreditnotor];
    ApplicationArea=#Basic,#Suite;
    SourceTable=Table124;
    SourceTableView=SORTING(Posting Date)
                    ORDER(Descending);
    PageType=List;
    UsageCategory=History;
    CardPageID=Posted Purchase Credit Memo;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Cancel,Navigate,Print/Send,Credit Memo,Approval;
                                NOR=Ny,Prosess,Rapport,Annullere,Naviger,Skriv ut / send,Kreditnota;
                                SVE=Ny,Process,Rapport,Annullera,Navigera,Skriv ut/skicka,Kreditnota];
    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
                 HasFilters@1001 : Boolean;
               BEGIN
                 HasFilters := GETFILTERS <> '';
                 SetSecurityFilterOnRespCenter;
                 IF HasFilters THEN
                   IF FINDFIRST THEN;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
                 IsFoundationEnabled := ApplicationAreaMgmtFacade.IsFoundationEnabled;

                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 DCActive := IsDocumentCaptureActive; //**DC or 4PS.n
               END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           //**4PS.sn
                           SetControlAppearance;
                           //**4PS.en
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 NOR=Kredi&tnota;
                                 SVE=&Kreditnota];
                      Image=CreditMemo }
      { 29      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#Suite;
                      RunObject=Page 401;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category7 }
      { 30      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 66;
                      RunPageLink=Document Type=CONST(Posted Credit Memo),
                                  No.=FIELD(No.);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category7 }
      { 1102601000;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera dimensioner, till exempel omrÜde, projekt eller avdelning, som du kan tilldela fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1100285100;2 ;Action    ;
                      CaptionML=[ENU=Show &Documents;
                                 SVE=Visa &dokument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                                 SourceCodeSetup@1000000001 : Record 242;
                                 PurchInvHeader@1000000000 : Record 122;
                                 PurchCredHeader@1100285300 : Record 124;
                                 DocumentFilter@1000000003 : Record 11012073;
                                 GlobalTempDocumentProperties@1000000002 : TEMPORARY Record 11012746;
                               BEGIN
                                 //RFC136
                                 //160324
                                 SourceCodeSetup.GET;
                                 CASE "Source Code" OF
                                   SourceCodeSetup.Purchases,'':
                                     BEGIN
                                       IF PurchInvHeader.GET("No.") THEN
                                         RecRef.GETTABLE(PurchInvHeader)
                                       ELSE
                                         IF PurchCredHeader.GET("No.") THEN
                                           RecRef.GETTABLE(PurchCredHeader)
                                         ELSE
                                         RecRef.GETTABLE(Rec);
                                     END;
                                   ELSE
                                     RecRef.GETTABLE(Rec);
                                 END;

                                 DocumentFilters.CreateTemporaryFilter(RecRef, DocumentFilter);
                                 COMMIT;

                                 DocumentFilters.ApplyDocumentFilter(DocumentFilter, GlobalTempDocumentProperties);
                                 GlobalTempDocumentProperties.SETRANGE("From Filter Form", FALSE);
                                 CASE GlobalTempDocumentProperties.COUNT OF
                                   0:
                                     CASE RecRef.NUMBER OF
                                      122: BEGIN PurchInvHeader.SETRECFILTER; PurchInvHeader.PrintRecords(TRUE); END;
                                      124: BEGIN PurchCredHeader.SETRECFILTER; PurchCredHeader.PrintRecords(TRUE,FALSE); END;
                                     END;
                                   1:  GlobalTempDocumentProperties.OpenDocument;
                                   ELSE
                                   PAGE.RUNMODAL(0, GlobalTempDocumentProperties);
                                 END;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 5       ;1   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverandõren i kjõpsdokumentet.;
                                 SVE=Visa eller redigera detaljerad information om leverantîren pÜ inkîpsdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Image=Vendor;
                      PromotedCategory=Category5;
                      Scope=Repeater }
      { 21      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut;
                                 SVE=Skriv &ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargjõr for Ü skrive ut dokumentet. Det vises et rapportforespõrselsvindu for dokumentet der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Fîrbered utskrift av dokumentet. Ett rapportfînster om dokumentet îppnas dÑr det gÜr att ange vad du vill inkludera pÜ utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 PurchCrMemoHdr@1102 : Record 124;
                               BEGIN
                                 PurchCrMemoHdr := Rec;
                                 CurrPage.SETSELECTIONFILTER(PurchCrMemoHdr);
                                 OnBeforePrintRecords(PurchCrMemoHdr);
                                 //PurchCrMemoHdr.PrintRecords(TRUE); //**4PS.o
                                 PurchCrMemoHdr.PrintRecords(TRUE,TRUE); //**4PS.n
                               END;
                                }
      { 22      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger;
                                 SVE=Anal&ysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppfõringer og dokumenter som finnes for dokumentnummeret og bokfõringsdatoen i den valgte oppfõringen eller dokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet fîr den valda transaktionen eller det valda dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Annullera] }
      { 14      ;2   ;Action    ;
                      Name=CancelCrMemo;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Annullera];
                      ToolTipML=[ENU=Create and post a purchase invoice that reverses this posted purchase credit memo. This posted purchase credit memo will be canceled.;
                                 NOR=Opprett og bokfõr en kjõpsfaktura som tilbakefõrer denne bokfõrte kjõpskreditnotaen. Denne bokfõrte kjõpskreditnotaen vil bli annullert.;
                                 SVE=Skapa och bokfîr en inkîpsfaktura som Üterfîr den hÑr bokfîrda inkîpskreditnotan. Den hÑr bokfîrda inkîpskreditnotan annulleras.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsFoundationEnabled;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Cancel PstdPurchCrM (Yes/No)",Rec);
                               END;
                                }
      { 16      ;2   ;Action    ;
                      Name=ShowInvoice;
                      CaptionML=[ENU=Show Canceled/Corrective Invoice;
                                 NOR=Vis annullert/korrigerende faktura;
                                 SVE=Visa annullerad/korrigerande faktura];
                      ToolTipML=[ENU=Open the posted sales invoice that was created when you canceled the posted sales credit memo. If the posted sales credit memo is the result of a canceled sales invoice, then canceled invoice will open.;
                                 NOR=èpne den bokfõrte salgsfakturaen som ble opprettet da du kansellerte den bokfõrte salgskreditnotaen. Hvis den bokfõrte salgskreditnotaen er et resultat av den kansellerte salgsfakturaen, sÜ vil den kansellerte fakturaen bli Üpnet.;
                                 SVE=ôppna den bokfîrda fîrsÑljningsfakturan som skapades nÑr du annullerade den bokfîrda fîrsÑljningskreditnotan. Om den bokfîrda fîrsÑljningskreditnotan Ñr resultatet av en annullerad fîrsÑljningsfaktura, îppnas den annullerade fakturan.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsFoundationEnabled;
                      Enabled=Cancelled OR Corrective;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrInvoice;
                               END;
                                }
      { 1100528410;1 ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 SVE=GodkÑnnande] }
      { 1100528409;2 ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 SVE=GodkÑnn];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528408;2 ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 SVE=Avvisa];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528407;2 ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 SVE=Delegera];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528406;2 ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 SVE=Kommentar];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalEntry@1100525001 : Record 454;
                                 ApprovalCommentLine@1100525000 : Record 455;
                               BEGIN
                                 //**4PS
                                 IF OpenApprovalEntriesExist THEN BEGIN
                                   //ApprovalManagement4PSConstr.FilterApprovalEntryOpen(3, "No.", ApprovalEntry, FALSE);//**4PS C049344.o
                                   ApprovalManagement4PSConstr.FilterApprovalEntryOpen(DATABASE::"Purch. Cr. Memo Hdr.", 3, "No.", ApprovalEntry, FALSE);//**4PS C049344.n
                                   ApprovalCommentLine.SETRANGE("Table ID", DATABASE::"Purch. Cr. Memo Hdr.");
                                   ApprovalCommentLine.SETRANGE("Document No.", "No.");
                                   ApprovalCommentLine.SETRANGE("Record ID to Approve", RECORDID);
                                   ApprovalCommentLine."Workflow Step Instance ID" := ApprovalEntry."Workflow Step Instance ID";
                                   ApprovalManagement4PSConstr.DrillDownApprovalCommentsHdr(ApprovalEntry,ApprovalCommentLine);
                                 END;
                               END;
                                }
      { 1100525009;2 ;Action    ;
                      CaptionML=[ENU=&On Hold;
                                 SVE=S&toppad];
                      Promoted=Yes;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=Lock;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsBridge4PSConstruct@1100525000 : Codeunit 11125348;
                               BEGIN
                                 ApprovalsBridge4PSConstruct.OnHold(Rec);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100528405;1 ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 SVE=BegÑr godkÑnnande];
                      Image=Action }
      { 1100528404;2 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalManagement4PSConstr@1100528400 : Codeunit 11125349;
                                 ApprovalsBridge4PSConstruct@1100528401 : Codeunit 11125348;
                               BEGIN
                                 ApprovalManagement4PSConstr.CheckPostedPurchaseCreditMemoApprovalsWorkflowEnabled(Rec);
                                   ApprovalsBridge4PSConstruct.OnSendPostedPurchaseCreditMemoForApproval(Rec);
                               END;
                                }
      { 1100528403;2 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      Image=Cancel;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsBridge4PSConstruct@1100528400 : Codeunit 11125348;
                               BEGIN
                                 ApprovalsBridge4PSConstruct.OnCancelPostedPurchaseCreditMemoApprovalRequest(Rec);
                               END;
                                }
      { 1100525008;1 ;Action    ;
                      CaptionML=ENU=Show Original &E-mail;
                      Visible=DCActive;
                      Enabled=DCActive;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 PurchDocMgnt@1100525000 : Codeunit 6085709;
                               BEGIN
                                 PurchDocMgnt.OpenEmailFile(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#All;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who delivered the items.;
                           NOR=Angir navnet pÜ leverandõren som leverte varene.;
                           SVE=Anger namnet pÜ leverantîren som levererade artiklarna.];
                ApplicationArea=#All;
                SourceExpr="Buy-from Vendor No." }

    { 1100485002;2;Field  ;
                SourceExpr="Vendor Cr. Memo No." }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order address of the related vendor.;
                           NOR=Angir bestillingsadressen for den relaterte leverandõren.;
                           SVE=Anger den relaterade leverantîrens orderadress.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Address Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who delivered the items.;
                           NOR=Angir navnet pÜ leverandõren som leverte varene.;
                           SVE=Anger namnet pÜ leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Vendor Name" }

    { 1100525000;2;Field  ;
                SourceExpr="Buy-from Vendor Name 2";
                Visible=FALSE }

    { 1210190000;2;Field  ;
                SourceExpr="Job No." }

    { 1210190014;2;Field  ;
                SourceExpr="Service Order No.";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code used to calculate the amounts on the credit memo.;
                           NOR=Angir valutakoden som er brukt til Ü beregne belõpene i kreditnotaen.;
                           SVE=Anger valutakoden som anvÑnds fîr att berÑkna beloppen pÜ kreditnotan.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code" }

    { 1100525010;2;Field  ;
                SourceExpr="Open Approval Entry" }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the credit memo is due. The program calculates the date using the Payment Terms Code and Posting Date fields on the purchase header.;
                           NOR=Angir nÜr kreditnotaen forfaller. Programmet beregner datoen ved hjelp av feltet Betalingsbet.kode og Bokfõringsdato i bestillingshodet.;
                           SVE=Anger nÑr kreditnotan fîrfaller. Datumet berÑknas med fÑlten Betalningsvillkorskod och Bokfîringsdatum pÜ inkîpshuvudet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date" }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total, in the currency of the credit memo, of the amounts on all the credit memo lines.;
                           NOR=Angir summen av belõpene pÜ alle kreditnotalinjene i valutaen som er i kreditnotaen.;
                           SVE=Anger summan av alla rader pÜ kreditnotan i kreditnotans valuta.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount;
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              PAGE.RUNMODAL(PAGE::"Posted Purchase Credit Memo",Rec)
                            END;
                             }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total of the amounts, including VAT, on all the lines on the document.;
                           NOR=Angir summen av belõpene, inkludert mva, pÜ alle linjene i dokumentet.;
                           SVE=Anger summan av beloppen, inklusive moms, pÜ fakturaraderna i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Including VAT";
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              PAGE.RUNMODAL(PAGE::"Posted Purchase Credit Memo",Rec)
                            END;
                             }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be paid for the posted purchase invoice that relates to this purchase credit memo.;
                           NOR=Angir belõpet som gjenstÜr Ü bli betalt for den bokfõrte kjõpsfakturaen som er knyttet til denne kjõpskreditnotaen.;
                           SVE=Anger beloppet som ÜterstÜr att betala pÜ den bokfîrda inkîpsfakturan som relaterar till den hÑr inkîpskreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Amount" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice that relates to this purchase credit memo is paid. The check box will also be selected if a credit memo for the remaining amount has been applied.;
                           NOR=Angir om den bokfõrte kjõpsfakturaen, som er knyttet til denne kjõpskreditnotaen, er betalt. Det vil ogsÜ merkes av for hvis en kreditnota for det gjenstÜende belõpet er brukt.;
                           SVE=Anger om den bokfîrda inkîpsfakturan som relaterar till den hÑr inkîpskreditnotan Ñr betald. Kryssrutan markeras Ñven om en kreditnota fîr det ÜterstÜende beloppet har kopplats.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Paid }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice that relates to this purchase credit memo has been either corrected or canceled.;
                           NOR=Angir om den bokfõrte kjõpsfakturaen som er knyttet til denne kjõpskreditnotaen, er blitt korrigert eller kansellert.;
                           SVE=Anger om den bokfîrda inkîpsfakturan som relaterar till den hÑr inkîpskreditnotan har rÑttats eller annullerats.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Editable=FALSE;
                LookupPageID=Posted Sales Invoices;
                DrillDownPageID=Posted Sales Invoices;
                HideValue=NOT Cancelled;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveInvoice;
                            END;
                             }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice has been either corrected or canceled by this purchase credit memo .;
                           NOR=Angir om den bokfõrte kjõpsfakturaen er blitt korrigert eller kansellert av denne kjõpskreditnotaen.;
                           SVE=Anger om den bokfîrda inkîpsfakturan har rÑttats eller annullerats av den hÑr inkîpskreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Editable=FALSE;
                LookupPageID=Posted Sales Invoices;
                DrillDownPageID=Posted Sales Invoices;
                HideValue=NOT Corrective;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledInvoice;
                            END;
                             }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the post code of the vendor who delivered the items.;
                           NOR=Angir postnummeret for leverandõren som leverte varene.;
                           SVE=Anger postnumret fîr leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the city of the vendor who delivered the items.;
                           NOR=Angir poststedet til leverandõren som leverte varene.;
                           SVE=Anger orten fîr leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Country/Region Code";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the contact person at the vendor who delivered the items.;
                           NOR=Angir navnet pÜ kontaktpersonen hos leverandõren som leverte varene.;
                           SVE=Anger namnet pÜ kontaktpersonen hos leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact";
                Visible=FALSE }

    { 127 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor that you received the invoice from.;
                           NOR=Angir nummeret til leverandõren du har mottatt fakturaen fra.;
                           SVE=Anger numret pÜ leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Vendor No.";
                Visible=FALSE }

    { 125 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who you received the invoice from.;
                           NOR=Angir navnet pÜ leverandõren du har mottatt fakturaen fra.;
                           SVE=Anger namnet pÜ leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Visible=FALSE }

    { 1100525002;2;Field  ;
                SourceExpr="Pay-to Name 2";
                Visible=FALSE }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the post code of the vendor that you received the invoice from.;
                           NOR=Angir postnummeret for leverandõren som du har mottatt fakturaen fra.;
                           SVE=Anger postnumret fîr leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omrÜdekoden for adressen.;
                           SVE=Anger adressens lands-/regionkod.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Country/Region Code";
                Visible=FALSE }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you should contact at the vendor who you received the credit memo from.;
                           NOR=Angir navnet pÜ kontaktperson hos leverandõren som du mottok kreditnotaen fra.;
                           SVE=Anger namnet pÜ kontaktpersonen hos leverantîren som du mottog kreditnotan frÜn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Visible=FALSE }

    { 1101200000;2;Field  ;
                SourceExpr="Your Reference";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for an alternate shipment address if you want to ship to another address than the one that has been entered automatically. This field is also used in case of drop shipment.;
                           NOR=Angir en kode for en alternativ leveringsadresse hvis du vil levere til en annen adresse enn den som er angitt automatisk. Dette feltet brukes ogsÜ ved direkte levering.;
                           SVE=Anger en kod fîr en alternativ leveransadress om du vill leverera till en annan adress Ñn den som har angetts automatiskt. Det hÑr fÑltet anvÑnds ocksÜ vid direktutleverans.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the customer at the address that the items are shipped to.;
                           NOR=Angir navnet pÜ kunden pÜ adressen som varene blir levert til.;
                           SVE=Anger namnet pÜ kunden pÜ adressen som artiklarna levereras till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 1100525004;2;Field  ;
                SourceExpr="Ship-to Name 2";
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address that the items are shipped to.;
                           NOR=Angir postnummeret for adressen som varene sendes til.;
                           SVE=Anger postnumret i adressen som artiklarna levereras till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address that the items are shipped to.;
                           NOR=Angir lands-/omrÜdekoden for adressen som varene sendes til.;
                           SVE=Anger lands-/regionkoden i adressen som artiklarna levereras till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the contact person at the address that the items are shipped to.;
                           NOR=Angir navnet pÜ kontaktpersonen pÜ adressen som varene blir sendt til.;
                           SVE=Anger namnet pÜ kontaktpersonen pÜ adressen som artiklarna levereras till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date the credit memo was posted.;
                           NOR=Angir datoen da kreditnotaen ble bokfõrt.;
                           SVE=Anger datumet nÑr kreditnotan bokfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 1102601001;2;Field  ;
                ToolTipML=[ENU=Specifies the date when the related document was created.;
                           NOR=Angir datoen da de relaterte dokumentet ble opprettet.;
                           SVE=Anger datumet nÑr det relaterade dokumentet skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is assigned to the vendor.;
                           NOR=Angir hvilken innkjõper som er knyttet til leverandõren.;
                           SVE=Anger vilken inkîpare som Ñr kopplad till leverantîren.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE;
                LookupPageID=Cost Object List }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location used when you posted the credit memo.;
                           NOR=Angir koden for lokasjonen som er brukt i bokfõringen av kreditnotaen.;
                           SVE=Anger koden fîr lagerstÑllet som anvÑndes nÑr du bokfîrde kreditnotan.];
                ApplicationArea=#Location;
                SourceExpr="Location Code" }

    { 1100525007;2;Field  ;
                SourceExpr="On Hold";
                Visible=FALSE }

    { 1100525006;2;Field  ;
                SourceExpr="Remain On Hold";
                Visible=FALSE }

    { 1100525005;2;Field  ;
                SourceExpr="Approvement Initials" }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the document has been printed.;
                           NOR=Angir hvor mange ganger dokumentet har blitt skrevet ut.;
                           SVE=Anger hur mÜnga gÜnger dokumentet har skrivits ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed" }

    { 1100525001;2;Field  ;
                SourceExpr="DMS Status" }

    { 1102601003;2;Field  ;
                ToolTipML=[ENU=Specifies the type of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir typen bokfõrt dokument som dette dokumentet eller denne kladdelinjen blir utlignet til nÜr du bokfõrer, for eksempel for Ü registrere utbetaling.;
                           SVE=Anger typen fîr det bokfîrda dokument som den hÑr dokument- eller journalraden tillÑmpas pÜ nÑr du bokfîr, t.ex. fîr att registrera en betalning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. Type";
                Visible=FALSE }

    { 1100528402;2;Field  ;
                CaptionML=[ENU=Approval by User;
                           SVE=GodkÑnnande av anvÑndare];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApprover(RECORDID,0) }

    { 1100528401;2;Field  ;
                CaptionML=[ENU=Approval by User Name;
                           SVE=GodkÑnnande av anvÑndarnamn];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApproverName(RECORDID,0) }

    { 1100528411;2;Field  ;
                CaptionML=ENU=Approved by User;
                SourceExpr=ApprovalManagement4PSConstr.GetLastApproverDocument(3,"No.");
                Visible=FALSE }

    { 1100528412;2;Field  ;
                CaptionML=ENU=Approved by User Name;
                SourceExpr=ApprovalManagement4PSConstr.GetLastApproverNameDocument(3,"No.");
                Visible=FALSE }

    { 1100525003;2;Field  ;
                SourceExpr="Pre-Assigned No." }

    { 1100528400;2;Field  ;
                SourceExpr="User ID";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 3   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

    { 1100528500;1;Part   ;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page9104;
                Visible=FALSE;
                PartType=Page }

  }
  CODE
  {
    VAR
      ApplicationAreaMgmtFacade@1001 : Codeunit 9179;
      IsOfficeAddin@1000 : Boolean;
      IsFoundationEnabled@1002 : Boolean;
      DPA_IsHardFilter@1100000999 : Boolean;
      DCActive@1100525000 : Boolean INDATASET;
      OpenApprovalEntriesExist@1100528402 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1100528401 : Boolean;
      ApprovalManagement4PSConstr@1100528400 : Codeunit 11125349;
      CanCancelApprovalForRecord@1100527300 : Boolean;

    [Integration]
    LOCAL PROCEDURE OnBeforePrintRecords@1(VAR PurchCrMemoHdr@1000 : Record 124);
    BEGIN
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1000 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID); //**4PS.n
    END;

    LOCAL PROCEDURE IsDocumentCaptureActive@1100528203() : Boolean;
    VAR
      DocumentCaptureSetup@1100525000 : Record 6085573;
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
    BEGIN
      //**4PS
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DocumentCaptureSetup) THEN
        EXIT(FALSE);
      IF DocumentCaptureSetup.GET THEN;
      EXIT(DocumentCaptureSetup."Document Nos." <> '');
    END;

    BEGIN
    {
      4PS 29-03-18 DP01917 OLKOL: Fields "Open Approval Entry" added
      160909 ITERO.DL RFC136 view attached documents (from Symbrio) if no doc then print report
    }
    END.
  }
}

