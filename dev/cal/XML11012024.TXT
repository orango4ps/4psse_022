OBJECT XMLport 11012024 Import Debrief Message - FSA
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Import Debrief Message - FSA;
    Direction=Import;
    OnPreXMLport=BEGIN
                   MessType := 'DEBRIEF';

                   FSASetupRec.GET('');
                   FSA_FunctionsDllCreated := FALSE;
                 END;

  }
  ELEMENTS
  {
    { [{66BEC9F8-C5AB-422A-B48E-F31762EBB04C}];  ;Message             ;Element ;Text     }

    { [{4D5830E6-413C-4362-921B-F9E4F3786A81}];1 ;MessageID           ;Attribute;Text   ;
                                                  Import::OnAfterAssignVariable=BEGIN
                                                                                  IF (MessageID <> MessID) THEN BEGIN
                                                                                    gLogbookRec.WriteExchangeError(STRSUBSTNO(Text000a,MessageID,MessID),ErrorRec.Type::Error,0);
                                                                                    currXMLport.BREAK;
                                                                                  END;
                                                                                END;
                                                                                 }

    { [{E28E3AD4-B274-4602-B78C-3F503C28670D}];1 ;MessageType         ;Attribute;Text   ;
                                                  Import::OnAfterAssignVariable=BEGIN
                                                                                  IF (MessageType <> MessType) THEN BEGIN
                                                                                    gLogbookRec.WriteExchangeError(STRSUBSTNO(Text000b,MessageType,MessType),ErrorRec.Type::Error,0);
                                                                                    currXMLport.BREAK;
                                                                                  END;
                                                                                END;
                                                                                 }

    { [{7CAD8714-8C2D-4FB1-BCAF-7DE899311CFF}];1 ;ListServiceorders   ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{651AD363-A07E-40A3-8F9F-9A7AD02D9DBA}];2 ;Serviceorder        ;Element ;Table   ;
                                                  VariableName=ServiceOrder;
                                                  SourceTable=Table11012273;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterInitRecord=BEGIN
                                                                              InitImportDataLine(ServiceOrder, ServiceOrder."Line Type"::ServOrder);
                                                                            END;

                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 MakeSignature();
                                                                                 XMLFormatMgtCU.EvaluateDateTime(Order_OrderDateTime,ServiceOrder.Date,ServiceOrder.Times);
                                                                                 IF ServiceOrder.Date = 0D THEN BEGIN
                                                                                   ServiceOrder.Date := TODAY;  //* If data is not delivered than fill here, because if error in data
                                                                                   ServiceOrder.Times := TIME;  //* this can only be processed (much) later.
                                                                                 END;
                                                                               END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                ServiceOrder.INIT;
                                                                                Order_OrderDateTime := '';
                                                                                CLEAR(Order_Signature);
                                                                              END;
                                                                               }

    { [{472DCBAB-CF50-4E65-93DF-F874D1645799}];3 ;Order_ServiceOrderNo;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Service Order No. }

    { [{1E8C71FA-4358-44F6-B79A-38C2DF02810F}];3 ;Order_Problem       ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Problem;
                                                  MinOccurs=Zero }

    { [{77B218CA-52D5-4D08-B788-74069829CB1A}];3 ;Order_Cause         ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Cause;
                                                  MinOccurs=Zero }

    { [{5383DDFD-F6A0-44B0-BD5D-785057685953}];3 ;Order_Solution      ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Solution;
                                                  MinOccurs=Zero }

    { [{FD4C8799-BC49-4D82-A213-5F799555B9C4}];3 ;Order_Discipline    ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Discipline;
                                                  MinOccurs=Zero }

    { [{A9266CA0-C478-45DF-9879-AA1D28475B87}];3 ;Order_YourReference ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Your Reference;
                                                  MinOccurs=Zero }

    { [{87082884-5377-4340-A0FA-8AB1ABD1CB86}];3 ;Order_OrderNoCustomer;Element;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Order No. Customer;
                                                  MinOccurs=Zero }

    { [{3AD2C277-2816-4303-8AD0-783739248CF2}];3 ;Order_Installation  ;Element ;Text    ;
                                                  DataType=Code;
                                                  MinOccurs=Zero }

    { [{099A5926-70A3-40B1-9002-AA48F351CA9A}];3 ;Order_InstallationPart;Element;Text   ;
                                                  DataType=Code;
                                                  MinOccurs=Zero }

    { [{2F82FE17-1BF2-46EF-80DF-AE02E0E83C16}];3 ;Order_ObjectNo      ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Object No.;
                                                  MinOccurs=Zero }

    { [{A1403351-492E-4F91-BCB6-1571ECE288DC}];3 ;Order_SolutionText  ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Comment;
                                                  MinOccurs=Zero }

    { [{B083EA81-5A8D-4F10-93BA-84FF8D1075FF}];3 ;Order_Signature     ;Element ;Text    ;
                                                  TextType=BigText;
                                                  MinOccurs=Zero }

    { [{06D36A17-90E3-44E1-BEC8-DF0844C6843B}];3 ;Order_DecentralCreated;Element;Field  ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Decentral Created Order;
                                                  MinOccurs=Zero }

    { [{B838F31B-2243-4900-8BC4-358E1047E040}];3 ;Order_EmployeeNo    ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Employee No.;
                                                  MinOccurs=Zero }

    { [{775FFFE3-C8FC-4E4D-9A4E-0E3D334D3378}];3 ;Order_CustomerNo    ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Customer No.;
                                                  MinOccurs=Zero }

    { [{38030B8F-EE19-43B0-8B52-37466C8B9619}];3 ;Order_Name          ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Name;
                                                  MinOccurs=Zero }

    { [{09EF50FE-AAAD-4240-9EE7-A09AFF0045FC}];3 ;Order_Address       ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Address;
                                                  MinOccurs=Zero }

    { [{73029F2F-F3ED-442D-A6CF-01C5831B4A64}];3 ;Order_City          ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::City;
                                                  MinOccurs=Zero }

    { [{732A17A9-E249-48FA-B110-638E670B9276}];3 ;Order_PostCode      ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Post Code;
                                                  MinOccurs=Zero }

    { [{5E416248-6369-4D97-8231-6584E730602B}];3 ;Order_PhoneNo       ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Phone No.;
                                                  MinOccurs=Zero }

    { [{CD26E77B-0730-4EC7-889C-DCA4D8C23072}];3 ;Order_E-Mail        ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::E-Mail;
                                                  MinOccurs=Zero }

    { [{F3589557-D29A-4E96-B76C-A42BD54D47EA}];3 ;Order_ContactName   ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Contact Name;
                                                  MinOccurs=Zero }

    { [{650913FB-D71F-482A-9A53-DB4D9C5F9720}];3 ;Order_ServiceLocationCode;Element;Field;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Service Location No.;
                                                  MinOccurs=Zero }

    { [{C4CDA9E0-4DF1-4590-97F5-07B86ACBF717}];3 ;Order_OrderKind     ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Order Kind;
                                                  MinOccurs=Zero }

    { [{8CDD18C6-C6DE-4543-871D-29B937278E85}];3 ;Order_OrderType     ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Order Type;
                                                  MinOccurs=Zero }

    { [{D1EFC0E0-A381-4358-B9FA-DC49E6D31B8C}];3 ;Order_Description   ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Description;
                                                  MinOccurs=Zero }

    { [{E68DF12F-CA05-4862-8822-2962FD6AEE7F}];3 ;Order_OrderDateTime ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{0C41C9BD-B626-44A7-87FF-F1E46C48A3FC}];3 ;Order_ProblemText   ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Problem Text;
                                                  MinOccurs=Zero }

    { [{C70E0A5E-F23A-4659-B5CC-A45F19990CE9}];3 ;Order_InternalText  ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=ServiceOrder::Internal Text;
                                                  MinOccurs=Zero }

    { [{11DD7702-D7B1-41F4-9FCC-2468FFFE0C32}];3 ;ListServiceorderBudgetLines;Element;Text;
                                                  MinOccurs=Zero }

    { [{5F1DD1DB-D7AB-47D4-804C-37CF9A8A3415}];4 ;ServiceorderBudgetLine;Element;Table  ;
                                                  VariableName=BudgetLine;
                                                  SourceTable=Table11012273;
                                                  LinkTable=ServiceOrder;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterInitRecord=BEGIN
                                                                              InitImportDataLine(BudgetLine, BudgetLine."Line Type"::Budget);
                                                                            END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                BudgetLine.INIT;
                                                                              END;
                                                                               }

    { [{1E717433-563E-444A-BF84-F15D88875790}];5 ;Budget_ServiceOrderNo;Element;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Service Order No. }

    { [{AA24AC76-7C6C-43C8-B2D8-82724785520C}];5 ;Budget_LineNo       ;Element ;Field   ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Service Order Line No. }

    { [{D209FF6A-B9A0-43D3-8207-4E179B6A527E}];5 ;Budget_ObjectNo     ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Object No.;
                                                  MinOccurs=Zero }

    { [{B6337368-34EE-429C-9C2D-ABCC2B84C487}];5 ;Budget_ObjectCustomer;Element;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Object Customer;
                                                  MinOccurs=Zero }

    { [{A9AF588A-A4A0-486A-BD8E-B84ABCA777E8}];5 ;Budget_Building     ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Building;
                                                  MinOccurs=Zero }

    { [{BF1173B8-942D-4B3C-A668-641BFBF59444}];5 ;Budget_Floor        ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Floor;
                                                  MinOccurs=Zero }

    { [{E544EB22-010F-499F-873C-B5E53D490FDC}];5 ;Budget_Room         ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Room;
                                                  MinOccurs=Zero }

    { [{B3D17BBE-6D63-478B-9134-B254F1059466}];5 ;Budget_Discipline   ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Discipline;
                                                  MinOccurs=Zero }

    { [{D053516A-3BBA-4D44-89A5-EC566FC71C3C}];5 ;Budget_TradeSpeciality;Element;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Trade Speciality;
                                                  MinOccurs=Zero }

    { [{21053545-4AFA-4D54-8DDB-4AAE0F399948}];5 ;Budget_TradeExpertise;Element;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Trade Expertise;
                                                  MinOccurs=Zero }

    { [{88DA383D-9991-417E-A055-2EE37E67BA9A}];5 ;Budget_Finished     ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Finished }

    { [{329D43FA-1DB1-4370-BE99-BB208A1A6F57}];5 ;Budget_FollowupJob  ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=BudgetLine::Follow-up Job }

    { [{F68D670E-506C-4F73-BA27-63BD71DC384D}];3 ;ListServiceorderCostPlus;Element;Text ;
                                                  MinOccurs=Zero }

    { [{FA442AB8-53AD-45D0-8407-F997AE472F7B}];4 ;ServiceorderCostPlus;Element ;Table   ;
                                                  VariableName=CostPlusLine;
                                                  SourceTable=Table11012273;
                                                  LinkTable=ServiceOrder;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterInitRecord=BEGIN
                                                                              InitImportDataLine(CostPlusLine, CostPlusLine."Line Type"::CostPlus);
                                                                            END;

                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 XMLFormatMgtCU.EvaluateDate(CostPlus_PostingDate,CostPlusLine.Date);
                                                                                 XMLFormatMgtCU.EvaluateDecimal(CostPlus_Quantity,CostPlusLine.Quantity);
                                                                                 XMLFormatMgtCU.EvaluateDecimal(CostPlus_UnitCost,CostPlusLine."Unit Cost");
                                                                                 XMLFormatMgtCU.EvaluateDate(CostPlus_FromDate,CostPlusLine."From Date");
                                                                                 XMLFormatMgtCU.EvaluateTime(CostPlus_FromTime,CostPlusLine."From Time");
                                                                                 XMLFormatMgtCU.EvaluateDate(CostPlus_ToDate,CostPlusLine."To Date");
                                                                                 XMLFormatMgtCU.EvaluateTime(CostPlus_ToTime,CostPlusLine."To Time");
                                                                               END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                CostPlusLine.INIT;
                                                                                CostPlus_PostingDate := '';
                                                                                CostPlus_Quantity := '';
                                                                                CostPlus_UnitCost := '';
                                                                                CostPlus_FromDate := '';
                                                                                CostPlus_FromTime := '';
                                                                                CostPlus_ToDate := '';
                                                                                CostPlus_ToTime := '';
                                                                              END;
                                                                               }

    { [{30FB92EC-0EF9-40BD-B0CD-BE2DD7A72094}];5 ;CostPlus_ServiceOrderNo;Element;Field ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Service Order No. }

    { [{8DBB02ED-CB30-4DF6-B615-02CF0E427C45}];5 ;CostPlus_PostingDate;Element ;Text    ;
                                                  DataType=Date }

    { [{F34DA367-EA59-4A13-BFC5-82C05F0A457F}];5 ;CostPlus_Installation;Element;Text    ;
                                                  DataType=Code;
                                                  MinOccurs=Zero }

    { [{90127824-2530-4B5A-9B7A-2A96363C0261}];5 ;CostPlus_InstallationPart;Element;Text;
                                                  DataType=Code;
                                                  MinOccurs=Zero }

    { [{83CC527D-4EC2-4A76-BA92-76AB37F9ED4A}];5 ;CostPlus_ObjectNo   ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Object No.;
                                                  MinOccurs=Zero }

    { [{5F9A6EF2-F9E7-4754-B991-CBC43A56687A}];5 ;CostPlus_ObjectCustomer;Element;Field ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Object Customer;
                                                  MinOccurs=Zero }

    { [{8401FF15-09D5-4B92-8871-304110BECCFD}];5 ;CostPlus_EmployeeNo ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Employee No.;
                                                  MinOccurs=Zero }

    { [{EEC9BA78-83D8-4FB6-BCF8-EEE97217DAE4}];5 ;CostPlus_ItemNo     ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Item No.;
                                                  MinOccurs=Zero }

    { [{52CE17A6-6BE4-42C0-8AB6-1BEC685328C2}];5 ;CostPlus_BasicItem  ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Basic Item;
                                                  MinOccurs=Zero }

    { [{AD508C60-260A-469E-B1B0-B4522F2BC864}];5 ;CostPlus_TradeItem  ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Trade Item;
                                                  MinOccurs=Zero }

    { [{0F4B3356-28C0-4385-9FDE-79A83CCDCF6A}];5 ;CostPlus_VendorTradeItem;Element;Field;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Vendor (Trade Item);
                                                  MinOccurs=Zero }

    { [{E7C8C48F-7F29-44D8-AD67-0E89FA1EA157}];5 ;CostPlus_Manufacturer;Element;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Manufacturer;
                                                  MinOccurs=Zero }

    { [{1A6BD673-F506-4F57-9E19-30638A4DB997}];5 ;CostPlus_CostObject ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Cost Object;
                                                  MinOccurs=Zero }

    { [{FAADE4AF-40A7-4FA1-98D4-1CC6ED497E73}];5 ;CostPlus_CostComponent;Element;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Cost Component;
                                                  MinOccurs=Zero }

    { [{58518CB4-E471-4D72-8A9D-4883F2E376FF}];5 ;CostPlus_WageComponent;Element;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Wage Component;
                                                  MinOccurs=Zero }

    { [{F840D88B-10A6-45B3-B187-CD57709B80D2}];5 ;CostPlus_Description;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Description;
                                                  MinOccurs=Zero }

    { [{848FD93B-4873-4E1C-9C2C-61ACA1093391}];5 ;CostPlus_Description2;Element;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Description 2;
                                                  MinOccurs=Zero }

    { [{6CBB743D-8018-4A01-94E8-A00CEA530E07}];5 ;CostPlus_Quantity   ;Element ;Text    ;
                                                  DataType=Decimal }

    { [{D0DDC06F-FE9D-4A60-AABF-3AF023268049}];5 ;CostPlus_UnitOfMeasure;Element;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Unit of Measure;
                                                  MinOccurs=Zero }

    { [{FCEE95F9-A4F0-42C9-9085-DBC18D96555B}];5 ;CostPlus_AdditionalCost;Element;Field ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=CostPlusLine::Additional Cost }

    { [{841A7309-1EE5-422A-916B-903A98DB3685}];5 ;CostPlus_UnitCost   ;Element ;Text    ;
                                                  DataType=Decimal;
                                                  MinOccurs=Zero }

    { [{798DA580-0737-4DC3-B452-783766DE76E3}];5 ;CostPlus_FromDate   ;Element ;Text    ;
                                                  DataType=Date;
                                                  MinOccurs=Zero }

    { [{75C2D759-A4BB-4E72-948E-E7F3A422DB60}];5 ;CostPlus_FromTime   ;Element ;Text    ;
                                                  DataType=Time;
                                                  MinOccurs=Zero }

    { [{985F6106-F9C3-491C-AE77-3D7EC7566A3A}];5 ;CostPlus_ToDate     ;Element ;Text    ;
                                                  DataType=Date;
                                                  MinOccurs=Zero }

    { [{F3049215-B53D-4495-B7DE-DB517B4C93EA}];5 ;CostPlus_ToTime     ;Element ;Text    ;
                                                  DataType=Time;
                                                  MinOccurs=Zero }

    { [{1CEF3F95-654E-4095-9397-D9502E099D84}];3 ;ListServiceAdviceOrderLines;Element;Text;
                                                  MinOccurs=Zero }

    { [{AACF9C50-8826-4DDF-8F99-E9EA3C11A626}];4 ;ServiceAdviceOrderLine;Element;Table  ;
                                                  VariableName=AdviceOrderLine;
                                                  SourceTable=Table11012273;
                                                  LinkTable=ServiceOrder;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterInitRecord=BEGIN
                                                                              InitImportDataLine(AdviceOrderLine, AdviceOrderLine."Line Type"::AdviceOrder);
                                                                            END;

                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 XMLFormatMgtCU.EvaluateDecimal(Advice_Quantity,AdviceOrderLine.Quantity);
                                                                               END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                AdviceOrderLine.INIT;
                                                                                Advice_Quantity := '';
                                                                              END;
                                                                               }

    { [{8420008C-B613-4F6D-B74F-FFC7D4820C08}];5 ;Advice_ServiceOrderNo;Element;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Service Order No. }

    { [{8C195A11-5C12-4977-B64D-E596DCD4C50E}];5 ;Advice_ItemNo       ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Item No.;
                                                  MinOccurs=Zero }

    { [{6BAC8136-073A-40E1-9A83-F73035A18961}];5 ;Advice_BasicItem    ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Basic Item;
                                                  MinOccurs=Zero }

    { [{25D3830F-B203-4905-A8D5-0982F0843098}];5 ;Advice_TradeItem    ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Trade Item;
                                                  MinOccurs=Zero }

    { [{782AE0CF-0C56-4112-9150-4355248E5B7F}];5 ;Advice_VendorTradeItem;Element;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Vendor (Trade Item);
                                                  MinOccurs=Zero }

    { [{C0643E63-2CA7-4382-B439-9F61D4592850}];5 ;Advice_Manufacturer ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Manufacturer;
                                                  MinOccurs=Zero }

    { [{306A5E53-5EB4-4EAD-80C3-8EE3B9FBB859}];5 ;Advice_Description  ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Description;
                                                  MinOccurs=Zero }

    { [{3459A80C-E5EB-41D8-B82D-069B1CA20541}];5 ;Advice_Description2 ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Description 2;
                                                  MinOccurs=Zero }

    { [{6D4ACEFE-7377-48B1-9961-D2FE3AC44FA4}];5 ;Advice_Quantity     ;Element ;Text     }

    { [{4712C013-79FF-400A-A46C-59DD46838F62}];5 ;Advice_UnitOfMeasure;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=AdviceOrderLine::Unit of Measure }

    { [{14255A18-557E-4DE9-B7B5-A51607546EE4}];3 ;ListSpecifications  ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{37A17C44-95D3-4159-B928-44F5DCB70AB1}];4 ;Specification       ;Element ;Table   ;
                                                  VariableName=Specification;
                                                  SourceTable=Table11012273;
                                                  LinkTable=ServiceOrder;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterInitRecord=BEGIN
                                                                              InitImportDataLine(Specification, Specification."Line Type"::Specs);
                                                                            END;

                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 XMLFormatMgtCU.EvaluateDecimal(Specs_Value,Specification.Quantity);
                                                                                 XMLFormatMgtCU.EvaluateDate(Specs_Date,Specification.Date);
                                                                               END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                Specification.INIT;
                                                                                Specs_Value := '';
                                                                                Specs_Date := '';
                                                                              END;
                                                                               }

    { [{0D34E80C-0F4A-44FF-BE90-4A396FE4AA8B}];5 ;Specs_ServiceOrderNo;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=Specification::Service Order No.;
                                                  MinOccurs=Zero }

    { [{71583FAD-82E2-4992-81C1-0B1A64065276}];5 ;Specs_ServiceLocation;Element;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=Specification::Service Location No.;
                                                  MinOccurs=Zero }

    { [{B265D802-B415-4CEE-8C93-5936F55289F2}];5 ;Specs_SpecLevel     ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Specification::Level }

    { [{E1555FAA-E907-42F7-8D8F-B626F9272851}];5 ;Specs_Installation  ;Element ;Text    ;
                                                  DataType=Code }

    { [{4E7C66AD-8A88-4EE1-BD25-A6F18F819333}];5 ;Specs_InstallationPart;Element;Text   ;
                                                  DataType=Code;
                                                  MinOccurs=Zero }

    { [{529E8D3C-018C-4250-8F8F-D1871E43F044}];5 ;Specs_FeatureGroup  ;Element ;Text    ;
                                                  DataType=Code }

    { [{F1D32E30-CA57-43CF-917E-5C47752814F4}];5 ;Specs_Feature       ;Element ;Text    ;
                                                  DataType=Code }

    { [{64966DAB-4C2B-4A87-AB7B-F28C4FFDEEB7}];5 ;Specs_Apply         ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  FieldValidate=No;
                                                  SourceField=Specification::Apply;
                                                  MinOccurs=Zero }

    { [{4C784CD2-C4DF-4F1C-92DB-F6A6C468D73B}];5 ;Specs_Choice        ;Element ;Text    ;
                                                  DataType=Code;
                                                  MinOccurs=Zero }

    { [{19958525-E16C-49BF-B228-E69345E75435}];5 ;Specs_Value         ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{8911F2B2-0B5B-4AAA-BE9C-EC5C2A5F050F}];5 ;Specs_Text          ;Element ;Field   ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=Specification::Comment;
                                                  MinOccurs=Zero }

    { [{22B2E531-7EF2-428D-8506-FA20E9B3DC54}];5 ;Specs_Date          ;Element ;Text    ;
                                                  MinOccurs=Zero }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      FSASetupRec@1100485011 : Record 11012138;
      gLogbookRec@1100485001 : Record 11012271;
      ErrorRec@1100485004 : Record 11012272;
      XMLFormatMgtCU@1100485003 : Codeunit 11012092;
      FileMgt@1100525500 : Codeunit 419;
      OperatingSystemMgt@1100409000 : Codeunit 11012364;
      FSA_FunctionsDllCreated@1100485005 : Boolean;
      Counter@1100485000 : Integer;
      MessID@1100485009 : Code[30];
      MessType@1100485010 : Code[30];
      Text000a@1100485007 : TextConst 'ENU=Message ID ''%1'' incorrect, must be ''%2''';
      Text000b@1100485008 : TextConst 'ENU=Message Type ''%1'' incorrect, must be ''%2''';
      PathTmpFiles@1100485006 : Text[250];

    PROCEDURE SetImportData@1100485000(ILogbookRec@1100485000 : Record 11012271;IMessID@1100485001 : Code[30]);
    BEGIN
      gLogbookRec := ILogbookRec;
      MessID := IMessID;
    END;

    PROCEDURE GetImportData@1100485001() : Integer;
    BEGIN
      EXIT(Counter);
    END;

    PROCEDURE InitImportDataLine@1100485003(VAR IOImportLineRec@1100485000 : Record 11012273;ILineType@1100485001 : Option);
    BEGIN
      Counter := Counter + 1;

      IOImportLineRec."Date/Time" := gLogbookRec."Date/Time";
      IOImportLineRec."Message Type" := gLogbookRec."Message Type";
      IOImportLineRec."Line No." := Counter;
      IOImportLineRec."Line Type" := ILineType;
    END;

    PROCEDURE MakeSignature@1100485002();
    VAR
      TempBlob@1100525500 : Record 99008535;
      lvLen@1100485002 : Integer;
      lvMaxLen@1100485003 : Integer;
      lvStartPos@1100485000 : Integer;
      lvTxt@1100485001 : Text[1024];
      lvFile@1100485005 : Text[1024];
    BEGIN
      ERROR('Not yet implemented.');
      //* A digital signature will be delivered as a encrypted textstring (bigtext, because can be more than 1024
      //* characters). This should be converted to a bmp-file (using a DLL),
      //* after that the bmp-file can be imported as a BLOB.
      //* More info about DLL can be retreived from Joost Mulder.

      IF Order_Signature.LENGTH <= 2 THEN  //* Do not test on zero, because FV still delivers two characters ('G4')
        EXIT;                              //* for an 'empty signature'. For other BDA also.

      lvStartPos := 1;
      lvMaxLen := MAXSTRLEN(lvTxt);
      lvLen := Order_Signature.LENGTH;

      CASE FSASetupRec."Field Service Administration" OF
        FSASetupRec."Field Service Administration"::FieldVision:
          BEGIN
            IF NOT FSA_FunctionsDllCreated THEN BEGIN
      //        CREATE(FV_FunctionsDll, FALSE, TRUE); kk.o
              FSA_FunctionsDllCreated := TRUE;
              PathTmpFiles := OperatingSystemMgt.ClientEnviron('TEMP');
              FileMgt.AddBackSlashToDirectoryName(PathTmpFiles);
            END;

      //      FV_FunctionsDll.ClearText(); kk.o

            REPEAT
              lvTxt := '';
              Order_Signature.GETSUBTEXT(lvTxt, lvStartPos, lvMaxLen);
      //        FV_FunctionsDll.AddText(lvTxt); kk.o
              lvStartPos := lvStartPos + lvMaxLen;
            UNTIL (lvStartPos > lvLen);

            lvFile := PathTmpFiles + 'Tmp'+ USERID + '-SODebriefSignature.bmp';

      //      FV_FunctionsDll.CreateSignatureFromText(200, 150, 'FFFFFF', '000000', lvFile, 2.0); kk.o
            FileMgt.BLOBImport4PS(TempBlob, lvFile, FALSE);
            ServiceOrder.Signature := TempBlob.Blob;
          END;
        FSASetupRec."Field Service Administration"::Nemo:  //* PCA-NEMO
          BEGIN
            IF NOT FSA_FunctionsDllCreated THEN BEGIN
      //        CREATE(PCA_FunctionsDll, FALSE, TRUE); kk.o
              FSA_FunctionsDllCreated := TRUE;
              PathTmpFiles := OperatingSystemMgt.ClientEnviron('TEMP');
              FileMgt.AddBackSlashToDirectoryName(PathTmpFiles);
            END;

      //      PCA_FunctionsDll.ClearText(); kk.o

            REPEAT
              lvTxt := '';
              Order_Signature.GETSUBTEXT(lvTxt, lvStartPos, lvMaxLen);
      //        PCA_FunctionsDll.AddText(lvTxt); kk.o
              lvStartPos := lvStartPos + lvMaxLen;
            UNTIL (lvStartPos > lvLen);

            lvFile := PathTmpFiles + 'Tmp'+ USERID + '-SODebriefSignature.bmp';
      //      PCA_FunctionsDll.WriteXMLImage(2.0, lvFile); kk.o
            FileMgt.BLOBImport4PS(TempBlob, lvFile, FALSE);
            ServiceOrder.Signature := TempBlob.Blob;
          END;
      END;
    END;

    BEGIN
    {
      TODO kkleermaker: FV_FunctionsDll and PCA_FunctionsDll must be replaced with DotNet variables.
      Some code has been commented out, because it is not possible in NAV2013 to use the automation
      variables FV_FunctionsDll and PCA_FunctionsDll on the NAS server.
    }
    END.
  }
}

