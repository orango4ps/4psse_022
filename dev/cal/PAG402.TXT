OBJECT Page 402 Sales Order Statistics
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=_Sales Order Statistics;
               NOR=Ordrestatistikk;
               SVE=F”rs.orderstatistik];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table36;
    PageType=Card;
    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 SalesSetup.GET;
                 AllowInvDisc := NOT (SalesSetup."Calc. Inv. Discount" AND CustInvDiscRecExists("Invoice Disc. Code"));
                 AllowVATDifference :=
                   SalesSetup."Allow VAT Difference" AND
                   NOT ("Document Type" IN ["Document Type"::Quote,"Document Type"::"Blanket Order"]);
                 OnOpenPageOnBeforeSetEditable(AllowInvDisc,AllowVATDifference);
                 VATLinesFormIsEditable := AllowVATDifference OR AllowInvDisc;
                 CurrPage.EDITABLE := VATLinesFormIsEditable;
               END;

    OnAfterGetRecord=BEGIN
                       RefreshOnAfterGetRecord;
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnQueryClosePage=VAR
                       SalesLine@1001 : Record 37;
                       ReleaseSalesDocument@1002 : Codeunit 414;
                     BEGIN
                       GetVATSpecification(PrevTab);
                       ReleaseSalesDocument.CalcAndUpdateVATOnLines(Rec,SalesLine);
                       EXIT(TRUE);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           DynamicEditable := CurrPage.EDITABLE;
                         END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=Allm„nt] }

    { 39  ;2   ;Field     ;
                Name=LineAmountGeneral;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine[1]."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text002,FALSE);
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                Name=InvDiscountAmount_General;
                CaptionML=[ENU=Inv. Discount Amount;
                           NOR=Fakturarabattbel›p;
                           SVE=Fakturarabatt];
                ToolTipML=[ENU=Specifies the invoice discount amount for the sales document.;
                           NOR=Angir salgsdokumentets fakturarabattbel›p.;
                           SVE=Anger fakturarabatten f”r f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine[1]."Inv. Discount Amount";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                Editable=DynamicEditable;
                OnValidate=BEGIN
                             ActiveTab := ActiveTab::General;
                             UpdateInvDiscAmount(1);
                           END;
                            }

    { 20  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAmount1[1];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text001,FALSE);
                Editable=DynamicEditable;
                OnValidate=BEGIN
                             ActiveTab := ActiveTab::General;
                             UpdateTotalAmount(1);
                           END;
                            }

    { 16  ;2   ;Field     ;
                Name=VATAmount;
                CaptionML=[ENU=VAT Amount;
                           NOR=Mva-bel›p;
                           SVE=Momsbelopp];
                ToolTipML=[ENU=Specifies the total VAT amount that has been calculated for all the lines in the sales document.;
                           NOR=Angir det totale mva.-bel›pet som er beregnet for alle linjene i salgsdokumentet.;
                           SVE=Anger det totala momsbeloppet ber„knat p† alla f”rs„ljningsdokumentets rader.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount[1];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=FORMAT(VATAmountText[1]);
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAmount2[1];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text001,TRUE);
                Editable=FALSE;
                OnValidate=BEGIN
                             TotalAmount21OnAfterValidate;
                           END;
                            }

    { 7   ;2   ;Field     ;
                CaptionML=[ENU=Sales (LCY);
                           NOR=Salg (NOK);
                           SVE=F”rs„ljning (BVA)];
                ToolTipML=[ENU=Specifies your total sales turnover in the fiscal year. It is calculated from amounts excluding VAT on all completed and open sales invoices and credit memos.;
                           NOR=Angir den totale salgsomsetningen i regnskaps†ret. Verdien beregnes fra bel›p uten mva for alle fullf›rte og †pne salgsfakturaer og kreditnotaer.;
                           SVE=Anger total f”rs„ljningsoms„ttning under r„kenskaps†ret. Den ber„knas fr†n belopp exklusive moms p† alla avslutade och ”ppna f”rs„ljningsfakturor och kreditnotor.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLineLCY[1].Amount;
                AutoFormatType=1;
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                CaptionML=[ENU=Original Profit (LCY);
                           NOR=Bruttofortjeneste (NOK);
                           SVE=Ursprunglig vinst (BVA)];
                ToolTipML=[ENU=Specifies the original profit that was associated with the sales when they were originally posted.;
                           NOR=Angir den opprinnelige bruttofortjenesten som ble knyttet til salgene da de opprinnelig ble bokf›rt.;
                           SVE=Anger den ursprungliga vinsten som kopplades till f”rs„ljningen n„r den ursprungligen bokf”rdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ProfitLCY[1];
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 46  ;2   ;Field     ;
                CaptionML=[ENU=Adjusted Profit (LCY);
                           NOR=Justert bruttofortjeneste (NOK);
                           SVE=Justerad vinst (BVA)];
                ToolTipML=[ENU=Specifies the profit, taking into consideration changes in the purchase prices of the goods.;
                           NOR=Angir bruttofortjenesten etter at det er tatt h›yde for endringer i kj›psprisen for varene.;
                           SVE=Anger vinsten med h„nsyn till „ndringar i varornas ink”pspriser.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AdjProfitLCY[1];
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                CaptionML=[ENU=Original Profit %;
                           NOR=Bruttofortjeneste-%;
                           SVE=Ursprunglig vinst %];
                ToolTipML=[ENU=Specifies the original percentage of profit that was associated with the sales when they were originally posted.;
                           NOR=Angir den opprinnelige prosentdelen av fortjenesten som ble knyttet til salgene da de opprinnelig ble bokf›rt.;
                           SVE=Anger den ursprungliga vinstprocentandelen som kopplades till f”rs„ljningen n„r den ursprungligen bokf”rdes.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=1:1;
                SourceExpr=ProfitPct[1];
                Importance=Additional;
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                CaptionML=[ENU=Adjusted Profit %;
                           NOR=Justert bruttofortjeneste-%;
                           SVE=Justerad vinst %];
                ToolTipML=[ENU=Specifies the percentage of profit for all sales, taking into account changes that occurred in the purchase prices of the goods.;
                           NOR=Angir prosenten av fortjeneste for alle salg, etter at det er tatt h›yde for endringer som oppstod i kj›psprisen for varene.;
                           SVE=Anger vinstprocentandelen f”r all f”rs„ljning, med h„nsyn till konto„ndringar som har „gt rum i varornas ink”pspriser.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=1:1;
                SourceExpr=AdjProfitPct[1];
                Importance=Additional;
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Quantity;
                           NOR=Antall;
                           SVE=Antal];
                ToolTipML=[ENU=Specifies the total quantity of G/L account entries, items, and/or resources in the sales document. If the amount is rounded, because the Invoice Rounding check box is selected in the Sales & Receivables Setup window, this field will contain the quantity of items in the sales document plus one.;
                           NOR=Angir det totale antall finansposter, varer og/eller ressurser i salgsdokumentet. Hvis bel›pet avrundes fordi det er merket av for Fakturaavrunding i vinduet Salgsoppsett, inneholder feltet antall varer i salgsdokumentet pluss ‚n.;
                           SVE=Anger det totala antalet redovisningskontotransaktioner, artiklar och/eller resurser p† f”rs„ljningsordern. Om beloppet avrundas d„rf”r att kryssrutan Fakturaavrundning i f”nstret Konfiguration av f”rs„ljning och fordringar „r markerad, inneh†ller det h„r f„ltet antalet artiklar i f”rs„ljningsdokumentet plus ett.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[1].Quantity;
                Importance=Additional;
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Parcels;
                           NOR=Kolli;
                           SVE=F”rpackningar];
                ToolTipML=[ENU=Specifies the total number of parcels in the sales document.;
                           NOR=Angir antall kolli i salgsdokumentet.;
                           SVE=Anger totalt antal f”rpackningar i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[1]."Units per Parcel";
                Importance=Additional;
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Net Weight;
                           NOR=Nettovekt;
                           SVE=Nettovikt];
                ToolTipML=[ENU=Specifies the total net weight of the items in the sales document.;
                           NOR=Angir den totale nettovekten av varene i salgsdokumentet.;
                           SVE=Anger total nettovikt f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[1]."Net Weight";
                Importance=Additional;
                Editable=FALSE }

    { 11  ;2   ;Field     ;
                CaptionML=[ENU=Gross Weight;
                           NOR=Bruttovekt;
                           SVE=Bruttovikt];
                ToolTipML=[ENU=Specifies the total gross weight of the items in the sales document.;
                           NOR=Angir den totale bruttovekten av varene i salgsdokumentet.;
                           SVE=Anger total bruttovikt f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[1]."Gross Weight";
                Importance=Additional;
                Editable=FALSE }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Volume;
                           NOR=Volum;
                           SVE=Volym];
                ToolTipML=[ENU=Specifies the total volume of the items in the sales document.;
                           NOR=Angir det totale volumet av varene i salgsdokumentet.;
                           SVE=Anger total volym f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[1]."Unit Volume";
                Importance=Additional;
                Editable=FALSE }

    { 37  ;2   ;Field     ;
                CaptionML=[ENU=Original Cost (LCY);
                           NOR=Opprinnelig kost (NOK);
                           SVE=Ursprunglig kostnad (BVA)];
                ToolTipML=[ENU=Specifies the total cost, in LCY, of the G/L account entries, items, and/or resources in the sales document. The cost is calculated as unit cost x quantity of the items or resources.;
                           NOR=Angir det totale kostbel›p, i NOK, til finans, varene og/eller ressurser i salgsdokumentet. Kostbel›pet er beregnet som enhetskost x mengde av varene eller ressursene.;
                           SVE=Anger den totala kostnaden i BVA f”r redovisningskontotransaktioner, artiklar och/eller resurser i f”rs„ljningsdokumentet. Kostnaden ber„knas som styckkostnad ž antal artiklar eller resurser.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLineLCY[1]."Unit Cost (LCY)";
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 35  ;2   ;Field     ;
                CaptionML=[ENU=Adjusted Cost (LCY);
                           NOR=Justert kost (NOK);
                           SVE=Justerad kostnad (BVA)];
                ToolTipML=[ENU=Specifies the total cost, in LCY, of the items in the sales document, adjusted for any changes in the original costs of these items. If this field contains zero, it means that there were no entries to calculate, possibly because of date compression or because the adjustment batch job has not yet been run.;
                           NOR=Angir total kost, i NOK, for varene i salgsdokumentet, justert for eventuelle endringer i opprinnelig kost for varene. Hvis feltet inneholder null, betyr det at det ikke var noen poster † beregne. Dette kan skyldes datokomprimering eller at justeringskj›rselen ikke er kj›rt enn†.;
                           SVE=Anger den totala kostnaden i BVA f”r artiklarna i f”rs„ljningsdokumentet, justerat med eventuella „ndringar i den ursprungliga kostnaden f”r dessa artiklar. Om det h„r f„ltet inneh†ller v„rdet noll, inneb„r det att det inte fanns n†gra transaktioner att ber„kna, m”jligen p† grund av datakomprimering eller p† att buntjobbet Justering „nnu inte har k”rts.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAdjCostLCY[1];
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 120 ;2   ;Field     ;
                CaptionML=[ENU=Cost Adjmt. Amount (LCY);
                           NOR=Kostjusteringsbel›p (NOK);
                           SVE=Kostnadsjusteringsbelopp (BVA)];
                ToolTipML=[ENU=Specifies the difference between the original cost and the total adjusted cost of the items in the sales document.;
                           NOR=Angir differansen mellom opprinnelig kost og total justert kost for varene i salgsdokumentet.;
                           SVE=Anger skillnaden mellan den ursprungliga kostnaden och den totala justerade kostnaden f”r artiklar i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAdjCostLCY[1] - TotalSalesLineLCY[1]."Unit Cost (LCY)";
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE;
                OnLookup=BEGIN
                           LookupAdjmtValueEntries(0);
                         END;
                          }

    { 119 ;2   ;Field     ;
                Name=NoOfVATLines_General;
                DrillDown=Yes;
                CaptionML=[ENU=No. of Tax Lines;
                           NOR=Ant. mva-linjer;
                           SVE=Antal momsrader];
                ToolTipML=[ENU=Specifies the number of lines on the sales order that have VAT amounts.;
                           NOR=Angir antallet linjer p† ordren som har mva-bel›p.;
                           SVE=Anger antalet rader p† f”rs„ljningsordern som har momsbelopp.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempVATAmountLine1.COUNT;
                Importance=Additional;
                OnDrillDown=BEGIN
                              VATLinesDrillDown(TempVATAmountLine1,FALSE);
                              UpdateHeaderInfo(1,TempVATAmountLine1);
                            END;
                             }

    { 1210190000;1;Part   ;
                PagePartID=Page576;
                PartType=Page }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           NOR=Fakturering;
                           SVE=Fakturering] }

    { 71  ;2   ;Field     ;
                Name=AmountInclVAT_Invoicing;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine[2]."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text002,FALSE);
                Editable=FALSE }

    { 51  ;2   ;Field     ;
                Name=InvDiscountAmount_Invoicing;
                CaptionML=[ENU=Inv. Discount Amount;
                           NOR=Fakturarabattbel›p;
                           SVE=Fakturarabatt];
                ToolTipML=[ENU=Specifies the invoice discount amount for the sales document.;
                           NOR=Angir salgsdokumentets fakturarabattbel›p.;
                           SVE=Anger fakturarabatten f”r f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine[2]."Inv. Discount Amount";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                Editable=DynamicEditable;
                OnValidate=BEGIN
                             ActiveTab := ActiveTab::Invoicing;
                             UpdateInvDiscAmount(2);
                           END;
                            }

    { 50  ;2   ;Field     ;
                Name=TotalInclVAT_Invoicing;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAmount1[2];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text001,FALSE);
                Editable=DynamicEditable;
                OnValidate=BEGIN
                             ActiveTab := ActiveTab::Invoicing;
                             UpdateTotalAmount(2);
                           END;
                            }

    { 49  ;2   ;Field     ;
                Name=VATAmount_Invoicing;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount[2];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=FORMAT(VATAmountText[2]);
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                Name=TotalExclVAT_Invoicing;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAmount2[2];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text001,TRUE);
                Editable=FALSE }

    { 69  ;2   ;Field     ;
                CaptionML=[ENU=Sales (LCY);
                           NOR=Salg (NOK);
                           SVE=F”rs„ljning (BVA)];
                ToolTipML=[ENU=Specifies your total sales turnover in the fiscal year. It is calculated from amounts excluding VAT on all completed and open sales invoices and credit memos.;
                           NOR=Angir den totale salgsomsetningen i regnskaps†ret. Verdien beregnes fra bel›p uten mva for alle fullf›rte og †pne salgsfakturaer og kreditnotaer.;
                           SVE=Anger total f”rs„ljningsoms„ttning under r„kenskaps†ret. Den ber„knas fr†n belopp exklusive moms p† alla avslutade och ”ppna f”rs„ljningsfakturor och kreditnotor.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLineLCY[2].Amount;
                AutoFormatType=1;
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                CaptionML=[ENU=Original Profit (LCY);
                           NOR=Bruttofortjeneste (NOK);
                           SVE=Ursprunglig vinst (BVA)];
                ToolTipML=[ENU=Specifies the original profit that was associated with the sales when they were originally posted.;
                           NOR=Angir den opprinnelige bruttofortjenesten som ble knyttet til salgene da de opprinnelig ble bokf›rt.;
                           SVE=Anger den ursprungliga vinsten som kopplades till f”rs„ljningen n„r den ursprungligen bokf”rdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ProfitLCY[2];
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 75  ;2   ;Field     ;
                CaptionML=[ENU=Adjusted Profit (LCY);
                           NOR=Justert bruttofortjeneste (NOK);
                           SVE=Justerad vinst (BVA)];
                ToolTipML=[ENU=Specifies the profit, taking into consideration changes in the purchase prices of the goods.;
                           NOR=Angir bruttofortjenesten etter at det er tatt h›yde for endringer i kj›psprisen for varene.;
                           SVE=Anger vinsten med h„nsyn till „ndringar i varornas ink”pspriser.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AdjProfitLCY[2];
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 66  ;2   ;Field     ;
                CaptionML=[ENU=Original Profit %;
                           NOR=Bruttofortjeneste-%;
                           SVE=Ursprunglig vinst %];
                ToolTipML=[ENU=Specifies the original percentage of profit that was associated with the sales when they were originally posted.;
                           NOR=Angir den opprinnelige prosentdelen av fortjenesten som ble knyttet til salgene da de opprinnelig ble bokf›rt.;
                           SVE=Anger den ursprungliga vinstprocentandelen som kopplades till f”rs„ljningen n„r den ursprungligen bokf”rdes.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=1:1;
                SourceExpr=ProfitPct[2];
                Importance=Additional;
                Editable=FALSE }

    { 79  ;2   ;Field     ;
                CaptionML=[ENU=Adjusted Profit %;
                           NOR=Justert bruttofortjeneste-%;
                           SVE=Justerad vinst %];
                ToolTipML=[ENU=Specifies the percentage of profit for all sales, taking into account changes that occurred in the purchase prices of the goods.;
                           NOR=Angir prosenten av fortjeneste for alle salg, etter at det er tatt h›yde for endringer som oppstod i kj›psprisen for varene.;
                           SVE=Anger vinstprocentandelen f”r all f”rs„ljning, med h„nsyn till konto„ndringar som har „gt rum i varornas ink”pspriser.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=1:1;
                SourceExpr=AdjProfitPct[2];
                Importance=Additional;
                Editable=FALSE }

    { 65  ;2   ;Field     ;
                CaptionML=[ENU=Quantity;
                           NOR=Antall;
                           SVE=Antal];
                ToolTipML=[ENU=Specifies the total quantity of G/L account entries, items, and/or resources in the sales document. If the amount is rounded, because the Invoice Rounding check box is selected in the Sales & Receivables Setup window, this field will contain the quantity of items in the sales document plus one.;
                           NOR=Angir det totale antall finansposter, varer og/eller ressurser i salgsdokumentet. Hvis bel›pet avrundes fordi det er merket av for Fakturaavrunding i vinduet Salgsoppsett, inneholder feltet antall varer i salgsdokumentet pluss ‚n.;
                           SVE=Anger det totala antalet redovisningskontotransaktioner, artiklar och/eller resurser p† f”rs„ljningsordern. Om beloppet avrundas d„rf”r att kryssrutan Fakturaavrundning i f”nstret Konfiguration av f”rs„ljning och fordringar „r markerad, inneh†ller det h„r f„ltet antalet artiklar i f”rs„ljningsdokumentet plus ett.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[2].Quantity;
                Importance=Additional;
                Editable=FALSE }

    { 62  ;2   ;Field     ;
                CaptionML=[ENU=Parcels;
                           NOR=Kolli;
                           SVE=F”rpackningar];
                ToolTipML=[ENU=Specifies the total number of parcels in the sales document.;
                           NOR=Angir antall kolli i salgsdokumentet.;
                           SVE=Anger totalt antal f”rpackningar i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[2]."Units per Parcel";
                Importance=Additional;
                Editable=FALSE }

    { 64  ;2   ;Field     ;
                CaptionML=[ENU=Net Weight;
                           NOR=Nettovekt;
                           SVE=Nettovikt];
                ToolTipML=[ENU=Specifies the total net weight of the items in the sales document.;
                           NOR=Angir den totale nettovekten av varene i salgsdokumentet.;
                           SVE=Anger total nettovikt f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[2]."Net Weight";
                Importance=Additional;
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                CaptionML=[ENU=Gross Weight;
                           NOR=Bruttovekt;
                           SVE=Bruttovikt];
                ToolTipML=[ENU=Specifies the total gross weight of the items in the sales document.;
                           NOR=Angir den totale bruttovekten av varene i salgsdokumentet.;
                           SVE=Anger total bruttovikt f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[2]."Gross Weight";
                Importance=Additional;
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                CaptionML=[ENU=Volume;
                           NOR=Volum;
                           SVE=Volym];
                ToolTipML=[ENU=Specifies the total volume of the items in the sales document.;
                           NOR=Angir det totale volumet av varene i salgsdokumentet.;
                           SVE=Anger total volym f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[2]."Unit Volume";
                Importance=Additional;
                Editable=FALSE }

    { 68  ;2   ;Field     ;
                CaptionML=[ENU=Original Cost (LCY);
                           NOR=Opprinnelig kost (NOK);
                           SVE=Ursprunglig kostnad (BVA)];
                ToolTipML=[ENU=Specifies the total cost, in LCY, of the G/L account entries, items, and/or resources in the sales document. The cost is calculated as unit cost x quantity of the items or resources.;
                           NOR=Angir det totale kostbel›p, i NOK, til finans, varene og/eller ressurser i salgsdokumentet. Kostbel›pet er beregnet som enhetskost x mengde av varene eller ressursene.;
                           SVE=Anger den totala kostnaden i BVA f”r redovisningskontotransaktioner, artiklar och/eller resurser i f”rs„ljningsdokumentet. Kostnaden ber„knas som styckkostnad ž antal artiklar eller resurser.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLineLCY[2]."Unit Cost (LCY)";
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 17  ;2   ;Field     ;
                CaptionML=[ENU=Adjusted Cost (LCY);
                           NOR=Justert kost (NOK);
                           SVE=Justerad kostnad (BVA)];
                ToolTipML=[ENU=Specifies the total cost, in LCY, of the items in the sales document, adjusted for any changes in the original costs of these items. If this field contains zero, it means that there were no entries to calculate, possibly because of date compression or because the adjustment batch job has not yet been run.;
                           NOR=Angir total kost, i NOK, for varene i salgsdokumentet, justert for eventuelle endringer i opprinnelig kost for varene. Hvis feltet inneholder null, betyr det at det ikke var noen poster † beregne. Dette kan skyldes datokomprimering eller at justeringskj›rselen ikke er kj›rt enn†.;
                           SVE=Anger den totala kostnaden i BVA f”r artiklarna i f”rs„ljningsdokumentet, justerat med eventuella „ndringar i den ursprungliga kostnaden f”r dessa artiklar. Om det h„r f„ltet inneh†ller v„rdet noll, inneb„r det att det inte fanns n†gra transaktioner att ber„kna, m”jligen p† grund av datakomprimering eller p† att buntjobbet Justering „nnu inte har k”rts.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAdjCostLCY[2];
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 122 ;2   ;Field     ;
                CaptionML=[ENU=Cost Adjmt. Amount (LCY);
                           NOR=Kostjusteringsbel›p (NOK);
                           SVE=Kostnadsjusteringsbelopp (BVA)];
                ToolTipML=[ENU=Specifies the difference between the original cost and the total adjusted cost of the items in the sales document.;
                           NOR=Angir differansen mellom opprinnelig kost og total justert kost for varene i salgsdokumentet.;
                           SVE=Anger skillnaden mellan den ursprungliga kostnaden och den totala justerade kostnaden f”r artiklar i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAdjCostLCY[2] - TotalSalesLineLCY[2]."Unit Cost (LCY)";
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE;
                OnLookup=BEGIN
                           LookupAdjmtValueEntries(1);
                         END;
                          }

    { 125 ;2   ;Field     ;
                Name=NoOfVATLines_Invoicing;
                DrillDown=Yes;
                CaptionML=[ENU=No. of Tax Lines;
                           NOR=Ant. mva-linjer;
                           SVE=Antal momsrader];
                ToolTipML=[ENU=Specifies the number of lines on the sales order that have VAT amounts.;
                           NOR=Angir antallet linjer p† ordren som har mva-bel›p.;
                           SVE=Anger antalet rader p† f”rs„ljningsordern som har momsbelopp.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempVATAmountLine2.COUNT;
                Importance=Additional;
                OnDrillDown=BEGIN
                              ActiveTab := ActiveTab::Invoicing;
                              VATLinesDrillDown(TempVATAmountLine2,TRUE);
                              UpdateHeaderInfo(2,TempVATAmountLine2);

                              IF TempVATAmountLine2.GetAnyLineModified THEN BEGIN
                                UpdateVATOnSalesLines;
                                RefreshOnAfterGetRecord;
                              END;
                            END;
                             }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           NOR=Levering;
                           SVE=Leverans] }

    { 105 ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine[3]."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text002,FALSE);
                Editable=FALSE }

    { 83  ;2   ;Field     ;
                CaptionML=[ENU=Inv. Discount Amount;
                           NOR=Fakturarabattbel›p;
                           SVE=Fakturarabatt];
                ToolTipML=[ENU=Specifies the invoice discount amount for the sales document.;
                           NOR=Angir salgsdokumentets fakturarabattbel›p.;
                           SVE=Anger fakturarabatten f”r f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine[3]."Inv. Discount Amount";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                Editable=FALSE }

    { 82  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAmount1[3];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text001,FALSE);
                Editable=FALSE }

    { 81  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount[3];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=FORMAT(VATAmountText[3]);
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalAmount2[3];
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text001,TRUE);
                Editable=FALSE }

    { 103 ;2   ;Field     ;
                CaptionML=[ENU=Sales (LCY);
                           NOR=Salg (NOK);
                           SVE=F”rs„ljning (BVA)];
                ToolTipML=[ENU=Specifies your total sales turnover in the fiscal year. It is calculated from amounts excluding VAT on all completed and open sales invoices and credit memos.;
                           NOR=Angir den totale salgsomsetningen i regnskaps†ret. Verdien beregnes fra bel›p uten mva for alle fullf›rte og †pne salgsfakturaer og kreditnotaer.;
                           SVE=Anger total f”rs„ljningsoms„ttning under r„kenskaps†ret. Den ber„knas fr†n belopp exklusive moms p† alla avslutade och ”ppna f”rs„ljningsfakturor och kreditnotor.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLineLCY[3].Amount;
                AutoFormatType=1;
                Editable=FALSE }

    { 102 ;2   ;Field     ;
                CaptionML=[ENU=Cost (LCY);
                           NOR=Kost (NOK);
                           SVE=Kostnad (BVA)];
                ToolTipML=[ENU=Specifies the total cost of the sales order.;
                           NOR=Angir den totale kostnaden for ordren.;
                           SVE=Anger f”rs„ljningsorderns totalkostnad.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLineLCY[3]."Unit Cost (LCY)";
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 101 ;2   ;Field     ;
                CaptionML=[ENU=Profit (LCY);
                           NOR=Bruttofortjeneste (NOK);
                           SVE=Vinst (BVA)];
                ToolTipML=[ENU=Specifies the total profit of the sales order.;
                           NOR=Angir den totale fortjenesten for ordren.;
                           SVE=Anger f”rs„ljningsorderns totala vinst.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ProfitLCY[3];
                AutoFormatType=1;
                Importance=Additional;
                Editable=FALSE }

    { 100 ;2   ;Field     ;
                CaptionML=[ENU=Profit %;
                           NOR=Bruttofortjeneste-%;
                           SVE=Vinst %];
                ToolTipML=[ENU=Specifies the total profit of the sales order expressed as a percentage of the total amount.;
                           NOR=Angir den totale for tjenesten for ordren vist som prosentandel av totalbel›pet.;
                           SVE=Anger den totala vinsten f”r f”rs„ljningsordern uttryckt som en andel av totalbeloppet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=1:1;
                SourceExpr=ProfitPct[3];
                Importance=Additional;
                Editable=FALSE }

    { 99  ;2   ;Field     ;
                CaptionML=[ENU=Quantity;
                           NOR=Antall;
                           SVE=Antal];
                ToolTipML=[ENU=Specifies the total quantity of G/L account entries, items, and/or resources in the sales document. If the amount is rounded, because the Invoice Rounding check box is selected in the Sales & Receivables Setup window, this field will contain the quantity of items in the sales document plus one.;
                           NOR=Angir det totale antall finansposter, varer og/eller ressurser i salgsdokumentet. Hvis bel›pet avrundes fordi det er merket av for Fakturaavrunding i vinduet Salgsoppsett, inneholder feltet antall varer i salgsdokumentet pluss ‚n.;
                           SVE=Anger det totala antalet redovisningskontotransaktioner, artiklar och/eller resurser p† f”rs„ljningsordern. Om beloppet avrundas d„rf”r att kryssrutan Fakturaavrundning i f”nstret Konfiguration av f”rs„ljning och fordringar „r markerad, inneh†ller det h„r f„ltet antalet artiklar i f”rs„ljningsdokumentet plus ett.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[3].Quantity;
                Importance=Additional;
                Editable=FALSE }

    { 94  ;2   ;Field     ;
                CaptionML=[ENU=Parcels;
                           NOR=Kolli;
                           SVE=F”rpackningar];
                ToolTipML=[ENU=Specifies the total number of parcels in the sales document.;
                           NOR=Angir antall kolli i salgsdokumentet.;
                           SVE=Anger totalt antal f”rpackningar i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[3]."Units per Parcel";
                Importance=Additional;
                Editable=FALSE }

    { 98  ;2   ;Field     ;
                CaptionML=[ENU=Net Weight;
                           NOR=Nettovekt;
                           SVE=Nettovikt];
                ToolTipML=[ENU=Specifies the total net weight of the items in the sales document.;
                           NOR=Angir den totale nettovekten av varene i salgsdokumentet.;
                           SVE=Anger total nettovikt f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[3]."Net Weight";
                Importance=Additional;
                Editable=FALSE }

    { 97  ;2   ;Field     ;
                CaptionML=[ENU=Gross Weight;
                           NOR=Bruttovekt;
                           SVE=Bruttovikt];
                ToolTipML=[ENU=Specifies the total gross weight of the items in the sales document.;
                           NOR=Angir den totale bruttovekten av varene i salgsdokumentet.;
                           SVE=Anger total bruttovikt f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[3]."Gross Weight";
                Importance=Additional;
                Editable=FALSE }

    { 93  ;2   ;Field     ;
                CaptionML=[ENU=Volume;
                           NOR=Volum;
                           SVE=Volym];
                ToolTipML=[ENU=Specifies the total volume of the items in the sales document.;
                           NOR=Angir det totale volumet av varene i salgsdokumentet.;
                           SVE=Anger total volym f”r artiklarna i f”rs„ljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=TotalSalesLine[3]."Unit Volume";
                Importance=Additional;
                Editable=FALSE }

    { 127 ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=No. of Tax Lines;
                           NOR=Ant. mva-linjer;
                           SVE=Antal momsrader];
                ToolTipML=[ENU=Specifies the number of lines on the sales order that have VAT amounts.;
                           NOR=Angir antallet linjer p† ordren som har mva-bel›p.;
                           SVE=Anger antalet rader p† f”rs„ljningsordern som har momsbelopp.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempVATAmountLine3.COUNT;
                Importance=Additional;
                OnDrillDown=BEGIN
                              VATLinesDrillDown(TempVATAmountLine3,FALSE);
                            END;
                             }

    { 1900201301;1;Group  ;
                CaptionML=[ENU=Prepayment;
                           NOR=Forskudd;
                           SVE=F”rskottsbetalning] }

    { 95  ;2   ;Field     ;
                ApplicationArea=#Prepayments;
                SourceExpr=PrepmtTotalAmount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text006,FALSE);
                Editable=DynamicEditable;
                OnValidate=BEGIN
                             ActiveTab := ActiveTab::Prepayment;
                             UpdatePrepmtAmount;
                           END;
                            }

    { 115 ;2   ;Field     ;
                CaptionML=[ENU=Prepayment Amount Invoiced;
                           NOR=Fakturert forskuddsbel›p;
                           SVE=Fakturerad f”rskottsbetalning];
                ToolTipML=[ENU=Specifies how much has been invoiced as prepayment.;
                           NOR=Angir hvor mye som er fakturert som forskudd.;
                           SVE=Anger hur mycket som har fakturerats som f”rskottsbetalning.];
                ApplicationArea=#Prepayments;
                SourceExpr=PrepmtVATAmount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=FORMAT(PrepmtVATAmountText);
                Editable=FALSE }

    { 117 ;2   ;Field     ;
                ApplicationArea=#Prepayments;
                SourceExpr=PrepmtTotalAmount2;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text006,TRUE);
                Editable=FALSE }

    { 109 ;2   ;Field     ;
                ApplicationArea=#Prepayments;
                SourceExpr=TotalSalesLine[1]."Prepmt. Amt. Inv.";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text007,FALSE);
                Editable=FALSE }

    { 110 ;2   ;Field     ;
                ExtendedDatatype=Ratio;
                CaptionML=[ENU=Invoiced % of Prepayment Amt.;
                           NOR=Fakturert % av forskuddsbel›p;
                           SVE=Fakturerat i % av f”rskottsbetalning];
                ToolTipML=[ENU=Specifies Invoiced Percentage of Prepayment Amt.;
                           NOR=Angir fakturert prosentandel av forskuddsbel›p.;
                           SVE=Anger Fakturerat i % av f”rskottsbetalning.];
                ApplicationArea=#Prepayments;
                SourceExpr=PrepmtInvPct }

    { 107 ;2   ;Field     ;
                ApplicationArea=#Prepayments;
                SourceExpr=TotalSalesLine[1]."Prepmt Amt Deducted";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text008,FALSE);
                Editable=FALSE }

    { 108 ;2   ;Field     ;
                ExtendedDatatype=Ratio;
                CaptionML=[ENU=Deducted % of Prepayment Amt. to Deduct;
                           NOR=Fratrukket % av forskuddsbel›p til fradrag;
                           SVE=Avdraget i % av f”rskottsbetalning att dra av];
                ToolTipML=[ENU=Specifies the deducted percentage of the prepayment amount to deduct.;
                           NOR=Angir den fratrukkede prosentandelen av forskuddsbel›pet som skal trekkes fra.;
                           SVE=Anger avdraget i procent av f”rskottsbetalningen att dra av.];
                ApplicationArea=#Prepayments;
                SourceExpr=PrepmtDeductedPct }

    { 96  ;2   ;Field     ;
                ApplicationArea=#Prepayments;
                SourceExpr=TotalSalesLine[1]."Prepmt Amt to Deduct";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=GetCaptionClass(Text009,FALSE);
                Editable=FALSE }

    { 130 ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=No. of Tax Lines;
                           NOR=Ant. mva-linjer;
                           SVE=Antal momsrader];
                ToolTipML=[ENU=Specifies the number of lines on the sales order that have VAT amounts.;
                           NOR=Angir antallet linjer p† ordren som har mva-bel›p.;
                           SVE=Anger antalet rader p† f”rs„ljningsordern som har momsbelopp.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempVATAmountLine4.COUNT;
                OnDrillDown=BEGIN
                              VATLinesDrillDown(TempVATAmountLine4,TRUE);
                            END;
                             }

    { 1903289601;1;Group  ;
                CaptionML=[ENU=Customer;
                           NOR=Kunde;
                           SVE=Kund] }

    { 26  ;2   ;Field     ;
                CaptionML=[ENU=Balance (LCY);
                           NOR=Saldo (NOK);
                           SVE=Saldo (BVA)];
                ToolTipML=[ENU=Specifies the balance on the customer's account.;
                           NOR=Angir saldoen p† kundens konto.;
                           SVE=Anger saldot p† kundens konto.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cust."Balance (LCY)";
                AutoFormatType=1;
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                CaptionML=[ENU=Credit Limit (LCY);
                           NOR=Kredittgrense (NOK);
                           SVE=Kreditlimit (BVA)];
                ToolTipML=[ENU=Specifies the credit limit of the customer that you created the sales document for.;
                           NOR=Angir kredittgrensen for kunden som du opprettet salgsdokumentet for.;
                           SVE=Anger kreditlimiten i BVA f”r kunden du skapade f”rs„ljningsdokumentet f”r.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cust."Credit Limit (LCY)";
                AutoFormatType=1;
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                ExtendedDatatype=Ratio;
                CaptionML=[ENU=Expended % of Credit Limit (LCY);
                           NOR=Benyttet % av kredittgrense (NOK);
                           SVE=Kreditlimit utnyttjad % (BVA)];
                ToolTipML=[ENU=Specifies the expended percentage of the credit limit in (LCY).;
                           NOR=Angir den forventede prosenten for kredittgrensen i (NOK).;
                           SVE=Anger kreditlimitens utnyttjade procentandel (BVA).];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CreditLimitLCYExpendedPct }

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Sales %1 Statistics;NOR=Salgsstatistikk - %1;SVE=F”rs. %1 statistik';
      Text001@1001 : TextConst 'ENU=Total;NOR=I alt;SVE=Totalt';
      Text002@1002 : TextConst 'ENU=Amount;NOR=Bel›p;SVE=Belopp';
      Text003@1003 : TextConst 'ENU=%1 must not be 0.;NOR=%1 skal ikke v‘re 0.;SVE=%1 f†r inte vara 0.';
      Text004@1004 : TextConst 'ENU=%1 must not be greater than %2.;NOR=%1 skal ikke v‘re st›rre enn %2.;SVE=%1 f†r inte vara st”rre „n %2.';
      Text005@1005 : TextConst 'ENU=You cannot change the invoice discount because a customer invoice discount with the code %1 exists.;NOR=Du kan ikke endre fakturarabatten ettersom det finnes en kundefakturarabatt med koden %1.;SVE=Du kan inte „ndra fakturarabatten eftersom det finns en kundfakturarabatt med koden %1.';
      TotalSalesLine@1006 : ARRAY [3] OF Record 37;
      TotalSalesLineLCY@1007 : ARRAY [3] OF Record 37;
      Cust@1008 : Record 18;
      TempVATAmountLine1@1009 : TEMPORARY Record 290;
      TempVATAmountLine2@1010 : TEMPORARY Record 290;
      TempVATAmountLine3@1011 : TEMPORARY Record 290;
      TempVATAmountLine4@1034 : TEMPORARY Record 290;
      SalesSetup@1012 : Record 311;
      SalesPost@1013 : Codeunit 80;
      VATLinesForm@1032 : Page 9401;
      TotalAmount1@1014 : ARRAY [3] OF Decimal;
      TotalAmount2@1015 : ARRAY [3] OF Decimal;
      VATAmount@1016 : ARRAY [3] OF Decimal;
      PrepmtTotalAmount@1037 : Decimal;
      PrepmtVATAmount@1038 : Decimal;
      PrepmtTotalAmount2@1040 : Decimal;
      VATAmountText@1017 : ARRAY [3] OF Text[30];
      PrepmtVATAmountText@1039 : Text[30];
      ProfitLCY@1018 : ARRAY [3] OF Decimal;
      ProfitPct@1019 : ARRAY [3] OF Decimal;
      AdjProfitLCY@1031 : ARRAY [3] OF Decimal;
      AdjProfitPct@1030 : ARRAY [3] OF Decimal;
      TotalAdjCostLCY@1029 : ARRAY [3] OF Decimal;
      CreditLimitLCYExpendedPct@1020 : Decimal;
      PrepmtInvPct@1036 : Decimal;
      PrepmtDeductedPct@1035 : Decimal;
      i@1021 : Integer;
      PrevNo@1022 : Code[20];
      ActiveTab@1023 : 'General,Invoicing,Shipping,Prepayment';
      PrevTab@1024 : 'General,Invoicing,Shipping,Prepayment';
      VATLinesFormIsEditable@1026 : Boolean;
      AllowInvDisc@1027 : Boolean;
      AllowVATDifference@1028 : Boolean;
      Text006@1033 : TextConst 'ENU=Prepmt. Amount;NOR=Forskuddsbel›p;SVE=F”rskottsbetalning';
      Text007@1041 : TextConst 'ENU=Prepmt. Amt. Invoiced;NOR=Forskuddsbel›p fakturert;SVE=Fakturerad f”rskottsbetalning';
      Text008@1042 : TextConst 'ENU=Prepmt. Amt. Deducted;NOR=Fratrukket forskuddsbel›p;SVE=Avdragen f”rskottsbetalning';
      Text009@1043 : TextConst 'ENU=Prepmt. Amt. to Deduct;NOR=Forskuddsbel›p til fradrag;SVE=F”rskottsbetalning att dra av';
      DynamicEditable@1025 : Boolean;
      UpdateInvDiscountQst@1056 : TextConst 'ENU=One or more lines have been invoiced. The discount distributed to invoiced lines will not be taken into account.\\Do you want to update the invoice discount?;NOR=n eller flere linjer er fakturert. Det tas ikke hensyn til rabatt som er fordelt p† fakturerte linjer.\\Vil du oppdatere fakturarabatten?;SVE=En eller flera rader har fakturerats. Rabatten som f”rdelas p† de fakturerade raderna beaktas inte.\\Vill du uppdatera fakturarabatten?';
      DPA_IsHardFilter@1100000999 : Boolean;

    LOCAL PROCEDURE RefreshOnAfterGetRecord@10();
    VAR
      SalesLine@1003 : Record 37;
      TempSalesLine@1002 : TEMPORARY Record 37;
      SalesPostPrepayments@1001 : Codeunit 442;
    BEGIN
      CurrPage.CAPTION(STRSUBSTNO(Text000,"Document Type"));

      IF PrevNo = "No." THEN
        EXIT;
      PrevNo := "No.";
      FILTERGROUP(2);
      SETRANGE("No.",PrevNo);
      FILTERGROUP(0);

      CLEAR(SalesLine);
      CLEAR(TotalSalesLine);
      CLEAR(TotalSalesLineLCY);

      FOR i := 1 TO 3 DO BEGIN
        TempSalesLine.DELETEALL;
        CLEAR(TempSalesLine);
        CLEAR(SalesPost);
        SalesPost.GetSalesLines(Rec,TempSalesLine,i - 1);
        CLEAR(SalesPost);
        CASE i OF
          1:
            SalesLine.CalcVATAmountLines(0,Rec,TempSalesLine,TempVATAmountLine1);
          2:
            SalesLine.CalcVATAmountLines(0,Rec,TempSalesLine,TempVATAmountLine2);
          3:
            SalesLine.CalcVATAmountLines(0,Rec,TempSalesLine,TempVATAmountLine3);
        END;

        SalesPost.SumSalesLinesTemp(
          Rec,TempSalesLine,i - 1,TotalSalesLine[i],TotalSalesLineLCY[i],
          VATAmount[i],VATAmountText[i],ProfitLCY[i],ProfitPct[i],TotalAdjCostLCY[i]);

        IF i = 3 THEN
          TotalAdjCostLCY[i] := TotalSalesLineLCY[i]."Unit Cost (LCY)";

        AdjProfitLCY[i] := TotalSalesLineLCY[i].Amount - TotalAdjCostLCY[i];
        IF TotalSalesLineLCY[i].Amount <> 0 THEN
          AdjProfitPct[i] := ROUND(AdjProfitLCY[i] / TotalSalesLineLCY[i].Amount * 100,0.1);

        IF "Prices Including VAT" THEN BEGIN
          TotalAmount2[i] := TotalSalesLine[i].Amount;
          TotalAmount1[i] := TotalAmount2[i] + VATAmount[i];
          TotalSalesLine[i]."Line Amount" := TotalAmount1[i] + TotalSalesLine[i]."Inv. Discount Amount";
        END ELSE BEGIN
          TotalAmount1[i] := TotalSalesLine[i].Amount;
          TotalAmount2[i] := TotalSalesLine[i]."Amount Including VAT";
        END;
      END;
      TempSalesLine.DELETEALL;
      CLEAR(TempSalesLine);
      SalesPostPrepayments.GetSalesLines(Rec,0,TempSalesLine);
      SalesPostPrepayments.SumPrepmt(
        Rec,TempSalesLine,TempVATAmountLine4,PrepmtTotalAmount,PrepmtVATAmount,PrepmtVATAmountText);
      PrepmtInvPct :=
        Pct(TotalSalesLine[1]."Prepmt. Amt. Inv.",PrepmtTotalAmount);
      PrepmtDeductedPct :=
        Pct(TotalSalesLine[1]."Prepmt Amt Deducted",TotalSalesLine[1]."Prepmt. Amt. Inv.");
      IF "Prices Including VAT" THEN BEGIN
        PrepmtTotalAmount2 := PrepmtTotalAmount;
        PrepmtTotalAmount := PrepmtTotalAmount + PrepmtVATAmount;
      END ELSE
        PrepmtTotalAmount2 := PrepmtTotalAmount + PrepmtVATAmount;

      IF Cust.GET("Bill-to Customer No.") THEN
        Cust.CALCFIELDS("Balance (LCY)")
      ELSE
        CLEAR(Cust);

      CASE TRUE OF
        Cust."Credit Limit (LCY)" = 0:
          CreditLimitLCYExpendedPct := 0;
        Cust."Balance (LCY)" / Cust."Credit Limit (LCY)" < 0:
          CreditLimitLCYExpendedPct := 0;
        Cust."Balance (LCY)" / Cust."Credit Limit (LCY)" > 1:
          CreditLimitLCYExpendedPct := 10000;
        ELSE
          CreditLimitLCYExpendedPct := ROUND(Cust."Balance (LCY)" / Cust."Credit Limit (LCY)" * 10000,1);
      END;

      TempVATAmountLine1.MODIFYALL(Modified,FALSE);
      TempVATAmountLine2.MODIFYALL(Modified,FALSE);
      TempVATAmountLine3.MODIFYALL(Modified,FALSE);
      TempVATAmountLine4.MODIFYALL(Modified,FALSE);

      PrevTab := -1;

      UpdateHeaderInfo(2,TempVATAmountLine2);
    END;

    LOCAL PROCEDURE UpdateHeaderInfo@5(IndexNo@1000 : Integer;VAR VATAmountLine@1001 : Record 290);
    VAR
      CurrExchRate@1002 : Record 330;
      UseDate@1003 : Date;
    BEGIN
      TotalSalesLine[IndexNo]."Inv. Discount Amount" := VATAmountLine.GetTotalInvDiscAmount;
      TotalAmount1[IndexNo] :=
        TotalSalesLine[IndexNo]."Line Amount" - TotalSalesLine[IndexNo]."Inv. Discount Amount";
      VATAmount[IndexNo] := VATAmountLine.GetTotalVATAmount;
      IF "Prices Including VAT" THEN BEGIN
        TotalAmount1[IndexNo] := VATAmountLine.GetTotalAmountInclVAT;
        TotalAmount2[IndexNo] := TotalAmount1[IndexNo] - VATAmount[IndexNo];
        TotalSalesLine[IndexNo]."Line Amount" :=
          TotalAmount1[IndexNo] + TotalSalesLine[IndexNo]."Inv. Discount Amount";
      END ELSE
        TotalAmount2[IndexNo] := TotalAmount1[IndexNo] + VATAmount[IndexNo];

      IF "Prices Including VAT" THEN
        TotalSalesLineLCY[IndexNo].Amount := TotalAmount2[IndexNo]
      ELSE
        TotalSalesLineLCY[IndexNo].Amount := TotalAmount1[IndexNo];
      IF "Currency Code" <> '' THEN
        IF "Posting Date" = 0D THEN
          UseDate := WORKDATE
        ELSE
          UseDate := "Posting Date";

      TotalSalesLineLCY[IndexNo].Amount :=
        CurrExchRate.ExchangeAmtFCYToLCY(
      //  UseDate,"Currency Code",TotalSalesLineLCY[IndexNo].Amount,"Currency Factor"); //**4PS.o
          0, '',UseDate,"Currency Code",TotalSalesLineLCY[IndexNo].Amount,"Currency Factor",TRUE); //**4PS.n

      ProfitLCY[IndexNo] := TotalSalesLineLCY[IndexNo].Amount - TotalSalesLineLCY[IndexNo]."Unit Cost (LCY)";
      IF TotalSalesLineLCY[IndexNo].Amount = 0 THEN
        ProfitPct[IndexNo] := 0
      ELSE
        ProfitPct[IndexNo] := ROUND(100 * ProfitLCY[IndexNo] / TotalSalesLineLCY[IndexNo].Amount,0.01);

      AdjProfitLCY[IndexNo] := TotalSalesLineLCY[IndexNo].Amount - TotalAdjCostLCY[IndexNo];
      IF TotalSalesLineLCY[IndexNo].Amount = 0 THEN
        AdjProfitPct[IndexNo] := 0
      ELSE
        AdjProfitPct[IndexNo] := ROUND(100 * AdjProfitLCY[IndexNo] / TotalSalesLineLCY[IndexNo].Amount,0.01);
    END;

    LOCAL PROCEDURE GetVATSpecification@21(QtyType@1000 : 'General,Invoicing,Shipping');
    BEGIN
      CASE QtyType OF
        QtyType::General:
          BEGIN
            VATLinesForm.GetTempVATAmountLine(TempVATAmountLine1);
            UpdateHeaderInfo(1,TempVATAmountLine1);
          END;
        QtyType::Invoicing:
          BEGIN
            VATLinesForm.GetTempVATAmountLine(TempVATAmountLine2);
            UpdateHeaderInfo(2,TempVATAmountLine2);
          END;
        QtyType::Shipping:
          VATLinesForm.GetTempVATAmountLine(TempVATAmountLine3);
      END;
    END;

    LOCAL PROCEDURE UpdateTotalAmount@16(IndexNo@1000 : Integer);
    VAR
      SaveTotalAmount@1001 : Decimal;
    BEGIN
      CheckAllowInvDisc;
      IF "Prices Including VAT" THEN BEGIN
        SaveTotalAmount := TotalAmount1[IndexNo];
        UpdateInvDiscAmount(IndexNo);
        TotalAmount1[IndexNo] := SaveTotalAmount;
      END;

      WITH TotalSalesLine[IndexNo] DO
        "Inv. Discount Amount" := "Line Amount" - TotalAmount1[IndexNo];
      UpdateInvDiscAmount(IndexNo);
    END;

    LOCAL PROCEDURE UpdateInvDiscAmount@3(ModifiedIndexNo@1000 : Integer);
    VAR
      ConfirmManagement@1006 : Codeunit 27;
      PartialInvoicing@1001 : Boolean;
      MaxIndexNo@1002 : Integer;
      IndexNo@1003 : ARRAY [2] OF Integer;
      i@1004 : Integer;
      InvDiscBaseAmount@1005 : Decimal;
    BEGIN
      CheckAllowInvDisc;
      IF NOT (ModifiedIndexNo IN [1,2]) THEN
        EXIT;

      IF InvoicedLineExists THEN
        IF NOT ConfirmManagement.ConfirmProcess(UpdateInvDiscountQst,TRUE) THEN
          ERROR('');

      IF ModifiedIndexNo = 1 THEN
        InvDiscBaseAmount := TempVATAmountLine1.GetTotalInvDiscBaseAmount(FALSE,"Currency Code")
      ELSE
        InvDiscBaseAmount := TempVATAmountLine2.GetTotalInvDiscBaseAmount(FALSE,"Currency Code");

      IF InvDiscBaseAmount = 0 THEN
        ERROR(Text003,TempVATAmountLine2.FIELDCAPTION("Inv. Disc. Base Amount"));

      IF TotalSalesLine[ModifiedIndexNo]."Inv. Discount Amount" / InvDiscBaseAmount > 1 THEN
        ERROR(
          Text004,
          TotalSalesLine[ModifiedIndexNo].FIELDCAPTION("Inv. Discount Amount"),
          TempVATAmountLine2.FIELDCAPTION("Inv. Disc. Base Amount"));

      PartialInvoicing := (TotalSalesLine[1]."Line Amount" <> TotalSalesLine[2]."Line Amount");

      IndexNo[1] := ModifiedIndexNo;
      IndexNo[2] := 3 - ModifiedIndexNo;
      IF (ModifiedIndexNo = 2) AND PartialInvoicing THEN
        MaxIndexNo := 1
      ELSE
        MaxIndexNo := 2;

      IF NOT PartialInvoicing THEN
        IF ModifiedIndexNo = 1 THEN
          TotalSalesLine[2]."Inv. Discount Amount" := TotalSalesLine[1]."Inv. Discount Amount"
        ELSE
          TotalSalesLine[1]."Inv. Discount Amount" := TotalSalesLine[2]."Inv. Discount Amount";

      FOR i := 1 TO MaxIndexNo DO
        WITH TotalSalesLine[IndexNo[i]] DO BEGIN
          IF (i = 1) OR NOT PartialInvoicing THEN
            IF IndexNo[i] = 1 THEN BEGIN
              TempVATAmountLine1.SetInvoiceDiscountAmount(
                "Inv. Discount Amount","Currency Code","Prices Including VAT","VAT Base Discount %");
            END ELSE
              TempVATAmountLine2.SetInvoiceDiscountAmount(
                "Inv. Discount Amount","Currency Code","Prices Including VAT","VAT Base Discount %");

          IF (i = 2) AND PartialInvoicing THEN
            IF IndexNo[i] = 1 THEN BEGIN
              InvDiscBaseAmount := TempVATAmountLine2.GetTotalInvDiscBaseAmount(FALSE,"Currency Code");
              IF InvDiscBaseAmount = 0 THEN
                TempVATAmountLine1.SetInvoiceDiscountPercent(
                  0,"Currency Code","Prices Including VAT",FALSE,"VAT Base Discount %")
              ELSE
                TempVATAmountLine1.SetInvoiceDiscountPercent(
                  100 * TempVATAmountLine2.GetTotalInvDiscAmount / InvDiscBaseAmount,
                  "Currency Code","Prices Including VAT",FALSE,"VAT Base Discount %");
            END ELSE BEGIN
              InvDiscBaseAmount := TempVATAmountLine1.GetTotalInvDiscBaseAmount(FALSE,"Currency Code");
              IF InvDiscBaseAmount = 0 THEN
                TempVATAmountLine2.SetInvoiceDiscountPercent(
                  0,"Currency Code","Prices Including VAT",FALSE,"VAT Base Discount %")
              ELSE
                TempVATAmountLine2.SetInvoiceDiscountPercent(
                  100 * TempVATAmountLine1.GetTotalInvDiscAmount / InvDiscBaseAmount,
                  "Currency Code","Prices Including VAT",FALSE,"VAT Base Discount %");
            END;
        END;

      UpdateHeaderInfo(1,TempVATAmountLine1);
      UpdateHeaderInfo(2,TempVATAmountLine2);

      IF ModifiedIndexNo = 1 THEN
        VATLinesForm.SetTempVATAmountLine(TempVATAmountLine1)
      ELSE
        VATLinesForm.SetTempVATAmountLine(TempVATAmountLine2);

      "Invoice Discount Calculation" := "Invoice Discount Calculation"::Amount;
      "Invoice Discount Value" := TotalSalesLine[1]."Inv. Discount Amount";
      MODIFY;

      UpdateVATOnSalesLines;
    END;

    LOCAL PROCEDURE UpdatePrepmtAmount@9();
    VAR
      TempSalesLine@1001 : TEMPORARY Record 37;
      SalesPostPrepmt@1000 : Codeunit 442;
    BEGIN
      SalesPostPrepmt.UpdatePrepmtAmountOnSaleslines(Rec,PrepmtTotalAmount);
      SalesPostPrepmt.GetSalesLines(Rec,0,TempSalesLine);
      SalesPostPrepmt.SumPrepmt(
        Rec,TempSalesLine,TempVATAmountLine4,PrepmtTotalAmount,PrepmtVATAmount,PrepmtVATAmountText);
      PrepmtInvPct :=
        Pct(TotalSalesLine[1]."Prepmt. Amt. Inv.",PrepmtTotalAmount);
      PrepmtDeductedPct :=
        Pct(TotalSalesLine[1]."Prepmt Amt Deducted",TotalSalesLine[1]."Prepmt. Amt. Inv.");
      IF "Prices Including VAT" THEN BEGIN
        PrepmtTotalAmount2 := PrepmtTotalAmount;
        PrepmtTotalAmount := PrepmtTotalAmount + PrepmtVATAmount;
      END ELSE
        PrepmtTotalAmount2 := PrepmtTotalAmount + PrepmtVATAmount;
      MODIFY;
    END;

    LOCAL PROCEDURE GetCaptionClass@2(FieldCaption@1000 : Text[100];ReverseCaption@1001 : Boolean) : Text[80];
    BEGIN
      IF "Prices Including VAT" XOR ReverseCaption THEN
        EXIT('2,1,' + FieldCaption);
      EXIT('2,0,' + FieldCaption);
    END;

    LOCAL PROCEDURE UpdateVATOnSalesLines@1();
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      GetVATSpecification(ActiveTab);
      IF TempVATAmountLine1.GetAnyLineModified THEN
        SalesLine.UpdateVATOnLines(0,Rec,SalesLine,TempVATAmountLine1);
      IF TempVATAmountLine2.GetAnyLineModified THEN
        SalesLine.UpdateVATOnLines(1,Rec,SalesLine,TempVATAmountLine2);
      PrevNo := '';
    END;

    LOCAL PROCEDURE CustInvDiscRecExists@4(InvDiscCode@1000 : Code[20]) : Boolean;
    VAR
      CustInvDisc@1001 : Record 19;
    BEGIN
      CustInvDisc.SETRANGE(Code,InvDiscCode);
      EXIT(CustInvDisc.FINDFIRST);
    END;

    LOCAL PROCEDURE CheckAllowInvDisc@8();
    BEGIN
      IF NOT AllowInvDisc THEN
        ERROR(Text005,"Invoice Disc. Code");
    END;

    LOCAL PROCEDURE Pct@6(Numerator@1001 : Decimal;Denominator@1000 : Decimal) : Decimal;
    BEGIN
      IF Denominator = 0 THEN
        EXIT(0);
      EXIT(ROUND(Numerator / Denominator * 10000,1));
    END;

    LOCAL PROCEDURE VATLinesDrillDown@7(VAR VATLinesToDrillDown@1000 : Record 290;ThisTabAllowsVATEditing@1001 : Boolean);
    BEGIN
      CLEAR(VATLinesForm);
      VATLinesForm.SetTempVATAmountLine(VATLinesToDrillDown);
      VATLinesForm.InitGlobals(
        "Currency Code",AllowVATDifference,AllowVATDifference AND ThisTabAllowsVATEditing,
        "Prices Including VAT",AllowInvDisc,"VAT Base Discount %");
      VATLinesForm.RUNMODAL;
      VATLinesForm.GetTempVATAmountLine(VATLinesToDrillDown);
    END;

    LOCAL PROCEDURE TotalAmount21OnAfterValidate@19074760();
    BEGIN
      WITH TotalSalesLine[1] DO BEGIN
        IF "Prices Including VAT" THEN
          "Inv. Discount Amount" := "Line Amount" - "Amount Including VAT"
        ELSE
          "Inv. Discount Amount" := "Line Amount" - Amount;
      END;
      UpdateInvDiscAmount(1);
    END;

    [Integration]
    LOCAL PROCEDURE OnOpenPageOnBeforeSetEditable@11(VAR AllowInvDisc@1000 : Boolean;VAR AllowVATDifference@1001 : Boolean);
    BEGIN
    END;

    BEGIN
    END.
  }
}

