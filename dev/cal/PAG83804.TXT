OBJECT Page 83804 Posted Sales Cred.Memo Netting
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW110.00,4PS10.00,NAVDK.NO,4PSSE;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Posted Sales Credit Memos;
               NOR=Bokfõrte salgskreditnotaer;
               SVE=Bokfîrda fîrsÑljningskreditnotor];
    ApplicationArea=#Basic,#Suite;
    SourceTable=Table114;
    SourceTableView=SORTING(Posting Date)
                    ORDER(Descending);
    PageType=List;
    UsageCategory=History;
    CardPageID=Posted Sales Credit Memo;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Credit Memo,Cancel;
                                NOR=Ny,Prosess,Rapport,Kreditnota,Avbryt;
                                SVE=Ny,Bearbeta,Rapport,Kreditnota,Annullera];
    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 IF FINDFIRST THEN;
                 IsOfficeAddin := OfficeMgt.IsPopOut;

                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 //4PSSE.DK.NO
                 GLSetup.GET;
                 NORlocalizationEnable := GLSetup."Norwegian Localization Active";
                 DKinfoEnable := GLSetup."Danish Localization Active";
               END;

    OnAfterGetRecord=VAR
                       SalesCrMemoHeader@1000 : Record 114;
                     BEGIN
                       DocExchStatusStyle := GetDocExchStatusStyle;

                       SalesCrMemoHeader.COPYFILTERS(Rec);
                       SalesCrMemoHeader.SETFILTER("Document Exchange Status",'<>%1',"Document Exchange Status"::"Not Sent");
                       DocExchStatusVisible := NOT SalesCrMemoHeader.ISEMPTY;
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnAfterGetCurrRecord=BEGIN
                           DocExchStatusStyle := GetDocExchStatusStyle;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 19      ;1   ;ActionGroup;
                      Name=InvoiceButton;
                      CaptionML=[ENU=&Credit Memo;
                                 NOR=&Kreditnota;
                                 SVE=&Kreditnota];
                      Image=CreditMemo }
      { 26      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort;
                                 SVE=Kort];
                      ToolTipML=[NOR=èpne den bokfõrte salgskreditnotaen.;
                                 SVE=ôppna den bokfîrda fîrsÑljningskreditnotan.];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Posted Sales Credit Memo",Rec)
                               END;
                                }
      { 31      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      RunObject=Page 398;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category4 }
      { 32      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      RunObject=Page 67;
                      RunPageLink=Document Type=CONST(Posted Credit Memo),
                                  No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category4 }
      { 1102601000;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera dimensioner, till exempel omrÜde, projekt eller avdelning, som du kan tilldela fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1060000 ;2   ;Separator  }
      { 1060001 ;2   ;Action    ;
                      CaptionML=ENU=Create Electronic Credit Memo DK;
                      ToolTipML=[ENU=Create an electronic version of the current document.;
                                 SVE=Skapa en elektronisk version av detta dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=DKinfoEnable;
                      Image=ElectronicDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesCrMemoHeader@1060001 : Record 114;
                               BEGIN
                                 SalesCrMemoHeader := Rec;
                                 SalesCrMemoHeader.SETRECFILTER;

                                 REPORT.RUNMODAL(REPORT::"Create DK Elec. Credit Memos", TRUE, FALSE, SalesCrMemoHeader);
                               END;
                                }
      { 1100583000;2 ;Action    ;
                      CaptionML=[ENU=Remove Nettingflag;
                                 SVE=Tabort Nettingbock];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 NettingMGM@1100583000 : Codeunit 83801;
                               BEGIN
                                 NettingMGM.NettingRemoveExportedCrMemoBoolean(Rec);
                               END;
                                }
      { 10      ;2   ;Action    ;
                      Name=IncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument];
                      ToolTipML=[ENU=View or create an incoming document record that is linked to the entry or document.;
                                 NOR=Viser eller oppretter en post for innkommende dokument som er koblet til oppfõringen eller dokumentet.;
                                 SVE=Visa eller skapa en inkommande dokumentpost som Ñr lÑnkad till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 12      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Customer;
                                 NOR=Kunde;
                                 SVE=Kund];
                      ToolTipML=[ENU=View or edit detailed information about the customer.;
                                 NOR=Vis eller rediger detaljert informasjon om kunden.;
                                 SVE=Visa eller redigera detaljerad information om kunden.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Sell-to Customer No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Customer;
                      PromotedCategory=Category4;
                      Scope=Repeater }
      { 25      ;2   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger;
                                 SVE=Anal&ysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected posted sales document.;
                                 NOR=Finner alle poster og dokumenter for dokumentnummeret og bokfõringsdatoen i det valgte bokfõrte salgsdokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet pÜ det valda bokfîrda fîrsÑljningsdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 36      ;1   ;ActionGroup;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Annullera] }
      { 28      ;2   ;Action    ;
                      Name=CancelCrMemo;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Annullera];
                      ToolTipML=[ENU=Create and post a sales invoice that reverses this posted sales credit memo. This posted sales credit memo will be canceled.;
                                 NOR=Opprett og bokfõr en salgsfaktura som tilbakefõrer denne bokfõrte salgskreditnotaen. Denne bokfõrte salgskreditnotaen vil bli annullert.;
                                 SVE=Skapa och bokfîr en fîrsÑljningsfaktura som Üterfîr den hÑr bokfîrda fîrsÑljningskreditnotan. Den bokfîrda fîrsÑljningskreditnotan gÜr inte att annullera.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category5;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Cancel PstdSalesCrM (Yes/No)",Rec);
                               END;
                                }
      { 24      ;2   ;Action    ;
                      Name=ShowInvoice;
                      CaptionML=[ENU=Show Canceled/Corrective Invoice;
                                 NOR=Vis annullert/korrigerende faktura;
                                 SVE=Visa annullerad/korrigerande faktura];
                      ToolTipML=[ENU=Open the posted sales invoice that was created when you canceled the posted sales credit memo. If the posted sales credit memo is the result of a canceled sales invoice, then canceled invoice will open.;
                                 NOR=èpne den bokfõrte salgsfakturaen som ble opprettet da du kansellerte den bokfõrte salgskreditnotaen. Hvis den bokfõrte salgskreditnotaen er et resultat av den kansellerte salgsfakturaen, sÜ vil den kansellerte fakturaen bli Üpnet.;
                                 SVE=ôppna den bokfîrda fîrsÑljningsfakturan som skapades nÑr du annullerade den bokfîrda fîrsÑljningskreditnotan. Om den bokfîrda fîrsÑljningskreditnotan Ñr resultatet av en annullerad fîrsÑljningsfaktura, îppnas den annullerade fakturan.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=Cancelled OR Corrective;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Category5;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrInvoice;
                               END;
                                }
      { 98      ;1   ;ActionGroup;
                      CaptionML=[ENU=Send;
                                 NOR=Send;
                                 SVE=Skicka] }
      { 1100485925;2 ;ActionGroup;
                      CaptionML=[ENU=Complaint Managemant;
                                 SVE=KlagomÜlshantering];
                      Image=ReminderTerms }
      { 1100485927;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create New Complaint;
                                 SVE=Skapa nytt klagomÜl];
                      Image=NewDocument;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 lvComplMgtCU.CreateNewComplaintOnDocument(lvComplDocRec."Document Type"::"PM-S", "No.");
                               END;
                                }
      { 1100485928;3 ;Action    ;
                      CaptionML=[ENU=Open Complaints;
                                 SVE=ôppna klagomÜl];
                      Image=Reminder;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"PM-S", "No.", TRUE);
                               END;
                                }
      { 1100485929;3 ;Action    ;
                      CaptionML=[ENU=Complaints;
                                 SVE=KlagomÜl];
                      Image=ReminderTerms;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"PM-S", "No.", FALSE);
                               END;
                                }
      { 1100525006;1 ;ActionGroup;
                      Name=PdfXmlButton;
                      CaptionML=[ENU=&PDF/XML;
                                 SVE=&PDF/XML] }
      { 1100525007;2 ;Action    ;
                      CaptionML=[ENU=PDF - &Release;
                                 SVE=PDF Õ &slÑpp];
                      Image=SendEmailPDFNoAttach;
                      OnAction=BEGIN
                                 PDFSetSendOK();
                               END;
                                }
      { 1100525008;2 ;Action    ;
                      CaptionML=[ENU=PDF - &Undo Release;
                                 SVE=PDF Õ Ü&ngra slÑpp];
                      Image=SendEmailPDFNoAttach;
                      OnAction=BEGIN
                                 PDFResetSendOK();
                               END;
                                }
      { 1100525009;2 ;Action    ;
                      CaptionML=[ENU=XML - R&elease;
                                 SVE=XML Õ Sl&Ñpp];
                      Image=Document;
                      OnAction=BEGIN
                                 XMLSetExport();
                               END;
                                }
      { 1100525010;2 ;Action    ;
                      CaptionML=[ENU=XML - U&ndo Release;
                                 SVE=XML Õ è&ngra slÑpp];
                      Image=Document;
                      OnAction=BEGIN
                                 XMLResetExport();
                               END;
                                }
      { 1100525012;2 ;Action    ;
                      CaptionML=[ENU=PDF - Send;
                                 SVE=PDF Õ skicka];
                      Image=SendEmailPDFNoAttach;
                      OnAction=BEGIN
                                 PDFSend();
                               END;
                                }
      { 1100525013;2 ;Action    ;
                      CaptionML=[ENU=XML - Export;
                                 SVE=XML Õ Exportera];
                      Image=Document;
                      OnAction=BEGIN
                                 XMLExport();
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=SendCustom;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send;
                                 NOR=Send;
                                 SVE=Skicka];
                      ToolTipML=[ENU=Prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens where you can confirm or select a sending profile.;
                                 NOR=Klargjõr for Ü sende dokumentet i henhold til kundens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til Üpnes der du kan bekrefte eller velge en sendingsprofil.;
                                 SVE=Fîrbered att skicka dokumentet enligt kundens utskicksprofil, t.ex. som bilaga till ett e-postmeddelande. Fînstret Skicka dokument till îppnas dÑr det gÜr att bekrÑfta eller vÑlja en utskicksprofil.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NewDocumentReportingVisible;
                      PromotedIsBig=Yes;
                      Image=SendToMultiple;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=VAR
                                 SalesCrMemoHeader@1000 : Record 114;
                               BEGIN
                                 SalesCrMemoHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);
                                 SalesCrMemoHeader.SendRecords;
                               END;
                                }
      { 20      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut;
                                 SVE=Skriv &ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargjõr for Ü skrive ut dokumentet. Det vises et rapportforespõrselsvindu for dokumentet der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Fîrbered utskrift av dokumentet. Ett rapportfînster om dokumentet îppnas dÑr det gÜr att ange vad du vill inkludera pÜ utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      Scope=Repeater;
                      OnAction=VAR
                                 SalesCrMemoHeader@1102 : Record 114;
                               BEGIN
                                 SalesCrMemoHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);
                                 SalesCrMemoHeader.PrintRecords(TRUE);
                               END;
                                }
      { 3       ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send by &Email;
                                 NOR=Send via &e-post;
                                 SVE=Skicka med &e-post];
                      ToolTipML=[ENU=Prepare to send the document by email. The Send Email window opens prefilled for the customer where you can add or change information before you send the email.;
                                 NOR=Klargjõr for Ü sende dokumentet via e-post. Vinduet Send e-post Üpnes forhÜndsutfylt for kunder, der du kan legge til eller endre informasjon fõr du sender e-posten.;
                                 SVE=Fîrbered att skicka dokumentet per e-post. Fînstret Skicka e-post îppnas. Kundens uppgifter Ñr ifyllda, men det gÜr att lÑgga till eller Ñndra information innan du skickar meddelandet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Email;
                      Scope=Repeater;
                      OnAction=VAR
                                 SalesCrMemoHeader@1000 : Record 114;
                               BEGIN
                                 SalesCrMemoHeader := Rec;
                                 //CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader); //**4PS.o
                                 SalesCrMemoHeader.SETRECFILTER; //**4PS.n
                                 SalesCrMemoHeader.EmailRecords(TRUE);
                               END;
                                }
      { 1080001 ;1   ;Action    ;
                      CaptionML=[ENU=Create NO Electronic Credit Memo;
                                 NOR=Opprett elektronisk kreditnota;
                                 SVE=Skapa NO elektronisk kreditnot];
                      ToolTipML=NOR=Opprett ett eller flere XML-dokumenter som du kan sende til kunden. Du kan kjõre kjõrselen for flere kreditnotaer, eller du kan kjõre den for Çn kreditnota. Bilagsnummeret brukes som filnavn. Filene lagres pÜ lokasjonen som er angitt i vinduet Salgsoppsett.;
                      ApplicationArea=#Basic,#Suite;
                      Visible=NORlocalizationEnable;
                      Image=CreateDocument;
                      OnAction=VAR
                                 SalesCrMemoHeader@1060001 : Record 114;
                               BEGIN
                                 SalesCrMemoHeader := Rec;
                                 SalesCrMemoHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Create NO Elec. Credit Memos",TRUE,FALSE,SalesCrMemoHeader);
                               END;
                                }
      { 1100285002;1 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Svefaktura;
                                 SVE=Skapa svefaktura];
                      Promoted=Yes;
                      Image=ElectronicDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesCrMemoHeader@1100285501 : Record 114;
                                 SalesRecSetup@1100285000 : Record 311;
                                 ExportSvefaktura@1100285504 : Codeunit 11128055;
                                 lvSalesCrMemoHeader@1100285503 : Record 114;
                                 iCount@1100285502 : Integer;
                                 iAlreadyCreated@1100285500 : Integer;
                               BEGIN
                                 // RFC001
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);

                                 //>> 190604 ORANGO.FH #24479
                                 SalesRecSetup.GET();
                                 IF SalesRecSetup."Svefaktura Cr.Memo Report No." <> 0 THEN BEGIN
                                   REPORT.RUNMODAL(SalesRecSetup."Svefaktura Cr.Memo Report No.", TRUE, FALSE, SalesCrMemoHeader);
                                 END ELSE
                                 IF SalesCrMemoHeader.FINDFIRST THEN BEGIN
                                   IF SalesCrMemoHeader."Invoice Exported by XML" THEN
                                     IF NOT CONFIRM(STRSUBSTNO(txtSendAlreadyCreated, '1') ) THEN
                                       EXIT;

                                   SalesCrMemoHeader.SendCreditMemoElectronic(FALSE,FALSE);
                                 END;

                                 // SalesRecSetup.GET();
                                 // REPORT.RUNMODAL(SalesRecSetup."Svefaktura Cr.Memo Report No.", TRUE, FALSE, SalesCrMemoHeader);
                                 //<< 190604


                                 // //4PSSE.sn 161202
                                 // CurrPage.SETSELECTIONFILTER(lvSalesCrMemoHeader);
                                 // iCount := lvSalesCrMemoHeader.COUNT;
                                 // lvSalesCrMemoHeader.SETFILTER("Electronic Invoicing", '<>%1', lvSalesCrMemoHeader."Electronic Invoicing"::"Svefaktura (XML)");
                                 //
                                 // IF (lvSalesCrMemoHeader.COUNT > 0) THEN IF NOT (CONFIRM(txtSendAllInvoices, FALSE, lvSalesCrMemoHeader.COUNT, iCount)) THEN EXIT;
                                 //
                                 // lvSalesCrMemoHeader.SETFILTER("Electronic Invoicing", '%1', lvSalesCrMemoHeader."Electronic Invoicing"::"Svefaktura (XML)");
                                 //
                                 // // 140909 ITERO.MH ENH042 <<
                                 // IF (lvSalesCrMemoHeader.FINDSET(FALSE)) THEN REPEAT
                                 //   IF (lvSalesCrMemoHeader."Electronic Credit Memo Created") THEN iAlreadyCreated +=1;
                                 // UNTIL lvSalesCrMemoHeader.NEXT = 0;
                                 //
                                 // IF (iAlreadyCreated > 0) THEN IF NOT (CONFIRM(txtSendAlreadyCreated, TRUE, iAlreadyCreated)) THEN EXIT;
                                 // // 140909 ITERO.MH ENH042 >>
                                 //
                                 // //ExportSvefaktura.CreateSveSalesCreditMemo(lvSalesCrMemoHeader);   //4PSSE.o
                                 // CODEUNIT.RUN(11128034,lvSalesCrMemoHeader);                        //4PSSE.n
                                 // MESSAGE(txtSvefakturaCreated, lvSalesCrMemoHeader.COUNT);
                                 // //4PSSE.en 161202
                               END;
                                }
      { 9       ;1   ;Action    ;
                      Name=ActivityLog;
                      CaptionML=[ENU=Activity Log;
                                 NOR=Aktivitetslogg;
                                 SVE=Aktivitetslogg];
                      ToolTipML=[ENU=View the status and any errors if the document was sent as an electronic document or OCR file through the document exchange service.;
                                 NOR=Vis statusen og eventuelle feilmeldinger hvis dokumentet ble sendt som et elektronisk dokument eller OCR-fil via dokumentutvekslingstjenesten.;
                                 SVE=Visa status och eventuella fel om dokumentet skickades som ett elektroniskt dokument eller som OCR-fil med dokumentutbytestjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Log;
                      OnAction=BEGIN
                                 ShowActivityLog;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted credit memo number.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#All;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer number associated with the credit memo.;
                           NOR=Angir nummeret for kunden.;
                           SVE=Anger kundens nummer.];
                SourceExpr="Sell-to Customer No." }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Customer Name;
                           NOR=Kundenavn;
                           SVE=Kundens namn];
                ToolTipML=[ENU=Specifies the name of the customer that you shipped the items on the credit memo to.;
                           NOR=Angir navnet pÜ kunden som varene i kreditnotaen er levert til.;
                           SVE=Anger namnet pÜ kunden som du levererade kreditnotans artiklar till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name" }

    { 1100525000;2;Field  ;
                SourceExpr="Sell-to Customer Name 2";
                Visible=FALSE }

    { 1100485921;2;Field  ;
                SourceExpr="Open Complaints";
                Visible=FALSE;
                OnDrillDown=VAR
                              lvComplDocRec@1100485002 : Record 11012457;
                              lvComplMgtCU@1100485001 : Codeunit 11012418;
                            BEGIN
                              //**4PS
                              lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"PM-S", "No.", TRUE);
                            END;
                             }

    { 1100485923;2;Field  ;
                SourceExpr=Complaints;
                Visible=FALSE;
                OnDrillDown=VAR
                              lvComplDocRec@1100485002 : Record 11012457;
                              lvComplMgtCU@1100485001 : Codeunit 11012418;
                            BEGIN
                              //**4PS
                              lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"PM-S", "No.", FALSE);
                            END;
                             }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code of the credit memo.;
                           NOR=Angir valutakoden for kreditnotaen.;
                           SVE=Anger kreditnotans valutakod.];
                SourceExpr="Currency Code" }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the shipment is due for payment.;
                           NOR=Angir datoen da fõlgeseddelen mÜ betales.;
                           SVE=Anger datumet dÜ utleveransen fîrfaller till betalning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date" }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total of the amounts on all the credit memo lines, in the currency of the credit memo. The amount does not include VAT.;
                           NOR=Angir summen av belõpene pÜ alle kreditnotalinjene, i valutaen pÜ kreditnotaen. Belõpet er ikke inkludert mva.;
                           SVE=Anger summan av beloppen pÜ alla kreditnotans rader i kreditnotans valuta. Beloppet inkluderar inte moms.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount;
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memo",Rec)
                            END;
                             }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total of the amounts in all the amount fields on the credit memo, in the currency of the credit memo. The amount includes VAT.;
                           NOR=Angir summen av belõpene, inkludert mva, pÜ alle linjene i dokumentet.;
                           SVE=Anger summan av beloppen, inklusive moms, pÜ fakturaraderna i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Including VAT";
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memo",Rec)
                            END;
                             }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be paid for the posted sales invoice.;
                           NOR=Angir belõpet som gjenstÜr Ü bli betalt for den bokfõrte salgsfakturaen.;
                           SVE=Anger beloppet som ÜterstÜr att betala fîr den bokfîrda fîrsÑljningsfakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Amount" }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice that relates to this sales credit memo is paid.;
                           NOR=Angir om den bokfõrte salgsfakturaen som er knyttet til denne salgskreditnotaen er betalt.;
                           SVE=Anger om den bokfîrda fîrsÑljningsfakturan som berîr den hÑr fîrsÑljningskreditnotan Ñr betald.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Paid }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice that relates to this sales credit memo has been either corrected or canceled.;
                           NOR=Angir om den bokfõrte salgsfakturaen som er knyttet til denne salgskreditnotaen, er blitt korrigert eller kansellert.;
                           SVE=Anger om den bokfîrda fîrsÑljningsfakturan relaterad till den hÑr fîrsÑljningskreditnotan har korrigerats eller avbrutits.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                HideValue=NOT Cancelled;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveInvoice;
                            END;
                             }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice has been either corrected or canceled by this sales credit memo.;
                           NOR=Angir om den bokfõrte salgsfakturaen har blitt korrigert eller kansellert av denne salgskreditnotaen.;
                           SVE=Anger om den bokfîrda fîrsÑljningsfakturan har rÑttats eller annullerats med den hÑr fîrsÑljningskreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                HideValue=NOT Corrective;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledInvoice;
                            END;
                             }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for kundens hovedadresse.;
                           SVE=Anger postnumret i kundens huvudadress.];
                SourceExpr="Sell-to Post Code";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir koden for land/omrÜde for kundens hovedadresse.;
                           SVE=Anger lands-/regionkod fîr kundens huvudadress.];
                SourceExpr="Sell-to Country/Region Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person to contact when you communicate with the customer that you shipped the items on the credit memo to.;
                           NOR=Angir navnet pÜ kontaktpersonen i kundens hovedadresse.;
                           SVE=Anger namnet pÜ kontaktpersonen pÜ kundens huvudadress.];
                SourceExpr="Sell-to Contact";
                Visible=FALSE }

    { 127 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer the credit memo was sent to.;
                           NOR=Angir nummeret for kunden du sender eller har sendt fakturaen eller kreditnotaen til.;
                           SVE=Anger numret pÜ kunden som du skickade eller skickar fakturan eller kreditnotan till.];
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 125 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the customer that the credit memo was sent to.;
                           NOR=Angir navnet pÜ kunden du sender eller har sendt fakturaen eller kreditnotaen til.;
                           SVE=Anger namnet pÜ kunden som du skickade eller skickar fakturan eller kreditnotan till.];
                SourceExpr="Bill-to Name";
                Visible=FALSE }

    { 1100525002;2;Field  ;
                SourceExpr="Bill-to Name 2";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for kundens fakturaadresse.;
                           SVE=Anger postnumret i kundens faktureringsadress.];
                SourceExpr="Bill-to Post Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir koden for land/omrÜde for kundens fakturaadresse.;
                           SVE=Anger lands-/regionkod fîr kundens faktureringsadress.];
                SourceExpr="Bill-to Country/Region Code";
                Visible=FALSE }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you regularly contact when you communicate with the customer to whom the credit memo was sent.;
                           NOR=Angir navnet pÜ kontaktpersonen i kundens fakturaadresse.;
                           SVE=Anger namnet pÜ kontaktpersonen pÜ kundens faktureringsadress.];
                SourceExpr="Bill-to Contact";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=This field is used with shipments to customers with multiple ship-to addresses.;
                           NOR=Angir en kode for en alternativ leveringsadresse hvis du vil levere til en annen adresse enn den som er angitt automatisk. Dette feltet brukes ogsÜ ved direkte levering.;
                           SVE=Anger en kod fîr en alternativ leveransadress om du vill leverera till en annan adress Ñn den som har angetts automatiskt. Det hÑr fÑltet anvÑnds ocksÜ vid direktutleverans.];
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the customer that the items were shipped to.;
                           NOR=Angir navnet pÜ kunden pÜ adressen som varene blir levert til.;
                           SVE=Anger namnet pÜ kunden pÜ adressen som artiklarna levereras till.];
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 1100525004;2;Field  ;
                SourceExpr="Ship-to Name 2";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen som varene sendes til.;
                           SVE=Anger postnumret i adressen som artiklarna levereras till.];
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omrÜdekoden for adressen som varene sendes til.;
                           SVE=Anger lands-/regionkoden i adressen som artiklarna levereras till.];
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you regularly contact at the customer to whom the items were shipped.;
                           NOR=Angir navnet pÜ kontaktpersonen pÜ adressen som varene blir sendt til.;
                           SVE=Anger namnet pÜ kontaktpersonen pÜ adressen som artiklarna levereras till.];
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the credit memo was posted.;
                           NOR=Angir datoen da kreditnotaen ble bokfõrt.;
                           SVE=Anger datumet dÜ kreditnotan bokfîrdes.];
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 1102601003;2;Field  ;
                ToolTipML=[ENU=Specifies the date when you created the sales document.;
                           NOR=Angir datoen da de relaterte dokumentet ble opprettet.;
                           SVE=Anger datumet nÑr det relaterade dokumentet skapades.];
                SourceExpr="Document Date";
                Visible=FALSE }

    { 65  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which salesperson is associated with the credit memo.;
                           NOR=Angir hvilken selger som er knyttet til kreditnotaen.;
                           SVE=Anger vilken sÑljare som Ñr knuten till kreditnotan.];
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the credit memo.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the credit memo.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location where the credit memo was registered.;
                           NOR=Angir hvilken lokasjon kreditnotaen er registrert pÜ.;
                           SVE=Anger lagerstÑllet dÑr kreditnotan registrerades.];
                SourceExpr="Location Code" }

    { 1100485000;2;Field  ;
                SourceExpr="Job No." }

    { 1100409000;2;Field  ;
                SourceExpr="Service Order No." }

    { 1100409001;2;Field  ;
                SourceExpr="Service Contract No." }

    { 1100485012;2;Field  ;
                SourceExpr="Principal Reference";
                Visible=FALSE }

    { 1100485002;2;Field  ;
                SourceExpr="Project Credit Memo";
                Visible=FALSE }

    { 1100485004;2;Field  ;
                SourceExpr="Installment Credit Memo";
                Visible=FALSE }

    { 1100485006;2;Field  ;
                SourceExpr="Service Invoice";
                Visible=FALSE }

    { 1100525016;2;Field  ;
                SourceExpr="Inserted By";
                Visible=FALSE }

    { 1100525014;2;Field  ;
                SourceExpr="User ID";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the credit memo has been printed.;
                           NOR=Angir hvor mange ganger dokumentet har blitt skrevet ut.;
                           SVE=Anger hur mÜnga gÜnger dokumentet har skrivits ut.];
                SourceExpr="No. Printed" }

    { 1102601005;2;Field  ;
                ToolTipML=[ENU=Specifies whether the credit memo has been applied to an already-posted document.;
                           NOR=Angir typen bokfõrt dokument som dette dokumentet eller denne kladdelinjen blir utlignet til nÜr du bokfõrer, for eksempel for Ü registrere utbetaling.;
                           SVE=Anger typen fîr det bokfîrda dokument som den hÑr dokument- eller journalraden tillÑmpas pÜ nÑr du bokfîr, t.ex. fîr att registrera en betalning.];
                SourceExpr="Applies-to Doc. Type";
                Visible=FALSE }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the document if you are using a document exchange service to send it as an electronic document. The status values are reported by the document exchange service.;
                           NOR=Angir statusen for dokumentet hvis du bruker en dokumentutvekslingstjeneste til Ü sende den som et elektronisk dokument. Statusverdiene rapporteres av dokumentutvekslingstjenesten.;
                           SVE=Anger dokumentets status om du anvÑnder en dokumentutbytestjÑnst till att skicka det som ett elektroniskt dokument. StatusvÑrdena rapporteras av dokumentutbytestjÑnsten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Exchange Status";
                Visible=DocExchStatusVisible;
                StyleExpr=DocExchStatusStyle }

    { 1100525001;2;Field  ;
                SourceExpr="Pre-Assigned No." }

    { 1100528000;2;Field  ;
                SourceExpr="Return Order No." }

    { 1100285505;2;Field  ;
                SourceExpr="Electronic Credit Memo Created" }

    { 1100285100;2;Field  ;
                SourceExpr="Invoice Exported by XML" }

    { 1100285504;2;Field  ;
                SourceExpr="External Document No." }

    { 1100285503;2;Field  ;
                SourceExpr="Bill-to Address";
                Visible=false }

    { 1100285502;2;Field  ;
                SourceExpr="Sell-to City";
                Visible=false }

    { 1100285500;2;Field  ;
                SourceExpr="E-Invoice Layout Code";
                Visible=false }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 7   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      DocExchStatusStyle@1111 : Text;
      DocExchStatusVisible@1000 : Boolean;
      IsOfficeAddin@1001 : Boolean;
      DPA_IsHardFilter@1100000999 : Boolean;
      txtSendAllInvoices@1100285503 : TextConst 'ENU=%1 credit memos of %2 are not marked as Svefaktura and will hence not be created. Would you like to continue?;SVE=%1 kreditnotor av %2 Ñr inte markerade som Svefaktura och kommer dÑrfîr inte att skapas. Vill du fortsÑtta?';
      txtSvefakturaCreated@1100285502 : TextConst 'ENU=%1 electronic credit memos have been created.;SVE=%1 svefaktura-filer har skapats.';
      DKinfoEnable@1100285500 : Boolean INDATASET;
      txtSendAlreadyCreated@1100285504 : TextConst 'ENU=%1 electronic credit memos have already been created and will be created again. Would you like to continue?;SVE=%1 elektronisk kreditnota har redan skapats och kommer att skapas pÜ nytt. Vill du fortsÑtta?';
      NORlocalizationEnable@1100285505 : Boolean INDATASET;
      NewDocumentReportingVisible@1100528400 : Boolean INDATASET;
      GLSetup@1101285000 : Record 98;

    BEGIN
    {
      140909 ITERO.MH ENH042 Added confirmation for already exported e-credit memos.
      141008 ITERO.MH Added field "Electronic Credit Memo Created"
      150928 ITERO.MH RFC001 Changed Svefaktur-action to use Report from Setup
      160107 ITERO.SB RFC-063 Added fields: "Bill-to Address", "Sell-to City"
      160209 ITERO.SB Added field "E-Invoice Layout Code"
      190604 ORANGO.FH #24479 Added functionality for printing Svefaktura from cu instead of report
      191212 ORANGO.PR New function "Remove Nettingflag" - Certego - Integration 7
    }
    END.
  }
}

