OBJECT Table 11072654 Invoice Line SiB
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnDelete=VAR
               lvInvMessRec@1100525000 : Record 11072655;
             BEGIN
               lvInvMessRec.SETRANGE("Invoice No.", "Invoice No.");
               lvInvMessRec.SETRANGE("Invoice Line No.", "Line No.");
               lvInvMessRec.DELETEALL;
             END;

    CaptionML=ENU=External Invoice Line;
  }
  FIELDS
  {
    { 10  ;   ;Invoice No.         ;Code20        ;TableRelation="Invoice SiB";
                                                   CaptionML=[ENU=Invoice No.;
                                                              NOR=Fakturanr.;
                                                              SVE=Fakturanummer];
                                                   Editable=No }
    { 20  ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.;
                                                              SVE=Radnr];
                                                   Editable=No }
    { 25  ;   ;External Line No.   ;Integer       ;CaptionML=[ENU=External Line No.;
                                                              NOR=Eksternt radnr;
                                                              SVE=Externt radnr];
                                                   Editable=No }
    { 30  ;   ;Reference Buyer     ;Text30        ;CaptionML=[ENU=Reference Buyer;
                                                              NOR=Referansekj›per;
                                                              SVE=Referensk”pare];
                                                   Editable=No }
    { 40  ;   ;Order No. Buyer     ;Text30        ;CaptionML=[ENU=Order No. Buyer;
                                                              NOR=Ordrenr, kj›per;
                                                              SVE=Ordernr, k”pare];
                                                   Editable=No }
    { 41  ;   ;Order Line No. Buyer;Integer       ;CaptionML=[ENU=Order Line No. Buyer.;
                                                              NOR=Ordreradnr, kj›per.;
                                                              SVE=Orderradnr, k”pare.];
                                                   Editable=No }
    { 50  ;   ;Project No.         ;Code20        ;TableRelation=Job.No.;
                                                   OnValidate=VAR
                                                                ProjRec@1210190000 : Record 11072003;
                                                                ProjSetup@1100527300 : Record 315;
                                                              BEGIN
                                                                IF "Project No." <> '' THEN BEGIN
                                                                  TESTFIELD("Service Order No.", '');
                                                                  TESTFIELD("Plant Type", '');  //db, 04-02-14: T004213
                                                                  TESTFIELD("G/L Account", '');
                                                                  ProjRec.GET("Project No.");
                                                                  ProjSetup.GET;
                                                                  IF ProjSetup."Provisions at Closure" THEN
                                                                    ProjRec.CheckProjectStatus(-1)
                                                                  ELSE
                                                                    ProjRec.CheckProjectStatus(2);
                                                                  Department := ProjRec."Global Dimension 1 Code";
                                                                END ELSE BEGIN
                                                                  Element := '';
                                                                END;
                                                                CALCFIELDS("Project Description");
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 51  ;   ;Project Description ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Job.Description WHERE (No.=FIELD(Project No.)));
                                                   CaptionML=[ENU=Project Description;
                                                              NOR=Prosjektbeskrivelse;
                                                              SVE=Projektbeskrivning];
                                                   Editable=No }
    { 60  ;   ;Correction on Invoice;Code20       ;CaptionML=[ENU=Correction on Invoice;
                                                              NOR=Korreksjon p† faktura;
                                                              SVE=R„ttning p† faktura];
                                                   Editable=No }
    { 61  ;   ;Corr. on Invoice Line No.;Integer  ;CaptionML=[ENU=Corr. on Invoice Line No.;
                                                              NOR=Korreksjon p† Fakturaradnr;
                                                              SVE=R„tta p† fakturaradnr];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 70  ;   ;Dispatch Note No.   ;Code20        ;TableRelation="Dispatch Note SiB";
                                                   CaptionML=[ENU=Dispatch Note No.;
                                                              NOR=F›lgeseddelnr;
                                                              SVE=Leveransbeskedsnr];
                                                   Editable=No }
    { 71  ;   ;Dispatch Note Line No.;Integer     ;TableRelation="Dispatch Note Line SiB"."Line No." WHERE (Dispatch Note No.=FIELD(Dispatch Note No.),
                                                                                                            Item No. Vendor=FIELD(Item No. Vendor),
                                                                                                            GTIN Item=FIELD(GTIN Item));
                                                   OnValidate=VAR
                                                                lvDispatchNoteLineRec@1100525000 : Record 11072652;
                                                              BEGIN
                                                                IF "Dispatch Note Line No." <> 0 THEN BEGIN
                                                                  lvDispatchNoteLineRec.GET("Dispatch Note No.", "Dispatch Note Line No.");
                                                                  IF (lvDispatchNoteLineRec."Delivered Quantity" <> "Delivered Quantity") OR
                                                                     (lvDispatchNoteLineRec."Unit of Measure Code" <> "Unit Code Delivered Quantity")
                                                                  THEN BEGIN
                                                                    IF NOT CONFIRM(Text002, FALSE,
                                                                      "Delivered Quantity", "Unit Code Delivered Quantity",
                                                                      lvDispatchNoteLineRec."Delivered Quantity", lvDispatchNoteLineRec."Unit of Measure Code")
                                                                    THEN
                                                                      ERROR('');
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Dispatch Note Line No.;
                                                              NOR=Radnr for f›lgeseddel;
                                                              SVE=Leveransbeskedsradnr];
                                                   BlankZero=Yes }
    { 80  ;   ;Delivery Date       ;Date          ;CaptionML=[ENU=Delivery Date;
                                                              NOR=Leveringsdato;
                                                              SVE=Leveransdatum];
                                                   Editable=No }
    { 82  ;   ;Delivered Quantity  ;Decimal       ;CaptionML=[ENU=Delivered Quantity;
                                                              NOR=Levert antall;
                                                              SVE=Levererat antal];
                                                   Editable=No }
    { 83  ;   ;Unit Code Delivered Quantity;Code10;CaptionML=[ENU=Unit Code Delivered Quantity;
                                                              NOR=Enhetskode for levert antall;
                                                              SVE=Enhetskod f”r levererat antal];
                                                   Editable=No }
    { 85  ;   ;Approved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Dispatch Note Line SiB"."Approved Quantity" WHERE (Dispatch Note No.=FIELD(Dispatch Note No.),
                                                                                                                          Line No.=FIELD(Dispatch Note Line No.)));
                                                   CaptionML=[ENU=Approved Quantity;
                                                              NOR=Godkjent antall;
                                                              SVE=Godk„nt antal];
                                                   Editable=No }
    { 86  ;   ;Unit Code Approved Quantity;Code10 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Dispatch Note Line SiB"."Unit of Measure Code" WHERE (Dispatch Note No.=FIELD(Dispatch Note No.),
                                                                                                                             Line No.=FIELD(Dispatch Note Line No.)));
                                                   CaptionML=[ENU=Unit Code Approved Quantity;
                                                              NOR=Enhetskode for godkjent antall;
                                                              SVE=Enhetskod f”r godk„nt antal];
                                                   Editable=No }
    { 100 ;   ;Item No. Vendor     ;Code20        ;CaptionML=[ENU=Item No. Vendor;
                                                              NOR=Artikkelnr, leverand›r;
                                                              SVE=Artikelnr, leverant”r];
                                                   Editable=No }
    { 110 ;   ;GTIN Item           ;Code20        ;CaptionML=[ENU=GTIN Item;
                                                              NOR=GTIN-artikkel;
                                                              SVE=GTIN-artikel];
                                                   Editable=No }
    { 120 ;   ;Description         ;Text100       ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning];
                                                   Editable=No }
    { 130 ;   ;Invoiced Quantity   ;Decimal       ;CaptionML=[ENU=Invoiced Quantity;
                                                              NOR=Fakturert antall;
                                                              SVE=Fakturerat antal];
                                                   Editable=No }
    { 135 ;   ;Unit of Measure Code;Code10        ;CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=M†leenhetskode;
                                                              SVE=Enhetskod];
                                                   Editable=No }
    { 140 ;   ;Price Base Quantity ;Decimal       ;CaptionML=[ENU=Price Base Quantity;
                                                              NOR=Pris for antall lagerenheter;
                                                              SVE=Pris f”r basantal];
                                                   Editable=No }
    { 145 ;   ;Price Base Unit Code;Code10        ;CaptionML=[ENU=Price Base Unit Code;
                                                              NOR=Priskode for lagerenheter;
                                                              SVE=Priskod f”r basenhet];
                                                   Editable=No }
    { 150 ;   ;Price               ;Decimal       ;CaptionML=[ENU=Price;
                                                              NOR=Pris;
                                                              SVE=Pris];
                                                   Description=format type 2;
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 160 ;   ;Discount/Surcharge %;Decimal       ;CaptionML=[ENU=Discount/Surcharge %;
                                                              NOR=Rabatt-/tilleggsgebyr%;
                                                              SVE=Rabatt-/till„ggsavgiftprocent];
                                                   Editable=No }
    { 165 ;   ;Discount/Surcharge Amount;Decimal  ;CaptionML=[ENU=Discount/Surcharge Amount;
                                                              NOR=Rabatt-/tilleggsgebyrbel›p;
                                                              SVE=Rabatt-/till„ggsavgiftbelopp];
                                                   Editable=No }
    { 167 ;   ;Discount/Surcharge Type;Option     ;CaptionML=[ENU=Discount/Surcharge Type;
                                                              NOR=Rabatt-/tileggsgebyrtype;
                                                              SVE=Rabatt-/till„ggavgifttyp];
                                                   OptionCaptionML=[ENU=Discount,Surcharge;
                                                                    NOR=Rabatt,Tilleggsgebyr;
                                                                    SVE=Rabatt,Till„ggsavgift];
                                                   OptionString=Discount,Surcharge;
                                                   Editable=No }
    { 168 ;   ;Discount/Surcharge Code;Code20     ;CaptionML=[ENU=Discount/Surcharge Code;
                                                              NOR=Rabatt-/Tillegsgebyrkode;
                                                              SVE=Rabatt-/till„ggavgiftkod];
                                                   Editable=No }
    { 170 ;   ;Net Line Amount     ;Decimal       ;CaptionML=ENU=Net Line Amount;
                                                   Description=[Amt. excl. VAT; format type 1];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 180 ;   ;VAT Rate Type       ;Code20        ;CaptionML=[ENU=VAT Rate Type;
                                                              NOR=Mva.-satstype;
                                                              SVE=Momssatstyp];
                                                   Editable=No }
    { 185 ;   ;VAT %               ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=VAT %;
                                                              NOR=Mva-%;
                                                              SVE=Momssats %];
                                                   Editable=No }
    { 600 ;   ;Time Quantity       ;Decimal       ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Time Quantity;
                                                              SVE=Tidskvantitet];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 610 ;   ;Time Unit           ;Code10        ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Time Unit;
                                                              SVE=Tidsenhet] }
    { 620 ;   ;Starting Date       ;Date          ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Starting Date;
                                                              SVE=Startdatum] }
    { 621 ;   ;Ending Date         ;Date          ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Ending Date;
                                                              SVE=Slutdatum] }
    { 900 ;   ;Cost Object         ;Code20        ;TableRelation=IF (Item No. Vendor=FILTER(<>'')) "Dimension Value".Code WHERE (Cost Type=FILTER(Material),
                                                                                                                                 Global Dimension No.=CONST(2))
                                                                                                                                 ELSE IF (GTIN Item=FILTER(<>'')) "Dimension Value".Code WHERE (Cost Type=FILTER(Material),
                                                                                                                                                                                                Global Dimension No.=CONST(2))
                                                                                                                                                                                                ELSE "Dimension Value".Code WHERE (Cost Type=FILTER(<Revenue),
                                                                                                                                                                                                                                   Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              NOR=Kostnadsobjekt;
                                                              SVE=Kostnadsobjekt];
                                                   CaptionClass='1,1,2' }
    { 910 ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=VAR
                                                                lvInvoiceRec@1100529400 : Record 11072653;
                                                                lvVendor@1100529401 : Record 23;
                                                              BEGIN
                                                                //IF "VAT Bus. Posting Group" = '' THEN
                                                                //  "VAT Prod. Posting Group" := ''
                                                                //ELSE
                                                                //  VALIDATE("VAT Prod. Posting Group");

                                                                IF "VAT Bus. Posting Group" = '' THEN BEGIN
                                                                  "VAT Prod. Posting Group" := '';
                                                                  IF lvInvoiceRec.GET("Invoice No.") THEN BEGIN
                                                                    IF lvVendor.GET(lvInvoiceRec."Vendor No.") THEN BEGIN
                                                                      "VAT Bus. Posting Group" := lvVendor."VAT Bus. Posting Group";
                                                                      VALIDATE("VAT Prod. Posting Group");
                                                                    END;
                                                                  END;
                                                                END ELSE
                                                                  VALIDATE("VAT Prod. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - firma;
                                                              SVE=Moms r”relsebokf”ringsmall] }
    { 915 ;   ;VAT Prod. Posting Group;Code20     ;TableRelation="VAT Product Posting Group";
                                                   OnValidate=VAR
                                                                lvInvoiceRec@1100525000 : Record 11072653;
                                                                lvVATPostingSetupRec@1100525001 : Record 325;
                                                              BEGIN
                                                                IF "VAT Prod. Posting Group" <> '' THEN BEGIN
                                                                  IF "VAT Bus. Posting Group" = '' THEN BEGIN
                                                                    IF lvInvoiceRec.GET("Invoice No.") THEN
                                                                      "VAT Bus. Posting Group" := lvInvoiceRec."VAT Bus. Posting Group";
                                                                  END;
                                                                  lvVATPostingSetupRec.GET("VAT Bus. Posting Group", "VAT Prod. Posting Group");
                                                                  IF lvVATPostingSetupRec."VAT %" <> "VAT %" THEN BEGIN
                                                                    IF NOT CONFIRM(Text001, FALSE, FIELDCAPTION("VAT %"), lvVATPostingSetupRec."VAT %", "VAT %", '%') THEN
                                                                      ERROR('');
                                                                  END;
                                                                END;

                                                                IF "VAT Prod. Posting Group" = '' THEN BEGIN
                                                                  IF "VAT Bus. Posting Group" <> '' THEN BEGIN
                                                                    lvVATPostingSetupRec.SETRANGE("VAT Bus. Posting Group","VAT Bus. Posting Group");
                                                                    lvVATPostingSetupRec.SETRANGE("VAT %","VAT %");
                                                                    IF lvVATPostingSetupRec.FINDFIRST THEN
                                                                      "VAT Prod. Posting Group" := lvVATPostingSetupRec."VAT Prod. Posting Group";
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Moms produktbokf›ringsmal;
                                                              SVE=Moms produktbokf”ringsmall] }
    { 920 ;   ;Element             ;Code20        ;TableRelation="Project Element".Element WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=VAR
                                                                ElementFormat@1210190000 : Codeunit 11012022;
                                                              BEGIN
                                                                IF Element <> '' THEN BEGIN
                                                                  ElementFormat.FormatElem(Element,2,'');
                                                                  TESTFIELD("Project No.");
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 930 ;   ;Service Order No.   ;Code20        ;TableRelation="Service Order";
                                                   OnValidate=VAR
                                                                ServOrderRec@1210190000 : Record 11012823;
                                                              BEGIN
                                                                IF "Service Order No." <> '' THEN BEGIN
                                                                  TESTFIELD("Project No.", '');
                                                                  TESTFIELD("Plant Type", '');  //db, 04-02-14: T004213
                                                                  TESTFIELD("G/L Account", '');
                                                                  ServOrderRec.GET("Service Order No.");
                                                                  ServOrderRec.CheckStatus(1);
                                                                  Department := ServOrderRec."Global Dimension 1 Code";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr] }
    { 940 ;   ;G/L Account         ;Code20        ;TableRelation="G/L Account";
                                                   OnValidate=BEGIN
                                                                IF "G/L Account" <> '' THEN BEGIN
                                                                  TESTFIELD("Project No.", '');
                                                                  TESTFIELD("Service Order No.", '');
                                                                  TESTFIELD("Plant Type", '');  //db, 04-02-14: T004213
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=G/L Account;
                                                              NOR=Hovedbokskonto;
                                                              SVE=Redovisningskonto] }
    { 950 ;   ;Department          ;Code20        ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Avdeling;
                                                              SVE=Department];
                                                   CaptionClass='1,1,1' }
    { 960 ;   ;Vendor (Trade Item) ;Code15        ;TableRelation="ETIM Vendor - Central Mgt";
                                                   CaptionML=[ENU=Vendor (Trade Item);
                                                              NOR=Leverand›r (katalogartikkel);
                                                              SVE=Leverant”r (skaffningsartikel)] }
    { 970 ;   ;Trade Item          ;Code20        ;TableRelation="Trade Item"."Item Code" WHERE (Vendor=FIELD("Vendor (Trade Item)"));
                                                   OnValidate=BEGIN
                                                                IF ("Trade Item" <> xRec."Trade Item") AND ("Trade Item" <> '') THEN  //db, 17-10-14
                                                                  ValidateItem(ItemTypeOpt::"Trade Item");
                                                              END;

                                                   CaptionML=[ENU=Trade Item;
                                                              NOR=Katalogartikkel;
                                                              SVE=Anskaffningsartikel] }
    { 980 ;   ;Basic Item          ;Code20        ;TableRelation="Basic Item"."Product Code" WHERE (Manufacturer=FIELD(Manufacturer));
                                                   CaptionML=[ENU=Basic Item;
                                                              NOR=Fabrikantartikkel;
                                                              SVE=Basartikel] }
    { 990 ;   ;Manufacturer        ;Code15        ;TableRelation="ETIM Vendor - Central Mgt";
                                                   CaptionML=[ENU=Manufacturer;
                                                              NOR=Produsent;
                                                              SVE=Tillverkare] }
    { 1000;   ;No Dispatch Required;Text10        ;CaptionML=[ENU=No Dispatch Required;
                                                              NOR=Ingen fordeling kreves;
                                                              SVE=Ingen leverans kr„vs] }
    { 1010;   ;Item No.            ;Code20        ;TableRelation=Item.No.;
                                                   OnValidate=BEGIN
                                                                IF ("Item No." <> xRec."Item No.") AND ("Item No." <> '') THEN  //db, 17-10-14
                                                                  ValidateItem(ItemTypeOpt::Item);
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.;
                                                              SVE=Artikelnr];
                                                   Description=DP00065 (table relation added) }
    { 1020;   ;Comment             ;Text50        ;CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar];
                                                   Description=DP00065 }
    { 1030;   ;Comment Dispatch Note Line;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Dispatch Note Line SiB".Comment WHERE (Dispatch Note No.=FIELD(Dispatch Note No.),
                                                                                                              Line No.=FIELD(Dispatch Note Line No.)));
                                                   OnValidate=VAR
                                                                lvDispatchNoteLineRec@1100525000 : Record 11072652;
                                                              BEGIN
                                                                IF "Dispatch Note Line No." <> 0 THEN BEGIN
                                                                  lvDispatchNoteLineRec.GET("Dispatch Note No.", "Dispatch Note Line No.");
                                                                  IF (lvDispatchNoteLineRec."Delivered Quantity" <> "Delivered Quantity") OR
                                                                     (lvDispatchNoteLineRec."Unit of Measure Code" <> "Unit Code Delivered Quantity")
                                                                  THEN BEGIN
                                                                    IF NOT CONFIRM(Text002, FALSE,
                                                                      "Delivered Quantity", "Unit Code Delivered Quantity",
                                                                      lvDispatchNoteLineRec."Delivered Quantity", lvDispatchNoteLineRec."Unit of Measure Code")
                                                                    THEN
                                                                      ERROR('');
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Comment Dispatch Note Line;
                                                              NOR=Kommentarrad for f›lgeseddel;
                                                              SVE=Kommentarsrad f”r leveransbesked];
                                                   Description=DP00065;
                                                   Editable=No }
    { 1040;   ;Approved            ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Invoice SiB".Approved WHERE (No.=FIELD(Invoice No.)));
                                                   CaptionML=[ENU=Approved;
                                                              NOR=Godkjent;
                                                              SVE=Godk„nd];
                                                   Description=DP00065;
                                                   Editable=No }
    { 1050;   ;Plant Type          ;Code20        ;TableRelation="Plant Type";
                                                   OnValidate=VAR
                                                                PlantTypeRec@1100525000 : Record 11012551;
                                                                PlantSetup@1100525001 : Record 11012550;
                                                              BEGIN
                                                                //db, 04-02-14: T004213
                                                                IF "Plant Type" <> '' THEN BEGIN
                                                                  TESTFIELD("Project No.", '');
                                                                  TESTFIELD("Service Order No.", '');
                                                                  TESTFIELD("G/L Account", '');
                                                                  PlantTypeRec.GET("Plant Type");
                                                                  Department := PlantTypeRec."Department Code";
                                                                  //db.sn, 14-10-14
                                                                  "Cost Object" := PlantTypeRec."Cost Object";
                                                                  PlantSetup.GET;
                                                                  IF PlantTypeRec.External THEN
                                                                    "Cost Component Plant" := PlantSetup."Cost Component Rent"
                                                                  ELSE
                                                                    "Cost Component Plant" := PlantSetup."Cost Component Acquisition";
                                                                  //db.en, 14-10-14
                                                                  IF "Plant Type" <> xRec."Plant Type" THEN
                                                                    "Plant No." := '';
                                                                  VALIDATE("Plant No.");
                                                                END ELSE BEGIN
                                                                  "Plant No." := '';
                                                                  "Cost Component Plant" := '';
                                                                  GetCostObjectItem;  //db, 14-04-14
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Plant Type;
                                                              NOR=Maskintype;
                                                              SVE=Maskintyp];
                                                   Description=DP00065 }
    { 1051;   ;Plant No.           ;Code10        ;TableRelation="Plant Number".No. WHERE (Plant Type=FIELD(Plant Type));
                                                   OnValidate=VAR
                                                                PlantNumber@1100529000 : Record 11012552;
                                                                PlantSetup@1100529001 : Record 11012550;
                                                              BEGIN
                                                                IF "Plant No." <> '' THEN BEGIN
                                                                  PlantSetup.GET;
                                                                  PlantNumber.GET("Plant Type", "Plant No.");
                                                                  IF PlantNumber.External THEN BEGIN
                                                                    IF ("Cost Component Plant" = '') OR ("Cost Component Plant" = PlantSetup."Cost Component Acquisition") THEN
                                                                      "Cost Component Plant" := PlantSetup."Cost Component Rent";
                                                                  END ELSE BEGIN
                                                                    IF ("Cost Component Plant" = '') OR ("Cost Component Plant" = PlantSetup."Cost Component Rent") THEN
                                                                      "Cost Component Plant" := PlantSetup."Cost Component Acquisition";
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Plant No.;
                                                              NOR=Maskinnr.;
                                                              SVE=Maskinnr];
                                                   Description=DP00065 }
    { 1052;   ;Cost Component Plant;Code10        ;TableRelation="Cost Component Plant";
                                                   CaptionML=[ENU=Cost Component Plant;
                                                              NOR=Kostdel, maskin;
                                                              SVE=Kostnadsdel, Maskin];
                                                   Description=DP00065 }
    { 1060;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                //db, 07-10-14
                                                                IF "Location Code" <> '' THEN BEGIN  //db, 14-10-14: provisionally only allowed for managing type=item (table purchaseline)
                                                                  TESTFIELD("Item No.");
                                                                  TESTFIELD("Project No.", '');
                                                                  TESTFIELD("Service Order No.", '');
                                                                  TESTFIELD("G/L Account", '');
                                                                END;
                                                                IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                  "Bin Code" := '';
                                                                  IF ("Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.",'',"Location Code","Bin Code");
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Plasseringkode;
                                                              SVE=Lagerst„llekod];
                                                   Description=DP00065 }
    { 1065;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=BEGIN
                                                                //db, 07-10-14
                                                                IF "Bin Code" <> '' THEN BEGIN  //db, 14-10-14: provisionally only allowed for managing type=item (table purchaseline)
                                                                  TESTFIELD("Item No.");
                                                                  TESTFIELD("Project No.", '');
                                                                  TESTFIELD("Service Order No.", '');
                                                                  TESTFIELD("G/L Account", '');
                                                                END;
                                                                IF ("Bin Code" <> xRec."Bin Code") AND ("Bin Code" <> '') THEN BEGIN
                                                                  GetLocation("Location Code");
                                                                  Location.TESTFIELD("Bin Mandatory");
                                                                  Location.TESTFIELD("Directed Put-away and Pick",FALSE);
                                                                  GetBin("Location Code","Bin Code");
                                                                  TESTFIELD("Location Code",Bin."Location Code");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Lagerplasseringskode;
                                                              SVE=Lagerplatskod];
                                                   Description=DP00065 }
    { 1070;   ;Line Matched        ;Boolean       ;OnValidate=VAR
                                                                PurchaseLine@1100525000 : Record 39;
                                                              BEGIN
                                                                IF "Line Matched" THEN
                                                                  PurchaseLine.GET(PurchaseLine."Document Type"::Order, "Order No. Buyer", "Order Line No. Buyer");  //db, 04-06-15
                                                              END;

                                                   CaptionML=[ENU=Line Matched;
                                                              NOR=Rad matcher;
                                                              SVE=Rad matchad];
                                                   Description=GS1 }
    { 1080;   ;Related Purch.Line Description;Text100;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Purchase Line".Description WHERE (Document Type=CONST(Order),
                                                                                                         Document No.=FIELD(Order No. Buyer),
                                                                                                         Line No.=FIELD(Order Line No. Buyer)));
                                                   CaptionML=ENU=Related Purchase Line Description;
                                                   Description=GS1;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Invoice No.,Line No.                    ;Clustered=Yes }
    {    ;Dispatch Note No.                        }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1100525000 : TextConst 'ENU=%1 is %2%4, this is unequal to %1 (%3%4) of the invoice line. Are you sure?;NOR=%1 er %2%4 og ikke lik %1 (%3%4) p† fakturaraden. Er du sikker?;SVE=%1 „r %2%4 och inte lika med %1 (%3%4) p† fakturaraden. Žr du s„ker?';
      Text002@1100525001 : TextConst 'ENU=Delivered quantity/unit of the invoice line ''%1 %'' is unequal to those of the dispatch not line ''%3 %4''. Are you sure?;NOR=Levert antall/enhet p† fakturaraden ''%1 %'' skiller seg fra f›lgeseddel ''%3 %4''. Er du sikker?;SVE=Levererat antal/levererad enhet p† fakturaraden ''%1 %'' skiljer sig fr†n uppgifterna p† leveranssedeln ''%3 %4''. Žr du s„ker?';
      DPA_Management@1100000999 : Codeunit 11012783;
      Location@1100525003 : Record 14;
      Bin@1100525002 : Record 7354;
      WMSManagement@1100525004 : Codeunit 7302;
      ItemTypeOpt@1100525005 : 'Item,Basic Item,Trade Item';

    PROCEDURE IsInvoiceTextLine@1100525000() : Boolean;
    BEGIN
      IF ("Delivered Quantity" = 0) AND ("Invoiced Quantity" = 0) AND
         ("Item No. Vendor" = '') AND  (DELCHR("GTIN Item",'=','0') = '') AND
         (Price = 0) AND ("Net Line Amount" = 0) AND ("VAT %" = 0)
      THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    PROCEDURE FillProjectNoWithDispNoteProj@1100525001();
    VAR
      lvDispatchNoteRec@1100525000 : Record 11072651;
      lvProjRec@1100525001 : Record 11072003;
    BEGIN
      IF "Dispatch Note No." = '' THEN
        EXIT;
      IF NOT lvDispatchNoteRec.GET("Dispatch Note No.") THEN
        EXIT;
      IF (lvDispatchNoteRec."Project No." <> '') AND lvProjRec.GET(lvDispatchNoteRec."Project No.") THEN
        "Project No." := lvDispatchNoteRec."Project No.";
    END;

    PROCEDURE SearchForDispatchNoteLineNo@1100525002() : Integer;
    VAR
      lvDispatchNoteLineRec@1100525000 : Record 11072652;
    BEGIN
      //* Some vendors can not fill/determine the 'Dispatch Note Line No.' on an invoice line. So we try to
      //* determine this lino no, but this will only be filled when dispactch note no., items, delivered quantity
      //* and unit are the same. Otherwise the user can manually link invoice lines to a dispatch note line by
      //* filling the 'Dispatch Note Line No.' in the invoice lines (not approved).
      IF "Dispatch Note No." = '' THEN
        EXIT(0);
      IF IsInvoiceTextLine THEN
        EXIT(0);

      lvDispatchNoteLineRec.SETRANGE("Dispatch Note No.", "Dispatch Note No.");
      lvDispatchNoteLineRec.SETRANGE("Item No. Vendor", "Item No. Vendor");
      lvDispatchNoteLineRec.SETRANGE("GTIN Item", "GTIN Item");
      lvDispatchNoteLineRec.SETRANGE("Delivered Quantity", "Delivered Quantity");
      lvDispatchNoteLineRec.SETRANGE("Unit of Measure Code", "Unit Code Delivered Quantity");
      IF lvDispatchNoteLineRec.FINDFIRST THEN
        EXIT(lvDispatchNoteLineRec."Line No.");
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(11072654) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 11072654');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Invoice Line SiB", Department, IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO(Department));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, Department);
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      //db, 07-10-14
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    LOCAL PROCEDURE GetBin@7301(LocationCode@1000 : Code[10];BinCode@1001 : Code[20]);
    BEGIN
      //db, 07-10-14
      IF BinCode = '' THEN
        CLEAR(Bin)
      ELSE
        IF Bin.Code <> BinCode THEN
          Bin.GET(LocationCode,BinCode);
    END;

    PROCEDURE GetCostObjectItem@1100525003();
    VAR
      ItemRec@1100525001 : Record 27;
      TradeItemRec@1100525000 : Record 11012317;
    BEGIN
      //db, 17-10-14
      IF "Trade Item" <> '' THEN BEGIN
        TradeItemRec.GET("Vendor (Trade Item)", "Trade Item");
        "Cost Object" := TradeItemRec."Cost Object";
      END ELSE BEGIN
        IF ItemRec.GET("Item No.") THEN
          "Cost Object" := ItemRec."Global Dimension 2 Code";
      END;
    END;

    PROCEDURE ValidateItem@1210190000(LTypeArtOpt@11012000 : 'Item,Basic Item,Trade Item');
    VAR
      ValidateCu@1100525000 : Codeunit 11012033;
      DummyCode@1100525003 : Code[250];
      DummyTxt@1100525001 : Text[250];
      DummyDec@1100525002 : Decimal;
      DummyDate@1100525004 : Date;
      lvRefDate@1100485004 : Date;
      lvDiscRef1@1100485003 : Code[20];
      lvDiscRef2@1100485002 : Code[20];
    BEGIN
      //db, 17-10-14
      lvRefDate := TODAY;
      ValidateCu.ValidateItem(LTypeArtOpt,"Trade Item","Item No.",Manufacturer,"Vendor (Trade Item)",
        "Basic Item","Cost Object",DummyTxt,DummyCode,
        DummyDec,DummyDec,DummyDate,DummyDec,DummyTxt,DummyCode,
        lvDiscRef1,lvDiscRef2,lvRefDate,'');
    END;

    PROCEDURE RelatedPurchLineDescription@1100529600() : Text[100];
    VAR
      PurchaseLine@1100529600 : Record 39;
    BEGIN
      IF ("Order No. Buyer" = '') OR ("Order Line No. Buyer" = 0) OR
         (STRLEN("Order No. Buyer") > MAXSTRLEN(PurchaseLine."Document No."))
      THEN
        EXIT('');
      IF PurchaseLine.GET(PurchaseLine."Document Type"::Order, "Order No. Buyer", "Order Line No. Buyer") THEN
        EXIT(PurchaseLine.Description);
    END;

    PROCEDURE DrillDownRelatedPurchLine@1100529601();
    VAR
      PurchaseLine@1100529600 : Record 39;
    BEGIN
      IF ("Order No. Buyer" = '') OR ("Order Line No. Buyer" = 0) OR
         (STRLEN("Order No. Buyer") > MAXSTRLEN(PurchaseLine."Document No."))
      THEN
        EXIT;
      PurchaseLine.SETRANGE("Document Type", PurchaseLine."Document Type"::Order);
      PurchaseLine.SETRANGE("Document No.", "Order No. Buyer");
      PurchaseLine.SETRANGE("Line No.", "Order Line No. Buyer");
      PAGE.RUNMODAL(0, PurchaseLine);
    END;

    PROCEDURE RetrieveLocalUnitCode@1100528500(InternationalUnitCode@1100528500 : Text) LocalUnitCode : Code[10];
    VAR
      UnitOfMeasure@1100528501 : Record 204;
    BEGIN
      IF InternationalUnitCode  = '' THEN BEGIN
        LocalUnitCode := '';
        EXIT;
      END;

      UnitOfMeasure.SETRANGE(
        "International Standard Code",COPYSTR(InternationalUnitCode,1,MAXSTRLEN(UnitOfMeasure."International Standard Code")));
      IF UnitOfMeasure.FINDFIRST THEN BEGIN
        LocalUnitCode := UnitOfMeasure.Code;
        EXIT;
      END;

      UnitOfMeasure.RESET;
      UnitOfMeasure.SETRANGE(Code,COPYSTR(InternationalUnitCode,1,MAXSTRLEN(UnitOfMeasure.Code)));
      IF UnitOfMeasure.FINDFIRST THEN BEGIN
        LocalUnitCode := UnitOfMeasure.Code;
        EXIT;
      END;
    END;

    PROCEDURE FindTradeItem@1100528501(InvoiceSiB@1100528502 : Record 11072653;VAR TradeItem@1100528503 : Record 11012317);
    VAR
      ItemCode@1100528501 : Code[20];
      VendorCode@1100528500 : Code[20];
    BEGIN
      CLEAR(TradeItem);

      InvoiceSiB.CALCFIELDS("GLN Alternative Vendor");
      IF InvoiceSiB."GLN Alternative Vendor" <> '' THEN
        VendorCode := InvoiceSiB."GLN Alternative Vendor"
      ELSE
        VendorCode := InvoiceSiB."GLN Vendor";
      IF "Item No. Vendor" <> '' THEN
        ItemCode := "Item No. Vendor"
      ELSE
        ItemCode := "GTIN Item";

      IF NOT TradeItem.GET(VendorCode,ItemCode) THEN
        IF "GTIN Item" <> '' THEN BEGIN
          TradeItem.RESET;
          TradeItem.SETCURRENTKEY("GTIN Code (Item)");
          TradeItem.SETRANGE("GTIN Code (Item)","GTIN Item");
          TradeItem.SETRANGE(Vendor,VendorCode);
          IF NOT TradeItem.FINDFIRST THEN BEGIN
            TradeItem.SETRANGE(Vendor);
            IF TradeItem.COUNT = 1 THEN BEGIN
              TradeItem.FINDFIRST;
              "Item No. Vendor" := '';
            END;
          END;
        END;
    END;

    PROCEDURE LineCommentPresent@1210190017() : Boolean;
    VAR
      PurchCommentLine@1210190000 : Record 43;
    BEGIN
      EXIT(PurchCommentLine.CommentPresent(PurchCommentLine."Document Type"::"INSBOU Invoice", "Invoice No.", "Line No."));
    END;

    BEGIN
    END.
  }
}

