OBJECT XMLport 11127991 SymbrioImportPurchaseInv
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSSE;
  }
  PROPERTIES
  {
    Permissions=TableData 11127980=rimd,
                TableData 11127981=rimd;
    Direction=Both;
    Encoding=ISO-8859-2;
    PreserveWhiteSpace=Yes;
    OnPreXMLport=BEGIN
                   SymbrioSetup.GET;
                   GETSTAMP(FullSourceFilename, varDate, varTime);
                   keyDateTime := CURRENTDATETIME;//CREATEDATETIME(TODAY,TIME);
                   entryId += 1;
                 END;

    OnPostXMLport=BEGIN
                    "Symbrio Purchase Inv. Header".FINDLAST;
                  END;

  }
  ELEMENTS
  {
    { [{F34D0F63-4B48-4905-B573-2DB10B0349E2}];  ;SymbrioExtInvoice   ;Element ;Text     }

    { [{C1AA2285-6A36-4E04-B535-DB67E34796D1}];1 ;xsi                 ;Attribute;Text   ;
                                                  VariableName=xsi;
                                                  Occurrence=Optional }

    { [{B2263985-A013-479A-A0E9-EA39EF7B1D33}];1 ;InvoiceHead         ;Element ;Table   ;
                                                  SourceTable=Table11127980;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 PurchaseHeader@1100285500 : Record 38;
                                                                                 TotalSum@1100285000 : Decimal;
                                                                               BEGIN
                                                                                 //"Symbrio Purchase Inv. Header"."Date Received":= DT2DATE(keyDateTime); //TODAY();
                                                                                 //"Symbrio Purchase Inv. Header"."Time Received":= DT2TIME(keyDateTime); //TIME();
                                                                                 "Symbrio Purchase Inv. Header"."Source Filename":=SourceFilename;
                                                                                 //>>140305 SYM994
                                                                                 GETSTAMP(FullSourceFilename, varDate, varTime);
                                                                                 "Symbrio Purchase Inv. Header"."Date Last Modified":=varDate;
                                                                                 "Symbrio Purchase Inv. Header"."Time Last Modified":=varTime;
                                                                                 //<<140305 SYM994
                                                                                 "Symbrio Purchase Inv. Header"."DateTime Received" := keyDateTime;
                                                                                 "Symbrio Purchase Inv. Header"."EntryNo in BatchRead" := entryId;

                                                                                 //>>140624 SYM-999 Itero.WvG
                                                                                 "Symbrio Purchase Inv. Header".PurchaserCompanyName := COPYSTR(PurchaserCompanyName,1,MAXSTRLEN("Symbrio Purchase Inv. Header".PurchaserCompanyName));
                                                                                 "Symbrio Purchase Inv. Header".SupplierCompanyName := COPYSTR(SupplierCompanyName,1,MAXSTRLEN("Symbrio Purchase Inv. Header".SupplierCompanyName));
                                                                                 "Symbrio Purchase Inv. Header".DeliveryReceiver := COPYSTR(DeliveryReceiver,1,MAXSTRLEN("Symbrio Purchase Inv. Header".DeliveryReceiver));
                                                                                 "Symbrio Purchase Inv. Header".PurchaserAddress := COPYSTR(PurchaserAddress,1,MAXSTRLEN("Symbrio Purchase Inv. Header".PurchaserAddress));
                                                                                 "Symbrio Purchase Inv. Header".PurchaserCity := COPYSTR(PurchaserCity,1,MAXSTRLEN("Symbrio Purchase Inv. Header".PurchaserCity));
                                                                                 "Symbrio Purchase Inv. Header".SupplierAddress := COPYSTR(SupplierAddress,1,MAXSTRLEN("Symbrio Purchase Inv. Header".SupplierAddress));
                                                                                 "Symbrio Purchase Inv. Header".SupplierCity := COPYSTR(SupplierCity,1,MAXSTRLEN("Symbrio Purchase Inv. Header".SupplierCity));
                                                                                 "Symbrio Purchase Inv. Header".DeliveryAddress := COPYSTR(DeliveryAddress,1,MAXSTRLEN("Symbrio Purchase Inv. Header".DeliveryAddress));
                                                                                 "Symbrio Purchase Inv. Header".DeliveryCity := COPYSTR(DeliveryCity,1,MAXSTRLEN("Symbrio Purchase Inv. Header".DeliveryCity));
                                                                                 "Symbrio Purchase Inv. Header".DeliveryAddressNoteText := COPYSTR(DeliveryAddressNoteText,1,MAXSTRLEN("Symbrio Purchase Inv. Header".DeliveryAddressNoteText));
                                                                                 "Symbrio Purchase Inv. Header".GoodsLabel := COPYSTR(GoodsLabel,1,MAXSTRLEN("Symbrio Purchase Inv. Header".GoodsLabel));
                                                                                 "Symbrio Purchase Inv. Header".PurchaserReference := COPYSTR(PurchaserReference,1,MAXSTRLEN("Symbrio Purchase Inv. Header".PurchaserReference));
                                                                                 "Symbrio Purchase Inv. Header".SupplierReference := COPYSTR(SupplierReference,1,MAXSTRLEN("Symbrio Purchase Inv. Header".SupplierReference));
                                                                                 "Symbrio Purchase Inv. Header".SupplierInvoiceNo := COPYSTR(SupplierInvoiceNo,1,MAXSTRLEN("Symbrio Purchase Inv. Header".SupplierInvoiceNo));
                                                                                 //>>140624 SYM-999 Itero.WvG


                                                                                 //>>140414 SYM-ENH-006 ITERO.DJ
                                                                                 IF "Symbrio Purchase Inv. Header".InvoiceStatus = 'Discarded' THEN
                                                                                   "Symbrio Purchase Inv. Header"."Error Message" := 'Discarded Invoice';
                                                                                 //<<140414 SYM-ENH-006 ITERO.DJ

                                                                                 //>>SYM088+089, 150629
                                                                                 IF NOT EVALUATE(TotalSum,"Symbrio Purchase Inv. Header".TotalSum) THEN
                                                                                   TotalSum :=0;
                                                                                 IF ("Symbrio Purchase Inv. Header".InvoiceType = 'Debit') AND (TotalSum>=0) THEN
                                                                                 //<<SYM098
                                                                                   //>>140701 SYM025 ITERO.DL
                                                                                   IF ("Symbrio Purchase Inv. Header".OrderHeadID <> '') AND ("Symbrio Purchase Inv. Header"."Error Message"='') THEN BEGIN
                                                                                   //>>150316 SYM064
                                                                                     //IF NOT PurchaseHeader.GET(PurchaseHeader."Document Type"::Order, "Symbrio Purchase Inv. Header".OrderHeadID) THEN
                                                                                     CLEAR(SymbrioPurchaseHeader);
                                                                                     SymbrioPurchaseHeader.SETRANGE(OrderHeadID, "Symbrio Purchase Inv. Header".OrderHeadID);
                                                                                     IF (NOT (PurchaseHeader.GET(PurchaseHeader."Document Type"::Order, "Symbrio Purchase Inv. Header".OrderHeadID))) THEN
                                                                                       IF (SymbrioPurchaseHeader.ISEMPTY) THEN
                                                                                   //<<150316 SYM064
                                                                                         "Symbrio Purchase Inv. Header"."Error Message" := STRSUBSTNO(Text001, "Symbrio Purchase Inv. Header".OrderHeadID);
                                                                                   END;
                                                                                   //<<140701 SYM025 ITERO.DL
                                                                               END;
                                                                                }

    { [{FA9DD52F-9E22-40F7-B98A-5DB11A2AE642}];2 ;OrderHeadID         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::OrderHeadID;
                                                  Import::OnAfterAssignField=VAR
                                                                               SymbrioPurchaseInvHeader@1100285500 : Record 11127980;
                                                                             BEGIN
                                                                               //140220 SYM982 Itero.DL, error handling
                                                                               IF ("Symbrio Purchase Inv. Header".InvoiceHeadID<>'') AND ("Symbrio Purchase Inv. Header".OrderHeadID<>'') THEN
                                                                                 IF SymbrioPurchaseInvHeader.GET("Symbrio Purchase Inv. Header".InvoiceHeadID,"Symbrio Purchase Inv. Header".OrderHeadID) THEN
                                                                                   ERROR(STRSUBSTNO(ImportExistsErr,"Symbrio Purchase Inv. Header".InvoiceHeadID,SymbrioPurchaseInvHeader.OrderHeadID));
                                                                             END;
                                                                              }

    { [{13A926A3-9707-4262-8964-DEDABD20BB27}];2 ;SupplierOrderNo     ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierOrderNo;
                                                  MinOccurs=Zero }

    { [{11B070FA-3D8A-4D83-ACA0-292519C208BD}];2 ;SupplierDeliveryNoteNo;Element;Field  ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierDeliveryNoteNo }

    { [{39158DCB-71AF-4459-905A-C3E0F1C8B9E8}];2 ;InvoiceHeadID       ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::InvoiceHeadID;
                                                  Import::OnAfterAssignField=VAR
                                                                               SymbrioPurchaseInvHeader@1100285500 : Record 11127980;
                                                                             BEGIN
                                                                               //140220 SYM982 Itero.DL, error handling
                                                                               IF ("Symbrio Purchase Inv. Header".InvoiceHeadID<>'') AND ("Symbrio Purchase Inv. Header".OrderHeadID<>'') THEN
                                                                                 IF SymbrioPurchaseInvHeader.GET("Symbrio Purchase Inv. Header".InvoiceHeadID,"Symbrio Purchase Inv. Header".OrderHeadID) THEN
                                                                                   ERROR(STRSUBSTNO(ImportExistsErr,"Symbrio Purchase Inv. Header".InvoiceHeadID,SymbrioPurchaseInvHeader.OrderHeadID));
                                                                             END;
                                                                              }

    { [{EC627F01-A2F2-4D82-81D0-8A95552833EC}];2 ;SupplierInvoiceNo   ;Element ;Text    ;
                                                  DataType=Text }

    { [{BC81B8E9-6ABD-403C-986C-22D0AB43698E}];2 ;VerificationNo      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::VerificationNo }

    { [{176C0952-82A9-4752-9025-7A8E4101308C}];2 ;DebetInvoiceHeadID  ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{9CCB6F3A-E3CA-4E52-8465-2FFD64003BF0}];2 ;SupplierDebetInvoiceNo;Element;Text   ;
                                                  MinOccurs=Zero }

    { [{FE101D40-4B1D-4F8B-A13A-ECD4D352E293}];2 ;WorkOrderNo         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::WorkOrderNo;
                                                  MinOccurs=Zero }

    { [{B2E028E6-D5A9-434A-9201-2A0910BA5918}];2 ;PurchaserIdentification;Element;Field ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::PurchaserIdentification;
                                                  MinOccurs=Zero }

    { [{53FE42B4-278E-42AC-B15C-4C6FBDB9B4E2}];2 ;PurchaserCompanyCode;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::PurchaserCompanyCode }

    { [{7DD07275-FD2A-40D8-BBC7-A57FFD3A8703}];2 ;PurchaserDivisionCode;Element;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::PurchaserDivisionCode }

    { [{28BF8A63-DBA6-488C-82C2-0DEBFE0AADA1}];2 ;SupplierIdentification;Element;Field  ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierIdentification }

    { [{F1EFE8C7-A365-4E27-85FD-2169CE798EDE}];2 ;SupplierCompanyCode ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierCompanyCode }

    { [{249FE3BB-795C-41CC-BEC5-B557BB5A0B7F}];2 ;SupplierDivisionCode;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierDivisionCode }

    { [{A02B9A02-9527-4C17-AB62-1BC155FAABF7}];2 ;InvoiceDate         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::InvoiceDate }

    { [{55258018-3A3A-4591-B4D8-057D42A67805}];2 ;InvoiceDueDate      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::InvoiceDueDate }

    { [{C0E14166-32EC-4B83-8912-D6FC4D09BB49}];2 ;PurchaserCompanyName;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{BCE700D8-DAC4-4968-9C43-349F4498B45E}];2 ;SupplierCompanyName ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{152FED3F-0878-45A9-8672-7DF7DBA4EF71}];2 ;DeliveryReceiver    ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{AD4BA6B8-ABEC-41D9-AEA9-6242C4610112}];2 ;PurchaserVatNo      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::PurchaserVatNo;
                                                  MinOccurs=Zero }

    { [{5FF4FB33-8523-41D9-BE5D-87B0F55A4444}];2 ;SupplierVatNo       ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierVatNo;
                                                  MinOccurs=Zero }

    { [{18C50D9B-713D-465F-A844-8A74D1B703BE}];2 ;PurchaserAddress    ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{4F717F97-B33C-4AFD-AC8A-EF4BE1BF2B87}];2 ;PurchaserPostalCode ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::PurchaserPostalCode;
                                                  MinOccurs=Zero }

    { [{B5C79C4B-1006-4803-A4DA-633425855DA4}];2 ;PurchaserCity       ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{36D127EF-FC60-4740-B0D2-081FE9991395}];2 ;PurchaserCountry    ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::PurchaserCountry;
                                                  MinOccurs=Zero }

    { [{3091F535-A23B-45FE-B536-794126BD050D}];2 ;SupplierAddress     ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{1FAF5EA4-2952-4DCB-8AA7-860E42E02331}];2 ;SupplierPostalCode  ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierPostalCode;
                                                  MinOccurs=Zero }

    { [{78B8151A-EA1F-4F55-BCD7-98D6B8BD75A4}];2 ;SupplierCity        ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{ED098D7D-F46A-4F00-954C-41B4336F1FFE}];2 ;SupplierCountry     ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierCountry;
                                                  MinOccurs=Zero }

    { [{446DFC4D-19BE-4A64-8C89-B1E59BDD3977}];2 ;DeliveryAddress     ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{0B803520-031E-428C-A2FC-F799AB4900BA}];2 ;DeliveryPostalCode  ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::DeliveryPostalCode;
                                                  MinOccurs=Zero }

    { [{996BB7D0-33B8-491C-8ED5-EB66C4893BCC}];2 ;DeliveryCity        ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{57270687-3689-4804-9243-00A908137E1A}];2 ;DeliveryCountry     ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::DeliveryCountry;
                                                  MinOccurs=Zero }

    { [{522BD2F5-3DD4-46EE-8A20-47C41F76BBCF}];2 ;DeliveryAddressNoteText;Element;Text  ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{8C75023C-E918-44F6-9C03-27D2A949EE4A}];2 ;GoodsLabel          ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{B4244723-799F-4F15-9019-290A8288FC2E}];2 ;PurchaserReference  ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{9B7A57A6-B0DF-4644-83A2-EA225F2BF029}];2 ;SupplierReference   ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{588BC220-5C52-4D9B-8001-8F660949550F}];2 ;OrderAuthorizerEmploymentNo;Element;Field;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::OrderAuthorizerEmploymentNo;
                                                  MinOccurs=Zero }

    { [{04008F27-6A02-42ED-8EFE-CD2BB8B15FC1}];2 ;AuthorizationDate   ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::AuthorizationDate }

    { [{E94D5B1C-280D-4F5F-B513-563B367BF3D8}];2 ;InvoiceSource       ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::InvoiceSource }

    { [{6964A60C-CBB0-421B-9582-05DECDB4C896}];2 ;NetSum              ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::NetSum }

    { [{26200431-923D-4178-980A-5527AD35857D}];2 ;NetAdjustment       ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::NetAdjustment }

    { [{56664EB4-77B7-43BB-A970-FB15471CABD4}];2 ;VatSum              ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::VatSum }

    { [{F84E2EB7-7AC6-4EC6-BA59-79218CB2B0D7}];2 ;VATCode             ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::VATCode }

    { [{70EF76BA-37B9-4E73-913C-B6FDB4B433D0}];2 ;TotalSum            ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::TotalSum }

    { [{1A620816-3C91-4B1A-9CEF-433A2CD1BE0E}];2 ;Currency            ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::Currency }

    { [{E80B0291-EF41-4BFF-8D09-C39A25187427}];2 ;InvoiceType         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::InvoiceType }

    { [{0307C9CB-FC95-45A8-BFA2-DDB0AE0E38FC}];2 ;InvoiceStatus       ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::InvoiceStatus }

    { [{E893A557-9468-4C45-9290-14F4B833557D}];2 ;PurchaserCountryCode;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::PurchaserCountryCode;
                                                  MinOccurs=Zero }

    { [{A68B4FCA-64D8-4B96-A717-D9E25DC838B0}];2 ;ArrivalDate         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::ArrivalDate }

    { [{B802EB99-0F53-42D2-913B-B69F6EC93796}];2 ;RegisteredDate      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::RegisteredDate }

    { [{F2285E6B-8E96-495D-A3EC-1414E56E8542}];2 ;AccountHolder1      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::AccountHolder1;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{A5251826-B404-4D8C-9F5A-12F604AE30B9}];2 ;AccountHolder2      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::AccountHolder2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{3029E26E-CB2B-4E68-8A7B-2C2922A74D85}];2 ;PaymentReference    ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::PaymentReference;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{BBD4A1C8-0FB1-4962-A37A-032AC55A2611}];2 ;SupplierNote        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::SupplierNote;
                                                  MinOccurs=Zero }

    { [{03AA81F6-C43E-4CAF-BAEA-EEFA3780F76A}];2 ;OrderType           ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::OrderType }

    { [{1BBCB239-8DA4-453E-B160-7C5686106257}];2 ;OrderStatus         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Header::OrderStatus;
                                                  MinOccurs=Zero }

    { [{92D1DDBB-7E03-4E2E-8DAA-E31E8C417D90}];2 ;InvoiceLine         ;Element ;Text     }

    { [{57DD4526-B405-4B5E-ABB7-BA67FA7015B4}];3 ;InvoiceLineID       ;Element ;Text    ;
                                                  DataType=Text;
                                                  Import::OnAfterAssignVariable=BEGIN

                                                                                  ArticleNo:='';
                                                                                  ArticleBranchNo:='';
                                                                                  ArticleName:='';
                                                                                  Quantity:='';
                                                                                  QuantityMeasurement:='';
                                                                                  DeliveryDate:='';
                                                                                  GrossPrice:='';
                                                                                  Discount:='';
                                                                                  NetPrice:='';
                                                                                  LineSum:='';
                                                                                  VAT:='';
                                                                                  BranchName:='';
                                                                                  SupplierNote:='';
                                                                                  OrderLinePosition:='';

                                                                                  Amount:='';
                                                                                  AuthorizerEmploymentNo:='';
                                                                                  AuthorizerFirstName:='';
                                                                                  AuthorizerLastName:='';
                                                                                  AuthorizerEmail:='';
                                                                                  AuthorizerPLCode:='';
                                                                                  AccountRef:='';
                                                                                  AccountType:='';
                                                                                  AccountSuffix:='';
                                                                                  SuffixType:='';
                                                                                END;
                                                                                 }

    { [{B057A142-7ABF-4C55-A889-FB56BA47A29F}];3 ;ArticleNo           ;Element ;Text    ;
                                                  DataType=Text }

    { [{552D8913-3695-4E6A-87F6-533EE4632C2F}];3 ;ArticleBranchNo     ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{FDB8F4FA-47C2-4849-B5B7-423114659155}];3 ;ArticleName         ;Element ;Text    ;
                                                  DataType=Text }

    { [{8EF5D15F-CDBE-4E6D-B28D-EB274369B449}];3 ;Quantity            ;Element ;Text    ;
                                                  DataType=Text }

    { [{8167BCE3-BA56-4DC3-ADC6-7A390422E673}];3 ;QuantityMeasurement ;Element ;Text    ;
                                                  DataType=Text }

    { [{CDB7C421-E59C-45B5-A5CE-3A018F90AD5D}];3 ;DeliveryDate        ;Element ;Text    ;
                                                  DataType=Text }

    { [{9D4ACDDA-39C2-4CC9-8C29-9EB41CBFD3E4}];3 ;GrossPrice          ;Element ;Text    ;
                                                  DataType=Text }

    { [{013F736B-976E-427E-994F-9443DC856D62}];3 ;Discount            ;Element ;Text    ;
                                                  DataType=Text }

    { [{254BE8BB-CD94-496B-AEE7-73BC7F95984A}];3 ;NetPrice            ;Element ;Text    ;
                                                  DataType=Text }

    { [{9ED05762-4FFD-42C7-A1BB-ACBF1B650131}];3 ;LineSum             ;Element ;Text    ;
                                                  DataType=Text }

    { [{8B653A20-07C8-43A2-AD89-C11760364078}];3 ;VAT                 ;Element ;Text    ;
                                                  DataType=Text }

    { [{5FE775A5-C710-46C3-A6F6-2BCD1757B891}];3 ;BranchName          ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{5B64D858-07DF-491F-AD0C-3A3E7ECEDD96}];3 ;SupplierNote        ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{5213E581-9613-4B17-8378-F5781B870BD2}];3 ;OrderLinePosition   ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{C0EAB369-0593-4D58-A494-032007A8BDD0}];3 ;AccountLine         ;Element ;Table   ;
                                                  SourceTable=Table11127981;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 SymbrioPurchaseInvLine2@1100285500 : Record 11127981;
                                                                                 lCurrency@1100285501 : Record 4;
                                                                                 orderrefdec@1100285100 : Decimal;
                                                                                 maxinteger@1100285101 : Integer;
                                                                               BEGIN

                                                                                 //>>140109 SYM973
                                                                                 SymbrioPurchaseInvLine2.SETRANGE(InvoiceHeadID,"Symbrio Purchase Inv. Header".InvoiceHeadID);
                                                                                 SymbrioPurchaseInvLine2.SETRANGE(OrderHeadID,"Symbrio Purchase Inv. Header".OrderHeadID);
                                                                                 SymbrioPurchaseInvLine2.SETRANGE(InvoiceLineID,InvoiceLineID);
                                                                                 //<<140109 SYM973
                                                                                 IF SymbrioPurchaseInvLine2.FINDLAST THEN
                                                                                   LineNo:=SymbrioPurchaseInvLine2.LineNo+10000
                                                                                 ELSE
                                                                                   LineNo := 10000;

                                                                                 "Symbrio Purchase Inv. Line".InvoiceHeadID:="Symbrio Purchase Inv. Header".InvoiceHeadID;
                                                                                 "Symbrio Purchase Inv. Line".OrderHeadID:="Symbrio Purchase Inv. Header".OrderHeadID;
                                                                                 "Symbrio Purchase Inv. Line".InvoiceLineID := InvoiceLineID;
                                                                                 "Symbrio Purchase Inv. Line".LineNo := LineNo;
                                                                                 "Symbrio Purchase Inv. Line"."DateTime Received" := keyDateTime; //"Symbrio Purchase Inv. Header"."DateTime Received";
                                                                                 "Symbrio Purchase Inv. Line"."EntryNo in BatchRead":= entryId;//"Symbrio Purchase Inv. Header"."EntryNo in BatchRead";
                                                                                 //>>140107 SYM973
                                                                                 NetPriceDec := Str2Dec(NetPrice);
                                                                                 AmountDec := Str2Dec(Amount);
                                                                                 //>>140115 SYM014
                                                                                 EVALUATE(QtyDec, Quantity);
                                                                                 IF QtyDec <> 0 THEN BEGIN

                                                                                 //>>SYM079, move code from import to processInvoice
                                                                                 ////>>SYM039
                                                                                 //IF "Symbrio Purchase Inv. Header".Currency = '' THEN
                                                                                 //  lCurrency.InitRoundingPrecision
                                                                                 //ELSE BEGIN
                                                                                 //  lCurrency.GET("Symbrio Purchase Inv. Header".Currency);
                                                                                 //  lCurrency.TESTFIELD("Amount Rounding Precision");
                                                                                 //END;
                                                                                 ////<<SYM039
                                                                                 //
                                                                                 ////>>SYM024
                                                                                 //  SymQty := QtyDec;
                                                                                 //  IF NetPriceDec <> 0 THEN
                                                                                 ////<<SYM024
                                                                                 //  SymQty := AmountDec/NetPriceDec;
                                                                                 //  //>>140115 SYM012
                                                                                 //  Direction := '=';
                                                                                 ////>>SYM029
                                                                                 //  //Precision := 0.1;
                                                                                 //  Precision := 0.00001;
                                                                                 //  Precision := lCurrency."Amount Rounding Precision";  //SYM039
                                                                                 ////<<SYM029
                                                                                 //  QtyResult := ROUND(SymQty, Precision, Direction);
                                                                                 //  //<<140115 SYM012
                                                                                 //
                                                                                 //  //<<140115
                                                                                   QtyResult := QtyDec;
                                                                                 //<<SYM079

                                                                                   "Symbrio Purchase Inv. Line".NetPrice:=NetPrice;

                                                                                 END ELSE BEGIN

                                                                                   QtyResult := 1;
                                                                                   "Symbrio Purchase Inv. Line".NetPrice:=Amount;

                                                                                 //>>140225, DL, SYM992
                                                                                   IF "Symbrio Purchase Inv. Header".InvoiceType = 'Credit' THEN BEGIN   //and qty=0
                                                                                     "Symbrio Purchase Inv. Line".NetPrice:=FORMAT(-AmountDec,0,1); //>>140306 SYM995
                                                                                     QtyResult := -1;
                                                                                   END;
                                                                                 //<<140225, DL, SYM992

                                                                                 END;
                                                                                 //<<140115 SYM014
                                                                                 //<<140107 SYM973

                                                                                 "Symbrio Purchase Inv. Line".ArticleNo:= COPYSTR(ArticleNo,1,MAXSTRLEN("SymbrioPurchaseInv.Line".ArticleNo));
                                                                                 "Symbrio Purchase Inv. Line".ArticleBranchNo:= COPYSTR(ArticleBranchNo,1,MAXSTRLEN("SymbrioPurchaseInv.Line".ArticleBranchNo));
                                                                                 //>>140409 SYM016 ITERO.DJ
                                                                                 //"Symbrio Purchase Inv. Line".ArticleName:=ArticleName;
                                                                                 "Symbrio Purchase Inv. Line".ArticleName := COPYSTR(ArticleName, 1,MAXSTRLEN("SymbrioPurchaseInv.Line".ArticleName));
                                                                                 //<<140409 SYM016 ITERO.DJ
                                                                                 //>>140107 SYM973
                                                                                 "Symbrio Purchase Inv. Line".Quantity := FORMAT(QtyResult, 0, 1);
                                                                                 //<<140107 SYM973
                                                                                 "Symbrio Purchase Inv. Line".QuantityMeasurement:=QuantityMeasurement;
                                                                                 "Symbrio Purchase Inv. Line".DeliveryDate:=DeliveryDate;
                                                                                 "Symbrio Purchase Inv. Line".GrossPrice:=GrossPrice;
                                                                                 "Symbrio Purchase Inv. Line".Discount:=Discount;
                                                                                 //>>140115 SYM014
                                                                                 //"Symbrio Purchase Inv. Line".NetPrice:=NetPrice;
                                                                                 //<<140115 SYM014
                                                                                 "Symbrio Purchase Inv. Line".LineSum:=LineSum;
                                                                                 "Symbrio Purchase Inv. Line".VAT:=VAT;
                                                                                 "Symbrio Purchase Inv. Line".BranchName:=BranchName;
                                                                                 //"Symbrio Purchase Inv. Line"."Date Received":= DT2DATE(keyDateTime); //TODAY();
                                                                                 //"Symbrio Purchase Inv. Line"."Time Received":= DT2TIME(keyDateTime); //TIME();
                                                                                 "Symbrio Purchase Inv. Line"."Source Filename":=SourceFilename;
                                                                                 //>>SYM994
                                                                                 "Symbrio Purchase Inv. Line"."Date Last Modified":=varDate;
                                                                                 "Symbrio Purchase Inv. Line"."Time Last Modified":=varTime;
                                                                                 //<<SYM994

                                                                                 "Symbrio Purchase Inv. Line".OrderLinePosition:=OrderLinePosition;

                                                                                 "Symbrio Purchase Inv. Line".Amount:=Amount;
                                                                                 "Symbrio Purchase Inv. Line".AuthorizerFirstName:=AuthorizerFirstName;
                                                                                 "Symbrio Purchase Inv. Line".AuthorizerLastName:=AuthorizerLastName;
                                                                                 "Symbrio Purchase Inv. Line".AuthorizerEmail:=AuthorizerEmail;
                                                                                 "Symbrio Purchase Inv. Line".AuthorizerPLCode:=AuthorizerPLCode;

                                                                                 //pure286298
                                                                                 IF "Symbrio Purchase Inv. Line".OrderLinePosition <> '' THEN
                                                                                   IF EVALUATE(orderrefdec,"Symbrio Purchase Inv. Line".OrderLinePosition) THEN BEGIN
                                                                                     maxinteger:= 2147483647;
                                                                                     IF orderrefdec > (maxinteger / 10000) THEN BEGIN
                                                                                       WHILE orderrefdec > (maxinteger / 10000) DO
                                                                                         orderrefdec := orderrefdec / 10;
                                                                                       "Symbrio Purchase Inv. Line".OrderLinePosition := FORMAT(orderrefdec,0,1);
                                                                                     END;
                                                                                   END;
                                                                               END;

                                                  Import::OnAfterInsertRecord=BEGIN


                                                                                //PrevLineID:=InvoiceLineID;
                                                                              END;
                                                                               }

    { [{12F908B3-9701-4EB1-A82D-EDBBB4D31FBC}];4 ;Amount              ;Element ;Text    ;
                                                  DataType=Text }

    { [{7505EA4E-3836-4D7B-9542-EC236878539E}];4 ;AuthorizerEmploymentNo;Element;Text   ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{CF489D05-D14C-4C2A-BBD4-E881D7FFF004}];4 ;AuthorizerFirstName ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{17D5C775-7712-4018-96BC-03A4E71E5610}];4 ;AuthorizerLastName  ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{F00BB604-494B-4551-91D9-60ABCB19030E}];4 ;AuthorizerEmail     ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{1DA85CB9-230F-45AB-B310-1246F3C0FBB0}];4 ;AuthorizerPLCode    ;Element ;Text    ;
                                                  DataType=Text;
                                                  MinOccurs=Zero }

    { [{97ED9100-63AF-4C32-9A9D-4623419D4B20}];4 ;AccountRef          ;Element ;Text    ;
                                                  Import::OnAfterAssignVariable=BEGIN
                                                                                  CASE AccountType OF
                                                                                    'Project':           "Symbrio Purchase Inv. Line".VALIDATE(AccountRefProject,AccountRef);
                                                                                    'BaseAccount':       "Symbrio Purchase Inv. Line".VALIDATE(AccountRefBaseAccount,AccountRef);
                                                                                    'Object':            "Symbrio Purchase Inv. Line".VALIDATE(AccountRefObject,AccountRef);
                                                                                    'RemainingAccount':  "Symbrio Purchase Inv. Line".VALIDATE(AccountRefRemAccount,AccountRef);
                                                                                    'Periodizing':       "Symbrio Purchase Inv. Line".VALIDATE(AccountRefPeriodizing,AccountRef);
                                                                                    'Perioddatum':       "Symbrio Purchase Inv. Line".VALIDATE(AccountRefPerioddatum,AccountRef);
                                                                                  END;

                                                                                  AccountRef:='';
                                                                                  AccountType:='';
                                                                                END;
                                                                                 }

    { [{754E61B4-BD3F-43C3-B680-0B01E70D406E}];5 ;AccountType         ;Attribute;Text   ;
                                                  Occurrence=Optional }

    { [{03AD9511-8B88-44A6-BC7F-D88FD6E57E47}];4 ;AccountSuffix       ;Element ;Text    ;
                                                  Import::OnAfterAssignVariable=BEGIN
                                                                                  CASE SuffixType OF
                                                                                    'TA':           "Symbrio Purchase Inv. Line".VALIDATE(AccountSuffixTA,AccountSuffix);
                                                                                    'PurchaseType':  "Symbrio Purchase Inv. Line".VALIDATE(AccountSuffixPurchType,AccountSuffix);
                                                                                  END;

                                                                                  SuffixType:='';
                                                                                  AccountSuffix:='';
                                                                                END;
                                                                                 }

    { [{AC67DEB2-7F67-431D-8EFC-AD81931BEDD7}];5 ;SuffixType          ;Attribute;Text   ;
                                                  Occurrence=Optional }

    { [{4E3F97F3-2E7E-4EBC-95C2-E52FAE124A81}];2 ;InvoiceImages       ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{B1812DCE-1255-4BFA-8E39-1A071F1F922B}];3 ;numberOfPages       ;Attribute;Text    }

    { [{F0662B18-C221-4950-87DD-6BDD9E3EC91A}];3 ;InvoiceImage        ;Element ;Table   ;
                                                  SourceTable=Table11127990;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //RFC136
                                                                                 IF "Symbrio Purchase Inv. Images".name = '' THEN
                                                                                   currXMLport.SKIP;

                                                                                 "Symbrio Purchase Inv. Images".InvoiceHeadID := "Symbrio Purchase Inv. Header".InvoiceHeadID;
                                                                                 "Symbrio Purchase Inv. Images".OrderHeadID := "Symbrio Purchase Inv. Header".OrderHeadID;
                                                                                 "Symbrio Purchase Inv. Images"."DateTime Received" := keyDateTime;
                                                                                 "Symbrio Purchase Inv. Images"."EntryNo in BatchRead" := entryId;
                                                                                 //"Symbrio Purchase Inv. Images"."Date Received" := DT2DATE(keyDateTime);
                                                                                 //"Symbrio Purchase Inv. Images"."Time Received" := DT2TIME(keyDateTime);
                                                                               END;

                                                  Import::OnAfterInsertRecord=VAR
                                                                                dotNetFile@1100285300 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.File";
                                                                              BEGIN
                                                                                //RFC136
                                                                                //move file
                                                                                IF dotNetFile.Exists(SymbrioSetup."Path Invoice Import" + "Symbrio Purchase Inv. Images".name) THEN BEGIN
                                                                                  //move doesnt overwrite if target exists
                                                                                  IF dotNetFile.Exists(SymbrioSetup."Path Invoice Import Img Buffer" + "Symbrio Purchase Inv. Images".name) THEN
                                                                                    dotNetFile.Delete(SymbrioSetup."Path Invoice Import Img Buffer" + "Symbrio Purchase Inv. Images".name);
                                                                                  dotNetFile.Move(
                                                                                    SymbrioSetup."Path Invoice Import" +            "Symbrio Purchase Inv. Images".name,
                                                                                    SymbrioSetup."Path Invoice Import Img Buffer" + "Symbrio Purchase Inv. Images".name);
                                                                                END;
                                                                              END;
                                                                               }

    { [{2700D6C6-69B3-48FA-B463-B5680B1FDF49}];4 ;imageIndex          ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Images::imageIndex }

    { [{00449AF1-AD5C-4FD5-8A2E-1C499772CE20}];4 ;mimeType            ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Images::mimeType;
                                                  Occurrence=Optional }

    { [{64429814-3676-4196-BD7F-5AB5F06E7C14}];4 ;encoding            ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Images::encoding;
                                                  Occurrence=Optional }

    { [{2FBA5FD6-4307-4D13-A67C-67B5891EB042}];4 ;name                ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=Symbrio Purchase Inv. Images::name }

    { [{9D5DF190-0094-4CCC-9D73-2EBFE95FED22}];2 ;Attachments         ;Element ;Text     }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      i@1100285000 : Integer;
      SymbrioPurchInvAccRef@1100285001 : Record 11127983;
      SourceFilename@1100285002 : Text[250];
      "SymbrioPurchaseInv.Line"@1100285500 : Record 11127981;
      NewLine@1100285501 : Boolean;
      LineNo@1100285502 : Integer;
      PrevLineID@1100285503 : Text;
      SymQty@1100285504 : Decimal;
      NetPriceDec@1100285505 : Decimal;
      AmountDec@1100285506 : Decimal;
      QtyDec@1100285507 : Decimal;
      Direction@1100285508 : Text;
      Precision@1100285509 : Decimal;
      QtyResult@1100285510 : Decimal;
      ImportExistsErr@1100285511 : TextConst 'ENU=Invoice %1, Order %2  already exists!';
      varDate@1100285512 : Date;
      varTime@1100285513 : Time;
      FullSourceFilename@1100285514 : Text[250];
      Text001@1100285518 : TextConst 'ENU=Order: %1 doesn''t exist;SVE=Order: %1 finns inte';
      SymbrioPurchaseHeader@1100285515 : Record 11127978;
      SymbrioSetup@1100285300 : Record 11127975;
      keyDateTime@1100409000 : DateTime;
      entryId@1100285100 : Integer;

    PROCEDURE SetFileName@1100285000(filename@1100285000 : Text[250];fullfilename@1100285500 : Text);
    BEGIN
      SourceFilename:=filename;
      FullSourceFilename := fullfilename;

      IF FullSourceFilename = '' THEN
        FullSourceFilename := SourceFilename;
    END;

    PROCEDURE Str2Dec@1100285001(StrNumber@1100285000 : Text[250]) Return : Decimal;
    VAR
      pos@1100285002 : Integer;
      Before@1100285004 : Integer;
      After@1100285003 : Integer;
      BeforeStr@1100285006 : Text[250];
      AfterStr@1100285005 : Text[250];
      i@1100285001 : Integer;
      exp@1100285007 : Integer;
      Neg@1100285008 : Boolean;
    BEGIN
      // Function to generate a decimal out of a text which contains either no decimal sign or the decimal sign . or ,
      IF (STRLEN(StrNumber)) = 0 THEN EXIT(0);

      Neg := FALSE;
      IF (StrNumber[1] = '-') THEN Neg := TRUE;

      pos := STRLEN(StrNumber);
      IF (pos > 1) THEN REPEAT
         pos -= 1;
      UNTIL (pos = 1) OR (StrNumber[pos] = '.') OR (StrNumber[pos] = ',');
      IF (pos = 1) THEN
         EVALUATE(Return, StrNumber)
      ELSE BEGIN
         BeforeStr := COPYSTR(StrNumber, 1, pos - 1);
         AfterStr := COPYSTR(StrNumber, pos + 1);
         EVALUATE(Before, BeforeStr);
         EVALUATE(After, AfterStr);
         exp := 10;

         FOR i := 1 TO (STRLEN(StrNumber) - pos - 1) DO BEGIN
            exp := exp * 10;
         END;
         IF Before >= 0 THEN
            Return := Before + After / exp
         ELSE
            Return := Before - After / exp;
      END;
      IF (Neg) AND (Return > 0) THEN Return := -Return;
    END;

    BEGIN
    {
      131112 I045#P6 Symbrio Invoice Handling - created xml port to import Symbrio Invoice file
      131121 Fileds added
      131129 SYM-005 ArticleBranchNo,BranchName,OrderLinePosition changed prop. (minocc.=0)
      131203 SYM960 Changed minOccurs setting on fields + added findlast in postxmlport
      131209 SYM970 New tags in credit memo, DebetInvoiceHeadID & SupplierDebetInvoiceNo
      140107 SYM973 added function str2dec, and new calculation for quantity
      140109 SYM973 new calculation of LineNo
      140115 SYM014 new calculation if quantity from file = 0
      140115 SYM012 rounding to make sure qty has only one decimal
      140121 SYM980, SYM013 changed purchaseridentification to "Minoccurs"=Zero
      140122 SYM973 Changed qty from file from int to decimal
      140220 ENHSYM002 added orderstatus
      140225 SYM992 DL  handle creditmemos with qty=0 on the line
      140305 SYM994 added fileinformation fields time last modified,date last modified
      140306 SYM995 change to reginal setting . > ,
      140319 ITERO.DL added fullname into import
      140409 ITERO.DJ SYM016 handle invoice decription longer than 100ch with unknown item
      140414 ITERO.DJ SYM-ENH-006 handle invoice with invoicestatus = discarded
      140625 SYM999 cut of after max no of characters for several fields
      140701 ITERO.DL SYM025 Invoice with linked order when order placed in Symbrio error buffer
      140728 ITERO.DL SYM024 'divide by zero'
      140926 ITERO.DL SYM029 Error with rounding of invoice quantities
      141023 ITERO.DL code cleanup
      141208 ITERO.DL SYM039 Incorrectly calculated quantities for posted invoices
      150316 ITERO.WG SYM064 Added check if order exist in Symbrio Purchase Buffer
      150316 ITERO.MH IME251 Added field PaymentReference to be imported to PaymentReference in table
      151013 ITERO.SB Attribute 'AccountType' is optional
      160323 ITERO.DL RFC136/Radiator handle inv.images from Symbrio
      160323 ITERO.DL altered key head-line-images
      160428 ITERO.DL prepare for new prim-key, new fields "Symbrio Purchase Inv. Header"."DateTime Received", "Symbrio Purchase Inv. Header"."EntryNo in BatchRead"
      160909 ITERO.DL RFC136 view attached documents (from Symbrio), new fields
          Symbrio Purchase Inv. Header::SupplierNote
          Symbrio Purchase Inv. Header::SupplierOrderNo
      171219 ITERO.DL pure286298 value OrderLinePosition exceeds MaxInteger
      190514 ORANGO.PR RFC-1190 Added field AccountHolder1, AccountHolder2 to be imported to AccountHolder1, AccountHolder2 in table
    }
    END.
  }
}

