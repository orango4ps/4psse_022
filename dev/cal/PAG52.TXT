OBJECT Page 52 Purchase Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00,EXF;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Credit Memo;
               NOR=Kjõpskreditnota;
               SVE=Inkîpskreditnota];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Credit Memo));
    PageType=Document;
    TimerUpdate=1;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Request Approval,Credit Memo,Release,Posting,Navigate,Mail Documents;
                                NOR=Ny,Prosess,Rapport,Godkjenn,Be om godkjenning,Kreditnota,Frigi,Bokfõring,Naviger;
                                SVE=Ny,Process,Rapport,GodkÑnn,BegÑr godkÑnnande,Kreditnota,SlÑpp,Bokfîring,Navigera];
    OnInit=VAR
             PurchasesPayablesSetup@1000 : Record 312;
           BEGIN
             JobQueueUsed := PurchasesPayablesSetup.JobQueueActive;
             SetExtDocNoMandatoryCondition;

             //**4PS.sn
             "Amount excl. VATEditable" := TRUE;
             "VAT AmountEditable" := TRUE;
             MemoWKAEditable := TRUE;
             WageChargetoTaxAuthorityEditab := TRUE;
             WageChargetoBAccountEditable := TRUE;
             "Pay To Tax AuthorityEditable" := TRUE;
             "Labor AmountEditable" := TRUE;
             "Avg. Wage RateEditable" := TRUE;
             "Number of HoursEditable" := TRUE;
             "Actual End DateEditable" := TRUE;
             "Actual Effective DateEditable" := TRUE;
             "Payment AgreementEditable" := TRUE;
             "Ext. Document IDEditable" := TRUE;
             "Ext. Document IDVisible" := TRUE;
             "Interest DateVisible" := TRUE;
             PayVATAmtOnBAccountVendorEditable := TRUE;
             //**4PS.en
           END;

    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
                 PermissionManager@1001 : Codeunit 9002;
                 lvInterestCalcMgtCU@1210190000 : Codeunit 11012049;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 SetDocNoVisible;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
                 IsSaaS := PermissionManager.SoftwareAsAService;

                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;
                 IF ("No." <> '') AND ("Buy-from Vendor No." = '') THEN
                   DocumentIsPosted := (NOT GET("Document Type","No."));

                 ActivateFields;

                 //**4PS.sn
                 PurchSetup.GET;
                 IF NOT lvInterestCalcMgtCU.PermissionInterestGranule() THEN
                   "Interest DateVisible" := (FALSE);
                 BankAccountSelectEditable := PurchSetup."Invoices on Bank Account";
                 BankNoCheckEditable := PurchSetup."Bank Account Check";
                 IF PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Other THEN BEGIN
                   "Ext. Document IDEditable" := FALSE;
                   "Ext. Document IDVisible" := (FALSE);
                 END;
                 DCActive := IsDocumentCaptureActive;
                 //**4PS.en
               END;

    OnAfterGetRecord=BEGIN
                       CalculateCurrentShippingOption;

                       //**4PS.sn
                       SetControlAppearance;

                       IF gFromReference THEN BEGIN
                         gFromReference := FALSE;
                         CurrPage.PurchLines.PAGE.InitSelectionFromReference(gInvLineNo);
                       END;

                       FillSelectBankAccount;

                       gvAmount := 0;

                       IF ("No." <> xRec."No.") THEN
                         WhiteVisionStop;
                       //**4PS.en
                     END;

    OnNewRecord=BEGIN
                  WhiteVisionStop; //**4PS.n

                  "Responsibility Center" := UserMgt.GetPurchasesFilter;

                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetBuyFromVendorFromFilter;

                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02

                  //**4PS.sn
                  SetFieldsEditable;
                  BankAccountSelect := '';
                  //**4PS.en
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT DocumentIsPosted THEN
                         EXIT(ConfirmCloseUnposted);
                     END;

    OnAfterGetCurrRecord=VAR
                           RecRef@1100528700 : RecordRef;
                         BEGIN
                           SetControlAppearance;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.ApprovalFactBox.PAGE.UpdateApprovalEntriesFromSourceRecord(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           //**4PS.sn
                           PurchHeadExtensionRec.GetPurchHeadExtension("Document Type", "No.");
                           SetFieldsEditable;

                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Shortcut Dimension 1 Code");

                           FillDocumentViewerFactbox;
                           //**4PS.en
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Credit Memo;
                                 NOR=&Kreditnota;
                                 SVE=&Kreditnota];
                      Image=CreditMemo }
      { 49      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#Basic,#Suite;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 PAGE.RUNMODAL(PAGE::"Purchase Statistics",Rec);
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverandõren i kjõpsdokumentet.;
                                 SVE=Visa eller redigera detaljerad information om leverantîren pÜ inkîpsdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Enabled="Buy-from Vendor No." <> '';
                      Image=Vendor;
                      PromotedCategory=Category9 }
      { 105     ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera mÜtt, till exempel omrÜde, projekt eller avdelning, som du kan tilldela till fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 43      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Approvals;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 WorkflowsEntriesBuffer@1001 : Record 832;
                               BEGIN
                                 WorkflowsEntriesBuffer.RunWorkflowEntriesPage(RECORDID,DATABASE::"Purchase Header","Document Type","No.");
                               END;
                                }
      { 12013596;2   ;Separator  }
      { 12013597;2   ;Action    ;
                      Name=<Action1100285004>;
                      ShortCutKey=Ctrl+I;
                      CaptionML=[ENU=Show document;
                                 SVE=Visa dokument];
                      Image=Document;
                      OnAction=BEGIN
                                 // ExFlow ->
                                 ExFlow.ShowImageDocument("Document Type","No.");
                                 // <- ExFlow
                               END;
                                }
      { 12013598;2   ;Action    ;
                      Name=<Action1100285005>;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=Attached Fil&es;
                                 SVE=&Bilagor];
                      RunObject=Page 12013644;
                      RunPageView=SORTING(Document Type,Document No.,Attached);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Image=Documents }
      { 51      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category6 }
      { 924     ;2   ;Action    ;
                      Name=DocAttach;
                      CaptionML=[ENU=Attachments;
                                 NOR=Vedlegg;
                                 SVE=Bilagor];
                      ToolTipML=[ENU=Add a file as an attachment. You can attach images as well as documents.;
                                 NOR=Legg til en fil som vedlegg. Du kan legge ved bilderˇog dokumenter.;
                                 SVE=LÑgg till en fil som en bilaga. Du kan bifoga bilder och dokument.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Image=Attach;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1000 : Page 1173;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 1100485000;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+S;
                      CaptionML=[ENU=Scanned Document;
                                 SVE=Skannade dokument];
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 lvPurchSetupRec@1100485003 : Record 312;
                               BEGIN
                                 //**4PS
                                 lvPurchSetupRec.GET;
                                 lvPurchSetupRec.ShowScannedDocument(3,"No.","Buy-from Vendor No.","Ext. Document ID");
                               END;
                                }
      { 1210190016;2 ;Action    ;
                      CaptionML=[ENU=&Documents;
                                 SVE=&Dokument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 99      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 SVE=Ra&d] }
      { 1210190011;2 ;Action    ;
                      CaptionML=[ENU=ICF Specifications;
                                 SVE=ICF-specifikationer];
                      Image=SetupList;
                      OnAction=BEGIN
                                 ShowICFInvoiceLines;  //**4PS
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning;
                                 SVE=GodkÑnnande] }
      { 25      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn;
                                 SVE=GodkÑnn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.;
                                 SVE=GodkÑnn de begÑrda fîrÑndringarna.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                                 ApprovalEntry@1100528200 : Record 454;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                                 //**4PS.sn
                                 IF NOT ApprovalsMgmt.FindOpenApprovalEntryForCurrUser(ApprovalEntry,RECORDID) THEN
                                   MARK(FALSE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      ToolTipML=[ENU=Reject the approval request.;
                                 NOR=Avvis godkjenningsforespõrselen.;
                                 SVE=Avvisa godkÑnnandebegÑran.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger;
                                 SVE=Delegera];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.;
                                 SVE=Delegera godkÑnnandet till en ersÑttare.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader;
                                 SVE=Kommentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 1100525009;2 ;Action    ;
                      CaptionML=[ENU=Approval Comment;
                                 SVE=GodkÑnnandekommentar];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=NOT OpenApprovalEntriesExist;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalManagement4PSConstr@1100525000 : Codeunit 11125349;
                               BEGIN
                                 ApprovalManagement4PSConstr.PurchHdrApprovalCommentsWithoutApproval(Rec);
                               END;
                                }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑpp];
                      Image=ReleaseDoc }
      { 112     ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=Fri&gi;
                                 SVE=&SlÑpp];
                      ToolTipML=[ENU=Release the document to the next stage of processing. When a document is released, it will be included in all availability calculations from the expected receipt date of the items. You must reopen the document before you can make changes to it.;
                                 NOR=Frigi dokumentet til neste behandlingsfase. NÜr et dokument frigis, tas det med i alle tilgjengelighetsberegninger fra den forventede mottaksdatoen for varene. Du mÜ Üpne dokumentet pÜ nytt fõr du kan gjõre endringer i det.;
                                 SVE=SlÑpp dokumentet till nÑsta etapp i bearbetningen. NÑr ett dokument slÑpps, tas det med i alla dispositionsberÑkningar frÜn och med artiklarnas planerade inleveransdatum. Du mÜste îppna dokumentet igen innan du kan Ñndra i det.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Category7;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 113     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=&èpne pÜ nytt;
                                 SVE=&ôppna igen];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed.;
                                 NOR=èpne dokumentet pÜ nytt for Ü endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de mÜ Üpnes fõr de kan endres.;
                                 SVE=ôppna dokumentet igen och Ñndra det efter att det har godkÑnts. GodkÑnda dokument har statusen SlÑppt och mÜste îppnas innan de kan Ñndras.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      Image=ReOpen;
                      PromotedCategory=Category7;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 52      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner;
                                 SVE=Fu&nktion];
                      Image=Action }
      { 127     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get St&d. Vend. Purchase Codes;
                                 NOR=Hent st&d. kjõpskode for lev.;
                                 SVE=HÑmta st&d. lev.inkîpskoder];
                      ToolTipML=[ENU=View a list of the standard purchase lines that have been assigned to the vendor to be used for recurring purchases.;
                                 NOR=Vis en liste over standard kjõpslinjer som er tilordnet til leverandõren som skal brukes for gjentakende kjõp.;
                                 SVE=Visa en lista îver de standardinkîpsrader som har tilldelats leverantîren och som ska anvÑndas fîr Üterkommande inkîp.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Image=VendorCode;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 53      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 24=R;
                      CaptionML=[ENU=Calculate &Invoice Discount/Charge;
                                 NOR=&Beregn fakturarabatt;
                                 SVE=BerÑkna &fakturarabatt];
                      ToolTipML=[ENU=Calculate the invoice discount for the entire document.;
                                 NOR=Beregne fakturarabatten for hele dokumentet.;
                                 SVE=BerÑkna fakturarabatten fîr hela dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 128     ;2   ;Separator  }
      { 93      ;2   ;Action    ;
                      Name=ApplyEntries;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 NOR=Utlign poster;
                                 SVE=Koppla transaktioner];
                      ToolTipML=[ENU=Apply open entries for the relevant account type.;
                                 NOR=Utlign Üpne poster for den relevante kontotypen.;
                                 SVE=AnvÑnd îppna transaktioner fîr den relevanta kontotypen.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Purchase Header Apply",Rec);
                               END;
                                }
      { 129     ;2   ;Separator  }
      { 1210190007;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Allo&cation;
                                 SVE=HÑmta till&delning];
                      Visible=FALSE;
                      Image=LedgerEntries;
                      OnAction=VAR
                                 GetAllocation@1210190000 : Codeunit 11012048;
                               BEGIN
                                 GetAllocation.PurchaseHeader(Rec);
                               END;
                                }
      { 1210190002;2 ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Get Receipt Lines;
                                 SVE=HÑmta inleveransrader];
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.PurchLines.PAGE.GetReceipt;
                               END;
                                }
      { 143     ;2   ;Action    ;
                      Name=GetPostedDocumentLinesToReverse;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Posted Doc&ument Lines to Reverse;
                                 NOR=Hent bokfõrte dok&umentlinjer som skal tilbakefõres;
                                 SVE=HÑmta bokfîrda dok&umentrader som ska Üterfîras];
                      ToolTipML=[ENU=Copy one or more posted purchase document lines in order to reverse the original order.;
                                 NOR=Kopier Çn eller flere bokfõrte kjõpsdokumentlinjer for Ü tilbakefõre den opprinnelige ordren.;
                                 SVE=Kopiera en eller flera bokfîra inkîpsdokumentrader fîr att Üterfîra den ursprungliga ordern.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ReverseLines;
                      OnAction=BEGIN
                                 GetPstdDocLinesToRevere;
                               END;
                                }
      { 54      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument;
                                 SVE=Kopiera dokument];
                      ToolTipML=[ENU=Copy document lines and header information from another sales document to this document. You can copy a posted sales invoice into a new sales invoice to quickly create a similar document.;
                                 NOR=Kopier dokumentlinjer og hodeopplysninger fra et annet salgsdokument til dette dokumentet. Du kan kopiere en bokfõrt salgsfaktura til en ny salgsfaktura for Ü opprette et lignende dokument raskt.;
                                 SVE=Kopiera dokumentrader och huvudinformation frÜn andra fîrsÑljningsdokument till det hÑr dokumentet. Du kan kopiera en bokfîrd fîrsÑljningsfaktura till en ny fîrsÑljningsfaktura om du snabbt vill skapa ett liknande dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 131     ;2   ;Separator  }
      { 1210190012;2 ;Action    ;
                      CaptionML=[ENU=&Match ICF Invoice;
                                 SVE=&Matcha ICF-faktura];
                      Visible=FALSE;
                      Image=ElectronicDoc;
                      OnAction=VAR
                                 PurchReceiptCU@1210190000 : Codeunit 74;
                               BEGIN
                                 PurchReceiptCU.MatchReceiptICFInvoice("No.", TRUE);  //**4PS.n
                               END;
                                }
      { 1100525000;2 ;Action    ;
                      CaptionML=[ENU=Create Invoice Lines for Sub Projects;
                                 SVE=Skapa fakturarader fîr underprojekt];
                      Visible=FALSE;
                      Image=CreateJobSalesInvoice;
                      OnAction=BEGIN
                                 //**4PS
                                 DistrPurchLinesOverSubProjects(Rec);
                               END;
                                }
      { 114     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 NOR=Flytt negative linjer;
                                 SVE=Flytta negativa rader];
                      ToolTipML=[ENU=Prepare to create a replacement sales order in a sales return process.;
                                 NOR=Klargjõr for Ü opprette en erstatningsordre i salgsreturprosessen.;
                                 SVE=Fîrbered skapa en ersÑttningsfîrsÑljningsorder i en fîrsÑljningsreturprocess.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 1100485090;2 ;Action    ;
                      CaptionML=[ENU=Get Plant Rent Entries;
                                 SVE=HÑmta transaktioner fîr Maskinsuthyrning];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 GetPlantRentEntries@1100525000 : Report 11012589;
                               BEGIN
                                 TESTFIELD("No.");
                                 TESTFIELD("Buy-from Vendor No.");
                                 GetPlantRentEntries.SetSelections("No.", DATABASE::"Purchase Line", TRUE, FALSE);
                                 GetPlantRentEntries.RUNMODAL;
                               END;
                                }
      { 132     ;2   ;Separator  }
      { 37      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument];
                      ActionContainerType=NewDocumentItems;
                      Visible=FALSE;
                      Image=Documents }
      { 35      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inngÜende dokument;
                                 SVE=Visa inkommande dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppfõringen eller dokumentet.;
                                 SVE=Visa alla poster med inkommande dokument och filbilagor som finns fîr transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 33      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inngÜende dokument;
                                 SVE=VÑlj inkommande dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppfõringen eller dokumentet.;
                                 SVE=VÑlj en post fîr inkommande dokument och en filbilaga som du vill koppla till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 31      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inngÜende dokument fra fil;
                                 SVE=Skapa inkommande dokument frÜn fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved Ü velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppfõringen eller dokumentet.;
                                 SVE=Skapa en post fîr inkommande dokument genom att vÑlja en fil att bifoga. Koppla sedan posten om det inkommande dokumentet till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Enabled=("Incoming Document Entry No." = 0) AND ("No." <> '');
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPurchaseDocument(Rec);
                               END;
                                }
      { 41      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 NOR=Fjern inngÜende dokument;
                                 SVE=Ta bort inkommande dokument];
                      ToolTipML=[ENU=Remove any incoming document records and file attachments.;
                                 NOR=Fjern eventuelle innkommende dokumentposter og filvedlegg.;
                                 SVE=Ta bort inkommande dokumentposter och filbilagor.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IF IncomingDocument.GET("Incoming Document Entry No.") THEN
                                   IncomingDocument.RemoveLinkToRelatedRecord;
                                 "Incoming Document Entry No." := 0;
                                 MODIFY(TRUE);
                               END;
                                }
      { 1100527451;2 ;Action    ;
                      Name=ChooseTradeName;
                      CaptionML=ENU=Choose Tradename;
                      Visible=FALSE;
                      Image=CompareContacts;
                      OnAction=BEGIN
                                 //**4PS
                                 ChooseTradeName;
                               END;
                                }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning;
                                 SVE=BegÑr godkÑnnande];
                      Image=Approval }
      { 146     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforespõrsel;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      ToolTipML=[ENU=Request approval of the document.;
                                 NOR=Be om godkjenning av dokumentet.;
                                 SVE=BegÑr godkÑnnande av dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Enabled=NOT OpenApprovalEntriesExist AND CanRequestApprovalForFlow;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 147     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforespõrsel;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforespõrselen.;
                                 SVE=Annullera godkÑnnandebegÑran.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Enabled=CanCancelApprovalForRecord OR CanCancelApprovalForFlow;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                                 WorkflowWebhookMgt@1000 : Codeunit 1543;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                                 WorkflowWebhookMgt.FindAndCancel(RECORDID);
                               END;
                                }
      { 144     ;2   ;Separator  }
      { 61      ;2   ;ActionGroup;
                      CaptionML=[ENU=Flow;
                                 NOR=Flow;
                                 SVE=Flow];
                      Image=Flow }
      { 62      ;3   ;Action    ;
                      Name=CreateFlow;
                      CaptionML=[ENU=Create a Flow;
                                 NOR=Opprett en flyt;
                                 SVE=Skapa ett arbetsflîde];
                      ToolTipML=[ENU=Create a new Flow from a list of relevant Flow templates.;
                                 NOR=Opprett en ny flyt fra en liste over relevante flytmaler.;
                                 SVE=Skapa ett nytt arbetsflîde frÜn en lista med relevanta arbetsflîdesmallar.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsSaaS;
                      Image=Flow;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 FlowServiceManagement@1000 : Codeunit 6400;
                                 FlowTemplateSelector@1001 : Page 6400;
                               BEGIN
                                 // Opens page 6400 where the user can use filtered templates to create new flows.
                                 FlowTemplateSelector.SetSearchText(FlowServiceManagement.GetPurchasingTemplateFilter);
                                 FlowTemplateSelector.RUN;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      Name=SeeFlows;
                      CaptionML=[ENU=See my Flows;
                                 NOR=Se mine flyter;
                                 SVE=Visa mina arbetsflîden];
                      ToolTipML=[ENU=View and configure Flows that you created.;
                                 NOR=Vis og konfigurer flyter som du har opprettet.;
                                 SVE=Visa och konfigurera arbetsflîden som du har skapat.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 6401;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Flow;
                      PromotedCategory=Category5 }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okfõring;
                                 SVE=B&okfîring];
                      Image=Post }
      { 59      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okfõr;
                                 SVE=&Bokfîr];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullfõr dokumentet eller kladden ved Ü bokfõre belõpene og antallene til de relaterte kontiene i selskapstablÜene.;
                                 SVE=Slutfîr dokumentet eller journalen genom att bokfîra beloppen och kvantiteterna till de relaterade kontona i fîretagets redovisning.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post (Yes/No)");
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=ForhÜndsvis bokfõring;
                                 SVE=Fîrhandsgranska bokfîring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet nÜr du bokfõrer dokumentet eller kladden.;
                                 SVE=Granska de olika typer av transaktioner som skapas nÑr du bokfîr dokumentet eller journalen.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewPostedOrder;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 PurchPostYesNo@1000 : Codeunit 91;
                               BEGIN
                                 PurchPostYesNo.Preview(Rec);
                               END;
                                }
      { 58      ;2   ;Action    ;
                      Name=TestReport;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport;
                                 SVE=Testrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil fõr du bokfõrer kladden eller dokumentet.;
                                 SVE=Visa en testrapport sÜ att du kan hitta och rÑtta till eventuella fel innan du bokfîr journalen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 1101200045;2 ;Action    ;
                      CaptionML=ENU=Invoice Check List;
                      Visible=FALSE;
                      Image=TestReport;
                      OnAction=VAR
                                 PurchHeaderRec@1000000006 : Record 38;
                                 PurchInvChecklist@1100525000 : Report 11012063;
                               BEGIN
                                 //**4PS
                                 PurchHeaderRec.SETRANGE("Document Type",PurchHeaderRec."Document Type"::"Credit Memo");
                                 PurchInvChecklist.SETTABLEVIEW(PurchHeaderRec);
                                 PurchInvChecklist.RUN;
                               END;
                                }
      { 60      ;2   ;Action    ;
                      Name=PostAndPrint;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokfõr og &skriv ut;
                                 SVE=Bokfîr och skriv &ut];
                      ToolTipML=[ENU=Finalize and prepare to print the document or journal. The values and quantities are posted to the related accounts. A report request window where you can specify what to include on the print-out.;
                                 NOR=Fullfõr og klargjõr for Ü skrive ut dokumentet eller kladden. Verdiene og antallene blir bokfõrt til de relaterte kontiene. Det vises en rapportforespõrselsside der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Slutfîr och fîrbered utskrift av dokumentet eller journalen. VÑrdena och kvantiteterna bokfîrs pÜ de relaterade kontona. Ett fînster med en rapportbegÑran dÑr du kan ange vad som ska tas med pÜ utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post + Print");
                               END;
                                }
      { 3       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbkõ;
                                 SVE=Ta bort frÜn jobbkî];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektkõen.;
                                 SVE=Ta bort den schemalagda bearbetningen av den hÑr rapporten frÜn jobbkîn.];
                      ApplicationArea=#All;
                      Visible=JobQueueVisible;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 1100409001;1 ;ActionGroup;
                      CaptionML=[ENU=Mail Documents;
                                 SVE=E-postdokument];
                      ActionContainerType=NewDocumentItems }
      { 1100409000;2 ;Action    ;
                      CaptionML=[ENU=Mail Document to Buy-from Vendor;
                                 SVE=Inkîpsleverantîr];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 Contact@1100409002 : Record 5050;
                                 Vendor@1100409001 : Record 23;
                                 DocumentTemplate@1100409000 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Vendor No.");
                                 IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN BEGIN
                                   Vendor.GET("Buy-from Vendor No.");
                                   EditDocuments(
                                     "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Credit Memo"),
                                     Contact."No.", '', TRUE, Vendor."E-Mail", FALSE);
                                 END;
                               END;
                                }
      { 1100409002;2 ;Action    ;
                      CaptionML=[ENU=Mail Document to Buy-from Contact;
                                 SVE=Inkîpskontaktperson];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category10;
                      OnAction=VAR
                                 Contact@1100409002 : Record 5050;
                                 DocumentTemplate@1100409000 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Contact No.");
                                 IF Contact.GET("Buy-from Contact No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Credit Memo"),
                                       Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail", FALSE)
                                    ELSE
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Credit Memo"),
                                       Contact."No.", '', TRUE, Contact."E-Mail", FALSE);
                                 END;
                               END;
                                }
      { 1100528202;2 ;Action    ;
                      CaptionML=ENU=Show Original &E-mail;
                      Visible=DCActive;
                      Enabled=DCActive;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 PurchDocMgnt@1100527300 : Codeunit 6085709;
                               BEGIN
                                 //**4PS
                                 PurchDocMgnt.OpenEmailFile(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                Lookup=No;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Standard;
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Vendor No.;
                           NOR=Leverandõrnr.;
                           SVE=Leverantîrsnr];
                ToolTipML=[ENU=Specifies the number of the vendor who delivers the products.;
                           NOR=Angir nummeret pÜ leverandõren som leverer produktene.;
                           SVE=Anger numret pÜ leverantîren som levererar produkterna.];
                ApplicationArea=#Basic,#Suite;
                NotBlank=Yes;
                SourceExpr="Buy-from Vendor No.";
                Importance=Additional;
                OnValidate=BEGIN
                             OnAfterValidateBuyFromVendorNo(Rec,xRec);
                             CurrPage.UPDATE;
                           END;
                            }

    { 1210190004;2;Field  ;
                SourceExpr="Related Purch. Order No.";
                OnValidate=BEGIN
                             //**4PS.n
                             ValidateRelatedPurchOrder;
                           END;

                OnLookup=VAR
                           OldRelatedOrderNo@1100525000 : Code[20];
                         BEGIN
                           //**4PS.n
                           OldRelatedOrderNo := "Related Purch. Order No.";
                           LookupRelatedOrder();
                           IF ("Related Purch. Order No." <> '') AND ("Related Purch. Order No." <> OldRelatedOrderNo) THEN
                             ValidateRelatedPurchOrder;
                         END;
                          }

    { 1210190006;2;Field  ;
                Name=BankAccountSelect;
                CaptionML=[ENU=Bank Account No.;
                           SVE=Bankkontonr];
                SourceExpr=BankAccountSelect;
                Visible=FALSE;
                Editable=BankAccountSelectEditable;
                OnValidate=BEGIN
                             //**4PS
                             HandleSelectedBankAccount(Rec, BankAccountSelect);
                           END;
                            }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Vendor Name;
                           NOR=Leverandõrnavn;
                           SVE=Leverantîrsnamn];
                ToolTipML=[ENU=Specifies the name of the vendor who delivers the products.;
                           NOR=Angir navnet pÜ leverandõren som leverer produktene.;
                           SVE=Anger namnet pÜ leverantîren som levererar produkterna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Vendor Name";
                Importance=Promoted;
                OnValidate=VAR
                             ApplicationAreaMgmtFacade@1001 : Codeunit 9179;
                           BEGIN
                             IF "No." = '' THEN
                               InitRecord;

                             OnAfterValidateBuyFromVendorNo(Rec,xRec);

                             IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE;
                QuickEntry=FALSE }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies additional posting information for the document. After you post the document, the description can add detail to vendor and customer ledger entries.;
                           NOR=Angir ekstra bokfõringsinformasjon for dokumentet. NÜr du bokfõrer dokumentet, kan beskrivelsen tilfõre detaljer til leverandõr- og kundeposter.;
                           SVE=Anger ytterligare bokfîringsinformation fîr dokumentet. NÑr du bokfîr dokumentet kan beskrivningen tillfîra detaljer i leverantîrs- och kundreskontratransaktioner.];
                ApplicationArea=#Suite;
                SourceExpr="Posting Description";
                Visible=FALSE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kjõp fra;
                           SVE=Kîp frÜn];
                GroupType=Group }

    { 63  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor who ships the items.;
                           NOR=Angir adressen til leverandõren som leverer varene.;
                           SVE=Anger adressen till leverantîren som levererar artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                QuickEntry=FALSE }

    { 65  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                QuickEntry=FALSE }

    { 67  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                QuickEntry=FALSE }

    { 88  ;3   ;Group     ;
                Visible=IsBuyFromCountyVisible;
                GroupType=Group }

    { 74  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from County";
                Importance=Additional;
                QuickEntry=FALSE }

    { 68  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                QuickEntry=FALSE }

    { 75  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the vendor on the purchase document.;
                           NOR=Angir lands- eller omrÜdekoden for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens land eller region i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Country/Region Code";
                Importance=Additional;
                OnValidate=BEGIN
                             IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 123 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of your contact at the vendor.;
                           NOR=Angir nummeret for kontakten hos leverandõren.;
                           SVE=Anger numret som hîr till kontaktpersonen hos leverantîren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                QuickEntry=FALSE }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about shipment of the item from this vendor.;
                           NOR=Angir navnet pÜ kontaktpersonen som kan kontaktes angÜende varelevering fra denne leverandõren.;
                           SVE=Anger namnet pÜ den person som bîr kontaktas angÜende utleverans av artikeln frÜn leverantîren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact" }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the original document you received from the vendor. You can require the document number for posting, or let it be optional. By default, it's required, so that this document references the original. Making document numbers optional removes a step from the posting process. For example, if you attach the original invoice as a PDF, you might not need to enter the document number. To specify whether document numbers are required, in the Purchases & Payables Setup window, select or clear the Ext. Doc. No. Mandatory field.;
                           NOR=Angir dokumentnummeret for det opprinnelige dokumentet du mottok fra leverandõren. Du kan kreve dokumentnummeret for bokfõring eller la det vëre valgfritt. Det er obligatorisk som standard, slik at dette dokumentet refererer til originalen. Hvis dokumentnumre gjõres valgfrie, fjernes et trinn fra bokfõringsprosessen. Hvis du for eksempel legger ved den opprinnelige fakturaen som en PDF-fil, kan det hende du ikke behõver Ü angi dokumentnummeret. Hvis du vil angi om dokumentnummeret er obligatorisk, gÜr du til vinduet for kjõpsoppsett, og merker av for eller fjerner merket for feltet Eksternt dokumentnr. obligatorisk.;
                           SVE=Anger dokumentnumret fîr det ursprungliga dokumentet som du har fÜtt frÜn leverantîren. Du kan krÑva dokumentnumret fîr bokfîring eller lÜta det vara frivilligt. Som standard krÑvs det i syfte att lÜta detta dokument referera till det ursprungliga. Vid valfria dokumentnummer fîrvinner ett steg frÜn bokfîringsprocessen. Om du till exempel bifogar den ursprungliga fakturan som en PDF kanske du inte behîver ange dokumentnumret. Fîr att ange om dokumentnummer krÑvs, vÑlj eller rensa fÑltet Externt dok.nr obligatoriskt i fînstret Inkîp & InkîpsinstÑllningar.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Cr. Memo No.";
                Visible=FALSE;
                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('Factuurnummer', 0);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Vendor Cr. Memo No.", COPYSTR(RetVal, 1, 20));
                             END;

                ShowMandatory=VendorCreditMemoNoMandatory }

    { 1100485005;2;Field  ;
                SourceExpr="Ext. Document ID";
                Visible="Ext. Document IDVisible";
                Editable="Ext. Document IDEditable" }

    { 1101200012;2;Field  ;
                CaptionML=[ENU=Subcontractor Credit Memo;
                           SVE=Kreditnota fîr underentreprenîr];
                SourceExpr="Subcontracting Invoice";
                OnValidate=BEGIN
                             SubcontractingInvoiceOnAfterVa;
                           END;
                            }

    { 1101200016;2;Field  ;
                SourceExpr="Invoice Lines Input";
                Editable="Invoice Lines InputEditable" }

    { 1000000001;2;Field  ;
                SourceExpr="Amounts only" }

    { 1210190022;2;Field  ;
                SourceExpr="Bank No. Check";
                Visible=FALSE;
                Editable=BankNoCheckEditable;
                OnValidate=BEGIN
                             //**4PS
                             FillSelectBankAccount;
                           END;
                            }

    { 1100525006;2;Field  ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the purchase document will be recorded.;
                           NOR=Angir datoen nÜr bokfõringen av kjõpsdokumentet blir registrert.;
                           SVE=Anger datumet dÜ bokfîring av inkîpsdokumentet registreras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Standard;
                OnValidate=BEGIN
                             SaveInvoiceDiscountAmount;
                           END;

                QuickEntry=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the related document was created.;
                           NOR=Angir datoen da de relaterte dokumentet ble opprettet.;
                           SVE=Anger datumet nÑr det relaterade dokumentet skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('Factuurdatum', 2);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Document Date", RetVal);
                             END;

                QuickEntry=FALSE }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the identification number of a compensation agreement.;
                           NOR=Angir ID-nummeret for en kompensasjonsavtale.;
                           SVE=Anger id-numret pÜ ett kompensationsavtal.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Authorization No.";
                Importance=Standard;
                Visible=FALSE }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the incoming document that this purchase document is created for.;
                           NOR=Angir nummeret pÜ det innkommende dokumentet som dette kjõpsdokumentet er opprettet for.;
                           SVE=Anger numret pÜ det inkommande dokument som detta inkîpsdokument skapas fîr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Incoming Document Entry No.";
                Visible=FALSE }

    { 1101200014;2;Field  ;
                SourceExpr="VAT Prod. Posting Group";
                OnValidate=BEGIN
                             VATProdPostingGroupOnAfterVali;
                           END;
                            }

    { 1101200002;2;Field  ;
                SourceExpr="Amount excl. VAT";
                Editable="Amount excl. VATEditable" }

    { 1101200004;2;Field  ;
                SourceExpr="VAT Amount";
                Editable="VAT AmountEditable";
                OnValidate=BEGIN
                             VATAmountOnAfterValidate;
                           END;
                            }

    { 1101200000;2;Field  ;
                SourceExpr="Amount incl. VAT";
                OnValidate=BEGIN
                             AmountinclVATOnAfterValidate;
                           END;

                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               //**4PS.sn
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('BrutoBedrag', 3);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Amount incl. VAT", RetVal);
                               //**4PS.en
                             END;
                              }

    { 1100527300;2;Field  ;
                SourceExpr="Approval Code";
                Visible=FALSE }

    { 1101200006;2;Field  ;
                SourceExpr="On Hold";
                Visible=FALSE }

    { 1100528401;2;Field  ;
                CaptionML=[ENU=Approval by User;
                           SVE=GodkÑnnande av anvÑndare];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApprover(RECORDID,0);
                Visible=FALSE }

    { 1100528402;2;Field  ;
                CaptionML=[ENU=Approval by User Name;
                           SVE=GodkÑnnande av anvÑndarnamn];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApproverName(RECORDID,0);
                Visible=FALSE }

    { 1100527450;2;Field  ;
                CaptionML=ENU=No. of Documents (DC);
                SourceExpr=DocMgt.GetNoOfDocForDoc(DATABASE::"Purchase Header","Document Type","No.",0);
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DocMgt.LookupDocsForDoc(DATABASE::"Purchase Header","Document Type","No.",0);
                            END;
                             }

    { 1101200008;2;Field  ;
                SourceExpr="Approvement Initials";
                Visible=FALSE }

    { 1210190000;2;Field  ;
                SourceExpr="Job No.";
                OnValidate=BEGIN
                             //**4PS;
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry that handles the posting of purchase credit memos.;
                           NOR=Angir status for en jobbkõpost som hÜndterer bokfõring av kjõpskreditnotaer.;
                           SVE=Anger statusen fîr en jobbkîtransaktion eller en aktivitet som hanterar bokfîringen av inkîpskreditnotor.];
                ApplicationArea=#All;
                SourceExpr="Job Queue Status";
                Importance=Additional;
                Visible=JobQueueUsed }

    { 1100525003;2;Field  ;
                SourceExpr="Service Order No.";
                OnValidate=BEGIN
                             //**4PS
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1210190018;2;Field  ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 101 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the record is open, is waiting to be approved, has been invoiced for prepayment, or has been released to the next stage of processing.;
                           NOR=Angir om posten er Üpen, om den venter pÜ godkjenning, om den er fakturert for forskudd eller om den er frigitt til neste fase i behandlingen.;
                           SVE=Anger om posten Ñr îppen, vÑntar pÜ att godkÑnnas, har fakturerats fîr fîrskottsbetalning eller har slÑppts till nÑsta steg i behandlingen.];
                ApplicationArea=#Suite;
                SourceExpr=Status;
                Importance=Additional;
                QuickEntry=FALSE }

    { 1102601000;2;Field  ;
                ToolTipML=[ENU=Specifies the campaign number the document is linked to.;
                           NOR=Angir kampanjenummeret som dokumentet er koblet til.;
                           SVE=Anger kampanjnumret som dokumentet Ñr kopplat till.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign No.";
                Importance=Additional;
                Visible=FALSE }

    { 12013599;2;Field    ;
                SourceExpr=Approve }

    { 12013587;2;Field    ;
                CaptionML=[ENU=Approval Status;
                           SVE=Atteststatus];
                SourceExpr=ExFlowStatusFromPO;
                OnDrillDown=BEGIN
                              ExFlowFormat;
                            END;
                             }

    { 12013589;2;Field    ;
                SourceExpr="Import VAT Amount" }

    { 12013590;2;Field    ;
                SourceExpr="Block Document" }

    { 46  ;1   ;Part      ;
                Name=PurchLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page98;
                Enabled="Buy-from Vendor No." <> '';
                Editable="Buy-from Vendor No." <> '';
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer;
                           SVE=Fakturadetaljer];
                GroupType=Group }

    { 1101200018;2;Field  ;
                SourceExpr="Your Reference" }

    { 78  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Importance=Promoted;
                Visible=FALSE;
                LookupPageID=Cost Object List;
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbelõpet.;
                           SVE=Anger en formel som berÑknar betalningsfîrfallodatumet, kassarabattsdatumet och kassarabattens belopp.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Standard }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how to make payment, such as with bank transfer, cash, or check.;
                           NOR=Angir hvordan du utfõrer en betaling, for eksempel med bankoverfõring, kontanter eller sjekk.;
                           SVE=Anger hur kunden betalar, t.ex. med bankîverfîring, kontanter eller check.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the invoice is due. The program calculates the date using the Payment Terms Code and Document Date fields.;
                           NOR=Angir nÜr fakturaen forfaller. Programmet beregner datoen ved hjelp av feltet Betalingsbet.kode og Dokumentdato.;
                           SVE=Anger nÑr fakturan fîrfaller. Datumet berÑknas frÜn fÑlten Betalningsvillkorskod och Dokumentdatum.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Standard }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis betaling utfõres innen datoen i feltet Kont.rabattdato.;
                           SVE=Anger den procentuella kassarabatten som anvÑnds om betalningen gîrs senast det datum som anges i fÑltet Kassarabattsdatum.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 139 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                           NOR=Angir datoen da belõpet i posten mÜ vëre betalt for at det kan oppnÜs kontantrabatt.;
                           SVE=Anger datumet dÜ transaktionens belopp mÜste vara betalt fîr att orderns kassarabatt ska gÑlla.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Visible=FALSE }

    { 141 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT specification of the involved customer or vendor to link transactions made for this record with the appropriate general ledger account according to the VAT posting setup.;
                           NOR=Angir mva-spesifikasjonen for den involverte kunden eller leverandõren for Ü koble transaksjoner som ble utfõrt for denne posten, med riktig finanskonto i henhold til det generelle mva-bokfõringsoppsettet.;
                           SVE=Anger momsspecifikationen fîr den berîrda kunden eller leverantîren i syfte att koppla transaktioner som skapas fîr posten till det lÑmpliga redovisningskontot enligt momsbokfîringsinstÑllningen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                OnValidate=VAR
                             ApplicationAreaMgmtFacade@1000 : Codeunit 9179;
                           BEGIN
                             IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;
                            }

    { 1100525001;2;Field  ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 1210190005;2;Field  ;
                SourceExpr="Interest Date";
                Importance=Additional;
                Visible="Interest DateVisible" }

    { 1100525005;2;Field  ;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the location where you want the items to be placed when they are received.;
                           NOR=Angir en kode for lokasjonen der du vil at de bestilte varene skal plasseres.;
                           SVE=Anger en kod fîr lagerstÑllet dÑr du vill att artiklarna ska placeras nÑr de har levererats.];
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Importance=Additional;
                Visible=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling;
                           SVE=Leverans och betalning];
                GroupType=Group }

    { 71  ;2   ;Group     ;
                GroupType=Group }

    { 70  ;3   ;Field     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Forsendelsesadresse;
                           SVE=Leverans];
                ToolTipML=[ENU=Specifies the address that the products on the purchase document are shipped to. Default (Company Address): The same as the company address specified in the Company Information window. Location: One of the company's location addresses. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Angir adressen som produktene i kjõpsdokumentet skal sendes til. Standard (selskapsadresse): Det samme som selskapsadressen angitt i Selskapsopplysninger-vinduet. Lokasjon: En av selskapets adresser. Tilpasset adresse: En forsendelsesadresse du angir i feltene under.;
                           SVE=Anger den adress som produkterna i inkîpsdokumentet levereras till. StandardvÑrde (fîretagsadress): Samma som den fîretagsadress som anges i fîretagets informationsfînster. Plats: En av fîretagets lagerstÑlleadresser. Anpassad adress: Valfri leveransadress som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Vendor Address),Alternate Vendor Address,Custom Address;
                                 NOR=Standard (leverandõradresse),Alternativ leverandõradresse,Kundeadresse;
                                 SVE=Standard (leverantîrsadress),Alternativ leverantîrsadress,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                OnValidate=BEGIN
                             ValidateShippingOption;
                           END;
                            }

    { 69  ;2   ;Group     ;
                Visible=ShipToOptions = ShipToOptions::"Alternate Vendor Address";
                GroupType=Group }

    { 1100525004;3;Field  ;
                ToolTipML=[ENU=Specifies the order address of the related vendor.;
                           SVE=Anger information om fîrsÑljningsofferter, inkîpsofferter eller order som finns i tidigare versioner av dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Address Code" }

    { 48  ;2   ;Group     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til;
                           SVE=Leverans];
                GroupType=Group }

    { 32  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the company at the address to which you want the items in the purchase order to be shipped.;
                           NOR=Angir navnet pÜ selskapet med adressen som du vil at varene i bestillingen skal leveres til.;
                           SVE=Anger namnet pÜ fîretaget som finns pÜ adressen dit du vill att artiklarna pÜ inkîpsordern ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Importance=Promoted }

    { 34  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address that you want the items in the purchase order to be shipped to.;
                           NOR=Angir adressen du vil at varene i bestillingen skal leveres til.;
                           SVE=Anger adressen dit du vill att artiklarna pÜ inkîpsordern ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Importance=Additional;
                QuickEntry=FALSE }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Importance=Additional;
                QuickEntry=FALSE }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Importance=Additional;
                QuickEntry=FALSE }

    { 86  ;3   ;Group     ;
                Visible=IsShipToCountyVisible;
                GroupType=Group }

    { 77  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Importance=Additional;
                Editable=ShipToOptions = ShipToOptions::"Custom Address";
                QuickEntry=FALSE }

    { 83  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Importance=Additional;
                QuickEntry=FALSE }

    { 79  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Importance=Additional;
                OnValidate=BEGIN
                             IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person for the address where the items in the purchase order should be shipped.;
                           NOR=Angir navnet pÜ kontaktpersonen med adressen som varene i bestillingen skal leveres til.;
                           SVE=Anger namnet pÜ en kontaktperson pÜ adressen dit artiklarna pÜ inkîpsordern ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 55  ;2   ;Group     ;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til;
                           SVE=Betalas];
                GroupType=Group }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the vendor who is sending the invoice.;
                           NOR=Angir leverandõren som sender fakturaen.;
                           SVE=Anger leverantîren som skickar fakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                OnValidate=VAR
                             ApplicationAreaMgmtFacade@1000 : Codeunit 9179;
                           BEGIN
                             IF GETFILTER("Pay-to Vendor No.") = xRec."Pay-to Vendor No." THEN
                               IF "Pay-to Vendor No." <> xRec."Pay-to Vendor No." THEN
                                 SETRANGE("Pay-to Vendor No.");

                             IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;
                            }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor sending the invoice.;
                           NOR=Angir adressen til leverandõren som sender fakturaen.;
                           SVE=Anger adressen fîr leverantîren som skickar fakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                QuickEntry=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                QuickEntry=FALSE }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional;
                QuickEntry=FALSE }

    { 84  ;3   ;Group     ;
                Visible=IsPayToCountyVisible;
                GroupType=Group }

    { 81  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to County";
                Importance=Additional;
                QuickEntry=FALSE }

    { 73  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                QuickEntry=FALSE }

    { 82  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the vendor on the purchase document.;
                           NOR=Angir lands- eller omrÜdekoden for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens land eller region i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Country/Region Code";
                Importance=Additional;
                OnValidate=BEGIN
                             IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 125 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the contact who sends the invoice.;
                           NOR=Angir nummeret til kontakten som sender fakturaen.;
                           SVE=Anger numret fîr kontakten som skickar fakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about an invoice from this vendor.;
                           NOR=Angir navnet pÜ den personen som skal kontaktes hvis det oppstÜr spõrsmÜl til en faktura fra denne leverandõren.;
                           SVE=Anger namnet pÜ den person som bîr kontaktas angÜende en faktura frÜn leverantîren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel;
                           SVE=Utlandshandel] }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for amounts on the purchase lines.;
                           NOR=Angir valutakoden for belõpet pÜ kjõpslinjene.;
                           SVE=Anger valutakoden fîr belopp pÜ inkîpsraderna.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               ChangeExchangeRate.SetAdditionalParameters(1, "Job No.", FALSE); //**4PS.n
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 SaveInvoiceDiscountAmount;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a specification of the document's transaction, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir en spesifikasjon for dokumentets transaksjon ved rapportering til INTRASTAT.;
                           SVE=Anger en specifikation av fîrsÑljningsdokumentets transaktion fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr="Transaction Specification";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of transaction that the document represents, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transaksjonstypen som dokumentet representerer ved rapportering til INTRASTAT.;
                           SVE=Anger den transaktionstyp som dokumentet representerar fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Type";
                Importance=Promoted;
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transportmÜten ved rapportering til INTRASTAT.;
                           SVE=Anger transportsÑttet fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr="Transport Method";
                Visible=FALSE }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the port of entry where the items pass into your country/region, for reporting to Intrastat.;
                           NOR=Angir koden for innfõrselsstedet der varene kommer inn i landet/omrÜdet, for rapportering til Intrastat.;
                           SVE=Anger koden fîr inskeppningshamnen dÑr artiklarna kommer till ditt land/din region, fîr rapportering till Intrastat.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Entry Point";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area of the customer or vendor, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir omrÜdet for kunden eller leverandõren ved rapportering til INTRASTAT.;
                           SVE=Anger omrÜdet i kundens eller leverantîrens adress fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr=Area;
                Visible=FALSE }

    { 1100485012;2;Field  ;
                SourceExpr="Company VAT Registration No." }

    { 1100485010;2;Field  ;
                SourceExpr="VAT Registration No." }

    { 1100485007;2;Field  ;
                SourceExpr="Country of Origin";
                Visible=FALSE }

    { 1100485006;2;Field  ;
                SourceExpr="Country of Destination";
                Visible=FALSE }

    { 1904409301;1;Group  ;
                CaptionML=[ENU=Application;
                           NOR=Utligning;
                           SVE=Koppling] }

    { 135 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir typen bokfõrt dokument som dette dokumentet eller denne kladdelinjen blir utlignet til nÜr du bokfõrer, for eksempel for Ü registrere utbetaling.;
                           SVE=Anger typen fîr det bokfîrda dokument som den hÑr dokument- eller journalraden tillÑmpas pÜ nÑr du bokfîr, t.ex. fîr att registrera en betalning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. Type";
                Importance=Promoted }

    { 137 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir nummeret for det bokfõrte dokumentet som dette dokumentet eller denne kladdelinjen blir utlignet til nÜr du bokfõrer, for eksempel for Ü registrere utbetaling.;
                           SVE=Anger numret pÜ det bokfîrda dokument som den hÑr dokument- eller journalraden tillÑmpas pÜ nÑr du bokfîr, t.ex. fîr att registrera en betalning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. No.";
                Importance=Promoted }

    { 133 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of entries that will be applied to when you choose the Apply Entries action.;
                           NOR=Angir ID-en for postene som blir utlignet nÜr du velger handlingen Utlign poster.;
                           SVE=Anger id-numret fîr transaktioner som kommer att tillÑmpas nÑr du vÑljer ÜtgÑrden Koppla transaktioner.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to ID" }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.;
                           SVE=Anger id fîr anvÑndaren som ansvarar fîr dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Assigned User ID";
                Importance=Additional;
                Visible=FALSE;
                QuickEntry=FALSE }

    { 1902686201;1;Group  ;
                CaptionML=[ENU=WKA;
                           SVE=WKA] }

    { 1905403901;1;Group  ;
                CaptionML=[ENU=Subcontracting;
                           SVE=Underentreprenad] }

    { 1000000012;2;Field  ;
                SourceExpr="Payment Agreement";
                Importance=Promoted;
                Editable="Payment AgreementEditable";
                OnValidate=BEGIN
                             PaymentAgreementOnAfterValidat;
                           END;
                            }

    { 1000000022;2;Field  ;
                SourceExpr="Actual Effective Date";
                Importance=Promoted;
                Editable="Actual Effective DateEditable" }

    { 1000000024;2;Field  ;
                SourceExpr="Actual End Date";
                Editable="Actual End DateEditable" }

    { 1000000014;2;Field  ;
                SourceExpr="Number of Hours";
                Editable="Number of HoursEditable";
                OnValidate=BEGIN
                             NumberofHoursOnAfterValidate;
                           END;
                            }

    { 1000000016;2;Field  ;
                SourceExpr="Avg. Wage Rate";
                Editable="Avg. Wage RateEditable" }

    { 1000000018;2;Field  ;
                SourceExpr="Labor Amount";
                Editable="Labor AmountEditable";
                OnValidate=BEGIN
                             LaborAmountOnAfterValidate;
                           END;
                            }

    { 1000000020;2;Field  ;
                SourceExpr="Contribution Percentage Labor";
                Editable=ContributionPercentageLaborEdi;
                OnValidate=BEGIN
                             ContributionPercentageLaborOnA;
                           END;
                            }

    { 1210190014;2;Field  ;
                SourceExpr="Contribution Percentage Total";
                Editable=ContributionPercentageLaborEdi;
                OnValidate=BEGIN
                             ContributionPercentageTotalOnA;
                           END;
                            }

    { 1100528200;2;Field  ;
                SourceExpr="Fixed B Amount per Hour";
                Editable=ContributionPercentageLaborEdi;
                OnValidate=BEGIN
                             CurrPage.UPDATE(FALSE);
                           END;
                            }

    { 1000000010;2;Field  ;
                SourceExpr="Pay To Tax Authority";
                Visible=FALSE;
                Editable="Pay To Tax AuthorityEditable";
                OnValidate=BEGIN
                             PayToTaxAuthorityOnAfterValida;
                           END;
                            }

    { 1000000008;2;Field  ;
                SourceExpr="Wage Charge (to B Account)";
                Editable=WageChargetoBAccountEditable;
                OnValidate=BEGIN
                             WageChargetoBAccountOnAfterVal;
                           END;
                            }

    { 1000000006;2;Field  ;
                SourceExpr="Wage Charge (to Tax Authority)";
                Visible=FALSE;
                Editable=WageChargetoTaxAuthorityEditab }

    { 1100529600;2;Field  ;
                SourceExpr="Pay VAT Amt. on B-Acc. Vendor";
                Editable=PayVATAmtOnBAccountVendorEditable }

    { 1100525008;2;Field  ;
                Name=MemoWKA;
                CaptionML=[ENU=Text;
                           SVE=BenÑmning];
                SourceExpr=PurchHeadExtensionRec.Memo;
                Visible=FALSE;
                Editable=MemoWKAEditable;
                MultiLine=Yes;
                OnValidate=BEGIN
                             PurchHeadExtensionRec.UpdatePurchHeadExtension("Document Type", "No.");
                             CurrPage.SAVERECORD;
                           END;
                            }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 954 ;1   ;Part      ;
                Name=Attached Documents;
                CaptionML=[ENU=Attachments;
                           NOR=Vedlegg;
                           SVE=Bilagor];
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(38),
                            No.=FIELD(No.),
                            Document Type=FIELD(Document Type);
                PagePartID=Page1174;
                Visible=FALSE;
                PartType=Page }

    { 1100528201;1;Part   ;
                Name=CaptureUI;
                CaptionML=[ENU=DC Document;
                           SVE=DC Dokument];
                SubPageView=SORTING(Document Type,No.)
                            WHERE(Document Type=CONST(Credit Memo));
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page6085596;
                Visible=FALSE }

    { 15  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190001;1;Part   ;
                Name=[Purchase VAT ];
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page11130181;
                ProviderID=46;
                PartType=Page }

    { 1906354007;1;Part   ;
                Name=ApprovalFactBox;
                ApplicationArea=#Suite;
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                PartType=Page }

    { 1904651607;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9094;
                PartType=Page }

    { 1903435607;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                PartType=Page }

    { 1906949207;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                PartType=Page }

    { 29  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 5   ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9100;
                ProviderID=46;
                PartType=Page }

    { 45  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1100409004;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page11130225;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

    { 1100528500;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9104;
                Visible=FALSE;
                PartType=Page }

    { 1100528101;1;Part   ;
                Name=DocumentViewerDocument;
                CaptionML=ENU=Document Viewer Documents;
                PagePartID=Page11129746;
                Visible=FALSE;
                PartType=Page }

    { 1100528100;1;Part   ;
                Name=DocumentViewer;
                CaptionML=ENU=Document Viewer;
                SubPageLink=Source Type=FIELD(Source Type),
                            No.=FIELD(No.),
                            Description=FIELD(Description);
                PagePartID=Page11129745;
                ProviderID=1100528101;
                Visible=FALSE;
                PartType=Page }

  }
  CODE
  {
    VAR
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1005 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      PurchCalcDiscByType@1007 : Codeunit 66;
      LinesInstructionMgt@1017 : Codeunit 1320;
      FormatAddress@1027 : Codeunit 365;
      ChangeExchangeRate@1001 : Page 511;
      ShipToOptions@1022 : 'Default (Vendor Address),Alternate Vendor Address,Custom Address';
      VendorRec@11012001 : Record 23;
      gFromReference@1210190001 : Boolean;
      gInvLineNo@1210190000 : Integer;
      PurchHeadExtensionRec@1100525001 : Record 11020398;
      PurchSetup@1100525002 : Record 312;
      DPA_IsHardFilter@1100000999 : Boolean;
      BankAccountSelect@1210190002 : Text[34];
      BankAccountSelectEditable@1100525004 : Boolean INDATASET;
      gvAmount@1210190004 : Decimal;
      "Interest DateVisible"@19029017 : Boolean INDATASET;
      "Ext. Document IDVisible"@19068947 : Boolean INDATASET;
      BankNoCheckEditable@19051859 : Boolean INDATASET;
      "Ext. Document IDEditable"@19001168 : Boolean INDATASET;
      "Payment AgreementEditable"@19078437 : Boolean INDATASET;
      "Actual Effective DateEditable"@19052142 : Boolean INDATASET;
      "Actual End DateEditable"@19011700 : Boolean INDATASET;
      "Number of HoursEditable"@19032395 : Boolean INDATASET;
      ContributionPercentageLaborEdi@19054050 : Boolean INDATASET;
      "Avg. Wage RateEditable"@19003838 : Boolean INDATASET;
      "Labor AmountEditable"@19041756 : Boolean INDATASET;
      "Pay To Tax AuthorityEditable"@19017584 : Boolean INDATASET;
      WageChargetoBAccountEditable@19062124 : Boolean INDATASET;
      WageChargetoTaxAuthorityEditab@19058677 : Boolean INDATASET;
      MemoWKAEditable@19038952 : Boolean INDATASET;
      "VAT AmountEditable"@19075252 : Boolean INDATASET;
      "Amount excl. VATEditable"@19000869 : Boolean INDATASET;
      "Invoice Lines InputEditable"@1100525003 : Boolean INDATASET;
      JobQueueVisible@1000 : Boolean INDATASET;
      JobQueueUsed@1019 : Boolean INDATASET;
      HasIncomingDocument@1010 : Boolean;
      DocNoVisible@1006 : Boolean;
      VendorCreditMemoNoMandatory@1008 : Boolean;
      OpenApprovalEntriesExist@1009 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1012 : Boolean;
      ShowWorkflowStatus@1011 : Boolean;
      IsOfficeAddin@1015 : Boolean;
      CanCancelApprovalForRecord@1014 : Boolean;
      DocumentIsPosted@1018 : Boolean;
      OpenPostedPurchCrMemoQst@1013 : TextConst '@@@="%1 = posted document number";ENU=The credit memo is posted as number %1 and moved to the Posted Purchase Credit Memos window.\\Do you want to open the posted credit memo?;NOR=Kreditnotaen er bokfõrt som nummer %1 og flyttet til vinduet Bokfõrte kjõpskreditnotaer.\\Vil du Üpne den bokfõrte kreditnotaen?;SVE=Kreditnotan har bokfîrts som nummer %1 och flyttats till fînstret Bokfîrda inkîpskreditnotor.\\Vill du îppna den bokfîrda kreditnotan?';
      CanRequestApprovalForFlow@1020 : Boolean;
      CanCancelApprovalForFlow@1021 : Boolean;
      IsSaaS@1023 : Boolean;
      IsBuyFromCountyVisible@1026 : Boolean;
      IsPayToCountyVisible@1025 : Boolean;
      IsShipToCountyVisible@1024 : Boolean;
      ApprovalManagement4PSConstr@1100528400 : Codeunit 11125349;
      PayVATAmtOnBAccountVendorEditable@1100529600 : Boolean INDATASET;
      TiffViewer@1100528500 : Variant;
      DCActive@1100528200 : Boolean INDATASET;
      DocMgt@1100528501 : Codeunit 6085578;
      DocAmountVisible@1100525000 : Boolean INDATASET;
      "*** ExFlow ***"@1100285001 : Integer;
      ExFlow@12013588 : Codeunit 12013601;

    LOCAL PROCEDURE ActivateFields@6();
    BEGIN
      IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
      IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
      IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
    END;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    VAR
      PurchaseHeader@1001 : Record 38;
      PurchCrMemoHdr@1002 : Record 124;
      ApplicationAreaMgmtFacade@1003 : Codeunit 9179;
      InstructionMgt@1004 : Codeunit 1330;
      IsScheduledPosting@1005 : Boolean;
    BEGIN
      IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
        LinesInstructionMgt.PurchaseCheckAllLinesHaveQuantityAssigned(Rec);

      SendToPosting(PostingCodeunitID);

      IsScheduledPosting := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      DocumentIsPosted := (NOT PurchaseHeader.GET("Document Type","No.")) OR IsScheduledPosting;

      IF IsScheduledPosting THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);

      IF PostingCodeunitID <> CODEUNIT::"Purch.-Post (Yes/No)" THEN
        EXIT;

      COMMIT; //**4PS.new

      IF IsOfficeAddin THEN BEGIN
        PurchCrMemoHdr.SETRANGE("Pre-Assigned No.","No.");
        IF PurchCrMemoHdr.FINDFIRST THEN
          //PAGE.RUN(PAGE::"Posted Purchase Credit Memo",PurchCrMemoHdr); //**4PS.old
          //**4PS.sn
          IF PurchCrMemoHdr."Credit Memo Approved" THEN
            PAGE.RUN(PAGE::"Posted Purchase Credit Memo",PurchCrMemoHdr)
          ELSE
            PAGE.RUNMODAL(PAGE::"Approve Credit Memos",PurchCrMemoHdr);
          //**4PS.en
      END ELSE
        IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
          ShowPostedConfirmationMessage;
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SaveInvoiceDiscountAmount@14();
    VAR
      DocumentTotals@1000 : Codeunit 57;
    BEGIN
      CurrPage.SAVERECORD;
      DocumentTotals.PurchaseRedistributeInvoiceDiscountAmountsOnDocument(Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1001 : Codeunit 1400;
      DocType@1000 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.PurchaseDocumentNoIsVisible(DocType::"Credit Memo","No.");
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@3();
    VAR
      PurchasesPayablesSetup@1000 : Record 312;
    BEGIN
      PurchasesPayablesSetup.GET;
      VendorCreditMemoNoMandatory := PurchasesPayablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
      WorkflowWebhookMgt@1000 : Codeunit 1543;
    BEGIN
      JobQueueVisible := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      SetExtDocNoMandatoryCondition;

      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);

      WorkflowWebhookMgt.GetCanRequestAndCanCancel(RECORDID,CanRequestApprovalForFlow,CanCancelApprovalForFlow);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@13();
    VAR
      PurchCrMemoHdr@1000 : Record 124;
      InstructionMgt@1001 : Codeunit 1330;
    BEGIN
      PurchCrMemoHdr.SETRANGE("Pre-Assigned No.","No.");
      IF PurchCrMemoHdr.FINDFIRST THEN
        IF InstructionMgt.ShowConfirm(STRSUBSTNO(OpenPostedPurchCrMemoQst,PurchCrMemoHdr."No."),
             InstructionMgt.ShowPostedConfirmationMessageCode)
        THEN
          //PAGE.RUN(PAGE::"Posted Purchase Credit Memo",PurchCrMemoHdr); //**4PS.o
          //**4PS.sn
          IF PurchCrMemoHdr."Credit Memo Approved" THEN
            PAGE.RUN(PAGE::"Posted Purchase Credit Memo",PurchCrMemoHdr)
          ELSE
            PAGE.RUNMODAL(PAGE::"Approve Credit Memos",PurchCrMemoHdr);
          //**4PS.en
    END;

    LOCAL PROCEDURE ValidateShippingOption@7();
    BEGIN
      CASE ShipToOptions OF
        ShipToOptions::"Default (Vendor Address)":
          BEGIN
            VALIDATE("Order Address Code",'');
            VALIDATE("Buy-from Vendor No.");
          END;
        ShipToOptions::"Alternate Vendor Address":
          VALIDATE("Order Address Code",'');
      END
    END;

    LOCAL PROCEDURE CalculateCurrentShippingOption@8();
    BEGIN
      CASE TRUE OF
        "Order Address Code" <> '':
          ShipToOptions := ShipToOptions::"Alternate Vendor Address";
        BuyFromAddressEqualsShipToAddress:
          ShipToOptions := ShipToOptions::"Default (Vendor Address)";
        ELSE
          ShipToOptions := ShipToOptions::"Custom Address";
      END;
    END;

    PROCEDURE InitSelectionFromReference@1210190002(IInvLineNo@1210190000 : Integer);
    BEGIN
      //**4PS
      gFromReference := TRUE;
      gInvLineNo := IInvLineNo;
    END;

    PROCEDURE ShowICFInvoiceLines@1210190000();
    VAR
      ICFLineRec@1210190000 : Record 11012327;
    BEGIN
      //**4PS
      ICFLineRec.RESET;
      ICFLineRec.SETRANGE(Vendor, "Pay-to Vendor No.");
      ICFLineRec.SETRANGE("Invoice No.", "No.");
      IF ICFLineRec.FIND('-') THEN
        PAGE.RUNMODAL(PAGE::"ICF Invoices", ICFLineRec);
    END;

    PROCEDURE SetFieldsEditable@1100525001();
    VAR
      WKA@1100525002 : Boolean;
    BEGIN
      //**4PS
      IF VendorRec."No." <> "Buy-from Vendor No." THEN
        IF NOT VendorRec.GET("Buy-from Vendor No.") THEN BEGIN
          VendorRec."Security Fund" := FALSE;
          VendorRec.ACL := FALSE;
        END;

      WKA := "Subcontracting Invoice" AND NOT VendorRec."Security Fund" AND
             PurchSetup."Credit Memo by G-Account allow"; // C002607.n

      ContributionPercentageLaborEdi := WKA;
      //"Payment AgreementEditable" := ("Subcontracting Invoice"); // C002607.o
      "Payment AgreementEditable" := ("Subcontracting Invoice" AND PurchSetup."Credit Memo by G-Account allow"); // C002607.n
      "Actual Effective DateEditable" := (WKA);
      "Actual End DateEditable" := (WKA);
      "Number of HoursEditable" := (WKA);
      "Avg. Wage RateEditable" := (WKA AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL);
      "Labor AmountEditable" := (WKA AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL);
      "Pay To Tax AuthorityEditable" := (WKA AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL);
      WageChargetoBAccountEditable := (WKA AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL AND NOT "Pay To Tax Authority");
      WageChargetoTaxAuthorityEditab := (WKA AND "Pay To Tax Authority");
      MemoWKAEditable := (WKA);
      "VAT AmountEditable" := ("Manually VAT Posting");
      "Amount excl. VATEditable" := ("Manually VAT Posting");
      "Invoice Lines InputEditable" := (PurchSetup."Approve Purchase Invoices");  //T003810

      BankAccountSelectEditable := PurchSetup."Invoices on Bank Account" AND CurrPage.EDITABLE;
      PayVATAmtOnBAccountVendorEditable := WKA;
    END;

    PROCEDURE ValidateRelatedPurchOrder@1100525002();
    BEGIN
      //**4PS (C006225)
      CurrPage.UPDATE;
      COMMIT; //11-03-2014
      IF GetReceiptsRelatedOrderAutomat(Rec) THEN BEGIN
        GET("Document Type", "No.");
        CurrPage.UPDATE;
      END;
    END;

    PROCEDURE WhiteVisionStart@1100528300();
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT;

      WhiteVisionMgt.LoadDocuments(TiffViewer, "No.", FALSE, "Input Date");
    END;

    PROCEDURE WhiteVisionStop@1100528301();
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT;

      WhiteVisionMgt.Stop(TiffViewer);
    END;

    PROCEDURE WhiteVisionActivateField@1100528303(FieldName@1100528301 : Text[30];FieldType@1100528302 : Option) : Text[250];
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      //FieldType:
      //0: Text
      //1: Decimal
      //2: Date
      //3: Money
      //4: RegEx

      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT('');

      EXIT(WhiteVisionMgt.ActivateField(TiffViewer, FieldName, FieldType));
    END;

    LOCAL PROCEDURE AmountinclVATOnAfterValidate@19037268();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE VATAmountOnAfterValidate@19038655();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SubcontractingInvoiceOnAfterVa@19014981();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE VATProdPostingGroupOnAfterVali@19001691();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE WageChargetoBAccountOnAfterVal@19015148();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE PayToTaxAuthorityOnAfterValida@19033144();
    BEGIN
       //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE PaymentAgreementOnAfterValidat@19059474();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE NumberofHoursOnAfterValidate@19014369();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE LaborAmountOnAfterValidate@19042394();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContributionPercentageLaborOnA@19007239();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContributionPercentageTotalOnA@19018232();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ActualEffectiveDateOnActivate@19016407();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE); //**4PS.n this is necessary to set fields editable in case a payment agreement is selected with a lookup
    END;

    LOCAL PROCEDURE FillSelectBankAccount@1100525000();
    BEGIN
      //**4PS
      IF PurchSetup."Bank Account Check" AND ("Bank No. Check" = '') THEN
        BankAccountSelect := ''
      ELSE
        BankAccountSelect := "Bank Account No.";
    END;

    LOCAL PROCEDURE FillDocumentViewerFactbox@1100528100();
    VAR
      DocumentLinkManagement@1100528100 : Codeunit 11012401;
      DocumentProperties@1100528101 : Record 11012746;
      DocumentAttachmentMgt@1100528102 : Codeunit 6085602;
      TempDocument@1100528103 : Record 6085756;
      EmptyRecID@1100528104 : RecordID;
      DocumentViewerTempDoc@1100528105 : Record 11072460;
    BEGIN
      CurrPage.DocumentViewerDocument.PAGE.ResetPage;
      DocumentLinkManagement.GetDocuments(DocumentProperties, RECORDID.GETRECORD);
      DocumentProperties.MARKEDONLY(TRUE);
      CurrPage.DocumentViewerDocument.PAGE.SetExternal4PSDocuments(DocumentProperties);

      CASE PurchSetup."Scanning Application Purch.Inv" OF
        PurchSetup."Scanning Application Purch.Inv"::"Document Capture":
          BEGIN
            DocumentAttachmentMgt.CreateTempDocumentList(TempDocument, EmptyRecID, DATABASE::"Purchase Header", "Document Type", "No.", 0, TRUE);
            CurrPage.DocumentViewerDocument.PAGE.SetDocumentCaptureDocuments(TempDocument);
            IF "Ext. Document ID" <> '' THEN BEGIN
              CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::DocumentCapture, "Ext. Document ID");
            END ELSE
              CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::DocumentCapture, '');
          END;
        PurchSetup."Scanning Application Purch.Inv"::Whitevision:
          BEGIN
            CurrPage.DocumentViewerDocument.PAGE.SetWhiteVisionDocument(Rec);
            CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::WhiteVision, '');
          END;
      END;

      CurrPage.DocumentViewer.PAGE.SetEmailSubject("No.");
    END;

    BEGIN
    {
      4PS 02-02-2007, Peter Schoenmaker, Function "Get Return &Shipment Lines" disabled.
      4PS 24-09-2009 PS, Approval removed
      4PS 29-03-18 DP01917 OLKOL: Actions "<Page Approval Comments>" added, "Approve" changed
      --- ExFlow --->
      Field General : Approve
      Field General : Approval Status
      Field General : Imported VAT Amount
      Field General : Block Document
      Action        : Show Document (Code), Attached Files
      Globals
      Variables     : Exflow
      <-- ExFlow ---
    }
    END.
  }
}

