OBJECT Table 6085590 DC Document
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=DCW13.70.00.5.00.05,4PS14.00;
  }
  PROPERTIES
  {
    Permissions=TableData 6085593=d,
                TableData 6085594=d,
                TableData 6085700=d;
    DataCaptionFields=No.;
    OnInsert=VAR
               NoSeriesMgt@1160040000 : Codeunit 396;
               ContiniaOnlineDC@1000 : Codeunit 6085617;
             BEGIN
               ContiniaOnlineDC.IsCompanyActive(TRUE);
               IF "No." = '' THEN BEGIN
                 GetDCSetup;
                 DCSetup.TESTFIELD("Document Nos.");
                 NoSeriesMgt.InitSeries(DCSetup."Document Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;

               IF "Imported Date-Time" = 0DT THEN BEGIN
                 "Imported Date-Time" := CURRENTDATETIME;
                 "Imported by" := USERID;
                 "Import Day" := DATE2DMY(DT2DATE("Imported Date-Time"),1);
                 "Import Month" := DATE2DMY(DT2DATE("Imported Date-Time"),2);
                 "Import Year" := DATE2DMY(DT2DATE("Imported Date-Time"),3);
               END;
             END;

    OnDelete=VAR
               Page@1000000000 : Record 6085591;
               Value@1000000001 : Record 6085593;
               PurchDocMatch@161024012 : Record 6085700;
               DocCat@1160040000 : Record 6085575;
               DocumentCommentLine@1160040001 : Record 6085577;
               ContiniaOnlineDC@6085573 : Codeunit 6085617;
             BEGIN
               IF NOT "Allow Delete" THEN
                 IF Status = Status::Registered THEN
                   ERROR(STRSUBSTNO(RejectedDocsDeleteErr,TABLECAPTION,FIELDCAPTION(Status),Status));

               IF NOT DeleteCheckSuspended THEN BEGIN
                 IF "Document Category Code" <> '' THEN BEGIN
                   DocCat.GET("Document Category Code");
                   IF NOT DocCat."Allow Deleting Documents" THEN
                     ERROR(Text007,TABLECAPTION,"No.",DocCat.FIELDCAPTION("Allow Deleting Documents"),DocCat.TABLECAPTION,DocCat.Code);
                 END;

                 ContiniaOnlineDC.IsCompanyActive(TRUE);
               END;

               Page.SETRANGE("Document No.","No.");
               Page.DELETEALL(TRUE);

               Value.SETRANGE("Document No.","No.");
               Value.DELETEALL(TRUE);

               PurchDocMatch.SETRANGE("Document No.","No.");
               PurchDocMatch.DELETEALL(TRUE);

               DocumentCommentLine.SETRANGE("Table ID",DATABASE::"DC Document");
               DocumentCommentLine.SETRANGE("No.","No.");
               DocumentCommentLine.DELETEALL;

               DeleteComments(-2);

               IF "File Type" = "File Type"::OCR THEN BEGIN
                 ClearEmailFile;
                 ClearTiffFile;
                 ClearPdfFile;
               END ELSE
                 IF "File Type" = "File Type"::Miscellaneous THEN
                   ClearMiscFile;
             END;

    OnRename=BEGIN
               ERROR(Text001,TABLECAPTION);
             END;

    CaptionML=[DEU=Beleg;
               ENU=Document;
               NLD=Document;
               NOR=Dokument;
               SVE=Dokument];
    LookupPageID=Page6085598;
    DrillDownPageID=Page6085598;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;CaptionML=[DEU=Nr.;
                                                              ENU=No.;
                                                              NLD=Nr.;
                                                              NOR=Nr;
                                                              SVE=No.];
                                                   NotBlank=Yes }
    { 2   ;   ;Document Category Code;Code10      ;TableRelation="DC Document Category";
                                                   OnValidate=VAR
                                                                NewDocument@1001 : Record 6085590;
                                                                TempFile@1000 : TEMPORARY Record 6085608;
                                                                CopyFiles@1160040000 : Boolean;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                VALIDATE("Source Record ID Tree ID",0);

                                                                IF "Document Category Code" = xRec."Document Category Code" THEN
                                                                  EXIT;

                                                                GetDCSetup;

                                                                IF (DCSetup."Document Storage Type" <> DCSetup."Document Storage Type"::"File System") OR
                                                                  NOT DCSetup."Category Code in Archive"
                                                                THEN
                                                                  EXIT;

                                                                // Only if using filesystem.
                                                                CopyFiles := FALSE;

                                                                IF xRec.GetTiffFile(TempFile) THEN
                                                                  IF SetTiffFile(TempFile) THEN
                                                                    CopyFiles := TRUE;

                                                                IF xRec.GetPdfFile(TempFile) THEN
                                                                  IF SetPdfFile(TempFile) THEN
                                                                     CopyFiles := TRUE;

                                                                IF xRec.GetMiscFile(TempFile) THEN
                                                                  IF SetMiscFile(TempFile) THEN
                                                                    CopyFiles := TRUE;

                                                                IF xRec.GetEmailFile(TempFile) THEN
                                                                  IF SetEmailFile(TempFile) THEN
                                                                    CopyFiles := TRUE;

                                                                COMMIT;

                                                                IF NOT CopyFiles THEN
                                                                  EXIT;

                                                                IF xRec.HasTiffFile THEN
                                                                  xRec.ClearTiffFile;

                                                                IF xRec.HasPdfFile THEN
                                                                  xRec.ClearPdfFile;

                                                                IF xRec.HasMiscFile THEN
                                                                  xRec.ClearMiscFile;

                                                                IF xRec.HasEmailFile THEN
                                                                  xRec.ClearEmailFile;
                                                              END;

                                                   CaptionML=[DEU=Belegkategorie-Code;
                                                              ENU=Document Category Code;
                                                              NLD=Documentcategoriecode];
                                                   NotBlank=Yes }
    { 3   ;   ;TIFF Image File     ;BLOB          ;CaptionML=[DEU=TIFF-Bilddatei;
                                                              ENU=TIFF Image File;
                                                              NLD=TIFF Image bestand] }
    { 6   ;   ;Template No.        ;Code20        ;TableRelation=Template WHERE (Category Code=FIELD(Document Category Code),
                                                                                 Source Record ID Tree ID=FIELD(Source Record ID Tree ID));
                                                   OnValidate=VAR
                                                                Value@1160040001 : Record 6085593;
                                                                PurchDocMatch@1160040000 : Record 6085700;
                                                                Template@1100528000 : Record 6085579;
                                                              BEGIN
                                                                TestStatus;
                                                                OK := FALSE;

                                                                Value.SETRANGE("Document No.","No.");
                                                                Value.DELETEALL(TRUE);

                                                                DeleteComments(-1);

                                                                PurchDocMatch.SETRANGE("Document No.","No.");
                                                                PurchDocMatch.DELETEALL(TRUE);

                                                                //**4PS sn
                                                                IF Template.GET("Template No.") THEN  BEGIN
                                                                  "Amounts Only" := Template."Amounts Only";
                                                                  "Invoice Lines Input":= Template."Invoice Lines Input";
                                                                END;
                                                                //**4PS en

                                                                "Match Status" := "Match Status"::Unmatched;
                                                                MODIFY(TRUE);
                                                              END;

                                                   CaptionML=[DEU=Vorlagennr.;
                                                              ENU=Template No.;
                                                              NLD=Sjabloonnr.;
                                                              NOR=Malnr.;
                                                              SVE=Mallnr] }
    { 7   ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                IF Status = Status::Open THEN BEGIN
                                                                  "Amount Excl. VAT" := 0;
                                                                  "Amount Incl. VAT" := 0;
                                                                  "Created Doc. Type" := 0;
                                                                  "Created Doc. Subtype" := 0;
                                                                  "Created Doc. ID" := '';
                                                                  "Created Doc. Ref. No." := 0;
                                                                  Description := '';
                                                                  EXIT;
                                                                END;

                                                                "Date-Time for Register/Reject" := CURRENTDATETIME;
                                                              END;

                                                   CaptionML=[DEU=Status;
                                                              ENU=Status;
                                                              NLD=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[DEU=Offen,Registriert,Abgelehnt;
                                                                    ENU=Open,Registered,Rejected;
                                                                    NLD=Open,Geregistreerd,Geweigerd];
                                                   OptionString=Open,Registered,Rejected;
                                                   Editable=No }
    { 8   ;   ;No. of Pages        ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Document Page" WHERE (Document No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anz. der Seiten;
                                                              ENU=No. of Pages;
                                                              NLD=Aantal pagina's];
                                                   Editable=No }
    { 9   ;   ;OK                  ;Boolean       ;CaptionML=[DEU=OK;
                                                              ENU=OK;
                                                              NLD=OK;
                                                              NOR=OK;
                                                              SVE=OK];
                                                   Editable=No }
    { 10  ;   ;Filename            ;Code100       ;CaptionML=[DEU=Dateiname;
                                                              ENU=Filename;
                                                              NLD=Bestandsnaam;
                                                              NOR=Filnavn;
                                                              SVE=Filnamn];
                                                   Editable=No }
    { 11  ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[DEU=Nummernserie;
                                                              ENU=No. Series;
                                                              NLD=Nr.-reeksen;
                                                              NOR=Nr.serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 12  ;   ;Template Description;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Template.Description WHERE (No.=FIELD(Template No.)));
                                                   CaptionML=[DEU=Vorlagenbeschreibung;
                                                              ENU=Template Description;
                                                              NLD=Sjabloonomschrijving;
                                                              NOR=Malbeskrivelse;
                                                              SVE=Mallbeskrivning];
                                                   Editable=No }
    { 13  ;   ;Created Doc. Type   ;Integer       ;CaptionML=[DEU=Erstellte Belegart;
                                                              ENU=Created Doc. Type;
                                                              NLD=Gemaakte Document type];
                                                   Editable=No }
    { 14  ;   ;Created Doc. Subtype;Integer       ;CaptionML=[DEU=Erstellte Bel.-Unterart;
                                                              ENU=Created Doc. Subtype;
                                                              NLD=Gemaakte Document subtype];
                                                   Editable=No }
    { 15  ;   ;Created Doc. ID     ;Code20        ;CaptionML=[DEU=Erstellte Bel.-ID;
                                                              ENU=Created Doc. ID;
                                                              NLD=Gemaakte document-id];
                                                   Editable=No }
    { 16  ;   ;Created Doc. Ref. No.;Integer      ;CaptionML=[DEU=Erst. Bel. Referenznr.;
                                                              ENU=Created Doc. Ref. No.;
                                                              NLD=Gemaakte Doc.ref.nummer];
                                                   Editable=No }
    { 17  ;   ;Description         ;Text80        ;CaptionML=[DEU=Beschreibung;
                                                              ENU=Description;
                                                              NLD=Omschrijving;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 18  ;   ;Match Status        ;Option        ;CaptionML=[DEU=Abgleichstatus;
                                                              ENU=Match Status;
                                                              NLD=Match status];
                                                   OptionCaptionML=[DEU=Nicht abgeglichen,Automatisch abgeglichen,Manuell abgeglichen;
                                                                    ENU=Unmatched,Automatically Matched,Manually Matched;
                                                                    NLD=Niet gematcht,Automatisch gematcht,Handmatig gematcht];
                                                   OptionString=Unmatched,Automatically Matched,Manually Matched;
                                                   Editable=No }
    { 19  ;   ;Show after Register ;Boolean       ;CaptionML=[DEU=Nach Registrierung anzeigen;
                                                              ENU=Show After Register;
                                                              NLD=Tonen na registratie];
                                                   Editable=No }
    { 20  ;   ;PDF File            ;BLOB          ;CaptionML=[DEU=PDF-Datei;
                                                              ENU=PDF File;
                                                              NLD=PFD bestand] }
    { 21  ;   ;Misc. File          ;BLOB          ;CaptionML=[DEU=Import-Datum;
                                                              ENU=Misc. File;
                                                              NLD=Overig bestand;
                                                              NOR=Importdato;
                                                              SVE=Importdatum] }
    { 25  ;   ;Imported by         ;Code50        ;CaptionML=[DEU=Importiert von;
                                                              ENU=Imported by;
                                                              NLD=Geimporteerd door;
                                                              SVE=Importerades av anvÑndar-ID];
                                                   Editable=No }
    { 26  ;   ;Imported Date-Time  ;DateTime      ;CaptionML=[DEU=Importdatum/-Zeit;
                                                              ENU=Imported Date-Time;
                                                              NLD=Geimporteerd op];
                                                   Editable=No }
    { 27  ;   ;Date-Time for Register/Reject;DateTime;
                                                   CaptionML=[DEU=Datum/Zeit fÅr Registrierung;
                                                              ENU=Date-Time for Register/Reject;
                                                              NLD=Datum/tijd voor registeren/weigeren];
                                                   Editable=No }
    { 28  ;   ;File Type           ;Option        ;CaptionML=[DEU=Dateityp;
                                                              ENU=File Type;
                                                              NLD=Bestandstype;
                                                              NOR=Filtype;
                                                              SVE=Filtyp];
                                                   OptionCaptionML=[DEU=OCR ,,,,Verschiedenes;
                                                                    ENU=OCR,,,,Miscellaneous;
                                                                    NLD=OCR,,,,Diversen];
                                                   OptionString=OCR,,,,Miscellaneous;
                                                   Editable=No }
    { 29  ;   ;File Extension      ;Text30        ;CaptionML=[DEU=Dateierweiterung;
                                                              ENU=File Extension;
                                                              NLD=Bestands-extensie;
                                                              NOR=Filtype;
                                                              SVE=FilÑndelse];
                                                   Editable=No }
    { 30  ;   ;Allow Delete        ;Boolean       ;CaptionML=[DEU=Lîschen zulassen;
                                                              ENU=Allow Delete;
                                                              NLD=Verwijderen toestaan];
                                                   Editable=No }
    { 31  ;   ;From E-Mail Address ;Text200       ;CaptionML=[DEU=Von E-Mail-Adresse;
                                                              ENU=From E-Mail Address;
                                                              NLD=Van e-mailadres];
                                                   Editable=No }
    { 32  ;   ;From E-Mail Name    ;Text200       ;CaptionML=[DEU=Von E-Mail-Name;
                                                              ENU=From E-Mail Name;
                                                              NLD=Van e-mailnaam];
                                                   Editable=No }
    { 33  ;   ;To E-Mail Address   ;Text200       ;CaptionML=[DEU=An E-Mail-Adresse;
                                                              ENU=To E-Mail Address;
                                                              NLD=Aan e-mailadres];
                                                   Editable=No }
    { 34  ;   ;To E-Mail Name      ;Text200       ;CaptionML=[DEU=An E-Mail-Name;
                                                              ENU=To E-Mail Name;
                                                              NLD=Aan e-mailnaam];
                                                   Editable=No }
    { 35  ;   ;E-Mail Date         ;DateTime      ;CaptionML=[DEU=E-Mail-Datum;
                                                              ENU=E-Mail Date;
                                                              NLD=Datum e-mail];
                                                   Editable=No }
    { 36  ;   ;E-Mail Inbox Subfolder;Text200     ;CaptionML=[DEU=Eingangsfach-Unterordner;
                                                              ENU=Inbox Subfolder;
                                                              NLD=Inbox-submap e-mail];
                                                   Editable=No }
    { 37  ;   ;E-Mail Subject      ;Text200       ;CaptionML=[DEU=E-Mail-Betreff;
                                                              ENU=E-Mail Subject;
                                                              NLD=Onderwerp e-mail;
                                                              SVE=E-postÑmne];
                                                   Editable=No }
    { 38  ;   ;E-Mail GUID         ;GUID          ;CaptionML=[DEU=E-Mail-GUID;
                                                              ENU=E-Mail GUID;
                                                              NLD=GUID e-mail];
                                                   Editable=No }
    { 39  ;   ;Batch Register      ;Boolean       ;CaptionML=[DEU=Batch-Register;
                                                              ENU=Batch Register;
                                                              NLD=Registreer batch];
                                                   Editable=No }
    { 40  ;   ;PDF File Hash       ;Text50        ;CaptionML=[DEU=PDF-Datei-Hash;
                                                              ENU=PDF File Hash;
                                                              NLD=PDF-bestand hash];
                                                   Editable=No }
    { 41  ;   ;Status Code         ;Code10        ;TableRelation="Document Status Code";
                                                   OnValidate=VAR
                                                                DocumentCommentLine@1160040000 : Record 6085577;
                                                              BEGIN
                                                                IF xRec."Status Code" <> "Status Code" THEN BEGIN
                                                                  DocumentCommentLine.INIT;
                                                                  DocumentCommentLine."Table ID" := DATABASE::"DC Document";
                                                                  DocumentCommentLine."No." := "No.";
                                                                  DocumentCommentLine."Line No." := 0;
                                                                  DocumentCommentLine.INSERT(TRUE);
                                                                  DocumentCommentLine.Type := DocumentCommentLine.Type::"Status Code";
                                                                  DocumentCommentLine.Comment := STRSUBSTNO(Text010,FIELDCAPTION("Status Code"),xRec."Status Code","Status Code",USERID);
                                                                  DocumentCommentLine.MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Statuscode;
                                                              ENU=Status Code;
                                                              NLD=Statuscode;
                                                              SVE=Statuskod] }
    { 42  ;   ;OCR Process Completed;DateTime     ;CaptionML=[DEU=OCR Prozess fertig;
                                                              ENU=OCR Process Completed;
                                                              NLD=OCR proces gereed];
                                                   Editable=No }
    { 45  ;   ;Source Record Table ID;Integer     ;CaptionML=[DEU=Herkunft Datensatztabelle-ID;
                                                              ENU=Source Record Table ID;
                                                              NLD=Bronrecordtabel-id];
                                                   NotBlank=No }
    { 46  ;   ;Source Record No.   ;Code50        ;CaptionML=[DEU=Herkunft Datensatznr.;
                                                              ENU=Source Record No.;
                                                              NLD=Bronrecordnr.] }
    { 47  ;   ;Source Record Name  ;Text100       ;CaptionML=[DEU=Herkunft Datensatzname;
                                                              ENU=Source Record Name;
                                                              NLD=Bronrecordnaam];
                                                   Editable=No }
    { 48  ;   ;Version             ;Integer       ;CaptionML=[DEU=Version;
                                                              ENU=Version;
                                                              NLD=Versie;
                                                              SVE=Version];
                                                   Editable=No }
    { 50  ;   ;Amount Excl. VAT    ;Decimal       ;CaptionML=[DEU=Betrag ohne MwSt.;
                                                              ENU=Amount Excl. VAT;
                                                              NLD=Bedrag excl. btw;
                                                              NOR=Belõp eks. mva;
                                                              SVE=Belopp exklusive moms];
                                                   Editable=No }
    { 51  ;   ;Amount Incl. VAT    ;Decimal       ;CaptionML=[DEU=Betrag inkl. MwSt.;
                                                              ENU=Amount Incl. VAT;
                                                              NLD=Bedrag incl. btw;
                                                              NOR=Belõp inkl. mva.;
                                                              SVE=Belopp inkl moms];
                                                   Editable=No }
    { 53  ;   ;Import Day          ;Integer       ;CaptionML=[DEU=Importtag;
                                                              ENU=Import Day;
                                                              NLD=Importdag];
                                                   Editable=No }
    { 54  ;   ;Import Month        ;Integer       ;CaptionML=[DEU=Importmonat;
                                                              ENU=Import Month;
                                                              NLD=Importmaand];
                                                   Editable=No }
    { 55  ;   ;Import Year         ;Integer       ;CaptionML=[DEU=Importjahr;
                                                              ENU=Import Year;
                                                              NLD=Importjaar] }
    { 60  ;   ;Identification Barcode;Code50      ;CaptionML=[DEU=Identifikationsbarcode;
                                                              ENU=Identification Barcode;
                                                              NLD=Kenmerkbarcode];
                                                   Editable=No }
    { 61  ;   ;Source Record ID Tree ID;Integer   ;TableRelation="Record ID Tree";
                                                   OnValidate=VAR
                                                                RecRef@6085573 : RecordRef;
                                                                RecIDMgt@6085574 : Codeunit 6085604;
                                                                RecID@6085575 : RecordID;
                                                                RecordIDTree@6085576 : Record 6085763;
                                                                Template@1160040000 : Record 6085579;
                                                              BEGIN
                                                                TestStatus;

                                                                "Source Record Table ID" := 0;
                                                                "Source Record No." := '';
                                                                "Source Record Name" := '';

                                                                IF "Source Record ID Tree ID" = 0 THEN
                                                                  VALIDATE("Template No.",'')
                                                                ELSE BEGIN
                                                                  IF RecIDMgt.GetRecIDFromTreeID("Source Record ID Tree ID",RecID) THEN BEGIN
                                                                    RecRef := RecID.GETRECORD;
                                                                    IF RecIDMgt.KeyIsOneFieldCodeType(RecRef) THEN BEGIN
                                                                      "Source Record Table ID" := RecRef.NUMBER;
                                                                      "Source Record No." := COPYSTR(GetSourceID,1,MAXSTRLEN("Source Record No."));
                                                                      "Source Record Name" := GetSourceName;
                                                                    END;
                                                                    VALIDATE("Template No.",GetDefaultTemplate(FALSE));
                                                                  END ELSE BEGIN
                                                                    RecordIDTree.GET("Source Record ID Tree ID");
                                                                    IF RecordIDTree."Table No." = DATABASE::Vendor THEN BEGIN
                                                                      Template.GET(GetDefaultTemplate(FALSE));
                                                                      ERROR(VendorNotFountErr,RecordIDTree."Value (Text)",Template."Search Text",Template."No.");
                                                                    END ELSE
                                                                      ERROR(SourceNotExist,RecordIDTree."Value (Text)",GetDefaultTemplate(FALSE));
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Herkunftsdatensatz-ID Baum-ID;
                                                              ENU=Source Record ID Tree ID;
                                                              NLD=Bronrecord-id Boom-id];
                                                   Editable=No }
    { 62  ;   ;Document Status Text;Text100       ;CaptionML=[DEU=Belegstatustext;
                                                              ENU=Document Status Text;
                                                              NLD=Document statustekst];
                                                   Editable=No }
    { 63  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Document Comment Line" WHERE (Table ID=CONST(6085590),
                                                                                                    No.=FIELD(No.),
                                                                                                    Type=CONST(User)));
                                                   CaptionML=[DEU=Bemerkung;
                                                              ENU=Comment;
                                                              NLD=Opmerking;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 11012001;;Company            ;Text100       ;TableRelation=Company;
                                                   CaptionML=[DEU=Mandant;
                                                              ENU=Company;
                                                              NLD=Bedrijf;
                                                              NOR=Selskap;
                                                              SVE=Fîretag] }
    { 11012002;;Amounts Only       ;Boolean       ;CaptionML=[DEU=Nur BetrÑge;
                                                              ENU=Amounts Only;
                                                              NLD=Alleen bedragen;
                                                              NOR=Kun belõp;
                                                              SVE=Endast belopp] }
    { 11012003;;Invoice Lines Input;Boolean       ;InitValue=No;
                                                   OnValidate=VAR
                                                                PurchSetup@1100528200 : Record 312;
                                                              BEGIN
                                                                //**4PS
                                                                PurchSetup.GET;
                                                                IF ("Invoice Lines Input") AND
                                                                   (PurchSetup."Approve Purchase Invoices") AND
                                                                   (PurchSetup."VAT Indicator (Purchase)" = PurchSetup."VAT Indicator (Purchase)" ::"No VAT") THEN
                                                                  ERROR(Text11012001);
                                                              END;

                                                   CaptionML=[DEU=Rechnungszeilen Eingabe;
                                                              ENU=Invoice Lines Input;
                                                              NLD=Factuurregels invoeren;
                                                              NOR=Fakturaradstilgang;
                                                              SVE=Inmatning fîr fakturarader] }
    { 11012004;;Document On Hold Code;Code10      ;TableRelation="Document On Hold Code DC";
                                                   CaptionML=[DEU=Wartestatuscode Beleg;
                                                              ENU=Document On Hold Code;
                                                              NLD=Document wachtcode] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Status                                   }
    {    ;Document Category Code,Status            }
    {    ;Template No.,Status                      }
    {    ;Source Record ID Tree ID                 }
    {    ;Filename                                 }
    {    ;Created Doc. Type,Created Doc. Subtype,Created Doc. ID,Created Doc. Ref. No. }
    {    ;Document Category Code                   }
    {    ;E-Mail GUID                              }
    {    ;Source Record Table ID,Source Record No.,Document Category Code }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      DCSetup@1000000002 : Record 6085573;
      CaptureMgt@1000000006 : Codeunit 6085576;
      DocumentFileInterface@1002 : Codeunit 6085635;
      Text001@1160040001 : TextConst 'DEU=Sie kînnen eine %1 nicht umbenennen.;ENU=You cannot rename a %1.;NLD=U kunt een %1 niet hernoemen.;NOR=Du kan ikke gi nytt navn til en %1.;SVE=Du kan inte byta namn pÜ %1.';
      Text002@1160040000 : TextConst 'DEU=Mîchten Sie den Beleg ablehnen?;ENU=Do you want to reject the document?;NLD=Wilt u het document weigeren?';
      Text004@1160040004 : TextConst 'DEU=%1 %2 liegt nicht innerhalb der Filter von %3.;ENU=The %1 %2 is not within the filters of the %3.;NLD=De/het %1 %2 voldoet niet aan de filters van %3.';
      IsManual@161024014 : Boolean;
      Text005@1160040003 : TextConst 'DEU=Mit diesem Beleg sind keine E-Mails verknÅpft.;ENU=There are no e-mails associated to this document.;NLD=Er zijn geen e-mails geassocieerd met dit document.';
      GotDCSetup@1160040005 : Boolean;
      Text006@1160040006 : TextConst 'DEU=Eine Vorlage fÅr %1 %2 wurde in Unternehmen %3 gefunden, mîchten Sie diese Vorlage kopieren?;ENU=A template for %1 %2 has been found in company %3, do you want to copy this template?;NLD=Er is een sjabloon gevonden voor %1 %2 in bedrijf %3';
      Text11012001@1100528200 : TextConst 'DEU="Nicht zulÑssig bei Einkaufseinrichtung ''MwSt. zurÅck zu fordern'' = ''Nein''";ENU=Not allowed with Purchase Setup VAT Indicator ''No VAT'';NLD="Niet toegestaan bij inkoopinstelling ''Btw terug te vorderen'' =  ''Nee''.";NOR=Ikke tillatt med innkjõpsinstillingen ''Ingen avgift'';SVE=Inte tillÜtet med inkîpsinstÑllningen ''Ingen moms''';
      SupplyingCompany@1100528400 : Text[30];
      DeleteCheckSuspended@1160040007 : Boolean;
      Text007@1160040008 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, weil %3 in %4 %5 gesperrt ist.;ENU=You cannot delete %1 %2 because %3 in %4 %5 is disabled.;NLD=U kunt %1 %2 niet verwijderen omdat %3 in %4 %5 geblokkeerd is.';
      Text008@1000 : TextConst 'DEU=Kein Kreditor wurde diesem Beleg zugewiesen.\\Mîchten Sie einen neuen Kreditor erstellen?;ENU=No vendor assigned to this document.\\Do you want to create a new vendor?;NLD=Aan dit document is geen leverancier toegewezen.\\Wilt u een nieuwe leverancier aanmaken?';
      Text009@1001 : TextConst 'DEU=Kein Debitor wurde diesem Beleg.\\Mîchten Sie einen neuen Debitor erstellen?;ENU=No customer assigned for this document.\\Do you want to create a new customer?;NLD=Aan dit document is geen klant toegewezen.\\Wilt u een nieuwe klant aanmaken?';
      Text010@1160040009 : TextConst 'DEU=%1 geÑndert von "%2" in "%3" von %4;ENU=%1 changed from ''%2'' to ''%3'' by %4;NLD=%1 veranderd van "%2" naar "%3" door %4';
      NoSourceAvailableTxt@6085600 : TextConst 'DEU=Nicht zutreffend;ENU=N/A;NLD=N/A;SVE=-';
      NotOkErr@6085573 : TextConst 'DEU=De Beleg ist nicht fertig zum Festlegen.\\Bitte, prÅfen Sie den Kommentarteil des Belegs auf Fehler.;ENU=The document is not ready to be registered.\\Please check the comment section of the document for errors;NLD=Het document kan niet worden geregistreerd.\\Controleer het commentaargedeelte van het document op fouten';
      RejectedDocsDeleteErr@6085574 : TextConst 'DEU=%1 kann nicht gelîscht werden, wenn %2 %3 ist;ENU=%1 can''t be deleted when %2 is %3;NLD=%1 kan niet worden verwijderd wanneer %2 %3 is';
      SourceNotExist@6085575 : TextConst 'ENU=%1 used on template %2 does not exist.';
      VendorNotFountErr@6085576 : TextConst 'ENU=Vendor %1 doesn''t exist. Please, remove search text %2 from template %3.';
      GotContiniaCompanySetup@1100529500 : Boolean;
      ContiniaCompanySetup@1100529501 : Record 6192773;

    PROCEDURE GetSourceNoCaption@1000000001() : Text[50];
    VAR
      DocCat@161024012 : Record 6085575;
      ObjWithCap@161024013 : Record 2000000058;
    BEGIN
      IF NOT DocCat.GET("Document Category Code") THEN
        EXIT;

      IF ObjWithCap.GET(ObjWithCap."Object Type"::Table,DocCat."Source Table No.") THEN
        EXIT(ObjWithCap."Object Caption")
      ELSE
        EXIT(NoSourceAvailableTxt);
    END;

    PROCEDURE GetSourceNameCaption@1000000003() : Text[50];
    VAR
      Fld@161024012 : Record 2000000041;
      DocCat@161024013 : Record 6085575;
    BEGIN
      IF NOT DocCat.GET("Document Category Code") THEN
        EXIT;

      IF Fld.GET(DocCat."Source Table No.",DocCat."Source Field No. (Name)") THEN
        EXIT(Fld."Field Caption")
      ELSE
        EXIT(NoSourceAvailableTxt);
    END;

    PROCEDURE GetSourceName@1000000000() : Text[1024];
    VAR
      DocCat@1160040000 : Record 6085575;
      RecIDMgt@1160040001 : Codeunit 6085604;
      SourceName@1000 : Text[1024];
    BEGIN
      IF DocCat.GET("Document Category Code") THEN BEGIN
        SourceName := RecIDMgt.GetFieldValue("Source Record ID Tree ID",DocCat."Source Field No. (Name)");
        IF SourceName = '' THEN
          SourceName := "Source Record Name";
        EXIT(COPYSTR(SourceName,1,MAXSTRLEN("Source Record Name")));
      END;
    END;

    PROCEDURE GetDefaultTemplate@1000000002(CreateNew@1000000001 : Boolean) : Code[20];
    VAR
      DocCat@1160040000 : Record 6085575;
      Template@1000000000 : Record 6085579;
      Template2@1160040004 : Record 6085579;
      FromCompany@1160040001 : Text[30];
      SourceName@1160040002 : Text[250];
      SourceID@1160040003 : Text[250];
    BEGIN
      Template.SETRANGE("Category Code","Document Category Code");
      Template.SETRANGE("Source Record ID Tree ID","Source Record ID Tree ID");
      Template.SETRANGE(Type,Template.Type::" ");
      Template.SETRANGE(Default,TRUE);
      IF Template.FINDFIRST THEN BEGIN
        IF Template.COUNT = 1 THEN
          EXIT(Template."No.");

        IF CreateNew THEN
          EXIT(Template.CreateNew("Document Category Code","Source Record ID Tree ID",FALSE));

        EXIT('');
      END;

      Template.SETRANGE(Default);
      IF Template.FINDFIRST THEN BEGIN
        IF Template.COUNT = 1 THEN
          EXIT(Template."No.");

        IF CreateNew THEN
          EXIT(Template.CreateNew("Document Category Code","Source Record ID Tree ID",FALSE));

        EXIT('');
      END ELSE
        IF IsManual OR CreateNew THEN BEGIN
          DocCat.GET("Document Category Code");
          IF NOT DocCat.HasMasterTemplate THEN
            EXIT('');

          SourceName := GetSourceName;
          SourceID := GetSourceID;

          IF FindTemplateInCompanies(FromCompany,Template,SourceName) THEN
            IF CONFIRM(Text006,TRUE,SourceID,SourceName,FromCompany) THEN BEGIN
              Template2.GET(Template.Clone(FromCompany,Template,Template."Category Code",'',Template.Type,TRUE,FALSE));
              Template2.VALIDATE("Source Record ID Tree ID","Source Record ID Tree ID");
              Template2.MODIFY;
              EXIT(Template2."No.");
            END;

          EXIT(Template.CreateNew("Document Category Code","Source Record ID Tree ID",FALSE));
        END;

      EXIT('');
    END;

    PROCEDURE DeleteComments@1000000004(Area@1000000001 : Integer);
    VAR
      Comment@1000000000 : Record 6085594;
    BEGIN
      Comment.SETCURRENTKEY("Document No.");
      Comment.SETRANGE("Document No.","No.");
      IF Area = -2 THEN
        Comment.SETFILTER(Area,'<>%1',Comment.Area::Import)
      ELSE
        IF Area >= 0 THEN
          Comment.SETRANGE(Area,Area);
      Comment.DELETEALL;
    END;

    PROCEDURE HasWarningComments@1160040013() : Boolean;
    VAR
      Comment@1000000000 : Record 6085594;
    BEGIN
      Comment.SETCURRENTKEY("Document No.");
      Comment.SETRANGE("Document No.","No.");
      Comment.SETRANGE("Comment Type",Comment."Comment Type"::Warning);
      EXIT(NOT Comment.ISEMPTY);
    END;

    PROCEDURE HasDocumentLines@6085573() : Boolean;
    VAR
      DocValue@6085573 : Record 6085593;
    BEGIN
      DocValue.SETRANGE("Document No.","No.");
      DocValue.SETRANGE(Type,DocValue.Type::Line);
      DocValue.SETRANGE("Is Value",TRUE);
      EXIT(NOT(DocValue.ISEMPTY));
    END;

    PROCEDURE BuildTempLinesTable@1000000005(VAR DocumentLine@1000000001 : Record 6085596);
    VAR
      Template@1000000006 : Record 6085579;
      Value@1000000000 : Record 6085593;
      Field@1000000004 : Record 6085580;
      FieldCodes@1000000005 : ARRAY [20] OF Code[20];
      NoOfLines@1000000002 : Integer;
      i@1000000003 : Integer;
    BEGIN
      IF "Template No." = '' THEN
        EXIT;

      Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
      Field.SETRANGE("Template No.","Template No.");
      Field.SETRANGE(Type,Field.Type::Line);
      IF Field.FINDSET THEN
        REPEAT
          i := i + 1;
          FieldCodes[i] := Field.Code;
        UNTIL (Field.NEXT = 0) OR (i = 20);

      Value.SETCURRENTKEY("Document No.","Is Value",Type,"Line No.");
      Value.SETRANGE("Document No.","No.");
      Value.SETRANGE("Is Value",TRUE);
      Value.SETRANGE(Type,Value.Type::Line);
      IF NOT Value.FINDLAST THEN
        EXIT;

      NoOfLines := Value."Line No.";

      Template.GET("Template No.");

      FOR i := 1 TO NoOfLines DO BEGIN
        DocumentLine.INIT;
        DocumentLine."Document No." := "No.";
        DocumentLine."Template No." := "Template No.";
        DocumentLine."Line No." := i;
        Value.SETRANGE("Document No.","No.");
        Value.SETRANGE("Line No.",i);
        IF Value.FINDFIRST THEN BEGIN
          DocumentLine."Page No." := Value."Page No.";

          DocumentLine."Field Value 1" := GetValueAsText(FieldCodes[1],i);
          DocumentLine."Field Value 2" := GetValueAsText(FieldCodes[2],i);
          DocumentLine."Field Value 3" := GetValueAsText(FieldCodes[3],i);
          DocumentLine."Field Value 4" := GetValueAsText(FieldCodes[4],i);
          DocumentLine."Field Value 5" := GetValueAsText(FieldCodes[5],i);
          DocumentLine."Field Value 6" := GetValueAsText(FieldCodes[6],i);
          DocumentLine."Field Value 7" := GetValueAsText(FieldCodes[7],i);
          DocumentLine."Field Value 8" := GetValueAsText(FieldCodes[8],i);
          DocumentLine."Field Value 9" := GetValueAsText(FieldCodes[9],i);
          DocumentLine."Field Value 10" := GetValueAsText(FieldCodes[10],i);
          DocumentLine."Field Value 11" := GetValueAsText(FieldCodes[11],i);
          DocumentLine."Field Value 12" := GetValueAsText(FieldCodes[12],i);
          DocumentLine."Field Value 13" := GetValueAsText(FieldCodes[13],i);
          DocumentLine."Field Value 14" := GetValueAsText(FieldCodes[14],i);
          DocumentLine."Field Value 15" := GetValueAsText(FieldCodes[15],i);
          DocumentLine."Field Value 16" := GetValueAsText(FieldCodes[16],i);
          DocumentLine."Field Value 17" := GetValueAsText(FieldCodes[17],i);
          DocumentLine."Field Value 18" := GetValueAsText(FieldCodes[18],i);
          DocumentLine."Field Value 19" := GetValueAsText(FieldCodes[19],i);
          DocumentLine."Field Value 20" := GetValueAsText(FieldCodes[20],i);

          IF Template."Codeunit ID: Line Validation" <> 0 THEN
            CODEUNIT.RUN(Template."Codeunit ID: Line Validation",DocumentLine)
          ELSE
            DocumentLine.OK := TRUE;

          IF NOT DocumentLine.Skip THEN
            DocumentLine.INSERT;
        END;
      END;

      IF DocumentLine.FINDFIRST THEN;
    END;

    PROCEDURE GetValueAsText@1000000008(FieldCode@1000000000 : Code[20];LineNo@1000000002 : Integer) : Text[250];
    VAR
      Field@1000000001 : Record 6085580;
    BEGIN
      IF Field.GET("Template No.",Field.Type::Line,FieldCode) THEN
        EXIT(CaptureMgt.GetValueAsText("No.",LineNo,Field));
    END;

    PROCEDURE AfterCapture@1000000006();
    VAR
      Template@1000000000 : Record 6085579;
    BEGIN
      IF Template.GET("Template No.") THEN
        IF Template."Codeunit ID: After Capture" <> 0 THEN
          CODEUNIT.RUN(Template."Codeunit ID: After Capture",Rec);
    END;

    PROCEDURE ValidateDocument@1000000007();
    VAR
      DocCat@1160040000 : Record 6085575;
      Template@1000000000 : Record 6085579;
    BEGIN
      TestStatus;
      CheckSourceTableFilter;

      IF Template.GET("Template No.") THEN BEGIN
        IF Template."Codeunit ID: Doc. Validation" = 0 THEN BEGIN
          DeleteComments(1);
          Rec.OK := TRUE;
          MODIFY;
        END ELSE
          CODEUNIT.RUN(Template."Codeunit ID: Doc. Validation",Rec);
      END ELSE BEGIN
        DocCat.GET("Document Category Code");
        IF ("Source Record ID Tree ID" <> 0) AND (NOT DocCat.HasMasterTemplate ) THEN BEGIN
          Rec.OK := TRUE;
          MODIFY;
        END;
      END;
    END;

    PROCEDURE Register@1000000010();
    VAR
      DocCat@1160040000 : Record 6085575;
      Template@1000000000 : Record 6085579;
    BEGIN
      TestStatus;

      DocCat.GET("Document Category Code");
      DocCat.TESTFIELD("Source Table No.");

      IF RegisterWithoutTemplate(TRUE) THEN
        EXIT;

      TestSourceNoAndTemplNo;
      Template.GET("Template No.");
      Template.TESTFIELD("Codeunit ID: Register");

      CODEUNIT.RUN(Template."Codeunit ID: Register",Rec);
    END;

    PROCEDURE RegisterYN@161024014();
    VAR
      DocCat@1160040000 : Record 6085575;
      Template@1000000000 : Record 6085579;
    BEGIN
      TestStatus;

      IF RegisterWithoutTemplate(TRUE) THEN
        EXIT;

      DocCat.GET("Document Category Code");
      IF DocCat."Source Table No." <> 0 THEN
        TestSourceNoAndTemplNo;

      Template.GET("Template No.");
      Template.TESTFIELD("Codeunit ID: Register (Y/N)");

      CODEUNIT.RUN(Template."Codeunit ID: Register (Y/N)",Rec);
    END;

    LOCAL PROCEDURE RegisterWithoutTemplate@1(HideErrors@1000 : Boolean) : Boolean;
    VAR
      DocCat@1001 : Record 6085575;
      TempKeyField@1160040001 : TEMPORARY Record 2000000041;
      RecIDMgt@1160040000 : Codeunit 6085604;
      RecIDText@1160040002 : Text[250];
      FieldValueAsText@1160040003 : Text[250];
    BEGIN
      DocCat.GET("Document Category Code");
      IF DocCat.HasMasterTemplate THEN
        EXIT;

      IF NOT HideErrors THEN
        TESTFIELD("Source Record ID Tree ID")
      ELSE
        IF "Source Record ID Tree ID" = 0 THEN
          EXIT;

      "Created Doc. Type" := DocCat."Source Table No.";
      "Created Doc. Subtype" := GetSubType;
      "Created Doc. ID" := GetSourceID;

      IF Description = '' THEN BEGIN
        RecIDMgt.GetKeyFields(DocCat."Source Table No.",TempKeyField);
        IF TempKeyField.FINDSET THEN
          REPEAT
            FieldValueAsText := RecIDMgt.GetKeyValue("Source Record ID Tree ID",TempKeyField."No.");
            IF TempKeyField.Type = TempKeyField.Type::Option THEN
              FieldValueAsText := RecIDMgt.IntToOptionText(DocCat."Source Table No.",TempKeyField."No.",FieldValueAsText);

            IF FieldValueAsText <> '' THEN BEGIN
              IF Description = '' THEN
                Description := FieldValueAsText
              ELSE
                Description := Description + ', ' + FieldValueAsText;
            END;
          UNTIL TempKeyField.NEXT = 0;

        IF DocCat.Description <> '' THEN
          Description := STRSUBSTNO('%1 (%2)',DocCat.Description,Description);
      END;

      VALIDATE(Status,Status::Registered);
      MODIFY;
      EXIT(TRUE);
    END;

    PROCEDURE RegisterHideErrors@1160040012() : Boolean;
    VAR
      DocCat@1160040000 : Record 6085575;
      Template@1000000000 : Record 6085579;
    BEGIN
      IF Status <> Status::Open THEN
        EXIT(FALSE);

      IF NOT DocCat.GET("Document Category Code") THEN
        EXIT(FALSE);

      IF RegisterWithoutTemplate(TRUE) THEN
        EXIT(TRUE);

      IF DocCat."Source Table No." <> 0 THEN BEGIN
        IF "Source Record ID Tree ID" = 0 THEN
          EXIT(FALSE);
        IF NOT Template.GET("Template No.") THEN
          EXIT(FALSE);
      END;

      IF Template."Codeunit ID: Register" = 0 THEN
        EXIT(FALSE);

      //**4PS.so Call C041748
      //IF HasWarningComments THEN
      //  EXIT(FALSE);
      //**4PS.eo

      EXIT(CODEUNIT.RUN(Template."Codeunit ID: Register",Rec));
    END;

    PROCEDURE Reject@1000000011();
    VAR
      PurchDocMatch@1160040000 : Record 6085700;
    BEGIN
      TestStatus;

      IF NOT CONFIRM(Text002) THEN
        EXIT;

      PurchDocMatch.SETRANGE("Document No.","No.");
      PurchDocMatch.DELETEALL(TRUE);

      VALIDATE(Status,Status::Rejected);
      MODIFY(TRUE);
    END;

    PROCEDURE Reopen@161024013();
    VAR
      DocCat@161024012 : Record 6085575;
    BEGIN
      DocCat.GET("Document Category Code");
      IF DocCat."Codeunit ID: Reopen" = 0 THEN
        CODEUNIT.RUN(CODEUNIT::"Purch. Doc. - Reopen",Rec)
      ELSE
        CODEUNIT.RUN(DocCat."Codeunit ID: Reopen",Rec);
    END;

    PROCEDURE OpenTiffImageFile@1000000015();
    VAR
      TempFile@1000 : Record 6085608;
    BEGIN
      GetTiffFile(TempFile);
      TempFile.Open;
    END;

    PROCEDURE OpenPdfFile@1000000014();
    VAR
      TempFile@1000 : Record 6085608;
      WebClientMgt@6085573 : Codeunit 6085662;
    BEGIN
      IF "File Type" = "File Type"::OCR THEN
        GetPdfFile(TempFile)
      ELSE BEGIN
        GetMiscFile(TempFile);
        TempFile.LoadData;
        TempFile."File Location" := TempFile."File Location"::Memory;
        TempFile.Name := Description + '.' + "File Extension";
      END;

      TempFile.Open;
    END;

    PROCEDURE OpenEMailFile@1160040004();
    VAR
      TempFile@1000 : Record 6085608;
      EmptyGuid@1160040000 : GUID;
    BEGIN
      IF "E-Mail GUID" = EmptyGuid THEN
        ERROR(Text005);

      GetEmailFile(TempFile);
      TempFile.Open;
    END;

    PROCEDURE ShowRegisteredDoc@1160040009();
    VAR
      DocCat@1160040000 : Record 6085575;
    BEGIN
      DocCat.GET("Document Category Code");
      DocCat.TESTFIELD("Codeunit ID: Show Reg. Doc.");
      CODEUNIT.RUN(DocCat."Codeunit ID: Show Reg. Doc.",Rec);
    END;

    PROCEDURE TestStatus@1000000012();
    BEGIN
      TESTFIELD(Status,Status::Open);
    END;

    PROCEDURE TestSourceNoAndTemplNo@161024012();
    BEGIN
      TESTFIELD("Source Record ID Tree ID");
      TESTFIELD("Template No.");
    END;

    PROCEDURE GetTiffFileName@1000000017() FullFileName : Text[1024];
    VAR
      TempFile@1000 : TEMPORARY Record 6085608;
    BEGIN
      IF "No."= '' THEN
        EXIT('');

      IF GetTiffFile(TempFile) THEN
        FullFileName := TempFile.GetClientFilePath;
    END;

    PROCEDURE GetPdfFileName@1000000019() : Text[1024];
    VAR
      TempFile@1000 : TEMPORARY Record 6085608;
    BEGIN
      IF "No."= '' THEN
        EXIT('');

      GetPdfFile(TempFile);

      EXIT(TempFile.GetClientFilePath);
    END;

    PROCEDURE GetMiscFileName@161024015(WriteProtected@1160040000 : Boolean) : Text[1024];
    VAR
      TempFile@1000 : TEMPORARY Record 6085608;
    BEGIN
      IF "No."= '' THEN
        EXIT('');

      GetMiscFile(TempFile);

      EXIT(TempFile.GetClientFilePath);
    END;

    PROCEDURE GetEMailFileName@1160040000() : Text[1024];
    VAR
      TempFile@1000 : TEMPORARY Record 6085608;
    BEGIN
      IF "No."= '' THEN
        EXIT('');

      GetEmailFile(TempFile);

      EXIT(TempFile.GetClientFilePath);
    END;

    PROCEDURE HasTiffFile@13() : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.HasTiffFile(Rec));
    END;

    PROCEDURE HasPdfFile@18() : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.HasPdfFile(Rec));
    END;

    PROCEDURE HasMiscFile@19() : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.HasMiscFile(Rec));
    END;

    PROCEDURE HasEmailFile@20() : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.HasEmailFile(Rec));
    END;

    PROCEDURE ClearTiffFile@17() : Boolean;
    BEGIN
      IF DocumentFileInterface.HasTiffFile(Rec) THEN
        EXIT(DocumentFileInterface.ClearTiffFile(Rec))
    END;

    PROCEDURE ClearPdfFile@16() : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.ClearPdfFile(Rec))
    END;

    PROCEDURE ClearMiscFile@15() : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.ClearMiscFile(Rec))
    END;

    PROCEDURE ClearEmailFile@14() : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.ClearEmailFile(Rec))
    END;

    PROCEDURE GetTiffFile@22(VAR TempFile@1000 : TEMPORARY Record 6085608) : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.GetTiffFile(Rec,TempFile))
    END;

    PROCEDURE GetPdfFile@23(VAR TempFile@1000 : TEMPORARY Record 6085608) : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.GetPdfFile(Rec,TempFile))
    END;

    PROCEDURE GetMiscFile@24(VAR TempFile@1000 : TEMPORARY Record 6085608) : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.GetMiscFile(Rec,TempFile))
    END;

    PROCEDURE GetEmailFile@25(VAR TempFile@1000 : TEMPORARY Record 6085608) : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.GetEmailFile(Rec,TempFile))
    END;

    PROCEDURE SetTiffFile@29(VAR TempFile@1000 : TEMPORARY Record 6085608) : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.SetTiffFile(Rec,TempFile))
    END;

    PROCEDURE SetPdfFile@28(VAR TempFile@1000 : TEMPORARY Record 6085608) : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.SetPdfFile(Rec,TempFile))
    END;

    PROCEDURE SetMiscFile@27(VAR TempFile@1000 : TEMPORARY Record 6085608) : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.SetMiscFile(Rec,TempFile))
    END;

    PROCEDURE SetEmailFile@26(VAR TempFile@1000 : TEMPORARY Record 6085608) : Boolean;
    BEGIN
      EXIT(DocumentFileInterface.SetEmailFile(Rec,TempFile))
    END;

    PROCEDURE GetEmailGUIDAsText@1160040016() : Text[50];
    BEGIN
      EXIT(COPYSTR(FORMAT("E-Mail GUID"),2,36));
    END;

    PROCEDURE CheckSourceTableFilter@1160040003();
    VAR
      DocCat@1160040005 : Record 6085575;
      Field@1160040006 : Record 6085580;
      Comment@1160040001 : Record 6085594;
      RecIDMgt@1160040002 : Codeunit 6085604;
      RecRef@1160040003 : RecordRef;
      FieldRef@1160040000 : FieldRef;
    BEGIN
      IF "Source Record ID Tree ID" = 0 THEN
        EXIT;

      RecRef.GETTABLE(Rec);

      DocCat.GET("Document Category Code");
      IF NOT RecIDMgt.IsValueWithinFilters(DocCat."Source Table No.",DocCat."Source Field No.",
        DocCat."Document Category GUID",
        RecIDMgt.GetFieldValue("Source Record ID Tree ID",DocCat."Source Field No."))
      THEN
        Comment.Add(Rec,Field,0,Comment.Area::Validation,Comment."Comment Type"::Error,
          STRSUBSTNO(Text004,RecRef.CAPTION,RecIDMgt.GetFieldValue("Source Record ID Tree ID",DocCat."Source Field No."),
          DocCat.FIELDCAPTION("Source Table No.")));
    END;

    PROCEDURE SetAndCreateNewVendor@4();
    VAR
      NoSeriesRelationship@1003 : Record 310;
      PurchSetup@1002 : Record 312;
      Vendor@1001 : Record 23;
      NoSeriesMgt@1000 : Codeunit 396;
      VendorNo@1004 : Code[20];
    BEGIN
      IF NOT CONFIRM(Text008,TRUE) THEN
        EXIT;

      PurchSetup.GET;
      PurchSetup.TESTFIELD("Vendor Nos.");

      NoSeriesRelationship.SETRANGE(Code,PurchSetup."Vendor Nos.");

      IF NOT NoSeriesRelationship.ISEMPTY THEN
        IF NoSeriesMgt.SelectSeries(PurchSetup."Vendor Nos.",Vendor."No. Series",Vendor."No. Series") THEN
          NoSeriesMgt.SetSeries(Vendor."No.")
        ELSE
          EXIT;

      Vendor.INSERT(TRUE);
      VendorNo := Vendor."No.";

      COMMIT;

      PAGE.RUNMODAL(PAGE::"Vendor Card",Vendor);

      IF Vendor.GET(VendorNo) THEN BEGIN
        SetManual(TRUE);
        SetSourceID(Vendor."No.");
      END;
    END;

    PROCEDURE SetAndCreateNewCustomer@5();
    VAR
      NoSeriesRelationship@1007 : Record 310;
      SalesSetup@1006 : Record 311;
      Customer@1005 : Record 18;
      NoSeriesMgt@1004 : Codeunit 396;
      CustomerNo@1000 : Code[20];
    BEGIN
      IF NOT CONFIRM(Text009,TRUE) THEN
        EXIT;

      SalesSetup.GET;
      SalesSetup.TESTFIELD("Customer Nos.");

      NoSeriesRelationship.SETRANGE(Code,SalesSetup."Customer Nos.");

      IF NOT NoSeriesRelationship.ISEMPTY THEN
        IF NoSeriesMgt.SelectSeries(SalesSetup."Customer Nos.",Customer."No. Series",Customer."No. Series") THEN
          NoSeriesMgt.SetSeries(Customer."No.")
        ELSE
          EXIT;

      Customer.INSERT(TRUE);
      CustomerNo := Customer."No.";

      COMMIT;

      PAGE.RUNMODAL(PAGE::"Customer Card",Customer);

      IF Customer.GET(CustomerNo) THEN BEGIN
        SetManual(TRUE);
        SetSourceID(Customer."No.");
      END;
    END;

    PROCEDURE SetSourceID@1160040002(KeyValues@1160040000 : Text[250]);
    VAR
      DocCat@1160040001 : Record 6085575;
      RecIDMgt@1160040002 : Codeunit 6085604;
      SourceID@1160040003 : Integer;
    BEGIN
      IF DELCHR(KeyValues,'=',' ') = '' THEN
        KeyValues := '';

      DocCat.GET("Document Category Code");
      IF IsManual THEN BEGIN
        SourceID := RecIDMgt.SetKeyValueWithGUID(DocCat."Source Table No.",DocCat."Source Field No.",DocCat."Source Search Field No.",
          DocCat."Document Category GUID",KeyValues,TRUE);
        COMMIT;

        VALIDATE("Source Record ID Tree ID",SourceID);
      END ELSE
        VALIDATE("Source Record ID Tree ID",
          RecIDMgt.SetKeyValueWithGUID(DocCat."Source Table No.",DocCat."Source Field No.",0,
            DocCat."Document Category GUID",KeyValues,FALSE));

      MODIFY;
    END;

    PROCEDURE GetSourceID@1160040001() : Text[250];
    VAR
      DocCat@1160040001 : Record 6085575;
      RecIDMgt@1160040000 : Codeunit 6085604;
    BEGIN
      IF DocCat.GET("Document Category Code") THEN
        EXIT(RecIDMgt.GetKeyValue("Source Record ID Tree ID",DocCat."Source Field No."));
    END;

    PROCEDURE SetManual@161024016(NewIsManual@161024012 : Boolean);
    BEGIN
      IsManual := NewIsManual;
    END;

    PROCEDURE GetDCSetup@1160040005();
    BEGIN
      //**4PS.sn
      IF SupplyingCompany <> '' THEN
        DCSetup.CHANGECOMPANY(SupplyingCompany);
      //**4PS.en
      IF NOT GotDCSetup THEN
        GotDCSetup := DCSetup.GET;
    END;

    PROCEDURE SetDCSetup@1160040006(VAR NewDCSetup@1160040000 : Record 6085573);
    BEGIN
      DCSetup := NewDCSetup;
      GotDCSetup := TRUE;
      DocumentFileInterface.SetDCSetup(NewDCSetup);
    END;

    PROCEDURE SetCurrentCompany@21(NewCompanyName@1000 : Text[50]);
    BEGIN
      CHANGECOMPANY(NewCompanyName);
      DocumentFileInterface.SetCurrentCompany(NewCompanyName);
    END;

    PROCEDURE UpdateStatusText@1160040008();
    VAR
      DocCat@1160040000 : Record 6085575;
    BEGIN
      IF DocCat.GET("Document Category Code") THEN
        IF DocCat."Codeunit ID: Get Doc. Status" <> 0 THEN
          CODEUNIT.RUN(DocCat."Codeunit ID: Get Doc. Status",Rec);
    END;

    PROCEDURE GetSourceTableNo@1160040010() : Integer;
    VAR
      DocCat@1160040000 : Record 6085575;
    BEGIN
      IF "Document Category Code" = '' THEN
        EXIT;

      DocCat.GET("Document Category Code");
      EXIT(DocCat."Source Table No.");
    END;

    PROCEDURE FindTemplateInCompanies@1160040011(VAR FromCompany@1160040001 : Text[30];VAR FromTemplate@1160040006 : Record 6085579;SourceName@1160040000 : Text[250]) : Boolean;
    VAR
      Comp@1160040002 : Record 2000000006;
      DocCat@1160040004 : Record 6085575;
      RecIDMgt@1160040003 : Codeunit 6085604;
    BEGIN
      Comp.SETFILTER(Name,'<>%1',COMPANYNAME);
      IF Comp.FINDSET THEN
        REPEAT
          IF DocCat.CHANGECOMPANY(Comp.Name) THEN BEGIN
            IF DocCat.READPERMISSION THEN BEGIN
              IF DocCat.GET("Document Category Code") THEN BEGIN
                FromTemplate.CHANGECOMPANY(Comp.Name);
                IF FromTemplate.READPERMISSION THEN BEGIN
                  FromTemplate.SETRANGE("Category Code","Document Category Code");
                  FromTemplate.SETFILTER("Source Record ID Tree ID",'>%1',0);
                  FromTemplate.SETRANGE(Type,FromTemplate.Type::" ");
                  FromTemplate.SETRANGE(Default,TRUE);
                  IF FromTemplate.FINDSET THEN;
                    REPEAT
                      IF SourceName = RecIDMgt.GetFieldValueInCompany(Comp.Name,FromTemplate."Source Record ID Tree ID",
                        DocCat."Source Field No. (Name)")
                      THEN BEGIN
                        FromCompany := Comp.Name;
                        EXIT(TRUE);
                      END;
                    UNTIL FromTemplate.NEXT = 0;

                  FromTemplate.SETRANGE(Default,FALSE);
                  IF FromTemplate.FINDSET THEN
                    REPEAT
                      IF SourceName = RecIDMgt.GetFieldValueInCompany(Comp.Name,FromTemplate."Source Record ID Tree ID",
                        DocCat."Source Field No. (Name)")
                      THEN BEGIN
                        FromCompany := Comp.Name;
                        EXIT(TRUE);
                      END;
                    UNTIL FromTemplate.NEXT = 0;
                END;
              END;
            END;
          END;
        UNTIL Comp.NEXT = 0;
    END;

    LOCAL PROCEDURE GetSubType@2() SubType : Integer;
    VAR
      DocCat@1001 : Record 6085575;
      RecIDMgt@1000 : Codeunit 6085604;
      TempKeyField@1160040000 : TEMPORARY Record 2000000041;
    BEGIN
      IF NOT DocCat.GET("Document Category Code") THEN
        EXIT(0);

      RecIDMgt.GetKeyFields(DocCat."Source Table No.",TempKeyField);
      TempKeyField.SETRANGE(Type,TempKeyField.Type::Option);
      IF TempKeyField.FINDFIRST THEN
        IF EVALUATE(SubType,RecIDMgt.GetKeyValue("Source Record ID Tree ID",TempKeyField."No.")) THEN;
    END;

    PROCEDURE SuspendDeleteCheck@1160040014(Suspend@1160040000 : Boolean);
    BEGIN
      DeleteCheckSuspended := Suspend;
    END;

    PROCEDURE CheckOkToRegister@6085574();
    BEGIN
      IF NOT OK THEN
        ERROR(NotOkErr);
    END;

    PROCEDURE SetSupplyingCompany@1100528400(SupplyingCompany2@1100528400 : Text[30]);
    BEGIN
      //**4PS
      SupplyingCompany := SupplyingCompany2;
    END;

    PROCEDURE GetPDFileName@1100529500() : Text[1024];
    VAR
      FileSysMgt@1160040000 : Codeunit 6085584;
    BEGIN
      //**4PS
      IF "No."= '' THEN
        EXIT('');

      EXIT(FileSysMgt.GetClientFilename(GetPdfServerFileName,FALSE));
    END;

    LOCAL PROCEDURE GetPdfServerFileName@9() FullFilename : Text[1024];
    VAR
      FileSysMgt@1100529500 : Codeunit 6085584;
      FileInfo@1100529501 : Codeunit 6085666;
    BEGIN
      //**4PS
      GetDCSetup;
      DCSetup.TESTFIELD("Archive File Path");
      FullFilename := GetServerFilePath(Rec,Rec."No.",DCSetup."Archive File Path",'pdf');
      FileSysMgt.CreateDirectory(FileInfo.GetFilePath(FullFilename));
    END;

    LOCAL PROCEDURE GetServerFilePath@1100529503(VAR Document@6085575 : Record 6085590;Identifier@6085573 : Text[50];Path@6085576 : Text[200];Extension@6085574 : Text[10]) FullFilename : Text[250];
    BEGIN
      //**4PS
      IF Identifier = '' THEN
        EXIT;

      FullFilename := STRSUBSTNO('%1%2%3.%4',Path,GetDocSubDir(Document),Identifier,Extension);
    END;

    LOCAL PROCEDURE GetDocSubDir@161024017(Document@161024012 : Record 6085590) : Text[1024];
    BEGIN
      //**4PS
      GetContiniaCompanySetup;
      GetDCSetup;

      WITH DCSetup DO
        EXIT(GetSubDir(Document,"Disk File Directory Structure","Company Code in Archive","Category Code in Archive",
          ContiniaCompanySetup."Company Code",Document."Document Category Code"));
    END;

    LOCAL PROCEDURE GetSubDir@161024018(Document@1160040003 : Record 6085590;Structure@161024012 : Integer;CompanyCodeInArchive@1160040000 : Boolean;DocCatCodeInArchive@1000 : Boolean;CompanyCode@1160040002 : Code[10];CategoryCode@1001 : Code[100]) : Text[1024];
    VAR
      Month@161024014 : Code[2];
      Day@161024015 : Code[2];
      Path@1160040001 : Text[1024];
    BEGIN
      //**4PS
      IF Document."Import Month" < 10 THEN
        Month := '0' + FORMAT(Document."Import Month")
      ELSE
        Month := FORMAT(Document."Import Month");

      IF Document."Import Day" < 10 THEN
        Day := '0' + FORMAT(Document."Import Day")
      ELSE
        Day := FORMAT(Document."Import Day");

      IF CompanyCodeInArchive AND (CompanyCode <> '') THEN
        Path := CompanyCode + '\';

      IF DocCatCodeInArchive AND (CategoryCode <> '') THEN
        Path := Path + CategoryCode + '\';

      CASE Structure OF
        DCSetup."Disk File Directory Structure"::"One Directory":
          EXIT(Path);
        DCSetup."Disk File Directory Structure"::"Year\Month":
          EXIT(Path + STRSUBSTNO('%1\%2\',Document."Import Year",Month));
        DCSetup."Disk File Directory Structure"::"Year\Month\Day":
          EXIT(Path + STRSUBSTNO('%1\%2\%3\',Document."Import Year",Month,Day));
      END;
    END;

    LOCAL PROCEDURE GetContiniaCompanySetup@6085575();
    BEGIN
      //**4PS
      IF NOT GotContiniaCompanySetup THEN
        GotContiniaCompanySetup := ContiniaCompanySetup.GET;
    END;

    BEGIN
    {
      META001 14-09-2018 BNJ Continia 4.50-Upgrade. Added function GetPDFFileName
      META001 26-09-2018 BNJ Continia 5.00-Upgrade.
                             1) Modified OnValidate of "Template No."
                             2) Added following functions to support function GetPDFFileName:
                                - GetPdfServerFileName
                                - GetServerFilePath
                                - GetDocSubDir
                                - GetSubDir
                                - GetContiniaCompanySetup
    }
    END.
  }
}

