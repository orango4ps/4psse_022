OBJECT XMLport 11072003 INSBOU Order WS
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=;
    Encoding=UTF-8;
    Format/Evaluate=XML Format/Evaluate;
    OnPreXMLport=BEGIN
                   CompanyInformation.GET;

                   //xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="Order_insbou003.xsd">
                   //xmlns:xs="http://www.w3.org/2001/XMLSchema"
                   //xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   //xsi:noNamespaceSchemaLocation="Order_insbou003.xsd">


                   //NS1 := 'http://www.w3.org/2001/XMLSchema';
                   //NS2 := 'xsi=http://www.w3.org/2001/XMLSchema-instance';
                   //NoNS :='xsi=Order_insbou003.xsd';
                 END;

  }
  ELEMENTS
  {
    { [{EE4630AC-7521-4A7D-B4A6-A22093902363}];  ;Order               ;Element ;Table   ;
                                                  SourceTable=Table38;
                                                  MaxOccurs=Once;
                                                  Export::OnAfterGetRecord=BEGIN
                                                                             Vendor.GET("Purchase Header"."Buy-from Vendor No.");
                                                                             PurchHeadExt.GetPurchHeadExtension("Purchase Header"."Document Type","Purchase Header"."No.");
                                                                             ShippingInstruction := PurchHeadExt."Shipping Instruction";
                                                                           END;
                                                                            }

    { [{B4FEFAC6-B4A9-483D-AA62-13E95B5F4E05}];1 ;OrderType           ;Element ;Text    ;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OrderType := '220';
                                                                               END;
                                                                                }

    { [{195D09D9-45F0-4109-8055-FF025BDE5C1A}];1 ;OrderNumber         ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Header::No.;
                                                  MaxOccurs=Once }

    { [{3A144220-EB0E-4B91-901A-204B0BF03563}];1 ;OrderDate           ;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Purchase Header::Order Date;
                                                  MaxOccurs=Once }

    { [{3ABB9F45-25DE-48E9-9495-41774253D2B8}];1 ;OrderTime           ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{2734755B-8E86-463A-AE12-EEA180437D5C}];1 ;ScenarioTypeCode    ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ScenarioTypeCode := 'X1';
                                                                               END;
                                                                                }

    { [{DA803AAA-7F88-43BA-B073-2730FED581A6}];1 ;DraftOrderIndicator ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DraftOrderIndicator := '';
                                                                                 IF ("Purchase Header"."Document Type" = "Purchase Header"."Document Type"::Quote) THEN
                                                                                   DraftOrderIndicator := '16';
                                                                               END;
                                                                                }

    { [{7578BBE7-DD2A-4B88-8F1F-C4B8D7D40607}];1 ;DeliveryOnDemandIndicator;Element;Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{0E0DB139-242D-4E77-BE67-19246027E77C}];1 ;EndCustomerOrderNumber;Element;Text   ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{972BE3FA-0B1E-4389-AB5C-DEBAD773EFF3}];1 ;ContractReference   ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{DE29434E-69C4-47F0-B297-8B7A02201F5D}];2 ;ContractNumber      ;Element ;Text    ;
                                                  MaxOccurs=Once }

    { [{85FD1026-C3D7-4B82-B796-DC8EF11215FF}];2 ;ContractDate        ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{4D778329-5F81-41B9-95DE-625D8FDDEF83}];1 ;ProjectNumber       ;Element ;Text    ;
                                                  DataType=Code;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Purchase Header"."Job No." <> '' THEN
                                                                                   ProjectNumber := "Purchase Header"."Job No."
                                                                                 ELSE
                                                                                   IF "Purchase Header"."Service Order No." <> '' THEN
                                                                                     ProjectNumber := "Purchase Header"."Service Order No."
                                                                                   ELSE
                                                                                     ProjectNumber := '';
                                                                               END;
                                                                                }

    { [{A2F55B08-1740-4BB7-9633-8A3F5D79F4D8}];1 ;BackhaulingIndicator;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{018A865E-4DA2-4E30-9648-797AC2C0350C}];1 ;TransportInstruction;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{E7215269-AFC6-496E-AEF2-8BDD3658F74D}];2 ;TransportInstructionTypeCode;Element;Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{B5901B11-B282-4B03-9DBA-8F2C819D3F2B}];2 ;DeliveryNoteText    ;Element ;Text    ;
                                                  VariableName=ShippingInstruction;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{6B977CE2-9F02-4151-8F56-ADE4ACC39336}];1 ;FreeText            ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 FreeTextNav@1100525001 : Text[1024];
                                                                                 FreeTextNav2@1100525000 : Text[250];
                                                                                 SalespersonPurchaser@1100525002 : Record 13;
                                                                               BEGIN
                                                                                 FreeTextNav := '';
                                                                                 FreeTextNav2 := '';
                                                                                 "Purchase Header".HandleShipmentInstruction(0, FreeTextNav, FreeTextNav2);
                                                                                 IF (FreeTextNav+FreeTextNav2 <> '') THEN
                                                                                   FreeTextNav += ' ' + FreeTextNav2 + '  ';
                                                                                 IF ("Purchase Header".Expediter <> '') THEN BEGIN
                                                                                   SalespersonPurchaser.GET("Purchase Header".Expediter);
                                                                                   FreeTextNav += "Purchase Header".FIELDCAPTION(Expediter) + ': ' + SalespersonPurchaser.Name;
                                                                                   IF (SalespersonPurchaser."Phone No." <> '') THEN
                                                                                     FreeTextNav += ' (' + SalespersonPurchaser."Phone No." + ')';
                                                                                 END;
                                                                                 IF FreeTextNav <> '' THEN
                                                                                   FreeText := FreeTextNav;
                                                                               END;
                                                                                }

    { [{D4127F58-59A8-4641-B05B-5AFA74EA854B}];1 ;DeliveryDateTimeInformation;Element;Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{F80BC38F-1C90-4388-8FDC-A39728BD12A7}];2 ;RequiredDeliveryDate;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Purchase Header::Expected Receipt Date;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{2E653AE4-F15B-4B1D-9476-6F773A4070F4}];2 ;RequiredDeliveryTime;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Purchase Header"."Expected Receipt Date" <> 0D) THEN
                                                                                   RequiredDeliveryTime := '00:00:00';
                                                                               END;
                                                                                }

    { [{414897CD-B147-411D-B652-6AB5702D19C2}];2 ;DeliveryTimeFrame   ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{2CEAB6DC-1684-4AE5-9116-5EF32E5FC450}];3 ;DeliveryDateEarliest;Element ;Text    ;
                                                  MaxOccurs=Once }

    { [{0CCE5E7C-F9EB-47A7-891E-3C888CE60BF2}];3 ;DeliveryTimeEarliest;Element ;Text    ;
                                                  MaxOccurs=Once }

    { [{7C05F7B5-0D76-486C-87B1-5FB6A90506FC}];3 ;DeliveryDateLatest  ;Element ;Text    ;
                                                  MaxOccurs=Once }

    { [{4C12507A-A130-4692-8525-07B48B02D7C0}];3 ;DeliveryTimeLatest  ;Element ;Text    ;
                                                  MaxOccurs=Once }

    { [{11CDE64F-B133-4CBB-B411-873FA0A1DAE6}];1 ;Buyer               ;Element ;Text    ;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerGLN := SetGLN(CompanyInformation.GLN);
                                                                                 BuyerName := CompanyInformation.Name;
                                                                                 BuyerStreetAndNumber := CompanyInformation.Address;
                                                                                 BuyerCity := CompanyInformation.City;
                                                                                 BuyerPostalCode := CompanyInformation."Post Code";
                                                                                 BuyerCountry := CompanyInformation."Country/Region Code";
                                                                               END;
                                                                                }

    { [{9E7E8BA4-3051-4836-87A7-9DFD934B378B}];2 ;GLN                 ;Element ;Text    ;
                                                  VariableName=BuyerGLN;
                                                  MaxOccurs=Once }

    { [{983CECBB-66C8-4A57-B7E1-4DDB175C9281}];2 ;Name                ;Element ;Text    ;
                                                  VariableName=BuyerName;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{71EB6B6C-F565-41AB-BD71-11B0577CEA55}];2 ;Name2               ;Element ;Text    ;
                                                  VariableName=BuyerName2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{3CCF9DCB-5C2B-4F0C-BADF-1D399D4B2B0D}];2 ;StreetAndNumber     ;Element ;Text    ;
                                                  VariableName=BuyerStreetAndNumber;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{C8F632C9-7D64-4B1B-BD3B-0FA53E694166}];2 ;City                ;Element ;Text    ;
                                                  VariableName=BuyerCity;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{FC118662-4CCB-4ECB-B8C4-2E6D592754F1}];2 ;PostalCode          ;Element ;Text    ;
                                                  VariableName=BuyerPostalCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{A01C0716-CA59-4577-8D60-CFDA6C2AB548}];2 ;Country             ;Element ;Text    ;
                                                  VariableName=BuyerCountry;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{568F8E4E-77A1-4A17-8279-178C151604C4}];2 ;ContactInformation  ;Element ;Text    ;
                                                  VariableName=<ContactInformation>;
                                                  MinOccurs=Zero }

    { [{CEB9B25E-11E6-4E82-B7EC-1A5019F882F7}];3 ;ContactPersonName   ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 SalespersonPurchaser@1100525000 : Record 13;
                                                                               BEGIN
                                                                                 IF (("Purchase Header"."Purchaser Code" <> '') AND
                                                                                     (SalespersonPurchaser.GET("Purchase Header"."Purchaser Code"))) THEN
                                                                                   ContactPersonName := SalespersonPurchaser.Name;
                                                                               END;
                                                                                }

    { [{7D69CEDD-7227-444F-9450-0184878856CF}];3 ;PhoneNumber         ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 SalespersonPurchaser@1100525000 : Record 13;
                                                                               BEGIN
                                                                                 IF (("Purchase Header"."Purchaser Code" <> '') AND
                                                                                     (SalespersonPurchaser.GET("Purchase Header"."Purchaser Code"))) THEN
                                                                                   PhoneNumber := SalespersonPurchaser."Phone No.";
                                                                               END;
                                                                                }

    { [{9F53EF26-5C3B-4976-ADE4-91D39A41039A}];3 ;EmailAddress        ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 SalespersonPurchaser@1100525000 : Record 13;
                                                                               BEGIN
                                                                                 IF (("Purchase Header"."Purchaser Code" <> '') AND
                                                                                     (SalespersonPurchaser.GET("Purchase Header"."Purchaser Code"))) THEN
                                                                                   EmailAddress := SalespersonPurchaser."E-Mail";
                                                                               END;
                                                                                }

    { [{3DA917A7-F333-462D-9525-5F495472F797}];1 ;Supplier            ;Element ;Text    ;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 OrderAddress@1100525000 : Record 224;
                                                                               BEGIN
                                                                                 SupplierGLN := SetGLN(Vendor.GLN);

                                                                                 IF ("Purchase Header"."Order Address Code" <> '') AND
                                                                                     (OrderAddress.GET("Purchase Header"."Buy-from Vendor No.", "Purchase Header"."Order Address Code"))
                                                                                 THEN BEGIN
                                                                                   SupplierName := OrderAddress.Name;
                                                                                   SupplierName2 := OrderAddress."Name 2";
                                                                                   SupplierStreetAndNumber := OrderAddress.Address;
                                                                                   SupplierPostalCode := OrderAddress."Post Code";
                                                                                   SupplierCity := OrderAddress.City;
                                                                                   SupplierCountry := OrderAddress."Country/Region Code";
                                                                                 END ELSE BEGIN
                                                                                   SupplierName := "Purchase Header"."Buy-from Vendor Name";
                                                                                   SupplierName2 := "Purchase Header"."Buy-from Vendor Name 2";
                                                                                   SupplierStreetAndNumber := "Purchase Header"."Buy-from Address";
                                                                                   SupplierPostalCode := "Purchase Header"."Buy-from Post Code";
                                                                                   SupplierCity := "Purchase Header"."Buy-from City";
                                                                                   SupplierCountry := "Purchase Header"."Buy-from Country/Region Code";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{E8B9BE73-A5EB-4DA5-A1FD-5DD2A6331D6E}];2 ;GLN                 ;Element ;Text    ;
                                                  VariableName=SupplierGLN;
                                                  MaxOccurs=Once }

    { [{C53A1377-02F3-4583-AFA4-B4140FA7DB45}];2 ;Name                ;Element ;Text    ;
                                                  VariableName=SupplierName;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{E9AD1E87-4E8D-46BD-9E47-517EFF4CF2FA}];2 ;Name2               ;Element ;Text    ;
                                                  VariableName=SupplierName2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{9C948646-E96B-46B0-8F8E-D0E1FAB55535}];2 ;StreetAndNumber     ;Element ;Text    ;
                                                  VariableName=SupplierStreetAndNumber;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{176CFFD9-C75E-42A3-9BD7-49B6C767B902}];2 ;City                ;Element ;Text    ;
                                                  VariableName=SupplierCity;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{69AB8800-0193-4C0D-A3FC-92333BC81E92}];2 ;PostalCode          ;Element ;Text    ;
                                                  VariableName=SupplierPostalCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{63324301-53F2-4DA0-9103-076DC1B59D35}];2 ;Country             ;Element ;Text    ;
                                                  VariableName=SupplierCountry;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{01A8EC57-273B-442D-A41F-797EF8E64394}];1 ;DeliveryParty       ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{06507625-87EF-47F4-A63B-D70A677F24B7}];2 ;GLN                 ;Element ;Text    ;
                                                  VariableName=DeliveryPartyGLN;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{D4742798-B0CE-4969-BA9B-B143772DF63E}];2 ;Name                ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Header::Ship-to Name;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{90A3AF38-A273-4896-8BCD-8DDCBDBBAFB7}];2 ;Name2               ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Header::Ship-to Name 2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{C1641864-491F-4FB7-9BEC-7295F6A49582}];2 ;StreetAndNumber     ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Header::Ship-to Address;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{9A8C08E6-4415-4D95-A702-5BE487255947}];2 ;City                ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Header::Ship-to City;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{9DEB287C-D1EE-4781-B898-115D0A67400E}];2 ;PostalCode          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Header::Ship-to Post Code;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{EF46D457-EF17-4F7E-A94F-944574A024D8}];2 ;Country             ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Header::Ship-to Country/Region Code;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{0218C1BB-939E-475A-AD77-AB0724DC0FB7}];2 ;LocationDescription ;Element ;Text    ;
                                                  VariableName=VendorLocationCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 VendorDeliveryLocation@1100529900 : Record 11020434;
                                                                               BEGIN
                                                                                 VendorLocationCode := '';
                                                                                 IF VendorDeliveryLocation.GET("Purchase Header"."Buy-from Vendor No.", "Purchase Header"."Location Code") THEN
                                                                                   VendorLocationCode := VendorDeliveryLocation.Description;
                                                                               END;
                                                                                }

    { [{43528038-C9D2-42A0-B83E-C0422B8760A0}];2 ;Contactgegevens     ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{4C9F4FE0-37CB-46F8-BFAC-3DBCD1CF622A}];3 ;ContactPersonName   ;Element ;Text    ;
                                                  VariableName=DeliveryPartyContactPersonName;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{A9F7B858-5464-4A8C-AAD1-729C3BCFA2EA}];3 ;PhoneNumber         ;Element ;Text    ;
                                                  VariableName=DeliveryPartyPhoneNumber;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{6B6BDCAF-9927-43FF-B4F3-187E7BE1D1E0}];1 ;UltimateConsignee   ;Element ;Text    ;
                                                  MaxOccurs=Once }

    { [{EAF4FC1E-1CBC-44C4-8350-8FE93FCB0F39}];2 ;GLN                 ;Element ;Text    ;
                                                  VariableName=UltConsGLN;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{C212638B-04BB-4583-A57E-681C9E43796B}];2 ;Name                ;Element ;Text    ;
                                                  VariableName=UltConsName;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{DCE941E7-EDC3-488E-9773-BAEC989977B7}];2 ;Name2               ;Element ;Text    ;
                                                  VariableName=UltConsName2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{EF743018-895D-420C-ACCF-F924FAA5B563}];2 ;StreetAndNumber     ;Element ;Text    ;
                                                  VariableName=UltConsStreetAndNumber;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{FF100AAA-0235-4F7B-B90B-35D7F028BA98}];2 ;City                ;Element ;Text    ;
                                                  VariableName=UltConsCity;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{9B0EF8B3-2372-4329-8FF2-6F2B4BD541BC}];2 ;PostalCode          ;Element ;Text    ;
                                                  VariableName=UltConsPostalCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{E433D2CA-2E5C-47EE-9E4F-41D71D8F4CA0}];2 ;Country             ;Element ;Text    ;
                                                  VariableName=UltConsCountry;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{77B8D63F-CF8D-41CD-BC0E-9829CFF932EF}];1 ;ShipFrom            ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{204368BA-2E5C-4481-9AF9-CEDA1C0464C6}];2 ;GLN                 ;Element ;Text    ;
                                                  VariableName=ShipFromGLN;
                                                  MaxOccurs=Once }

    { [{FF2453F8-C66F-4C4C-B2CA-87D53221B629}];2 ;Name                ;Element ;Text    ;
                                                  VariableName=ShipFromName;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{2DC93D09-4BFC-48C2-8510-BEB2B32F9E93}];2 ;Name2               ;Element ;Text    ;
                                                  VariableName=ShipFromName2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{3BD31316-7888-4E4A-9AA8-BBE7F81E7876}];2 ;StreetAndNumber     ;Element ;Text    ;
                                                  VariableName=ShipFromStreetAndNumber;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{1FAB058E-047B-419C-B2A2-982DFD6FA6BD}];2 ;City                ;Element ;Text    ;
                                                  VariableName=ShipFromCity;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{F8FD0BB5-CEB2-4D76-9A2A-CAFC7896978B}];2 ;PostalCode          ;Element ;Text    ;
                                                  VariableName=ShipFromPostalCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{AF9080CD-DF2B-432A-B9D8-3B5130974630}];2 ;Country             ;Element ;Text    ;
                                                  VariableName=ShipFromCountry;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{59F18106-6122-4B9E-89C7-E9DF1C1E08B3}];1 ;Invoicee            ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{876F130F-C17B-46B6-9258-7C369DFFD961}];2 ;GLN                 ;Element ;Text    ;
                                                  VariableName=InvoiceeGLN;
                                                  MaxOccurs=Once }

    { [{0123B91C-87AD-41C2-98B4-759AC0DC9D49}];1 ;PurchasingOrganisation;Element;Text   ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{4E9C1D97-B44D-416B-8ACE-109C0769952C}];2 ;GLN                 ;Element ;Text    ;
                                                  VariableName=PurchOrgGLN;
                                                  MaxOccurs=Once }

    { [{A0B6B6BD-0BF6-453D-B6C8-D287CEBFFA3F}];2 ;Name                ;Element ;Text    ;
                                                  VariableName=PurchOrgName;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{9697EC84-6196-4809-865D-38B151DAD5AC}];2 ;Name2               ;Element ;Text    ;
                                                  VariableName=PurchOrgName2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{96841B93-E63D-40A9-9048-9FBD75A56F58}];2 ;StreetAndNumber     ;Element ;Text    ;
                                                  VariableName=PurchOrgStreetAndNumber;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{F61F6F2C-4356-4D08-9E92-C291289CE34A}];2 ;City                ;Element ;Text    ;
                                                  VariableName=PurchOrgCity;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{3FC27EBA-6AA7-45F4-88DB-36C1259D78C3}];2 ;PostalCode          ;Element ;Text    ;
                                                  VariableName=PurchOrgPostalCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{8A9CC4AA-33C7-4307-AA21-9C29211701A3}];2 ;Country             ;Element ;Text    ;
                                                  VariableName=PurchOrgCountry;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{675807D8-BB30-4D9E-A623-BE86D5725385}];1 ;Carrier             ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{DE3E3E78-ACC6-4D9E-B3BC-889D43F2D258}];2 ;GLN                 ;Element ;Text    ;
                                                  VariableName=CarrierGLN;
                                                  MaxOccurs=Once }

    { [{7220F0FD-F9E4-4D82-B573-EE16F966872B}];2 ;Name                ;Element ;Text    ;
                                                  VariableName=CarrierName;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{F27F2C3B-B2ED-4C51-95C2-1B182C4002B7}];2 ;Name2               ;Element ;Text    ;
                                                  VariableName=CarrierName2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{D033957C-25DB-4C48-93AE-249FCE7AC466}];2 ;StreetAndNumber     ;Element ;Text    ;
                                                  VariableName=CarrierStreetAndNumber;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{89CC4DB2-31EB-4EDF-B9A6-CDF1A2E6A791}];2 ;City                ;Element ;Text    ;
                                                  VariableName=CarrierCity;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{622B42E1-DC1F-4A2C-B79A-A3D27B5BAC14}];2 ;PostalCode          ;Element ;Text    ;
                                                  VariableName=CarrierPostalCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{614EFA91-9FBF-4F86-B24D-10F937B2C14C}];2 ;Country             ;Element ;Text    ;
                                                  VariableName=CarrierCountry;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{85F42486-F4E3-4E4D-95EA-891438546076}];1 ;OrderLine           ;Element ;Table   ;
                                                  SourceTable=Table39;
                                                  SourceTableView=SORTING(Field1,Field3,Field4);
                                                  LinkFields=Field3=FIELD(Field3);
                                                  LinkTable=Purchase Header;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         "Purchase Line".SETFILTER("Shortcut Dimension 2 Code", '<>%1', '');
                                                                         "Purchase Line".SETRANGE("Removal Contribution", FALSE);
                                                                         "Purchase Line".SETRANGE("Vendor Charge", FALSE);
                                                                         "Purchase Line".SETRANGE("Exclude From Electronic Order", FALSE);
                                                                       END;
                                                                        }

    { [{EF84BC6B-B185-4EBE-A1A1-BE61D4AE396A}];2 ;LineNumber          ;Element ;Text    ;
                                                  VariableName=LineNumber;
                                                  DataType=Integer;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 LineNumber := FORMAT("Purchase Line"."Line No.");
                                                                               END;
                                                                                }

    { [{DDD53EDB-C4CD-474A-9D5A-6D60D4C7D1EE}];2 ;OrderedQuantity     ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Purchase Line::ICM Quantity;
                                                  MaxOccurs=Once }

    { [{20322521-F54E-4B1E-95D4-E5C4A6D110D1}];2 ;OrderedQuantityMeasureUnitCode;Element;Field;
                                                  DataType=Code;
                                                  SourceField=Purchase Line::ICM Unit;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{F2F78467-991B-48B5-8BB1-ACB8CD326D8A}];2 ;LineIdentitfication ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Purchase Line::Line No.;
                                                  MaxOccurs=Once }

    { [{FCFDAAAF-8146-4BA3-96EF-2439BEAC0B6E}];2 ;TradeItemIdentification;Element;Text  ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{91CF6AFD-B2C6-4C30-801C-8E7078A348F8}];3 ;GTIN                ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 GTIN := TradeItem."GTIN Code (Item)";
                                                                               END;
                                                                                }

    { [{6434BDC6-F0FF-428E-8B1D-D541D6F34F8E}];3 ;SuppliersTradeItemIdentification;Element;Field;
                                                  DataType=Text;
                                                  SourceField=Purchase Line::Vendor Item No.;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{E462BC87-B01E-4D6D-82C4-62A19B35406B}];3 ;AdditionalItemIdentification;Element;Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{95B8CF52-2F10-4C05-ADC8-A878C380B541}];4 ;TradeItemDescription;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Line::Description;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{ED45BB2D-76E5-4888-B079-F5472D2FA42E}];4 ;Colour              ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{02C801AE-66F0-47E7-B10C-AE38649EF7C9}];4 ;Size                ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{38E4C3D1-3D45-4E47-AA25-59C7B6400B80}];4 ;SerialNumber        ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{103C54E2-01C5-4590-82BE-1E1C59F77E36}];4 ;PhysicalDimensions  ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{466C49BD-7C0C-4C15-8A9E-5D9D0EC48EF1}];5 ;Width               ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{A630EDAB-E47F-42AD-BDF1-778E5D3EF605}];5 ;Length              ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{97E1E60F-2394-4B9C-B4CD-097B75F44BD8}];5 ;Height              ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{FC17FA6F-39CF-463C-BC09-BA75C738CB97}];5 ;MeasurementUnitCode ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{9198CB44-C91A-49AA-8F8E-05CE50857F00}];2 ;TradeItemProcessing ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{93B0A5D5-A68C-43FE-AADA-8D913ED90C45}];3 ;ProcessingGTIN      ;Element ;Text    ;
                                                  MaxOccurs=Once }

    { [{C81C13B3-96E3-4702-B253-4F56033C6552}];3 ;ProcessingSequence  ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{38242A24-478A-4775-A6EA-D14AB6902F1D}];3 ;ProcessingDescription;Element;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{23757E07-AB9D-445D-8D9C-F2FA2950788B}];2 ;TransportInstruction;Element ;Text    ;
                                                  VariableName=OrderLineTransportInstruction;
                                                  MinOccurs=Zero }

    { [{E42A3D3F-CBB2-42DF-8681-7D07E37A96BA}];3 ;TransportInstructionTypeCode;Element;Text;
                                                  VariableName=OrderLineTransInstrTypeCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{58853E65-B66E-40CA-B2BC-E51461D832CB}];3 ;DeliveryNoteText    ;Element ;Text    ;
                                                  VariableName=OrderLineDeliveryNoteText>;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{03CAD2C9-262B-4CC3-A62C-51CD48165324}];2 ;FreeText            ;Element ;Text    ;
                                                  VariableName=OrderLineFreeText;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OrderLineFreeText := COPYSTR("Purchase Line".Text, 1, 70)
                                                                               END;
                                                                                }

    { [{6E0C37C0-9833-4AB9-811C-BE0019A79F3E}];2 ;DeliveryDateTimeInformation;Element;Text;
                                                  VariableName=OrderLineDeliveryDateTimeInfo;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{E9BFD6D7-CFF6-47A6-8FFB-6924217D3E43}];3 ;RequiredDeliveryDate;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Purchase Line::Expected Receipt Date;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{16DC99AA-E0B6-456A-AFFF-868504251429}];3 ;RequiredDeliveryTime;Element ;Text    ;
                                                  VariableName=OrderLineRequiredDeliveryTime;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Purchase Line"."Expected Receipt Date" <> 0D) THEN
                                                                                   RequiredDeliveryTime := '00:00:00';
                                                                               END;
                                                                                }

    { [{51B09421-9BF4-4641-8D53-509B430AD401}];3 ;DeliveryTimeFrame   ;Element ;Text    ;
                                                  VariableName=OrderLineDeliveryTimeFrame;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{725F168C-5C43-4E96-90F1-1F9CDB89F6FE}];4 ;DeliveryDateEarliest;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Purchase Line::Expected Receipt Date;
                                                  MaxOccurs=Once }

    { [{4E4A044A-03EE-41BD-976A-B6BF37D71683}];4 ;DeliveryTimeEarliest;Element ;Text    ;
                                                  VariableName=OrderLineDeliveryTimeEarliest;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Purchase Line"."Expected Receipt Date" <> 0D) THEN
                                                                                   OrderLineDeliveryTimeEarliest := '00:00:00';
                                                                               END;
                                                                                }

    { [{4382DCAD-876C-4373-B55E-79E2DEDBF5A0}];4 ;DeliveryDateLatest  ;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Purchase Line::Expected Receipt Date;
                                                  MaxOccurs=Once }

    { [{8DF27C7E-BA6B-406A-A876-06E8AC0758D9}];4 ;DeliveryTimeLatest  ;Element ;Text    ;
                                                  VariableName=OrderLineDeliveryTimeLatest;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Purchase Line"."Expected Receipt Date" <> 0D) THEN
                                                                                   OrderLineDeliveryTimeLatest := '00:00:00';
                                                                               END;
                                                                                }

    { [{25D1CB0E-598C-4E01-8B62-9121662DD1ED}];2 ;DifferentPriceAgreement;Element;Text  ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{F21D5A50-0940-489D-9101-586FC1274B45}];3 ;DifferentPriceAgreementIndicator;Element;Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{417CFB33-BA8B-4E0B-81C9-4F4EA0689E0B}];3 ;DifferentPrice      ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{22F7A6F3-FE2D-4747-8D80-12539E6135F3}];3 ;PriceBase           ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{A8B795DC-9537-4C48-8648-05D7CFCA0759}];4 ;NumberOfUnitsInPriceBasis;Element;Text;
                                                  MaxOccurs=Once }

    { [{12F6023F-84A0-4F6F-BE7F-C18DF6B30E01}];4 ;MeasureUnitPriceBasis;Element;Text    ;
                                                  MaxOccurs=Once }

    { [{8AE78124-982D-41C7-B4EC-B34DDF63E13C}];4 ;PriceBaseDescription;Element ;Text    ;
                                                  MaxOccurs=Once }

    { [{A3166C89-FB56-4299-9195-111565DB4FCC}];2 ;ContractReference   ;Element ;Text    ;
                                                  VariableName=OrderLineContractReference;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{54B8487C-53AC-4A61-B14F-04C59C2B9A49}];3 ;ContractNumber      ;Element ;Text    ;
                                                  VariableName=OrderLineContractNumber;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{BBE85422-8862-4798-BEF4-D3546EBB8F24}];3 ;ContractDate        ;Element ;Text    ;
                                                  VariableName=OrderLineContractDate;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInformation@1100525000 : Record 79;
      Vendor@1100525001 : Record 23;
      TradeItem@1100525005 : Record 11012317;
      PurchHeadExt@1100525002 : Record 11020398;

    LOCAL PROCEDURE GetICMCustomerCode@1100528300(BuyFromVendorNo@1100528302 : Code[20];ProjectCode@1100528301 : Code[20];Deliver@1100528303 : Option;ShipToLocation@1100528304 : Code[20];ShortcutDimension1Code@1100528306 : Code[20]) : Code[20];
    VAR
      ICMCustomerRec@1100528300 : Record 11012129;
      VendorRec@1100528308 : Record 23;
      ICMCustCodeFoundOnProjectLevel@1100528305 : Boolean;
      CustCode@1100528307 : Code[20];
    BEGIN
      //copied from dataport 11012323
      IF (BuyFromVendorNo = '') THEN
        EXIT('');

      ICMCustomerRec.SETRANGE(Vendor, BuyFromVendorNo);
      ICMCustomerRec.SETFILTER(Project, '%1', '');
      ICMCustomerRec.SETFILTER("Global Dimension 1 Code", '%1', '');
      ICMCustomerRec.SETFILTER("ICM Customer No.", '<>%1', '');
      IF ICMCustomerRec.FINDFIRST THEN
        CustCode := ICMCustomerRec."ICM Customer No.";

      ICMCustCodeFoundOnProjectLevel := FALSE;
      IF ProjectCode <> '' THEN BEGIN
        ICMCustomerRec.SETRANGE(Project, ProjectCode);
        IF (Deliver = 2) AND //Deliver::"Project Location"
           (ShipToLocation <> '') THEN BEGIN
          ICMCustomerRec.SETRANGE("Project Location", ShipToLocation);
          IF ICMCustomerRec.FIND('-') THEN BEGIN
            CustCode := ICMCustomerRec."ICM Customer No.";
            ICMCustCodeFoundOnProjectLevel := TRUE;
          END ELSE BEGIN
            ICMCustomerRec.SETFILTER("Project Location", '%1', '');
            IF ICMCustomerRec.FIND('-') THEN BEGIN
              CustCode := ICMCustomerRec."ICM Customer No.";
              ICMCustCodeFoundOnProjectLevel := TRUE;
            END;
          END;
        END ELSE BEGIN
          ICMCustomerRec.SETFILTER("Project Location", '%1', '');
          IF ICMCustomerRec.FINDFIRST THEN BEGIN
            CustCode := ICMCustomerRec."ICM Customer No.";
            ICMCustCodeFoundOnProjectLevel := TRUE;
          END;
        END;
      END;

      IF (NOT ICMCustCodeFoundOnProjectLevel) AND (ShortcutDimension1Code <> '') THEN BEGIN
        ICMCustomerRec.RESET;
        ICMCustomerRec.SETRANGE(Vendor, BuyFromVendorNo);
        ICMCustomerRec.SETFILTER(Project, '%1', '');
        ICMCustomerRec.SETFILTER("Global Dimension 1 Code", ShortcutDimension1Code);
        ICMCustomerRec.SETFILTER("ICM Customer No.", '<>%1', '');
        IF ICMCustomerRec.FINDFIRST THEN
          CustCode := ICMCustomerRec."ICM Customer No.";
      END;

      IF (CustCode = '') THEN BEGIN
        VendorRec.GET(BuyFromVendorNo);
        CustCode := VendorRec."ICM Customer No.";
      END;

      EXIT(CustCode);
    END;

    PROCEDURE SetVars@1100528301(NewDocType@1100528300 : Option;NewNo@1100528301 : Code[20]);
    BEGIN
      "Purchase Header".SETRANGE("Document Type", NewDocType);
      "Purchase Header".SETRANGE("No.", NewNo);
    END;

    LOCAL PROCEDURE SetGLN@1100528302(GLN@1100528300 : Code[20]) : Code[13];
    BEGIN
      WHILE (STRLEN(GLN) < 13) DO
        GLN := '0' + GLN;
      EXIT(GLN);
    END;

    BEGIN
    END.
  }
}

