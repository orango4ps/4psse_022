OBJECT XMLport 11012001 Export Sales Invoices
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Export Sales Invoices;
  }
  ELEMENTS
  {
    { [{70E45D92-1C53-4787-B2CE-9668E2D02A68}];  ;pay:invoice         ;Element ;Text     }

    { [{B356235D-A13A-4720-9E60-6C0DA23FC8BE}];1 ;xmlns:pay           ;Attribute;Text   ;
                                                  VariableName=xmlnspay;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnspay := 'urn:ean.ucc:pay:2';
                                                                               END;
                                                                                }

    { [{CE5D540F-C83C-4CAE-A059-0A38BBA3B898}];1 ;xmlns:eanucc        ;Attribute;Text   ;
                                                  VariableName=xmlnseanucc;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnseanucc := 'urn:ean.ucc:2'
                                                                               END;
                                                                                }

    { [{664ED9DF-1F97-4DC4-B8C2-09763562553A}];1 ;xmlns:px            ;Attribute;Text   ;
                                                  VariableName=xmlnspx;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnspx := 'urn:ean.ucc:pay:vat:2'
                                                                               END;
                                                                                }

    { [{1FBFC8F8-DAD3-418C-A4E1-B105BEC90B90}];1 ;xmlns:xsi           ;Attribute;Text   ;
                                                  VariableName=xmlnsxsi;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnsxsi := 'http://www.w3.org/2001/XMLSchema-instance';
                                                                               END;
                                                                                }

    { [{1382356B-38A7-4BCB-8495-78C3901C6FEF}];1 ;xsi:schemaLocation  ;Attribute;Text   ;
                                                  VariableName=xsischemaLocation;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xsischemaLocation := 'urn:ean:ucc:pay:2 Factuur_bou002.xsd';
                                                                               END;
                                                                                }

    { [{E982FB79-7464-4424-85CE-306909E0F013}];1 ;xmlns:fps           ;Attribute;Text   ;
                                                  VariableName=xmlnsfps;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnsfps := 'www.4ps.nl';
                                                                               END;
                                                                                }

    { [{34071E4A-A238-40CF-B2C5-A881C6A41C0E}];1 ;creationDateTime    ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 creationDateTime := FORMAT(TODAY)+'T'+FORMAT(TIME);
                                                                               END;
                                                                                }

    { [{75CBBF2E-8716-46F3-99FE-57C9B7FB5FC5}];1 ;documentStatus      ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 documentStatus := 'ORIGINAL';
                                                                               END;
                                                                                }

    { [{C1CAA7DA-4F91-4076-AAA3-09E3EE211D67}];1 ;documentStructureVersion;Element;Text  }

    { [{60AA3B73-4E5F-4B8A-966A-48C0EF0D37A7}];2 ;versionIdentification;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 versionIdentification := '002';  //db, 02-10-14: C014150
                                                                               END;
                                                                                }

    { [{9BA4F869-218D-4BD1-898A-1D26979B46D0}];1 ;invoiceIdentification;Element;Table   ;
                                                  VariableName=Sales Invoice Header;
                                                  SourceTable=Table112 }

    { [{19926487-1FCC-46F9-86B1-61C3C2B19EEC}];2 ;uniqueCreatorIdentification;Element;Field;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Header::No. }

    { [{3F030A81-8547-4615-B1A3-C8B27E0512C2}];1 ;fpsReference4PS     ;Element ;Text    ;
                                                  VariableName=Reference;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Reference := "Sales Invoice Header"."Your Reference";
                                                                               END;
                                                                                }

    { [{90D72063-56F7-4FB1-A86D-06F95C7874B0}];1 ;fpsPostingDate4PS   ;Element ;Text    ;
                                                  VariableName=PostingDate;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PostingDate := FORMAT(("Sales Invoice Header"."Posting Date"), 0, 9);
                                                                               END;
                                                                                }

    { [{A0D30D1D-312E-45B2-B426-4D37E3768793}];1 ;invoiceCurrency     ;Element ;Text     }

    { [{76D423B2-A9EE-4658-9488-8D6A498B21DB}];2 ;currencyISOCode     ;Element ;Text    ;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 GLSetup@1100525000 : Record 98;
                                                                               BEGIN
                                                                                 currencyISOCode := "Sales Invoice Header"."Currency Code";
                                                                                 IF "Sales Invoice Header"."Currency Code" = '' THEN BEGIN
                                                                                   GLSetup.GET;
                                                                                   GLSetup.TESTFIELD("LCY Code");
                                                                                   currencyISOCode := GLSetup."LCY Code";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{E1527947-C3CD-44D0-B849-9578FAFBA7DD}];1 ;invoiceType         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 invoiceType := 'INVOICE';
                                                                               END;
                                                                                }

    { [{4122401F-5EA6-49F3-A4A7-2C4249556EE2}];1 ;paymentTerms        ;Element ;Text     }

    { [{F6452FA2-4DCD-4341-BDC0-1840D06A70FC}];2 ;paymentTermsType    ;Attribute;Text   ;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 paymentTermsType := 'DISCOUNT';
                                                                               END;
                                                                                }

    { [{9B5D5F66-23B2-422F-B5C1-F8F539BA03FA}];2 ;paymentTermEvent    ;Attribute;Text   ;
                                                  DataType=DateFormula;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 paymentTermEvent := 'DATE_OF_INVOICE';
                                                                               END;
                                                                                }

    { [{0F4F0974-AA46-4FB0-B8AE-85BE1FE56C1B}];2 ;discountPayment     ;Element ;Text     }

    { [{C46D8844-C300-4F88-B8F3-608A0B691B31}];3 ;discountPercent     ;Element ;Text    ;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 discountPercent :=FORMAT(("Sales Invoice Header"."Payment Discount %"), 0, 9);
                                                                               END;
                                                                                }

    { [{7FA50F0F-8A4E-4FC4-8636-D41745F9F32D}];3 ;paymentTimePeriod   ;Element ;Text     }

    { [{29BE1AB7-94C4-4801-A650-CB605C267419}];4 ;timePeriodDue       ;Element ;Text     }

    { [{8773DAC8-AAC1-40CB-9B22-D9D8FCB03B6D}];5 ;days                ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 days := 'DAYS';
                                                                               END;
                                                                                }

    { [{1B6501B7-6D22-44D4-BC50-5A40CE58620E}];5 ;value               ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Due Date" <> 0D THEN BEGIN
                                                                                   IF "Sales Invoice Header"."Due Date" < "Sales Invoice Header"."Document Date" THEN
                                                                                     value := '0'
                                                                                   ELSE
                                                                                     value := FORMAT(("Sales Invoice Header"."Due Date" - "Sales Invoice Header"."Document Date" + 1), 0, 9);
                                                                                 END ELSE
                                                                                   value := '0';
                                                                               END;
                                                                                }

    { [{F50A8FD2-C449-4648-ABA1-425B5D75B42A}];2 ;creditRestrictionNL ;Element ;Text     }

    { [{B1075872-C39D-4593-8FFD-41A37883EFA2}];3 ;creditRestrictionPercent;Element;Text ;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 creditRestrictionPercent := FORMAT(("Sales Invoice Header"."Credit Restriction %"), 0, 9);
                                                                               END;
                                                                                }

    { [{9750D82F-DD4A-4A62-8912-5EFD9D81C03E}];3 ;creditRestrictionTimePeriod;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CreditRestTimePeriodDue := 'DAYS';
                                                                               END;
                                                                                }

    { [{23AF5B5B-993E-4207-B2DC-6CC71A2D3961}];4 ;timePeriodDue       ;Element ;Text    ;
                                                  VariableName=CreditRestTimePeriodDue }

    { [{14FA1A66-C023-4586-A4CF-A6355C781607}];5 ;value               ;Element ;Text    ;
                                                  VariableName=CreditRestrictionValue;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 CreditRestrictionValue@1100525000 : Text[30];
                                                                               BEGIN
                                                                                 IF "Sales Invoice Header"."Credit Restriction Date" <> 0D THEN BEGIN
                                                                                   IF "Sales Invoice Header"."Credit Restriction Date" < "Sales Invoice Header"."Document Date" THEN
                                                                                     CreditRestrictionValue := '0'
                                                                                   ELSE
                                                                                     CreditRestrictionValue := FORMAT(("Sales Invoice Header"."Credit Restriction Date"  -
                                                                                                                      "Sales Invoice Header"."Document Date" + 1), 0, 9);
                                                                                 END ELSE
                                                                                   CreditRestrictionValue := '0';
                                                                               END;
                                                                                }

    { [{9183798B-D357-470C-A249-E3A64984C2A9}];1 ;invoiceTotals       ;Element ;Text     }

    { [{279D7DE5-A621-4AE5-99BA-662BBB609E28}];2 ;totalInvoiceAmount  ;Element ;Text    ;
                                                  VariableName=totalInvoiceAmount;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 SalesInvoiceLine@1100525002 : Record 113;
                                                                                 AmntTot@1100525001 : Decimal;
                                                                                 VatAmntTot@1100525000 : Decimal;
                                                                               BEGIN
                                                                                 SalesInvoiceLine.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                                 IF SalesInvoiceLine.FINDSET THEN
                                                                                   REPEAT
                                                                                     AmntTot := AmntTot + SalesInvoiceLine.Amount;
                                                                                     VatAmntTot := VatAmntTot + SalesInvoiceLine."Line VAT Amount";
                                                                                   UNTIL SalesInvoiceLine.NEXT = 0;

                                                                                 totalInvoiceAmount := FORMAT((AmntTot + VatAmntTot), 0, 9);
                                                                                 TotLineAmntInclAllowCharge := FORMAT(AmntTot, 0, 9);
                                                                                 totalTaxAmount := FORMAT(VatAmntTot, 0, 9);
                                                                               END;
                                                                                }

    { [{06B94526-644F-411E-9FFA-6FACE5D244FB}];2 ;totalLineAmountInclusiveAllowancesCharges;Element;Text;
                                                  VariableName=TotLineAmntInclAllowCharge;
                                                  DataType=Decimal }

    { [{BC481A7D-10BF-4404-B899-5130040170F6}];2 ;totalTaxAmount      ;Element ;Text    ;
                                                  VariableName=totalTaxAmount;
                                                  DataType=Decimal }

    { [{1BB3A5EC-3CA1-4779-A4CA-61B4DADA6E51}];2 ;basisAmountForDiscountPaymentAndCreditRestrictionNL;Element;Text;
                                                  VariableName=BasAmntForDiscPayAndCrRest;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BasAmntForDiscPayAndCrRest := TotLineAmntInclAllowCharge
                                                                               END;
                                                                                }

    { [{C041E2D5-747B-443B-9F9C-7A317F0617DA}];1 ;seller              ;Element ;Table   ;
                                                  VariableName=Company Information;
                                                  SourceTable=Table79 }

    { [{5B9C8A8E-5D2F-421B-9ED4-FE030A34495A}];2 ;partyIdentification ;Element ;Text    ;
                                                  VariableName=SellerPartyIdentification }

    { [{FFD05709-7028-42B1-8250-D83412CA6528}];3 ;gln                 ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Company Information::GLN }

    { [{ACE69FE6-5D44-47C7-BDC2-EA9F0BD36EC0}];3 ;contactNl           ;Element ;Text     }

    { [{90F8BDDE-FD38-413B-B0AC-061AE13AA5F6}];4 ;communicationChannel;Element ;Text    ;
                                                  VariableName=SellerCommChannel }

    { [{75C38855-9457-4F8F-ACF8-F93E85C1C68D}];5 ;communicationChannelCode;Attribute;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 communicationChannelCode := 'TELEPHONE';
                                                                               END;
                                                                                }

    { [{E58CDDF5-BF40-40CE-8DD4-D5837E8D3857}];5 ;comminicationNumber ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=Company Information::Phone No. Accounts Department }

    { [{23BAE09E-A5F2-44FE-A508-F58B6EE518A2}];4 ;personOrDepartmentName;Element;Text    }

    { [{547F4E40-0CF6-4637-9878-2760FEF7856D}];5 ;description         ;Element ;Text     }

    { [{BBC1A87A-3DB4-4772-BF98-6C77FBCF5764}];6 ;language            ;Element ;Text     }

    { [{D92F4418-C58F-49CC-BAD1-BFF345B9C506}];7 ;languageISOCode     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Company Information::Language ISO Code }

    { [{33FB3A9C-3DC4-4857-8CA9-733C43A24F51}];2 ;nameAndAddress      ;Element ;Text    ;
                                                  VariableName=SellerNameAndAddress }

    { [{2A314864-2123-415F-8C36-3415CA29FF44}];3 ;city                ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Company Information::City }

    { [{8FB4C164-6EB9-4514-9E6E-2FB700FE9008}];3 ;countrycode         ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Company Information::Country/Region Code }

    { [{79334215-113D-4CA7-84E9-2852234B9A3D}];3 ;languageOfTheParty  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Company Information::Language of the Party }

    { [{70D852AF-4A42-433F-8FE1-C3606E302FBB}];3 ;name                ;Element ;Text    ;
                                                  VariableName=SellerName;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerName := COPYSTR("Company Information".Name + "Company Information"."Name 2", 1, 80);
                                                                               END;
                                                                                }

    { [{DAF5A87E-8CA4-48C8-B611-A051068284B4}];3 ;postalCode          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Company Information::Post Code }

    { [{F6CAAA50-A17B-4F85-9D6E-A7D286D58ED1}];3 ;streetAddressOne    ;Element ;Text    ;
                                                  VariableName=SellerStreetAddressOne;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerStreetAddressOne := COPYSTR("Company Information".Address + ' ' + "Company Information"."Address 2", 1, 80);
                                                                               END;
                                                                                }

    { [{6193B4A8-57AD-4857-842B-FD9E21CA22E6}];2 ;companyRegistrationNumber;Element;Field;
                                                  DataType=Text;
                                                  SourceField=Company Information::VAT Registration No. }

    { [{4021326D-F4BB-4CC7-BA95-FBEFBC08681F}];1 ;payer               ;Element ;Table   ;
                                                  VariableName=Customer GLN Relation;
                                                  SourceTable=Table11020562 }

    { [{0E91AB5D-9663-4A14-9C30-B25F3F8FAE03}];2 ;partyIdentification ;Element ;Text    ;
                                                  VariableName=PayerPartyIdentification }

    { [{03779974-F529-413F-9A84-2A5BC93FFF31}];3 ;gln                 ;Element ;Text    ;
                                                  VariableName=PayerGln;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 "Customer GLN Relation".SETFILTER("Customer No.", "Sales Invoice Header"."Bill-to Customer No.");
                                                                                 IF "Customer GLN Relation".FINDFIRST THEN
                                                                                   PayerGln := "Customer GLN Relation"."Receiving Global Location No.";
                                                                               END;
                                                                                }

    { [{1C98C4FF-AE9C-41C2-BF80-C887D8DD5471}];2 ;nameAndAddress      ;Element ;Text    ;
                                                  VariableName=PayerNameAndAddress }

    { [{188FFF27-2EBD-4F76-9A6B-C821026DB665}];3 ;city                ;Element ;Text    ;
                                                  VariableName=PayerCity;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PayerCity := "Sales Invoice Header"."Bill-to City";
                                                                               END;
                                                                                }

    { [{4D7A0F89-76F5-4AE9-8B11-9E083BE3BB0C}];3 ;countrycode         ;Element ;Text    ;
                                                  VariableName=PayerCountryCode;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PayerCountryCode := "Sales Invoice Header"."Bill-to Country/Region Code";
                                                                               END;
                                                                                }

    { [{076F9FB9-A5E4-4A53-B3A0-DB2A711E3A9A}];3 ;languageOfTheParty  ;Element ;Text    ;
                                                  VariableName=PayerLlanguageOfTheParty;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PayerLlanguageOfTheParty := "Sales Invoice Header"."Language Code";
                                                                               END;
                                                                                }

    { [{5226A14E-FA84-4281-8A0A-97D2827B9E13}];3 ;name                ;Element ;Text    ;
                                                  VariableName=PayerName;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 PayerName@1100525000 : Text[80];
                                                                               BEGIN
                                                                                 PayerName := "Sales Invoice Header"."Bill-to Name" + "Sales Invoice Header"."Bill-to Name 2";
                                                                               END;
                                                                                }

    { [{E1E0DFAA-3B1C-4D61-AA30-850B9F08F089}];3 ;postalCode          ;Element ;Text    ;
                                                  VariableName=payerPostalCode;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 payerPostalCode := "Sales Invoice Header"."Bill-to Post Code";
                                                                               END;
                                                                                }

    { [{7F04BB94-6371-4D3B-9C39-36C6005AA517}];3 ;streetAddressOne    ;Element ;Text    ;
                                                  VariableName=PayerStreetAddressOne;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PayerStreetAddressOne := COPYSTR("Sales Invoice Header"."Bill-to Address" + "Sales Invoice Header"."Bill-to Address 2", 1, 80);
                                                                               END;
                                                                                }

    { [{AB976630-3FD7-4B7F-A670-CAF2126BB21C}];1 ;buyer               ;Element ;Text     }

    { [{30A150D3-5E88-4DA6-8364-AB80639F7E7B}];2 ;partyIdentification ;Element ;Text    ;
                                                  VariableName=BuyerPartyIdentification }

    { [{7C5904E2-9205-4904-B202-1B317FAA2244}];3 ;gln                 ;Element ;Text    ;
                                                  VariableName=BuyerGln;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 "Customer GLN Relation".SETFILTER("Customer No.", "Sales Invoice Header"."Sell-to Customer No.");
                                                                                 IF "Customer GLN Relation".FINDFIRST THEN
                                                                                   BuyerGln := "Customer GLN Relation"."Receiving Global Location No.";
                                                                               END;
                                                                                }

    { [{725112C6-7FF2-4C88-AB4A-C54C836BEEA6}];2 ;nameAndAddress      ;Element ;Text    ;
                                                  VariableName=BuyerNameAndAddress }

    { [{F5378EFC-5A36-4448-A481-26F63086A872}];3 ;city                ;Element ;Text    ;
                                                  VariableName=BuyerCity;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerCity := "Sales Invoice Header"."Sell-to City";
                                                                               END;
                                                                                }

    { [{7FAEE24D-9274-4C98-AE1F-5BB534EABD8F}];3 ;countrycode         ;Element ;Text    ;
                                                  VariableName=BuyerCountryCode;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerCountryCode := "Sales Invoice Header"."Sell-to Country/Region Code";
                                                                               END;
                                                                                }

    { [{20856DFE-F17A-4A3E-BA7E-DB2A390A321F}];3 ;languageOfTheParty  ;Element ;Text    ;
                                                  VariableName=BuyerLanguageOfTheParty;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerLanguageOfTheParty := "Sales Invoice Header"."Language Code";
                                                                               END;
                                                                                }

    { [{8C4305F8-2E92-45BF-9B87-468E81669378}];3 ;name                ;Element ;Text    ;
                                                  VariableName=BuyerName;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 BuyerName@1100525000 : Text[80];
                                                                               BEGIN
                                                                                 BuyerName := "Sales Invoice Header"."Sell-to Customer Name" + "Sales Invoice Header"."Sell-to Customer Name 2";
                                                                               END;
                                                                                }

    { [{B8C3A9A9-D611-49BB-B656-B8C93932D9C2}];3 ;postalCode          ;Element ;Text    ;
                                                  VariableName=BuyerPostalCode;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerPostalCode := "Sales Invoice Header"."Sell-to Post Code";
                                                                               END;
                                                                                }

    { [{B843AAE4-C9AC-426F-843D-DA3300CC24D7}];3 ;streetAddressOne    ;Element ;Text    ;
                                                  VariableName=BuyerStreetAddressOne;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerStreetAddressOne := COPYSTR("Sales Invoice Header"."Sell-to Address" + "Sales Invoice Header"."Sell-to Address 2", 1, 80);
                                                                               END;
                                                                                }

    { [{EE404A48-75E0-46F9-95E2-29C2C9838376}];2 ;companyRegistrationNumber;Element;Text;
                                                  VariableName=BuyerCompRegistrationNo;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerCompRegistrationNo := "Sales Invoice Header"."VAT Registration No.";
                                                                               END;
                                                                                }

    { [{CF767BD8-906F-493C-805A-B882A3BE8244}];1 ;shipTo              ;Element ;Text     }

    { [{00B11B46-241C-4FC0-BFA9-BFA688A2CD69}];2 ;gln                 ;Element ;Text    ;
                                                  VariableName=ShipToGln;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ShipToGln@1100525000 : Text[30];
                                                                               BEGIN
                                                                                 "Customer GLN Relation".SETFILTER("Customer No.", "Sales Invoice Header"."Ship-to Contact No.");
                                                                                 IF "Customer GLN Relation".FINDFIRST THEN
                                                                                   ShipToGln := "Customer GLN Relation"."Receiving Global Location No.";
                                                                               END;
                                                                                }

    { [{FB71EBBF-6D4F-492B-9DF4-5CD4238CB88E}];2 ;nameAndAddress      ;Element ;Text    ;
                                                  VariableName=ShipToNameAndAddress }

    { [{0B80ADBC-B218-46A9-BDD9-1144D799703C}];3 ;city                ;Element ;Text    ;
                                                  VariableName=ShipToCity;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ShipToCity := "Sales Invoice Header"."Ship-to City";
                                                                               END;
                                                                                }

    { [{AA71998F-3462-4DF0-A338-68FBEF05F598}];3 ;countrycode         ;Element ;Text    ;
                                                  VariableName=ShipTpCountryCode;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ShipTpCountryCode := "Sales Invoice Header"."Ship-to Country/Region Code"
                                                                               END;
                                                                                }

    { [{543563E2-6664-4F0A-B7E6-08907256D3E0}];3 ;languageOfTheParty  ;Element ;Text    ;
                                                  VariableName=ShipToLangOfTheParty;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ShipToLangOfTheParty := "Sales Invoice Header"."Language Code"
                                                                               END;
                                                                                }

    { [{7613ECBD-79ED-4FF5-8443-5911D94986B2}];3 ;name                ;Element ;Text    ;
                                                  VariableName=ShipToName;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ShipToName@1100525000 : Text[80];
                                                                               BEGIN
                                                                                 ShipToName := "Sales Invoice Header"."Ship-to Name" + "Sales Invoice Header"."Ship-to Name 2";
                                                                               END;
                                                                                }

    { [{CB5E701E-41B3-4290-87B4-6E8A248C5C71}];3 ;postalCode          ;Element ;Text    ;
                                                  VariableName=ShipToPostalCode;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ShipToPostalCode := "Sales Invoice Header"."Ship-to Post Code";
                                                                               END;
                                                                                }

    { [{9262CF3A-820C-4EBC-9D86-15C8DF6A739E}];3 ;streetAddressOne    ;Element ;Text    ;
                                                  VariableName=ShipToStreetAddressOne;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ShipToStreetAddressOne@1100525000 : Text[80];
                                                                               BEGIN
                                                                                 ShipToStreetAddressOne := "Sales Invoice Header"."Ship-to Address" + "Sales Invoice Header"."Ship-to Address 2";
                                                                               END;
                                                                                }

    { [{45E2027F-C19D-45E8-9259-E28F6AA6B595}];1 ;isSupplierChainResposibilityLawNL;Element;Text;
                                                  VariableName=SupplierChainRespLawNL;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Blocked Amount (Subcontracting" <> 0 THEN
                                                                                   SupplierChainRespLawNL := '1';
                                                                               END;
                                                                                }

    { [{1070E1BC-B3ED-4609-B127-1F956D2E35B3}];1 ;depositOnGAccountNL ;Element ;Text    ;
                                                  VariableName=DepositOnGAccountNL;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Blocked Amount (Subcontracting" <> 0 THEN
                                                                                   DepositOnGAccountNL := '1';
                                                                               END;
                                                                                }

    { [{E30D8666-438F-4C92-BF86-63216AA6C5C9}];2 ;accountNumber       ;Element ;Text    ;
                                                  VariableName=ShipToAccountNo;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ShipToAccountNo@1100525000 : Text[30];
                                                                               BEGIN
                                                                                 ShipToAccountNo := "Company Information"."B-Account";
                                                                               END;
                                                                                }

    { [{F9647D9B-DD7B-4593-AD43-E5DC9C6768FF}];2 ;amount              ;Element ;Text    ;
                                                  VariableName=ShipToAmount }

    { [{7E1E3CB4-5CE7-4969-99CE-237337B3059E}];3 ;currencyCode        ;Element ;Text    ;
                                                  VariableName=ShipToCurrencyCode }

    { [{EA294546-2CC1-4A73-BAA8-F4AED24A79EB}];4 ;currencyISOCode     ;Element ;Text    ;
                                                  VariableName=ShipToCurrISOCode;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 GLSetup@1100525001 : Record 98;
                                                                                 ShipToCurrISOCode@1100525000 : Text[30];
                                                                               BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" = '' THEN BEGIN
                                                                                   GLSetup.GET;
                                                                                   GLSetup.TESTFIELD("LCY Code");
                                                                                   ShipToCurrISOCode := GLSetup."LCY Code";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{3BAB83B7-3B91-46DC-A446-86DD180D23BC}];3 ;monetaryAmount      ;Element ;Text    ;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 monetaryAmount := FORMAT(("Sales Invoice Header"."Blocked Amount (Subcontracting"), 0, 9);
                                                                               END;
                                                                                }

    { [{9765A61F-E98B-4786-99D2-2C0D9C4CF34F}];1 ;invoiceLineItem     ;Element ;Table   ;
                                                  VariableName=Sales Invoice Line;
                                                  SourceTable=Table113;
                                                  SourceTableView=SORTING(Field3);
                                                  LinkFields=Field3=FIELD(Field3);
                                                  LinkTable=Sales Invoice Header }

    { [{81FC71D7-90AF-476E-8528-F0B246ECBCE5}];2 ;number              ;Attribute;Text   ;
                                                  VariableName=number;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 LineNum +=1;
                                                                                 number := FORMAT(LineNum, 0, 9);
                                                                               END;
                                                                                }

    { [{DF2DF457-C535-4068-A64D-A7A373D8B2FD}];2 ;projectNumberNL     ;Element ;Text     }

    { [{C6B5C465-41EE-42C6-9BEE-4CC77F564163}];3 ;referenceIdentification;Element;Field ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Job No. }

    { [{B8125365-DED0-4958-9B33-E9BC541FBF4F}];3 ;fpsElement4PS       ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Element }

    { [{67241FE3-DD60-46C8-8DCF-A806815C655D}];2 ;tradeItemIdentification;Element;Text   }

    { [{83B44F96-E2E0-40F6-81F4-A3B1FE279A17}];3 ;gtin                ;Element ;Text    ;
                                                  VariableName=Gtin;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Gtin := '00000000000000';
                                                                               END;
                                                                                }

    { [{B670F623-3582-4963-AE51-E39F535814FA}];3 ;additionalTradeItemIdentification;Element;Text;
                                                  VariableName=AddTradeItemIdent }

    { [{D17E2B8D-7E22-47F9-8C15-0A7752BA584C}];4 ;additionalTradeItemIdentificationValue;Element;Field;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Trade Item }

    { [{6014C798-09B9-4780-89FB-6228FB9C4781}];4 ;additionalTradeItemIdentificationType;Element;Text;
                                                  VariableName=AddTradeItemIdenType;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AddTradeItemIdenType := 'SUPPLIER_ASSIGNED';
                                                                               END;
                                                                                }

    { [{5D49F25A-6ACD-428E-91A9-1D6BFC23D4CC}];2 ;invoicedQuantity    ;Element ;Text     }

    { [{D759D08B-0907-48CC-A2B6-2972C802100F}];3 ;value               ;Element ;Text    ;
                                                  VariableName=InvoicedQuantityValue;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoicedQuantityValue := FORMAT("Sales Invoice Line".Quantity, 0, 9);
                                                                               END;
                                                                                }

    { [{55C4593F-0A87-48AB-9C9C-6AA1E633035B}];2 ;deliveredQuantityNL ;Element ;Text     }

    { [{2DB77A78-F5AE-4997-93FC-177A19500295}];3 ;value               ;Element ;Text    ;
                                                  VariableName=DeliveredQuantityValue;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveredQuantityValue := FORMAT("Sales Invoice Line".Quantity, 0, 9);
                                                                               END;
                                                                                }

    { [{751BC362-60D4-4421-841D-5878376547B1}];2 ;transferOfOwnershipDate;Element;Field ;
                                                  DataType=Date;
                                                  SourceField=Sales Invoice Line::Posting Date }

    { [{FC20EC78-7D7C-409D-B31B-E0CAA299E346}];2 ;amountInclusiveAllowancesCharges;Element;Text;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 amountInclusiveAllowancesCharges := FORMAT("Sales Invoice Line"."Line Amount", 0, 9);
                                                                               END;
                                                                                }

    { [{485DFC06-F334-4D8B-9117-257F6F2AE1F4}];2 ;fpsItemNo4PS        ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Item No. }

    { [{2FBEB08D-2828-487E-9401-62CEEB1A7E3D}];2 ;itemDescription     ;Element ;Text     }

    { [{770DC859-19BF-4F12-B259-1D1EC1E428E0}];3 ;language            ;Element ;Text    ;
                                                  VariableName=SalesLineLanguage;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvLanguageISOCode := "Sales Invoice Header"."Language Code";
                                                                               END;
                                                                                }

    { [{A49FD02E-A532-4FDD-9F73-2C1B2D8E0167}];4 ;languageISOCode     ;Element ;Text    ;
                                                  VariableName=InvLanguageISOCode;
                                                  DataType=Code }

    { [{C7B91691-9AF4-4CF6-8E43-EE987D0DBF01}];3 ;text                ;Element ;Text    ;
                                                  VariableName=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Text := COPYSTR("Sales Invoice Line".Description + "Sales Invoice Line"."Description 2", 1, 70);
                                                                               END;
                                                                                }

    { [{43F4475C-D7AE-4BF5-83EB-3EDE9EF514C4}];2 ;itemPriceInclusiveAllowancesCharges;Element;Text;
                                                  VariableName=ItemPriceInclAllowCharges;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ItemPriceInclAllowCharges@1100525000 : Decimal;
                                                                               BEGIN
                                                                                 IF "Sales Invoice Line".Quantity = 0 THEN
                                                                                   ItemPriceInclAllowCharges := "Sales Invoice Line".Amount
                                                                                 ELSE
                                                                                   ItemPriceInclAllowCharges := "Sales Invoice Line".Amount / "Sales Invoice Line".Quantity;
                                                                               END;
                                                                                }

    { [{197F54D1-C34A-4A28-BC70-55ECDC644285}];2 ;invoiceLineAllowanceCharge;Element;Text }

    { [{677FD0B8-CBE2-4950-83B6-A88D181BC2DC}];3 ;invoiceAllowanceChargePercentageNL;Element;Field;
                                                  DataType=Decimal;
                                                  SourceField=Sales Invoice Line::Line Discount % }

    { [{72528C59-118D-44B8-92B2-470FC5DF8554}];3 ;invoiceAllowanceChargeAmount;Element;Field;
                                                  DataType=Decimal;
                                                  SourceField=Sales Invoice Line::Line Discount Amount }

    { [{49C8B2FF-5633-4F38-B0AC-4981996C38E6}];3 ;invoiceAllowanceOrChargeType;Element;Text;
                                                  VariableName=InvAllowOrChargeType;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 InvAllowOrChargeType@1100525000 : Text[10];
                                                                               BEGIN
                                                                                 IF "Sales Invoice Line"."Line Discount Amount" < 0 THEN
                                                                                   InvAllowOrChargeType := 'CHARGE'
                                                                                 ELSE
                                                                                   InvAllowOrChargeType := 'ALLOWANCE';
                                                                               END;
                                                                                }

    { [{D978354F-3665-4230-93A7-D3BFC5D03494}];2 ;invoiceLineTaxInformation;Element;Text }

    { [{46D6D835-E6F2-4582-85F4-9613EA8AFC64}];3 ;vATInformationNL    ;Element ;Text     }

    { [{04493133-A6A6-41BF-AB27-1748245053F6}];4 ;rate                ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Sales Invoice Line::VAT % }

    { [{9EA29992-555B-4840-9E9C-D937B856EFA7}];4 ;vATCategory         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 vATCategory := 'STANDARD_RATE';
                                                                               END;
                                                                                }

    { [{05560245-D9D4-4D01-915F-883205CF3145}];2 ;fpsvatBusPostGroup4PS;Element;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::VAT Bus. Posting Group }

    { [{CC95F6ED-DD26-43FD-9DD9-CBBE35AB0FC0}];2 ;fpsvatProdPostGroup4PS;Element;Field  ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::VAT Prod. Posting Group }

    { [{C4AA8C52-85DF-4C04-BD46-01E4C7C91287}];2 ;itemPriceBaseQuantity;Element;Text     }

    { [{ED40E7DE-3ACA-45F7-85C3-C70CF683C5F3}];3 ;value               ;Element ;Text    ;
                                                  VariableName=ItemPriceBaseQuantityValue;
                                                  DataType=Decimal;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ItemPriceBaseQuantityValue := FORMAT("Sales Invoice Line"."Quantity (Base)", 0, 9);
                                                                               END;
                                                                                }

    { [{41E88147-A32D-4093-B702-CE8DDF585CE8}];2 ;fpsDepartment4PS    ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Shortcut Dimension 1 Code }

    { [{B157E667-1789-41FE-8F34-3456EF3790EC}];2 ;fpsCostObject4PS    ;Element ;Text    ;
                                                  VariableName=CostObject4PS;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CostObject4PS := "Sales Invoice Line"."Shortcut Dimension 2 Code";
                                                                               END;
                                                                                }

    { [{07F47175-B1C8-48CC-BB43-89BEC9DC2970}];2 ;fpsServiceOrder4PS  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Service Order No. }

    { [{36E3212C-1908-49A6-9069-BAD7A7743280}];2 ;fpsGLAccount4PS     ;Element ;Text    ;
                                                  VariableName=GLAccount4PS;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 GLAccount4PS := '';
                                                                                 IF "Sales Invoice Line".Type = "Sales Invoice Line".Type::"G/L Account" THEN
                                                                                   IF ("Sales Invoice Line"."Service Order No." = '') AND ("Sales Invoice Line"."Job No." = '') THEN
                                                                                     GLAccount4PS := "Sales Invoice Line"."No.";;
                                                                               END;
                                                                                }

    { [{42808464-16E0-45D7-87D7-7130B8D96CB3}];2 ;fpsVendorTradeItem4PS;Element;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Vendor (Trade Item) }

    { [{43547B7A-101C-4D30-80F2-42151461E58E}];2 ;fpsTradeItem4PS     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Trade Item }

    { [{BF48C261-30ED-497D-A98F-0D7DD6EDA03F}];2 ;fpsBasicItem4PS     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Basic Item }

    { [{21C546AF-F722-40B0-AE73-29C421F25974}];2 ;fpsManufacturer4PS  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Manufacturer }

    { [{ED1FAD7B-FA51-46E1-BB44-6BCB4E3BE3D1}];2 ;fpsnoDispatchRequired4PS;Element;Text ;
                                                  VariableName=NoDispatchRequired;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 RequiredDispatch@1100525000 : Boolean;
                                                                               BEGIN
                                                                                 RequiredDispatch := TRUE;
                                                                                 NoDispatchRequired := FORMAT(RequiredDispatch, 0, 9);
                                                                               END;
                                                                                }

    { [{A65F1F30-F302-4D96-910A-434BCABE6249}];2 ;fpsUnitOfMeasureCode4PS;Element;Field ;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Unit of Measure Code }

    { [{1E33C54E-39F8-4114-96B4-832154BE4695}];2 ;fpsCostObjectCostPlusLine4PS;Element;Field;
                                                  DataType=Code;
                                                  SourceField=Sales Invoice Line::Cost Object Cost Plus Line }

    { [{DEB2C56C-BD35-479E-ACB5-AA43D57E793E}];1 ;fpsAttachment4PS    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 fpsAttachment4PS := GetPDFBase64String; //C036222.n
                                                                               END;
                                                                                }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      LineNum@1100525000 : Integer;

    LOCAL PROCEDURE GetPDFBase64String@1100525000() : Text;
    VAR
      SalesInvoiceHeader@1100525000 : Record 112;
      DocumentManagementWebservice@1100525001 : Codeunit 11012405;
      base64EncodedContents@1100525002 : Text;
      ErrorMessage@1100525003 : Text;
      ReportSelections@1100525009 : Record 77;
      TempReportSelection@1100525007 : TEMPORARY Record 77;
      TempEmailAttachment@1100525006 : TEMPORARY Record 11229294;
      DocPrint@1100525005 : Codeunit 229;
    BEGIN
      //C036222.n
      SalesInvoiceHeader.GET("Sales Invoice Header"."No.");
      SalesInvoiceHeader.SETRECFILTER;
      ReportSelections.SETRANGE(Usage,ReportSelections.Usage::"S.Invoice");
      DocPrint.GetReportSelectionForPrintUsage(2, SalesInvoiceHeader."Bill-to Customer No.", FALSE, TempReportSelection);
      TempReportSelection.FIND('-');
      CreatePDF(TempReportSelection."Report ID",TempEmailAttachment,SalesInvoiceHeader);
      DocumentManagementWebservice.GetFileAsBase64(TempEmailAttachment."Attachment Server File Path",base64EncodedContents,ErrorMessage);
      IF ErrorMessage <> '' THEN
        EXIT
      ELSE
        EXIT(base64EncodedContents);
    END;

    LOCAL PROCEDURE CreatePDF@1100528501(ReportID@1100528501 : Integer;VAR TempEmailAttachment@1100528505 : TEMPORARY Record 11229294;VAR SalesInvoiceHeader@1100528500 : Record 112);
    VAR
      DocumentPrint@1100528508 : Codeunit 229;
      PDFFileManagement@1100529600 : Codeunit 11020228;
      MailTemplateNo@1100528300 : Integer;
    BEGIN
      //C036222.n
      MailTemplateNo := 1;
      DocumentPrint.SaveAnyRecordReportAsPdf(SalesInvoiceHeader, MailTemplateNo, SalesInvoiceHeader."Shortcut Dimension 1 Code",
        ReportID, TRUE, FALSE, SalesInvoiceHeader."No.", SalesInvoiceHeader.TABLECAPTION, TempEmailAttachment);
      IF SalesInvoiceHeader."Combine E-Mail Attachments" THEN BEGIN
        SalesInvoiceHeader.AddRelatedDocuments(TempEmailAttachment, SalesInvoiceHeader, SalesInvoiceHeader."Combine E-Mail Attachments", TRUE);
        PDFFileManagement.MergePDFEmailAttachmentsOnServer(TempEmailAttachment);
      END;
    END;

    BEGIN
    {
      db, 18-09-14: rename additional fields (fps:xx), due to problem with import by codeunit 11072076 (reserved for SiB)
    }
    END.
  }
}

