OBJECT Page 5098 Task Card
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Card;
               NOR=Oppgavekort;
               SVE=Uppgiftskort];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5080;
    PageType=Card;
    OnInit=VAR
             PermissionManager@1000 : Codeunit 9002;
           BEGIN
             CalcDueDateFromEnable := TRUE;
             RecurringDateIntervalEnable := TRUE;
             CompletedByEnable := TRUE;
             AttendeesAcceptedNoEnable := TRUE;
             NoOfAttendeesEnable := TRUE;
             CreateTodoEnable := TRUE; //**4PS.n
             AllDayEventEnable := TRUE;
             LocationEnable := TRUE;
             DurationEnable := TRUE;
             EndingTimeEnable := TRUE;
             StartTimeEnable := TRUE;
             CompletedByEditable := TRUE;
             CalcDueDateFromEditable := TRUE;
             RecurringDateIntervalEditable := TRUE;
             ContactNoEditable := TRUE;
             IsSoftwareAsAService := PermissionManager.SoftwareAsAService;
           END;

    OnOpenPage=BEGIN
                 CreateTodoEnable := NOT CreateTodoNotAllowed; //**4PS.n
               END;

    OnAfterGetRecord=VAR
                       RecRef@1100529900 : RecordRef;
                     BEGIN
                       SwitchCardControls;
                       IF "No." <> "Organizer To-do No." THEN
                         CurrPage.EDITABLE := FALSE
                       ELSE
                         CurrPage.EDITABLE := TRUE;
                       SetRecurringEditable;
                       EnableFields;
                       ContactNoOnFormat(FORMAT("Contact No."));

                       //**4PS.sn
                       RecRef.GETTABLE(Rec);
                       CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                       CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                       CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode('');

                       IF "Segment Description" <> '' THEN
                         SegmentDescEditable := FALSE;
                       //**4PS.en
                     END;

    OnModifyRecord=BEGIN
                     IF ("Team Code" = '') AND ("Salesperson Code" = '') THEN
                       ERROR(
                         Text000,TABLECAPTION,FIELDCAPTION("Salesperson Code"),FIELDCAPTION("Team Code"));

                     IF (Type = Type::Meeting) AND (NOT "All Day Event") THEN BEGIN
                       IF "Start Time" = 0T THEN
                         ERROR(Text002,TABLECAPTION,Type,FIELDCAPTION("Start Time"));
                       IF Duration = 0 THEN
                         ERROR(Text002,TABLECAPTION,Type,FIELDCAPTION(Duration));
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ta&sk;
                                 NOR=&Oppgave;
                                 SVE=U&ppgift];
                      Image=Task }
      { 33      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mment;
                                 NOR=&Merknad;
                                 SVE=&Kommentar];
                      ToolTipML=[ENU=View or add comments.;
                                 NOR=Vis eller legg til merknader.;
                                 SVE=Visa eller lÑgg till kommentarer.];
                      ApplicationArea=#Comments;
                      RunObject=Page 5072;
                      RunPageLink=Table Name=CONST(To-do),
                                  No.=FIELD(Organizer To-do No.),
                                  Sub No.=CONST(0);
                      Image=ViewComments }
      { 34      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 NOR=S&amhandlingsposter;
                                 SVE=&Interaktionslogg];
                      ToolTipML=[ENU=View interaction log entries for the task.;
                                 NOR=Vis samhandlingsposter for oppgaven.;
                                 SVE=Visa loggtransaktioner fîr uppgiften.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 11072053;
                      RunPageView=SORTING(To-do No.);
                      RunPageLink=To-do No.=FIELD(Organizer To-do No.);
                      Image=InteractionLog }
      { 69      ;2   ;Action    ;
                      CaptionML=[ENU=Postponed &Interactions;
                                 NOR=&Utsatte samhandlinger;
                                 SVE=Senarelagda &interaktioner];
                      ToolTipML=[ENU=View postponed interactions for the task.;
                                 NOR=Vis utsatte samhandlinger for oppgaven.;
                                 SVE=Visa senarelagda interaktioner fîr uppgiften.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5082;
                      RunPageView=SORTING(To-do No.);
                      RunPageLink=To-do No.=FIELD(Organizer To-do No.);
                      Image=PostponedInteractions }
      { 70      ;2   ;Action    ;
                      CaptionML=[ENU=A&ttendee Scheduling;
                                 NOR=&Tidsplanlegging for deltakere;
                                 SVE=Deltagar&planering];
                      ToolTipML=[ENU=View the status of a scheduled meeting.;
                                 NOR=Vis statusen for et planlagt mõte.;
                                 SVE=Vissa status fîr ett schemalagt mîte.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=ProfileCalender;
                      OnAction=BEGIN
                                 IF Type <> Type::Meeting THEN
                                   ERROR(CannotSelectAttendeesErr,FORMAT(Type));

                                 PAGE.RUNMODAL(PAGE::"Attendee Scheduling",Rec);
                               END;
                                }
      { 1210190001;2 ;Action    ;
                      CaptionML=[ENU=&Documents;
                                 SVE=&Dokument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Todo@1100528701 : Record 5080;
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 IF Todo.GET("Organizer To-do No.") THEN BEGIN
                                   RecRef.GETTABLE(Todo);
                                   DocumentFilters.CreateTempFilterAndExecute1(RecRef, '', FALSE, TRUE);
                                 END;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner;
                                 SVE=Fu&nktion];
                      Image=Action }
      { 35      ;2   ;Action    ;
                      CaptionML=[ENU=Assign Activities;
                                 NOR=Tilordne aktiviteter;
                                 SVE=Tilldela aktiviteter];
                      ToolTipML=[ENU=View all the tasks that have been assigned to salespeople and teams. A task can be organizing meetings, making phone calls, and so on.;
                                 NOR=Vis alle oppgavene som er knyttet til selgere og prosjektgrupper. En oppgave kan for eksempel vëre Ü arrangere mõter, foreta telefonsamtaler og sÜ videre.;
                                 SVE=Visa alla uppgifter som har tilldelats sÑljare och team. En uppgift kan vara att anordna mîten, ringa telefonsamtal o.s.v.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Allocate;
                      OnAction=VAR
                                 TempTask@1001 : TEMPORARY Record 5080;
                                 Todo@1100528000 : Record 5080;
                               BEGIN
                                 //**4PS.sn
                                 Todo.COPY(Rec);
                                 IF ContactNoWizard <> '' THEN
                                   Todo.SETRANGE("Contact No.", ContactNoWizard);
                                 IF ContactCompanyNoWizard <> '' THEN
                                   Todo.SETRANGE("Contact Company No.", ContactCompanyNoWizard);
                                 TempTask.AssignActivityFromTask(Todo);
                                 //**4PS.en
                                 //TempTask.AssignActivityFromTask(Rec) //**4PS.o
                               END;
                                }
      { 1100528707;2 ;Action    ;
                      CaptionML=[ENU=Create &Interaction;
                                 SVE=Skapa &interaktion];
                      Image=CreateInteraction;
                      OnAction=BEGIN
                                 //**4PS
                                 CreateInteraction;
                               END;
                                }
      { 36      ;2   ;Action    ;
                      Name=MakePhoneCall;
                      CaptionML=[ENU=Make &Phone Call;
                                 NOR=SlÜ &nummeret;
                                 SVE=&Ring upp];
                      ToolTipML=[ENU=Call the selected contact.;
                                 NOR=Ring den valgte kontakten.;
                                 SVE=Ring upp den markerade kontakten.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Calls;
                      OnAction=VAR
                                 TempSegmentLine@1001 : TEMPORARY Record 11072040;
                                 Contact@1100528701 : Record 5050;
                                 SalespersonPurchaser@1100528702 : Record 13;
                                 Campaign@1100528703 : Record 11072034;
                               BEGIN
                                 //**4PS.so
                                 //IF "Contact No." = '' THEN BEGIN
                                 //  IF (Type = Type::Meeting) AND ("Team Code" = '') THEN
                                 //    ERROR(MakePhoneCallIsNotAvailableErr);
                                 //  ERROR(MustAssignContactErr);
                                 //END;
                                 //TempSegmentLine."To-do No." := "No.";
                                 //TempSegmentLine."Contact No." := "Contact No.";
                                 //TempSegmentLine."Contact Company No." := "Contact Company No.";
                                 //TempSegmentLine."Campaign No." := "Campaign No.";
                                 //TempSegmentLine."Salesperson Code" := "Salesperson Code";
                                 //TempSegmentLine.CreatePhoneCall;
                                 //**4PS.eo
                                 //**4PS.sn
                                 // See also SegLine.CreateInteractionFromToDo
                                 TempSegmentLine."To-do No." := "Organizer To-do No.";
                                 IF Contact.GET("Contact No.") THEN
                                   TempSegmentLine.VALIDATE("Contact No.", Contact."No.")
                                 ELSE BEGIN
                                   IF (Type = Type::Meeting) AND ("Team Code" = '') THEN
                                     ERROR(MakePhoneCallIsNotAvailableErr);
                                   ERROR(MustAssignContactErr);
                                 END;
                                 IF SalespersonPurchaser.GET("Salesperson Code") THEN
                                   TempSegmentLine."Salesperson Code" := SalespersonPurchaser.Code;
                                 IF Campaign.GET("Campaign No.") THEN
                                   TempSegmentLine."Campaign No." := Campaign."No.";
                                 TempSegmentLine.CreatePhoneCall;
                                 //**4PS.en
                               END;
                                }
      { 1100528708;2 ;Action    ;
                      CaptionML=ENU=&Call Centre Form;
                      Image=Calls;
                      OnAction=BEGIN
                                 //**4PS
                                 CreateCallInCallCenterPage;
                               END;
                                }
      { 1100528700;2 ;Action    ;
                      CaptionML=ENU=Copy to &Appointment in Outlook;
                      Visible=NOT IsSoftwareAsAService;
                      Image=ExportContact;
                      OnAction=VAR
                                 MSOutlookInterface@1100528700 : Codeunit 11012751;
                               BEGIN
                                 //**4PS
                                 MSOutlookInterface.ScheduleAppointment(Rec);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100528701;2 ;Action    ;
                      CaptionML=ENU=Copy to &Task in Outlook;
                      Promoted=Yes;
                      Visible=NOT IsSoftwareAsAService;
                      Image=ExportToDo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 MSOutlookInterface@1100528700 : Codeunit 11012751;
                               BEGIN
                                 //**4PS
                                 MSOutlookInterface.ScheduleTask(Rec);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 31      ;1   ;Action    ;
                      Name=CreateTodo;
                      CaptionML=[ENU=&Create To-do;
                                 NOR=&Opprett oppgave;
                                 SVE=&Skapa Uppgift];
                      ToolTipML=[ENU=Create a new task.;
                                 NOR=Opprett en ny oppgave.;
                                 SVE=Skapa en ny uppgift.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Enabled=CreateTodoEnable;
                      PromotedIsBig=Yes;
                      Image=NewToDo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TempTask@1001 : TEMPORARY Record 5080;
                                 Todo@1100528700 : Record 5080;
                               BEGIN
                                 //**4PS.sn
                                 Todo.COPY(Rec);
                                 IF ContactNoWizard <> '' THEN
                                   Todo.SETRANGE("Contact No.", ContactNoWizard);
                                 IF ContactCompanyNoWizard <> '' THEN
                                   Todo.SETRANGE("Contact Company No.", ContactCompanyNoWizard);
                                 TempTask.AssignActivityFromTask(Todo);
                                 //**4PS.en
                                 //TempTask.CreateTaskFromTask(Rec); //**4PS.o
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="No.";
                Importance=Promoted }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the task.;
                           NOR=Angir beskrivelsen av oppgaven.;
                           SVE=Anger en beskrivning av uppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Description;
                Importance=Promoted }

    { 67  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location where the meeting will take place.;
                           NOR=Angir lokasjonen der mõtet skal foregÜ.;
                           SVE=Anger den plats dÑr mîtet kommer att Ñga rum.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Location;
                Visible=NOT IsSoftwareAsAService;
                Enabled=LocationEnable }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the salesperson assigned to the task.;
                           NOR=Angir koden for selgeren som er tilordnet til oppgaven.;
                           SVE=Anger koden fîr sÑljaren som tilldelades uppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 1100525001;2;Field  ;
                DrillDown=No;
                SourceExpr="Name Sales Person";
                Importance=Additional }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of attendees for the meeting. click the field to view the Attendee Scheduling card.;
                           NOR=Angir antall deltakere pÜ mõtet. Klikk feltet for Ü vise kortet Tidsplanlegging for deltaker.;
                           SVE=Anger antalet deltagare fîr mîtet. Klicka i fÑltet fîr att visa kortet Deltagare planering.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="No. of Attendees";
                Importance=Additional;
                Enabled=NoOfAttendeesEnable;
                OnDrillDown=BEGIN
                              MODIFY;
                              COMMIT;
                              PAGE.RUNMODAL(PAGE::"Attendee Scheduling",Rec);
                              GET("No.");
                              CurrPage.UPDATE;
                            END;
                             }

    { 73  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of attendees that have confirmed their participation in the meeting.;
                           NOR=Angir antall deltakere som har bekreftet at de vil delta pÜ mõtet.;
                           SVE=Anger antalet deltagare som har bekrÑftat att de kommer att delta i mîtet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Attendees Accepted No.";
                Importance=Additional;
                Enabled=AttendeesAcceptedNoEnable;
                OnDrillDown=BEGIN
                              MODIFY;
                              COMMIT;
                              PAGE.RUNMODAL(PAGE::"Attendee Scheduling",Rec);
                              GET("No.");
                              CurrPage.UPDATE;
                            END;
                             }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the contact linked to the task.;
                           NOR=Angir nummeret til kontakten som er knyttet til oppgaven.;
                           SVE=Anger numret fîr kontakten som Ñr kopplad till uppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Contact No.";
                Importance=Promoted;
                Editable=ContactNoEditable;
                OnValidate=BEGIN
                             ContactNoOnAfterValidate;
                           END;

                OnLookup=VAR
                           Task@1005 : Record 5080;
                           Cont@1003 : Record 5050;
                         BEGIN
                           IF Type = Type::Meeting THEN BEGIN
                             Task.SETRANGE("No.","No.");
                             PAGE.RUNMODAL(PAGE::"Attendee Scheduling",Task);
                           END ELSE BEGIN
                           //**4PS.sn
                             IF "Try-out No." <> '' THEN
                               PrepareTryoutContactLookup(Cont);
                             IF "Try-out Quote No." <> '' THEN
                               PrepareTryoutQuoteContLookup(Cont);
                           //**4PS.en

                             IF Cont.GET("Contact No.") THEN;
                             IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                               VALIDATE("Contact No.",Cont."No.");
                               CurrPage.UPDATE;
                             END;
                           END;
                         END;
                          }

    { 47  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the contact to which this task has been assigned.;
                           NOR=Angir navnet pÜ kontakten som denne oppgaven er tilordnet til.;
                           SVE=Anger namnet pÜ kontakten som tilldelades den hÑr uppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Contact Name";
                Importance=Additional;
                Editable=FALSE }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the company for which the contact involved in the task works.;
                           NOR=Angir navnet pÜ selskapet som kontakten som er involvert i oppgaven, jobber for.;
                           SVE=Anger namnet pÜ fîretaget dÑr kontakten som berîrs av uppgiften arbetar.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Contact Company Name";
                Importance=Additional;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the team to which the task is assigned.;
                           NOR=Angir koden for prosjektgruppen som oppgaven er tilordnet til.;
                           SVE=Anger koden fîr teamet som tilldelades uppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Team Code";
                Importance=Additional;
                OnValidate=BEGIN
                             TeamCodeOnAfterValidate;
                           END;
                            }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the salesperson who completed this team task.;
                           NOR=Angir selgeren som fullfõrte denne prosjektgruppeoppgaven.;
                           SVE=Anger vilken sÑljare som avslutade den hÑr teamuppgiften.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Completed By";
                Importance=Additional;
                Enabled=CompletedByEnable;
                Editable=CompletedByEditable;
                OnValidate=BEGIN
                             SwitchCardControls
                           END;
                            }

    { 1100528702;2;Field  ;
                SourceExpr="Responsibility Code" }

    { 1100528704;2;Field  ;
                SourceExpr="Responsible Person" }

    { 1100525004;2;Field  ;
                DrillDown=No;
                SourceExpr="Name Employee";
                Importance=Additional }

    { 1100528743;2;Field  ;
                SourceExpr=Rubric;
                Importance=Additional }

    { 1100528703;2;Field  ;
                SourceExpr="Standard To-do Code";
                Importance=Additional }

    { 1100528705;2;Field  ;
                SourceExpr="Standard To-do Description";
                Importance=Additional }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the task. There are five options: Not Started, In Progress, Completed, Waiting and Postponed.;
                           NOR=Angir statusen for oppgaven. Det er fem alternativer: Ikke startet, I arbeid, Ferdig, Venter og Utsatt.;
                           SVE=Anger uppgiftens status. Det finns fem alternativ: Ej startad, PÜ gÜng Avslutad VÑntar och Uppskjuten.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Status;
                Importance=Promoted }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the priority of the task.;
                           NOR=Angir prioriteten for oppgaven.;
                           SVE=Anger uppgiftens prioritet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Priority }

    { 12  ;2   ;Field     ;
                Name=TypeSaaS;
                CaptionML=[ENU=Type;
                           NOR=Type;
                           SVE=Typ];
                ToolTipML=[ENU=Specifies the type of the task.;
                           NOR=Angir oppgavetypen.;
                           SVE=Anger uppgiftens typ.];
                OptionCaptionML=[ENU=" ,,Phone Call";
                                 NOR=" ,,Telefonsamtale";
                                 SVE=" ,,Telefonsamtal"];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Type;
                Importance=Promoted;
                Visible=IsSoftwareAsAService;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 3   ;2   ;Field     ;
                Name=TypeOnPrem;
                CaptionML=[ENU=Type;
                           NOR=Type;
                           SVE=Typ];
                ToolTipML=[ENU=Specifies the type of the task.;
                           NOR=Angir oppgavetypen.;
                           SVE=Anger uppgiftens typ.];
                OptionCaptionML=[ENU=" ,Meeting,Phone Call";
                                 NOR=" ,Mõte,Telefonsamtale";
                                 SVE=" ,Mîte,Telefonsamtal"];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Type;
                Visible=NOT IsSoftwareAsAService;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 64  ;2   ;Field     ;
                Name=AllDayEvent;
                CaptionML=[ENU=All Day Event;
                           NOR=Hele dagen;
                           SVE=Hela dagen];
                ToolTipML=[ENU=Specifies that the task of the Meeting type is an all-day event, which is an activity that lasts 24 hours or longer.;
                           NOR=Angir at oppgaven av typen Mõte er en heldagshendelse, det vil si en aktivitet som varer 24 timer eller lenger.;
                           SVE=Anger att uppgiften av typen Mîte varar hela dagen, det vill sÑga 24 timmar eller lÑngre.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="All Day Event";
                Importance=Additional;
                Enabled=AllDayEventEnable;
                OnValidate=BEGIN
                             AllDayEventOnAfterValidate;
                           END;
                            }

    { 14  ;2   ;Field     ;
                Name=Date;
                ToolTipML=[ENU=Specifies the date when the task should be started. There are certain rules for how dates should be entered found in How to: Enter Dates and Times.;
                           NOR=Angir datoen da oppgaven skal starte. Det finnes bestemte regler for hvordan datoer skal registreres. Disse finner du under Lëre hvordan du setter inn datoer og klokkeslett.;
                           SVE=Anger datumet dÜ uppgiften startas. Det finns vissa regler fîr hur datum anges i SÜ hÑr anger du datum och tid.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Date }

    { 56  ;2   ;Field     ;
                Name=StartTime;
                ToolTipML=[ENU=Specifies the time when the task of the Meeting type should be started.;
                           NOR=Angir klokkeslettet da oppgaven av typen Mõte skal starte.;
                           SVE=Anger tidpunkten dÜ uppgiften av typen Mîte startas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Start Time";
                Enabled=StartTimeEnable }

    { 58  ;2   ;Field     ;
                Name=Duration;
                ToolTipML=[ENU=Specifies the duration of the task of the Meeting type.;
                           NOR=Angir varigheten for oppgaven av typen Mõte.;
                           SVE=Anger varaktigheten fîr uppgiften av typen Mîte.];
                ApplicationArea=#RelationshipMgmt;
                BlankZero=Yes;
                SourceExpr=Duration;
                Enabled=DurationEnable }

    { 63  ;2   ;Field     ;
                Name=EndingDate;
                CaptionML=[ENU=Ending Date;
                           NOR=Sluttdato;
                           SVE=Slutdatum];
                ToolTipML=[ENU=Specifies the date of when the task should end. There are certain rules for how dates should be entered. For more information, see How to: Enter Dates and Times.;
                           NOR=Angir datoen da oppgaven skal avsluttes. Det finnes bestemte regler for hvordan datoer skal registreres. Se Lëre hvordan du setter inn datoer og klokkeslett for mer informasjon.;
                           SVE=Anger datumet dÜ uppgiften avslutas. Det finns vissa regler fîr hur datum anges. Mer information finns i SÜ hÑr anger du datum och tid.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Ending Date" }

    { 61  ;2   ;Field     ;
                Name=EndingTime;
                CaptionML=[ENU=Ending Time;
                           NOR=Sluttidspunkt;
                           SVE=Sluttid];
                ToolTipML=[ENU=Specifies the time of when the task of the Meeting type should end.;
                           NOR=Angir klokkeslettet da oppgaven av typen Mõte skal avsluttes.;
                           SVE=Anger tidpunkten dÜ uppgiften av typen Mîte avlutas.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Ending Time";
                Enabled=EndingTimeEnable }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the task has been canceled.;
                           NOR=Angir at oppgaven er kansellert.;
                           SVE=Anger att uppgiften har avbrutits.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Canceled;
                OnValidate=BEGIN
                             SwitchCardControls
                           END;
                            }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the task is closed.;
                           NOR=Angir at oppgaven er lukket.;
                           SVE=Anger att uppgiften Ñr avslutad.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Closed;
                OnValidate=BEGIN
                             SwitchCardControls
                           END;
                            }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date the task was closed.;
                           NOR=Angir datoen da oppgaven ble lukket.;
                           SVE=Anger datumet dÜ uppgiften avslutades.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Date Closed" }

    { 1100529603;2;Field  ;
                Lookup=No;
                CaptionML=[ENU=Opportunity;
                           SVE=AffÑrsmîjlighet];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Wizard Opportunity Description";
                TableRelation=Opportunity;
                Editable=FALSE;
                OnAssistEdit=VAR
                               Opp@1102601001 : Record 5092;
                             BEGIN
                               //**4PS
                               IF GETFILTER("Opportunity No.") = '' THEN BEGIN
                                 IF Opp.GET("Opportunity No.") THEN ;
                                 IF PAGE.RUNMODAL(0,Opp) = ACTION::LookupOK THEN BEGIN
                                   VALIDATE("Opportunity No.",Opp."No.");
                                   "Wizard Opportunity Description" := Opp.Description;
                                 END;
                               END;
                             END;
                              }

    { 1100529600;2;Field  ;
                Name=SegmentDesc;
                Lookup=No;
                CaptionML=ENU=Create To-dos for Segment Contacts;
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Segment Description";
                TableRelation="Segment Header";
                Importance=Additional;
                Editable=SegmentDescEditable;
                OnAssistEdit=VAR
                               SegmentHeader@1102601000 : Record 11072039;
                             BEGIN
                               //**4PS
                               IF GETFILTER("Segment No.") = '' THEN BEGIN
                                 IF SegmentHeader.GET("Segment No.") THEN ;
                                 IF PAGE.RUNMODAL(0,SegmentHeader) = ACTION::LookupOK THEN BEGIN
                                   VALIDATE("Segment No.",SegmentHeader."No.");
                                   "Segment Description" := SegmentHeader.Description;
                                 END;
                               END;
                             END;
                              }

    { 1905354401;1;Group  ;
                CaptionML=[ENU=Related Activities;
                           NOR=Relaterte aktiviteter;
                           SVE=Relaterade aktiviteter] }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the campaign to which the task is linked.;
                           NOR=Angir nummeret pÜ kampanjen som oppgaven er knyttet til.;
                           SVE=Anger kampanjnumret som uppgiften Ñr kopplad till.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign No.";
                OnValidate=BEGIN
                             CampaignNoOnAfterValidate;
                           END;
                            }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the campaign to which the task is linked.;
                           NOR=Angir beskrivelsen av kampanjen som oppgaven er knyttet til.;
                           SVE=Anger beskrivningen av kampanjen som uppgiften Ñr kopplad till.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign Description";
                Importance=Promoted;
                Editable=FALSE }

    { 1904441601;1;Group  ;
                CaptionML=[ENU=Recurring;
                           NOR=Gjentakende;
                           SVE=èterkommande] }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the task occurs periodically.;
                           NOR=Angir at oppgaven skjer regelmessig.;
                           SVE=Anger att uppgiften Ñr Üterkommande.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Recurring;
                OnValidate=BEGIN
                             RecurringOnPush;
                           END;
                            }

    { 41  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date formula to assign automatically a recurring task to a salesperson or team.;
                           NOR=Angir datoformelen som brukes til Ü knytte et gjentakende oppgave til en selger eller en prosjektgruppe automatisk.;
                           SVE=FÑltet innehÜller datumformeln som anvÑnds nÑr en Üterkommande uppgift tilldelas en sÑljare eller ett team automatiskt.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Recurring Date Interval";
                Importance=Promoted;
                Enabled=RecurringDateIntervalEnable;
                Editable=RecurringDateIntervalEditable }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date to use to calculate the date on which the next task should be completed.;
                           NOR=Angir datoen som skal brukes til Ü beregne datoen for fullfõring av neste oppgave.;
                           SVE=Anger datumet som anvÑnds fîr att berÑkna datumet dÜ nÑsta uppgift ska vara slutfîrd.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Calc. Due Date From";
                Enabled=CalcDueDateFromEnable;
                Editable=CalcDueDateFromEditable }

    { 1905885001;1;Group  ;
                CaptionML=[ENU=Date;
                           SVE=Datum] }

    { 1100525003;2;Field  ;
                SourceExpr="Modified by" }

    { 1100528709;2;Field  ;
                SourceExpr="Last Date Modified" }

    { 1100528711;2;Field  ;
                SourceExpr="Last Time Modified" }

    { 1100528713;2;Field  ;
                SourceExpr="Planned by";
                Importance=Promoted }

    { 1100528717;2;Field  ;
                SourceExpr="Planned on" }

    { 1100528715;2;Field  ;
                SourceExpr="Planned in Outlook" }

    { 1902156701;1;Group  ;
                CaptionML=[ENU=Links;
                           SVE=LÑnkar] }

    { 1100528719;2;Field  ;
                SourceExpr="Try-out No." }

    { 1100528721;2;Field  ;
                SourceExpr="Try-out Quote No." }

    { 1100528741;2;Field  ;
                SourceExpr="Estimate No." }

    { 1100528723;2;Field  ;
                SourceExpr="Project No." }

    { 1100528735;2;Field  ;
                SourceExpr="Parcel No." }

    { 1100525002;2;Field  ;
                SourceExpr="Building Code" }

    { 1100528729;2;Field  ;
                SourceExpr="Service Location No." }

    { 1100528739;2;Field  ;
                SourceExpr="Service Contract No." }

    { 1100528725;2;Field  ;
                SourceExpr="Service Call No." }

    { 1100528727;2;Field  ;
                SourceExpr="Service Order No." }

    { 1100528733;2;Field  ;
                SourceExpr="Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 1100528737;2;Field  ;
                SourceExpr="Cust. Ledger Entry No.";
                Editable=FALSE }

    { 1100528731;2;Field  ;
                SourceExpr="Action No.";
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100528800;1;Part   ;
                CaptionML=ENU=Contact Details;
                SubPageLink=No.=FIELD(Contact No.);
                PagePartID=Page11130242;
                PartType=Page }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=The %1 will always have either the %2 or %3 assigned.;NOR=%1 er alltid tilordnet %2 eller %3.;SVE=%1 kommer alltid att vara tilldelad antingen %2 eller %3.';
      Text002@1002 : TextConst 'ENU=The %1 of the %2 type must always have the %3 assigned.;NOR=%1 av typen %2 mÜ alltid ha tilordnet %3.;SVE=%1 som Ñr av typen %2 mÜste alltid vara tilldelad %3.';
      CannotSelectAttendeesErr@1005 : TextConst '@@@="%1 = Task Type";ENU=You cannot select attendees for a task of the ''%1'' type.;NOR=Du kan ikke velge deltakere til en oppgave av typen %1.;SVE=Det gÜr inte att inte vÑlja deltagare fîr en uppgift av typen %1.';
      MakePhoneCallIsNotAvailableErr@1007 : TextConst 'ENU=The Make Phone Call function for this task is available only in the Attendee Scheduling window.;NOR=Funksjonen SlÜ nummeret for denne oppgaven er bare tilgjengelig fra vinduet Tidsplanlegging for deltakere.;SVE=Funktionen Ring upp fîr den hÑr uppgiften Ñr endast tillgÑnglig i fînstret Deltagarplanering.';
      MustAssignContactErr@1008 : TextConst 'ENU=You must assign a contact to this task before you can use the Make Phone Call function.;NOR=Du mÜ tilordne en kontakt til denne oppgaven fõr du kan bruke funksjonen SlÜ nummeret.;SVE=Du mÜste tilldela uppgiften en kontakt innan det gÜr att anvÑnda funktionen Ring upp.';
      MultipleTxt@1009 : TextConst 'ENU=(Multiple);NOR=(Flere);SVE=(Flera)';
      ContactNoEditable@19030566 : Boolean INDATASET;
      CreateTodoNotAllowed@1100528700 : Boolean;
      RecurringDateIntervalEditable@19051941 : Boolean INDATASET;
      CalcDueDateFromEditable@19052355 : Boolean INDATASET;
      CompletedByEditable@19071171 : Boolean INDATASET;
      StartTimeEnable@19008764 : Boolean INDATASET;
      EndingTimeEnable@19050392 : Boolean INDATASET;
      DurationEnable@19035217 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      AllDayEventEnable@19049519 : Boolean INDATASET;
      NoOfAttendeesEnable@19000329 : Boolean INDATASET;
      AttendeesAcceptedNoEnable@19007606 : Boolean INDATASET;
      CompletedByEnable@19024761 : Boolean INDATASET;
      RecurringDateIntervalEnable@19019953 : Boolean INDATASET;
      CalcDueDateFromEnable@19036769 : Boolean INDATASET;
      IsSoftwareAsAService@1001 : Boolean;
      CreateTodoEnable@19076373 : Boolean INDATASET;
      ContactNoWizard@1100528702 : Code[10];
      ContactCompanyNoWizard@1100528703 : Code[10];
      SegmentDescEditable@1100529600 : Boolean;

    [External]
    PROCEDURE SetRecurringEditable@1();
    BEGIN
      RecurringDateIntervalEditable := Recurring;
      CalcDueDateFromEditable := Recurring;
    END;

    LOCAL PROCEDURE EnableFields@2();
    BEGIN
      RecurringDateIntervalEnable := Recurring;
      CalcDueDateFromEnable := Recurring;

      IF NOT Recurring THEN BEGIN
        EVALUATE("Recurring Date Interval",'');
        CLEAR("Calc. Due Date From");
      END;

      IF Type = Type::Meeting THEN BEGIN
        StartTimeEnable := NOT "All Day Event";
        EndingTimeEnable := NOT "All Day Event";
        DurationEnable := NOT "All Day Event";
        LocationEnable := TRUE;
        AllDayEventEnable := TRUE;
      END ELSE BEGIN
        StartTimeEnable := FALSE;
        EndingTimeEnable := FALSE;
        LocationEnable := FALSE;
        DurationEnable := FALSE;
        AllDayEventEnable := FALSE;
      END;

      GetEndDateTime;
    END;

    LOCAL PROCEDURE SwitchCardControls@3();
    BEGIN
      IF Type = Type::Meeting THEN BEGIN
        ContactNoEditable := FALSE;

        NoOfAttendeesEnable := TRUE;
        AttendeesAcceptedNoEnable := TRUE;
      END ELSE BEGIN
        ContactNoEditable := TRUE;

        NoOfAttendeesEnable := FALSE;
        AttendeesAcceptedNoEnable := FALSE;
      END;
      IF "Team Code" = '' THEN
        CompletedByEnable := FALSE
      ELSE BEGIN
        CompletedByEnable := TRUE;
        CompletedByEditable := NOT Closed
      END
    END;

    PROCEDURE SetCreateTodoAllowed@1100528700(NewValue@1100528700 : Boolean);
    BEGIN
      //**4PS
      CreateTodoNotAllowed := NOT NewValue;
    END;

    PROCEDURE SetContactNoWizard@1100528701(No@1100528700 : Code[10]);
    BEGIN
      //**4PS
      ContactNoWizard := No;
    END;

    PROCEDURE SetContactCompanyNoWizard@1100528703(No@1100528700 : Code[10]);
    BEGIN
      //**4PS
      ContactCompanyNoWizard := No;
    END;

    PROCEDURE CreateCallInCallCenterPage@1100525000();
    VAR
      SegLine@1100528702 : Record 11072040;
      Contact@1100528700 : Record 5050;
      SalespersonPurchaser@1100528701 : Record 13;
      Campaign@1100528703 : Record 11072034;
    BEGIN
      //**4PS
      SegLine."To-do No." := "Organizer To-do No.";
      IF Contact.GET("Contact No.") THEN
        SegLine.VALIDATE("Contact No.", Contact."No.")
      ELSE BEGIN
        IF (Type = Type::Meeting) AND ("Team Code" = '') THEN
          ERROR(MakePhoneCallIsNotAvailableErr);
        ERROR(MustAssignContactErr);
      END;
      IF SalespersonPurchaser.GET("Salesperson Code") THEN
        SegLine."Salesperson Code" := SalespersonPurchaser.Code;
      IF Campaign.GET("Campaign No.") THEN
        "Campaign No." := Campaign."No.";
      SegLine."Line No." := 777;
      SegLine.CreateCallUsingCallCenterPage;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE TeamCodeOnAfterValidate@19070305();
    BEGIN
      SwitchCardControls;
      CALCFIELDS(
        "No. of Attendees",
        "Attendees Accepted No.",
        "Contact Name",
        "Contact Company Name",
        "Campaign Description",
        "Opportunity Description")
    END;

    LOCAL PROCEDURE ContactNoOnAfterValidate@19009577();
    BEGIN
      CALCFIELDS("Contact Name","Contact Company Name");
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE AllDayEventOnAfterValidate@19020274();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      SwitchCardControls;
      CALCFIELDS(
        "Name Sales Person", //**4PS.n
        "No. of Attendees",
        "Attendees Accepted No.",
        "Contact Name",
        "Contact Company Name",
        "Campaign Description",
        "Opportunity Description");
    END;

    LOCAL PROCEDURE CampaignNoOnAfterValidate@19036822();
    BEGIN
      CALCFIELDS("Campaign Description");
    END;

    LOCAL PROCEDURE OpportunityNoOnAfterValidate@19076180();
    BEGIN
      CALCFIELDS("Opportunity Description");
    END;

    LOCAL PROCEDURE RecurringOnPush@19040619();
    BEGIN
      SetRecurringEditable;
    END;

    LOCAL PROCEDURE ContactNoOnFormat@19025756(Text@19019593 : Text[1024]);
    BEGIN
      IF Type = Type::Meeting THEN
        Text := MultipleTxt;
    END;

    BEGIN
    END.
  }
}

