OBJECT Table 11072074 Sub-Estimate
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    DataCaptionFields=Estimate No.,Sub-Estimate No.,Description;
    OnInsert=BEGIN
               TESTFIELD("Sub-Estimate No.");
               IF EstRec.GET("Estimate No.") THEN BEGIN
                 EstRec.TESTFIELD("Part Group");
                 "Part Group" := EstRec."Part Group";
               END;
               Finished := FALSE;  //DP01931
               InitAdjustmentFactor;
             END;

    OnModify=BEGIN
               EstRec.UpdateLogbook("Estimate No.");
             END;

    OnDelete=VAR
               EstLineTotal@1100528900 : Record 11072077;
               EstPartTotal@1100525000 : Record 11229767;
               PlotbySubEstimate@1100528500 : Record 11229775;
             BEGIN
               EstRec.UpdateLogbook("Estimate No.");

               FormatMgt.CheckFormat(11,sp1,sp2);  //C063045
               CurrLevel := Level;
               IF (sp1 = 0) AND (CurrLevel = 0) THEN CurrLevel := CurrLevel + 1;
               IF (sp2 = 0) AND (CurrLevel = 1) THEN CurrLevel := CurrLevel + 1;

               SubEstRec.RESET;
               SubEstRec.SETRANGE("Estimate No.","Estimate No.");
               IF CurrLevel = 0 THEN
                 SubEstRec.SETRANGE(Chapter,"Sub-Estimate No.");
               IF CurrLevel = 1 THEN
                 SubEstRec.SETRANGE(Paragraph,"Sub-Estimate No.");
               IF CurrLevel = 2 THEN
                 SubEstRec.SETRANGE("Sub-Estimate No.","Sub-Estimate No.");

               IF SubEstRec.FINDSET(FALSE, FALSE) THEN BEGIN
                 REPEAT
                   EstPartRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   EstPartRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   EstPartRec.SETFILTER("Excel Estimate Template", '<>%1', '');
                   IF EstPartRec.FINDSET THEN BEGIN
                     REPEAT
                       EstPartRec.DeleteExcelFile(EstPartRec);
                     UNTIL EstPartRec.NEXT = 0;
                   END;
                   EstPartRec.SETRANGE("Excel Estimate Template");

                   EstPartRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   EstPartRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   EstPartRec.DELETEALL;

                   EstPartTotal.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   EstPartTotal.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   EstPartTotal.DELETEALL;   //DP00381

                   EstLineRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   EstLineRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   EstLineRec.DELETEALL;

                   EstLineTotal.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   EstLineTotal.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   EstLineTotal.DELETEALL;   //DP00381

                   RcpLineRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   RcpLineRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   RcpLineRec.DELETEALL;

                   TextRec.SETRANGE("Table Name",TextRec."Table Name"::Estimate);
                   TextRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   TextRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   TextRec.DELETEALL;

                   EstCodeRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   EstCodeRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   EstCodeRec.DELETEALL;

                   ChrgRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   ChrgRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   ChrgRec.DELETEALL;

                   DeleteQuantityRelation(SubEstRec."Estimate No.", SubEstRec."Sub-Estimate No."); //DP00686

                   QuanSheetRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   QuanSheetRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   QuanSheetRec.DELETEALL;

                   QuanModelRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   QuanModelRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   QuanModelRec.DELETEALL;

                   EstFeaturePartRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   EstFeaturePartRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   EstFeaturePartRec.DELETEALL;

                   ConfigPartRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   ConfigPartRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   ConfigPartRec.DELETEALL;

                   ConfigRowQuanRec.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   ConfigRowQuanRec.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   ConfigRowQuanRec.DELETEALL;

                   PlotbySubEstimate.SETRANGE("Estimate No.",SubEstRec."Estimate No.");
                   PlotbySubEstimate.SETRANGE("Sub-Estimate No.",SubEstRec."Sub-Estimate No.");
                   PlotbySubEstimate.DELETEALL;  //DP02088
                 UNTIL SubEstRec.NEXT = 0;
                 SubEstRec.DELETEALL;
               END;
             END;

    OnRename=BEGIN
               ERROR(Text000);
             END;

    CaptionML=[ENU=Sub-Estimate;
               NOR=Delkalkyle;
               SVE=Delkalkyl];
    PasteIsValid=No;
    LookupPageID=Page11229767;
    DrillDownPageID=Page11229767;
  }
  FIELDS
  {
    { 10  ;   ;Estimate No.        ;Code20        ;TableRelation=Estimate.No.;
                                                   CaptionML=[ENU=Estimate No.;
                                                              NOR=Kalkylenr;
                                                              SVE=Kalkylnr] }
    { 20  ;   ;Sub-Estimate No.    ;Code20        ;OnValidate=BEGIN
                                                                FormatMgt.FormatSubEstimate("Sub-Estimate No.",Chapter,Paragraph,Level,"Estimate No.",FALSE);
                                                                IF CurrFieldNo = FIELDNO("Sub-Estimate No.") THEN
                                                                  IF (xRec."Sub-Estimate No." <> '') AND (xRec."Sub-Estimate No." <> "Sub-Estimate No.") THEN
                                                                    ERROR(Text000);

                                                                InheritFromParentLevel;  //DP02460
                                                                CheckCumFreqParent;
                                                                CheckPartLevelZeroExist;  //DP00381
                                                              END;

                                                   CaptionML=[ENU=Sub-Estimate No.;
                                                              NOR=Delkalkylenummer;
                                                              SVE=Delkalkylnr] }
    { 30  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 50  ;   ;Frequency           ;Decimal       ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                ProcessFrequency("Estimate No.", "Sub-Estimate No.", TRUE);
                                                                IF CurrFieldNo = FIELDNO(Frequency) THEN
                                                                  CheckFrequencySubEstimateByNumPlots("Estimate No.", "Sub-Estimate No.", FALSE);  //DP02088
                                                              END;

                                                   CaptionML=[ENU=Frequency;
                                                              NOR=Forekomst;
                                                              SVE=Frekvens];
                                                   DecimalPlaces=0:5 }
    { 51  ;   ;Cumulative Frequency;Decimal       ;InitValue=1;
                                                   CaptionML=[ENU=Cumulative Frequency;
                                                              NOR=Akkumulert Frekvens;
                                                              SVE=Ackumulerad f”rekomst];
                                                   Editable=No }
    { 60  ;   ;Unit of Measure     ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Unit of Measure;
                                                              NOR=Enhet;
                                                              SVE=Enhet] }
    { 70  ;   ;Hours               ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line".Hours WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Hours;
                                                              NOR="Timer ";
                                                              SVE=Timmar];
                                                   Editable=No }
    { 80  ;   ;Labor Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Labor Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                              Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Labor Amount;
                                                              NOR=Arbeidskraftsbel›p;
                                                              SVE=Arbetskraftsbelopp];
                                                   Editable=No }
    { 90  ;   ;Material Amount     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Material Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                 Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Material Amount;
                                                              NOR=Materialebel›p;
                                                              SVE=Materialbelopp];
                                                   Editable=No }
    { 91  ;   ;Gross Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Material Gross Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                  Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Gross Amount;
                                                              NOR=Bruttobel›p;
                                                              SVE=Bruttobelopp];
                                                   Editable=No }
    { 100 ;   ;Subcontracting Amount;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Subcontracting Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                       Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Subcontracting Amount;
                                                              NOR=Underentrepren›rbel›p;
                                                              SVE=Underentreprenadsbelopp];
                                                   Editable=No }
    { 110 ;   ;Plant Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Plant Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                              Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Plant Amount;
                                                              NOR=Maskinbel›p;
                                                              SVE=Maskin belopp];
                                                   Editable=No }
    { 120 ;   ;Total Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                        Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Total Amount;
                                                              NOR=Totalt bel›p;
                                                              SVE=Totalt belopp];
                                                   Editable=No }
    { 130 ;   ;Estimate Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Estimate.Description WHERE (No.=FIELD(Estimate No.)));
                                                   CaptionML=[ENU=Estimate Description;
                                                              NOR=Kalkylebeskrivelse;
                                                              SVE=Kalkylbeskrivning];
                                                   Editable=No }
    { 140 ;   ;Level               ;Integer       ;CaptionML=[ENU=Level;
                                                              NOR=Niv†;
                                                              SVE=Niv†] }
    { 160 ;   ;Chapter             ;Code20        ;CaptionML=[ENU=Chapter;
                                                              NOR=Kapittel;
                                                              SVE=Kapitel] }
    { 165 ;   ;Paragraph           ;Code20        ;CaptionML=[ENU=Paragraph;
                                                              NOR=Avsnitt;
                                                              SVE=Stycke] }
    { 170 ;   ;Hours Chapter       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line".Hours WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Hours Chapter;
                                                              NOR=Timer, kapittel;
                                                              SVE=Timmar, kapitel];
                                                   Editable=No }
    { 171 ;   ;Hours Paragraph     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line".Hours WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Hours Paragraph;
                                                              NOR=Timer, avsnitt;
                                                              SVE=Timmar, stycke];
                                                   Editable=No }
    { 180 ;   ;Labor Chapter       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Labor Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                              Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Labor Chapter;
                                                              NOR=Arbeidskraftskapittel;
                                                              SVE=Arbetskraftskapitel];
                                                   Editable=No }
    { 181 ;   ;Labor Paragraph     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Labor Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                              Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Labor Paragraph;
                                                              NOR=Arbeidskraftsavsnitt;
                                                              SVE=Arbetskraftsstycke];
                                                   Editable=No }
    { 190 ;   ;Material Chapter    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Material Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                 Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Material Chapter;
                                                              NOR=Materialekapittel;
                                                              SVE=Materialkapitel];
                                                   Editable=No }
    { 191 ;   ;Gross Price Chapter ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Material Gross Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                  Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Gross Price Chapter;
                                                              NOR=Bruttopriskapittel;
                                                              SVE=Bruttopriskapitel];
                                                   Editable=No }
    { 195 ;   ;Material Paragraph  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Material Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                 Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Material Paragraph;
                                                              NOR=Materialeavsnitt;
                                                              SVE=Materialstycke];
                                                   Editable=No }
    { 196 ;   ;Gross Price Paragraph;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Material Gross Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                  Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Gross Price Paragraph;
                                                              NOR=Bruttoprisavsnitt;
                                                              SVE=Bruttoprisstycke];
                                                   Editable=No }
    { 200 ;   ;Subcontracting Chapter;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Subcontracting Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                       Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Subcontracting Chapter;
                                                              NOR=Underentrepen›rskapittel;
                                                              SVE=Underentreprenadskapitel];
                                                   Editable=No }
    { 201 ;   ;Subcontracting Paragraph;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Subcontracting Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                       Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Subcontracting Paragraph;
                                                              NOR=Underentrepen›rsavsnitt;
                                                              SVE=Underentreprenadsstycke];
                                                   Editable=No }
    { 210 ;   ;Plant Chapter       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Plant Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                              Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Plant Chapter;
                                                              NOR=Maskinkapittel;
                                                              SVE=Maskinkapitel];
                                                   Editable=No }
    { 211 ;   ;Plant Paragraph     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Plant Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                              Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Plant Paragraph;
                                                              NOR=Maskinavsnitt;
                                                              SVE=Maskinstycke];
                                                   Editable=No }
    { 220 ;No ;Total Chapter       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                        Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Total Chapter;
                                                              NOR=Kapittel totalt;
                                                              SVE=Kapitel totalt];
                                                   Description=DP00381: expired;
                                                   Editable=No }
    { 221 ;No ;Total Paragraph     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                        Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Total Paragraph;
                                                              NOR=Avsnitt totalt;
                                                              SVE=Stycke totalt];
                                                   Description=DP00381: expired;
                                                   Editable=No }
    { 290 ;   ;Cum. Hours          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Hours" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Cum. Hours;
                                                              NOR=Akkumulerte timer;
                                                              SVE=Ackum. Timmar];
                                                   Editable=No }
    { 300 ;   ;Cum. Labor          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Labor" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Cum. Labor;
                                                              NOR=Akkumulert arbeidskraft;
                                                              SVE=Ackum. Arbetskraft];
                                                   Editable=No }
    { 310 ;   ;Cum. Material       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Material" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                      Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Cum. Material;
                                                              NOR=Akkumulert Materiale;
                                                              SVE=Ackum. Material];
                                                   Editable=No }
    { 320 ;   ;Cum. Subcontracting ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Subcontracting" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                            Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Cum. Subcontracting;
                                                              NOR=Akkumulert underentrepen›r;
                                                              SVE=Ackum. Underentreprenad];
                                                   Editable=No }
    { 330 ;   ;Cum. Plant          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Plant" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Cum. Plant;
                                                              NOR=Akkumulert maskin;
                                                              SVE=Ackum. Maskin];
                                                   Editable=No }
    { 340 ;   ;Cum. Total          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Total" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Cum. Total;
                                                              NOR=Akkumulert Totalt;
                                                              SVE=Ackum. Totalt];
                                                   Editable=No }
    { 350 ;   ;Cum. Hours Chapter  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Hours" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Cum. Hours Chapter;
                                                              NOR=Akkumulerte timer, kapitel;
                                                              SVE=Ackum. Timmar, kapitel];
                                                   Editable=No }
    { 351 ;   ;Cum. Hours Paragraph;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Hours" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Cum. Hours Paragraph;
                                                              NOR=Akkumulerte timer, avsnitt;
                                                              SVE=Ackum. Timmar, stycke];
                                                   Editable=No }
    { 360 ;   ;Cum. Labor Chapter  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Labor" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Cum. Labor Chapter;
                                                              NOR=Akkumulert arbeidskraftskapittel;
                                                              SVE=Ackum. Arbetskraftskapitel];
                                                   Editable=No }
    { 361 ;   ;Cum. Labor Paragraph;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Labor" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Cum. Labor Paragraph;
                                                              NOR=Akkumulert arbeidskraftsavsnitt;
                                                              SVE=Ackum. Arbetskraftsstycke];
                                                   Editable=No }
    { 370 ;   ;Cum. Material Chapter;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Material" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                      Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Cum. Material Chapter;
                                                              NOR=Akkumulert materialekapittel;
                                                              SVE=Ackum. Materialkapitel];
                                                   Editable=No }
    { 375 ;   ;Cum. Material Paragraph;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Material" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                      Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Cum. Material Paragraph;
                                                              NOR=Akkumulert Materialeavsnitt;
                                                              SVE=Ackum. Materialstycke];
                                                   Editable=No }
    { 380 ;   ;Cum. Subcontracting Chapter;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Subcontracting" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                            Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Cum. Subcontracting Chapter;
                                                              NOR=Akkumulert underentrepen›rskapittel;
                                                              SVE=Ackum. Underentreprenadskapitel];
                                                   Editable=No }
    { 381 ;   ;Cum. Subcontracting Paragraph;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Subcontracting" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                            Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Cum. Subcontracting Paragraph;
                                                              NOR=Akkumulert underentrepen›rsavsnitt;
                                                              SVE=Ackum. Underentreprenadsstycke];
                                                   Editable=No }
    { 390 ;   ;Cum. Plant Chapter  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Plant" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Cum. Plant Chapter;
                                                              NOR=Akkumulert maskinkapittel;
                                                              SVE=Ackum. Maskinkapitel];
                                                   Editable=No }
    { 391 ;   ;Cum. Plant Paragraph;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Plant" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Cum. Plant Paragraph;
                                                              NOR=Akkumulert maskinavsnitt;
                                                              SVE=Ackum. Maskinstycke];
                                                   Editable=No }
    { 400 ;No ;Cum. Total Chapter  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Total" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=[ENU=Cum. Total Chapter;
                                                              NOR=Akkumulert kapittel totalt;
                                                              SVE=Ackum. Kapitel totalt];
                                                   Description=DP00381: expired;
                                                   Editable=No }
    { 401 ;No ;Cum. Total Paragraph;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Total" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                   Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=[ENU=Cum. Total Paragraph;
                                                              NOR=Akkumulert avsnitt totalt;
                                                              SVE=Ackum. Stycke totalt];
                                                   Description=DP00381: expired;
                                                   Editable=No }
    { 410 ;   ;Norm Group          ;Code10        ;TableRelation="Norm Group".Code;
                                                   OnValidate=BEGIN
                                                                UpdateNormGroup;  //DP00686
                                                              END;

                                                   CaptionML=[ENU=Norm Group;
                                                              NOR=Normgruppe;
                                                              SVE=Normgrupp] }
    { 420 ;   ;Part Group          ;Code10        ;TableRelation="Estimate Group".No. WHERE (Type=CONST(Part));
                                                   OnValidate=VAR
                                                                lvEstPartRec@1100485000 : Record 11072073;
                                                                lvEstLineRec@1100528900 : Record 11072072;
                                                              BEGIN
                                                                IF "Part Group" <> xRec."Part Group" THEN BEGIN
                                                                  lvEstPartRec.SETRANGE("Estimate No.", "Estimate No.");
                                                                  lvEstPartRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
                                                                  lvEstPartRec.SETRANGE("Part Group", xRec."Part Group");
                                                                  lvEstPartRec.SETFILTER(Level, '>%1', 0);  //DP00381
                                                                  IF lvEstPartRec.FINDFIRST THEN
                                                                    FIELDERROR("Part Group", Text001);
                                                                  //DP00381.sn
                                                                  lvEstPartRec.SETRANGE(Level, 0);
                                                                  IF lvEstPartRec.FINDSET THEN BEGIN
                                                                    lvEstLineRec.SETRANGE("Estimate No.", lvEstPartRec."Estimate No.");
                                                                    lvEstLineRec.SETRANGE("Sub-Estimate No.", lvEstPartRec."Sub-Estimate No.");
                                                                    lvEstLineRec.SETRANGE("Part Group", lvEstPartRec."Part Group");
                                                                    lvEstLineRec.SETRANGE(Part, lvEstPartRec.Part);
                                                                    lvEstLineRec.DELETEALL(TRUE);
                                                                    //IF lvEstLineRec.FINDFIRST THEN
                                                                    //  FIELDERROR("Part Group", Text001);
                                                                    lvEstPartRec.DELETE;
                                                                  END;
                                                                  CheckPartLevelZeroExist;
                                                                  //DP00381.en
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Part Group;
                                                              NOR=Del gruppe;
                                                              SVE=Delgrupp] }
    { 425 ;   ;Recipe Group        ;Code10        ;TableRelation="Recipe Group".No.;
                                                   CaptionML=[ENU=Recipe Group;
                                                              NOR=Maltype;
                                                              SVE=Malltyp];
                                                   Description=C028822 }
    { 430 ;   ;Element             ;Code20        ;TableRelation="Base Element".Code;
                                                   OnValidate=BEGIN
                                                                FormatMgt.FormatElem(Element,2,'');
                                                                IF Element <> '' THEN
                                                                  IF "Project No." <> '' THEN BEGIN
                                                                    IF NOT ProjElemRec.GET("Project No.", Element) THEN
                                                                      ElemRec.GET(Element);
                                                                  END ELSE
                                                                    ElemRec.GET(Element);

                                                                GetDisciplineByElement;  //DP02460
                                                                UpdateProjElem(1);
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF "Project No." <> '' THEN BEGIN
                                                                ProjElemRec.SETRANGE("Project No.", "Project No.");
                                                                ProjElemRec.Element := Element;
                                                                IF PAGE.RUNMODAL(PAGE::"Project Element List", ProjElemRec) = ACTION::LookupOK THEN
                                                                  VALIDATE(Element, ProjElemRec.Element);
                                                              END ELSE BEGIN
                                                                ElemRec.Code := Element;
                                                                IF PAGE.RUNMODAL(PAGE::Elements, ElemRec) = ACTION::LookupOK THEN
                                                                  VALIDATE(Element, ElemRec.Code);
                                                              END;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 440 ;   ;Project No.         ;Code20        ;TableRelation=Job.No.;
                                                   OnValidate=BEGIN
                                                                UpdateProjElem(0);
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 450 ;   ;Volume              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line".Volume WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                 Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Volume;
                                                              NOR=Volum;
                                                              SVE=Volym];
                                                   DecimalPlaces=2:;
                                                   Editable=No }
    { 460 ;   ;Text                ;Text250       ;CaptionML=[ENU=Text;
                                                              NOR=Tekst;
                                                              SVE=Ben„mning] }
    { 465 ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line (Group)" WHERE (Table Name=CONST(Estimate),
                                                                                                   Estimate No.=FIELD(Estimate No.),
                                                                                                   Sub-Estimate No.=FIELD(Sub-Estimate No.),
                                                                                                   Part Group=FILTER(''),
                                                                                                   Part=FILTER(''),
                                                                                                   Estimate Line No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 466 ;   ;Print on Quote      ;Boolean       ;OnValidate=BEGIN
                                                                UpdatePartLevel("Estimate No.", "Sub-Estimate No.", FIELDNO("Print on Quote"));
                                                                UpdateLowerLevel(FIELDNO("Print on Quote"));
                                                              END;

                                                   CaptionML=[ENU=Print on Quote;
                                                              NOR=Skriv ut p† tilbud;
                                                              SVE=Skriv ut p† offert] }
    { 467 ;   ;Extension           ;Boolean       ;OnValidate=BEGIN
                                                                UpdatePartLevel("Estimate No.", "Sub-Estimate No.", FIELDNO(Extension));
                                                                UpdateLowerLevel(FIELDNO(Extension));
                                                              END;

                                                   CaptionML=[ENU=Extension;
                                                              NOR=Direktenr.;
                                                              SVE=Anknytning] }
    { 470 ;   ;Adjustment Factor Hours;Decimal    ;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(1,1);  //DP00555
                                                              END;

                                                   CaptionML=[ENU=Hours Adjustment Factor;
                                                              NOR=Timejusteringsfaktor;
                                                              SVE=Timjusteringsfaktor];
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 471 ;   ;Adjustment Factor Material;Decimal ;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(2,1);  //DP00555
                                                              END;

                                                   CaptionML=[ENU=Material Adjustment Factor;
                                                              NOR=Materialejusteringsfaktor;
                                                              SVE=Materialjusteringsfaktor];
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 472 ;   ;Adjustment Factor Subcontr.;Decimal;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(3,1);  //DP00555
                                                              END;

                                                   CaptionML=[ENU=Subcontr. Adjustment Factor;
                                                              NOR=Underentrepen›r Justeringsfaktor;
                                                              SVE=Underlev. Justeringsfaktor];
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 473 ;   ;Adjustment Factor Plant;Decimal    ;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(4,1);  //DP00555
                                                              END;

                                                   CaptionML=[ENU=Plant Adjustment Factor;
                                                              NOR=Maskin Justeringsfaktor;
                                                              SVE=Maskin justeringsfaktor];
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 474 ;   ;Adjustment Factor Sundry;Decimal   ;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(5,1);  //DP00555
                                                              END;

                                                   CaptionML=ENU=Sundry Adjustment Factor;
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 475 ;   ;Cum. Adj. Factor Hours;Decimal     ;CaptionML=[ENU=Cum. Hours Adjustment Factor;
                                                              NOR=Akkumulert Timejusteringsfaktor;
                                                              SVE=Ackum. Timjusteringsfaktor];
                                                   DecimalPlaces=0:6 }
    { 476 ;   ;Cum. Adj. Factor Material;Decimal  ;CaptionML=[ENU=Cum. Material Adjustment Factor;
                                                              NOR=Akkumulert Materialejusteringsfaktor;
                                                              SVE=Ackum. Materialjusteringsfaktor];
                                                   DecimalPlaces=0:6 }
    { 477 ;   ;Cum. Adj. Factor Subcontr.;Decimal ;CaptionML=[ENU=Cum. Subcontracting Adjustment Factor;
                                                              NOR=Akkumulert Justeringsfaktor for underentrepen›r;
                                                              SVE=Ackum. Justeringsfaktor f”r underentreprenad];
                                                   DecimalPlaces=0:6 }
    { 478 ;   ;Cum. Adj. Factor Plant;Decimal     ;CaptionML=[ENU=Cum. Plant Adjustment Factor;
                                                              NOR=Akkumulert maskinjusteringsfaktor;
                                                              SVE=Ackum. Maskin justeringsfaktor];
                                                   DecimalPlaces=0:6 }
    { 479 ;   ;Cum. Adj. Factor Sundry;Decimal    ;CaptionML=ENU=Cum. Sundry Adjustment Factor;
                                                   DecimalPlaces=0:6 }
    { 480 ;   ;Code                ;Code20        ;OnValidate=VAR
                                                                CodingSystem@1100525000 : Record 11012088;
                                                              BEGIN
                                                                EstRec.GET("Estimate No.");
                                                                EstRec.TESTFIELD("Coding System");

                                                                IF Code <> '' THEN BEGIN
                                                                  CodingSystem.GET(EstRec."Coding System");
                                                                  IF CodingSystem."Deviant Code allowed" = FALSE THEN BEGIN
                                                                    FormatMgt.SetSelection(EstRec."Coding System");
                                                                    FormatMgt.FormatElem(Code,4,'');
                                                                    CodeRec.GET(EstRec."Coding System", Code);
                                                                  END;
                                                                END;

                                                                MODIFY;
                                                                UpdateMgt.UpdateCode("Estimate No.", "Sub-Estimate No.", '', Code);  //DP00381
                                                              END;

                                                   OnLookup=BEGIN
                                                              EstRec.GET("Estimate No.");
                                                              EstRec.TESTFIELD("Coding System");
                                                              CodeRec.SETRANGE("Coding System", EstRec."Coding System");
                                                              CodeRec.Code := Code;
                                                              IF PAGE.RUNMODAL(PAGE::"Codes per Coding System", CodeRec) = ACTION::LookupOK THEN
                                                                VALIDATE(Code, CodeRec.Code);
                                                            END;

                                                   CaptionML=[ENU=Code;
                                                              NOR=Kode;
                                                              SVE=Kod] }
    { 490 ;   ;Target Hours        ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Target Amount Labor", 0);
                                                              END;

                                                   CaptionML=[ENU=Target Hours;
                                                              NOR=M†ltimer;
                                                              SVE=M†ltimmar] }
    { 491 ;   ;Target Amount Labor ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Target Hours", 0);
                                                              END;

                                                   CaptionML=[ENU=Target Amount Labor;
                                                              NOR=M†lbel›p for arbeidskraft;
                                                              SVE=M†lbelopp f”r arbetskraft] }
    { 492 ;   ;Target Amount Material;Decimal     ;CaptionML=[ENU=Target Amount Material;
                                                              NOR=M†lbel›p for Materiale;
                                                              SVE=M†lbelopp f”r material] }
    { 493 ;   ;Target Amount Subcontracting;Decimal;
                                                   CaptionML=[ENU=Target Amount Subcontracting;
                                                              NOR=M†lbel›p for underentrepen›r;
                                                              SVE=M†lbelopp f”r underentreprenad] }
    { 494 ;   ;Target Amount Plant ;Decimal       ;CaptionML=[ENU=Target Amount Plant;
                                                              NOR=M†lbel›p for maskin;
                                                              SVE=M†lbelopp f”r Maskin] }
    { 495 ;   ;Target Amount Sundry;Decimal       ;CaptionML=ENU=Target Amount Sundry }
    { 500 ;   ;House Model         ;Code20        ;TableRelation="House Model".Model WHERE (Project No.=FILTER(''));
                                                   OnValidate=BEGIN
                                                                UpdateSalesPricebyHouseModel;  //DP02089
                                                              END;

                                                   CaptionML=[ENU=House Model;
                                                              NOR=Modell;
                                                              SVE=Modell];
                                                   Description=DP02089 }
    { 505 ;   ;Source Estimate     ;Code20        ;TableRelation=Estimate.No.;
                                                   CaptionML=[ENU=Source Estimate;
                                                              NOR=Kildekalkyle;
                                                              SVE=Ursprungskalkyl];
                                                   Editable=No }
    { 510 ;   ;Condition           ;Code10        ;TableRelation=Condition.Code;
                                                   CaptionML=[ENU=Condition;
                                                              NOR=Betingelse;
                                                              SVE=Villkor] }
    { 520 ;   ;Transfer to Service ;Option        ;OnValidate=BEGIN
                                                                UpdateLowerLevel(FIELDNO("Transfer to Service"));
                                                              END;

                                                   CaptionML=[ENU=Transfer to Service;
                                                              NOR=Overf›r til Service;
                                                              SVE=™verf”r till service];
                                                   OptionCaptionML=ENU=" ,,,Service Order,Modification";
                                                   OptionString=[ ,,,ServOrder,Modification];
                                                   Description=option ServLoc+Installation cancelled }
    { 525 ;   ;Service Location No.;Code20        ;TableRelation="Service Location".No.;
                                                   OnValidate=VAR
                                                                ServiceLocation@1100525000 : Record 11012801;
                                                              BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  UpdateLowerLevel(FIELDNO("Service Location No."));
                                                                //**4PS.sn
                                                                IF "Language Code" = '' THEN BEGIN
                                                                  ServiceLocation.GET("Service Location No.");
                                                                  "Language Code" := ServiceLocation."Language Code";
                                                                END;
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Service Location No.;
                                                              NOR=Servicelokasjon Nr.;
                                                              SVE=Serviceplatsnr] }
    { 527 ;   ;Object Modification No.;Code10     ;TableRelation="Object Modification";
                                                   OnValidate=BEGIN
                                                                IF "Object Modification No." <> '' THEN
                                                                  TESTFIELD("Transfer to Service", "Transfer to Service"::Modification);
                                                                IF CurrFieldNo <> 0 THEN
                                                                  UpdateLowerLevel(FIELDNO("Object Modification No."));
                                                              END;

                                                   CaptionML=ENU=Object Modification No. }
    { 530 ;   ;Service Order No.   ;Code20        ;TableRelation="Service Order".No. WHERE (No.=FIELD(Service Order No.));
                                                   OnValidate=BEGIN
                                                                IF "Service Order No." <> '' THEN
                                                                  TESTFIELD("Transfer to Service", "Transfer to Service"::ServOrder);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  UpdateLowerLevel(FIELDNO("Service Order No."));

                                                                CheckServiceOrder;
                                                              END;

                                                   OnLookup=VAR
                                                              ServiceSetup@1100528601 : Record 11012800;
                                                              ServiceOrder@1100528600 : Record 11012823;
                                                            BEGIN
                                                              ServiceSetup.GET;
                                                              IF "Service Order No." <> '' THEN
                                                                IF ServiceOrder.GET("Service Order No.") THEN;
                                                              IF PAGE.RUNMODAL(0, ServiceOrder) = ACTION::LookupOK THEN
                                                                VALIDATE("Service Order No.", ServiceOrder."No.");
                                                            END;

                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr] }
    { 540 ;   ;Vendor              ;Code20        ;TableRelation=Vendor.No.;
                                                   CaptionML=[ENU=Vendor;
                                                              NOR=Leverand›r;
                                                              SVE=Leverant”r] }
    { 541 ;   ;Vendor Name         ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Name WHERE (No.=FIELD(Vendor)));
                                                   CaptionML=[ENU=Vendor Name;
                                                              NOR=Leverand›rsnavn;
                                                              SVE=Leverant”rsnamn];
                                                   Editable=No }
    { 550 ;   ;Subcontractor       ;Code20        ;TableRelation=Vendor.No. WHERE (Subcontractor Type=FILTER(Subcontractor|Self Employed|Employment Agency));
                                                   CaptionML=[ENU=Subcontractor;
                                                              NOR=Underentrepren›r;
                                                              SVE=Underentrepren”r] }
    { 551 ;   ;Subcontractor Name  ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Name WHERE (No.=FIELD(Subcontractor)));
                                                   CaptionML=[ENU=Subcontractor Name;
                                                              NOR=Underentrepren›rens navn;
                                                              SVE=Underentrepren”rens namn];
                                                   Editable=No }
    { 560 ;   ;Quantity Model Exist;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Estimate Model Line Quantity" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                           Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Quantity Model Exist;
                                                              NOR=Antallsmodell finnes;
                                                              SVE=Antalsmodell finns];
                                                   Editable=No }
    { 590 ;   ;Estimator           ;Code20        ;TableRelation=Employee.No.;
                                                   CaptionML=[ENU=Estimator;
                                                              NOR=Kalkylat›r;
                                                              SVE=Kalkylator] }
    { 591 ;   ;Name Estimator      ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Estimator)));
                                                   CaptionML=[ENU=Name Estimator;
                                                              NOR=Navn p† Kalkyleansvarlig;
                                                              SVE=Namn p† kalkylansvarig];
                                                   Editable=No }
    { 600 ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              NOR=Spr†kkode;
                                                              SVE=Spr†kkod] }
    { 610 ;   ;Summary (Sales)     ;Code10        ;TableRelation="Summary Sheet".Summary WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                Summary Type=CONST(Sales));
                                                   CaptionML=[ENU=Summary (Sales);
                                                              NOR=Sum (salg);
                                                              SVE=Summa (f”rs„ljning)] }
    { 611 ;   ;Summary (Cost)      ;Code10        ;TableRelation="Summary Sheet".Summary WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                Summary Type=CONST(Cost));
                                                   CaptionML=[ENU=Summary (Cost);
                                                              NOR=Sum (kost);
                                                              SVE=Summa (kostnad)] }
    { 650 ;   ;Project Planning Activity Code;Code10;
                                                   TableRelation="Project Planning Base Activity";
                                                   OnValidate=VAR
                                                                ProjectPlanningActivity@1100528402 : Record 11012431;
                                                                ProjectPlanningBaseActivity@1100528401 : Record 11012434;
                                                                FormatManagement@1100528400 : Codeunit 11012022;
                                                              BEGIN
                                                                FormatManagement.FormatElem("Project Planning Activity Code", 20, '');
                                                                IF "Project Planning Activity Code" <> '' THEN
                                                                  IF "Project No." <> '' THEN BEGIN
                                                                    IF NOT ProjectPlanningActivity.GET("Project No." + "Project Planning Activity Code") THEN
                                                                      ProjectPlanningBaseActivity.GET("Project Planning Activity Code");
                                                                  END ELSE
                                                                    ProjectPlanningBaseActivity.GET("Project Planning Activity Code");

                                                                UpdateProjPlanActCode;
                                                              END;

                                                   OnLookup=VAR
                                                              ProjectPlanningActivity@1100528401 : Record 11012431;
                                                              ProjectPlanningBaseActivity@1100528400 : Record 11012434;
                                                            BEGIN
                                                              IF "Project No." <> '' THEN BEGIN
                                                                ProjectPlanningActivity.SETRANGE("Project No.", "Project No.");
                                                                ProjectPlanningActivity.Code := "Project Planning Activity Code";
                                                                IF PAGE.RUNMODAL(PAGE::"Project Planning Activity List", ProjectPlanningActivity) = ACTION::LookupOK THEN
                                                                  VALIDATE("Project Planning Activity Code", ProjectPlanningActivity.Code);
                                                              END ELSE BEGIN
                                                                ProjectPlanningBaseActivity.Code := "Project Planning Activity Code";
                                                                IF PAGE.RUNMODAL(PAGE::"Proj. Planning Base Activities", ProjectPlanningBaseActivity) = ACTION::LookupOK THEN
                                                                  VALIDATE("Project Planning Activity Code", ProjectPlanningBaseActivity.Code);
                                                              END;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Project Planning Activity Code;
                                                              NOR=Prosjektplan, Aktivitetskode;
                                                              SVE=Projektplan, aktivitetskod] }
    { 660 ;   ;Extension Contract  ;Code10        ;TableRelation="Extension Contract"."Contract No." WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                UpdateExtensionContract;  //DP00260
                                                              END;

                                                   CaptionML=[ENU=Extension Contract;
                                                              NOR=ETA;
                                                              SVE=ŽTA] }
    { 670 ;   ;Rate Code           ;Code10        ;TableRelation="Estimate Rate"."Rate Code" WHERE (Estimate No.=FIELD(Estimate No.));
                                                   CaptionML=[ENU=Rate Code;
                                                              NOR=Avgiftskode;
                                                              SVE=Avgiftskod] }
    { 675 ;   ;Discipline          ;Code10        ;TableRelation=Discipline;
                                                   OnValidate=BEGIN
                                                                //DP02460
                                                                IF CurrFieldNo <> FIELDNO(Discipline) THEN
                                                                  GetDisciplineByElement;  //DP02460
                                                                UpdatePartLevel("Estimate No.", "Sub-Estimate No.", FIELDNO(Discipline));
                                                                UpdateLowerLevel(FIELDNO(Discipline));
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Discipline;
                                                              SVE=Disciplin];
                                                   Description=DP02460 }
    { 700 ;   ;Parts Exist         ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Estimate Part" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                            Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Parts;
                                                              NOR=Deler;
                                                              SVE=Delar];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 710 ;   ;Finished            ;Boolean       ;OnValidate=BEGIN
                                                                //DP01931
                                                                UpdatePartLevel("Estimate No.", "Sub-Estimate No.", FIELDNO(Finished));
                                                                UpdateLowerLevel(FIELDNO(Finished));
                                                              END;

                                                   CaptionML=[ENU=Estimate Finished;
                                                              NOR=Kalkyle ferdig;
                                                              SVE=Kalkyl f„rdig];
                                                   Description=DP01931 }
    { 720 ;   ;Sales Price (House Model);Decimal  ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Sales Price (House Model);
                                                   BlankZero=Yes;
                                                   Description=DP02089;
                                                   AutoFormatType=2 }
    { 2000;   ;Sundry Amount       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Sundry Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                               Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Sundry Amount;
                                                              NOR=Diversebel›p;
                                                              SVE=Diverse, belopp];
                                                   Editable=No }
    { 2001;   ;Sundry Chapter      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Sundry Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                               Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=ENU=Sundry Chapter;
                                                   Editable=No }
    { 2002;   ;Sundry Paragraph    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line"."Sundry Cost Amount" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                               Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=ENU=Sundry Paragraph;
                                                   Editable=No }
    { 2005;   ;Cum. Sundry         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Sundry" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                    Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=ENU=Cum. Sundry;
                                                   Editable=No }
    { 2006;   ;Cum. Sundry Chapter ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Sundry" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                    Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=ENU=Cum. Sundry Chapter;
                                                   Editable=No }
    { 2007;   ;Cum. Sundry Paragraph;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Sundry" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                    Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=ENU=Cum. Sundry Paragraph;
                                                   Editable=No }
    { 2010;   ;Surcharge % Labor   ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurcharge(0);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Labor;
                                                              NOR=Tilleggsgebyrsprosent, arbeidskraft;
                                                              SVE=Till„ggsavgiftsprocent, arbetskraft];
                                                   BlankZero=Yes }
    { 2011;   ;Surcharge % Material;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurcharge(1);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Material;
                                                              NOR=Tilleggsgebyrsprosent, Materiale;
                                                              SVE=Till„ggsavgiftsprocent, material];
                                                   BlankZero=Yes }
    { 2012;   ;Surcharge % Subcontracting;Decimal ;OnValidate=BEGIN
                                                                UpdateSurcharge(2);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Subcontracting;
                                                              NOR=Tilleggsgebyrsprosent, underentrepen›r;
                                                              SVE=Till„ggsavgiftsprocent, underentreprenad];
                                                   BlankZero=Yes }
    { 2013;   ;Surcharge % Plant   ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurcharge(3);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Plant;
                                                              NOR=Tilleggsgebyrsprosent, maskin;
                                                              SVE=Till„ggsavgiftsprocent, maskin];
                                                   BlankZero=Yes }
    { 2014;   ;Surcharge % Sundry  ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurcharge(4);
                                                              END;

                                                   CaptionML=[ENU=Surcharge % Sundry;
                                                              NOR=P†slagssatser, diverse;
                                                              SVE=Till„ggsavgiftsprocent, diverse];
                                                   BlankZero=Yes }
    { 2020;   ;Cum. Hours (Sales)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Hours (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=ENU=Cum. Hours (Sales);
                                                   Editable=No }
    { 2021;   ;Cum. Labor (Sales)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Labor (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=ENU=Cum. Labor (Sales);
                                                   Editable=No }
    { 2022;   ;Cum. Material (Sales);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Material (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                              Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=ENU=Cum. Material (Sales);
                                                   Editable=No }
    { 2023;   ;Cum. Subcontracting (Sales);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Subcontr. (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                               Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=ENU=Cum. Subcontracting (Sales);
                                                   Editable=No }
    { 2024;   ;Cum. Plant (Sales)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Plant (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=ENU=Cum. Plant (Sales);
                                                   Editable=No }
    { 2025;   ;Cum. Sundry (Sales) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Sundry (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                            Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=ENU=Cum. Sundry (Sales);
                                                   Editable=No }
    { 2030;   ;Cum. Total (Sales)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Total (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Sub-Estimate No.=FIELD(Sub-Estimate No.)));
                                                   CaptionML=[ENU=Cum. Total;
                                                              NOR=Akkumulert Totalt;
                                                              SVE=Ackum. Totalt];
                                                   Editable=No }
    { 2040;   ;Cum. Hours Chapter (Sales);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Hours (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=ENU=Cum. Hours Chapter (Sales);
                                                   Editable=No }
    { 2041;   ;Cum. Hours Paragraph (Sales);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Hours (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=ENU=Cum. Hours Paragraph (Sales);
                                                   Editable=No }
    { 2050;   ;Cum. Labor Chapter (Sales);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Labor (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=ENU=Cum. Labor Chapter (Sales);
                                                   Editable=No }
    { 2051;   ;Cum. Labor Paragraph (Sales);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Labor (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=ENU=Cum. Labor Paragraph (Sales);
                                                   Editable=No }
    { 2060;   ;Cum. Mat. Chapter (Sales);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Material (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                              Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=ENU=Cum. Material Chapter (Sales);
                                                   Editable=No }
    { 2061;   ;Cum. Mat. Paragraph (Sales);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Material (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                              Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=ENU=Cum. Material Paragraph (Sales);
                                                   Editable=No }
    { 2070;   ;Cum. Subc. Chapter (Sales);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Subcontr. (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                               Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=ENU=Cum. Subcontracting (Sales);
                                                   Editable=No }
    { 2071;   ;Cum. Subc. Paragraph (Sales);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Subcontr. (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                               Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=ENU=Cum. Subcontracting Paragraph (Sales);
                                                   Editable=No }
    { 2080;   ;Cum. Plant Chapter (Sales);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Plant (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=ENU=Cum. Plant Chapter (Sales);
                                                   Editable=No }
    { 2081;   ;Cum. Plant Paragraph (Sales);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Plant (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                           Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=ENU=Cum. Plant Paragraph (Sales);
                                                   Editable=No }
    { 2090;   ;Cum. Sundry Chapter (Sales);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Sundry (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                            Chapter (Sub-Estimate)=FIELD(Chapter)));
                                                   CaptionML=ENU=Cum. Sundry Chapter (Sales);
                                                   Editable=No }
    { 2091;   ;Cum. Sundry Paragraph (Sales);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line Total"."Cumulative Sundry (Sales)" WHERE (Estimate No.=FIELD(Estimate No.),
                                                                                                                            Paragraph (Sub-Estimate)=FIELD(Paragraph)));
                                                   CaptionML=ENU=Cum. Sundry Paragraph (Sales);
                                                   Editable=No }
    { 2100;   ;Norm Group (Sales)  ;Code10        ;TableRelation="Norm Group".Code;
                                                   OnValidate=BEGIN
                                                                UpdateNormGroupSales;  //DP00686
                                                              END;

                                                   CaptionML=[ENU=Norm Group (Sales);
                                                              SVE=Kopiera till] }
    { 2110;   ;Adj. Factor Hours (Sales);Decimal  ;OnValidate=BEGIN
                                                                ProcessAdjustmentFactor(1,2);   //DP00555
                                                              END;

                                                   CaptionML=ENU=Hours Adjustment Factor (Sales);
                                                   DecimalPlaces=0:6;
                                                   MinValue=0 }
    { 2120;   ;Cum. Adj. Factor Hours (Sales);Decimal;
                                                   CaptionML=ENU=Cum. Hours Adjustment Factor (Sales);
                                                   DecimalPlaces=0:6 }
  }
  KEYS
  {
    {    ;Estimate No.,Sub-Estimate No.           ;Clustered=Yes }
    {    ;Project No.,Element                      }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      EstRec@1210190002 : Record 11012151;
      SubEstRec@1210190003 : Record 11072074;
      EstPartRec@11012000 : Record 11072073;
      EstLineRec@11012001 : Record 11072072;
      RcpLineRec@11012002 : Record 11072075;
      EstCodeRec@1210190009 : Record 11229772;
      CodeRec@1210190010 : Record 11012089;
      ChrgRec@11012003 : Record 11229771;
      TextRec@1210190012 : Record 11020595;
      QuanSheetRec@1210190007 : Record 11012186;
      QuanModelRec@1210190011 : Record 11012197;
      ConfigPartRec@11012007 : Record 11012176;
      ConfigRowQuanRec@1210190000 : Record 11012192;
      EstFeaturePartRec@11012008 : Record 11012178;
      Text000@1210190001 : TextConst 'ENU="Rename disabled; use copy function and delete original line afterwards.";NOR=Kan ikke endre navn. Bruk kopieringsfunksjonen og Fjern den originale raden etterp†.;SVE=Det g†r inte att byta namn. Anv„nd kopieringsfunktionen och ta bort den ursprungliga raden efter†t.';
      ElemRec@1210190004 : Record 11012060;
      ProjElemRec@1210190005 : Record 11012010;
      FormatMgt@1210190006 : Codeunit 11012022;
      UpdateMgt@1210190008 : Codeunit 11012229;
      Text001@1100485000 : TextConst 'ENU=may not be modfied, there are already estimate parts present;NOR=kan ikke endres, det finnes allerede kalkyledeler;SVE=f†r inte „ndras, det finns redan kalkyldelar';
      sp1@1100485003 : Integer;
      sp2@1100485002 : Integer;
      CurrLevel@1100485001 : Integer;
      Text002@1100525000 : TextConst 'ENU=%1 (%2) from Service Order %4 does not match with %1 (%3) from Estimate.';
      Text003@1100528600 : TextConst 'ENU=Estimate Lines present for other Object Modifications';

    PROCEDURE InitAdjustmentFactor@1210190003();
    BEGIN
      IF "Adjustment Factor Hours" = 0 THEN
        "Adjustment Factor Hours" := 1;
      IF "Adjustment Factor Material" = 0 THEN
        "Adjustment Factor Material" := 1;
      IF "Adjustment Factor Subcontr." = 0 THEN
        "Adjustment Factor Subcontr." := 1;
      IF "Adjustment Factor Plant" = 0 THEN
        "Adjustment Factor Plant" := 1;
      IF "Adjustment Factor Sundry" = 0 THEN  //DP00381
        "Adjustment Factor Sundry" := 1;

      IF "Adj. Factor Hours (Sales)" = 0 THEN  //DP00555
        "Adj. Factor Hours (Sales)" := 1;

      SubEstRec.RESET;
      SubEstRec.SETRANGE("Estimate No.", "Estimate No.");
      IF Level = 0 THEN
        SubEstRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      IF Level = 1 THEN
        SubEstRec.SETRANGE("Sub-Estimate No.", Chapter);
      IF Level = 2 THEN
        SubEstRec.SETRANGE("Sub-Estimate No.", Paragraph);
      IF NOT SubEstRec.FINDFIRST THEN SubEstRec.INIT;

      IF SubEstRec."Cum. Adj. Factor Hours" = 0 THEN
        "Cum. Adj. Factor Hours" := "Adjustment Factor Hours"
      ELSE
        "Cum. Adj. Factor Hours" := "Adjustment Factor Hours" * SubEstRec."Cum. Adj. Factor Hours";
      IF SubEstRec."Cum. Adj. Factor Material" = 0 THEN
        "Cum. Adj. Factor Material" := "Adjustment Factor Material"
      ELSE
        "Cum. Adj. Factor Material" := "Adjustment Factor Material" * SubEstRec."Cum. Adj. Factor Material";
      IF SubEstRec."Cum. Adj. Factor Subcontr." = 0 THEN
        "Cum. Adj. Factor Subcontr." := "Adjustment Factor Subcontr."
      ELSE
        "Cum. Adj. Factor Subcontr." := "Adjustment Factor Subcontr." * SubEstRec."Cum. Adj. Factor Subcontr.";
      IF SubEstRec."Cum. Adj. Factor Plant" = 0 THEN
        "Cum. Adj. Factor Plant" := "Adjustment Factor Plant"
      ELSE
        "Cum. Adj. Factor Plant" := "Adjustment Factor Plant" * SubEstRec."Cum. Adj. Factor Plant";
      IF SubEstRec."Cum. Adj. Factor Sundry" = 0 THEN  //DP00381
        "Cum. Adj. Factor Sundry" := "Adjustment Factor Sundry"
      ELSE
        "Cum. Adj. Factor Sundry" := "Adjustment Factor Sundry" * SubEstRec."Cum. Adj. Factor Sundry";

      IF SubEstRec."Cum. Adj. Factor Hours (Sales)" = 0 THEN  //DP00555
        "Cum. Adj. Factor Hours (Sales)" := "Adj. Factor Hours (Sales)"
      ELSE
        "Cum. Adj. Factor Hours (Sales)" := "Adj. Factor Hours (Sales)" * SubEstRec."Cum. Adj. Factor Hours (Sales)";
    END;

    PROCEDURE ProcessAdjustmentFactor@1210190000(IAdjType@1210190000 : Integer;IEstType@1100525000 : Integer);
    BEGIN
      IF (IEstType = 0) OR (IEstType = 2) THEN BEGIN  //DP00555 (0=both, 1=cost, 2=sales)
        CASE IAdjType OF
          1:
            IF "Adj. Factor Hours (Sales)" = 0 THEN
              "Adj. Factor Hours (Sales)" := 1;
        END;
      END;
      IF (IEstType = 0) OR (IEstType = 1) THEN BEGIN  //DP00555 (0=both, 1=cost, 2=sales)
        CASE IAdjType OF
          1:
            IF "Adjustment Factor Hours" = 0 THEN
              "Adjustment Factor Hours" := 1;
          2:
            IF "Adjustment Factor Material" = 0 THEN
              "Adjustment Factor Material" := 1;
          3:
            IF "Adjustment Factor Subcontr." = 0 THEN
              "Adjustment Factor Subcontr." := 1;
          4:
            IF "Adjustment Factor Plant" = 0 THEN
              "Adjustment Factor Plant" := 1;
          5:  //DP00381
            IF "Adjustment Factor Sundry" = 0 THEN
              "Adjustment Factor Sundry" := 1;
        END;
      END;
      MODIFY;

      FormatMgt.CheckFormat(11,sp1,sp2);  //C063045
      CurrLevel := Level;
      IF (sp1 = 0) AND (CurrLevel = 0) THEN CurrLevel := CurrLevel + 1;
      IF (sp2 = 0) AND (CurrLevel = 1) THEN CurrLevel := CurrLevel + 1;

      SubEstRec.RESET;
      SubEstRec.SETRANGE("Estimate No.", "Estimate No.");
      IF CurrLevel = 0 THEN
        SubEstRec.SETRANGE(Chapter,"Sub-Estimate No.");
      IF CurrLevel = 1 THEN
        SubEstRec.SETRANGE(Paragraph,"Sub-Estimate No.");
      IF CurrLevel = 2 THEN
        SubEstRec.SETRANGE("Sub-Estimate No.","Sub-Estimate No.");
      IF SubEstRec.FINDSET(FALSE, FALSE) THEN BEGIN
        REPEAT
          UpdateMgt.ResetAdjustmentFactor(SubEstRec."Estimate No.", SubEstRec."Sub-Estimate No.",
            '', '', 0, TRUE, 1, IAdjType, IEstType);  //DP00555
        UNTIL SubEstRec.NEXT = 0;
      END;

      GET("Estimate No.", "Sub-Estimate No.");
    END;

    PROCEDURE ProcessFrequency@1100485000(lvEst@1100485002 : Code[20];lvSubEst@1100485001 : Code[20];CalcLines@1100485000 : Boolean);
    VAR
      lvSubEstRec@1100485003 : Record 11072074;
      lvQuan@1100485005 : Decimal;
    BEGIN
      IF CalcLines THEN
        MODIFY;

      FormatMgt.CheckFormat(11,sp1,sp2);  //C063045
      CurrLevel := Level;
      IF (sp1 = 0) AND (CurrLevel = 0) THEN CurrLevel := CurrLevel + 1;
      IF (sp2 = 0) AND (CurrLevel = 1) THEN CurrLevel := CurrLevel + 1;

      SubEstRec.RESET;
      SubEstRec.SETRANGE("Estimate No.", lvEst);
      IF CurrLevel = 0 THEN
        SubEstRec.SETRANGE(Chapter, "Sub-Estimate No.");
      IF CurrLevel = 1 THEN
        SubEstRec.SETRANGE(Paragraph, "Sub-Estimate No.");
      IF CurrLevel = 2 THEN
        SubEstRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      IF SubEstRec.FINDSET(FALSE, FALSE) THEN BEGIN
        REPEAT
          lvQuan := SubEstRec.Frequency;
          CurrLevel := SubEstRec.Level;

          lvSubEstRec.RESET;
          lvSubEstRec.SETRANGE("Estimate No.", SubEstRec."Estimate No.");
          IF CurrLevel = 2 THEN BEGIN
            CurrLevel := CurrLevel - 1;
            lvSubEstRec.SETRANGE("Sub-Estimate No.", SubEstRec.Paragraph);
            IF lvSubEstRec.FINDFIRST THEN
              lvQuan := lvQuan * lvSubEstRec.Frequency;
          END;
          IF CurrLevel = 1 THEN BEGIN
            CurrLevel := CurrLevel - 1;
            lvSubEstRec.SETRANGE("Sub-Estimate No.", SubEstRec.Chapter);
            IF lvSubEstRec.FINDFIRST THEN
              lvQuan := lvQuan * lvSubEstRec.Frequency;
          END;

          IF SubEstRec.Level = Level THEN BEGIN
            IF "Cumulative Frequency" <> lvQuan THEN BEGIN
              "Cumulative Frequency" := lvQuan;
              MODIFY;
            END;
          END ELSE BEGIN
            IF SubEstRec."Cumulative Frequency" <> lvQuan THEN BEGIN
              SubEstRec."Cumulative Frequency" := lvQuan;
              SubEstRec.MODIFY;
            END;
          END;

          UpdatePartTotals(SubEstRec."Estimate No.", SubEstRec."Sub-Estimate No.");  //DP00381
          CalculateEstLines(SubEstRec."Estimate No.", SubEstRec."Sub-Estimate No.", CalcLines);
        UNTIL SubEstRec.NEXT = 0;
      END;
    END;

    PROCEDURE CalculateEstLines@1(lvEst@1100485000 : Code[20];lvSubEst@1100485001 : Code[20];CalcLines@1100485002 : Boolean);
    VAR
      EstimateLineOriginal@1210190000 : Record 11072072;
    BEGIN
      IF CalcLines = FALSE THEN EXIT;

      EstLineRec.SETRANGE("Estimate No.", lvEst);
      EstLineRec.SETRANGE("Sub-Estimate No.", lvSubEst);
      IF EstLineRec.FINDSET(FALSE, FALSE) THEN BEGIN
        REPEAT
          EstimateLineOriginal := EstLineRec;
          EstLineRec.VALIDATE(Quantity);  //incl. CalculateTotal + UpdateRecipeTotal
          IF FORMAT(EstimateLineOriginal) <> FORMAT(EstLineRec) THEN
            EstLineRec.MODIFY;
          CheckRecipeTotal;
        UNTIL EstLineRec.NEXT = 0;
      END;
    END;

    PROCEDURE CheckRecipeTotal@1210190001();
    BEGIN
      IF EstLineRec.Recipe = '' THEN EXIT;

      RcpLineRec.SETRANGE("Estimate No.", EstLineRec."Estimate No.");
      RcpLineRec.SETRANGE("Sub-Estimate No.", EstLineRec."Sub-Estimate No.");
      RcpLineRec.SETRANGE(Part, EstLineRec.Part);
      RcpLineRec.SETRANGE("Part Group", EstLineRec."Part Group");
      RcpLineRec.SETRANGE("Estimate Line", EstLineRec."Line No.");
      IF RcpLineRec.FINDFIRST THEN
        RcpLineRec.UpdateEstLines;
    END;

    PROCEDURE UpdateProjElem@1100485001(lvAction@1100485000 : Integer);
    VAR
      lvEstPartRec@1100485001 : Record 11072073;
    BEGIN
      IF "Project No." = '' THEN
        "Extension Contract" := '';  //DP00260

      lvEstPartRec.SETRANGE("Estimate No.", "Estimate No.");
      lvEstPartRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      IF lvAction = 0 THEN
        lvEstPartRec.SETFILTER("Project No.", '%1|%2', '', xRec."Project No.")
      ELSE
        lvEstPartRec.SETFILTER(Element, '%1|%2', '', xRec.Element);
      IF lvEstPartRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF lvAction = 0 THEN
            lvEstPartRec.VALIDATE("Project No.", "Project No.")
          ELSE
            lvEstPartRec.VALIDATE(Element, Element);
          IF "Project No."= '' THEN
            lvEstPartRec."Extension Contract" := '';  //DP00260
          lvEstPartRec.MODIFY;
        UNTIL lvEstPartRec.NEXT = 0;
      END;
    END;

    PROCEDURE UpdateLowerLevel@1100485002(CalledBy@1100528900 : Integer);
    VAR
      lvEstLineRec@1100525004 : Record 11072072;
      lvServBudgetRec@1100525002 : Record 11012875;
      lvText001@1100525003 : TextConst 'ENU=Service Order Budget Lines present;NOR=Budsjettrader for Serviceordre finnes;SVE=Budgetrader f”r serviceorder finns';
      lvText002@1100525005 : TextConst 'ENU=Estimate Lines present for other Service Orders;NOR=Det finnes kalkylerader for andre Serviceordre;SVE=Det finns kalkylrader f”r andra serviceorder';
    BEGIN
      //DP01931: use CalledBy instead of CurrFieldNo
      IF CalledBy = FIELDNO("Service Order No.") THEN BEGIN
        lvServBudgetRec.SETRANGE("Budget Type", lvServBudgetRec."Budget Type"::Order);
        lvServBudgetRec.SETRANGE("Service Order No.", "Service Order No.");
        IF lvServBudgetRec.FINDFIRST THEN MESSAGE(lvText001);

        lvEstLineRec.SETRANGE("Estimate No.", "Estimate No.");
        lvEstLineRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
        lvEstLineRec.SETFILTER("Service Order No.", '<>%1&<>%2', '', "Service Order No.");
        IF lvEstLineRec.FINDFIRST THEN ERROR(lvText002);
      END;

      IF CalledBy = FIELDNO("Object Modification No.") THEN BEGIN
        lvServBudgetRec.SETRANGE("Budget Type", lvServBudgetRec."Budget Type"::Order);
        lvServBudgetRec.SETRANGE("Service Order No.", "Service Order No.");
        IF lvServBudgetRec.FINDFIRST THEN MESSAGE(lvText001);

        lvEstLineRec.SETRANGE("Estimate No.", "Estimate No.");
        lvEstLineRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
        lvEstLineRec.SETFILTER("Object Modification No.", '<>%1&<>%2', '', "Object Modification No.");
        IF lvEstLineRec.FINDFIRST THEN ERROR(Text003);
      END;

      MODIFY;

      FormatMgt.CheckFormat(11,sp1,sp2);  //C063045
      CurrLevel := Level;
      IF (sp1 = 0) AND (CurrLevel = 0) THEN CurrLevel := CurrLevel + 1;
      IF (sp2 = 0) AND (CurrLevel = 1) THEN CurrLevel := CurrLevel + 1;

      SubEstRec.RESET;
      SubEstRec.SETRANGE("Estimate No.", "Estimate No.");
      IF CurrLevel = 0 THEN
        SubEstRec.SETRANGE(Chapter, "Sub-Estimate No.");
      IF CurrLevel = 1 THEN
        SubEstRec.SETRANGE(Paragraph, "Sub-Estimate No.");
      IF CurrLevel = 2 THEN
        SubEstRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      IF SubEstRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF CalledBy = FIELDNO("Transfer to Service") THEN
            SubEstRec."Transfer to Service" := "Transfer to Service";
          IF CalledBy = FIELDNO("Service Location No.") THEN
            SubEstRec."Service Location No." := "Service Location No.";
          IF CalledBy = FIELDNO("Service Order No.") THEN
            SubEstRec."Service Order No." := "Service Order No.";
          IF CalledBy = FIELDNO("Object Modification No.") THEN
            SubEstRec."Object Modification No." := "Object Modification No.";
          IF CalledBy = FIELDNO("Print on Quote") THEN BEGIN
            SubEstRec."Print on Quote" := "Print on Quote";
            UpdatePartLevel(SubEstRec."Estimate No.", SubEstRec."Sub-Estimate No.", CalledBy);
          END;
          IF CalledBy = FIELDNO(Extension) THEN BEGIN
            SubEstRec.Extension := Extension;
            UpdatePartLevel(SubEstRec."Estimate No.", SubEstRec."Sub-Estimate No.", CalledBy);
          END;
          IF CalledBy = FIELDNO(Finished) THEN BEGIN  //DP01931
            SubEstRec.Finished := Finished;
            UpdatePartLevel(SubEstRec."Estimate No.", SubEstRec."Sub-Estimate No.", CalledBy);
          END;
          IF CalledBy = FIELDNO(Discipline) THEN BEGIN  //DP02460
            SubEstRec.Discipline := Discipline;
            UpdatePartLevel(SubEstRec."Estimate No.", SubEstRec."Sub-Estimate No.", CalledBy);
          END;
          SubEstRec.MODIFY;
        UNTIL SubEstRec.NEXT = 0;
      END;
    END;

    PROCEDURE CheckCumFreqParent@1100525000();
    BEGIN
      //get cumulative for initial value frequency
      IF Level = 0 THEN
        "Cumulative Frequency" := Frequency;
      IF Level = 1 THEN
        IF SubEstRec.GET("Estimate No.", Chapter) THEN
          "Cumulative Frequency" := SubEstRec."Cumulative Frequency" * Frequency;
      IF Level = 2 THEN
        IF SubEstRec.GET("Estimate No.", Paragraph) THEN
          "Cumulative Frequency" := SubEstRec."Cumulative Frequency" * Frequency;
    END;

    PROCEDURE UpdatePartLevel@1210190002(iEst@1210190000 : Code[20];iSubEst@1210190001 : Code[20];CalledBy@1100528900 : Integer);
    VAR
      EstPartRec@1210190002 : Record 11072073;
    BEGIN
      //DP01931: use CalledBy instead of CurrFieldNo
      EstPartRec.SETRANGE("Estimate No.", iEst);
      EstPartRec.SETRANGE("Sub-Estimate No.", iSubEst);
      IF EstPartRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF CalledBy = FIELDNO("Print on Quote") THEN
            EstPartRec.VALIDATE("Print on Quote", "Print on Quote");
          IF CalledBy = FIELDNO(Extension) THEN
            EstPartRec.VALIDATE(Extension, Extension);
          IF CalledBy = FIELDNO(Finished) THEN
            EstPartRec.VALIDATE(Finished, Finished);  //DP01931
          IF CalledBy = FIELDNO(Discipline) THEN
            EstPartRec.VALIDATE(Discipline, Discipline);  //DP02460
          EstPartRec.MODIFY;
        UNTIL EstPartRec.NEXT = 0;
      END;
    END;

    PROCEDURE UpdateProjPlanActCode@1210190022();
    VAR
      lvEstPartRec@1210190000 : Record 11072073;
    BEGIN
      lvEstPartRec.SETRANGE("Estimate No.", "Estimate No.");
      lvEstPartRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      lvEstPartRec.SETFILTER("Project Planning Activity Code", '%1|%2', '', xRec."Project Planning Activity Code");
      IF lvEstPartRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          lvEstPartRec.VALIDATE("Project Planning Activity Code", "Project Planning Activity Code");
          lvEstPartRec.MODIFY;
        UNTIL lvEstPartRec.NEXT = 0;
      END;
    END;

    PROCEDURE UpdateExtensionContract@1100525003();
    VAR
      lvEstPartRec@1210190000 : Record 11072073;
    BEGIN
      lvEstPartRec.SETRANGE("Estimate No.", "Estimate No.");
      lvEstPartRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      lvEstPartRec.SETFILTER("Extension Contract", '%1|%2', '', xRec."Extension Contract");
      IF lvEstPartRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF lvEstPartRec."Project No." <> '' THEN
            lvEstPartRec.VALIDATE("Extension Contract", "Extension Contract");
          lvEstPartRec.MODIFY;
        UNTIL lvEstPartRec.NEXT = 0;
      END;
    END;

    PROCEDURE InitRecord@1210190004();
    BEGIN
      IF EstRec.GET("Estimate No.") THEN BEGIN
        "Project No." := EstRec."Project No.";
        Element := EstRec.Element;
        GetDisciplineByElement;  //DP02460
        IF Discipline = '' THEN
          Discipline := EstRec.Discipline;  //DP02460
        IF "Project No." <> '' THEN
          "Extension Contract" := EstRec."Extension Contract";  //DP00260
        "Project Planning Activity Code" := EstRec."Project Planning Activity Code";
      END;
      InitSurcharge;  //DP00381
    END;

    PROCEDURE GetDataCaption@1100528000() : Text[250];
    BEGIN
      EXIT(STRSUBSTNO('%1 - %2 - %3', "Estimate No.", "Sub-Estimate No.", Description));
    END;

    PROCEDURE UpdateSurcharge@1100528900(CostType@1100485000 : Integer);
    VAR
      EstPartRec@1100485001 : Record 11072073;
    BEGIN
      //DP00381
      EstPartRec.SETRANGE("Estimate No.", "Estimate No.");
      EstPartRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      IF CostType = 0 THEN
        EstPartRec.SETFILTER("Surcharge % Labor", '%1|%2', 0, xRec."Surcharge % Labor");
      IF CostType = 1 THEN
        EstPartRec.SETFILTER("Surcharge % Material", '%1|%2', 0, xRec."Surcharge % Material");
      IF CostType = 2 THEN
        EstPartRec.SETFILTER("Surcharge % Subcontracting", '%1|%2', 0, xRec."Surcharge % Subcontracting");
      IF CostType = 3 THEN
        EstPartRec.SETFILTER("Surcharge % Plant", '%1|%2', 0, xRec."Surcharge % Plant");
      IF CostType = 4 THEN
        EstPartRec.SETFILTER("Surcharge % Sundry", '%1|%2', 0, xRec."Surcharge % Sundry");
      IF EstPartRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          IF CostType = 0 THEN
            EstPartRec.VALIDATE("Surcharge % Labor", "Surcharge % Labor");
          IF CostType = 1 THEN
            EstPartRec.VALIDATE("Surcharge % Material", "Surcharge % Material");
          IF CostType = 2 THEN
            EstPartRec.VALIDATE("Surcharge % Subcontracting", "Surcharge % Subcontracting");
          IF CostType = 3 THEN
            EstPartRec.VALIDATE("Surcharge % Plant", "Surcharge % Plant");
          IF CostType = 4 THEN
            EstPartRec.VALIDATE("Surcharge % Sundry", "Surcharge % Sundry");
          EstPartRec.MODIFY;
        UNTIL EstPartRec.NEXT = 0;
      END;
    END;

    PROCEDURE SetOptionToCreatePartLevelZero@1100525004();
    BEGIN
      CurrFieldNo := FIELDNO("Sub-Estimate No.");
    END;

    PROCEDURE CheckPartLevelZeroExist@1100528901();
    VAR
      EstPartRec@1100528900 : Record 11072073;
      BasePartRec@1100528901 : Record 11012169;
    BEGIN
      //DP00381
      IF (CurrFieldNo = FIELDNO("Sub-Estimate No.")) THEN BEGIN
        EstPartRec.SETRANGE("Estimate No.", "Estimate No.");
        EstPartRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
        EstPartRec.SETFILTER(Level, '<>%1', 0);
        IF EstPartRec.FINDFIRST THEN EXIT;

        EstRec.GET("Estimate No.");  //get defaults from Estimate
        "Part Group" := EstRec."Part Group";

        BasePartRec.SETRANGE("Part Group", "Part Group");
        BasePartRec.SETRANGE(Level, 0);
        IF NOT BasePartRec.FINDFIRST THEN EXIT;

        EstPartRec."Estimate No." := "Estimate No.";
        EstPartRec."Sub-Estimate No." := "Sub-Estimate No.";
        EstPartRec."Part Group":= BasePartRec."Part Group";
        EstPartRec.VALIDATE(Part, BasePartRec.Code);
        //copy from function InitSurcharge
        EstPartRec."Surcharge % Labor" :=  EstRec."Surcharge % Labor";
        EstPartRec."Surcharge % Material" :=  EstRec."Surcharge % Material";
        EstPartRec."Surcharge % Subcontracting" :=  EstRec."Surcharge % Subcontracting";
        EstPartRec."Surcharge % Plant" :=  EstRec."Surcharge % Plant";
        EstPartRec."Surcharge % Sundry" :=  EstRec."Surcharge % Sundry";
        //copy from function InitRecord
        IF EstPartRec."Project No." = '' THEN
          EstPartRec."Project No." := EstRec."Project No.";
        IF EstPartRec.Element = '' THEN
          EstPartRec.Element := EstRec.Element;
        IF EstPartRec."Extension Contract" = '' THEN
          IF EstPartRec."Project No." <> '' THEN
            EstPartRec."Extension Contract" := EstRec."Extension Contract";
        IF EstPartRec."Project Planning Activity Code" = '' THEN
          EstPartRec."Project Planning Activity Code" := EstRec."Project Planning Activity Code";
        EstPartRec.InitAdjustmentFactor;
        EstPartRec.INSERT;
        EstPartRec.UpdatePartTotal;
      END;

      IF (CurrFieldNo = FIELDNO("Part Group")) THEN BEGIN
        BasePartRec.SETRANGE("Part Group", "Part Group");
        BasePartRec.SETRANGE(Level, 0);
        IF NOT BasePartRec.FINDFIRST THEN EXIT;

        //get defaults from Sub-Estimate
        EstPartRec."Estimate No." := "Estimate No.";
        EstPartRec."Sub-Estimate No." := "Sub-Estimate No.";
        EstPartRec."Part Group":= BasePartRec."Part Group";
        EstPartRec.VALIDATE(Part, BasePartRec.Code);
        //copy from function InitSurcharge
        EstPartRec."Surcharge % Labor" := "Surcharge % Labor";
        EstPartRec."Surcharge % Material" := "Surcharge % Material";
        EstPartRec."Surcharge % Subcontracting" := "Surcharge % Subcontracting";
        EstPartRec."Surcharge % Plant" := "Surcharge % Plant";
        EstPartRec."Surcharge % Sundry" := "Surcharge % Sundry";
        //copy from function InitRecord
        IF EstPartRec."Project No." = '' THEN
          EstPartRec."Project No." := "Project No.";
        IF EstPartRec.Element = '' THEN
          EstPartRec.Element := Element;
        IF EstPartRec."Extension Contract" = '' THEN
          IF EstPartRec."Project No." <> '' THEN
            EstPartRec."Extension Contract" := "Extension Contract";
        IF EstPartRec."Project Planning Activity Code" = '' THEN
          EstPartRec."Project Planning Activity Code" := "Project Planning Activity Code";
        EstPartRec.InitAdjustmentFactor;
        EstPartRec.INSERT;
        EstPartRec.UpdatePartTotal;
      END;
    END;

    PROCEDURE InitSurcharge@1100528911();
    BEGIN
      //DP00381
      IF EstRec.GET("Estimate No.") THEN BEGIN
        "Surcharge % Labor" := EstRec."Surcharge % Labor";
        "Surcharge % Material" := EstRec."Surcharge % Material";
        "Surcharge % Subcontracting" := EstRec."Surcharge % Subcontracting";
        "Surcharge % Plant" := EstRec."Surcharge % Plant";
        "Surcharge % Sundry" := EstRec."Surcharge % Sundry";
      END;
    END;

    PROCEDURE GetTotals@1100528902(VAR HoursDec@1100528901 : Decimal;VAR LaborDec@1100528902 : Decimal;VAR MatDec@1100528903 : Decimal;VAR SubcDec@1100528904 : Decimal;VAR PlantDec@1100528905 : Decimal;VAR SundryDec@1100528906 : Decimal;VAR TotalDec@1100528913 : Decimal;VAR CumHoursDec@1100528912 : Decimal;VAR CumLaborDec@1100528911 : Decimal;VAR CumMatDec@1100528910 : Decimal;VAR CumSubcDec@1100528909 : Decimal;VAR CumPlantDec@1100528908 : Decimal;VAR CumSundryDec@1100528907 : Decimal;VAR CumTotalDec@1100528914 : Decimal);
    VAR
      CurrLevel@1100528900 : Integer;
    BEGIN
      //DP00381
      FormatMgt.CheckFormat(11,sp1,sp2);  //C063045
      CurrLevel := Level;
      IF (sp1 = 0) AND (CurrLevel = 0) THEN CurrLevel := CurrLevel + 1;
      IF (sp2 = 0) AND (CurrLevel = 1) THEN CurrLevel := CurrLevel + 1;

      CASE CurrLevel OF
        0:BEGIN
            CALCFIELDS("Hours Chapter","Labor Chapter","Material Chapter",
                       "Subcontracting Chapter","Plant Chapter","Sundry Chapter");
            HoursDec := "Hours Chapter";
            LaborDec := "Labor Chapter";
            MatDec := "Material Chapter";
            SubcDec := "Subcontracting Chapter";
            PlantDec := "Plant Chapter";
            SundryDec := "Sundry Chapter";

            CALCFIELDS("Cum. Hours Chapter","Cum. Labor Chapter","Cum. Material Chapter",
                       "Cum. Subcontracting Chapter","Cum. Plant Chapter", "Cum. Sundry Chapter");
            CumHoursDec := "Cum. Hours Chapter";
            CumLaborDec := "Cum. Labor Chapter";
            CumMatDec := "Cum. Material Chapter";
            CumSubcDec := "Cum. Subcontracting Chapter";
            CumPlantDec := "Cum. Plant Chapter";
            CumSundryDec := "Cum. Sundry Chapter";
          END;
        1:BEGIN
            CALCFIELDS("Hours Paragraph","Labor Paragraph","Material Paragraph",
                       "Subcontracting Paragraph","Plant Paragraph","Sundry Paragraph");
            HoursDec := "Hours Paragraph";
            LaborDec := "Labor Paragraph";
            MatDec := "Material Paragraph";
            SubcDec := "Subcontracting Paragraph";
            PlantDec := "Plant Paragraph";
            SundryDec := "Sundry Paragraph";

            CALCFIELDS("Cum. Hours Paragraph","Cum. Labor Paragraph","Cum. Material Paragraph",
                       "Cum. Subcontracting Paragraph","Cum. Plant Paragraph","Cum. Sundry Paragraph");
            CumHoursDec := "Cum. Hours Paragraph";
            CumLaborDec := "Cum. Labor Paragraph";
            CumMatDec := "Cum. Material Paragraph";
            CumSubcDec := "Cum. Subcontracting Paragraph";
            CumPlantDec := "Cum. Plant Paragraph";
            CumSundryDec := "Cum. Sundry Paragraph";
          END;
        2:BEGIN
            CALCFIELDS(Hours,"Labor Amount","Material Amount",
                       "Subcontracting Amount","Plant Amount","Sundry Amount");
            HoursDec := Hours;
            LaborDec := "Labor Amount";
            MatDec := "Material Amount";
            SubcDec := "Subcontracting Amount";
            PlantDec := "Plant Amount";
            SundryDec := "Sundry Amount";

            CALCFIELDS("Cum. Hours","Cum. Labor","Cum. Material",
                       "Cum. Subcontracting","Cum. Plant","Cum. Sundry");
            CumHoursDec := "Cum. Hours";
            CumLaborDec := "Cum. Labor";
            CumMatDec := "Cum. Material";
            CumSubcDec := "Cum. Subcontracting";
            CumPlantDec := "Cum. Plant";
            CumSundryDec := "Cum. Sundry";
          END;
      END;

      TotalDec := LaborDec + MatDec + SubcDec + PlantDec + SundryDec;
      CumTotalDec := CumLaborDec + CumMatDec + CumSubcDec + CumPlantDec + CumSundryDec;
    END;

    PROCEDURE UpdatePartTotals@1100525001(iEst@1100525000 : Code[20];iSubEst@1100525001 : Code[20]);
    BEGIN
      //DP00381
      EstPartRec.SETRANGE("Estimate No.", iEst);
      EstPartRec.SETRANGE("Sub-Estimate No.", iSubEst);
      IF EstPartRec.FINDSET THEN BEGIN
        REPEAT
          EstPartRec.UpdatePartTotal;
        UNTIL EstPartRec.NEXT = 0;
      END;
    END;

    PROCEDURE CheckServiceOrder@1100525002();
    VAR
      ServOrderRec@1100525000 : Record 11012823;
    BEGIN
      //DP00260
      IF NOT ServOrderRec.GET("Service Order No.") THEN EXIT;
      ServOrderRec.CheckStatus(1);
      EstRec.GET("Estimate No.");
      IF (ServOrderRec."Customer No." <> EstRec."Customer No.") AND
         (ServOrderRec."Customer No." <> '') AND
         (EstRec."Customer No." <> '') THEN
        MESSAGE(Text002, ServOrderRec.FIELDCAPTION("Customer No."),
          ServOrderRec."Customer No.", EstRec."Customer No.",
          "Service Order No.");
      IF (ServOrderRec."Service Contract No." <> EstRec."Service Contract No.") AND
         (ServOrderRec."Service Contract No." <> '') AND
         (EstRec."Service Contract No." <> '') THEN
        MESSAGE(Text002, ServOrderRec.FIELDCAPTION("Service Contract No."),
          ServOrderRec."Service Contract No.", EstRec."Service Contract No.",
          "Service Order No.");
    END;

    PROCEDURE DeleteQuantityRelation@1100409001(lvEst@1100409000 : Code[20];lvSubEst@1100409001 : Code[20]);
    VAR
      QuanHeader@1100409006 : Record 11020462;
      QuanRelation@1100409005 : Record 11020463;
      QuanLine@1100409004 : Record 11020464;
    BEGIN
      //DP00686
      QuanHeader.SETRANGE("Estimate No.", "Estimate No.");
      QuanHeader.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      IF QuanHeader.FINDSET THEN BEGIN
        REPEAT
          QuanLine.SETRANGE("Estimate No.", QuanHeader."Estimate No.");
          QuanLine.SETRANGE("Quantity Sheet", QuanHeader.Code);
          QuanLine.DELETEALL;

          QuanRelation.SETRANGE("Estimate No.", QuanHeader."Estimate No.");
          QuanRelation.SETRANGE("Sub-Estimate No.", QuanHeader."Sub-Estimate No.");
          QuanRelation.SETRANGE("Quantity Sheet", QuanHeader.Code);
          QuanRelation.DELETEALL;
        UNTIL QuanHeader.NEXT = 0;
        QuanHeader.DELETEALL;
      END;
    END;

    PROCEDURE UpdateNormGroup@1100409000();
    VAR
      lvEstPartRec@1100485001 : Record 11072073;
    BEGIN
      //DP00686
      lvEstPartRec.SETRANGE("Estimate No.", "Estimate No.");
      lvEstPartRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      lvEstPartRec.SETFILTER("Norm Group", '%1|%2', '', xRec."Norm Group");
      IF lvEstPartRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          lvEstPartRec.VALIDATE("Norm Group", "Norm Group");
          lvEstPartRec.MODIFY;
        UNTIL lvEstPartRec.NEXT = 0;
      END;
    END;

    PROCEDURE UpdateNormGroupSales@1100525005();
    VAR
      lvEstPartRec@1100485001 : Record 11072073;
    BEGIN
      //DP00686
      lvEstPartRec.SETRANGE("Estimate No.", "Estimate No.");
      lvEstPartRec.SETRANGE("Sub-Estimate No.", "Sub-Estimate No.");
      lvEstPartRec.SETFILTER("Norm Group (Sales)", '%1|%2', '', xRec."Norm Group (Sales)");
      IF lvEstPartRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          lvEstPartRec.VALIDATE("Norm Group (Sales)", "Norm Group (Sales)");
          lvEstPartRec.MODIFY;
        UNTIL lvEstPartRec.NEXT = 0;
      END;
    END;

    PROCEDURE GetPreviousPart@1100528001(JumpLevel@1100528000 : 'Part,Paragraph,Chapter') : Boolean;
    BEGIN
      //DP00909
      SETRANGE("Estimate No.", "Estimate No.");
      IF Level = 0 THEN
        EXIT(NEXT(-1) <> 0);

      CASE JumpLevel OF
        0 : EXIT(NEXT(-1) <> 0);
        1 : BEGIN
              SETRANGE(Chapter, Chapter);
              SETRANGE(Paragraph, Paragraph);
              FINDFIRST;
              SETRANGE(Paragraph);
              IF NEXT(-1) = 0 THEN BEGIN
                SETRANGE(Chapter);
                IF NEXT(-1) = 0 THEN
                  EXIT(TRUE);
                SETRANGE(Chapter, Chapter);
              END;

              SETRANGE(Paragraph, Paragraph);
              EXIT(FINDFIRST);
            END;

        2 : BEGIN
              SETRANGE(Chapter, Chapter);
              FINDFIRST;
              SETRANGE(Chapter);
              IF NEXT(-1) = 0 THEN
                EXIT(TRUE)
              ELSE BEGIN
                SETRANGE(Chapter, Chapter);
                EXIT(FINDFIRST);
              END;
            END;
       END;
    END;

    PROCEDURE GetNextPart@1100528002(JumpLevel@1100528000 : 'Part,Paragraph,Chapter') : Boolean;
    BEGIN
      //DP00909
      SETRANGE("Estimate No.", "Estimate No.");
      IF Level = 0 THEN
        EXIT(NEXT <> 0);

      CASE JumpLevel OF
        0 : EXIT(NEXT <> 0);
        1 : BEGIN
              SETRANGE(Chapter, Chapter);
              SETRANGE(Paragraph, Paragraph);
              FINDLAST;
              SETRANGE(Chapter);
              SETRANGE(Paragraph);
              IF NEXT = 0 THEN;
              EXIT(TRUE);
            END;

        2 : BEGIN
              SETRANGE(Chapter, Chapter);
              FINDLAST;
              SETRANGE(Chapter);
              IF NEXT = 0 THEN;
              EXIT(TRUE)
            END;
      END;
    END;

    PROCEDURE GetStyleExpressionSubEstimateAmount@1100529900() : Boolean;
    BEGIN
      //C036784
      CALCFIELDS("Total Amount");
      EXIT("Total Amount" <> 0);
    END;

    LOCAL PROCEDURE UpdateSalesPricebyHouseModel@1100528903();
    VAR
      SalesPricebyEstimate@1100528900 : Record 11229774;
      RefDate@1100528901 : Date;
    BEGIN
      //DP02089
      SalesPricebyEstimate.SETRANGE("Estimate No.", "Estimate No.");
      IF SalesPricebyEstimate.ISEMPTY THEN BEGIN
        //previously this field was not editable, while Sub-Estimates were generated by available House Models for Estimate after inventory Estimate Lines (Breman)
        //now this field is used also for Sales Price by Model (Sub-Estimate) or Recipe (Estimate Line) for Smit-Electra
        TESTFIELD("House Model", xRec."House Model");
      END;
      //
      IF "House Model" = '' THEN
        "Sales Price (House Model)" := 0;
      //
      EstRec.GET("Estimate No.");
      RefDate := EstRec."Reference Date (Sales Price)";
      //
      SalesPricebyEstimate.SETRANGE("Estimate No.", "Estimate No.");
      SalesPricebyEstimate.SETRANGE("Estimate Type", SalesPricebyEstimate."Estimate Type"::HouseModel);
      SalesPricebyEstimate.SETRANGE("House Model", "House Model");
      SalesPricebyEstimate.SETRANGE("Starting Date", 0D, RefDate);
      SalesPricebyEstimate.SETFILTER("Ending Date", '%1|>=%2', 0D, RefDate);
      IF SalesPricebyEstimate.FINDLAST THEN
        "Sales Price (House Model)" := SalesPricebyEstimate.Price;
    END;

    PROCEDURE CheckFrequencySubEstimateByNumPlots@1100528904(EstimateNo@1100528903 : Code[20];SubEstimateNo@1100528904 : Code[20];UpdateAction@1100528905 : Boolean);
    VAR
      PlotbySubEstimate@1100528901 : Record 11229775;
      SubEstimate@1100528900 : Record 11072074;
      NumPlots@1100528902 : Integer;
    BEGIN
      //DP02088
      PlotbySubEstimate.SETRANGE("Estimate No.", EstimateNo);
      PlotbySubEstimate.SETRANGE("Sub-Estimate No.", SubEstimateNo);
      NumPlots := PlotbySubEstimate.COUNT;
      //
      IF NumPlots <> 0 THEN BEGIN
        IF UpdateAction THEN BEGIN
          SubEstimate.GET(EstimateNo, SubEstimateNo);
          SubEstimate.VALIDATE(Frequency, NumPlots);
          SubEstimate.MODIFY;
        END ELSE BEGIN
          TESTFIELD(Frequency, NumPlots);
        END;
      END;
    END;

    PROCEDURE GetDisciplineByElement@1100528920();
    VAR
      BaseElement@1100528900 : Record 11012060;
      ProjectElement@1100528901 : Record 11012010;
    BEGIN
      //DP02460
      IF Element = '' THEN EXIT;
      IF "Project No." <> '' THEN BEGIN
        IF NOT ProjectElement.GET("Project No.", Element) THEN ProjectElement.INIT;
        IF ProjectElement.Discipline <> '' THEN
          Discipline := ProjectElement.Discipline;
      END ELSE BEGIN
        IF NOT BaseElement.GET(Element) THEN BaseElement.INIT;
        IF BaseElement.Discipline <> '' THEN
          Discipline := BaseElement.Discipline;
      END;
    END;

    PROCEDURE InheritFromParentLevel@1100528905();
    VAR
      AssignValue@1100528900 : Boolean;
      SubEstimate@1100528901 : Record 11072074;
    BEGIN
      //DP02460
      IF Level = 1 THEN
        IF SubEstimate.GET("Estimate No.", Chapter) THEN
          AssignValue := TRUE;
      IF Level = 2 THEN
        IF SubEstimate.GET("Estimate No.", Paragraph) THEN
          AssignValue := TRUE;
      IF AssignValue THEN BEGIN
        IF SubEstimate."Project No." <> '' THEN
          "Project No." := SubEstimate."Project No.";
        IF SubEstimate."Project Planning Activity Code" <> '' THEN
          "Project Planning Activity Code" := SubEstimate."Project Planning Activity Code";
        IF SubEstimate.Element <> '' THEN
          Element := SubEstimate.Element;
        IF SubEstimate.Discipline <> '' THEN
          Discipline := SubEstimate.Discipline;
        IF SubEstimate."Rate Code" <> '' THEN
          "Rate Code" := SubEstimate."Rate Code";
        IF SubEstimate."Recipe Group" <> '' THEN
          "Recipe Group" := SubEstimate."Recipe Group";
        IF SubEstimate."Norm Group" <> '' THEN
          "Norm Group" := SubEstimate."Norm Group";
        IF SubEstimate."Norm Group (Sales)" <> '' THEN
          "Norm Group (Sales)" := SubEstimate."Norm Group (Sales)";
      END;
    END;

    BEGIN
    {
      4PS01 HBK 06-08-09: Field added "Language Code"
    }
    END.
  }
}

