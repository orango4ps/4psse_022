OBJECT Page 12057127 ExFlow Setup Wizard
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF513000;
  }
  PROPERTIES
  {
    CaptionML=[ENU=ExFlow Setup Wizard;
               SVE=ExFlow Setup Wizard];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table12057114;
    PageType=NavigatePage;
    UsageCategory=Administration;
    SourceTableTemporary=Yes;
    ShowFilter=No;
    OnInit=BEGIN
             IF NOT GET THEN BEGIN
               INIT;
               SetDefaultValues;
               INSERT;
             END;
             NAV2017support := ExFlowAssistedSetup.NAV2017FeaturesSupported;
           END;

    OnOpenPage=VAR
                 OpenPageTxt@1100285000 : TextConst '@@@=%1 is the page that will be opened when clicking the control;ENU=Open %1;SVE=™ppna %1';
                 SMTPSetup@1000 : Page 409;
               BEGIN
                 ShowIntroStep;
                 LinkToSMTPSetup := STRSUBSTNO(OpenPageTxt,SMTPSetup.CAPTION);
                 LinkToURL:= AddInsLink;
                 ImportRSOXSLT:=TXT014;
                 OpenEmailSetupWizard:=TXT015;
               END;

    ActionList=ACTIONS
    {
      { 8       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 15      ;1   ;Action    ;
                      Name=Back;
                      CaptionML=[ENU=Back;
                                 SVE=Bak†t];
                      ApplicationArea=#Suite;
                      Enabled=BackEnabled;
                      InFooterBar=Yes;
                      Image=PreviousRecord;
                      OnAction=BEGIN
                                 NextStep(TRUE);
                               END;
                                }
      { 14      ;1   ;Action    ;
                      Name=Next;
                      CaptionML=[ENU=Next;
                                 SVE=N„sta];
                      ApplicationArea=#Suite;
                      Enabled=NextEnabled;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 NextStep(FALSE);
                               END;
                                }
      { 9       ;1   ;Action    ;
                      Name=Finish;
                      CaptionML=[ENU=Finish;
                                 SVE=Slutf”r];
                      ApplicationArea=#Suite;
                      Enabled=FinishEnabled;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=VAR
                                 ExFlowAssistedSetup@1001 : Codeunit 12057128;
                               BEGIN
                                 ExFlowAssistedSetup.ApplyUserSelection(Rec);
                                 MESSAGE(TXT017);
                                 CurrPage.CLOSE;
                               END;
                                }
      { 1100285021;1 ;Action    ;
                      Name=Refresh SMTP Warning Message;
                      CaptionML=[ENU=Refresh SMTP Warning Message;
                                 SVE=Uppdatera SMTP varningsmeddelande];
                      Promoted=Yes;
                      Visible=RefreshSMTPWarningMessageVisable;
                      Image=Refresh;
                      OnAction=BEGIN
                                 EmailSetupWarningMessage;
                               END;
                                }
      { 1100285028;1 ;Action    ;
                      Name=Default Root Folder Settings;
                      CaptionML=[ENU=Default Root Folder Path Settings;
                                 SVE=Standard Rotkatalogs S”kv„gs Inst„llningar];
                      Promoted=Yes;
                      Visible=RootPathDefaultValuesVisable;
                      Enabled=RootFolderActionsEnabled;
                      Image=Default;
                      OnAction=BEGIN
                                 SetDefaultRootFolderValues;
                               END;
                                }
      { 1100285029;1 ;Action    ;
                      Name=Clear All Folder Path Settings;
                      CaptionML=[ENU=Clear All Folder Path Settings;
                                 SVE=Rensa alla mappv„gsinst„llningar];
                      Promoted=Yes;
                      Visible=RootPathDefaultValuesVisable;
                      Enabled=RootFolderActionsEnabled;
                      Image=Delete;
                      OnAction=BEGIN
                                 ClearAllFolderPahtSettings;
                               END;
                                }
      { 1100285115;1 ;Action    ;
                      Name=ActionDownloadTemplate;
                      CaptionML=[ENU=Download Template;
                                 SVE=Ladda ned mall];
                      Promoted=Yes;
                      Visible=ImportExFlowUsersVisable;
                      Image=Table;
                      OnAction=VAR
                                 ExFLowAssistedSetup3@1100285001 : Codeunit 12057130;
                               BEGIN
                                 ExFLowAssistedSetup3.ExportExcelTemplate;
                               END;
                                }
      { 1100285116;1 ;Action    ;
                      Name=ActionUploadExcelFile;
                      CaptionML=[ENU=Upload Excel File;
                                 SVE=Ladda upp Excelfil];
                      Promoted=Yes;
                      Visible=ImportExFlowUsersVisable;
                      Image=ImportExcel;
                      OnAction=VAR
                                 ExFLowAssistedSetup3@1100285000 : Codeunit 12057130;
                               BEGIN
                                 IF ExFLowAssistedSetup3.ImportExcelData THEN BEGIN
                                   ApplySetupEnabled:=TRUE;
                                   "Apply Package":=TRUE;
                                 END ELSE BEGIN
                                    ApplySetupEnabled:=FALSE;
                                   "Apply Package":=FALSE;
                                 END;
                               END;
                                }
      { 1100285146;1 ;Action    ;
                      Name=DefaultCompanyRSOSetting;
                      CaptionML=[ENU=Copy RSO settings from default company;
                                 SVE=Kopiera RSO-inst„llningar fr†n standardf”retaget];
                      Promoted=Yes;
                      Visible=CopyRSOSettingsVisable;
                      Enabled=RSOSettingsEnabled;
                      Image=Copy;
                      OnAction=VAR
                                 WebCompanyID@1100285002 : Record 12013630;
                                 ExFlowSetup@1100285001 : Record 12013601;
                                 DefaultComapny@1100285000 : Text[100];
                               BEGIN
                                 WebCompanyID.SETRANGE("Default Company",TRUE);
                                 IF WebCompanyID.FINDFIRST THEN BEGIN
                                   DefaultComapny:=WebCompanyID."Company Name";
                                   ExFlowSetup.CHANGECOMPANY(DefaultComapny);
                                   ExFlowSetup.GET;
                                   "Readsoft Online integration":=ExFlowSetup."Readsoft Online integration";
                                   "RO Connect User":= ExFlowSetup."RO Connect User";
                                   "RO Connect Password":=ExFlowSetup."RO Connect Password";
                                   "RO Buyer Name":='';
                                   "Upload vendors to RO":=ExFlowSetup."Upload vendors to RO";
                                   "Upload references to RO":=ExFlowSetup."Upload references to RO";
                                   "Customized RO ApiKey":=ExFlowSetup."Customized RO ApiKey";
                                 END;
                               END;
                                }
      { 1100285147;1 ;Action    ;
                      Name=ClearRSOSettings;
                      CaptionML=[ENU=Clear RSO Settings;
                                 SVE=Rensa RSO-inst„llningarna];
                      Promoted=Yes;
                      Visible=ClearRSOSettingVisable;
                      Enabled=RSOSettingsEnabled;
                      Image=ClearFilter;
                      OnAction=BEGIN
                                 "Readsoft Online integration":=FALSE;
                                 "RO Connect User":= '';
                                 "RO Connect Password":='';
                                 "RO Buyer Name":='';
                                 "Upload vendors to RO":=FALSE;
                                 "Upload references to RO":=FALSE;
                                 "Customized RO ApiKey":='';
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 11  ;1   ;Group     ;
                Name=Step1;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=IntroVisible;
                GroupType=Group }

    { 18  ;2   ;Group     ;
                Name=Para1.1;
                CaptionML=[ENU=Welcome to the ExFlow Setup Wizard;
                           SVE=V„lkommen till ExFlows inst„llningsguide];
                GroupType=Group;
                InstructionalTextML=[ENU=Choose type of setup and then click next to start the ExFlow Setup Wizard;
                                     SVE=V„lj typ av inst„llning och klicka sedan p† n„sta f”r att starta inst„llningsguiden f”r ExFlow] }

    { 1100285121;3;Field  ;
                Name=TypeOfSetUp;
                SourceExpr="Type of Setup" }

    { 1100285133;3;Field  ;
                DrillDown=Yes;
                CaptionML=[ENU=Current Default Company;
                           SVE=Nuvarande standardf”retag];
                SourceExpr=ExFlowDefaultCompany;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              PAGE.RUNMODAL(PAGE::"Web Company ID");
                            END;
                             }

    { 1100285123;3;Field  ;
                CaptionML=[ENU=Link to ExFlow Add-ins;
                           SVE=L„nk till ExFlow kontrolltill„gg] }

    { 1100285122;3;Field  ;
                Name=LinkToURL;
                DrillDown=Yes;
                CaptionML=ENU=LinkToURL;
                SourceExpr=LinkToURL;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              HYPERLINK(AddInsLink);
                            END;

                ShowCaption=No }

    { 2   ;1   ;Group     ;
                Name=Step2;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=DefaultCompanyInitVisible;
                GroupType=Group }

    { 1100285104;2;Group  ;
                Name=1GridLayoutGoop1;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285105;3;Group  ;
                Name=1GridLayout;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout }

    { 1100285106;4;Group  ;
                Name=1GridLayoutGoop2;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 22  ;5   ;Group     ;
                Name=Para2.1;
                CaptionML=[ENU=Default Company:;
                           SVE=Standardf”retag:];
                GroupType=Group }

    { 1100285134;6;Field  ;
                Name=ExFlowDefaultCompany2;
                DrillDown=Yes;
                CaptionML=[ENU=Current Default Company;
                           SVE=Nuvarande standardf”retag];
                SourceExpr=ExFlowDefaultCompany;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              PAGE.RUNMODAL(PAGE::"Web Company ID");
                            END;
                             }

    { 1100285000;6;Field  ;
                SourceExpr="Create as default Company";
                OnValidate=BEGIN
                             IF "Create as default Company" THEN BEGIN
                               "Create ExFlow WEB Service" := TRUE;
                               "Create ExFlow Job Queue" := TRUE;
                               "ExF Web User Level Permissions":= TRUE;
                               "ExFlow Permission Roles":= TRUE;
                             END ELSE BEGIN
                               "Create ExFlow WEB Service" := FALSE;
                               "Create ExFlow Job Queue" := FALSE;
                               "ExF Web User Level Permissions":= FALSE;
                               "ExFlow Permission Roles":= FALSE;
                             END;
                           END;
                            }

    { 1100285039;6;Group  ;
                Name=2GridLayoutGroop1;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285040;7;Group  ;
                Name=2GridLayout;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Columns }

    { 1100285103;8;Group  ;
                Name=2GridLayoutGroop2;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285003;9;Group  ;
                Name=Para2.2;
                CaptionML=[ENU=Settings for default web company:;
                           SVE=Inst„llningar f”r standard webbf”retag:];
                GroupType=Group }

    { 1100285002;10;Field ;
                SourceExpr="Create ExFlow WEB Service" }

    { 1100285001;10;Field ;
                SourceExpr="Create ExFlow Job Queue" }

    { 1100285107;9;Group  ;
                Name=Para2.3;
                CaptionML=[ENU=Permissions:;
                           SVE=Beh”righeter:];
                GroupType=Group }

    { 1100285030;10;Field ;
                SourceExpr="ExF Web User Level Permissions" }

    { 1100285031;10;Field ;
                SourceExpr="ExFlow Permission Roles" }

    { 1100285119;9;Group  ;
                Name=Para2.5;
                GroupType=Group }

    { 1100285124;1;Group  ;
                Name=Step3;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=AddInsVisable;
                GroupType=Group }

    { 1100285125;2;Group  ;
                GroupType=GridLayout }

    { 1100285129;3;Group  ;
                GroupType=Group }

    { 1100285130;4;Group  ;
                CaptionML=[ENU=Add-Ins:;
                           SVE=Kontrolltill„gg];
                GroupType=Group }

    { 1100285127;5;Field  ;
                CaptionML=[ENU=Link to ExFlow Add-ins;
                           SVE=L„nk till ExFlow kontrolltill„gg];
                ShowCaption=No }

    { 1100285126;5;Field  ;
                Name=LinkToURL1;
                DrillDown=Yes;
                CaptionML=ENU=LinkToURL;
                SourceExpr=LinkToURL;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              HYPERLINK(AddInsLink);
                            END;

                ShowCaption=No }

    { 1100285128;5;Field  ;
                SourceExpr="Initialize all Add Ins" }

    { 1100285102;5;Field  ;
                Name=PDFPrev;
                CaptionML=[ENU=Import PDF Preview Component;
                           SVE=Importera PDF-komponent];
                SourceExpr="PDF Preview".HASVALUE;
                OnAssistEdit=BEGIN
                               VALIDATE("PDF Preview");
                             END;
                              }

    { 1100285138;5;Field  ;
                Name=ROXSLT;
                CaptionML=[ENU=Import RSO XSLT;
                           SVE=Importera RSO XSLT];
                SourceExpr="RO XSLT".HASVALUE;
                OnAssistEdit=BEGIN
                               VALIDATE("RO XSLT");
                             END;
                              }

    { 1100285137;5;Field  ;
                Name=EmailTemplate;
                CaptionML=[ENU=Import E-mail Template;
                           SVE=Importera E-postmall];
                SourceExpr="HTML Template File".HASVALUE;
                OnAssistEdit=BEGIN
                               VALIDATE("HTML Template File");
                             END;
                              }

    { 1100285020;1;Group  ;
                Name=Step4;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=EmailSetupVisible;
                GroupType=Group }

    { 1100285019;2;Group  ;
                Name=Para4.1;
                CaptionML=[ENU=E-mail Setup:;
                           SVE=E-postinst„llningar:];
                GroupType=Group }

    { 1100285018;3;Field  ;
                SourceExpr="Create Default Email Job";
                OnValidate=BEGIN
                             IF "Create Default Email Job" = TRUE THEN
                                EmailSettingsVisable :=TRUE
                             ELSE
                               EmailSettingsVisable:= FALSE;
                           END;
                            }

    { 1100285017;3;Group  ;
                Name=Para4.2;
                CaptionML=[ENU=Default E-mail Settings:;
                           SVE=Standard E-postinst„llningar:];
                Visible=EmailSettingsVisable;
                GroupType=Group }

    { 1100285016;4;Field  ;
                SourceExpr="Email Subject" }

    { 1100285015;4;Field  ;
                SourceExpr="Sender Name" }

    { 1100285011;4;Field  ;
                SourceExpr="Sender Email" }

    { 1100285012;4;Field  ;
                SourceExpr="ExFlow Web URL" }

    { 1100285101;4;Field  ;
                Name=EmailTemplate2;
                CaptionML=[ENU=Import E-mail Template;
                           SVE=Importera E-postmall];
                SourceExpr="HTML Template File".HASVALUE;
                OnAssistEdit=BEGIN
                               VALIDATE("HTML Template File");
                             END;
                              }

    { 1100285010;3;Group  ;
                Name=Para4.4;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=TestSMTPConnectionMessageVisible;
                GroupType=Group }

    { 1100285009;4;Field  ;
                Name=TestSMTPConnectionMessage;
                CaptionML=[ENU=Warning: the SMTP Setup is not complete. Please open the SMTP settings and fill the required information.;
                           SVE=Varning: SMTP-inst„llningarna „r inte fullst„ndiga. V„nligen ”ppna SMTP-inst„llningarna och fyll i n”dv„ndig information.];
                Editable=FALSE;
                Style=Strong;
                StyleExpr=TRUE }

    { 1100285008;3;Group  ;
                Name=Para4.5;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285006;4;Field  ;
                Name=Open SMTP Setup;
                CaptionML=[ENU=Open SMTP Setup;
                           SVE=™ppna SMTP-postinst„llning];
                SourceExpr=LinkToSMTPSetup;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              PAGE.RUNMODAL(PAGE::"SMTP Mail Setup");
                            END;

                ShowCaption=No }

    { 1100285032;1;Group  ;
                Name=Step 5;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=InitializeCompanyVisable;
                GroupType=Group }

    { 1100285059;2;Group  ;
                GroupType=Group }

    { 1100285004;3;Field  ;
                SourceExpr="Activate Web";
                Visible=DefaultCompanyInitVisible }

    { 1100285109;3;Field  ;
                SourceExpr="Predefined account" }

    { 1100285060;2;Group  ;
                Name=5GridLayout;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group;
                Layout=Rows }

    { 1100285057;3;Group  ;
                Name=5GridLayoutGroop2;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285108;3;Group  ;
                Name=Para2.4;
                CaptionML=[ENU=Columns:;
                           SVE=Kolumner:];
                GroupType=Group }

    { 1100285036;4;Field  ;
                SourceExpr="Line Type G/L Account";
                Editable=UseColumnsEditble }

    { 1100285037;4;Field  ;
                SourceExpr="Line Type Item";
                Editable=UseColumnsEditble }

    { 1100285035;4;Field  ;
                SourceExpr="Line Type Fixed Asset";
                Editable=UseColumnsEditble }

    { 1100285033;4;Field  ;
                SourceExpr="Line Type Item Charge";
                Editable=UseColumnsEditble }

    { 1100285034;3;Group  ;
                Name=Para5.2;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285117;4;Group  ;
                GroupType=Group }

    { 1100285041;5;Field  ;
                SourceExpr="Use Jobs";
                Editable=UseColumnsEditble }

    { 1100285131;4;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285042;5;Field  ;
                SourceExpr="Use Deferral Code";
                Editable=UseColumnsEditble }

    { 1100285061;5;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285062;6;Group  ;
                Name=GridLayout;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Rows }

    { 1100285063;7;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285064;8;Group  ;
                Name=SubGroop1;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285043;9;Field  ;
                SourceExpr="Use Shortcut Dimension 1 Code";
                Editable=UseColumnsEditble }

    { 1100285065;8;Group  ;
                Name=SubGroop2;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285044;9;Field  ;
                CaptionML=[ENU="ENU=Dim1;SVE=Dim1"];
                SourceExpr=GetShortCutCode(Rec,1);
                TableRelation=Dimension;
                ShowCaption=No }

    { 1100285068;5;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285067;6;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Rows }

    { 1100285066;7;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285069;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285045;9;Field  ;
                SourceExpr="Use Shortcut Dimension 2 Code";
                Editable=UseColumnsEditble }

    { 1100285070;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285046;9;Field  ;
                CaptionML=[ENU=Dim2;
                           SVE=Dim2];
                SourceExpr=GetShortCutCode(Rec,2);
                TableRelation=Dimension;
                ShowCaption=No }

    { 1100285073;5;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285072;6;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Rows }

    { 1100285071;7;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285089;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285047;9;Field  ;
                SourceExpr="Use Shortcut Dimension 3 Code";
                Editable=UseColumnsEditble }

    { 1100285090;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285048;9;Field  ;
                CaptionML=[ENU=Dim3;
                           SVE=Dim3];
                SourceExpr=GetShortCutCode(Rec,3);
                TableRelation=Dimension;
                ShowCaption=No }

    { 1100285076;5;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285075;6;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Rows }

    { 1100285074;7;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285091;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285050;9;Field  ;
                SourceExpr="Use Shortcut Dimension 4 Code";
                Editable=UseColumnsEditble }

    { 1100285092;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285049;9;Field  ;
                CaptionML=[ENU=Dim4;
                           SVE=Dim4];
                SourceExpr=GetShortCutCode(Rec,4);
                TableRelation=Dimension;
                ShowCaption=No }

    { 1100285079;5;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285078;6;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Rows }

    { 1100285077;7;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285093;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285051;9;Field  ;
                SourceExpr="Use Shortcut Dimension 5 Code";
                Editable=UseColumnsEditble;
                ShowCaption=Yes }

    { 1100285094;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285055;9;Field  ;
                CaptionML=[ENU=Dim5;
                           SVE=Dim5];
                SourceExpr=GetShortCutCode(Rec,5);
                TableRelation=Dimension;
                ShowCaption=No }

    { 1100285082;5;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285081;6;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Rows }

    { 1100285080;7;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285095;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285052;9;Field  ;
                SourceExpr="Use Shortcut Dimension 6 Code";
                Editable=UseColumnsEditble }

    { 1100285096;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285056;9;Field  ;
                CaptionML=[ENU=Dim6;
                           SVE=Dim6];
                SourceExpr=GetShortCutCode(Rec,6);
                TableRelation=Dimension;
                ShowCaption=No }

    { 1100285085;5;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285084;6;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Rows }

    { 1100285083;7;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285097;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285053;9;Field  ;
                SourceExpr="Use Shortcut Dimension 7 Code";
                Editable=UseColumnsEditble }

    { 1100285098;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285120;9;Field  ;
                CaptionML=[ENU=Dim7;
                           SVE=Dim7];
                SourceExpr=GetShortCutCode(Rec,7);
                TableRelation=Dimension;
                ShowCaption=No }

    { 1100285088;5;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285087;6;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=GridLayout;
                Layout=Rows }

    { 1100285086;7;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285099;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285054;9;Field  ;
                SourceExpr="Use Shortcut Dimension 8 Code";
                Editable=UseColumnsEditble }

    { 1100285100;8;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285058;9;Field  ;
                CaptionML=[ENU=Dim8;
                           SVE=Dim8];
                SourceExpr=GetShortCutCode(Rec,8);
                TableRelation=Dimension;
                ShowCaption=No }

    { 1100285151;1;Group  ;
                Name=Step6;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=POandRequisitionVisable;
                GroupType=Group }

    { 1100285152;2;Group  ;
                CaptionML=[ENU=PO and Requisition Setup:;
                           SVE=PO and Requisition Setup:];
                GroupType=Group }

    { 1100285153;3;Field  ;
                SourceExpr="Purchase Order Matching";
                OnValidate=BEGIN
                             //>>1375
                             IF "Purchase Order Matching" = TRUE THEN
                               PurchaseOrderOptionsVisable:=TRUE
                             ELSE
                               PurchaseOrderOptionsVisable:=FALSE;
                             //<<1375
                           END;
                            }

    { 1100285154;3;Group  ;
                Name=Options:;
                CaptionML=[ENU=Options:;
                           SVE=Alternativ:];
                Visible=PurchaseOrderOptionsVisable;
                GroupType=Group }

    { 1100285155;4;Field  ;
                SourceExpr="Allowed Price Diff (%)" }

    { 1100285156;4;Field  ;
                SourceExpr="Allowed Price Diff (LCY)" }

    { 1100285157;3;Field  ;
                SourceExpr="Purchase Order Approval" }

    { 1100285158;3;Field  ;
                SourceExpr="Use Requisition" }

    { 1100285110;1;Group  ;
                Name=Step7;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=ImportExFlowUsersVisable;
                GroupType=Group }

    { 1100285112;2;Group  ;
                CaptionML=[ENU=ExFlow User Setup:;
                           SVE=ExFlow Anv„ndarinst„llningar:];
                GroupType=Group }

    { 1100285111;3;Field  ;
                CaptionML=[ENU=1) Download the Excel template.;
                           SVE=1) Ladda ned Excel-mallen.] }

    { 1100285113;3;Field  ;
                CaptionML=[ENU=2) Fill in the template with your data.;
                           SVE=2) Fyll i mallen med din data.] }

    { 1100285114;3;Field  ;
                CaptionML=[ENU=3) "Upload Excel" File with the new data;
                           SVE=3) V„lj "Ladda upp Excelfil" med den nya datan] }

    { 1100285118;3;Field  ;
                SourceExpr="Apply Package";
                Enabled=ApplySetupEnabled }

    { 1100285132;1;Group  ;
                Name=Step8;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=RSOSetupVisable;
                GroupType=Group }

    { 1100285005;2;Group  ;
                CaptionML=[ENU=ReadSoft Online Setup:;
                           SVE=ReadSoft Online Inst„llningar:];
                GroupType=Group }

    { 1100285135;3;Field  ;
                CaptionML=[ENU=Create setup for ReadSoft Online:;
                           SVE=Skapa setup f”r ReadSoft Online:];
                SourceExpr="RSO Setup";
                OnValidate=BEGIN
                             IF "RSO Setup" = TRUE THEN BEGIN
                               RSOSettingsVisable:= TRUE;
                               RSOSettingsEnabled:=TRUE;
                             END ELSE BEGIN
                               RSOSettingsVisable:=FALSE;
                               RSOSettingsEnabled:=FALSE;
                             END;
                           END;
                            }

    { 1100285136;3;Group  ;
                Visible=RSOSettingsVisable;
                GroupType=Group }

    { 1100285139;4;Field  ;
                SourceExpr="Readsoft Online integration" }

    { 1100285148;4;Field  ;
                Name=ROXSLT2;
                CaptionML=[ENU=Import RSO XSLT;
                           SVE=Importera RSO XSLT];
                SourceExpr="RO XSLT".HASVALUE;
                OnAssistEdit=BEGIN
                               VALIDATE("RO XSLT");
                             END;
                              }

    { 1100285140;4;Field  ;
                SourceExpr="RO Connect User" }

    { 1100285141;4;Field  ;
                SourceExpr="RO Connect Password" }

    { 1100285142;4;Field  ;
                SourceExpr="RO Buyer Name" }

    { 1100285143;4;Field  ;
                SourceExpr="Upload vendors to RO" }

    { 1100285144;4;Field  ;
                SourceExpr="Upload references to RO" }

    { 1100285145;4;Field  ;
                SourceExpr="Customized RO ApiKey" }

    { 1100285150;4;Field  ;
                SourceExpr="RO Service URL" }

    { 1100285038;1;Group  ;
                Name=Step9;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=CreateRootFolderVisible;
                GroupType=Group }

    { 1100285007;2;Group  ;
                CaptionML=[ENU="";
                           SVE=""];
                GroupType=Group }

    { 1100285013;3;Field  ;
                SourceExpr="File storage type";
                OnValidate=BEGIN
                             IF "File storage type"="File storage type"::Filesystem THEN BEGIN
                                 CreateDefaultRootFolderEnabled := TRUE;
                                 "Create Default Root Folder":=TRUE;
                                 IF ExFlowSetup."Path to Used Invoices" = '' THEN BEGIN
                                   SetDefaultRootFolderValues;
                                   RootFolderAndSubfoldersVisable:= TRUE;
                                   RootFolderActionsEnabled:= TRUE;
                                   "Create Default Root Folder" := TRUE;
                                 END;
                               END ELSE BEGIN
                                 CreateDefaultRootFolderEnabled := FALSE;
                                 "Create Default Root Folder":=FALSE;
                               END;

                             IF "Create Default Root Folder"= TRUE THEN BEGIN
                               RootFolderAndSubfoldersVisable:= TRUE;
                               RootFolderActionsEnabled:= TRUE;
                             END ELSE BEGIN
                               RootFolderAndSubfoldersVisable:= FALSE;
                               RootFolderActionsEnabled:=FALSE;
                             END;
                           END;
                            }

    { 1100285027;2;Group  ;
                Name=Para9.1;
                CaptionML=[ENU=Default Root Folder and Subfolders;
                           SVE=Standard rotmapp och undermappar];
                GroupType=Group }

    { 1100285026;3;Field  ;
                SourceExpr="Create Default Root Folder";
                Enabled=CreateDefaultRootFolderEnabled;
                OnValidate=BEGIN
                             IF "Create Default Root Folder"= TRUE THEN BEGIN
                               RootFolderAndSubfoldersVisable:= TRUE;
                               RootFolderActionsEnabled:= TRUE;
                             END ELSE BEGIN
                               RootFolderAndSubfoldersVisable:= FALSE;
                               RootFolderActionsEnabled:=FALSE;
                             END;
                           END;
                            }

    { 1100285025;3;Group  ;
                Name=Para9.2;
                CaptionML=[ENU=Create root folder and subfolders:;
                           SVE=Skapa rotmapp och undermappar:];
                Visible=RootFolderAndSubfoldersVisable;
                GroupType=Group;
                InstructionalTextML=[ENU=(Ask your admin to create the root folder with the required permissions);
                                     SVE=(Be din administrat”r att skapa rotmappen med n”dv„ndiga beh”righeter)] }

    { 1100285024;4;Field  ;
                AssistEdit=No;
                SourceExpr="Main Folder Path";
                OnValidate=BEGIN
                             SetDefaultMainAndSubFolderPaths;

                             DeleteEndingSlash("Main Folder Path");
                           END;
                            }

    { 1100285023;4;Field  ;
                SourceExpr="Path To New invoices";
                Editable=False }

    { 1100285022;4;Field  ;
                SourceExpr="Path To Processed Invoices";
                Editable=False }

    { 1100285014;4;Field  ;
                SourceExpr="Path To New OCR";
                Editable=False }

    { 1100285149;4;Field  ;
                SourceExpr="Path to Deleted Documents";
                Editable=False }

    { 10  ;1   ;Group     ;
                Name=Step10;
                CaptionML=[ENU="";
                           SVE=""];
                Visible=DoneVisible;
                GroupType=Group }

    { 25  ;2   ;Group     ;
                Name=Para10.1;
                CaptionML=[ENU=That's it!;
                           SVE=Klart!];
                GroupType=Group;
                InstructionalTextML=[ENU=Choose Finish to enable the selected ExFlow settings.;
                                     SVE=V„lj slutf”r f”r att aktivera de valda ExFlow-inst„llningarna.] }

  }
  CODE
  {
    VAR
      ExFlowSetup@1100285008 : Record 12013601;
      ExFlowFileMgt@1100285040 : Codeunit 12013602;
      ExFlowAssistedSetup@1100285032 : Codeunit 12057128;
      NAV2017support@1100285035 : Boolean;
      BackEnabled@1014 : Boolean;
      NextEnabled@1013 : Boolean;
      FinishEnabled@1010 : Boolean;
      IntroVisible@1009 : Boolean;
      DefaultCompanyInitVisible@1008 : Boolean;
      PublishWebServiceVisible@1017 : Boolean;
      CreateSMTPVisible@1011 : Boolean;
      CreateExFlowEmailVisible@1003 : Boolean;
      CreateRootFolderDetailsVisible@1006 : Boolean;
      CreateJobsVisible@1100285000 : Boolean;
      AllCompanyVisible@1100285001 : Boolean;
      DoneVisible@1004 : Boolean;
      CreateRootFolderVisible@1100285003 : Boolean;
      EmailSetupVisible@1100285004 : Boolean;
      EmailSettingsVisable@1100285005 : Boolean;
      ImportExFlowUsersVisable@1100285041 : Boolean;
      TXT001@1100285009 : TextConst 'ENU=Documents for approval;SVE=Dokument att godk„nna';
      TXT002@1100285010 : TextConst 'ENU=ExFlow;SVE=ExFlow';
      TXT003@1100285011 : TextConst 'ENU=noreply-exflow@yourdomain.com;SVE=noreply-exflow@yourdomain.com';
      TXT004@1100285012 : TextConst 'ENU=http://askyouradmin;SVE=http://fr†gadinadministrat”r';
      TestSMTPConnectionMessageVisible@1100285013 : Boolean INDATASET;
      RefreshSMTPWarningMessageVisable@1100285015 : Boolean;
      RootFolderAndSubfoldersVisable@1100285016 : Boolean;
      TXT005@1100285017 : TextConst 'ENU=\%1\Scanned;SVE=\%1\Scanned';
      TXT006@1100285018 : TextConst 'ENU=\%1\Archive;SVE=\%1\Archive';
      TXT007@1100285019 : TextConst 'ENU=\%1\OCR;SVE=\%1\OCR';
      TXT008@1100285021 : TextConst 'ENU=\%1\Deleted;SVE=\%1\Deleted';
      TXT011@1100285023 : TextConst 'ENU=\\FileServerName\ScannedInvoices;SVE=\\FileServerName\ScannedInvoices';
      RootPathDefaultValuesVisable@1100285025 : Boolean;
      RootFolderActionsEnabled@1100285027 : Boolean INDATASET;
      TXT012@1100285028 : TextConst 'ENU=Warning, the root folder does not exist. Folder creation will be inactivated.;SVE=Varning, rotmappen existerar ej. Mapp upps„ttning kommer att avaktiveras.';
      InitializeCompanyVisable@1100285029 : Boolean;
      AddInsLink@1100285048 : TextConst 'ENU=http://exflownavaddins.signup.se/download/ExFlowNAVAddIns.zip;SVE=http://exflownavaddins.signup.se/download/ExFlowNAVAddIns.zip';
      POandRequisitionVisable@1100285022 : Boolean;
      AddInsVisable@1100285051 : Boolean;
      TXT014@1100285056 : TextConst 'ENU=Import RSO XSLT;SVE=Importera RSO XSLT';
      TXT015@1100285059 : TextConst 'ENU=Run the Email Setup Wizard;SVE=K”r Email Setup Wizard';
      TXT016@1100285047 : TextConst 'ENU=Warning, a shared folder must be used for ExFlow folders. Root folder setup will be inactivated;SVE=Varning, en delad mapp m†ste anv„ndas f”r ExFlow mappar. Inga mappar kommer att skapas';
      RSOSetupVisable@1100285002 : Boolean;
      RSOSettingsVisable@1100285006 : Boolean;
      UseColumnsEditble@1100285033 : Boolean;
      TXT017@1100285037 : TextConst 'ENU=Setup successfully applied;SVE=Inst„llingarna har sparats';
      CreateDefaultRootFolderEnabled@1100285038 : Boolean;
      ApplySetupEnabled@1100285042 : Boolean;
      Step@1100285043 : 'Intro,Default Company,Add Ins,Email Setup,Initialize Company,PO and Requisition Setup,Import ExFlow Users,RSO Setup,Default Root Folder,Done';
      LinkToSMTPSetup@1100285049 : Text;
      MainPath@1100285046 : Text[200];
      LinkToURL@1100285045 : Text;
      ImportRSOXSLT@1100285044 : Text;
      OpenEmailSetupWizard@1100285039 : Text;
      ExFlowDefaultCompany@1100285024 : Text;
      CopyRSOSettingsVisable@1100285007 : Boolean;
      ClearRSOSettingVisable@1100285014 : Boolean;
      RSOSettingsEnabled@1100285020 : Boolean;
      PurchaseOrderOptionsVisable@1100285026 : Boolean;

    LOCAL PROCEDURE NextStep@3(Backwards@1000 : Boolean);
    BEGIN
      IF Backwards THEN BEGIN
        IF ("Type of Setup"="Type of Setup"::Initialize) AND (Step = Step::"Initialize Company") THEN
          Step := Step::Intro
        ELSE IF (Step = Step::"Default Root Folder") AND (NOT NAV2017support) THEN
          Step := Step::"Initialize Company"
        ELSE
          Step := Step - 1
      END ELSE BEGIN
        IF "Type of Setup" = "Type of Setup"::Copy THEN BEGIN
          PAGE.RUN(PAGE::"Copy ExFlow Setup");
          CurrPage.CLOSE;
        END;

        IF Step = Step::"Default Root Folder" THEN
          CheckRootFolder;

        IF ("Type of Setup"="Type of Setup"::Initialize) AND (Step = Step::Intro) THEN
           Step:=Step::"Initialize Company"
        ELSE IF (Step = Step::"Initialize Company") AND (NOT NAV2017support) THEN
          Step := Step::"Default Root Folder"
        ELSE
          Step := Step + 1;
      END;

      CASE Step OF
        Step::Intro:
          ShowIntroStep;
        Step::"Default Company" :
          CreateDetaultStep;
        Step::"Add Ins":
          AddIns;
        Step::"Email Setup":
         EmailSetup;
        //Step for PO and Requizition should be here
        Step::"PO and Requisition Setup":
          POandRequisition;
        Step::"Initialize Company":
          InitializeCompany;
        Step::"Import ExFlow Users":
          ImportExFlowUsers;
        Step::"RSO Setup":
          RSOSetup;
        Step::"Default Root Folder":
          DefaultRootFolder;
        Step::Done:
          ShowDoneStep;
      END;
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ShowIntroStep@1();
    BEGIN
      ResetWizardControls;
      IntroVisible := TRUE;
      BackEnabled := FALSE;
    END;

    LOCAL PROCEDURE CreateDetaultStep@2();
    BEGIN
      ResetWizardControls;
      DefaultCompanyInitVisible := TRUE;
    END;

    LOCAL PROCEDURE PublishWebServiceStep@9();
    BEGIN
      ResetWizardControls;
      PublishWebServiceVisible := TRUE;
    END;

    LOCAL PROCEDURE ShowDoneStep@6();
    BEGIN
      ResetWizardControls;
      DoneVisible := TRUE;
      NextEnabled := FALSE;
      FinishEnabled := TRUE;
    END;

    LOCAL PROCEDURE ResetWizardControls@10();
    BEGIN
      // Buttons
      BackEnabled := TRUE;
      NextEnabled := TRUE;
      FinishEnabled := FALSE;

      // Tabs ADD ALL
      IntroVisible := FALSE;
      DefaultCompanyInitVisible := FALSE;
      PublishWebServiceVisible := FALSE;
      CreateSMTPVisible := FALSE;
      CreateExFlowEmailVisible := FALSE;
      CreateRootFolderDetailsVisible := FALSE;
      CreateJobsVisible := FALSE;
      AllCompanyVisible := FALSE;
      DoneVisible := FALSE;
      CreateRootFolderVisible:=FALSE;
      InitializeCompanyVisable:=FALSE;
      POandRequisitionVisable:=FALSE;   //1375
      EmailSetupVisible:=FALSE;
      AddInsVisable:=FALSE;
      ImportExFlowUsersVisable:=FALSE;
      RSOSetupVisable:=FALSE;
      CopyRSOSettingsVisable:=FALSE;
      ClearRSOSettingVisable:=FALSE;

      //Actions
      RefreshSMTPWarningMessageVisable:=FALSE;
      RootPathDefaultValuesVisable:=FALSE;
    END;

    LOCAL PROCEDURE SetDefaultValues@8();
    VAR
      ExColumn@1100285000 : Record 12013661;
      WebCompanyID@1100285001 : Record 12013630;
      ExFlowSetup@1100285002 : Record 12013601;
      DefaultComapny@1100285003 : Text[100];
    BEGIN
      //Current Default Company
      ExFlowDefaultCompany:=ExFlowAssistedSetup.GetExFlowDefaultCompanyName;

      IF ExFlowDefaultCompany <> '' THEN
        "Type of Setup" := "Type of Setup"::Initialize
      ELSE
        "Create as default Company" := TRUE;

      //Email Setup
      "Email Subject":=TXT001;
      "Sender Name":= TXT002;
      "Sender Email":=TXT003;
      "ExFlow Web URL":=TXT004;

      "Create ExFlow WEB Service" := TRUE;
      "Create ExFlow Job Queue" := TRUE;
      "ExF Web User Level Permissions" := TRUE;
      "ExFlow Permission Roles" := TRUE;
      "Initialize all Add Ins" := TRUE;
      "Create Default Email Job" := TRUE;
      "Activate Web" := TRUE;
      EmailSettingsVisable :=TRUE;

      IF ExFlowSetup.GET THEN BEGIN
        "Predefined account":=ExFlowSetup."Predefined Account";
        "File storage type":= ExFlowSetup."File storage type";
      END ELSE
        "File storage type" := "File storage type"::"Database ";

      IF ExColumn.ISEMPTY THEN BEGIN
        //Set Editble and defualt column val
        UseColumnsEditble := TRUE;
        "Line Type G/L Account" := TRUE;
        "Line Type Item" := TRUE;
        "Line Type Fixed Asset" := TRUE;
        "Line Type Item Charge" := TRUE;
      END ELSE BEGIN
        //Display current values
        IF ExFlowAssistedSetup.ColumnsExist('DIM1') THEN
          "Use Shortcut Dimension 1 Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('DIM2') THEN
          "Use Shortcut Dimension 2 Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('DIM3') THEN
          "Use Shortcut Dimension 3 Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('DIM4') THEN
          "Use Shortcut Dimension 4 Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('DIM5') THEN
          "Use Shortcut Dimension 5 Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('DIM6') THEN
          "Use Shortcut Dimension 6 Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('DIM7') THEN
          "Use Shortcut Dimension 7 Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('DIM8') THEN
          "Use Shortcut Dimension 8 Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('PERCODE') OR ExFlowAssistedSetup.ColumnsExist('PERDATE') THEN
          "Use Deferral Code" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('JOB') THEN
          "Use Jobs" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('G_LACCOUNT') THEN
          "Line Type G/L Account" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('ITEM') THEN
          "Line Type Item" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('FIXEDASSET') THEN
          "Line Type Fixed Asset" := TRUE;

        IF ExFlowAssistedSetup.ColumnsExist('CHARGE') THEN
          "Line Type Item Charge" := TRUE;
      END;

      IF "File storage type"="File storage type"::Filesystem THEN BEGIN
        CreateDefaultRootFolderEnabled := TRUE;
        "Create Default Root Folder":=TRUE;
        IF ExFlowSetup."Path to Used Invoices" = '' THEN BEGIN
          SetDefaultRootFolderValues;
          RootFolderAndSubfoldersVisable:= TRUE;
          RootFolderActionsEnabled:= TRUE;
          "Create Default Root Folder" := TRUE;
        END;
      END ELSE BEGIN
        CreateDefaultRootFolderEnabled := FALSE;
        "Create Default Root Folder":=FALSE;
      END;

      IF "Create Default Root Folder"= TRUE THEN BEGIN
        RootFolderAndSubfoldersVisable:= TRUE;
        RootFolderActionsEnabled:= TRUE;
      END ELSE BEGIN
        RootFolderAndSubfoldersVisable:= FALSE;
        RootFolderActionsEnabled:=FALSE;
      END;

      //RSO Online Setup
      RSOSettingsVisable:=FALSE;
      IF ExFlowSetup.GET THEN BEGIN
        "Readsoft Online integration":=ExFlowSetup."Readsoft Online integration";
        "RO Connect User":= ExFlowSetup."RO Connect User";
        "RO Connect Password":=ExFlowSetup."RO Connect Password";
        "RO Buyer Name":=ExFlowSetup."RO Buyer Name";
        "Upload vendors to RO":=ExFlowSetup."Upload vendors to RO";
        "Upload references to RO":=ExFlowSetup."Upload references to RO";
        "Customized RO ApiKey":=ExFlowSetup."Customized RO ApiKey";
        "RO Service URL":=ExFlowSetup."RO Service URL";
      END;
    END;

    LOCAL PROCEDURE DefaultRootFolder@1100285015();
    BEGIN
      ResetWizardControls;
      CreateRootFolderVisible:=TRUE;
      RootPathDefaultValuesVisable:=TRUE;
    END;

    LOCAL PROCEDURE POandRequisition@1100285003();
    BEGIN
      //>>1375
      ResetWizardControls;
      POandRequisitionVisable:=TRUE;
      //<<1375
    END;

    LOCAL PROCEDURE InitializeCompany@1100285000();
    BEGIN
      ResetWizardControls;
      InitializeCompanyVisable:= TRUE;
    END;

    LOCAL PROCEDURE ImportExFlowUsers@1100285008();
    BEGIN
      ResetWizardControls;
      ImportExFlowUsersVisable:=TRUE;
    END;

    LOCAL PROCEDURE AddIns@1100285018();
    BEGIN
      ResetWizardControls;
      AddInsVisable:=TRUE;
    END;

    LOCAL PROCEDURE EmailSetup@1100285016();
    BEGIN
      ResetWizardControls;
      EmailSetupVisible:=TRUE;
      RefreshSMTPWarningMessageVisable:=TRUE;
      EmailSetupWarningMessage;
    END;

    LOCAL PROCEDURE EmailSetupWarningMessage@1100285013();
    VAR
      SMTPMailSetup@1100285000 : Record 409;
    BEGIN
      IF SMTPMailSetup.GET THEN BEGIN
        IF SMTPMailSetup.Authentication = SMTPMailSetup.Authentication::Basic THEN BEGIN
          IF (SMTPMailSetup."SMTP Server" <>'') AND (FORMAT(SMTPMailSetup."SMTP Server Port") <> '')
           AND (SMTPMailSetup."User ID" <>'') THEN
             TestSMTPConnectionMessageVisible:=FALSE
          ELSE
            TestSMTPConnectionMessageVisible:=TRUE;
        END ELSE BEGIN
          IF (SMTPMailSetup."SMTP Server" <>'') AND (FORMAT(SMTPMailSetup."SMTP Server Port") <> '') THEN
            TestSMTPConnectionMessageVisible:=FALSE
          ELSE
            TestSMTPConnectionMessageVisible:=TRUE;
        END;
      END;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetDefaultRootFolderValues@1100285009();
    BEGIN
      "Main Folder Path":= TXT011;
       MainPath:="Main Folder Path";
       DeleteEndingSlash(MainPath);
      "Path To New invoices":= MainPath + STRSUBSTNO(TXT005,COMPANYNAME);
      "Path To Processed Invoices":= MainPath + STRSUBSTNO(TXT006,COMPANYNAME);
      "Path To New OCR":= MainPath + STRSUBSTNO(TXT007,COMPANYNAME);
      "Path to Deleted Documents" := MainPath + STRSUBSTNO(TXT008,COMPANYNAME);
    END;

    LOCAL PROCEDURE SetDefaultMainAndSubFolderPaths@1100285027();
    BEGIN
      MainPath:="Main Folder Path";
      IF MainPath <> '' THEN BEGIN
        DeleteEndingSlash(MainPath);
        "Path To New invoices":= MainPath + STRSUBSTNO(TXT005,COMPANYNAME);
        "Path To Processed Invoices":= MainPath + STRSUBSTNO(TXT006,COMPANYNAME);
        "Path To New OCR":= MainPath + STRSUBSTNO(TXT007,COMPANYNAME);
        "Path to Deleted Documents":= MainPath + STRSUBSTNO(TXT008,COMPANYNAME);
      END ELSE BEGIN
        "Path To New invoices":= MainPath;
        "Path To Processed Invoices":= MainPath;
        "Path To New OCR":= MainPath;
        "Path to Deleted Documents":= MainPath;
      END;

      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE DeleteEndingSlash@1000000000(VAR Path@1000000000 : Text[128]);
    BEGIN
      IF Path <> '' THEN
        IF Path[STRLEN(Path)] = '\' THEN
          Path:= COPYSTR(Path,1,STRLEN(Path)-1);
    END;

    LOCAL PROCEDURE ClearAllFolderPahtSettings@1100285034();
    BEGIN
      "Main Folder Path":='';
      "Path To New invoices":= '';
      "Path To Processed Invoices":= '';
      "Path To New OCR":= '';
      "Path to Deleted Documents":= '';
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE CheckRootFolder@1100285001();
    BEGIN
      IF "Create Default Root Folder" THEN BEGIN
        IF COPYSTR(MainPath,1,2) <> '\\' THEN BEGIN
          MESSAGE(TXT016);
          "Create Default Root Folder" := FALSE;
          RootFolderAndSubfoldersVisable:= FALSE;
          RootFolderActionsEnabled:=FALSE;
          EXIT;
        END;

        IF NOT ExFlowFileMgt.FolderExist(MainPath) THEN BEGIN
          "Create Default Root Folder" := FALSE;
          RootFolderAndSubfoldersVisable:= FALSE;
          RootFolderActionsEnabled:=FALSE;
          MESSAGE(TXT012);
          EXIT;
        END;
      END;
    END;

    LOCAL PROCEDURE RSOSetup@1100285004();
    BEGIN
      ResetWizardControls;
      RSOSetupVisable:=TRUE;
      CopyRSOSettingsVisable:=TRUE;
      ClearRSOSettingVisable:=TRUE;
    END;

    BEGIN
    END.
  }
}

