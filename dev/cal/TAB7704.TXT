OBJECT Table 7704 Item Identifier
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    DataCaptionFields=Code,Item No.;
    OnInsert=BEGIN
               TESTFIELD("Item No.");
               IF VerifyItem = FALSE THEN
                 ERROR(Text000,"Item No.");
             END;

    CaptionML=[ENU=Item Identifier;
               NOR=Vare-ID];
    LookupPageID=Page7707;
    DrillDownPageID=Page7707;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NOR=Kode;
                                                              SVE=Kod];
                                                   NotBlank=Yes }
    { 2   ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   OnValidate=BEGIN
                                                                GetItem;
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.;
                                                              SVE=Artikelnr] }
    { 3   ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=VAR
                                                                ItemVariant@1000 : Record 5401;
                                                              BEGIN
                                                                IF "Variant Code" <> '' THEN
                                                                  ItemVariant.GET("Item No.","Variant Code");
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode;
                                                              SVE=Variantkod] }
    { 4   ;   ;Unit of Measure Code;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                IF "Item No." <> '' THEN
                                                                  GetItemUnitOfMeasure;
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode;
                                                              SVE=Enhetskod] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Item No.,Variant Code,Unit of Measure Code }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Item@1000 : Record 27;
      ItemUnitOfMeasure@1001 : Record 5404;
      Text000@1002 : TextConst 'ENU=For Item %1 Identifier exists.;NOR=Det finnes ID for varen %1.';

    LOCAL PROCEDURE GetItem@15();
    BEGIN
      IF Item."No." <> "Item No." THEN
        Item.GET("Item No.");
    END;

    LOCAL PROCEDURE GetItemUnitOfMeasure@18();
    BEGIN
      GetItem;
      Item.TESTFIELD("No.");
      IF (Item."No." <> ItemUnitOfMeasure."Item No.") OR
         ("Unit of Measure Code" <> ItemUnitOfMeasure.Code)
      THEN
        IF NOT ItemUnitOfMeasure.GET(Item."No.","Unit of Measure Code") THEN
          ItemUnitOfMeasure.GET(Item."No.",Item."Base Unit of Measure");
    END;

    LOCAL PROCEDURE VerifyItem@1() : Boolean;
    VAR
      ItemIdent@1000 : Record 7704;
    BEGIN
      ItemIdent.SETRANGE("Item No.","Item No.");
      ItemIdent.SETRANGE("Variant Code","Variant Code");
      ItemIdent.SETRANGE("Unit of Measure Code","Unit of Measure Code");
      EXIT(ItemIdent.ISEMPTY);
    END;

    BEGIN
    END.
  }
}

