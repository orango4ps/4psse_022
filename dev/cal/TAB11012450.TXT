OBJECT Table 11012450 Complaint
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF "No." = '' THEN
                 NoSeriesMgt.InitSeries(GetComplaintNoSerie,xRec."No. Series",0D,"No.","No. Series");

               "Call Date" := TODAY;
               IF "Entered By" = '' THEN BEGIN
                 IF UserSetupRec.GET(USERID) THEN
                   "Entered By" := UserSetupRec."Employee No.";
               END;
               VALIDATE("Plot No.");
             END;

    OnModify=VAR
               lvComplaintDocRec@1100485000 : Record 11012457;
               lvComplaintCommRec@1100525000 : Record 11012456;
               lvComplaintCommRec2@1100525001 : Record 11012456;
             BEGIN
               IF (xRec."No." = "No.") AND (xRec.Status = Status::Finished) THEN
                 ERROR(Text005);

               lvComplaintDocRec.SETRANGE("Complaint No.", "No.");
               lvComplaintDocRec.SETFILTER("Complaint Status", '<>%1', Status);
               lvComplaintDocRec.MODIFYALL("Complaint Status", Status);

               lvComplaintCommRec.SETRANGE("Complaint No.", "No.");
               IF lvComplaintCommRec.FINDSET(TRUE,TRUE) THEN BEGIN
                 REPEAT
                   IF (lvComplaintCommRec."Project No." <> "Project No.") OR
                      (lvComplaintCommRec."Plot No." <> "Plot No.") OR
                      (lvComplaintCommRec.Delivery <> Delivery) OR
                      (lvComplaintCommRec."Delivered Object" <> "Delivered Object")
                   THEN BEGIN
                     lvComplaintCommRec2 := lvComplaintCommRec;
                     lvComplaintCommRec2.RENAME(
                       "No.", "Project No.", "Plot No." , '', Delivery, "Delivered Object", lvComplaintCommRec."Commision No.");
                   END;
                 UNTIL lvComplaintCommRec.NEXT = 0;
               END;
             END;

    OnDelete=VAR
               lvComplaintDocRec@1100485000 : Record 11012457;
             BEGIN
               IF Status = Status::Finished THEN BEGIN
                 ComplaintNotRec.RESET;
                 ComplaintNotRec.SETRANGE("Complaint No.", "No.");
                 ComplaintNotRec.DELETEALL;
                 ComplaintPrincRec.RESET;
                 ComplaintPrincRec.SETRANGE("Complaint No.", "No.");
                 ComplaintPrincRec.DELETEALL;
                 lvComplaintDocRec.SETRANGE("Complaint No.", "No.");
                 lvComplaintDocRec.DELETEALL;
               END ELSE
                 ERROR(Text000);
               UpdateComplNoOfQADeviations;//kkleermaker.n, 09-11-10, rfc369
             END;

    CaptionML=[ENU=Complaint;
               NOR=Klage;
               SVE=Klagom†l];
    LookupPageID=Page11012468;
    DrillDownPageID=Page11012468;
  }
  FIELDS
  {
    { 10  ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  NoSeriesMgt.TestManual(GetComplaintNoSerie);
                                                                  "No. Series" := '';
                                                                END;

                                                                VALIDATE("Plot No.");
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr;
                                                              SVE=Nr] }
    { 20  ;   ;Project No.         ;Code20        ;TableRelation=Job;
                                                   OnValidate=VAR
                                                                QADeviation@1100525000 : Record 11125986;
                                                              BEGIN
                                                                //kkleermaker.sn, 09-11-10, rfc369
                                                                IF ("Project No." <>  xRec."Project No.") AND QADeviationsAreLinkedToCompl THEN BEGIN
                                                                  IF NOT CONFIRM(
                                                                            Text003,
                                                                            FALSE,
                                                                            QADeviation.FIELDCAPTION("Complaint No."),
                                                                            QADeviation.TABLECAPTION)
                                                                  THEN
                                                                    ERROR('');
                                                                  UpdateComplNoOfQADeviations;
                                                                END;
                                                                //kkleermaker.en
                                                                IF "Project No." = '' THEN BEGIN
                                                                  "Plot No." := '';
                                                                  VALIDATE(Delivery, '');
                                                                  "Project Principal" := '';
                                                                END ELSE BEGIN
                                                                  IF CurrFieldNo <> 0 THEN // Call T001203, get stucked here at new complaint on delivered object
                                                                    TESTFIELD("Delivered Object", '');
                                                                  IF ("Project No." <>  xRec."Project No.") THEN BEGIN
                                                                    IF ("Plot No." <> '') THEN BEGIN
                                                                      IF NOT PlotRec.GET("Project No.", "Plot No.") THEN
                                                                        "Plot No." := '';
                                                                    END;
                                                                    FillProjectPrincipal();
                                                                  END;
                                                                END;
                                                                IF ("Source Type" = "Source Type"::RentalUnit) AND ("Source No." <> "Project No.") THEN BEGIN
                                                                  "Source No." := "Project No.";
                                                                  "Source No. 2" := '';
                                                                END;

                                                                CALCFIELDS("Project Description");

                                                                IF (("Project No." <> '' ) AND (xRec."Project No." = '')) THEN BEGIN
                                                                  ProjRec.GET("Project No.");
                                                                  "Complaint Address" := ProjRec.Address;
                                                                  "Complaint Post Code" := ProjRec."Post Code";
                                                                  "Complaint City" := ProjRec.City;
                                                                  "Complaint County" := ProjRec.County;
                                                                  "Complaint Country/Region Code" := ProjRec."Country/Region Code";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 21  ;   ;Project Description ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Job.Description WHERE (No.=FIELD(Project No.)));
                                                   CaptionML=[ENU=Project Description;
                                                              NOR=Prosjektbeskrivelse;
                                                              SVE=Projektbeskrivning];
                                                   Editable=No }
    { 30  ;   ;Plot No.            ;Code20        ;TableRelation=Plot."Plot No." WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                IF ("Plot No." <> '')  AND ("Delivered Object" = '') THEN
                                                                  PlotRec.GET("Project No.", "Plot No."); //Only Validate if No Delivered Object

                                                                IF ("Plot No." <>  xRec."Plot No.") THEN
                                                                  FillProjectPrincipal();

                                                                IF (PlotRec.GET("Project No.", "Plot No.")) THEN BEGIN;
                                                                  "Complaint Address" := PlotRec.Address;
                                                                  "Complaint Post Code" := PlotRec."Post Code";
                                                                  "Complaint City" := PlotRec.City;
                                                                  "Complaint County" := PlotRec.County;
                                                                  "Complaint Country/Region Code" := PlotRec."Country/Region Code";
                                                                END;

                                                                CALCFIELDS("House Model");
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Plot No.;
                                                              NOR=Tegningnr;
                                                              SVE=Ritningnr] }
    { 31  ;   ;House Model         ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Plot."House Model" WHERE (Project No.=FIELD(Project No.),
                                                                                                Plot No.=FIELD(Plot No.)));
                                                   CaptionML=[ENU=House Model;
                                                              NOR=Husmodell;
                                                              SVE=Husmodell];
                                                   Editable=No }
    { 35  ;   ;Unit                ;Code20        ;TableRelation="Units per House Model".Unit WHERE (Project No.=FIELD(Project No.),
                                                                                                     Model=FIELD(House Model));
                                                   OnValidate=BEGIN
                                                                GetUnitDescription();
                                                              END;

                                                   CaptionML=[ENU=Unit;
                                                              NOR=Enhet;
                                                              SVE=Unit] }
    { 36  ;   ;Delivery Date       ;Date          ;CaptionML=[ENU=Delivery Date;
                                                              NOR=Leveringsdato;
                                                              SVE=Leveransdatum] }
    { 37  ;   ;Delivery            ;Code20        ;TableRelation=Delivery."Delivery No." WHERE (Project No.=FIELD(Project No.),
                                                                                                Plot No.=FIELD(Plot No.));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Delivery Description");
                                                                IF FPSLicenseManagement.LicenseAndReadPermissionForTable(DeliveryRec) THEN BEGIN
                                                                  IF DeliveryRec.GET("Project No.","Plot No.",Delivery) THEN
                                                                    "Delivery Date" := DT2DATE(DeliveryRec."Delivery Date");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Delivery;
                                                              NOR=Leveranse;
                                                              SVE=LEVERANS] }
    { 38  ;   ;Delivery Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Delivery.Description WHERE (Project No.=FIELD(Project No.),
                                                                                                  Plot No.=FIELD(Plot No.),
                                                                                                  Delivery No.=FIELD(Delivery)));
                                                   CaptionML=[ENU=Delivery Description;
                                                              NOR=Leveransebeskrivelse;
                                                              SVE=Leveransbeskrivning];
                                                   Editable=No }
    { 39  ;   ;Delivered Object    ;Code20        ;TableRelation="Delivered Object";
                                                   OnValidate=BEGIN
                                                                IF "Delivered Object" = '' THEN
                                                                  "Delivered Object Principal" := ''
                                                                ELSE BEGIN
                                                                  //TESTFIELD("Project No.", '');
                                                                  //TESTFIELD("Plot No.", '');
                                                                  TESTFIELD(Delivery, '');
                                                                  IF FPSLicenseManagement.LicenseAndReadPermissionForTable(DeliveredObject) THEN BEGIN
                                                                    IF DeliveredObject.GET("Delivered Object") THEN BEGIN
                                                                      "Delivery Date" := DeliveredObject."Date Delivered";
                                                                      IF (DeliveredObject."Original Project" <> '') AND ProjRec.GET(DeliveredObject."Original Project") THEN
                                                                        "Project No." := DeliveredObject."Original Project";
                                                                      "Plot No." := DeliveredObject."Original Plot no.";
                                                                      IF DeliveredObject.Principal <> '' THEN
                                                                        VALIDATE("Delivered Object Principal", DeliveredObject.Principal);
                                                                      IF DeliveredObject.Buyer <> '' THEN
                                                                        VALIDATE(Buyer, DeliveredObject.Buyer);
                                                                      "Complaint Address" := DeliveredObject.Address;
                                                                      "Complaint Post Code" := DeliveredObject."Post Code";
                                                                      "Complaint City" := DeliveredObject.City;
                                                                      "Complaint County" := DeliveredObject.County;
                                                                      "Complaint Country/Region Code" := DeliveredObject."Country/Region Code";
                                                                    END;
                                                                  END;

                                                                END;
                                                                CALCFIELDS("Original Project (Del. Obj.)");
                                                              END;

                                                   CaptionML=[ENU=Delivered Object;
                                                              NOR=Levert objekt;
                                                              SVE=Levererat objekt] }
    { 40  ;   ;Call Date           ;Date          ;OnValidate=BEGIN
                                                                IF ("Solving Date" <> 0D) AND ("Solving Date" < "Call Date") THEN
                                                                  FIELDERROR("Solving Date", STRSUBSTNO(Text006, "Solving Date", FIELDCAPTION("Call Date"), "Call Date"));
                                                                CalculatedLeadTimeDays();
                                                                IF "Call Date" <> xRec."Call Date" THEN
                                                                  CalcExpectedSolvingDate();
                                                              END;

                                                   CaptionML=[ENU=Call Date;
                                                              NOR=Samtaledato;
                                                              SVE=Samtalsdatum] }
    { 41  ;   ;Solving Date        ;Date          ;OnValidate=BEGIN
                                                                IF ("Solving Date" <> 0D) AND ("Solving Date" < "Call Date") THEN
                                                                  FIELDERROR("Solving Date", STRSUBSTNO(Text006, "Solving Date", FIELDCAPTION("Call Date"), "Call Date"));
                                                                CalculatedLeadTimeDays();
                                                              END;

                                                   CaptionML=[ENU=Solving Date;
                                                              NOR=L›sningsdato;
                                                              SVE=L”sningsdatum] }
    { 42  ;   ;Lead Time in Days   ;Integer       ;CaptionML=[ENU=Lead Time in Days;
                                                              NOR="Leveringstid i dager ";
                                                              SVE=Ledtid i dagar];
                                                   Editable=No }
    { 45  ;   ;Expected Solving Date;Date         ;CaptionML=[ENU=Expected Solving Date;
                                                              NOR=Forventet dato for L›sning;
                                                              SVE=F”rv„ntat datum f”r l”sning] }
    { 49  ;   ;Original Project (Del. Obj.);Code20;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Delivered Object"."Original Project" WHERE (No.=FIELD(Delivered Object)));
                                                   CaptionML=ENU=Original Project (Del. Obj.);
                                                   Editable=No }
    { 50  ;   ;Requisition System  ;Option        ;CaptionML=[ENU=Requisition System;
                                                              NOR=Rekvisisjonssystem;
                                                              SVE=Rekvisitionssystem];
                                                   OptionCaptionML=ENU=By Phone,By Mail,By E-mail,Website,Spoken,Others;
                                                   OptionString=By Phone,By Mail,By E-mail,Website,Spoken,Others }
    { 55  ;   ;Entered By          ;Code20        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Entered By Name");
                                                              END;

                                                   CaptionML=[ENU=Entered By;
                                                              NOR=Angitt av;
                                                              SVE=Angivet av] }
    { 56  ;   ;Entered By Name     ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Entered By)));
                                                   CaptionML=[ENU=Entered By Name;
                                                              NOR=Angitt av navn;
                                                              SVE=Angivet av namn];
                                                   Editable=No }
    { 60  ;   ;Urgency             ;Code10        ;FieldClass=Normal;
                                                   TableRelation="Complaint Urgency".Code;
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Urgency Description");
                                                                CalcExpectedSolvingDate();
                                                              END;

                                                   CaptionML=[ENU=Urgency;
                                                              NOR=Hastegrad;
                                                              SVE=Angel„genhetsgrad] }
    { 61  ;   ;Urgency Description ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Complaint Urgency".Description WHERE (Code=FIELD(Urgency)));
                                                   CaptionML=[ENU=Urgency Description;
                                                              NOR=Beskrivelse av Hastegrad;
                                                              SVE=Beskrivning av angel„genhet];
                                                   Editable=No }
    { 70  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 71  ;   ;Reference           ;Text35        ;CaptionML=[ENU=Reference;
                                                              NOR=Referanse;
                                                              SVE=Referens] }
    { 80  ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                IF Status = Status::Finished THEN BEGIN
                                                                  ComplaintPrincRec.RESET;
                                                                  ComplaintPrincRec.SETRANGE("Complaint No.", "No.");
                                                                  ComplaintPrincRec.SETFILTER("Commision Status", '<%1', ComplaintPrincRec."Commision Status"::Finished);
                                                                  IF ComplaintPrincRec.FIND('-') THEN BEGIN
                                                                    ERROR(Text001);
                                                                  END ELSE BEGIN
                                                                    IF "Complaint about" = Rec."Complaint about"::Delivery THEN
                                                                      TESTFIELD("Solving Date")
                                                                    ELSE
                                                                      IF (Handling = Rec.Handling::" ") OR (Handling = Handling::"Not yet known") OR ("Caused by" = '') OR ("Solving Date" = 0D) THEN
                                                                        ERROR(Text002);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[ENU=Received,In Process,Waiting,Finished;
                                                                    NOR=Mottatt,Under Behandling,Venter,Ferdig;
                                                                    SVE=Mottaget,Under behandling,V„ntar,F„rdig];
                                                   OptionString=Received,In Process,Waiting,Finished }
    { 90  ;   ;Complaint Kind      ;Code10        ;TableRelation="Complaint Indication".Code WHERE (Indication=CONST(Kind));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Complaint Kind Description");
                                                              END;

                                                   CaptionML=[ENU=Complaint Kind;
                                                              NOR=Klagetype;
                                                              SVE=Klagom†lstyp] }
    { 91  ;   ;Complaint Kind Description;Text30  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Complaint Indication".Description WHERE (Code=FIELD(Complaint Kind),
                                                                                                                Indication=CONST(Kind)));
                                                   CaptionML=[ENU=Complaint Kind Description;
                                                              NOR=Klagetypebeskrivelse;
                                                              SVE=Klagom†lstypsbeskrivning];
                                                   Editable=No }
    { 92  ;   ;Complaint Type      ;Code10        ;TableRelation="Complaint Indication".Code WHERE (Indication=CONST(Type));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Complaint Type Description");
                                                              END;

                                                   CaptionML=[ENU=Complaint Type;
                                                              NOR=Klagetype;
                                                              SVE=Klagom†lstyp] }
    { 93  ;   ;Complaint Type Description;Text30  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Complaint Indication".Description WHERE (Code=FIELD(Complaint Type),
                                                                                                                Indication=CONST(Type)));
                                                   CaptionML=[ENU=Complaint Type Description;
                                                              NOR=Klagetypebeskrivelse;
                                                              SVE=Klagom†lstypsbeskrivning];
                                                   Editable=No }
    { 100 ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr-serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 105 ;   ;Handling            ;Option        ;CaptionML=[ENU=Action;
                                                              NOR=Handling;
                                                              SVE=tg„rd];
                                                   OptionCaptionML=ENU=" ,Unfounded,Guarantee,Maintenance,Contractor Costs,Customer Costs,,,,,,Not yet known";
                                                   OptionString=[ ,Unfounded,Guarantee,Maintenance,Contractor Costs,Customer Costs,,,,,,Not yet known] }
    { 110 ;   ;Caused by           ;Code20        ;TableRelation="Complaint Cause";
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Caused by Description");
                                                              END;

                                                   CaptionML=[ENU=Caused by;
                                                              NOR=For†rsaket av;
                                                              SVE=Orsakad av] }
    { 115 ;   ;Caused by Description;Text50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Complaint Cause".Description WHERE (Code=FIELD(Caused by)));
                                                   CaptionML=[ENU=Caused by Description;
                                                              NOR=For†rsaket av, Beskrivelse;
                                                              SVE=Orsakad av, beskrivning];
                                                   Editable=No }
    { 130 ;   ;Inquiry Costs       ;Decimal       ;CaptionML=[ENU=Inquiry Costs;
                                                              NOR=Kostnader for Henvendelse;
                                                              SVE=Kostnader f”r f”rfr†gan] }
    { 140 ;   ;Sales Invoice       ;Code20        ;CaptionML=[ENU=Sales Invoice;
                                                              NOR=Salgsfaktura;
                                                              SVE=F”rs.faktura];
                                                   Editable=No }
    { 150 ;   ;Credit Memo         ;Code20        ;CaptionML=[ENU=Credit Memo;
                                                              NOR=Kreditnota;
                                                              SVE=Kreditnota];
                                                   Editable=No }
    { 155 ;   ;Posted Credit Memo  ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Sales Cr.Memo Header".No. WHERE (Pre-Assigned No.=FIELD(Credit Memo),
                                                                                                        Pre-Assigned No. Series=FILTER(<>'')));
                                                   CaptionML=[ENU=Posted Credit Memo;
                                                              NOR=Bokf›rt kreditnota;
                                                              SVE=Bokf”rd kreditnota];
                                                   Editable=No }
    { 160 ;   ;Paid Amount         ;Decimal       ;CaptionML=ENU=Paid Amount;
                                                   Editable=No }
    { 165 ;   ;Posted Sales Invoice;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Sales Invoice Header".No. WHERE (Pre-Assigned No.=FIELD(Sales Invoice),
                                                                                                        Pre-Assigned No. Series=FILTER(<>'')));
                                                   CaptionML=[ENU=Posted Sales Invoice;
                                                              NOR=Bokf›rt salgsfaktura;
                                                              SVE=Bokf”rd f”rs„ljningsfaktura];
                                                   Editable=No }
    { 170 ;   ;Bill to Contact     ;Code20        ;TableRelation=Contact.No.;
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Bill to Contact Name");
                                                              END;

                                                   CaptionML=[ENU=Bill to Contact;
                                                              NOR=Faktureringskontaktperson;
                                                              SVE=Faktureringskontaktperson] }
    { 175 ;   ;Bill to Contact Name;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Bill to Contact)));
                                                   CaptionML=[ENU=Bill to Contact Name;
                                                              NOR=Fakturere til Kontaktnavn;
                                                              SVE=Fakturera till kontaktnamn];
                                                   Editable=No }
    { 200 ;   ;Contact No.         ;Code20        ;TableRelation=Contact.No.;
                                                   OnValidate=BEGIN
                                                                IF Buyer <> '' THEN
                                                                  "Contact No." := Buyer
                                                                ELSE
                                                                  IF "Delivered Object" <> ''  THEN
                                                                    "Contact No." := "Delivered Object Principal"
                                                                  ELSE
                                                                    "Contact No." := GetContactProjectPrincipal;

                                                                FillContactFields;
                                                              END;

                                                   CaptionML=[ENU=Contact No.;
                                                              NOR=Kontaktnr;
                                                              SVE=Kontaktnr];
                                                   Editable=Yes }
    { 205 ;   ;Project Principal   ;Code20        ;TableRelation=Customer.No.;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Contact No.");
                                                                CALCFIELDS("Name Project Principal");
                                                              END;

                                                   OnLookup=VAR
                                                              ProjPrincipal@1100485000 : Record 11012005;
                                                            BEGIN
                                                              IF "Project No." <> '' THEN BEGIN
                                                                ProjPrincipal.SETRANGE("Project No.","Project No.");
                                                                IF PAGE.RUNMODAL(PAGE::"Project Principal List",ProjPrincipal) = ACTION::LookupOK THEN BEGIN
                                                                  IF ("Project Principal" <> ProjPrincipal.Principal) AND (Status <> Status::Finished) THEN
                                                                    VALIDATE("Project Principal",ProjPrincipal.Principal);
                                                                END;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Project Principal;
                                                              NOR=Prosjektoppdragsgiver;
                                                              SVE=Projektuppdragsgivare] }
    { 206 ;   ;Delivered Object Principal;Code20  ;TableRelation="Delivered Object Principal".Principal WHERE (Delivered Object=FIELD(Delivered Object));
                                                   OnValidate=BEGIN
                                                                VALIDATE("Contact No.");
                                                                CALCFIELDS("Name Object Principal");
                                                              END;

                                                   OnLookup=VAR
                                                              DelObjPrincipal@1100485000 : Record 11012109;
                                                            BEGIN
                                                              IF "Delivered Object" <> '' THEN BEGIN
                                                                DelObjPrincipal.SETRANGE("Delivered Object","Delivered Object");
                                                                IF PAGE.RUNMODAL(PAGE::"Delivered Object Principals",DelObjPrincipal) = ACTION::LookupOK THEN BEGIN
                                                                  IF ("Delivered Object Principal" <> DelObjPrincipal.Principal) AND (Status <> Status::Finished) THEN
                                                                    VALIDATE("Delivered Object Principal",DelObjPrincipal.Principal);
                                                                END;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Object Principal;
                                                              NOR=Oppdragsgiver, Objekt;
                                                              SVE=Huvudansvarig, objekt];
                                                   Editable=Yes }
    { 207 ;   ;Name Object Principal;Text100      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Delivered Object Principal)));
                                                   CaptionML=[ENU=Name Object Principal;
                                                              NOR=Navn p† Oppdragsgiver Objekt;
                                                              SVE=Namn p† huvudansvarig, objekt];
                                                   Editable=No }
    { 208 ;   ;Name Project Principal;Text100     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Project Principal)));
                                                   CaptionML=[ENU=Name Project Principal;
                                                              NOR=Navn p† prosjektoppdragsgiver;
                                                              SVE=Namn p† projektuppdragsgivare];
                                                   Editable=No }
    { 210 ;   ;Address             ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Delivered Object".Address WHERE (No.=FIELD(Delivered Object)));
                                                   CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress];
                                                   Editable=No }
    { 220 ;   ;Address 2           ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Delivered Object"."Address 2" WHERE (No.=FIELD(Delivered Object)));
                                                   CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2;
                                                              SVE=Adress 2];
                                                   Editable=No }
    { 230 ;   ;Postal Code         ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Delivered Object"."Post Code" WHERE (No.=FIELD(Delivered Object)));
                                                   TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Postal Code;
                                                              NOR=Postnummer;
                                                              SVE=Postnummer];
                                                   Editable=No }
    { 240 ;   ;City                ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Delivered Object".City WHERE (No.=FIELD(Delivered Object)));
                                                   CaptionML=[ENU=City;
                                                              NOR=Poststed;
                                                              SVE=Ort];
                                                   Editable=No }
    { 250 ;   ;Phone               ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Delivered Object".City WHERE (No.=FIELD(Delivered Object)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone;
                                                              NOR=Telefon;
                                                              SVE=Telefon];
                                                   Editable=No }
    { 260 ;   ;Contact Name        ;Text100       ;CaptionML=[ENU=Contact Name;
                                                              NOR=Kontaktnavn;
                                                              SVE=Kontaktnamn] }
    { 270 ;   ;Preferred Start Date;Date          ;CaptionML=[ENU=Preferred Start Date;
                                                              NOR=Foretrukket Startdato;
                                                              SVE=F”rvalt startdatum] }
    { 280 ;   ;Preferred End Date  ;Date          ;CaptionML=[ENU=Preferred End Date;
                                                              NOR=Foretrukket Sluttdato;
                                                              SVE=F”rvalt slutdatum] }
    { 290 ;   ;Small Project No.   ;Code20        ;TableRelation=Job.No. WHERE (Small Project=CONST(Yes));
                                                   OnLookup=VAR
                                                              lvSmallProjRec@1210190000 : Record 11072003;
                                                            BEGIN
                                                              IF ("Small Project No." <> '') THEN //kzwerver, 110802, n, #26039
                                                                lvSmallProjRec.SETRANGE("No.", "Small Project No.");
                                                              lvSmallProjRec."No." := "Small Project No.";
                                                              IF ("Small Project Company" = '') OR ("Small Project Company" = COMPANYNAME) THEN
                                                                PAGE.RUNMODAL(PAGE::"Small Project", lvSmallProjRec)
                                                              ELSE BEGIN
                                                                lvSmallProjRec.CHANGECOMPANY("Small Project Company");
                                                                lvSmallProjRec.FILTERGROUP(9);
                                                                lvSmallProjRec.SETRANGE("Small Project", TRUE);
                                                                PAGE.RUNMODAL(0, lvSmallProjRec);
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Small Project No.;
                                                              NOR=Lite prosjektnr.;
                                                              SVE=Mindre projekt nr];
                                                   Editable=No }
    { 295 ;   ;Small Project Company;Text30       ;TableRelation=Company;
                                                   CaptionML=[ENU=Small Project Company;
                                                              NOR=Selskap for lite prosjekt;
                                                              SVE=F”retag f”r mindre projekt];
                                                   Editable=No }
    { 300 ;   ;Main Project No.    ;Code20        ;TableRelation=IF (Small Project Company=FILTER('')) Job.No. WHERE (Small Project=FILTER(No),
                                                                                                                      Single/Main/Sub Project=FILTER(Main Project));
                                                   OnValidate=VAR
                                                                lvMainSmallProjRec@1100485000 : Record 11072003;
                                                              BEGIN
                                                                IF "Small Project No." = '' THEN BEGIN
                                                                  GetComplaintSetup;
                                                                  "Small Project Company" := ComplaintSetupRec."Small Project Company";
                                                                END;

                                                                lvMainSmallProjRec.CHANGECOMPANY("Small Project Company");
                                                                lvMainSmallProjRec.GET("Main Project No.");
                                                                lvMainSmallProjRec.TESTFIELD("Small Project", FALSE);
                                                                lvMainSmallProjRec.TESTFIELD("Single/Main/Sub Project", lvMainSmallProjRec."Single/Main/Sub Project"::"Main Project");
                                                              END;

                                                   OnLookup=VAR
                                                              lvMainSmallProjRec@1100485000 : Record 11072003;
                                                            BEGIN
                                                              IF "Small Project No." = '' THEN BEGIN
                                                                GetComplaintSetup;
                                                                "Small Project Company" := ComplaintSetupRec."Small Project Company";
                                                              END;

                                                              lvMainSmallProjRec.CHANGECOMPANY("Small Project Company");
                                                              lvMainSmallProjRec.SETRANGE("Small Project", FALSE);
                                                              lvMainSmallProjRec.SETRANGE("Single/Main/Sub Project", lvMainSmallProjRec."Single/Main/Sub Project"::"Main Project");
                                                              lvMainSmallProjRec."No." := "Main Project No.";
                                                              IF PAGE.RUNMODAL(0, lvMainSmallProjRec) = ACTION::LookupOK THEN
                                                                IF (Status <> Status::Finished) THEN
                                                                  VALIDATE("Main Project No.", lvMainSmallProjRec."No.");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Main Project No.;
                                                              NOR=Hovedprosjektnr.;
                                                              SVE=Huvudprojektnr] }
    { 320 ;   ;Contact Name 2      ;Text50        ;CaptionML=[ENU=Contact Name 2;
                                                              NOR=Kontaktnavn 2;
                                                              SVE=Kontaktnamn 2] }
    { 321 ;   ;Contact Address     ;Text100       ;CaptionML=[ENU=Contact Address;
                                                              NOR=Kontaktadresse;
                                                              SVE=Kontaktadress] }
    { 322 ;   ;Contact Address 2   ;Text50        ;CaptionML=[ENU=Contact Address 2;
                                                              NOR=Kontaktadresse 2;
                                                              SVE=Kontaktadress 2] }
    { 325 ;   ;Contact Post Code   ;Code20        ;TableRelation=IF (Contact Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Contact Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Contact Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Contact City",
                                                                  "Contact Post Code",
                                                                  "Contact County",
                                                                  "Contact Country/Region Code",
                                                                  (CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr;
                                                              SVE=Postnr] }
    { 326 ;   ;Contact City        ;Text30        ;TableRelation=IF (Contact Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Contact Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Contact Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Contact City",
                                                                  "Contact Post Code",
                                                                  "Contact County",
                                                                  "Contact Country/Region Code",
                                                                  (CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Contact City;
                                                              NOR=Kontakt, poststed;
                                                              SVE=Kontaktort] }
    { 328 ;   ;Contact County      ;Text30        ;CaptionML=[ENU=Contact County;
                                                              NOR=Kontaktfylke] }
    { 329 ;   ;Contact Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Contact Country/Region Code;
                                                              NOR=Kontaktland/Regionkode] }
    { 330 ;   ;Contact Phone       ;Text30        ;FieldClass=Normal;
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Contact Phone;
                                                              NOR=Kontaktpersonens telefonnummer;
                                                              SVE=Kontaktpersonens telefonnummer] }
    { 340 ;   ;Contact Phone 2     ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Contact Phone 2;
                                                              NOR=Kontaktpersonens telefonnummer 2;
                                                              SVE=Kontaktpersonens telefonnummer 2] }
    { 350 ;   ;Contact Mobile Phone;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Contact Mobile Phone;
                                                              NOR=Kontaktmobilnummer;
                                                              SVE=Kontaktmobilnummer] }
    { 360 ;   ;Contact E-Mail      ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Contact E-Mail;
                                                              NOR=Kontakt e-mail;
                                                              SVE=Kontakte-post] }
    { 370 ;   ;Contact Mobile Phone 2;Text30      ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Contact Mobile Phone 2;
                                                              NOR=Kontaktmobilnummer 2;
                                                              SVE=Kontaktmobilnummer 2] }
    { 380 ;   ;Contact Phone Work  ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Contact Phone Work;
                                                              NOR=Kontaktpersonens telefonnummer, arbeid;
                                                              SVE=Kontaktpersonens telefonnummer, arbete] }
    { 390 ;   ;Contact Phone Work 2;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Contact Phone Work 2;
                                                              NOR=Kontaktpersonens telefon, arbeid 2;
                                                              SVE=Kontaktpersonens telefonnummer, arbete 2] }
    { 400 ;   ;Source Type         ;Option        ;OnValidate=BEGIN
                                                                IF ("Source Type" <> xRec."Source Type") THEN BEGIN
                                                                  "Source No." := '';
                                                                  "Source No. 2" := '';
                                                                  IF ("Source Type" = "Source Type"::RentalUnit) AND ("Project No." <> '') THEN
                                                                    "Source No." := "Project No.";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Source Type;
                                                              NOR=Kildetype;
                                                              SVE=Ursprungstyp];
                                                   OptionCaptionML=[ENU=" ,Customer,Vendor,Department,Plant,Rental Unit,Plant Location,Service Order";
                                                                    NOR=" ,Kunde,Leverand›r,Avdeling,Maskin,Leieenhet,Maskinplassering,Serviceordre";
                                                                    SVE=" ,Kund,Leverant”r,Avdelning,Maskin,Uthyrningsenhet,Maskinutplacering,Serviceorder"];
                                                   OptionString=[ ,Cust,Vend,Dept,Plant,RentalUnit,PlantLoc,ServOrder] }
    { 401 ;   ;Source No.          ;Code20        ;TableRelation=IF (Source Type=CONST(Cust)) Customer
                                                                 ELSE IF (Source Type=CONST(Vend)) Vendor
                                                                 ELSE IF (Source Type=CONST(Dept)) "Dimension Value".Code WHERE (Global Dimension No.=CONST(1))
                                                                 ELSE IF (Source Type=CONST(Plant)) "Plant Type"
                                                                 ELSE IF (Source Type=CONST(RentalUnit)) Job
                                                                 ELSE IF (Source Type=CONST(PlantLoc)) "Plant Location"
                                                                 ELSE IF (Source Type=CONST(ServOrder)) "Service Order";
                                                   OnValidate=BEGIN
                                                                IF "Source No." <> '' THEN BEGIN
                                                                  TESTFIELD("Source Type");
                                                                  IF ("Source Type" = "Source Type"::RentalUnit) AND ("Source No." <> "Project No.") THEN
                                                                    VALIDATE("Project No.", "Source No.");
                                                                END;
                                                                IF "Source No." <> xRec."Source No." THEN
                                                                  "Source No. 2" := '';
                                                              END;

                                                   CaptionML=[ENU=Source No.;
                                                              NOR=Kildenr.;
                                                              SVE=Ursprungsnr] }
    { 402 ;   ;Source No. 2        ;Code20        ;TableRelation=IF (Source Type=CONST(Plant)) "Plant Number".No. WHERE (Plant Type=FIELD(Source No.))
                                                                 ELSE IF (Source Type=CONST(RentalUnit)) "Rental Unit"."Rental Unit" WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                IF "Source No. 2" <> '' THEN BEGIN
                                                                  TESTFIELD("Source Type");
                                                                  TESTFIELD("Source No.");
                                                                  IF NOT ("Source Type" IN ["Source Type"::Plant, "Source Type"::RentalUnit]) THEN
                                                                    FIELDERROR("Source Type");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Source No. 2;
                                                              NOR=Kildenr. 2;
                                                              SVE=K„lla nr 2];
                                                   Description=Used for Sources No. with more than one field }
    { 410 ;   ;Source Contact No.  ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                lvContRec@1100485000 : Record 5050;
                                                              BEGIN
                                                                IF "Source Contact No." <> '' THEN BEGIN
                                                                  lvContRec.GET("Source Contact No.");
                                                                  "Source Contact Name" := lvContRec.Name;
                                                                  IF "Source Contact No." <> xRec."Source Contact No." THEN BEGIN
                                                                    "Source Phone No." := lvContRec."Phone No.";
                                                                    IF (lvContRec."Phone No." <> '') AND (lvContRec."Mobile Phone No." <> '') THEN
                                                                      "Source Phone No." := "Source Phone No." + '/';
                                                                    IF STRLEN("Source Phone No.") + STRLEN(lvContRec."Mobile Phone No.") < MAXSTRLEN("Source Phone No.") THEN
                                                                      "Source Phone No." := "Source Phone No." + lvContRec."Mobile Phone No.";
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Source Contact No.;
                                                              NOR=Kilde Kontaktnr.;
                                                              SVE=K„lla kontakt] }
    { 411 ;   ;Source Contact Name ;Text100       ;CaptionML=[ENU=Source Contact Name;
                                                              NOR=Kilde Kontaktnavn;
                                                              SVE=K„lla kontaktnamn] }
    { 412 ;   ;Source Phone No.    ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Source Phone No.;
                                                              NOR=Kilde Telefonnr.;
                                                              SVE=K„lla telefonnr] }
    { 420 ;   ;Document Type Filter;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Document Type Filter;
                                                              NOR=Dokumenttypefilter;
                                                              SVE=Dokumenttypfilter];
                                                   OptionCaptionML=[ENU=" ,Sales Quote,Sales Order,Sales Invoice,Credit Memo,Purch. Quote,Purch. Order,,,Plant Order,Transport Order(Plant)";
                                                                    NOR=" ,Salgstilbud,Salgsordre,Salgsfaktura,Kreditnota,Innkj›pstilbud,Innkj›psordre,,,Maskinordre,Transportordre(Maskin)";
                                                                    SVE=" ,F”rs„ljningsoffert,F”rs„ljningsorder,F”rs„ljningsfaktura,Kreditnota,Ink”p. Offert,Ink”p. Order,,,Maskinorder,Transportorder(Maskin)"];
                                                   OptionString=[ ,Q-S,O-S,PI-S,PM-S,Q-P,O-P,,,PO-Pl,TO-Pl];
                                                   Description=Must have same options as in table 11012457 (field 30) }
    { 421 ;   ;Doc. Type Filter On Complaint;Boolean;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Exist("Complaint Document" WHERE (Complaint No.=FIELD(No.),
                                                                                                 Document Type=FIELD(Document Type Filter)));
                                                   CaptionML=[ENU=Document Type Filter on Complaint;
                                                              NOR=Dokumenttypefilter p† Klage;
                                                              SVE=Dokumenttypfilter, klagom†l];
                                                   Editable=No }
    { 450 ;   ;Buyer               ;Code20        ;TableRelation=Contact;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Contact No.");
                                                                CALCFIELDS("Name Buyer");
                                                              END;

                                                   CaptionML=[ENU=Buyer;
                                                              NOR=Kj›per;
                                                              SVE=K”pare] }
    { 460 ;   ;Complaint about     ;Option        ;CaptionML=[ENU=Complaint about;
                                                              NOR=Klage om;
                                                              SVE=Klagom†l om];
                                                   OptionCaptionML=[ENU=General,Project,Plot,Delivery,Delivered Object;
                                                                    NOR=Generell,Prosjekt,Tegning,Leveranse,Levert Objekt;
                                                                    SVE=Allm„nt,Projekt,Ritning,Leverans,Levererat objekt];
                                                   OptionString=General,Project,Plot,Delivery,Delivered Object }
    { 470 ;   ;External Contract No.;Code20       ;CaptionML=[ENU=External Contract No.;
                                                              NOR=Eksternt kontraktsnr;
                                                              SVE=Externt avtalsnummer] }
    { 480 ;   ;Unit Description    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Units per House Model".Description WHERE (Project No.=FIELD(Project No.),
                                                                                                                 Model=FIELD(House Model),
                                                                                                                 Unit=FIELD(Unit)));
                                                   CaptionML=[ENU=Unit Description;
                                                              NOR=Enhetsbeskrivelse;
                                                              SVE=Enhetsbeskrivning];
                                                   Editable=No }
    { 481 ;   ;Name Buyer          ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Buyer)));
                                                   CaptionML=[ENU=Name Buyer;
                                                              NOR=Navn, Kj›per;
                                                              SVE=Namn, k”pare] }
    { 500 ;   ;Complaint Address   ;Text100       ;CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress] }
    { 510 ;   ;Complaint Post Code ;Code20        ;TableRelation=IF (Complaint Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Complaint Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Complaint Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Complaint City",
                                                                  "Complaint Post Code",
                                                                  "Complaint County",
                                                                  "Complaint Country/Region Code",
                                                                  (CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Postal Code;
                                                              NOR=Postnummer;
                                                              SVE=Postnummer] }
    { 520 ;   ;Complaint City      ;Text30        ;TableRelation=IF (Complaint Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Complaint Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Complaint Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Complaint City",
                                                                  "Complaint Post Code",
                                                                  "Complaint County",
                                                                  "Complaint Country/Region Code",
                                                                  (CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Poststed;
                                                              SVE=Ort] }
    { 530 ;   ;Complaint County    ;Text30        ;CaptionML=[ENU=County;
                                                              NOR=Fylke/delstat;
                                                              SVE=Delstat] }
    { 540 ;   ;Complaint Country/Region Code;Code10;
                                                   TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode;
                                                              SVE=Lands-/regionkod] }
    { 550 ;   ;Incident Date       ;Date          ;CaptionML=ENU=Incident Date }
    { 560 ;   ;Feedback Date       ;Date          ;CaptionML=ENU=Feedback Date }
    { 570 ;   ;No. of Assignments  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Project Assignment" WHERE (Complaint No.=FIELD(No.)));
                                                   CaptionML=ENU=No. of Assignments;
                                                   Editable=No }
    { 580 ;   ;No. of Open Assignments;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Project Assignment" WHERE (Complaint No.=FIELD(No.),
                                                                                                 Commision Status=FILTER(To Provide|Order)));
                                                   CaptionML=ENU=No. of Open Assignments;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Project No.                              }
    {    ;Project No.,Plot No.,Delivery            }
    {    ;Delivered Object                         }
    {    ;Source Type,Source No.,Source No. 2      }
    {    ;Call Date                                }
    {    ;Sales Invoice                            }
    {    ;Credit Memo                              }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@11012005 : TextConst 'ENU=Can''t remove complaint due to status;NOR=Kan ikke fjerne klage p.g.a. status;SVE=Kan inte ta bort klagom†l p.g.a. status';
      Text001@11012006 : TextConst 'ENU=There are still assignments for this complaint which have not been finished.;NOR=Det finnes fortsatt tilordninger for denne klagen som enda ikke er behandlet.;SVE=Det finns fortfarande tilldelningar f”r detta klagom†l som „nnu inte har behandlats.';
      ProjSetUp@11012000 : Record 315;
      ComplaintNotRec@11012003 : Record 11012454;
      ComplaintPrincRec@11012004 : Record 11012456;
      Text002@1100485000 : TextConst 'ENU=The fields Handling, Cause and Date Solved must be filled.;NOR=Felt for H†ndtering, rsak og Dato for L›sning m† fylles ut.;SVE=F„lt f”r hantering, orsak och datum f”r l”sning m†ste fyllas i.';
      ComplaintSetupRec@1100485001 : Record 11012108;
      ProjRec@1100485007 : Record 11072003;
      PlotRec@1100485003 : Record 11012500;
      DeliveryRec@1100485004 : Record 11012507;
      DeliveredObject@1100485005 : Record 11012101;
      UserSetupRec@1100485006 : Record 91;
      ComplaintUrgency@1100525000 : Record 11012451;
      PostCode@1100525003 : Record 225;
      NoSeriesMgt@1100525002 : Codeunit 396;
      DPA_Management@1100000999 : Codeunit 11012783;
      Text003@1100525004 : TextConst 'ENU=The %1 of all linked %2s will be cleared. Do yo want to continue?;NOR=%1 av alle linkede %2 kommer vil renses. Vil du fortsette?;SVE=%1 av alla l„nkade %2 kommer att rensas. Vill du forts„tta?';
      Text004@1210190000 : TextConst 'ENU=%1 is already linked to %2 %3\First unlink, please.;NOR=%1 er allerede linket til %2 %3\Fjern link f›rst.;SVE=%1 „r redan l„nkat till %2 %3\Avl„nka f”rst.';
      ComplaintsSetupRead@1210190001 : Boolean;
      Text005@1210190003 : TextConst 'ENU=Can''t edit complaint due to status;NOR=Kan ikke redigere klage p.g.a. status;SVE=Kan inte redigera klagom†l p.g.a. status';
      Text006@1100525001 : TextConst 'ENU=''%1'' may not be less than %2 ''%3'';NOR=''%1'' kan ikke v‘re mindre enn %2 ''%3'';SVE=(%1) f†r inte vara mindre „n %2 (%3)';
      FPSLicenseManagement@1100527400 : Codeunit 11229289;

    PROCEDURE AssistEdit@2(OldComplaint@11012000 : Record 11012450) : Boolean;
    VAR
      Complaint@11012001 : Record 11012450;
    BEGIN
      WITH Complaint DO BEGIN
        Complaint := Rec;
        IF NoSeriesMgt.SelectSeries(GetComplaintNoSerie,OldComplaint."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := Complaint;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE FillContactFields@1100485000();
    VAR
      lContactRec@1100485001 : Record 5050;
    BEGIN
      IF ("Contact No." <> '') AND lContactRec.GET("Contact No.") THEN BEGIN
        "Contact Name" := lContactRec.Name;
        "Contact Name 2" := lContactRec."Name 2" ;
        "Contact Address" := lContactRec.Address;
        "Contact Address 2" := lContactRec."Address 2" ;
        "Contact Post Code" := lContactRec."Post Code";
        "Contact City" := lContactRec.City;
        "Contact County" := lContactRec.County;
        "Contact Country/Region Code" := lContactRec."Country/Region Code";
        "Contact Phone" := lContactRec."Phone No." ;
        "Contact Phone 2" := lContactRec."Phone No. 2" ;
        "Contact Mobile Phone" := lContactRec."Mobile Phone No."  ;
        "Contact E-Mail" := lContactRec."E-Mail" ;
        "Contact Mobile Phone 2" :=  lContactRec."Mobile Phone No. 2" ;
        "Contact Phone Work" := lContactRec."Phone No. Work" ;
        "Contact Phone Work 2" := lContactRec."Phone No. Work 2";
      END ELSE BEGIN
        IF "Delivered Object" <> ''  THEN BEGIN
          IF DeliveredObject.GET("Delivered Object") THEN BEGIN
            "Contact Name" := DeliveredObject."Contact Name";
            "Contact Name 2" := DeliveredObject."Contact Name 2" ;
            "Contact Address" := DeliveredObject.Address;
            "Contact Address 2" := DeliveredObject."Address 2" ;
            "Contact Post Code" := DeliveredObject."Post Code";
            "Contact City" := DeliveredObject.City;
            "Contact County" := DeliveredObject.County;
            "Contact Country/Region Code" := DeliveredObject."Country/Region Code";
            "Contact Phone" := DeliveredObject."Contact Phone" ;
            "Contact Phone 2" := DeliveredObject."Contact Phone 2" ;
            "Contact Mobile Phone" := DeliveredObject."Contact Mobile Phone"  ;
            "Contact E-Mail" := DeliveredObject."Contact E-Mail" ;
            "Contact Mobile Phone 2" :=  DeliveredObject."Contact Mobile Phone 2" ;
            "Contact Phone Work" := DeliveredObject."Contact Phone Work" ;
            "Contact Phone Work 2" := DeliveredObject."Contact Phone Work 2";
          END
        END;
      END;
    END;

    PROCEDURE GetContactProjectPrincipal@1100485001() : Code[20];
    VAR
      lContBusRel@1100485000 : Record 5054;
    BEGIN
      lContBusRel.SETRANGE("Link to Table",lContBusRel."Link to Table"::Customer);
      lContBusRel.SETRANGE("No.","Project Principal");
      IF lContBusRel.FIND('-') THEN
        EXIT(lContBusRel."Contact No.");

      EXIT('');
    END;

    PROCEDURE FillProjectPrincipal@1100485005();
    BEGIN
      IF "Delivered Object" <> ''  THEN
        EXIT;

      IF ("Project No." <> '') AND ("Plot No." <> '') THEN BEGIN
        PlotRec.GET("Project No.","Plot No.");
        Buyer := PlotRec.Buyer;
        VALIDATE("Project Principal", PlotRec.Principal);
      END ELSE BEGIN
        IF "Project No." <> '' THEN BEGIN
          ProjRec.GET("Project No.");
          VALIDATE("Project Principal", ProjRec."Bill-to Customer No.");
        END;
      END;
    END;

    PROCEDURE GetComplaintNoSerie@1100485003() : Code[20];
    BEGIN
      ProjSetUp.GET;

      CASE "Complaint about" OF
        "Complaint about"::Project:
          BEGIN
            ProjSetUp.TESTFIELD("Complaint Project Nos.");
            EXIT(ProjSetUp."Complaint Project Nos.");
          END;
        "Complaint about"::Plot:
          BEGIN
            ProjSetUp.TESTFIELD("Complaint Plot Nos.");
            EXIT(ProjSetUp."Complaint Plot Nos.");
          END;
        "Complaint about"::Delivery:
          BEGIN
            ProjSetUp.TESTFIELD("Complaint Delivery Nos.");
            EXIT(ProjSetUp."Complaint Delivery Nos.");
          END;
        "Complaint about"::"Delivered Object":
          BEGIN
            ProjSetUp.TESTFIELD("Complaint Delivered Obj. Nos.");
            EXIT(ProjSetUp."Complaint Delivered Obj. Nos.");
          END;
        ELSE
          BEGIN
            ProjSetUp.TESTFIELD("Complaint Nos.");
            EXIT(ProjSetUp."Complaint Nos.");
          END;
      END;
    END;

    PROCEDURE GetSourceDescription@1100485004() : Text[100];
    VAR
      lvCustRec@1100485000 : Record 18;
      lvVendRec@1100485001 : Record 23;
      lvDimValRec@1100485002 : Record 349;
      lvPlantTypeRec@1100485004 : Record 11012551;
      lvPlantNoRec@1100485005 : Record 11012552;
      lvPlantLocRec@1100485007 : Record 11012554;
      lvRentalUnitRec@1100485003 : Record 11012940;
      lvServiceOrder@1210190000 : Record 11012823;
      lvDimMgtCU@1100485006 : Codeunit 408;
    BEGIN
      CASE "Source Type" OF
        "Source Type"::Cust:
          BEGIN
            IF lvCustRec.GET("Source No.") THEN
              EXIT(lvCustRec.Name);
          END;
        "Source Type"::Vend:
          BEGIN
            IF lvVendRec.GET("Source No.") THEN
              EXIT(lvVendRec.Name);
          END;
        "Source Type"::Dept:
          BEGIN
            lvDimMgtCU.GetDimValueRec(1, "Source No.", lvDimValRec, FALSE, '');
            EXIT(lvDimValRec.Name);
          END;
        "Source Type"::Plant:
          BEGIN
            IF ("Source No. 2" = '') THEN BEGIN
              IF lvPlantTypeRec.GET("Source No.") THEN
                EXIT(lvPlantTypeRec.Description);
            END ELSE BEGIN
              IF lvPlantNoRec.GET("Source No.", "Source No. 2") THEN
                EXIT(lvPlantNoRec.Description);
            END;
          END;
        "Source Type"::PlantLoc:
          BEGIN
            IF lvPlantLocRec.GET("Source No.") THEN
              EXIT(lvPlantLocRec.Description);
          END;
        "Source Type"::RentalUnit:
          BEGIN
            IF lvRentalUnitRec.GET("Source No.", "Source No. 2") THEN
              EXIT(lvRentalUnitRec.Description);
          END;
        "Source Type"::ServOrder:
          BEGIN
            IF lvServiceOrder.GET("Source No.") THEN
              EXIT(lvServiceOrder.Description);
          END;
      END;

      EXIT('');
    END;

    PROCEDURE LookupSourceContact@1(IEditable@1100485005 : Boolean);
    VAR
      lvContBusRelRec@1000 : Record 5054;
      lvContRec@1001 : Record 5050;
      lvContRec2@1100485003 : Record 5050;
      lvContRec3@1100485001 : Record 5050;
    BEGIN
      lvContBusRelRec.SETCURRENTKEY("Link to Table","No.");
      IF ("Source Type" IN ["Source Type"::Cust, "Source Type"::Vend]) THEN BEGIN
        IF ("Source Type" = "Source Type"::Cust) THEN
          lvContBusRelRec.SETRANGE("Link to Table", lvContBusRelRec."Link to Table"::Customer)
        ELSE
          lvContBusRelRec.SETRANGE("Link to Table", lvContBusRelRec."Link to Table"::Vendor);
        lvContBusRelRec.SETRANGE("No.", "Source No.");
        IF lvContBusRelRec.FIND('-') THEN BEGIN
          IF NOT lvContRec2.GET(lvContBusRelRec."Contact No.") THEN
            CLEAR(lvContRec2);
        END;

        lvContRec.RESET;
        lvContRec.SETRANGE("Company Name", lvContRec2."Company Name");
        lvContRec.SETRANGE("Company No.", lvContRec2."Company No.");
        lvContRec."Company Name" := lvContRec2."Company Name";
        lvContRec."Company No." := lvContRec2."Company No.";
        IF lvContRec3.GET("Source Contact No.") THEN BEGIN
          IF (lvContRec3."Company No." = lvContRec2."Company No.") THEN
            lvContRec := lvContRec3;
        END;
      END ELSE BEGIN
        IF NOT lvContRec.GET("Source Contact No.") THEN
          CLEAR(lvContRec);
      END;

      IF NOT IEditable THEN
        PAGE.RUNMODAL(0, lvContRec)
      ELSE BEGIN
        IF PAGE.RUNMODAL(0, lvContRec) = ACTION::LookupOK THEN
          VALIDATE("Source Contact No.", lvContRec."No.");
      END;
    END;

    PROCEDURE ShowPlantInventory@1100485006();
    VAR
      lvPlantNoRec@1100485003 : Record 11012552;
      lvInventoryRec@1100485001 : Record 11012555;
      lvInventoryPage@1100485000 : Page 11012559;
    BEGIN
      IF ("Source Type" <> "Source Type"::Plant) THEN
        EXIT;

      lvInventoryRec.SETCURRENTKEY(Removed, "Plant Type" , "Plant No.");
      lvInventoryRec.SETRANGE(Removed,FALSE);
      IF ("Source No." <> '') THEN
        lvInventoryRec.SETRANGE("Plant Type", "Source No.");
      lvInventoryRec.Removed := FALSE;
      lvInventoryRec."Plant Type" := "Source No.";
      lvInventoryRec."Plant No." := "Source No. 2";
      IF ("Source No." <> '') AND ("Source No. 2" <> '') THEN BEGIN
        IF lvPlantNoRec.GET("Source No.", "Source No. 2") THEN BEGIN
          lvPlantNoRec.CALCFIELDS(Bulk);
          IF lvPlantNoRec.Bulk AND (lvPlantNoRec."Stock No." <> "Source No. 2") THEN
            lvInventoryRec."Plant No." := lvPlantNoRec."Stock No.";
        END;
      END;

      lvInventoryPage.SetDetailSelection(2);  // 2=PlantNo
      lvInventoryPage.SetInventoryLocationsSameProjectDisabled;
      lvInventoryPage.SETTABLEVIEW(lvInventoryRec);
      lvInventoryPage.SETRECORD(lvInventoryRec);
      lvInventoryPage.RUNMODAL;
    END;

    PROCEDURE CalculatedLeadTimeDays@1100485002();
    VAR
      lvDateRec@1100485000 : Record 2000000007;
      lvCalendarMgtCU@1100485001 : Codeunit 7600;
      lvDescription@1100485002 : Text[100];
    BEGIN
      IF ("Call Date" = 0D) OR ("Solving Date" = 0D) OR ("Solving Date" < "Call Date") THEN BEGIN
        "Lead Time in Days" := 0;
        EXIT;
      END;

      "Lead Time in Days" := "Solving Date" - "Call Date" + 1;

      GetComplaintSetup;
      IF ComplaintSetupRec."Complaint Calendar" <> '' THEN BEGIN
        lvDateRec.SETRANGE("Period Type", lvDateRec."Period Type"::Date);
        lvDateRec.SETRANGE("Period Start", "Call Date", "Solving Date");
        IF lvDateRec.FINDSET(FALSE, FALSE) THEN BEGIN
          REPEAT
            IF lvCalendarMgtCU.CheckDateStatus(ComplaintSetupRec."Complaint Calendar", lvDateRec."Period Start",lvDescription) THEN
              "Lead Time in Days" := "Lead Time in Days" - 1;  //* Return value 'True' is Nonworking Day
          UNTIL lvDateRec.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE CalcExpectedSolvingDate@1100525002();
    VAR
      EndDate@1100525003 : DateTime;
      StartDate@1100525002 : DateTime;
      TimeUsed@1100525001 : Duration;
      TimeSpend@1100525000 : Time;
      lvDate@1100525006 : Date;
      lvCalendarMgtCU@1100525005 : Codeunit 7600;
      lvDescription@1100525004 : Text[100];
    BEGIN
      //Calculate the Planned Solving Date based on the logdate of the complaint and the resolve time
      //which is registered in the Complaint Urgency table (decimal).
      IF ("Call Date" = 0D) OR (Urgency = '') THEN
        EXIT;

      ComplaintUrgency.GET(Urgency);
      IF ComplaintUrgency."Resolve Time (Days)" > 0 THEN BEGIN
        StartDate := CREATEDATETIME("Call Date",TimeSpend);
        TimeUsed := (ComplaintUrgency."Resolve Time (Days)" * 24 * 3600000);
        EndDate := StartDate + TimeUsed;
        "Expected Solving Date" := DT2DATE(EndDate);
        IF "Expected Solving Date" >= "Call Date" THEN BEGIN
          GetComplaintSetup;
          IF ComplaintSetupRec."Complaint Calendar" <> '' THEN BEGIN
            lvDate := "Call Date";
            REPEAT
              IF lvCalendarMgtCU.CheckDateStatus(ComplaintSetupRec."Complaint Calendar", lvDate,lvDescription) THEN
                "Expected Solving Date" := "Expected Solving Date" + 1;  //* Return value 'True' is Nonworking Day
              lvDate := lvDate + 1;
            UNTIL (lvDate > "Expected Solving Date");
          END;
        END;
      END;
    END;

    PROCEDURE GetProjectDescription@1100525000() : Text[100];
    VAR
      lvDelObjectRec@1100525000 : Record 11012101;
    BEGIN
      CALCFIELDS("Project Description");
      IF ("Project Description" = '') AND ("Project No." <> '') THEN BEGIN
        IF ("Delivered Object" <> '') THEN BEGIN
          IF lvDelObjectRec.GET("Delivered Object") THEN
            EXIT(lvDelObjectRec."Original Project Description");
        END;
      END;
      EXIT("Project Description");
    END;

    PROCEDURE GetUnitDescription@1100525001() : Text[50];
    BEGIN
      IF Unit <> '' THEN BEGIN
        CALCFIELDS("House Model");
        CALCFIELDS("Unit Description");  //* Unit Description is a flowfield but CalcFormula contains flowfield "House Model"
        EXIT("Unit Description");
      END;
      EXIT('');
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(11012450) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 11012450');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::Complaint, "Source No.", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Source No."));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Source No.");
    END;

    LOCAL PROCEDURE UpdateComplNoOfQADeviations@1100525003();
    VAR
      QADeviation@1100525000 : Record 11125986;
    BEGIN
      QADeviation.SETCURRENTKEY("Complaint No.");
      QADeviation.SETRANGE("Complaint No.", "No.");
      QADeviation.MODIFYALL("Complaint No.", '');
    END;

    LOCAL PROCEDURE QADeviationsAreLinkedToCompl@1100525004() : Boolean;
    VAR
      QADeviation@1100525000 : Record 11125986;
    BEGIN
      IF "No." = '' THEN //CALL T001203
        EXIT(FALSE);

      QADeviation.SETCURRENTKEY("Complaint No.");
      QADeviation.SETRANGE("Complaint No.", "No.");
      IF QADeviation.ISEMPTY THEN
        EXIT(FALSE)
      ELSE
        EXIT(TRUE);
    END;

    PROCEDURE LinkSmallProject@1210190000();
    VAR
      JobRec@1210190000 : Record 11072003;
    BEGIN
      //kzwerver, 110802, c, #26039
      GetComplaintSetup;
      TestLinkSmallProjectIsAllowed;
      IF (ComplaintSetupRec."Small Project Company" <> '') THEN
        JobRec.CHANGECOMPANY(ComplaintSetupRec."Small Project Company");
      JobRec.SETRANGE("Small Project", TRUE);
      JobRec.SETFILTER("Origin Complaint No.", '%1', '');
      IF (PAGE.RUNMODAL(0, JobRec) = ACTION::LookupOK) THEN BEGIN
        "Small Project Company" := '';
        IF (ComplaintSetupRec."Small Project Company" <> '') THEN
          "Small Project Company" := ComplaintSetupRec."Small Project Company";
        "Small Project No." := JobRec."No.";
        MODIFY;
        JobRec."Origin Complaint Company" := '';
        IF (ComplaintSetupRec."Small Project Company" <> '') THEN
          JobRec."Origin Complaint Company" := COMPANYNAME;
        JobRec."Origin Complaint No." := "No.";
        JobRec.MODIFY;
      END;
    END;

    PROCEDURE UnLinkSmallProject@1210190001();
    VAR
      JobRec@1210190000 : Record 11072003;
    BEGIN
      //kzwerver, 110802, c, #26039
      IF ("Small Project Company" <> '') THEN
        JobRec.CHANGECOMPANY("Small Project Company");
      IF (JobRec.GET("Small Project No.")) THEN BEGIN
        JobRec."Origin Complaint Company" := '';
        JobRec."Origin Complaint No." := '';
        JobRec.MODIFY;
        "Small Project Company" := '';
        "Small Project No." := '';
        MODIFY;
      END;
    END;

    PROCEDURE TestLinkSmallProjectIsAllowed@1210190002();
    VAR
      JobRec@1210190000 : Record 11072003;
    BEGIN
      IF ("Small Project No." <> '') THEN
        ERROR(Text004, TABLECAPTION, JobRec.TABLECAPTION, "Small Project No.");
    END;

    PROCEDURE GetComplaintSetup@1210190004();
    BEGIN
      IF (NOT ComplaintsSetupRead) THEN
        ComplaintsSetupRead := ComplaintSetupRec.GET('');
    END;

    PROCEDURE EditDocuments@1100528702(ContactNo@1210190004 : Code[20];ContactPersonNo@1210190005 : Code[20];SendMail@1210190002 : Boolean;Recipient@1100528700 : Text[120]);
    VAR
      DocumentTemplate@1210190001 : Record 11012401;
      DocumentMailing@1210190000 : Codeunit 11012278;
      RecRef@1100525000 : RecordRef;
      DocumentLinkRIDs@1100525001 : ARRAY [5] OF RecordID;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentLinkRIDs[1] := RecRef.RECORDID;

      DocumentMailing.EditDocuments(
        STRSUBSTNO('%1', DocumentTemplate.Type::Complaint), DocumentLinkRIDs, '', ContactNo, ContactPersonNo, SendMail, Recipient);
    END;

    BEGIN
    {
      kk, 09-11-2010: Added functions UpdateComplNoOfQADeviations and QADeviationsAreLinkedToCompl for rfc369.
    }
    END.
  }
}

