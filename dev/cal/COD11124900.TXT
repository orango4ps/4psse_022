OBJECT Codeunit 11124900 Graph. Resource Planning Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      ResourcePlanningSetup@1100525000 : Record 11124900;
      ResourcePlanningUserSetup@1100529105 : Record 11124910;
      TmpWorkOrderExported@1100529000 : TEMPORARY Record 11124906;
      Text000@1100529003 : TextConst 'ENU=Event Type;SVE=H„ndelsetyp';
      Text001b@1100529002 : TextConst 'ENU=Absence;SVE=Fr†nvaro';
      Text002@1100529004 : TextConst 'ENU=Request Type';
      OrgAdditionalInfoRequestWO@1100529005 : Record 11124915;
      Text003@1100528300 : TextConst 'ENU=Request SourceType';
      GeneralLedgerSetup@1100529156 : Record 98;
      Text004@1100528303 : TextConst 'ENU=modify from ''%1'' in ''%2'' not allowed';
      Text005@1100528304 : TextConst 'ENU=All work orders of the request are deleted. \Delete request ''%1'' also?';
      Text006@1100529100 : TextConst 'ENU=Request SubType';
      Text007@1100529101 : TextConst 'ENU=Serviceorder Priority';
      Text008@1100529102 : TextConst 'ENU=Event Filter';
      Text009@1100529103 : TextConst 'ENU=Resource Filter;SVE=Resursfilter';
      Text010@1100528306 : TextConst 'ENU=Resource unavailable';
      Text011@1100528307 : TextConst 'ENU=Resource without FSA';
      Text012@1100528308 : TextConst 'ENU=Work order unavailable';
      Text013@1100528309 : TextConst 'ENU=Blokking reference point';
      ResourceGroupTypeOption@1100528501 : ',Discipline,PlantType';
      TempEventType@1100529107 : TEMPORARY Record 11124911;
      Text014@1100529116 : TextConst 'ENU=Not available for resource request';
      Text015@1100529117 : TextConst 'ENU=Not available for fixed events';
      Text016@1100529120 : TextConst 'ENU=The following resources are double-planned:';
      Text017@1100529119 : TextConst 'ENU=The following resources are not available:';
      Text018@1100529121 : TextConst 'ENU=Warning!;SVE=Varning!';
      Text019@1100529147 : TextConst 'ENU=Your user settings may limit the operation of resource planning:';
      Text021@1100529149 : TextConst 'ENU=\There are no resource filters active.';
      Text022@1100529150 : TextConst 'ENU=\There are no event filters active.';
      Text023@1100529151 : TextConst 'ENU=\\Do you want to adjust your settings?';
      Text024@1100529152 : TextConst 'ENU=\The event text selection is not filled.';
      Text025@1100529153 : TextConst 'ENU=\The event popup selection is not filled.';
      Text026@1100529154 : TextConst 'ENU=New user settings have been created for you. \Do you want to change it?';
      Text027@1100529176 : TextConst 'ENU=No Resources Available in the Current View.';
      Text028@1100529179 : TextConst 'ENU=hour;SVE=Timme';
      Text029@1100529180 : TextConst 'ENU=From;SVE=Fr†n';
      Text029b@1100529193 : TextConst 'ENU=until;SVE=Till';
      Text030@1100529181 : TextConst 'ENU=Master Project;SVE=Originalprojekt';
      Text031@1100529183 : TextConst 'ENU=Absence;SVE=Fr†nvaro';
      Text032@1100529190 : TextConst 'ENU=Absence Plant';
      Text033@1100529191 : TextConst 'ENU=Absence Employee';
      Text034@1100529192 : TextConst 'ENU=Ref. Point';
      Text035@1100529194 : TextConst 'ENU=Request;SVE=F”rfr†gan';
      Text036@1100529195 : TextConst 'ENU=Duration;SVE=Duration';
      Text037@1100528500 : TextConst 'ENU=Absence move to other Resource not allowed.';
      Text038@1100525003 : TextConst 'ENU=The following work order(s) are moved out of the planning horizon:';
      Text039@1100525005 : TextConst 'ENU=Location;SVE=Lagerst„lle';
      Text040@1100525007 : TextConst 'ENU=Field Service Status Reason';
      IconInfo@1100529108 : TextConst 'ENU="<i class=""fa fa-fw fa-info""></i>"';
      IconEmail@1100529109 : TextConst 'ENU="<i class=""fa fa-fw fa-envelope""></i>"';
      IconFilter@1100529110 : TextConst 'ENU="<i class=""fa fa-fw fa-filter""></i>"';
      IconDelete@1100529111 : TextConst 'ENU="<i class=""fa fa-fw fa-trash-o""></i>"';
      IconRemove@1100529113 : TextConst 'ENU="<i class=""fa fa-fw fa-times""></i>"';
      IconPerson@1100529114 : TextConst 'ENU="<i class=""fa fa-fw fa-user""></i>"';
      IconExport@1100529115 : TextConst 'ENU="<i class=""fa fa-fw fa-paper-plane""></i>"';
      IconCreate@1100529118 : TextConst 'ENU="<i class=""fa fa-fw fa-plus""></i>"';
      IconOpenSource@1100529122 : TextConst 'ENU="<i class=""fa fa-fw fa-newspaper-o""></i>"';
      TempServicePriority@1100529104 : TEMPORARY Record 11012829;
      TempServiceOrderIndication@1100529106 : TEMPORARY Record 11012837;
      TempReferencePoint@1100529123 : TEMPORARY Record 11020271;
      TempDimensionValue@1100529157 : TEMPORARY Record 349;
      ResourcesAvailable@1100529175 : Boolean;
      EnableResourceFilterLabel@1100529124 : Boolean;
      EnableResourceTypeLabel@1100529125 : Boolean;
      EnableExternalLabel@1100529126 : Boolean;
      EnableDisciplineLabel@1100529127 : Boolean;
      EnableQualificationLabel@1100529128 : Boolean;
      EnablePlantTypeWithGroupsLabel@1100529129 : Boolean;
      EnableTradeSpecialityLabel@1100529130 : Boolean;
      EnablePlannerLabel@1100529131 : Boolean;
      EnableDimension1ResourceLabel@1100529155 : Boolean;
      EnableEventFilterLabel@1100529132 : Boolean;
      EnableRequestSourceTypeLabel@1100529134 : Boolean;
      EnableRequestTypeLabel@1100529135 : Boolean;
      EnableRequestSubTypeLabel@1100529136 : Boolean;
      EnablePriorityLabel@1100529137 : Boolean;
      EnableOrderManagerLabel@1100529138 : Boolean;
      EnableProjectManagerLabel@1100529139 : Boolean;
      EnableAssignedToLabel@1100529140 : Boolean;
      EnableAddressLabel@1100529158 : Boolean;
      EnablePostCodeLabel@1100529141 : Boolean;
      EnableCityLabel@1100529142 : Boolean;
      EnableServiceOrderKindLabel@1100529143 : Boolean;
      EnableServiceOrderTypeLabel@1100529144 : Boolean;
      EnableContractManagerLabel@1100529145 : Boolean;
      EnableDimension1EventLabel@1100529146 : Boolean;
      EnableSourceNoLabel@1100529159 : Boolean;
      EnableSourceDescriptionLabel@1100529160 : Boolean;
      EnableReferencePointDescriptionLabel@1100529161 : Boolean;
      EnableTypeNoLabel@1100529162 : Boolean;
      EnableTypeDescriptionLabel@1100529163 : Boolean;
      EnableLocationLabel@1100525010 : Boolean;
      EnableWorkorderNoLabel@1100529164 : Boolean;
      EnableWorkorderDescriptionLabel@1100529165 : Boolean;
      EnableSourceLabel@1100529166 : Boolean;
      EnableReferencePointLabel@1100529167 : Boolean;
      EnableEventTypeLabel@1100529168 : Boolean;
      EnableDurationTimeLabel@1100529172 : Boolean;
      EnableServiceOrderMasterProjectNumberLabel@1100529112 : Boolean;
      EnableServiceOrderMasterProjectDescriptionLabel@1100529173 : Boolean;
      EnableCommentsLabel@1100529174 : Boolean;
      IconPhone@1100529177 : TextConst 'ENU="<i class=""fa fa-fw fa-phone""></i>"';
      EnableInspectionNoLabel@1100529178 : Boolean;
      EnableTypeTextLabel@1100529182 : Boolean;
      ImagePerson@1100525001 : TextConst 'ENU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAAA+klEQVR4Ae3UAaYCURSH8Q8YMZD3AJoHtYMA7y2g1QS1ghdpAUlBIIACKKGW0FCAICiEjFJQpxAic2eaM1Du71vAnzH3gGXFZ+WoMmV3a0qVHKlyGXBBHrowwCUlDj7yHD4OqeggIXXQI885dOBMHrU6YqiO2sw44KN2NA4cUAuMA8EbfKKGcaCB2o/xN/XQo61/aGYOM/Op0HPpPx27Pi6p8qjcz/WECh7WR8lQokaXEXP2BCwY0eWfEhmUCpQZckJCOjGkTIFEioyRmI0p8pIsPeTFemSJ6ZctkqAtf8TwxQZJ2JpvIjURRS0iLVUDKyKJrgQDdsCyrCvFDgaZKmjtoQAAAABJRU5ErkJggg=="';
      ImagePlant@1100525002 : TextConst 'ENU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAACX0lEQVR4Ae3WA6wlWxBG4fVs27aNsW1bwdi2bdu2bdu2bePcWxON1Z2eynQle1XM/ztsXC6Xj57mNwrQjpmsZg9nuMJRtrCEIRTiG0LeL3TgHHKf20c7viSUPc10xOPNJjOPEbpicg7xfCuJEUbCRcTHDeEDQlZ8n4SD/GydcI4k1glR5LFOiBAnfIRLvgin+IqQldQnYQvPWSc0BtuECD9ZJ8wD/V7wTbjigxAP9YaTEX+l9kEYiXJvEkVEkRDFR6hWFkFUCbVQbRWiTFiMYi8hSABCxAMgmrdQKwVyCyG1ynuQA7XqIbfcFVIrfAvqotZoxAMh2HyhH2rNRTwQgs0XFqDWOsQbIcB/sbAbtfYj9yAk9fA0FALAUeQed4mkD2m+sBO1NiMeCMHmC9tRaz7igRBsvjBf9WfUAyHYfKEnarVEHkiIH3C+UAm1MiAPvIvEDzRfSI9ab3gacCHQ/Agvo9gGRPlmoFoddUBJVHuPaGVADZQbjyhfUVRLhVgnzLVO+JaIdUILxDbhJTZZJ3zOMQT9K4taMYlYJ+QmyjohCWesE75nn3XCa3Qm2jYB/mW9dcITZGK+bQLAn7Rlz30nbKYGrcNMAPiWknRhOruufzdOsoxB1OYvAKCNPkE5R3j0OUJN+4QmhKImYSI4giM4giM4giM4giO0cYSHVA37hLIBCA3tE2JYJ0wD24SzYJuwCWwTaoFlwgyeBLuEGTwHYJUwg2cArBIm68/XJEzmKQCrhLE8hYGK3nP+kwBWCcP152sSBvAExipN9PX5fXkMg8VjKefYSnXuk8vlugqjcfZs98exJQAAAABJRU5ErkJggg=="';
      TooltipInfoWorkorder@1100529133 : TextConst 'ENU=Open Work Order Card';
      TooltipInfoAbsence@1100529171 : TextConst 'ENU=Open Absence Registration';
      TooltipOpenServiceorder@1100529169 : TextConst 'ENU=Open Service Order Card';
      TooltipOpenProject@1100529186 : TextConst 'ENU=Open Project Card';
      TooltipOpenResourceRequest@1100529187 : TextConst 'ENU=Open Resource Request Card';
      TooltipOpenPlant@1100527705 : TextConst 'ENU=Open Plant Card';
      TooltipOpenPlantType@1100527708 : TextConst 'ENU=Open Plant Type Card';
      TooltipOpenEmployee@1100527704 : TextConst 'ENU=Open Employee Card';
      TooltipOpenSubcontractor@1100527703 : TextConst 'ENU=Open Subcontractor Card';
      TooltipCallResource@1100527702 : TextConst 'ENU=Call Resource';
      TooltipMailResource@1100527701 : TextConst 'ENU=Mail Resource';
      TooltipFilterEvent@1100529170 : TextConst 'ENU=Filter on Source Number';
      TooltipFilterResource@1100527700 : TextConst 'ENU=Filter on Linked Resources';
      TooltipDeleteWorkorder@1100529184 : TextConst 'ENU=Delete Workorder';
      TooltipExportFieldService@1100529185 : TextConst 'ENU=Send to Employee';
      TooltipCreateNextWorkorder@1100529188 : TextConst 'ENU=Create next Work Order;SVE=Skapa ny arbetsorder';
      TooltipUnplanWorkorder@1100529189 : TextConst 'ENU=Unplan Work Order';
      TooltipDeleteAbsence@1100529196 : TextConst 'ENU=Delete Absence';
      EnableTerritoryLabel@1100525004 : Boolean;
      EnableOnHoldLabel@1100525006 : Boolean;
      EnableFieldServiceReasonLabel@1100525009 : Boolean;
      GlobalVariantTrue@1100527707 : Variant;
      GlobalVariantFalse@1100527706 : Variant;

    [External]
    PROCEDURE ExportConfiguration@1100529009(VAR SchedulerConfig@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerConfig");
    VAR
      Resource@1100529006 : Record 11229278;
      WorkOrder@1100529004 : Record 11229279;
      PlantType@1100529005 : Record 11012551;
      Discipline@1100529101 : Record 11020204;
      Qualification@1100529100 : Record 5202;
      TradeSpeciality@1100529105 : Record 11020285;
      ResourceRequest@1100529102 : Record 11124901;
      CaptionDay@1100529008 : TextConst 'ENU=Day;SVE=Dag';
      CaptionWeek@1100529009 : TextConst 'ENU=Week;SVE=Vecka';
      CaptionMonth@1100529010 : TextConst 'ENU=Month;SVE=M†nad';
      CaptionToday@1100529011 : TextConst 'ENU=Today;SVE=Dagens datum';
      CaptionTomorrow@1100529012 : TextConst 'ENU=Tomorrow;SVE=I MORGON';
      CaptionNextWeek@1100529013 : TextConst 'ENU=Next Week;SVE=N„sta vecka';
      CaptionThisWeek@1100529014 : TextConst 'ENU=This Week';
      CaptionNextMonth@1100529015 : TextConst 'ENU=Next Month';
      CaptionThisMonth@1100529016 : TextConst 'ENU=This Month;SVE=Denna m†nad';
      CaptionCustomRange@1100529017 : TextConst 'ENU=Custom Range';
      CaptionFuture@1100529036 : TextConst 'ENU=Future;SVE=Framtid';
      CaptionPast@1100529007 : TextConst 'ENU=Past';
      CaptionMultipleNumberOfDays@1100529002 : TextConst 'ENU={{number}} days';
      CaptionSingleNumberOfDays@1100529001 : TextConst 'ENU={{number}} day';
      CaptionPrint@1100529018 : TextConst 'ENU="<i class=''fa fa-print''></i> Print"';
      CaptionFilter@1100529019 : TextConst 'ENU=Filter;SVE=Urval';
      CaptionResources@1100529020 : TextConst 'ENU=Resources;SVE=Resurser';
      CaptionEvents@1100529021 : TextConst 'ENU=Events';
      CaptionEventsPresent@1100528306 : TextConst 'ENU=Events present';
      CaptionOptionYes@1100528307 : TextConst 'ENU=Yes;SVE=Ja';
      CaptionOptionNo@1100528308 : TextConst 'ENU=No;SVE=Nej';
      CaptionClear@1100529022 : TextConst 'ENU="<i class=''fa fa-filter''></i> Clear"';
      CaptionNothingSelected@1100529023 : TextConst 'ENU=Nothing Selected';
      CaptionSettings@1100529024 : TextConst 'ENU=Settings;SVE=Inst„llningar';
      CaptionScaleSettings@1100525006 : TextConst 'ENU=Scale specific settings';
      CaptionScaleSettingsTitle@1100525007 : TextConst 'ENU={{scale}} settings';
      CaptionScaleDuration@1100529025 : TextConst 'ENU=Scale;SVE=Skala';
      CaptionShowTimeIndicators@1100529026 : TextConst 'ENU=Show Time on Move';
      CaptionAutoRefresh@1100529027 : TextConst 'ENU=Auto Refresh';
      CaptionRefreshIntervalSec@1100529028 : TextConst 'ENU=Refresh Interval (sec)';
      CaptionScaleSnapToGrid@1100529029 : TextConst 'ENU=Snap to Grid';
      CaptionScaleGridSize@1100529170 : TextConst 'ENU=Minimum step (in minutes) for event time values';
      CaptionScaleDurationOptionQuarterHour@1100529030 : TextConst 'ENU=15 Minutes';
      CaptionScaleDurationOptionHalfHour@1100529031 : TextConst 'ENU=30 Minutes';
      CaptionScaleDurationOptionOneHour@1100529032 : TextConst 'ENU=1 Hour';
      CaptionScaleDurationOptionTwoHour@1100529033 : TextConst 'ENU=2 Hours';
      CaptionScaleDurationOptionHalfDay@1100529034 : TextConst 'ENU=12 Hours';
      CaptionScaleDurationOptionOneDay@1100529035 : TextConst 'ENU=1 Day';
      CaptionAbout@1100528300 : TextConst 'ENU=About this app';
      CaptionPlanningHorizon@1100528301 : TextConst 'ENU=Default Planning Horizon';
      ServiceOrder@1100529103 : Record 11012823;
      ServiceLocation@1100525008 : Record 11012801;
      Job@1100529104 : Record 11072003;
      ServiceContract@1100529106 : Record 11012812;
      ResourcePlanningView@1100525001 : Record 11124916;
      ResourcePlanningUserSetupPage@1100529107 : Page 11126924;
      SchedulerConfigTranslations@1100528302 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerConfig+SchedulerTranslations";
      SchedulerConfigUserSettings@1100528303 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerConfig+SchedulerConfigUserSettings";
      CaptionNumberOfItemsSelected@1100528309 : TextConst 'ENU=%d selected';
      CaptionScaleColumnWidth@1100528310 : TextConst 'ENU=Column Width';
      CaptionScaleRowHeight@1100528311 : TextConst 'ENU=Row Height';
      CaptionWeekNumber@1100528312 : TextConst 'ENU=Week {{weeknumber}}';
      CaptionViewTypeGantt@1100529900 : TextConst 'ENU="<i class=''fa fa-lg fa-calendar-check-o'' aria-hidden=''true''></i>"';
      CaptionViewTypeScheduler@1100529901 : TextConst 'ENU="<i class=''fa fa-lg fa-user'' aria-hidden=''true''></i>"';
      CaptionActiveFilter@1100528319 : TextConst 'ENU=Active Filter';
      CaptionFilterSettings@1100528318 : TextConst 'ENU="<i class=""fa fa-cog""></i>"';
      CaptionOk@1100528317 : TextConst 'ENU=OK;SVE=OK';
      CaptionCancel@1100528316 : TextConst 'ENU=Cancel;SVE=Annullera';
      CaptionFilterDelete@1100528315 : TextConst 'ENU=Are you sure you want to delete this filter?';
      CaptionFilterDescription@1100528314 : TextConst 'ENU=Filter Description';
      CaptionFilterPlaceholder@1100528313 : TextConst 'ENU=My new filter';
      SchedulerEvent@1100529112 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
      BText@1100528323 : BigText;
      IStream@1100528324 : InStream;
      SchedulerFilterTypes@1100528320 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.FilterType";
      MessageString@1100529108 : Text;
      CaptionFullscreen@1100529109 : TextConst 'ENU=Fullscreen';
      CaptionFilterToSelection@1100529110 : TextConst 'ENU="<i class=""fa fa-filter""></i>&nbsp;Selection"';
      CaptionEventCopied@1100529111 : TextConst 'ENU=Event Copied';
      CaptionEventCopiedFailed@1100529113 : TextConst 'ENU=Copy unsuccessful';
      CaptionCopiedFailedDueToFixedEvent@1100529114 : TextConst 'ENU=This event and cannot be moved';
      CaptionCopiedFailedDueToLocalStorage@1100529115 : TextConst 'ENU=Unable to copy event in this client';
      SchedulerPermission@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      ResourcePlanningViewMgt@1100525002 : Codeunit 11124905;
      CaptionResourceView@1100525003 : TextConst 'ENU=Resource View';
      SchedulerConfigUserScaleSettings@1100525004 : DotNet "'Fps.Nav.Addin.Scheduler, Culture=neutral, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerConfig+SchedulerConfigUserScaleSettings";
      SchedulerScale@1100525005 : DotNet "'Fps.Nav.Addin.Scheduler, Culture=neutral, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.Scale";
      CaptionScaleSettingsHideWeekend@1100529171 : TextConst 'ENU=Hide Weekend';
      CaptionScaleSettingsHideNonBusiness@1100529172 : TextConst 'ENU=Show Only Business Hours';
      CaptionScaleSettingsNonBusinessMorning@1100529173 : TextConst 'ENU=Morning';
      CaptionScaleSettingsNonBusinessNoon@1100529174 : TextConst 'ENU=Noon';
      CaptionScaleSettingsNonBusinessEvening@1100529175 : TextConst 'ENU=Evening';
    BEGIN
      GlobalVariantTrue := TRUE;
      GlobalVariantFalse := FALSE;

      FillTempTables;
      SchedulerConfig := SchedulerConfig.SchedulerConfig;
      SchedulerConfig.Locale(DetermineLanguage);
      CLEAR(SchedulerConfigUserSettings);

      IF NOT ResourcePlanningUserSetup.GET(USERID) THEN BEGIN
        ResourcePlanningUserSetup.INIT;
        ResourcePlanningUserSetup."User ID" := USERID;
        ResourcePlanningUserSetup.INSERT;
        COMMIT;
        IF CONFIRM(Text026) THEN BEGIN
          ResourcePlanningUserSetupPage.SETRECORD(ResourcePlanningUserSetup);
          ResourcePlanningUserSetupPage.RUNMODAL;
          ResourcePlanningUserSetup.GET(USERID);
        END;
      END ELSE BEGIN
        IF ResourcePlanningUserSetup."Row Height Day" = 0 THEN BEGIN
          ResourcePlanningUserSetup."Duration Day" := ResourcePlanningUserSetup."Time Scale";
          ResourcePlanningUserSetup."Duration Week" := 60;
          ResourcePlanningUserSetup."Duration Month" := 1440;
          ResourcePlanningUserSetup."Snap to Grid Day" := ResourcePlanningUserSetup."Align to Grid";
          ResourcePlanningUserSetup."Snap to Grid Week" := TRUE;
          ResourcePlanningUserSetup."Snap to Grid Month" := TRUE;
          ResourcePlanningUserSetup."Grid Size Day" := 5;
          ResourcePlanningUserSetup."Grid Size Week" := 30;
          ResourcePlanningUserSetup."Grid Size Month" := 60;
          ResourcePlanningUserSetup."Column Width Day" := ResourcePlanningUserSetup."Column Width";
          ResourcePlanningUserSetup."Column Width Week" := 100;
          ResourcePlanningUserSetup."Column Width Month" := 100;
          ResourcePlanningUserSetup."Row Height Day" := ResourcePlanningUserSetup."Row Height";
          ResourcePlanningUserSetup."Row Height Week" := 100;
          ResourcePlanningUserSetup."Row Height Month" := 100;
          ResourcePlanningUserSetup.MODIFY;
          COMMIT;
        END;

        IF ResourcePlanningUserSetup."Business End Hour Day" = 0 THEN BEGIN
          ResourcePlanningUserSetup."Business Begin Hour Day" := 6;
          ResourcePlanningUserSetup."Business Begin Hour Week" := 6;
          ResourcePlanningUserSetup."Business Begin Hour Month" := 6;
          ResourcePlanningUserSetup."Business End Hour Day" := 18;
          ResourcePlanningUserSetup."Business End Hour Week" := 18;
          ResourcePlanningUserSetup."Business End Hour Month" := 18;
          ResourcePlanningUserSetup.MODIFY;
          COMMIT;
        END;

        IF ((ResourcePlanningUserSetup."Event Text Line 1" = ResourcePlanningUserSetup."Event Text Line 1"::" ")
          AND (ResourcePlanningUserSetup."Event Text Line 2" = ResourcePlanningUserSetup."Event Text Line 2"::" "))
          THEN
          MessageString += Text024;

        IF ((ResourcePlanningUserSetup."Popup Line 1" = ResourcePlanningUserSetup."Popup Line 1"::" ")
          AND (ResourcePlanningUserSetup."Popup Line 2" = ResourcePlanningUserSetup."Popup Line 2"::" ")
          AND (ResourcePlanningUserSetup."Popup Line 3" = ResourcePlanningUserSetup."Popup Line 3"::" ")
          AND (ResourcePlanningUserSetup."Popup Line 4" = ResourcePlanningUserSetup."Popup Line 4"::" ")
          AND (ResourcePlanningUserSetup."Popup Line 5" = ResourcePlanningUserSetup."Popup Line 5"::" ")
          AND (ResourcePlanningUserSetup."Popup Line 6" = ResourcePlanningUserSetup."Popup Line 6"::" "))
          THEN
          MessageString += Text025;

        IF ((ResourcePlanningUserSetup."Resource Text Filter" = FALSE)
          AND (ResourcePlanningUserSetup."Resource Type" = FALSE)
          AND (ResourcePlanningUserSetup.External = FALSE)
          AND (ResourcePlanningUserSetup.Discipline = FALSE)
          AND (ResourcePlanningUserSetup.Qualification = FALSE)
          AND (ResourcePlanningUserSetup."Plant Type" = FALSE)
          AND (ResourcePlanningUserSetup."Trade Speciality" = FALSE)
          AND (ResourcePlanningUserSetup.Planner = FALSE)
          AND (ResourcePlanningUserSetup."Global Dimension 1 Resource" = FALSE))
          THEN
          MessageString += Text021;

        IF ((ResourcePlanningUserSetup."Event Text Filter" = FALSE)
          AND (ResourcePlanningUserSetup."Event Type" = FALSE)
          AND (ResourcePlanningUserSetup."Request SourceType" = FALSE)
          AND (ResourcePlanningUserSetup."Request Type" = FALSE)
          AND (ResourcePlanningUserSetup."Request SubType" = FALSE)
          AND (ResourcePlanningUserSetup."Serviceorder Priority" = FALSE)
          AND (ResourcePlanningUserSetup."Order Manager" = FALSE)
          AND (ResourcePlanningUserSetup."Project Manager" = FALSE)
          AND (ResourcePlanningUserSetup."Assigned to" = FALSE)
          AND (ResourcePlanningUserSetup."Post Code" = FALSE)
          AND (ResourcePlanningUserSetup.City = FALSE)
          AND (ResourcePlanningUserSetup."Order Kind" = FALSE)
          AND (ResourcePlanningUserSetup."Order Type" = FALSE)
          AND (ResourcePlanningUserSetup."Contract Manager" = FALSE)
          AND (ResourcePlanningUserSetup."Global Dimension 1 Event" = FALSE))
          THEN
          MessageString += Text022;

        IF MessageString <> '' THEN BEGIN
          IF CONFIRM(Text019 + MessageString + Text023) THEN BEGIN
            ResourcePlanningUserSetupPage.SETRECORD(ResourcePlanningUserSetup);
            ResourcePlanningUserSetupPage.RUNMODAL;
            ResourcePlanningUserSetup.GET(USERID);
          END;
        END;

      END;

      ResourcePlanningUserSetup.CALCFIELDS("Edit Permission");
      SchedulerConfigUserSettings := SchedulerConfig.UserSettings;
      IF ResourcePlanningUserSetup."Edit Permission" = FALSE THEN
        SchedulerConfigUserSettings.Permission(SchedulerPermission.Read)
      ELSE
        SchedulerConfigUserSettings.Permission(SchedulerPermission.FullControl);

      SchedulerConfigUserSettings.PlanningHorizon(ResourcePlanningUserSetup."Planning Horizon Option");
      SchedulerConfigUserSettings.PlanningHorizonLowerBound(ResourcePlanningUserSetup."Planning Horizon Lower Bound");
      SchedulerConfigUserSettings.PlanningHorizonUpperBound(ResourcePlanningUserSetup."Planning Horizon Upper Bound");
      SchedulerConfigUserSettings.Scale(ResourcePlanningUserSetup."Schedular Scale");
      SchedulerConfigUserSettings.ShowTimeIndicators(ResourcePlanningUserSetup."Show Time Info");
      SchedulerConfigUserSettings.AutoRefreshEvents(ResourcePlanningUserSetup."Automatic Refresh");
      SchedulerConfigUserSettings.AutoRefreshInterval(ResourcePlanningUserSetup."Refresh Interval");
      SchedulerConfigUserSettings.ViewType(ResourcePlanningUserSetup."View Type");
      SchedulerConfigUserSettings.ActiveFeatureFilter(ResourcePlanningUserSetup."Active Feature Filter");
      SchedulerConfigUserSettings.Fullscreen(ResourcePlanningUserSetup.Fullscreen);

      SchedulerConfigUserScaleSettings := SchedulerConfigUserScaleSettings.SchedulerConfigUserScaleSettings();
      SchedulerConfigUserScaleSettings.Scale(SchedulerScale.Day);
      SchedulerConfigUserScaleSettings.Duration(ResourcePlanningUserSetup."Duration Day");
      SchedulerConfigUserScaleSettings.SnapToGrid(ResourcePlanningUserSetup."Snap to Grid Day");
      SchedulerConfigUserScaleSettings.GridSize(ResourcePlanningUserSetup."Grid Size Day");
      SchedulerConfigUserScaleSettings.ColumnWidth(ResourcePlanningUserSetup."Column Width Day");
      SchedulerConfigUserScaleSettings.RowHeight(ResourcePlanningUserSetup."Row Height Day");
      SchedulerConfigUserScaleSettings.HideNonBusiness(ResourcePlanningUserSetup."Hide Non Business Day");
      SchedulerConfigUserScaleSettings.HideWeekend(ResourcePlanningUserSetup."Hide Weekend Day");
      SchedulerConfigUserScaleSettings.BusinessBeginsHour(ResourcePlanningUserSetup."Business Begin Hour Day");
      SchedulerConfigUserScaleSettings.BusinessEndsHour(ResourcePlanningUserSetup."Business End Hour Day");
      SchedulerConfigUserSettings.AddScaleSettings(SchedulerConfigUserScaleSettings);

      SchedulerConfigUserScaleSettings := SchedulerConfigUserScaleSettings.SchedulerConfigUserScaleSettings();
      SchedulerConfigUserScaleSettings.Scale(SchedulerScale.Week);
      SchedulerConfigUserScaleSettings.Duration(ResourcePlanningUserSetup."Duration Week");
      SchedulerConfigUserScaleSettings.SnapToGrid(ResourcePlanningUserSetup."Snap to Grid Week");
      SchedulerConfigUserScaleSettings.GridSize(ResourcePlanningUserSetup."Grid Size Week");
      SchedulerConfigUserScaleSettings.ColumnWidth(ResourcePlanningUserSetup."Column Width Week");
      SchedulerConfigUserScaleSettings.RowHeight(ResourcePlanningUserSetup."Row Height Week");
      SchedulerConfigUserScaleSettings.HideNonBusiness(ResourcePlanningUserSetup."Hide Non Business Week");
      SchedulerConfigUserScaleSettings.HideWeekend(ResourcePlanningUserSetup."Hide Weekend Week");
      SchedulerConfigUserScaleSettings.BusinessBeginsHour(ResourcePlanningUserSetup."Business Begin Hour Week");
      SchedulerConfigUserScaleSettings.BusinessEndsHour(ResourcePlanningUserSetup."Business End Hour Week");
      SchedulerConfigUserSettings.AddScaleSettings(SchedulerConfigUserScaleSettings);

      SchedulerConfigUserScaleSettings := SchedulerConfigUserScaleSettings.SchedulerConfigUserScaleSettings();
      SchedulerConfigUserScaleSettings.Scale(SchedulerScale.Month);
      SchedulerConfigUserScaleSettings.Duration(ResourcePlanningUserSetup."Duration Month");
      SchedulerConfigUserScaleSettings.SnapToGrid(ResourcePlanningUserSetup."Snap to Grid Month");
      SchedulerConfigUserScaleSettings.GridSize(ResourcePlanningUserSetup."Grid Size Month");
      SchedulerConfigUserScaleSettings.ColumnWidth(ResourcePlanningUserSetup."Column Width Month");
      SchedulerConfigUserScaleSettings.RowHeight(ResourcePlanningUserSetup."Row Height Month");
      SchedulerConfigUserScaleSettings.HideNonBusiness(ResourcePlanningUserSetup."Hide Non Business Month");
      SchedulerConfigUserScaleSettings.HideWeekend(ResourcePlanningUserSetup."Hide Weekend Month");
      SchedulerConfigUserScaleSettings.BusinessBeginsHour(ResourcePlanningUserSetup."Business Begin Hour Month");
      SchedulerConfigUserScaleSettings.BusinessEndsHour(ResourcePlanningUserSetup."Business End Hour Month");
      SchedulerConfigUserSettings.AddScaleSettings(SchedulerConfigUserScaleSettings);

      ResourcePlanningView.SETRANGE("User ID", USERID);
      ResourcePlanningView.SETRANGE("Visable in GRP", TRUE);
      ResourcePlanningView.SETRANGE(Code, ResourcePlanningUserSetup."Resource View");
      IF ResourcePlanningView.FINDFIRST THEN BEGIN
        SchedulerConfigUserSettings.ActiveResourceView(ResourcePlanningUserSetup."Resource View");
      END ELSE BEGIN
        ResourcePlanningViewMgt.InitViews;
        ResourcePlanningView.RESET;
        ResourcePlanningView.SETRANGE("User ID", USERID);
        ResourcePlanningView.SETRANGE("Visable in GRP", TRUE);
        IF ResourcePlanningView.FINDFIRST THEN BEGIN
          ResourcePlanningUserSetup."Resource View" := ResourcePlanningView.Code;
          ResourcePlanningUserSetup.MODIFY;
          COMMIT;
          SchedulerConfigUserSettings.ActiveResourceView(ResourcePlanningView.Code);
        END;
      END;

      ResourcePlanningUserSetup.CALCFIELDS("Feature Filters");
      ResourcePlanningUserSetup."Feature Filters".CREATEINSTREAM(IStream);
      BText.READ(IStream);
      SchedulerConfigUserSettings.FeatureFilters(BText);

      SchedulerConfigTranslations := SchedulerConfig.Translations;
      SchedulerConfigTranslations.ScaleDay(CaptionDay);
      SchedulerConfigTranslations.ScaleWeek(CaptionWeek);
      SchedulerConfigTranslations.ScaleMonth(CaptionMonth);
      SchedulerConfigTranslations.WeekNumber(CaptionWeekNumber);
      SchedulerConfigTranslations.NavigateToday(CaptionToday);
      SchedulerConfigTranslations.NavigateTomorrow(CaptionTomorrow);
      SchedulerConfigTranslations.NavigateNextWeek(CaptionNextWeek);
      SchedulerConfigTranslations.NavigateThisWeek(CaptionThisWeek);
      SchedulerConfigTranslations.NavigateNextMonth(CaptionNextMonth);
      SchedulerConfigTranslations.NavigateThisMonth(CaptionThisMonth);
      SchedulerConfigTranslations.NavigateCustomRange(CaptionCustomRange);
      SchedulerConfigTranslations.NavigateFuture(CaptionFuture);
      SchedulerConfigTranslations.NavigatePast(CaptionPast);
      SchedulerConfigTranslations.NavigateMultipleNumberOfDays(CaptionMultipleNumberOfDays);
      SchedulerConfigTranslations.NavigateSingleNumberOfDays(CaptionSingleNumberOfDays);
      SchedulerConfigTranslations.About(CaptionAbout);
      SchedulerConfigTranslations.ActiveFilter(CaptionActiveFilter);
      SchedulerConfigTranslations.Print(CaptionPrint);
      SchedulerConfigTranslations.ActionOk(CaptionOk);
      SchedulerConfigTranslations.ActionCancel(CaptionCancel);
      SchedulerConfigTranslations.Filter(CaptionFilter);
      SchedulerConfigTranslations.FilterDescription(CaptionFilterDescription);
      SchedulerConfigTranslations.FilterPlaceholder(CaptionFilterPlaceholder);
      SchedulerConfigTranslations.FilterResources(CaptionResources);
      SchedulerConfigTranslations.FilterSettings(CaptionFilterSettings);
      SchedulerConfigTranslations.FilterDelete(CaptionFilterDelete);
      SchedulerConfigTranslations.FilterEvents(CaptionEvents);
      SchedulerConfigTranslations.FilterEventsPresent(CaptionEventsPresent);
      SchedulerConfigTranslations.FilterOptionYes(CaptionOptionYes);
      SchedulerConfigTranslations.FilterOptionNo(CaptionOptionNo);
      SchedulerConfigTranslations.FilterClear(CaptionClear);
      SchedulerConfigTranslations.FilterOptionsNothingSelected(CaptionNothingSelected);
      SchedulerConfigTranslations.ScaleSettings(CaptionScaleSettings);
      SchedulerConfigTranslations.ScaleSettingsTitle(CaptionScaleSettingsTitle);
      SchedulerConfigTranslations.ScaleSettingsDuration(CaptionScaleDuration);
      SchedulerConfigTranslations.ScaleSettingsDurationOptionQuarterHour(CaptionScaleDurationOptionQuarterHour);
      SchedulerConfigTranslations.ScaleSettingsDurationOptionHalfHour(CaptionScaleDurationOptionHalfHour);
      SchedulerConfigTranslations.ScaleSettingsDurationOptionOneHour(CaptionScaleDurationOptionOneHour);
      SchedulerConfigTranslations.ScaleSettingsDurationOptionTwoHour(CaptionScaleDurationOptionTwoHour);
      SchedulerConfigTranslations.ScaleSettingsDurationOptionHalfDay(CaptionScaleDurationOptionHalfDay);
      SchedulerConfigTranslations.ScaleSettingsDurationOptionOneDay(CaptionScaleDurationOptionOneDay);
      SchedulerConfigTranslations.ScaleSettingsSnapToGrid(CaptionScaleSnapToGrid);
      SchedulerConfigTranslations.ScaleSettingsGridSize(CaptionScaleGridSize);
      SchedulerConfigTranslations.ScaleSettingsColumnWidth(CaptionScaleColumnWidth);
      SchedulerConfigTranslations.ScaleSettingsRowHeight(CaptionScaleRowHeight);
      SchedulerConfigTranslations.ScaleSettingsHideWeekend(CaptionScaleSettingsHideWeekend);
      SchedulerConfigTranslations.ScaleSettingsHideNonBusiness(CaptionScaleSettingsHideNonBusiness);
      SchedulerConfigTranslations.ScaleSettingsNonBusinessMorning(CaptionScaleSettingsNonBusinessMorning);
      SchedulerConfigTranslations.ScaleSettingsNonBusinessNoon(CaptionScaleSettingsNonBusinessNoon);
      SchedulerConfigTranslations.ScaleSettingsNonBusinessEvening(CaptionScaleSettingsNonBusinessEvening);
      SchedulerConfigTranslations.Settings(CaptionSettings);
      SchedulerConfigTranslations.SettingsPlanningHorizon(CaptionPlanningHorizon);
      SchedulerConfigTranslations.SettingsShowTimeIndicators(CaptionShowTimeIndicators);
      SchedulerConfigTranslations.SettingsAutoRefresh(CaptionAutoRefresh);
      SchedulerConfigTranslations.SettingsAutoRefreshInterval(CaptionRefreshIntervalSec);
      SchedulerConfigTranslations.SettingsFullscreen(CaptionFullscreen);
      SchedulerConfigTranslations.FilterToSelection(CaptionFilterToSelection);
      SchedulerConfigTranslations.EventCopied(CaptionEventCopied);
      SchedulerConfigTranslations.EventCopiedFailed(CaptionEventCopiedFailed);
      SchedulerConfigTranslations.CopiedFailedDueToFixedEvent(CaptionCopiedFailedDueToFixedEvent);
      SchedulerConfigTranslations.CopiedFailedDueToLocalStorage(CaptionCopiedFailedDueToLocalStorage);
      SchedulerConfigTranslations.NumberOfItemsSelected(CaptionNumberOfItemsSelected);
      SchedulerConfigTranslations.ViewTypeGantt(CaptionViewTypeGantt);
      SchedulerConfigTranslations.ViewTypeScheduler(CaptionViewTypeScheduler);
      SchedulerConfigTranslations.SettingsResourceView(CaptionResourceView);

      SchedulerConfig.AddResourceFilter('eventsPresent', CaptionEventsPresent, SchedulerFilterTypes.Custom, TRUE);

      IF ResourcePlanningUserSetup."Resource Text Filter" THEN BEGIN
        SchedulerConfig.AddResourceFilter('*', Text009, SchedulerFilterTypes.String, TRUE);
        EnableResourceFilterLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Resource Type" THEN BEGIN
        SchedulerConfig.AddResourceFilter('resourcetype', WorkOrder.FIELDCAPTION("Resource Type"), SchedulerFilterTypes.OptionMultiple, TRUE);
        EnableResourceTypeLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup.External THEN BEGIN
        SchedulerConfig.AddResourceFilter('external',  PlantType.FIELDCAPTION(External), SchedulerFilterTypes.Option, TRUE);
        EnableExternalLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup.Discipline THEN BEGIN
        SchedulerConfig.AddResourceFilter('discipline', Discipline.TABLECAPTION, SchedulerFilterTypes.OptionList, TRUE);
        EnableDisciplineLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup.Qualification THEN BEGIN
        SchedulerConfig.AddResourceFilter('qualification', Qualification.TABLECAPTION, SchedulerFilterTypes.OptionList, TRUE);
        EnableQualificationLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Plant Type" THEN BEGIN
        SchedulerConfig.AddResourceFilter('planttypewithgroups', PlantType.TABLECAPTION, SchedulerFilterTypes.OptionList, TRUE);
        EnablePlantTypeWithGroupsLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Trade Speciality" THEN BEGIN
        SchedulerConfig.AddResourceFilter('tradespeciality', TradeSpeciality.TABLECAPTION, SchedulerFilterTypes.OptionList, TRUE);
        EnableTradeSpecialityLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup.Planner THEN BEGIN
        SchedulerConfig.AddResourceFilter('planner', Resource.FIELDCAPTION(Planner), SchedulerFilterTypes.OptionList, TRUE);
        EnablePlannerLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Global Dimension 1 Resource" THEN BEGIN
        SchedulerConfig.AddResourceFilter('dimension1resource', ServiceOrder.FIELDCAPTION("Global Dimension 1 Code"), SchedulerFilterTypes.OptionList, TRUE);
        EnableDimension1ResourceLabel := TRUE;
      END;

      IF ResourcePlanningUserSetup."Event Text Filter" THEN BEGIN
        SchedulerConfig.AddEventFilter('*', Text008, SchedulerFilterTypes.String, TRUE);
        EnableEventFilterLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Event Type" THEN BEGIN
        SchedulerConfig.AddEventFilter('typetext', Text000, SchedulerFilterTypes.OptionMultiple, TRUE);
        EnableTypeTextLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Request SourceType" THEN BEGIN
        SchedulerConfig.AddEventFilter('requestsourcetype', Text003, SchedulerFilterTypes.OptionList, TRUE);
        EnableRequestSourceTypeLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Request Type" THEN BEGIN
        SchedulerConfig.AddEventFilter('requesttype', Text002, SchedulerFilterTypes.OptionList, TRUE);
        EnableRequestTypeLabel := TRUE;
      END;
      IF  ResourcePlanningUserSetup."Request SubType" THEN BEGIN
        SchedulerConfig.AddEventFilter('requestsubtype', Text006, SchedulerFilterTypes.OptionList, TRUE);
        EnableRequestSubTypeLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Serviceorder Priority" THEN BEGIN
        SchedulerConfig.AddEventFilter('priority', Text007, SchedulerFilterTypes.OptionList, TRUE);
        EnablePriorityLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Order Manager" THEN BEGIN
        SchedulerConfig.AddEventFilter('ordermanager', ServiceOrder.FIELDCAPTION("Order Manager"), SchedulerFilterTypes.OptionList, TRUE);
        EnableOrderManagerLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Project Manager" THEN BEGIN
        SchedulerConfig.AddEventFilter('projectmanager', Job.FIELDCAPTION("Project Manager"), SchedulerFilterTypes.OptionList, TRUE);
        EnableProjectManagerLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Assigned to" THEN BEGIN
        SchedulerConfig.AddEventFilter('assignedto', WorkOrder.FIELDCAPTION("Assigned to"), SchedulerFilterTypes.OptionList, TRUE);
        EnableAssignedToLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Post Code" THEN BEGIN
        SchedulerConfig.AddEventFilter('postcode', ResourceRequest.FIELDCAPTION("Post Code"), SchedulerFilterTypes.OptionList, TRUE);
        EnablePostCodeLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup.City THEN BEGIN
        SchedulerConfig.AddEventFilter('city', ResourceRequest.FIELDCAPTION(City), SchedulerFilterTypes.OptionList, TRUE);
        EnableCityLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Order Kind" THEN BEGIN
        SchedulerConfig.AddEventFilter('serviceorderkind', ServiceOrder.FIELDCAPTION("Order Kind"), SchedulerFilterTypes.OptionList, TRUE);
        EnableServiceOrderKindLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Order Type" THEN BEGIN
        SchedulerConfig.AddEventFilter('serviceordertype', ServiceOrder.FIELDCAPTION("Order Type"), SchedulerFilterTypes.OptionList, TRUE);
        EnableServiceOrderTypeLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Contract Manager" THEN BEGIN
        SchedulerConfig.AddEventFilter('contractmanager', ServiceContract.FIELDCAPTION("Contract Manager"), SchedulerFilterTypes.OptionList, TRUE);
        EnableContractManagerLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."Global Dimension 1 Event" THEN BEGIN
        SchedulerConfig.AddEventFilter('dimension1event', ServiceOrder.FIELDCAPTION("Global Dimension 1 Code"), SchedulerFilterTypes.OptionList, TRUE);
        EnableDimension1EventLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup.Territory THEN BEGIN
        SchedulerConfig.AddEventFilter('territory', ResourcePlanningUserSetup.FIELDCAPTION(Territory), SchedulerFilterTypes.OptionList, TRUE);
        EnableTerritoryLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup.Location THEN BEGIN
        SchedulerConfig.AddEventFilter('location', ResourcePlanningUserSetup.FIELDCAPTION(Location), SchedulerFilterTypes.OptionList, TRUE);
        EnableLocationLabel := TRUE;
      END;
      IF ResourcePlanningUserSetup."On Hold" THEN BEGIN
        SchedulerConfig.AddEventFilter('onhold', ResourcePlanningUserSetup.FIELDCAPTION("On Hold"), SchedulerFilterTypes.OptionList, TRUE);
        EnableOnHoldLabel := TRUE;
      END;

      ExportResourceViews(SchedulerConfig);
      ExportPopover(SchedulerConfig);
      SchedulerEvent := SchedulerEvent.SchedulerEvent;
      ExportEventText(SchedulerEvent);
    END;

    LOCAL PROCEDURE ExportResourceViews@1100525018(VAR SchedulerConfig@1100529100 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerConfig");
    VAR
      ResourcePlanningView@1100525000 : Record 11124916;
    BEGIN
      ResourcePlanningView.SETRANGE("User ID", USERID);
      ResourcePlanningView.SETRANGE("Visable in GRP", TRUE);
      IF ResourcePlanningView.FINDSET THEN BEGIN
        REPEAT
          SchedulerConfig.AddResourceView(ResourcePlanningView.Code, ResourcePlanningView.Description);
        UNTIL ResourcePlanningView.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ExportPopover@1100529110(VAR SchedulerConfig@1100529100 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerConfig");
    VAR
      EventPopoverTemplate@1100529101 : BigText;
    BEGIN
      EventPopoverTemplate.ADDTEXT('<table>');
      ExportPopoverLine(EventPopoverTemplate, ResourcePlanningUserSetup."Popup Line 1");
      ExportPopoverLine(EventPopoverTemplate, ResourcePlanningUserSetup."Popup Line 2");
      ExportPopoverLine(EventPopoverTemplate, ResourcePlanningUserSetup."Popup Line 3");
      ExportPopoverLine(EventPopoverTemplate, ResourcePlanningUserSetup."Popup Line 4");
      ExportPopoverLine(EventPopoverTemplate, ResourcePlanningUserSetup."Popup Line 5");
      ExportPopoverLine(EventPopoverTemplate, ResourcePlanningUserSetup."Popup Line 6");
      EventPopoverTemplate.ADDTEXT('</table>');

      SchedulerConfig.EventPopoverTemplate(EventPopoverTemplate);
    END;

    LOCAL PROCEDURE ExportPopoverLine@1100529113(VAR PopoverTemplate@1100529100 : BigText;PopoverTemplateOption@1100529101 : Option);
    VAR
      WorkOrder@1100529102 : Record 11229279;
      EventType@1100529103 : Record 11124911;
      ServiceOrder@1100529104 : Record 11012823;
      CommentLine@1100529105 : Record 97;
      PlantNumber@1100529106 : Record 11012552;
      ReferencePoint@1100529107 : Record 11020271;
    BEGIN
      CASE PopoverTemplateOption OF
        ResourcePlanningUserSetup."Popup Line 1"::Source:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr><td><strong>{{event.getFeature("typetext")}}:&nbsp;</strong></td>' +
              '<td>{{event.getFeature("typeno")}}<span *ngIf="event.hasFeature(''typedescription'')"> {{event.getFeature("typedescription")}}</span></td></tr>');
            EnableTypeTextLabel := TRUE;
            EnableTypeNoLabel := TRUE;
            EnableTypeDescriptionLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::Customer:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''sourceno'')"><td><strong>{{event.getFeature("source")}}:&nbsp;</strong></td>' +
              '<td>{{event.getFeature("sourceno")}}<span *ngIf="event.hasFeature(''sourcedescription'')"> {{event.getFeature("sourcedescription")}}</span></td></tr>');
            EnableSourceLabel := TRUE;
            EnableSourceNoLabel := TRUE;
            EnableSourceDescriptionLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::Workorder:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''workorderno'')"><td><strong>' + WorkOrder.TABLECAPTION + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("workorderno")}}<span *ngIf="event.hasFeature(''workorderdescription'')"> {{event.getFeature("workorderdescription")}}</span></td></tr>');
            EnableWorkorderNoLabel := TRUE;
            EnableWorkorderDescriptionLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::Date:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr><td><strong>' + Text029 + '&nbsp;-&nbsp;' + Text029b + ':&nbsp;' + '</strong></td>' +
            '<td><span>{{event.startDate | momentDate:"l LT"}} - </span> <span>{{event.endDate | momentDate:"l LT"}}</span></td><tr>');
          END;
        ResourcePlanningUserSetup."Popup Line 1"::Referencepoint:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''referencepoint'')"><td><strong>' + Text034 + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("referencepoint")}}<span *ngIf="event.hasFeature(''referencepointdescription'')"> {{event.getFeature("referencepointdescription")}}</span></td></tr>');
            EnableReferencePointLabel := TRUE;
            EnableReferencePointDescriptionLabel := TRUE;
           END;
        ResourcePlanningUserSetup."Popup Line 1"::Eventtype:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr><td><strong>' + EventType.TABLECAPTION + ':&nbsp;</strong></td>' +
            '<td>{{event.getFeature("eventtype")}}</td></tr>');
            EnableEventTypeLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::Address:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''postcode'')"><td><strong>' + ServiceOrder.FIELDCAPTION(Address) + ':&nbsp;</strong></td>' +
              '<td><span *ngIf="event.hasFeature(''address'')">{{event.getFeature("address")}} </span> <span>{{event.getFeature("postcode")}} </span> <span>{{event.getFeature("city")}}</span></td></tr>');
            EnableAddressLabel := TRUE;
            EnablePostCodeLabel := TRUE;
            EnableCityLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::"InspectionNo(SO)":
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''plantinspectionno'')"><td><strong>' + PlantNumber.FIELDCAPTION("Inspection No.") + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("plantinspectionno")}}</td></tr>');
            EnableInspectionNoLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::DurationTime:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''durationtime'')"><td><strong>' + Text036 + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("durationtime")}} ' + Text028 + '</td></tr>');
            EnableDurationTimeLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::"MasterProject(SO)":
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''serviceordermasterprojectnumber'')"><td><strong>' + Text030 + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("serviceordermasterprojectnumber")}}<span *ngIf="event.hasFeature(''serviceordermasterprojectdescription'')"> {{event.getFeature("serviceordermasterprojectdescription")}}</span></td></tr>');
            EnableServiceOrderMasterProjectNumberLabel := TRUE;
            EnableServiceOrderMasterProjectDescriptionLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::Comments:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''comments'')"><td><strong>' + CommentLine.FIELDCAPTION(Comment) + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("comments")}}</td></tr>');
            EnableCommentsLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::"Priority(SO)":
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''priority'')"><td><strong>' + ServiceOrder.FIELDCAPTION(Priority) + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("priority")}}</td></tr>');
            EnablePriorityLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::"OrderType(SO)":
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''serviceordertype'')"><td><strong>' + ServiceOrder.FIELDCAPTION("Order Type") + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("serviceordertype")}}</td></tr>');
            EnableServiceOrderTypeLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::"OrderKind(SO)":
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''serviceorderkind'')"><td><strong>' + ServiceOrder.FIELDCAPTION("Order Kind") + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("serviceorderkind")}}</td></tr>');
            EnableServiceOrderKindLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::"Location(SO)":
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''location'')"><td><strong>' + Text039 + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("location")}}</td></tr>');
            EnableLocationLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::AssignedTo:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''assignedto'')"><td><strong>' + WorkOrder.FIELDCAPTION("Assigned to") + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("assignedto")}}</td></tr>');
            EnableAssignedToLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::"OrderManager(SO)":
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''ordermanager'')"><td><strong>' + ServiceOrder.FIELDCAPTION("Order Manager") + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("ordermanager")}}</td></tr>');
            EnableOrderManagerLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::"OnHold(SO)":
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''onhold'')"><td><strong>' + ResourcePlanningUserSetup.FIELDCAPTION("On Hold") + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("onhold")}}</td></tr>');
            EnableOnHoldLabel := TRUE;
          END;
        ResourcePlanningUserSetup."Popup Line 1"::FSReason:
          BEGIN
            PopoverTemplate.ADDTEXT('<tr *ngIf="event.hasFeature(''fsreason'')"><td><strong>' + Text040 + ':&nbsp;</strong></td>' +
              '<td>{{event.getFeature("fsreason")}}</td></tr>');
            EnableFieldServiceReasonLabel := TRUE;
          END;
      END;
    END;

    [External]
    PROCEDURE ExportResourceTypes@1100528304(VAR SchedulerResourceTypes@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResourceTypes");
    VAR
      SchedulerResourceType@1100528300 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResourceType";
      SchedulerPermission@1100528301 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      CommandType@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.CommandType";
    BEGIN
      SchedulerResourceTypes := SchedulerResourceTypes.SchedulerResourceTypes();

      SchedulerResourceType := SchedulerResourceType.SchedulerResourceType();
      SchedulerResourceType.Identifier('plant');
      ExportResourceTypeCommand(SchedulerResourceType, 'ShowResourceInfo', IconInfo, TooltipOpenPlant, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportResourceTypeCommand(SchedulerResourceType, 'SchedulerFilterResourceGroup', IconFilter, TooltipFilterResource, SchedulerPermission.FullControl, CommandType.Info, FALSE, FALSE, FALSE);
      SchedulerResourceType.ResourceImage(ImagePlant);
      SchedulerResourceTypes.AddResourceType(SchedulerResourceType);

      SchedulerResourceType := SchedulerResourceType.SchedulerResourceType();
      SchedulerResourceType.Identifier('employee');
      IF ExecutePermissionPage(5200) THEN
        ExportResourceTypeCommand(SchedulerResourceType, 'ShowResourceInfo', IconInfo, TooltipOpenEmployee, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportResourceTypeCommand(SchedulerResourceType, 'SchedulerFilterResourceGroup', IconFilter, TooltipFilterResource, SchedulerPermission.FullControl, CommandType.Info, FALSE, FALSE, FALSE);
      ExportResourceTypeCommand(SchedulerResourceType, 'CallResource', IconPhone, TooltipCallResource, SchedulerPermission.FullControl, CommandType.Warning, FALSE, TRUE, FALSE);
      ExportResourceTypeCommand(SchedulerResourceType,'EmailResource', IconEmail, TooltipMailResource, SchedulerPermission.FullControl, CommandType.Warning, FALSE, TRUE, FALSE);
      SchedulerResourceType.ResourceImage(ImagePerson);
      SchedulerResourceTypes.AddResourceType(SchedulerResourceType);

      SchedulerResourceType := SchedulerResourceType.SchedulerResourceType();
      SchedulerResourceType.Identifier('subcontractor');
      IF ExecutePermissionPage(26) THEN
        ExportResourceTypeCommand(SchedulerResourceType,'ShowResourceInfo', IconInfo, TooltipOpenSubcontractor, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportResourceTypeCommand(SchedulerResourceType, 'SchedulerFilterResourceGroup', IconFilter, TooltipFilterResource, SchedulerPermission.FullControl, CommandType.Info, FALSE, FALSE, FALSE);
      ExportResourceTypeCommand(SchedulerResourceType,'CallResource', IconPhone, TooltipCallResource, SchedulerPermission.FullControl, CommandType.Warning, FALSE, TRUE, FALSE);
      ExportResourceTypeCommand(SchedulerResourceType,'EmailResource', IconEmail, TooltipMailResource, SchedulerPermission.FullControl, CommandType.Warning, FALSE, TRUE, FALSE);
      SchedulerResourceType.ResourceImage(ImagePerson);
      SchedulerResourceTypes.AddResourceType(SchedulerResourceType);

      SchedulerResourceType := SchedulerResourceType.SchedulerResourceType();
      SchedulerResourceType.Identifier('groupdiscipline');
      SchedulerResourceType.ResourceImage(ImagePerson);
      SchedulerResourceTypes.AddResourceType(SchedulerResourceType);

      SchedulerResourceType := SchedulerResourceType.SchedulerResourceType();
      SchedulerResourceType.Identifier('groupplant');
      ExportResourceTypeCommand(SchedulerResourceType,'ShowResourceInfo', IconInfo, TooltipOpenPlantType, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      SchedulerResourceType.ResourceImage(ImagePlant);
      SchedulerResourceTypes.AddResourceType(SchedulerResourceType);
    END;

    LOCAL PROCEDURE ExportResourceTypeCommand@1100525002(VAR ResourceType@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResourceType";Identifier@1100525001 : Text;Text@1100525002 : Text;Tooltip@1100525003 : Text;Permission@1100525004 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";CommandType@1100525005 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.CommandType";MultipleSelect@1100525006 : Variant;Visible@1100525007 : Variant;Disabled@1100525008 : Variant);
    VAR
      SchedulerCommand@1100525009 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerCommand";
    BEGIN
      SchedulerCommand := SchedulerCommand.SchedulerCommand();
      SchedulerCommand.Identifier(Identifier);
      SchedulerCommand.Text(Text);
      SchedulerCommand.Tooltip(Tooltip);
      SchedulerCommand.Permission(Permission);
      SchedulerCommand.Type(CommandType);
      SchedulerCommand.MultipleSelect(MultipleSelect);
      SchedulerCommand.Visible(Visible);
      SchedulerCommand.Disabled(Disabled);
      ResourceType.AddCommand(SchedulerCommand);
    END;

    [External]
    PROCEDURE ExportResources@1100529000(VAR SchedulerResources@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResources";ResourceViewCode@1100525001 : Code[20]);
    VAR
      SchedulerResource@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";
      ResourcePlanningView@1100525002 : Record 11124916;
      Resource@1100525003 : Record 11229278;
    BEGIN
      SchedulerResources := SchedulerResources.SchedulerResources();
      ResourcesAvailable := FALSE;

      ResourcePlanningView.SETRANGE("User ID", USERID);
      ResourcePlanningView.SETRANGE("Visable in GRP", TRUE);
      IF ResourceViewCode <> '' THEN BEGIN
        ResourcePlanningView.SETRANGE(Code, ResourceViewCode);
        IF ResourcePlanningView.FINDFIRST THEN
          ExportResourceSet(SchedulerResources, ResourceViewCode, TRUE);
      END ELSE BEGIN
        SetKeyAndFiltersResources(Resource, -1, 'SEARCHNAME');
        IF Resource.FINDSET THEN BEGIN
          REPEAT
            SchedulerResource := SchedulerResource.SchedulerResource;
            ExportResource(SchedulerResource, Resource."No.");
            SchedulerResources.AddResource(SchedulerResource);
          UNTIL Resource.NEXT = 0;
        END;
        ResourcePlanningView.SETRANGE(Code, ResourcePlanningUserSetup."Resource View");
        IF ResourcePlanningView.FINDFIRST THEN
          ExportResourceSet(SchedulerResources, ResourcePlanningUserSetup."Resource View", TRUE);
      END;

      IF NOT ResourcesAvailable THEN
        MESSAGE(Text027);
    END;

    [External]
    PROCEDURE ExportResourceSet@1100525024(VAR SchedulerResources@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResources";ResourceViewNo@1100525006 : Code[20];IncludeViews@1100525002 : Boolean);
    VAR
      SchedulerResource@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";
      FirstLevelResource@1100525003 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";
      SecondLevelResource@1100525004 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";
      ThirdLevelResource@1100525005 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";
      SchedulerPermission@1100525007 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      ResourcePlanningViewLine@1100525001 : Record 11124917;
      ResourcePlanningViewMgt@1100525008 : Codeunit 11124905;
      IsRootVariant@1100527701 : Variant;
      IsGroupVariant@1100527700 : Variant;
    BEGIN
      IsRootVariant := TRUE;
      IsGroupVariant := TRUE;
      ResourcePlanningViewMgt.InitView(ResourceViewNo);
      ResourcePlanningViewLine.SETCURRENTKEY("User ID",Code,"Line No.");
      ResourcePlanningViewLine.SETRANGE("User ID", USERID);
      ResourcePlanningViewLine.SETRANGE(Code, ResourceViewNo);
      IF ResourcePlanningViewLine.FINDSET THEN BEGIN
        REPEAT
          CASE ResourcePlanningViewLine.IndentPos OF
            0:
              BEGIN
                IF ResourcePlanningViewLine.Type = ResourcePlanningViewLine.Type::Group THEN BEGIN
                  FirstLevelResource := FirstLevelResource.SchedulerResource;
                  FirstLevelResource.Identifier(FORMAT(ResourcePlanningViewLine.Code + FORMAT(ResourcePlanningViewLine."Line No.")));
                  FirstLevelResource.Name(ResourcePlanningViewLine.Description);
                  FirstLevelResource.Permission(SchedulerPermission.Read);
                  FirstLevelResource.IsGroup(IsGroupVariant);
                  FirstLevelResource.IsRoot(IsRootVariant);
                  SchedulerResources.AddResource(FirstLevelResource);
                END;
                IF (ResourcePlanningViewLine.Type = ResourcePlanningViewLine.Type::ResourceView) AND IncludeViews THEN BEGIN
                  ExportResourceSet(SchedulerResources, ResourcePlanningViewLine."No.", FALSE);
                END;
              END;
            1:
              BEGIN
                SecondLevelResource := SecondLevelResource.SchedulerResource;
                IF NOT ISNULL(FirstLevelResource) AND ExportResourceSetLine(SecondLevelResource, ResourcePlanningViewLine) THEN
                  FirstLevelResource.AddChild(SecondLevelResource);
              END;
            2:
              BEGIN
                ThirdLevelResource := ThirdLevelResource.SchedulerResource;
                IF NOT ISNULL(SecondLevelResource) AND ExportResourceSetLine(ThirdLevelResource, ResourcePlanningViewLine) THEN
                  SecondLevelResource.AddChild(ThirdLevelResource);
              END;
          END;
        UNTIL ResourcePlanningViewLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ExportResourceSetLine@1100525015(VAR SchedulerResource@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";ResourcePlanningViewLine@1100525001 : Record 11124917) : Boolean;
    BEGIN
      CASE ResourcePlanningViewLine.Type OF
        ResourcePlanningViewLine.Type::Resource:
          BEGIN
            EXIT(ExportResource(SchedulerResource, ResourcePlanningViewLine."No."));
          END;
        ResourcePlanningViewLine.Type::ResourceGroup:
          BEGIN
            EXIT(ExportResourceGroup(SchedulerResource, ResourcePlanningViewLine."No."));
          END;
      END;
    END;

    LOCAL PROCEDURE ExportResource@1100525016(VAR SchedulerResource@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";ResourceNo@1100529900 : Code[20]) : Boolean;
    VAR
      Resource@1100529000 : Record 11229278;
      Employee@1100529001 : Record 5200;
      ResourceDiscipline@1100528300 : Record 11229286;
      Discipline@1100528301 : Record 11020204;
      EmployeeQualification@1100529100 : Record 5203;
      Qualification@1100529101 : Record 5202;
      TradeSpeciality@1100529102 : Record 11020285;
      DimensionValue@1100529104 : Record 349;
      GeneralLedgerSetup@1100529105 : Record 98;
      ChildSchedulerResource@1100529004 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";
      DummyResource@1100528302 : Code[20];
      SourceCompany@1100529003 : Text;
      FullFileName@1100529005 : Text;
      Base64EncodedContents@1100529006 : BigText;
      FilterString@1100529103 : Text;
      SchedulerPermission@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
    BEGIN
      IF ResourceNo = '' THEN
        EXIT(FALSE);
      Resource.SetCompanyPlanGroupFilters;
      Resource.SETFILTER("User ID Filter", USERID);
      Resource.SETRANGE("Visible in GRP", TRUE);
      Resource.SETRANGE("No.", ResourceNo);
      IF Resource.FINDFIRST THEN BEGIN
        CASE Resource.Type OF
          Resource.Type::Plant:
            EXIT(ExportResourcePlant(SchedulerResource, Resource));
          Resource.Type::Employee:
            EXIT(ExportResourceEmployee(SchedulerResource, Resource));
          Resource.Type::Subcontractor:
            EXIT(ExportResourceSubcontractor(SchedulerResource, Resource));
        END;
      END;
    END;

    LOCAL PROCEDURE ExportResourceGroup@1100525014(VAR SchedulerResource@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";ResourceGroupNo@1100529900 : Code[20]) : Boolean;
    VAR
      ResourceGroup@1100529000 : Record 11229384;
      SchedulerPermission@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
    BEGIN
      IF ResourceGroupNo = '' THEN
        EXIT(FALSE);
      ResourceGroup.SetCompanyPlanGroupFilters;
      ResourceGroup.SETFILTER("User ID Filter", USERID);
      ResourceGroup.SETFILTER("Company Filter", COMPANYNAME);
      ResourceGroup.SETRANGE("Visible in GRP", TRUE);
      ResourceGroup.SETRANGE("No.", ResourceGroupNo);
      IF ResourceGroup.FINDFIRST THEN BEGIN
        CASE ResourceGroup.Type OF
          ResourceGroup.Type::Discipline:
            EXIT(ExportResourceGroupDiscipline(SchedulerResource, ResourceGroup));
          ResourceGroup.Type::Plant:
            EXIT(ExportResourceGroupPlantType(SchedulerResource, ResourceGroup));
        END;
      END;
    END;

    [External]
    PROCEDURE ExportEventTypes@1100529037(VAR SchedulerEventTypes@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEventTypes");
    VAR
      EventType@1100529102 : Record 11124911;
      SchedulerEventType@1100528300 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEventType";
      SchedulerPermission@1100528301 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      CommandType@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.CommandType";
    BEGIN
      ResourcePlanningSetup.GET;
      SchedulerEventTypes := SchedulerEventTypes.SchedulerEventTypes();

      // serviceorder
      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('UNPLANNED_SERVICEORDER');

      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenServiceorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('SERVICE_PLANT');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenServiceorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'CreateNextWorkOrder', IconCreate, TooltipCreateNextWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, FALSE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'UnplanWorkOrder', IconRemove, TooltipUnplanWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('SERVICE_EMPLOYEE');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenServiceorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'ExportEventsFieldService', IconExport, TooltipExportFieldService, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'CreateNextWorkOrder', IconCreate, TooltipCreateNextWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, FALSE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'UnplanWorkOrder', IconRemove, TooltipUnplanWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('FIXED_SERVICEORDER');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenServiceorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'CreateNextWorkOrder', IconCreate, TooltipCreateNextWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, FALSE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventType.EventFixed(GlobalVariantTrue);
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      // project
      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('UNPLANNED_PROJECT');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenProject, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('PROJECT_PLANT');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenProject, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'CreateNextWorkOrder', IconCreate, TooltipCreateNextWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, FALSE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'UnplanWorkOrder', IconRemove, TooltipUnplanWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('PROJECT_EMPLOYEE');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenProject, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'ExportEventsFieldService', IconExport, TooltipExportFieldService, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'CreateNextWorkOrder', IconCreate, TooltipCreateNextWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, FALSE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'UnplanWorkOrder', IconRemove, TooltipUnplanWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('FIXED_PROJECT');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenProject, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'CreateNextWorkOrder', IconCreate, TooltipCreateNextWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, FALSE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventType.EventFixed(GlobalVariantTrue);
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      // resourcerequest
      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('UNPLANNED_RESOURCEREQUEST');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenResourceRequest, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('RESOURCEREQUEST_PLANT');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenResourceRequest, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'ExportEventsFieldService', IconExport, TooltipExportFieldService, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'UnplanWorkOrder', IconRemove, TooltipUnplanWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('RESOURCEREQUEST_EMPLOYEE');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenResourceRequest, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'ExportEventsFieldService', IconExport, TooltipExportFieldService, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'UnplanWorkOrder', IconRemove, TooltipUnplanWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerRemoveEvents', IconDelete, TooltipDeleteWorkorder, SchedulerPermission.Modify, CommandType.Danger, TRUE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('FIXED_RESOURCEREQUEST');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoWorkorder, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'OpenSource', IconOpenSource, TooltipOpenResourceRequest, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'SchedulerFilterEventGroup', IconFilter, TooltipFilterEvent, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      ExportEventTypeCommand(SchedulerEventType, 'CreateNextWorkOrder', IconCreate, TooltipCreateNextWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, FALSE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventType.EventFixed(GlobalVariantTrue);
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      // absence
      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('ABSENCE_EVENT');
      ExportEventTypeCommand(SchedulerEventType, 'ShowEventInfo', IconInfo, TooltipInfoAbsence, SchedulerPermission.FullControl, CommandType.Info, FALSE, TRUE, FALSE);
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventType.EventFixedResource(GlobalVariantTrue);
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      SchedulerEventType := SchedulerEventType.SchedulerEventType();
      SchedulerEventType.Identifier('ABSENCE_EVENT_FIXED');
      SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(0) + '1)');
      SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(0) + '.6)');
      SchedulerEventType.EventFixed(GlobalVariantTrue);
      SchedulerEventTypes.AddEventType(SchedulerEventType);

      IF EventType.FINDSET THEN BEGIN
        REPEAT
          SchedulerEventType := SchedulerEventType.SchedulerEventType();
          SchedulerEventType.Identifier(EventType.Code);
          SchedulerEventType.EventBarBackgroundColor('rgba(' + ColorToRGB(EventType.Color) + '1)');
          SchedulerEventType.EventBackgroundColor('rgba(' + ColorToRGB(EventType.Color) + '.6)');
          SchedulerEventTypes.AddEventType(SchedulerEventType);
        UNTIL EventType.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ExportEventTypeCommand@1100525012(VAR EventType@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEventType";Identifier@1100525001 : Text;Text@1100525002 : Text;Tooltip@1100525003 : Text;Permission@1100525004 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";CommandType@1100525005 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.CommandType";MultipleSelect@1100525006 : Variant;Visible@1100525007 : Variant;Disabled@1100525008 : Variant);
    VAR
      SchedulerCommand@1100525009 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerCommand";
    BEGIN
      SchedulerCommand := SchedulerCommand.SchedulerCommand();
      SchedulerCommand.Identifier(Identifier);
      SchedulerCommand.Text(Text);
      SchedulerCommand.Tooltip(Tooltip);
      SchedulerCommand.Permission(Permission);
      SchedulerCommand.Type(CommandType);
      SchedulerCommand.MultipleSelect(MultipleSelect);
      SchedulerCommand.Visible(Visible);
      SchedulerCommand.Disabled(Disabled);
      EventType.AddCommand(SchedulerCommand);
    END;

    [External]
    PROCEDURE ExportRelationTypes@1100525025(VAR SchedulerRelationTypes@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerRelationTypes");
    VAR
      SchedulerRelationType@1100525001 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerRelationType";
      RelationTypeStyle@1100525002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.RelationTypeStyle";
    BEGIN
      SchedulerRelationTypes := SchedulerRelationTypes.SchedulerRelationTypes();
      ExportRelationType(SchedulerRelationTypes, 'DEFAULT', 1, '#002e5f', RelationTypeStyle.Dashed);
    END;

    LOCAL PROCEDURE ExportRelationType@1100525013(VAR SchedulerRelationTypes@1100525000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerRelationTypes";Identifier@1100525005 : Text;Width@1100525002 : Variant;Color@1100525003 : Text;Style@1100525004 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.RelationTypeStyle");
    VAR
      SchedulerRelationType@1100525001 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerRelationType";
    BEGIN
      SchedulerRelationType := SchedulerRelationType.SchedulerRelationType();
      SchedulerRelationType.Identifier(Identifier);
      SchedulerRelationType.RelationTypeWidth(Width);
      SchedulerRelationType.RelationTypeColor(Color);
      SchedulerRelationType.RelationTypeStyle(Style);
      SchedulerRelationTypes.AddRelationType(SchedulerRelationType);
    END;

    [External]
    PROCEDURE ExportEvents@1100529011(VAR SchedulerEvents@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";PlanHorizonStartDate@1100529002 : Date;PlanHorizonEndDate@1100529001 : Date;VAR WorkorderLastExportedOn@1100529003 : DateTime);
    BEGIN
      ExportWorkorders(SchedulerEvents, PlanHorizonStartDate, PlanHorizonEndDate, WorkorderLastExportedOn);
      ExportAllEmployeeAbsence(SchedulerEvents, PlanHorizonStartDate, PlanHorizonEndDate);
      ExportAllPlantAbsence(SchedulerEvents, PlanHorizonStartDate, PlanHorizonEndDate);
    END;

    [External]
    PROCEDURE ExportEventsChangeLogWorkorders@1100529028(VAR SchedulerEvents@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR SchedulerEventsDelete@1100529004 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";PlanHorizonStartDate@1100529002 : Date;PlanHorizonEndDate@1100529001 : Date;VAR WorkorderLastExportedOn@1100529003 : DateTime);
    BEGIN
      ExportChangeLogWorkorders(SchedulerEvents, SchedulerEventsDelete, PlanHorizonStartDate, PlanHorizonEndDate, WorkorderLastExportedOn);
    END;

    [External]
    PROCEDURE ExportEventsSourceWorkOrders@1100529034(VAR SchedulerEvents@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR SchedulerEventsDelete@1100529001 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";SourceType@1100529002 : Option;SourceNo@1100529003 : Code[20];WorkorderLastExportedOn@1100529101 : DateTime);
    VAR
      WorkOrder@1100529004 : Record 11229279;
    BEGIN
      SchedulerEvents := SchedulerEvents.SchedulerEvents();
      SchedulerEventsDelete := SchedulerEventsDelete.SchedulerEvents();
      WorkOrder.SETCURRENTKEY("Source No.", "Source Company","No.");
      WorkOrder.SETRANGE("Modified on", WorkorderLastExportedOn, CURRENTDATETIME);
      WorkOrder.SETRANGE("Source Type", SourceType);
      WorkOrder.SETRANGE("Source No.", SourceNo);
      WorkOrder.SETRANGE("Source Company", COMPANYNAME);
      IF WorkOrder.FINDSET THEN BEGIN
        REPEAT
          IF (WorkOrder."Resource No." <> '') OR (WorkOrder."Resource Group No." <> '') THEN
            ExportWorkorderData(SchedulerEvents, WorkOrder)
          ELSE
            ExportWorkorderDelete(SchedulerEventsDelete, WorkOrder."No.");
        UNTIL WorkOrder.NEXT = 0;
      END;
    END;

    [External]
    PROCEDURE ExportEventsUpdatedWorkOrders@1100529031(VAR SchedulerEvents@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR SchedulerEventsDelete@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR TmpWorkorderTable@1100529001 : TEMPORARY Record 11020579);
    VAR
      WorkOrder@1100529004 : Record 11229279;
    BEGIN
      IF TmpWorkorderTable.FINDSET THEN BEGIN
        REPEAT
          IF NOT WorkOrder.GET(TmpWorkorderTable."Key Code1") THEN
            ExportWorkorderDelete(SchedulerEventsDelete, TmpWorkorderTable."Key Code1")
          ELSE BEGIN
            IF (WorkOrder."Resource No." <> '') OR (WorkOrder."Resource Group No." <> '') THEN
              ExportWorkorderData(SchedulerEvents, WorkOrder)
            ELSE
              ExportWorkorderDelete(SchedulerEventsDelete, TmpWorkorderTable."Key Code1");
          END;
          TmpWorkorderTable.DELETE;
        UNTIL TmpWorkorderTable.NEXT = 0;
      END;
    END;

    [External]
    PROCEDURE ExportPossibleResources@1100529901(VAR SchedulerEvent@1100529902 : DotNet "'Fps.Nav.Addin.Scheduler,PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";VAR ReturnSchedulerResources@1100529900 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResources");
    VAR
      SchedulerResource@1100529903 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";
      ReturnSchedulerResource@1100529907 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";
      WorkOrder@1100529901 : Record 11229279;
      ResourceGroup@1100529100 : Record 11229384;
      ResourceDiscipline@1100529905 : Record 11229286;
      Resource@1100529101 : Record 11229278;
    BEGIN
      SchedulerResource := SchedulerResource.SchedulerResource;
      ResourcesAvailable := FALSE;

      IF WorkOrder.GET(SchedulerEvent.Identifier) THEN BEGIN
        CASE WorkOrder."Resource Type" OF
          WorkOrder."Resource Type"::Employee, WorkOrder."Resource Type"::Subcontractor : BEGIN
            IF WorkOrder."Resource Group No." <> '' THEN BEGIN
              IF ResourceGroup.GET(WorkOrder."Resource Group No.") THEN BEGIN
                ResourceDiscipline.SETRANGE(Discipline, ResourceGroup."Source No.");
                IF ResourceDiscipline.FINDSET THEN BEGIN
                  REPEAT
                    SetKeyAndFiltersResources(Resource, -1, 'SEARCHNAME');
                    Resource.SETRANGE("No.", ResourceDiscipline."Resource No.");
                    IF Resource.FINDFIRST THEN BEGIN
                      SchedulerResource := SchedulerResource.SchedulerResource();
                      SchedulerResource.Identifier(Resource."No.");
                       ReturnSchedulerResources.AddResource(SchedulerResource);
                      ResourcesAvailable := TRUE;
                    END;
                  UNTIL ResourceDiscipline.NEXT = 0;
                END;
              END;
            END;
            IF NOT ResourcesAvailable THEN BEGIN
              SetKeyAndFiltersResources(Resource, Resource.Type::Employee, 'SEARCHNAME');
              IF Resource.FINDSET THEN BEGIN
                REPEAT
                  SchedulerResource := SchedulerResource.SchedulerResource();
                  SchedulerResource.Identifier(Resource."No.");
                   ReturnSchedulerResources.AddResource(SchedulerResource);
                UNTIL Resource.NEXT = 0;
              END;
              SetKeyAndFiltersResources(Resource, Resource.Type::Subcontractor, 'SEARCHNAME');
              IF Resource.FINDSET THEN BEGIN
                REPEAT
                  SchedulerResource := SchedulerResource.SchedulerResource();
                  SchedulerResource.Identifier(Resource."No.");
                   ReturnSchedulerResources.AddResource(SchedulerResource);
                UNTIL Resource.NEXT = 0;
              END;
            END;
          END;

          WorkOrder."Resource Type"::Plant : BEGIN
            IF WorkOrder."Resource Group No." <> '' THEN BEGIN
              IF ResourceGroup.GET(WorkOrder."Resource Group No.") THEN BEGIN
                SetKeyAndFiltersResources(Resource, Resource.Type::Plant, 'SOURCENO');
                Resource.SETRANGE("Source No.", ResourceGroup."Source No.");
                IF Resource.FINDSET THEN BEGIN
                  REPEAT
                    SchedulerResource := SchedulerResource.SchedulerResource();
                    SchedulerResource.Identifier(Resource."No.");
                    ReturnSchedulerResources.AddResource(SchedulerResource);
                    ResourcesAvailable := TRUE;
                  UNTIL Resource.NEXT = 0;
                END;
              END;
            END;
            IF NOT ResourcesAvailable THEN BEGIN
              SetKeyAndFiltersResources(Resource, Resource.Type::Plant, 'SEARCHNAME');
              IF Resource.FINDSET THEN BEGIN
                REPEAT
                  SchedulerResource := SchedulerResource.SchedulerResource();
                  SchedulerResource.Identifier(Resource."No.");
                   ReturnSchedulerResources.AddResource(SchedulerResource);
                UNTIL Resource.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE UpdateResourcePlanningUserSetup@1100528302(VAR SchedulerConfig@1100528300 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerConfig");
    VAR
      ResourcePlanningUserSetup@1100528301 : Record 11124910;
      BText@1100528305 : BigText;
      OStream@1100528306 : OutStream;
      SchedulerConfigUserScaleSettings@1100529171 : DotNet "'Fps.Nav.Addin.Scheduler, Culture=neutral, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerConfig+SchedulerConfigUserScaleSettings";
      Scale@1100529172 : Text;
    BEGIN
      IF (NOT ResourcePlanningUserSetup.GET(USERID)) THEN BEGIN
        ResourcePlanningUserSetup.INIT;
        ResourcePlanningUserSetup."User ID" := USERID;
        ResourcePlanningUserSetup.INSERT;
      END;

      CASE FORMAT(SchedulerConfig.UserSettings.PlanningHorizon) OF
        'Today':
          ResourcePlanningUserSetup."Planning Horizon Option" := ResourcePlanningUserSetup."Planning Horizon Option"::Today;
        'Tomorrow':
          ResourcePlanningUserSetup."Planning Horizon Option" := ResourcePlanningUserSetup."Planning Horizon Option"::Tomorrow;
        'ThisWeek':
          ResourcePlanningUserSetup."Planning Horizon Option" := ResourcePlanningUserSetup."Planning Horizon Option"::ThisWeek;
        'NextWeek':
          ResourcePlanningUserSetup."Planning Horizon Option" := ResourcePlanningUserSetup."Planning Horizon Option"::NextWeek;
        'ThisMonth':
          ResourcePlanningUserSetup."Planning Horizon Option" := ResourcePlanningUserSetup."Planning Horizon Option"::ThisMonth;
        'NextMonth':
          ResourcePlanningUserSetup."Planning Horizon Option" := ResourcePlanningUserSetup."Planning Horizon Option"::NextMonth;
        'Custom':
          ResourcePlanningUserSetup."Planning Horizon Option" := ResourcePlanningUserSetup."Planning Horizon Option"::Custom;
      END;
      ResourcePlanningUserSetup."Planning Horizon Lower Bound" := SchedulerConfig.UserSettings.PlanningHorizonLowerBound;
      ResourcePlanningUserSetup."Planning Horizon Upper Bound" := SchedulerConfig.UserSettings.PlanningHorizonUpperBound;
      CASE FORMAT(SchedulerConfig.UserSettings.Scale) OF
        'Day':
          ResourcePlanningUserSetup."Schedular Scale" := ResourcePlanningUserSetup."Schedular Scale"::Day;
        'Week':
          ResourcePlanningUserSetup."Schedular Scale" := ResourcePlanningUserSetup."Schedular Scale"::Week;
        'Month':
          ResourcePlanningUserSetup."Schedular Scale" := ResourcePlanningUserSetup."Schedular Scale"::Month;
        'Custom':
          ResourcePlanningUserSetup."Schedular Scale" := ResourcePlanningUserSetup."Schedular Scale"::Custom;
      END;
      ResourcePlanningUserSetup."Show Time Info" := SchedulerConfig.UserSettings.ShowTimeIndicators;
      ResourcePlanningUserSetup."Automatic Refresh" := SchedulerConfig.UserSettings.AutoRefreshEvents;
      ResourcePlanningUserSetup."Refresh Interval" := SchedulerConfig.UserSettings.AutoRefreshInterval;
      CASE FORMAT(SchedulerConfig.UserSettings.ViewType) OF
        'Resources':
          ResourcePlanningUserSetup."View Type" := ResourcePlanningUserSetup."View Type"::Resources;
        'Gantt':
          ResourcePlanningUserSetup."View Type" := ResourcePlanningUserSetup."View Type"::Gantt;
      END;
      ResourcePlanningUserSetup."Active Feature Filter" := SchedulerConfig.UserSettings.ActiveFeatureFilter;
      ResourcePlanningUserSetup.Fullscreen := SchedulerConfig.UserSettings.Fullscreen;
      ResourcePlanningUserSetup."Resource View" := SchedulerConfig.UserSettings.ActiveResourceView;
      FOREACH SchedulerConfigUserScaleSettings IN SchedulerConfig.UserSettings.ScaleSettings DO BEGIN
        Scale := SchedulerConfigUserScaleSettings.Scale.ToString;
        IF Scale = 'Day' THEN BEGIN
          ResourcePlanningUserSetup."Duration Day" := SchedulerConfigUserScaleSettings.Duration;
          ResourcePlanningUserSetup."Snap to Grid Day" := SchedulerConfigUserScaleSettings.SnapToGrid;
          ResourcePlanningUserSetup."Grid Size Day" := SchedulerConfigUserScaleSettings.GridSize;
          ResourcePlanningUserSetup."Column Width Day" := SchedulerConfigUserScaleSettings.ColumnWidth;
          ResourcePlanningUserSetup."Row Height Day" := SchedulerConfigUserScaleSettings.RowHeight;
          ResourcePlanningUserSetup."Hide Non Business Day" := SchedulerConfigUserScaleSettings.HideNonBusiness;
          ResourcePlanningUserSetup."Hide Weekend Day" := SchedulerConfigUserScaleSettings.HideWeekend;
          ResourcePlanningUserSetup."Business Begin Hour Day" := SchedulerConfigUserScaleSettings.BusinessBeginsHour;
          ResourcePlanningUserSetup."Business End Hour Day" := SchedulerConfigUserScaleSettings.BusinessEndsHour;
        END;
        IF Scale = 'Week' THEN BEGIN
          ResourcePlanningUserSetup."Duration Week" := SchedulerConfigUserScaleSettings.Duration;
          ResourcePlanningUserSetup."Snap to Grid Week" := SchedulerConfigUserScaleSettings.SnapToGrid;
          ResourcePlanningUserSetup."Grid Size Week" := SchedulerConfigUserScaleSettings.GridSize;
          ResourcePlanningUserSetup."Column Width Week" := SchedulerConfigUserScaleSettings.ColumnWidth;
          ResourcePlanningUserSetup."Row Height Week" := SchedulerConfigUserScaleSettings.RowHeight;
          ResourcePlanningUserSetup."Hide Non Business Week" := SchedulerConfigUserScaleSettings.HideNonBusiness;
          ResourcePlanningUserSetup."Hide Weekend Week" := SchedulerConfigUserScaleSettings.HideWeekend;
          ResourcePlanningUserSetup."Business Begin Hour Week" := SchedulerConfigUserScaleSettings.BusinessBeginsHour;
          ResourcePlanningUserSetup."Business End Hour Week" := SchedulerConfigUserScaleSettings.BusinessEndsHour;
        END;
        IF Scale = 'Month' THEN BEGIN
          ResourcePlanningUserSetup."Duration Month" := SchedulerConfigUserScaleSettings.Duration;
          ResourcePlanningUserSetup."Snap to Grid Month" := SchedulerConfigUserScaleSettings.SnapToGrid;
          ResourcePlanningUserSetup."Grid Size Month" := SchedulerConfigUserScaleSettings.GridSize;
          ResourcePlanningUserSetup."Column Width Month" := SchedulerConfigUserScaleSettings.ColumnWidth;
          ResourcePlanningUserSetup."Row Height Month" := SchedulerConfigUserScaleSettings.RowHeight;
          ResourcePlanningUserSetup."Hide Non Business Month" := SchedulerConfigUserScaleSettings.HideNonBusiness;
          ResourcePlanningUserSetup."Hide Weekend Month" := SchedulerConfigUserScaleSettings.HideWeekend;
          ResourcePlanningUserSetup."Business Begin Hour Month" := SchedulerConfigUserScaleSettings.BusinessBeginsHour;
          ResourcePlanningUserSetup."Business End Hour Month" := SchedulerConfigUserScaleSettings.BusinessEndsHour;
        END;
      END;


      BText.ADDTEXT(SchedulerConfig.UserSettings.FeatureFilters);
      ResourcePlanningUserSetup."Feature Filters".CREATEOUTSTREAM(OStream);
      BText.WRITE(OStream);

      ResourcePlanningUserSetup.MODIFY;
    END;

    [External]
    PROCEDURE OnCreateEventInsertTmpResourceTable@1100529041(VAR TmpResourceTable@1100529001 : TEMPORARY Record 11020579;ResourceNo@1100529000 : Code[40];StartDateTime@1100529004 : DateTime;EndDateTime@1100529003 : DateTime;CopyMode@1100529005 : Boolean;EventsByDay@1100529008 : Boolean;OrgWorkorderNo@1100529006 : Code[20];OrgResourceType@1100525001 : Option;OrgResourceGroup@1100525000 : Code[20];OrgResourceNo@1100529007 : Code[40];OrgOperatesPlantWO@1100528302 : Code[20];Duration@1100529102 : Decimal;WorkOrderNo@1100529103 : Code[20];PlanDuringClockTime@1100529172 : Boolean;PlanInWeekend@1100529171 : Boolean;FirmPlanned@1100529170 : Boolean);
    VAR
      StartingDateTime@1100529010 : DateTime;
      EndingDateTime@1100529009 : DateTime;
      StartingDate@1100529012 : Date;
      EndingDate@1100529011 : Date;
      CreateEventByDay@1100529013 : Boolean;
      ResourceGroupTypeNo@1100528301 : Integer;
      MainResourceNo@1100529002 : Code[20];
      ResourceOperatesPlant@1100528300 : Code[20];
    BEGIN
      StartingDateTime := StartDateTime;
      EndingDateTime := EndDateTime;
      IF EventsByDay AND (NOT CopyMode) THEN BEGIN
        StartingDate := DT2DATE(StartDateTime);
        EndingDate := DT2DATE(EndDateTime - 1);
        IF EndingDate > StartingDate THEN BEGIN
          CreateEventByDay := TRUE;
          EndingDateTime := CREATEDATETIME(StartingDate + 1, 0T);
        END;
      END;

      ResourceGroupTypeNo := IsResourceNo2ResourceGroup(ResourceNo);
      IF (ResourceGroupTypeNo <> ResourceGroupTypeOption::Discipline) AND (ResourceGroupTypeNo <> ResourceGroupTypeOption::PlantType) THEN
        MainResourceNo := GetMainResourceNo(ResourceNo, ResourceOperatesPlant);

      TmpResourceTable.INIT;
      TmpResourceTable."Key Code1" := FormatDateTime(StartingDateTime) + ' ' + FormatDateTime(EndingDateTime);
      TmpResourceTable."Key Code2" := ResourceNo;
      TmpResourceTable."Key Code3" := '';
      TmpResourceTable."Key Code4" := FORMAT(ResourceGroupTypeNo);
      //TmpResourceTable."Key Code6" := OrgWorkorderNo;
      TmpResourceTable.Int1 := ResourceGroupTypeNo;
      IF MainResourceNo <> '' THEN BEGIN
        IF MainResourceNo = ResourceNo THEN
          TmpResourceTable.Bool1 := TRUE
        ELSE BEGIN
          TmpResourceTable."Key Code2" := MainResourceNo;
          TmpResourceTable."Key Code3" := ResourceNo;
          TmpResourceTable.Bool2 := TRUE;
        END;
      END;
      TmpResourceTable.DateTime1 := StartingDateTime;
      TmpResourceTable.DateTime2 := EndingDateTime;
      TmpResourceTable.Dec1 := Duration;
      TmpResourceTable.Bool3 := CopyMode;
      TmpResourceTable.Code1 := OrgWorkorderNo;
      TmpResourceTable.Code2 := OrgResourceNo;
      IF NOT CopyMode THEN
        TmpResourceTable.Code3 := ResourceOperatesPlant
      ELSE BEGIN
        TmpResourceTable.Int2 := OrgResourceType;
        TmpResourceTable.Code6 := OrgResourceGroup;
        TmpResourceTable.Code4 := OrgOperatesPlantWO;
      END;
      TmpResourceTable.Code5 := ResourceNo;
      IF WorkOrderNo <> '' THEN
        TmpResourceTable.Code15 := WorkOrderNo;
      TmpResourceTable.Bool4 := PlanDuringClockTime;
      TmpResourceTable.Bool5 := PlanInWeekend;
      TmpResourceTable.Bool6 := FirmPlanned;
      IF NOT TmpResourceTable.INSERT THEN
        EXIT;

      IF CreateEventByDay THEN BEGIN
        REPEAT
          StartingDate := StartingDate + 1;
          StartingDateTime := CREATEDATETIME(StartingDate, 0T);
          IF StartingDate >= EndingDate THEN
            EndingDateTime := EndDateTime
          ELSE
            EndingDateTime := CREATEDATETIME(StartingDate + 1, 0T);
          TmpResourceTable."Key Code1" := FormatDateTime(StartingDateTime) + ' ' + FormatDateTime(EndingDateTime);
          TmpResourceTable.DateTime1 := StartingDateTime;
          TmpResourceTable.DateTime2 := EndingDateTime;
          TmpResourceTable.INSERT;
        UNTIL StartingDate >= EndingDate;
      END;
    END;

    [External]
    PROCEDURE CreateEvent@1100529019(SourceType@1100529011 : Option;VAR SourceNo@1100529002 : Code[20];VAR TmpResourceTable@1100529003 : TEMPORARY Record 11020579;WorkorderLastExportedOn@1100529102 : DateTime;UpdateEvent@1100529106 : Boolean;SourceCompany@1100529107 : Text);
    VAR
      ResourceRequest@1100529000 : Record 11124901;
      ServiceOrder@1100529012 : Record 11012823;
      Project@1100529013 : Record 11072003;
      ProjectElement@1100529104 : Record 11012010;
      WorkOrder@1100529014 : Record 11229279;
      Resource@1100525000 : Record 11229278;
      ProjectElementList@1100529105 : Page 11012029;
      SchedulerEvents@1100529100 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";
      SchedulerEventsDelete@1100529101 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";
      SourceCreated@1100529004 : Boolean;
      CopyMode@1100528303 : Boolean;
      ResourceGroupTypeNo@1100528301 : Integer;
      ResourceNo@1100529007 : Code[20];
      ResourceGroup@1100528300 : Code[20];
      WorkOrderNo@1100529006 : Code[20];
      MainResourceNo@1100529008 : Code[20];
      MainWorkOrderNo@1100529009 : Code[20];
      MainKeyCode1@1100529005 : Code[50];
      RelatedWorkOrderNo@1100529010 : Code[20];
      Element@1100528500 : Code[20];
      MessageString@1100529103 : Text;
      FirstOrder@1100529170 : Boolean;
    BEGIN
      FirstOrder := TRUE;
      IF UpdateEvent THEN BEGIN
        ResourceRequest.CHANGECOMPANY(SourceCompany);
        ServiceOrder.CHANGECOMPANY(SourceCompany);
        Project.CHANGECOMPANY(SourceCompany);
        ProjectElement.CHANGECOMPANY(SourceCompany);
      END;
      IF SourceNo = '' THEN BEGIN
        SourceNo := AddSource(SourceType);
        SourceCreated := TRUE;
      END;
      CASE SourceType OF
        WorkOrder."Source Type"::ServiceOrder:
          BEGIN
            ServiceOrder.GET(SourceNo);
          END;
        WorkOrder."Source Type"::Project:
          BEGIN
            Project.GET(SourceNo);
            IF NOT UpdateEvent THEN BEGIN
              COMMIT;
              ProjectElement.SETRANGE("Project No.", Project."No.");
              IF Project."Posting Element Mandatory" THEN BEGIN
                IF ProjectElement.COUNT > 0 THEN BEGIN
                  ProjectElementList.SETTABLEVIEW(ProjectElement);
                  ProjectElementList.LOOKUPMODE(FALSE);
                  ProjectElementList.RUNMODAL;
                  ProjectElementList.GETRECORD(ProjectElement);
                  Element := ProjectElement.Element;
                END;
              END ELSE BEGIN
                IF ProjectElement.COUNT > 0 THEN BEGIN
                  ProjectElementList.LOOKUPMODE(TRUE);
                  IF PAGE.RUNMODAL(PAGE::"Project Element List", ProjectElement) = ACTION::LookupOK THEN
                    Element := ProjectElement.Element;
                END;
              END;
            END;
          END;
        WorkOrder."Source Type"::Request:
          BEGIN
            ResourceRequest.GET(SourceNo);
          END;
      END;

      IF TmpResourceTable.FINDSET THEN BEGIN
        CopyMode := TmpResourceTable.Bool3;  //Same for all records in tmptable
        REPEAT
          ResourceNo := TmpResourceTable."Key Code2";
          ResourceGroup := '';
          RelatedWorkOrderNo := '';
          IF TmpResourceTable.Bool2 THEN BEGIN
            ResourceNo := TmpResourceTable."Key Code3";
            IF (TmpResourceTable."Key Code2" = MainResourceNo) AND (MainKeyCode1 = TmpResourceTable."Key Code1") THEN
              RelatedWorkOrderNo := MainWorkOrderNo;
          END;
          ResourceGroupTypeNo := TmpResourceTable.Int1;
          IF (ResourceGroupTypeNo = ResourceGroupTypeOption::Discipline) OR (ResourceGroupTypeNo = ResourceGroupTypeOption::PlantType) THEN BEGIN
            ResourceGroup := ResourceNo;
            ResourceNo := '';
          END ELSE BEGIN
            IF TmpResourceTable.Bool3 AND (TmpResourceTable.Code6 <> '') AND (ResourceNo <> '') THEN BEGIN
              IF Resource.GET(ResourceNo) THEN BEGIN
                IF ((Resource.Type IN [Resource.Type::Employee, Resource.Type::Subcontractor]) AND
                    (TmpResourceTable.Int2 IN [Resource.Type::Employee, Resource.Type::Subcontractor])) OR
                   ((Resource.Type = Resource.Type::Plant) AND (TmpResourceTable.Int2 = Resource.Type::Plant))
                THEN
                  ResourceGroup := TmpResourceTable.Code6;
              END;
            END;
          END;
          IF TmpResourceTable.Code15 = '' THEN
            WorkOrderNo := AddWorkorder(
              SourceType, SourceNo, ResourceNo, ResourceGroupTypeNo, ResourceGroup,
              TmpResourceTable.DateTime1, TmpResourceTable.DateTime2, TmpResourceTable.Dec1, RelatedWorkOrderNo, TmpResourceTable.Code1,
              Element, TmpResourceTable.Bool4, TmpResourceTable.Bool5, TmpResourceTable.Bool6, FirstOrder);
          IF SourceType = WorkOrder."Source Type"::Request THEN BEGIN
            IF TmpResourceTable.Bool2 AND (RelatedWorkOrderNo <> '') THEN
              FillDefaultChargeableLinked(WorkOrderNo, MainResourceNo, ResourceNo);
            IF TmpResourceTable.Bool3 THEN
              CopyAdditionalInfo(WorkOrderNo, ResourceNo, TmpResourceTable.Code1, TmpResourceTable.Code2);
          END;
          IF TmpResourceTable.Bool1 THEN BEGIN
            MainResourceNo := TmpResourceTable."Key Code2";
            MainKeyCode1 := TmpResourceTable."Key Code1";
            IF TmpResourceTable.Code15 <> '' THEN
              MainWorkOrderNo := TmpResourceTable.Code15
            ELSE
              MainWorkOrderNo := WorkOrderNo;
          END;
          TmpResourceTable.Code15 := WorkOrderNo;
          TmpResourceTable.MODIFY;
          FirstOrder := FALSE;
        UNTIL TmpResourceTable.NEXT = 0;
        IF NOT CopyMode THEN
           UpdateOperatesPlantOnCreate(TmpResourceTable)
        ELSE
           UpdateOperatesPlantOnCopy(TmpResourceTable);
      END;
      COMMIT;

      IF SourceCreated THEN BEGIN
        ExportEventsSourceWorkOrders(SchedulerEvents, SchedulerEventsDelete, SourceType, SourceNo, WorkorderLastExportedOn);
        CheckEvents(SchedulerEvents, MessageString, ' \', 20991231D);
        IF MessageString <> '' THEN
          MESSAGE(Text018 + ' \' + MessageString);
        CreatedSourceCard(SourceType, SourceNo);
      END;
    END;

    [External]
    PROCEDURE CheckEvents@1100529114(VAR NewSchedulerEvents@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler,  PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR MessageString@1100529101 : Text;BreakChar@1100529102 : Text;HorizonEndDate@1100525000 : Date);
    VAR
      WorkOrder@1100529008 : Record 11229279;
      NewSchedulerEvent@1100529005 : DotNet "'Fps.Nav.Addin.Scheduler,  PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
      WorkOrderNo@1100529006 : Code[20];
      SourceType@1100529103 : Option;
      TextString1@1100529100 : Text;
      TextString2@1100525001 : Text;
      TextString3@1100525002 : Text;
      StartDateTime@1100529105 : DateTime;
      EndDateTime@1100529106 : DateTime;
      EventIdentifier@1100527700 : Code[40];
      ResourceGroupTypeNo@1100527701 : Integer;
    BEGIN
      FOREACH NewSchedulerEvent IN NewSchedulerEvents.Events DO BEGIN
        SourceType := EventSourceTypeText2OptionNo(NewSchedulerEvent.GetFeature('sourcetype'));
        EventIdentifier := NewSchedulerEvent.Identifier();
        ResourceGroupTypeNo := IsResourceNo2ResourceGroup(EventIdentifier);

        IF (ResourceGroupTypeNo = 0) AND (SourceType IN [WorkOrder."Source Type"::ServiceOrder, WorkOrder."Source Type"::Project, WorkOrder."Source Type"::Request]) THEN BEGIN
          IF WorkOrder.GET(NewSchedulerEvent.Identifier()) THEN BEGIN
            WorkOrderNo := WorkOrder.GetOverlapWorkOrderNo;
            IF WorkOrderNo <> '' THEN BEGIN
              FOREACH NewSchedulerEvent IN NewSchedulerEvents.Events DO BEGIN
                IF WorkOrderNo = NewSchedulerEvent.Identifier() THEN
                  WorkOrderNo := '';
              END;
              IF WorkOrderNo <> '' THEN BEGIN
                IF STRPOS(TextString1, WorkOrder."Resource No.") = 0 THEN BEGIN
                  WorkOrder.CALCFIELDS("Resource Name");
                  TextString1 += BreakChar + WorkOrder."Resource No." + ', ' + WorkOrder."Resource Name";
                END;
              END;
            END;
            CheckEmployeeAbsence(WorkOrder, TextString2, BreakChar);
            CheckPlantAbsence(WorkOrder, TextString2, BreakChar);
          END;
          IF (DT2DATE(WorkOrder."Starting Date/Time") > HorizonEndDate) THEN BEGIN
            TextString3 += BreakChar + WorkOrder."No." + ', ' + WorkOrder.Description;
          END;
        END;
        IF (SourceType = 901) OR (SourceType = 902) THEN BEGIN // absence
          StartDateTime := EvaluateDateTime(NewSchedulerEvent.StartDate());
          EndDateTime := EvaluateDateTime(NewSchedulerEvent.EndDate());
          CheckResourceHasEvents(NewSchedulerEvent.Resource, StartDateTime, EndDateTime, TextString2, BreakChar);
        END;

      END;

      IF TextString1 <> '' THEN BEGIN
        IF MessageString <> '' THEN
          MessageString += BreakChar + BreakChar;
        MessageString += Text016 + TextString1;
      END;
      IF TextString2 <> '' THEN BEGIN
        IF MessageString <> '' THEN
          MessageString += BreakChar + BreakChar;
        MessageString += Text017 + TextString2;
      END;
      IF TextString3 <> '' THEN BEGIN
        IF MessageString <> '' THEN
          MessageString += BreakChar + BreakChar;
        MessageString += Text038 + TextString3;
      END;
    END;

    LOCAL PROCEDURE CheckResourceHasEvents@1100529126(ResourceNo@1100529100 : Code[20];StartDateTime@1100529101 : DateTime;EndDateTime@1100529102 : DateTime;VAR MessageString@1100529103 : Text;BreakChar@1100529104 : Text);
    VAR
      WorkOrder@1100529105 : Record 11229279;
    BEGIN
      WorkOrder.SETRANGE("Resource No.", ResourceNo);
      WorkOrder.SETFILTER("Starting Date/Time", '< %1', EndDateTime);
      WorkOrder.SETFILTER("Ending Date/Time", '> %1', StartDateTime);
      IF WorkOrder.FINDFIRST THEN BEGIN
        WorkOrder.CALCFIELDS("Resource Name");
        MessageString += BreakChar + WorkOrder."Resource No." + ', ' + WorkOrder."Resource Name";
      END;
    END;

    LOCAL PROCEDURE CreatedSourceCard@1100529047(SourceType@1100529001 : Option;SourceNo@1100529000 : Code[20]);
    VAR
      WorkOrder@1100529002 : Record 11229279;
      ResourceRequest@1100529004 : Record 11124901;
      ServiceOrder@1100529003 : Record 11012823;
    BEGIN
      CASE SourceType OF
        WorkOrder."Source Type"::ServiceOrder:
          BEGIN
            ServiceOrder.SETRANGE("No.", SourceNo);
            PAGE.RUNMODAL(PAGE::"Service Order (General)", ServiceOrder);
          END;
        WorkOrder."Source Type"::Project:
          ;  // Only on existing project
        WorkOrder."Source Type"::Request:
          BEGIN
            ResourceRequest.SETRANGE("No.", SourceNo);
            PAGE.RUNMODAL(PAGE::"Resource Request", ResourceRequest);
          END;
      END;
      FillTempTables;
    END;

    LOCAL PROCEDURE UpdateOperatesPlantOnCreate@1100528303(VAR TmpResourceTable@1100528300 : TEMPORARY Record 11020579);
    VAR
      TmpResourceTable1@1100528302 : TEMPORARY Record 11020579;
      TmpResourceTable2@1100528301 : TEMPORARY Record 11020579;
      WorkOrder1@1100528303 : Record 11229279;
      WorkOrder2@1100528304 : Record 11229279;
    BEGIN
      TmpResourceTable1.COPY(TmpResourceTable, TRUE);
      TmpResourceTable2.COPY(TmpResourceTable, TRUE);
      TmpResourceTable1.SETFILTER(Code3, '<>%1', '');
      IF TmpResourceTable1.FINDSET THEN BEGIN
        REPEAT
          IF WorkOrder1.GET(TmpResourceTable1.Code15) THEN BEGIN
            IF (WorkOrder1."Resource Type" IN [WorkOrder1."Resource Type"::Employee, WorkOrder1."Resource Type"::Subcontractor]) THEN BEGIN
              TmpResourceTable2.SETRANGE(Code5, TmpResourceTable1.Code3);
              TmpResourceTable2.SETRANGE("Key Code1", TmpResourceTable1."Key Code1");
              IF TmpResourceTable2.FINDFIRST THEN BEGIN
                IF WorkOrder2.GET(TmpResourceTable2.Code15) THEN BEGIN
                  IF WorkOrder2."Resource Type" = WorkOrder2."Resource Type"::Plant THEN BEGIN
                    WorkOrder1.VALIDATE("Operates Plant (WO)", WorkOrder2."No.");
                    WorkOrder1.MODIFY;
                  END;
                END;
              END;
            END;
          END;
        UNTIL TmpResourceTable1.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE UpdateOperatesPlantOnCopy@1100528305(VAR TmpResourceTable@1100528300 : TEMPORARY Record 11020579);
    VAR
      TmpResourceTable1@1100528302 : TEMPORARY Record 11020579;
      TmpResourceTable2@1100528301 : TEMPORARY Record 11020579;
      WorkOrder1@1100528303 : Record 11229279;
      WorkOrder2@1100528304 : Record 11229279;
    BEGIN
      TmpResourceTable1.COPY(TmpResourceTable, TRUE);
      TmpResourceTable2.COPY(TmpResourceTable, TRUE);
      TmpResourceTable1.SETFILTER(Code4, '<>%1', '');
      IF TmpResourceTable1.FINDSET THEN BEGIN
        REPEAT
          IF WorkOrder1.GET(TmpResourceTable1.Code15) THEN BEGIN
            IF (WorkOrder1."Resource Type" IN [WorkOrder1."Resource Type"::Employee, WorkOrder1."Resource Type"::Subcontractor]) AND
               (((TmpResourceTable1.Int1 = 0) AND (WorkOrder1."Resource No." = TmpResourceTable1.Code2)) OR
                ((TmpResourceTable1.Int1 = ResourceGroupTypeOption::Discipline) AND (WorkOrder1."Resource Group No." = TmpResourceTable1.Code2)))
            THEN BEGIN
              TmpResourceTable2.SETRANGE(Code1, TmpResourceTable1.Code4);
              TmpResourceTable2.SETRANGE("Key Code1", TmpResourceTable1."Key Code1");
              IF TmpResourceTable2.FINDFIRST THEN BEGIN
                IF WorkOrder2.GET(TmpResourceTable2.Code15) THEN BEGIN
                  IF (WorkOrder2."Resource Type" = WorkOrder2."Resource Type"::Plant) AND
                     (((TmpResourceTable2.Int1 = 0) AND (WorkOrder2."Resource No." = TmpResourceTable2.Code2)) OR
                      ((TmpResourceTable2.Int1 = ResourceGroupTypeOption::PlantType) AND (WorkOrder2."Resource Group No." = TmpResourceTable2.Code2))) AND
                     (WorkOrder2."Source No." = WorkOrder1."Source No.")
                  THEN BEGIN
                    WorkOrder1.VALIDATE("Operates Plant (WO)", WorkOrder2."No.");
                    WorkOrder1.MODIFY;
                  END;
                END;
              END;
            END;
          END;
        UNTIL TmpResourceTable1.NEXT = 0;
      END;
    END;

    [External]
    PROCEDURE UpdateEvent@1100529030(WorkOrderNo@1100529000 : Code[20];ResourceNo@1100529001 : Code[40];StartDateTime@1100529003 : DateTime;EndDateTime@1100529002 : DateTime;VAR TmpWorkorderTable@1100529004 : TEMPORARY Record 11020579;IgnoreTypeChange@1100529100 : Boolean);
    VAR
      ResourceGroupTypeNo@1100529111 : Integer;
      ResourceGroup@1100529110 : Code[20];
    BEGIN
      ResourceGroupTypeNo := IsResourceNo2ResourceGroup(ResourceNo);
      IF (ResourceGroupTypeNo = ResourceGroupTypeOption::Discipline) OR (ResourceGroupTypeNo = ResourceGroupTypeOption::PlantType) THEN BEGIN
        ResourceGroup := ResourceNo;
        ResourceNo := '';
      END;
      UpdateWorkorder(WorkOrderNo, ResourceNo, ResourceGroupTypeNo, ResourceGroup, StartDateTime, EndDateTime, IgnoreTypeChange);
      TmpWorkorderTable."Key Code1" := WorkOrderNo;
      IF TmpWorkorderTable.INSERT THEN;
    END;

    [External]
    PROCEDURE DeleteEvent@1100529033(WorkOrderNo@1100529000 : Code[20];VAR TmpWorkorderTable@1100529004 : TEMPORARY Record 11020579);
    BEGIN
      DeleteWorkorder(WorkOrderNo);
      TmpWorkorderTable."Key Code1" := WorkOrderNo;
      IF TmpWorkorderTable.INSERT THEN;
    END;

    LOCAL PROCEDURE ExportResourcePlant@1100525019(VAR SchedulerResource@1100529004 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";Resource@1100525001 : Record 11229278) : Boolean;
    VAR
      PlantType@1100529001 : Record 11012551;
      PlantNumber@1100529003 : Record 11012552;
      ResourceDiscipline@1100529100 : Record 11229286;
      Discipline@1100529101 : Record 11020204;
      TradeSpeciality@1100529102 : Record 11020285;
      DimensionValue@1100529104 : Record 349;
      GeneralLedgerSetup@1100529105 : Record 98;
      SchedulerPermission@1100528500 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      DummyResource@1100528300 : Code[20];
      SourceCompany@1100529002 : Text;
      FullFileName@1100529007 : Text;
      Base64EncodedContents@1100529006 : BigText;
      MainResourceNo@1100527700 : Text;
      SchedulerCommand@1100527701 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerCommand";
    BEGIN
      IF Resource.ISEMPTY THEN
        EXIT(FALSE);

      IF Resource.Company <> SourceCompany THEN BEGIN
        PlantType.CHANGECOMPANY(Resource.Company);
        PlantNumber.CHANGECOMPANY(Resource.Company);
        DimensionValue.CHANGECOMPANY(Resource.Company);
        GeneralLedgerSetup.CHANGECOMPANY(Resource.Company);
        SourceCompany := Resource.Company;
      END;
      IF PlantType.GET(Resource."Source No.") AND PlantNumber.GET(Resource."Source No.", Resource."Source No. 2") THEN BEGIN
        SchedulerResource.Identifier(Resource."No.");
        SchedulerResource.Name(Resource.Name);
        SchedulerResource.Type('plant');
        SchedulerResource.Description(PlantNumber."No.");
        SchedulerResource.Permission(SchedulerPermission.FullControl);
        MainResourceNo := GetMainResourceNo(Resource."No.", DummyResource);
        IF MainResourceNo <> '' THEN BEGIN
          SchedulerResource.GroupIdentifier(MainResourceNo);
          SchedulerCommand := SchedulerCommand.SchedulerCommand();
          SchedulerCommand.Identifier('SchedulerFilterResourceGroup');
          SchedulerCommand.Visible(GlobalVariantTrue);
          SchedulerResource.AddCommand(SchedulerCommand);
        END;
        IF EnableDimension1ResourceLabel THEN BEGIN
          GeneralLedgerSetup.GET;
          IF PlantNumber."Department Code" <> '' THEN BEGIN
            IF DimensionValue.GET(GeneralLedgerSetup."Global Dimension 1 Code", PlantNumber."Department Code") THEN BEGIN
              SchedulerResource.AddFeature('dimension1resource', PlantNumber."Department Code" + ' ' + DimensionValue.Name);
            END;
          END;
        END;
        IF EnableResourceTypeLabel THEN BEGIN
          SchedulerResource.AddFeature('resourcetype', FORMAT(Resource.Type));
        END;
        SchedulerResource.AddFeature('name', Resource.Name);
        IF EnableExternalLabel THEN
          SchedulerResource.AddFeature('external', FORMAT(PlantNumber.External));
        IF EnablePlannerLabel THEN BEGIN
          IF Resource.Planner <> '' THEN BEGIN
            SchedulerResource.AddFeature('planner', Resource.Planner + ' ' + Resource.GetPlannerName);
          END;
        END;
        IF EnablePlantTypeWithGroupsLabel THEN
          SchedulerResource.AddFeature('planttypewithgroups', CombinedGroupingLevelsAndPlantType(PlantType, SourceCompany));
        ResourceDiscipline.SETRANGE("Resource No.", Resource."No.");
        IF ResourceDiscipline.FINDSET THEN BEGIN
          REPEAT
            IF Discipline.GET(ResourceDiscipline.Discipline) THEN BEGIN
              IF EnableDisciplineLabel THEN BEGIN
                SchedulerResource.AddFeature('discipline', Discipline.Code + ' ' + Discipline.Description);
              END;
              IF EnableTradeSpecialityLabel THEN BEGIN
                TradeSpeciality.SETRANGE(Discipline, Discipline.Code);
                IF TradeSpeciality.FINDSET THEN BEGIN
                  REPEAT
                    SchedulerResource.AddFeature('tradespeciality', TradeSpeciality.Code + ' ' + TradeSpeciality.Description);
                  UNTIL TradeSpeciality.NEXT = 0;
                END;
              END;
            END;
          UNTIL ResourceDiscipline.NEXT = 0;
        END;
        IF PlantType.Image.HASVALUE THEN BEGIN
          IF Resource.Company <> COMPANYNAME THEN
            CheckTenantMediaCompany(PlantType.Image.MEDIAID);
          FullFileName := GetTmpFullFileName(FALSE);
          IF PlantType.Image.EXPORTFILE(FullFileName) THEN BEGIN
            CreateBase64Content(FullFileName, Base64EncodedContents);
           SchedulerResource.Image(Base64EncodedContents);
          END;
        END;
        ResourceWorkingTimes(Resource."Source No.", Resource.Company, SchedulerResource);
        ResourcesAvailable := TRUE;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ExportResourceEmployee@1100529001(VAR SchedulerResource@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";Resource@1100525001 : Record 11229278) : Boolean;
    VAR
      Employee@1100529001 : Record 5200;
      ResourceDiscipline@1100528300 : Record 11229286;
      Discipline@1100528301 : Record 11020204;
      EmployeeQualification@1100529100 : Record 5203;
      Qualification@1100529101 : Record 5202;
      TradeSpeciality@1100529102 : Record 11020285;
      DimensionValue@1100529104 : Record 349;
      GeneralLedgerSetup@1100529105 : Record 98;
      SchedulerPermission@1100528500 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      DummyResource@1100528302 : Code[20];
      SourceCompany@1100529003 : Text;
      FullFileName@1100529005 : Text;
      Base64EncodedContents@1100529006 : BigText;
      MainResourceNo@1100527701 : Text;
      SchedulerCommand@1100527700 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerCommand";
    BEGIN
      IF Resource.ISEMPTY THEN
        EXIT(FALSE);

      IF Resource.Company <> SourceCompany THEN BEGIN
        Employee.CHANGECOMPANY(Resource.Company);
        EmployeeQualification.CHANGECOMPANY(Resource.Company);
        Qualification.CHANGECOMPANY(Resource.Company);
        DimensionValue.CHANGECOMPANY(Resource.Company);
        GeneralLedgerSetup.CHANGECOMPANY(Resource.Company);
        SourceCompany := Resource.Company;
      END;
      IF Employee.GET(Resource."Source No.") THEN BEGIN
        SchedulerResource.Identifier(Resource."No.");
        SchedulerResource.Name(Employee."Full Name");
        SchedulerResource.Type('employee');
        SchedulerResource.Description(Employee."No.");
        SchedulerResource.Permission(SchedulerPermission.FullControl);
        MainResourceNo := GetMainResourceNo(Resource."No.", DummyResource);
        IF MainResourceNo <> '' THEN BEGIN
          SchedulerResource.GroupIdentifier(MainResourceNo);
          SchedulerCommand := SchedulerCommand.SchedulerCommand();
          SchedulerCommand.Identifier('SchedulerFilterResourceGroup');
          SchedulerCommand.Visible(GlobalVariantTrue);
          SchedulerResource.AddCommand(SchedulerCommand);
        END;
        IF EnableDimension1ResourceLabel THEN BEGIN
          IF Employee."Global Dimension 1 Code" <> '' THEN BEGIN
            GeneralLedgerSetup.GET;
            IF DimensionValue.GET(GeneralLedgerSetup."Global Dimension 1 Code", Employee."Global Dimension 1 Code") THEN BEGIN
              SchedulerResource.AddFeature('dimension1resource', Employee."Global Dimension 1 Code" + ' ' + DimensionValue.Name);
            END;
          END;
        END;
        IF EnableResourceTypeLabel THEN BEGIN
          SchedulerResource.AddFeature('resourcetype', FORMAT(Resource.Type));
        END;
        SchedulerResource.AddFeature('name', Resource.Name);
        IF EnableExternalLabel THEN
          SchedulerResource.AddFeature('external', FORMAT(Employee.External));
        IF EnablePlannerLabel THEN BEGIN
          IF Resource.Planner <> '' THEN BEGIN
            SchedulerResource.AddFeature('planner', Resource.Planner + ' ' + Resource.GetPlannerName);
          END;
        END;
        ResourceDiscipline.SETRANGE("Resource No.", Resource."No.");
        IF ResourceDiscipline.FINDSET THEN BEGIN
          REPEAT
            IF Discipline.GET(ResourceDiscipline.Discipline) THEN BEGIN
              IF EnableDisciplineLabel THEN BEGIN
                SchedulerResource.AddFeature('discipline', Discipline.Code + ' ' + Discipline.Description);
              END;
              IF EnableTradeSpecialityLabel THEN BEGIN
                TradeSpeciality.SETRANGE(Discipline, Discipline.Code);
                IF TradeSpeciality.FINDSET THEN BEGIN
                  REPEAT
                    SchedulerResource.AddFeature('tradespeciality', TradeSpeciality.Code + ' ' + TradeSpeciality.Description);
                  UNTIL TradeSpeciality.NEXT = 0;
                END;
              END;
            END;
          UNTIL ResourceDiscipline.NEXT = 0;
        END;
        IF EnableQualificationLabel THEN BEGIN
          EmployeeQualification.SETRANGE("Employee No.", Employee."No.");
          IF EmployeeQualification.FINDSET THEN BEGIN
            REPEAT
              IF Qualification.GET(EmployeeQualification."Qualification Code") THEN BEGIN
                SchedulerResource.AddFeature('qualification', Qualification.Code + ' ' + Qualification.Description);
              END;
            UNTIL EmployeeQualification.NEXT = 0;
          END;
        END;
        IF Employee.Image.HASVALUE THEN BEGIN
          IF Resource.Company <> COMPANYNAME THEN
            CheckTenantMediaCompany(Employee.Image.MEDIAID);
          FullFileName := GetTmpFullFileName(FALSE);
          IF Employee.Image.EXPORTFILE(FullFileName) THEN BEGIN
            CreateBase64Content(FullFileName, Base64EncodedContents);
            SchedulerResource.Image(Base64EncodedContents);
          END;
        END;
        ResourceWorkingTimes(Resource."Source No.", Resource.Company, SchedulerResource);
        ResourcesAvailable := TRUE;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ExportResourceSubcontractor@1100525021(VAR SchedulerResource@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";Resource@1100525001 : Record 11229278) : Boolean;
    VAR
      Vendor@1100529001 : Record 23;
      ResourceDiscipline@1100528300 : Record 11229286;
      Discipline@1100528301 : Record 11020204;
      TradeSpeciality@1100529100 : Record 11020285;
      DimensionValue@1100529102 : Record 349;
      GeneralLedgerSetup@1100529103 : Record 98;
      SchedulerPermission@1100528500 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      DummyResource@1100528302 : Code[20];
      SourceCompany@1100529003 : Text;
      FullFileName@1100529005 : Text;
      Base64EncodedContents@1100529006 : BigText;
      MainResourceNo@1100527701 : Text;
      SchedulerCommand@1100527700 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerCommand";
    BEGIN
      IF Resource.ISEMPTY THEN
        EXIT(FALSE);

      IF Resource.Company <> SourceCompany THEN BEGIN
        Vendor.CHANGECOMPANY(Resource.Company);
        DimensionValue.CHANGECOMPANY(Resource.Company);
        GeneralLedgerSetup.CHANGECOMPANY(Resource.Company);
        SourceCompany := Resource.Company;
      END;
      IF Vendor.GET(Resource."Source No.") THEN BEGIN
        SchedulerResource.Identifier(Resource."No.");
        SchedulerResource.Name(Resource.Name);
        SchedulerResource.Type('subcontractor');
        SchedulerResource.Description(Vendor."No.");
        SchedulerResource.Permission(SchedulerPermission.FullControl);
        MainResourceNo := GetMainResourceNo(Resource."No.", DummyResource);
        IF MainResourceNo <> '' THEN BEGIN
          SchedulerResource.GroupIdentifier(MainResourceNo);
          SchedulerCommand := SchedulerCommand.SchedulerCommand();
          SchedulerCommand.Identifier('SchedulerFilterResourceGroup');
          SchedulerCommand.Visible(GlobalVariantTrue);
          SchedulerResource.AddCommand(SchedulerCommand);
        END;
        IF EnableDimension1ResourceLabel THEN BEGIN
          IF Vendor."Global Dimension 1 Code" <> '' THEN BEGIN
            GeneralLedgerSetup.GET;
            IF DimensionValue.GET(GeneralLedgerSetup."Global Dimension 1 Code", Vendor."Global Dimension 1 Code") THEN BEGIN
              SchedulerResource.AddFeature('dimension1resource', Vendor."Global Dimension 1 Code" + ' ' + DimensionValue.Name);
            END;
          END;
        END;
        IF EnableResourceTypeLabel THEN BEGIN
          SchedulerResource.AddFeature('resourcetype', FORMAT(Resource.Type));
        END;
        SchedulerResource.AddFeature('name', Resource.Name);
        IF EnableExternalLabel THEN
          SchedulerResource.AddFeature('external', FORMAT(TRUE));
        IF EnablePlannerLabel THEN BEGIN
          IF Resource.Planner <> '' THEN BEGIN
            SchedulerResource.AddFeature('planner', Resource.Planner + ' ' + Resource.GetPlannerName);
          END;
        END;
        ResourceDiscipline.SETRANGE("Resource No.", Resource."No.");
        IF ResourceDiscipline.FINDSET THEN BEGIN
          REPEAT
            IF Discipline.GET(ResourceDiscipline.Discipline) THEN BEGIN
              IF EnableDisciplineLabel THEN BEGIN
                SchedulerResource.AddFeature('discipline', Discipline.Code + ' ' + Discipline.Description);
              END;
              IF EnableTradeSpecialityLabel THEN BEGIN
                TradeSpeciality.SETRANGE(Discipline, Discipline.Code);
                IF TradeSpeciality.FINDSET THEN BEGIN
                  REPEAT
                    SchedulerResource.AddFeature('tradespeciality', TradeSpeciality.Code + ' ' + TradeSpeciality.Description);
                  UNTIL TradeSpeciality.NEXT = 0;
                END;
              END;
            END;
          UNTIL ResourceDiscipline.NEXT = 0;
        END;
        IF Vendor.Image.HASVALUE THEN BEGIN
          IF Resource.Company <> COMPANYNAME THEN
              CheckTenantMediaCompany(Vendor.Image.MEDIAID);
          FullFileName := GetTmpFullFileName(FALSE);
          IF Vendor.Image.EXPORTFILE(FullFileName) THEN BEGIN
            CreateBase64Content(FullFileName, Base64EncodedContents);
            SchedulerResource.Image(Base64EncodedContents);
          END;
        END;
        ResourceWorkingTimes(Resource."Source No.", Resource.Company, SchedulerResource);
        ResourcesAvailable := TRUE;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ExportResourceGroupDiscipline@1100525022(VAR SchedulerResource@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";ResourceGroup@1100525001 : Record 11229384) : Boolean;
    VAR
      Discipline@1100528300 : Record 11020204;
      SchedulerPermission@1100528500 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      SourceCompany@1100529001 : Text;
    BEGIN
      IF ResourceGroup.ISEMPTY THEN
        EXIT(FALSE);

      IF ResourceGroup.Company <> SourceCompany THEN BEGIN
        Discipline.CHANGECOMPANY(ResourceGroup.Company);
        SourceCompany := ResourceGroup.Company;
      END;
      IF Discipline.GET(ResourceGroup."Source No.") THEN BEGIN
        SchedulerResource.Identifier(FormatResourceGroup2GRPResourceNo(DATABASE::Discipline, ResourceGroup."No."));
        SchedulerResource.Name(ResourceGroup.Name);
        SchedulerResource.Description(ResourceGroup."No.");
        SchedulerResource.Permission(SchedulerPermission.FullControl);
        SchedulerResource.Type('groupdiscipline');
        IF EnableResourceTypeLabel THEN BEGIN
          SchedulerResource.AddFeature('resourcetype', Discipline.TABLECAPTION);
        END;
        IF EnableDisciplineLabel THEN BEGIN
          SchedulerResource.AddFeature('discipline', Discipline.Code + ' ' + Discipline.Description);
        END;
        SchedulerResource.AddFeature('name', ResourceGroup.Name);
        IF EnableExternalLabel THEN BEGIN
          SchedulerResource.AddFeature('external', FORMAT(FALSE));  // Must be send with FALSE and TRUE
          SchedulerResource.AddFeature('external', FORMAT(TRUE));
        END;
        ResourceWorkingTimes('', ResourceGroup.Company, SchedulerResource);
        ResourcesAvailable := TRUE;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ExportResourceGroupPlantType@1100525023(VAR SchedulerResource@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";ResourceGroup@1100525001 : Record 11229384) : Boolean;
    VAR
      PlantType@1100529000 : Record 11012551;
      SchedulerPermission@1100528500 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      FullFileName@1100528301 : Text;
      SourceCompany@1100529003 : Text;
      Base64EncodedContents@1100528300 : BigText;
    BEGIN
      IF ResourceGroup.ISEMPTY THEN
        EXIT(FALSE);

      IF ResourceGroup.Company <> SourceCompany THEN BEGIN
        PlantType.CHANGECOMPANY(ResourceGroup.Company);
        SourceCompany := ResourceGroup.Company;
      END;
      IF PlantType.GET(ResourceGroup."Source No.") THEN BEGIN
        SchedulerResource.Identifier(FormatResourceGroup2GRPResourceNo(DATABASE::"Plant Type", ResourceGroup."No."));
        SchedulerResource.Name(ResourceGroup.Name);
        SchedulerResource.Description(ResourceGroup."No.");
        SchedulerResource.Permission(SchedulerPermission.FullControl);
        SchedulerResource.Type('groupplant');
        IF EnableResourceTypeLabel THEN BEGIN
          SchedulerResource.AddFeature('resourcetype', PlantType.TABLECAPTION);
        END;
        SchedulerResource.AddFeature('name', ResourceGroup.Name);
        IF EnablePlantTypeWithGroupsLabel THEN
          SchedulerResource.AddFeature('planttypewithgroups', CombinedGroupingLevelsAndPlantType(PlantType, COMPANYNAME));
        IF EnableExternalLabel THEN BEGIN
          SchedulerResource.AddFeature('external', FORMAT(FALSE));  // Must be send with FALSE and TRUE (do not use External of Plant Type!)
          SchedulerResource.AddFeature('external', FORMAT(TRUE));
        END;
        IF PlantType.Image.HASVALUE THEN BEGIN
          FullFileName := GetTmpFullFileName(FALSE);
          IF PlantType.Image.EXPORTFILE(FullFileName) THEN BEGIN
            CreateBase64Content(FullFileName, Base64EncodedContents);
            SchedulerResource.Image(Base64EncodedContents);
          END;
        END;
        ResourceWorkingTimes('', ResourceGroup.Company, SchedulerResource);
        ResourcesAvailable := TRUE;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckTenantMediaCompany@1100525005(MediaIdGuid@1100525001 : GUID);
    VAR
      TenantMedia@1100525000 : Record 2000000184;
    BEGIN
      IF TenantMedia.GET(MediaIdGuid) THEN BEGIN
        IF TenantMedia."Company Name" <> '' THEN BEGIN  // If company is filled then image of a resource of an other company is not exported,
          TenantMedia."Company Name" := '';             // despite image.HASVLUE is true. Working NAV platform (bug?).
          TenantMedia.MODIFY;
          COMMIT;
        END;
      END;
    END;

    LOCAL PROCEDURE GetMainResourceNo@1100529027(ResourceNo@1100529001 : Code[20];VAR ResourceOperatesPlant@1100528300 : Code[20]) : Code[20];
    VAR
      LinkedResource@1100529000 : Record 11229324;
    BEGIN
      ResourceOperatesPlant := '';
      IF ResourceNo <> '' THEN BEGIN
        LinkedResource.SETRANGE("Main Resource No.", ResourceNo);
        IF LinkedResource.FINDFIRST THEN
          EXIT(LinkedResource."Main Resource No.");
        LinkedResource.RESET;
        LinkedResource.SETCURRENTKEY("Resource No.");
        LinkedResource.SETRANGE("Resource No.", ResourceNo);
        LinkedResource.SETAUTOCALCFIELDS("Resource Type");
        IF LinkedResource.FINDFIRST THEN BEGIN
          IF LinkedResource."Resource Type" IN [LinkedResource."Resource Type"::Employee, LinkedResource."Resource Type"::Subcontractor] THEN
            ResourceOperatesPlant := LinkedResource."Operates Plant";
          EXIT(LinkedResource."Main Resource No.");
        END;
      END;
      EXIT('');
    END;

    LOCAL PROCEDURE CombinedGroupingLevelsAndPlantType@1100529017(PlantType@1100529000 : Record 11012551;SourceCompany@1100529001 : Text) GroupingLevelsAndPlantType : Text;
    BEGIN
      IF PlantType."Group Level 1" <> '' THEN BEGIN
        GroupingLevelsAndPlantType := PlantGroupingDescription(PlantType."Group Level 1", SourceCompany) +'|';
        IF PlantType."Group Level 2" <> '' THEN BEGIN
          GroupingLevelsAndPlantType := GroupingLevelsAndPlantType + PlantGroupingDescription(PlantType."Group Level 2", SourceCompany) +'|';
          IF PlantType."Group Level 3" <> '' THEN
            GroupingLevelsAndPlantType := GroupingLevelsAndPlantType + PlantGroupingDescription(PlantType."Group Level 3", SourceCompany) +'|';
        END;
      END;
      GroupingLevelsAndPlantType := GroupingLevelsAndPlantType + PlantType.Code + ' - ' + PlantType.Description;
    END;

    LOCAL PROCEDURE PlantGroupingDescription@1100529026(GroupLevelCode@1100529000 : Code[20];SourceCompany@1100529002 : Text) : Text;
    VAR
      GroupingLevel@1100529001 : Record 11012576;
    BEGIN
      IF GroupLevelCode <> '' THEN BEGIN
        IF SourceCompany <> COMPANYNAME THEN
          GroupingLevel.CHANGECOMPANY(SourceCompany);
        IF GroupingLevel.GET(GroupLevelCode) THEN BEGIN
          IF GroupingLevel.Description <> '' THEN
            EXIT(GroupLevelCode + ' - ' + GroupingLevel.Description);
        END;
        EXIT(GroupLevelCode + ' - ' + GroupingLevel.TABLECAPTION + ' ' + GroupLevelCode);
      END;
      EXIT('');
    END;

    LOCAL PROCEDURE ResourceWorkingTimes@1100529003(ResourceNo@1100529006 : Code[20];ResourceCompany@1100529007 : Text;VAR ChildSchedulerResource@1100529008 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource");
    VAR
      EmployeeTimeTable@1100529000 : Record 11012923;
      BaseCalendar@1100529100 : Record 11072014;
      CompanyInformation@1100529101 : Record 79;
      ResourceWOP@1100527651 : Record 11229278;
      WorkTimeFrom1@1100529002 : Time;
      WorkTimeUntil1@1100529003 : Time;
      WorkTimeFrom2@1100529004 : Time;
      WorkTimeUntil2@1100529005 : Time;
      DayNo@1100529001 : Integer;
      EffectiveDate@1100529102 : Date;
      SkipBaseCalendar@1100527706 : Boolean;
      BaseCalendarDate@1100527705 : Date;
      BaseCalendarCompany@1100527650 : Text;
    BEGIN
      BaseCalendarDate := 700101D; //this is a constant value. Don't change

      IF ResourceNo <> '' THEN BEGIN
        EmployeeTimeTable.CHANGECOMPANY(ResourceCompany);
        EmployeeTimeTable.SETRANGE("Employee No.", ResourceNo);
        EmployeeTimeTable.SETFILTER("Effective Date", '<%1', TODAY+365);
        IF EmployeeTimeTable.FINDSET THEN
          REPEAT
            IF EmployeeTimeTable."Effective Date" <> 0D THEN
              EffectiveDate := EmployeeTimeTable."Effective Date"
            ELSE
              EffectiveDate := BaseCalendarDate;

            IF EffectiveDate = BaseCalendarDate THEN
              SkipBaseCalendar := TRUE;

            FOR DayNo := 1 TO 7 DO BEGIN
              CreateWorkTimes(DayNo, EmployeeTimeTable, WorkTimeFrom1, WorkTimeUntil1, WorkTimeFrom2, WorkTimeUntil2);
              IF (WorkTimeFrom1 <> 0T) AND (WorkTimeUntil1 <> 0T) THEN
                ChildSchedulerResource.AddBusinessHours(FormatDate(EffectiveDate), DayNo, FormatTime(WorkTimeFrom1), FormatTime(WorkTimeUntil1));
              IF (WorkTimeFrom2 <> 0T) AND (WorkTimeUntil2 <> 0T) THEN
                ChildSchedulerResource.AddBusinessHours(FormatDate(EffectiveDate), DayNo, FormatTime(WorkTimeFrom2), FormatTime(WorkTimeUntil2));
            END;
          UNTIL EmployeeTimeTable.NEXT = 0;
      END;

      IF NOT SkipBaseCalendar THEN BEGIN
        BaseCalendarCompany := ResourceWOP.GetPlanGroupCompany(ResourceCompany);
        IF BaseCalendarCompany <> COMPANYNAME THEN BEGIN
          CompanyInformation.CHANGECOMPANY(BaseCalendarCompany);
          BaseCalendar.CHANGECOMPANY(BaseCalendarCompany);
        END;
        CompanyInformation.GET;
        IF BaseCalendar.GET(CompanyInformation."Base Calendar Code") THEN BEGIN
          FOR DayNo := 1 TO 7 DO BEGIN
            CreateWorkTimesBaseCalendar(DayNo, BaseCalendar, WorkTimeFrom1, WorkTimeUntil1, WorkTimeFrom2, WorkTimeUntil2);
            IF (WorkTimeFrom1 <> 0T) AND (WorkTimeUntil1 <> 0T) THEN
              ChildSchedulerResource.AddBusinessHours(FormatDate(BaseCalendarDate), DayNo, FormatTime(WorkTimeFrom1), FormatTime(WorkTimeUntil1));
            IF (WorkTimeFrom2 <> 0T) AND (WorkTimeUntil2 <> 0T) THEN
              ChildSchedulerResource.AddBusinessHours(FormatDate(BaseCalendarDate), DayNo, FormatTime(WorkTimeFrom2), FormatTime(WorkTimeUntil2));
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE CreateWorkTimes@1100529008(Dayno@1100529000 : Integer;EmployeeTimeTable@1100529001 : Record 11012923;VAR WorkTimeFrom1@1100529002 : Time;VAR WorkTimeUntil1@1100529003 : Time;VAR WorkTimeFrom2@1100529004 : Time;VAR WorkTimeUntil2@1100529005 : Time);
    VAR
      WorkFrom@1100529006 : Time;
      WorkUntil@1100529007 : Time;
      PauseFrom@1100529008 : Time;
      PauseUntil@1100529009 : Time;
    BEGIN
      WorkTimeFrom1 := 0T;
      WorkTimeUntil1 := 0T;
      WorkTimeFrom2 := 0T;
      WorkTimeUntil2 := 0T;
      CASE Dayno OF
        1:
          BEGIN
            WorkFrom := EmployeeTimeTable."Monday Work From";
            WorkUntil := EmployeeTimeTable."Monday Work Until";
            PauseFrom := EmployeeTimeTable."Monday Pause From";
            PauseUntil := EmployeeTimeTable."Monday Pause Until";
          END;
        2:
          BEGIN
            WorkFrom := EmployeeTimeTable."Tuesday Work From";
            WorkUntil := EmployeeTimeTable."Tuesday Work Until";
            PauseFrom := EmployeeTimeTable."Tuesday Pause From";
            PauseUntil := EmployeeTimeTable."Tuesday Pause Until";
          END;
        3:
          BEGIN
            WorkFrom := EmployeeTimeTable."Wednesday Work From";
            WorkUntil := EmployeeTimeTable."Wednesday Work Until";
            PauseFrom := EmployeeTimeTable."Wednesday Pause From";
            PauseUntil := EmployeeTimeTable."Wednesday Pause Until";
          END;
        4:
          BEGIN
            WorkFrom := EmployeeTimeTable."Thursday Work From";
            WorkUntil := EmployeeTimeTable."Thursday Work Until";
            PauseFrom := EmployeeTimeTable."Thursday Pause From";
            PauseUntil := EmployeeTimeTable."Thursday Pause Until";
          END;
        5:
          BEGIN
            WorkFrom := EmployeeTimeTable."Friday Work From";
            WorkUntil := EmployeeTimeTable."Friday Work Until";
            PauseFrom := EmployeeTimeTable."Friday Pause From";
            PauseUntil := EmployeeTimeTable."Friday Pause Until";
          END;
        6:
          BEGIN
            WorkFrom := EmployeeTimeTable."Saturday Work From";
            WorkUntil := EmployeeTimeTable."Saturday Work Until";
            PauseFrom := EmployeeTimeTable."Saturday Pause From";
            PauseUntil := EmployeeTimeTable."Saturday Pause Until";
          END;
        7:
          BEGIN
            WorkFrom := EmployeeTimeTable."Sunday Work From";
            WorkUntil := EmployeeTimeTable."Sunday Work Until";
            PauseFrom := EmployeeTimeTable."Sunday Pause From";
            PauseUntil := EmployeeTimeTable."Sunday Pause Until";
          END;
      END;
      IF (WorkFrom <> 0T) AND  (WorkUntil <> 0T) THEN BEGIN
        WorkTimeFrom1 := WorkFrom;
        WorkTimeUntil1 := WorkUntil;
        IF (PauseFrom <> 0T) AND (PauseUntil <> 0T) THEN BEGIN
          WorkTimeUntil1 := PauseFrom;
          WorkTimeFrom2 := PauseUntil;
          WorkTimeUntil2 := WorkUntil;
        END;
      END;
    END;

    LOCAL PROCEDURE CreateWorkTimesBaseCalendar@1100529104(Dayno@1100529000 : Integer;BaseCalendar@1100529001 : Record 11072014;VAR WorkTimeFrom1@1100529002 : Time;VAR WorkTimeUntil1@1100529003 : Time;VAR WorkTimeFrom2@1100529004 : Time;VAR WorkTimeUntil2@1100529005 : Time);
    VAR
      WorkFrom@1100529006 : Time;
      WorkUntil@1100529007 : Time;
      PauseFrom@1100529008 : Time;
      PauseUntil@1100529009 : Time;
    BEGIN
      WorkTimeFrom1 := 0T;
      WorkTimeUntil1 := 0T;
      WorkTimeFrom2 := 0T;
      WorkTimeUntil2 := 0T;
      CASE Dayno OF
        1:
          BEGIN
            WorkFrom := BaseCalendar."Monday Work From";
            WorkUntil := BaseCalendar."Monday Work Until";
            PauseFrom := BaseCalendar."Monday Pause From";
            PauseUntil := BaseCalendar."Monday Pause Until";
          END;
        2:
          BEGIN
            WorkFrom := BaseCalendar."Tuesday Work From";
            WorkUntil := BaseCalendar."Tuesday Work Until";
            PauseFrom := BaseCalendar."Tuesday Pause From";
            PauseUntil := BaseCalendar."Tuesday Pause Until";
          END;
        3:
          BEGIN
            WorkFrom := BaseCalendar."Wednesday Work From";
            WorkUntil := BaseCalendar."Wednesday Work Until";
            PauseFrom := BaseCalendar."Wednesday Pause From";
            PauseUntil := BaseCalendar."Wednesday Pause Until";
          END;
        4:
          BEGIN
            WorkFrom := BaseCalendar."Thursday Work From";
            WorkUntil := BaseCalendar."Thursday Work Until";
            PauseFrom := BaseCalendar."Thursday Pause From";
            PauseUntil := BaseCalendar."Thursday Pause Until";
          END;
        5:
          BEGIN
            WorkFrom := BaseCalendar."Friday Work From";
            WorkUntil := BaseCalendar."Friday Work Until";
            PauseFrom := BaseCalendar."Friday Pause From";
            PauseUntil := BaseCalendar."Friday Pause Until";
          END;
        6:
          BEGIN
            WorkFrom := BaseCalendar."Saturday Work From";
            WorkUntil := BaseCalendar."Saturday Work Until";
            PauseFrom := BaseCalendar."Saturday Pause From";
            PauseUntil := BaseCalendar."Saturday Pause Until";
          END;
        7:
          BEGIN
            WorkFrom := BaseCalendar."Sunday Work From";
            WorkUntil := BaseCalendar."Sunday Work Until";
            PauseFrom := BaseCalendar."Sunday Pause From";
            PauseUntil := BaseCalendar."Sunday Pause Until";
          END;
      END;
      IF (WorkFrom <> 0T) AND  (WorkUntil <> 0T) THEN BEGIN
        WorkTimeFrom1 := WorkFrom;
        WorkTimeUntil1 := WorkUntil;
        IF (PauseFrom <> 0T) AND (PauseUntil <> 0T) THEN BEGIN
          WorkTimeUntil1 := PauseFrom;
          WorkTimeFrom2 := PauseUntil;
          WorkTimeUntil2 := WorkUntil;
        END;
      END;
    END;

    LOCAL PROCEDURE EvaluateWorkingTimesBaseCalendar@1100529111(VAR StartingDateTime@1100529100 : DateTime;VAR EndingDateTime@1100529101 : DateTime);
    VAR
      BaseCalendar@1100529108 : Record 11072014;
      CompanyInformation@1100529107 : Record 79;
      WorkTimeFrom1@1100529106 : Time;
      WorkTimeUntil1@1100529105 : Time;
      WorkTimeFrom2@1100529104 : Time;
      WorkTimeUntil2@1100529103 : Time;
      StartDate@1100529114 : Date;
      StartTime@1100529113 : Time;
      StartDayOfWeek@1100529112 : Integer;
      EndDate@1100529111 : Date;
      EndTime@1100529110 : Time;
      EndDayOfWeek@1100529109 : Integer;
    BEGIN
      StartDate := DT2DATE(StartingDateTime);
      StartTime := DT2TIME(StartingDateTime);
      StartDayOfWeek := DATE2DWY(StartDate,1);
      EndDate := DT2DATE(EndingDateTime);
      EndTime := DT2TIME(EndingDateTime);
      IF EndTime = 000000T THEN BEGIN
        EndTime := 235959T;
        EndDate := EndDate - 1;
      END;
      EndDayOfWeek := DATE2DWY(EndDate,1);

      CompanyInformation.GET;
      IF BaseCalendar.GET(CompanyInformation."Base Calendar Code") THEN BEGIN
        CreateWorkTimesBaseCalendar(StartDayOfWeek, BaseCalendar, WorkTimeFrom1, WorkTimeUntil1, WorkTimeFrom2, WorkTimeUntil2);
        StartTime := WorkTimeFrom1;
        CreateWorkTimesBaseCalendar(EndDayOfWeek, BaseCalendar, WorkTimeFrom1, WorkTimeUntil1, WorkTimeFrom2, WorkTimeUntil2);
        IF WorkTimeUntil2 <> 0T THEN
          EndTime := WorkTimeUntil2
        ELSE
          EndTime := WorkTimeUntil1;
        StartingDateTime := CREATEDATETIME(StartDate, StartTime);
        EndingDateTime := CREATEDATETIME(EndDate, EndTime);
      END;
    END;

    LOCAL PROCEDURE ExportWorkorders@1100529010(VAR SchedulerEvents@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";PlanHorizonStartDate@1100529006 : Date;PlanHorizonEndDate@1100529005 : Date;VAR WorkorderLastExportedOn@1100529001 : DateTime);
    VAR
      WorkOrder@1100529000 : Record 11229279;
      Resource@1100529003 : Record 11229278;
      ResourceGroup@1100529004 : Record 11229384;
      TypeNo@1100529007 : Integer;
      DurationDateTime@1100529100 : Duration;
      EndDateTime@1100529101 : DateTime;
    BEGIN
      TmpWorkOrderExported.DELETEALL;
      SetKeyAndFiltersResources(Resource, -1, 'SOURCENO');
      WorkorderLastExportedOn := CURRENTDATETIME;
      IF Resource.FINDSET THEN BEGIN
        WorkOrder.SETCURRENTKEY("Resource No.", "Starting Date/Time", "Ending Date/Time");
        WorkOrder.SETFILTER("Starting Date/Time", '<%1&<>%2', CREATEDATETIME(PlanHorizonEndDate+1,0T), 0DT);
        WorkOrder.SETFILTER("Ending Date/Time", '>=%1|%2', CREATEDATETIME(PlanHorizonStartDate,0T), 0DT);
        WorkOrder.SETAUTOCALCFIELDS("Actual Reference Point Desc.");
        REPEAT
          WorkOrder.SETRANGE("Resource No.", Resource."No.");
          IF WorkOrder.FINDSET THEN BEGIN
            REPEAT
              IF WorkOrder."Ending Date/Time" = 0DT THEN BEGIN
                DurationDateTime := ROUND(WorkOrder."Duration Time", 0.01) * 3600000;
                EndDateTime := WorkOrder."Starting Date/Time" + DurationDateTime;
              END;
              IF (WorkOrder."Ending Date/Time" <> 0DT) OR (EndDateTime >= CREATEDATETIME(PlanHorizonStartDate,0T)) THEN
                ExportWorkorderData(SchedulerEvents, WorkOrder);
            UNTIL WorkOrder.NEXT = 0;
          END;
        UNTIL Resource.NEXT = 0;
      END;

      FOR TypeNo := 1 TO 2 DO BEGIN
        WorkOrder.RESET;
        IF TypeNo = 1 THEN
          SetKeyAndFiltersResourceGroups(ResourceGroup, ResourceGroup.Type::Plant, '')
        ELSE
          SetKeyAndFiltersResourceGroups(ResourceGroup, ResourceGroup.Type::Discipline, '');
        IF ResourceGroup.FINDSET THEN BEGIN
          WorkOrder.SETCURRENTKEY("Resource No.", "Starting Date/Time", "Ending Date/Time");
          WorkOrder.SETFILTER("Starting Date/Time", '<%1&<>%2', CREATEDATETIME(PlanHorizonEndDate+1,0T), 0DT);
          WorkOrder.SETFILTER("Ending Date/Time", '>=%1|%2', CREATEDATETIME(PlanHorizonStartDate,0T), 0DT);
          WorkOrder.SETRANGE("Resource No.", '');
          WorkOrder.SETRANGE("Source Company", COMPANYNAME);
          WorkOrder.SETAUTOCALCFIELDS("Actual Reference Point Desc.");
          REPEAT
            WorkOrder.SETRANGE("Resource Group No.", ResourceGroup."No.");
            IF WorkOrder.FINDSET THEN BEGIN
              REPEAT
                IF WorkOrder."Ending Date/Time" = 0DT THEN BEGIN
                  DurationDateTime := ROUND(WorkOrder."Duration Time", 0.01) * 3600000;
                  EndDateTime := WorkOrder."Starting Date/Time" + DurationDateTime;
                END;
                IF (WorkOrder."Ending Date/Time" <> 0DT) OR (EndDateTime >= CREATEDATETIME(PlanHorizonStartDate,0T)) THEN
                  ExportWorkorderData(SchedulerEvents, WorkOrder);
              UNTIL WorkOrder.NEXT = 0;
            END;
          UNTIL ResourceGroup.NEXT = 0;
        END;
      END;
    END;

    LOCAL PROCEDURE ExportChangeLogWorkorders@1100529029(VAR SchedulerEvents@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR SchedulerEventsDelete@1100529010 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";PlanHorizonStartDate@1100529006 : Date;PlanHorizonEndDate@1100529005 : Date;VAR WorkorderLastExportedOn@1100529004 : DateTime);
    VAR
      WorkOrderChangeLogGRP@1100529001 : Record 11124906;
      WorkOrderChangeLogGRP2@1100529009 : Record 11124906;
      TmpWorkOrderChangeLogGRP@1100529011 : TEMPORARY Record 11124906;
      WorkOrder@1100529000 : Record 11229279;
      Resource@1100529003 : Record 11229278;
      ResourceGroup@1100529012 : Record 11229384;
      PrevWorkorderLastExportedOn@1100529008 : DateTime;
      PlanHorizonStartDateTime@1100529014 : DateTime;
      PlanHorizonEndDateTime@1100529013 : DateTime;
      DeleteInGRP@1100529007 : Boolean;
    BEGIN
      PrevWorkorderLastExportedOn := WorkorderLastExportedOn;
      WorkorderLastExportedOn := CURRENTDATETIME;
      WorkOrderChangeLogGRP.SETRANGE("Modified On", PrevWorkorderLastExportedOn, WorkorderLastExportedOn);
      IF NOT WorkOrderChangeLogGRP.FINDSET THEN
        EXIT;
      TmpWorkOrderChangeLogGRP.DELETEALL;
      PlanHorizonStartDateTime := CREATEDATETIME(PlanHorizonStartDate, 0T);
      PlanHorizonEndDateTime := CREATEDATETIME(PlanHorizonEndDate+1,0T);
      SetKeyAndFiltersResources(Resource, -1, '');
      SetKeyAndFiltersResourceGroups(ResourceGroup, -1, '');
      WorkOrderChangeLogGRP2.SETCURRENTKEY("Work Order No.", "Modified On");
      REPEAT
        IF (NOT TmpWorkOrderChangeLogGRP.GET(WorkorderLastExportedOn, WorkOrderChangeLogGRP."Work Order No.")) THEN BEGIN
          TmpWorkOrderChangeLogGRP.INIT;
          TmpWorkOrderChangeLogGRP."Modified On" := WorkorderLastExportedOn;
          TmpWorkOrderChangeLogGRP."Work Order No." := WorkOrderChangeLogGRP."Work Order No.";
          TmpWorkOrderChangeLogGRP.INSERT;
          DeleteInGRP := TRUE;
          WorkOrderChangeLogGRP2.SETRANGE("Work Order No.", WorkOrderChangeLogGRP."Work Order No.");
          IF WorkOrderChangeLogGRP2.FINDLAST THEN BEGIN
            IF (WorkOrder.GET(WorkOrderChangeLogGRP."Work Order No.")) THEN BEGIN
              IF ((WorkOrder."Starting Date/Time" < PlanHorizonEndDateTime) AND (WorkOrder."Starting Date/Time" <> 0DT)) AND
                 ((WorkOrder."Ending Date/Time" >= PlanHorizonStartDateTime) OR (WorkOrder."Ending Date/Time" = 0DT))
              THEN BEGIN
                IF WorkOrder."Resource No." <> '' THEN BEGIN
                  Resource.SETRANGE("No.", WorkOrder."Resource No.");
                  IF NOT Resource.ISEMPTY THEN
                    DeleteInGRP := FALSE;
                END ELSE BEGIN
                  IF WorkOrder."Resource Group No." <> '' THEN BEGIN
                    IF WorkOrder."Resource Type" = WorkOrder."Resource Type"::Plant THEN
                      ResourceGroup.SETRANGE(Company)
                    ELSE
                      ResourceGroup.SETRANGE(Company, COMPANYNAME);
                    ResourceGroup.SETRANGE("No.", WorkOrder."Resource Group No.");
                    IF NOT ResourceGroup.ISEMPTY THEN
                      DeleteInGRP := FALSE;
                  END;
                END;
              END;
            END;
          END;
          IF (DeleteInGRP) THEN
            ExportWorkorderDelete(SchedulerEventsDelete, WorkOrderChangeLogGRP."Work Order No.")
          ELSE
            ExportWorkorderData(SchedulerEvents, WorkOrder);
        END;
      UNTIL (WorkOrderChangeLogGRP.NEXT = 0);
    END;

    LOCAL PROCEDURE ExportWorkorderData@1100529024(VAR SchedulerEvents@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";WorkOrder@1100529001 : Record 11229279);
    VAR
      ResourceRequest@1100529004 : Record 11124901;
      ResourceRequestSubtype@1100529100 : Record 11124909;
      ServiceOrder@1100529005 : Record 11012823;
      Project@1100529006 : Record 11072003;
      Customer@1100529104 : Record 18;
      ServiceContract@1100529105 : Record 11012812;
      DimensionValue@1100529110 : Record 349;
      GeneralLedgerSetup@1100529109 : Record 98;
      ServicePriority@1100529111 : Record 11012829;
      ServiceOrderIndication@1100529112 : Record 11012837;
      ReferencePoint@1100529113 : Record 11020271;
      EventType@1100529115 : Record 11124911;
      CommentLine@1100529116 : Record 97;
      AdditionalInfoRequestWO@1100529117 : Record 11124915;
      SchedulerEvent@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
      DurationDateTime@1100529103 : Duration;
      EventResource@1100528300 : Code[40];
      Planned@1100529102 : Boolean;
      Fixed@1100529106 : Boolean;
      CompanyChanged@1100529114 : Boolean;
      EventTypeCode@1100529107 : Code[10];
      SourceType@1100529170 : 'Project,ServiceOrder,Customer,Request';
      SchedulerRelationship@1100527700 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.Relationship";
    BEGIN
      IF WorkOrder."Source Company" <> COMPANYNAME THEN BEGIN
        CompanyChanged := TRUE;
        ServiceOrder.CHANGECOMPANY(WorkOrder."Source Company");
        Project.CHANGECOMPANY(WorkOrder."Source Company");
        ResourceRequest.CHANGECOMPANY(WorkOrder."Source Company");
        ResourceRequestSubtype.CHANGECOMPANY(WorkOrder."Source Company");
        Customer.CHANGECOMPANY(WorkOrder."Source Company");
        ServiceContract.CHANGECOMPANY(WorkOrder."Source Company");
        DimensionValue.CHANGECOMPANY(WorkOrder."Source Company");
        GeneralLedgerSetup.CHANGECOMPANY(WorkOrder."Source Company");
        ServicePriority.CHANGECOMPANY(WorkOrder."Source Company");
        ServiceOrderIndication.CHANGECOMPANY(WorkOrder."Source Company");
        ReferencePoint.CHANGECOMPANY(WorkOrder."Source Company");
        EventType.CHANGECOMPANY(WorkOrder."Source Company");
        AdditionalInfoRequestWO.CHANGECOMPANY(WorkOrder."Source Company");
      END;

      SchedulerEvent := SchedulerEvent.SchedulerEvent();
      SchedulerEvent.Type('DEFAULT');
      SchedulerEvent.ColorType('DEFAULT');
      SchedulerEvent.Identifier(WorkOrder."No.");
      IF (WorkOrder."Resource No." = '') AND (WorkOrder."Resource Group No." <> '') THEN BEGIN
        EventResource := FormatResourceGroup2GRPResourceNo(WorkOrder."Resource Type", WorkOrder."Resource Group No.");
        SchedulerEvent.Resource(EventResource);
        IF ResourcePlanningSetup."Event Type Unplanned (Default)" <> '' THEN
          EventTypeCode := ResourcePlanningSetup."Event Type Unplanned (Default)"; // color unplanned
        Planned := FALSE;
      END ELSE BEGIN
        SchedulerEvent.Resource(WorkOrder."Resource No.");
        IF ResourcePlanningSetup."Event Type Planned (Default)" <> '' THEN
          EventTypeCode := ResourcePlanningSetup."Event Type Planned (Default)"; // color planned
        Planned := TRUE;
      END;
      SchedulerEvent.GroupIdentifier(WorkOrder."Source No.");

      SchedulerRelationship := SchedulerRelationship.StartToStart;
      IF (WorkOrder."Schedule Relation" = WorkOrder."Schedule Relation"::"End-Start") THEN
        SchedulerRelationship := SchedulerRelationship.FinishToStart;
      AddRelation(SchedulerEvent, WorkOrder."Related Work Order No.", '', 'DEFAULT', SchedulerRelationship);

      IF (WorkOrder."Starting Date/Time" <> 0DT) THEN BEGIN
        SchedulerEvent.StartDate(FormatDateTime(WorkOrder."Starting Date/Time"));
        IF (WorkOrder."Ending Date/Time" <> 0DT) THEN
          SchedulerEvent.EndDate(FormatDateTime(WorkOrder."Ending Date/Time"))
        ELSE BEGIN
          DurationDateTime := ROUND(WorkOrder."Duration Time", 0.01) * 3600000;
          SchedulerEvent.EndDate(FormatDateTime(WorkOrder."Starting Date/Time" + DurationDateTime));
        END;
      END;
      Fixed := (CompanyChanged) OR
        (NOT (WorkOrder."Source Type" IN
         [WorkOrder."Source Type"::ServiceOrder,WorkOrder."Source Type"::Project,WorkOrder."Source Type"::Request])) OR
        (WorkOrder."WO Finished (Field Service)") OR
        ((WorkOrder."Source Type" = WorkOrder."Source Type"::Request) AND WorkOrder.Finished);
      IF WorkOrder."Firm Planned" THEN BEGIN
        SchedulerEvent.FixedStartDate(GlobalVariantTrue);
        SchedulerEvent.FixedEndDate(GlobalVariantTrue);
      END;

      AddFeature(SchedulerEvent, 'workorderno', FORMAT(WorkOrder."No."));
      AddFeature(SchedulerEvent, 'workorderdescription', FORMAT(WorkOrder.Description));
      AddFeature(SchedulerEvent, 'sourcetype', EventSourceType2Text(WorkOrder."Source Type"));
      AddFeature(SchedulerEvent, 'referencepoint', FORMAT(WorkOrder."Actual Reference Point"));
      AddFeature(SchedulerEvent, 'fsreason', FORMAT(WorkOrder."Fld Srv Status Reason Desc."));
      IF EnableReferencePointDescriptionLabel THEN BEGIN
        IF CompanyChanged THEN BEGIN
          WorkOrder.CALCFIELDS("Actual Reference Point Desc.");
          AddFeature(SchedulerEvent, 'referencepointdescription', FORMAT(WorkOrder."Actual Reference Point Desc."));
        END ELSE BEGIN
          IF TempReferencePoint.GET(WorkOrder."Actual Reference Point") THEN BEGIN
            AddFeature(SchedulerEvent, 'referencepointdescription', FORMAT(TempReferencePoint.Description));
          END;
        END;
      END;
      AddFeature(SchedulerEvent, 'assignedto', FORMAT(WorkOrder."Assigned to" + ' ' + WorkOrder."Name Assigned to"));
      AddFeature(SchedulerEvent, 'durationtime', FORMAT(ROUND(WorkOrder."Duration Time", 0.01, '=')));

      IF EnableDimension1EventLabel THEN BEGIN
        IF WorkOrder."Global Dimension 1 Code" <> '' THEN BEGIN
          GeneralLedgerSetup.GET;
          IF CompanyChanged THEN BEGIN
            IF DimensionValue.GET(GeneralLedgerSetup."Global Dimension 1 Code", WorkOrder."Global Dimension 1 Code") THEN BEGIN
              AddFeature(SchedulerEvent, 'dimension1event', FORMAT(WorkOrder."Global Dimension 1 Code" + ' ' + DimensionValue.Name));
            END;
          END ELSE BEGIN
            IF TempDimensionValue.GET(GeneralLedgerSetup."Global Dimension 1 Code", WorkOrder."Global Dimension 1 Code") THEN BEGIN
              AddFeature(SchedulerEvent, 'dimension1event', FORMAT(WorkOrder."Global Dimension 1 Code" + ' ' + TempDimensionValue.Name));
            END;
          END;
        END;
      END;

      IF EnableCommentsLabel THEN BEGIN
        CommentLine.SETRANGE("Table Name", CommentLine."Table Name"::Workorder);
        CommentLine.SETRANGE("No.", WorkOrder."No.");
        IF CommentLine.FINDFIRST THEN
          AddFeature(SchedulerEvent, 'comments', FORMAT(CommentLine.Comment));
      END;

      CASE WorkOrder."Source Type" OF
        WorkOrder."Source Type"::ServiceOrder:
          BEGIN
            ServiceOrder.SETAUTOCALCFIELDS("Customer Name", "Order Manager Name", "Service Location Description", "Description On Hold");
            IF ServiceOrder.GET(WorkOrder."Source No.") THEN BEGIN
              IF Planned THEN BEGIN
                IF WorkOrder."Resource Type" = WorkOrder."Resource Type"::Plant THEN
                  SchedulerEvent.Type('SERVICE_PLANT')
                ELSE
                  SchedulerEvent.Type('SERVICE_EMPLOYEE');
              END ELSE BEGIN
                SchedulerEvent.Type('UNPLANNED_SERVICEORDER');
              END;
              IF EnableLocationLabel THEN BEGIN
                IF ServiceOrder."Service Location No." <> '' THEN BEGIN
                  AddFeature(SchedulerEvent, 'location', FORMAT(ServiceOrder."Service Location No." + ' ' + ServiceOrder."Service Location Description"));
                END;
              END;
              IF EnablePriorityLabel THEN BEGIN
                IF ServiceOrder.Priority <> '' THEN BEGIN
                  IF CompanyChanged THEN BEGIN
                    IF ServicePriority.GET(ServiceOrder.Priority) THEN BEGIN
                      AddFeature(SchedulerEvent, 'priority', FORMAT(ServiceOrder.Priority + ' ' + ServicePriority.Description));
                      IF ServicePriority."Eventtype in Resource Planning" <> '' THEN
                        EventTypeCode := ServicePriority."Eventtype in Resource Planning"; // color serviceorder priority
                    END;
                  END ELSE BEGIN
                    IF TempServicePriority.GET(ServiceOrder.Priority) THEN BEGIN
                      AddFeature(SchedulerEvent, 'priority', FORMAT(ServiceOrder.Priority + ' ' + TempServicePriority.Description));
                      IF TempServicePriority."Eventtype in Resource Planning" <> '' THEN
                        EventTypeCode := TempServicePriority."Eventtype in Resource Planning"; // color serviceorder priority
                    END;
                  END;
                END;
              END;
              IF EnableServiceOrderKindLabel THEN BEGIN
                IF ServiceOrder."Order Kind" <> '' THEN BEGIN
                  IF CompanyChanged THEN BEGIN
                    IF ServiceOrderIndication.GET(ServiceOrderIndication.Indication::Kind, ServiceOrder."Order Kind") THEN BEGIN
                      AddFeature(SchedulerEvent, 'serviceorderkind', FORMAT(ServiceOrderIndication.Code + ' ' + ServiceOrderIndication.Description));
                    END;
                  END ELSE BEGIN
                    IF TempServiceOrderIndication.GET(TempServiceOrderIndication.Indication::Kind, ServiceOrder."Order Kind") THEN BEGIN
                      AddFeature(SchedulerEvent, 'serviceorderkind', FORMAT(TempServiceOrderIndication.Code + ' ' + TempServiceOrderIndication.Description));
                    END;
                  END;
                END;
              END;
              IF EnableServiceOrderTypeLabel THEN BEGIN
                IF ServiceOrder."Order Type" <> '' THEN BEGIN
                  IF CompanyChanged THEN BEGIN
                    IF ServiceOrderIndication.GET(ServiceOrderIndication.Indication::Type, ServiceOrder."Order Type") THEN BEGIN
                      AddFeature(SchedulerEvent, 'serviceordertype', FORMAT(ServiceOrderIndication.Code + ' ' + ServiceOrderIndication.Description));
                    END;
                  END ELSE BEGIN
                    IF TempServiceOrderIndication.GET(TempServiceOrderIndication.Indication::Type, ServiceOrder."Order Type") THEN BEGIN
                      AddFeature(SchedulerEvent, 'serviceordertype', FORMAT(TempServiceOrderIndication.Code + ' ' + TempServiceOrderIndication.Description));
                    END;
                  END;
                END;
              END;
              IF EnableContractManagerLabel THEN BEGIN
                IF ServiceOrder."Service Contract No." <> '' THEN BEGIN
                  ServiceContract.SETAUTOCALCFIELDS("Contract Manager Name");
                  IF ServiceContract.GET(ServiceOrder."Service Contract No.") THEN BEGIN
                    AddFeature(SchedulerEvent, 'contractmanager', FORMAT(ServiceContract."Contract Manager" + ' ' + ServiceContract."Contract Manager Name"));
                  END;
                END;
              END;
              AddFeature(SchedulerEvent, 'type', EventType2Text(DATABASE::"Service Order"));
              AddFeature(SchedulerEvent, 'typetext', EventType2Text(DATABASE::"Service Order"));
              AddFeature(SchedulerEvent, 'typeno', FORMAT(ServiceOrder."No."));
              AddFeature(SchedulerEvent, 'typedescription', FORMAT(ServiceOrder.Description));
              AddFeature(SchedulerEvent, 'source', FORMAT(Customer.TABLECAPTION));
              AddFeature(SchedulerEvent, 'sourceno', FORMAT(ServiceOrder."Customer No."));
              AddFeature(SchedulerEvent, 'sourcedescription', FORMAT(ServiceOrder."Customer Name"));
              AddFeature(SchedulerEvent, 'address', FORMAT(ServiceOrder.Address));
              AddFeature(SchedulerEvent, 'postcode', FORMAT(ServiceOrder."Post Code"));
              AddFeature(SchedulerEvent, 'city', FORMAT(ServiceOrder.City));
              AddFeature(SchedulerEvent, 'ordermanager', FORMAT(ServiceOrder."Order Manager" + ' ' + ServiceOrder."Order Manager Name"));
              AddFeature(SchedulerEvent, 'onhold', FORMAT(ServiceOrder."On Hold" + ' ' + ServiceOrder."Description On Hold"));
              AddFeature(SchedulerEvent, 'territory', FORMAT(ServiceOrder."Territory Code"));
              IF EnableInspectionNoLabel THEN BEGIN
                IF ServiceOrder."Plant Type" <> '' THEN BEGIN
                  IF ServiceOrder."Plant Number" <> '' THEN BEGIN
                    ServiceOrder.CALCFIELDS("Plant Inspection No.");
                    ServiceOrder.CALCFIELDS("Plant Number Description");
                    AddFeature(SchedulerEvent, 'plantinspectionno', FORMAT(ServiceOrder."Plant Inspection No." + ' ' + ServiceOrder."Plant Number Description"));
                  END;
                END;
              END;
              IF EnableServiceOrderMasterProjectNumberLabel THEN BEGIN
                ServiceOrder.CALCFIELDS("Master Project");
                IF ServiceOrder."Master Project" <> '' THEN BEGIN
                  AddFeature(SchedulerEvent, 'serviceordermasterprojectnumber', FORMAT(ServiceOrder."Master Project"));
                  IF EnableServiceOrderMasterProjectDescriptionLabel THEN
                    IF Project.GET(ServiceOrder."Master Project") THEN
                      AddFeature(SchedulerEvent, 'serviceordermasterprojectdescription', FORMAT(Project.Description));
                END;
              END;
              ExportSourceData(SchedulerEvents, SourceType::ServiceOrder, WorkOrder."Source No.", WorkOrder."Source Company");
            END;
          END;

        WorkOrder."Source Type"::Project:
          BEGIN
            Project.SETAUTOCALCFIELDS("Principal Name", "Name Project Manager");
            IF Project.GET(WorkOrder."Source No.") THEN BEGIN
              IF Planned THEN BEGIN
                IF WorkOrder."Resource Type" = WorkOrder."Resource Type"::Plant THEN
                  SchedulerEvent.Type('PROJECT_PLANT')
                ELSE
                  SchedulerEvent.Type('PROJECT_EMPLOYEE');
              END ELSE BEGIN
                SchedulerEvent.Type('UNPLANNED_PROJECT');
              END;
              AddFeature(SchedulerEvent, 'type', EventType2Text(DATABASE::Job));
              AddFeature(SchedulerEvent, 'typetext', EventType2Text(DATABASE::Job));
              AddFeature(SchedulerEvent, 'typeno', FORMAT(Project."No."));
              AddFeature(SchedulerEvent, 'typedescription', FORMAT(Project.Description));
              AddFeature(SchedulerEvent, 'source', FORMAT(Project.FIELDCAPTION("Bill-to Customer No.")));
              AddFeature(SchedulerEvent, 'sourceno', FORMAT(Project."Bill-to Customer No."));
              AddFeature(SchedulerEvent, 'sourcedescription', FORMAT(Project."Principal Name"));
              AddFeature(SchedulerEvent, 'address', FORMAT(Project.Address));
              AddFeature(SchedulerEvent, 'postcode', FORMAT(Project."Post Code"));
              AddFeature(SchedulerEvent, 'city', FORMAT(Project.City));
              AddFeature(SchedulerEvent, 'projectmanager', FORMAT(Project."Project Manager" + ' ' + Project."Name Project Manager"));
              AddFeature(SchedulerEvent, 'territory', FORMAT(Project."Territory Code"));
              ExportSourceData(SchedulerEvents, SourceType::Project, WorkOrder."Source No.", WorkOrder."Source Company");
            END;
          END;

        WorkOrder."Source Type"::Request:
          BEGIN
            IF ResourceRequest.GET(WorkOrder."Source No.") THEN BEGIN
              IF AdditionalInfoRequestWO.GET(WorkOrder."No.") THEN ;
              IF Planned THEN BEGIN
                IF WorkOrder."Resource Type" = WorkOrder."Resource Type"::Plant THEN
                  SchedulerEvent.Type('RESOURCEREQUEST_PLANT')
                ELSE
                  SchedulerEvent.Type('RESOURCEREQUEST_EMPLOYEE');
              END ELSE BEGIN
                SchedulerEvent.Type('UNPLANNED_RESOURCEREQUEST');
              END;
              AddFeature(SchedulerEvent, 'type', EventType2Text(DATABASE::"Resource Request"));
              AddFeature(SchedulerEvent, 'typetext', FORMAT(Text035));
              AddFeature(SchedulerEvent, 'typeno', FORMAT(ResourceRequest."No."));
              AddFeature(SchedulerEvent, 'typedescription', FORMAT(ResourceRequest.Description));
              AddFeature(SchedulerEvent, 'requesttype', FORMAT(ResourceRequest.Type));
              AddFeature(SchedulerEvent, 'source', FORMAT(ResourceRequest."Source Type"));
              AddFeature(SchedulerEvent, 'sourceno', FORMAT(ResourceRequest."Source No."));
              AddFeature(SchedulerEvent, 'sourcedescription', FORMAT(ResourceRequest.GetSourceDescription(FALSE)));
              AddFeature(SchedulerEvent, 'requestsourcetype', FORMAT(ResourceRequest."Source Type"));
              IF ResourceRequestSubtype.GET(ResourceRequest."Sub Type") THEN BEGIN
                AddFeature(SchedulerEvent, 'requestsubtype', FORMAT(ResourceRequestSubtype.Code + ' ' + ResourceRequestSubtype.Description));
                IF ResourceRequestSubtype."Eventtype in Resource Planning" <> '' THEN BEGIN
                  EventTypeCode := ResourceRequestSubtype."Eventtype in Resource Planning"; // color request subtype
                END;
              END;
              IF AdditionalInfoRequestWO.Address <> '' THEN BEGIN
                AddFeature(SchedulerEvent, 'address', FORMAT(AdditionalInfoRequestWO.Address));
                AddFeature(SchedulerEvent, 'postcode', FORMAT(AdditionalInfoRequestWO."Post Code"));
                AddFeature(SchedulerEvent, 'city', FORMAT(AdditionalInfoRequestWO.City));
              END ELSE BEGIN
                AddFeature(SchedulerEvent, 'address', FORMAT(ResourceRequest.Address));
                AddFeature(SchedulerEvent, 'postcode', FORMAT(ResourceRequest."Post Code"));
                AddFeature(SchedulerEvent, 'city', FORMAT(ResourceRequest.City));
              END;
              AddFeature(SchedulerEvent, 'territory', FORMAT(ResourceRequest.Territory));
              ExportSourceData(SchedulerEvents, SourceType::Request, WorkOrder."Source No.", WorkOrder."Source Company");
            END;
          END;

      END;

      IF (Planned) AND (WorkOrder."Actual Reference Point" > 0) THEN BEGIN
        IF CompanyChanged THEN BEGIN
          IF ReferencePoint.GET(WorkOrder."Actual Reference Point") THEN
            IF ReferencePoint."Eventtype in Resource Planning" <> '' THEN
              EventTypeCode := ReferencePoint."Eventtype in Resource Planning"; // color reference point
        END ELSE BEGIN
          IF TempReferencePoint.GET(WorkOrder."Actual Reference Point") THEN
            IF TempReferencePoint."Eventtype in Resource Planning" <> '' THEN
              EventTypeCode := TempReferencePoint."Eventtype in Resource Planning"; // color reference point
        END;
      END;
      IF WorkOrder."Eventtype in Resource Planning" <> '' THEN
        EventTypeCode := WorkOrder."Eventtype in Resource Planning"; // color workorder

      SchedulerEvent.ColorType(EventTypeCode);
      AddFeature(SchedulerEvent, 'eventtype', FORMAT(TempEventType.GetDescription(EventTypeCode)));

      IF (Planned) AND (WorkOrder."Actual Reference Point" > 0) THEN BEGIN
        IF NOT Fixed THEN BEGIN
          IF CompanyChanged THEN
            Fixed := ReferencePoint."Block Modify Service Order"
          ELSE
            Fixed := TempReferencePoint."Block Modify Service Order";
        END;
      END;

      IF NOT Fixed THEN
        Fixed := TempEventType.GetFixed(EventTypeCode);
      IF Fixed THEN BEGIN
        IF WorkOrder."Source Type" = WorkOrder."Source Type"::ServiceOrder THEN
          SchedulerEvent.Type('FIXED_SERVICEORDER');
        IF WorkOrder."Source Type" = WorkOrder."Source Type"::Project THEN
          SchedulerEvent.Type('FIXED_PROJECT');
        IF WorkOrder."Source Type" = WorkOrder."Source Type"::Request THEN
          SchedulerEvent.Type('FIXED_RESOURCEREQUEST');
        IF ResourcePlanningSetup."Event Type Finished (Default)" <> '' THEN
          EventTypeCode := ResourcePlanningSetup."Event Type Finished (Default)";
      END;

      IF (SchedulerEvent.Type IN ['SERVICE_PLANT','SERVICE_EMPLOYEE','PROJECT_PLANT','PROJECT_EMPLOYEE',
                                  'FIXED_SERVICEORDER','FIXED_PROJECT','FIXED_RESOURCEREQUEST']) THEN
        AddCreateWorkorderEventCommand(SchedulerEvent, WorkOrder);

      ExportEventText(SchedulerEvent);
      SchedulerEvents.AddEvent(SchedulerEvent);

      IF NOT TmpWorkOrderExported.GET(0DT, WorkOrder."No.") THEN BEGIN
        TmpWorkOrderExported."Modified On" := 0DT;
        TmpWorkOrderExported."Work Order No." := WorkOrder."No.";
        TmpWorkOrderExported.INSERT;
      END;
    END;

    LOCAL PROCEDURE ExportSourceData@1100529172(VAR SchedulerEvents@1100529170 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";SourceType@1100529172 : 'Project,ServiceOrder,Customer,Request';SourceNo@1100529173 : Code[20];SourceCompany@1100529174 : Text[30]);
    VAR
      SchedulerEvent@1100529171 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
      Job@1100529175 : Record 11072003;
      ResourceRequest@1100529176 : Record 11124901;
      Customer@1100529177 : Record 18;
      ServiceOrder@1100529178 : Record 11012823;
    BEGIN
      IF SourceNo = '' THEN
        EXIT;

      IF SourceCompany <> '' THEN BEGIN
        Job.CHANGECOMPANY(SourceCompany);
        ServiceOrder.CHANGECOMPANY(SourceCompany);
        ResourceRequest.CHANGECOMPANY(SourceCompany);
        Customer.CHANGECOMPANY(SourceCompany);
      END;

      CASE SourceType OF
        SourceType::ServiceOrder:
          BEGIN
            ServiceOrder.GET(SourceNo);
            SchedulerEvent := SchedulerEvent.SchedulerEvent();
            SchedulerEvent.Identifier(ServiceOrder."No.");
            SchedulerEvent.Text(ServiceOrder."No." + ' ' + ServiceOrder.Description);
            IF ServiceOrder."Customer No." <> '' THEN
              SchedulerEvent.GroupIdentifier(ServiceOrder."Customer No.");
            SchedulerEvents.AddEvent(SchedulerEvent);
            IF ServiceOrder."Customer No." <> '' THEN
              ExportSourceData(SchedulerEvents, SourceType::Customer, ServiceOrder."Customer No.", SourceCompany);
          END;
        SourceType::Project:
          BEGIN
            Job.GET(SourceNo);
            SchedulerEvent := SchedulerEvent.SchedulerEvent();
            SchedulerEvent.Identifier(Job."No.");
            SchedulerEvent.Text(Job."No." + ' ' + Job.Description);
            IF Job."Bill-to Customer No." <> '' THEN
              SchedulerEvent.GroupIdentifier(Job."Bill-to Customer No.");
            SchedulerEvents.AddEvent(SchedulerEvent);
            IF Job."Bill-to Customer No." <> '' THEN
              ExportSourceData(SchedulerEvents, SourceType::Customer, Job."Bill-to Customer No.", SourceCompany);
          END;
        SourceType::Request:
          BEGIN
            ResourceRequest.GET(SourceNo);
            SchedulerEvent := SchedulerEvent.SchedulerEvent;
            SchedulerEvent.Identifier(ResourceRequest."No.");
            SchedulerEvent.Text(ResourceRequest."No." + ' ' + ResourceRequest.Description);
            IF ResourceRequest."Source No." <> '' THEN
              SchedulerEvent.GroupIdentifier(ResourceRequest."Source No.");
            SchedulerEvents.AddEvent(SchedulerEvent);
            IF ResourceRequest."Source No." <> '' THEN BEGIN
              ExportSourceData(SchedulerEvents, ResourceRequest."Source Type", ResourceRequest."Source No.", SourceCompany);
            END;
          END;
        SourceType::Customer:
          BEGIN
            Customer.GET(SourceNo);
            SchedulerEvent := SchedulerEvent.SchedulerEvent;
            SchedulerEvent.Identifier(Customer."No.");
            SchedulerEvent.Text(Customer."No." + ' ' + Customer.Name);
            SchedulerEvents.AddEvent(SchedulerEvent);
          END;
      END;
    END;

    LOCAL PROCEDURE AddRelation@1100525037(VAR SchedulerEvent@1100529172 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";Source@1100529170 : Text;Target@1100529171 : Text;Type@1100525000 : Text;RelationShip@1100525001 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.Relationship");
    VAR
      SchedulerRelation@1100525002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerRelation";
    BEGIN
      SchedulerRelation := SchedulerRelation.SchedulerRelation();
      IF Source <> '' THEN
        SchedulerRelation.Source(Source);
      IF Target <> '' THEN
        SchedulerRelation.Target(Target);
      SchedulerRelation.Type(Type);
      SchedulerRelation.Relationship(RelationShip);
      SchedulerEvent.AddRelation(SchedulerRelation);
    END;

    LOCAL PROCEDURE AddFeature@1100529170(VAR SchedulerEvent@1100529172 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";FeatureName@1100529170 : Text;FeatureValue@1100529171 : Text);
    BEGIN
      IF (FeatureValue = '') OR (FeatureValue = ' ') OR (FeatureName = '') THEN
        EXIT;

      IF CheckFeature(FeatureName) THEN BEGIN
        SchedulerEvent.AddFeature(FeatureName, FeatureValue);
      END;
    END;

    LOCAL PROCEDURE CheckFeature@1100529176(FeatureName@1100529170 : Text) : Boolean;
    BEGIN
      CASE FeatureName OF
        'workorderno':
          IF EnableWorkorderNoLabel THEN
            EXIT(TRUE);
        'workorderdescription':
          IF EnableWorkorderDescriptionLabel THEN
            EXIT(TRUE);
        'sourcetype':
          EXIT(TRUE);
        'referencepoint':
          IF EnableReferencePointLabel THEN
            EXIT(TRUE);
        'referencepointdescription':
          IF EnableReferencePointDescriptionLabel THEN
            EXIT(TRUE);
        'assignedto':
          IF EnableAssignedToLabel THEN
            EXIT(TRUE);
        'durationtime':
          IF EnableDurationTimeLabel THEN
            EXIT(TRUE);
        'dimension1event':
          IF EnableDimension1EventLabel THEN
            EXIT(TRUE);
        'comments':
          IF EnableCommentsLabel THEN
            EXIT(TRUE);
        'fsreason':
          IF EnableFieldServiceReasonLabel THEN
            EXIT(TRUE);
        'priority':
          IF EnablePriorityLabel THEN
            EXIT(TRUE);
        'serviceorderkind':
          IF EnableServiceOrderKindLabel THEN
            EXIT(TRUE);
        'serviceordertype':
          IF EnableServiceOrderTypeLabel THEN
            EXIT(TRUE);
        'location':
          IF EnableLocationLabel THEN
            EXIT(TRUE);
        'contractmanager':
          IF EnableContractManagerLabel THEN
            EXIT(TRUE);
        'type':
          EXIT(TRUE);
        'typetext':
          IF EnableTypeTextLabel THEN
            EXIT(TRUE);
        'typeno':
          IF EnableTypeNoLabel THEN
            EXIT(TRUE);
        'typedescription':
          IF EnableTypeDescriptionLabel THEN
            EXIT(TRUE);
        'source':
          IF EnableSourceLabel THEN
            EXIT(TRUE);
        'sourceno':
          IF EnableSourceNoLabel THEN
            EXIT(TRUE);
        'sourcedescription':
          IF EnableSourceDescriptionLabel THEN
            EXIT(TRUE);
        'address':
          IF EnableAddressLabel THEN
            EXIT(TRUE);
        'postcode':
          IF EnablePostCodeLabel THEN
            EXIT(TRUE);
        'city':
          IF EnableCityLabel THEN
            EXIT(TRUE);
        'ordermanager':
          IF EnableOrderManagerLabel THEN
            EXIT(TRUE);
        'onhold':
          IF EnableOnHoldLabel THEN
            EXIT(TRUE);
        'territory':
          IF EnableTerritoryLabel THEN
            EXIT(TRUE);
        'plantinspectionno':
          IF EnableInspectionNoLabel THEN
            EXIT(TRUE);
        'serviceordermasterprojectnumber':
          IF EnableServiceOrderMasterProjectNumberLabel THEN
            EXIT(TRUE);
        'serviceordermasterprojectdescription':
          IF EnableServiceOrderMasterProjectDescriptionLabel THEN
            EXIT(TRUE);
        'projectmanager':
          IF EnableProjectManagerLabel THEN
            EXIT(TRUE);
        'requesttype':
          IF EnableRequestTypeLabel THEN
            EXIT(TRUE);
        'requestsourcetype':
          IF EnableRequestSourceTypeLabel THEN
            EXIT(TRUE);
        'requestsubtype':
          IF EnableRequestSubTypeLabel THEN
            EXIT(TRUE);
        'eventtype':
          IF EnableEventTypeLabel THEN
            EXIT(TRUE);
        'eventfilter':
          IF EnableEventFilterLabel THEN
            EXIT(TRUE);
        ELSE
          EXIT(FALSE);
      END;
      EXIT(FALSE);
    END;

    LOCAL PROCEDURE ExportEventText@1100529102(VAR SchedulerEvent@1100529100 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent");
    VAR
      EventText@1100529101 : Text;
    BEGIN
      ExportEventTextLine(SchedulerEvent, ResourcePlanningUserSetup."Event Text Line 1", EventText);
      ExportEventTextLine(SchedulerEvent, ResourcePlanningUserSetup."Event Text Line 2", EventText);
      SchedulerEvent.Text(EventText);
    END;

    LOCAL PROCEDURE ExportEventTextLine@1100529103(VAR SchedulerEvent@1100529100 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";TextLineOption@1100529101 : Option;VAR EventText@1100529102 : Text);
    BEGIN
      IF EventText <> '' THEN
        EventText += '<br>';
      CASE TextLineOption OF
        ResourcePlanningUserSetup."Event Text Line 1"::Address:
          BEGIN
            EnableAddressLabel := TRUE;
            EnablePostCodeLabel := TRUE;
            EnableCityLabel := TRUE;
            EventText += SchedulerEvent.GetFeature('address') + ' ' + SchedulerEvent.GetFeature('postcode') + ' ' + SchedulerEvent.GetFeature('city');
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::Customer:
          BEGIN
            EnableSourceNoLabel := TRUE;
            EnableSourceDescriptionLabel := TRUE;
            IF SchedulerEvent.HasFeature('sourceno') THEN BEGIN
              EventText += SchedulerEvent.GetFeature('sourceno');
              IF SchedulerEvent.HasFeature('sourcedescription') THEN BEGIN
                EventText += ', ' + SchedulerEvent.GetFeature('sourcedescription');
              END;
            END;
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::EventType:
          BEGIN
            EnableEventTypeLabel := TRUE;
            EventText += SchedulerEvent.GetFeature('eventtype');
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::ReferencePoint:
          BEGIN
            EnableReferencePointLabel := TRUE;
            EnableReferencePointDescriptionLabel := TRUE;
            IF SchedulerEvent.HasFeature('referencepoint') THEN BEGIN
              EventText += SchedulerEvent.GetFeature('referencepoint');
              IF SchedulerEvent.HasFeature('referencepointdescription') THEN BEGIN
                EventText += ', ' + SchedulerEvent.GetFeature('referencepointdescription');
              END;
            END;
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::Source:
          BEGIN
            EnableTypeNoLabel := TRUE;
            EnableTypeDescriptionLabel := TRUE;
            IF SchedulerEvent.HasFeature('typeno') THEN BEGIN
              EventText += SchedulerEvent.GetFeature('typeno');
              IF SchedulerEvent.HasFeature('typedescription') THEN BEGIN
                EventText += ', ' + SchedulerEvent.GetFeature('typedescription');
              END;
            END;
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::WorkOrder:
          BEGIN
            EnableWorkorderNoLabel := TRUE;
            EnableWorkorderDescriptionLabel := TRUE;
            IF SchedulerEvent.HasFeature('workorderno') THEN BEGIN
              EventText += SchedulerEvent.GetFeature('workorderno');
              IF SchedulerEvent.HasFeature('workorderdescription') THEN BEGIN
                EventText += ', ' + SchedulerEvent.GetFeature('workorderdescription');
              END;
            END;
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::Priority:
          BEGIN
            EnablePriorityLabel := TRUE;
            EventText += SchedulerEvent.GetFeature('priority');
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::OrderType:
          BEGIN
            EnableServiceOrderTypeLabel := TRUE;
            EventText += SchedulerEvent.GetFeature('serviceordertype');
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::OrderKind:
          BEGIN
            EnableServiceOrderKindLabel := TRUE;
            EventText += SchedulerEvent.GetFeature('serviceorderkind');
          END;
        ResourcePlanningUserSetup."Event Text Line 1"::"Location(SO)":
          BEGIN
            EnableLocationLabel := TRUE;
            EventText += SchedulerEvent.GetFeature('location');
          END;
      END;
    END;

    LOCAL PROCEDURE ExportWorkorderDelete@1100529038(VAR SchedulerEventsDelete@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";WorkOrderNo@1100529001 : Code[20]);
    VAR
      SchedulerEvent@1100529002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
    BEGIN
      IF TmpWorkOrderExported.GET(0DT, WorkOrderNo) THEN BEGIN
        TmpWorkOrderExported.DELETE;
        SchedulerEvent := SchedulerEvent.SchedulerEvent();
        SchedulerEvent.Identifier(WorkOrderNo);
        SchedulerEventsDelete.AddEvent(SchedulerEvent);
      END;
    END;

    [External]
    PROCEDURE ExportAllEmployeeAbsence@1100529002(VAR SchedulerEvents@1100529003 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";PlanHorizonStartDate@1100529007 : Date;PlanHorizonEndDate@1100529006 : Date);
    VAR
      EmployeeAbsence@1100529000 : Record 5207;
      Resource@1100529004 : Record 11229278;
      SchedulerEvent@1100529005 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
    BEGIN
      ResourcePlanningSetup.GET;
      SetKeyAndFiltersResources(Resource, Resource.Type::Employee, 'SOURCENO');
      IF Resource.FINDSET THEN BEGIN
        SchedulerEvent := SchedulerEvent.SchedulerEvent();
        SchedulerEvent.Identifier('01');
        SchedulerEvent.Text(Text033);
        SchedulerEvents.AddEvent(SchedulerEvent);
        REPEAT
          EmployeeAbsence.RESET;
          EmployeeAbsence.CHANGECOMPANY(Resource.Company);
          EmployeeAbsence.SETCURRENTKEY("Employee No.","From Date");
          EmployeeAbsence.SETRANGE("Employee No.", Resource."Source No.");
          EmployeeAbsence.SETRANGE("From Date", 0D, PlanHorizonEndDate);
          EmployeeAbsence.SETFILTER("To Date", '>=%1|%2', PlanHorizonStartDate, 0D);
          IF EmployeeAbsence.FINDSET THEN BEGIN
            REPEAT
              IF (EmployeeAbsence."From Date" <> 0D) OR (EmployeeAbsence."To Date" <> 0D) THEN BEGIN
                SchedulerEvent := SchedulerEvent.SchedulerEvent;
                ExportEmployeeAbsence(SchedulerEvent, EmployeeAbsence."Entry No.", Resource.Company);
                SchedulerEvents.AddEvent(SchedulerEvent);
              END;
            UNTIL EmployeeAbsence.NEXT = 0;
          END;
        UNTIL Resource.NEXT = 0;
      END;
    END;

    [External]
    PROCEDURE ExportAllPlantAbsence@1100529112(VAR SchedulerEvents@1100529003 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";PlanHorizonStartDate@1100529007 : Date;PlanHorizonEndDate@1100529006 : Date);
    VAR
      PlantAbsence@1100529000 : Record 11126143;
      Resource@1100529004 : Record 11229278;
      SchedulerEvent@1100529005 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
    BEGIN
      ResourcePlanningSetup.GET;
      SetKeyAndFiltersResources(Resource, Resource.Type::Plant, 'SOURCENO');
      IF Resource.FINDSET THEN BEGIN
        SchedulerEvent := SchedulerEvent.SchedulerEvent();
        SchedulerEvent.Identifier('02');
        SchedulerEvent.Text(Text032);
        SchedulerEvents.AddEvent(SchedulerEvent);
        REPEAT
          PlantAbsence.RESET;
          PlantAbsence.CHANGECOMPANY(Resource.Company);
          PlantAbsence.SETCURRENTKEY("Plant Type","Plant No.","From Date");
          PlantAbsence.SETRANGE("Plant Type", Resource."Source No.");
          PlantAbsence.SETRANGE("Plant No.", Resource."Source No. 2");
          PlantAbsence.SETRANGE("From Date", 0D, PlanHorizonEndDate);
          PlantAbsence.SETFILTER("To Date", '>=%1|%2', PlanHorizonStartDate, 0D);
          IF PlantAbsence.FINDSET THEN BEGIN
            REPEAT
              IF (PlantAbsence."From Date" <> 0D) OR (PlantAbsence."To Date" <> 0D) THEN BEGIN
                SchedulerEvent := SchedulerEvent.SchedulerEvent();
                ExportPlantAbsence(SchedulerEvent, PlantAbsence."Entry No.", Resource.Company);
                SchedulerEvents.AddEvent(SchedulerEvent);
              END;
            UNTIL PlantAbsence.NEXT = 0;
          END;
        UNTIL Resource.NEXT = 0;
       END;
    END;

    LOCAL PROCEDURE MakeDateTimeAbsence@1100529015(Date@1100529000 : Date;Times@1100529001 : Time;ToMode@1100529002 : Boolean) : DateTime;
    BEGIN
      IF Date = 0D THEN
        Times := 0T;
      IF NOT ToMode THEN BEGIN
        IF Date = 0D THEN
          Date := DMY2DATE(1, 1, 2000);
      END ELSE BEGIN
        IF Date = 0D THEN
          Date := DMY2DATE(31, 12, 2099);
        IF Times = 0T THEN
          Times := VARIANT2TIME((CREATEDATETIME(Date+1, 0T) - 60));
      END;
      EXIT(CREATEDATETIME(Date, Times));
    END;

    LOCAL PROCEDURE AddSource@1100529021(SourceType@1100529003 : Option) : Code[20];
    VAR
      ResourceRequest@1100529000 : Record 11124901;
      ServiceOrder@1100529001 : Record 11012823;
      WorkOrder@1100529002 : Record 11229279;
    BEGIN
      CASE SourceType OF
        WorkOrder."Source Type"::ServiceOrder:
          BEGIN
            ServiceOrder.INIT;
            ServiceOrder."No." := '';
            ServiceOrder.INSERT(TRUE);
            ServiceOrder.TESTFIELD("No.");
            EXIT(ServiceOrder."No.");
          END;
        WorkOrder."Source Type"::Project:
          EXIT('');  //Do not create a project, on this moment only add WO's to an existing Project allowed (see selections in P11126905)
        WorkOrder."Source Type"::Request:
          BEGIN
            ResourceRequest.INIT;
            ResourceRequest."No." := '';
            ResourceRequest.INSERT(TRUE);
            ResourceRequest.TESTFIELD("No.");
            EXIT(ResourceRequest."No.");
          END;
      END;
    END;

    LOCAL PROCEDURE AddWorkorder@1100529020(SourceType@1100529009 : Option;SourceNo@1100529005 : Code[20];ResourceNo@1100529000 : Code[20];ResourceGroupType@1100528300 : Option;ResourceGroup@1100528301 : Code[20];StartDateTime@1100529001 : DateTime;EndDateTime@1100529002 : DateTime;Duration@1100529102 : Decimal;RelatedWorkOrderNo@1100529006 : Code[20];OrgWorkorderNo@1100529007 : Code[20];ProjectElement@1100529100 : Code[20];PlanDuringClockTime@1100529171 : Boolean;PlanInWeekend@1100529172 : Boolean;FirmPlanned@1100529173 : Boolean;ShowErrors@1100529175 : Boolean) : Code[20];
    VAR
      WorkOrder@1100529003 : Record 11229279;
      OrgWorkOrder@1100529008 : Record 11229279;
      RelWorkOrder@1100529103 : Record 11229279;
      Resource@1100529004 : Record 11229278;
      ResourceRequest@1100529170 : Record 11124901;
      DurationDateTime@1100529174 : Duration;
    BEGIN
      WorkOrder.INIT;
      WorkOrder.SetSkipAddLinkedResources(TRUE);
      WorkOrder."No." := '';
      WorkOrder."Source Company" := COMPANYNAME;
      WorkOrder.VALIDATE("Source Type", SourceType);
      WorkOrder.VALIDATE("Source No.", SourceNo);
      IF ResourceNo <> '' THEN BEGIN
        Resource.GET(ResourceNo);
        WorkOrder.VALIDATE("Resource Type", Resource.Type);
        WorkOrder.VALIDATE("Resource No.", ResourceNo);
        IF ResourceGroup <> '' THEN
          WorkOrder.VALIDATE("Resource Group No.", ResourceGroup);
      END ELSE BEGIN
        IF ResourceGroup <> '' THEN BEGIN
          CASE ResourceGroupType OF
            ResourceGroupTypeOption::Discipline:
              WorkOrder.VALIDATE("Resource Type", Resource.Type::Employee);
            ResourceGroupTypeOption::PlantType:
              WorkOrder.VALIDATE("Resource Type", Resource.Type::Plant);
          END;
          WorkOrder.VALIDATE("Resource Group No.", ResourceGroup);
        END;
      END;
      IF RelatedWorkOrderNo <> '' THEN BEGIN
        WorkOrder."Schedule Relation" := WorkOrder."Schedule Relation"::"Start-Start";
        WorkOrder."Related Work Order No." := RelatedWorkOrderNo;
        IF RelWorkOrder.GET(RelatedWorkOrderNo) THEN BEGIN
          StartDateTime := RelWorkOrder."Starting Date/Time";
          EndDateTime := RelWorkOrder."Ending Date/Time";
          Duration := RelWorkOrder."Duration Time";
        END;
      END;
      IF OrgWorkorderNo <> '' THEN BEGIN
        IF OrgWorkOrder.GET(OrgWorkorderNo) THEN BEGIN
          WorkOrder.Description := OrgWorkOrder.Description;
          WorkOrder."Eventtype in Resource Planning" := OrgWorkOrder."Eventtype in Resource Planning";
        END;
      END;
      IF ProjectElement <> '' THEN
        WorkOrder.VALIDATE("Project Element", ProjectElement)
      ELSE
        IF WorkOrder."Source Type" = WorkOrder."Source Type"::Request THEN
          IF ResourceRequest.GET(SourceNo) THEN
            WorkOrder.VALIDATE("Project Element", ResourceRequest."Project Element");

      IF RelatedWorkOrderNo = '' THEN BEGIN
        IF OrgWorkorderNo = '' THEN BEGIN
          IF PlanDuringClockTime THEN BEGIN
            DurationDateTime := EndDateTime - StartDateTime;
            Duration := ROUND(DurationDateTime / 3600000, 0.01);
          END ELSE BEGIN
            IF NOT CalculateDurationTime(ResourceNo, StartDateTime, EndDateTime, Duration, PlanInWeekend) THEN BEGIN
              IF ShowErrors THEN
                ERROR(GETLASTERRORTEXT)
              ELSE
                EXIT;
            END;
          END;
        END ELSE BEGIN
          IF PlanDuringClockTime THEN BEGIN
            DurationDateTime := EndDateTime - StartDateTime;
            Duration := ROUND(DurationDateTime / 3600000, 0.01);
          END ELSE BEGIN
            IF NOT CalculateEndDateTime(ResourceNo, StartDateTime, EndDateTime, Duration, PlanInWeekend) THEN BEGIN
              IF ShowErrors THEN
                ERROR(GETLASTERRORTEXT)
              ELSE
                EXIT;
            END;
          END;
        END;
      END;
      WorkOrder."Ending Date/Time" := 0DT;
      WorkOrder.VALIDATE("Starting Date/Time", StartDateTime);
      WorkOrder.VALIDATE("Ending Date/Time", EndDateTime);
      WorkOrder.VALIDATE("Duration Time", Duration);
      WorkOrder."Plan during Clock Time" := PlanDuringClockTime;
      WorkOrder."Plan in Weekend" := PlanInWeekend;
      WorkOrder."Firm Planned" := FirmPlanned;

      WorkOrder.INSERT(TRUE);
      EXIT(WorkOrder."No.");
    END;

    LOCAL PROCEDURE FillDefaultChargeableLinked@1100529043(WorkOrderNo@1100529002 : Code[20];MainResourceNo@1100529001 : Code[20];ResourceNo@1100529003 : Code[20]);
    VAR
      LinkedResource@1100529000 : Record 11229324;
      AdditionalInfoRequestWO@1100529004 : Record 11124915;
    BEGIN
      IF NOT LinkedResource.GET(MainResourceNo, ResourceNo) THEN
        EXIT;
      IF NOT AdditionalInfoRequestWO.GET(WorkOrderNo) THEN
        EXIT;
      IF AdditionalInfoRequestWO.Chargeable <> LinkedResource."Chargeable (default)" THEN BEGIN
        AdditionalInfoRequestWO.Chargeable := LinkedResource."Chargeable (default)";
        AdditionalInfoRequestWO.MODIFY;
      END;
    END;

    LOCAL PROCEDURE CopyAdditionalInfo@1100529044(WorkOrderNo@1100529000 : Code[20];ResourceNo@1100529001 : Code[20];OrgWorkOrderNo@1100529002 : Code[20];OrgResourceNo@1100529003 : Code[20]);
    VAR
      AdditionalInfoRequestWO@1100529004 : Record 11124915;
      OrgAdditionalInfoRequestWO@1100529005 : Record 11124915;
    BEGIN
      IF NOT OrgAdditionalInfoRequestWO.GET(OrgWorkOrderNo) THEN
        EXIT;
      IF NOT AdditionalInfoRequestWO.GET(WorkOrderNo) THEN
        EXIT;
      AdditionalInfoRequestWO.Address := OrgAdditionalInfoRequestWO.Address;
      AdditionalInfoRequestWO."Address 2" := OrgAdditionalInfoRequestWO."Address 2";
      AdditionalInfoRequestWO."Post Code" := OrgAdditionalInfoRequestWO."Post Code";
      AdditionalInfoRequestWO.City := OrgAdditionalInfoRequestWO.City;
      AdditionalInfoRequestWO."Load Address" := OrgAdditionalInfoRequestWO."Load Address";
      AdditionalInfoRequestWO."Load Address 2" := OrgAdditionalInfoRequestWO."Load Address 2";
      AdditionalInfoRequestWO."Load Address Post Code" := OrgAdditionalInfoRequestWO."Load Address Post Code";
      AdditionalInfoRequestWO."Load Address City" := OrgAdditionalInfoRequestWO."Load Address City";
      AdditionalInfoRequestWO."Unload Address" := OrgAdditionalInfoRequestWO."Unload Address";
      AdditionalInfoRequestWO."Unload Address 2" := OrgAdditionalInfoRequestWO."Unload Address 2";
      AdditionalInfoRequestWO."Unload Address Post Code" := OrgAdditionalInfoRequestWO."Unload Address Post Code";
      AdditionalInfoRequestWO."Unload Address City" := OrgAdditionalInfoRequestWO."Unload Address City";
      AdditionalInfoRequestWO.Chargeable := OrgAdditionalInfoRequestWO.Chargeable;
      IF ResourceNo = OrgResourceNo THEN BEGIN
        AdditionalInfoRequestWO."Agreement Type" := OrgAdditionalInfoRequestWO."Agreement Type";
        AdditionalInfoRequestWO."Quantity Agreement" := OrgAdditionalInfoRequestWO."Quantity Agreement";
        AdditionalInfoRequestWO."Fixed Quantity" := OrgAdditionalInfoRequestWO."Fixed Quantity";
        AdditionalInfoRequestWO."Special Rate" := OrgAdditionalInfoRequestWO."Special Rate";
        AdditionalInfoRequestWO."Special Discount %" := OrgAdditionalInfoRequestWO."Special Discount %";
        AdditionalInfoRequestWO."Fixed Amount" := OrgAdditionalInfoRequestWO."Fixed Amount";
      END;
      AdditionalInfoRequestWO.VALIDATE("Calulate Pause", OrgAdditionalInfoRequestWO."Calulate Pause");
      AdditionalInfoRequestWO.MODIFY;
    END;

    LOCAL PROCEDURE UpdateWorkorder@1100529032(WorkOrderNo@1100529005 : Code[20];ResourceNo@1100529000 : Code[20];ResourceGroupType@1100528301 : Option;ResourceGroup@1100528300 : Code[20];StartDateTime@1100529001 : DateTime;EndDateTime@1100529002 : DateTime;IgnoreTypeChange@1100529102 : Boolean);
    VAR
      WorkOrder@1100529003 : Record 11229279;
      Resource@1100529004 : Record 11229278;
      Resource2@1100525000 : Record 11229278;
      ReferencePoint@1100529104 : Record 11020271;
      MobileSetup@1100529105 : Record 11012676;
      InstallationManagement@1100529106 : Codeunit 11012268;
      DurationTime@1100529100 : Decimal;
      CalcDuration@1100529101 : Boolean;
      UpdateExportFieldService@1100529103 : Boolean;
      FPSLicenseManagement@1100528500 : Codeunit 11229289;
    BEGIN
      IF WorkOrder.GET(WorkOrderNo) THEN BEGIN
        IF (WorkOrder."Resource No." <> ResourceNo) OR ((ResourceGroup <> '') AND (WorkOrder."Resource Group No." <> ResourceGroup)) OR
           (WorkOrder."Starting Date/Time" <> StartDateTime) OR (WorkOrder."Ending Date/Time" <> EndDateTime)
        THEN BEGIN
          IF ResourceNo <> '' THEN
            Resource.GET(ResourceNo)
          ELSE BEGIN
            IF ResourceGroupType = ResourceGroupTypeOption::PlantType THEN
              Resource.Type := Resource.Type::Plant
            ELSE
              Resource.Type := Resource.Type::Employee;
          END;
          IF (WorkOrder."Resource No." <> ResourceNo) OR ((ResourceGroup <> '') AND (WorkOrder."Resource Group No." <> ResourceGroup)) THEN BEGIN
            IF ResourceGroup <> '' THEN BEGIN
              IF ((WorkOrder."Resource Type" = WorkOrder."Resource Type"::Plant) AND (ResourceGroupType <> ResourceGroupTypeOption::PlantType)) OR
                 ((WorkOrder."Resource Type" IN [WorkOrder."Resource Type"::Employee, WorkOrder."Resource Type"::Subcontractor]) AND
                   (ResourceGroupType <> ResourceGroupTypeOption::Discipline))
              THEN BEGIN
                IF ResourceGroupType = ResourceGroupTypeOption::PlantType THEN
                  Resource2.Type := Resource.Type::Plant
                ELSE
                  Resource2.Type := Resource.Type::Employee;
                WorkOrder.FIELDERROR("Resource Type", STRSUBSTNO(Text004, WorkOrder."Resource Type", Resource2.Type));
              END;
            END ELSE BEGIN
              IF NOT IgnoreTypeChange THEN BEGIN
                IF ResourceNo <> '' THEN BEGIN
                  IF ((WorkOrder."Resource Type" = WorkOrder."Resource Type"::Plant) AND (Resource.Type <> Resource.Type::Plant)) OR
                     ((WorkOrder."Resource Type" IN [WorkOrder."Resource Type"::Employee, WorkOrder."Resource Type"::Subcontractor]) AND
                      (NOT (Resource.Type IN [Resource.Type::Employee, Resource.Type::Subcontractor])))
                  THEN
                    WorkOrder.FIELDERROR("Resource Type", STRSUBSTNO(Text004, WorkOrder."Resource Type", Resource.Type));
                END;
              END;
            END;
          END;
          WorkOrder.SetSkipAddLinkedResources(TRUE);
          IF WorkOrder."Resource Type" <> Resource.Type THEN
            WorkOrder."Resource Type" := Resource.Type;
          IF WorkOrder."Resource No." <> ResourceNo THEN BEGIN
            WorkOrder.VALIDATE("Resource No.", ResourceNo);
            UpdateExportFieldService := TRUE;
            CalcDuration := TRUE;
          END;
          IF (ResourceGroup <> '') AND (WorkOrder."Resource Group No." <> ResourceGroup) THEN
            WorkOrder.VALIDATE("Resource Group No.", ResourceGroup);

          IF WorkOrder."Schedule Relation" <> WorkOrder."Schedule Relation"::"Start-Start" THEN BEGIN
            IF NOT WorkOrder."Firm Planned" THEN BEGIN
              IF NOT WorkOrder."Plan during Clock Time" THEN BEGIN
                IF ((WorkOrder."Starting Date/Time" <> StartDateTime) AND (WorkOrder."Ending Date/Time" <> EndDateTime)) OR
                    CalcDuration
                  THEN BEGIN // duration time is leading, change end time
                  DurationTime := WorkOrder."Duration Time";
                  CalculateEndDateTime(ResourceNo,StartDateTime,EndDateTime,DurationTime,WorkOrder."Plan in Weekend");
                  IF WorkOrderTimeChanged(WorkOrder,StartDateTime,EndDateTime,DurationTime) THEN BEGIN
                    WorkOrder."Ending Date/Time" := 0DT;
                    WorkOrder.VALIDATE("Starting Date/Time", StartDateTime);
                    WorkOrder.VALIDATE("Ending Date/Time", EndDateTime);
                    WorkOrder.VALIDATE("Duration Time", DurationTime);
                    UpdateExportFieldService := TRUE;
                  END;
                END ELSE BEGIN
                  IF ((WorkOrder."Starting Date/Time" <> StartDateTime) AND (WorkOrder."Ending Date/Time" = EndDateTime)) OR
                    ((WorkOrder."Starting Date/Time" = StartDateTime) AND (WorkOrder."Ending Date/Time" <> EndDateTime))
                  THEN BEGIN // end time is leading, change duration time
                    CalculateDurationTime(ResourceNo,StartDateTime,EndDateTime,DurationTime,WorkOrder."Plan in Weekend");
                    IF WorkOrderTimeChanged(WorkOrder,StartDateTime,EndDateTime,DurationTime) THEN BEGIN
                      WorkOrder."Ending Date/Time" := 0DT;
                      WorkOrder.VALIDATE("Starting Date/Time", StartDateTime);
                      WorkOrder.VALIDATE("Ending Date/Time", EndDateTime);
                      WorkOrder.VALIDATE("Duration Time", DurationTime);
                      UpdateExportFieldService := TRUE;
                    END;
                  END;
                END;
              END ELSE BEGIN
                IF (WorkOrder."Starting Date/Time" <> StartDateTime) OR (WorkOrder."Ending Date/Time" <> EndDateTime) THEN BEGIN
                  DurationTime := ROUND((EndDateTime - StartDateTime) / 3600000, 0.01);
                  IF WorkOrderTimeChanged(WorkOrder,StartDateTime,EndDateTime,DurationTime) THEN BEGIN
                    WorkOrder."Ending Date/Time" := 0DT;
                    WorkOrder.VALIDATE("Starting Date/Time", StartDateTime);
                    WorkOrder.VALIDATE("Ending Date/Time", EndDateTime);
                    WorkOrder.VALIDATE("Duration Time", DurationTime);
                    UpdateExportFieldService := TRUE;
                  END;
                END;
              END;
            END;
          END;

          IF UpdateExportFieldService THEN BEGIN
            IF InstallationManagement.LicensePermissionForTableData(DATABASE::"4PS-Mobile Setup") THEN
              IF FPSLicenseManagement.LicenseAndReadPermissionForTable(MobileSetup) THEN
                IF MobileSetup.GET THEN
                  IF MobileSetup."Ref. Point Sending SO" > 0 THEN
                    IF WorkOrder."Actual Reference Point" > MobileSetup."Ref. Point Sending SO" THEN
                      IF ReferencePoint.GET(WorkOrder."Actual Reference Point") THEN
                        IF NOT ReferencePoint."Block Modify Service Order" THEN
                          IF Resource."Active in FSA" THEN BEGIN
                            WorkOrder."Export to FSA" := TRUE;
                            IF NOT WorkOrder.ExportFromGRPtoFSA THEN
                              WorkOrder."Export to FSA" := FALSE;
                          END;
          END;
          WorkOrder.MODIFY(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE DeleteWorkorder@1100529035(WorkOrderNo@1100529005 : Code[20]);
    VAR
      WorkOrder@1100529003 : Record 11229279;
      WorkOrder2@1100529000 : Record 11229279;
      ResourceRequest@1100528300 : Record 11124901;
    BEGIN
      IF WorkOrder.GET(WorkOrderNo) THEN BEGIN
        WorkOrder.DELETE(TRUE);
        IF (WorkOrder."Source Type" = WorkOrder."Source Type"::Request) AND (WorkOrder."Source No." <> '') THEN BEGIN  //Only for request, so not PROJ/SO!
          WorkOrder2.SETCURRENTKEY("Source Company", "Source Type", "Source No.");
          WorkOrder2.SETRANGE("Source Company", WorkOrder."Source Company");
          WorkOrder2.SETRANGE("Source Type", WorkOrder."Source Type");
          WorkOrder2.SETRANGE("Source No.", WorkOrder."Source No.");
          IF WorkOrder2.ISEMPTY THEN BEGIN
            IF CONFIRM(Text005, TRUE, WorkOrder."Source No.") THEN BEGIN
              IF ResourceRequest.GET(WorkOrder."Source No.") THEN
                ResourceRequest.DELETE(TRUE);
            END;
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE SetKeyAndFiltersResources@1100529012(VAR Resource@1100529000 : Record 11229278;ResourceType@1100529001 : Option;SortOn@1100529002 : Code[10]);
    BEGIN
      Resource.RESET;
      CASE SortOn OF
        'SOURCENO'  : Resource.SETCURRENTKEY(Type,Company,"Source No.","Source No. 2");
        'SEARCHNAME': Resource.SETCURRENTKEY(Type,Company,"Search Name");
      ELSE
        Resource.SETCURRENTKEY("No.");
      END;
      Resource.SETFILTER("No.", '<>%1', '');
      IF ResourceType <> -1 THEN
        Resource.SETRANGE(Type, ResourceType)
      ELSE
        Resource.SETFILTER(Type, '%1|%2|%3', Resource.Type::Employee, Resource.Type::Plant, Resource.Type::Subcontractor);
      Resource.SetCompanyPlanGroupFilters;
      Resource.SETFILTER("User ID Filter", USERID);
      Resource.SETRANGE("Visible in GRP", TRUE);
    END;

    LOCAL PROCEDURE SetKeyAndFiltersResourceGroups@1100529048(VAR ResourceGroup@1100529000 : Record 11229384;ResourceGroupType@1100529001 : Option;SortOn@1100529002 : Code[10]);
    BEGIN
      ResourceGroup.RESET;
      CASE SortOn OF
        'SOURCENO'  : ResourceGroup.SETCURRENTKEY(Type,Company,"Source No.");
        'SEARCHNAME': ResourceGroup.SETCURRENTKEY(Type,Company,"Search Name");
      ELSE
        ResourceGroup.SETCURRENTKEY("No.");
      END;
      ResourceGroup.SETFILTER("No.", '<>%1', '');
      IF ResourceGroupType <> -1 THEN
        ResourceGroup.SETRANGE(Type, ResourceGroupType)
      ELSE
        ResourceGroup.SETFILTER(Type, '%1|%2', ResourceGroup.Type::Discipline, ResourceGroup.Type::Plant);
      ResourceGroup.SetCompanyPlanGroupFilters;
      ResourceGroup.SETFILTER("User ID Filter", USERID);
      ResourceGroup.SETFILTER("Company Filter", COMPANYNAME);
      ResourceGroup.SETRANGE("Visible in GRP", TRUE);
    END;

    [External]
    PROCEDURE ShowResourceSourceCard@1100529013(ResourceNo@1100529000 : Code[40]);
    VAR
      Resource@1100529001 : Record 11229278;
      ResourceGroup@1100529002 : Record 11229384;
      Employee@1100529003 : Record 5200;
      PlantNumber@1100529004 : Record 11012552;
      PlantType@1100528300 : Record 11012551;
      Vendor@1100525000 : Record 23;
      Discipline@1100529005 : Record 11020204;
      ResourceGroupTypeNo@1100528301 : Integer;
    BEGIN
      IF ResourceNo = '' THEN
        EXIT;

      ResourceGroupTypeNo := IsResourceNo2ResourceGroup(ResourceNo);
      IF (ResourceGroupTypeNo <> ResourceGroupTypeOption::Discipline) AND (ResourceGroupTypeNo <> ResourceGroupTypeOption::PlantType) THEN BEGIN
        IF NOT Resource.GET(ResourceNo) THEN
          EXIT;
        IF Resource.Company <> COMPANYNAME THEN BEGIN
          Resource.SETRANGE("No.", Resource."No.");
          PAGE.RUNMODAL(PAGE::"Resource-Card", Resource);
          EXIT;
        END;
        CASE Resource.Type OF
          Resource.Type::Employee:
            BEGIN
              Employee.SETRANGE("No.", Resource."Source No.");
              PAGE.RUNMODAL(PAGE::"Employee Card", Employee);
            END;
          Resource.Type::Plant:
            BEGIN
              PlantNumber.SETRANGE("Plant Type", Resource."Source No.");
              PlantNumber.SETRANGE("No.", Resource."Source No. 2");
              PAGE.RUNMODAL(PAGE::"Plant Number", PlantNumber);
            END;
          Resource.Type::Subcontractor:
            BEGIN
              Vendor.SETRANGE("No.", Resource."Source No.");
              PAGE.RUNMODAL(PAGE::"Vendor Card", Vendor);
            END;
        END;
      END ELSE BEGIN
        IF NOT ResourceGroup.GET(ResourceNo) THEN
          EXIT;
        IF ResourceGroup.Company <> COMPANYNAME THEN BEGIN
          ResourceGroup.SETRANGE("No.", Resource."No.");
          PAGE.RUNMODAL(PAGE::"Resource Group Card (WOP)", ResourceGroup);
          EXIT;
        END;
        CASE ResourceGroupTypeNo OF
          ResourceGroupTypeOption::Discipline :
            BEGIN
              Discipline.SETRANGE(Code, ResourceGroup."Source No.");
              PAGE.RUNMODAL(PAGE::Disciplines, Discipline);
            END;
          ResourceGroupTypeOption::PlantType:
            BEGIN
              PlantType.SETRANGE(Code, ResourceGroup."Source No.");
              PAGE.RUNMODAL(PAGE::"Plant Type", PlantType);
            END;
        END;
      END;
    END;

    [External]
    PROCEDURE ShowEventCard@1100529025(EventNo@1100529000 : Text;VAR SourceType@1100529100 : Option) : Code[20];
    VAR
      Workorder@1100529001 : Record 11229279;
      AdditionalInfoRequestWO@1100529003 : Record 11124915;
      WorkOrderCard@1100529002 : Page 11229285;
      AdditionalInfoCard@1100529004 : Page 11126894;
    BEGIN
      IF EventNo = '' THEN
        EXIT;
      IF NOT Workorder.GET(EventNo) THEN
        EXIT;
      IF (Workorder."Source Type" = Workorder."Source Type"::Request) AND (Workorder."Source Company" = COMPANYNAME) THEN BEGIN
        AdditionalInfoRequestWO.SETRANGE("Work Order No.", Workorder."No.");
        AdditionalInfoCard.SETTABLEVIEW(AdditionalInfoRequestWO);
        AdditionalInfoCard.EDITABLE(Workorder."Source Company" = COMPANYNAME);
        AdditionalInfoCard.RUNMODAL;
      END ELSE BEGIN
        Workorder.SETRANGE("No.", Workorder."No.");
        WorkOrderCard.SETTABLEVIEW(Workorder);
        WorkOrderCard.EDITABLE(Workorder."Source Company" = COMPANYNAME);
        WorkOrderCard.RUNMODAL;
      END;
      SourceType := Workorder."Source Type";
      EXIT(Workorder."Source No.");
    END;

    [External]
    PROCEDURE ShowSourceCard@1100529108(EventNo@1100529000 : Text);
    VAR
      Workorder@1100529001 : Record 11229279;
      ServiceOrder@1100529100 : Record 11012823;
      Job@1100529102 : Record 11072003;
      ResourceRequest@1100529101 : Record 11124901;
    BEGIN
      IF EventNo = '' THEN
        EXIT;
      IF NOT Workorder.GET(EventNo) THEN
        EXIT;
      CASE Workorder."Source Type" OF
        Workorder."Source Type"::Request:
          BEGIN
            ResourceRequest.CHANGECOMPANY(Workorder."Source Company");
            IF ResourceRequest.GET(Workorder."Source No.") THEN BEGIN
              IF Workorder."Source Company" <> COMPANYNAME THEN
                HYPERLINK(GETURL(CURRENTCLIENTTYPE, Workorder."Source Company", OBJECTTYPE::Page, PAGE::"Resource Request", ResourceRequest))
              ELSE
                PAGE.RUNMODAL(PAGE::"Resource Request", ResourceRequest);
            END;
          END;
        Workorder."Source Type"::Project:
          BEGIN
            Job.CHANGECOMPANY(Workorder."Source Company");
            IF Job.GET(Workorder."Source No.") THEN BEGIN
              IF Workorder."Source Company" <> COMPANYNAME THEN
                HYPERLINK(GETURL(CURRENTCLIENTTYPE, Workorder."Source Company", OBJECTTYPE::Page, PAGE::"Job Card", Job))
              ELSE
                PAGE.RUNMODAL(PAGE::"Job Card", Job);
            END;
          END;
        Workorder."Source Type"::ServiceOrder:
          BEGIN
            ServiceOrder.CHANGECOMPANY(Workorder."Source Company");
            IF ServiceOrder.GET(Workorder."Source No.") THEN BEGIN
              IF Workorder."Source Company" <> COMPANYNAME THEN
                HYPERLINK(GETURL(CURRENTCLIENTTYPE, Workorder."Source Company", OBJECTTYPE::Page, ServiceOrder.GetServiceOrderCard, ServiceOrder))
              ELSE
                PAGE.RUNMODAL(ServiceOrder.GetServiceOrderCard, ServiceOrder);
            END;
          END;
      END;
    END;

    LOCAL PROCEDURE DetermineLanguage@1100525001() : Text[2];
    VAR
      WindowsLanguages@1100525000 : Record 2000000045;
    BEGIN
      IF WindowsLanguages.GET(GLOBALLANGUAGE) THEN BEGIN
        IF WindowsLanguages."Abbreviated Name" <> '' THEN
          EXIT(LOWERCASE(COPYSTR(WindowsLanguages."Abbreviated Name", 1, 2)));
      END;
      EXIT('');
    END;

    LOCAL PROCEDURE FormatDate@1100529005(Date@1100529000 : Date) : Text;
    BEGIN
      EXIT(FORMAT(Date,0,'<Year4>-<Month,2>-<Day,2>'));  //* yyyy-mm-dd
    END;

    LOCAL PROCEDURE FormatTime@1100529006(Time@1100529000 : Time) : Text;
    BEGIN
      EXIT(FORMAT(Time,0,'<Hours24,2><Filler Character,0>:<Minutes,2>:<Seconds,2>'));  //* hh:mm:ss
    END;

    LOCAL PROCEDURE Time0Hrs@1100529900() Time0H : Time;
    BEGIN
      EVALUATE(Time0H, '0');
    END;

    LOCAL PROCEDURE FormatDateTime@1100529007(DateTime@1100529000 : DateTime) : Text;
    BEGIN
      EXIT(FORMAT(ROUNDDATETIME(DateTime, 60000),0,'<Year4>-<Month,2>-<Day,2>T<Hours24,2><Filler Character,0>:<Minutes,2>:<Seconds,2>'));  //* yyyy-mm-ddThh:mm:ss
    END;

    LOCAL PROCEDURE FormatBool2TextFalseTrue@1100529018(Bool@1100529000 : Boolean) : Text;
    BEGIN
      EXIT(FORMAT(Bool,0,9));
    END;

    [External]
    PROCEDURE EvaluateDate@1100529023(DateTxt@1100529000 : Text) : Date;
    VAR
      Year@1100529001 : Integer;
      Month@1100529002 : Integer;
      DayNo@1100529003 : Integer;
    BEGIN
      //* Text with format yyyy-mm-dd -> Date
      EVALUATE(Year, COPYSTR(DateTxt,1,4));
      EVALUATE(Month, COPYSTR(DateTxt,6,2));
      EVALUATE(DayNo, COPYSTR(DateTxt,9,2));
      EXIT(DMY2DATE(DayNo, Month, Year));
    END;

    [External]
    PROCEDURE EvaluateDateTime@1100529022(DateTimeTxt@1100529000 : Text) : DateTime;
    VAR
      Year@1100529001 : Integer;
      Month@1100529002 : Integer;
      DayNo@1100529003 : Integer;
      Times@1100529004 : Time;
    BEGIN
      //* Text with format yyyy-mm-ddThh:mm:ss -> DateTime
      IF DateTimeTxt = '' THEN
        EXIT;
      EVALUATE(Year, COPYSTR(DateTimeTxt,1,4));
      EVALUATE(Month, COPYSTR(DateTimeTxt,6,2));
      EVALUATE(DayNo, COPYSTR(DateTimeTxt,9,2));
      EVALUATE(Times, COPYSTR(DateTimeTxt,12));
      EXIT(CREATEDATETIME(DMY2DATE(DayNo, Month, Year), Times));
    END;

    [External]
    PROCEDURE EventType2Text@1100529039(TableNo@1100529000 : Integer) : Text;
    VAR
      ServiceOrder@1100529100 : Record 11012823;
      Job@1100529101 : Record 11072003;
      ResourceRequest@1100529102 : Record 11124901;
      EmployeeAbsence@1100529103 : Record 5207;
      PlantAbsence@1100529104 : Record 11126143;
    BEGIN
      CASE TableNo OF
        DATABASE::Job:
          EXIT(Job.TABLECAPTION);
        DATABASE::"Service Order":
          EXIT(ServiceOrder.TABLECAPTION);
        DATABASE::"Resource Request":
          EXIT(ResourceRequest.TABLECAPTION);
        DATABASE::"Employee Absence":
          EXIT(EmployeeAbsence.TABLECAPTION);
        DATABASE::"Plant Absence":
          EXIT(PlantAbsence.TABLECAPTION);
      END;
      EXIT('');
    END;

    [External]
    PROCEDURE EventSourceType2Text@1100529040(SourceTypeNo@1100529000 : Integer) : Text;
    VAR
      WorkOrder@1100529001 : Record 11229279;
    BEGIN
      CASE SourceTypeNo OF
        WorkOrder."Source Type"::Project,
        WorkOrder."Source Type"::ServiceOrder,
        WorkOrder."Source Type"::Request:
          BEGIN
            WorkOrder."Source Type" := SourceTypeNo;
            EXIT(FORMAT(WorkOrder."Source Type"));
          END;
        DATABASE::"Employee Absence":
          EXIT(EventType2Text(DATABASE::"Employee Absence"));
        DATABASE::"Plant Absence":
          EXIT(EventType2Text(DATABASE::"Plant Absence"));
      END;
      EXIT('');
    END;

    [External]
    PROCEDURE EventSourceTypeText2OptionNo@1100529036(SourceTypeText@1100529000 : Text) : Integer;
    VAR
      WorkOrder@1100529001 : Record 11229279;
    BEGIN
      CASE SourceTypeText OF
        FORMAT(WorkOrder."Source Type"::Project):
          EXIT(WorkOrder."Source Type"::Project);
        FORMAT(WorkOrder."Source Type"::ServiceOrder):
          EXIT(WorkOrder."Source Type"::ServiceOrder);
        FORMAT(WorkOrder."Source Type"::Request):
          EXIT(WorkOrder."Source Type"::Request);
        EventType2Text(DATABASE::"Employee Absence"):
          EXIT(901);
        EventType2Text(DATABASE::"Plant Absence"):
          EXIT(902);
      END;
      EXIT(-1);
    END;

    LOCAL PROCEDURE FormatResourceGroup2GRPResourceNo@1100528301(TypeNo@1100528300 : Integer;ResourceGroup@1100528301 : Code[20]) : Code[40];
    VAR
      WorkOrder@1100528302 : Record 11229279;
    BEGIN
      CASE TypeNo OF
        WorkOrder."Resource Type"::Employee,
        WorkOrder."Resource Type"::Subcontractor,
        DATABASE::Discipline:
          EXIT('[D]_' + ResourceGroup);
        WorkOrder."Resource Type"::Plant,
        DATABASE::"Plant Type":
          EXIT('[P]_' + ResourceGroup);
      END;
    END;

    [External]
    PROCEDURE IsResourceNo2ResourceGroup@1100528300(VAR ResourceNoGRP@1100529000 : Code[40]) : Integer;
    BEGIN
      CASE COPYSTR(ResourceNoGRP,1,4) OF
        '[D]_':
          BEGIN
            ResourceNoGRP := COPYSTR(ResourceNoGRP, 5);
            EXIT(ResourceGroupTypeOption::Discipline);
          END;
        '[P]_':
          BEGIN
            ResourceNoGRP := COPYSTR(ResourceNoGRP, 5);
            EXIT(ResourceGroupTypeOption::PlantType);
          END;
      END;
      EXIT(0);
    END;

    LOCAL PROCEDURE FormatAbsenceNo2GRPEventNo@1100527715(TypeNo@1100528300 : Integer;EntryNo@1100528301 : Code[20]) : Code[40];
    VAR
      WorkOrder@1100528302 : Record 11229279;
    BEGIN
      CASE TypeNo OF
        DATABASE::"Employee Absence":
          EXIT('[EA]_' + EntryNo);
        DATABASE::"Plant Absence":
          EXIT('[PA]_' + EntryNo);
      END;
    END;

    [External]
    PROCEDURE FormatEventNo2AbsenceNo@1100527717(EventNo@1100529000 : Text) : Integer;
    VAR
      EntryNo@1100527700 : Integer;
    BEGIN
      CASE COPYSTR(EventNo,1,5) OF
        '[EA]_':
          BEGIN
            EVALUATE(EntryNo, COPYSTR(EventNo, 6));
            EXIT(EntryNo);
          END;
        '[PA]_':
          BEGIN
            EVALUATE(EntryNo, COPYSTR(EventNo, 6));
            EXIT(EntryNo);
          END;
      END;
      EXIT(0);
    END;

    LOCAL PROCEDURE GetTmpFullFileName@1100529016(Resize@1100529000 : Boolean) : Text;
    BEGIN
      IF NOT Resize THEN
        EXIT(TEMPORARYPATH + 'TmpResourcePictureGRP.bmp')
      ELSE
        EXIT(TEMPORARYPATH + 'TmpResourcePictureGRPResize.bmp');
    END;

    LOCAL PROCEDURE CreateBase64Content@1100529014(FullFileName@1100529006 : Text;VAR Base64EncodedContents@1100529007 : BigText);
    VAR
      Resizeimage@1100529000 : Codeunit 11125359;
      Convert@1100529009 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Convert";
      File@1100529010 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.File";
      ResizeFullFileName@1100529001 : Text;
    BEGIN
      ResizeFullFileName := GetTmpFullFileName(TRUE);
      Resizeimage.CompressPicture(FullFileName, ResizeFullFileName, 100);
      CLEAR(Base64EncodedContents);
      Base64EncodedContents.ADDTEXT('data:image/bmp;base64,');
      Base64EncodedContents.ADDTEXT(Convert.ToBase64String(File.ReadAllBytes(ResizeFullFileName)));
    END;

    [External]
    PROCEDURE CleanWorkOrderEventLog@1100529042();
    VAR
      WorkOrderChangeLogGRP@1100529000 : Record 11124906;
    BEGIN
      WorkOrderChangeLogGRP.SETFILTER("Modified On", '<%1', CURRENTDATETIME-(1000*60*60*24));   // Older 1 day
      WorkOrderChangeLogGRP.DELETEALL;
      COMMIT;
    END;

    LOCAL PROCEDURE ColorToRGB@1100529116(IntColor@1100529100 : Integer) : Text;
    VAR
      Blue@1100529101 : Integer;
      Green@1100529102 : Integer;
      Red@1100529103 : Integer;
    BEGIN
      IF IntColor > 0 THEN BEGIN
        Blue := IntColor MOD 256;
        Green := (ROUND(IntColor / 256, 1, '<' )) MOD 256;
        Red := (ROUND(((IntColor / 256) / 256),1 ,'<')) MOD 256;
        EXIT(FORMAT(Red) + ', ' + FORMAT(Green) + ', ' + FORMAT(Blue) + ', ');
      END ELSE
        EXIT('0, 128, 255, ');
    END;

    [External]
    PROCEDURE GetEmployeeFromResource@1100525000(ResourceNo@1100525000 : Code[20];ModeOwnCompany@1100529100 : Boolean;VAR EmployeeNo@1100525001 : Code[20];VAR EmployeeCompany@1100529101 : Text) : Boolean;
    VAR
      ResourceWOP@1100525002 : Record 11229278;
    BEGIN
      IF ResourceWOP.GET(ResourceNo) THEN BEGIN
        IF (ResourceWOP.Type = ResourceWOP.Type::Employee) AND ((ResourceWOP.Company = COMPANYNAME) OR (NOT ModeOwnCompany)) THEN BEGIN
          EmployeeNo := ResourceWOP."Source No.";
          EmployeeCompany := ResourceWOP.Company;
          EXIT(TRUE);
        END;
      END;
      EXIT(FALSE);
    END;

    [External]
    PROCEDURE GetPlantFromResource@1100529115(ResourceNo@1100525000 : Code[20];ModeOwnCompany@1100529100 : Boolean;VAR PlantType@1100529102 : Code[20];VAR PlantNo@1100525001 : Code[10];VAR PlantCompany@1100529101 : Text) : Boolean;
    VAR
      ResourceWOP@1100525002 : Record 11229278;
    BEGIN
      IF ResourceWOP.GET(ResourceNo) THEN BEGIN
        IF (ResourceWOP.Type = ResourceWOP.Type::Plant) AND ((ResourceWOP.Company = COMPANYNAME) OR (NOT ModeOwnCompany)) THEN BEGIN
          PlantType := ResourceWOP."Source No.";
          PlantNo := ResourceWOP."Source No. 2";
          PlantCompany := ResourceWOP.Company;
          EXIT(TRUE);
        END;
      END;
      EXIT(FALSE);
    END;

    [External]
    PROCEDURE CreateEmployeeAbsence@1100525003(ResourceNo@1100525006 : Code[20];CauseOfAbsence@1100525001 : Code[10];StartDateTime@1100525002 : DateTime;EndDateTime@1100525003 : DateTime) : Integer;
    VAR
      EmployeeAbsence@1100525004 : Record 5207;
      EmployeeNo@1100525000 : Code[20];
      FromDate@1100529100 : Date;
      ToDate@1100529101 : Date;
      FromTime@1100529102 : Time;
      ToTime@1100529103 : Time;
      EmployeeCompany@1100529104 : Text;
    BEGIN
      FromDate := DT2DATE(StartDateTime);
      FromTime := DT2TIME(StartDateTime);
      ToDate := DT2DATE(EndDateTime);
      ToTime := DT2TIME(EndDateTime);
      IF ToTime = 000000T THEN BEGIN
        ToDate := ToDate - 1;
        ToTime := 235959T;
      END;
      IF NOT GetEmployeeFromResource(ResourceNo, TRUE, EmployeeNo, EmployeeCompany) THEN
        EXIT(0);

      EmployeeAbsence.INIT;
      EmployeeAbsence."Employee No." := EmployeeNo;
      EmployeeAbsence.VALIDATE("Cause of Absence Code", CauseOfAbsence);
      EmployeeAbsence.VALIDATE("From Date", FromDate);
      EmployeeAbsence.VALIDATE("To Date", ToDate);
      EmployeeAbsence.VALIDATE("From Time", FromTime);
      EmployeeAbsence.VALIDATE("Until Time", ToTime);
      EmployeeAbsence.INSERT(TRUE);
      EXIT(EmployeeAbsence."Entry No.")
    END;

    [External]
    PROCEDURE CreatePlantAbsence@1100529121(ResourceNo@1100525006 : Code[20];CauseOfAbsencePlant@1100525001 : Code[10];StartDateTime@1100525002 : DateTime;EndDateTime@1100525003 : DateTime) : Integer;
    VAR
      PlantAbsence@1100525004 : Record 11126143;
      PlantType@1100525000 : Code[20];
      PlantNo@1100529105 : Code[10];
      FromDate@1100529100 : Date;
      ToDate@1100529101 : Date;
      FromTime@1100529102 : Time;
      ToTime@1100529103 : Time;
      PlantCompany@1100529104 : Text;
    BEGIN
      FromDate := DT2DATE(StartDateTime);
      FromTime := DT2TIME(StartDateTime);
      ToDate := DT2DATE(EndDateTime);
      ToTime := DT2TIME(EndDateTime);
      IF ToTime = 000000T THEN BEGIN
        ToDate := ToDate - 1;
        ToTime := 235959T;
      END;
      IF NOT GetPlantFromResource(ResourceNo, TRUE, PlantType, PlantNo, PlantCompany) THEN
        EXIT(0);

      PlantAbsence.INIT;
      PlantAbsence."Plant Type" := PlantType;
      PlantAbsence."Plant No." := PlantNo;
      PlantAbsence.VALIDATE("Cause of Absence Code", CauseOfAbsencePlant);
      PlantAbsence.VALIDATE("From Date", FromDate);
      PlantAbsence.VALIDATE("To Date", ToDate);
      PlantAbsence.VALIDATE("From Time", FromTime);
      PlantAbsence.VALIDATE("Until Time", ToTime);
      PlantAbsence.INSERT(TRUE);
      EXIT(PlantAbsence."Entry No.")
    END;

    [External]
    PROCEDURE ShowCreatedEmployeeAbsence@1100529101(StartEntryNo@1100529102 : Integer;EndEntryNo@1100529101 : Integer);
    VAR
      EmployeeAbsence@1100529100 : Record 5207;
    BEGIN
      COMMIT;
      EmployeeAbsence.SETRANGE("Entry No.", StartEntryNo, EndEntryNo);
      PAGE.RUNMODAL(PAGE::"Absence Registration", EmployeeAbsence);
    END;

    [External]
    PROCEDURE ShowCreatedPlantAbsence@1100529122(StartEntryNo@1100529102 : Integer;EndEntryNo@1100529101 : Integer);
    VAR
      PlantAbsence@1100529100 : Record 11126143;
    BEGIN
      COMMIT;
      PlantAbsence.SETRANGE("Entry No.", StartEntryNo, EndEntryNo);
      PAGE.RUNMODAL(PAGE::"Plant Absence Registration", PlantAbsence);
    END;

    [External]
    PROCEDURE ExportCreatedEmployeeAbsence@1100529100(VAR SchedulerEvents@1100529103 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";StartEntryNo@1100529102 : Integer;EndEntryNo@1100529101 : Integer);
    VAR
      EmployeeAbsence@1100529100 : Record 5207;
      SchedulerEvent@1100529104 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
    BEGIN
      SchedulerEvents := SchedulerEvents.SchedulerEvents();
      EmployeeAbsence.SETRANGE("Entry No.", StartEntryNo, EndEntryNo);
      IF EmployeeAbsence.FINDSET THEN BEGIN
        REPEAT
          SchedulerEvent := SchedulerEvent.SchedulerEvent;
          ExportEmployeeAbsence(SchedulerEvent, EmployeeAbsence."Entry No.", COMPANYNAME);
          SchedulerEvents.AddEvent(SchedulerEvent);
        UNTIL EmployeeAbsence.NEXT = 0;
      END;
    END;

    [External]
    PROCEDURE ExportCreatedPlantAbsence@1100529123(VAR SchedulerEvents@1100529103 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";StartEntryNo@1100529102 : Integer;EndEntryNo@1100529101 : Integer);
    VAR
      PlantAbsence@1100529100 : Record 11126143;
      SchedulerEvent@1100529104 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
    BEGIN
      SchedulerEvents := SchedulerEvents.SchedulerEvents();
      PlantAbsence.SETRANGE("Entry No.", StartEntryNo, EndEntryNo);
      IF PlantAbsence.FINDSET THEN BEGIN
        REPEAT
          SchedulerEvent := SchedulerEvent.SchedulerEvent;
          ExportPlantAbsence(SchedulerEvent, PlantAbsence."Entry No.", COMPANYNAME);
          SchedulerEvents.AddEvent(SchedulerEvent);
        UNTIL PlantAbsence.NEXT = 0;
      END;
    END;

    [External]
    PROCEDURE CheckEmployeeAbsence@1100525004(WorkOrder@1100525000 : Record 11229279;VAR MessageString@1100525001 : Text;BreakChar@1100529100 : Text);
    BEGIN
      IF WorkOrder.CheckEmployeeAbsence THEN BEGIN
        IF STRPOS(MessageString, WorkOrder."Resource No.") = 0 THEN BEGIN
          WorkOrder.CALCFIELDS("Resource Name");
          MessageString += BreakChar + WorkOrder."Resource No." + ', ' + WorkOrder."Resource Name";
        END;
      END;
    END;

    [External]
    PROCEDURE CheckPlantAbsence@1100529124(WorkOrder@1100525000 : Record 11229279;VAR MessageString@1100525001 : Text;BreakChar@1100529100 : Text);
    BEGIN
      IF WorkOrder.CheckPlantAbsence AND (STRPOS(MessageString, WorkOrder."Resource No.") = 0) THEN BEGIN
        WorkOrder.CALCFIELDS("Resource Name");
        MessageString += BreakChar + WorkOrder."Resource No." + ', ' + WorkOrder."Resource Name";
      END;
    END;

    [External]
    PROCEDURE GetEmployeeAbsenceEntryNo@1100525006(VAR SchedulerEvent@1100525001 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent") : Integer;
    VAR
      EmployeeAbsence@1100525004 : Record 5207;
      EmployeeNo@1100525000 : Code[20];
      EmployeeCompany@1100529100 : Text;
    BEGIN
      IF GetEmployeeFromResource(SchedulerEvent.Resource, FALSE, EmployeeNo, EmployeeCompany) THEN BEGIN
        EmployeeAbsence.CHANGECOMPANY(EmployeeCompany);
        EmployeeAbsence.SETRANGE("Employee No.", EmployeeNo);
        EmployeeAbsence.SETRANGE("Cause of Absence Code", SchedulerEvent.Type);
        EmployeeAbsence.SETRANGE("From Date", EvaluateDate(SchedulerEvent.StartDate));
        EmployeeAbsence.SETRANGE("To Date", EvaluateDate(SchedulerEvent.EndDate));
        IF EmployeeAbsence.FINDFIRST THEN
          EXIT(EmployeeAbsence."Entry No.");
      END;
      EXIT(0);
    END;

    [External]
    PROCEDURE ShowEmployeeAbsence@1100525009(EmployeeNo@1100529100 : Code[20];EntryNo@1100525000 : Integer);
    VAR
      EmployeeAbsence@1100525001 : Record 5207;
      EmployeeAbsence2@1100525002 : Record 5207;
    BEGIN
      IF NOT EmployeeAbsence.GET(EntryNo) THEN
        EXIT;
      IF EmployeeAbsence."Employee No." <> EmployeeNo THEN
        EXIT;

      EmployeeAbsence2.SETRANGE("Employee No.", EmployeeAbsence."Employee No.");
      EmployeeAbsence2.SETFILTER("From Date", '>%1', DT2DATE(CURRENTDATETIME) - 365);
      EmployeeAbsence2.GET(EntryNo);

      PAGE.RUNMODAL(PAGE::"Absence Registration", EmployeeAbsence2);
    END;

    [External]
    PROCEDURE UpdateEmployeeAbsence@1100529125(SchedulerEvent@1100529101 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";EmployeeNo@1100529102 : Code[20];EntryNo@1100529100 : Integer;VAR MessageString@1100529110 : Text;BreakChar@1100529109 : Text);
    VAR
      EmployeeAbsence@1100525001 : Record 5207;
      StartDateTime@1100529103 : DateTime;
      EndDateTime@1100529104 : DateTime;
      FromDate@1100529108 : Date;
      ToDate@1100529107 : Date;
      FromTime@1100529106 : Time;
      ToTime@1100529105 : Time;
    BEGIN
      IF NOT EmployeeAbsence.GET(EntryNo) THEN
        EXIT;
      IF EmployeeAbsence."Employee No." <> EmployeeNo THEN BEGIN
        IF STRPOS(MessageString, Text037) = 0 THEN BEGIN
          IF MessageString <> '' THEN
            MessageString += BreakChar + BreakChar;
          MessageString += Text037;
        END;
        EXIT;
      END;

      StartDateTime := EvaluateDateTime(SchedulerEvent.StartDate());
      EndDateTime := EvaluateDateTime(SchedulerEvent.EndDate());
      FromDate := DT2DATE(StartDateTime);
      FromTime := DT2TIME(StartDateTime);
      ToDate := DT2DATE(EndDateTime);
      ToTime := DT2TIME(EndDateTime);
      IF ToTime = 000000T THEN BEGIN
        ToDate := ToDate - 1;
        ToTime := 235959T;
      END;

      EmployeeAbsence.VALIDATE("From Date", FromDate);
      EmployeeAbsence.VALIDATE("To Date", ToDate);
      EmployeeAbsence.VALIDATE("From Time", FromTime);
      EmployeeAbsence.VALIDATE("Until Time", ToTime);
      EmployeeAbsence.MODIFY;
    END;

    [External]
    PROCEDURE UpdatePlantAbsence@1100529127(SchedulerEvent@1100529101 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";PlantType@1100529102 : Code[20];PlantNo@1100529112 : Code[10];EntryNo@1100529100 : Integer;VAR MessageString@1100529110 : Text;BreakChar@1100529109 : Text);
    VAR
      PlantAbsence@1100525001 : Record 11126143;
      StartDateTime@1100529103 : DateTime;
      EndDateTime@1100529104 : DateTime;
      FromDate@1100529108 : Date;
      ToDate@1100529107 : Date;
      FromTime@1100529106 : Time;
      ToTime@1100529105 : Time;
    BEGIN
      IF NOT PlantAbsence.GET(EntryNo) THEN
        EXIT;
      IF (PlantAbsence."Plant Type" <> PlantType) OR (PlantAbsence."Plant No." <> PlantNo) THEN BEGIN
        IF STRPOS(MessageString, Text037) = 0 THEN BEGIN
          IF MessageString <> '' THEN
            MessageString += BreakChar + BreakChar;
          MessageString += Text037;
        END;
        EXIT;
      END;

      StartDateTime := EvaluateDateTime(SchedulerEvent.StartDate());
      EndDateTime := EvaluateDateTime(SchedulerEvent.EndDate());
      FromDate := DT2DATE(StartDateTime);
      FromTime := DT2TIME(StartDateTime);
      ToDate := DT2DATE(EndDateTime);
      ToTime := DT2TIME(EndDateTime);
      IF ToTime = 000000T THEN BEGIN
        ToDate := ToDate - 1;
        ToTime := 235959T;
      END;

      PlantAbsence.VALIDATE("From Date", FromDate);
      PlantAbsence.VALIDATE("To Date", ToDate);
      PlantAbsence.VALIDATE("From Time", FromTime);
      PlantAbsence.VALIDATE("Until Time", ToTime);
      PlantAbsence.MODIFY;
    END;

    [External]
    PROCEDURE ShowPlantAbsence@1100529119(PlantType@1100529100 : Code[20];PlantNo@1100529101 : Code[10];EntryNo@1100525000 : Integer);
    VAR
      PlantAbsence@1100525001 : Record 11126143;
      PlantAbsence2@1100525002 : Record 11126143;
    BEGIN
      IF NOT PlantAbsence.GET(EntryNo) THEN
        EXIT;
      IF (PlantAbsence."Plant Type" <> PlantType) OR (PlantAbsence."Plant No." <> PlantNo) THEN
        EXIT;

      PlantAbsence2.SETRANGE("Plant Type", PlantAbsence."Plant Type");
      PlantAbsence2.SETRANGE("Plant No.", PlantAbsence."Plant No.");
      PlantAbsence2.SETFILTER("From Date", '>%1', DT2DATE(CURRENTDATETIME) - 365);
      PlantAbsence2.GET(EntryNo);

      PAGE.RUNMODAL(PAGE::"Plant Absence Registration", PlantAbsence2);
    END;

    [External]
    PROCEDURE ExportEmployeeAbsence@1100525007(VAR SchedulerEvent@1100529103 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";EntryNo@1100525001 : Integer;Company@1100529104 : Text);
    VAR
      EmployeeAbsence@1100525002 : Record 5207;
      Employee@1100525004 : Record 5200;
      CauseofAbsence@1100525005 : Record 5206;
      EventType@1100529102 : Record 11124911;
      DateTimeFrom@1100529101 : DateTime;
      DateTimeTo@1100529100 : DateTime;
      FixedVariant@1100528500 : Variant;
    BEGIN
      EmployeeAbsence.CHANGECOMPANY(Company);
      CauseofAbsence.CHANGECOMPANY(Company);
      Employee.CHANGECOMPANY(Company);
      IF EmployeeAbsence.GET(EntryNo) THEN BEGIN
        SchedulerEvent.Type('ABSENCE_EVENT');
        SchedulerEvent.Identifier(FormatAbsenceNo2GRPEventNo(DATABASE::"Employee Absence", FORMAT(EntryNo)));
        Employee.GET(EmployeeAbsence."Employee No.");
        DateTimeFrom := MakeDateTimeAbsence(EmployeeAbsence."From Date", EmployeeAbsence."From Time", FALSE);
        DateTimeTo := MakeDateTimeAbsence(EmployeeAbsence."To Date", EmployeeAbsence."Until Time", TRUE);
        SchedulerEvent.Resource(Employee.GetResourceNoWithCompany(Company));
        IF CauseofAbsence.GET(EmployeeAbsence."Cause of Absence Code") THEN BEGIN
          IF CauseofAbsence."Eventtype in Resource Planning" <> '' THEN BEGIN
            SchedulerEvent.ColorType(CauseofAbsence."Eventtype in Resource Planning"); // color cause of absence
            AddFeature(SchedulerEvent, 'eventtype', FORMAT(EventType.GetDescription(CauseofAbsence."Eventtype in Resource Planning")));
          END ELSE BEGIN
            IF ResourcePlanningSetup."Event Type Absence (Default)" <> '' THEN
              SchedulerEvent.ColorType(ResourcePlanningSetup."Event Type Absence (Default)"); // color absence
            AddFeature(SchedulerEvent, 'eventtype', FORMAT(EventType.GetDescription(ResourcePlanningSetup."Event Type Absence (Default)")));
          END;
        END ELSE BEGIN
          IF ResourcePlanningSetup."Event Type Absence (Default)" <> '' THEN
            SchedulerEvent.ColorType(ResourcePlanningSetup."Event Type Absence (Default)"); // color abcense
          AddFeature(SchedulerEvent, 'eventtype', FORMAT(EventType.GetDescription(ResourcePlanningSetup."Event Type Absence (Default)")));
        END;
        SchedulerEvent.GroupIdentifier('01');
        IF Company <> COMPANYNAME THEN
          SchedulerEvent.Type('ABSENCE_EVENT_FIXED');
        IF EmployeeAbsence.Description = '' THEN
          SchedulerEvent.Text(Text031)
        ELSE
          SchedulerEvent.Text(EmployeeAbsence.Description);
        SchedulerEvent.StartDate(FormatDateTime(DateTimeFrom));
        SchedulerEvent.EndDate(FormatDateTime(DateTimeTo));
        AddFeature(SchedulerEvent, 'type', EventType2Text(DATABASE::"Employee Absence"));
        AddFeature(SchedulerEvent, 'typetext', FORMAT(Text031));
        AddFeature(SchedulerEvent, 'typeno', FORMAT(EmployeeAbsence."Cause of Absence Code"));
        AddFeature(SchedulerEvent, 'typedescription', FORMAT(EmployeeAbsence.Description));
        AddFeature(SchedulerEvent, 'sourcetype', FORMAT(EventSourceType2Text(DATABASE::"Employee Absence")));
        AddFeature(SchedulerEvent, 'durationtime', FORMAT(EmployeeAbsence.Quantity));
      END;
    END;

    [External]
    PROCEDURE ExportPlantAbsence@1100529120(VAR SchedulerEvent@1100529103 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";EntryNo@1100525001 : Integer;Company@1100529104 : Text);
    VAR
      PlantAbsence@1100525002 : Record 11126143;
      PlantNumber@1100525004 : Record 11012552;
      CauseofAbsencePlant@1100525005 : Record 11126144;
      EventType@1100529102 : Record 11124911;
      DateTimeFrom@1100529101 : DateTime;
      DateTimeTo@1100529100 : DateTime;
      FixedVariant@1100528500 : Variant;
    BEGIN
      PlantAbsence.CHANGECOMPANY(Company);
      CauseofAbsencePlant.CHANGECOMPANY(Company);
      PlantNumber.CHANGECOMPANY(Company);
      IF PlantAbsence.GET(EntryNo) THEN BEGIN
        SchedulerEvent.Type('ABSENCE_EVENT');
        SchedulerEvent.Identifier(FormatAbsenceNo2GRPEventNo(DATABASE::"Plant Absence", FORMAT(EntryNo)));
        PlantNumber.GET(PlantAbsence."Plant Type", PlantAbsence."Plant No.");
        DateTimeFrom := MakeDateTimeAbsence(PlantAbsence."From Date", PlantAbsence."From Time", FALSE);
        DateTimeTo := MakeDateTimeAbsence(PlantAbsence."To Date", PlantAbsence."Until Time", TRUE);
        SchedulerEvent.Resource(PlantNumber.GetResourceNoWithCompany(Company));
        IF CauseofAbsencePlant.GET(PlantAbsence."Cause of Absence Code") THEN BEGIN
          IF CauseofAbsencePlant."Eventtype in Resource Planning" <> '' THEN BEGIN
            SchedulerEvent.ColorType(CauseofAbsencePlant."Eventtype in Resource Planning"); // color cause of absence
            AddFeature(SchedulerEvent, 'eventtype', FORMAT(EventType.GetDescription(CauseofAbsencePlant."Eventtype in Resource Planning")));
          END ELSE BEGIN
            IF ResourcePlanningSetup."Event Type Absence (Default)" <> '' THEN
              SchedulerEvent.ColorType(ResourcePlanningSetup."Event Type Absence (Default)"); // color absence
            AddFeature(SchedulerEvent, 'eventtype', FORMAT(EventType.GetDescription(ResourcePlanningSetup."Event Type Absence (Default)")));
          END;
        END ELSE BEGIN
          IF ResourcePlanningSetup."Event Type Absence (Default)" <> '' THEN
            SchedulerEvent.ColorType(ResourcePlanningSetup."Event Type Absence (Default)"); // color abcense
          AddFeature(SchedulerEvent, 'eventtype', FORMAT(EventType.GetDescription(ResourcePlanningSetup."Event Type Absence (Default)")));
        END;
        SchedulerEvent.GroupIdentifier('02');
        IF Company <> COMPANYNAME THEN
          SchedulerEvent.Type('ABSENCE_EVENT_FIXED');
        IF PlantAbsence.Description = '' THEN
          SchedulerEvent.Text(Text031)
        ELSE
          SchedulerEvent.Text(PlantAbsence.Description);
        SchedulerEvent.StartDate(FormatDateTime(DateTimeFrom));
        SchedulerEvent.EndDate(FormatDateTime(DateTimeTo));
        AddFeature(SchedulerEvent, 'type', EventType2Text(DATABASE::"Plant Absence"));
        AddFeature(SchedulerEvent, 'typetext', FORMAT(Text031));
        AddFeature(SchedulerEvent, 'typeno', FORMAT(PlantAbsence."Cause of Absence Code"));
        AddFeature(SchedulerEvent, 'typedescription', FORMAT(PlantAbsence.Description));
        AddFeature(SchedulerEvent, 'sourcetype', EventSourceType2Text(DATABASE::"Plant Absence"));
      END;
    END;

    [External]
    PROCEDURE ExportEventsFieldService@1100528306(SchedulerEvents@1100528300 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR TextStringSucceeded@1100528305 : Text;VAR TextStringFailed@1100528304 : Text);
    VAR
      SchedulerEvent@1100528301 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
      ResourceWOP@1100528302 : Record 11229278;
      WorkOrder@1100528303 : Record 11229279;
    BEGIN
      TextStringSucceeded := '';
      TextStringFailed := '';
      FOREACH SchedulerEvent IN SchedulerEvents.Events DO BEGIN
        IF NOT ResourceWOP.GET(SchedulerEvent.Resource) THEN
          TextStringFailed += SchedulerEvent.Identifier + ', ' + Text010 + '<br>'
        ELSE BEGIN
            IF NOT WorkOrder.GET(SchedulerEvent.Identifier) THEN
              TextStringFailed += SchedulerEvent.Identifier + ', ' + Text012 + '<br>'
            ELSE BEGIN
              WorkOrder."Export to FSA" := TRUE;
              IF WorkOrder.ExportFromGRPtoFSA THEN BEGIN
                WorkOrder.MODIFY(TRUE);
                TextStringSucceeded += WorkOrder."No." + ', ' + WorkOrder.Description + '<br>';
              END ELSE BEGIN
                TextStringFailed += WorkOrder."No." + ': ' + GETLASTERRORTEXT + '<br>';
              END;
            END;
        END;
      END;
    END;

    [External]
    PROCEDURE UnplanWorkOrder@1100529107(SchedulerEvents@1100528300 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR TextStringSucceeded@1100528305 : Text;VAR TextStringFailed@1100528304 : Text);
    VAR
      SchedulerEvent@1100528301 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
      WorkOrder@1100528303 : Record 11229279;
      TmpWorkorderTable@1100529102 : TEMPORARY Record 11020579;
      StartDateTime@1100529101 : DateTime;
      EndDateTime@1100529100 : DateTime;
    BEGIN
      TextStringSucceeded := '';
      TextStringFailed := '';
      FOREACH SchedulerEvent IN SchedulerEvents.Events DO BEGIN
        IF NOT WorkOrder.GET(SchedulerEvent.Identifier) THEN
          TextStringFailed += SchedulerEvent.Identifier + ', ' + Text012 + '<br>'
        ELSE BEGIN
          IF (SchedulerEvent.IsFixed = TRUE) OR (STRPOS(SchedulerEvent.Type, 'FIXED') > 0) THEN
            TextStringFailed += SchedulerEvent.Identifier + ', ' + Text015 + '<br>'
          ELSE BEGIN
            IF SchedulerEvent.Resource <> '' THEN BEGIN
              StartDateTime := EvaluateDateTime(SchedulerEvent.StartDate());
              EndDateTime := EvaluateDateTime(SchedulerEvent.EndDate());
              IF WorkOrder."Resource Type" = WorkOrder."Resource Type"::Plant THEN
                UpdateEvent(SchedulerEvent.Identifier, '[P]_', StartDateTime, EndDateTime, TmpWorkorderTable, FALSE)
              ELSE
                UpdateEvent(SchedulerEvent.Identifier, '[D]_', StartDateTime, EndDateTime, TmpWorkorderTable, FALSE);
              TextStringSucceeded += WorkOrder."No." + ', ' + WorkOrder.Description + '<br>';
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE CreateNextWorkOrder@1100529106(SchedulerEvents@1100528300 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvents";VAR TextStringSucceeded@1100528305 : Text;VAR TextStringFailed@1100528304 : Text);
    VAR
      SchedulerEvent@1100528301 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";
      WorkOrder@1100528303 : Record 11229279;
    BEGIN
      TextStringSucceeded := '';
      TextStringFailed := '';
      FOREACH SchedulerEvent IN SchedulerEvents.Events DO BEGIN
        IF NOT WorkOrder.GET(SchedulerEvent.Identifier) THEN
          TextStringFailed += SchedulerEvent.Identifier + ', ' + Text012 + '<br>'
        ELSE BEGIN
          IF WorkOrder."Source Type" = WorkOrder."Source Type"::Request THEN
            TextStringFailed += SchedulerEvent.Identifier + ', ' + Text014 + '<br>'
          ELSE BEGIN
            IF WorkOrder.CreateNextWorkOrderGRP THEN BEGIN
              WorkOrder.CreateNextWorkOrder;
              TextStringSucceeded += WorkOrder."No." + ', ' + WorkOrder.Description + '<br>';
            END ELSE
              TextStringFailed += WorkOrder."No." + ', ' + GETLASTERRORTEXT + '<br>';
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE FillTempTables@1100525010();
    VAR
      EventType@1100525000 : Record 11124911;
      ServicePriority@1100529100 : Record 11012829;
      ReferencePoint@1100529101 : Record 11020271;
      ServiceOrderIndication@1100529102 : Record 11012837;
      DimensionValue@1100529103 : Record 349;
    BEGIN
      TempEventType.DELETEALL;
      IF EventType.FINDSET THEN BEGIN
        REPEAT
          TempEventType := EventType;
          TempEventType.INSERT;
        UNTIL EventType.NEXT = 0;
      END;
      TempServicePriority.DELETEALL;
      IF ServicePriority.FINDSET THEN BEGIN
        REPEAT
          TempServicePriority := ServicePriority;
          TempServicePriority.INSERT;
        UNTIL ServicePriority.NEXT = 0;
      END;
      TempReferencePoint.DELETEALL;
      IF ReferencePoint.FINDSET THEN BEGIN
        REPEAT
          TempReferencePoint := ReferencePoint;
          TempReferencePoint.INSERT;
        UNTIL ReferencePoint.NEXT = 0;
      END;
      TempServiceOrderIndication.DELETEALL;
      IF ServiceOrderIndication.FINDSET THEN BEGIN
        REPEAT
          TempServiceOrderIndication := ServiceOrderIndication;
          TempServiceOrderIndication.INSERT;
        UNTIL ServiceOrderIndication.NEXT = 0;
      END;
      TempDimensionValue.DELETEALL;
      IF DimensionValue.FINDSET THEN BEGIN
        REPEAT
          TempDimensionValue := DimensionValue;
          TempDimensionValue.INSERT;
        UNTIL DimensionValue.NEXT = 0;
      END;
    END;

    [TryFunction]
    LOCAL PROCEDURE CalculateEndDateTime@1100529117(ResourceNo@1100529100 : Code[20];VAR StartDateTime@1100529102 : DateTime;VAR EndDateTime@1100529103 : DateTime;VAR DurationTime@1100529104 : Decimal;PlanInWeekend@1100529170 : Boolean);
    VAR
      ResourceWOP@1100529101 : Record 11229278;
      DurationDateTime@1100529105 : Duration;
    BEGIN
      StartDateTime := ROUNDDATETIME(StartDateTime, 60000);
      EndDateTime := ROUNDDATETIME(EndDateTime, 60000);
      IF (DurationTime = 0) AND (EndDateTime > StartDateTime) THEN BEGIN
        DurationDateTime := EndDateTime - StartDateTime;
        DurationTime := ROUND(DurationDateTime / 3600000, 0.01);
      END;
      IF NOT ResourceWOP.GET(ResourceNo) THEN
        ResourceWOP.INIT;
      ResourceWOP.CalculateWorkingTimes(StartDateTime,EndDateTime,DurationTime,PlanInWeekend);
      StartDateTime := ROUNDDATETIME(StartDateTime, 60000);
      EndDateTime := ROUNDDATETIME(EndDateTime, 60000);
    END;

    [TryFunction]
    LOCAL PROCEDURE CalculateDurationTime@1100529118(ResourceNo@1100529100 : Code[20];VAR StartDateTime@1100529102 : DateTime;VAR EndDateTime@1100529103 : DateTime;VAR DurationTime@1100529104 : Decimal;PlanInWeekend@1100529170 : Boolean);
    VAR
      ResourceWOP@1100529101 : Record 11229278;
      DurationDateTime@1100529105 : Duration;
    BEGIN
      StartDateTime := ROUNDDATETIME(StartDateTime, 60000);
      EndDateTime := ROUNDDATETIME(EndDateTime, 60000);
      IF NOT ResourceWOP.GET(ResourceNo) THEN
        ResourceWOP.INIT;
      ResourceWOP.CalculateDurationTime(StartDateTime,EndDateTime,DurationTime,PlanInWeekend);
      StartDateTime := ROUNDDATETIME(StartDateTime, 60000);
      EndDateTime := ROUNDDATETIME(EndDateTime, 60000);
    END;

    LOCAL PROCEDURE ExecutePermissionPage@1100529109(PageID@1100529100 : Integer) : Boolean;
    VAR
      AccessControl@1100529101 : Record 2000000053;
      Permission@1100529102 : Record 2000000005;
    BEGIN
      AccessControl.SETRANGE("User Name", USERID);
      IF AccessControl.FINDSET THEN BEGIN
        REPEAT
          Permission.RESET;
          Permission.SETRANGE("Role ID", AccessControl."Role ID");
          Permission.SETRANGE("Object Type", Permission."Object Type"::Page);
          Permission.SETFILTER("Object ID", '%1|%2', 0, PageID);
          IF Permission.FINDFIRST THEN
            IF Permission."Execute Permission" <> Permission."Execute Permission"::" " THEN
              EXIT(TRUE);
        UNTIL AccessControl.NEXT = 0;
      END;
      EXIT(FALSE);
    END;

    LOCAL PROCEDURE WorkOrderTimeChanged@1100529132(VAR WorkOrder@1100529100 : Record 11229279;StartDateTime@1100529101 : DateTime;EndDateTime@1100529102 : DateTime;Duration@1100529103 : Decimal) : Boolean;
    BEGIN
      IF WorkOrder."Starting Date/Time" <> StartDateTime THEN
        EXIT(TRUE);
      IF WorkOrder."Ending Date/Time" <> EndDateTime THEN
        EXIT(TRUE);
      IF WorkOrder."Duration Time" <> Duration THEN
        EXIT(TRUE);
    END;

    [External]
    PROCEDURE GetResourcePhone@1100525008(SchedulerResource@1100529000 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";VAR PhoneNumber@1100525001 : Text;VAR PhoneType@1100525002 : Text) : Boolean;
    VAR
      Employee@1100529003 : Record 5200;
      ResourceWOP@1100525005 : Record 11229278;
      Vendor@1100525006 : Record 23;
      ResourceNo@1100525004 : Code[20];
      EmployeeNo@1100525000 : Code[20];
      EmployeeCompany@1100525003 : Text;
    BEGIN
      ResourceNo := SchedulerResource.Identifier;
      IF ResourceNo = '' THEN
        EXIT(FALSE);
      PhoneNumber := '';
      PhoneType := '';

      CASE SchedulerResource.Type OF
        'employee':
          BEGIN
            IF GetEmployeeFromResource(ResourceNo, FALSE, EmployeeNo, EmployeeCompany) THEN BEGIN
              Employee.CHANGECOMPANY(EmployeeCompany);
              Employee.GET(EmployeeNo);
              IF Employee."Company Phone No." <> '' THEN
                PhoneNumber := Employee."Company Phone No."
              ELSE
                IF Employee."Company Mobile Phone No." <> '' THEN
                  PhoneNumber := Employee."Company Mobile Phone No."
                ELSE
                  IF Employee."Mobile Phone No." <> '' THEN
                    PhoneNumber := Employee."Mobile Phone No.";
            END;
          END;
        'subcontractor':
          BEGIN
            ResourceWOP.GET(ResourceNo);
            Vendor.CHANGECOMPANY(ResourceWOP.Company);
            Vendor.GET(ResourceWOP."Source No.");
            IF Vendor."Phone No." <> '' THEN
              PhoneNumber := Vendor."Phone No."
            ELSE
              IF Vendor."Phone No. 2" <> '' THEN
                PhoneNumber := Vendor."Phone No. 2"
              ELSE
                IF Vendor."Mobile Phone No." <> '' THEN
                  PhoneNumber := Vendor."Mobile Phone No.";
          END;
        ELSE
          EXIT(FALSE);
      END;

      IF PhoneNumber = '' THEN
        EXIT(FALSE);
      IF STRPOS(PhoneNumber, '@') > 0 THEN
        PhoneType := 'sip:'
      ELSE
        PhoneType := 'tel:';
      EXIT(TRUE);
    END;

    [External]
    PROCEDURE GetResourceEmail@1100525011(SchedulerResource@1100525002 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerResource";VAR EmailAddress@1100525001 : Text) : Boolean;
    VAR
      Employee@1100525007 : Record 5200;
      ResourceWOP@1100525006 : Record 11229278;
      Vendor@1100525005 : Record 23;
      ResourceNo@1100525004 : Code[20];
      EmployeeNo@1100525003 : Code[20];
      EmployeeCompany@1100525000 : Text;
    BEGIN
      ResourceNo := SchedulerResource.Identifier;
      IF ResourceNo = '' THEN
        EXIT(FALSE);
      EmailAddress := '';

      CASE SchedulerResource.Type OF
        'employee':
          BEGIN
            IF GetEmployeeFromResource(ResourceNo, FALSE, EmployeeNo, EmployeeCompany) THEN BEGIN
              Employee.CHANGECOMPANY(EmployeeCompany);
              Employee.GET(EmployeeNo);
              IF Employee."Company E-Mail" <> '' THEN
                EmailAddress := Employee."Company E-Mail"
              ELSE
                IF Employee."E-Mail" <> '' THEN
                  EmailAddress := Employee."E-Mail";
            END;
          END;
        'subcontractor':
          BEGIN
            ResourceWOP.GET(ResourceNo);
            Vendor.CHANGECOMPANY(ResourceWOP.Company);
            Vendor.GET(ResourceWOP."Source No.");
            IF Vendor."E-Mail" <> '' THEN
              EmailAddress := Vendor."E-Mail";
          END;
        ELSE
          EXIT(FALSE);
      END;

      EXIT(EmailAddress <> '');
    END;

    PROCEDURE RemoveNonWorkPeriodsFromTmp@1100527650(VAR TmpResourceTable@1100527655 : TEMPORARY Record 11020579);
    VAR
      TmpPeriodsToRemove@1100527657 : TEMPORARY Record 11020579;
      TmpResourcesToRemove@1100527658 : TEMPORARY Record 11229278;
      ResourceWOP@1100527660 : Record 11229278;
      StartDateTime@1100527654 : DateTime;
      EndDateTime@1100527653 : DateTime;
      Duration@1100527652 : Decimal;
      RemoveStartDateTime@1100527651 : DateTime;
      RemoveEndDateTime@1100527650 : DateTime;
      ResourceNo@1100527656 : Code[20];
      ResourceList@1100527659 : Text;
    BEGIN
      IF TmpResourceTable.FINDSET THEN
        REPEAT
          StartDateTime := TmpResourceTable.DateTime1;
          EndDateTime := TmpResourceTable.DateTime2;
          Duration := 0;

          IF TmpResourceTable."Key Code3" <> '' THEN
            ResourceNo := TmpResourceTable."Key Code3"
          ELSE
            ResourceNo := TmpResourceTable."Key Code2";

          IF NOT CalculateDurationTime(ResourceNo, StartDateTime, EndDateTime, Duration, TmpResourceTable.Bool5) THEN BEGIN
            IF NOT TmpPeriodsToRemove.GET(FORMAT(StartDateTime), FORMAT(EndDateTime)) THEN BEGIN

              TmpPeriodsToRemove."Key Code1" := FORMAT(TmpResourceTable.DateTime1);
              TmpPeriodsToRemove."Key Code2" := FORMAT(TmpResourceTable.DateTime2);
              TmpPeriodsToRemove.DateTime1 := TmpResourceTable.DateTime1;
              TmpPeriodsToRemove.DateTime2 := TmpResourceTable.DateTime2;
              TmpPeriodsToRemove.INSERT;
            END;

            IF NOT TmpResourcesToRemove.GET(ResourceNo) THEN BEGIN
              TmpResourcesToRemove."No." := ResourceNo;
              TmpResourcesToRemove.INSERT;
            END;
          END;
        UNTIL TmpResourceTable.NEXT = 0;

      IF TmpPeriodsToRemove.FINDSET THEN
        REPEAT
          TmpResourceTable.RESET;
          TmpResourceTable.SETRANGE(DateTime1, TmpPeriodsToRemove.DateTime1);
          TmpResourceTable.SETRANGE(DateTime2, TmpPeriodsToRemove.DateTime2);
          TmpResourceTable.DELETEALL;
        UNTIL TmpPeriodsToRemove.NEXT = 0;
      TmpResourceTable.RESET;

      IF TmpResourcesToRemove.FINDSET THEN BEGIN
        REPEAT
          IF ResourceWOP.GET(TmpResourcesToRemove."No.") THEN BEGIN
            IF ResourceList = '' THEN
              ResourceList := ResourceWOP."No." + ', ' + ResourceWOP.Name
            ELSE
              ResourceList += '\' + ResourceWOP."No." + ' ' + ResourceWOP.Name;
          END;
        UNTIL TmpResourcesToRemove.NEXT = 0;
        MESSAGE(STRSUBSTNO('%1\%2\%3', Text018, Text017, ResourceList));
      END;
    END;

    LOCAL PROCEDURE AddCreateWorkorderEventCommand@1100527711(VAR SchedulerEvent@1100527700 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";WorkOrder@1100527704 : Record 11229279);
    VAR
      SchedulerPermission@1100527703 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
      CommandType@1100527702 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.CommandType";
      ReferencePoint@1100527701 : Record 11020271;
      ServiceOrder@1100527705 : Record 11012823;
    BEGIN
      ReferencePoint.SETRANGE("Triggered by Field Service", '65');
      ReferencePoint.SETRANGE(Apply, ReferencePoint.Apply::ServOrder);
      ReferencePoint.FINDFIRST;
      IF WorkOrder."Actual Reference Point" <> ReferencePoint."No." THEN
        EXIT;

      IF WorkOrder."Date/Time Export to FSA" <> 0DT THEN BEGIN
        IF WorkOrder."Source Type" = WorkOrder."Source Type"::ServiceOrder THEN BEGIN
          ServiceOrder.CHANGECOMPANY(WorkOrder."Source Company");
          ServiceOrder.GET(WorkOrder."Source No.");
        END;
        IF (NOT WorkOrder."Active in FSA") AND (ServiceOrder.Subcontractor = '') THEN
          IF NOT WorkOrder."WO Finished (Field Service)" THEN
            EXIT;
      END;
      ExportEventCommand(SchedulerEvent, 'CreateNextWorkOrder', IconCreate, TooltipCreateNextWorkorder, SchedulerPermission.Modify, CommandType.Warning, TRUE, TRUE, FALSE);
    END;

    LOCAL PROCEDURE ExportEventCommand@1100527730(VAR SchedulerEvent@1100527700 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerEvent";Identifier@1100525001 : Text;Text@1100525002 : Text;Tooltip@1100525003 : Text;Permission@1100525004 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";CommandType@1100525005 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.CommandType";MultipleSelect@1100525006 : Variant;Visible@1100525007 : Variant;Disabled@1100525008 : Variant);
    VAR
      SchedulerCommand@1100525009 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerCommand";
      SchedulerPermission@1100527701 : DotNet "'Fps.Nav.Addin.Scheduler, PublicKeyToken=024bd013665211e9'.Fps.Nav.Addin.Scheduler.SchedulerPermission";
    BEGIN
      SchedulerCommand := SchedulerCommand.SchedulerCommand();
      SchedulerCommand.Identifier(Identifier);
      SchedulerCommand.Text(Text);
      SchedulerCommand.Tooltip(Tooltip);
      SchedulerCommand.Permission(Permission);
      SchedulerCommand.Type(CommandType);
      SchedulerCommand.MultipleSelect(MultipleSelect);
      SchedulerCommand.Visible(Visible);
      SchedulerCommand.Disabled(Disabled);
      SchedulerEvent.AddCommand(SchedulerCommand);
    END;

    BEGIN
    END.
  }
}

