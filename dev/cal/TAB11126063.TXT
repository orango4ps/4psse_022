OBJECT Table 11126063 Serv.Port. User
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=VAR
               ServPortCustomerRights@1100528100 : Record 11126062;
             BEGIN
               CheckLoginCaseInsensitive();
               ServPortCustomerRights.GET("Customer No.");
               "Contract Related" := ServPortCustomerRights."Contract Related";
               "Call Succession Orders" := ServPortCustomerRights."Call Succession Orders";
               "Call Succession Calls" := ServPortCustomerRights."Call Succession Calls";
               "Additional Orders" := ServPortCustomerRights."Additional Orders";
               "Call Analysis" := ServPortCustomerRights."Call Analysis";
               "Reference Periods" := ServPortCustomerRights."Reference Periods";
               "Create Call" := ServPortCustomerRights."Create Call";
               "User Maintenance" := ServPortCustomerRights."User Maintenance";
               "Document Management" := ServPortCustomerRights."Document Management";
               "Invoice Lines" := ServPortCustomerRights."Invoice Lines";
               "Prob./Cause/Sol. Codes" := ServPortCustomerRights."Prob./Cause/Sol. Codes";
               "Export Orders" := ServPortCustomerRights."Export Orders";
               "Call Attachments" := ServPortCustomerRights."Call Attachments";
               "Confirm Maint. Appointments" := ServPortCustomerRights."Confirm Maint. Appointments";
               "Change Maint. Appointments" := ServPortCustomerRights."Change Maint. Appointments";
               "Object Management" := ServPortCustomerRights."Object Management";
               "Physical Location" := ServPortCustomerRights."Physical Location";
               "Object Specifications" := ServPortCustomerRights."Object Specifications";
               Warranty := ServPortCustomerRights.Warranty;
               "Object Structure" := ServPortCustomerRights."Object Structure";
               "Customer Tab 1" := ServPortCustomerRights."Customer Tab 1";
               "Customer Tab 2" := ServPortCustomerRights."Customer Tab 2";
               "Customer Tab 3" := ServPortCustomerRights."Customer Tab 3";
               "Customer Tab 4" := ServPortCustomerRights."Customer Tab 4";
               "Customer Tab 5" := ServPortCustomerRights."Customer Tab 5";
               "Change Requests" := ServPortCustomerRights."Change Requests";
               "Change Request Texts" := ServPortCustomerRights."Change Request Texts";
               "Change Request Impacts" := ServPortCustomerRights."Change Request Impacts";
             END;

    OnDelete=VAR
               ServPortUserFilter@1100528100 : Record 11126064;
             BEGIN
               ServPortUserFilter.SETRANGE("Customer No.", "Customer No.");
               ServPortUserFilter.SETRANGE(Login, Login);
               ServPortUserFilter.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Serv.Port. User;
               NOR=Serv.port. Bruker;
               SVE=Serv.port. anv„ndar];
  }
  FIELDS
  {
    { 10  ;   ;Customer No.        ;Code20        ;TableRelation="Serv.Port. Customer Rights";
                                                   CaptionML=[ENU=Customer No.;
                                                              NOR=Kundenr.;
                                                              SVE=Kundnr];
                                                   NotBlank=Yes }
    { 20  ;   ;Login               ;Text30        ;CaptionML=[ENU=Login;
                                                              NOR=Innlogging;
                                                              SVE=Inloggning];
                                                   NotBlank=Yes }
    { 30  ;   ;Password            ;Text32        ;CaptionML=[ENU=Password;
                                                              NOR=Passord;
                                                              SVE=L”senord] }
    { 32  ;   ;MD5 Password        ;Boolean       ;CaptionML=[ENU=MD5 Password;
                                                              NOR=MD5-Passord;
                                                              SVE=MD5-l”senord] }
    { 35  ;   ;Primary Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Contact@1001 : Record 5050;
                                                                ContactBusinessRelation@1000 : Record 5054;
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Primary Contact No." <> '' THEN BEGIN
                                                                  Contact.GET("Primary Contact No.");
                                                                  Contact.TESTFIELD(Blocked, FALSE);
                                                                  Contact.TESTFIELD(Type, Contact.Type::Person);

                                                                  ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContactBusinessRelation.SETRANGE("Link to Table", ContactBusinessRelation."Link to Table"::Customer);
                                                                  ContactBusinessRelation.SETRANGE("No.", "Customer No.");
                                                                  ContactBusinessRelation.FIND('-');

                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.CALCFIELDS("Customer Name");
                                                                  IF Contact."Company No." <> ContactBusinessRelation."Contact No." THEN
                                                                    ERROR(Text005, Contact."No.", Contact.Name, "Customer No.", ServPortCustomerRights."Customer Name");

                                                                  VALIDATE(Name, Contact.Name);
                                                                  VALIDATE("Phone No.", Contact."Phone No.");
                                                                  VALIDATE("E-Mail", Contact."E-Mail");
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              Contact@1001 : Record 5050;
                                                              ContactBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                              ContactBusinessRelation.SETRANGE("Link to Table", ContactBusinessRelation."Link to Table"::Customer);
                                                              ContactBusinessRelation.SETRANGE("No.", "Customer No.");
                                                              IF ContactBusinessRelation.FINDFIRST THEN
                                                                Contact.SETRANGE("Company No.", ContactBusinessRelation."Contact No.")
                                                              ELSE
                                                                Contact.SETRANGE("No.",'');
                                                              Contact.SETRANGE(Type, Contact.Type::Person);

                                                              IF "Primary Contact No." <> '' THEN
                                                                IF Contact.GET("Primary Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0, Contact) = ACTION::LookupOK THEN
                                                                VALIDATE("Primary Contact No.", Contact."No.");
                                                            END;

                                                   CaptionML=[ENU=Primary Contact No.;
                                                              NOR=Prim‘rt kontaktnr.;
                                                              SVE=Prim„rkontaktnr] }
    { 40  ;   ;Name                ;Text100       ;CaptionML=[ENU=Name;
                                                              NOR=Navn;
                                                              SVE=Namn] }
    { 50  ;   ;E-Mail              ;Text80        ;CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 55  ;   ;Phone No.           ;Text30        ;OnValidate=VAR
                                                                PhoneNumberFormatting@1210190000 : Codeunit 11012276;
                                                              BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber('', "Phone No.");
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              NOR=Telefonnr.;
                                                              SVE=Telefonnr] }
    { 60  ;   ;Active              ;Boolean       ;CaptionML=[ENU=Active;
                                                              NOR=Aktiv;
                                                              SVE=Aktiv] }
    { 70  ;   ;Filter Type         ;Option        ;OnValidate=VAR
                                                                ServPortUserFilter@1100528100 : Record 11126064;
                                                              BEGIN
                                                                ServPortUserFilter.SETRANGE("Customer No.", "Customer No.");
                                                                ServPortUserFilter.SETRANGE(Login, Login);
                                                                ServPortUserFilter.DELETEALL(TRUE);
                                                              END;

                                                   CaptionML=[ENU=Filter Type;
                                                              NOR=Filtertype;
                                                              SVE=Filtertyp];
                                                   OptionCaptionML=[ENU=None,Contracts,Locations;
                                                                    NOR=Ingen,Kontrakter,Lokasjoner;
                                                                    SVE=Ingen,Kontrakt,Platser];
                                                   OptionString=None,Contracts,Locations }
    { 100 ;   ;Contract Related    ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "Contract Related" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Contract Related");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Contract Related;
                                                              NOR=Kontraktrelatert;
                                                              SVE=Kontraktrelaterat] }
    { 105 ;   ;Contract Related Line Level;Boolean;CaptionML=ENU=Contract Related Line Level }
    { 110 ;   ;Call Succession Orders;Boolean     ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "Call Succession Orders" THEN BEGIN
                                                                  TESTFIELD("Call Succession Calls", FALSE);
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Call Succession Orders");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Call Succession based on Orders;
                                                              NOR=Samtalerekkef›lge basert p† ordre;
                                                              SVE=Samtalsf”ljd baserat p† order] }
    { 115 ;   ;Call Succession Calls;Boolean      ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "Call Succession Calls" THEN BEGIN
                                                                  TESTFIELD("Call Succession Orders", FALSE);
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Call Succession Calls");
                                                                END ELSE
                                                                  TESTFIELD("Block Zoom to Order from Call", FALSE);
                                                              END;

                                                   CaptionML=[ENU=Call Succession based on Calls;
                                                              NOR=Samtalerekkef›lge basert p† samtale;
                                                              SVE=Samtalsf”ljd baserat p† samtal] }
    { 117 ;   ;Reference Periods by Order;Boolean ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528101 : Record 11126062;
                                                              BEGIN
                                                                IF "Reference Periods by Order" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Reference Periods by Order");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Reference Periods by Order;
                                                              NOR=Referanseperioder etter ordre;
                                                              SVE=Referensperioder efter order] }
    { 120 ;   ;Additional Orders   ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "Additional Orders" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Additional Orders");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Additional Orders;
                                                              NOR=Tilleggsordre;
                                                              SVE=Ytterligare order] }
    { 130 ;   ;Call Analysis       ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "Call Analysis" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Call Analysis");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Call Analysis;
                                                              NOR=Samtaleanalyse;
                                                              SVE=Samtalsanalys] }
    { 140 ;   ;Reference Periods   ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528101 : Record 11126062;
                                                              BEGIN
                                                                IF "Reference Periods" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Reference Periods");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Reference Periods (Graph);
                                                              NOR=Referanseperioder (diagram);
                                                              SVE=Referensperioder (diagram)] }
    { 150 ;   ;Create Call         ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "Create Call" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Create Call");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Create Call;
                                                              NOR=Opprette Samtale;
                                                              SVE=Skapa samtal] }
    { 160 ;   ;User Maintenance    ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "User Maintenance" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("User Maintenance");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=User Maintenance;
                                                              NOR=Brukervedlikehold;
                                                              SVE=Anv„ndarunderh†ll] }
    { 170 ;   ;Document Management ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "Document Management" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Document Management");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Document Management;
                                                              NOR=Dokumenth†ndtering;
                                                              SVE=Dokumenthantering] }
    { 180 ;   ;Invoice Lines       ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1210190000 : Record 11126062;
                                                              BEGIN
                                                                IF "Invoice Lines" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Invoice Lines");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Invoice Lines;
                                                              NOR=Fakturarader;
                                                              SVE=Fakturarader] }
    { 185 ;   ;Prob./Cause/Sol. Codes;Boolean     ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Prob./Cause/Sol. Codes" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Prob./Cause/Sol. Codes");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Problem/Cause/Solution Codes }
    { 190 ;   ;Export Orders       ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1210190000 : Record 11126062;
                                                              BEGIN
                                                                IF "Export Orders" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Export Orders");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Export Orders;
                                                              NOR=Eksporter ordre;
                                                              SVE=Exportera order] }
    { 195 ;   ;Call Attachments    ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1210190000 : Record 11126062;
                                                              BEGIN
                                                                IF "Call Attachments" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Call Attachments");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Call Attachments;
                                                              NOR=Samtalevedlegg;
                                                              SVE=Samtalsbilagor] }
    { 560 ;   ;Confirm Maint. Appointments;Boolean;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Confirm Maint. Appointments" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Confirm Maint. Appointments");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Confirm Maint. Appointments;
                                                              NOR=Bekreft vedlikeholdsavtaler] }
    { 570 ;   ;Change Maint. Appointments;Boolean ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Change Maint. Appointments" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Change Maint. Appointments");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Change Maint. Appointments;
                                                              NOR=Endre vedlikeholdsavtaler] }
    { 580 ;   ;Object Management   ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF "Object Management" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Object Management");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Object Management;
                                                              NOR=Objekth†ndtering;
                                                              SVE=Objekthantering] }
    { 590 ;   ;Physical Location   ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF "Physical Location" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Physical Location");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Physical Location }
    { 600 ;   ;Object Specifications;Boolean      ;OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF "Object Specifications" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Object Specifications");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Object Specifications;
                                                              NOR=Objektspesifikasjoner;
                                                              SVE=Objektspecifikationer] }
    { 610 ;   ;Warranty            ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF Warranty THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD(Warranty);
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Warranty;
                                                              NOR=Garanti;
                                                              SVE=Garanti] }
    { 620 ;   ;Object Structure    ;Option        ;CaptionML=ENU=Object Structure;
                                                   OptionCaptionML=ENU=" ,Tender Code System 1,Tender Code System 2";
                                                   OptionString=[ ,Tender Code System 1,Tender Code System 2] }
    { 630 ;   ;Customer Tab 1      ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Customer Tab 1" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Customer Tab 1");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Customer Tab 1 }
    { 640 ;   ;Customer Tab 2      ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Customer Tab 2" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Customer Tab 2");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Customer Tab 2 }
    { 650 ;   ;Customer Tab 3      ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Customer Tab 3" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Customer Tab 3");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Customer Tab 3 }
    { 660 ;   ;Customer Tab 4      ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Customer Tab 4" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Customer Tab 4");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Customer Tab 4 }
    { 670 ;   ;Customer Tab 5      ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Customer Tab 5" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Customer Tab 5");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Customer Tab 5 }
    { 680 ;   ;Block Zoom to Order from Call;Boolean;
                                                   OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "Block Zoom to Order from Call" THEN BEGIN
                                                                  TESTFIELD("Call Succession Calls");
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Block Zoom to Order from Call");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Block Zoom to Service Order from Call }
    { 690 ;   ;No Finished Service Calls;Boolean  ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528600 : Record 11126062;
                                                              BEGIN
                                                                IF "No Finished Service Calls" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("No Finished Service Calls");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Don't show Service Calls with status Finished }
    { 700 ;   ;Change Requests     ;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF "Change Requests" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Change Requests");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Change Requests;
                                                              SVE=Žndringsbeg„ran] }
    { 710 ;   ;Change Request Texts;Boolean       ;OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF "Change Request Texts" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Change Request Texts");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Change Request Texts }
    { 720 ;   ;Change Request Impacts;Boolean     ;OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF "Change Request Impacts" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Change Request Impacts");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Change Request Impact Analysis;
                                                              SVE=Žndringsbeg„ran, Effektanalys] }
    { 730 ;   ;Change Request Communication;Boolean;
                                                   OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF "Change Request Communication" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Change Request Communication");
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Communication;
                                                              NOR=Kommunikasjon;
                                                              SVE=Kommunikation] }
    { 731 ;   ;Change Request Attachments;Boolean ;OnValidate=VAR
                                                                ServPortCustomerRights@1100525000 : Record 11126062;
                                                              BEGIN
                                                                IF "Change Request Attachments" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Change Request Attachments");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Change Request Attachments }
    { 740 ;   ;URL Link            ;Text250       ;CaptionML=ENU=URL Link;
                                                   Editable=No }
    { 750 ;   ;Create Change Request;Boolean      ;OnValidate=VAR
                                                                ServPortCustomerRights@1100528100 : Record 11126062;
                                                              BEGIN
                                                                IF "Create Change Request" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Create Change Request");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Create Change Request }
    { 760 ;   ;Communication Attachments;Boolean  ;OnValidate=VAR
                                                                ServPortCustomerRights@1100529401 : Record 11126062;
                                                              BEGIN
                                                                IF "Communication Attachments" THEN BEGIN
                                                                  ServPortCustomerRights.GET("Customer No.");
                                                                  ServPortCustomerRights.TESTFIELD("Communication Attachments");
                                                                END
                                                              END;

                                                   CaptionML=ENU=Communication Attachments }
    { 1200;   ;Tmp Password        ;Text32        ;ExtendedDatatype=Masked;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Temp. Password;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Customer No.,Login                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text003@1100528000 : TextConst 'ENU=The new password is created.';
      Text004@1100525000 : TextConst 'ENU=User %1 already exists.';
      Text005@1100528600 : TextConst 'ENU=Contact %1 %2 is not related to customer %3 %4.;NOR=Kontakten %1 %2 er ikke knyttet til kunden %3 %4.;SVE=Kontakt %1 %2 tillh”r inte kund %3 %4.';

    PROCEDURE GenerateAndMailPassword@1100528100();
    VAR
      passWordToMail@1100528100 : Text[30];
    BEGIN
      GeneratePassword(passWordToMail, Password, "MD5 Password");
      "Tmp Password" := passWordToMail;
      MODIFY;

      TESTFIELD(Login);
      TESTFIELD("E-Mail");
      MailPassword(passWordToMail, TRUE);

      //GET;
      GET("Customer No.", Login);
      "Tmp Password" := '';
      MODIFY;
    END;

    PROCEDURE ResetAndMailPassword@1100528000();
    VAR
      passWordToMail@1100528000 : Text[30];
    BEGIN
      GeneratePassword(passWordToMail, Password, "MD5 Password");
      "Tmp Password" := passWordToMail;
      MODIFY;

      TESTFIELD(Login);
      TESTFIELD("E-Mail");
      MailPassword(passWordToMail, FALSE);

      //GET;
      GET("Customer No.", Login);
      "Tmp Password" := '';
      MODIFY;
    END;

    PROCEDURE GeneratePassword@1100528101(VAR Password@1100528100 : Text[30];VAR PasswordHash@1100528101 : Text[100];VAR MD5Hash@1100528105 : Boolean);
    VAR
      StringFunctions@1100528103 : Codeunit 11012273;
    BEGIN
      StringFunctions.GeneratePasswordMD5(Password, PasswordHash, MD5Hash, PasswordLength); //#kz, 20150114
    END;

    LOCAL PROCEDURE MailPassword@1100528102(NewPassword@1100528012 : Text[30];GeneratePas@1100528000 : Boolean);
    VAR
      ServPortSetup@1100528008 : Record 11126065;
      Language@1100528007 : Record 8;
      MailTemplate@1100528006 : Record 11229450;
      MailTemplateManagement@1100528300 : Codeunit 11012622;
      SMTPMail@1100528003 : Codeunit 400;
      SubjectText@1100528301 : Text;
      BodyText@1100528002 : Text;
      SaveLanguageId@1100528001 : Integer;
      MailTemplateNo@1100528302 : Integer;
    BEGIN
      IF GeneratePas THEN
        MailTemplateNo := 53
      ELSE
        MailTemplateNo := 52;

      ServPortSetup.GET('1');
      Language.SETRANGE("Windows Language ID", WINDOWSLANGUAGE);
      Language.FINDFIRST;
      MailTemplateManagement.GetMailTemplate(MailTemplate, MailTemplateNo, '');
      MailTemplateManagement.GetLayoutTextSubstitutedSubjectAndTotalBody(MailTemplateNo, Language.Code, Rec, SubjectText, BodyText);

      SaveLanguageId := GLOBALLANGUAGE;
      GLOBALLANGUAGE(WINDOWSLANGUAGE);
      IF (NOT MailTemplate."Use Mail Template Subject Text") THEN
        SubjectText := Text003;
      GLOBALLANGUAGE(SaveLanguageId);

      SMTPMail.CreateMessage(MailTemplate."From Name", MailTemplate.From, "E-Mail", SubjectText, BodyText, MailTemplate."Mail is Html");
      SMTPMail.Send;
    END;

    LOCAL PROCEDURE PasswordLength@1100525001() : Integer;
    BEGIN
      EXIT(8);
    END;

    PROCEDURE CheckLoginCaseInsensitive@1100525002();
    VAR
      ServPortUser@1100525000 : Record 11126063;
    BEGIN
      //C008157
      ServPortUser.SETRANGE("Customer No.", "Customer No.");
      ServPortUser.SETFILTER(Login, '%1', '@' + Login);
      IF NOT ServPortUser.ISEMPTY THEN BEGIN
        ServPortUser.FINDFIRST;
        ERROR(Text004, ServPortUser.Login);
      END;
    END;

    LOCAL PROCEDURE ReplaceBackslash@1100409000(IInputString@1100409000 : Text) OutputString : Text;
    VAR
      CRLF@1100409001 : Text;
      i@1100409002 : Integer;
    BEGIN
      CRLF := '  <BR/>';
      CRLF[1] := 13;
      CRLF[2] := 10;

      FOR i := 1 TO STRLEN(IInputString) DO BEGIN
        IF IInputString[i] <> '\' THEN
          OutputString += FORMAT(IInputString[i])
        ELSE
          OutputString += CRLF;
      END;
    END;

    BEGIN
    END.
  }
}

