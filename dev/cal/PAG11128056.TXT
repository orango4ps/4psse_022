OBJECT Page 11128056 Project Control Overview
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSSE;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Project Control Overview;
               NOR=Prosjektstyring oversikt;
               SVE=Projektkontroll ”versikt];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table11072003;
    DataCaptionFields=Main Project;
    PageType=List;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Project Control;
                                NOR=Ny,Behandle,Rapport,Prosjektkontroll;
                                SVE=Ny,Behandla,Rapport,Projektkontroll];
    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 ProjectSetup.GET;
                 InventSetupRec.GET;

                 IF SetPeriodTypeDay THEN
                   PeriodType := PeriodType::Day;
                 SearchPeriodCu.FindPeriod(Rec,PeriodType,'');
                 PeriodFilter := GETFILTER("Period Filter");

                 IF ProjectSetup."Excl. marked proj. from Contrl" THEN
                   SETRANGE("Excl. from Project Control",FALSE);

                 //Set range based on permission employee
                 Permissions.CostControlReports(Rec);
                 ProjRec.COPYFILTERS(Rec);

                 //>> 190130 ORANGO.SB RFC-226
                 //IME155
                 //SETFILTER("Wage Component Type Filter",'<>%1',"Wage Component Type Filter"::"Expense hours");
                 SETFILTER("Wage Component Type Filter",'<>%1&<>%2',"Wage Component Type Filter"::"Expense hours","Wage Component Type Filter"::Addition);
                 //<<

                 //>>ITERO.GH 4PS-042 140709
                 //BuildProjControl;
                 //<<ITERO.GH 4PS-042 140709

                 //Hide sub-projects when starting program from menu; same form can be activated with button
                 //to display subprojects on mainproject (then filter set on main project)
                 IF ProjRec.GETFILTER("Main Project") = '' THEN
                   SETFILTER("Single/Main/Sub Project", '<>%1', "Single/Main/Sub Project"::"Sub Project");

                 //Speed up
                 IF ProjRec.FINDFIRST THEN
                   SETFILTER("Project Filter", ProjRec."No.");
               END;

    OnAfterGetRecord=VAR
                       FoundPrognosis@1100525000 : Boolean;
                     BEGIN
                       DetermineProductionDate.DetermineBothDates(Rec, "Single/Main/Sub Project" = "Single/Main/Sub Project"::Single);
                       DeterminePrognosisDate.DetermineBothDates(Rec);

                       FillProjectFilter(ProjFilter);
                       SETFILTER("Project Filter", ProjFilter);

                       CALCFIELDS(
                         "Open Hours", "Actual Hours", "Actuals Period", "Actual Hours Period",
                         Revenues, "Revenues Period", "Purchase Period",
                         "Extension Quoted Amount", "Options Contract Amount",
                         "Actual Preclosure Result", "Act. Preclosure Result Period",
                         "Provision Loss");

                       CostContMgt.CalcFieldsProject(Rec);

                       CostContMgt.AllowedAndPurchProject(
                         Rec,
                         AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec, PurchaseFieldsVisible,
                         PurchaseDec, EstimPurchResultDec, PurchCostDec, ActualPurchResultDec, TotPurchResultDec,TRUE);

                       TotCostDec := CostContMgt.TotCostProject(Rec,FALSE);
                       TotHoursDec := CostContMgt.TotHoursProject(Rec,FALSE);
                       ResultDec := CostContMgt.ResultProject(Rec,FALSE);
                       ResultHoursDec := CostContMgt.ResultHoursProject(Rec,FALSE);
                       PrognTotCostDec := CostContMgt.PrognTotCostProject(Rec,FALSE);
                       PrognTotHoursDec := CostContMgt.PrognTotHoursProject(Rec,FALSE);
                       AllowedPerc := CostContMgt.AllowedPercProject(Rec,FALSE);
                       ResultPerc := CostContMgt.ResultPercProject(Rec,FALSE);
                       CalculatedEndResult := CostContMgt.CalculatedEndResultProject(Rec,FALSE);
                       CalcEndResVersusBudget := CostContMgt.CalcEndResVersusBudgetProject(Rec,FALSE);
                       BudgetResultDec := CostContMgt.BudgetResultProject(Rec,FALSE);
                       BudgetResultPerc := CostContMgt.BudgetResultPercProject(Rec,FALSE);
                       PrognResultDec := CostContMgt.PrognResultProject(Rec,FALSE);
                       PrognEndResVersusContrDec := CostContMgt.PrognEndResVrsContrAmtProject(Rec,FALSE);
                       PrognEndResVersusContrPerc := CostContMgt.PrognEndResVrsContrAmtProjPerc(Rec,FALSE);
                       PrognEndResultDec := CostContMgt.PrognEndResultProject(Rec,FALSE);
                       PrognEndResultHoursDec := CostContMgt.PrognEndResultHoursProject(Rec,FALSE);
                       PrognEndResVersusBudget := CostContMgt.PrognEndResVersusBudgetProject(Rec,FALSE);
                       AvailableDec := Budget - TotCostDec;

                       //>>4PS-001
                       CALCFIELDS(Prognosis);
                       PrognosisDec := Prognosis;
                       //<<4PS-001

                       CLEAR(PrognosisRec);
                       PrognosisRec."Prognosis Level" := "Prognosis Level";
                       PrognRevenues := 0;
                       PrognTotRevenue := 0;
                       PrognFinResult := 0;
                       ExpFinishDate := 0D;

                       FoundPrognosis := FALSE;  //**4PS Call 19184
                       PrognosisRec.RESET;
                       PrognosisRec.SETRANGE("Project No.", "No.");
                       PrognosisRec.SETFILTER("Prognosis Date", GETFILTER("Cumulation Filter"));
                       IF PrognosisRec.FINDLAST THEN BEGIN
                         FoundPrognosis := TRUE;  //**4PS Call 19184
                         IF PrognosisRec."Prognosis Level" = PrognosisRec."Prognosis Level"::Rough THEN
                           PrognTotRevenue := PrognosisRec."Rough Prognosis Total Revenues"
                         ELSE BEGIN

                           //>> LAHE 130703
                           IF "Forecast Level" = "Forecast Level"::"Cost Component" THEN BEGIN
                             PrognosisRec.CALCFIELDS("Prognosis Revenue CC","Prognosis Total Revenue CC");
                             PrognRevenues := PrognosisRec."Prognosis Revenue CC";
                             PrognTotRevenue := PrognosisRec."Prognosis Total Revenue CC";
                             //>>4PS-001
                             PrognosisRec.CALCFIELDS("Prognosis Cost CC","Prognosis Surch.OH.costs CC");
                             PrognosisDec := PrognosisRec."Prognosis Cost CC" + PrognosisRec."Prognosis Surch.OH.costs CC";
                             PrognTotCostDec := PrognosisDec + TotCostDec;
                             //<<4PS-001
                           END ELSE BEGIN
                           //<< LAHE 130703

                             PrognosisRec.CALCFIELDS("Prognosis Revenue");
                             PrognRevenues := PrognosisRec."Prognosis Revenue";
                             PrognTotRevenue := PrognosisRec."Project Invoiced" + PrognosisRec."Prognosis Revenue";
                           END;
                         END;
                         ExpFinishDate := PrognosisRec."Expected Finishing Date";
                       END ELSE BEGIN
                         IF "Single/Main/Sub Project" = "Single/Main/Sub Project"::"Main Project" THEN BEGIN
                           //This part speeds up situations in which no prognoses are made
                           PrognosisSubRec.SETCURRENTKEY("Main Project No.","Prognosis Date");
                           PrognosisSubRec.SETRANGE("Main Project No.", "No.");
                           PrognosisSubRec.SETFILTER("Prognosis Date",GETFILTER("Cumulation Filter"));
                           IF NOT PrognosisSubRec.ISEMPTY THEN BEGIN
                           //
                             FoundPrognosis := TRUE;  //**4PS Call 19184
                             SubProjRec.SETCURRENTKEY("Main Project");
                             SubProjRec.SETRANGE("Main Project", "Main Project");
                             IF SubProjRec.FINDSET THEN
                               REPEAT
                                 PrognosisSubRec.RESET;
                                 PrognosisSubRec.SETRANGE("Project No.", SubProjRec."No.");
                                 PrognosisSubRec.SETFILTER("Prognosis Date", GETFILTER("Cumulation Filter"));
                                 IF PrognosisSubRec.FINDLAST THEN BEGIN
                                   IF PrognosisRec."Expected Finishing Date" > ExpFinishDate THEN
                                     ExpFinishDate := PrognosisRec."Expected Finishing Date";
                                   IF PrognosisSubRec."Prognosis Level" = "Prognosis Level"::Rough THEN
                                     PrognTotRevenue := PrognTotRevenue + PrognosisSubRec."Rough Prognosis Total Revenues"
                                   ELSE BEGIN
                                     //>> LAHE 130703
                                     IF "Forecast Level" = "Forecast Level"::"Cost Component" THEN BEGIN
                                       PrognosisSubRec.CALCFIELDS("Prognosis Revenue CC","Prognosis Total Revenue CC");
                                       PrognRevenues += PrognosisSubRec."Prognosis Revenue CC";
                                       PrognTotRevenue += PrognosisSubRec."Prognosis Total Revenue CC";
                                       //>>4PS-001
                                       PrognosisSubRec.CALCFIELDS("Prognosis Cost CC","Prognosis Surch.OH.costs CC");
                                       PrognosisDec += PrognosisSubRec."Prognosis Cost CC" + PrognosisSubRec."Prognosis Surch.OH.costs CC";
                                       PrognTotCostDec := PrognosisDec + TotCostDec;
                                       //<<4PS-001
                                     END ELSE BEGIN
                                     //<< LAHE 130703
                                       PrognosisSubRec.CALCFIELDS("Prognosis Revenue");
                                       PrognRevenues := PrognRevenues + PrognosisSubRec."Prognosis Revenue";
                                       PrognTotRevenue := PrognTotRevenue + PrognosisSubRec."Project Invoiced" + PrognosisSubRec."Prognosis Revenue";
                                     END;
                                   END;
                                 END;
                               UNTIL SubProjRec.NEXT = 0;
                           END;
                         END;
                       END;

                       IF NOT FoundPrognosis THEN     //**4PS Call 19184
                         PrognTotRevenue := Revenues; //**4PS Call 19184

                       PrognFinResult := PrognTotRevenue - PrognTotCostDec;

                       //018+++
                       BudgetTargetAmount := cuBudgetTarget.CalcProjBudgetProc(Rec,FALSE);
                       IF Budget <> 0 THEN
                         //>>IME-034
                         //BudgetTargetPerc := (BudgetTargetAmount / Budget) * 100
                         BudgetTargetPerc := (( Budget - BudgetTargetAmount ) / Budget) * 100
                         //<<IME-034
                       ELSE
                         BudgetTargetPerc := 0;

                       TotPurcCost_BudgetAmount := PurchCostDec - BudgetTargetAmount;
                       IF PurchCostDec <>0 THEN
                         //>>IME-034
                         //TotPurcCost_BudgetPerc := ( BudgetTargetAmount / PurchCostDec ) * 100
                         TotPurcCost_BudgetPerc := ( ( PurchCostDec - BudgetTargetAmount ) / PurchCostDec ) * 100
                         //<<IME-034
                       ELSE
                         TotPurcCost_BudgetPerc := 0;
                       //018---

                       IF PreviousTrigger = PreviousTrigger::GetRec THEN
                         SETFILTER("Project Filter", CurrentProjFilter);

                       PreviousTrigger := PreviousTrigger::GetRec;
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100485017;1 ;ActionGroup;
                      CaptionML=[ENU=&Project;
                                 NOR=Prosjekt;
                                 SVE=&Projekt] }
      { 1100485019;2 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort;
                                 SVE=Kort];
                      Image=EditLines;
                      OnAction=BEGIN
                                 IF NOT "Small Project" THEN BEGIN
                                   PAGE.RUNMODAL(PAGE::"Job Card",Rec);
                                 END ELSE BEGIN
                                   PAGE.RUNMODAL(PAGE::"Small Project",Rec);
                                 END;
                               END;
                                }
      { 1210190036;1 ;ActionGroup;
                      CaptionML=[ENU=&Control;
                                 NOR=&Kontroll;
                                 SVE=&Kontroll] }
      { 1100285501;2 ;Action    ;
                      Name=Build Project Control;
                      CaptionML=[ENU=Build Project Control;
                                 NOR=Beregning Prosjektkontroll;
                                 SVE=Ber„kna Projektkontroll];
                      Promoted=Yes;
                      Image=CalculateCost;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 BuildProjControl;
                               END;
                                }
      { 1100285500;2 ;Action    ;
                      CaptionML=[ENU=Project Control;
                                 NOR=Prosjektkontroll;
                                 SVE=Projektkontroll];
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ProjectRec@1100525000 : Record 11072003;
                               BEGIN
                                 OpenProjectControl;
                               END;
                                }
      { 1100285503;2 ;Action    ;
                      CaptionML=[ENU=Project Control Overview;
                                 NOR=Prosjektstyring oversikt;
                                 SVE=Projektkontroll ”versikt];
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Project@1100285500 : Record 11072003;
                               BEGIN
                                 OpenProjectControlOverview;
                               END;
                                }
      { 1210190037;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+F1;
                      CaptionML=[ENU=Cost &Type;
                                 NOR=Kost&type;
                                 SVE=Kostnads&typ];
                      Promoted=Yes;
                      Image=ValueLedger;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CLEAR(CostTypeFrm);
                                 CostTypeFrm.SetDefault(Rec);
                                 CostTypeFrm.RUN;
                               END;
                                }
      { 1210190038;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+F2;
                      CaptionML=[ENU=&Element;
                                 NOR=&Element;
                                 SVE=&Element];
                      Promoted=Yes;
                      Image=BOMVersions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CLEAR(CostElementFrm);
                                 CostElementFrm.SetDefault(Rec);
                                 CostElementFrm.RUN;
                               END;
                                }
      { 1210190039;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+F3;
                      CaptionML=[ENU=Cost&Component;
                                 NOR=Kost&komponent;
                                 SVE=Kostnads&del];
                      Promoted=Yes;
                      Image=Zones;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 JobSetup@1100525001 : Record 315;
                               BEGIN
                                 JobSetup.GET;
                                 IF NOT JobSetup."Cost Component Editable" THEN BEGIN
                                   CLEAR(CostCompFrm);
                                   CostCompFrm.SetDefault(Rec);
                                   CostCompFrm.RUN;
                                 END ELSE BEGIN
                                   CLEAR(CostCompFrmNew);
                                   CostCompFrmNew.SetDefault(Rec);
                                   CostCompFrmNew.RUN;
                                 END;
                               END;
                                }
      { 1210190022;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+F4;
                      CaptionML=[ENU=&Extension Contract;
                                 NOR=&ETA-kontrakt;
                                 SVE=&ŽTA-kontrakt];
                      Promoted=Yes;
                      Image=TransferFunds;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CLEAR(CostExtFrm);
                                 CostExtFrm.SetDefault(Rec);
                                 CostExtFrm.RUN;
                               END;
                                }
      { 1210190040;2 ;Separator  }
      { 1210190041;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+F5;
                      CaptionML=[ENU=&Sub Project;
                                 NOR=&Underprosjekt;
                                 SVE=&Underprojekt];
                      Promoted=Yes;
                      Image=Splitlines;
                      PromotedCategory=Category4;
                      OnAction=BEGIN

                                 ProjRec.RESET;
                                 //** opheffen filter uit OpenForm tbv functie berekentoegestaan;
                                 ProjRec.SETRANGE("Single/Main/Sub Project", "Single/Main/Sub Project"::"Sub Project");
                                 ProjRec.SETRANGE("Main Project", "No.");
                                 IF ProjRec.FIND('-') THEN
                                 //>>ITERO.WG 4PS-042 140711
                                   //PAGE.RUNMODAL(PAGE::"Project Control", ProjRec)
                                   PAGE.RUNMODAL(PAGE::"Project Control Overview", ProjRec)
                                 //>>ITERO.WG 4PS-042 140711
                                 ELSE
                                   MESSAGE(Text000);
                                 ProjRec.RESET;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 109     ;1   ;Action    ;
                      CaptionML=[ENU=Previous Period;
                                 NOR=Forrige periode;
                                 SVE=F”reg†ende period];
                      ToolTipML=[ENU=Previous Period;
                                 NOR=Forrige periode;
                                 SVE=F”reg†ende period];
                      Promoted=Yes;
                      Image=PreviousRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 FindPeriod('<=');
                                 PeriodTypeOnAfterValidate;
                               END;
                                }
      { 110     ;1   ;Action    ;
                      CaptionML=[ENU=Next Period;
                                 NOR=Neste periode;
                                 SVE=N„sta period];
                      ToolTipML=[ENU=Next Period;
                                 NOR=Neste periode;
                                 SVE=N„sta period];
                      Promoted=Yes;
                      Image=NextRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 FindPeriod('>=');
                                 PeriodTypeOnAfterValidate;
                               END;
                                }
      { 1210190005;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1100485000;1 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=Skriv &ut;
                                 SVE=Skriv &ut];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 lvProjRec@1100485000 : Record 11072003;
                                 PrintDoc@1100485001 : Codeunit 229;
                               BEGIN
                                 lvProjRec.COPY(Rec);
                                 lvProjRec.SETRANGE("No.","No.");
                                 lvProjRec.SETRANGE("Prognosis Filter");
                                 lvProjRec.SETRANGE("Progress Filter");
                                 lvProjRec.SETRANGE(PrevPrognosisFilter);
                                 lvProjRec.SETRANGE(PrevProgressFilter);
                                 PrintDoc.PrintProjectControl(lvProjRec);
                               END;
                                }
      { 1210190007;1 ;Action    ;
                      CaptionML=[ENU=Graph;
                                 NOR=Graf;
                                 SVE=Diagram];
                      Image=AnalysisView;
                      OnAction=BEGIN
                                 CUGraph.ProjectControl(Rec,"Ending Date");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1210190013;1;Group  ;
                Name=Projects;
                CaptionML=[ENU=Projects;
                           NOR=Prosjekt;
                           SVE=Projekt];
                GroupType=Group }

    { 1   ;2   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1100285502;3;Field  ;
                SourceExpr="Cost Control Up to Date";
                Editable=false }

    { 2   ;3   ;Field     ;
                SourceExpr="No." }

    { 4   ;3   ;Field     ;
                SourceExpr=Description }

    { 1100485007;3;Field  ;
                SourceExpr="Principal Name";
                Visible=TRUE }

    { 1000000000;3;Field  ;
                SourceExpr="Project Type";
                Visible=FALSE }

    { 6   ;3   ;Field     ;
                SourceExpr="Project Status";
                Visible=FALSE }

    { 8   ;3   ;Field     ;
                SourceExpr="Single/Main/Sub Project";
                Visible=FALSE }

    { 1100485026;3;Field  ;
                SourceExpr="Main Project";
                Visible=FALSE }

    { 10  ;3   ;Field     ;
                CaptionML=[ENU=Project Manager;
                           NOR=Prosjektleder;
                           SVE=Platschef];
                SourceExpr="Name Project Manager";
                Visible=TRUE }

    { 1210190006;3;Field  ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 12  ;3   ;Field     ;
                SourceExpr="Project Contract Amount";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              FillProjectFilter(ProjFilter);
                              ProjPrincipalRec.SETFILTER("Project No.", ProjFilter);
                              ProjPrincipalRec.SETFILTER("Main Project No.", "Main Project");
                              ProjPrincForm.SETTABLEVIEW(ProjPrincipalRec);
                              ProjPrincForm.RUN;
                            END;
                             }

    { 1210190002;3;Field  ;
                SourceExpr="Extension Quoted Amount";
                Visible=FALSE }

    { 1210190004;3;Field  ;
                SourceExpr="Extension Contract Amount";
                Visible=FALSE }

    { 1210190026;3;Field  ;
                SourceExpr="Options Contract Amount";
                Visible=FALSE }

    { 18  ;3   ;Field     ;
                CaptionML=[ENU=Contract Amount incl. Extensions and Options;
                           NOR=Kontraktsbel›p inkl. ETA og alternativer;
                           SVE=Kontraktsbelopp inkl. ŽTA och alternativ];
                SourceExpr="Project Contract Amount" + "Extension Contract Amount" + "Options Contract Amount" }

    { 20  ;3   ;Field     ;
                SourceExpr=Budget }

    { 22  ;3   ;Field     ;
                SourceExpr="Budget Hours (Entire Project)";
                Visible=FALSE }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Budgetted Result;
                           NOR=Budsjettert resultat;
                           SVE=Budgeterat resultat];
                SourceExpr=BudgetResultDec;
                Visible=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Budgetted Result %;
                           NOR=Budsjettert Resultat %;
                           SVE=Budgeterad resultatprocent];
                SourceExpr=BudgetResultPerc;
                Visible=FALSE }

    { 28  ;3   ;Field     ;
                SourceExpr="Purchase Budget";
                Visible=FALSE }

    { 1210190008;3;Field  ;
                SourceExpr=Purchase;
                Visible=FALSE }

    { 1100485005;3;Field  ;
                SourceExpr="Purchase Period";
                Visible=FALSE }

    { 1210190020;3;Field  ;
                Name=PurchaseDec;
                CaptionML=[ENU=Purchase (purchase action);
                           NOR=Innkj›p (Innkj›pshandling);
                           SVE=Ink”p (ink”ps†tg„rd)];
                SourceExpr=PurchaseDec;
                Visible=FALSE }

    { 1210190046;3;Field  ;
                SourceExpr="Open (Purchase)" }

    { 1100525001;3;Field  ;
                SourceExpr="Open Ovh. Surch. Soft (Purch.)";
                Visible=FALSE }

    { 1210190048;3;Field  ;
                CaptionML=[ENU=Received/Not Invoiced;
                           NOR=Mottatt/ikke fakturert;
                           SVE=Mottaget/inte fakturerat];
                SourceExpr="Received/Not Invoiced" }

    { 1100525003;3;Field  ;
                SourceExpr="Open Ovh. Surch. Firm (Purch.)";
                Visible=FALSE }

    { 1210190023;3;Field  ;
                SourceExpr="Received/Not Inv. Hours";
                Visible=FALSE }

    { 1100485024;3;Field  ;
                SourceExpr="Risc Coverage (Prognosis)";
                Visible=FALSE }

    { 34  ;3   ;Field     ;
                SourceExpr="Risc Coverage";
                Visible=FALSE }

    { 36  ;3   ;Field     ;
                SourceExpr="Risc Coverage Withdraw";
                Visible=FALSE }

    { 1100485020;3;Field  ;
                SourceExpr="Open (Inventory)";
                Visible=FALSE }

    { 1210190034;3;Field  ;
                SourceExpr="Open Ovh. Surch. (Inventory)";
                Visible=FALSE }

    { 1210190028;3;Field  ;
                SourceExpr="Open Amount (Hours)" }

    { 1210190030;3;Field  ;
                SourceExpr="Open Hours";
                Visible=FALSE }

    { 1210190032;3;Field  ;
                SourceExpr="Open Ovh. Surch. (Hours)";
                Visible=FALSE }

    { 1100485022;3;Field  ;
                SourceExpr="Preregistered WIP";
                Visible=FALSE;
                OnDrillDown=VAR
                              lvTmpPurchHeadRec@1100485003 : TEMPORARY Record 38;
                              lvPurchInvHeaderRec@1100485000 : Record 122;
                              lvPurchCredMemRec@1100485002 : Record 124;
                            BEGIN
                              CALCFIELDS("Preregistration WIP Account");
                              IF "Preregistration WIP Account" <> '' THEN BEGIN

                                CLEAR(lvTmpPurchHeadRec);

                                lvPurchInvHeaderRec.SETRANGE("Invoice Approved",FALSE);
                                lvPurchInvHeaderRec.SETRANGE("Job No.","No.");
                                IF lvPurchInvHeaderRec.FINDSET(FALSE,FALSE) THEN BEGIN
                                  REPEAT
                                    lvTmpPurchHeadRec.INIT;
                                    lvTmpPurchHeadRec."Document Type" := lvTmpPurchHeadRec."Document Type"::Invoice;
                                    lvTmpPurchHeadRec.TRANSFERFIELDS(lvPurchInvHeaderRec);
                                    lvPurchInvHeaderRec.CALCFIELDS(Amount,"Amount Including VAT","Amount VAT");
                                    lvTmpPurchHeadRec."Amount excl. VAT" := lvPurchInvHeaderRec.Amount;
                                    lvTmpPurchHeadRec."VAT Amount" := lvPurchInvHeaderRec."Amount VAT";
                                    lvTmpPurchHeadRec."Amount incl. VAT" := lvPurchInvHeaderRec."Amount Including VAT";
                                    lvTmpPurchHeadRec.INSERT;
                                  UNTIL lvPurchInvHeaderRec.NEXT = 0;
                                END;

                                lvPurchCredMemRec.SETRANGE("Credit Memo Approved",FALSE);
                                lvPurchCredMemRec.SETRANGE("Job No.","No.");
                                IF lvPurchCredMemRec.FINDSET(FALSE,FALSE) THEN BEGIN
                                  REPEAT
                                    lvTmpPurchHeadRec.INIT;
                                    lvTmpPurchHeadRec."Document Type" := lvTmpPurchHeadRec."Document Type"::"Credit Memo";
                                    lvTmpPurchHeadRec.TRANSFERFIELDS(lvPurchCredMemRec);
                                    lvPurchCredMemRec.CALCFIELDS(Amount,"Amount Including VAT");
                                    lvTmpPurchHeadRec."Amount excl. VAT" := lvPurchCredMemRec.Amount;
                                    lvTmpPurchHeadRec."VAT Amount" := lvPurchCredMemRec."Amount Including VAT" - lvPurchCredMemRec.Amount;
                                    lvTmpPurchHeadRec."Amount incl. VAT" := lvPurchCredMemRec."Amount Including VAT";

                                    lvTmpPurchHeadRec.INSERT;
                                  UNTIL lvPurchCredMemRec.NEXT = 0;
                                END;

                                PAGE.RUNMODAL(PAGE::"Preregistered WIP Invoices",lvTmpPurchHeadRec);
                              END;
                            END;
                             }

    { 40  ;3   ;Field     ;
                SourceExpr="Actual Costs" }

    { 1210190010;3;Field  ;
                Name=PurchCostDec;
                CaptionML=[ENU=Actual Costs (Purchase Action);
                           NOR=Reelle Kostnader (Innkj›phandling);
                           SVE=Verkliga kostnader (ink”ps†tg„rd)];
                SourceExpr=PurchCostDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 42  ;3   ;Field     ;
                SourceExpr="Actual Hours";
                Visible=FALSE }

    { 44  ;3   ;Field     ;
                CaptionML=[ENU=Total Cost;
                           NOR=Total kost;
                           SVE=Totalkostnad];
                SourceExpr=TotCostDec;
                AutoFormatType=1 }

    { 1100485003;3;Field  ;
                CaptionML=[ENU=Total hours;
                           NOR=Timer totalt;
                           SVE=Timmar totalt];
                SourceExpr=TotHoursDec }

    { 1100485001;3;Field  ;
                CaptionML=[ENU=Available;
                           NOR=Disponibelt;
                           SVE=Disponibelt];
                SourceExpr=AvailableDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 46  ;3   ;Field     ;
                SourceExpr=PrevProgressFilter;
                Visible=FALSE }

    { 48  ;3   ;Field     ;
                CaptionML=[ENU=Progress Date;
                           NOR=Fremdriftsdato;
                           SVE=F”rloppsdatum];
                SourceExpr=GETFILTER("Progress Filter");
                Visible=FALSE }

    { 50  ;3   ;Field     ;
                Name=Allowed;
                CaptionML=[ENU=Allowed;
                           NOR=Tillatt;
                           SVE=Till†ten];
                SourceExpr=AllowedDec;
                AutoFormatType=1;
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DrillDownAllowed;
                            END;
                             }

    { 52  ;3   ;Field     ;
                CaptionML=[ENU=Allowed %;
                           NOR=Tillatt prosent;
                           SVE=Till†ten procent];
                SourceExpr=AllowedPerc;
                Visible=FALSE }

    { 54  ;3   ;Field     ;
                CaptionML=[ENU=Allowed Hours;
                           NOR=Tillatte timer;
                           SVE=Till†tna timmar];
                SourceExpr=AllowedHoursDec;
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DrillDownAllowed;
                            END;
                             }

    { 1210190012;3;Field  ;
                CaptionML=[ENU=Purchase Result;
                           NOR=Innkj›psresultat;
                           SVE=Ink”psresultat];
                SourceExpr=CostContMgt.PurchResultProject(Rec,FALSE);
                AutoFormatType=1;
                Visible=FALSE }

    { 1210190014;3;Field  ;
                Name=EstimPurchResultDec;
                CaptionML=[ENU=Estimated Purchase Result;
                           NOR=Kalkulert Innkj›psresultat;
                           SVE=Kalkylerat ink”psresultat];
                SourceExpr=EstimPurchResultDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 1210190016;3;Field  ;
                Name=ActualPurchResultDec;
                CaptionML=[ENU=Actual Purchase Result;
                           NOR=Reellt Innkj›psresultat;
                           SVE=Verkligt ink”psresultat];
                SourceExpr=ActualPurchResultDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 1210190018;3;Field  ;
                Name=TotPurchResultDec;
                CaptionML=[ENU=Total Result;
                           NOR=Totalresultat;
                           SVE=Totalresultat];
                SourceExpr=TotPurchResultDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 56  ;3   ;Field     ;
                Name=Result;
                CaptionML=[ENU=Result;
                           NOR=Resultat;
                           SVE=Resultat];
                SourceExpr=ResultDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 58  ;3   ;Field     ;
                CaptionML=[ENU=Result %;
                           NOR=Resultat (%);
                           SVE=Resultat (%)];
                SourceExpr=ResultPerc;
                Visible=FALSE }

    { 60  ;3   ;Field     ;
                CaptionML=[ENU=Hours Result;
                           NOR=Timer (resultat);
                           SVE=Timmar (resultat)];
                SourceExpr=ResultHoursDec;
                Visible=FALSE }

    { 62  ;3   ;Field     ;
                CaptionML=[ENU=Calculated End Result;
                           NOR=Beregnet sluttresultat;
                           SVE=Ber„knat slutresultat];
                SourceExpr=CalculatedEndResult;
                AutoFormatType=1;
                Visible=FALSE }

    { 64  ;3   ;Field     ;
                CaptionML=[ENU=Calculated End Result %;
                           NOR=Beregnet sluttresultatsprosent;
                           SVE=Ber„knad slutresultatsprocent];
                SourceExpr=CalcEndResVersusBudget;
                Visible=FALSE }

    { 76  ;3   ;Field     ;
                SourceExpr=Revenues }

    { 1100525014;3;Field  ;
                CaptionML=[ENU=WIP Position;
                           NOR=Arbeidskapital, posisjon;
                           SVE=P†g†ende arbeten, position];
                SourceExpr=("Actual Costs" + "Closed Costs") - ( Revenues - "Closed Revenues" ) }

    { 1100485009;3;Field  ;
                CaptionML=[ENU=Prognosis Date;
                           NOR=Prognosedato;
                           SVE=Prognosdatum];
                SourceExpr=GETFILTER("Prognosis Filter");
                Visible=TRUE }

    { 66  ;3   ;Field     ;
                CaptionML=[ENU=Prognosis Costs;
                           NOR=Kostprognose;
                           SVE=Prognos †terst†ende kostnader];
                SourceExpr=PrognosisDec;
                Visible=FALSE;
                DrillDownPageID=Prognosis Detailed CC;
                OnDrillDown=VAR
                              Prognosis@1100285000 : Record 11012034;
                            BEGIN
                              //>>ENH-011
                              //moved below code to table

                              //4PS-018
                              // In case of prognosis level in table 11072003 is "detailed" and  forecast level in table 11072003 is "cost component"
                              // the drill down should be based on the table Prognosis Line CC (11128270) and the prognosis date as shown in the Project
                              // Control.  After the drill down it should be possible to select a prognosis line and start the page Prognosis Detailed CC (11128278)

                              Prognosis.RESET();
                              Prognosis.SETRANGE("Project No.","No.");
                              Prognosis.SETFILTER("Prognosis Date",GETFILTER("Prognosis Filter"));

                              //CASE "Prognosis Level" OF
                              //  "Prognosis Level"::Rough:   PAGE.RUN(PAGE::"Prognosis Rough", Prognosis);
                              //  "Prognosis Level"::Element: PAGE.RUN(PAGE::"Prognosis per Element", Prognosis);
                              //  ELSE
                                  IF ("Forecast Level" = "Forecast Level"::"Cost Component") THEN
                                    PAGE.RUN(PAGE::"Prognosis Detailed CC",Prognosis)
                                  ELSE
                                   PAGE.RUN(PAGE::Prognosis, Prognosis);
                              //END;


                              //In case the prognose level is detailed and forecast level is <> cost component the drill down should be based on the table Prognosis
                              //Line (11012035). In this situation use the flow field "Prognosis" of table 11072003.

                              //OpenPrognosisCardList;
                              //<<ENH-011
                            END;
                             }

    { 1100485013;3;Field  ;
                SourceExpr="Hours Prognosis";
                Visible=FALSE }

    { 1100485015;3;Field  ;
                CaptionML=[ENU=Prognosis Total Hours;
                           NOR=Prognose for timer totalt;
                           SVE=Prognos f”r timmar totalt];
                SourceExpr=PrognTotHoursDec;
                Visible=FALSE }

    { 70  ;3   ;Field     ;
                CaptionML=[ENU=Prognosis End Result;
                           NOR=Forventet Sluttresultat;
                           SVE=F”rv„ntat \slutresultat];
                SourceExpr=PrognEndResultDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 1100485011;3;Field  ;
                CaptionML=[ENU=Prognosis End Result Hours;
                           NOR=Prognose for sluttresultat, timer;
                           SVE=Prognos f”r slutresultat, timmar];
                SourceExpr=PrognEndResultHoursDec;
                Visible=FALSE }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Prognosis End Result %;
                           NOR=Prognose for sluttresultatsprosent;
                           SVE=Prognos f”r slutresultatsprocent];
                SourceExpr=PrognEndResVersusBudget;
                Visible=FALSE }

    { 74  ;3   ;Field     ;
                CaptionML=[ENU=Prognosis Result;
                           NOR=Prognoseresultat;
                           SVE=Prognosresultat];
                SourceExpr=PrognResultDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 78  ;3   ;Field     ;
                CaptionML=[ENU=Gross WIP Position;
                           NOR=Bruttoposisjon for arbeidskapital;
                           SVE=Bruttoposition f”r p†g†ende arbeten];
                SourceExpr="Actual Costs" - Revenues;
                AutoFormatType=1;
                Visible=FALSE }

    { 1100525004;3;Field  ;
                CaptionML=[ENU=Closed Costs;
                           NOR=Opparbeidede koster;
                           SVE=Upparbetade kostnader];
                SourceExpr=-"Closed Costs";
                Visible=FALSE }

    { 1100525016;3;Field  ;
                SourceExpr="Closed Revenues";
                Visible=FALSE }

    { 80  ;3   ;Field     ;
                CaptionML=[ENU=Expected End Result Against Contract Price;
                           NOR=Forventet sluttresultat mot kontraktspris;
                           SVE=F”rv„ntat slutresultat mot kontraktspris];
                SourceExpr=PrognEndResVersusContrDec;
                AutoFormatType=1;
                Visible=FALSE }

    { 82  ;3   ;Field     ;
                CaptionML=[ENU=Expected End Result against Contract Price %;
                           NOR=Forventet sluttresultat mot kontraktspris %;
                           SVE=F”rv„ntat slutresultat mot kontraktsprisprocent];
                SourceExpr=PrognEndResVersusContrPerc;
                Visible=FALSE }

    { 84  ;3   ;Field     ;
                SourceExpr="Actuals Period";
                Visible=FALSE }

    { 86  ;3   ;Field     ;
                SourceExpr="Actual Hours Period";
                Visible=FALSE }

    { 88  ;3   ;Field     ;
                CaptionML=[ENU=Allowed Period;
                           NOR=Tillatt, periodee;
                           SVE=Till†ten, period];
                SourceExpr=AllowedDec-PrevAllowedDec;
                AutoFormatType=1;
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DrillDownAllowed;
                            END;
                             }

    { 90  ;3   ;Field     ;
                CaptionML=[ENU=Allowed Hours Period;
                           NOR=Tillatte timer, periode;
                           SVE=Till†tna timmar, period];
                SourceExpr=AllowedHoursDec-PrevAllowedHoursDec;
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DrillDownAllowed;
                            END;
                             }

    { 92  ;3   ;Field     ;
                CaptionML=[ENU=Result Period;
                           NOR=Resultatperiode;
                           SVE=Resultatperiod];
                SourceExpr=AllowedDec - PrevAllowedDec - "Actuals Period";
                AutoFormatType=1;
                Visible=FALSE }

    { 94  ;3   ;Field     ;
                CaptionML=[ENU=Period Hour Result;
                           NOR=Resultat, timeperiode;
                           SVE=Resultat, timperiod];
                SourceExpr=AllowedHoursDec - PrevAllowedHoursDec - "Actual Hours Period";
                Visible=FALSE }

    { 96  ;3   ;Field     ;
                SourceExpr="Revenues Period";
                AutoFormatType=1;
                Visible=FALSE }

    { 1210190024;3;Field  ;
                Name=ProjInventAmt;
                CaptionML=[ENU=Project Inventory;
                           NOR=Prosjektlager;
                           SVE=Projektlager];
                SourceExpr=GetProjInventAmt();
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ProjInventRec.RESET;
                              ProjInventRec.SETCURRENTKEY("Project No.");
                              ProjInventRec.SETRANGE("Project No.", "No.");
                              ProjInventRec.SETFILTER("Posting Date", GETFILTER("Cumulation Filter"));
                              PAGE.RUNMODAL(PAGE::"Project Inventory Entries", ProjInventRec);
                            END;
                             }

    { 1210190042;3;Field  ;
                SourceExpr="Actual Preclosure Result";
                AutoFormatType=1;
                Visible=FALSE;
                OnDrillDown=VAR
                              lJobLedgerEntryRec@1100485000 : Record 11072005;
                            BEGIN
                              lJobLedgerEntryRec.SETCURRENTKEY("Main Project No.","Job No.","Document No.","Posting Date");
                              lJobLedgerEntryRec.SETRANGE("Main Project No.","Main Project");
                              lJobLedgerEntryRec.SETRANGE("Job No.",GETFILTER("Project Filter"));
                              lJobLedgerEntryRec.SETRANGE("Entry Type",lJobLedgerEntryRec."Entry Type"::Usage);
                              lJobLedgerEntryRec.SETFILTER("Posting Date",GETFILTER("Cumulation Filter"));
                              lJobLedgerEntryRec.SETFILTER("Actual Preclosure Result", '<> 0');
                              PAGE.RUN(11012074, lJobLedgerEntryRec);
                            END;
                             }

    { 1210190044;3;Field  ;
                SourceExpr="Act. Preclosure Result Period";
                Visible=FALSE;
                OnDrillDown=VAR
                              lJobLedgerEntryRec@1100485000 : Record 11072005;
                            BEGIN
                              lJobLedgerEntryRec.SETCURRENTKEY("Main Project No.","Job No.","Document No.","Posting Date");
                              lJobLedgerEntryRec.SETRANGE("Main Project No.","Main Project");
                              lJobLedgerEntryRec.SETRANGE("Job No.",GETFILTER("Project Filter"));
                              lJobLedgerEntryRec.SETRANGE("Entry Type",lJobLedgerEntryRec."Entry Type"::Usage);
                              lJobLedgerEntryRec.SETFILTER("Posting Date",GETFILTER("Period Filter"));
                              lJobLedgerEntryRec.SETFILTER("Actual Preclosure Result", '<> 0');
                              PAGE.RUN(PAGE::"Project Ledger (Compressed)", lJobLedgerEntryRec);
                            END;
                             }

    { 1100525000;3;Field  ;
                SourceExpr="Provision Loss";
                Visible=FALSE }

    { 1100525002;3;Field  ;
                CaptionML=[ENU=Prognosis Level;
                           NOR=Prognoseniv†;
                           SVE=Prognosniv†];
                OptionCaptionML=[ENU=Detailed,,Rough;
                                 NOR=Detaljert,,Grov;
                                 SVE=Detaljerad,,Grov];
                SourceExpr=PrognosisRec."Prognosis Level";
                Visible=FALSE }

    { 1100525006;3;Field  ;
                CaptionML=[ENU=Prognosis Revenue;
                           NOR=Prognostiserte inntekter;
                           SVE=Prognos int„kter];
                SourceExpr=PrognRevenues;
                AutoFormatType=1;
                Visible=FALSE }

    { 1100525008;3;Field  ;
                CaptionML=[ENU=Prognosis Total Revenue;
                           NOR=Prognose totalresultat;
                           SVE=Prognos totala int„kter];
                SourceExpr=PrognTotRevenue;
                AutoFormatType=1 }

    { 1100525010;3;Field  ;
                CaptionML=[ENU=Prognosis Total Cost;
                           NOR=Prognose Totalkost;
                           SVE=Prognos totala kostnader];
                SourceExpr=PrognTotCostDec;
                AutoFormatType=1 }

    { 1100525012;3;Field  ;
                CaptionML=[ENU=Prognosis Financial Result;
                           NOR=Resultatprognose, finans;
                           SVE=Prognos finansiellt resultat];
                SourceExpr=PrognFinResult;
                AutoFormatType=1 }

    { 1100525018;3;Field  ;
                CaptionML=[ENU=Expected Finishing Date;
                           NOR=Forventet Ferdigdato;
                           SVE=F”rv„ntat f„rdigdatum];
                SourceExpr=ExpFinishDate;
                Visible=FALSE }

    { 1100285000;3;Field  ;
                Name=BudgetTargetAmount;
                CaptionML=[ENU=Procurement target amount;
                           NOR=Anskaffelsessm†l bel›p;
                           SVE=Upphandlingsm†l belopp];
                SourceExpr=BudgetTargetAmount;
                Visible=False;
                Editable=False }

    { 1100285001;3;Field  ;
                Name=BudgetTargetPerc;
                CaptionML=[ENU=Procurement target percentage;
                           NOR=Anskaffelsessm†l prosent;
                           SVE=Upphandlingsm†l procent];
                SourceExpr=BudgetTargetPerc;
                Visible=False;
                Editable=False }

    { 1100285002;3;Field  ;
                Name=TotPurcCost_BudgetAmount;
                CaptionML=[ENU=Actual Costs (Purchase Action) - Target;
                           NOR=Reelle kostnader (Innkj›p) - M†l;
                           SVE=Verkliga kostnader (Ink”p) - M†l];
                SourceExpr=TotPurcCost_BudgetAmount;
                Visible=False;
                Editable=False }

    { 1100285003;3;Field  ;
                Name=TotPurcCost_BudgetPerc;
                CaptionML=[ENU=Actual Costs % (Purchase Action) - Target;
                           NOR=Reelle Kostnader % (Innkj›pshandling) - M†l;
                           SVE=Verkliga kostnader % (Ink”p) - M†l];
                SourceExpr=TotPurcCost_BudgetPerc;
                Visible=False;
                Editable=False }

    { 1100285100;3;Field  ;
                SourceExpr="Invoiced (ready)";
                Visible=FALSE }

    { 1100528602;1;Group  ;
                CaptionML=[ENU=Options;
                           NOR=Alternativer;
                           SVE=Alternativ] }

    { 1100528601;2;Field  ;
                CaptionML=[ENU=View by;
                           NOR=Vis per;
                           SVE=Visa per];
                OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                 NOR=Dag,Uke,M†ned,Kvartal,r,bokf›ringsperiode;
                                 SVE=Dag,Vecka,M†nad,Kvartal,r,Bokf”ringsperiod];
                SourceExpr=PeriodType;
                OnValidate=BEGIN
                             FindPeriod('');
                             PeriodTypeOnAfterValidate;
                           END;
                            }

    { 1100528600;2;Field  ;
                CaptionML=[ENU=Date Filter;
                           NOR=Dato filter;
                           SVE=Datumfilter];
                SourceExpr=PeriodFilter;
                OnValidate=VAR
                             TextManagement@1001 : Codeunit 41;
                           BEGIN
                             IF TextManagement.MakeDateFilter(PeriodFilter) = 0 THEN;
                             SETFILTER("Period Filter", PeriodFilter);
                             PeriodFilter := GETFILTER("Period Filter");

                             PeriodFilterOnAfterValidate;
                           END;
                            }

  }
  CODE
  {
    VAR
      Text000@11012038 : TextConst 'ENU=For this Project are no Sub Projects;NOR=Det finnes ingen underprosjekter for dette prosjektet;SVE=Det finns inga underprojekt f”r det h„r projektet';
      ProjectSetup@11012001 : Record 315;
      ProgressRec@11012004 : Record 11012037;
      PrognosisRec@1100525000 : Record 11012034;
      PrognosisSubRec@1100525002 : Record 11012034;
      PrognosisLineRec@11012006 : Record 11012035;
      ProjRec@11012005 : Record 11072003;
      SubProjRec@1100525003 : Record 11072003;
      ProjPrincipalRec@1000000000 : Record 11012005;
      InventSetupRec@1210190009 : Record 313;
      ProjInventRec@1210190004 : Record 11012670;
      ProgressForm@11012010 : Page 11012080;
      PrognosisForm@11012012 : Page 11012088;
      ProjPrincForm@1000000001 : Page 11012016;
      CostCompFrm@1210190010 : Page 11020207;
      CostCompFrmNew@1100485007 : Page 11020347;
      CostTypeFrm@1210190011 : Page 11012094;
      CostElementFrm@1210190018 : Page 11012096;
      CostExtFrm@1210190019 : Page 11020236;
      SearchPeriodCu@11012014 : Codeunit 11012013;
      DetermineProductionDate@11012016 : Codeunit 11012014;
      DeterminePrognosisDate@11012017 : Codeunit 11012029;
      CUGraph@11012018 : Codeunit 11012019;
      Permissions@11012019 : Codeunit 11012026;
      CostContMgt@1210190012 : Codeunit 11012006;
      ProjFilter@11012020 : Text[250];
      CurrentProjFilter@1100485004 : Text[250];
      PeriodFilter@1210190021 : Text[30];
      PeriodType@1210190020 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      AllowedPerc@11012022 : Decimal;
      ResultPerc@11012023 : Decimal;
      CalculatedEndResult@11012024 : Decimal;
      CalcEndResVersusBudget@11012025 : Decimal;
      PrognEndResVersusBudget@11012026 : Decimal;
      BudgetResultDec@1210190001 : Decimal;
      BudgetResultPerc@11012027 : Decimal;
      TotCostDec@11012031 : Decimal;
      TotHoursDec@1100485001 : Decimal;
      AllowedDec@11012032 : Decimal;
      AllowedHoursDec@11012033 : Decimal;
      PrevAllowedDec@11012034 : Decimal;
      PrevAllowedHoursDec@11012035 : Decimal;
      PrognEndResultDec@1210190000 : Decimal;
      PrognEndResultHoursDec@1100485005 : Decimal;
      PurchaseDec@1210190003 : Decimal;
      EstimPurchResultDec@1210190002 : Decimal;
      PurchCostDec@1210190007 : Decimal;
      ActualPurchResultDec@1210190006 : Decimal;
      TotPurchResultDec@1210190005 : Decimal;
      ProjInventAmt@1210190008 : Decimal;
      ResultDec@1210190013 : Decimal;
      ResultHoursDec@1100485002 : Decimal;
      PrognTotCostDec@1210190014 : Decimal;
      PrognTotHoursDec@1100485003 : Decimal;
      PrognResultDec@1210190017 : Decimal;
      PrognEndResVersusContrDec@1210190015 : Decimal;
      PrognEndResVersusContrPerc@1210190016 : Decimal;
      PreviousTrigger@11012036 : ',GetRec,GetCurr';
      AvailableDec@1100485000 : Decimal;
      DepAuthRec@1100000997 : Record 11012466;
      GeneratedtTxtConst1@1100000998 : TextConst 'ENU=You are not authorized for Department Code %1.;NOR=Du har ikke tillatelse til avdelingskode %1.;SVE=Du har inte beh”righet f”r avdelningskod %1.';
      PrognRevenues@1100525005 : Decimal;
      PrognTotRevenue@1100525006 : Decimal;
      PrognFinResult@1100525001 : Decimal;
      ExpFinishDate@1100525007 : Date;
      SetPeriodTypeDay@1100525004 : Boolean;
      DPA_IsHardFilter@1100000999 : Boolean;
      "***018"@1100285002 : Integer;
      BudgetTargetPerc@1100285001 : Decimal;
      TotPurcCost_BudgetAmount@1100285004 : Decimal;
      TotPurcCost_BudgetPerc@1100285005 : Decimal;
      BudgetTargetAmount@1100285003 : Decimal;
      cuBudgetTarget@1100285000 : Codeunit 11012244;
      BudgetLinePurchGoalrec@1100285006 : Record 11128042;
      PrognosisDec@1100285007 : Decimal;

    PROCEDURE DrillDownAllowed@1();
    BEGIN
      FillProjectFilter(ProjFilter);
      DetermineProductionDate.DetermineDate(Rec, "Single/Main/Sub Project" = "Single/Main/Sub Project"::Single);
      ProgressRec.SETRANGE("Main Project No.", "Main Project");
      COPYFILTER("Project Filter", ProgressRec."Project No.");
      ProgressRec.SETFILTER("Progress Date", GETFILTER("Progress Filter"));
      ProgressForm.SETTABLEVIEW(ProgressRec);
      ProgressForm.RUN;
    END;

    PROCEDURE DrillDownPrognAllowed@2();
    BEGIN
      FillProjectFilter(ProjFilter);
      DeterminePrognosisDate.DetermineDate(Rec);
      PrognosisLineRec.RESET;
      PrognosisLineRec.SETRANGE("Main Project No.", "Main Project");
      COPYFILTER("Project Filter", PrognosisLineRec."Project No.");
      PrognosisLineRec.SETFILTER("Prognosis Date", GETFILTER("Prognosis Filter"));
      PrognosisForm.SETTABLEVIEW(PrognosisLineRec);
      PrognosisForm.RUN;
    END;

    PROCEDURE PurchaseFieldsVisible@1210190000() : Boolean;
    BEGIN
      EXIT(TRUE);
    END;

    PROCEDURE Setfilter@1100485000(lProjCde@1210190000 : Code[20]);
    BEGIN
      FILTERGROUP(2);
      SETRANGE("No.",lProjCde);
      FILTERGROUP(0);
    END;

    PROCEDURE SetPeriodTypetoDay@1100525000();
    BEGIN
      SetPeriodTypeDay := TRUE;
    END;

    PROCEDURE BuildProjControl@1100525005();
    VAR
      BuildProjectControl@1100525000 : Codeunit 11020224;
      lvJob@1100525001 : Record 11072003;
    BEGIN
      lvJob.SETRANGE("No.", "No.");
      //BuildProjectControl.BuildProjectControl(Rec);
      BuildProjectControl.BuildProjectControl(lvJob);
      CLEAR(lvJob);
    END;

    PROCEDURE GetProjInventAmt@1100525001() : Decimal;
    BEGIN
      ProjInventAmt := 0;
      IF InventSetupRec.JobInventoryByLocationShelf("No.") OR InventSetupRec.JobInventoryByStockRelease("No.") THEN
        ProjInventAmt := CostContMgt.InventoryProject(Rec,FALSE);
      EXIT(ProjInventAmt);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SETFILTER("Project Filter", ProjFilter);

      CurrentProjFilter := ProjFilter;
      PreviousTrigger := PreviousTrigger::GetCurr;
    END;

    LOCAL PROCEDURE PeriodTypeOnAfterValidate@19012979();
    BEGIN
      PeriodFilter := GETFILTER("Period Filter");
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PeriodFilterOnAfterValidate@1210190002();
    BEGIN
      SETFILTER("Cumulation Filter", '..%1', GETRANGEMAX("Period Filter"));
      CurrPage.UPDATE;
    END;

    PROCEDURE FindPeriod@1210190001(SearchString@1210190000 : Text[3]);
    BEGIN
      SearchPeriodCu.FindPeriod(Rec,PeriodType,SearchString);
    END;

    BEGIN
    {
      IMSE-005  LAHE 130703 Revenue Cost Comp

      //018+++     Purchase Goals
      //>>IME-034  Change Purchase Goals Calculation
      4PSSE, 140128, ENH-011#1, translations
      4PSSE, 140128, ENH-011#4, start prognosis based on prog.level + forc.level

      Copy of page Project Control with less columns
      ITERO.GH 4PS-042 140709 No BuildProjControl in OnOpenPage - is now action on Page
      ITERO.WG 4PS-042 140711 Changed action 'Sub Project' added action 'Project Control Overview'
      140815 ITERO.DL IME155 exclude "Component Type"::'expense hours' from "Open Amount (Hours)", "Open Ovh. Surch. (Hours)", "Open Hours"
      140413 ITERO.DL RFC106 add field  "Invoiced (ready)"
      190130 ORANGO.SB RFC-226 Added "Addition" in Wage Component Type Filter
    }
    END.
  }
}

