OBJECT Page 681 Report Inbox Part
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW113.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Report Inbox;
               NOR=Rapportinnboks;
               SVE=Rapportinkorgen];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table477;
    SourceTableView=SORTING(User ID,Created Date-Time)
                    ORDER(Descending);
    PageType=ListPart;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 SETRANGE("User ID",USERID);
                 SETAUTOCALCFIELDS;
                 ShowAll := TRUE;
                 UpdateVisibility;
                 AddInReady := FALSE;
               END;

    OnFindRecord=BEGIN
                   ActionsEnabled := NOT ISEMPTY;
                   EXIT(FIND(Which));
                 END;

    OnQueryClosePage=BEGIN
                       IF AddInReady THEN
                         CurrPage.PingPong.Stop;
                       EXIT(TRUE);
                     END;

    ActionList=ACTIONS
    {
      { 7       ;    ;ActionContainer;
                      CaptionML=[ENU=Report;
                                 NOR=Rapport;
                                 SVE=Rapport];
                      ActionContainerType=ActionItems }
      { 8       ;1   ;Action    ;
                      Name=Show;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Show;
                                 NOR=Vis;
                                 SVE=Visa];
                      ToolTipML=[ENU=Open your report inbox.;
                                 NOR=èpne rapportinnboksen.;
                                 SVE=ôppna din rapportinkorg.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=ActionsEnabled;
                      Image=Report;
                      OnAction=BEGIN
                                 ShowReport;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 11      ;1   ;Separator  }
      { 12      ;1   ;Action    ;
                      Name=Unread;
                      CaptionML=[ENU=Unread Reports;
                                 NOR=Uleste rapporter;
                                 SVE=OlÑsta rapporter];
                      ToolTipML=[ENU=Show only unread reports in your inbox.;
                                 NOR=Vis bare uleste rapporter i innboksen.;
                                 SVE=Visa endast olÑsta rapporter i din inkorg.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=ShowAll;
                      Image=FilterLines;
                      OnAction=BEGIN
                                 ShowAll := FALSE;
                                 UpdateVisibility;
                               END;
                                }
      { 13      ;1   ;Action    ;
                      Name=All;
                      CaptionML=[ENU=All Reports;
                                 NOR=Alle rapporter;
                                 SVE=Alla rapporter];
                      ToolTipML=[ENU=View all reports in your inbox.;
                                 NOR=Vis alle rapporter i innboksen.;
                                 SVE=Visa alla rapporter i din inkorg.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT ShowAll;
                      Image=AllLines;
                      OnAction=BEGIN
                                 ShowAll := TRUE;
                                 UpdateVisibility;
                               END;
                                }
      { 14      ;1   ;Separator  }
      { 9       ;1   ;Action    ;
                      Name=Delete;
                      CaptionML=[ENU=Delete;
                                 NOR=Slett;
                                 SVE=Ta bort];
                      ToolTipML=[ENU=Delete the record.;
                                 NOR=Slett posten.;
                                 SVE=Ta bort transaktionen.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=ActionsEnabled;
                      Image=Delete;
                      OnAction=VAR
                                 ReportInbox@1000 : Record 477;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(ReportInbox);
                                 ReportInbox.DELETEALL;
                                 UpdateVisibility;
                               END;
                                }
      { 18      ;1   ;Separator  }
      { 19      ;1   ;Action    ;
                      Name=ShowQueue;
                      CaptionML=[ENU=Show Queue;
                                 NOR=Vis kõ;
                                 SVE=Visa kî];
                      ToolTipML=[ENU=Show scheduled reports.;
                                 NOR=Vis planlagte rapporten.;
                                 SVE=Visa schemalagda rapporter.];
                      ApplicationArea=#Basic,#Suite;
                      Image=List;
                      OnAction=VAR
                                 JobQueueEntry@1000 : Record 472;
                               BEGIN
                                 JobQueueEntry.FILTERGROUP(2);
                                 JobQueueEntry.SETRANGE("User ID",USERID);
                                 JobQueueEntry.FILTERGROUP(0);
                                 PAGE.RUN(PAGE::"Job Queue Entries",JobQueueEntry);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who posted the entry, to be used, for example, in the change log.;
                           NOR=Angir ID-en for brukeren som bokfõrte posten, som for eksempel skal brukes i endringsloggen.;
                           SVE=Anger ID:t fîr anvÑndaren som bokfîrde transaktionen, som ska anvÑndas i till exempel Ñndringsloggen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="User ID";
                Visible=false;
                Style=Strong;
                StyleExpr=NOT Read }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date and time that the scheduled report was processed from the job queue.;
                           NOR=Angir datoen og klokkeslettet da den planlagte rapporten ble behandlet fra prosjektkõen.;
                           SVE=Anger datum och tidpunkt dÜ den schemalagda rapporten behandlades i jobbkîn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Created Date-Time";
                Style=Strong;
                StyleExpr=NOT Read }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the object ID of the report.;
                           NOR=Angir rapportens objekt-ID.;
                           SVE=Anger rapportens objekt-ID.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Report ID";
                Visible=false;
                Style=Strong;
                StyleExpr=NOT Read }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the report.;
                           NOR=Angir navnet pÜ rapporten.;
                           SVE=Anger rapportens namn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Report Name";
                Visible=FALSE;
                Style=Strong;
                StyleExpr=NOT Read;
                OnDrillDown=BEGIN
                              ShowReport;
                              CurrPage.UPDATE;
                            END;
                             }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the scheduled report that was processed from the job queue.;
                           NOR=Angir beskrivelsen av den planlagte rapporten som ble behandlet fra prosjektkõen.;
                           SVE=Anger beskrivningen pÜ den schemalagda rapporten som behandlades i jobbkîn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                Style=Strong;
                StyleExpr=NOT Read;
                OnDrillDown=BEGIN
                              ShowReport;
                              CurrPage.UPDATE;
                            END;
                             }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the output type of the scheduled report.;
                           NOR=Angir utdatatypen for den planlagte rapporten.;
                           SVE=Anger den schemalagda rapportkîrningens utdatatyp.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Output Type";
                Style=Strong;
                StyleExpr=NOT Read }

    { 16  ;1   ;Group     ;
                GroupType=Group }

    { 17  ;2   ;Field     ;
                Name=PingPong;
                ApplicationArea=#Basic,#Suite;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PingPong;PublicKeyToken=31bf3856ad364e35] }

  }
  CODE
  {
    VAR
      ShowAll@1000 : Boolean;
      PrevNumberOfRecords@1001 : Integer;
      AddInReady@1002 : Boolean;
      ActionsEnabled@1003 : Boolean;

    LOCAL PROCEDURE UpdateVisibility@1();
    BEGIN
      IF ShowAll THEN
        SETRANGE(Read)
      ELSE
        SETRANGE(Read,FALSE);
      ActionsEnabled := FINDFIRST;
      CurrPage.UPDATE(FALSE);
    END;

    EVENT PingPong@-17::AddInReady@2();
    BEGIN
      AddInReady := TRUE;
      PrevNumberOfRecords := COUNT;
      CurrPage.PingPong.Ping(10000);
    END;

    EVENT PingPong@-17::Pong@3();
    VAR
      CurrNumberOfRecords@1000 : Integer;
    BEGIN
      CurrNumberOfRecords := COUNT;
      IF PrevNumberOfRecords <> CurrNumberOfRecords THEN
        CurrPage.UPDATE(FALSE);
      PrevNumberOfRecords := CurrNumberOfRecords;
      CurrPage.PingPong.Ping(10000);
    END;

    BEGIN
    END.
  }
}

