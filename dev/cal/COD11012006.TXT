OBJECT Codeunit 11012006 Cost Control Management
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00,4PSSE;
  }
  PROPERTIES
  {
    Permissions=TableData 11012039=rimd,
                TableData 11012361=rimd;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TotCostDec@1210190005 : Decimal;
      TotCostPeriod@1100527000 : Decimal;
      AllowedDec@1210190009 : Decimal;
      AllowedHoursDec@1210190008 : Decimal;
      PrevAllowedDec@1210190007 : Decimal;
      PrevAllowedHoursDec@1210190006 : Decimal;
      PurchaseDec@1210190004 : Decimal;
      EstimPurchResultDec@1210190003 : Decimal;
      PurchCostDec@1210190002 : Decimal;
      ActualPurchResultDec@1210190001 : Decimal;
      TotPurchResultDec@1210190000 : Decimal;
      AllowedPerc@1210190010 : Decimal;
      CalculatedEndResultDec@1210190011 : Decimal;
      TotHoursDec@1100485000 : Decimal;
      TotContrAmnt@1100485001 : Decimal;
      TotContractDec@1100485002 : Decimal;
      TotBudgetDec@1100485003 : Decimal;
      TotAllowedDec@1100485004 : Decimal;
      TotOpenDec@1100485005 : Decimal;
      SetupRead@1100525000 : Boolean;
      JobSetup@1100525001 : Record 315;
      Project@1210190012 : Record 11072003;
      CostContMgt@1210190013 : Codeunit 11012006;
      BudgetOrAllowedPresentGlobal@1100528500 : Boolean;
      BudgetOrAllowedPresentMainProj@1100528501 : Boolean;
      BudgetOrAllowedPresentProject@1100528502 : Boolean;
      BudgetOrAllowedCheckedGlobal@1100528503 : Boolean;
      BudgetOrAllowedCheckedMainProj@1100528504 : Code[20];
      BudgetOrAllowedCheckedProject@1100528505 : Code[20];
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
      TotHoursDecAmount@1101285001 : Decimal;
      TotMaterialDecAmount@1101285000 : Decimal;
      TotOpenRevenuesAmount@1101285002 : Decimal;

    [External]
    PROCEDURE CalcFieldsProject@1210190007(VAR Rec@1210190000 : Record 11072003);
    BEGIN
      WITH Rec DO BEGIN
        IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
          SETFILTER("Project Filter", "No.")
        ELSE
          IF GETFILTER("Project Status") = '' THEN  //**4PS03.n
            SETFILTER("Project Filter", '');

        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Product Discount (Purchase)",  //DP01727
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours (Entire Project)");

        CALCFIELDS(
          Prognosis, "Prognosis Total Cost", "Hours Prognosis", "Risc Coverage (Prognosis)",
          "Contract Amount", "Project Contract Amount",
          "Extension Contract Amount", "Options Contract Amount",
          "Land Value",
          "Preregistration WIP Account",
          "Prognosis Received/To Process",
          "Closed Costs", "Closed Revenues");

        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period", "Open (Inventory) Period",
          "Open Ovh. Srch. (Inv.) Period", "Open (Purchase) Period", "Open Ovh. Srch. Soft (P.) Per.");

        IF "Preregistration WIP Account" <> '' THEN
          CALCFIELDS("Preregistered WIP")
        ELSE
          "Preregistered WIP" := 0;

      END;
    END;

    [External]
    PROCEDURE CalcFieldsCostType@1210190026(VAR Rec@1210190000 : Record 11012046);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("Single/Main/Sub Project");
        IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
          SETFILTER("Project Filter", "Project No.")
        ELSE
          SETFILTER("Project Filter", '');
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours");
        CALCFIELDS(
          Prognosis, "Prognosis Total Cost", "Hours Prognosis","Risc Coverage (Prognosis)",
          "Prognosis Received/To Process",
          Revenues, "Purchase Period", "Actuals Period");
        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period", "Open (Inventory) Period",
          "Open Ovh. Srch. (Inv.) Period", "Open (Purchase) Period", "Open Ovh. Srch. Soft (P.) Per.");
        IF "Cost Type" <> "Cost Type"::Labor THEN
          "Actual Hours" := 0;  //db, 29-11-11: M31135
      END;
    END;

    [External]
    PROCEDURE CalcFieldsCostObj@1210190034(VAR Rec@1210190000 : Record 11012047);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("Single/Main/Sub Project");
        IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
          SETFILTER("Project Filter", "Project No.")
        ELSE
          SETFILTER("Project Filter", '');
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Product Discount (Purchase)",  //DP01727
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours");
        CALCFIELDS(
          Prognosis, "Prognosis Total Cost", "Hours Prognosis", "Risc Coverage (Prognosis)",
          "Original Budget Amount", "Original Budget Hours",
          Adjustments, "Adjustments Hours",
          Extension, "Extension Hours",
          Options , "Option Hours",
          "Prognosis Received/To Process",
          "Purchase Period", "Actuals Period", "Actual Hours Period");
        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period", "Open (Inventory) Period",
          "Open Ovh. Srch. (Inv.) Period", "Open (Purchase) Period", "Open Ovh. Srch. Soft (P.) Per.");
      END;
    END;

    [External]
    PROCEDURE CalcFieldsElem@1210190071(VAR Rec@1210190000 : Record 11012048);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("Single/Main/Sub Project");
        IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
          SETFILTER("Project Filter", "Project No.")
        ELSE
          SETFILTER("Project Filter", '');
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced","Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Product Discount (Purchase)",  //DP01727
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours", "Budget Hours Plant");  //DP02115
        CALCFIELDS(
          Prognosis, "Prognosis Total Cost","Hours Prognosis", "Risc Coverage (Prognosis)",
          Revenues, "Purchase Period",
          "Prognosis Received/To Process",
          "Revenues Period", "Actuals Period",
          "Prognosis Revenues", "Prognosis Total Revenues");
        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period", "Open (Inventory) Period",
          "Open Ovh. Srch. (Inv.) Period", "Open (Purchase) Period", "Open Ovh. Srch. Soft (P.) Per.");
      END;
    END;

    [External]
    PROCEDURE CalcFieldsElemCostType@1210190041(VAR Rec@1210190000 : Record 11012049);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("Single/Main/Sub Project");
        IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
          SETFILTER("Project Filter", "Project No.")
        ELSE
          SETFILTER("Project Filter", '');
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)",
          "Open Ovh. Surch. Soft (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours");
        CALCFIELDS(
          Prognosis, "Prognosis Total Cost","Hours Prognosis", "Risc Coverage (Prognosis)",
          "Prognosis Received/To Process",
          "Purchase Period", "Actuals Period");
        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period", "Open (Inventory) Period",
          "Open Ovh. Srch. (Inv.) Period", "Open (Purchase) Period", "Open Ovh. Srch. Soft (P.) Per.");
        IF "Cost Type" <> "Cost Type"::Labor THEN
          "Actual Hours" := 0;  //db, 29-11-11: M31135
      END;
    END;

    [External]
    PROCEDURE CalcFieldsElemCostObj@1210190047(VAR Rec@1210190000 : Record 11012050);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("Single/Main/Sub Project");
        IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
          SETFILTER("Project Filter", "Project No.")
        ELSE
          SETFILTER("Project Filter", '');
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Product Discount (Purchase)",  //DP01727
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)",
          "Open Ovh. Surch. Soft (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours");
        CALCFIELDS(
          Prognosis, "Prognosis Total Cost","Hours Prognosis", "Risc Coverage (Prognosis)",
          "Original Budget Amount", "Purchase Period",
          "Hours Prognosis", "Actuals Period",
          "Actual Hours Period", Extension,
          "Prognosis Received/To Process",
          Options, Adjustments);
        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period", "Open (Inventory) Period",
          "Open Ovh. Srch. (Inv.) Period", "Open (Purchase) Period", "Open Ovh. Srch. Soft (P.) Per.");
      END;
    END;

    [External]
    PROCEDURE CalcFieldsExt@1210190103(VAR Rec@1210190000 : Record 11012004);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours", Revenues);
        CALCFIELDS("Open Ovh. Surch. Soft (Purch.)");
        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period", "Open (Inventory) Period",
          "Open Ovh. Srch. (Inv.) Period", "Open (Purchase) Period", "Open Ovh. Srch. Soft (P.) Per.");
      END;
    END;

    [External]
    PROCEDURE CalcFieldsExtCostType@1210190108(VAR Rec@1210190000 : Record 11020222);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours");
        CALCFIELDS("Open Ovh. Surch. Soft (Purch.)");
        IF "Cost Type" <> "Cost Type"::Labor THEN
          "Actual Hours" := 0;  //db, 29-11-11: M31135
      END;
    END;

    [External]
    PROCEDURE CalcFieldsExtCostObj@1210190112(VAR Rec@1210190000 : Record 11020223);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours");
        CALCFIELDS("Open Ovh. Surch. Soft (Purch.)");
        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period", "Open (Inventory) Period",
          "Open Ovh. Srch. (Inv.) Period", "Open (Purchase) Period", "Open Ovh. Srch. Soft (P.) Per.");
      END;
    END;

    [External]
    PROCEDURE CalcFieldsCostComp@1100485046(VAR Rec@1210190000 : Record 11020297);
    VAR
      PrognLineCC@1100285000 : Record 11128270;
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS("Single/Main/Sub Project");
        IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
          SETFILTER("Project Filter", "Project No.")
        ELSE
          SETFILTER("Project Filter", '');
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase, "Purchase Budget",
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Risc Coverage", "Risc Coverage Withdraw",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)",
          "Open Amount (Hours)", "Open Hours", "Open Ovh. Surch. (Hours)",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          Budget, "Budget Hours");
        CALCFIELDS(
      //>>4PS-001
          //"Prognosis Cost",
          //"Prognosis Total Cost",
      //<<4PS-001
          "Hours Prognosis", "Risc Coverage (Prognosis)",
          "Open Ovh. Surch. Soft (Purch.)",
          "Purchase Period", "Actual Costs Period",
          "Actual Hours Period");
        CALCFIELDS(
          "Actual Costs Period", "Received/Not Invoiced Period", "Open Ovh. Srch. Soft (P.) Per.",
          "Open Amount (Hours) Period", "Open Ovh. Srch. Firm (P.) Per.",
          "Open (Purchase) Period", "Open Ovh. Srch. (Hours) Period");
      END;

      //>>4PS-001
      PrognLineCC.RESET;
      PrognLineCC.SETRANGE("Main Project No.", Rec."Main Project No.");
      PrognLineCC.SETRANGE("Cost Component Code", Rec."Cost Component");
      IF Rec.GETFILTER("Project Filter") <> '' THEN
        PrognLineCC.SETRANGE("Project No.", Rec.GETFILTER("Project Filter"));
      IF Rec.GETFILTER("Prognosis Filter") <> '' THEN
        PrognLineCC.SETFILTER("Prognosis Date", Rec.GETFILTER("Prognosis Filter"));

      PrognLineCC.CALCSUMS("Prognosis Costs","Overhead Surch. Progn. Costs");
      Rec."Prognosis Cost" :=
        PrognLineCC."Prognosis Costs" + PrognLineCC."Overhead Surch. Progn. Costs";
      //<<4PS-001
    END;

    [External]
    PROCEDURE CalcFieldsServContr@1210190070(VAR Rec@1210190000 : Record 11012812);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase,
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)",
          "Open Amount (Hours)", "Open Ovh. Surch. (Hours)", "Open Hours",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          "Allowed Costs", "Allowed Costs (Ovh. Surch.)", "Allowed Hours",
          "Order Amount");
        CALCFIELDS(
          "Budget Amount (ServOrder)", "Budget Ovh. Surch. (ServOrder)", "Budget Hours (ServOrder)",
          "Budget Amount (Contract)", "Budget Ovh. Surch. (Contract)", "Budget Hours (Contract)",
          "Budget Amount (ST Contract)", "Budget Ovh. Surch. (ST Contr)");
        CALCFIELDS(
          "Open Ovh. Surch. Soft (Purch.)",
          "Closed Costs", "Closed Revenues", Revenues);
      END;
    END;

    [External]
    PROCEDURE CalcFieldsServOrder@1210190089(VAR Rec@1210190000 : Record 11012823);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase,
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)",
          "Open Amount (Hours)", "Open Ovh. Surch. (Hours)", "Open Hours",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          "Allowed Costs", "Allowed Costs (Ovh. Surch.)", "Allowed Hours",
          "Budget Amount", "Budget Overhead Surcharge");  //db, 08-04-10: M18560
      END;
    END;

    [External]
    PROCEDURE CalcFieldsServiceLocation@1100528600(VAR Rec@1100528600 : Record 11012801);
    BEGIN
      WITH Rec DO BEGIN
        CALCFIELDS(
          "Actual Costs", "Actual Hours",
          Purchase,
          "Received/Not Invoiced", "Received/Not Inv. Hours",
          "Open (Purchase)", "Open Ovh. Surch. Firm (Purch.)",  "Open Ovh. Surch. Soft (Purch.)",
          "Open Amount (Hours)", "Open Ovh. Surch. (Hours)", "Open Hours",
          "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
          "Allowed Costs", "Allowed Costs (Ovh. Surch.)", "Allowed Hours");
        CALCFIELDS(
          "Budget Amount (ServOrder)", "Budget Ovh. Surch. (ServOrder)", "Budget Hours (ServOrder)",
          "Budget Amount (ST Contract)", "Budget Ovh. Surch. (ST Contr)");
        CALCFIELDS(
          Revenues, "Revenues (Additional)", "Revenues (Contract)");
      END;
    END;

    [External]
    PROCEDURE OutstandingProject@1210190000(VAR Rec@1210190000 : Record 11072003;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingCostType@1210190028(VAR Rec@1210190000 : Record 11012046;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingCostObj@1210190042(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingElem@1210190072(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingElemCostType@1210190054(VAR Rec@1210190000 : Record 11012049;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingElemCostObj@1210190048(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingExt@1210190116(VAR Rec@1210190000 : Record 11012004;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingExtCostType@1210190111(VAR Rec@1210190000 : Record 11020222;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingExtCostObj@1210190123(VAR Rec@1210190000 : Record 11020223;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingServContr@1210190083(VAR Rec@1210190000 : Record 11012812;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE OutstandingServOrder@1210190090(VAR Rec@1210190000 : Record 11012823;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open (Purchase)");
        EXIT("Open (Purchase)");
      END;
    END;

    [External]
    PROCEDURE ProductDiscountCostObj@1100528901(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      //DP01727
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Product Discount (Purchase)");
        EXIT("Product Discount (Purchase)");
      END;
    END;

    [External]
    PROCEDURE ProductDiscountElem@1100528902(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      //DP01727
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Product Discount (Purchase)");
        EXIT("Product Discount (Purchase)");
      END;
    END;

    [External]
    PROCEDURE ProductDiscountElemCostObj@1100528900(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      //DP01727
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Product Discount (Purchase)");
        EXIT("Product Discount (Purchase)");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedProject@1210190001(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedCostType@1210190029(VAR Rec@1210190001 : Record 11012046;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedCostObj@1210190043(VAR Rec@1210190001 : Record 11012047;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedElem@1210190073(VAR Rec@1210190001 : Record 11012048;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedElemCostTyp@1210190059(VAR Rec@1210190001 : Record 11012049;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedElemCostObj@1210190049(VAR Rec@1210190001 : Record 11012050;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedExt@1210190117(VAR Rec@1210190001 : Record 11012004;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedExtCostType@1210190113(VAR Rec@1210190001 : Record 11020222;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedExtCostObj@1210190124(VAR Rec@1210190001 : Record 11020223;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedServContr@1210190084(VAR Rec@1210190001 : Record 11012812;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvoicedServOrder@1210190091(VAR Rec@1210190001 : Record 11012823;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Invoiced");
        EXIT("Received/Not Invoiced");
      END;
    END;

    [External]
    PROCEDURE ReceivedNotInvHoursCostObj@1210190102(VAR Rec@1210190001 : Record 11012047;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Received/Not Inv. Hours");
        EXIT("Received/Not Inv. Hours");
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchProject@1210190003(VAR Rec@1210190000 : Record 11072003;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchCostType@1210190025(VAR Rec@1210190000 : Record 11012046;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchCostObj@1210190044(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchElem@1210190074(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchElemCostType@1210190061(VAR Rec@1210190000 : Record 11012049;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchElemCostObj@1210190050(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchExt@1210190118(VAR Rec@1210190000 : Record 11012004;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchExtCostType@1210190114(VAR Rec@1210190000 : Record 11020222;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchExtCostObj@1210190125(VAR Rec@1210190000 : Record 11020223;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchServContr@1210190085(VAR Rec@1210190000 : Record 11012812;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE OpenOvhPurchServOrder@1210190092(VAR Rec@1210190000 : Record 11012823;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Open Ovh. Surch. Firm (Purch.)", "Open Ovh. Surch. Soft (Purch.)");
        IF InclOpenPurchase THEN
          EXIT("Open Ovh. Surch. Firm (Purch.)" + "Open Ovh. Surch. Soft (Purch.)")
        ELSE
          EXIT("Open Ovh. Surch. Firm (Purch.)")
      END;
    END;

    [External]
    PROCEDURE TotOpenServContr@1100485131(VAR Rec@1210190000 : Record 11012812;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Open (Purchase)", "Received/Not Invoiced", "Open Ovh. Surch. Firm (Purch.)",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)");

        TotOpenDec :=
          "Open (Purchase)" + "Received/Not Invoiced" +
          "Open Ovh. Surch. Soft (Purch.)" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)";
        EXIT(TotOpenDec);
      END;
    END;

    [External]
    PROCEDURE TotOpenServOrder@1100485132(VAR Rec@1210190000 : Record 11012823;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Open (Purchase)", "Received/Not Invoiced", "Open Ovh. Surch. Firm (Purch.)",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)");

        TotOpenDec :=
          "Open (Purchase)" + "Received/Not Invoiced" +
          "Open Ovh. Surch. Soft (Purch.)" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)";
        EXIT(TotOpenDec);
      END;
    END;

    [External]
    PROCEDURE TotOpenServLoc@1100485133(VAR Rec@1210190000 : Record 11012801;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Open (Purchase)", "Received/Not Invoiced", "Open Ovh. Surch. Firm (Purch.)",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)");

        TotOpenDec :=
          "Open (Purchase)" + "Received/Not Invoiced" +
          "Open Ovh. Surch. Soft (Purch.)" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)";
        EXIT(TotOpenDec);
      END;
    END;

    [External]
    PROCEDURE TotCostProject@1210190021(VAR Rec@1210190000 : Record 11072003;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Firm (Purch.)",  "Open Ovh. Surch. Soft (Purch.)",
            "Received/Not Invoiced",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs" +
           "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostProjectPeriod@1100527008(VAR Rec@1210190000 : Record 11072003;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Firm (P.) Per.",  "Open Ovh. Srch. Soft (P.) Per.",
            "Received/Not Invoiced Period",
            "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period",
            "Open (Inventory) Period", "Open Ovh. Srch. (Inv.) Period",
            "Risc Coverage (Prognosis)");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Firm (P.) Per." +
          "Open Amount (Hours) Period" + "Open Ovh. Srch. (Hours) Period" +
          "Open (Inventory) Period" + "Open Ovh. Srch. (Inv.) Period" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. Soft (P.) Per.";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostCostType@1210190024(VAR Rec@1210190000 : Record 11012046;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostCostTypePeriod@1100527001(VAR Rec@1210190000 : Record 11012046;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Firm (P.) Per.",  "Open Ovh. Srch. Soft (P.) Per.",
            "Received/Not Invoiced Period",
            "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period",
            "Open (Inventory) Period", "Open Ovh. Srch. (Inv.) Period",
            "Risc Coverage (Prognosis)");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Firm (P.) Per." +
          "Open Amount (Hours) Period" + "Open Ovh. Srch. (Hours) Period" +
          "Open (Inventory) Period" + "Open Ovh. Srch. (Inv.) Period" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. Soft (P.) Per.";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostCostObj@1210190036(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostCostObjPeriod@1100527002(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Firm (P.) Per.",  "Open Ovh. Srch. Soft (P.) Per.",
            "Received/Not Invoiced Period",
            "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period",
            "Open (Inventory) Period", "Open Ovh. Srch. (Inv.) Period",
            "Risc Coverage (Prognosis)");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Firm (P.) Per." +
          "Open Amount (Hours) Period" + "Open Ovh. Srch. (Hours) Period" +
          "Open (Inventory) Period" + "Open Ovh. Srch. (Inv.) Period" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. Soft (P.) Per.";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostElem@1210190075(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");
        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostElemPeriod@1100527000(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Firm (P.) Per.",  "Open Ovh. Srch. Soft (P.) Per.",
            "Received/Not Invoiced Period",
            "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period",
            "Open (Inventory) Period", "Open Ovh. Srch. (Inv.) Period",
            "Risc Coverage (Prognosis)");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Firm (P.) Per." +
          "Open Amount (Hours) Period" + "Open Ovh. Srch. (Hours) Period" +
          "Open (Inventory) Period" + "Open Ovh. Srch. (Inv.) Period" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. Soft (P.) Per.";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostElemCostType@1210190062(VAR Rec@1210190000 : Record 11012049;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostElemCostTypePeriod@1100527003(VAR Rec@1210190000 : Record 11012049;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Firm (P.) Per.",  "Open Ovh. Srch. Soft (P.) Per.",
            "Received/Not Invoiced Period",
            "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period",
            "Open (Inventory) Period", "Open Ovh. Srch. (Inv.) Period",
            "Risc Coverage (Prognosis)");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Firm (P.) Per." +
          "Open Amount (Hours) Period" + "Open Ovh. Srch. (Hours) Period" +
          "Open (Inventory) Period" + "Open Ovh. Srch. (Inv.) Period" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. Soft (P.) Per.";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostElemCostObj@1210190051(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostElemCostObjPeriod@1100527004(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Firm (P.) Per.",  "Open Ovh. Srch. Soft (P.) Per.",
            "Received/Not Invoiced Period",
            "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period",
            "Open (Inventory) Period", "Open Ovh. Srch. (Inv.) Period",
            "Risc Coverage (Prognosis)");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Firm (P.) Per." +
          "Open Amount (Hours) Period" + "Open Ovh. Srch. (Hours) Period" +
          "Open (Inventory) Period" + "Open Ovh. Srch. (Inv.) Period" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. Soft (P.) Per.";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostExt@1210190107(VAR Rec@1210190000 : Record 11012004;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)");

        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostExtPeriod@1100527006(VAR Rec@1210190000 : Record 11012004;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Firm (P.) Per.",  "Open Ovh. Srch. Soft (P.) Per.",
            "Received/Not Invoiced Period",
            "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period",
            "Open (Inventory) Period", "Open Ovh. Srch. (Inv.) Period");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Firm (P.) Per." +
          "Open Amount (Hours) Period" + "Open Ovh. Srch. (Hours) Period" +
          "Open (Inventory) Period" + "Open Ovh. Srch. (Inv.) Period";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. Soft (P.) Per.";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostExtCostType@1210190115(VAR Rec@1210190000 : Record 11020222;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)");

        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostExtCostObj@1210190126(VAR Rec@1210190000 : Record 11020223;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)");

        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostExtCostObjPeriod@1100527007(VAR Rec@1210190000 : Record 11020223;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Firm (P.) Per.", "Received/Not Invoiced Period",
            "Open Ovh. Srch. Soft (P.) Per.",
            "Open Amount (Hours) Period", "Open Ovh. Srch. (Hours) Period",
            "Open (Inventory) Period", "Open Ovh. Srch. (Inv.) Period");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Firm (P.) Per." +
          "Open Amount (Hours) Period" + "Open Ovh. Srch. (Hours) Period" +
          "Open (Inventory) Period" + "Open Ovh. Srch. (Inv.) Period";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. Soft (P.) Per.";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostCostComp@1100485003(VAR Rec@1210190000 : Record 11020297;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs", "Open (Purchase)",
            "Open Ovh. Surch. Firm (Purch.)", "Received/Not Invoiced",
            "Open Ovh. Surch. Soft (Purch.)",
            "Open Amount (Hours)", "Open Ovh. Surch. (Hours)",
      //>>4PS-001
          "Open (Inventory)",
      //<<4PS-001
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs" +
          "Received/Not Invoiced" + "Open Ovh. Surch. Firm (Purch.)" +
          "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)" +
      //>>4PS-001
          "Open (Inventory)"+
      //<<4PS-001
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostCostCompPeriod@1100527005(VAR Rec@1210190000 : Record 11020297;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs Period", "Open (Purchase) Period",
            "Open Ovh. Srch. Soft (P.) Per.", "Received/Not Invoiced Period",
            "Open Ovh. Srch. (Hours) Period",
            "Open Amount (Hours) Period", "Open Amount (Hours) Period",
            "Risc Coverage (Prognosis)");

        TotCostPeriod :=
          "Actual Costs Period" +
          "Received/Not Invoiced Period" + "Open Ovh. Srch. Soft (P.) Per." +
          "Open Amount (Hours) Period" + "Open Amount (Hours) Period" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostPeriod := TotCostPeriod + "Open (Purchase) Period" + "Open Ovh. Srch. (Hours) Period";

        EXIT(TotCostPeriod);
      END;
    END;

    [External]
    PROCEDURE TotCostServContr@1210190086(VAR Rec@1210190000 : Record 11012812;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Actual Costs", "Open (Purchase)");

        TotOpenDec := TotOpenServContr(Rec, ExecCalcFields);
        TotCostDec := "Actual Costs" + TotOpenDec;

        IF NOT InclOpenPurchase THEN
          TotCostDec := TotCostDec - "Open (Purchase)" - "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostServOrder@1210190093(VAR Rec@1210190000 : Record 11012823;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Actual Costs", "Open (Purchase)");

        TotOpenDec := TotOpenServOrder(Rec, ExecCalcFields);
        TotCostDec := "Actual Costs" + TotOpenDec;

        IF NOT InclOpenPurchase THEN
          TotCostDec := TotCostDec - "Open (Purchase)" - "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotCostServLoc@1210190100(VAR Rec@1210190000 : Record 11012801;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Actual Costs", "Open (Purchase)");

        TotOpenDec := TotOpenServLoc(Rec, ExecCalcFields);
        TotCostDec := "Actual Costs" + TotOpenDec;

        IF NOT InclOpenPurchase THEN
          TotCostDec := TotCostDec - "Open (Purchase)" - "Open Ovh. Surch. Soft (Purch.)";

        EXIT(TotCostDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursProject@1100485001(VAR Rec@1100485001 : Record 11072003;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";

        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursCostType@1100485002(VAR Rec@1100485001 : Record 11012046;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF "Cost Type" = "Cost Type"::Labor THEN BEGIN
          IF ExecCalcFields THEN
            CALCFIELDS(
              "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

          TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        END ELSE
          TotHoursDec := 0;
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursCostObj@1100485000(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursElem@1100485004(VAR Rec@1100485001 : Record 11012048;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursElemCostType@1100485013(VAR Rec@1100485001 : Record 11012049;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF "Cost Type" = "Cost Type"::Labor THEN BEGIN
          IF ExecCalcFields THEN
            CALCFIELDS(
              "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

          TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        END ELSE
          TotHoursDec := 0;
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursElemCostObj@1100485014(VAR Rec@1100485001 : Record 11012050;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursExt@1100485015(VAR Rec@1100485001 : Record 11012004;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursExtCostType@1100485021(VAR Rec@1100485001 : Record 11020222;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursExtCostObj@1100485017(VAR Rec@1100485001 : Record 11020223;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursCostComp@1100485045(VAR Rec@1210190000 : Record 11020297;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursServContr@1100485022(VAR Rec@1100485001 : Record 11012812;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursServOrder@1100485019(VAR Rec@1100485001 : Record 11012823;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotHoursServLoc@1100485020(VAR Rec@1100485001 : Record 11012801;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Hours", "Received/Not Inv. Hours", "Open Hours");

        TotHoursDec := "Actual Hours" + "Received/Not Inv. Hours" + "Open Hours";
        EXIT(TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE TotContrAmntProject@1100485081(VAR Rec@1100485001 : Record 11072003;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Project Contract Amount","Extension Contract Amount","Options Contract Amount");

        TotContractDec := "Project Contract Amount" + "Extension Contract Amount" + "Options Contract Amount";
        EXIT(TotContractDec);
      END;
    END;

    [External]
    PROCEDURE TotContrAmntServContr@1100485080(VAR Rec@1100485001 : Record 11012812;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Order Amount");
        TotContractDec := "Order Amount";

        EXIT(TotContractDec);
      END;
    END;

    [External]
    PROCEDURE BudgetHoursServContr@1100485102(VAR Rec@1100485001 : Record 11012812;ExecCalcFields@1100485000 : Boolean) BudgetHours : Decimal;
    VAR
      lvOverlap@1100485002 : Boolean;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Budget Hours (ServOrder)", "Budget Hours (Contract)");
        IF GETFILTER("Source Type Filter") = '' THEN
          lvOverlap := TRUE
        ELSE
          IF GETRANGEMAX("Source Type Filter") = "Source Type Filter"::Contract THEN
            lvOverlap := TRUE;
        IF lvOverlap = FALSE THEN
          BudgetHours := "Budget Hours (ServOrder)"
        ELSE
          BudgetHours := "Budget Hours (Contract)";
        EXIT(BudgetHours);
      END;
    END;

    [External]
    PROCEDURE BudgetHoursServOrder@1100485104(VAR Rec@1100485001 : Record 11012823;ExecCalcFields@1100485000 : Boolean) BudgetHours : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Budget Hours");
        BudgetHours := "Budget Hours";
        EXIT(BudgetHours);
      END;
    END;

    [External]
    PROCEDURE BudgetHoursServLoc@1100485103(VAR Rec@1100485001 : Record 11012801;ExecCalcFields@1100485000 : Boolean) BudgetHours : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Budget Hours (ServOrder)");
        BudgetHours := "Budget Hours (ServOrder)";
        EXIT(BudgetHours);
      END;
    END;

    [External]
    PROCEDURE TotBudgetServContr@1100485079(VAR Rec@1100485001 : Record 11012812;ExecCalcFields@1100485000 : Boolean) TotBudgetDec : Decimal;
    VAR
      lvOverlap@1100485002 : Boolean;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Budget Amount (ServOrder)", "Budget Ovh. Surch. (ServOrder)",
            "Budget Amount (Contract)", "Budget Ovh. Surch. (Contract)",
            "Budget Amount (ST Contract)", "Budget Ovh. Surch. (ST Contr)");
        IF GETFILTER("Source Type Filter") = '' THEN
          lvOverlap := TRUE
        ELSE
          IF GETRANGEMAX("Source Type Filter") = "Source Type Filter"::Contract THEN
            lvOverlap := TRUE;
        IF lvOverlap = FALSE THEN
          TotBudgetDec :=
            ("Budget Amount (ServOrder)" + "Budget Ovh. Surch. (ServOrder)")
        ELSE
          TotBudgetDec :=
            ("Budget Amount (ServOrder)" + "Budget Ovh. Surch. (ServOrder)") +
            ("Budget Amount (Contract)" + "Budget Ovh. Surch. (Contract)") -
            ("Budget Amount (ST Contract)" + "Budget Ovh. Surch. (ST Contr)");
        EXIT(TotBudgetDec);
      END;
    END;

    [External]
    PROCEDURE TotBudgetServOrder@1100485087(VAR Rec@1100485001 : Record 11012823;ExecCalcFields@1100485000 : Boolean) TotBudgetDec : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Budget Amount", "Budget Overhead Surcharge");
        TotBudgetDec := "Budget Amount" + "Budget Overhead Surcharge";
        EXIT(TotBudgetDec);
      END;
    END;

    [External]
    PROCEDURE TotBudgetServLoc@1100485088(VAR Rec@1100485001 : Record 11012801;ExecCalcFields@1100485000 : Boolean) TotBudgetDec : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Budget Amount (ServOrder)", "Budget Ovh. Surch. (ServOrder)");
        TotBudgetDec :=
          ("Budget Amount (ServOrder)" + "Budget Ovh. Surch. (ServOrder)")
      END;
    END;

    [External]
    PROCEDURE TotBudgetHoursServContr@1100525004(VAR Rec@1100485001 : Record 11012812;ExecCalcFields@1100485000 : Boolean) TotBudgetHours : Decimal;
    VAR
      lvOverlap@1100485002 : Boolean;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(
            "Budget Hours (ServOrder)",
            "Budget Hours (Contract)",
            "Budget Hours (ST Contract)");
        IF GETFILTER("Source Type Filter") = '' THEN
          lvOverlap := TRUE
        ELSE
          IF GETRANGEMAX("Source Type Filter") = "Source Type Filter"::Contract THEN
            lvOverlap := TRUE;
        IF lvOverlap = FALSE THEN
          TotBudgetHours :=
            ("Budget Hours (ServOrder)")
        ELSE
          TotBudgetHours :=
            ("Budget Hours (ServOrder)") +
            ("Budget Hours (Contract)" ) -
            ("Budget Hours (ST Contract)");
        EXIT(TotBudgetHours);
      END;
    END;

    [External]
    PROCEDURE TotAllowedServContr@1100485099(VAR Rec@1100485001 : Record 11012812;ExecCalcFields@1100485000 : Boolean) TotAllowedDec : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Allowed Costs", "Allowed Costs (Ovh. Surch.)");
        TotAllowedDec := "Allowed Costs" + "Allowed Costs (Ovh. Surch.)";
        EXIT(TotAllowedDec);
      END;
    END;

    [External]
    PROCEDURE TotAllowedServLoc@1100485101(VAR Rec@1100485001 : Record 11012801;ExecCalcFields@1100485000 : Boolean) TotAllowedDec : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Allowed Costs", "Allowed Costs (Ovh. Surch.)");
        TotAllowedDec := "Allowed Costs" + "Allowed Costs (Ovh. Surch.)";
        EXIT(TotAllowedDec);
      END;
    END;

    [External]
    PROCEDURE TotAllowedServOrder@1100485100(VAR Rec@1100485001 : Record 11012823;ExecCalcFields@1100485000 : Boolean) TotAllowedDec : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Allowed Costs", "Allowed Costs (Ovh. Surch.)");
        TotAllowedDec := "Allowed Costs" + "Allowed Costs (Ovh. Surch.)";
        EXIT(TotAllowedDec);
      END;
    END;

    [External]
    PROCEDURE PrognTotCostProject@1100485025(VAR Rec@1210190000 : Record 11072003;ExecCalcFields@1210190002 : Boolean) : Decimal;
    VAR
      PrognosisRec@1100485001 : Record 11012034;
      PrognosisSubRec@1100525003 : Record 11012034;
      SubProjRec@1100525002 : Record 11072003;
      lvRoughPrognosisPresent@1100485000 : Boolean;
      lvPrognosisPresent@1100525000 : Boolean;
      lvPrognTotCost@1100525001 : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
          PrognosisRec.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisSubRec.CHANGECOMPANY(CURRENTCOMPANY);
          SubProjRec.CHANGECOMPANY(CURRENTCOMPANY);
        END;
        CostContMgt.SetCompany(CURRENTCOMPANY);

        IF GETFILTER("Prognosis Filter") <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "No.");
          PrognosisRec.SETFILTER("Prognosis Date", GETFILTER("Prognosis Filter"));
          IF PrognosisRec.FINDFIRST THEN BEGIN
            lvPrognosisPresent := TRUE;
            lvRoughPrognosisPresent := PrognosisRec."Prognosis Level" = PrognosisRec."Prognosis Level"::Rough;
          END;
        END;
        IF lvRoughPrognosisPresent THEN
          EXIT(PrognosisRec."Rough Prognosis Total Cost");

        IF ("Single/Main/Sub Project" = "Single/Main/Sub Project"::"Main Project") AND NOT lvPrognosisPresent THEN BEGIN
          //This part speeds up situations in which no prognoses are made
          PrognosisSubRec.SETCURRENTKEY("Main Project No.","Prognosis Date");
          PrognosisSubRec.SETRANGE("Main Project No.", "No.");
          PrognosisSubRec.SETFILTER("Prognosis Date",GETFILTER("Cumulation Filter"));
          IF NOT PrognosisSubRec.ISEMPTY THEN BEGIN
          //
            SubProjRec.SETCURRENTKEY("Main Project");
            SubProjRec.SETRANGE("Main Project", "Main Project");
            Rec.COPYFILTER("Cumulation Filter", SubProjRec."Cumulation Filter");
            IF SubProjRec.FINDSET THEN
              REPEAT
                SubProjRec.SETRANGE("Project Filter", SubProjRec."No.");
                PrognosisSubRec.RESET;
                IF CURRENTCOMPANY <> COMPANYNAME THEN
                  PrognosisSubRec.CHANGECOMPANY(CURRENTCOMPANY);
                PrognosisSubRec.SETRANGE("Project No.", SubProjRec."No.");
                PrognosisSubRec.SETFILTER("Prognosis Date", GETFILTER("Cumulation Filter"));
                IF PrognosisSubRec.FINDLAST THEN
                  CASE PrognosisSubRec."Prognosis Level" OF
                    PrognosisSubRec."Prognosis Level"::Rough:
                      lvPrognTotCost := lvPrognTotCost + PrognosisSubRec."Rough Prognosis Total Cost";
                    //C043270.sn
                    PrognosisSubRec."Prognosis Level"::Element:
                      BEGIN
                        PrognosisSubRec.CALCFIELDS("Prognosis Total Cost Element");
                        lvPrognTotCost := lvPrognTotCost + PrognosisSubRec."Prognosis Total Cost Element";
                      END;
                    //C043270.en
                    PrognosisSubRec."Prognosis Level"::Detailed:
                      BEGIN
                        PrognosisSubRec.CALCFIELDS("Prognosis Total Cost");
                        lvPrognTotCost := lvPrognTotCost + PrognosisSubRec."Prognosis Total Cost";
                      END;
                  END
                ELSE
                  lvPrognTotCost := lvPrognTotCost + CostContMgt.TotCostProject(SubProjRec, TRUE);
              UNTIL SubProjRec.NEXT = 0;
            EXIT(lvPrognTotCost);
          END;
        END;

        IF lvPrognosisPresent THEN BEGIN
          //C043270.sn
          IF PrognosisRec."Prognosis Level" = PrognosisRec."Prognosis Level"::Element THEN BEGIN
            PrognosisRec.CALCFIELDS("Prognosis Total Cost Element");
            EXIT(PrognosisRec."Prognosis Total Cost Element");
          END ELSE
          //C043270.en
            IF PrognosisRec."Fix Prognosis Line" THEN BEGIN
              IF ExecCalcFields THEN
                CALCFIELDS("Prognosis Total Cost");
              EXIT("Prognosis Total Cost");
            END ELSE BEGIN
              IF ExecCalcFields THEN BEGIN
                TotCostDec := TotCostProject(Rec, ExecCalcFields);
              //>>4PS-001
              //CALCFIELDS(Prognosis);
              CALCFIELDS(Prognosis,"Overhead Surch. Progn. Costs");
              //<<4PS-001
              END;
            //>>4PS-001
            //EXIT(TotCostDec + Prognosis);
            EXIT(TotCostDec + Prognosis + "Overhead Surch. Progn. Costs");
            //<<4PS-001
            END;
        END ELSE BEGIN
          IF ExecCalcFields THEN
            TotCostDec := TotCostProject(Rec, ExecCalcFields);
          EXIT(TotCostDec);
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotCostCostType@1210190023(VAR Rec@1210190000 : Record 11012046;ExecCalcFields@1210190002 : Boolean) : Decimal;
    VAR
      PrognosisRec@1210190004 : Record 11012034;
      SubProjRec@1210190006 : Record 11072003;
      SubControlProjectCostType@1210190005 : Record 11012046;
      PrognTotCost@1210190008 : Decimal;
      FiltGroup@1210190003 : Integer;
      PrognDateFilter@1210190001 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Prognosis Total Cost");

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

      //call 33954
        GetProject("Project No.");
        IF (Project."Single/Main/Sub Project" = Project."Single/Main/Sub Project"::"Main Project") THEN BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF (PrognosisRec."Project No." = '') THEN BEGIN
            SubProjRec.SETCURRENTKEY("Main Project");
            SubProjRec.SETRANGE("Main Project", "Main Project No.");
            Rec.COPYFILTER("Cumulation Filter", SubProjRec."Cumulation Filter");
            IF SubProjRec.FINDSET THEN BEGIN
              REPEAT
                SubControlProjectCostType.COPY(Rec);
                SubControlProjectCostType.SETRANGE("Project Filter", SubProjRec."No.");
                SubControlProjectCostType."Project No." := SubProjRec."No.";
                IF SubProjRec."No." = "Main Project No." THEN
                  PrognTotCost := PrognTotCost + CostContMgt.TotCostCostType(
                    SubControlProjectCostType, TRUE)
                ELSE
                  PrognTotCost := PrognTotCost + CostContMgt.PrognTotCostCostType(
                    SubControlProjectCostType, TRUE);
              UNTIL SubProjRec.NEXT = 0;
              EXIT(PrognTotCost);
            END;
          END;
        END;
      //

        IF ("Prognosis Total Cost" = 0) AND (PrognDateFilter = '') THEN BEGIN
          TotCostDec := TotCostCostType(Rec, ExecCalcFields);
          EXIT(TotCostDec);
        END ELSE BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF PrognosisRec."Fix Prognosis Line" THEN
            EXIT("Prognosis Total Cost")
          ELSE BEGIN
            IF ExecCalcFields THEN BEGIN
              TotCostDec := TotCostCostType(Rec, ExecCalcFields);
              CALCFIELDS(Prognosis);
            END;
            EXIT(TotCostDec + Prognosis);
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotCostCostObj@1210190037(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190002 : Boolean) : Decimal;
    VAR
      PrognosisRec@1210190004 : Record 11012034;
      SubProjRec@1210190006 : Record 11072003;
      SubControlProjectCostObject@1210190005 : Record 11012047;
      PrognTotCost@1210190008 : Decimal;
      FiltGroup@1210190003 : Integer;
      PrognDateFilter@1210190001 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Prognosis Total Cost");

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
          SubProjRec.CHANGECOMPANY(CURRENTCOMPANY);
          SubControlProjectCostObject.CHANGECOMPANY(CURRENTCOMPANY);
        END;

      //call 33954
        GetProject("Project No.");
        IF (Project."Single/Main/Sub Project" = Project."Single/Main/Sub Project"::"Main Project") THEN BEGIN
          IF CURRENTCOMPANY <> COMPANYNAME THEN
            PrognosisRec.CHANGECOMPANY(CURRENTCOMPANY);
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF (PrognosisRec."Project No." = '') THEN BEGIN
            SubProjRec.SETCURRENTKEY("Main Project");
            SubProjRec.SETRANGE("Main Project", "Main Project No.");
            Rec.COPYFILTER("Cumulation Filter", SubProjRec."Cumulation Filter");
            IF SubProjRec.FINDSET THEN BEGIN
              REPEAT
                SubControlProjectCostObject.COPY(Rec);
                SubControlProjectCostObject.SETRANGE("Project Filter", SubProjRec."No.");
                SubControlProjectCostObject."Project No." := SubProjRec."No.";
                IF SubProjRec."No." = "Main Project No." THEN
                  PrognTotCost := PrognTotCost + CostContMgt.TotCostCostObj(
                    SubControlProjectCostObject, TRUE)
                ELSE
                  PrognTotCost := PrognTotCost + CostContMgt.PrognTotCostCostObj(
                    SubControlProjectCostObject, TRUE);
              UNTIL SubProjRec.NEXT = 0;
              EXIT(PrognTotCost);
            END;
          END;
        END;
      //

        IF ("Prognosis Total Cost" = 0) AND (PrognDateFilter = '') THEN BEGIN
          TotCostDec := TotCostCostObj(Rec, ExecCalcFields);
          EXIT(TotCostDec);
        END ELSE BEGIN
          IF CURRENTCOMPANY <> COMPANYNAME THEN
            PrognosisRec.CHANGECOMPANY(CURRENTCOMPANY);
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF PrognosisRec."Fix Prognosis Line" THEN
            EXIT("Prognosis Total Cost")
          ELSE BEGIN
            IF ExecCalcFields THEN BEGIN
              TotCostDec := TotCostCostObj(Rec, ExecCalcFields);
              CALCFIELDS(Prognosis);
            END;
            //>>4PS-001
            //EXIT(TotCostDec + Prognosis);
            EXIT("Prognosis Total Cost");
            //<<4PS-001
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotCostElem@1210190076(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190002 : Boolean) : Decimal;
    VAR
      PrognosisRec@1210190004 : Record 11012034;
      SubProjRec@1210190007 : Record 11072003;
      SubControlProjectElem@1210190006 : Record 11012048;
      PrognTotCost@1210190005 : Decimal;
      FiltGroup@1210190003 : Integer;
      PrognDateFilter@1210190001 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Prognosis Total Cost");

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

      //call 33954
        GetProject("Project No.");
        IF (Project."Single/Main/Sub Project" = Project."Single/Main/Sub Project"::"Main Project") THEN BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF (PrognosisRec."Project No." = '') THEN BEGIN
            SubProjRec.SETCURRENTKEY("Main Project");
            SubProjRec.SETRANGE("Main Project", "Main Project No.");
            Rec.COPYFILTER("Cumulation Filter", SubProjRec."Cumulation Filter");
            IF SubProjRec.FINDSET THEN BEGIN
              REPEAT
                SubControlProjectElem.COPY(Rec);
                SubControlProjectElem.SETRANGE("Project Filter", SubProjRec."No.");
                SubControlProjectElem."Project No." := SubProjRec."No.";
                IF SubProjRec."No." = "Main Project No." THEN
                  PrognTotCost := PrognTotCost + CostContMgt.TotCostElem(
                   SubControlProjectElem, TRUE)
                ELSE
                  PrognTotCost := PrognTotCost + CostContMgt.PrognTotCostElem(
                    SubControlProjectElem, TRUE);
              UNTIL SubProjRec.NEXT = 0;
              EXIT(PrognTotCost);
            END;
          END;
        END;
      //

        IF ("Prognosis Total Cost" = 0) AND (PrognDateFilter = '') THEN BEGIN
          TotCostDec := TotCostElem(Rec, ExecCalcFields);
          EXIT(TotCostDec);
        END ELSE BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF PrognosisRec."Fix Prognosis Line" THEN
            EXIT("Prognosis Total Cost")
          ELSE BEGIN
            IF ExecCalcFields THEN BEGIN
              TotCostDec := TotCostElem(Rec, ExecCalcFields);
              CALCFIELDS(Prognosis);
            END;
            EXIT(TotCostDec + Prognosis);
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotCostElemCostType@1210190063(VAR Rec@1210190000 : Record 11012049;ExecCalcFields@1210190002 : Boolean) : Decimal;
    VAR
      PrognosisRec@1210190004 : Record 11012034;
      SubProjRec@1210190007 : Record 11072003;
      SubControlProjElemCostType@1210190006 : Record 11012049;
      PrognTotCost@1210190005 : Decimal;
      FiltGroup@1210190003 : Integer;
      PrognDateFilter@1210190001 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Prognosis Total Cost");

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

      //call 33954
        GetProject("Project No.");
        IF (Project."Single/Main/Sub Project" = Project."Single/Main/Sub Project"::"Main Project") THEN BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF (PrognosisRec."Project No." = '') THEN BEGIN
            SubProjRec.SETCURRENTKEY("Main Project");
            SubProjRec.SETRANGE("Main Project", "Main Project No.");
            Rec.COPYFILTER("Cumulation Filter", SubProjRec."Cumulation Filter");
            IF SubProjRec.FINDSET THEN BEGIN
              REPEAT
                SubControlProjElemCostType.COPY(Rec);
                SubControlProjElemCostType.SETRANGE("Project Filter", SubProjRec."No.");
                SubControlProjElemCostType."Project No." := SubProjRec."No.";
                IF SubProjRec."No." = "Main Project No." THEN
                  PrognTotCost := PrognTotCost + CostContMgt.TotCostElemCostType(
                    SubControlProjElemCostType, TRUE)
                ELSE
                  PrognTotCost := PrognTotCost + CostContMgt.PrognTotCostElemCostType(
                    SubControlProjElemCostType, TRUE);
              UNTIL SubProjRec.NEXT = 0;
              EXIT(PrognTotCost);
            END;
          END;
        END;
      //

        IF ("Prognosis Total Cost" = 0) AND (PrognDateFilter = '') THEN BEGIN
          TotCostDec := TotCostElemCostType(Rec, ExecCalcFields);
          EXIT(TotCostDec);
        END ELSE BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF PrognosisRec."Fix Prognosis Line" THEN
            EXIT("Prognosis Total Cost")
          ELSE BEGIN
            IF ExecCalcFields THEN BEGIN
              TotCostDec := TotCostElemCostType(Rec, ExecCalcFields);
              CALCFIELDS(Prognosis);
            END;
            EXIT(TotCostDec + Prognosis);
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotCostElemCostObj@1210190060(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190002 : Boolean) : Decimal;
    VAR
      PrognosisRec@1210190004 : Record 11012034;
      SubProjRec@1210190007 : Record 11072003;
      SubControlProjElemCostObject@1210190006 : Record 11012050;
      PrognTotCost@1210190005 : Decimal;
      FiltGroup@1210190003 : Integer;
      PrognDateFilter@1210190001 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Prognosis Total Cost");

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

      //call 33954
        GetProject("Project No.");
        IF (Project."Single/Main/Sub Project" = Project."Single/Main/Sub Project"::"Main Project") THEN BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF (PrognosisRec."Project No." = '') THEN BEGIN
            SubProjRec.SETCURRENTKEY("Main Project");
            SubProjRec.SETRANGE("Main Project", "Main Project No.");
            Rec.COPYFILTER("Cumulation Filter", SubProjRec."Cumulation Filter");
            IF SubProjRec.FINDSET THEN BEGIN
              REPEAT
                SubControlProjElemCostObject.COPY(Rec);
                SubControlProjElemCostObject.SETRANGE("Project Filter", SubProjRec."No.");
                SubControlProjElemCostObject."Project No." := SubProjRec."No.";
                IF SubProjRec."No." = "Main Project No." THEN
                  PrognTotCost := PrognTotCost + CostContMgt.TotCostElemCostObj(
                    SubControlProjElemCostObject, TRUE)
                ELSE
                  PrognTotCost := PrognTotCost + CostContMgt.PrognTotCostElemCostObj(
                    SubControlProjElemCostObject, TRUE);
              UNTIL SubProjRec.NEXT = 0;
              EXIT(PrognTotCost);
            END;
          END;
        END;
      //

        IF ("Prognosis Total Cost" = 0) AND (PrognDateFilter = '') THEN BEGIN
          TotCostDec := TotCostElemCostObj(Rec, ExecCalcFields);
          EXIT(TotCostDec);
        END ELSE BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF PrognosisRec."Fix Prognosis Line" THEN
            EXIT("Prognosis Total Cost")
          ELSE BEGIN
            IF ExecCalcFields THEN BEGIN
              TotCostDec := TotCostElemCostObj(Rec, ExecCalcFields);
              CALCFIELDS(Prognosis);
            END;
            EXIT(TotCostDec + Prognosis);
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotHoursProject@1100485036(VAR Rec@1210190000 : Record 11072003;ExecCalcFields@1210190002 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Hours Prognosis");
          TotHoursDec := TotHoursProject(Rec, ExecCalcFields);
        END;
        EXIT("Hours Prognosis" + TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE PrognTotHoursCostType@1100485023(VAR Rec@1210190000 : Record 11012046;ExecCalcFields@1210190002 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF "Cost Type" = "Cost Type"::Labor THEN BEGIN
          IF ExecCalcFields THEN BEGIN
            CALCFIELDS("Hours Prognosis");
            TotHoursDec := TotHoursCostType(Rec, ExecCalcFields);
          END;
          EXIT("Hours Prognosis" + TotHoursDec);
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotHoursCostObj@1100485035(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190002 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Hours Prognosis");
          TotHoursDec := TotHoursCostObj(Rec, ExecCalcFields);
        END;
        EXIT("Hours Prognosis" + TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE PrognTotHoursElem@1100485037(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190002 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Hours Prognosis");
          TotHoursDec := TotHoursElem(Rec, ExecCalcFields);
        END;
        EXIT("Hours Prognosis" + TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE PrognTotHoursElemCostType@1100485038(VAR Rec@1210190000 : Record 11012049;ExecCalcFields@1210190002 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF "Cost Type" = "Cost Type"::Labor THEN BEGIN
          IF ExecCalcFields THEN BEGIN
            CALCFIELDS("Hours Prognosis");
            TotHoursDec := TotHoursElemCostType(Rec, ExecCalcFields);
          END;
          EXIT("Hours Prognosis" + TotHoursDec);
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotHoursElemCostObj@1100485039(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190002 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Hours Prognosis");
          TotHoursDec := TotHoursElemCostObj(Rec, ExecCalcFields);
        END;
        EXIT("Hours Prognosis" + TotHoursDec);
      END;
    END;

    [External]
    PROCEDURE PurchResultProject@1210190006(VAR Rec@1210190000 : Record 11072003;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingProject(Rec, ExecCalcFields) -
          ReceivedNotInvoicedProject(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchProject(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PurchResultCostType@1210190030(VAR Rec@1210190000 : Record 11012046;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingCostType(Rec, ExecCalcFields) -
          ReceivedNotInvoicedCostType(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchCostType(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PurchResultCostObj@1210190045(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingCostObj(Rec, ExecCalcFields) -
          ReceivedNotInvoicedCostObj(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchCostObj(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PurchResultElem@1210190077(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingElem(Rec, ExecCalcFields) -
          ReceivedNotInvoicedElem(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchElem(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PurchResultElemCostType@1210190064(VAR Rec@1210190000 : Record 11012049;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingElemCostType(Rec, ExecCalcFields) -
          ReceivedNotInvoicedElemCostTyp(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchElemCostType(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PurchResultElemCostObj@1210190038(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingElemCostObj(Rec, ExecCalcFields) -
          ReceivedNotInvoicedElemCostObj(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchElemCostObj(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PurchResultExt@1210190104(VAR Rec@1210190000 : Record 11012004;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingExt(Rec, ExecCalcFields) -
          ReceivedNotInvoicedExt(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchExt(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PurchResultExtCostType@1210190119(VAR Rec@1210190000 : Record 11020222;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingExtCostType(Rec, ExecCalcFields) -
          ReceivedNotInvoicedExtCostType(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchExtCostType(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PurchResultExtCostObj@1210190130(VAR Rec@1210190000 : Record 11020223;ExecCalcFields@1210190001 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Purchase Budget", "Risc Coverage", "Risc Coverage Withdraw", "Actual Costs");
        EXIT(
          "Purchase Budget" - OutstandingExtCostObj(Rec, ExecCalcFields) -
          ReceivedNotInvoicedExtCostObj(Rec, ExecCalcFields) -
          "Risc Coverage" + "Risc Coverage Withdraw" -
          "Actual Costs" - OpenOvhPurchExtCostObj(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE AllowedAndPurchProject@1210190008(VAR Rec@1210190010 : Record 11072003;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;CalcPurchase@1210190005 : Boolean;VAR lPurchaseDec@1210190004 : Decimal;VAR lEstimPurchResultDec@1210190003 : Decimal;VAR lPurchCostDec@1210190002 : Decimal;VAR lActualPurchResultDec@1210190001 : Decimal;VAR lTotPurchResultDec@1210190000 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN
        IF CheckBudgetOrAllowedPresent(Rec) THEN //C010480
          Rec.CalcAllowedPrevAllowAndPurch(
            lAllowedDec, lAllowedHoursDec, lPrevAllowedDec, lPrevAllowedHoursDec, CalcPurchase,
            lPurchaseDec, lEstimPurchResultDec, lPurchCostDec, lActualPurchResultDec, lTotPurchResultDec)
        //C014148.sn
        ELSE BEGIN
          lAllowedDec := 0;
          lAllowedHoursDec := 0;
          lPrevAllowedDec := 0;
          lPrevAllowedHoursDec := 0;
          lPurchaseDec := 0;
          lEstimPurchResultDec := 0;
          lPurchCostDec := 0;
          lActualPurchResultDec := 0;
          lTotPurchResultDec := 0;
        END;
        //C014148.en
      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
      PurchaseDec := lPurchaseDec;
      EstimPurchResultDec := lEstimPurchResultDec;
      PurchCostDec := lPurchCostDec;
      ActualPurchResultDec := lActualPurchResultDec;
      TotPurchResultDec := TotPurchResultDec;
    END;

    [External]
    PROCEDURE AllowedAndPurchCostType@1210190027(VAR Rec@1210190010 : Record 11012046;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;VAR lPurchaseDec@1210190004 : Decimal;VAR lEstimPurchResultDec@1210190003 : Decimal;VAR lPurchCostDec@1210190002 : Decimal;VAR lActualPurchResultDec@1210190001 : Decimal;VAR lTotPurchResultDec@1210190000 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN
        Rec.CalculateAllowedAndPurchase(
          lAllowedDec, lAllowedHoursDec, lPrevAllowedDec, lPrevAllowedHoursDec,
          lPurchaseDec, lEstimPurchResultDec, lPurchCostDec, lActualPurchResultDec, lTotPurchResultDec);

      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
      PurchaseDec := lPurchaseDec;
      EstimPurchResultDec := lEstimPurchResultDec;
      PurchCostDec := lPurchCostDec;
      ActualPurchResultDec := lActualPurchResultDec;
      TotPurchResultDec := TotPurchResultDec;
    END;

    [External]
    PROCEDURE AllowedAndPurchCostObj@1210190035(VAR Rec@1210190010 : Record 11012047;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;VAR lPurchaseDec@1210190004 : Decimal;VAR lEstimPurchResultDec@1210190003 : Decimal;VAR lPurchCostDec@1210190002 : Decimal;VAR lActualPurchResultDec@1210190001 : Decimal;VAR lTotPurchResultDec@1210190000 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN BEGIN
        Rec.CalculateAllowedAndPrevious(lAllowedDec,lAllowedHoursDec,lPrevAllowedDec,lPrevAllowedHoursDec);
        Rec.CalculatePurchaseResults(
          lAllowedDec,lPurchaseDec,lEstimPurchResultDec,lPurchCostDec,lActualPurchResultDec,lTotPurchResultDec);
      END;

      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
      PurchaseDec := lPurchaseDec;
      EstimPurchResultDec := lEstimPurchResultDec;
      PurchCostDec := lPurchCostDec;
      ActualPurchResultDec := lActualPurchResultDec;
      TotPurchResultDec := TotPurchResultDec;
    END;

    [External]
    PROCEDURE AllowedAndPurchElem@1210190078(VAR Rec@1210190010 : Record 11012048;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN
        Rec.CalculateAllowed(lAllowedDec,lAllowedHoursDec,lPrevAllowedDec,lPrevAllowedHoursDec,3,Rec.Element);

      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
    END;

    [External]
    PROCEDURE AllowedAndPurchElemCostType@1210190065(VAR Rec@1210190010 : Record 11012049;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN
        Rec.CalculateAllowed(lAllowedDec,lAllowedHoursDec,lPrevAllowedDec,lPrevAllowedHoursDec);

      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
    END;

    [External]
    PROCEDURE AllowedAndPurchElemCostObj@1210190052(VAR Rec@1210190010 : Record 11012050;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;VAR lPurchaseDec@1100485004 : Decimal;VAR lEstimPurchResultDec@1100485003 : Decimal;VAR lPurchCostDec@1100485002 : Decimal;VAR lActualPurchResultDec@1100485001 : Decimal;VAR lTotPurchResultDec@1100485000 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN BEGIN
        Rec.CalculateAllowedAndPrevious(lAllowedDec,lAllowedHoursDec,lPrevAllowedDec,lPrevAllowedHoursDec);
        //**4PS01.sn
        Rec.CalculatePurchaseResults(
          lAllowedDec,lPurchaseDec,lEstimPurchResultDec,lPurchCostDec,lActualPurchResultDec,lTotPurchResultDec);
        //**4PS01.en
      END;

      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
      //**4PS01.sn
      PurchaseDec := lPurchaseDec;
      EstimPurchResultDec := lEstimPurchResultDec;
      PurchCostDec := lPurchCostDec;
      ActualPurchResultDec := lActualPurchResultDec;
      TotPurchResultDec := TotPurchResultDec;
      //**4PS01.en
    END;

    [External]
    PROCEDURE AllowedAndPurchExt@1210190106(VAR Rec@1210190010 : Record 11012004;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN
        Rec.CalculateAllowed(lAllowedDec,lAllowedHoursDec,lPrevAllowedDec,lPrevAllowedHoursDec);

      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
    END;

    [External]
    PROCEDURE AllowedAndPurchExtCostType@1210190120(VAR Rec@1210190010 : Record 11020222;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN
        Rec.CalculateAllowed(lAllowedDec,lAllowedHoursDec,lPrevAllowedDec,lPrevAllowedHoursDec);

      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
    END;

    [External]
    PROCEDURE AllowedAndPurchExtCostObj@1210190127(VAR Rec@1210190010 : Record 11020223;VAR lAllowedDec@1210190009 : Decimal;VAR lAllowedHoursDec@1210190008 : Decimal;VAR lPrevAllowedDec@1210190007 : Decimal;VAR lPrevAllowedHoursDec@1210190006 : Decimal;ExecCalcFields@1210190011 : Boolean);
    BEGIN
      IF ExecCalcFields THEN
        Rec.CalculateAllowed(lAllowedDec,lAllowedHoursDec,lPrevAllowedDec,lPrevAllowedHoursDec);

      AllowedDec := lAllowedDec;
      AllowedHoursDec := lAllowedHoursDec;
      PrevAllowedDec := lPrevAllowedDec;
      PrevAllowedHoursDec := lPrevAllowedHoursDec;
    END;

    LOCAL PROCEDURE CalcAllowedProject@1210190009(VAR Rec@1210190000 : Record 11072003);
    BEGIN
      AllowedAndPurchProject(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec, FALSE,
        PurchaseDec, EstimPurchResultDec, PurchCostDec, ActualPurchResultDec, TotPurchResultDec,
        TRUE);
    END;

    LOCAL PROCEDURE CalcAllowedCostType@1210190032(VAR Rec@1210190000 : Record 11012046);
    BEGIN
      AllowedAndPurchCostType(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec,
        PurchaseDec, EstimPurchResultDec, PurchCostDec, ActualPurchResultDec, TotPurchResultDec,
        TRUE);
    END;

    LOCAL PROCEDURE CalcAllowedCostObj@1210190046(VAR Rec@1210190000 : Record 11012047);
    BEGIN
      AllowedAndPurchCostObj(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec,
        PurchaseDec, EstimPurchResultDec, PurchCostDec, ActualPurchResultDec, TotPurchResultDec,
        TRUE);
    END;

    LOCAL PROCEDURE CalcAllowedElem@1210190079(VAR Rec@1210190000 : Record 11012048);
    BEGIN
      AllowedAndPurchElem(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec,
        TRUE);
    END;

    LOCAL PROCEDURE CalcAllowedElemCostType@1210190066(VAR Rec@1210190000 : Record 11012049);
    BEGIN
      AllowedAndPurchElemCostType(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec,
        TRUE);
    END;

    LOCAL PROCEDURE CalcAllowedElemCostObj@1210190053(VAR Rec@1210190000 : Record 11012050);
    BEGIN
      AllowedAndPurchElemCostObj(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec,
        PurchaseDec, EstimPurchResultDec, PurchCostDec, ActualPurchResultDec, TotPurchResultDec,     //**4PS01.n
        TRUE);
    END;

    LOCAL PROCEDURE CalcAllowedExt@1210190110(VAR Rec@1210190000 : Record 11012004);
    BEGIN
      AllowedAndPurchExt(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec,
        TRUE);
    END;

    LOCAL PROCEDURE CalcAllowedExtCostType@1210190121(VAR Rec@1210190000 : Record 11020222);
    BEGIN
      AllowedAndPurchExtCostType(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec,
        TRUE);
    END;

    LOCAL PROCEDURE CalcAllowedExtCostObj@1210190128(VAR Rec@1210190000 : Record 11020223);
    BEGIN
      AllowedAndPurchExtCostObj(
        Rec,
        AllowedDec, AllowedHoursDec, PrevAllowedDec, PrevAllowedHoursDec,
        TRUE);
    END;

    [External]
    PROCEDURE AllowedPercProject@1210190005(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        IF Budget = 0 THEN
          AllowedPerc := 100
        ELSE BEGIN
          IF ExecCalcFields THEN
            CalcAllowedProject(Rec);
          AllowedPerc := AllowedDec / Budget * 100;
        END;
        EXIT(AllowedPerc);
      END;
    END;

    [External]
    PROCEDURE AllowedPercCostType@1100485029(VAR Rec@1100485000 : Record 11012046;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        IF Budget = 0 THEN
          AllowedPerc := 100
        ELSE BEGIN
          IF ExecCalcFields THEN
            CalcAllowedCostType(Rec);
          AllowedPerc := AllowedDec / Budget * 100;
        END;
        EXIT(AllowedPerc);
      END;
    END;

    [External]
    PROCEDURE AllowedPercCostObj@1100485028(VAR Rec@1100485000 : Record 11012047;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        IF Budget = 0 THEN
          AllowedPerc := 100
        ELSE BEGIN
          IF ExecCalcFields THEN
            CalcAllowedCostObj(Rec);
          AllowedPerc := AllowedDec / Budget * 100;
        END;
        EXIT(AllowedPerc);
      END;
    END;

    [External]
    PROCEDURE AllowedPercElem@1100485027(VAR Rec@1100485000 : Record 11012048;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        IF Budget = 0 THEN
          AllowedPerc := 100
        ELSE BEGIN
          IF ExecCalcFields THEN
            CalcAllowedElem(Rec);
          AllowedPerc := AllowedDec / Budget * 100;
        END;
        EXIT(AllowedPerc);
      END;
    END;

    [External]
    PROCEDURE AllowedPercServContr@1100485054(VAR Rec@1210190001 : Record 11012812;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        TotAllowedDec := TotAllowedServContr(Rec,ExecCalcFields);
        TotBudgetDec := TotBudgetServContr(Rec,ExecCalcFields);
        IF TotBudgetDec = 0 THEN
          AllowedPerc := 100
        ELSE
          AllowedPerc := TotAllowedDec / TotBudgetDec * 100;
        EXIT(AllowedPerc);
      END;
    END;

    [External]
    PROCEDURE AllowedPercServOrder@1100485057(VAR Rec@1210190001 : Record 11012823;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        TotAllowedDec := TotAllowedServOrder(Rec,ExecCalcFields);
        TotBudgetDec := TotBudgetServOrder(Rec,ExecCalcFields);
        IF TotBudgetDec = 0 THEN
          AllowedPerc := 100
        ELSE
          AllowedPerc := TotAllowedDec / TotBudgetDec * 100;
        EXIT(AllowedPerc);
      END;
    END;

    [External]
    PROCEDURE ResultProject@1210190018(VAR Rec@1210190004 : Record 11072003;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostProject(Rec, ExecCalcFields);
        CalcAllowedProject(Rec);
        Rec.CALCFIELDS("Prognosis Received/To Process");
      END;
      EXIT(AllowedDec - TotCostDec - Rec."Prognosis Received/To Process");
    END;

    [External]
    PROCEDURE ResultCostType@1210190031(VAR Rec@1210190004 : Record 11012046;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostCostType(Rec, ExecCalcFields);
        CalcAllowedCostType(Rec);
        Rec.CALCFIELDS("Prognosis Received/To Process");
      END;
      EXIT(AllowedDec - TotCostDec - Rec."Prognosis Received/To Process");
    END;

    [External]
    PROCEDURE ResultCostObj@1210190057(VAR Rec@1210190004 : Record 11012047;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostCostObj(Rec, ExecCalcFields);
        CalcAllowedCostObj(Rec);
        Rec.CALCFIELDS("Prognosis Received/To Process");
      END;
      EXIT(AllowedDec - TotCostDec - Rec."Prognosis Received/To Process");
    END;

    [External]
    PROCEDURE ResultElem@1210190080(VAR Rec@1210190004 : Record 11012048;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostElem(Rec, ExecCalcFields);
        CalcAllowedElem(Rec);
        Rec.CALCFIELDS("Prognosis Received/To Process");
      END;
      EXIT(AllowedDec - TotCostDec - Rec."Prognosis Received/To Process");
    END;

    [External]
    PROCEDURE ResultElemCostType@1210190067(VAR Rec@1210190004 : Record 11012049;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostElemCostType(Rec, ExecCalcFields);
        CalcAllowedElemCostType(Rec);
        Rec.CALCFIELDS("Prognosis Received/To Process");
      END;
      EXIT(AllowedDec - TotCostDec - Rec."Prognosis Received/To Process");
    END;

    [External]
    PROCEDURE ResultElemCostObj@1210190058(VAR Rec@1210190004 : Record 11012050;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostElemCostObj(Rec, ExecCalcFields);
        CalcAllowedElemCostObj(Rec);
        Rec.CALCFIELDS("Prognosis Received/To Process");
      END;
      EXIT(AllowedDec - TotCostDec - Rec."Prognosis Received/To Process");
    END;

    [External]
    PROCEDURE ResultExt@1210190109(VAR Rec@1210190004 : Record 11012004;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostExt(Rec, ExecCalcFields);
        CalcAllowedExt(Rec);
      END;
      EXIT(AllowedDec - TotCostDec);
    END;

    [External]
    PROCEDURE ResultExtCostType@1210190122(VAR Rec@1210190004 : Record 11020222;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostExtCostType(Rec, ExecCalcFields);
        CalcAllowedExtCostType(Rec);
      END;
      EXIT(AllowedDec - TotCostDec);
    END;

    [External]
    PROCEDURE ResultExtCostObj@1210190129(VAR Rec@1210190004 : Record 11020223;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotCostDec := TotCostExtCostObj(Rec, ExecCalcFields);
        CalcAllowedExtCostObj(Rec);
      END;
      EXIT(AllowedDec - TotCostDec);
    END;

    [External]
    PROCEDURE ResultServContr@1210190088(VAR Rec@1210190004 : Record 11012812;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      TotCostDec := TotCostServContr(Rec, ExecCalcFields);
      TotAllowedDec := TotAllowedServContr(Rec, ExecCalcFields);
      EXIT(TotAllowedDec - TotCostDec);
    END;

    [External]
    PROCEDURE ResultServLoc@1210190101(VAR Rec@1210190004 : Record 11012801;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      TotCostDec := TotCostServLoc(Rec, ExecCalcFields);
      TotAllowedDec := TotAllowedServLoc(Rec, ExecCalcFields);
      EXIT(TotAllowedDec - TotCostDec);
    END;

    [External]
    PROCEDURE ResultServOrder@1210190095(VAR Rec@1210190004 : Record 11012823;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      TotCostDec := TotCostServOrder(Rec, ExecCalcFields);
      TotAllowedDec := TotAllowedServOrder(Rec, ExecCalcFields);
      EXIT(TotAllowedDec - TotCostDec);
    END;

    [External]
    PROCEDURE ResultHoursProject@1100485041(VAR Rec@1210190004 : Record 11072003;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotHoursDec := TotHoursProject(Rec, ExecCalcFields);
        CalcAllowedProject(Rec);
      END;
      EXIT(AllowedHoursDec - TotHoursDec);
    END;

    [External]
    PROCEDURE ResultHoursCostType@1100485040(VAR Rec@1210190004 : Record 11012046;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotHoursDec := TotHoursCostType(Rec, ExecCalcFields);
        CalcAllowedCostType(Rec);
      END;
      EXIT(AllowedHoursDec - TotHoursDec);
    END;

    [External]
    PROCEDURE ResultHoursCostObj@1100485012(VAR Rec@1210190004 : Record 11012047;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotHoursDec := TotHoursCostObj(Rec, ExecCalcFields);
        CalcAllowedCostObj(Rec);
      END;
      EXIT(AllowedHoursDec - TotHoursDec);
    END;

    [External]
    PROCEDURE ResultHoursElem@1100485042(VAR Rec@1210190004 : Record 11012048;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotHoursDec := TotHoursElem(Rec, ExecCalcFields);
        CalcAllowedElem(Rec);
      END;
      EXIT(AllowedHoursDec - TotHoursDec);
    END;

    [External]
    PROCEDURE ResultHoursElemCostType@1100485043(VAR Rec@1210190004 : Record 11012049;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotHoursDec := TotHoursElemCostType(Rec, ExecCalcFields);
        CalcAllowedElemCostType(Rec);
      END;
      EXIT(AllowedHoursDec - TotHoursDec);
    END;

    [External]
    PROCEDURE ResultHoursElemCostObj@1100485044(VAR Rec@1210190004 : Record 11012050;ExecCalcFields@1210190003 : Boolean) : Decimal;
    BEGIN
      IF ExecCalcFields THEN BEGIN
        TotHoursDec := TotHoursElemCostObj(Rec, ExecCalcFields);
        CalcAllowedElemCostObj(Rec);
      END;
      EXIT(AllowedHoursDec - TotHoursDec);
    END;

    [External]
    PROCEDURE ResultPercProject@1210190013(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        IF Budget = 0 THEN
          EXIT(100)
        ELSE
          EXIT( ResultProject(Rec,ExecCalcFields) / Budget * 100);
      END;
    END;

    [External]
    PROCEDURE CalculatedEndResultProject@1210190010(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          AllowedPerc := AllowedPercProject(Rec,ExecCalcFields);
        IF AllowedPerc = 0 THEN
          CalculatedEndResultDec := ResultProject(Rec,ExecCalcFields)
        ELSE
          CalculatedEndResultDec := ResultProject(Rec,ExecCalcFields) / AllowedPerc * 100;
        EXIT(CalculatedEndResultDec);
      END;
    END;

    [External]
    PROCEDURE CalcEndResVersusBudgetProject@1210190012(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        IF Budget = 0 THEN
          EXIT(100)
        ELSE
          EXIT( CalculatedEndResultProject(Rec,ExecCalcFields) / Budget * 100);
      END;
    END;

    [External]
    PROCEDURE BudgetResultProject@1210190004(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        EXIT(TotContrAmntProject(Rec, ExecCalcFields) - Budget );
      END;
    END;

    [External]
    PROCEDURE BudgetResultPercProject@1210190015(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        TotContrAmnt := TotContrAmntProject(Rec, ExecCalcFields);
        IF (TotContrAmnt = 0) THEN
          EXIT(100)
        ELSE
          EXIT(BudgetResultProject(Rec, ExecCalcFields) / TotContrAmnt * 100);
      END;
    END;

    [External]
    PROCEDURE BudgetResultServContr@1100485030(VAR Rec@1210190001 : Record 11012812;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        EXIT(
          TotContrAmntServContr(Rec, ExecCalcFields) -
          TotBudgetServContr(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE BudgetResultPercServContr@1100485031(VAR Rec@1210190001 : Record 11012812;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        TotContrAmnt := TotContrAmntServContr(Rec, ExecCalcFields);
        IF (TotContrAmnt = 0) THEN
          EXIT(100)
        ELSE
          EXIT(BudgetResultServContr(Rec, ExecCalcFields) / TotContrAmnt * 100);
      END;
    END;

    [External]
    PROCEDURE PrognResultProject@1210190002(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Actual Costs", Prognosis);
          CalcAllowedProject(Rec);
        END;
        EXIT(AllowedDec - "Actual Costs" - Prognosis);
      END;
    END;

    [External]
    PROCEDURE PrognResultCostType@1210190033(VAR Rec@1210190001 : Record 11012046;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Actual Costs", Prognosis);
          CalcAllowedCostType(Rec);
        END;
        EXIT(AllowedDec - "Actual Costs" - Prognosis);
      END;
    END;

    [External]
    PROCEDURE PrognResultCostObj@1210190039(VAR Rec@1210190001 : Record 11012047;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Actual Costs", Prognosis);
          CalcAllowedCostObj(Rec);
        END;
        EXIT(AllowedDec - "Actual Costs" - Prognosis);
      END;
    END;

    [External]
    PROCEDURE PrognResultElem@1210190081(VAR Rec@1210190001 : Record 11012048;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Actual Costs", Prognosis);
          CalcAllowedElem(Rec);
        END;
        EXIT(AllowedDec - "Actual Costs" - Prognosis);
      END;
    END;

    [External]
    PROCEDURE PrognResultElemCostType@1210190068(VAR Rec@1210190001 : Record 11012049;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Actual Costs", Prognosis);
          CalcAllowedElemCostType(Rec);
        END;
        EXIT(AllowedDec - "Actual Costs" - Prognosis);
      END;
    END;

    [External]
    PROCEDURE PrognResultElemCostObj@1210190055(VAR Rec@1210190001 : Record 11012050;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN BEGIN
          CALCFIELDS("Actual Costs", Prognosis);
          CalcAllowedElemCostObj(Rec);
        END;
        EXIT(AllowedDec - "Actual Costs" - Prognosis);
      END;
    END;

    [External]
    PROCEDURE PrognEndResVrsContrAmtProject@1210190019(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        EXIT(
          TotContrAmntProject(Rec, ExecCalcFields) -
          PrognTotCostProject(Rec, ExecCalcFields));
      END;
    END;

    [External]
    PROCEDURE PrognEndResVrsContrAmtProjPerc@1210190016(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        TotContrAmnt := TotContrAmntProject(Rec, ExecCalcFields);
        IF (TotContrAmnt = 0) THEN
          EXIT(100)
        ELSE
          EXIT(PrognEndResVrsContrAmtProject(Rec,ExecCalcFields) / TotContrAmnt * 100);
      END;
    END;

    [External]
    PROCEDURE PrognEndResultProject@1210190017(VAR Rec@1210190003 : Record 11072003;ExecCalcFields@1210190002 : Boolean) lPrognEndResultDec : Decimal;
    VAR
      ProjectSetup@1100525000 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        lPrognEndResultDec := Budget - PrognTotCostProject(Rec, ExecCalcFields);

        IF CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
          ProjectSetup.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisRec.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisLineRec.CHANGECOMPANY(CURRENTCOMPANY);
        END;

        IF GETFILTER("Prognosis Filter") <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "No.");
          PrognosisRec.SETFILTER("Prognosis Date", GETFILTER("Prognosis Filter"));
          IF PrognosisRec.FINDFIRST THEN BEGIN
            IF PrognosisRec."Prognosis Level" = PrognosisRec."Prognosis Level"::Rough THEN BEGIN
              lPrognEndResultDec := PrognosisRec."Rough Prognosis End Result";
            END ELSE BEGIN
              ProjectSetup.GET;
              IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
                PrognosisLineRec.SETRANGE("Project No.", "No.");
                PrognosisLineRec.SETFILTER("Prognosis Date", GETFILTER("Prognosis Filter"));
                PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
                IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                  lPrognEndResultDec := 0;
                  REPEAT
                    lPrognEndResultDec := lPrognEndResultDec + PrognosisLineRec."Prognosis End Result";
                  UNTIL PrognosisLineRec.NEXT = 0;
                END;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultCostType@1210190022(VAR Rec@1210190003 : Record 11012046;ExecCalcFields@1210190002 : Boolean) lPrognEndResultDec : Decimal;
    VAR
      ProjectSetup@1210190004 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525000 : Integer;
      PrognDateFilter@1100525001 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        lPrognEndResultDec := Budget - PrognTotCostCostType(Rec, ExecCalcFields);

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "Project No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "Project No.");
              PrognosisLineRec.SETRANGE("Cost Type", "Cost Type");
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultDec := 0;
                REPEAT
                  lPrognEndResultDec := lPrognEndResultDec + PrognosisLineRec."Prognosis End Result";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultCostObj@1210190040(VAR Rec@1210190003 : Record 11012047;ExecCalcFields@1210190002 : Boolean) lPrognEndResultDec : Decimal;
    VAR
      ProjectSetup@1210190004 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
          ProjectSetup.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisRec.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisLineRec.CHANGECOMPANY(CURRENTCOMPANY);
        END;

        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        lPrognEndResultDec := Budget - PrognTotCostCostObj(Rec, ExecCalcFields);

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "Project No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "Project No.");
              PrognosisLineRec.SETRANGE("Cost Object", "Cost Object");
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultDec := 0;
                REPEAT
                  lPrognEndResultDec := lPrognEndResultDec + PrognosisLineRec."Prognosis End Result";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultElem@1210190082(VAR Rec@1210190003 : Record 11012048;ExecCalcFields@1210190002 : Boolean) lPrognEndResultDec : Decimal;
    VAR
      ProjectSetup@1210190004 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        lPrognEndResultDec := Budget - PrognTotCostElem(Rec, ExecCalcFields);

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "Project No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "Project No.");
              PrognosisLineRec.SETRANGE(Element, Element);
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultDec := 0;
                REPEAT
                  lPrognEndResultDec := lPrognEndResultDec + PrognosisLineRec."Prognosis End Result";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultElemCostType@1210190069(VAR Rec@1210190003 : Record 11012049;ExecCalcFields@1210190002 : Boolean) lPrognEndResultDec : Decimal;
    VAR
      ProjectSetup@1210190004 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        lPrognEndResultDec := Budget - PrognTotCostElemCostType(Rec, ExecCalcFields);

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "Project No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "Project No.");
              PrognosisLineRec.SETRANGE(Element, Element);
              PrognosisLineRec.SETRANGE("Cost Type", "Cost Type");
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultDec := 0;
                REPEAT
                  lPrognEndResultDec := lPrognEndResultDec + PrognosisLineRec."Prognosis End Result";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultElemCostObj@1210190056(VAR Rec@1210190003 : Record 11012050;ExecCalcFields@1210190002 : Boolean) lPrognEndResultDec : Decimal;
    VAR
      ProjectSetup@1210190004 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        lPrognEndResultDec := Budget - PrognTotCostElemCostObj(Rec, ExecCalcFields);

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "Project No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "Project No.");
              PrognosisLineRec.SETRANGE(Element, Element);
              PrognosisLineRec.SETRANGE("Cost Object", "Cost Object");
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultDec := 0;
                REPEAT
                  lPrognEndResultDec := lPrognEndResultDec + PrognosisLineRec."Prognosis End Result";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResVersusBudgetProject@1210190020(VAR Rec@1210190001 : Record 11072003;ExecCalcFields@1210190000 : Boolean) : Decimal;
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS(Budget);
        IF Budget = 0 THEN
          EXIT(100)
        ELSE
          EXIT(PrognEndResultProject(Rec, ExecCalcFields) / Budget * 100);
      END;
    END;

    [External]
    PROCEDURE PrognEndResultHoursProject@1100485049(VAR Rec@1210190003 : Record 11072003;ExecCalcFields@1210190002 : Boolean) lPrognEndResultHoursDec : Decimal;
    VAR
      ProjectSetup@1100485000 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Budget Hours (Entire Project)");
        lPrognEndResultHoursDec := "Budget Hours (Entire Project)" - PrognTotHoursProject(Rec, ExecCalcFields);

        IF CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
          ProjectSetup.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisRec.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisLineRec.CHANGECOMPANY(CURRENTCOMPANY);
        END;

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "No.");
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultHoursDec := 0;
                REPEAT
                  lPrognEndResultHoursDec := lPrognEndResultHoursDec + PrognosisLineRec."Prognosis End Result Hours";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultHoursCostType@1100485048(VAR Rec@1210190003 : Record 11012046;ExecCalcFields@1210190002 : Boolean) lPrognEndResultHoursDec : Decimal;
    VAR
      ProjectSetup@1100485000 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF "Cost Type" = "Cost Type"::Labor THEN BEGIN
          IF ExecCalcFields THEN
            CALCFIELDS("Budget Hours");
          lPrognEndResultHoursDec := "Budget Hours" - PrognTotHoursCostType(Rec, ExecCalcFields);

          FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
            FILTERGROUP(FiltGroup);
            IF PrognDateFilter = '' THEN
              IF (GETFILTER("Prognosis Filter") <> '') THEN
                PrognDateFilter := GETFILTER("Prognosis Filter");
          END;

          IF PrognDateFilter <> '' THEN BEGIN
            PrognosisRec.SETRANGE("Project No.", "Project No.");
            PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
            IF PrognosisRec.FINDFIRST THEN BEGIN
              ProjectSetup.GET;
              IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
                PrognosisLineRec.SETRANGE("Project No.", "Project No.");
                PrognosisLineRec.SETRANGE("Cost Type", "Cost Type");
                PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
                PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
                IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                  lPrognEndResultHoursDec := 0;
                  REPEAT
                    lPrognEndResultHoursDec := lPrognEndResultHoursDec + PrognosisLineRec."Prognosis End Result Hours";
                  UNTIL PrognosisLineRec.NEXT = 0;
                END;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultHoursCostObj@1100485011(VAR Rec@1210190003 : Record 11012047;ExecCalcFields@1210190002 : Boolean) lPrognEndResultHoursDec : Decimal;
    VAR
      ProjectSetup@1100485000 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
          ProjectSetup.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisRec.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisLineRec.CHANGECOMPANY(CURRENTCOMPANY);
        END;

        IF ExecCalcFields THEN
          CALCFIELDS("Budget Hours");
        lPrognEndResultHoursDec := "Budget Hours" - PrognTotHoursCostObj(Rec, ExecCalcFields);

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "Project No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "Project No.");
              PrognosisLineRec.SETRANGE("Cost Object", "Cost Object");
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultHoursDec := 0;
                REPEAT
                  lPrognEndResultHoursDec := lPrognEndResultHoursDec + PrognosisLineRec."Prognosis End Result Hours";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultHoursElem@1100485052(VAR Rec@1210190003 : Record 11012048;ExecCalcFields@1210190002 : Boolean) lPrognEndResultHoursDec : Decimal;
    VAR
      ProjectSetup@1100485000 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Budget Hours");
        lPrognEndResultHoursDec := "Budget Hours" - PrognTotHoursElem(Rec, ExecCalcFields);

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "Project No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "Project No.");
              PrognosisLineRec.SETRANGE(Element, Element);
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultHoursDec := 0;
                REPEAT
                  lPrognEndResultHoursDec := lPrognEndResultHoursDec + PrognosisLineRec."Prognosis End Result Hours";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultHoursElemCostTyp@1100485051(VAR Rec@1210190003 : Record 11012049;ExecCalcFields@1210190002 : Boolean) lPrognEndResultHoursDec : Decimal;
    VAR
      ProjectSetup@1100485000 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF "Cost Type" = "Cost Type"::Labor THEN BEGIN
          IF ExecCalcFields THEN
            CALCFIELDS("Budget Hours");
          lPrognEndResultHoursDec := "Budget Hours" - PrognTotHoursElemCostType(Rec, ExecCalcFields);

          FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
            FILTERGROUP(FiltGroup);
            IF PrognDateFilter = '' THEN
              IF (GETFILTER("Prognosis Filter") <> '') THEN
                PrognDateFilter := GETFILTER("Prognosis Filter");
          END;

          IF PrognDateFilter <> '' THEN BEGIN
            PrognosisRec.SETRANGE("Project No.", "Project No.");
            PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
            IF PrognosisRec.FINDFIRST THEN BEGIN
              ProjectSetup.GET;
              IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
                PrognosisLineRec.SETRANGE("Project No.", "Project No.");
                PrognosisLineRec.SETRANGE(Element, Element);
                PrognosisLineRec.SETRANGE("Cost Type", "Cost Type");
                PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
                PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
                IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                  lPrognEndResultHoursDec := 0;
                  REPEAT
                    lPrognEndResultHoursDec := lPrognEndResultHoursDec + PrognosisLineRec."Prognosis End Result Hours";
                  UNTIL PrognosisLineRec.NEXT = 0;
                END;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognEndResultHoursElemCostObj@1100485050(VAR Rec@1210190003 : Record 11012050;ExecCalcFields@1210190002 : Boolean) lPrognEndResultHoursDec : Decimal;
    VAR
      ProjectSetup@1100485000 : Record 315;
      PrognosisRec@1210190001 : Record 11012034;
      PrognosisLineRec@1210190000 : Record 11012035;
      FiltGroup@1100525001 : Integer;
      PrognDateFilter@1100525000 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Budget Hours");
        lPrognEndResultHoursDec := "Budget Hours" - PrognTotHoursElemCostObj(Rec, ExecCalcFields);

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        IF PrognDateFilter <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "Project No.");
          PrognosisRec.SETFILTER("Prognosis Date", PrognDateFilter);
          IF PrognosisRec.FINDFIRST THEN BEGIN
            ProjectSetup.GET;
            IF (ProjectSetup."Fix Prognosis Line") OR (PrognosisRec."Fix Prognosis Line") THEN BEGIN  //db, 13-01-11
              PrognosisLineRec.SETRANGE("Project No.", "Project No.");
              PrognosisLineRec.SETRANGE(Element, Element);
              PrognosisLineRec.SETRANGE("Cost Object", "Cost Object");
              PrognosisLineRec.SETFILTER("Prognosis Date", PrognDateFilter);
              PrognosisLineRec.SETRANGE("Fix Prognosis Line",TRUE);
              IF PrognosisLineRec.FINDSET(FALSE,FALSE) THEN BEGIN
                lPrognEndResultHoursDec := 0;
                REPEAT
                  lPrognEndResultHoursDec := lPrognEndResultHoursDec + PrognosisLineRec."Prognosis End Result Hours";
                UNTIL PrognosisLineRec.NEXT = 0;
              END;
            END;
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE PrognTotFinResultProject@1100525009(VAR Rec@1100525001 : Record 11072003;ExecCalcFields@1100525000 : Boolean;VAR PrognTotCost@1100525005 : Decimal;VAR PrognRevenues@1100525003 : Decimal;VAR PrognTotRevenue@1100525004 : Decimal;VAR PrognFinResult@1100525006 : Decimal;VAR ExpFinishDate@1100525007 : Date;VAR PrognLevel@1100525008 : 'Detailed,,Rough');
    VAR
      PrognosisRec@1100525002 : Record 11012034;
      PrognosisSubProj@1100525010 : Record 11012034;
      SubProject@1100525011 : Record 11072003;
      CostContMgt@1100525013 : Codeunit 11012006;
      PrognosisPresent@1100525009 : Boolean;
    BEGIN
      PrognTotCost := 0;
      PrognRevenues := 0;
      PrognTotRevenue := 0;
      PrognFinResult := 0;
      ExpFinishDate := 0D;
      PrognLevel := Rec."Prognosis Level";

      WITH Rec DO BEGIN
        IF CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
          PrognosisRec.CHANGECOMPANY(CURRENTCOMPANY);
          PrognosisSubProj.CHANGECOMPANY(CURRENTCOMPANY);
          SubProject.CHANGECOMPANY(CURRENTCOMPANY);
        END;
        CostContMgt.SetCompany(CURRENTCOMPANY);

        IF GETFILTER("Prognosis Filter") <> '' THEN BEGIN
          PrognosisRec.SETRANGE("Project No.", "No.");
          PrognosisRec.SETFILTER("Prognosis Date", GETFILTER("Prognosis Filter"));
          IF PrognosisRec.FINDFIRST THEN BEGIN
            PrognosisPresent := TRUE;
            CASE PrognosisRec."Prognosis Level" OF
              PrognosisRec."Prognosis Level"::Rough:
                BEGIN
                  PrognTotCost := PrognosisRec."Rough Prognosis Total Cost";
                  PrognTotRevenue := PrognosisRec."Rough Prognosis Total Revenues";
                END;
              PrognosisRec."Prognosis Level"::Element:
                BEGIN
                  PrognosisRec.CALCFIELDS("Prognosis Total Cost Element", "Prognosis Revenue Element");
                  PrognTotCost := PrognosisRec."Prognosis Total Cost Element";
                  PrognRevenues := PrognosisRec."Prognosis Revenue Element";
                  PrognTotRevenue := PrognosisRec.GetRevenueProjectInvoiced + PrognosisRec."Prognosis Revenue Element";
                END;
              PrognosisRec."Prognosis Level"::Detailed:
                BEGIN
                  PrognosisRec.CALCFIELDS("Prognosis Revenue");
                  IF ExecCalcFields THEN
                    CALCFIELDS("Prognosis Total Cost");
      //>>pure286109
      //            PrognTotCost := "Prognosis Total Cost";
      //            PrognRevenues := PrognosisRec."Prognosis Revenue";
      //            PrognTotRevenue := PrognosisRec.GetRevenueProjectInvoiced + PrognosisRec."Prognosis Revenue";
                  IF "Forecast Level" = "Forecast Level"::"Cost Component" THEN
                    PrognosisRec.CALCFIELDS("Prognosis Revenue CC","Prognosis Total Revenue CC");
      //            IF ExecCalcFields AND ("Forecast Level" = "Forecast Level"::"Cost Component") THEN
                  IF ("Forecast Level" = "Forecast Level"::"Cost Component") THEN
                    CALCFIELDS("Prognosis Total Cost CC");
                  PrognTotCost := "Prognosis Total Cost" + "Prognosis Total Cost CC";
                  PrognRevenues := PrognosisRec."Prognosis Revenue" + PrognosisRec."Prognosis Total Revenue CC";
                  PrognTotRevenue := PrognosisRec."Project Invoiced" + PrognosisRec."Prognosis Revenue" + PrognosisRec."Prognosis Total Revenue CC";
      //<<pure286109
              END;
            END;
            ExpFinishDate := PrognosisRec."Expected Finishing Date";
            PrognLevel := PrognosisRec."Prognosis Level";
          END;
        END;

        IF ("Single/Main/Sub Project" = "Single/Main/Sub Project"::"Main Project") AND NOT PrognosisPresent THEN BEGIN
          //This part speeds up situations in which no prognoses are made
          PrognosisSubProj.SETCURRENTKEY("Main Project No.","Prognosis Date");
          PrognosisSubProj.SETRANGE("Main Project No.", "No.");
          PrognosisSubProj.SETFILTER("Prognosis Date",GETFILTER("Cumulation Filter"));
          IF NOT PrognosisSubProj.ISEMPTY THEN BEGIN
          //
            PrognosisPresent := TRUE;
            SubProject.SETCURRENTKEY("Main Project");
            SubProject.SETRANGE("Main Project", "Main Project");
            Rec.COPYFILTER("Cumulation Filter", SubProject."Cumulation Filter");
            IF SubProject.FINDSET THEN
              REPEAT
                SubProject.SETRANGE("Project Filter", SubProject."No.");
                PrognosisSubProj.RESET;
                IF CURRENTCOMPANY <> COMPANYNAME THEN
                  PrognosisSubProj.CHANGECOMPANY(CURRENTCOMPANY);
                PrognosisSubProj.SETRANGE("Project No.", SubProject."No.");
                PrognosisSubProj.SETFILTER("Prognosis Date", GETFILTER("Cumulation Filter"));
                IF PrognosisSubProj.FINDLAST THEN BEGIN
                  CASE PrognosisSubProj."Prognosis Level" OF
                    PrognosisSubProj."Prognosis Level"::Rough:
                      BEGIN
                        PrognTotCost += PrognosisSubProj."Rough Prognosis Total Cost";
                        PrognTotRevenue += PrognosisSubProj."Rough Prognosis Total Revenues";
                      END;
                    PrognosisSubProj."Prognosis Level"::Detailed:
                      BEGIN
                        PrognosisSubProj.CALCFIELDS("Prognosis Revenue", "Prognosis Total Cost");
                        PrognTotCost += PrognosisSubProj."Prognosis Total Cost";
                        PrognRevenues += PrognosisSubProj."Prognosis Revenue";
                        PrognTotRevenue += PrognosisSubProj.GetRevenueProjectInvoiced + PrognosisSubProj."Prognosis Revenue";
                      END;
                    PrognosisSubProj."Prognosis Level"::Element:
                      BEGIN
                        PrognosisSubProj.CALCFIELDS("Prognosis Revenue Element", "Prognosis Total Cost Element");
                        PrognTotCost += PrognosisSubProj."Prognosis Total Cost Element";
                        PrognRevenues += PrognosisSubProj."Prognosis Revenue Element";
                        PrognTotRevenue += PrognosisSubProj.GetRevenueProjectInvoiced + PrognosisSubProj."Prognosis Revenue Element";
                      END;
                  END;

      //>>pure286109
                  IF "Forecast Level" = "Forecast Level"::"Cost Component" THEN
                    PrognosisSubProj.CALCFIELDS("Prognosis Revenue CC", "Prognosis Total Cost CC");
                  PrognTotCost := PrognTotCost + PrognosisSubProj."Prognosis Total Cost CC";
                  PrognRevenues := PrognRevenues + PrognosisSubProj."Prognosis Revenue CC";
                  PrognTotRevenue := PrognTotRevenue + PrognosisSubProj."Prognosis Revenue CC";
      //<<pure286109

                  IF PrognosisRec."Expected Finishing Date" > ExpFinishDate THEN
                    ExpFinishDate := PrognosisRec."Expected Finishing Date";
                END ELSE
                  PrognTotCost := PrognTotCost + CostContMgt.TotCostProject(SubProject, TRUE);
              UNTIL SubProject.NEXT = 0;
          END;
        END;

        IF NOT PrognosisPresent THEN BEGIN
          IF ExecCalcFields THEN BEGIN
            TotCostDec := TotCostProject(Rec, ExecCalcFields);
            CALCFIELDS(Revenues);
          END;
          PrognTotCost := TotCostDec;
          PrognTotRevenue := Revenues;
        END;
        PrognFinResult := PrognTotRevenue - PrognTotCost;

      END;
    END;

    [External]
    PROCEDURE PrognTotRevenuesElem@1100529606(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190002 : Boolean) : Decimal;
    VAR
      PrognosisRec@1210190004 : Record 11012034;
      SubProjRec@1210190007 : Record 11072003;
      SubControlProjectElem@1210190006 : Record 11012048;
      PrognTotRevenue@1210190005 : Decimal;
      FiltGroup@1210190003 : Integer;
      PrognDateFilter@1210190001 : Text[250];
    BEGIN
      WITH Rec DO BEGIN
        IF ExecCalcFields THEN
          CALCFIELDS("Prognosis Total Revenues");

        FOR FiltGroup := 4 DOWNTO 0 DO BEGIN
          FILTERGROUP(FiltGroup);
          IF PrognDateFilter = '' THEN
            IF (GETFILTER("Prognosis Filter") <> '') THEN
              PrognDateFilter := GETFILTER("Prognosis Filter");
        END;

        GetProject("Project No.");
        IF (Project."Single/Main/Sub Project" = Project."Single/Main/Sub Project"::"Main Project") THEN BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF PrognosisRec."Project No." = '' THEN BEGIN
            SubProjRec.SETCURRENTKEY("Main Project");
            SubProjRec.SETRANGE("Main Project", "Main Project No.");
            Rec.COPYFILTER("Cumulation Filter", SubProjRec."Cumulation Filter");
            IF SubProjRec.FINDSET THEN BEGIN
              REPEAT
                SubControlProjectElem.COPY(Rec);
                SubControlProjectElem.SETRANGE("Project Filter", SubProjRec."No.");
                SubControlProjectElem."Project No." := SubProjRec."No.";
                IF SubProjRec."No." = "Main Project No." THEN BEGIN
                  SubControlProjectElem.CALCFIELDS(Revenues);
                  PrognTotRevenue += SubControlProjectElem.Revenues;
                END ELSE
                  PrognTotRevenue += CostContMgt.PrognTotRevenuesElem(SubControlProjectElem, TRUE);
              UNTIL SubProjRec.NEXT = 0;
              EXIT(PrognTotRevenue);
            END;
          END;
        END;

      //
        IF ("Prognosis Total Revenues" = 0) AND (PrognDateFilter = '') THEN BEGIN
          IF ExecCalcFields THEN
            CALCFIELDS(Revenues);
          EXIT(Revenues);
        END ELSE BEGIN
          GetPrognosis(PrognosisRec, "Project No.", PrognDateFilter);
          IF PrognosisRec."Fix Prognosis Line" THEN
            EXIT("Prognosis Total Revenues")
          ELSE BEGIN
            IF ExecCalcFields THEN
              CALCFIELDS(Revenues, "Prognosis Revenues");
            EXIT(Revenues + "Prognosis Revenues");
          END;
        END;
      END;
    END;

    [External]
    PROCEDURE InventoryProject@1210190014(VAR Rec@1210190002 : Record 11072003;ExecCalcFields@1210190001 : Boolean) lProjInventAmt : Decimal;
    VAR
      ProjInventRec@1210190000 : Record 11012670;
    BEGIN
      WITH Rec DO BEGIN
        lProjInventAmt := 0;
        ProjInventRec.RESET;
        IF CURRENTCOMPANY <> COMPANYNAME THEN
          ProjInventRec.CHANGECOMPANY(CURRENTCOMPANY);
        ProjInventRec.SETCURRENTKEY("Project No.");
        ProjInventRec.SETRANGE("Project No.", "No.");
        ProjInventRec.SETFILTER("Posting Date", GETFILTER("Cumulation Filter"));
        IF ProjInventRec.FINDSET(FALSE,FALSE) THEN BEGIN
          REPEAT
            lProjInventAmt := lProjInventAmt + (ProjInventRec.Quantity * ProjInventRec.GetItemPrice());
          UNTIL ProjInventRec.NEXT = 0;
        END;
      END;
    END;

    [External]
    PROCEDURE InclOpenPurchase@1100525000() : Boolean;
    BEGIN
      IF NOT SetupRead THEN BEGIN
        JobSetup.GET;
        SetupRead := TRUE;
      END;

      EXIT(NOT JobSetup."Total Cost Excl. Open Purchase");
    END;

    [External]
    PROCEDURE NumericFilter@1100530000(Text@11012001 : Text[250]) Res@11012000 : Boolean;
    BEGIN
      //db, 11-01-11: M24919
      EXIT(DELCHR(Text,'=','0123456789')='');
    END;

    [External]
    PROCEDURE GetPrognosis@1210190011(VAR Prognosis@1210190000 : Record 11012034;ProjCde@1210190001 : Code[20];PrognDateTxt@1210190002 : Text[250]);
    VAR
      PrognDate@1210190003 : Date;
    BEGIN
      IF PrognDateTxt = '' THEN BEGIN
        CLEAR(Prognosis);
        EXIT;
      END;

      IF NOT EVALUATE(PrognDate, PrognDateTxt) THEN BEGIN
        CLEAR(Prognosis);
        EXIT;
      END;

      IF (Prognosis."Project No." = ProjCde) AND (Prognosis."Prognosis Date" = PrognDate) THEN
        EXIT;

      Prognosis.SETRANGE("Project No.", ProjCde);
      Prognosis.SETRANGE("Prognosis Date", PrognDate);
      IF NOT Prognosis.FINDFIRST THEN
        CLEAR(Prognosis);
    END;

    [External]
    PROCEDURE GetProject@1210190087(ProjNo@1210190000 : Code[20]);
    BEGIN
      IF Project."No." = ProjNo THEN
        EXIT;

      IF NOT Project.GET(ProjNo) THEN
        CLEAR(Project);
    END;

    [External]
    PROCEDURE CheckBudgetOrAllowedPresent@1100409000(VAR Job@1100409000 : Record 11072003) : Boolean;
    VAR
      BudgetLine@1100409001 : Record 11012001;
      ProgressLine@1100409002 : Record 11012037;
    BEGIN
      //C010480
      IF Job.CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
        BudgetLine.CHANGECOMPANY(Job.CURRENTCOMPANY);
        ProgressLine.CHANGECOMPANY(Job.CURRENTCOMPANY);
      END;

      IF NOT BudgetOrAllowedCheckedGlobal THEN BEGIN
        BudgetOrAllowedPresentGlobal := NOT (BudgetLine.ISEMPTY AND ProgressLine.ISEMPTY);
        BudgetOrAllowedCheckedGlobal := TRUE;
      END;

      IF NOT BudgetOrAllowedPresentGlobal THEN
        EXIT(FALSE);

      IF Job."Single/Main/Sub Project" = Job."Single/Main/Sub Project"::"Main Project" THEN BEGIN
        IF BudgetOrAllowedCheckedMainProj <> Job."Main Project" THEN BEGIN
          BudgetLine.SETCURRENTKEY("Main Project No.");
          BudgetLine.SETRANGE("Main Project No.", Job."Main Project");
          ProgressLine.SETCURRENTKEY("Main Project No.");
          ProgressLine .SETRANGE("Main Project No.", Job."Main Project");
          BudgetOrAllowedPresentMainProj := NOT (BudgetLine.ISEMPTY AND ProgressLine.ISEMPTY);
          BudgetOrAllowedCheckedMainProj := Job."Main Project";
        END;
        EXIT(BudgetOrAllowedPresentMainProj);
      END ELSE BEGIN
        IF BudgetOrAllowedCheckedProject <> Job."No." THEN BEGIN
          BudgetLine.RESET;
          IF Job.CURRENTCOMPANY <> COMPANYNAME THEN
            BudgetLine.CHANGECOMPANY(Job.CURRENTCOMPANY);
          BudgetLine.SETCURRENTKEY("Project No.");
          BudgetLine.SETRANGE("Project No.", Job."No.");
          ProgressLine.SETCURRENTKEY("Project No.");
          ProgressLine.SETRANGE("Project No.", Job."No.");
          BudgetOrAllowedPresentProject := NOT (BudgetLine.ISEMPTY AND ProgressLine.ISEMPTY);
          BudgetOrAllowedCheckedProject := Job."No.";
        END;
        EXIT(BudgetOrAllowedPresentProject);
      END;
    END;

    [External]
    PROCEDURE POControlLineAmtFCY@1100529408(Project@1100529411 : Record 11072003;ProjectForecastHeader@1100529412 : Record 11020630;VAR ProjectForecastLineTmp@1100529406 : TEMPORARY Record 11020631;VAR ProjectForecastinPeriodTmp@1100529413 : TEMPORARY Record 11020632);
    VAR
      PurchSetup@1100529402 : Record 312;
      PurchaseOrderControlLine@1100529400 : Record 11020221;
      PurchaseHeader@1100529600 : Record 38;
      PurchLine@1100529405 : Record 39;
      PurchReceiptLine@1100529408 : Record 121;
      PurchInvLine@1100529407 : Record 123;
      PurchCredMemoLine@1100529401 : Record 125;
      IncludeVATAmount@1100529404 : Boolean;
      CurrCode@1100529403 : Code[10];
      OutstandingAmount@1100529415 : Decimal;
      ReceivedNotInvoicedAmount@1100529414 : Decimal;
      TotalHours@1100529703 : Decimal;
      InvoicedAmount@1100529601 : Decimal;
      ExpectedReceiptDate@1100529409 : Date;
      LineNoLoc@1100529410 : Integer;
    BEGIN
      //**4PS.sn BI042 KD 01-09-16
      ProjectForecastLineTmp.RESET;
      ProjectForecastLineTmp.DELETEALL;
      ProjectForecastinPeriodTmp.RESET;
      ProjectForecastinPeriodTmp.DELETEALL;

      WITH PurchaseOrderControlLine DO BEGIN
        SETRANGE("Project No.", ProjectForecastHeader."Project No.");
        SETRANGE("Main Project No.", Project."Main Project");
        SETRANGE(Date, 0D, ProjectForecastHeader."Forecast Date");
        IF ISEMPTY THEN
          EXIT;

        PurchSetup.GET;
        IF (PurchSetup."VAT Indicator (Purchase)" = PurchSetup."VAT Indicator (Purchase)"::"No VAT") AND
           (Project."VAT Indicator (Purchase)" = Project."VAT Indicator (Purchase)"::"No VAT")
        THEN
          IncludeVATAmount := TRUE;

        SETCURRENTKEY("Order No.", "Order Line No.");
        FINDSET;
        REPEAT
          SETRANGE("Order No.", "Order No.");
          CALCSUMS("Hours Rcd. Not Invoiced", "Outstanding Amount", "Amt. Rcd. Not Invoiced", "Overhead Surcharge Soft", "Overhead Surcharge Firm");
          IF ("Hours Rcd. Not Invoiced" = 0) AND ("Outstanding Amount" = 0) AND ("Amt. Rcd. Not Invoiced" = 0) AND
             ("Overhead Surcharge Soft" = 0) AND ("Overhead Surcharge Firm" = 0)
          THEN BEGIN
            FINDLAST;
            SETRANGE("Order No.");
          END ELSE BEGIN
            SETRANGE("Line Type", "Line Type"::Invoice);
            CALCSUMS("Amt. Rcd. Not Invoiced");
            InvoicedAmount := - "Amt. Rcd. Not Invoiced";
            SETRANGE("Line Type");

            CurrCode := '';
            IF PurchaseHeader.GET(PurchaseHeader."Document Type"::Order, "Order No.") THEN
              CurrCode := PurchaseHeader."Currency Code";

            SETCURRENTKEY("Order No.", "Order Line No.");
            FINDSET;
            REPEAT
              IF NOT PurchLine.GET(PurchLine."Document Type"::Order, "Order No.", "Order Line No.") THEN
                CLEAR(PurchLine);
              PurchLine.CALCFIELDS("Purchase Order Type");
              IF PurchLine."Expected Receipt Date" <= ProjectForecastHeader."Forecast Date" THEN
                ExpectedReceiptDate := CALCDATE('<1D>', ProjectForecastHeader."Forecast Date")
              ELSE
                ExpectedReceiptDate := PurchLine."Expected Receipt Date";

              SETRANGE("Order Line No.", "Order Line No.");
              CALCSUMS("Hours Rcd. Not Invoiced", "Outstanding Amount", "Amt. Rcd. Not Invoiced", "Overhead Surcharge Soft", "Overhead Surcharge Firm");

              IF (CurrCode = '') OR (PurchLine."Line No." = 0) THEN BEGIN
                IF (PurchLine."Line No." <> 0) AND
                   (PurchLine."Purchase Order Type" = PurchLine."Purchase Order Type"::"Blanket Order")
                THEN
                  ProcessBlanketScheme(Project, ProjectForecastHeader, ProjectForecastLineTmp, ProjectForecastinPeriodTmp, PurchaseOrderControlLine, PurchLine,
                                       IncludeVATAmount, CurrCode, "Outstanding Amount", "Amt. Rcd. Not Invoiced", InvoicedAmount, LineNoLoc);
                AddProjectForecastLine(Project, ProjectForecastHeader, PurchaseOrderControlLine, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
                  '', ExpectedReceiptDate, LineNoLoc);
              END ELSE BEGIN

                TotalHours := "Hours Rcd. Not Invoiced";

                IF ("Overhead Surcharge Soft" <> 0) OR ("Overhead Surcharge Firm" <> 0) THEN BEGIN
                  "Hours Rcd. Not Invoiced" := 0;
                  "Outstanding Amount" := 0;
                  "Amt. Rcd. Not Invoiced" := 0;
                  AddProjectForecastLine(Project, ProjectForecastHeader, PurchaseOrderControlLine, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
                    '', ExpectedReceiptDate, LineNoLoc);
                END;

                OutstandingAmount := 0;
                ReceivedNotInvoicedAmount := 0;

                IF ("Outstanding Amount" <> 0) OR ("Amt. Rcd. Not Invoiced" <> 0) THEN BEGIN

                  FINDSET;
                  REPEAT
                    CASE "Line Type" OF
                      "Line Type"::Order:
                        IF IncludeVATAmount AND (PurchLine."VAT %" <> 0) THEN
                          OutstandingAmount += ROUND(PurchLine.Amount * (1 + PurchLine."VAT %" / 100),0.00001)
                        ELSE
                          OutstandingAmount += PurchLine.Amount;

                      "Line Type"::Receipt:
                        IF PurchReceiptLine.GET("Receipt No.", "Receipt Line No.") THEN BEGIN
                          ReceivedNotInvoicedAmount += PurchReceiptLine."Received (line)";
                          OutstandingAmount -= PurchReceiptLine."Received (line)";
                        END ELSE BEGIN
                          "Overhead Surcharge Soft" := 0;
                          "Overhead Surcharge Firm" := 0;
                          AddProjectForecastLine(Project, ProjectForecastHeader, PurchaseOrderControlLine, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
                            '', ExpectedReceiptDate, LineNoLoc);
                        END;

                      "Line Type"::Invoice:
                        IF PurchInvLine.GET("Invoice Document No.", "Invoice Line No.") THEN BEGIN
                          IF IncludeVATAmount AND (PurchInvLine."VAT %" <> 0) THEN
                            ReceivedNotInvoicedAmount -= ROUND(PurchInvLine."Amount Including VAT", 0.00001)
                          ELSE
                            ReceivedNotInvoicedAmount -= ROUND(PurchInvLine.Amount, 0.00001);
                        END ELSE BEGIN
                          "Overhead Surcharge Soft" := 0;
                          "Overhead Surcharge Firm" := 0;
                          AddProjectForecastLine(Project, ProjectForecastHeader, PurchaseOrderControlLine, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
                            '', ExpectedReceiptDate, LineNoLoc);
                        END;

                      "Line Type"::"Credit Memo":
                        IF PurchCredMemoLine.GET("Credit Memo Document No.", "Credit Memo Line No.") THEN BEGIN
                          IF IncludeVATAmount AND (PurchCredMemoLine."VAT %" <> 0) THEN
                            ReceivedNotInvoicedAmount -= ROUND(PurchCredMemoLine."Amount Including VAT", 0.00001)
                          ELSE
                            ReceivedNotInvoicedAmount -= ROUND(PurchCredMemoLine.Amount, 0.00001);
                        END ELSE BEGIN
                          "Overhead Surcharge Soft" := 0;
                          "Overhead Surcharge Firm" := 0;
                          AddProjectForecastLine(Project, ProjectForecastHeader, PurchaseOrderControlLine, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
                            '', ExpectedReceiptDate, LineNoLoc);
                        END;
                    END;
                  UNTIL NEXT = 0;

                  IF PurchLine."Purchase Order Type" = PurchLine."Purchase Order Type"::"Blanket Order" THEN
                    ProcessBlanketScheme(Project, ProjectForecastHeader, ProjectForecastLineTmp, ProjectForecastinPeriodTmp, PurchaseOrderControlLine, PurchLine,
                                         IncludeVATAmount, CurrCode, OutstandingAmount, ReceivedNotInvoicedAmount, InvoicedAmount, LineNoLoc);
                END;

                "Hours Rcd. Not Invoiced" := TotalHours;
                "Outstanding Amount" := OutstandingAmount;
                "Amt. Rcd. Not Invoiced" := ReceivedNotInvoicedAmount;
                "Overhead Surcharge Soft" := 0;
                "Overhead Surcharge Firm" := 0;
                AddProjectForecastLine(Project, ProjectForecastHeader, PurchaseOrderControlLine, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
                  CurrCode, ExpectedReceiptDate, LineNoLoc);
              END;

              FINDLAST;
              SETRANGE("Order Line No.");
            UNTIL NEXT = 0;
            SETRANGE("Order No.");
          END;
        UNTIL NEXT = 0;
      END;

      ProjectForecastLineTmp.RESET;
      ProjectForecastinPeriodTmp.RESET;
      //**4PS.en BI042 KD 01-09-16
    END;

    LOCAL PROCEDURE AddProjectForecastLineWithAmountCheck@1100529604(VAR CheckAmount@1100529606 : Decimal;VAR TotalAmount@1100529605 : Decimal;AmtReceived@1100529600 : Boolean;Project@1100529411 : Record 11072003;ProjectForecastHeader@1100529412 : Record 11020630;PurchaseOrderControlLine@1100529602 : Record 11020221;VAR ProjectForecastLineTmp@1100529406 : TEMPORARY Record 11020631;VAR ProjectForecastinPeriodTmp@1100529610 : TEMPORARY Record 11020632;CurrCode@1100529609 : Code[10];ExpectedReceiptDate@1100529604 : Date;VAR LineNoLoc@1100529612 : Integer);
    VAR
      AmtLoc@1100529607 : Decimal;
    BEGIN
      //C039897
      IF (CheckAmount = 0) OR (TotalAmount = 0) THEN
        EXIT;

      IF CheckAmount >= TotalAmount THEN
        AmtLoc := TotalAmount
      ELSE
        AmtLoc := CheckAmount;
      CheckAmount -= AmtLoc;
      TotalAmount -= AmtLoc;

      IF AmtReceived THEN BEGIN
        PurchaseOrderControlLine."Amt. Rcd. Not Invoiced" := AmtLoc;
        PurchaseOrderControlLine."Outstanding Amount" := 0;
      END ELSE BEGIN
        PurchaseOrderControlLine."Amt. Rcd. Not Invoiced" := 0;
        PurchaseOrderControlLine."Outstanding Amount" := AmtLoc;
      END;

      AddProjectForecastLine(Project, ProjectForecastHeader, PurchaseOrderControlLine, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
        CurrCode, ExpectedReceiptDate, LineNoLoc);
    END;

    LOCAL PROCEDURE AddProjectForecastLine@1100529603(Project@1100529411 : Record 11072003;ProjectForecastHeader@1100529412 : Record 11020630;PurchaseOrderControlLine@1100529602 : Record 11020221;VAR ProjectForecastLineTmp@1100529406 : TEMPORARY Record 11020631;VAR ProjectForecastinPeriodTmp@1100529610 : TEMPORARY Record 11020632;CurrCode@1100529609 : Code[10];ExpectedReceiptDate@1100529604 : Date;VAR LineNoLoc@1100529612 : Integer);
    VAR
      CostType@1100529603 : Integer;
      CostObj@1100529601 : Code[20];
      Element@1100529600 : Code[20];
    BEGIN
      //C038253
      CostType := PurchaseOrderControlLine."Cost Type" - 1;
      CASE Project."Forecast Level" OF
        Project."Forecast Level"::"Element - Cost Object":
          BEGIN
            Element := PurchaseOrderControlLine.Element;
            CostObj := PurchaseOrderControlLine."Shortcut Dimension 2 Code";
          END;
        Project."Forecast Level"::"Element - Cost Type":
          BEGIN
            Element := PurchaseOrderControlLine.Element;
            CostObj := '';
          END;
        Project."Forecast Level"::"Cost Object":
          BEGIN
            Element := '';
            CostObj := PurchaseOrderControlLine."Shortcut Dimension 2 Code";
          END;
        Project."Forecast Level"::"Cost Type":
          BEGIN
            Element := '';
            CostObj := '';
          END;
      END;

      IF NOT ProjectForecastLineTmp.GET(
        ProjectForecastHeader."Project No.",
        ProjectForecastHeader."Forecast Date",
        CostType,
        Element,
        CostObj,
        CurrCode )
      THEN BEGIN
        ProjectForecastLineTmp.INIT;
        ProjectForecastLineTmp."Project No." := ProjectForecastHeader."Project No.";
        ProjectForecastLineTmp."Forecast Date" := ProjectForecastHeader."Forecast Date";
        ProjectForecastLineTmp."Cost Type" := CostType;
        ProjectForecastLineTmp.Element := Element;
        ProjectForecastLineTmp."Cost Object" := CostObj;
        ProjectForecastLineTmp."Currency Code" := CurrCode;
        ProjectForecastLineTmp."Open (Purchase)" := PurchaseOrderControlLine."Outstanding Amount";
        ProjectForecastLineTmp."Received/Not Invoiced" := PurchaseOrderControlLine."Amt. Rcd. Not Invoiced";
        ProjectForecastLineTmp."Total Hours" := PurchaseOrderControlLine."Hours Rcd. Not Invoiced";
        ProjectForecastLineTmp."Open Ovh. Surch. (Purchase)" := PurchaseOrderControlLine."Overhead Surcharge Soft";
        ProjectForecastLineTmp."Open Ovh. Surch. (Inventory)" := PurchaseOrderControlLine."Overhead Surcharge Firm";
        ProjectForecastLineTmp.INSERT;
      END ELSE BEGIN
        ProjectForecastLineTmp."Open (Purchase)" += PurchaseOrderControlLine."Outstanding Amount";
        ProjectForecastLineTmp."Received/Not Invoiced" += PurchaseOrderControlLine."Amt. Rcd. Not Invoiced";
        ProjectForecastLineTmp."Total Hours" += PurchaseOrderControlLine."Hours Rcd. Not Invoiced";
        ProjectForecastLineTmp."Open Ovh. Surch. (Purchase)" += PurchaseOrderControlLine."Overhead Surcharge Soft";
        ProjectForecastLineTmp."Open Ovh. Surch. (Inventory)" += PurchaseOrderControlLine."Overhead Surcharge Firm";
        ProjectForecastLineTmp.MODIFY;
      END;

      IF PurchaseOrderControlLine."Outstanding Amount" <> 0 THEN
        AddProjectForecastinPeriod(ProjectForecastLineTmp, ProjectForecastinPeriodTmp, ExpectedReceiptDate,
          ProjectForecastinPeriodTmp.Source::"Outstanding Purchase", PurchaseOrderControlLine."Order No.", LineNoLoc, PurchaseOrderControlLine."Outstanding Amount");

      IF PurchaseOrderControlLine."Overhead Surcharge Soft" <> 0 THEN
        AddProjectForecastinPeriod(ProjectForecastLineTmp, ProjectForecastinPeriodTmp, ExpectedReceiptDate,
          ProjectForecastinPeriodTmp.Source::"Outstanding Purchase", PurchaseOrderControlLine."Order No.", LineNoLoc, PurchaseOrderControlLine."Overhead Surcharge Soft");

      IF PurchaseOrderControlLine."Amt. Rcd. Not Invoiced" <> 0 THEN
        AddProjectForecastinPeriod(ProjectForecastLineTmp, ProjectForecastinPeriodTmp, ExpectedReceiptDate,
          ProjectForecastinPeriodTmp.Source::"Received Not Invoiced", PurchaseOrderControlLine."Order No.", LineNoLoc, PurchaseOrderControlLine."Amt. Rcd. Not Invoiced");

      IF PurchaseOrderControlLine."Overhead Surcharge Firm" <> 0 THEN
        AddProjectForecastinPeriod(ProjectForecastLineTmp, ProjectForecastinPeriodTmp, ExpectedReceiptDate,
          ProjectForecastinPeriodTmp.Source::"Received Not Invoiced", PurchaseOrderControlLine."Order No.", LineNoLoc, PurchaseOrderControlLine."Overhead Surcharge Firm");
    END;

    LOCAL PROCEDURE AddProjectForecastinPeriod@1100529427(ProjectForecastLineTmp@1100529401 : TEMPORARY Record 11020631;VAR ProjectForecastinPeriodTmp@1100529400 : TEMPORARY Record 11020632;ExpectedReceiptDate@1100529402 : Date;Source@1100529403 : Option;DocNo@1100529404 : Code[20];VAR LineNo@1100529405 : Integer;Amount@1100529406 : Decimal);
    BEGIN
      ProjectForecastinPeriodTmp.SETRANGE("Project No.", ProjectForecastLineTmp."Project No.");
      ProjectForecastinPeriodTmp.SETRANGE("Forecast Date", ProjectForecastLineTmp."Forecast Date");
      ProjectForecastinPeriodTmp.SETRANGE("Cost Type", ProjectForecastLineTmp."Cost Type");
      ProjectForecastinPeriodTmp.SETRANGE(Element, ProjectForecastLineTmp.Element);
      ProjectForecastinPeriodTmp.SETRANGE("Cost Object", ProjectForecastLineTmp."Cost Object");
      ProjectForecastinPeriodTmp.SETRANGE("Currency Code", ProjectForecastLineTmp."Currency Code");
      ProjectForecastinPeriodTmp.SETRANGE(Date, ExpectedReceiptDate);
      ProjectForecastinPeriodTmp.SETRANGE(Source, Source);
      ProjectForecastinPeriodTmp.SETRANGE("Document No.", DocNo);
      IF NOT ProjectForecastinPeriodTmp.FINDFIRST THEN BEGIN
        LineNo += 1;
        ProjectForecastinPeriodTmp.INIT;
        ProjectForecastinPeriodTmp."Project No." := ProjectForecastLineTmp."Project No.";
        ProjectForecastinPeriodTmp."Forecast Date" := ProjectForecastLineTmp."Forecast Date";
        ProjectForecastinPeriodTmp."Cost Type" := ProjectForecastLineTmp."Cost Type";
        ProjectForecastinPeriodTmp.Element := ProjectForecastLineTmp.Element;
        ProjectForecastinPeriodTmp."Cost Object" := ProjectForecastLineTmp."Cost Object";
        ProjectForecastinPeriodTmp."Currency Code" := ProjectForecastLineTmp."Currency Code";
        ProjectForecastinPeriodTmp.Date := ExpectedReceiptDate;
        ProjectForecastinPeriodTmp."Line No." := LineNo;
        ProjectForecastinPeriodTmp.Amount := Amount;
        ProjectForecastinPeriodTmp.Source := Source;
        ProjectForecastinPeriodTmp."Document No." := DocNo;
        ProjectForecastinPeriodTmp.INSERT;
      END ELSE BEGIN
        ProjectForecastinPeriodTmp.Amount += Amount;
        ProjectForecastinPeriodTmp.MODIFY;
      END;
    END;

    [External]
    PROCEDURE TotCostCostTypeFCY@1100529405(VAR Rec@1210190000 : Record 11012046;ExecCalcFields@1210190001 : Boolean;OpenPurchDec@1100529400 : Decimal;ReceivedNotInvoicedDec@1100529401 : Decimal;FirmPurchDec@1100529403 : Decimal;SoftPurchDec@1100529404 : Decimal;CurrCode@1100529402 : Code[10]) : Decimal;
    BEGIN
      //**4PS.sn BI042 KD 01-09-16
      WITH Rec DO BEGIN
        IF CurrCode <> '' THEN BEGIN
           CALCFIELDS(
            "Actual Costs (FCY)", "Open Amount (Hours) (FCY)");

          TotCostDec :=
            "Actual Costs (FCY)" +
            ReceivedNotInvoicedDec + FirmPurchDec +
            "Open Amount (Hours) (FCY)";

          IF InclOpenPurchase THEN
            TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;
          EXIT(TotCostDec);
        END;

        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs (FCY)",
            "Open Amount (Hours) (FCY)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs (FCY)" +
          ReceivedNotInvoicedDec + FirmPurchDec +
          "Open Amount (Hours) (FCY)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;

        EXIT(TotCostDec);
      END;
      //**4PS.en BI042 KD 01-09-16
    END;

    [External]
    PROCEDURE TotCostCostObjFCY@1100529403(VAR Rec@1210190000 : Record 11012047;ExecCalcFields@1210190001 : Boolean;OpenPurchDec@1100529401 : Decimal;ReceivedNotInvoicedDec@1100529400 : Decimal;FirmPurchDec@1100529404 : Decimal;SoftPurchDec@1100529403 : Decimal;CurrCode@1100529402 : Code[10]) : Decimal;
    BEGIN
      //**4PS.sn BI042 KD 01-09-16
      WITH Rec DO BEGIN
        IF CurrCode <> '' THEN BEGIN
           CALCFIELDS(
            "Actual Costs (FCY)", "Open Amount (Hours) (FCY)");

          TotCostDec :=
            "Actual Costs (FCY)" +
            ReceivedNotInvoicedDec + FirmPurchDec +
            "Open Amount (Hours) (FCY)";

          IF InclOpenPurchase THEN
            TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;
          EXIT(TotCostDec);
        END;

        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs (FCY)",
            "Open Amount (Hours) (FCY)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs (FCY)" +
          ReceivedNotInvoicedDec + FirmPurchDec +
          "Open Amount (Hours) (FCY)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;

        EXIT(TotCostDec);
      END;
      //**4PS.en BI042 KD 01-09-16
    END;

    [External]
    PROCEDURE TotCostElemFCY@1100529402(VAR Rec@1210190000 : Record 11012048;ExecCalcFields@1210190001 : Boolean;OpenPurchDec@1100529401 : Decimal;ReceivedNotInvoicedDec@1100529400 : Decimal;FirmPurchDec@1100529404 : Decimal;SoftPurchDec@1100529403 : Decimal;CurrCode@1100529402 : Code[10]) : Decimal;
    BEGIN
      //**4PS.sn BI042 KD 01-09-16
      WITH Rec DO BEGIN
       IF CurrCode <> '' THEN BEGIN
          CALCFIELDS(
            "Actual Costs (FCY)", "Open Amount (Hours) (FCY)");

          TotCostDec :=
            "Actual Costs (FCY)" +
            ReceivedNotInvoicedDec + FirmPurchDec +
            "Open Amount (Hours) (FCY)";

          IF InclOpenPurchase THEN
            TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;
          EXIT(TotCostDec);
        END;

        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs (FCY)",
            "Open Amount (Hours) (FCY)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs (FCY)" +
          ReceivedNotInvoicedDec + FirmPurchDec +
          "Open Amount (Hours) (FCY)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;

        EXIT(TotCostDec);
      END;
      //**4PS.en BI042 KD 01-09-16
    END;

    [External]
    PROCEDURE TotCostElemCostTypeFCY@1100529401(VAR Rec@1210190000 : Record 11012049;ExecCalcFields@1210190001 : Boolean;OpenPurchDec@1100529401 : Decimal;ReceivedNotInvoicedDec@1100529400 : Decimal;FirmPurchDec@1100529404 : Decimal;SoftPurchDec@1100529403 : Decimal;CurrCode@1100529402 : Code[10]) : Decimal;
    BEGIN
      //**4PS.sn BI042 KD 01-09-16
      WITH Rec DO BEGIN
        IF CurrCode <> '' THEN BEGIN
          CALCFIELDS(
            "Actual Costs (FCY)", "Open Amount (Hours) (FCY)");

          TotCostDec :=
            "Actual Costs (FCY)" +
            ReceivedNotInvoicedDec + FirmPurchDec +
            "Open Amount (Hours) (FCY)";

          IF InclOpenPurchase THEN
            TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;
          EXIT(TotCostDec);
        END;

        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs (FCY)",
            "Open Amount (Hours) (FCY)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs (FCY)" +
          ReceivedNotInvoicedDec + FirmPurchDec +
          "Open Amount (Hours) (FCY)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;

        EXIT(TotCostDec);
      END;
      //**4PS.en BI042 KD 01-09-16
    END;

    [External]
    PROCEDURE TotCostElemCostObjFCY@1100529400(VAR Rec@1210190000 : Record 11012050;ExecCalcFields@1210190001 : Boolean;OpenPurchDec@1100529401 : Decimal;ReceivedNotInvoicedDec@1100529400 : Decimal;FirmPurchDec@1100529404 : Decimal;SoftPurchDec@1100529403 : Decimal;CurrCode@1100529402 : Code[10]) : Decimal;
    BEGIN
      //**4PS.sn BI042 KD 01-09-16
      WITH Rec DO BEGIN
        IF CurrCode <> '' THEN BEGIN
          CALCFIELDS(
            "Actual Costs (FCY)", "Open Amount (Hours) (FCY)");

          TotCostDec :=
            "Actual Costs (FCY)" +
            ReceivedNotInvoicedDec + FirmPurchDec +
            "Open Amount (Hours) (FCY)";

          IF InclOpenPurchase THEN
            TotCostDec := TotCostDec + OpenPurchDec + SoftPurchDec;
          EXIT(TotCostDec);
        END;

        IF ExecCalcFields THEN
          CALCFIELDS(
            "Actual Costs (FCY)",
            "Open Amount (Hours) (FCY)", "Open Ovh. Surch. (Hours)",
            "Open (Inventory)", "Open Ovh. Surch. (Inventory)",
            "Risc Coverage (Prognosis)");

        TotCostDec :=
          "Actual Costs (FCY)" +
          ReceivedNotInvoicedDec + FirmPurchDec +
          "Open Amount (Hours) (FCY)" + "Open Ovh. Surch. (Hours)" +
          "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
          "Risc Coverage (Prognosis)";

        IF InclOpenPurchase THEN
          TotCostDec := TotCostDec + OpenPurchDec +  SoftPurchDec;

        EXIT(TotCostDec);
      END;
      //**4PS.en BI042 KD 01-09-16
    END;

    [External]
    PROCEDURE GetHoursFromOtherCompanies@1100529600(VAR TmpHourAccountingLine@1100529600 : TEMPORARY Record 11012039;ServiceOrder@1100529602 : Record 11012823;VAR TotalHoursAmt@1100529603 : Decimal;VAR TotalHours@1100529604 : Decimal);
    VAR
      Company@1100529605 : Record 2000000006;
      GLSetup@1100529607 : Record 98;
      HourAccountingLine@1100529601 : Record 11012039;
      CurrencyExchangeRate@1100529609 : Record 330;
      InstallationManagement@1100528400 : Codeunit 11012268;
      LCYCode@1100529608 : Code[10];
      LineNo@1100529606 : Integer;
    BEGIN
      //DP01450
      IF InstallationManagement.NoLicensePermissionForTableData(DATABASE::"Hour Accounting Line") OR
         NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(TmpHourAccountingLine)
      THEN
        EXIT;

      TmpHourAccountingLine.RESET;
      TmpHourAccountingLine.DELETEALL;

      TotalHoursAmt := 0;
      TotalHours := 0;

      GLSetup.GET;
      LCYCode := GLSetup."LCY Code";

      Company.SETFILTER(Name, '<>%1', COMPANYNAME);
      IF Company.FINDSET THEN
        REPEAT
          HourAccountingLine.RESET;
          IF HourAccountingLine.CHANGECOMPANY(Company.Name) THEN BEGIN
            HourAccountingLine.SETCURRENTKEY("Receiving Company", "Base Service Order No.", "Service Order No.", "Cost Component", "Posting Date");
            HourAccountingLine.SETRANGE("Receiving Company", COMPANYNAME);
            HourAccountingLine.SETRANGE("Base Service Order No.", ServiceOrder."No.");
            HourAccountingLine.SETRANGE("Service Order No.", ServiceOrder."No.");
            HourAccountingLine.SETFILTER("Cost Component", ServiceOrder.GETFILTER("Cost Component Filter"));
            HourAccountingLine.SETFILTER("Posting Date", ServiceOrder.GETFILTER("Period Filter"));
            IF HourAccountingLine.FINDSET THEN BEGIN
              GLSetup.CHANGECOMPANY(Company.Name);
              GLSetup.GET;

              REPEAT
                LineNo := 0;
                WHILE TmpHourAccountingLine.GET(HourAccountingLine.Year, HourAccountingLine.Week, HourAccountingLine."Employee No.", HourAccountingLine."Line No." + LineNo) DO
                  LineNo += 10000;

                TmpHourAccountingLine := HourAccountingLine;
                TmpHourAccountingLine."Line No." := HourAccountingLine."Line No." + LineNo;
                TmpHourAccountingLine."Origin Company" := Company.Name;

                IF GLSetup."LCY Code" <> LCYCode THEN
                  IF HourAccountingLine."Currency Code" = LCYCode THEN BEGIN
                    TmpHourAccountingLine."Amount (LCY)" := HourAccountingLine.Amount;
                    TmpHourAccountingLine."Currency Code" := '';
                  END ELSE BEGIN
                    IF HourAccountingLine."Amount (LCY)" <> 0 THEN
                      TmpHourAccountingLine."Amount (LCY)" :=
                        CurrencyExchangeRate.ExchangeAmtFCYToLCY(0, '', HourAccountingLine."Posting Date",
                          GLSetup."LCY Code", HourAccountingLine."Amount (LCY)",
                          CurrencyExchangeRate.ExchangeRate(0, '', HourAccountingLine."Posting Date",
                          GLSetup."LCY Code", FALSE), FALSE);
                    TmpHourAccountingLine."Currency Code" := GLSetup."LCY Code";
                  END;

                TmpHourAccountingLine.INSERT;

                TotalHours += HourAccountingLine."Total Line";
                TotalHoursAmt += HourAccountingLine."Amount (LCY)";
              UNTIL HourAccountingLine.NEXT = 0;
            END;
          END;
        UNTIL Company.NEXT = 0;
    END;

    [External]
    PROCEDURE GetOpenHoursSiteMngmntFromCurrentCompany@1100528401(VAR TmpSiteMngmntHoursLine@1100528403 : TEMPORARY Record 11012361;Type@1100528402 : Integer;ObjectNo@1100528401 : Code[20];VAR OpenHours@1100528400 : Decimal);
    VAR
      InstallationManagement@1100528404 : Codeunit 11012268;
    BEGIN
      IF InstallationManagement.NoLicensePermissionForTableData(DATABASE::"Site Mngmnt. Hours Line") OR
         NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(TmpSiteMngmntHoursLine)
      THEN
        EXIT;

      TmpSiteMngmntHoursLine.RESET;
      TmpSiteMngmntHoursLine.DELETEALL;

      OpenHours := GetOpenHoursSiteMngmnt(TmpSiteMngmntHoursLine, COMPANYNAME, Type, ObjectNo);
    END;

    [External]
    PROCEDURE GetOpenHoursSiteMngmntFromOtherCompanies@1100528400(VAR TmpSiteMngmntHoursLine@1100528402 : TEMPORARY Record 11012361;Type@1100528401 : Integer;ObjectNo@1100528400 : Code[20];VAR OpenHours@1100528403 : Decimal);
    VAR
      InstallationManagement@1100528404 : Codeunit 11012268;
      Company@1100529605 : Record 2000000006;
    BEGIN
      IF InstallationManagement.NoLicensePermissionForTableData(DATABASE::"Site Mngmnt. Hours Line") OR
         NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(TmpSiteMngmntHoursLine)
      THEN
        EXIT;

      TmpSiteMngmntHoursLine.RESET;
      TmpSiteMngmntHoursLine.DELETEALL;

      OpenHours := 0;

      Company.SETFILTER(Name, '<>%1', COMPANYNAME);
      IF Company.FINDSET THEN
        REPEAT
          OpenHours += GetOpenHoursSiteMngmnt(TmpSiteMngmntHoursLine, Company.Name, Type, ObjectNo);
        UNTIL Company.NEXT = 0;
    END;

    LOCAL PROCEDURE GetOpenHoursSiteMngmnt@1100528410(VAR TmpSiteMngmntHoursLine@1100528402 : TEMPORARY Record 11012361;CompanyName2@1100528401 : Text[30];Type@1100528403 : Integer;ObjectNo@1100528404 : Code[20]) OpenHours : Decimal;
    VAR
      SiteMngmntHoursLine@1100528400 : Record 11012361;
      LineNo@1100528405 : Integer;
    BEGIN
      IF NOT SiteMngmntHoursLine.CHANGECOMPANY(CompanyName2) THEN
        EXIT;

      SiteMngmntHoursLine.SETRANGE(Type, Type);
      SiteMngmntHoursLine.SETRANGE("Object No.", ObjectNo);
      SiteMngmntHoursLine.SETRANGE("Receiving Company", COMPANYNAME);
      SiteMngmntHoursLine.SETFILTER(Status, '<%1', SiteMngmntHoursLine.Status::Posted);
      IF SiteMngmntHoursLine.FINDSET THEN
        REPEAT
          LineNo := 0;
          WHILE TmpSiteMngmntHoursLine.GET(
            SiteMngmntHoursLine.Year, SiteMngmntHoursLine.Week, SiteMngmntHoursLine."Supplying Company",
            SiteMngmntHoursLine."Employee No.", SiteMngmntHoursLine."Line No." + LineNo)
          DO
            LineNo += 10000;
          TmpSiteMngmntHoursLine := SiteMngmntHoursLine;
          TmpSiteMngmntHoursLine."Line No." := SiteMngmntHoursLine."Line No." + LineNo;
          TmpSiteMngmntHoursLine."Origin Company" := CompanyName2;
          TmpSiteMngmntHoursLine.INSERT;
          OpenHours += SiteMngmntHoursLine."Total Line";
        UNTIL SiteMngmntHoursLine.NEXT = 0;
    END;

    [External]
    PROCEDURE SetCompany@1100529602(RunInCompanyName@1100529600 : Text[30]);
    BEGIN
      SetupRead := FALSE;
      CLEAR(JobSetup);
      CLEAR(Project);

      IF (RunInCompanyName <> '') AND (RunInCompanyName <> COMPANYNAME) THEN BEGIN
        JobSetup.CHANGECOMPANY(RunInCompanyName);
        Project.CHANGECOMPANY(RunInCompanyName);
      END;
    END;

    LOCAL PROCEDURE ProcessBlanketScheme@1100529605(Project@1100529608 : Record 11072003;ProjectForecastHeader@1100529607 : Record 11020630;VAR ProjectForecastLineTmp@1100529606 : TEMPORARY Record 11020631;VAR ProjectForecastinPeriodTmp@1100529605 : TEMPORARY Record 11020632;PurchaseOrderControlLine@1100529612 : Record 11020221;PurchaseLine@1100529600 : Record 39;IncludeVATAmount@1100529609 : Boolean;CurrencyCode@1100529602 : Code[10];VAR OutstandingAmount@1100529614 : Decimal;VAR ReceivedNotInvoicedAmount@1100529613 : Decimal;VAR InvoicedAmount@1100529611 : Decimal;VAR LineNoLoc@1100529616 : Integer);
    VAR
      PurchaseOrderControlLineLoc@1100529617 : Record 11020221;
      BlanketScheme@1100529601 : Record 11012066;
      Currency@1100529603 : Record 4;
      ExpectedReceiptDate@1100529615 : Date;
      UnitPrice@1100529604 : Decimal;
      TotAmtLoc@1100529610 : Decimal;
      BlanketSchemeReceivedAmount@1100529618 : Decimal;
    BEGIN
      IF (OutstandingAmount = 0) AND (ReceivedNotInvoicedAmount = 0) THEN
        EXIT;

      BlanketScheme.SETRANGE("Document No.", PurchaseLine."Document No.");
      BlanketScheme.SETRANGE("Document Line No.", PurchaseLine."Line No.");
      IF BlanketScheme.ISEMPTY THEN
        EXIT;

      PurchaseOrderControlLineLoc := PurchaseOrderControlLine;
      PurchaseOrderControlLineLoc."Outstanding Amount" := 0;
      PurchaseOrderControlLineLoc."Overhead Surcharge Soft" := 0;
      PurchaseOrderControlLineLoc."Amt. Rcd. Not Invoiced" := 0;
      PurchaseOrderControlLineLoc."Overhead Surcharge Firm" := 0;

      Currency.Initialize(CurrencyCode);
      IF IncludeVATAmount THEN
        UnitPrice := PurchaseLine."Amount Including VAT"
      ELSE
        UnitPrice := PurchaseLine.Amount;
      IF PurchaseLine."Quantity (Base)" <> 0 THEN
        UnitPrice := UnitPrice / PurchaseLine."Quantity (Base)";

      BlanketScheme.SETRANGE("Receipts Created", TRUE);
      BlanketScheme.SETRANGE("Blanket Date", 0D, ProjectForecastHeader."Forecast Date");
      BlanketScheme.CALCSUMS(Quantity);
      BlanketSchemeReceivedAmount := ROUND(BlanketScheme.Quantity * UnitPrice, Currency."Amount Rounding Precision");
      IF ReceivedNotInvoicedAmount >= BlanketSchemeReceivedAmount THEN
        ReceivedNotInvoicedAmount -= BlanketSchemeReceivedAmount
      ELSE BEGIN
        BlanketSchemeReceivedAmount := ReceivedNotInvoicedAmount;
        ReceivedNotInvoicedAmount := 0;
      END;

      BlanketScheme.SETRANGE("Receipts Created");
      BlanketScheme.SETRANGE("Blanket Date");
      BlanketScheme.FINDSET;
      REPEAT
        TotAmtLoc := ROUND(BlanketScheme.Quantity * UnitPrice, Currency."Amount Rounding Precision");
        IF (TotAmtLoc <> 0) AND (InvoicedAmount <> 0) THEN
          IF InvoicedAmount > TotAmtLoc THEN BEGIN
            InvoicedAmount -= TotAmtLoc;
            TotAmtLoc := 0;
          END ELSE BEGIN
            TotAmtLoc -= InvoicedAmount;
            InvoicedAmount := 0;
          END;

        IF TotAmtLoc <> 0 THEN BEGIN
          IF BlanketScheme."Blanket Date" <= ProjectForecastHeader."Forecast Date" THEN
            ExpectedReceiptDate := CALCDATE('<1D>', ProjectForecastHeader."Forecast Date")
          ELSE
            ExpectedReceiptDate := BlanketScheme."Blanket Date";

          IF BlanketScheme."Receipts Created" AND (BlanketScheme."Blanket Date" <= ProjectForecastHeader."Forecast Date") THEN
            AddProjectForecastLineWithAmountCheck(BlanketSchemeReceivedAmount, TotAmtLoc, TRUE,
              Project, ProjectForecastHeader, PurchaseOrderControlLineLoc, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
              CurrencyCode, ExpectedReceiptDate, LineNoLoc);

          AddProjectForecastLineWithAmountCheck(ReceivedNotInvoicedAmount, TotAmtLoc, TRUE,
            Project, ProjectForecastHeader, PurchaseOrderControlLineLoc, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
            CurrencyCode, ExpectedReceiptDate, LineNoLoc);

          AddProjectForecastLineWithAmountCheck(OutstandingAmount, TotAmtLoc, FALSE,
            Project, ProjectForecastHeader, PurchaseOrderControlLineLoc, ProjectForecastLineTmp, ProjectForecastinPeriodTmp,
            CurrencyCode, ExpectedReceiptDate, LineNoLoc);
        END;
      UNTIL (BlanketScheme.NEXT = 0) OR
            ((OutstandingAmount = 0) AND (ReceivedNotInvoicedAmount = 0) AND (BlanketSchemeReceivedAmount = 0));
    END;

    [External]
    PROCEDURE CalcPrognosisAmountElement@1100529607(VAR ProjectLoc@1100529601 : Record 11072003);
    VAR
      PrognosisLoc@1100529602 : Record 11012034;
      PrognosisPerElementLoc@1100529600 : Record 11071893;
    BEGIN
      IF ProjectLoc.GETFILTER("Prognosis Filter") <> '' THEN BEGIN
        IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
          PrognosisLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
        PrognosisLoc.SETRANGE("Project No.", ProjectLoc."No.");
        PrognosisLoc.SETFILTER("Prognosis Date", ProjectLoc.GETFILTER("Prognosis Filter"));
        IF PrognosisLoc.ISEMPTY THEN
          EXIT;
        PrognosisLoc.FINDFIRST;
        IF PrognosisLoc."Prognosis Level" <> PrognosisLoc."Prognosis Level"::Element THEN
          EXIT;
        IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
          PrognosisPerElementLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
        PrognosisPerElementLoc.SETRANGE("Main Project No.", ProjectLoc."Main Project");
        PrognosisPerElementLoc.SETFILTER("Project No.", ProjectLoc.GETFILTER("Project Filter"));
        PrognosisPerElementLoc.SETRANGE("Prognosis Date", PrognosisLoc."Prognosis Date");
        PrognosisPerElementLoc.CALCSUMS(Amount);
        ProjectLoc.Prognosis := PrognosisPerElementLoc.Amount;
      END;
    END;

    [External]
    PROCEDURE DrillDownPrognosisAmount@1100529608(VAR ProjectLoc@1100529601 : Record 11072003);
    VAR
      PrognosisLoc@1100529602 : Record 11012034;
      PrognosisLineLoc@1100529600 : Record 11012035;
      PrognosisPerElementLoc@1100529603 : Record 11071893;
    BEGIN
      IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
        PrognosisLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
      PrognosisLoc.SETRANGE("Project No.", ProjectLoc."No.");
      PrognosisLoc.SETFILTER("Prognosis Date", ProjectLoc.GETFILTER("Prognosis Filter"));
      IF PrognosisLoc.ISEMPTY THEN
        EXIT;
      PrognosisLoc.FINDFIRST;
      IF PrognosisLoc."Prognosis Level" = PrognosisLoc."Prognosis Level"::Element THEN BEGIN
        IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
          PrognosisPerElementLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
        PrognosisPerElementLoc.SETRANGE("Main Project No.", ProjectLoc."Main Project");
        PrognosisPerElementLoc.SETFILTER("Project No.", ProjectLoc.GETFILTER("Project Filter"));
        PrognosisPerElementLoc.SETRANGE("Prognosis Date", PrognosisLoc."Prognosis Date");
        PAGE.RUNMODAL(PAGE::"Prognosis Element Line List", PrognosisPerElementLoc);
      END ELSE BEGIN
        IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
          PrognosisLineLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
        PrognosisLineLoc.SETRANGE("Main Project No.", ProjectLoc."Main Project");
        PrognosisLineLoc.SETFILTER("Project No.", ProjectLoc.GETFILTER("Project Filter"));
        PrognosisLineLoc.SETFILTER("Prognosis Date", ProjectLoc.GETFILTER("Prognosis Filter"));
        PAGE.RUNMODAL(PAGE::"Prognosis Line List", PrognosisLineLoc);
      END;
    END;

    [External]
    PROCEDURE CalcPrognosisFieldsElement@1100529601(VAR ProjectLoc@1100529600 : Record 11072003;VAR ControlProjectElementLoc@1210190000 : Record 11012048;VAR PrognosisLoc@1100529602 : Record 11012034);
    VAR
      PrognosisPerElementLoc@1100529601 : Record 11071893;
    BEGIN
      CLEAR(PrognosisLoc);
      IF ProjectLoc.GETFILTER("Prognosis Filter") <> '' THEN BEGIN
        IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
          PrognosisLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
        PrognosisLoc.SETRANGE("Project No.", ProjectLoc."No.");
        PrognosisLoc.SETFILTER("Prognosis Date", ProjectLoc.GETFILTER("Prognosis Filter"));
        IF PrognosisLoc.ISEMPTY THEN
          EXIT;
        PrognosisLoc.FINDFIRST;
        IF PrognosisLoc."Prognosis Level" <> PrognosisLoc."Prognosis Level"::Element THEN
          EXIT;
        IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
          PrognosisPerElementLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
        PrognosisPerElementLoc.SETRANGE("Main Project No.", ProjectLoc."Main Project");
        PrognosisPerElementLoc.SETFILTER("Project No.", ProjectLoc.GETFILTER("Project Filter"));
        PrognosisPerElementLoc.SETFILTER(Element, ControlProjectElementLoc.GETFILTER("Element Filter"));
        PrognosisPerElementLoc.SETRANGE("Prognosis Date", PrognosisLoc."Prognosis Date");
        PrognosisPerElementLoc.CALCSUMS(Amount, "Prognosis Total Cost", "Amount Revenue", "Prognosis Total Revenues");
        ControlProjectElementLoc.Prognosis := PrognosisPerElementLoc.Amount;
        ControlProjectElementLoc."Prognosis Total Cost" := PrognosisPerElementLoc."Prognosis Total Cost";
        ControlProjectElementLoc."Prognosis Revenues" := PrognosisPerElementLoc."Amount Revenue";
        ControlProjectElementLoc."Prognosis Total Revenues" := PrognosisPerElementLoc."Prognosis Total Revenues";
      END;
    END;

    [External]
    PROCEDURE DrillDownPrognosisFieldsElement@1100529609(VAR ProjectLoc@1100529600 : Record 11072003;VAR ControlProjectElementLoc@1210190000 : Record 11012048);
    VAR
      PrognosisLoc@1100529602 : Record 11012034;
      PrognosisLineLoc@1100529603 : Record 11012035;
      PrognosisPerElementLoc@1100529601 : Record 11071893;
    BEGIN
      IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
        PrognosisLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
      PrognosisLoc.SETRANGE("Project No.", ProjectLoc."No.");
      PrognosisLoc.SETFILTER("Prognosis Date", ProjectLoc.GETFILTER("Prognosis Filter"));
      IF PrognosisLoc.ISEMPTY THEN
        EXIT;
      PrognosisLoc.FINDFIRST;
      IF PrognosisLoc."Prognosis Level" = PrognosisLoc."Prognosis Level"::Element THEN BEGIN
        IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
          PrognosisPerElementLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
        PrognosisPerElementLoc.SETRANGE("Main Project No.", ProjectLoc."Main Project");
        PrognosisPerElementLoc.SETFILTER("Project No.", ProjectLoc.GETFILTER("Project Filter"));
        PrognosisPerElementLoc.SETFILTER(Element, ControlProjectElementLoc.GETFILTER("Element Filter"));
        PrognosisPerElementLoc.SETRANGE("Prognosis Date", PrognosisLoc."Prognosis Date");
        PAGE.RUNMODAL(PAGE::"Prognosis Element Line List", PrognosisPerElementLoc);
      END ELSE BEGIN
        IF ProjectLoc.CURRENTCOMPANY <> COMPANYNAME THEN
          PrognosisLineLoc.CHANGECOMPANY(ProjectLoc.CURRENTCOMPANY);
        PrognosisLineLoc.SETRANGE("Main Project No.", ProjectLoc."Main Project");
        PrognosisLineLoc.SETFILTER("Project No.", ProjectLoc.GETFILTER("Project Filter"));
        PrognosisLineLoc.SETFILTER(Element, ControlProjectElementLoc.GETFILTER("Element Filter"));
        PrognosisLineLoc.SETFILTER("Prognosis Date", ProjectLoc.GETFILTER("Prognosis Filter"));
        PAGE.RUNMODAL(PAGE::"Prognosis Line List", PrognosisLineLoc);
      END;
    END;

    [External]
    PROCEDURE CalcTotalEstimateResult@1100529632(ProjectNo@1100529601 : Code[20];EstimateResultDateFilter@1100529600 : Date) : Decimal;
    VAR
      ProjectLoc@1100529608 : Record 11072003;
    BEGIN
      ProjectLoc.GET(ProjectNo);
      ProjectLoc.SETFILTER("Project Filter", ProjectNo);
      ProjectLoc.SETFILTER("Cumulation Filter", '..%1', EstimateResultDateFilter);
      ProjectLoc.CALCFIELDS(Budget);
      EXIT(TotContrAmntProject(ProjectLoc, TRUE) - ProjectLoc.Budget);
    END;

    [External]
    PROCEDURE CalcProjectBudget@1100529613(ProjectNo@1100529611 : Code[20];VersionDateFilter@1100529608 : Date;VAR OriginalBudget@1100529602 : Decimal;VAR ExtensionBudget@1100529603 : Decimal;VAR OptionsBudget@1100529604 : Decimal;VAR AdjustmentBudget@1100529606 : Decimal);
    VAR
      BudgetLine@1100529601 : Record 11012001;
    BEGIN
      OriginalBudget := 0;
      ExtensionBudget := 0;
      OptionsBudget := 0;
      AdjustmentBudget := 0;

      BudgetLine.SETRANGE("Project No.", ProjectNo);
      BudgetLine.SETFILTER("Version Date", '..%1', VersionDateFilter);
      IF BudgetLine.ISEMPTY THEN
        EXIT;

      BudgetLine.SETRANGE("Extension Contract", '');
      BudgetLine.SETRANGE(Option, '');
      BudgetLine.SETRANGE(Adjustment, '');
      BudgetLine.CALCSUMS("Amount (LCY)");
      OriginalBudget := BudgetLine."Amount (LCY)";

      BudgetLine.SETFILTER("Extension Contract", '<>%1', '');
      BudgetLine.SETFILTER("Extension Contract Status", '%1|%2',
        BudgetLine."Extension Contract Status"::Order,
        BudgetLine."Extension Contract Status"::"Invoicing Allowed");
      BudgetLine.CALCSUMS("Amount (LCY)");
      ExtensionBudget := BudgetLine."Amount (LCY)";
      BudgetLine.SETRANGE("Extension Contract", '');
      BudgetLine.SETRANGE("Extension Contract Status");

      BudgetLine.SETFILTER(Option, '<>%1', '');
      BudgetLine.CALCSUMS("Amount (LCY)");
      OptionsBudget := BudgetLine."Amount (LCY)";

      BudgetLine.SETRANGE("Extension Contract");
      BudgetLine.SETRANGE(Option);

      BudgetLine.SETFILTER("Extension Contract Status", '%1|%2|%3', 0,
        BudgetLine."Extension Contract Status"::Order,
        BudgetLine."Extension Contract Status"::"Invoicing Allowed");
      BudgetLine.SETFILTER(Adjustment, '<>%1', '');
      BudgetLine.CALCSUMS("Amount (LCY)");
      AdjustmentBudget := BudgetLine."Amount (LCY)";
    END;

    LOCAL PROCEDURE "** IMSE-008"@1100285000();
    BEGIN
    END;

    PROCEDURE FBoxSub1RevenuesExp@1100285001(VAR pProjectNo@1100285007 : Code[20];ExecCalcFields@1210190001 : Boolean) : Decimal;
    VAR
      lProjContr@1100285000 : Record 11012046;
      lProjectInstallment@1100285002 : Record 11012018;
      lTotal@1100285001 : Decimal;
      lTotal1@1100285003 : Decimal;
      lTotal2@1100285004 : Decimal;
      lTotal3@1100285006 : Decimal;
      lProject@1100285005 : Record 11072003;
    BEGIN
      lTotal:= 0;
      //
      IF lProject.GET(pProjectNo) THEN
      BEGIN
        IF lProject."Single/Main/Sub Project" = lProject."Single/Main/Sub Project" :: "Main Project" THEN
        BEGIN
        CLEAR(lProject);
        lProject.SETRANGE("Main Project"  , pProjectNo);
      //>>IME424x
      //  IF lProject.FINDFIRST THEN
        IF lProject.FINDSET(FALSE) THEN
      //<<IME424x
           REPEAT
             lProjectInstallment.RESET;
             lProjectInstallment.SETRANGE("Project No.", lProject."No." );
             //lProjectInstallment.SETRANGE(Chargeable ,   TRUE);
      //>>IME424x
      //       IF lProjectInstallment.FINDFIRST THEN
             IF lProjectInstallment.FINDSET(FALSE) THEN
      //<<IME424x
                REPEAT
                  lProjectInstallment.CALCFIELDS("Invoice in Process (LCY)","Invoiced Price (LCY)");
                  IF lProjectInstallment."Invoiced Price (LCY)" = 0 THEN
                     lTotal := lTotal + lProjectInstallment."Installment Amount (LCY)" - lProjectInstallment."Withheld Amount (LCY)";
                     IF lProjectInstallment."Invoice in Process (LCY)" <> 0 THEN
                        lTotal:= lTotal - lProjectInstallment."Invoice in Process (LCY)";
                UNTIL lProjectInstallment.NEXT = 0;
           UNTIL lProject.NEXT = 0;
        END
      ELSE
        BEGIN
        lProjectInstallment.RESET;
        lProjectInstallment.SETRANGE("Project No.", pProjectNo );
        //lProjectInstallment.SETRANGE(Chargeable ,   TRUE);
      //>>IME424x
      //  IF lProjectInstallment.FINDFIRST THEN
        IF lProjectInstallment.FINDSET(FALSE) THEN
      //<<IME424x
           REPEAT
             lProjectInstallment.CALCFIELDS("Invoice in Process (LCY)","Invoiced Price (LCY)");
             lProjectInstallment.CALCFIELDS("Invoice in Process (LCY)");
             IF lProjectInstallment."Invoiced Price (LCY)" = 0 THEN
                lTotal := lTotal + lProjectInstallment."Installment Amount (LCY)" - lProjectInstallment."Withheld Amount (LCY)";
                IF lProjectInstallment."Invoice in Process (LCY)" <> 0 THEN
                   lTotal:= lTotal - lProjectInstallment."Invoice in Process (LCY)";
           UNTIL lProjectInstallment.NEXT = 0;
        END;
      END;
      EXIT(lTotal);
    END;

    PROCEDURE FBoxSub2RevenuesExp@1100285010(pProjectNo@1100285007 : Code[20];ExecCalcFields@1210190001 : Boolean) : Decimal;
    VAR
      lJobLedgerEntry@1100285000 : Record 11072005;
      lTotal@1100285001 : Decimal;
    BEGIN
      lTotal:= 0;
      lJobLedgerEntry.SETCURRENTKEY("Main Project No.","Cost Component");
      CLEAR(lJobLedgerEntry);
      lJobLedgerEntry.CALCFIELDS("Quantity Invoiced");
      lJobLedgerEntry.SETRANGE("No." , pProjectNo);
      lJobLedgerEntry.SETRANGE("Entry Type" , lJobLedgerEntry."Entry Type" :: Sale);
      lJobLedgerEntry.SETFILTER("Quantity Invoiced", '=0');
      //>>IME424x
      //IF lJobLedgerEntry.FINDFIRST THEN
      IF lJobLedgerEntry.FINDSET(FALSE) THEN
      //<<IME424x
         REPEAT
           lTotal := lTotal + lJobLedgerEntry."Total Price (LCY)";
         UNTIL lJobLedgerEntry.NEXT = 0;
      EXIT(lTotal);
    END;

    PROCEDURE FBoxSub3RevenuesExp@1100285011(VAR pProjectNo@1100285007 : Code[20];ExecCalcFields@1210190001 : Boolean) : Decimal;
    VAR
      lTotal@1100285001 : Decimal;
      lSalesInvLines@1100285005 : Record 37;
      lProject@1100285000 : Record 11072003;
    BEGIN
      lTotal:= 0;
      IF lProject.GET(pProjectNo) THEN
      BEGIN
        IF lProject."Single/Main/Sub Project" = lProject."Single/Main/Sub Project" :: "Main Project" THEN
        BEGIN
        CLEAR(lProject);
        lProject.SETRANGE("Main Project"  , pProjectNo);
      //>>IME424x
      //  IF lProject.FINDFIRST THEN
        IF lProject.FINDSET(FALSE) THEN
      //<<IME424x
           REPEAT
             CLEAR(lSalesInvLines);
             lSalesInvLines.SETCURRENTKEY("Document Type","Project Invoice","Installment Invoice",
                                          "Job No.","Sell-to Customer No.","Installment No.","Plot No.");
             lSalesInvLines.SETRANGE("Document Type", lSalesInvLines."Document Type" :: Invoice);
             lSalesInvLines.SETRANGE("Job No." , lProject."No.");
      //>>IME424x
      //       IF lSalesInvLines.FINDFIRST THEN
             IF lSalesInvLines.FINDSET(FALSE) THEN
      //<<IME424x
                REPEAT
                  lTotal := lTotal + lSalesInvLines."Amount (LCY)";
                UNTIL lSalesInvLines.NEXT = 0;
           UNTIL lProject.NEXT = 0;
        END
      ELSE
        BEGIN
          CLEAR(lSalesInvLines);
          lSalesInvLines.SETCURRENTKEY("Document Type","Project Invoice","Installment Invoice",
                                       "Job No.","Sell-to Customer No.","Installment No.","Plot No.");
          lSalesInvLines.SETRANGE("Document Type", lSalesInvLines."Document Type" :: Invoice);
          lSalesInvLines.SETRANGE("Job No." , pProjectNo);
      //>>IME424x
      //    IF lSalesInvLines.FINDFIRST THEN
          IF lSalesInvLines.FINDSET(FALSE) THEN
      //<<IME424x
             REPEAT
               lTotal := lTotal + lSalesInvLines."Amount (LCY)";
             UNTIL lSalesInvLines.NEXT = 0;
         END;
      END;

      EXIT(lTotal);
    END;

    PROCEDURE FBoxSurCharges@1100285002(VAR pProjectNo@1100285002 : Code[20];ExecCalcFields@1210190001 : Boolean) : Decimal;
    VAR
      lJobLedgerEntry@1100285000 : Record 11072005;
      lTotal@1100285001 : Decimal;
      lProject@1100285003 : Record 11072003;
    BEGIN
      lTotal := 0;
      IF lProject.GET(pProjectNo) THEN
      BEGIN
        IF lProject."Single/Main/Sub Project" = lProject."Single/Main/Sub Project" :: "Main Project" THEN
        BEGIN
          lJobLedgerEntry.SETCURRENTKEY("Main Project No.","Cost Component");
          CLEAR(lJobLedgerEntry);
          lJobLedgerEntry.SETRANGE("Main Project No." , pProjectNo);
          lJobLedgerEntry.SETRANGE(Surcharge          ,TRUE);
      //>>IME424x
      //    IF lJobLedgerEntry.FINDFIRST THEN
          IF lJobLedgerEntry.FINDSET(FALSE) THEN
      //<<IME424x
             REPEAT
               lTotal := lTotal + lJobLedgerEntry."Total Cost (LCY)";
             UNTIL lJobLedgerEntry.NEXT = 0;
       END
      ELSE
        BEGIN
          lJobLedgerEntry.SETCURRENTKEY("Job No.","Cost Component");
          CLEAR(lJobLedgerEntry);
          lJobLedgerEntry.SETRANGE("Job No." , pProjectNo);
          lJobLedgerEntry.SETRANGE(Surcharge          ,TRUE);
      //>>IME424x
      //    IF lJobLedgerEntry.FINDFIRST THEN
          IF lJobLedgerEntry.FINDSET(FALSE) THEN
      //<<IME424x
             REPEAT
               lTotal := lTotal + lJobLedgerEntry."Total Cost (LCY)";
             UNTIL lJobLedgerEntry.NEXT = 0;
       END;
      END;
      EXIT(lTotal);
    END;

    PROCEDURE TotHoursElemAmount@1000000001(VAR Rec@1100485001 : Record 11012048;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      //RFC-1165
      WITH Rec DO BEGIN
        CALCFIELDS(
           "Cost Actual Hours","Cost Open Amount (Hours)","Cost Hour Risc Coverage (Prog)","Cost Hour Open Ovh. S. F. (P.)","Cost Hour Reciv./Not Invoiced","Cost Open Ovh. Surch. (Hours)");

        TotHoursDecAmount := "Cost Actual Hours" + "Cost Open Amount (Hours)" + "Cost Hour Risc Coverage (Prog)" + "Cost Hour Open Ovh. S. F. (P.)" + "Cost Hour Reciv./Not Invoiced" +
                             "Cost Open Ovh. Surch. (Hours)";
        EXIT(TotHoursDecAmount);
      END;
    END;

    PROCEDURE TotMaterialElemAmount@1000000002(VAR Rec@1100485001 : Record 11012048;ExecCalcFields@1100485000 : Boolean) : Decimal;
    BEGIN
      //RFC-1165
      WITH Rec DO BEGIN
        CALCFIELDS(
           "Cost Actual Material","Cost Open (Inventory)","Cost Open Ovh. Surch. (Invent)","Cost Material Risc Cove (Prog)","Cost Mat. Open Ovh. S. F. (P.)",
           "Cost Mat Received/Not Invoiced","Cost Material Open (Purchase)");

        TotMaterialDecAmount := "Cost Actual Material" + "Cost Open (Inventory)" + "Cost Open Ovh. Surch. (Invent)" + "Cost Material Risc Cove (Prog)" + "Cost Mat. Open Ovh. S. F. (P.)" +
                                "Cost Mat Received/Not Invoiced" + "Cost Material Open (Purchase)";
        EXIT(TotMaterialDecAmount);
      END;
    END;

    PROCEDURE TotOpenRevenues@1000000004(VAR Rec@1100485001 : Record 11072003) : Decimal;
    VAR
      SalesLine@1000000000 : Record 37;
      SubProject@1000000001 : Record 11072003;
    BEGIN
      //RFC-1166
      TotOpenRevenuesAmount := 0;
      SalesLine.RESET;
      SalesLine.SETCURRENTKEY("Document Type","Job No.");
      IF Rec."Single/Main/Sub Project" = Rec."Single/Main/Sub Project"::"Main Project" THEN BEGIN
        SubProject.RESET;
        SubProject.SETRANGE("Main Project",Rec."No.");
        IF SubProject.FINDSET THEN BEGIN
          REPEAT
            SalesLine.SETRANGE("Job No.",SubProject."No.");
            IF SalesLine.FINDSET THEN BEGIN
              REPEAT
                IF SalesLine."Document Type" IN
                  [SalesLine."Document Type"::"Credit Memo",SalesLine."Document Type"::"Return Order"]
                THEN
                  TotOpenRevenuesAmount -= SalesLine."Amount (LCY)"
                ELSE
                  TotOpenRevenuesAmount += SalesLine."Amount (LCY)";
              UNTIL SalesLine.NEXT = 0;
            END;
          UNTIL SubProject.NEXT = 0;
        END;
      END ELSE BEGIN
        SalesLine.SETRANGE("Job No.",Rec."No.");
        IF SalesLine.FINDSET THEN BEGIN
          REPEAT
            IF SalesLine."Document Type" IN
              [SalesLine."Document Type"::"Credit Memo",SalesLine."Document Type"::"Return Order"]
            THEN
              TotOpenRevenuesAmount -= SalesLine."Amount (LCY)"
            ELSE
              TotOpenRevenuesAmount += SalesLine."Amount (LCY)";
          UNTIL SalesLine.NEXT = 0;
        END;
      END;

      EXIT(TotOpenRevenuesAmount);
    END;

    BEGIN
    {
      This codeunit makes all functions on all security levels clear.
      To keep it this way, please put all similar functions below each other.
      4PS01 JD Call C-006737 18-12-2006 Add Estimated Purchase Result to Prognosis page
      4PS02 JD, 13 feb 2007, Project Cost Control forms and reports must give overview of the costs of a mainproject as well.
      4PS03 JD, 19 jul 2007, Call 10044, Filter on project status added to project control card
      4PS, 21-11-13, C010480, Performance changes.
      4PS 01-09-16 UKR-C26352 KD: Foreign currency in the forecast (BI042) - Added triggers to calculate FCY amounts
      4PSSE GH 130412     IMSE-011: New function + controle message
      4PSSE DL    4PS-001: correction of EXIT(values)
                  "Prognosis Cost" := "Prognosis Costs" + "Overhead Surch. Progn. Costs"
      160229 ITERO.DL IME424x repace 'findfirst then repeat' (causes locking) with 'findset(false) then repeat'
      171221 ITERO.DL pure286109 "Forecast Level"::"Cost Component" not considered in PrognTotFinResultProject()
      191015 ORANGO.DL RFC1254 exclude wage component "addition" in
                            TotHoursProject, TotHoursCostType, TotHoursCostObj, TotHoursElem,
                            TotHoursElemCostType, TotHoursElemCostObj, TotHoursExt,
                            TotHoursExtCostType, TotHoursExtCostObj, TotHoursCostComp
      200116 ORANGO.PR RFC-1165 New functions: "TotHoursElemAmount", "TotMaterialElemAmount", New Globals "TotHoursDecAmount", "TotMaterialDecAmount"
      200122 ORANGO.PR RFC-1166 New function: "TotOpenRevenues"
    }
    END.
  }
}

