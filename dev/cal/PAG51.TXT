OBJECT Page 51 Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.03,4PS14.00,4PSSE,NAVDK.NO.FI;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Invoice;
               NOR=Kjõpsfaktura;
               SVE=Inkîpsfaktura];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Invoice,Posting,View,Request Approval,Incoming Document,Release,Navigate,Mail Documents;
                                NOR=Ny,Prosess,Rapport,Godkjenn,Faktura,Bokfõring,Visning,Be om godkjenning,InngÜende dokument,Frigi,Naviger;
                                SVE=Ny,Process,Rapport,GodkÑnn,Faktura,Bokfîring,Visa,BegÑr godkÑnnande,Inkommande dokument,SlÑpp,Navigera];
    OnInit=VAR
             PurchasesPayablesSetup@1001 : Record 312;
           BEGIN
             JobQueuesUsed := PurchasesPayablesSetup.JobQueueActive;
             SetExtDocNoMandatoryCondition;
             ShowShippingOptionsWithLocation := ApplicationAreaMgmtFacade.IsLocationEnabled OR ApplicationAreaMgmtFacade.IsAllDisabled;

             //**4PS.sn
             BankAccountCodeBPaymentsEditab := TRUE;
             "Invoice Lines InputEditable" := TRUE;
             "Amount excl. VATEditable" := TRUE;
             "VAT AmountEditable" := TRUE;
             MemoWKAEditable := TRUE;
             WageChargetoTaxAuthorityEditab := TRUE;
             WageChargetoBAccountEditable := TRUE;
             "Pay To Tax AuthorityEditable" := TRUE;
             ContributionPercentageEditable := TRUE;
             "Labor AmountEditable" := TRUE;
             "Avg. Wage RateEditable" := TRUE;
             "Number of HoursEditable" := TRUE;
             "Actual End DateEditable" := TRUE;
             "Actual Effective DateEditable" := TRUE;
             "Payment AgreementEditable" := TRUE;
             PurchLinesEditable := TRUE;
             "Ext. Document IDEditable" := TRUE;
             "Ext. Document IDVisible" := TRUE;
             "Interest DateVisible" := TRUE;
             PayVATAmtOnBAccountVendorEditable := TRUE;
             //**4PS.en
           END;

    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
                 PermissionManager@1001 : Codeunit 9002;
                 lvInterestCalcMgtCU@1210190000 : Codeunit 11012049;
               BEGIN
                 SetDocNoVisible;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
                 CreateIncomingDocFromEmailAttachment := OfficeMgt.OCRAvailable;
                 CreateIncomingDocumentVisible := NOT OfficeMgt.IsOutlookMobileApp;
                 IsSaaS := PermissionManager.SoftwareAsAService;

                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter());
                   FILTERGROUP(0);
                 END;
                 IF ("No." <> '') AND ("Buy-from Vendor No." = '') THEN
                   DocumentIsPosted := (NOT GET("Document Type","No."));

                 ActivateFields;

                 //**4PS.sn
                 PurchSetup.GET;
                 IF NOT lvInterestCalcMgtCU.PermissionInterestGranule() THEN
                   "Interest DateVisible" := FALSE;
                 BankAccountSelectEditable := PurchSetup."Invoices on Bank Account";
                 BankNoCheckEditable := PurchSetup."Bank Account Check";
                 IF PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Other THEN BEGIN
                   "Ext. Document IDEditable" := FALSE;
                   "Ext. Document IDVisible" := FALSE;
                 END;
                 IF (PurchSetup."Approve Purchase Invoices") AND
                    (PurchSetup."VAT Indicator (Purchase)" = PurchSetup."VAT Indicator (Purchase)"::"No VAT") THEN BEGIN
                   PurchLinesEditable := FALSE;
                 END;
                 gWKAPresent := FALSE;

                 DCActive := IsDocumentCaptureActive;
                 //**4PS.en
                 //4PSSE
                 GLSetup.GET;
                 NORlocalizationEnable := GLSetup."Norwegian Localization Active";
                 DKinfoEnable := GLSetup."Danish Localization Active";
                 FIinfoEnable := GLSetup."Finnish localization active";

                 //181126
                 PostingNoVisiEditableEvnt(PostingNoVisiEditable);
               END;

    OnClosePage=BEGIN
                  WhiteVisionStop;
                END;

    OnAfterGetRecord=BEGIN
                       CalculateCurrentShippingAndPayToOption;

                       //**4PS.sn
                       IF gFromReference THEN BEGIN
                         gFromReference := FALSE;
                         CurrPage.PurchLines.PAGE.InitSelectionFromReference(gInvLineNo);
                       END;

                       FillSelectBankAccount;

                       IF ("No." <> xRec."No.") THEN
                         WhiteVisionStop;

                       PurchHeadExtensionRec.GetPurchHeadExtension("Document Type", "No.");
                       //**4PS.en
                     END;

    OnNewRecord=BEGIN
                  WhiteVisionStop; //**4PS.n

                  "Responsibility Center" := UserMgt.GetPurchasesFilter;

                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetBuyFromVendorFromFilter;

                  CalculateCurrentShippingAndPayToOption;

                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02

                  //**4PS.sn
                  BankAccountSelect := '';
                  SetFieldsEditable;
                  //**4PS.en
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=BEGIN
                       //**4PS.so
                       // IF NOT DocumentIsPosted THEN
                       //  EXIT(ConfirmCloseUnposted);
                       //**4PS.eo

                       //**4PS.sn
                       IF NOT DocumentIsPosted THEN
                         IF NOT PostAndPrint THEN
                           EXIT(ConfirmCloseUnposted)
                         ELSE
                           EXIT(FALSE);
                       //**4PS.en
                     END;

    OnAfterGetCurrRecord=VAR
                           RecRef@1100528700 : RecordRef;
                         BEGIN
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.ApprovalFactBox.PAGE.UpdateApprovalEntriesFromSourceRecord(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                           SetControlAppearance;

                           //**4PS.sn
                           PostAndPrint := FALSE;
                           PurchHeadExtensionRec.GetPurchHeadExtension("Document Type", "No.");
                           SetFieldsEditable;

                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Shortcut Dimension 1 Code");

                           FillDocumentViewerFactbox;
                           //**4PS.en
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 55      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 NOR=&Faktura;
                                 SVE=Fa&ktura];
                      Image=Invoice }
      { 57      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 PAGE.RUNMODAL(PAGE::"Purchase Statistics",Rec);
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 58      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverandõren i kjõpsdokumentet.;
                                 SVE=Visa eller redigera detaljerad information om leverantîren pÜ inkîpsdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Enabled="Buy-from Vendor No." <> '';
                      Image=Vendor;
                      PromotedCategory=Category11 }
      { 59      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category5 }
      { 113     ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera mÜtt, till exempel omrÜde, projekt eller avdelning, som du kan tilldela till fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 1901458458;2 ;Action    ;
                      Name=DocAttach;
                      CaptionML=[ENU=Attachments;
                                 NOR=Vedlegg;
                                 SVE=Bilagor];
                      ToolTipML=[ENU=Add a file as an attachment. You can attach images as well as documents.;
                                 NOR=Legg til en fil som vedlegg. Du kan legge ved bilderˇog dokumenter.;
                                 SVE=LÑgg till en fil som en bilaga. Du kan bifoga bilder och dokument.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Attach;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1000 : Page 1173;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 1100528203;2 ;Action    ;
                      Name=Approvals4PS;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=Approvals;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 1100528202;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+S;
                      CaptionML=[ENU=Scanned Document;
                                 SVE=Skannade dokument];
                      Image=Document;
                      OnAction=VAR
                                 lvPurchSetupRec@1100485002 : Record 312;
                               BEGIN
                                 //**4PS
                                 lvPurchSetupRec.GET;
                                 lvPurchSetupRec.ShowScannedDocument(2,"No.","Buy-from Vendor No.","Ext. Document ID");
                               END;
                                }
      { 1210190020;2 ;Action    ;
                      CaptionML=[ENU=&Documents;
                                 SVE=&Dokument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 41      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument];
                      Visible=FALSE }
      { 39      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View;
                                 NOR=Vis;
                                 SVE=Visa];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppfõringen eller dokumentet.;
                                 SVE=Visa alla poster med inkommande dokument och filbilagor som finns fîr transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select;
                                 NOR=Velg;
                                 SVE=VÑlj];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppfõringen eller dokumentet.;
                                 SVE=VÑlj en post fîr inkommande dokument och en filbilaga som du vill koppla till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 35      ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create from File;
                                 NOR=Opprett fra fil;
                                 SVE=Skapa frÜn fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved Ü velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppfõringen eller dokumentet.;
                                 SVE=Skapa en post fîr inkommande dokument genom att vÑlja en fil att bifoga. Koppla sedan posten om det inkommande dokumentet till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=CreateIncomingDocumentVisible;
                      Enabled=("Incoming Document Entry No." = 0) AND ("No." <> '');
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPurchaseDocument(Rec);
                               END;
                                }
      { 16      ;2   ;Action    ;
                      Name=IncomingDocEmailAttachment;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create from Attachment;
                                 NOR=Opprett fra vedlegg;
                                 SVE=Skapa en bilaga];
                      ToolTipML=[ENU=Create an incoming document record by selecting an attachment from outlook email, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved Ü velge et vedlegg fra en e-postmelding i Outlook, og koble deretter posten for det innkommende dokumentet til oppfõringen eller dokumentet.;
                                 SVE=Skapa en inkommande dokumentpost genom att vÑlja en bifogad fil frÜn e-posten i Outlook. Koppla sedan den inkommande dokumentposten till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=CreateIncomingDocFromEmailAttachment;
                      Enabled=IncomingDocEmailAttachmentEnabled;
                      Image=SendElectronicDocument;
                      OnAction=VAR
                                 OfficeMgt@1001 : Codeunit 1630;
                               BEGIN
                                 IF NOT INSERT(TRUE) THEN
                                   MODIFY(TRUE);
                                 OfficeMgt.InitiateSendToIncomingDocumentsWithPurchaseHeaderLink(Rec,"Buy-from Vendor No.");
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove;
                                 NOR=Fjern;
                                 SVE=Ta bort];
                      ToolTipML=[ENU=Remove an external document that has been recorded, manually or automatically, and attached as a file to a document or ledger entry.;
                                 NOR=Fjern et eksternt dokument som er registrert manuelt eller automatisk, og knyttet som en fil til et dokument eller en post.;
                                 SVE=Ta bort ett externt dokument som har registrerats manuellt eller automatiskt och bifogats som en fil i ett dokument eller en transaktion.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=VAR
                                 WorkflowsEntriesBuffer@1001 : Record 832;
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 WorkflowsEntriesBuffer.RunWorkflowEntriesPage(RECORDID,DATABASE::"Purchase Header","Document Type","No.");
                                 //**4PS.sn
                                 IF IncomingDocument.GET("Incoming Document Entry No.") THEN
                                   IncomingDocument.RemoveLinkToRelatedRecord;
                                 "Incoming Document Entry No." := 0;
                                 MODIFY(TRUE);
                                 //**4PS.en
                               END;
                                }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning;
                                 SVE=GodkÑnnande] }
      { 23      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn;
                                 SVE=GodkÑnn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.;
                                 SVE=GodkÑnn de begÑrda fîrÑndringarna.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                                 ApprovalEntry@1100528200 : Record 454;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                                 //**4PS.sn
                                 IF NOT ApprovalsMgmt.FindOpenApprovalEntryForCurrUser(ApprovalEntry,RECORDID) THEN
                                   MARK(FALSE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      ToolTipML=[ENU=Reject the approval request.;
                                 NOR=Avvis godkjenningsforespõrselen.;
                                 SVE=Avvisa godkÑnnandebegÑran.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger;
                                 SVE=Delegera];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.;
                                 SVE=Delegera godkÑnnandet till en ersÑttare.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader;
                                 SVE=Kommentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑpp];
                      Image=Release }
      { 120     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=&Frigi;
                                 SVE=&SlÑpp];
                      ToolTipML=[ENU=Release the document to the next stage of processing. When a document is released, it will be included in all availability calculations from the expected receipt date of the items. You must reopen the document before you can make changes to it.;
                                 NOR=Frigi dokumentet til neste behandlingsfase. NÜr et dokument frigis, tas det med i alle tilgjengelighetsberegninger fra den forventede mottaksdatoen for varene. Du mÜ Üpne dokumentet pÜ nytt fõr du kan gjõre endringer i det.;
                                 SVE=SlÑpp dokumentet till nÑsta etapp i bearbetningen. NÑr ett dokument slÑpps, tas det med i alla dispositionsberÑkningar frÜn och med artiklarnas planerade inleveransdatum. Du mÜste îppna dokumentet igen innan du kan Ñndra i det.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Category10;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 121     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=èpne pÜ &nytt;
                                 SVE=&ôppna igen];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed.;
                                 NOR=èpne dokumentet pÜ nytt for Ü endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de mÜ Üpnes fõr de kan endres.;
                                 SVE=ôppna dokumentet igen och Ñndra det efter att det har godkÑnts. GodkÑnda dokument har statusen SlÑppt och mÜste îppnas innan de kan Ñndras.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      Image=ReOpen;
                      PromotedCategory=Category10;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 60      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner;
                                 SVE=Fu&nktion];
                      Image=Action }
      { 4       ;2   ;Action    ;
                      Name=GetRecurringPurchaseLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Recurring Purchase Lines;
                                 NOR=Hent gjentakende bestillingslinjer;
                                 SVE=HÑmta Üterkommande inkîpsrader];
                      ToolTipML=[ENU=Insert purchase document lines that you have set up for the vendor as recurring. Recurring purchase lines could be for a monthly replenishment order or a fixed freight expense.;
                                 NOR=Sett inn kjõpsdokumentlinjer du har definert som gjentakende for leverandõren. Gjentakende kjõpslinjer kan brukes for en mÜnedlig etterfyllingsordre eller en fast fraktutgift.;
                                 SVE=Infoga inkîpsdokumentrader som du har skapat som Üterkommande fîr leverantîren. èterkommande inkîpsrader kan t.ex. vara fîr en mÜnatlig Üteranskaffningsorder eller en fast fraktkostnad.];
                      ApplicationArea=#Suite;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=VendorCode;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 63      ;2   ;Action    ;
                      Name=CopyDocument;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument;
                                 SVE=Kopiera dokument];
                      ToolTipML=[ENU=Copy document lines and header information from another purchase document to this document. You can copy a posted purchase invoice into a new purchase invoice to quickly create a similar document.;
                                 NOR=Kopier dokumentlinjer og hodeopplysninger fra et annet kjõpsdokument til dette dokumentet. Du kan kopiere en bokfõrt kjõpsfaktura til en ny kjõpsfaktura for Ü opprette et lignende dokument raskt.;
                                 SVE=Kopiera dokumentrader och huvudinformation frÜn andra inkîpsdokument till det hÑr dokumentet. Du kan kopiera en bokfîrd inkîpsfaktura till en ny inkîpsfaktura om du snabbt vill skapa ett liknande dokument.];
                      ApplicationArea=#Suite;
                      Enabled="No." <> '';
                      PromotedIsBig=Yes;
                      Image=CopyDocument;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 61      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 24=R;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 NOR=Beregn &fakturarabatt;
                                 SVE=BerÑkna &fakturarabatt];
                      ToolTipML=[ENU=Calculate the invoice discount for the entire purchase invoice.;
                                 NOR=Beregn fakturarabatten for hele kjõpsfakturaen.;
                                 SVE=BerÑkna fakturarabatten fîr hela inkîpsfakturan.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 112     ;2   ;Action    ;
                      Name=MoveNegativeLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 NOR=Flytt negative linjer;
                                 SVE=Flytta negativa rader];
                      ToolTipML=[ENU=Prepare to create a replacement sales order in a sales return process.;
                                 NOR=Klargjõr for Ü opprette en erstatningsordre i salgsreturprosessen.;
                                 SVE=Fîrbered skapa en ersÑttningsfîrsÑljningsorder i en fîrsÑljningsreturprocess.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 1100528501;2 ;Action    ;
                      CaptionML=ENU=Generate Retention Line;
                      Visible=FALSE;
                      Image=Import;
                      OnAction=BEGIN
                                 //**4PS DP01406
                                 GenerateRetentionLine;
                               END;
                                }
      { 1100485026;2 ;Action    ;
                      CaptionML=[ENU=Create Invoice Lines for Sub Projects;
                                 SVE=Skapa fakturarader fîr underprojekt];
                      Visible=FALSE;
                      Image=Splitlines;
                      OnAction=BEGIN
                                 //**4PS
                                 DistrPurchLinesOverSubProjects(Rec);
                               END;
                                }
      { 1100485025;2 ;Action    ;
                      CaptionML=[ENU=Distribute Invoice Amount over Invoice Lines;
                                 SVE=Distribuera fakturabelopp îver fakturarader];
                      Visible=FALSE;
                      Image=Split;
                      OnAction=BEGIN
                                 DistributeAmountOverLines;
                               END;
                                }
      { 1100528201;2 ;Action    ;
                      CaptionML=[ENU=Subcontracting Hours;
                                 SVE=Underentreprenadstimmar];
                      Visible=FALSE;
                      Image=SubcontractingWorksheet;
                      OnAction=VAR
                                 SubcontractingHoursInvoice@1100528301 : Record 11020694;
                               BEGIN
                                 //**4PS.n
                                 SubcontractingHoursInvoice.RunPageFromPurchaseHdrInvoice(Rec);
                               END;
                                }
      { 1100525004;2 ;Action    ;
                      CaptionML=[ENU=Approval Comment;
                                 SVE=GodkÑnnandekommentar];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=NOT OpenApprovalEntriesExist;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalManagement4PSConstr@1100525000 : Codeunit 11125349;
                               BEGIN
                                 //**4PS
                                 ApprovalManagement4PSConstr.PurchHdrApprovalCommentsWithoutApproval(Rec);
                               END;
                                }
      { 1210190018;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Correct Document;
                                 SVE=RÑtta dokument];
                      Image=ChangeLog;
                      OnAction=BEGIN
                                 //**4PS
                                 CorrectPurchDoc.SetPurchHeader(Rec);
                                 CorrectPurchDoc.RUNMODAL;
                                 CLEAR(CorrectPurchDoc);
                                 GET("Document Type","No.");
                               END;
                                }
      { 1100527450;2 ;Action    ;
                      Name=ChooseTradeName;
                      CaptionML=ENU=Choose Tradename;
                      Visible=FALSE;
                      Image=CompareContacts;
                      OnAction=BEGIN
                                 //**4PS
                                 ChooseTradeName;
                               END;
                                }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning;
                                 SVE=BegÑr godkÑnnande] }
      { 45      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Approvals;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 WorkflowsEntriesBuffer@1001 : Record 832;
                               BEGIN
                                 WorkflowsEntriesBuffer.RunWorkflowEntriesPage(RECORDID,DATABASE::"Purchase Header","Document Type","No.");
                               END;
                                }
      { 12013598;2   ;Separator  }
      { 12013599;2   ;Action    ;
                      Name=<Action1100285004>;
                      ShortCutKey=Ctrl+I;
                      CaptionML=[ENU=Show document;
                                 SVE=Visa dokument];
                      Image=Document;
                      OnAction=BEGIN
                                 // ExFlow
                                 ExFlow.ShowImageDocument("Document Type","No.");
                               END;
                                }
      { 12013600;2   ;Action    ;
                      Name=<Action1100285005>;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=Attached Fil&es;
                                 SVE=&Bilagor];
                      RunObject=Page 12013644;
                      RunPageView=SORTING(Document Type,Document No.,Attached);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Image=Documents }
      { 1100485014;2 ;Separator  }
      { 1070000 ;2   ;Action    ;
                      CaptionML=[ENU=In&ward Registration;
                                 SVE=&Ankomstregistrering];
                      ToolTipML=SVE="Ange information om en inkîpsfaktura som du vill registrera tidigt som en preliminÑr bokfîring, innan du skriver îver den senare nÑr du gîr den slutliga bokfîringen av inkîpsfakturan. ";
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=InwardEntry;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // NTR Start
                                 TESTFIELD("Buy-from Vendor No.");
                                 TESTFIELD("Pay-to Vendor No.");
                                 TESTFIELD("VAT Bus. Posting Group");
                                 TESTFIELD("Gen. Bus. Posting Group");
                                 InwRegList.PurchHeaderKey("Document Type","No.");
                                 InwRegList.RUN;
                                 // NTR End
                               END;
                                }
      { 1070001 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Inward Reg. &Entries;
                                 SVE=Ankomstreg.&transaktioner];
                      ToolTipML=SVE=Visa eller redigera ankomstregistreringstransaktioner fîr inkîpsfakturan.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 11128015;
                      RunPageView=SORTING(Source Type,Source No.);
                      RunPageLink=Source Type=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=InwardEntry }
      { 12047960;2   ;Action    ;
                      CaptionML=[ENU=Get latest coding from vendor;
                                 SVE=HÑmta senaste konteringen fîr leverantîr];
                      Promoted=Yes;
                      Image=CopyWorksheet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // PEB0042
                                 gBaseMgt.GetLatestCodingFromVendor(Rec);
                                 // 0042
                               END;
                                }
      { 142     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforespõrsel;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      ToolTipML=[ENU=Request approval of the document.;
                                 NOR=Be om godkjenning av dokumentet.;
                                 SVE=BegÑr godkÑnnande av dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Enabled=NOT OpenApprovalEntriesExist AND CanRequestApprovalForFlow;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 143     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforespõrsel;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforespõrselen.;
                                 SVE=Annullera godkÑnnandebegÑran.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Enabled=CanCancelApprovalForRecord OR CanCancelApprovalForFlow;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                                 WorkflowWebhookMgt@1001 : Codeunit 1543;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                                 WorkflowWebhookMgt.FindAndCancel(RECORDID);
                               END;
                                }
      { 62      ;1   ;ActionGroup;
                      CaptionML=[ENU=Flow;
                                 NOR=Flow;
                                 SVE=Flow];
                      Image=Flow }
      { 71      ;2   ;Action    ;
                      Name=CreateFlow;
                      CaptionML=[ENU=Create a Flow;
                                 NOR=Opprett en flyt;
                                 SVE=Skapa ett arbetsflîde];
                      ToolTipML=[ENU=Create a new Flow from a list of relevant Flow templates.;
                                 NOR=Opprett en ny flyt fra en liste over relevante flytmaler.;
                                 SVE=Skapa ett nytt arbetsflîde frÜn en lista med relevanta arbetsflîdesmallar.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsSaaS;
                      Image=Flow;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 FlowServiceManagement@1000 : Codeunit 6400;
                                 FlowTemplateSelector@1001 : Page 6400;
                               BEGIN
                                 // Opens page 6400 where the user can use filtered templates to create new flows.
                                 FlowTemplateSelector.SetSearchText(FlowServiceManagement.GetPurchasingTemplateFilter);
                                 FlowTemplateSelector.RUN;
                               END;
                                }
      { 73      ;2   ;Action    ;
                      Name=SeeFlows;
                      CaptionML=[ENU=See my Flows;
                                 NOR=Se mine flyter;
                                 SVE=Visa mina arbetsflîden];
                      ToolTipML=[ENU=View and configure Flows that you created.;
                                 NOR=Vis og konfigurer flyter som du har opprettet.;
                                 SVE=Visa och konfigurera arbetsflîden som du har skapat.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 6401;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Flow;
                      PromotedCategory=Category8 }
      { 106     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 SVE=Ra&d] }
      { 1210190015;2 ;Action    ;
                      CaptionML=[ENU=ICF Specifications;
                                 SVE=ICF-specifikationer];
                      Visible=FALSE;
                      Image=SetupList;
                      OnAction=BEGIN
                                 ShowICFInvoiceLines;  //**4PS
                               END;
                                }
      { 1100525001;2 ;ActionGroup;
                      CaptionML=[ENU=Get;
                                 SVE=HÑmta];
                      Image=Import }
      { 1210190011;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Allo&cation;
                                 SVE=HÑmta till&delning];
                      Visible=FALSE;
                      Image=Import;
                      OnAction=VAR
                                 GetAllocation@1210190000 : Codeunit 11012048;
                               BEGIN
                                 //**4PS
                                 GetAllocation.PurchaseHeader(Rec);
                               END;
                                }
      { 64      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Get Receipt Lines;
                                 SVE=HÑmta inl&everans];
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF (PurchSetup."Approve Purchase Invoices") AND
                                    (PurchSetup."VAT Indicator (Purchase)" = PurchSetup."VAT Indicator (Purchase)"::"No VAT") THEN
                                   ERROR(Text11012002);

                                 CurrPage.PurchLines.PAGE.GetReceipt;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100485910;3 ;Action    ;
                      CaptionML=[ENU=Get Plant Rent Entries;
                                 SVE=HÑmta transaktioner fîr Maskinsuthyrning];
                      Visible=FALSE;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 GetPlantRentEntries@1100525000 : Report 11012589;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 TESTFIELD("Buy-from Vendor No.");
                                 GetPlantRentEntries.SetSelections("No.", DATABASE::"Purchase Line", FALSE, SavePeriodPlantRentEntries);
                                 GetPlantRentEntries.RUNMODAL;
                                 SavePeriodPlantRentEntries := TRUE;
                               END;
                                }
      { 1100528502;3 ;Action    ;
                      CaptionML=ENU=Get Retention Ledger Entry;
                      Visible=FALSE;
                      Image=Import;
                      OnAction=VAR
                                 ReleaseRetentionLines@1100525000 : Codeunit 11012258;
                               BEGIN
                                 //DP01406
                                 TESTFIELD(Status,Status::Open);
                                 ReleaseRetentionLines.GetRetentionLinePurchLine(Rec);
                               END;
                                }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okfõring;
                                 SVE=B&okfîring];
                      Image=Post }
      { 68      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okfõr;
                                 SVE=&Bokfîr];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullfõr dokumentet eller kladden ved Ü bokfõre belõpene og antallene til de relaterte kontiene i selskapstablÜene.;
                                 SVE=Slutfîr dokumentet eller journalen genom att bokfîra beloppen och kvantiteterna till de relaterade kontona i fîretagets redovisning.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 VerifyTotal;
                                 Post(CODEUNIT::"Purch.-Post (Yes/No)");
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=ForhÜndsvis bokfõring;
                                 SVE=Fîrhandsgranska bokfîring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet nÜr du bokfõrer dokumentet eller kladden.;
                                 SVE=Granska de olika typer av transaktioner som skapas nÑr du bokfîr dokumentet eller journalen.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=ViewPostedOrder;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 PurchPostYesNo@1000 : Codeunit 91;
                               BEGIN
                                 PurchPostYesNo.Preview(Rec);
                               END;
                                }
      { 67      ;2   ;Action    ;
                      Name=TestReport;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport;
                                 SVE=Testrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil fõr du bokfõrer kladden eller dokumentet.;
                                 SVE=Visa en testrapport sÜ att du kan hitta och rÑtta till eventuella fel innan du bokfîr journalen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=FALSE;
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 1101200046;2 ;Action    ;
                      CaptionML=ENU=Invoice Check List;
                      Visible=FALSE;
                      Image=TestReport;
                      OnAction=VAR
                                 PurchaseHeader@11012003 : Record 38;
                                 CheckPurchInvCreditMemo@1100525000 : Report 11012063;
                               BEGIN
                                 //**4PS
                                 PurchaseHeader.SETRANGE("Document Type", PurchaseHeader."Document Type"::Invoice);
                                 CheckPurchInvCreditMemo.SETTABLEVIEW(PurchaseHeader);
                                 CheckPurchInvCreditMemo.RUN;
                               END;
                                }
      { 69      ;2   ;Action    ;
                      Name=PostAndPrint;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokfõr og &skriv ut;
                                 SVE=Bokfîr och skriv &ut];
                      ToolTipML=[ENU=Finalize and prepare to print the document or journal. The values and quantities are posted to the related accounts. A report request window where you can specify what to include on the print-out.;
                                 NOR=Fullfõr og klargjõr for Ü skrive ut dokumentet eller kladden. Verdiene og antallene blir bokfõrt til de relaterte kontiene. Det vises en rapportforespõrselsside der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Slutfîr och fîrbered utskrift av dokumentet eller journalen. VÑrdena och kvantiteterna bokfîrs pÜ de relaterade kontona. Ett fînster med en rapportbegÑran dÑr du kan ange vad som ska tas med pÜ utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 VerifyTotal;
                                 PostAndPrint := TRUE; //**4PS.n
                                 Post(CODEUNIT::"Purch.-Post + Print");
                                 //**4PS.sn
                                 PostAndPrint := FALSE;

                                 IF DocumentIsPosted THEN
                                   CurrPage.CLOSE;
                                 //**4PS.en
                               END;
                                }
      { 70      ;2   ;Action    ;
                      Name=PostBatch;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 NOR=&Massebokfõr;
                                 SVE=Bokfîr b&atch-jobb];
                      ToolTipML=[ENU=Post several documents at once. A report request window opens where you can specify which documents to post.;
                                 NOR=Bokfõr flere dokumenter samtidig. Det vises et rapportforespõrselsvindu der du kan angi hvilke dokumenter som skal bokfõres.;
                                 SVE=Bokfîr flera dokument pÜ en gÜng. Ett rapportfînster îppnas dÑr du kan ange vilka dokument som ska bokfîras.];
                      ApplicationArea=#Basic,#Suite;
                      Image=PostBatch;
                      OnAction=VAR
                                 PurchaseHeader@1100528701 : Record 38;
                               BEGIN
                                 VerifyTotal;
                                 //REPORT.RUNMODAL(REPORT::"Batch Post Purchase Invoices",TRUE,TRUE,Rec); //**4PS.o
                                 //**4PS.sn
                                 PurchaseHeader.COPY(Rec);
                                 IF PurchSetup."Registration per User" THEN
                                   PurchaseHeader.SETRANGE("Input by", USERID);
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purchase Invoices",TRUE,TRUE,PurchaseHeader);
                                 //**4PS.en
                               END;
                                }
      { 7       ;2   ;Action    ;
                      Name=RemoveFromJobQueue;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbkõ;
                                 SVE=Ta bort frÜn jobbkî];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektkõen.;
                                 SVE=Ta bort den schemalagda bearbetningen av den hÑr rapporten frÜn jobbkîn.];
                      ApplicationArea=#All;
                      Visible="Job Queue Status" = "Job Queue Status"::"Scheduled For Posting";
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 1100525003;1 ;ActionGroup;
                      CaptionML=[ENU=Electronic Invoice;
                                 SVE=Elektronisk faktura];
                      Image=ElectronicDoc }
      { 1210190016;2 ;Action    ;
                      CaptionML=[ENU=&Match ICF Invoice;
                                 SVE=&Matcha ICF-faktura];
                      Visible=FALSE;
                      Image=Link;
                      OnAction=VAR
                                 PurchReceiptCU@1210190000 : Codeunit 74;
                               BEGIN
                                 //**4PS
                                 PurchReceiptCU.MatchReceiptICFInvoice("No.", FALSE);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1100485002;2 ;Action    ;
                      CaptionML=[ENU=&Approve ICF Invoice;
                                 SVE=&GodkÑnn ICF-faktura];
                      Visible=FALSE;
                      Image=Approve;
                      OnAction=BEGIN
                                 ApproveICFInvoice;  //**4PS
                               END;
                                }
      { 1100485010;2 ;Action    ;
                      CaptionML=[ENU=Import MTC Invoice Specification;
                                 SVE=Importera MTC-fakturaspecifikation];
                      Visible=FALSE;
                      Image=Import;
                      OnAction=VAR
                                 ImportMTCInvoiceSpec@1100525501 : XMLport 11012017;
                                 InStream@1100528500 : InStream;
                                 FromFile@1100528501 : Text;
                               BEGIN
                                 //**4PS
                                 UPLOADINTOSTREAM(Text000, '', '', FromFile, InStream);
                                 ImportMTCInvoiceSpec.SETSOURCE(InStream);
                                 ImportMTCInvoiceSpec.SetPurchInvHeader(Rec);
                                 ImportMTCInvoiceSpec.IMPORT;
                               END;
                                }
      { 1100485029;2 ;Action    ;
                      CaptionML=[ENU=Import Invoice;
                                 SVE=Importera faktura];
                      Visible=FALSE;
                      Image=Import;
                      OnAction=VAR
                                 lvImpInvoiceHeadRec@1100485000 : Record 11020430;
                               BEGIN
                                 IF lvImpInvoiceHeadRec.READPERMISSION THEN
                                   REPORT.RUNMODAL(REPORT::"Import Invoice");
                               END;
                                }
      { 1100409001;1 ;ActionGroup;
                      CaptionML=[ENU=Mail Documents;
                                 SVE=E-postdokument];
                      ActionContainerType=NewDocumentItems }
      { 1100409000;2 ;Action    ;
                      CaptionML=[ENU=Mail Document to Buy-from Vendor;
                                 SVE=Inkîpsleverantîr];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category12;
                      OnAction=VAR
                                 Contact@1100409002 : Record 5050;
                                 Vendor@1100409001 : Record 23;
                                 DocumentTemplate@1100409000 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Vendor No.");
                                 IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN BEGIN
                                   Vendor.GET("Buy-from Vendor No.");
                                   EditDocuments(
                                     "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::Invoice),
                                     Contact."No.", '', TRUE, Vendor."E-Mail", FALSE);
                                 END;
                               END;
                                }
      { 1100409002;2 ;Action    ;
                      CaptionML=[ENU=Mail Document to Buy-from Contact;
                                 SVE=Inkîpskontaktperson];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category12;
                      OnAction=VAR
                                 Contact@1100409002 : Record 5050;
                                 DocumentTemplate@1100409000 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Contact No.");
                                 IF Contact.GET("Buy-from Contact No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::Invoice),
                                       Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail", FALSE)
                                    ELSE
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::Invoice),
                                       Contact."No.", '', TRUE, Contact."E-Mail", FALSE);
                                 END;
                               END;
                                }
      { 1100527301;2 ;Action    ;
                      CaptionML=ENU=Show Original &E-mail;
                      Visible=DCActive;
                      Enabled=DCActive;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 PurchDocMgnt@1100527300 : Codeunit 6085709;
                               BEGIN
                                 //**4PS
                                 PurchDocMgnt.OpenEmailFile(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                Lookup=No;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Standard;
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 500 ;2   ;Field     ;
                CaptionML=[ENU=Vendor No.;
                           SVE=Leverantîrsnr];
                ToolTipML=[ENU=Specifies the number of the vendor who delivers the products.;
                           SVE=Anger numret pÜ leverantîren som levererar produkterna.];
                ApplicationArea=#All;
                NotBlank=Yes;
                SourceExpr="Buy-from Vendor No.";
                Importance=Additional;
                OnValidate=BEGIN
                             OnAfterValidateBuyFromVendorNo(Rec,xRec);
                             CurrPage.UPDATE;
                           END;
                            }

    { 1210190005;2;Field  ;
                SourceExpr="Related Purch. Order No.";
                OnValidate=BEGIN
                             //**4PS.n
                             ValidateRelatedPurchOrder;
                           END;

                OnLookup=VAR
                           OldRelatedOrderNo@1100525000 : Code[20];
                         BEGIN
                           //**4PS.n
                           OldRelatedOrderNo := "Related Purch. Order No.";
                           LookupRelatedOrder();
                           IF ("Related Purch. Order No." <> '') AND ("Related Purch. Order No." <> OldRelatedOrderNo) THEN
                             ValidateRelatedPurchOrder;
                           CurrPage.UPDATE;
                         END;
                          }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Vendor Name;
                           NOR=Leverandõrnavn;
                           SVE=Leverantîrsnamn];
                ToolTipML=[ENU=Specifies the name of the vendor who delivers the products.;
                           NOR=Angir navnet pÜ leverandõren som leverer produktene.;
                           SVE=Anger namnet pÜ leverantîren som levererar produkterna.];
                ApplicationArea=#All;
                NotBlank=Yes;
                SourceExpr="Buy-from Vendor Name";
                Importance=Promoted;
                OnValidate=VAR
                             ApplicationAreaMgmtFacade@1000 : Codeunit 9179;
                           BEGIN
                             OnAfterValidateBuyFromVendorNo(Rec,xRec);

                             IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies additional posting information for the document. After you post the document, the description can add detail to vendor and customer ledger entries.;
                           NOR=Angir ekstra bokfõringsinformasjon for dokumentet. NÜr du bokfõrer dokumentet, kan beskrivelsen tilfõre detaljer til leverandõr- og kundeposter.;
                           SVE=Anger ytterligare bokfîringsinformation fîr dokumentet. NÑr du bokfîr dokumentet kan beskrivningen tillfîra detaljer i leverantîrs- och kundreskontratransaktioner.];
                ApplicationArea=#Suite;
                SourceExpr="Posting Description";
                Visible=FALSE }

    { 1210190007;2;Field  ;
                Name=BankAccountSelect;
                CaptionML=[ENU=Bank Account No.;
                           SVE=Bankkontonr];
                SourceExpr=BankAccountSelect;
                Editable=BankAccountSelectEditable;
                OnValidate=BEGIN
                             //**4PS
                             HandleSelectedBankAccount(Rec, BankAccountSelect); //call C000319
                           END;
                            }

    { 1100529904;2;Field  ;
                SourceExpr="Processing Status SiB Invoice";
                Importance=Additional;
                Visible=FALSE }

    { 1100529903;2;Field  ;
                SourceExpr="Processing Result SiB Invoice";
                Importance=Additional;
                Visible=FALSE }

    { 51  ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kjõp fra;
                           SVE=Kîp frÜn];
                GroupType=Group }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor who ships the items.;
                           NOR=Angir adressen til leverandõren som leverer varene.;
                           SVE=Anger adressen till leverantîren som levererar artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                QuickEntry=FALSE }

    { 74  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                QuickEntry=FALSE }

    { 76  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                QuickEntry=FALSE }

    { 93  ;3   ;Group     ;
                Visible=IsBuyFromCountyVisible;
                GroupType=Group }

    { 92  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county of the address.;
                           NOR=Angir delstat, omrÜde eller fylke i adressen.;
                           SVE=Anger delstat, region eller lÑn i adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from County";
                Importance=Additional;
                QuickEntry=FALSE }

    { 77  ;3   ;Field     ;
                CaptionML=[ENU=Buy-from Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                QuickEntry=FALSE }

    { 95  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the address.;
                           NOR=Angir landet eller omrÜdet i adressen.;
                           SVE=Anger adressens land eller region.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Country/Region Code";
                Importance=Additional;
                OnValidate=BEGIN
                             IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 128 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of your contact at the vendor.;
                           NOR=Angir nummeret for kontakten hos leverandõren.;
                           SVE=Anger numret som hîr till kontaktpersonen hos leverantîren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about shipment of the item from this vendor.;
                           NOR=Angir navnet pÜ kontaktpersonen som kan kontaktes angÜende varelevering fra denne leverandõren.;
                           SVE=Anger namnet pÜ den person som bîr kontaktas angÜende utleverans av artikeln frÜn leverantîren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the original document you received from the vendor. You can require the document number for posting, or let it be optional. By default, it's required, so that this document references the original. Making document numbers optional removes a step from the posting process. For example, if you attach the original invoice as a PDF, you might not need to enter the document number. To specify whether document numbers are required, in the Purchases & Payables Setup window, select or clear the Ext. Doc. No. Mandatory field.;
                           NOR=Angir dokumentnummeret for det opprinnelige dokumentet du mottok fra leverandõren. Du kan kreve dokumentnummeret for bokfõring eller la det vëre valgfritt. Det er obligatorisk som standard, slik at dette dokumentet refererer til originalen. Hvis dokumentnumre gjõres valgfrie, fjernes et trinn fra bokfõringsprosessen. Hvis du for eksempel legger ved den opprinnelige fakturaen som en PDF-fil, kan det hende du ikke behõver Ü angi dokumentnummeret. Hvis du vil angi om dokumentnummeret er obligatorisk, gÜr du til vinduet for kjõpsoppsett, og merker av for eller fjerner merket for feltet Eksternt dokumentnr. obligatorisk.;
                           SVE=Anger dokumentnumret fîr det ursprungliga dokumentet som du har fÜtt frÜn leverantîren. Du kan krÑva dokumentnumret fîr bokfîring eller lÜta det vara frivilligt. Som standard krÑvs det i syfte att lÜta detta dokument referera till det ursprungliga. Vid valfria dokumentnummer fîrvinner ett steg frÜn bokfîringsprocessen. Om du till exempel bifogar den ursprungliga fakturan som en PDF kanske du inte behîver ange dokumentnumret. Fîr att ange om dokumentnummer krÑvs, vÑlj eller rensa fÑltet Externt dok.nr obligatoriskt i fînstret Inkîp & InkîpsinstÑllningar.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Invoice No.";
                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('Factuurnummer', 0);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Vendor Invoice No.", COPYSTR(RetVal, 1, 20));
                             END;

                ShowMandatory=VendorInvoiceNoMandatory }

    { 1100485015;2;Field  ;
                SourceExpr="Ext. Document ID";
                Visible="Ext. Document IDVisible";
                Editable="Ext. Document IDEditable" }

    { 1101200002;2;Field  ;
                SourceExpr="Subcontracting Invoice";
                OnValidate=BEGIN
                             SubcontractingInvoiceOnAfterVa;
                           END;
                            }

    { 1100485208;2;Field  ;
                CaptionML=[ENU=WKA Data present;
                           SVE=WKA-data finns];
                SourceExpr=gWKAPresent;
                Importance=Additional;
                Editable=FALSE }

    { 1101200014;2;Field  ;
                SourceExpr="Invoice Lines Input";
                Editable="Invoice Lines InputEditable";
                OnValidate=BEGIN
                             InvoiceLinesInputOnAfterValida;
                           END;
                            }

    { 1000000000;2;Field  ;
                SourceExpr="Amounts only" }

    { 1100485004;2;Field  ;
                SourceExpr="Bank No. Check";
                Visible=FALSE;
                Editable=BankNoCheckEditable;
                OnValidate=BEGIN
                             //**4PS
                             FillSelectBankAccount;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the purchase document will be recorded.;
                           NOR=Angir datoen nÜr bokfõringen av kjõpsdokumentet blir registrert.;
                           SVE=Anger datumet dÜ bokfîring av inkîpsdokumentet registreras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Standard;
                OnValidate=BEGIN
                             SaveInvoiceDiscountAmount;
                           END;
                            }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the related document was created.;
                           NOR=Angir datoen da de relaterte dokumentet ble opprettet.;
                           SVE=Anger datumet nÑr det relaterade dokumentet skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('Factuurdatum', 2);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Document Date", RetVal);
                             END;
                              }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the incoming document that this purchase document is created for.;
                           NOR=Angir nummeret pÜ det innkommende dokumentet som dette kjõpsdokumentet er opprettet for.;
                           SVE=Anger numret pÜ det inkommande dokument som detta inkîpsdokument skapas fîr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Incoming Document Entry No.";
                Importance=Additional;
                Visible=FALSE }

    { 1101200000;2;Field  ;
                SourceExpr="VAT Prod. Posting Group";
                OnValidate=BEGIN
                             VATProdPostingGroupOnAfterVali;
                           END;
                            }

    { 1101200004;2;Field  ;
                SourceExpr="Amount excl. VAT";
                Editable="Amount excl. VATEditable";
                OnValidate=BEGIN
                             AmountexclVATOnAfterValidate;
                           END;
                            }

    { 1101200006;2;Field  ;
                SourceExpr="VAT Amount";
                Editable="VAT AmountEditable";
                OnValidate=BEGIN
                             VATAmountOnAfterValidate;
                           END;
                            }

    { 1101200015;2;Field  ;
                SourceExpr="Amount incl. VAT";
                OnValidate=BEGIN
                             AmountinclVATOnAfterValidate;
                           END;

                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('BrutoBedrag', 3);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Amount incl. VAT", RetVal);
                             END;
                              }

    { 1100528207;2;Field  ;
                SourceExpr="Approval Code";
                Visible=FALSE }

    { 12047963;2;Field    ;
                SourceExpr="Recipient Bank Account";
                Visible=FALSE }

    { 1100570001;2;Field  ;
                SourceExpr="OCR No.";
                Visible=false }

    { 12013591;2;Field    ;
                SourceExpr="Block Document" }

    { 1100528400;2;Field  ;
                CaptionML=[ENU=Approval by User;
                           SVE=GodkÑnnande av anvÑndare];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApprover(RECORDID,0);
                Visible=FALSE }

    { 1100528401;2;Field  ;
                CaptionML=[ENU=Approval by User Name;
                           SVE=GodkÑnnande av anvÑndarnamn];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApproverName(RECORDID,0);
                Visible=FALSE }

    { 1100527300;2;Field  ;
                AccessByPermission=Codeunit 6085578=X;
                CaptionML=ENU=No. of Documents (DC);
                SourceExpr=DocMgt.GetNoOfDocForDoc(DATABASE::"Purchase Header","Document Type","No.",0);
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DocMgt.LookupDocsForDoc(DATABASE::"Purchase Header","Document Type","No.",0)
                            END;
                             }

    { 1101285003;2;Field  ;
                SourceExpr="Gross Invoice Amount ExFlow" }

    { 1101285000;2;Field  ;
                SourceExpr="Import VAT Amount" }

    { 1101285001;2;Field  ;
                SourceExpr="Receipt No. Mandatory" }

    { 1100285300;2;Field  ;
                SourceExpr=Approve }

    { 1100285301;2;Field  ;
                Name=<Control12013588>;
                CaptionML=[ENU=Approval Status;
                           SVE=GodkÑnnandestatus];
                SourceExpr=ExFlowStatusFromPO;
                OnDrillDown=BEGIN
                              ExFlowStatusDrillDownFromPO;
                            END;
                             }

    { 12013593;2;Field    ;
                SourceExpr="ExFlow Document Type" }

    { 1101200008;2;Field  ;
                SourceExpr="Approvement Initials";
                Visible=FALSE }

    { 1210190002;2;Field  ;
                SourceExpr="Job No.";
                OnValidate=BEGIN
                             JobNoOnAfterValidate;
                           END;
                            }

    { 1100525006;2;Field  ;
                SourceExpr="Service Order No.";
                OnValidate=BEGIN
                             //**4PS
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100525007;2;Field  ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 118 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the record is open, waiting to be approved, invoiced for prepayment, or released to the next stage of processing.;
                           NOR=Angir om posten er Üpen, om den venter pÜ godkjenning, om den er fakturert for forskudd eller om den er frigitt til neste fase i behandlingen.;
                           SVE=Anger om posten Ñr îppen, vÑntar pÜ att godkÑnnas, har fakturerats fîr fîrskottsbetalning eller har slÑppts till nÑsta steg i behandlingen.];
                ApplicationArea=#Suite;
                SourceExpr=Status;
                Importance=Additional;
                Visible=FALSE }

    { 1100529500;2;Field  ;
                CaptionML=ENU=Back-to-back;
                SourceExpr="Back-to-back";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry that handles the posting of purchase invoices.;
                           NOR=Angir status for en jobbkõpost som hÜndterer bokfõring av kjõpsfakturaer.;
                           SVE=Anger statusen fîr en jobbkîtransaktion som hanterar bokfîringen av inkîpsfakturor.];
                ApplicationArea=#All;
                SourceExpr="Job Queue Status";
                Importance=Additional;
                Visible=JobQueuesUsed }

    { 54  ;1   ;Part      ;
                Name=PurchLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page55;
                Enabled="Buy-from Vendor No." <> '';
                Editable="Buy-from Vendor No." <> '';
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer;
                           SVE=Fakturadetaljer];
                GroupType=Group }

    { 1090000;2;Field     ;
                CaptionML=[ENU=Message Type;
                           SVE=Meddelandetyp];
                SourceExpr=PurchHeadExtensionRec."Message Type";
                Visible=FIinfoEnable;
                OnValidate=BEGIN
                             PurchHeadExtensionRec.UpdatePurchHeadExtension("Document Type","No.");
                           END;

                ShowMandatory=TRUE }

    { 1090002;2;Field     ;
                Name=Invoice Message;
                CaptionML=ENU=Invoice Message;
                SourceExpr=PurchHeadExtensionRec."Invoice Message";
                Importance=Promoted;
                Visible=FIinfoEnable;
                OnValidate=BEGIN
                             PurchHeadExtensionRec.UpdatePurchHeadExtension("Document Type","No.");
                           END;

                ShowMandatory=TRUE }

    { 1101200018;2;Field  ;
                SourceExpr="Transaction Mode B Payments";
                Importance=Additional;
                Editable=TransactionModeBPaymentsEditab }

    { 1210190000;2;Field  ;
                SourceExpr="Bank Account Code B Payments";
                Importance=Additional;
                Editable=BankAccountCodeBPaymentsEditab }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Importance=Additional;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE;
                LookupPageID=Cost Object List;
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbelõpet.;
                           SVE=Anger en formel som berÑknar betalningsfîrfallodatumet, kassarabattsdatumet och kassarabattens belopp.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Standard }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the invoice is due. The program calculates the date using the Payment Terms Code and Document Date fields.;
                           NOR=Angir nÜr fakturaen forfaller. Programmet beregner datoen ved hjelp av feltet Betalingsbet.kode og Dokumentdato.;
                           SVE=Anger nÑr fakturan fîrfaller. Datumet berÑknas frÜn fÑlten Betalningsvillkorskod och Dokumentdatum.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Standard;
                ShowMandatory=TRUE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis betaling utfõres innen datoen i feltet Kont.rabattdato.;
                           SVE=Anger den procentuella kassarabatten som anvÑnds om betalningen gîrs senast det datum som anges i fÑltet Kassarabattsdatum.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                           NOR=Angir datoen da belõpet i posten mÜ vëre betalt for at det kan oppnÜs kontantrabatt.;
                           SVE=Anger datumet dÜ postbeloppet mÜste vara betalt fîr att orderns kassarabatt ska gÑlla.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the delivery conditions of the related shipment, such as free on board (FOB).;
                           NOR=Angir leveringsbetingelsene for den tilknyttede leveringen, for eksempel Fritt ombord (FOB).;
                           SVE=Anger leveransvillkoren fîr den relaterade utleveransen, till exempel fritt ombord.];
                ApplicationArea=#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Additional;
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment of the purchase invoice.;
                           NOR=Angir betalingen for kjõpsfakturaen.;
                           SVE=Anger betalningen av inkîpsfakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Reference";
                Importance=Additional }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor who sent the purchase invoice.;
                           NOR=Angir leverandõren som sendte kjõpsfakturaen.;
                           SVE=Anger leverantîren som skickade inkîpsfakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Creditor No.";
                Importance=Additional }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the related entry represents an unpaid invoice for which either a payment suggestion, a reminder, or a finance charge memo exists.;
                           NOR=Angir at den relaterte oppfõringen representerer en ubetalt faktura som det finnes et betalingsforslag, en purring eller en rentenota for.;
                           SVE=Anger att den relaterade transaktionen representerar en obetald faktura som det finns ett betalningsfîrslag, en betalningspÜminnelse eller en rÑntefaktura fîr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="On Hold";
                Importance=Additional }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling;
                           SVE=Leverans och betalning];
                GroupType=Group }

    { 53  ;2   ;Group     ;
                CaptionML=SVE=Leverans;
                GroupType=Group }

    { 78  ;3   ;Group     ;
                GroupType=Group }

    { 75  ;4   ;Field     ;
                Name=ShippingOptionWithLocation;
                CaptionML=[ENU=Ship-to;
                           NOR=Forsendelsesadresse;
                           SVE=Leverans];
                ToolTipML=[ENU=Specifies the address that the products on the purchase document are shipped to. Default (Company Address): The same as the company address specified in the Company Information window. Location: One of the company's location addresses. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Angir adressen som produktene i kjõpsdokumentet skal sendes til. Standard (selskapsadresse): Det samme som selskapsadressen angitt i Selskapsopplysninger-vinduet. Lokasjon: En av selskapets adresser. Tilpasset adresse: En forsendelsesadresse du angir i feltene under.;
                           SVE=Anger den adress som produkterna i inkîpsdokumentet levereras till. StandardvÑrde (fîretagsadress): Samma som den fîretagsadress som anges i fîretagets informationsfînster. Plats: En av fîretagets lagerstÑlleadresser. Anpassad adress: Valfri leveransadress som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Company Address),Location,Custom Address;
                                 NOR=Standard (selskapsadresse),Lokasjon,Egendefinert adresse;
                                 SVE=Standard (fîretagets adress),Plats,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                HideValue=NOT ShowShippingOptionsWithLocation AND (ShipToOptions = ShipToOptions::Location);
                OnValidate=BEGIN
                             ValidateShippingOption;
                           END;
                            }

    { 80  ;4   ;Field     ;
                Name=ShippingOptionWithoutLocation;
                CaptionML=[ENU=Ship-to;
                           NOR=Forsendelsesadresse;
                           SVE=Leverans];
                ToolTipML=[ENU=Specifies the address that the products on the purchase document are shipped to. Default (Company Address): The same as the company address specified in the Company Information window. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Angir adressen som produktene i kjõpsdokumentet skal sendes til. Standard (selskapsadresse): Det samme som selskapsadressen angitt i Selskapsopplysninger-vinduet. Egendefinert adresse: En forsendelsesadresse du angir i feltene under.;
                           SVE=Anger den adress som produkterna i inkîpsdokumentet levereras till. StandardvÑrde (fîretagsadress): Samma som den fîretagsadress som anges i fîretagets informationsfînster. Anpassad adress: Valfri leveransadress som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Company Address),,Custom Address;
                                 NOR=Standard (selskapsadresse),,Egendefinert adresse;
                                 SVE=Standard (fîretagets adress),,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                Visible=FALSE;
                HideValue=ShowShippingOptionsWithLocation AND (ShipToOptions = ShipToOptions::Location);
                OnValidate=BEGIN
                             ValidateShippingOption
                           END;
                            }

    { 79  ;4   ;Group     ;
                GroupType=Group }

    { 138 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT specification of the involved customer or vendor to link transactions made for this record with the appropriate general ledger account according to the VAT posting setup.;
                           NOR=Angir mva-spesifikasjonen for den involverte kunden eller leverandõren for Ü koble transaksjoner som ble utfõrt for denne posten, med riktig finanskonto i henhold til det generelle mva-bokfõringsoppsettet.;
                           SVE=Anger momsspecifikationen fîr den berîrda kunden eller leverantîren i syfte att koppla transaktioner som skapas fîr posten till det lÑmpliga redovisningskontot enligt momsbokfîringsinstÑllningen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                OnValidate=VAR
                             ApplicationAreaMgmtFacade@1000 : Codeunit 9179;
                           BEGIN
                             CurrPage.SAVERECORD;

                             IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;
                            }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how to make payment, such as with bank transfer, cash, or check.;
                           NOR=Angir hvordan du utfõrer en betaling, for eksempel med bankoverfõring, kontanter eller sjekk.;
                           SVE=Anger hur kunden betalar, t.ex. med bankîverfîring, kontanter eller check.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional }

    { 1101200020;2;Field  ;
                SourceExpr="Your Reference" }

    { 1100485000;2;Field  ;
                SourceExpr="ICF Status";
                Visible=FALSE }

    { 1060000;2;Field     ;
                SourceExpr="Giro Acc. No.";
                Visible=DKinfoEnable }

    { 1102601000;2;Field  ;
                ToolTipML=[ENU=Specifies the campaign number the document is linked to.;
                           NOR=Angir kampanjenummeret som dokumentet er koblet til.;
                           SVE=Anger kampanjnumret som dokumentet Ñr kopplat till.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign No.";
                Importance=Additional;
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                CaptionML=[ENU=Alternate Vendor Address Code;
                           NOR=Alternativ adressekode for leverandõr;
                           SVE=Kod fîr alternativ leverantîrsadress];
                ToolTipML=[ENU=Specifies the order address of the related vendor.;
                           NOR=Angir bestillingsadressen for den relaterte leverandõren.;
                           SVE=Anger den relaterade leverantîrens orderadress.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Address Code";
                Importance=Additional;
                Visible=FALSE }

    { 1100485033;2;Field  ;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Visible=FALSE }

    { 1100525002;2;Field  ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 1210190010;2;Field  ;
                SourceExpr="Interest Date";
                Importance=Additional;
                Visible="Interest DateVisible" }

    { 1100285001;2;Field  ;
                SourceExpr="Prices Including VAT" }

    { 1100285400;2;Field  ;
                SourceExpr="Export to Symbrio";
                Importance=Additional }

    { 1100285401;2;Field  ;
                SourceExpr="Export to Symbrio Type";
                Importance=Additional }

    { 1101285002;2;Field  ;
                SourceExpr="Posting No. Series";
                Visible=PostingNoVisiEditable;
                Editable=PostingNoVisiEditable }

    { 1101285004;2;Field  ;
                SourceExpr="Posting No.";
                Visible=PostingNoVisiEditable;
                Editable=PostingNoVisiEditable }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the location where you want the items to be placed when they are received.;
                           NOR=Angir en kode for lokasjonen der du vil at de bestilte varene skal plasseres.;
                           SVE=Anger en kod fîr lagerstÑllet dÑr du vill att artiklarna ska placeras nÑr de har levererats.];
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Importance=Additional }

    { 1100529400;2;Field  ;
                CaptionML=[ENU=Destination;
                           SVE=Destination];
                SourceExpr=PurchHeadExtensionRec.Destination;
                Visible=FALSE;
                OnValidate=BEGIN
                             //4PS
                             PurchHeadExtensionRecUpdate;
                           END;
                            }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date you expect to receive the items on the purchase document.;
                           NOR=Angir datoen du forventer Ü motta varer, pÜ kjõpsdokumentet.;
                           SVE=Anger det datum du fîrvÑntar dig att ta emot artiklarna i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted;
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the company at the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir navnet pÜ selskapet med adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger namnet pÜ det fîretag som finns pÜ den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Importance=Promoted;
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir adressen du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Importance=Additional;
                Visible=FALSE;
                Editable=ShipToOptions = ShipToOptions::"Custom Address";
                QuickEntry=FALSE }

    { 40  ;2   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Importance=Additional;
                Visible=FALSE;
                Editable=ShipToOptions = ShipToOptions::"Custom Address";
                QuickEntry=FALSE }

    { 42  ;2   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir byen i adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger staden fîr den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Importance=Additional;
                Visible=FALSE;
                Editable=ShipToOptions = ShipToOptions::"Custom Address";
                QuickEntry=FALSE }

    { 199 ;2   ;Group     ;
                Visible=IsShipToCountyVisible;
                GroupType=Group }

    { 97  ;3   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county of the address.;
                           NOR=Angir delstat, omrÜde eller fylke i adressen.;
                           SVE=Anger delstat, region eller lÑn i adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Importance=Additional;
                Editable=ShipToOptions = ShipToOptions::"Custom Address";
                QuickEntry=FALSE }

    { 94  ;2   ;Field     ;
                CaptionML=[ENU=Ship-to Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code of the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir postnummeret til selskapet med adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger postnumret fîr den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Importance=Additional;
                Visible=FALSE;
                Editable=ShipToOptions = ShipToOptions::"Custom Address";
                QuickEntry=FALSE }

    { 83  ;2   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country/region code of the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir land/omrÜde i adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger regionkod fîr den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Importance=Additional;
                Visible=FALSE;
                Editable=ShipToOptions = ShipToOptions::"Custom Address";
                QuickEntry=FALSE }

    { 44  ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person for the address of the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir navnet pÜ en kontaktperson i adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger namnet pÜ en kontaktperson knuten till den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Importance=Additional;
                Visible=FALSE;
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 56  ;2   ;Group     ;
                CaptionML=SVE=Betalas;
                GroupType=Group }

    { 86  ;3   ;Field     ;
                Name=PayToOptions;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til;
                           SVE=Betalas];
                ToolTipML=[ENU=Specifies the vendor that the purchase document will be paid to. Default (Vendor): The same as the vendor on the purchase document. Another Vendor: Any vendor that you specify in the fields below.;
                           NOR=Angir leverandõren som kjõpsdokumentet betales til. Standard (leverandõr): Det samme som leverandõren pÜ kjõpsdokumentet. En annen leverandõr: En leverandõr du angir i feltene nedenfor.;
                           SVE=Anger den leverantîr som inkîpsdokumentet utbetalas till. StandardvÑrde (Leverantîr): Samma som leverantîren pÜ inkîpsdokumentet. Annan leverantîr: Valfri leverantîr som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Vendor),Another Vendor,Custom Address;
                                 NOR=Standard (leverandõr),en annen leverandõr,kundeadresse;
                                 SVE=Standard (leverantîr),Annan leverantîr,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=PayToOptions;
                OnValidate=BEGIN
                             IF PayToOptions = PayToOptions::"Default (Vendor)" THEN
                               VALIDATE("Pay-to Vendor No.","Buy-from Vendor No.");
                           END;
                            }

    { 88  ;3   ;Group     ;
                Visible=NOT (PayToOptions = PayToOptions::"Default (Vendor)");
                GroupType=Group }

    { 18  ;4   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the vendor sending the invoice.;
                           NOR=Angir navnet pÜ leverandõren som sender fakturaen.;
                           SVE=Anger namnet pÜ leverantîren som skickar fakturan.];
                ApplicationArea=#Basic,#Suite;
                NotBlank=Yes;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                Enabled=PayToOptions = PayToOptions::"Another Vendor";
                Editable=PayToOptions = PayToOptions::"Another Vendor";
                OnValidate=VAR
                             ApplicationAreaMgmtFacade@1000 : Codeunit 9179;
                           BEGIN
                             IF GETFILTER("Pay-to Vendor No.") = xRec."Pay-to Vendor No." THEN
                               IF "Pay-to Vendor No." <> xRec."Pay-to Vendor No." THEN
                                 SETRANGE("Pay-to Vendor No.");

                             IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;
                            }

    { 20  ;4   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor sending the invoice.;
                           NOR=Angir adressen til leverandõren som sender fakturaen.;
                           SVE=Anger adressen fîr leverantîren som skickar fakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 22  ;4   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 24  ;4   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 103 ;4   ;Group     ;
                Visible=IsPayToCountyVisible;
                GroupType=Group }

    { 101 ;5   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county of the address.;
                           NOR=Angir delstat, omrÜde eller fylke i adressen.;
                           SVE=Anger delstat, region eller lÑn i adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to County";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 82  ;4   ;Field     ;
                CaptionML=[ENU=Pay-to Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 99  ;4   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the address.;
                           NOR=Angir landet eller omrÜdet i adressen.;
                           SVE=Anger adressens land eller region.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Country/Region Code";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                OnValidate=BEGIN
                             IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 130 ;4   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the contact who sends the invoice.;
                           NOR=Angir nummeret til kontakten som sender fakturaen.;
                           SVE=Anger numret fîr kontakten som skickar fakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.") }

    { 26  ;4   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about an invoice from this vendor.;
                           NOR=Angir navnet pÜ den personen som skal kontaktes hvis det oppstÜr spõrsmÜl til en faktura fra denne leverandõren.;
                           SVE=Anger namnet pÜ den person som bîr kontaktas angÜende en faktura frÜn leverantîren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.") }

    { 1080000;2;Field     ;
                ToolTipML=[ENU=Specifies the Kunde ID (KID) associated with purchase header.;
                           NOR=Angir kunde-ID-en (KID) som er knyttet til bestillingshodet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=KID;
                Visible=NORlocalizationEnable }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel;
                           SVE=Utlandshandel] }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for amounts on the purchase lines.;
                           NOR=Angir valutakoden for belõpet pÜ kjõpslinjene.;
                           SVE=Anger valutakoden fîr belopp pÜ inkîpsraderna.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               ChangeExchangeRate.SetAdditionalParameters(1, "Job No.", FALSE); //**4PS.n
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 SaveInvoiceDiscountAmount;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a specification of the document's transaction, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir en spesifikasjon for dokumentets transaksjon ved rapportering til INTRASTAT.;
                           SVE=Anger en specifikation av fîrsÑljningsdokumentets transaktion fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr="Transaction Specification";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of transaction that the document represents, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transaksjonstypen som dokumentet representerer ved rapportering til INTRASTAT.;
                           SVE=Anger den transaktionstyp som dokumentet representerar fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Type";
                Importance=Promoted;
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transportmÜten ved rapportering til INTRASTAT.;
                           SVE=Anger transportsÑttet fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr="Transport Method";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the port of entry where the items pass into your country/region, for reporting to Intrastat.;
                           NOR=Angir koden for innfõrselsstedet der varene kommer inn i landet/omrÜdet, for rapportering til Intrastat.;
                           SVE=Anger koden fîr inskeppningshamnen dÑr artiklarna kommer till ditt land/din region, fîr rapportering till Intrastat.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Entry Point";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area of the customer or vendor, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir omrÜdet for kunden eller leverandõren ved rapportering til INTRASTAT.;
                           SVE=Anger omrÜdet i kundens eller leverantîrens adress fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr=Area;
                Visible=FALSE }

    { 1100485022;2;Field  ;
                SourceExpr="Company VAT Registration No." }

    { 1100485020;2;Field  ;
                SourceExpr="VAT Registration No." }

    { 1100485017;2;Field  ;
                SourceExpr="Country of Origin";
                Visible=FALSE }

    { 1100485016;2;Field  ;
                SourceExpr="Country of Destination";
                Visible=FALSE }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies a two-digit code for the payment type.;
                           NOR=Angir en tosifret kode for betalingstypen.;
                           SVE=Ange tvÜsiffrig kod fîr betaltypen];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Type Code Abroad";
                Visible=NORlocalizationEnable }

    { 1080004;2;Field     ;
                ToolTipML=[ENU=Specifies information for your local government bank. Contact your bank for additional information.;
                           NOR=Angir informasjon for sentralbanken i landet. Kontakt banken din for mer informasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Specification (Norges Bank)";
                Visible=NORlocalizationEnable }

    { 1905403901;1;Group  ;
                CaptionML=[ENU=Subcontracting;
                           SVE=UE] }

    { 1000000002;2;Field  ;
                SourceExpr="Payment Agreement";
                Importance=Promoted;
                Editable="Payment AgreementEditable";
                OnValidate=BEGIN
                             PaymentAgreementOnAfterValidat;
                           END;
                            }

    { 1000000004;2;Field  ;
                SourceExpr="Actual Effective Date";
                Importance=Promoted;
                Editable="Actual Effective DateEditable" }

    { 1000000006;2;Field  ;
                SourceExpr="Actual End Date";
                Editable="Actual End DateEditable" }

    { 1000000008;2;Field  ;
                SourceExpr="Number of Hours";
                Editable="Number of HoursEditable";
                OnValidate=BEGIN
                             NumberofHoursOnAfterValidate;
                           END;
                            }

    { 1000000010;2;Field  ;
                SourceExpr="Avg. Wage Rate";
                Editable="Avg. Wage RateEditable" }

    { 1000000012;2;Field  ;
                SourceExpr="Labor Amount";
                Editable="Labor AmountEditable";
                OnValidate=BEGIN
                             LaborAmountOnAfterValidate;
                           END;
                            }

    { 1000000014;2;Field  ;
                SourceExpr="Contribution Percentage Labor";
                Editable=ContributionPercentageEditable;
                OnValidate=BEGIN
                             ContributionPercentageLaborOnA;
                           END;
                            }

    { 1210190008;2;Field  ;
                SourceExpr="Contribution Percentage Total";
                Editable=ContributionPercentageEditable;
                OnValidate=BEGIN
                             ContributionPercentageTotalOnA;
                           END;
                            }

    { 1100528200;2;Field  ;
                SourceExpr="Fixed B Amount per Hour";
                Editable=ContributionPercentageEditable;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1000000024;2;Field  ;
                SourceExpr="Pay To Tax Authority";
                Visible=false;
                Editable="Pay To Tax AuthorityEditable";
                OnValidate=BEGIN
                             PayToTaxAuthorityOnAfterValida;
                           END;
                            }

    { 1000000016;2;Field  ;
                SourceExpr="Wage Charge (to B Account)";
                Editable=WageChargetoBAccountEditable;
                OnValidate=BEGIN
                             WageChargetoBAccountOnAfterVal;
                           END;
                            }

    { 1000000018;2;Field  ;
                SourceExpr="Wage Charge (to Tax Authority)";
                Visible=FALSE;
                Editable=WageChargetoTaxAuthorityEditab }

    { 1100529600;2;Field  ;
                SourceExpr="Pay VAT Amt. on B-Acc. Vendor";
                Visible=FALSE;
                Editable=PayVATAmtOnBAccountVendorEditable }

    { 1100525005;2;Field  ;
                Name=MemoWKA;
                CaptionML=[ENU=Text;
                           SVE=BenÑmning];
                SourceExpr=PurchHeadExtensionRec.Memo;
                Visible=FALSE;
                Editable=MemoWKAEditable;
                MultiLine=Yes;
                OnValidate=BEGIN
                             //**4PS
                             PurchHeadExtensionRec.UpdatePurchHeadExtension("Document Type", "No.");
                             CurrPage.SAVERECORD;
                           END;
                            }

    { 1100528500;2;Field  ;
                SourceExpr="Subcontract No.";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1901275107;1;Part   ;
                Name=Attached Documents;
                CaptionML=[ENU=Attachments;
                           NOR=Vedlegg;
                           SVE=Bilagor];
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page1174;
                PartType=Page }

    { 1100528206;1;Part   ;
                Name=CaptureUI;
                CaptionML=[ENU=DC Document;
                           SVE=DC Dokument];
                SubPageView=SORTING(Document Type,No.)
                            WHERE(Document Type=CONST(Invoice));
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page6085596;
                Visible=FALSE }

    { 27  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190001;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page11130181;
                ProviderID=54;
                PartType=Page }

    { 1906354007;1;Part   ;
                Name=ApprovalFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                PartType=Page }

    { 31  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1904651607;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9094;
                PartType=Page }

    { 1903435607;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                PartType=Page }

    { 1906949207;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                PartType=Page }

    { 3   ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9100;
                ProviderID=54;
                PartType=Page }

    { 49  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1100409003;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page11130225;
                Visible=FALSE;
                PartType=Page }

    { 1100528503;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9104;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

    { 1100528104;1;Part   ;
                Name=DocumentViewerDocument;
                CaptionML=ENU=Document Viewer Documents;
                PagePartID=Page11129746;
                Visible=FALSE;
                PartType=Page }

    { 1100528105;1;Part   ;
                Name=DocumentViewer;
                CaptionML=ENU=Document Viewer;
                SubPageLink=Source Type=FIELD(Source Type),
                            No.=FIELD(No.),
                            Description=FIELD(Description);
                PagePartID=Page11129745;
                ProviderID=1100528104;
                Visible=FALSE;
                PartType=Page }

  }
  CODE
  {
    VAR
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1005 : Report 6698;
      ApplicationAreaMgmtFacade@1027 : Codeunit 9179;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      InwRegList@1070001 : Page 11128014;
      PurchCalcDiscByType@1007 : Codeunit 66;
      OfficeMgt@1022 : Codeunit 1630;
      FormatAddress@1033 : Codeunit 365;
      ChangeExchangeRate@1001 : Page 511;
      CorrectPurchDoc@1210190207 : Report 11012387;
      VendorRec@11012001 : Record 23;
      gFromReference@1210190001 : Boolean;
      gInvLineNo@1210190000 : Integer;
      gWKAPresent@1100485001 : Boolean;
      SavePeriodPlantRentEntries@1100485002 : Boolean;
      PurchHeadExtensionRec@1100525001 : Record 11020398;
      Text11012001@1100485003 : TextConst 'ENU=Amount to Distribute is greater than sum of all lines.;SVE=Beloppet som ska distribueras Ñr stîrre Ñn summan av alla rader.';
      Text11012002@1100525002 : TextConst 'ENU=Not allowed with Purchase Setup VAT Indicator ''No VAT'';SVE=Inte tillÜtet med inkîpsinstÑllningen ''Ingen moms''';
      PurchSetup@1100525005 : Record 312;
      DPA_IsHardFilter@1100000999 : Boolean;
      BankAccountSelect@1210190102 : Text[34];
      BankAccountSelectEditable@1100525004 : Boolean INDATASET;
      "Interest DateVisible"@19029017 : Boolean INDATASET;
      BankNoCheckEditable@19051959 : Boolean INDATASET;
      PurchLinesEditable@19017010 : Boolean INDATASET;
      "Payment AgreementEditable"@19078437 : Boolean INDATASET;
      "Actual Effective DateEditable"@19052142 : Boolean INDATASET;
      "Actual End DateEditable"@19011700 : Boolean INDATASET;
      "Number of HoursEditable"@19032395 : Boolean INDATASET;
      "Avg. Wage RateEditable"@19003838 : Boolean INDATASET;
      "Labor AmountEditable"@19041756 : Boolean INDATASET;
      ContributionPercentageEditable@19066713 : Boolean INDATASET;
      "Pay To Tax AuthorityEditable"@19017584 : Boolean INDATASET;
      WageChargetoBAccountEditable@19062124 : Boolean INDATASET;
      WageChargetoTaxAuthorityEditab@19058677 : Boolean INDATASET;
      MemoWKAEditable@19038952 : Boolean INDATASET;
      "VAT AmountEditable"@19075252 : Boolean INDATASET;
      "Amount excl. VATEditable"@19000869 : Boolean INDATASET;
      "Invoice Lines InputEditable"@19022465 : Boolean INDATASET;
      BankAccountCodeBPaymentsEditab@19039773 : Boolean INDATASET;
      TransactionModeBPaymentsEditab@19044846 : Boolean INDATASET;
      ShipToOptions@1025 : 'Default (Company Address),Location,Custom Address';
      PayToOptions@1028 : 'Default (Vendor),Another Vendor,Custom Address';
      HasIncomingDocument@1010 : Boolean;
      DocNoVisible@1006 : Boolean;
      VendorInvoiceNoMandatory@1008 : Boolean;
      OpenApprovalEntriesExist@1009 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1000 : Boolean;
      ShowWorkflowStatus@1011 : Boolean;
      JobQueuesUsed@1014 : Boolean;
      OpenPostedPurchaseInvQst@1015 : TextConst '@@@="%1 = posted document number";ENU=The invoice is posted as number %1 and moved to the Posted Purchase Invoices window.\\Do you want to open the posted invoice?;NOR=Ordrenˇer bokfõrt som nummer %1 og flyttet til vinduet Bokfõrte salgsfakturaer.\\Vil du Üpne den bokfõrte fakturaen?;SVE=Fakturan har bokfîrts som nummer %1 och flyttats till fînstret Bokfîrda inkîpsfakturor.\\Vill du îppna den bokfîrda fakturan?';
      IsOfficeAddin@1017 : Boolean;
      CanCancelApprovalForRecord@1013 : Boolean;
      DocumentIsPosted@1012 : Boolean;
      CreateIncomingDocumentVisible@1021 : Boolean;
      CreateIncomingDocFromEmailAttachment@1018 : Boolean;
      TotalsMismatchErr@1019 : TextConst 'ENU=The invoice cannot be posted because the total is different from the total on the related incoming document.;NOR=Fakturaen kan ikke bokfõres fordi summen er forskjellig fra summen pÜ det relaterte innkommende dokumentet.;SVE=Det gÜr inte att bokfîra fakturan eftersom summan skiljer sig frÜn totalbeloppet i det relaterade inkommande dokumentet.';
      IncomingDocEmailAttachmentEnabled@1020 : Boolean;
      CanRequestApprovalForFlow@1023 : Boolean;
      CanCancelApprovalForFlow@1024 : Boolean;
      ShowShippingOptionsWithLocation@1026 : Boolean;
      IsSaaS@1029 : Boolean;
      IsBuyFromCountyVisible@1032 : Boolean;
      IsPayToCountyVisible@1031 : Boolean;
      IsShipToCountyVisible@1030 : Boolean;
      "Ext. Document IDVisible"@1210190104 : Boolean INDATASET;
      "Ext. Document IDEditable"@1210190108 : Boolean INDATASET;
      ApprovalManagement4PSConstr@1100528400 : Codeunit 11125349;
      DocMgt@1100525003 : Codeunit 6085578;
      PostAndPrint@1100527300 : Boolean;
      DCActive@1100527301 : Boolean INDATASET;
      PayVATAmtOnBAccountVendorEditable@1100529600 : Boolean INDATASET;
      TiffViewer@1100528500 : Variant;
      Text000@1100528501 : TextConst 'ENU=Select File...;SVE=VÑlj en fil ...';
      DocAmountVisible@1100525000 : Boolean INDATASET;
      InwRegForm@1100285002 : Page 11128010;
      VendLedgEntry@1100285001 : Record 25;
      GenJnlLine@1100285000 : Record 81;
      GLSetup@111285700 : Record 98;
      DKinfoEnable@11128570 : Boolean INDATASET;
      FIinfoEnable@11128200 : Boolean INDATASET;
      NORlocalizationEnable@1100285500 : Boolean INDATASET;
      "*** ExFlow ***"@12013593 : Integer;
      ExFlow@12013597 : Codeunit 12013601;
      "*** PEB ***"@12047960 : Integer;
      gBaseMgt@12047958 : Codeunit 11128082;
      PostingNoVisiEditable@1101285000 : Boolean INDATASET;

    LOCAL PROCEDURE ActivateFields@6();
    BEGIN
      IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
      IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
      IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
    END;

    [External]
    PROCEDURE LineModified@7();
    BEGIN
    END;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    VAR
      PurchaseHeader@1002 : Record 38;
      PurchInvHeader@1003 : Record 122;
      LinesInstructionMgt@1001 : Codeunit 1320;
      InstructionMgt@1004 : Codeunit 1330;
      IsScheduledPosting@1005 : Boolean;
    BEGIN
      IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
        LinesInstructionMgt.PurchaseCheckAllLinesHaveQuantityAssigned(Rec);

      SendToPosting(PostingCodeunitID);

      IsScheduledPosting := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      DocumentIsPosted := (NOT PurchaseHeader.GET("Document Type","No.")) OR IsScheduledPosting;

      IF IsScheduledPosting THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);

      IF PostingCodeunitID <> CODEUNIT::"Purch.-Post (Yes/No)" THEN
        EXIT;

      COMMIT; //**4PS.new

      IF IsOfficeAddin THEN BEGIN
        PurchInvHeader.SETRANGE("Pre-Assigned No.","No.");
        PurchInvHeader.SETRANGE("Order No.",'');
        IF PurchInvHeader.FINDFIRST THEN
          //PAGE.RUN(PAGE::"Posted Purchase Invoice",PurchInvHeader); //**4PS.old
          //**4PS.sn
          IF PurchInvHeader."Invoice Approved" THEN
            PAGE.RUNMODAL(PAGE::"Posted Purchase Invoice",PurchInvHeader)
          ELSE
            PAGE.RUNMODAL(PAGE::"Approve Purchase Invoices",PurchInvHeader);
          //**4PS.en
      END ELSE
        IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
          ShowPostedConfirmationMessage;
    END;

    LOCAL PROCEDURE VerifyTotal@22();
    BEGIN
      IF NOT IsTotalValid THEN
        ERROR(TotalsMismatchErr);
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SaveInvoiceDiscountAmount@14();
    VAR
      DocumentTotals@1000 : Codeunit 57;
    BEGIN
      CurrPage.SAVERECORD;
      DocumentTotals.PurchaseRedistributeInvoiceDiscountAmountsOnDocument(Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
      CALCFIELDS("Invoice Discount Amount");
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.PurchaseDocumentNoIsVisible(DocType::Invoice,"No.");
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@3();
    VAR
      PurchasesPayablesSetup@1000 : Record 312;
    BEGIN
      PurchasesPayablesSetup.GET;
      VendorInvoiceNoMandatory := PurchasesPayablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
      WorkflowWebhookMgt@1000 : Codeunit 1543;
    BEGIN
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      SetExtDocNoMandatoryCondition;

      IncomingDocEmailAttachmentEnabled := OfficeMgt.EmailHasAttachments;
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);

      WorkflowWebhookMgt.GetCanRequestAndCanCancel(RECORDID,CanRequestApprovalForFlow,CanCancelApprovalForFlow);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@13();
    VAR
      PurchInvHeader@1000 : Record 122;
      InstructionMgt@1001 : Codeunit 1330;
    BEGIN
      PurchInvHeader.SETRANGE("Pre-Assigned No.","No.");
      PurchInvHeader.SETRANGE("Order No.",'');
      IF PurchInvHeader.FINDFIRST THEN
        IF InstructionMgt.ShowConfirm(STRSUBSTNO(OpenPostedPurchaseInvQst,PurchInvHeader."No."),
             InstructionMgt.ShowPostedConfirmationMessageCode)
        THEN
          //PAGE.RUN(PAGE::"Posted Purchase Invoice",PurchInvHeader); //**4PS.old
          //**4PS.sn
          IF PurchInvHeader."Invoice Approved" THEN
            PAGE.RUNMODAL(PAGE::"Posted Purchase Invoice",PurchInvHeader)
          ELSE
            PAGE.RUNMODAL(PAGE::"Approve Purchase Invoices",PurchInvHeader);
          //**4PS.en
    END;

    LOCAL PROCEDURE ValidateShippingOption@8();
    BEGIN
      CASE ShipToOptions OF
        ShipToOptions::"Default (Company Address)",
        ShipToOptions::"Custom Address":
          VALIDATE("Location Code",'');
        ShipToOptions::Location:
          VALIDATE("Location Code");
      END;
    END;

    LOCAL PROCEDURE CalculateCurrentShippingAndPayToOption@36();
    BEGIN
      IF "Location Code" <> '' THEN
        ShipToOptions := ShipToOptions::Location
      ELSE
        IF ShipToAddressEqualsCompanyShipToAddress THEN
          ShipToOptions := ShipToOptions::"Default (Company Address)"
        ELSE
          ShipToOptions := ShipToOptions::"Custom Address";

      CASE TRUE OF
        ("Pay-to Vendor No." = "Buy-from Vendor No.") AND BuyFromAddressEqualsPayToAddress:
          PayToOptions := PayToOptions::"Default (Vendor)";
        ("Pay-to Vendor No." = "Buy-from Vendor No.") AND (NOT BuyFromAddressEqualsPayToAddress):
          PayToOptions := PayToOptions::"Custom Address";
        "Pay-to Vendor No." <> "Buy-from Vendor No.":
          PayToOptions := PayToOptions::"Another Vendor";
      END;

      OnAfterCalculateCurrentShippingAndPayToOption(ShipToOptions,PayToOptions,Rec);
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCalculateCurrentShippingAndPayToOption@9(VAR ShipToOptions@1001 : 'Default (Company Address),Location,Custom Address';VAR PayToOptions@1000 : 'Default (Vendor),Another Vendor,Custom Address';PurchaseHeader@1002 : Record 38);
    BEGIN
    END;

    PROCEDURE InitSelectionFromReference@1210190002(IInvLineNo@1210190000 : Integer);
    BEGIN
      //**4PS
      gFromReference := TRUE;
      gInvLineNo := IInvLineNo;
    END;

    PROCEDURE ShowICFInvoiceLines@1210190000();
    VAR
      ICFLineRec@1210190000 : Record 11012327;
    BEGIN
      //**4PS
      ICFLineRec.RESET;
      ICFLineRec.SETRANGE(Vendor, "Pay-to Vendor No.");
      ICFLineRec.SETRANGE("Invoice No.", "No.");
      IF ICFLineRec.FIND('-') THEN
        PAGE.RUNMODAL(PAGE::"ICF Invoices", ICFLineRec);
    END;

    PROCEDURE ApproveICFInvoice@1100485000();
    VAR
      PurchLineRec@1210190003 : Record 39;
    BEGIN
      //**4PS
      PurchLineRec.RESET;
      PurchLineRec.SETRANGE("Document Type", "Document Type");
      PurchLineRec.SETRANGE("Document No.", "No.");
      PurchLineRec.SETFILTER(Type, '<>%1', PurchLineRec.Type::" ");
      IF PurchLineRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          PurchLineRec.VALIDATE("ICF Line Approved", TRUE);
          PurchLineRec.MODIFY(TRUE);
        UNTIL PurchLineRec.NEXT = 0;
      END;
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE CheckWKAData@1100485001();
    VAR
      lVendLedgEntryRec@1100485000 : Record 25;
      lvTmpDummyErrorRec@1100485001 : TEMPORARY Record 11012052;
      lvWKACalcCU@1210190004 : Codeunit 11012020;
    BEGIN
      //**4PS
      gWKAPresent := FALSE;
      IF NOT "Subcontracting Invoice" THEN
        EXIT;
      IF "Buy-from Vendor No." = '' THEN
        EXIT;

      lVendLedgEntryRec."Vendor No." := "Buy-from Vendor No.";
      lVendLedgEntryRec."Subcontracting Invoice" := "Subcontracting Invoice";
      lVendLedgEntryRec."Payment Agreement" := "Payment Agreement";
      lVendLedgEntryRec."Actual Effective Date" := "Actual Effective Date";
      lVendLedgEntryRec."Actual End Date" := "Actual End Date";
      lVendLedgEntryRec."Number of Hours" := "Number of Hours";
      lVendLedgEntryRec."Avg. Wage Rate" := "Avg. Wage Rate";
      lVendLedgEntryRec."Labor Amount" := "Labor Amount";
      lVendLedgEntryRec."Contribution Percentage Labor" := "Contribution Percentage Labor";
      lVendLedgEntryRec."Contribution Percentage Total" := "Contribution Percentage Total";
      lVendLedgEntryRec."Fixed B Amount per Hour" := "Fixed B Amount per Hour";
      lVendLedgEntryRec."Pay To Tax Authority" := "Pay To Tax Authority";
      lVendLedgEntryRec."Wage Charge (to B Account)" := "Wage Charge (to B Account)";
      lVendLedgEntryRec."Wage Charge (to Tax Authority)" := "Wage Charge (to Tax Authority)";
      lVendLedgEntryRec."Transaction Mode B Payments" := "Transaction Mode B Payments";
      lVendLedgEntryRec."Bank Account Code B Payments" := "Bank Account Code B Payments";
      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
        lVendLedgEntryRec."Document Type" := lVendLedgEntryRec."Document Type"::Invoice;
        lVendLedgEntryRec.Approved := "Invoice Approved";
      END;
      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
        lVendLedgEntryRec."Document Type" := lVendLedgEntryRec."Document Type"::"Credit Memo";
        lVendLedgEntryRec.Approved := "Credit Memo Approved";
      END;
      lVendLedgEntryRec."Approvement Initials" := "Approvement Initials";
      //lVendLedgEntryRec."Interest Date" := "Interest Date";

      gWKAPresent := lvWKACalcCU.CheckExternal(lVendLedgEntryRec, lvTmpDummyErrorRec);
    END;

    PROCEDURE DistributeAmountOverLines@1100485002();
    VAR
      PurchLineRec@1100485000 : Record 39;
      TotalLineAmount@1100485001 : Decimal;
    BEGIN
      //**4PS
      TESTFIELD("Amounts only",TRUE);
      PurchLineRec.SETRANGE("Document Type", "Document Type");
      PurchLineRec.SETRANGE("Document No.", "No.");
      PurchLineRec.SETFILTER("Amount Including VAT", '<>%1', 0);
      IF PurchLineRec.FINDSET(FALSE, FALSE) THEN BEGIN
        REPEAT
          TotalLineAmount := TotalLineAmount + PurchLineRec."Amount Including VAT";
        UNTIL PurchLineRec.NEXT = 0;

        IF TotalLineAmount < "Amount incl. VAT" THEN
          ERROR(Text11012001);
      END;

      IF TotalLineAmount > 0 THEN
        IF PurchLineRec.FINDSET(TRUE, FALSE) THEN
          REPEAT
            PurchLineRec.VALIDATE(PurchLineRec."Amount Including VAT",
                      "Amount incl. VAT" * (PurchLineRec."Amount Including VAT"/TotalLineAmount));
            PurchLineRec.VALIDATE("Line Amount", PurchLineRec.Amount);
            //**4PS.sn
            PurchLineRec."Modified by" := USERID; //DP00469
            PurchLineRec."Last Date Modified" := TODAY;//DP00469
            //**4PS.en
            PurchLineRec.MODIFY;
          UNTIL PurchLineRec.NEXT = 0;
    END;

    PROCEDURE SetFieldsEditable@1100525001();
    VAR
      WKA@1100525000 : Boolean;
    BEGIN
      //**4PS
      IF VendorRec."No." <> "Buy-from Vendor No." THEN
        IF NOT VendorRec.GET("Buy-from Vendor No.") THEN BEGIN
          VendorRec."Security Fund" := FALSE;
          VendorRec.ACL := FALSE;
        END;

      WKA := "Subcontracting Invoice" AND NOT VendorRec."Security Fund";

      "Payment AgreementEditable" := ("Subcontracting Invoice");
      "Actual Effective DateEditable" := (WKA);
      "Actual End DateEditable" := (WKA);
      "Number of HoursEditable" := (WKA);
      "Avg. Wage RateEditable" := (WKA AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL);
      "Labor AmountEditable" := (WKA AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL);
      ContributionPercentageEditable := WKA;
      "Pay To Tax AuthorityEditable" := (WKA AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL);
      WageChargetoBAccountEditable := (WKA AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL AND NOT "Pay To Tax Authority");
      WageChargetoTaxAuthorityEditab := (WKA AND "Pay To Tax Authority");
      MemoWKAEditable := (WKA);
      "VAT AmountEditable" := ("Manually VAT Posting");
      "Amount excl. VATEditable" := ("Manually VAT Posting");
      "Invoice Lines InputEditable" := (PurchSetup."Approve Purchase Invoices");
      BankAccountCodeBPaymentsEditab := (
        "Subcontracting Invoice" AND NOT VendorRec."Security Fund" AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL);
      TransactionModeBPaymentsEditab := (
        "Subcontracting Invoice" AND NOT VendorRec."Security Fund" AND (VendorRec."Subcontractor Type" <> VendorRec."Subcontractor Type"::"Self Employed") AND NOT VendorRec.ACL);

      BankAccountSelectEditable := PurchSetup."Invoices on Bank Account" AND CurrPage.EDITABLE;
      PayVATAmtOnBAccountVendorEditable := WKA;
    END;

    PROCEDURE ValidateRelatedPurchOrder@1100525000();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
      COMMIT; //11-03-2014
      IF GetReceiptsRelatedOrderAutomat(Rec) THEN BEGIN
        GET("Document Type", "No.");
        CurrPage.UPDATE;
      END;
    END;

    PROCEDURE WhiteVisionStart@1100528300();
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT;

      WhiteVisionMgt.LoadDocuments(TiffViewer, "No.", FALSE, "Input Date");
    END;

    PROCEDURE WhiteVisionStop@1100528301();
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT;

      WhiteVisionMgt.Stop(TiffViewer);
    END;

    PROCEDURE WhiteVisionActivateField@1100528303(FieldName@1100528301 : Text[30];FieldType@1100528302 : Option) : Text[250];
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      //FieldType:
      //0: Text
      //1: Decimal
      //2: Date
      //3: Money
      //4: RegEx

      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT('');

      EXIT(WhiteVisionMgt.ActivateField(TiffViewer, FieldName, FieldType));
    END;

    LOCAL PROCEDURE VATProdPostingGroupOnAfterVali@19001691();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE SubcontractingInvoiceOnAfterVa@19014981();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE AmountexclVATOnAfterValidate@19044333();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE VATAmountOnAfterValidate@19038655();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE InvoiceLinesInputOnAfterValida@19043059();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE AmountinclVATOnAfterValidate@19037268();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE JobNoOnAfterValidate@19070084();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PaymentAgreementOnAfterValidat@19059474();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE NumberofHoursOnAfterValidate@19014369();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE LaborAmountOnAfterValidate@19042394();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContributionPercentageLaborOnA@19007239();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE WageChargetoBAccountOnAfterVal@19015148();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE PayToTaxAuthorityOnAfterValida@19033144();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContributionPercentageTotalOnA@19018232();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ActualEffectiveDateOnActivate@19016407();
    BEGIN
      //**4PS this is necessary to set fields editable in case a payment agreement is selected with a lookup
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE FillSelectBankAccount@1100525002();
    BEGIN
      //**4PS
      IF PurchSetup."Bank Account Check" AND ("Bank No. Check" = '') THEN
        BankAccountSelect := ''
      ELSE
        BankAccountSelect := "Bank Account No.";
    END;

    LOCAL PROCEDURE PurchHeadExtensionRecUpdate@1100529403();
    BEGIN
      //**4PS
      PurchHeadExtensionRec.UpdatePurchHeadExtension("Document Type", "No.");
    END;

    LOCAL PROCEDURE FillDocumentViewerFactbox@1100528100();
    VAR
      DocumentAttachmentMgt@1100528105 : Codeunit 6085602;
      TempDocument@1100528104 : Record 6085756;
      EmptyRecID@1100528103 : RecordID;
      DocumentViewerTempDoc@1100528102 : Record 11072460;
      DocumentProperties@1100528100 : Record 11012746;
      DocumentLinkManagement@1100528101 : Codeunit 11012401;
    BEGIN
      //**4PS
      CurrPage.DocumentViewerDocument.PAGE.ResetPage;
      DocumentLinkManagement.GetDocuments(DocumentProperties, RECORDID.GETRECORD);
      DocumentProperties.MARKEDONLY(TRUE);
      CurrPage.DocumentViewerDocument.PAGE.SetExternal4PSDocuments(DocumentProperties);

      CASE PurchSetup."Scanning Application Purch.Inv" OF
        PurchSetup."Scanning Application Purch.Inv"::"Document Capture":
          BEGIN
            DocumentAttachmentMgt.CreateTempDocumentList(TempDocument, EmptyRecID, DATABASE::"Purchase Header", "Document Type", "No.", 0, TRUE);
            CurrPage.DocumentViewerDocument.PAGE.SetDocumentCaptureDocuments(TempDocument);
            IF "Ext. Document ID" <> '' THEN BEGIN
              CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::DocumentCapture, "Ext. Document ID");
            END ELSE
              CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::DocumentCapture, '');
          END;
        PurchSetup."Scanning Application Purch.Inv"::Whitevision:
          BEGIN
            CurrPage.DocumentViewerDocument.PAGE.SetWhiteVisionDocument(Rec);
            CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::WhiteVision, '');
          END;
      END;

      CurrPage.DocumentViewer.PAGE.SetEmailSubject("No.");
    END;

    [Integration]
    PROCEDURE PostingNoVisiEditableEvnt@1101285006(VAR PostingNoVisiEditable@1101285000 : Boolean);
    BEGIN
      //181126
    END;

    BEGIN
    {
      4PS 24-09-2009 PS, Approval removed
      4PS 20-09-16 UKR-C27159 VAKAT: BI032 checkbox Back-to-back - Added field
      4PS 29-03-18 DP01917 OLKOL: Actions "<Page Approval Comments>" added, "Approve" changed
      4PSSE ITERO.BSL Periodic fields in Invoice tab
      --- ExFlow --->
      Field General : Approve
      Field General : ExFlowStatus
      Field General : Requisition No.
      Field General : Gross Invoice Amount
      Field General : Imported VAT Amount
      Field General : Receipt No. Mandatory
      Field General : Block Document
      Action        : Show Document (Code)
      Action        : Attachments
      Globals
      <-- ExFlow ---

      PEB *** Begin ***
      PEB0010 Arrival Postings
        -OnPush: Invoice/Inward Registration - Faktura/Ankomstregistrering
      PEB0025 "Gross Invioce Amount" and Rounding
      PEB0042 Get Coding from Latest Invoice
      PEB0091 Bankning
        New fields on Page
        General:
         - OCR No.
         - "Recipient Bank Account"
      PEB
        New fields on Page
        General:
         - Due Date
         - Gross Invoice Amount, NextControl=54
         - Next Control on Vendor Invoice No. = 1000000002 (Gross Invoice Amount)
         - Next Control <Undefined> on field Document Date
      PEB *** End ***
    }
    END.
  }
}

