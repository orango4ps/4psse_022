OBJECT Table 11126011 SH Workplan
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=VAR
               SHProcess@1100528300 : Record 11126000;
               SHCopyManagement@1100528301 : Codeunit 11125987;
             BEGIN
               IF (Description = '') THEN BEGIN
                 SHProcess.GET("Main Process Code", "Sub Process Code");
                 Description := SHProcess.Description;
               END;
               FillDefaultFields;
               SHCopyManagement.CreateStandardWorkplan(Rec);
             END;

    OnModify=BEGIN
               IF (Periodical) THEN BEGIN
                 TESTFIELD("Location Code", '');
                 TESTFIELD("Location Description", '');
               END;
             END;

    OnDelete=BEGIN
               TESTFIELD("Actual Date", 0D);
               DeleteWorkplan;
             END;

    OnRename=BEGIN
               ERROR(RENAMENOTALLOWED);
             END;

    CaptionML=ENU=Workplan (SH);
    LookupPageID=Page11130683;
    DrillDownPageID=Page11130683;
  }
  FIELDS
  {
    { 5   ;   ;Source Type         ;Option        ;CaptionML=[ENU=Source Type;
                                                              NOR=Kildetype;
                                                              SVE=Ursprungstyp];
                                                   OptionCaptionML=ENU=" ,Estimate,Project,Company";
                                                   OptionString=[ ,Estimate,Project,Company];
                                                   NotBlank=Yes }
    { 10  ;   ;Source Code         ;Code20        ;TableRelation=IF (Source Type=CONST(Estimate)) Estimate.No.
                                                                 ELSE IF (Source Type=CONST(Project)) Job.No.;
                                                   CaptionML=[ENU=Source Code;
                                                              NOR=Kildespor;
                                                              SVE=Ursprungskod] }
    { 20  ;   ;Workplan Date       ;Date          ;CaptionML=ENU=Workplan Date }
    { 30  ;   ;Main Process Code   ;Code20        ;TableRelation=IF (Source Type=CONST(Company),
                                                                     Source Code=CONST(''),
                                                                     Workplan Date=CONST()) "SH Code".Code WHERE (Type=CONST(MainProcess),
                                                                                                                  Is Std Company Main Process=CONST(Yes))
                                                                                                                  ELSE IF (Source Type=CONST(Company),
                                                                                                                           Source Code=CONST(''),
                                                                                                                           Workplan Date=FILTER(<>'')) "SH Code".Code WHERE (Type=CONST(MainProcess),
                                                                                                                                                                             Is Company Main Process=CONST(Yes))
                                                                                                                                                                             ELSE IF (Source Type=FILTER(<>Company),
                                                                                                                                                                                      Source Code=FILTER(<>''),
                                                                                                                                                                                      Workplan Date=CONST()) "SH Code".Code WHERE (Type=CONST(MainProcess),
                                                                                                                                                                                                                                   Is Std Project Main Process=CONST(Yes))
                                                                                                                                                                                                                                   ELSE IF (Source Type=FILTER(<>Company),
                                                                                                                                                                                                                                            Source Code=FILTER(<>''),
                                                                                                                                                                                                                                            Workplan Date=FILTER(<>'')) "SH Code".Code WHERE (Type=CONST(MainProcess),
                                                                                                                                                                                                                                                                                              Is Project Main Process=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Main Process Description");
                                                              END;

                                                   CaptionML=ENU=Main Process Code;
                                                   NotBlank=Yes }
    { 31  ;   ;Main Process Description;Text80    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("SH Code".Description WHERE (Type=CONST(MainProcess),
                                                                                                   Code=FIELD(Main Process Code)));
                                                   CaptionML=ENU=Main Process Description;
                                                   Editable=No }
    { 40  ;   ;Sub Process Code    ;Code20        ;TableRelation=IF (Source Type=CONST(Company),
                                                                     Workplan Date=CONST()) "SH Process"."Sub Process Code" WHERE (Main Process Code=FIELD(Main Process Code),
                                                                                                                                   Process Type=CONST(Company))
                                                                                                                                   ELSE IF (Source Type=CONST(Company),
                                                                                                                                            Workplan Date=FILTER(<>'')) "SH Process"."Sub Process Code" WHERE (Main Process Code=FIELD(Main Process Code),
                                                                                                                                                                                                               Process Type=FILTER(Company|Accident))
                                                                                                                                                                                                               ELSE IF (Source Type=FILTER(<>Company),
                                                                                                                                                                                                                        Workplan Date=CONST()) "SH Process"."Sub Process Code" WHERE (Main Process Code=FIELD(Main Process Code),
                                                                                                                                                                                                                                                                                      Process Type=CONST(Project))
                                                                                                                                                                                                                                                                                      ELSE IF (Source Type=FILTER(<>Company),
                                                                                                                                                                                                                                                                                               Workplan Date=FILTER(<>'')) "SH Process"."Sub Process Code" WHERE (Main Process Code=FIELD(Main Process Code),
                                                                                                                                                                                                                                                                                                                                                                  Process Type=FILTER(Project|Accident));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Sub Process Description", "Risk Level Code", "Sanitation Method Code", "Norm Code");
                                                              END;

                                                   CaptionML=ENU=Sub Process Code;
                                                   NotBlank=Yes }
    { 41  ;   ;Sub Process Description;Text80     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("SH Code".Description WHERE (Type=CONST(MainProcess),
                                                                                                   Code=FIELD(Main Process Code)));
                                                   CaptionML=ENU=Sub Process Description;
                                                   Editable=No }
    { 42  ;   ;Norm Code           ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("SH Process"."Norm Code" WHERE (Main Process Code=FIELD(Main Process Code),
                                                                                                      Sub Process Code=FIELD(Sub Process Code)));
                                                   CaptionML=ENU=Norm Code;
                                                   Editable=No }
    { 43  ;   ;Text Lines          ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Text" WHERE (Text Type=CONST(Text),
                                                                                               Source Type=FIELD(Source Type),
                                                                                               Source Code=FIELD(Source Code),
                                                                                               Workplan Date=FIELD(Workplan Date),
                                                                                               Main Process Code=FIELD(Main Process Code),
                                                                                               Sub Process Code=FIELD(Sub Process Code),
                                                                                               Location Code=FIELD(Location Code)));
                                                   CaptionML=[ENU=Text Lines;
                                                              NOR=Tekstrader;
                                                              SVE=Textrader];
                                                   Editable=No }
    { 44  ;   ;Process Text Lines  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Process Text" WHERE (Source Type=FIELD(Source Type),
                                                                                                       Source Code=FIELD(Source Code),
                                                                                                       Workplan Date=FIELD(Workplan Date),
                                                                                                       Main Process Code=FIELD(Main Process Code),
                                                                                                       Sub Process Code=FIELD(Sub Process Code),
                                                                                                       Location Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Process Text Lines;
                                                   Editable=No }
    { 45  ;   ;Risk Text Lines     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Risk Text" WHERE (Source Type=FIELD(Source Type),
                                                                                                    Source Code=FIELD(Source Code),
                                                                                                    Workplan Date=FIELD(Workplan Date),
                                                                                                    Main Process Code=FIELD(Main Process Code),
                                                                                                    Sub Process Code=FIELD(Sub Process Code),
                                                                                                    Location Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Risk Text Lines;
                                                   Editable=No }
    { 46  ;   ;Process Report Lines;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Process Report" WHERE (Source Type=FIELD(Source Type),
                                                                                                         Source Code=FIELD(Source Code),
                                                                                                         Workplan Date=FIELD(Workplan Date),
                                                                                                         Main Process Code=FIELD(Main Process Code),
                                                                                                         Sub Process Code=FIELD(Sub Process Code),
                                                                                                         Location Code=FIELD(Location Code)));
                                                   CaptionML=[ENU=Report Lines;
                                                              SVE=Rapportrader];
                                                   Editable=No }
    { 47  ;   ;Report Detail Lines ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workp Process Report Detail" WHERE (Source Type=FIELD(Source Type),
                                                                                                             Source Code=FIELD(Source Code),
                                                                                                             Workplan Date=FIELD(Workplan Date),
                                                                                                             Main Process Code=FIELD(Main Process Code),
                                                                                                             Sub Process Code=FIELD(Sub Process Code),
                                                                                                             Location Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Report Detail Lines;
                                                   Editable=No }
    { 48  ;   ;Generated Report Detail Lines;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workp Process Report Detail" WHERE (Source Type=FIELD(Source Type),
                                                                                                             Source Code=FIELD(Source Code),
                                                                                                             Workplan Date=FIELD(Workplan Date),
                                                                                                             Main Process Code=FIELD(Main Process Code),
                                                                                                             Sub Process Code=FIELD(Sub Process Code),
                                                                                                             Location Code=FIELD(Location Code),
                                                                                                             Generated=CONST(Yes)));
                                                   CaptionML=ENU=Generated  Documents;
                                                   Editable=No }
    { 49  ;   ;Printed Report Detail Lines;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workp Process Report Detail" WHERE (Source Type=FIELD(Source Type),
                                                                                                             Source Code=FIELD(Source Code),
                                                                                                             Workplan Date=FIELD(Workplan Date),
                                                                                                             Main Process Code=FIELD(Main Process Code),
                                                                                                             Sub Process Code=FIELD(Sub Process Code),
                                                                                                             Location Code=FIELD(Location Code),
                                                                                                             Printed=CONST(Yes)));
                                                   CaptionML=ENU=Printed Documents;
                                                   Editable=No }
    { 50  ;   ;Location Code       ;Code20        ;TableRelation="SH Code".Code WHERE (Type=CONST(Location));
                                                   OnValidate=BEGIN
                                                                IF ("Location Code" <> '') AND ("Location Description" = '') THEN
                                                                  FillLocationDescription;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode;
                                                              SVE=Lagerst„llekod] }
    { 51  ;   ;Waste Type Lines    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Waste Type" WHERE (Source Type=FIELD(Source Type),
                                                                                                     Source Code=FIELD(Source Code),
                                                                                                     Workplan Date=FIELD(Workplan Date),
                                                                                                     Main Process Code=FIELD(Main Process Code),
                                                                                                     Sub Process Code=FIELD(Sub Process Code),
                                                                                                     Location Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Waste Type Lines;
                                                   Editable=No }
    { 52  ;   ;Plant Lines         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Plant" WHERE (Source Type=FIELD(Source Type),
                                                                                                Source Code=FIELD(Source Code),
                                                                                                Workplan Date=FIELD(Workplan Date),
                                                                                                Main Process Code=FIELD(Main Process Code),
                                                                                                Sub Process Code=FIELD(Sub Process Code),
                                                                                                Location Code=FIELD(Location Code)));
                                                   CaptionML=[ENU=Plant Lines;
                                                              NOR=Maskinlinjer;
                                                              SVE=Maskinrader];
                                                   Editable=No }
    { 53  ;   ;Risk Measure Text Lines;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Risk Measure Text" WHERE (Source Type=FIELD(Source Type),
                                                                                                            Source Code=FIELD(Source Code),
                                                                                                            Workplan Date=FIELD(Workplan Date),
                                                                                                            Main Process Code=FIELD(Main Process Code),
                                                                                                            Sub Process Code=FIELD(Sub Process Code),
                                                                                                            Location Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Measure Text Lines;
                                                   Editable=No }
    { 54  ;   ;Risk Measure PPM Text Lines;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workp Risk Measure PPM Text" WHERE (Source Type=FIELD(Source Type),
                                                                                                             Source Code=FIELD(Source Code),
                                                                                                             Workplan Date=FIELD(Workplan Date),
                                                                                                             Main Process Code=FIELD(Main Process Code),
                                                                                                             Sub Process Code=FIELD(Sub Process Code),
                                                                                                             Location Code=FIELD(Location Code)));
                                                   CaptionML=ENU=PPM Text Lines;
                                                   Editable=No }
    { 55  ;   ;Risk Level Code     ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("SH Code"."Risk Level Code" WHERE (Type=CONST(SubProcess),
                                                                                                         Code=FIELD(Sub Process Code)));
                                                   CaptionML=ENU=Risk Level Code;
                                                   Editable=No }
    { 56  ;   ;Cause Text Lines    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Text" WHERE (Text Type=CONST(Cause),
                                                                                               Source Type=FIELD(Source Type),
                                                                                               Source Code=FIELD(Source Code),
                                                                                               Workplan Date=FIELD(Workplan Date),
                                                                                               Main Process Code=FIELD(Main Process Code),
                                                                                               Sub Process Code=FIELD(Sub Process Code),
                                                                                               Location Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Cause Text Lines;
                                                   Editable=No }
    { 57  ;   ;Action Lines        ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Action" WHERE (Source Type=FIELD(Source Type),
                                                                                                 Source Code=FIELD(Source Code),
                                                                                                 Workplan Date=FIELD(Workplan Date),
                                                                                                 Main Process Code=FIELD(Main Process Code),
                                                                                                 Sub Process Code=FIELD(Sub Process Code),
                                                                                                 Location Code=FIELD(Location Code)));
                                                   CaptionML=ENU=Action Lines;
                                                   Editable=No }
    { 58  ;   ;Open Action Lines   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Action" WHERE (Source Type=FIELD(Source Type),
                                                                                                 Source Code=FIELD(Source Code),
                                                                                                 Workplan Date=FIELD(Workplan Date),
                                                                                                 Main Process Code=FIELD(Main Process Code),
                                                                                                 Sub Process Code=FIELD(Sub Process Code),
                                                                                                 Location Code=FIELD(Location Code),
                                                                                                 Finish Date=FILTER('')));
                                                   CaptionML=ENU=Open Action Lines;
                                                   Editable=No }
    { 59  ;   ;Sanitation Method Code;Code20      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("SH Code"."Sanitation Method Code" WHERE (Type=CONST(SubProcess),
                                                                                                                Code=FIELD(Sub Process Code)));
                                                   CaptionML=ENU=Sanitation Method Code;
                                                   Editable=No }
    { 100 ;   ;Description         ;Text80        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 110 ;   ;Actual Date         ;Date          ;OnValidate=BEGIN
                                                                CALCFIELDS("Generated Report Detail Lines");
                                                                IF ("Generated Report Detail Lines" > 0) AND ("Actual Date" = 0D) THEN
                                                                  TESTFIELD("Actual Date");
                                                              END;

                                                   CaptionML=[ENU=Actual Date;
                                                              SVE=Verkligt datum] }
    { 120 ;   ;Max Participants    ;Integer       ;CaptionML=ENU=Max Participants;
                                                   MinValue=0;
                                                   BlankZero=Yes }
    { 121 ;   ;No of Participants  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("SH Workplan Participant" WHERE (Source Code=FIELD(Source Code),
                                                                                                      Workplan Date=FIELD(Workplan Date),
                                                                                                      Main Process Code=FIELD(Main Process Code),
                                                                                                      Sub Process Code=FIELD(Sub Process Code)));
                                                   CaptionML=ENU=No of Participants;
                                                   Editable=No }
    { 130 ;   ;Site Manager No.    ;Code20        ;OnValidate=VAR
                                                                ProjectResponsiblePerson@1100528300 : Record 11012040;
                                                                Employee@1100528301 : Record 5200;
                                                              BEGIN
                                                                CASE "Source Type" OF
                                                                  "Source Type"::Project: BEGIN
                                                                    ProjectResponsiblePerson.SETRANGE("Project No.", "Source Code");
                                                                    ProjectResponsiblePerson.SETRANGE("Employee No.", "Site Manager No.");
                                                                    IF (NOT ProjectResponsiblePerson.FINDFIRST) THEN
                                                                      ERROR(Text000, FIELDCAPTION("Site Manager No."), TABLECAPTION, "Site Manager No.", ProjectResponsiblePerson.TABLECAPTION);
                                                                  END;
                                                                  "Source Type"::Company: BEGIN
                                                                    IF (NOT Employee.GET("Site Manager No.")) THEN
                                                                      ERROR(Text000, FIELDCAPTION("Site Manager No."), TABLECAPTION, "Site Manager No.", Employee.TABLECAPTION);
                                                                  END;
                                                                END;
                                                                CALCFIELDS("Site Manager Name");
                                                              END;

                                                   OnLookup=VAR
                                                              ProjectResponsiblePerson@1100528300 : Record 11012040;
                                                              Employee@1100528301 : Record 5200;
                                                            BEGIN
                                                              CASE "Source Type" OF
                                                                "Source Type"::Project: BEGIN
                                                                  ProjectResponsiblePerson.SETRANGE("Project No.", "Source Code");
                                                                  IF (PAGE.RUNMODAL(0, ProjectResponsiblePerson) = ACTION::LookupOK) THEN BEGIN
                                                                    "Site Manager No." := ProjectResponsiblePerson."Employee No.";
                                                                    VALIDATE("Site Manager No.");
                                                                  END;
                                                                END;
                                                                "Source Type"::Company: BEGIN
                                                                  IF (PAGE.RUNMODAL(0, Employee) = ACTION::LookupOK) THEN BEGIN
                                                                    "Site Manager No." := Employee."No.";
                                                                    VALIDATE("Site Manager No.");
                                                                  END;
                                                                END;
                                                              END;
                                                            END;

                                                   CaptionML=ENU=Site Manager No. }
    { 131 ;   ;Site Manager Name   ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Site Manager No.)));
                                                   CaptionML=[ENU=Site Manager Name;
                                                              NOR=Navn p† prosjektleder;
                                                              SVE=Namn p† byggledare];
                                                   Editable=No }
    { 140 ;   ;Location Description;Text80        ;CaptionML=[ENU=Location Description;
                                                              NOR=Beskrivelse av lokasjon;
                                                              SVE=Beskrivning av lagerst„lle] }
    { 150 ;   ;Workplan Interval   ;DateFormula   ;OnValidate=VAR
                                                                Job@1100528301 : Record 11072003;
                                                                DF@1100528300 : DateFormula;
                                                              BEGIN
                                                                IF ("Source Type" = "Source Type"::Project) AND ("Workplan Interval" <> DF) THEN BEGIN
                                                                  IF (NOT Job.GET("Source Code")) THEN
                                                                    Job.INIT;
                                                                  IF ("Starting Date" = 0D) THEN
                                                                    "Starting Date" := Job."Starting Date";
                                                                  IF ("Ending Date" = 0D) THEN
                                                                    "Ending Date" := Job."Ending Date";
                                                                END ELSE BEGIN
                                                                  "Starting Date" := 0D;
                                                                  "Ending Date" := 0D;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Workplan Interval }
    { 160 ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                IF ("Starting Date" > "Ending Date") AND ("Starting Date" <> 0D) AND ("Ending Date" <> 0D) THEN
                                                                  FIELDERROR("Starting Date");
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato;
                                                              SVE=Startdatum] }
    { 170 ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                IF ("Ending Date" < "Starting Date") AND ("Starting Date" <> 0D) AND ("Ending Date" <> 0D) THEN
                                                                  FIELDERROR("Ending Date");
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato;
                                                              SVE=Slutdatum] }
    { 180 ;   ;Process Type        ;Option        ;CaptionML=[ENU=Process Type;
                                                              NOR=Prosesstype;
                                                              SVE=Processtyp];
                                                   OptionCaptionML=ENU=Project,Company,Accident;
                                                   OptionString=Project,Company,Accident;
                                                   Editable=No }
    { 190 ;   ;Periodical          ;Boolean       ;CaptionML=ENU=Periodical;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Source Type,Source Code,Workplan Date,Main Process Code,Sub Process Code,Location Code;
                                                   Clustered=Yes }
    {    ;Source Type,Source Code,Main Process Code,Sub Process Code,Location Code,Workplan Date }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      RENAMENOTALLOWED@1100525001 : TextConst 'ENU=Rename is not allowed.;NOR=Gi nytt navn ikke tillatt;SVE=Att ge nytt namn „r inte till†tet.';
      Text000@1100528300 : TextConst 'ENU=The field %1 of table %2 contains a value (%3) that cannot be found in the related table (%4).';
      Text001@1100525000 : TextConst 'ENU=Generate Process finished.';

    PROCEDURE CopyStandardPeriodicalWorkplansToWorkplan@1100528308(VAR SHWorkplan@1100528300 : Record 11126011);
    VAR
      SHCopyManagement@1100528301 : Codeunit 11125987;
    BEGIN
      SHWorkplan.SETRANGE(Periodical, TRUE);
      SHWorkplan.SETRANGE("Workplan Date", 0D);
      IF (NOT SHWorkplan.FINDSET) THEN
        EXIT;

      REPEAT
        SHCopyManagement.CopySingleWorkplanToWorkplan(SHWorkplan, '', '')
      UNTIL (SHWorkplan.NEXT = 0);
    END;

    PROCEDURE CreateReportDetails@1100529500(VAR SHWorkplan@1100528300 : Record 11126011);
    VAR
      SHWorkplanProcessReport@1100529500 : Record 11126024;
    BEGIN
      IF (NOT SHWorkplan.FINDSET) THEN
        EXIT;

      REPEAT
        SHWorkplanProcessReport.SETRANGE("Source Type", SHWorkplan."Source Type");
        SHWorkplanProcessReport.SETRANGE("Source Code", SHWorkplan."Source Code");
        SHWorkplanProcessReport.SETRANGE("Workplan Date", SHWorkplan."Workplan Date");
        SHWorkplanProcessReport.SETRANGE("Main Process Code", SHWorkplan."Main Process Code");
        SHWorkplanProcessReport.SETRANGE("Sub Process Code", SHWorkplan."Sub Process Code");
        SHWorkplanProcessReport.SETRANGE("Location Code", SHWorkplan."Location Code");
        IF (SHWorkplanProcessReport.FINDSET) THEN BEGIN
          REPEAT
            SHWorkplanProcessReport.CreateReportDetails(SHWorkplanProcessReport);
          UNTIL (SHWorkplanProcessReport.NEXT = 0);
        END;
      UNTIL (SHWorkplan.NEXT = 0);
    END;

    PROCEDURE DrillDownActions@1100528316(OpenOnly@1100525000 : Boolean);
    VAR
      SHWorkplanAction@1100528300 : Record 11126032;
    BEGIN
      SHWorkplanAction.SETRANGE("Source Type", "Source Type");
      SHWorkplanAction.SETRANGE("Source Code", "Source Code");
      SHWorkplanAction.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanAction.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanAction.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanAction.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Actions", SHWorkplanAction);
    END;

    PROCEDURE DrillDownPartisipants@1100528303();
    VAR
      SHWorkplanParticipant@1100528300 : Record 11126012;
    BEGIN
      SHWorkplanParticipant.SETRANGE("Source Type", "Source Type");
      SHWorkplanParticipant.SETRANGE("Source Code", "Source Code");
      SHWorkplanParticipant.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanParticipant.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanParticipant.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanParticipant.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Participants", SHWorkplanParticipant);
    END;

    PROCEDURE DrillDownTexts@1100528321(TextType@1100528301 : Option);
    VAR
      SHWorkplanText@1100528300 : Record 11126013;
    BEGIN
      SHWorkplanText.SETRANGE("Text Type", TextType);
      SHWorkplanText.SETRANGE("Source Type", "Source Type");
      SHWorkplanText.SETRANGE("Source Code", "Source Code");
      SHWorkplanText.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanText.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanText.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanText.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Texts", SHWorkplanText);
    END;

    PROCEDURE DrillDownProcessTexts@1100528322();
    VAR
      SHWorkplanProcessText@1100528300 : Record 11126014;
    BEGIN
      SHWorkplanProcessText.SETRANGE("Source Type", "Source Type");
      SHWorkplanProcessText.SETRANGE("Source Code", "Source Code");
      SHWorkplanProcessText.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanProcessText.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanProcessText.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanProcessText.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Process Texts", SHWorkplanProcessText);
    END;

    PROCEDURE DrillDownRiskTexts@1100528323();
    VAR
      SHWorkplanRiskText@1100528300 : Record 11126020;
    BEGIN
      SHWorkplanRiskText.SETRANGE("Source Type", "Source Type");
      SHWorkplanRiskText.SETRANGE("Source Code", "Source Code");
      SHWorkplanRiskText.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanRiskText.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanRiskText.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanRiskText.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Risk Texts", SHWorkplanRiskText);
    END;

    PROCEDURE DrillDownProcessReports@1100528302();
    VAR
      SHWorkplanProcessReport@1100528300 : Record 11126024;
    BEGIN
      SHWorkplanProcessReport.SETRANGE("Source Type", "Source Type");
      SHWorkplanProcessReport.SETRANGE("Source Code", "Source Code");
      SHWorkplanProcessReport.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanProcessReport.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanProcessReport.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanProcessReport.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Process Reports", SHWorkplanProcessReport);
    END;

    PROCEDURE DrillDownStandardProcessReports@1100528324();
    VAR
      SHWorkplanProcessReport@1100528300 : Record 11126024;
    BEGIN
      SHWorkplanProcessReport.SETRANGE("Source Type", "Source Type");
      SHWorkplanProcessReport.SETRANGE("Source Code", "Source Code");
      SHWorkplanProcessReport.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanProcessReport.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanProcessReport.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanProcessReport.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Proc Std Reports", SHWorkplanProcessReport)
    END;

    PROCEDURE DrillDownWasteTypes@1100528334();
    VAR
      SHWorkplanWasteType@1100528300 : Record 11126028;
    BEGIN
      SHWorkplanWasteType.SETRANGE("Source Type", "Source Type");
      SHWorkplanWasteType.SETRANGE("Source Code", "Source Code");
      SHWorkplanWasteType.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanWasteType.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanWasteType.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanWasteType.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Waste Types", SHWorkplanWasteType);
    END;

    PROCEDURE DrillDownPlants@1100528335();
    VAR
      SHWorkplanPlant@1100528300 : Record 11126029;
    BEGIN
      SHWorkplanPlant.SETRANGE("Source Type", "Source Type");
      SHWorkplanPlant.SETRANGE("Source Code", "Source Code");
      SHWorkplanPlant.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanPlant.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanPlant.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanPlant.SETRANGE("Location Code", "Location Code");
      PAGE.RUNMODAL(PAGE::"SH Workplan Plants", SHWorkplanPlant);
    END;

    PROCEDURE GenerateReportDetailDocuments@1100529502(VAR SHWorkplan@1100528300 : Record 11126011);
    VAR
      SHWorkplanProcessReport@1100529500 : Record 11126024;
      SHPrintManagement@1100529501 : Codeunit 11125986;
    BEGIN
      IF (NOT SHWorkplan.FINDSET(TRUE)) THEN
        EXIT;

      REPEAT
        SHWorkplanProcessReport.RESET;
        SHWorkplanProcessReport.SETRANGE("Source Type", SHWorkplan."Source Type");
        SHWorkplanProcessReport.SETRANGE("Source Code", SHWorkplan."Source Code");
        SHWorkplanProcessReport.SETRANGE("Workplan Date", SHWorkplan."Workplan Date");
        SHWorkplanProcessReport.SETRANGE("Main Process Code", SHWorkplan."Main Process Code");
        SHWorkplanProcessReport.SETRANGE("Sub Process Code", SHWorkplan."Sub Process Code");
        SHWorkplanProcessReport.SETRANGE("Location Code", SHWorkplan."Location Code");
        IF (SHWorkplanProcessReport.FINDSET) THEN BEGIN
          REPEAT
            SHWorkplanProcessReport.MARK(TRUE);
          UNTIL (SHWorkplanProcessReport.NEXT = 0);
          SHWorkplanProcessReport.MARKEDONLY(TRUE);
          SHPrintManagement.GenerateWorkplanSelectedReports(SHWorkplanProcessReport);
        END;
        UpdateActualDate;
      UNTIL (SHWorkplan.NEXT = 0);
      MESSAGE(Text001);
    END;

    PROCEDURE GenerateWasteFlows@1100529501(VAR SHWorkplan@1100529500 : Record 11126011);
    VAR
      SHWorkplanWasteType@1100529501 : Record 11126028;
      SHCopyManagement@1100529502 : Codeunit 11125987;
    BEGIN
      IF (NOT SHWorkplan.FINDSET) THEN
        EXIT;

      REPEAT
        SHWorkplanWasteType.RESET;
        SHWorkplanWasteType.SETRANGE("Source Type", SHWorkplan."Source Type");
        SHWorkplanWasteType.SETRANGE("Source Code", SHWorkplan."Source Code");
        SHWorkplanWasteType.SETRANGE("Workplan Date", SHWorkplan."Workplan Date");
        SHWorkplanWasteType.SETRANGE("Main Process Code", SHWorkplan."Main Process Code");
        SHWorkplanWasteType.SETRANGE("Sub Process Code", SHWorkplan."Sub Process Code");
        SHWorkplanWasteType.SETRANGE("Location Code", SHWorkplan."Location Code");
        IF (SHWorkplanWasteType.FINDSET) THEN BEGIN
          REPEAT
            SHCopyManagement.GenerateWorkplanWasteFlow(SHWorkplanWasteType);
          UNTIL (SHWorkplanWasteType.NEXT = 0);
        END;
      UNTIL (SHWorkplan.NEXT = 0);
      MESSAGE(Text001);
    END;

    PROCEDURE GetNormDescription@1100528306() : Text;
    VAR
      SHCode@1100528300 : Record 11125999;
    BEGIN
      IF (SHCode.GET(SHCode.Type::Norm, "Norm Code")) THEN
        EXIT(SHCode.Description);
      EXIT('');
    END;

    PROCEDURE PrintReportDetailDocuments@1100528307(VAR SHWorkplan@1100528302 : Record 11126011);
    VAR
      UserSetup@1100528308 : Record 91;
      SHWorkplanProcessReport@1100528301 : Record 11126024;
      TempEmailAttachment@1100528303 : TEMPORARY Record 11229294;
      SHPrintManagement@1100528300 : Codeunit 11125986;
    BEGIN
      IF (NOT SHWorkplan.FINDSET(TRUE)) THEN
        EXIT;
      UserSetup.GET(USERID);
      UserSetup.TESTFIELD("PDF Reader Path");
      TempEmailAttachment.DELETEALL;

      REPEAT
        SHWorkplanProcessReport.RESET;
        SHWorkplanProcessReport.SETRANGE("Source Type", SHWorkplan."Source Type");
        SHWorkplanProcessReport.SETRANGE("Source Code", SHWorkplan."Source Code");
        SHWorkplanProcessReport.SETRANGE("Workplan Date", SHWorkplan."Workplan Date");
        SHWorkplanProcessReport.SETRANGE("Main Process Code", SHWorkplan."Main Process Code");
        SHWorkplanProcessReport.SETRANGE("Sub Process Code", SHWorkplan."Sub Process Code");
        SHWorkplanProcessReport.SETRANGE("Location Code", SHWorkplan."Location Code");
        IF (SHWorkplanProcessReport.FINDSET) THEN BEGIN
          REPEAT
            SHWorkplanProcessReport.MARK(TRUE);
          UNTIL (SHWorkplanProcessReport.NEXT = 0);
          SHWorkplanProcessReport.MARKEDONLY(TRUE);
          SHPrintManagement.PrintWorkplanSelectedReports(SHWorkplanProcessReport, TempEmailAttachment);
          UpdateActualDate;
        END;
      UNTIL (SHWorkplan.NEXT = 0);
      SHPrintManagement.PrintCreatedPDFOutputFile(TempEmailAttachment);
    END;

    PROCEDURE UpdateActualDate@1100528305();
    BEGIN
      IF ("Actual Date" = 0D) THEN BEGIN
        "Actual Date" := TODAY;
        MODIFY;
      END;
    END;

    LOCAL PROCEDURE "---Locals---"@1100528301();
    BEGIN
    END;

    LOCAL PROCEDURE DeleteWorkplan@1100528317();
    BEGIN
      DeleteWorkplanTexts(0);
      DeleteWorkplanParticipants;
      DeleteWorkplanProcessTextOptions;
      DeleteWorkplanProcessTexts;
      DeleteWorkplanRiskTexts;
      DeleteWorkplanRiskMeasureTexts;
      DeleteWorkplanRiskMeasurePPMTexts;
      DeleteWorkplanProcessReports;
      DeleteWorkplanProcessReportDetails;
      DeleteWorkplanWasteTypes;
      DeleteWorkplanPlants;
      DeleteWorkplanActions;
    END;

    LOCAL PROCEDURE DeleteWorkplanActions@1100528309();
    VAR
      SHWorkplanAction@1100528300 : Record 11126032;
    BEGIN
      SHWorkplanAction.SETRANGE("Source Type", "Source Type");
      SHWorkplanAction.SETRANGE("Source Code", "Source Code");
      SHWorkplanAction.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanAction.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanAction.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanAction.SETRANGE("Location Code", "Location Code");
      SHWorkplanAction.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanParticipants@1100528318();
    VAR
      SHWorkplanParticipant@1100528306 : Record 11126012;
    BEGIN
      SHWorkplanParticipant.SETRANGE("Source Type", "Source Type");
      SHWorkplanParticipant.SETRANGE("Source Code", "Source Code");
      SHWorkplanParticipant.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanParticipant.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanParticipant.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanParticipant.SETRANGE("Location Code", "Location Code");
      SHWorkplanParticipant.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanTexts@1100528310(TextType@1100528301 : Option);
    VAR
      SHWorkplanText@1100528300 : Record 11126013;
    BEGIN
      SHWorkplanText.SETRANGE("Text Type", TextType);
      SHWorkplanText.SETRANGE("Source Type", "Source Type");
      SHWorkplanText.SETRANGE("Source Code", "Source Code");
      SHWorkplanText.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanText.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanText.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanText.SETRANGE("Location Code", "Location Code");
      SHWorkplanText.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanProcessReports@1100528315();
    VAR
      SHWorkplanProcessReport@1100528304 : Record 11126024;
    BEGIN
      SHWorkplanProcessReport.SETRANGE("Source Type", "Source Type");
      SHWorkplanProcessReport.SETRANGE("Source Code", "Source Code");
      SHWorkplanProcessReport.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanProcessReport.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanProcessReport.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanProcessReport.SETRANGE("Location Code", "Location Code");
      SHWorkplanProcessReport.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanProcessReportDetails@1100528325();
    VAR
      SHWorkpProcessReportDetail@1100528304 : Record 11126025;
    BEGIN
      SHWorkpProcessReportDetail.SETRANGE("Source Type", "Source Type");
      SHWorkpProcessReportDetail.SETRANGE("Source Code", "Source Code");
      SHWorkpProcessReportDetail.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkpProcessReportDetail.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkpProcessReportDetail.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkpProcessReportDetail.SETRANGE("Location Code", "Location Code");
      SHWorkpProcessReportDetail.DELETEALL(TRUE);
    END;

    LOCAL PROCEDURE DeleteWorkplanProcessTexts@1100528311();
    VAR
      SHWorkplanProcessText@1100528304 : Record 11126014;
    BEGIN
      SHWorkplanProcessText.SETRANGE("Source Type", "Source Type");
      SHWorkplanProcessText.SETRANGE("Source Code", "Source Code");
      SHWorkplanProcessText.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanProcessText.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanProcessText.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanProcessText.SETRANGE("Location Code", "Location Code");
      SHWorkplanProcessText.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanProcessTextOptions@1100528319();
    VAR
      SHWorkplanProcessTxtOption@1100528303 : Record 11126015;
    BEGIN
      SHWorkplanProcessTxtOption.SETRANGE("Source Type", "Source Type");
      SHWorkplanProcessTxtOption.SETRANGE("Source Code", "Source Code");
      SHWorkplanProcessTxtOption.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanProcessTxtOption.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanProcessTxtOption.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanProcessTxtOption.SETRANGE("Location Code", "Location Code");
      SHWorkplanProcessTxtOption.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanRiskTexts@1100528312();
    VAR
      SHWorkplanRiskText@1100528302 : Record 11126020;
    BEGIN
      SHWorkplanRiskText.SETRANGE("Source Type", "Source Type");
      SHWorkplanRiskText.SETRANGE("Source Code", "Source Code");
      SHWorkplanRiskText.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanRiskText.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanRiskText.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanRiskText.SETRANGE("Location Code", "Location Code");
      SHWorkplanRiskText.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanRiskMeasureTexts@1100528313();
    VAR
      SHWorkplanRiskMeasureText@1100528301 : Record 11126021;
    BEGIN
      SHWorkplanRiskMeasureText.SETRANGE("Source Type", "Source Type");
      SHWorkplanRiskMeasureText.SETRANGE("Source Code", "Source Code");
      SHWorkplanRiskMeasureText.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanRiskMeasureText.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanRiskMeasureText.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanRiskMeasureText.SETRANGE("Location Code", "Location Code");
      SHWorkplanRiskMeasureText.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanRiskMeasurePPMTexts@1100528314();
    VAR
      SHWorkpRiskMeasurePPMText@1100528300 : Record 11126022;
    BEGIN
      SHWorkpRiskMeasurePPMText.SETRANGE("Source Type", "Source Type");
      SHWorkpRiskMeasurePPMText.SETRANGE("Source Code", "Source Code");
      SHWorkpRiskMeasurePPMText.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkpRiskMeasurePPMText.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkpRiskMeasurePPMText.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkpRiskMeasurePPMText.SETRANGE("Location Code", "Location Code");
      SHWorkpRiskMeasurePPMText.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanWasteTypes@1100528340();
    VAR
      SHWorkplanWasteType@1100528304 : Record 11126028;
    BEGIN
      SHWorkplanWasteType.SETRANGE("Source Type", "Source Type");
      SHWorkplanWasteType.SETRANGE("Source Code", "Source Code");
      SHWorkplanWasteType.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanWasteType.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanWasteType.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanWasteType.SETRANGE("Location Code", "Location Code");
      SHWorkplanWasteType.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteWorkplanPlants@1100528341();
    VAR
      SHWorkplanPlant@1100528304 : Record 11126029;
    BEGIN
      SHWorkplanPlant.SETRANGE("Source Type", "Source Type");
      SHWorkplanPlant.SETRANGE("Source Code", "Source Code");
      SHWorkplanPlant.SETRANGE("Workplan Date", "Workplan Date");
      SHWorkplanPlant.SETRANGE("Main Process Code", "Main Process Code");
      SHWorkplanPlant.SETRANGE("Sub Process Code", "Sub Process Code");
      SHWorkplanPlant.SETRANGE("Location Code", "Location Code");
      SHWorkplanPlant.DELETEALL;
    END;

    LOCAL PROCEDURE FillDefaultFields@1100528304();
    VAR
      SHProcess@1100528300 : Record 11126000;
    BEGIN
      IF (NOT SHProcess.GET("Main Process Code", "Sub Process Code")) THEN
        SHProcess.INIT;
      "Process Type" := SHProcess."Process Type";
      Periodical := SHProcess.Periodical;
    END;

    LOCAL PROCEDURE FillLocationDescription@1100528300();
    VAR
      SHCode@1100528300 : Record 11125999;
      SHWorkplan@1100528301 : Record 11126011;
    BEGIN
      SHWorkplan.SETRANGE("Source Type", "Source Type");
      SHWorkplan.SETRANGE("Source Code", "Source Code");
      SHWorkplan.SETFILTER("Main Process Code", '<>%1', "Main Process Code");
      SHWorkplan.SETFILTER("Sub Process Code", '<>%1', "Sub Process Code");
      SHWorkplan.SETRANGE("Location Code", "Location Code");
      IF (SHWorkplan.FINDFIRST) THEN
        "Location Description" := SHWorkplan."Location Description"
      ELSE BEGIN
        SHCode.GET(SHCode.Type::Location, "Location Code");
        "Location Description" := SHCode.Description;
      END;
    END;

    BEGIN
    END.
  }
}

