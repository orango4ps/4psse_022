OBJECT Page 81651 Job List sub.proj
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW17.00,4PS6.00 (89),4PSSE.I013.I041,SEEV.CC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sub Project List;
               NOR=Delprosjekt Í liste;
               SVE=Underprojekt Í lista];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table11072003;
    SourceTableView=WHERE(Project Status=FILTER(..Administrative Finished));
    PageType=List;
    CardPageID=Job Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Commission & Invoicing,Budget & Structure,Project control,Engineering & Purchase,Documents;
                                NOR=Nytt,Behandle,Rapport,Oppdragsgiver & Fakturering,Budsjett & Strukturer,Prosjektkontroll,Prosjektering & Kj›p,Dokumenter;
                                SVE=Nytt,Behandla,Rapport,Uppdragsgivare & Fakturering,Budget & Strukturer,Projektkontroll,Engineering & Purchase,Dokument];
    ShowFilter=Yes;
    OnInit=BEGIN
             CopyButtonEnable := TRUE;
             ProjectButtonVisible := TRUE;
             DocumentButtonVisible := TRUE;
           END;

    OnOpenPage=VAR
                 lProjRec2@1100525001 : Record 11072003;
                 RelationSetup@1100525002 : Record 5079;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 //**4PS.sn
                 ProjSetup.GET;
                 IF NOT gCopyServLoc THEN
                   CopyButtonEnable := FALSE;

                 //>> 160204 ITERO.DL
                 {
                 //Disable Menubutton if called from other company
                 gOtherCompany := FALSE;
                 IF FIND('=<>') THEN BEGIN
                   lProjRec2.COPY(Rec);
                   IF NOT lProjRec2.FIND('=<>') THEN
                     CLEAR(lProjRec2);
                   gOtherCompany := NOT ("No." + Description = lProjRec2."No."+ lProjRec2.Description);
                   ProjectButtonVisible := NOT gOtherCompany;
                   RelationSetup.GET;
                   DocumentButtonVisible := (gOtherCompany AND NOT RelationSetup."Show only own documents");
                 END;
                 //**4PS.en
                 }
                 //<< 160204 ITERO.DL

                 //>> 170411 ITERO.SB RFC-211 Do not set filter on invoiced (ready) in subproject list
                 //SETRANGE("Invoiced (ready)",FALSE);
                 //<<
               END;

    OnAfterGetRecord=BEGIN
                       //**4PS.sn
                       NameHideValue := FALSE;

                       IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
                         SETRANGE("Project Filter", "No.")
                       ELSE
                         SETRANGE("Project Filter");
                       //140612 CALCFIELDS(Revenues);
                       NameOnFormat;
                       //**4PS.en
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525042;1 ;ActionGroup;
                      CaptionML=[ENU=Commission & Invoicing;
                                 NOR=Oppdragsgiver & Fakturering;
                                 SVE=Uppdragsgivare & Fakturering] }
      { 1101200005;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+P;
                      CaptionML=[ENU=Principals;
                                 NOR=oppdragsgiver;
                                 SVE=Uppdragsgivare];
                      Promoted=Yes;
                      Image=TeamSales;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 //**4PS
                                 ProjPrincipRec.RESET;
                                 ProjPrincipRec.SETRANGE("Project No.","No.");
                                 IF "Bill-to Customer No." <> '' THEN
                                   IF NOT ProjPrincipRec.GET("No.","Bill-to Customer No.") THEN
                                     ProjPrincipRec.SETRANGE(Principal,"Bill-to Customer No.");
                                 PAGE.RUN(PAGE::"Project Principal List",ProjPrincipRec);
                               END;
                                }
      { 1101200023;2 ;Action    ;
                      CaptionML=[ENU=&Installments;
                                 NOR=&Betalingsplaner;
                                 SVE=&Betalplaner];
                      RunObject=Page 11012025;
                      RunPageView=SORTING(Project No.,Principal,Installment No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=AmountByPeriod;
                      PromotedCategory=Category4 }
      { 1101200017;2 ;Action    ;
                      ShortCutKey=Ctrl+M;
                      CaptionML=[ENU=&Extensions;
                                 NOR=&ETA;
                                 SVE=&ŽTA];
                      RunObject=Page 11012014;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=TransferFunds;
                      PromotedCategory=Category4 }
      { 1100525043;2 ;ActionGroup;
                      CaptionML=[ENU=Cost plus & Unit Prices;
                                 NOR=Selvkoster og Enhetspriser;
                                 SVE=Sj„lvkostnader & Enhetspriser];
                      Image=CostAccounting }
      { 1101200024;3 ;Action    ;
                      CaptionML=[ENU=&Cost Plus Entries;
                                 NOR=&Rapporterte selvkoster;
                                 SVE=&Redovisade sj„lvkostnader];
                      RunObject=Page 11012043;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=ApplyEntries }
      { 1100525036;3 ;Action    ;
                      CaptionML=[ENU=Project &Unit Prices;
                                 NOR=Prosjekt&enhetspriser;
                                 SVE=Projekt&enhetspriser];
                      RunObject=Page 11072519;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostCenter }
      { 1100525037;3 ;Action    ;
                      CaptionML=[ENU=Production Motivation;
                                 NOR=Produksjonsmotivasjon;
                                 SVE=Produktionsorsak];
                      Image=Production;
                      OnAction=VAR
                                 ProdMot@1100525000 : Record 11020425;
                               BEGIN
                                 ProdMot.RunUnitPriceProdMotList("No.", '', 0);  //* Level 0=Project
                               END;
                                }
      { 1100525029;2 ;ActionGroup;
                      CaptionML=[ENU=Sales rates;
                                 NOR=Salgsrater;
                                 SVE=F”rs„ljningspriser];
                      Image=Sales }
      { 1100525030;3 ;Action    ;
                      CaptionML=[ENU=Project - &Employee Sales Prices;
                                 NOR=Prosjekt Í &salgspriser for ansatt;
                                 SVE=Projekt Í &f”rs„ljningspriser f”r anst„lld];
                      RunObject=Page 11072469;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPerson }
      { 1100525031;3 ;Action    ;
                      CaptionML=[ENU=Project - Employee - &Cost Object Sales Prices;
                                 NOR=Prosjekt Í ansatt Í &salgspriser for kostobjekt;
                                 SVE=Projekt Í anst„lld Í &f”rs„ljningspriser f”r kostnadsobjekt];
                      RunObject=Page 11072497;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100525032;3 ;Action    ;
                      CaptionML=[ENU=Project - Employee - Cost Object - &Wage Component Sales Prices;
                                 NOR=Prosjekt Í ansatt Í kostobjekt Í &salgspriser for l›nnsart;
                                 SVE=Projekt Í anst„lld Í kostnadsobjekt Í &f”rs„ljningspriser f”r l”neart];
                      RunObject=Page 11072498;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ItemTrackingLedger }
      { 1100525033;3 ;Action    ;
                      CaptionML=[ENU=Project - Cost &Object Sales Prices;
                                 NOR=Prosjekt Í salgspriser for kost&objekt;
                                 SVE=Projekt Í f”rs„ljningspriser f”r kostnads&objekt];
                      RunObject=Page 11072467;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Item }
      { 1100525034;3 ;Action    ;
                      CaptionML=[ENU=Project - Cost Object - Wage Component Sales Prices;
                                 NOR=Prosjekt Í kostobjekt Í salgspriser for l›nnsart;
                                 SVE=Projekt Í kostnadsobjekt Í f”rs„ljningspriser f”r l”neart];
                      RunObject=Page 11072468;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525044;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1101200002;3 ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer;
                                 SVE=Fakturor];
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowPostedInvoices;
                               END;
                                }
      { 1101200003;3 ;Action    ;
                      CaptionML=[ENU=Credit &Memos;
                                 NOR=Kredit&notaer;
                                 SVE=Kredit&notor];
                      Promoted=No;
                      Image=CreditMemo;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowPostedCreditMemos;
                               END;
                                }
      { 1210190027;3 ;Action    ;
                      CaptionML=[ENU=Rental Units;
                                 NOR=Leieenheter;
                                 SVE=Uthyrningsenheter];
                      Image=BlanketOrder;
                      OnAction=VAR
                                 RentalUnitRec@1100485000 : Record 11012940;
                               BEGIN
                                 //**4PS
                                 ProjSetup.TESTFIELD("Rental Units active");
                                 RentalUnitRec.SETRANGE("Project No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Rental Unit",RentalUnitRec);
                               END;
                                }
      { 1100525068;3 ;Action    ;
                      CaptionML=[ENU=Exchange Rates;
                                 NOR=Valutakurser;
                                 SVE=Byt avgifter];
                      Image=CurrencyExchangeRates;
                      OnAction=BEGIN
                                 ShowCurrencyExchangeRates;
                               END;
                                }
      { 1100525017;1 ;ActionGroup;
                      CaptionML=[ENU=Budget & Structure;
                                 NOR=Budsjett & Struktur;
                                 SVE=Budget & Struktur];
                      Image=Administration }
      { 1101200015;2 ;Action    ;
                      CaptionML=[ENU=Elemen&ts;
                                 NOR=Elemen&t;
                                 SVE=Elemen&t];
                      RunObject=Page 11012028;
                      RunPageView=SORTING(Project No.,Element);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=BOMVersions;
                      PromotedCategory=Category5 }
      { 1101200016;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=&Budget;
                                 NOR=&Budsjett;
                                 SVE=&Budget];
                      RunObject=Page 11012003;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=LedgerBudget;
                      PromotedCategory=Category5 }
      { 1101200018;2 ;Action    ;
                      CaptionML=[ENU=Budget &Adjustments;
                                 NOR=Budsjett&justeringer;
                                 SVE=Budget&justeringar];
                      Promoted=Yes;
                      Image=Balance;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BudgetAdjustment@1100525000 : Record 11012003;
                               BEGIN
                                 BudgetAdjustment.SETRANGE("Project No.", "No.");
                                 IF BudgetAdjustment.FINDLAST THEN;
                                   PAGE.RUNMODAL(PAGE::"Budget Adjustment List", BudgetAdjustment);
                               END;
                                }
      { 1100525023;2 ;ActionGroup;
                      CaptionML=[ENU=Rates Cost Prices;
                                 NOR=Selvkoster;
                                 SVE=Sj„lvkostnadspriser];
                      Image=CostAccounting }
      { 1100525021;3 ;Action    ;
                      CaptionML=[ENU=Project &Budget Rates;
                                 NOR=Prosjektets &Budsjettsatser;
                                 SVE=Projektets &budgetavgifter];
                      RunObject=Page 11020264;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=LedgerBudget }
      { 1100525024;3 ;Action    ;
                      CaptionML=[ENU=Project - &Employee Cost Prices;
                                 NOR=Prosjekt Í &selvkoster for ansatt;
                                 SVE=Projekt Í &sj„lvkostnadspriser f”r anst„lld];
                      RunObject=Page 11020300;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Employee }
      { 1100525025;3 ;Action    ;
                      CaptionML=[ENU=Project - Employee - &Wage Component Cost Prices;
                                 NOR=Prosjekt Í ansatt Í &Selvkoster for l›nnsart;
                                 SVE=Projekt Í anst„lld Í &sj„lvkostnadspriser f”r l”neart];
                      RunObject=Page 11072435;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525026;3 ;Action    ;
                      CaptionML=[ENU=Project - &Cost Object Cost Prices;
                                 NOR=Prosjekt Í &selvkoster for kostobjekt;
                                 SVE=Projekt Í &sj„lvkostnadspriser f”r kostnadsobjekt];
                      RunObject=Page 11072434;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostAccountingDimensions }
      { 1100525027;3 ;Action    ;
                      CaptionML=[ENU=Project - &Trade Association Cost Prices;
                                 NOR=Prosjekt Í &selvkoster for bransjeorganisasjoner;
                                 SVE=Projekt Í &sj„lvkostnadspriser f”r branschorganisationer];
                      RunObject=Page 11072432;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Union }
      { 1100525028;3 ;Action    ;
                      CaptionML=[ENU=Project - Trade Association - Wage Co&mponent Cost Prices;
                                 NOR=Prosjekt Í bransjeorganisasjon Í &selvkoster for l›nnsart;
                                 SVE=Projekt Í branschorganisation Í sj„lv&sj„lvkostnadspriser f”r l”neart];
                      RunObject=Page 11072433;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525045;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1210190035;3 ;Action    ;
                      CaptionML=[ENU=Project Cost Objects;
                                 NOR=Prosjekt Í kostobjekt;
                                 SVE=Projekt Í kostnadsobjekt];
                      RunObject=Page 11012128;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Dimensions }
      { 1100525012;1 ;ActionGroup;
                      CaptionML=[ENU=Project Control;
                                 NOR=Prosjektkontroll;
                                 SVE=Projektkontroll];
                      Image=SNInfo }
      { 1100525013;2 ;Action    ;
                      CaptionML=[ENU=Project Control;
                                 NOR=Prosjektkontroll;
                                 SVE=Projektkontroll];
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100525000 : Record 11072003;
                               BEGIN
                                 OpenProjectControl;
                               END;
                                }
      { 1100285502;2 ;Action    ;
                      CaptionML=[ENU=Project Control Overview;
                                 NOR=Prosjektstyring oversikt;
                                 SVE=Projektkontroll ”versikt];
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100285500 : Record 11072003;
                               BEGIN
                                 OpenProjectControlOverview;
                               END;
                                }
      { 1100285501;2 ;Action    ;
                      CaptionML=[ENU=Project Control Summarized;
                                 NOR=Prosjektstyring oppsummert;
                                 SVE=Projektkontroll sammandrag];
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100285500 : Record 11072003;
                               BEGIN
                                 OpenProjectControlSummarized;
                               END;
                                }
      { 32      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 NOR=&Transaksjoner;
                                 SVE=&Transaktioner];
                      RunObject=Page 11072005;
                      RunPageView=SORTING(Job No.,Posting Date);
                      RunPageLink=Job No.=FIELD(No.);
                      Promoted=Yes;
                      Image=LedgerEntries;
                      PromotedCategory=Category6 }
      { 1100525014;2 ;Action    ;
                      CaptionML=[ENU=P&rogress;
                                 NOR=F&remdrift;
                                 SVE=F”&rlopp];
                      RunObject=Page 11012079;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=EditLines;
                      PromotedCategory=Category6 }
      { 1100525095;2 ;Action    ;
                      CaptionML=[ENU=Pr&ognosis;
                                 NOR=Pr&ognose;
                                 SVE=Pr&ognos];
                      Promoted=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 LaunchPrognosisList;
                               END;
                                }
      { 1100285101;2 ;Action    ;
                      CaptionML=[ENU=Project details;
                                 NOR=Prosjektdetaljer;
                                 SVE=Projektdetaljer];
                      Promoted=Yes;
                      Visible=true;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 MgtProjdetails@1100285000 : Codeunit 11128091;
                               BEGIN
                                 //>>160711 ITERO.SB RFC-101 Added action, show new project control page
                                 MgtProjdetails.MgtProjDetail(USERID,"No.");
                                 //<<
                               END;
                                }
      { 1100525046;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1100525066;3 ;Action    ;
                      CaptionML=[ENU=Snapshot;
                                 NOR=Snapshot;
                                 SVE=Snapshot];
                      RunObject=Page 11124895;
                      RunPageView=SORTING(Project No.,Snapshot Date);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SuggestCapacity }
      { 1100525067;3 ;Action    ;
                      CaptionML=[ENU=&Forecast;
                                 NOR=&Forecast;
                                 SVE=&Prognos];
                      Image=Forecast }
      { 1100525015;3 ;Action    ;
                      CaptionML=[ENU=Pr&ognosis;
                                 NOR=Pr&ognose;
                                 SVE=Pr&ognos];
                      Promoted=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Prognosis@1100528800 : Record 11012034;
                               BEGIN
                                 LaunchPrognosisList;
                               END;
                                }
      { 1100525016;3 ;Action    ;
                      CaptionML=[ENU=Liquidity Prognosis;
                                 NOR=Likviditetsprognose;
                                 SVE=Likviditetsprognos];
                      Image=PaymentForecast;
                      OnAction=VAR
                                 LiqProgProjHead@1100525000 : Record 11020603;
                               BEGIN
                                 TESTFIELD("Liquidity Prognosis", "Liquidity Prognosis"::"Specific Division");

                                 LiqProgProjHead.SETRANGE("Project No.", "No.");
                                 PAGE.RUNMODAL(PAGE::"Liquidity Prognosis Proj Head", LiqProgProjHead);
                               END;
                                }
      { 1100525051;1 ;ActionGroup;
                      CaptionML=[ENU=Engineering & Purchase;
                                 NOR=Ingeni›rkunst & Innkj›p;
                                 SVE=Ingenj”rskonst & Ink”p];
                      Image=Purchasing }
      { 1100525058;2 ;Action    ;
                      CaptionML=[ENU=Advice Orders;
                                 NOR=Bestillingsunderlag;
                                 SVE=Best„llningsunderlag];
                      RunObject=Page 11012102;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=OrderReminder;
                      PromotedCategory=Category7 }
      { 1101200021;2 ;Action    ;
                      CaptionML=[ENU=Purchase Actions;
                                 NOR=Innkj›pshandlinger;
                                 SVE=Ink”ps†tg„rder];
                      RunObject=Page 11012034;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=OrderTracking;
                      PromotedCategory=Category7 }
      { 1210190000;2 ;Action    ;
                      CaptionML=[ENU=Purchase Orders;
                                 NOR=Innkj›psordre;
                                 SVE=Ink”psorder];
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 ShowPurchaseOrdersForProject;
                               END;
                                }
      { 1100525059;2 ;Action    ;
                      CaptionML=[ENU=Purchase Quotes;
                                 NOR=Innkj›pstilbud;
                                 SVE=Ink”psofferter];
                      Image=Purchase;
                      OnAction=BEGIN
                                 ShowQuotesForProject;
                               END;
                                }
      { 1100525041;2 ;Action    ;
                      CaptionML=[ENU=Planning Activities;
                                 NOR=Planleggingsaktiviteter;
                                 SVE=Planeringsaktiviteter];
                      RunObject=Page 11072310;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=JobTimeSheet;
                      PromotedCategory=Category7 }
      { 1100525056;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1100525040;3 ;Action    ;
                      CaptionML=[ENU=Activities;
                                 NOR=Aktiviteter;
                                 SVE=Aktiviteter];
                      Image=Task;
                      OnAction=BEGIN
                                 ShowTodos;
                               END;
                                }
      { 1100525005;3 ;Action    ;
                      CaptionML=[ENU=Matrix Purchase Actions &Document Relations;
                                 NOR=Matrise for &dokumentrelasjoner (Innkj›pshandling);
                                 SVE=Matrisink”ps†tg„rd f”r &dokumentrelationer];
                      Image=Document;
                      OnAction=VAR
                                 MatrixPurchActDocRelations@1100525000 : Page 11071829;
                               BEGIN
                                 TESTFIELD("No.");
                                 MatrixPurchActDocRelations.SetProjectNo("No.");
                                 MatrixPurchActDocRelations.RUNMODAL;
                               END;
                                }
      { 1210190030;1 ;ActionGroup;
                      CaptionML=[ENU=Buyer Management;
                                 NOR=Kj›perh†ndtering;
                                 SVE=K”parhantering];
                      Image=AdministrationSalesPurchases }
      { 1101200011;2 ;Action    ;
                      CaptionML=[ENU=Plots;
                                 NOR=Tegningnr;
                                 SVE=Ritningar];
                      RunObject=Page 11012506;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=AddToHome }
      { 1100525048;2 ;Action    ;
                      CaptionML=[ENU=Option Quotes;
                                 NOR=Alternativtilbud;
                                 SVE=Alternativofferter];
                      RunObject=Page 11012546;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Quote;
                      OnAction=VAR
                                 BuyerMgt@1100525000 : Codeunit 11012500;
                               BEGIN
                                 // TESTFIELD("No.");
                                 // BuyerMgt.EditOptionQuote("No.", '');
                               END;
                                }
      { 1100525047;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1101200010;3 ;Action    ;
                      CaptionML=[ENU=House Types;
                                 NOR=Hustyper;
                                 SVE=Hustyper];
                      Promoted=No;
                      Image=NewWarehouse;
                      OnAction=VAR
                                 lvHouseModelRec@1210190000 : Record 11012501;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 lvHouseModelRec.FILTERGROUP(9);
                                 lvHouseModelRec.SETRANGE("Project No.", "No.");
                                 lvHouseModelRec.FILTERGROUP(0);
                                 PAGE.RUNMODAL(PAGE::"House Models by Project List", lvHouseModelRec);
                               END;
                                }
      { 1100525049;3 ;Action    ;
                      CaptionML=[ENU=Delivery;
                                 NOR=Leveranse;
                                 SVE=LEVERANS];
                      RunObject=Page 11012528;
                      RunPageView=WHERE(Plot No.=FILTER(''));
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Delivery }
      { 1210190028;3 ;Action    ;
                      CaptionML=[ENU=Project Options;
                                 NOR=Prosjektalternativer;
                                 SVE=Projektalternativ];
                      Image=Quote;
                      OnAction=BEGIN
                                 //**4PS
                                 OptionList();
                               END;
                                }
      { 1210190046;3 ;Action    ;
                      CaptionML=[ENU=Main Groups;
                                 NOR=Hovedgrupper;
                                 SVE=Huvudgrupper];
                      RunObject=Page 11012543;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Group }
      { 1101200013;3 ;Action    ;
                      CaptionML=[ENU=Groups;
                                 NOR=Grupper;
                                 SVE=Grupper];
                      RunObject=Page 11012518;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Group }
      { 1210190047;3 ;Action    ;
                      CaptionML=[ENU=Sub Groups;
                                 NOR=Undergrupper;
                                 SVE=Undergrupper];
                      RunObject=Page 11012542;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Group }
      { 1100525002;1 ;ActionGroup;
                      CaptionML=[ENU=&Civil Engineering;
                                 NOR=&Sivilingeni›r;
                                 SVE=&V„g- och vattenbyggnad];
                      Image=Travel }
      { 1100525022;2 ;Action    ;
                      CaptionML=[ENU=Project &Tender Paragraphs;
                                 NOR=Prosjekt&Tilbudsavsnitt;
                                 SVE=Projekt&anbudsstycken];
                      RunObject=Page 11020346;
                      RunPageLink=No.=FIELD(No.);
                      Image=Job }
      { 1100525003;2 ;Action    ;
                      CaptionML=[ENU=Tender Paragraphs;
                                 NOR=Tilbudsavsnitt;
                                 SVE=AMA koder];
                      RunObject=Page 11020553;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CalculateCost }
      { 1100525035;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1100525004;3 ;Action    ;
                      CaptionML=[ENU=Tender Paragraph &Parts;
                                 NOR=Tilbudsavsnitts&deler;
                                 SVE=Anbudsstycke&delar];
                      RunObject=Page 11020554;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CalculateCrossDock }
      { 1100525052;3 ;Action    ;
                      CaptionML=[ENU=Project Inspections (Site Mgt.);
                                 NOR=Prosjektinspeksjoner (byggeledelse);
                                 SVE=Projektinspektioner (byggledning)];
                      RunObject=Page 11125538;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Check }
      { 1100525053;1 ;ActionGroup;
                      CaptionML=[ENU=Site Manager Form;
                                 NOR=Prosjektlederskjema;
                                 SVE=Arbetschef-formul„r] }
      { 1100525054;2 ;Action    ;
                      CaptionML=[ENU=Project Working Hours;
                                 NOR=Prosjektarbeidstimer;
                                 SVE=Projektarbetstimmar];
                      RunObject=Page 11125541;
                      RunPageLink=No.=FIELD(No.);
                      Image=JobTimeSheet }
      { 1100525055;2 ;Action    ;
                      CaptionML=[ENU=Project Inspections;
                                 NOR=Prosjektinspeksjoner;
                                 SVE=Projektinspektioner];
                      RunObject=Page 11125538;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CheckRulesSyntax }
      { 1100525018;1 ;ActionGroup;
                      CaptionML=[ENU=&Project Tables;
                                 NOR=&Prosjekttabeller;
                                 SVE=&Projekttabeller];
                      Image=Worksheets }
      { 34      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Job),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1210190034;2 ;Action    ;
                      CaptionML=[ENU=Do&cuments;
                                 NOR=Do&kumenter;
                                 SVE=Do&kument];
                      Promoted=No;
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                                 DocumentFilters@1100525002 : Codeunit 11012432;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 // ByCompany changed to FALSE, otherwise documents are not showed in the archive company
                                   DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, FALSE);
                               END;
                                }
      { 1100525057;2 ;ActionGroup;
                      CaptionML=[ENU=Locations;
                                 NOR=Plasseringer;
                                 SVE=Lagerst„llen];
                      Image=Addresses }
      { 1210190031;3 ;Action    ;
                      CaptionML=[ENU=Project Locations;
                                 NOR=Prosjektplasseringer;
                                 SVE=Etableringar];
                      RunObject=Page 11012020;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Job }
      { 1100525020;3 ;Action    ;
                      CaptionML=[ENU=Job Preferred &Locations;
                                 NOR=Foretrukne &Plasseringer for jobb;
                                 SVE=F”rvalda &lagerst„llen f”r jobb];
                      RunObject=Page 11072043;
                      RunPageView=SORTING(Priority);
                      RunPageLink=Type=CONST(Job),
                                  No.=FIELD(No.);
                      Image=RoutingVersions }
      { 1100525060;2 ;ActionGroup;
                      CaptionML=[ENU=QA;
                                 NOR=Kvalitetssikring;
                                 SVE=Kvalitetss„kring];
                      Image=AnalysisView }
      { 1100525050;3 ;Action    ;
                      CaptionML=[ENU=Complaint Management;
                                 NOR=Klageh†ndtering;
                                 SVE=Incidenthantering];
                      RunObject=Page 11012468;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=EditReminder }
      { 1100525061;2 ;ActionGroup;
                      CaptionML=[ENU=More..;
                                 NOR=Mer..;
                                 SVE=Mer..];
                      Image=Navigate }
      { 1101200007;3 ;Action    ;
                      CaptionML=[ENU=Responsible Persons;
                                 NOR=Ansvarlige personer;
                                 SVE=Ansvariga personer];
                      RunObject=Page 11012017;
                      RunPageView=SORTING(Project No.,Line No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=PersonInCharge }
      { 1100525011;3 ;Action    ;
                      CaptionML=[ENU=Project &Inventory;
                                 NOR=Prosjekt&lager;
                                 SVE=Projekt&lager];
                      RunObject=Page 11012673;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=LedgerBook }
      { 1100525019;3 ;Action    ;
                      CaptionML=[ENU=Project &Authorities;
                                 NOR=Prosjekt&myndigheter;
                                 SVE=Projekt&myndigheter];
                      RunObject=Page 11020231;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=IndustryGroups }
      { 13      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(11072003),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 1100525038;3 ;Action    ;
                      CaptionML=[ENU=Features;
                                 NOR=Funksjoner;
                                 SVE=Funktioner];
                      Image=QualificationOverview;
                      OnAction=BEGIN
                                 ShowFeatures;
                               END;
                                }
      { 1101200008;3 ;Action    ;
                      CaptionML=[ENU=Picture;
                                 NOR=Bilde;
                                 SVE=Bild];
                      RunObject=Page 11012030;
                      RunPageLink=No.=FIELD(No.);
                      Image=Picture }
      { 1100525039;3 ;Action    ;
                      CaptionML=[ENU=Exchange Rates;
                                 NOR=Valutakurser;
                                 SVE=Byt avgifter];
                      RunObject=Page 11124939;
                      RunPageLink=Project Filter=FIELD(No.) }
      { 1100525062;1 ;ActionGroup;
                      CaptionML=[ENU=Sales && Marketing;
                                 NOR=Salg og &markedsf›ring;
                                 SVE=F”rs„ljning och &marknadsf”ring];
                      Visible=FALSE }
      { 1100525063;2 ;Action    ;
                      CaptionML=[ENU=Try-out;
                                 NOR=Prospekt;
                                 SVE=Anbud];
                      OnAction=BEGIN
                                 ShowTryOut(1);
                               END;
                                }
      { 1100525064;2 ;Action    ;
                      CaptionML=[ENU=Try-out &Quote;
                                 NOR=T&ilbudsforesp›rsel;
                                 SVE=A&nbudsf”rfr†gan];
                      OnAction=BEGIN
                                 ShowTryOut(2);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1900979604;1 ;Action    ;
                      CaptionML=[ENU=Copy Job;
                                 NOR=Kopier prosjekt;
                                 SVE=Kopiera projekt];
                      RunObject=Report 11072016;
                      Promoted=No;
                      Image=CopyFromTask;
                      PromotedCategory=New }
      { 1100525006;1 ;Action    ;
                      Name=DocumentButton;
                      CaptionML=[ENU=&Documents;
                                 NOR=&Dokumenter;
                                 SVE=&Dokument];
                      Promoted=Yes;
                      Visible=DocumentButtonVisible;
                      Image=Documents;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 RecRef@1100525003 : RecordRef;
                                 DocumentLinkMgt@1100525004 : Codeunit 11012401;
                                 CurrentCompany@1100525001 : Text[30];
                                 Contact@1100285101 : Record 5050;
                                 DocumentTemplate@1100285100 : Record 11012401;
                               BEGIN
                                 // RecRef.GETTABLE(Rec);
                                 // CurrentCompany := Rec.GETFILTER("Company Filter");
                                 // DocumentLinkMgt.OpenDocumentPropertiesListComp(RecRef, "Global Dimension 1 Code", FALSE, NOT gOtherCompany, CurrentCompany);
                                 TESTFIELD("Bill-to Customer No.");
                                 IF Contact.GetContactByCustomer("Bill-to Customer No.", Contact, TRUE) THEN
                                   EditDocuments(STRSUBSTNO('%1', DocumentTemplate.Type::Job), Contact."No.", '', FALSE, '');
                               END;
                                }
      { 1210190036;1 ;Action    ;
                      Name=CopyButton;
                      CaptionML=[ENU=&Copy;
                                 NOR=&Kopier;
                                 SVE=&Kopiera];
                      Enabled=CopyButtonEnable;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 CopyServiceLocation;
                                 COMMIT;
                                 CurrPage.CLOSE;
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=Re-calculate job;
                      CaptionML=[ENU=Refresh pre-calculation;
                                 NOR=Oppdater pre-beregning;
                                 SVE=Uppdatera f”r-ber„kning];
                      Image=Calculate;
                      PromotedCategory=New;
                      OnAction=VAR
                                 preCalcJobFigures@1000000000 : Codeunit 81650;
                               BEGIN
                                 preCalcJobFigures.CalcJob(Rec,WORKDATE);
                               END;
                                }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=Exports;
                                 SVE=Exporter] }
      { 1100285002;2 ;Action    ;
                      Name=ExportToSymbrioButton;
                      CaptionML=[ENU=Export to Symbrio...;
                                 NOR=Exportere til Symbrio...;
                                 SVE=Exportera till Symbrio...];
                      RunObject=Report 11127975;
                      Visible=TRUE;
                      Image=ExportElectronicDocument }
      { 1000000001;2 ;Action    ;
                      Name=ExportDim2SymbrioBuff;
                      CaptionML=[ENU=Export Costcenters to Symbrio...;
                                 NOR=Exportere KST til Symbrio...;
                                 SVE=Exportera KST till Symbrio...];
                      RunObject=Report 11127976;
                      Visible=FALSE;
                      Image=ExportElectronicDocument }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1100528800;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE }

    { 1100485008;2;Field  ;
                SourceExpr="Project Address Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Bill-to Customer No." }

    { 1100485019;2;Field  ;
                CaptionML=[ENU=Name (Small Project);
                           NOR=Navn (lite prosjekt);
                           SVE=Namn (mindre projekt)];
                SourceExpr=Name;
                Visible=FALSE;
                HideValue=NameHideValue }

    { 1210190013;2;Field  ;
                SourceExpr=Address;
                Visible=FALSE }

    { 1210190019;2;Field  ;
                SourceExpr="Address 2";
                Visible=FALSE }

    { 1210190021;2;Field  ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 1210190011;2;Field  ;
                SourceExpr=City;
                Visible=FALSE }

    { 1210190015;2;Field  ;
                SourceExpr="Phone No.";
                Visible=FALSE }

    { 1210190017;2;Field  ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr="Project Type";
                Visible=FALSE }

    { 1100485006;2;Field  ;
                SourceExpr="Territory Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1210190005;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1210190023;2;Field  ;
                SourceExpr=Type;
                Visible=FALSE }

    { 1210190007;2;Field  ;
                SourceExpr="Project Manager";
                Visible=FALSE }

    { 1100525001;2;Field  ;
                CaptionML=[ENU=Name Supervisor;
                           NOR=Navn ekstern veileder;
                           SVE=Namn extern arbetsledare];
                SourceExpr=NameSupervisor;
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Search Description";
                Visible=FALSE }

    { 1101200000;2;Field  ;
                SourceExpr="Project Status" }

    { 1100485000;2;Field  ;
                SourceExpr="Small Project Status";
                Visible=FALSE }

    { 1100525008;2;Field  ;
                SourceExpr="Urgency Code";
                Visible=FALSE }

    { 1100485004;2;Field  ;
                SourceExpr="Action by";
                Visible=FALSE }

    { 1100525000;2;Field  ;
                SourceExpr="Single/Main/Sub Project" }

    { 1210190037;2;Field  ;
                SourceExpr="Main Project";
                Visible=FALSE }

    { 1100525065;2;Field  ;
                SourceExpr="Prognosis Level";
                Visible=FALSE }

    { 1100285001;2;Field  ;
                SourceExpr="Forecast Level";
                Visible=FALSE }

    { 1210190009;2;Field  ;
                CaptionML=[ENU=Try-Out No.;
                           NOR=Prospektnr;
                           SVE=Anbudsnr];
                SourceExpr=GetTryOut(1);
                Visible=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowTryOut(1);
                         END;
                          }

    { 1210190025;2;Field  ;
                CaptionML=[ENU=Try-Out Quote;
                           NOR=Tilbudsforesp›rsel;
                           SVE=Anbudsf”rfr†gan];
                SourceExpr=GetTryOut(2);
                Visible=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowTryOut(2);
                         END;
                          }

    { 1100485015;2;Field  ;
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 1100485023;2;Field  ;
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 1100485017;2;Field  ;
                SourceExpr="Requested Starting Time";
                Visible=FALSE }

    { 1100485002;2;Field  ;
                SourceExpr="Order No. Customer";
                Visible=FALSE }

    { 1100485010;2;Field  ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 1210190056;2;Field  ;
                SourceExpr="Offers Expired";
                Visible=FALSE }

    { 1210190043;2;Field  ;
                SourceExpr=Text;
                Visible=FALSE }

    { 1100285500;2;Field  ;
                SourceExpr="Settlement Method";
                Visible=FALSE }

    { 1100285100;2;Field  ;
                SourceExpr="Principal Name";
                Visible=false }

    { 1100285103;2;Field  ;
                SourceExpr="preCalc. Revenues" }

    { 1100285104;2;Field  ;
                SourceExpr="preCalc. Real Costs" }

    { 1100285105;2;Field  ;
                SourceExpr="preCalc. Balance" }

    { 1100285106;2;Field  ;
                SourceExpr="preCalc. Prognosis Balance" }

    { 1100285107;2;Field  ;
                SourceExpr="preCalc. Hours totals" }

    { 1100285108;2;Field  ;
                SourceExpr="preCalc. DateTime";
                Visible=FALSE }

    { 1100285102;2;Field  ;
                SourceExpr="Invoiced (ready)" }

    { 1100285109;2;Field  ;
                SourceExpr="preCalc. LastInvDate" }

    { 1100285110;2;Field  ;
                SourceExpr="preCalc. NewCostFound" }

    { 1100285111;2;Field  ;
                SourceExpr="preCalc. Working Hours" }

  }
  CODE
  {
    VAR
      ProjSetup@1100485000 : Record 315;
      ProjPrincipRec@11012000 : Record 11012005;
      TryOutRelationRec@1210190001 : Record 11012761;
      TryOutRelation@1210190008 : Code[20];
      TryOutQuoteRelation@1210190002 : Code[20];
      Text11012000@1210190004 : TextConst 'ENU=For this Project are no Sub Projects present;NOR=Det finnes ingen underprosjekt for dette prosjektet;SVE=Det finns inga underprojekt f”r det h„r projektet';
      gCopyServLoc@1210190000 : Boolean;
      DPA_IsHardFilter@1100000999 : Boolean;
      gOtherCompany@1100525000 : Boolean;
      DocumentButtonVisible@19063906 : Boolean INDATASET;
      ProjectButtonVisible@19055766 : Boolean INDATASET;
      CopyButtonEnable@19014618 : Boolean INDATASET;
      NameHideValue@19054415 : Boolean INDATASET;
      Text11012001@1100525001 : TextConst 'ENU=Select Records First;NOR=Velg poster f›rst;SVE=V„lj poster f”rst';
      "*** 4PSSE"@1100285001 : TextConst;
      Text50000@1100285000 : TextConst 'ENU=Do you want create a sub project to project %1?;NOR=Vil du opprette ett underprosjekt til prosjekt %1?;SVE=Vill du skapa ett underprojekt till projekt %1?';

    PROCEDURE InitSelectionCopyServLoc@1210190001(lvCompName@1210190000 : Text[50]);
    BEGIN
      //**4PS
      gCopyServLoc := TRUE;
      CHANGECOMPANY(lvCompName);
    END;

    PROCEDURE CopyServiceLocation@1210190000();
    VAR
      Job@1100525000 : Record 11072003;
      ImexRec@1210190010 : Record 11012056;
      ProcID@1210190007 : Code[20];
      Text000@1210190009 : TextConst 'ENU=First select records.;NOR=Marker poster f›rst;SVE=Markera f”rst poster';
    BEGIN
      //**4PS
      CurrPage.SETSELECTIONFILTER(Job);
      IF NOT Job.FINDFIRST THEN BEGIN
        ERROR(Text000);
        EXIT;
      END;

      ProcID := 'GENSERVLOC_0';

      REPEAT
        ProcID := INCSTR(ProcID);
        ImexRec.INIT;
        ImexRec."User ID" := USERID;
        ImexRec."Process ID" := ProcID;
        ImexRec.Type := ImexRec.Type::Export;
        ImexRec.Description := 'Job';
        ImexRec.Condition := Job."No.";
        ImexRec.INSERT;
      UNTIL Job.NEXT = 0;
    END;

    PROCEDURE OptionList@1210190006();
    VAR
      lvOptionRec@1210190000 : Record 11012502;
    BEGIN
      //**4PS
      lvOptionRec.FILTERGROUP(9);
      lvOptionRec.SETRANGE("Project No.", "No.");
      lvOptionRec.FILTERGROUP(0);
      lvOptionRec.SETRANGE("Plot No.", '');

      PAGE.RUNMODAL(PAGE::"Project Option List", lvOptionRec);
    END;

    PROCEDURE ShowQuotesForProject@1100525000();
    VAR
      Quote@1100485000 : Record 38;
      QuoteLine@1100485001 : Record 39;
    BEGIN
      Quote.RESET;
      Quote.SETRANGE("Document Type",Quote."Document Type"::Quote);
      IF Quote.FINDSET(FALSE, FALSE) THEN
        REPEAT
          QuoteLine.SETRANGE("Document Type", Quote."Document Type");
          QuoteLine.SETRANGE("Document No.",Quote."No.");
          QuoteLine.SETRANGE("Job No.", "No.");
          IF (QuoteLine.FINDFIRST) OR (Quote."Job No." = "No.") THEN
            Quote.MARK(TRUE);
        UNTIL Quote.NEXT = 0;

      Quote.MARKEDONLY(TRUE);
      PAGE.RUN(PAGE::"Purchase List", Quote);
    END;

    PROCEDURE ShowPurchaseOrdersForProject@1100525002();
    VAR
      PurchaseOrder@1100485000 : Record 38;
      PurchaseLine@1100485001 : Record 39;
      ProjectPurchaseOrderList@1100525000 : Page 11012071;
    BEGIN
      PurchaseOrder.RESET;
      PurchaseOrder.SETRANGE("Document Type",PurchaseOrder."Document Type"::Order);
      IF PurchaseOrder.FINDSET(FALSE, FALSE) THEN
        REPEAT
          PurchaseLine.SETRANGE("Document Type", PurchaseOrder."Document Type");
          PurchaseLine.SETRANGE("Document No.",PurchaseOrder."No.");
          PurchaseLine.SETRANGE("Job No.", "No.");
          IF (PurchaseLine.FINDFIRST) OR (PurchaseOrder."Job No." = "No.") THEN
            PurchaseOrder.MARK(TRUE);
        UNTIL PurchaseOrder.NEXT = 0;

      PurchaseOrder.MARKEDONLY(TRUE);
      ProjectPurchaseOrderList.SETTABLEVIEW(PurchaseOrder);
      ProjectPurchaseOrderList.SetProject("No.");
      ProjectPurchaseOrderList.RUNMODAL;
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      IF NOT "Small Project" THEN
        NameHideValue := TRUE;
    END;

    PROCEDURE GetRecordSet@1100528601(VAR Job@1100528600 : Record 11072003);
    BEGIN
      //**4PS
      CurrPage.SETSELECTIONFILTER(Job);
    END;

    BEGIN
    {
      4PS
      - two buttons (Prices and Planning) removed.
      - 23-02-10 DocumentButton added for intercompany projects
      4PS01 MMA 20100412
        Function added GetSelectionFilter

      IMSE-041  -Itero
      LP 130704 4PSSE Added new action for "Create Sub Project".

      4PS-001, moved OpenPrognosisCardList() to the table
      140325, ITERO.DL, ENH-025, added "Settlement Method", visible =no

      140612, ITERO.DL, removed all FlowFields due to performance and 1 CALCFIELDS(Revenues)
            (Re)Print Option List
            Budgetted Options in Order
            Contract Amount
            Invoiced Price
            Name Buyer Contact
            Name Estimator
            Name Project Engineer
            Name Project Manager
            Name Purchaser
            Name Site Manager
            Number of Options in Order
            Number of Options Open
            Principal Name
            Urgency Description
            Revenues
      ITERO.WG 4PS-042 140711 Added page acion OpenProjectControlSummarized and OpenProjectControlOverview
      150925 ITERO.AC IME357 Added page action ExportToSymbrioButton in order to start report 81669 - Export Projects to Symbrio
      160114 ITERO.SB RFC-090 Added field "Principal Name"
      160204 ITERO.DL Performance fix
      160311 ITERO.SB RFC-106 New field, Invoiced (ready)
      160311 ITERO.DL RFC115 ny knapp f”r export av dimensioner till Symbrio
                             omd”pning av rapport 81669 till 11127975
      160727 ITERO.DL RFC101
      170411 ITERO.SB RFC-211 Do not set filter on invoiced (ready) in subproject list
      170425 ITERO.SB RFC-101.2 Added field preCalc. Working Hours
    }
    END.
  }
}

