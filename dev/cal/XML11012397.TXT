OBJECT XMLport 11012397 Import TRAD-Budget (CSV)
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import TRAD-Budget;
               SVE=Import TRAD-Budget];
    Direction=Import;
    DefaultFieldsValidation=No;
    PreserveWhiteSpace=Yes;
    TextEncoding=WINDOWS;
    OnPreXMLport=BEGIN
                   LineCounter := 0;

                   BudgetRec.SETRANGE("Project No.", ProjectCde);
                   BudgetRec.SETRANGE("Extension Contract", ExtensionCde);
                   BudgetRec.SETRANGE(Adjustment, AdjustmentCde);
                   BudgetRec.SETRANGE(Option, OptionCde);
                   BudgetRec.SETRANGE("Settlement Quantity Code", SettlementQuantityCde);
                   IF BudgetRec.FINDLAST THEN
                     LineCounter := BudgetRec."Line No.";

                   IF (ProjectCde <> '') THEN  //C038256
                     ProjRec.GET(ProjectCde);
                 END;

    OnPostXMLport=VAR
                    lvSumSheetRec@1100525000 : Record 11012064;
                  BEGIN
                    WITH "Budget Line" DO BEGIN
                      IF OptionCde <> '' THEN BEGIN
                        BudgetRec.SETRANGE("Project No.", ProjectCde);
                        BudgetRec.SETRANGE(Adjustment, '');
                        BudgetRec.SETRANGE("Extension Contract", '');
                        BudgetRec.SETRANGE(Option, OptionCde);
                        BudgetRec.SETRANGE("Settlement Quantity Code", '');
                        BudgetRec.SETRANGE("Extension Contract Status", "Extension Contract Status"::Expired);
                        BudgetRec.DELETEALL(TRUE);
                      END;
                      IF SettlementQuantityCde <> '' THEN BEGIN
                        BudgetRec.SETRANGE("Project No.", ProjectCde);
                        BudgetRec.SETRANGE(Adjustment, '');
                        BudgetRec.SETRANGE("Extension Contract", '');
                        BudgetRec.SETRANGE(Option, '');
                        BudgetRec.SETRANGE("Settlement Quantity Code", SettlementQuantityCde);
                        BudgetRec.SETRANGE("Extension Contract Status", "Extension Contract Status"::Expired);
                        BudgetRec.DELETEALL(TRUE);
                      END;
                      lvSumSheetRec."Project No." := ProjectCde;
                      lvSumSheetRec."Contract No." := ExtensionCde;
                      lvSumSheetRec."Plot No." := PlotCde;
                      lvSumSheetRec."House Model" := HouseModelCde;
                      lvSumSheetRec."Main Group" := MainGroupCde;
                      lvSumSheetRec.Group := GroupCde;
                      lvSumSheetRec."Sub Group" := SubGroupCde;
                      lvSumSheetRec.Option := OptionCde;
                      lvSumSheetRec."Settlement Quantity Code" := SettlementQuantityCde;
                      IF OptionCde <> '' THEN BEGIN
                        lvSumSheetRec.ReCalcOptionSummaryLines();
                        lvSumSheetRec.UpdateOptBudgetLines();
                      END ELSE BEGIN
                        IF SettlementQuantityCde <> '' THEN BEGIN
                          lvSumSheetRec.ReCalcSettlQuanSummaryLines();
                          lvSumSheetRec.UpdateSettlQuanBudgLines();
                        END ELSE BEGIN
                          lvSumSheetRec.ReCalcSummaryLines(AdjustmentCde);
                          lvSumSheetRec.UpdateBudgetLines(TRUE, AdjustmentCde);
                        END;
                      END;
                      CheckUpdateOption();
                      CheckUpdateSettlQuantity();
                    END;
                  END;

    Format=Variable Text;
    FieldDelimiter=<None>;
    FieldSeparator=[;];
    UseRequestPage=No;
  }
  ELEMENTS
  {
    { [{8FE14CB0-6C9B-4165-A1E8-162DFA5D8C71}];  ;Root                ;Element ;Text     }

    { [{BCD6AC24-E392-4FC0-955E-0C9781777F08}];1 ;BudgetLine          ;Element ;Table   ;
                                                  SourceTable=Table11012001;
                                                  SourceTableView=SORTING(Field1,Field31,Field33,Field38,Field14);
                                                  Import::OnAfterInitRecord=BEGIN
                                                                              CLEAR("Budget Line");
                                                                              CLEAR(RecordType);
                                                                              CLEAR(QuantityTxt);
                                                                              CLEAR(HourNormTxt);
                                                                              CLEAR(MaterialTxt);
                                                                              CLEAR(PlantTxt);
                                                                              CLEAR(SubcontractingTxt);
                                                                              CLEAR(TotalTxt);
                                                                              CLEAR(AdmiCode);
                                                                              CLEAR(Admi1);
                                                                              CLEAR(Admi2);
                                                                              CLEAR(Admi3);
                                                                              CLEAR(Admi4);
                                                                              CLEAR(TenderCode);
                                                                              CLEAR(WastePercentageTxt);
                                                                            END;

                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 ElemLevel@1100525002 : Integer;
                                                                                 ChapterCde@1100525001 : Code[20];
                                                                                 ParGraphCde@1100525000 : Code[20];
                                                                               BEGIN
                                                                                 WITH "Budget Line" DO BEGIN

                                                                                 IF RecordType = Text000 THEN
                                                                                   currXMLport.SKIP;

                                                                                 LineCreated := FALSE;
                                                                                 LineCounter := LineCounter + 10000;
                                                                                 "Line No." := LineCounter;
                                                                                 "Project No." := ProjectCde;
                                                                                 FillMainProject;
                                                                                 "Extension Contract" := ExtensionCde;
                                                                                 Adjustment := AdjustmentCde;
                                                                                 Option := OptionCde;
                                                                                 "Settlement Quantity Code" := SettlementQuantityCde;
                                                                                 "Time Quantity" := 1;
                                                                                 CLEAR("Option Line Type");
                                                                                 "Department Code" := ProjRec."Global Dimension 1 Code";

                                                                                 RecRef.GETTABLE("Budget Line");
                                                                                 XMLportStatusDialogMgt.ShowImportStatus(RecRef);

                                                                                 GetVersionDate;
                                                                                 UpdateExtContractStatus;

                                                                                 IF Option <> '' THEN BEGIN
                                                                                   "Extension Contract Status" := "Extension Contract Status"::Expired;
                                                                                   OptionRec.SETRANGE("Project No.","Project No.");
                                                                                   OptionRec.SETRANGE("Plot No.","Plot No.");
                                                                                   OptionRec.SETRANGE("House Model",HouseModelCde);
                                                                                   OptionRec.SETRANGE("Main Group",MainGroupCde);
                                                                                   OptionRec.SETRANGE(Group,GroupCde);
                                                                                   OptionRec.SETRANGE("Sub Group",SubGroupCde);
                                                                                   OptionRec.SETRANGE(Option,Option);
                                                                                   IF OptionRec.FINDFIRST THEN
                                                                                     "Version Date" := OptionRec."Version Date";
                                                                                 END;

                                                                                 IF "Settlement Quantity Code" <> '' THEN BEGIN
                                                                                   "Extension Contract Status" := "Extension Contract Status"::Expired;
                                                                                   SettlementQuantityRec.SETRANGE("Project No.","Project No.");
                                                                                   SettlementQuantityRec.SETRANGE("House Model",HouseModelCde);
                                                                                   SettlementQuantityRec.SETRANGE(Code, "Settlement Quantity Code");
                                                                                   IF SettlementQuantityRec.FINDFIRST THEN
                                                                                     "Version Date" := SettlementQuantityRec."Version Date";
                                                                                 END;

                                                                                 IF keepwithnext = TRUE THEN BEGIN
                                                                                   IF NOT ((RecordType = '*') OR (RecordType = '+')) THEN Element := '';
                                                                                 END;

                                                                                 IF RecordType = Text000 THEN Element := '';
                                                                                 IF ElementOptout = TRUE THEN Element := '';

                                                                                 IF Element <> '' THEN BEGIN
                                                                                   pos1 := STRPOS(Element, '.');
                                                                                   IF (pos1 = 2) OR ((pos1 = 0) AND (STRLEN(Element) = 1)) THEN
                                                                                     Element := '0' + Element;
                                                                                   ElementFormat.FormatElemExtended(2,Element,ChapterCde,ParGraphCde,ElemLevel);
                                                                                   IF NOT ElemRec.GET("Project No.", Element) THEN BEGIN
                                                                                     IF (RecordType = '*') OR (RecordType = '+') THEN BEGIN
                                                                                       IF ProjectCde <> '' THEN BEGIN
                                                                                         IF ElemLevel IN [2, 3] THEN
                                                                                           CheckInsertChapterPargraph(ChapterCde);
                                                                                         IF ElemLevel = 3 THEN
                                                                                            CheckInsertChapterPargraph(ParGraphCde);
                                                                                         ElemRec.VALIDATE("Project No.", ProjectCde);
                                                                                         ElemRec.VALIDATE(Element, Element);
                                                                                         ElemRec.Description := COPYSTR(Description, 1, MAXSTRLEN(ElemRec.Description));
                                                                                         ElemRec.Quantity  := 1;
                                                                                         ElemRec.INSERT;
                                                                                       END;
                                                                                       keepwithnext := TRUE;
                                                                                     END;
                                                                                     IF keepwithnext = FALSE THEN ElemRec.INIT;
                                                                                   END;
                                                                                 END;
                                                                                 Element := ElemRec.Element;
                                                                                 Chapter := ElemRec.Chapter;
                                                                                 Paragraph := ElemRec.Paragraph;
                                                                                 FillElementPhaseCodeBasedOnElement;

                                                                                 Quantity := Alphanumeric(QuantityTxt);
                                                                                 Norm   := Alphanumeric(HourNormTxt);
                                                                                 APrice := Alphanumeric(MaterialTxt);
                                                                                 MPrice := Alphanumeric(PlantTxt);
                                                                                 OPrice := Alphanumeric(SubcontractingTxt);
                                                                                 TPrice := Alphanumeric(TotalTxt);
                                                                                 factor := Alphanumeric(WastePercentageTxt);
                                                                                 factor := (100+factor)/100;
                                                                                 APrice := APrice * factor;
                                                                                 IF Norm = 0 THEN
                                                                                   HPrice := 0
                                                                                 ELSE
                                                                                   HPrice := TPrice - (Quantity * (APrice + MPrice + OPrice));
                                                                                 SPrice := 0;
                                                                                 "Cost Object" := '';
                                                                                 APrice := ROUND(APrice);
                                                                                 HPrice := ROUND(HPrice);

                                                                                 IF (Norm = 0) AND (APrice = 0) AND (MPrice = 0) AND (OPrice = 0) THEN
                                                                                   RecordType := '-';

                                                                                 IF ProcessMgt(RecordType) THEN BEGIN
                                                                                   AdmiCostTypeLevel := DetermineAdmicodeCostType;
                                                                                   IF AdmiCostTypeLevel THEN BEGIN
                                                                                     "Cost Object" := DimValRec.Code;
                                                                                     "Cost Type" := DimValRec."Cost Type";
                                                                                     CASE "Cost Type" OF
                                                                                       "Cost Type"::Labor:
                                                                                         BEGIN
                                                                                         END;
                                                                                       "Cost Type"::Material:
                                                                                         BEGIN
                                                                                           APrice := APrice + HPrice + OPrice + MPrice;
                                                                                           HPrice := 0;
                                                                                           OPrice := 0;
                                                                                           MPrice := 0;
                                                                                         END;
                                                                                       "Cost Type"::Subcontracting:
                                                                                         BEGIN
                                                                                           OPrice := OPrice + HPrice + APrice + MPrice;
                                                                                           HPrice := 0;
                                                                                           APrice := 0;
                                                                                           MPrice := 0;
                                                                                         END;
                                                                                       "Cost Type"::Plant:
                                                                                         BEGIN
                                                                                           MPrice := MPrice + HPrice + APrice + OPrice;
                                                                                           HPrice := 0;
                                                                                           APrice := 0;
                                                                                           OPrice := 0;
                                                                                         END;
                                                                                       "Cost Type"::Sundry:
                                                                                         BEGIN
                                                                                           SPrice := SPrice + HPrice + APrice + OPrice + MPrice;
                                                                                           HPrice := 0;
                                                                                           APrice := 0;
                                                                                           OPrice := 0;
                                                                                           MPrice := 0;
                                                                                         END;
                                                                                     END;
                                                                                   END;

                                                                                   IF Norm <> 0 THEN BEGIN
                                                                                     "Cost Type" := "Cost Type"::Labor;
                                                                                     IF NOT AdmiCostTypeLevel OR ("Cost Object" = '') THEN
                                                                                       "Cost Object" := DetermineAdmicodeCostObject(1);
                                                                                     CkeckCostObjectBlocked();
                                                                                     IF Quantity <> 0 THEN
                                                                                       "Rate (LCY)" := ROUND(HPrice / (Quantity * Norm))
                                                                                     ELSE
                                                                                       "Rate (LCY)" := 0;
                                                                                     "Price (LCY)" := 0;
                                                                                     "Amount (LCY)" := 0;
                                                                                     GetDefaultPurchAction;
                                                                                     "Cost Component" := DefaultCostComponent("Cost Object", "Project No.");
                                                                                     FillDefaultFscType();
                                                                                     CalcTotals;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN
                                                                                       INSERT
                                                                                     ELSE
                                                                                       AssignOptionBudget;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN UpdateCostControlStatus(0);
                                                                                     LineCreated := TRUE;
                                                                                   END;

                                                                                   IF APrice <> 0 THEN BEGIN
                                                                                     "Cost Type" := "Cost Type"::Material;
                                                                                     IF NOT AdmiCostTypeLevel OR ("Cost Object" = '') THEN
                                                                                       "Cost Object" := DetermineAdmicodeCostObject(2);
                                                                                     CkeckCostObjectBlocked();
                                                                                     IF LineCreated THEN BEGIN
                                                                                        LineCounter := LineCounter + 10000;
                                                                                       "Line No." := LineCounter;
                                                                                     END;
                                                                                     "Price (LCY)" := APrice;
                                                                                     Norm := 0;
                                                                                     "Rate (LCY)" := 0;
                                                                                     "Rate Code" := '';
                                                                                     GetDefaultPurchAction;
                                                                                     "Cost Component" := DefaultCostComponent("Cost Object", "Project No.");
                                                                                     FillDefaultFscType();
                                                                                     CalcTotals;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN
                                                                                       INSERT
                                                                                     ELSE
                                                                                       AssignOptionBudget;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN UpdateCostControlStatus(0);
                                                                                     LineCreated := TRUE;
                                                                                   END;

                                                                                   IF MPrice <> 0 THEN BEGIN
                                                                                     "Cost Type" := "Cost Type"::Plant;
                                                                                     IF NOT AdmiCostTypeLevel OR ("Cost Object" = '') THEN
                                                                                       "Cost Object" := DetermineAdmicodeCostObject(3);
                                                                                     CkeckCostObjectBlocked();
                                                                                     IF LineCreated THEN BEGIN
                                                                                       LineCounter := LineCounter + 10000;
                                                                                       "Line No." := LineCounter;
                                                                                     END;
                                                                                     "Price (LCY)" := MPrice;
                                                                                     Norm := 0;
                                                                                     "Rate (LCY)" := 0;
                                                                                     "Rate Code" := '';
                                                                                     GetDefaultPurchAction;
                                                                                     "Cost Component" := DefaultCostComponent("Cost Object", "Project No.");
                                                                                     FillDefaultFscType();
                                                                                     CalcTotals;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN
                                                                                       INSERT
                                                                                     ELSE
                                                                                       AssignOptionBudget;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN UpdateCostControlStatus(0);
                                                                                     LineCreated := TRUE;
                                                                                   END;

                                                                                   IF OPrice <> 0 THEN BEGIN
                                                                                     "Cost Type" := "Cost Type"::Subcontracting;
                                                                                     IF NOT AdmiCostTypeLevel OR ("Cost Object" = '') THEN
                                                                                       "Cost Object" := DetermineAdmicodeCostObject(4);
                                                                                     CkeckCostObjectBlocked();
                                                                                     IF LineCreated THEN BEGIN
                                                                                       LineCounter := LineCounter + 10000;
                                                                                       "Line No." := LineCounter;
                                                                                     END;
                                                                                     "Price (LCY)" := OPrice;
                                                                                     Norm := 0;
                                                                                     "Rate (LCY)" := 0;
                                                                                     "Rate Code" := '';
                                                                                     GetDefaultPurchAction;
                                                                                     "Cost Component" := DefaultCostComponent("Cost Object", "Project No.");
                                                                                     FillDefaultFscType();
                                                                                     CalcTotals;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN
                                                                                       INSERT
                                                                                     ELSE
                                                                                       AssignOptionBudget;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN UpdateCostControlStatus(0);
                                                                                     LineCreated := TRUE;
                                                                                   END;

                                                                                   IF SPrice <> 0 THEN BEGIN
                                                                                     "Cost Type" := "Cost Type"::Sundry;
                                                                                     IF NOT AdmiCostTypeLevel OR ("Cost Object" = '') THEN
                                                                                       "Cost Object" := DetermineAdmicodeCostObject(5);
                                                                                     CkeckCostObjectBlocked();
                                                                                     IF LineCreated THEN BEGIN
                                                                                       LineCounter := LineCounter + 10000;
                                                                                       "Line No." := LineCounter;
                                                                                     END;
                                                                                     "Price (LCY)" := SPrice;
                                                                                     Norm := 0;
                                                                                     "Rate (LCY)" := 0;
                                                                                     "Rate Code" := '';
                                                                                     GetDefaultPurchAction;
                                                                                     "Cost Component" := DefaultCostComponent("Cost Object", "Project No.");
                                                                                     FillDefaultFscType();
                                                                                     CalcTotals;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN
                                                                                       INSERT
                                                                                     ELSE
                                                                                       AssignOptionBudget;
                                                                                     IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN UpdateCostControlStatus(0);
                                                                                     LineCreated := TRUE;
                                                                                   END;
                                                                                 END ELSE BEGIN
                                                                                   AdmiCostTypeLevel := DetermineAdmicodeCostType;
                                                                                   IF AdmiCostTypeLevel THEN BEGIN
                                                                                     "Cost Type" := DimValRec."Cost Type";
                                                                                     "Cost Object" := DimValRec.Code;
                                                                                   END ELSE BEGIN
                                                                                     "Cost Type" := "Cost Type"::Sundry;
                                                                                     "Cost Object" := DetermineAdmicodeCostObject(5);
                                                                                     DimMgt.GetDimValueRec(2, "Cost Object", DimValRec, FALSE,'');
                                                                                     IF DimValRec.Code <> '' THEN
                                                                                       "Cost Type" := DimValRec."Cost Type";
                                                                                   END;
                                                                                   CkeckCostObjectBlocked();
                                                                                   Norm := 0;
                                                                                   "Rate (LCY)" := 0;
                                                                                   "Rate Code" := '';
                                                                                   "Price (LCY)" := 0;
                                                                                   "Amount (LCY)" := 0;
                                                                                   GetDefaultPurchAction;
                                                                                   "Cost Component" := DefaultCostComponent("Cost Object", "Project No.");
                                                                                   CalcTotals;
                                                                                   IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN
                                                                                     INSERT
                                                                                   ELSE
                                                                                     AssignOptionBudget;
                                                                                   IF (OptionCde = '') AND (SettlementQuantityCde = '')  THEN UpdateCostControlStatus(0);
                                                                                   LineCreated := TRUE;
                                                                                 END;

                                                                                 IF "Unit of Measure" <> '' THEN
                                                                                   IF NOT UnitRec.GET("Unit of Measure") THEN
                                                                                     StoreMessage(Description, STRSUBSTNO(Text001, FIELDCAPTION("Unit of Measure"), "Unit of Measure"));
                                                                                 IF "Cost Object" <> '' THEN BEGIN
                                                                                   DimMgt.GetDimValueRec(2, "Cost Object", DimValRec, FALSE,'');
                                                                                   IF ((Norm <> 0) AND (DimValRec."Cost Type" <> DimValRec."Cost Type"::Labor)) OR
                                                                                      (("Price (LCY)" <> 0) AND (APrice = "Price (LCY)") AND (DimValRec."Cost Type" <> DimValRec."Cost Type"::Material)) OR
                                                                                      (("Price (LCY)" <> 0) AND (OPrice = "Price (LCY)") AND (DimValRec."Cost Type" <> DimValRec."Cost Type"::Subcontracting)) OR
                                                                                      (("Price (LCY)" <> 0) AND (MPrice = "Price (LCY)") AND (DimValRec."Cost Type" <> DimValRec."Cost Type"::Plant))
                                                                                   THEN
                                                                                     StoreMessage(Description, STRSUBSTNO(Text004, "Cost Object"));
                                                                                 END;

                                                                                 WastePercentageTxt := '';
                                                                                 AdmiCode := '';
                                                                                 Admi1 := '';
                                                                                 Admi2 := '';
                                                                                 Admi3 := '';
                                                                                 Admi4 := '';
                                                                                 TenderCode := '';

                                                                                 currXMLport.SKIP;

                                                                                 END;
                                                                               END;
                                                                                }

    { [{24731921-D7BB-4A9B-B938-88DDD128CFBD}];2 ;Element             ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Budget Line::Element;
                                                  MinOccurs=Zero }

    { [{B6F22B59-38CB-44D0-87F6-616D70D5AEB7}];2 ;RecordType          ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterAssignVariable=BEGIN
                                                                                  "Budget Line".Element :=
                                                                                    COPYSTR("Budget Line".Element,1,MAXSTRLEN("Budget Line"."Cost Object"));
                                                                                END;
                                                                                 }

    { [{69A7D51C-ED31-450A-9A9F-BC55F512E742}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Budget Line::Description;
                                                  MinOccurs=Zero }

    { [{97358F16-7EA6-4C3A-B0EF-CDB353FDDAFD}];2 ;QuantityTxt         ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{90B7BC1D-D1DE-4326-9F61-B8C8FC0E1575}];2 ;UnitOfMeasure       ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Budget Line::Unit of Measure;
                                                  MinOccurs=Zero }

    { [{FAC4748F-1963-4DCA-950C-CF4C2F2F5CEE}];2 ;HourNormTxt         ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{0F5D39A5-AB93-4070-BF68-8966088FE74A}];2 ;MaterialTxt         ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{BFDA4D44-ED50-4785-818C-D84C8850F013}];2 ;PlantTxt            ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{0180BD37-FF9E-45AE-9825-9A8DF56EFC44}];2 ;SubcontractingTxt   ;Element ;Text    ;
                                                  VariableName=SubcontractingTxt;
                                                  MinOccurs=Zero }

    { [{8CB90C5C-ACB3-4F3A-943C-C89B2D7177BF}];2 ;filler1             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{801D8CD3-8E67-4745-B138-7E8027AC8786}];2 ;filler2             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{4048789B-D36B-4582-86EE-BE48B057557B}];2 ;filler3             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{AC4E0DB8-93FA-4B0E-8D9B-2347066ECBB8}];2 ;TotalTxt            ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{82C3BD2E-816E-4C82-A3C1-DF7B46756DF7}];2 ;AdmiCode            ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{554E7863-8DBC-466E-8669-32D76C527F77}];2 ;filler4             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{B3727B35-085C-43F2-A55C-BA6B88467273}];2 ;filler5             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{F9D30552-077A-49F5-9889-7B73606B6901}];2 ;Admi1               ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{7A899528-3FF3-421B-9F41-D42EB065C0C3}];2 ;Admi2               ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{087AB0FA-3289-4C96-B6AF-E8A6598CCFEE}];2 ;Admi3               ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{D0078CF5-5817-4141-A560-6B60EB433C8E}];2 ;Admi4               ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{3906CD41-18FC-4F01-8643-625723FEF29C}];2 ;filler6             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{E3F94513-5315-4DA4-B584-C8A8A1C1825C}];2 ;TenderCode          ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{4F61F56F-6041-4055-83E0-FDE0EDD2D00A}];2 ;filler7             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{C49B8037-A228-44EB-B3BB-7417F7D17A7D}];2 ;Description2        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Budget Line::Description 2;
                                                  MinOccurs=Zero }

    { [{B4A4C0E0-6B7C-4E83-B3C2-E70AEDDCA27A}];2 ;filler8             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{6436C3D5-E405-48B4-B245-E2BEDD794B50}];2 ;WastePercentageTxt  ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{3A7AC83A-5D8A-40A7-801F-A1CC4AE42CF7}];2 ;filler9             ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{8AF8D229-78FD-4660-8C8B-E3AD8A37F951}];2 ;filler10            ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{6C126F40-80BE-4333-AFAB-0B6DBB46546B}];2 ;filler11            ;Element ;Text    ;
                                                  MinOccurs=Zero }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      ProjRec@1100525047 : Record 11072003;
      DimValRec@1100525046 : Record 349;
      ElemRec@1100525045 : Record 11012010;
      BudgetRec@1100525044 : Record 11012001;
      OptionBudgetRec@1100525043 : Record 11012503;
      OptionRec@1100525042 : Record 11012502;
      AdmiRec@1100525041 : Record 11012390;
      UnitRec@1100525040 : Record 204;
      RecRef@1100525017 : RecordRef;
      pos1@1100525039 : Integer;
      LineCounter@1100525038 : Integer;
      LineCreated@1100525037 : Boolean;
      keepwithnext@1100525036 : Boolean;
      factor@1100525025 : Decimal;
      APrice@1100525024 : Decimal;
      HPrice@1100525023 : Decimal;
      MPrice@1100525022 : Decimal;
      OPrice@1100525021 : Decimal;
      SPrice@1100525020 : Decimal;
      TPrice@1100525019 : Decimal;
      ProjectCde@1100525012 : Code[20];
      AdjustmentCde@1100525011 : Code[10];
      ExtensionCde@1100525010 : Code[10];
      HouseModelCde@1100525009 : Code[20];
      PlotCde@1100525008 : Code[20];
      MainGroupCde@1100525007 : Code[20];
      GroupCde@1100525006 : Code[20];
      SubGroupCde@1100525005 : Code[20];
      OptionCde@1100525004 : Code[20];
      DimMgt@1100525003 : Codeunit 408;
      ElementFormat@1100525002 : Codeunit 11012022;
      XMLportStatusDialogMgt@1100525018 : Codeunit 11130006;
      ElementOptout@1100525001 : Boolean;
      AdmiCostTypeLevel@1100525000 : Boolean;
      Text000@1100525016 : TextConst 'ENU=CSTUURK;SVE=CSTUURK';
      Text001@1100525015 : TextConst 'ENU=%1 %2 not present;SVE=%1 %2 finns inte';
      Text004@1100525014 : TextConst 'ENU=Cost Object %1 differs from imported Norm/Price;SVE=Kostnadsobjekt %1 skiljer sig frÜn importerad norm/pris';
      Text005@1100525013 : TextConst 'ENU=" ?ABCDEFGHIJKLMNOPQRSTUVWXYZ";SVE=" ABCDEFGHIJKLMNOPQRSTUVWXYZèéô"';
      Text013@1210190000 : TextConst 'ENU=Cost Object %1 is blocked;SVE=Kostnadsobjekt %1 Ñr blockerad';
      SettlementQuantityCde@1100528206 : Code[20];
      FromSettlementQuantity@1100528205 : Boolean;
      SettlementQuantityRec@1100528204 : Record 11072243;
      SettlementQuantityBudgetRec@1100528203 : Record 11072244;

    PROCEDURE DetermineSelection@1(lvProject@11012000 : Code[20];lvAdjustment@11012001 : Code[10];lvExtension@11012002 : Code[10];lvHouseModel@1210190004 : Code[20];lvMainGroup@1210190003 : Code[20];lvGroup@1210190002 : Code[20];lvSubGroup@1210190001 : Code[20];lvOption@11012003 : Code[20];lvElementOptout@1210190000 : Boolean;lvPlot@1100485000 : Code[20]);
    BEGIN
      ProjectCde := lvProject;
      AdjustmentCde := lvAdjustment;
      ExtensionCde := lvExtension;
      PlotCde := lvPlot;
      HouseModelCde := lvHouseModel;
      MainGroupCde := lvMainGroup;
      GroupCde := lvGroup;
      SubGroupCde := lvSubGroup;
      OptionCde := lvOption;
      ElementOptout := lvElementOptout;
    END;

    PROCEDURE ProcessMgt@6(Text@11012001 : Text[250]) Result@11012000 : Boolean;
    BEGIN
      EXIT(DELCHR(Text,'=',Text005)='');
    END;

    PROCEDURE Alphanumeric@2(Text@11012001 : Text[250]) Result@11012000 : Decimal;
    VAR
      dummy@11012002 : Decimal;
    BEGIN
      Text := CONVERTSTR(Text, '.', ',');
      IF DELCHR(Text, '=', '-,0123456789') <> '' THEN EXIT(0);
      IF DELCHR(Text, '=', ' ') = '' THEN EXIT(0);
      EVALUATE(dummy, Text);
      EXIT(dummy);
    END;

    PROCEDURE CheckInsertChapterPargraph@1210190012(ElementCde@1210190000 : Code[20]);
    VAR
      ProjElemRec@1100525000 : Record 11012010;
    BEGIN
      IF (ProjectCde = '') OR (ElementCde = '')  THEN
        EXIT;
      IF ProjElemRec.GET(ProjectCde, ElementCde) THEN
        EXIT;

      ProjElemRec.INIT;
      ProjElemRec.VALIDATE("Project No.", ProjectCde);
      ProjElemRec.VALIDATE(Element, ElementCde);
      ProjElemRec.INSERT(TRUE);
      IF ProjElemRec.Description = '' THEN
        ProjElemRec.Description := COPYSTR("Budget Line".Description, 1, MAXSTRLEN(ProjElemRec.Description));
      ProjElemRec.Quantity  := 1;
      ProjElemRec.MODIFY;
    END;

    PROCEDURE AssignOptionBudget@3();
    VAR
      LastLino@11012000 : Integer;
    BEGIN
      IF SettlementQuantityCde <> '' THEN BEGIN
        AssignSettlQuantityBudget;
        EXIT;
      END;

      BudgetRec.COPY("Budget Line");

      OptionBudgetRec.SETRANGE("Project No.",ProjectCde);
      IF PlotCde <> '' THEN
        OptionBudgetRec.SETFILTER("Plot No.",PlotCde)
      ELSE
        OptionBudgetRec.SETFILTER("Plot No.",'%1','');
      OptionBudgetRec.SETRANGE("House Model",HouseModelCde);
      OptionBudgetRec.SETRANGE("Main Group",MainGroupCde);
      OptionBudgetRec.SETRANGE(Group,GroupCde);
      OptionBudgetRec.SETRANGE("Sub Group",SubGroupCde);
      OptionBudgetRec.SETRANGE(Option,OptionCde);
      IF NOT OptionBudgetRec.FINDLAST THEN
        LastLino := 10000
      ELSE
        LastLino := OptionBudgetRec."Line No." + 10000;

      OptionBudgetRec.INIT;
      OptionBudgetRec."Project No." := BudgetRec."Project No.";
      OptionBudgetRec."Plot No." := PlotCde;
      OptionBudgetRec."House Model" := HouseModelCde;
      OptionBudgetRec."Main Group" := MainGroupCde;
      OptionBudgetRec.Group := GroupCde;
      OptionBudgetRec."Sub Group" := SubGroupCde;
      OptionBudgetRec.Option := BudgetRec.Option;

      OptionBudgetRec.Element := BudgetRec.Element;
      OptionBudgetRec."Cost Object" := BudgetRec."Cost Object";
      OptionBudgetRec."Cost Component" := BudgetRec."Cost Component";
      OptionBudgetRec.Description := BudgetRec.Description;
      OptionBudgetRec."Description 2" := BudgetRec."Description 2";
      OptionBudgetRec.Quantity := BudgetRec.Quantity;
      OptionBudgetRec."Unit of Measure" := BudgetRec."Unit of Measure";
      OptionBudgetRec.Norm := BudgetRec.Norm;
      OptionBudgetRec."Rate Code" := BudgetRec."Rate Code";
      OptionBudgetRec.Rate := BudgetRec."Rate (LCY)";
      OptionBudgetRec.Hours := BudgetRec.Hours;
      OptionBudgetRec.Amount := BudgetRec."Amount (LCY)";
      OptionBudgetRec."Line No." := LastLino;
      OptionBudgetRec."Total Amount" := BudgetRec."Total Amount";
      OptionBudgetRec."Total Hours" := BudgetRec."Total Hours";
      OptionBudgetRec."Cost Type" := BudgetRec."Cost Type";
      OptionBudgetRec.Price := BudgetRec."Price (LCY)";
      OptionBudgetRec."Time Quantity" := BudgetRec."Time Quantity";
      OptionBudgetRec."Unit of Time" := BudgetRec."Unit of Time";
      OptionBudgetRec.Chapter := BudgetRec.Chapter;
      OptionBudgetRec.Paragraph := BudgetRec.Paragraph;

      OptionBudgetRec.CheckInsertSummarySheet(FALSE);  //* Must be done before INSERT, because of test 'only when first'.
      OptionBudgetRec.INSERT;
    END;

    PROCEDURE DetermineAdmicodeCostObject@4(CostType@11012000 : Integer) : Code[10];
    BEGIN
      DimMgt.GetDimValueRec(2, TenderCode, DimValRec, FALSE,'');
      IF DimValRec.Code <> '' THEN
        EXIT(DimValRec.Code);

      IF CostType = 1 THEN BEGIN
        IF Admi1 <> '' THEN
          IF AdmiRec.GET(Admi1) THEN
            EXIT(AdmiRec."Cost Object Labor");
        IF AdmiRec.GET(AdmiCode) THEN
          EXIT(AdmiRec."Cost Object Labor");
        IF AdmiRec.GET('') THEN
          EXIT(AdmiRec."Cost Object Labor");
      END;

      IF CostType = 2 THEN BEGIN
        IF Admi2 <> '' THEN
          IF AdmiRec.GET(Admi2) THEN
            EXIT(AdmiRec."Cost Object Material");
        IF AdmiRec.GET(AdmiCode) THEN
          EXIT(AdmiRec."Cost Object Material");
        IF AdmiRec.GET('') THEN
          EXIT(AdmiRec."Cost Object Material");
      END;

      IF CostType = 3 THEN BEGIN
        IF Admi3 <> '' THEN
          IF AdmiRec.GET(Admi3) THEN
            EXIT(AdmiRec."Cost Object Plant");
        IF AdmiRec.GET(AdmiCode) THEN
          EXIT(AdmiRec."Cost Object Plant");
        IF AdmiRec.GET('') THEN
          EXIT(AdmiRec."Cost Object Plant");
      END;

      IF CostType = 4 THEN BEGIN
        IF Admi4 <> '' THEN
          IF AdmiRec.GET(Admi4) THEN
            EXIT(AdmiRec."Cost Object Subcontracting");
        IF AdmiRec.GET(AdmiCode) THEN
          EXIT(AdmiRec."Cost Object Subcontracting");
        IF AdmiRec.GET('') THEN
          EXIT(AdmiRec."Cost Object Subcontracting");
      END;

      IF CostType = 5 THEN BEGIN
        IF AdmiRec.GET(AdmiCode) THEN
          EXIT(AdmiRec."Cost Object Sundry");
        IF AdmiRec.GET('') THEN
          EXIT(AdmiRec."Cost Object Sundry");
      END;

      EXIT('');
    END;

    PROCEDURE DetermineAdmicodeCostType@1210190000() : Boolean;
    BEGIN
      DimMgt.GetDimValueRec(2, TenderCode, DimValRec, FALSE,'');
      IF DimValRec.Code <> '' THEN EXIT(TRUE);

      IF Admi1 <> '' THEN
       IF AdmiRec.GET(Admi1) THEN
         IF AdmiRec."Admi Related Cost Type" = TRUE THEN BEGIN
           IF AdmiRec."Cost Object Labor" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Labor", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Material" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Material", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Subcontracting" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Subcontracting", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Plant" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Plant", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Sundry" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Sundry", DimValRec, FALSE,'');
           IF DimValRec.Code <> '' THEN EXIT(TRUE);
         END;

      IF Admi2 <> '' THEN
       IF AdmiRec.GET(Admi2) THEN
         IF AdmiRec."Admi Related Cost Type" = TRUE THEN BEGIN
           IF AdmiRec."Cost Object Labor" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Labor", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Material" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Material", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Subcontracting" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Subcontracting", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Plant" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Plant", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Sundry" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Sundry", DimValRec, FALSE,'');
           IF DimValRec.Code <> '' THEN EXIT(TRUE);
         END;

      IF Admi3 <> '' THEN
       IF AdmiRec.GET(Admi3) THEN
         IF AdmiRec."Admi Related Cost Type" = TRUE THEN BEGIN
           IF AdmiRec."Cost Object Labor" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Labor", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Material" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Material", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Subcontracting" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Subcontracting", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Plant" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Plant", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Sundry" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Sundry", DimValRec, FALSE,'');
           IF DimValRec.Code <> '' THEN EXIT(TRUE);
         END;

      IF Admi4 <> '' THEN
       IF AdmiRec.GET(Admi4) THEN
         IF AdmiRec."Admi Related Cost Type" = TRUE THEN BEGIN
           IF AdmiRec."Cost Object Labor" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Labor", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Material" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Material", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Subcontracting" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Subcontracting", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Plant" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Plant", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Sundry" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Sundry", DimValRec, FALSE,'');
           IF DimValRec.Code <> '' THEN EXIT(TRUE);
         END;

      IF AdmiCode <> '' THEN
       IF AdmiRec.GET(AdmiCode) THEN
         IF AdmiRec."Admi Related Cost Type" = TRUE THEN BEGIN
           IF AdmiRec."Cost Object Labor" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Labor", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Material" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Material", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Subcontracting" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Subcontracting", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Plant" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Plant", DimValRec, FALSE,'');
           IF AdmiRec."Cost Object Sundry" <> '' THEN
             DimMgt.GetDimValueRec(2, AdmiRec."Cost Object Sundry", DimValRec, FALSE,'');
           IF DimValRec.Code <> '' THEN EXIT(TRUE);
         END;

      EXIT(FALSE);
    END;

    PROCEDURE StoreMessage@5(lvDesc@11012000 : Text[100];lvMess@11012001 : Text[80]);
    VAR
      ErrorRec@1210190000 : Record 11012051;
      lvError@11012002 : Integer;
    BEGIN
      WITH ErrorRec DO BEGIN
        SETRANGE("User ID", USERID);
        SETRANGE("Source Type", "Source Type"::"Import Budget");
        IF FINDLAST THEN
          lvError := "Line No." + 1
        ELSE
          lvError := 1;

        INIT;
        "User ID" := USERID;
        "Source Type" := "Source Type"::"Import Budget";
        "Line No." := lvError;
        "Project No." := ProjRec."No.";
        "Error message" := lvMess;
        Description := lvDesc;
        INSERT;
      END;
    END;

    PROCEDURE CheckUpdateOption@1100485000();
    VAR
      lvDummyOptionSurchRec@1100485001 : Record 11012512;
      lvBuyerMgtCU@1100485000 : Codeunit 11012500;
    BEGIN
      IF OptionCde = '' THEN
        EXIT;

      lvBuyerMgtCU.BmCalcSurchargesUpdateOption(
        ProjectCde, PlotCde, HouseModelCde, MainGroupCde, GroupCde, SubGroupCde, OptionCde, FALSE, lvDummyOptionSurchRec);
    END;

    PROCEDURE DefaultCostComponent@1100485001(lvCostObject@1100485000 : Code[20];lvProject@1100485001 : Code[20]) lvCostComponent : Code[20];
    VAR
      lvDimValRec@1100485002 : Record 349;
    BEGIN
      lvCostComponent := '';
      IF lvCostObject <> '' THEN BEGIN
        DimMgt.GetDimValueRec(2, lvCostObject, lvDimValRec, FALSE, lvProject);
        IF NOT lvDimValRec.Blocked THEN
          lvCostComponent := lvDimValRec."Cost Component";
      END;
    END;

    PROCEDURE CkeckCostObjectBlocked@1210190001();
    BEGIN
      //C-026977
      IF "Budget Line"."Cost Object" <> '' THEN BEGIN
        DimMgt.GetDimValueRec(2, "Budget Line"."Cost Object", DimValRec, FALSE,'');
        IF DimValRec.Blocked THEN
          StoreMessage("Budget Line".Description, STRSUBSTNO(Text013,"Budget Line"."Cost Object"));
      END;
    END;

    PROCEDURE SetDefaultsSettlQuantity@1100528203(ISettlementQuantityCde@11012000 : Code[20]);
    BEGIN
      IF SettlementQuantityRec.WRITEPERMISSION AND SettlementQuantityBudgetRec.WRITEPERMISSION THEN BEGIN
        FromSettlementQuantity := TRUE;
        SettlementQuantityCde := ISettlementQuantityCde;
      END ELSE BEGIN
        FromSettlementQuantity := FALSE;
        SettlementQuantityCde := '';
      END;
    END;

    PROCEDURE CheckUpdateSettlQuantity@1100528200();
    VAR
      lvDummySettlementQuantitySurcharge@1100485001 : Record 11072247;
      lvSettlementQuantityManagement@1100485000 : Codeunit 11071690;
    BEGIN
      IF SettlementQuantityCde = '' THEN
        EXIT;

      lvSettlementQuantityManagement.MMRCalcSurchargesUpdateSettlQuan(
        ProjectCde, HouseModelCde, SettlementQuantityCde, FALSE,lvDummySettlementQuantitySurcharge)
    END;

    PROCEDURE AssignSettlQuantityBudget@1100528205();
    VAR
      LastLino@11012000 : Integer;
    BEGIN
      BudgetRec.COPY("Budget Line");

      SettlementQuantityBudgetRec.SETRANGE("Project No.",ProjectCde);
      SettlementQuantityBudgetRec.SETRANGE("House Model",HouseModelCde);
      SettlementQuantityBudgetRec.SETRANGE("Settlement Quantity Code", SettlementQuantityCde);
      IF NOT SettlementQuantityBudgetRec.FINDLAST THEN
        LastLino := 10000
      ELSE
        LastLino := SettlementQuantityBudgetRec."Line No." + 10000;

      SettlementQuantityBudgetRec.INIT;
      SettlementQuantityBudgetRec."Project No." := BudgetRec."Project No.";
      SettlementQuantityBudgetRec."Settlement Quantity Code":= BudgetRec."Settlement Quantity Code";
      SettlementQuantityBudgetRec."House Model" := HouseModelCde;
      SettlementQuantityBudgetRec."Line No." := LastLino;
      SettlementQuantityBudgetRec.Element := BudgetRec.Element;
      SettlementQuantityBudgetRec."Cost Type" := BudgetRec."Cost Type";
      SettlementQuantityBudgetRec."Cost Object" := BudgetRec."Cost Object";
      SettlementQuantityBudgetRec.Description := BudgetRec.Description;
      SettlementQuantityBudgetRec."Cost Component" := BudgetRec."Cost Component";
      SettlementQuantityBudgetRec.Quantity := BudgetRec.Quantity;
      SettlementQuantityBudgetRec."Unit of Measure" := BudgetRec."Unit of Measure";
      SettlementQuantityBudgetRec.Norm := BudgetRec.Norm;
      SettlementQuantityBudgetRec."Rate Code" := BudgetRec."Rate Code";
      SettlementQuantityBudgetRec.Rate := BudgetRec."Rate (LCY)";
      SettlementQuantityBudgetRec.Hours := BudgetRec.Hours;
      SettlementQuantityBudgetRec.Amount := BudgetRec."Amount (LCY)";
      SettlementQuantityBudgetRec."Total Amount" := BudgetRec."Total Amount";
      SettlementQuantityBudgetRec."Total Hours" := BudgetRec."Total Hours";
      SettlementQuantityBudgetRec.Price := BudgetRec."Price (LCY)";
      SettlementQuantityBudgetRec."Time Quantity" := BudgetRec."Time Quantity";
      SettlementQuantityBudgetRec."Unit of Time" := BudgetRec."Unit of Time";
      SettlementQuantityBudgetRec.Chapter := BudgetRec.Chapter;
      SettlementQuantityBudgetRec.Paragraph := BudgetRec.Paragraph;

      SettlementQuantityBudgetRec.CheckInsertSummarySheet(FALSE);  //* Must be done before INSERT, because of test 'only when first'.
      SettlementQuantityBudgetRec.INSERT;
    END;

    BEGIN
    END.
  }
}

