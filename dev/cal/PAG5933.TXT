OBJECT Page 5933 Service Invoice
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,NAVDK.NO;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Service Invoice;
               NOR=Servicefaktura;
               SVE=Servicefaktura];
    SourceTable=Table5900;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Posting,Invoice;
                                NOR=Ny,Prosess,Rapport,Bokf›ring,Faktura;
                                SVE=Ny,Process,Rapport,Bokf”ring,Faktura];
    OnOpenPage=BEGIN
                 SetSecurityFilterOnRespCenter;
                 IF ("No." <> '') AND ("Customer No." = '') THEN
                   DocumentIsPosted := (NOT GET("Document Type","No."));

                 ActivateFields;
               END;

    OnFindRecord=BEGIN
                   IF FIND(Which) THEN
                     EXIT(TRUE);

                   SETRANGE("No.");
                   EXIT(FIND(Which));
                 END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetServiceFilter;
                  IF "No." = '' THEN
                    SetCustomerFromFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     CLEAR(ServLogMgt);
                     ServLogMgt.ServHeaderManualDelete(Rec);
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT DocumentIsPosted THEN
                         EXIT(ConfirmCloseUnposted);
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 NOR=Fa&ktura;
                                 SVE=Fa&ktura];
                      Image=Invoice }
      { 59      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokf›rte poster, for posten.;
                                 SVE=Visa statistisk information f”r posten, till exempel v„rdet p† bokf”rda transaktioner.];
                      ApplicationArea=#Service;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 PAGE.RUNMODAL(PAGE::"Service Statistics",Rec);
                               END;
                                }
      { 60      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort;
                                 SVE=Kort];
                      ToolTipML=[ENU=View or change detailed information about the record on the document or journal line.;
                                 NOR=Vis eller endre detaljert informasjon om posten i dokumentet eller p† kladdelinjen.;
                                 SVE=Visa eller „ndra detaljerad information om posten p† dokument- eller journalraden.];
                      ApplicationArea=#Service;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Customer No.);
                      Promoted=Yes;
                      Image=EditLines;
                      PromotedCategory=Category5 }
      { 61      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller l„gg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 5911;
                      RunPageLink=Table Name=CONST(Service Header),
                                  Table Subtype=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Type=CONST(General);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category5 }
      { 116     ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=&Dimensions;
                                 NOR=&Dimensjoner;
                                 SVE=&Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to journal lines to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til kladdelinjer for † distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera m†tt, till exempel omr†de, projekt eller avdelning, som du kan tilldela till journalrader f”r att f”rdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Service Document Lo&g;
                                 NOR=Servi&ceordrelogg;
                                 SVE=Servicedokumentlo&gg];
                      ToolTipML=[ENU=View a list of the service document changes that have been logged. The program creates entries in the window when, for example, the response time or service order status changed, a resource was allocated, a service order was shipped or invoiced, and so on. Each line in this window identifies the event that occurred to the service document. The line contains the information about the field that was changed, its old and new value, the date and time when the change took place, and the ID of the user who actually made the changes.;
                                 NOR=Vis en oversikt over servicedokumentendringer som har blitt loggf›rt. Det opprettes poster i vinduet for eksempel n†r responstiden eller serviceordrestatusen endres, n†r en ressurs fordeles, n†r en serviceordre leveres eller faktureres og s† videre. Hver linje i dette vinduet identifiserer hendelsen som ble utf›rt for servicedokumentet. Linjen inneholder opplysninger om feltet som ble endret, dets gamle og nye verdi, dato og klokkeslett for endringen og IDen til brukeren som foretok endringen.;
                                 SVE=Visa en lista ”ver de servicedokument„ndringar som har registrerats. Poster skapas i f”nstret till exempel n„r svarstider eller serviceorderstatus „ndras, en resurs f”rdelas, en serviceorder levereras eller faktureras och s† vidare. Varje rad i det h„r f”nstret identifierar h„ndelsen som „gt rum och som „r kopplad till servicedokumentet. Raden inneh†ller information om det f„lt som har „ndrats, dess gamla och nya v„rde, datum och tid n„r f„ltet „ndrades och ID f”r den anv„ndare som har gjort „ndringarna.];
                      ApplicationArea=#Service;
                      Promoted=Yes;
                      Image=Log;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 TempServDocLog@1001 : TEMPORARY Record 5912;
                               BEGIN
                                 TempServDocLog.RESET;
                                 TempServDocLog.DELETEALL;
                                 TempServDocLog.CopyServLog(TempServDocLog."Document Type"::Invoice,"No.");

                                 TempServDocLog.RESET;
                                 TempServDocLog.SETCURRENTKEY("Change Date","Change Time");
                                 TempServDocLog.ASCENDING(FALSE);

                                 PAGE.RUN(0,TempServDocLog);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 62      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner;
                                 SVE=Fu&nktioner];
                      Image=Action }
      { 63      ;2   ;Action    ;
                      Name=Calculate Invoice Discount;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 NOR=&Beregn fakturarabatt;
                                 SVE=Ber„kna &fakturarabatt];
                      ToolTipML=[ENU=Calculate the invoice discount that applies to the service order.;
                                 NOR=Beregn fakturarabatten som gjelder for serviceordren.;
                                 SVE=Ber„kna fakturarabatten som g„ller serviceordern.];
                      ApplicationArea=#Service;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 134     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get St&d. Service Codes;
                                 NOR=&Hent standard servicekoder;
                                 SVE=H„mta st&d.servicekoder];
                      ToolTipML=[ENU="Insert service order lines that you have set up for recurring services. ";
                                 NOR="Sett inn serviceordrelinjer som du har definert for gjentakende tjenester. ";
                                 SVE="Infoga serviceorderrader som du har skapat f”r †terkommande service. "];
                      ApplicationArea=#Service;
                      Promoted=Yes;
                      Image=ServiceCode;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 StdServCode@1001 : Record 5996;
                               BEGIN
                                 StdServCode.InsertServiceLines(Rec);
                               END;
                                }
      { 69      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring;
                                 SVE=B&okf”ring];
                      Image=Post }
      { 70      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport;
                                 SVE=Testrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.;
                                 SVE=Visa en testrapport s† att du kan hitta och r„tta till eventuella fel innan du bokf”r journalen eller dokumentet.];
                      ApplicationArea=#Service;
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintServiceHeader(Rec);
                               END;
                                }
      { 71      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r;
                                 SVE=&Bokf”r];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullf›r dokumentet eller kladden ved † bokf›re bel›pene og antallene til de relaterte kontiene i firmatabl†ene.;
                                 SVE=Slutf”r dokumentet eller journalen genom att bokf”ra beloppen och kvantiteterna till de relaterade kontona i f”retagets redovisning.];
                      ApplicationArea=#Service;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ServiceHeader@1001 : Record 5900;
                                 ServPostYesNo@1000 : Codeunit 5981;
                                 InstructionMgt@1003 : Codeunit 1330;
                                 PreAssignedNo@1002 : Code[20];
                               BEGIN
                                 PreAssignedNo := "No.";
                                 ServPostYesNo.PostDocument(Rec);

                                 DocumentIsPosted := NOT ServiceHeader.GET("Document Type","No.");

                                 IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
                                   ShowPostedConfirmationMessage(PreAssignedNo);
                               END;
                                }
      { 3       ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forh†ndsvis bokf›ring;
                                 SVE=F”rhandsgranska bokf”ring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet n†r du bokf›rer dokumentet eller kladden.;
                                 SVE=Granska de olika typer av transaktioner som skapas n„r du bokf”r dokumentet eller journalen.];
                      ApplicationArea=#Service;
                      Promoted=Yes;
                      Image=ViewPostedOrder;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ServPostYesNo@1000 : Codeunit 5981;
                               BEGIN
                                 ServPostYesNo.PreviewDocument(Rec);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=PostAndSend;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Send;
                                 NOR=Bokf›r og &send;
                                 SVE=Bokf”r och &skicka];
                      ToolTipML=[ENU=Finalize and prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.;
                                 NOR=Fullf›r og klargj›r for † sende dokumentet i henhold til kundens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til †pnes slik at du kan bekrefte eller velge en sendingsprofil.;
                                 SVE=Slutf”r och f”rbered att skicka dokumentet enligt kundens utskicksprofil, t.ex. som bilaga till ett e-postmeddelande. F”nstret Skicka dokument till ”ppnas f”rst s† att det g†r att bekr„fta eller v„lja en utskicksprofil.];
                      ApplicationArea=#Service;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostSendTo;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ServiceHeader@1000 : Record 5900;
                               BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Service-Post and Send",Rec);
                                 DocumentIsPosted := NOT ServiceHeader.GET("Document Type","No.");
                               END;
                                }
      { 72      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokf›r og &skriv ut;
                                 SVE=Bokf”r och skriv &ut];
                      ToolTipML=[ENU=Finalize and prepare to print the document or journal. The values and quantities are posted to the related accounts. A report request window where you can specify what to include on the print-out.;
                                 NOR=Fullf›r og klargj›r for † skrive ut dokumentet eller kladden. Verdiene og antallene blir bokf›rt til de relaterte kontiene. Det vises en rapportforesp›rselsside der du kan angi hva som skal inkluderes p† utskriften.;
                                 SVE=Slutf”r och f”rbered utskrift av dokumentet eller journalen. V„rdena och kvantiteterna bokf”rs p† de relaterade kontona. Ett f”nster med en rapportbeg„ran d„r du kan ange vad som ska tas med p† utskriften.];
                      ApplicationArea=#Service;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ServiceHeader@1001 : Record 5900;
                                 ServPostPrint@1000 : Codeunit 5982;
                               BEGIN
                                 ServPostPrint.PostDocument(Rec);
                                 DocumentIsPosted := NOT ServiceHeader.GET("Document Type","No.");
                               END;
                                }
      { 73      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 NOR=Masse&bokf›r;
                                 SVE=Bokf”r b&atch-jobb];
                      ToolTipML=[ENU=Post several documents at once. A report request window opens where you can specify which documents to post.;
                                 NOR=Bokf›r flere dokumenter samtidig. Det vises et rapportforesp›rselsvindu der du kan angi hvilke dokumenter som skal bokf›res.;
                                 SVE=Bokf”r flera dokument p† en g†ng. Ett rapportf”nster ”ppnas d„r du kan ange vilka dokument som ska bokf”ras.];
                      ApplicationArea=#Service;
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Service Invoices",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=Allm„nt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret p† den aktuelle oppf›ringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret f”r den ber”rda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#Service;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer who owns the items in the service document.;
                           NOR=Angir nummeret p† kunden som eier varene i servicedokumentet.;
                           SVE=Anger numret p† kunden som „ger artiklarna i servicedokumentet.];
                ApplicationArea=#Service;
                SourceExpr="Customer No.";
                OnValidate=BEGIN
                             CustomerNoOnAfterValidate;
                           END;
                            }

    { 128 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the contact to whom you will deliver the service.;
                           NOR=Angir nummeret p† kontakten du skal levere tjenesten til.;
                           SVE=Anger numret p† kontakten som du levererar servicen till.];
                ApplicationArea=#Service;
                SourceExpr="Contact No.";
                OnValidate=BEGIN
                             IF GETFILTER("Contact No.") = xRec."Contact No." THEN
                               IF "Contact No." <> xRec."Contact No." THEN
                                 SETRANGE("Contact No.");
                           END;
                            }

    { 7   ;2   ;Group     ;
                CaptionML=[ENU=Sell-to;
                           NOR=Salg til;
                           SVE=Kund];
                GroupType=Group }

    { 6   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the customer to whom the items on the document will be shipped.;
                           NOR=Angir navnet p† kunden som varene i dokumentet skal leveres til.;
                           SVE=Anger namnet p† kunden som artiklarna p† dokumentet ska levereras till.];
                ApplicationArea=#Service;
                SourceExpr=Name }

    { 75  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the address of the customer to whom the service will be shipped.;
                           NOR=Angir adressen til kunden som tjenesten skal leveres til.;
                           SVE=Anger adressen till kunden som servicen ska levereras till.];
                ApplicationArea=#Service;
                SourceExpr=Address;
                QuickEntry=FALSE }

    { 77  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Service;
                SourceExpr="Address 2";
                QuickEntry=FALSE }

    { 13  ;3   ;Group     ;
                Visible=IsSellToCountyVisible;
                GroupType=Group }

    { 9   ;4   ;Field     ;
                ApplicationArea=#Service;
                SourceExpr=County;
                QuickEntry=FALSE }

    { 80  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Service;
                SourceExpr="Post Code" }

    { 79  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the city of the address.;
                           NOR=Angir poststedet for adressen.;
                           SVE=Anger orten i adressen.];
                ApplicationArea=#Service;
                SourceExpr=City;
                QuickEntry=FALSE }

    { 11  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region of the address.;
                           NOR=Angir landet/omr†det i adressen.;
                           SVE=Anger adressens land/region.];
                ApplicationArea=#Service;
                SourceExpr="Country/Region Code";
                OnValidate=BEGIN
                             IsSellToCountyVisible := FormatAddress.UseCounty("Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 8   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the contact who will receive the service.;
                           NOR=Angir navnet p† kontakten som skal motta tjenesten.;
                           SVE=Anger namnen p† kontakten som ska ta emot servicen.];
                ApplicationArea=#Service;
                SourceExpr="Contact Name" }

    { 1101100004;2;Field  ;
                ToolTipML=ENU=Specifies the role of the contact person at the customer.;
                SourceExpr="Contact Role" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the service document should be posted.;
                           NOR=Angir datoen n†r servicedokumentet skal sendes.;
                           SVE=Anger datumet n„r servicedokumentet ska bokf”ras.];
                ApplicationArea=#Service;
                SourceExpr="Posting Date" }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the related document was created.;
                           NOR=Angir datoen da de relaterte dokumentet ble opprettet.;
                           SVE=Anger datumet n„r det relaterade dokumentet skapades.];
                ApplicationArea=#Service;
                SourceExpr="Document Date" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the salesperson assigned to this service document.;
                           NOR=Angir koden til selgeren som er tilordnet dette servicedokumentet.;
                           SVE=Anger koden f”r s„ljaren som har blivit tilldelad servicedokumentet.];
                ApplicationArea=#Service;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 118 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the responsibility center, such as a distribution hub, that is associated with the involved user, company, customer, or vendor.;
                           NOR=Angir koden til ansvarssenteret, for eksempel en distribusjonshub, som er knyttet til den involverte brukeren, selskapet, kunden eller leverand›ren.;
                           SVE=Anger koden f”r ansvarsenheten, till exempel ett distributionsnav, som associeras med anv„ndaren, f”retaget, kunden eller leverant”ren i fr†ga.];
                ApplicationArea=#Suite;
                SourceExpr="Responsibility Center";
                OnValidate=BEGIN
                             ResponsibilityCenterOnAfterVal;
                           END;
                            }

    { 147 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.;
                           SVE=Anger id f”r anv„ndaren som ansvarar f”r dokumentet.];
                ApplicationArea=#Service;
                SourceExpr="Assigned User ID" }

    { 1101100006;2;Field  ;
                SourceExpr="Your Reference" }

    { 1080012;2;Field     ;
                ToolTipML=NOR=Angir det eksterne dokumentnummeret for denne posten.;
                SourceExpr="External Document No." }

    { 56  ;1   ;Part      ;
                Name=ServLines;
                ApplicationArea=#Service;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page5934 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           NOR=Fakturering;
                           SVE=Fakturering] }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer that you send or sent the invoice or credit memo to.;
                           NOR=Angir nummeret for kunden du sender eller har sendt fakturaen eller kreditnotaen til.;
                           SVE=Anger numret p† kunden som du skickade eller skickar fakturan eller kreditnotan till.];
                ApplicationArea=#Service;
                SourceExpr="Bill-to Customer No.";
                OnValidate=BEGIN
                             BilltoCustomerNoOnAfterValidat;
                           END;
                            }

    { 132 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the contact person at the customer's billing address.;
                           NOR=Angir nummeret for kontaktpersonen i kundens fakturaadresse.;
                           SVE=Anger numret p† kontaktpersonen p† kundens faktureringsadress.];
                ApplicationArea=#Service;
                SourceExpr="Bill-to Contact No." }

    { 15  ;2   ;Group     ;
                CaptionML=[ENU=Bill-to;
                           NOR=Faktura til;
                           SVE=Faktureras];
                GroupType=Group }

    { 16  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the customer that you send or sent the invoice or credit memo to.;
                           NOR=Angir navnet p† kunden du sender eller har sendt fakturaen eller kreditnotaen til.;
                           SVE=Anger namnet p† kunden som du skickade eller skickar fakturan eller kreditnotan till.];
                ApplicationArea=#Service;
                SourceExpr="Bill-to Name" }

    { 18  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the customer to whom you will send the invoice.;
                           NOR=Angir adressen til kunden du skal sende fakturaen til.;
                           SVE=Anger adressen till kunden som du ska skicka fakturan till.];
                ApplicationArea=#Service;
                SourceExpr="Bill-to Address";
                QuickEntry=FALSE }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies an additional line of the address.;
                           NOR=Angir en ekstra linje i adressen.;
                           SVE=Anger ytterligare en adressrad.];
                ApplicationArea=#Service;
                SourceExpr="Bill-to Address 2";
                QuickEntry=FALSE }

    { 21  ;3   ;Group     ;
                Visible=IsBillToCountyVisible;
                GroupType=Group }

    { 19  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=L„n];
                ApplicationArea=#Service;
                SourceExpr="Bill-to County";
                QuickEntry=FALSE }

    { 85  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnummer;
                           SVE=Postnummer];
                ToolTipML=[ENU=Specifies the postal code of the customer's billing address.;
                           NOR=Angir postnummeret for kundens fakturaadresse.;
                           SVE=Anger postnumret i kundens faktureringsadress.];
                ApplicationArea=#Service;
                SourceExpr="Bill-to Post Code";
                QuickEntry=FALSE }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the address.;
                           NOR=Angir poststedet for adressen.;
                           SVE=Anger orten i adressen.];
                ApplicationArea=#Service;
                SourceExpr="Bill-to City";
                QuickEntry=FALSE }

    { 17  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omr†de;
                           SVE=Land/region];
                ApplicationArea=#Service;
                SourceExpr="Bill-to Country/Region Code";
                OnValidate=BEGIN
                             IsBillToCountyVisible := FormatAddress.UseCounty("Bill-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the contact person at the customer's billing address.;
                           NOR=Angir navnet p† kontaktpersonen i kundens fakturaadresse.;
                           SVE=Anger namnet p† kontaktpersonen p† kundens faktureringsadress.];
                ApplicationArea=#Service;
                SourceExpr="Bill-to Contact" }

    { 1080000;2;Field     ;
                ToolTipML=NOR=Angir det globale lokasjonsnummeret for kunden.;
                SourceExpr=GLN }

    { 1080002;2;Field     ;
                ToolTipML=NOR=Angir kontokoden for kunden.;
                SourceExpr="Account Code NO";
                OnValidate=BEGIN
                             AccountCodeOnAfterValidate;
                           END;
                            }

    { 1080008;2;Field     ;
                ToolTipML=NOR=Angir om kunden er en del av EHF-systemet og krever en elektronisk serviceordre.;
                SourceExpr="E-Invoice" }

    { 1101100000;2;Field  ;
                ToolTipML=ENU=Specifies the EAN location number for the customer.;
                SourceExpr="EAN No." }

    { 1101100002;2;Field  ;
                ToolTipML=[ENU=Specifies the account code of the customer.;
                           SVE=Anger kontokoden f”r kunden.];
                SourceExpr="Account Code DK";
                OnValidate=BEGIN
                             AccountCodeOnAfterValidate;
                           END;
                            }

    { 1060001;2;Field     ;
                ToolTipML=ENU=Specifies the profile that this customer requires for electronic documents.;
                SourceExpr="OIOUBL Profile Code" }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er ‚n av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden f”r Genv„g dimension 1, som „r en av tv† globala dimensionskoder som du st„ller in i f”nstret Redovisningsinst„llningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er ‚n av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden f”r Genv„g dimension 2, som „r en av tv† globala dimensionskoder som du st„ller in i f”nstret Redovisningsinst„llningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbel›pet.;
                           SVE=Anger en formel som ber„knar betalningsf”rfallodatumet, kassarabattsdatumet och kassarabattens belopp.];
                ApplicationArea=#Service;
                SourceExpr="Payment Terms Code" }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the transaction is related to trade with a third party within the EU.;
                           NOR=Angir om transaksjonen er relatert til handel med en tredjepart innen EU.;
                           SVE=Anger om transaktionen „r relaterad till handel med tredje part inom EU.];
                ApplicationArea=#Service;
                SourceExpr="EU 3-Party Trade" }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the related invoice must be paid.;
                           NOR=Angir n†r den relaterte fakturaen m† betales.;
                           SVE=Anger n„r den relaterade fakturan m†ste vara betald.];
                ApplicationArea=#Service;
                SourceExpr="Due Date" }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the percentage of payment discount given, if the customer pays by the date entered in the Pmt. Discount Date field.;
                           NOR=Angir prosentandelen av kontantrabatten som gis hvis kunden betaler p† datoen som er angitt i feltet Kont.rabattdato.;
                           SVE=Anger den procentuella kassarabatten som ges om kunden betalar senast det datum som anges i f„ltet Kassarabattsdatum.];
                ApplicationArea=#Service;
                SourceExpr="Payment Discount %" }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                           NOR=Angir datoen da bel›pet i posten m† v‘re betalt for at det kan oppn†s kontantrabatt.;
                           SVE=Anger datumet d† transaktionens belopp m†ste vara betalt f”r att orderns kassarabatt ska g„lla.];
                ApplicationArea=#Service;
                SourceExpr="Pmt. Discount Date" }

    { 101 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how to make payment, such as with bank transfer, cash, or check.;
                           NOR=Angir hvordan du utf›rer en betaling, for eksempel med bankoverf›ring, kontanter eller sjekk.;
                           SVE=Anger hur kunden betalar, t.ex. med bank”verf”ring, kontanter eller check.];
                ApplicationArea=#Service;
                SourceExpr="Payment Method Code" }

    { 1060000;2;Field     ;
                ToolTipML=ENU=Specifies the Offentlig Information Online UBL (OIOUBL) payment method for the document.;
                SourceExpr="Payment Channel" }

    { 1080004;2;Field     ;
                ToolTipML=NOR=Angir datoen da varen ble ›nsket levert i serviceordren.;
                SourceExpr="Delivery Date" }

    { 107 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for various amounts on the service lines.;
                           NOR=Angir valutakoden for forskjellige bel›p p† servicelinjene.;
                           SVE=Anger valutakoden f”r olika belopp p† serviceraderna.];
                ApplicationArea=#Service;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 121 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the Unit Price and Line Amount fields on document lines should be shown with or without VAT.;
                           NOR=Angi om feltene Salgspris og Linjebel›p p† dokumentlinjer skal vises med eller uten mva.;
                           SVE=Anger om f„lten Enhetspris och Radbelopp p† dokumentrader visas med eller utan moms.];
                ApplicationArea=#Service;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValid;
                           END;
                            }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           NOR=Levering;
                           SVE=Leverans] }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for an alternate shipment address if you want to ship to another address than the one that has been entered automatically. This field is also used in case of drop shipment.;
                           NOR=Angir en kode for en alternativ leveringsadresse hvis du vil levere til en annen adresse enn den som er angitt automatisk. Dette feltet brukes ogs† ved direkte levering.;
                           SVE=Anger en kod f”r en alternativ leveransadress om du vill leverera till en annan adress „n den som har angetts automatiskt. Det h„r f„ltet anv„nds ocks† vid direktutleverans.];
                ApplicationArea=#Service;
                SourceExpr="Ship-to Code";
                OnValidate=BEGIN
                             ShiptoCodeOnAfterValidate;
                           END;
                            }

    { 23  ;2   ;Group     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til;
                           SVE=Leverans];
                GroupType=Group }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the customer at the address that the items are shipped to.;
                           NOR=Angir navnet p† kunden p† adressen som varene blir levert til.;
                           SVE=Anger namnet p† kunden p† adressen som artiklarna levereras till.];
                ApplicationArea=#Service;
                SourceExpr="Ship-to Name" }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address that the items are shipped to.;
                           NOR=Angir adressen som varene leveres til.;
                           SVE=Anger adressen som artiklarna levereras till.];
                ApplicationArea=#Service;
                SourceExpr="Ship-to Address";
                QuickEntry=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies an additional part of the ship-to address, in case it is a long address.;
                           NOR=Angir en tilleggsdel for lever til-adresse i tilfelle det er en lang adresse.;
                           SVE=Anger ytterligare en del av leveransadressen, om detta „r en l†ng adress.];
                ApplicationArea=#Service;
                SourceExpr="Ship-to Address 2";
                QuickEntry=FALSE }

    { 29  ;3   ;Group     ;
                Visible=IsShipToCountyVisible;
                GroupType=Group }

    { 25  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=L„n];
                ApplicationArea=#Service;
                SourceExpr="Ship-to County";
                QuickEntry=FALSE }

    { 93  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnummer;
                           SVE=Postnummer];
                ToolTipML=[ENU=Specifies the postal code of the address that the items are shipped to.;
                           NOR=Angir postnummeret for adressen som varene sendes til.;
                           SVE=Anger postnumret i adressen som artiklarna levereras till.];
                ApplicationArea=#Service;
                SourceExpr="Ship-to Post Code";
                QuickEntry=FALSE }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the address that the items are shipped to.;
                           NOR=Angir poststedet for adressen som varene leveres til.;
                           SVE=Anger orten i adressen som artiklarna levereras till.];
                ApplicationArea=#Service;
                SourceExpr="Ship-to City";
                QuickEntry=FALSE }

    { 27  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           NOR=Lands-/omr†dekode;
                           SVE=Lands-/regionkod];
                ApplicationArea=#Service;
                SourceExpr="Ship-to Country/Region Code";
                OnValidate=BEGIN
                             IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 44  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the contact person at the address that the items are shipped to.;
                           NOR=Angir navnet p† kontaktpersonen p† adressen som varene blir sendt til.;
                           SVE=Anger namnet p† kontaktpersonen p† adressen som artiklarna levereras till.];
                ApplicationArea=#Service;
                SourceExpr="Ship-to Contact" }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the location (for example, warehouse or distribution center) of the items specified on the service item lines.;
                           NOR=Angir koden til lokasjonen (for eksempel lager eller distribusjonssenter) for varene som er angitt p† servicevarelinjene.;
                           SVE=Anger koden f”r lagerst„llet (till exempel distributionslager eller distributionscenter) f”r artiklarna som anges p† serviceartikelraderna.];
                ApplicationArea=#Location;
                SourceExpr="Location Code" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel;
                           SVE=Utlandshandel] }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of transaction that the document represents, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transaksjonstypen som dokumentet representerer ved rapportering til INTRASTAT.;
                           SVE=Anger den transaktionstyp som dokumentet representerar f”r inrapportering till INTRASTAT.];
                ApplicationArea=#Service;
                SourceExpr="Transaction Type" }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a specification of the document's transaction, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir en spesifikasjon for dokumentets transaksjon ved rapportering til INTRASTAT.;
                           SVE=Anger en specifikation av f”rs„ljningsdokumentets transaktion f”r inrapportering till INTRASTAT.];
                ApplicationArea=#Service;
                SourceExpr="Transaction Specification" }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transportm†ten ved rapportering til INTRASTAT.;
                           SVE=Anger transports„ttet f”r inrapportering till INTRASTAT.];
                ApplicationArea=#Service;
                SourceExpr="Transport Method" }

    { 95  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the point of exit through which you ship the items out of your country/region, for reporting to Intrastat.;
                           NOR=Angir utskipningshavnen du sender varene ut av landet/omr†det fra ved rapportering til Intrastat.;
                           SVE=Anger utf”rselplatsen fr†n vilken du levererar artiklarna ut ur landet/regionen f”r inrapportering till Intrastat.];
                ApplicationArea=#Service;
                SourceExpr="Exit Point" }

    { 97  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area of the customer or vendor, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir omr†det for kunden eller leverand›ren ved rapportering til INTRASTAT.;
                           SVE=Anger omr†det i kundens eller leverant”rens adress f”r inrapportering till INTRASTAT.];
                ApplicationArea=#Service;
                SourceExpr=Area }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1902018507;1;Part   ;
                ApplicationArea=#Service;
                SubPageLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=TRUE;
                PartType=Page }

    { 1900316107;1;Part   ;
                ApplicationArea=#Service;
                SubPageLink=No.=FIELD(Customer No.);
                PagePartID=Page9084;
                Visible=FALSE;
                PartType=Page }

    { 1907829707;1;Part   ;
                ApplicationArea=#Service;
                SubPageLink=No.=FIELD(Customer No.);
                PagePartID=Page9085;
                Visible=FALSE;
                PartType=Page }

    { 1902613707;1;Part   ;
                ApplicationArea=#Service;
                SubPageLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9086;
                Visible=FALSE;
                PartType=Page }

    { 1906530507;1;Part   ;
                ApplicationArea=#Service;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9088;
                ProviderID=56;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      ServLogMgt@1007 : Codeunit 5906;
      FormatAddress@1009 : Codeunit 365;
      ChangeExchangeRate@1001 : Page 511;
      DocumentIsPosted@1000 : Boolean;
      OpenPostedServiceInvQst@1002 : TextConst '@@@="%1 = posted document number";ENU=The invoice is posted as number %1 and moved to the Posted Service Invoices window.\\Do you want to open the posted invoice?;NOR=Ordren er bokf›rt som nummer %1 og flyttet til vinduet Bokf›rte servicefakturaer.\\Vil du †pne den bokf›rte fakturaen?;SVE=Fakturan har bokf”rts som nummer %1 och flyttats till f”nstret Bokf”rda servicefakturor.\\Vill du ”ppna den bokf”rda fakturan?';
      IsBillToCountyVisible@1005 : Boolean;
      IsSellToCountyVisible@1006 : Boolean;
      IsShipToCountyVisible@1008 : Boolean;

    LOCAL PROCEDURE ActivateFields@5();
    BEGIN
      IsSellToCountyVisible := FormatAddress.UseCounty("Country/Region Code");
      IsBillToCountyVisible := FormatAddress.UseCounty("Bill-to Country/Region Code");
      IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.ServLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE CustomerNoOnAfterValidate@19016267();
    BEGIN
      IF GETFILTER("Customer No.") = xRec."Customer No." THEN
        IF "Customer No." <> xRec."Customer No." THEN
          SETRANGE("Customer No.");
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.ServLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ResponsibilityCenterOnAfterVal@19032024();
    BEGIN
      CurrPage.ServLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE BilltoCustomerNoOnAfterValidat@19044114();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE AccountCodeOnAfterValidate@19007267();
    BEGIN
      CurrPage.ServLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShiptoCodeOnAfterValidate@19065015();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@17(PreAssignedNo@1001 : Code[20]);
    VAR
      ServiceInvoiceHeader@1000 : Record 5992;
      InstructionMgt@1002 : Codeunit 1330;
    BEGIN
      ServiceInvoiceHeader.SETCURRENTKEY("Pre-Assigned No.");
      ServiceInvoiceHeader.SETRANGE("Pre-Assigned No.",PreAssignedNo);
      IF ServiceInvoiceHeader.FINDFIRST THEN
        IF InstructionMgt.ShowConfirm(STRSUBSTNO(OpenPostedServiceInvQst,ServiceInvoiceHeader."No."),
             InstructionMgt.ShowPostedConfirmationMessageCode)
        THEN
          PAGE.RUN(PAGE::"Posted Service Invoice",ServiceInvoiceHeader);
    END;

    BEGIN
    END.
  }
}

