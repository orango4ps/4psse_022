OBJECT Page 11125143 Service Location
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Service Location;
               NOR=Servicelokasjon;
               SVE=Serviceplats];
    SourceTable=Table11012801;
    PopulateAllFields=Yes;
    PageType=Card;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Objects,Mail Documents;
                                NOR=Ny,Prosesser,Rapporter,Objekter,Send dokumenter;
                                SVE=Ny,Behandla,Rapport,Objekt];
    OnOpenPage=BEGIN
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 ProjectInformationEditable := GetProjectInfoAccess;
                 SetVisible;
               END;

    OnAfterGetRecord=VAR
                       Source@1100528800 : 'ServiceLocation,ServiceObject';
                     BEGIN
                       CurrPage.PurchaseLineServiceObjectFactbox.PAGE.SetSource(Source::ServiceLocation, "No.");
                       gvMaintenanceManagementCU.GetNextMaintDateByLocation(Rec,gvNextDate,gvNextOrderCde);
                       RefreshNumOfAddresses;
                       OnAfterGetCurrRecord;
                       SetEditable;
                       SetContactInfoEditable;
                     END;

    OnNewRecord=BEGIN
                  IF BuildingCode <> '' THEN
                    VALIDATE("Building Code", BuildingCode);
                  DPA_SetDefaultDepartment;
                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=VAR
                     xRecRef@1210190000 : RecordRef;
                   BEGIN
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525034;1 ;ActionGroup;
                      CaptionML=[ENU=&Location;
                                 NOR=&Plassering;
                                 SVE=&Lagerst„lle] }
      { 1100528603;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Service Location),
                                  No.=FIELD(No.);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Process }
      { 1100525035;2 ;Action    ;
                      CaptionML=[ENU=Picture;
                                 NOR=Bilde;
                                 SVE=Bild];
                      RunObject=Page 11126757;
                      RunPageLink=No.=FIELD(No.);
                      Image=Picture }
      { 1100528604;2 ;Action    ;
                      CaptionML=[ENU=Report &Procedure;
                                 NOR=Annen Servicelokasjon informasjon;
                                 SVE=™vrig service&platsinformation];
                      RunObject=Page 11125206;
                      RunPageLink=Table Name=CONST(Service Location),
                                  No.=FIELD(No.);
                      Promoted=Yes;
                      Image=SNInfo;
                      PromotedCategory=Process }
      { 1100525043;2 ;Action    ;
                      CaptionML=[ENU=Objects;
                                 NOR=Programobjekt;
                                 SVE=Serviceobjekt];
                      Promoted=Yes;
                      Image=WorkCenterLoad;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowRelatedObjects;
                               END;
                                }
      { 1100528619;2 ;Action    ;
                      CaptionML=[ENU=Do&cuments;
                                 NOR=Do&kumenter;
                                 SVE=Do&kument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDocuments;
                               END;
                                }
      { 1210190005;2 ;Action    ;
                      CaptionML=[ENU=&Contacts;
                                 NOR=&Kontakter;
                                 SVE=&Kontakter];
                      RunObject=Page 11012874;
                      RunPageLink=Service Location No.=FIELD(No.);
                      Image=ContactPerson }
      { 1100528613;2 ;Action    ;
                      CaptionML=[ENU=Subcontractors;
                                 NOR=Underentrepen›rer;
                                 SVE=Underentrepren”rer];
                      RunObject=Page 11126097;
                      RunPageLink=Service Contract No.=CONST(),
                                  Service Location No.=FIELD(No.),
                                  Object No.=CONST(),
                                  Maintenance Scheme Code=CONST();
                      Image=SubcontractingWorksheet }
      { 1100526205;2 ;Action    ;
                      CaptionML=[ENU=Structures;
                                 NOR=Strukturer;
                                 SVE=Strukturer];
                      RunObject=Page 11125197;
                      RunPageLink=Service Location No.=FIELD(No.);
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=ExplodeBOM;
                      PromotedCategory=Category4 }
      { 1100526206;2 ;Action    ;
                      CaptionML=[ENU=Tender Element Structure;
                                 NOR=Tilbudselement, struktur;
                                 SVE=Anbudselementstruktur];
                      Visible=FALSE;
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 ShowTenderElementStructure;
                               END;
                                }
      { 1100528626;2 ;Action    ;
                      CaptionML=ENU=NEN2767/LTMP;
                      RunObject=Page 11128795;
                      RunPageView=SORTING(Location Type,Survey No.,Location Code,Measurement Date);
                      RunPageLink=Location Type=CONST(Service Location),
                                  Location Code=FIELD(No.);
                      Visible=FALSE;
                      Image=DocumentEdit }
      { 1100409003;2 ;Action    ;
                      CaptionML=[ENU=Preference Locations;
                                 SVE=F”rvalda lagerst„llen];
                      RunObject=Page 11072424;
                      RunPageLink=Service Location No.=FIELD(No.);
                      Visible=FALSE;
                      Image=Company }
      { 1100528305;2 ;Action    ;
                      CaptionML=[ENU=Responsible Persons;
                                 NOR=Ansvarlige personer;
                                 SVE=Ansvariga personer];
                      RunObject=Page 11126783;
                      RunPageLink=Source Type=CONST(ServLocation),
                                  Source Code=FIELD(No.);
                      Image=PersonInCharge }
      { 1100528304;2 ;Action    ;
                      CaptionML=[ENU=Authorities;
                                 NOR=Myndigheter;
                                 SVE=Myndigheter];
                      RunObject=Page 11126784;
                      RunPageLink=Source Type=CONST(ServLocation),
                                  Source Code=FIELD(No.);
                      Image=IndustryGroups }
      { 1100528400;2 ;Action    ;
                      CaptionML=ENU=Ship-to Addresses;
                      RunObject=Page 11126839;
                      RunPageLink=Service Location No.=FIELD(No.);
                      Visible=FALSE;
                      Image=Addresses }
      { 1100525051;1 ;ActionGroup;
                      CaptionML=[ENU=Bing Maps;
                                 NOR=Bing-kart;
                                 SVE=Bing Maps] }
      { 1100525045;2 ;Action    ;
                      Name=Show Location On Map;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=ENU=Show Location On Map;
                      Visible=(Latitude <> '') AND (Longitude <> '');
                      Image=Map;
                      OnAction=VAR
                                 BingMaps@1100525000 : Page 11229928;
                               BEGIN
                                 BingMaps.setLocation(Rec);
                                 BingMaps.RUNMODAL;
                               END;
                                }
      { 1100525046;2 ;Action    ;
                      Name=Set GPS Coordinates;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=[ENU=Set GPS Coordinates;
                                 SVE=S„tt GPS-kordinater];
                      Visible=(Latitude = '') OR (Longitude = '');
                      Image=MapSetup;
                      OnAction=VAR
                                 BingMapsHandler@1100525000 : Codeunit 11012485;
                                 tempLatitude@1100525001 : Text;
                                 tempLongitude@1100525002 : Text;
                               BEGIN
                                 IF BingMapsHandler.GetLatLngFromAddress(tempLatitude, tempLongitude, Address, City, "Post Code") THEN BEGIN
                                   Latitude := tempLatitude;
                                   Longitude := tempLongitude;
                                   MODIFY;
                                   CurrPage.UPDATE;
                                 END
                                 ELSE
                                   MESSAGE(Text001);
                               END;
                                }
      { 1100525047;2 ;Action    ;
                      Name=Add Location Manually on Map;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=ENU=Add Location Manually on Map;
                      Visible=(Longitude = '') OR (Latitude = '');
                      Image=MapSetup;
                      OnAction=VAR
                                 BingMaps@1100525000 : Page 11229937;
                               BEGIN
                                 BingMaps.setInformation("No.", "No.", DATABASE::"Service Location", Description);
                                 BingMaps.RUNMODAL;
                               END;
                                }
      { 1100525050;2 ;Action    ;
                      Name=Show Objects On Map;
                      AccessByPermission=TableData 11072390=R;
                      CaptionML=ENU=Show Location and Objects on Map;
                      Visible=(Latitude <> '') AND (Longitude <> '');
                      Image=Map;
                      OnAction=VAR
                                 BingMapsLocationObjects@1100525000 : Page 11229929;
                               BEGIN
                                 BingMapsLocationObjects.SetServiceLocation(Rec);
                                 BingMapsLocationObjects.UseRelatedServiceObjects;
                                 BingMapsLocationObjects.RUNMODAL;
                               END;
                                }
      { 1100528315;1 ;ActionGroup;
                      CaptionML=[ENU=Document Portal (Dual);
                                 NOR=Dokumentportal (dobbel);
                                 SVE=Dokumentportal (dubbel)];
                      Image=Web }
      { 1100528313;2 ;Action    ;
                      AccessByPermission=TableData 11229823=R;
                      CaptionML=[ENU=Welcome Text;
                                 NOR=Velkomsttekst;
                                 SVE=V„lkomsttext];
                      Visible=false;
                      Image=Text;
                      OnAction=VAR
                                 DPTHeaderText@1100528300 : Record 11229943;
                                 DPTHeaderTexts@1100528301 : Page 11229626;
                               BEGIN
                                 DPTHeaderText.SETRANGE("Table No.", DATABASE::"Service Location");
                                 DPTHeaderText.SETRANGE("Field No.", FIELDNO("Document Portal Site Generated"));
                                 DPTHeaderText.SETRANGE("Source No.", "No.");
                                 DPTHeaderText.SETRANGE("Subsite Code", '');
                                 DPTHeaderTexts.SETTABLEVIEW(DPTHeaderText);
                                 DPTHeaderTexts.RUNMODAL;
                               END;
                                }
      { 1100528312;2 ;Action    ;
                      CaptionML=[ENU=Subsites;
                                 SVE=Undersida];
                      RunObject=Page 11130622;
                      RunPageLink=Service Location No.=FIELD(No.);
                      Visible=false;
                      Image=AssemblyOrder }
      { 1100528311;2 ;Action    ;
                      CaptionML=[ENU=Linked Document Types;
                                 SVE=L„nkade dokumenttyper];
                      RunObject=Page 11130623;
                      RunPageLink=Service Location No.=FIELD(No.);
                      Visible=false;
                      Image=Link }
      { 1100528310;2 ;Action    ;
                      CaptionML=[ENU=Responsible Person Permissions;
                                 SVE=Projektansvariga, beh”righeter];
                      RunObject=Page 11130624;
                      RunPageLink=Service Location No.=FIELD(No.);
                      Visible=false;
                      Image=Permission }
      { 1100528308;2 ;Action    ;
                      CaptionML=[ENU=Authority Permissions;
                                 SVE=" Externa projektkontaker, beh”righeter"];
                      RunObject=Page 11130626;
                      RunPageLink=Service Location No.=FIELD(No.);
                      Visible=false;
                      Image=Permission }
      { 1210190001;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100525038;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=Fu&nksjon;
                                 SVE=F&unktion] }
      { 1100525039;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Maintenance Proposal;
                                 NOR=Opprett vedlikeholdsforslag;
                                 SVE=Skapa underh†llsf”rslag];
                      Promoted=Yes;
                      Image=MaintenanceRegistrations;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lvServLocRec@1100525001 : Record 11012801;
                                 lvCreateMaintPropRep@1100525000 : Report 11012864;
                               BEGIN
                                 lvServLocRec.SETRANGE("No.","No.");
                                 lvCreateMaintPropRep.SETTABLEVIEW(lvServLocRec);
                                 lvCreateMaintPropRep.RUNMODAL;
                               END;
                                }
      { 1100528800;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Final Invoice Proposal;
                                 SVE=Skapa slutfakturaf”rslag];
                      Image=MaintenanceRegistrations;
                      OnAction=VAR
                                 ServiceLocation@1100528801 : Record 11012801;
                                 FinalInvoiceProposalLoc@1100528800 : Report 11012792;
                               BEGIN
                                 ServiceLocation.SETRANGE("No.","No.");
                                 FinalInvoiceProposalLoc.SETTABLEVIEW(ServiceLocation);
                                 FinalInvoiceProposalLoc.RUNMODAL;
                               END;
                                }
      { 1210190003;2 ;Action    ;
                      CaptionML=[ENU=Create Objects;
                                 NOR=Opprett objekter;
                                 SVE=Skapa objekt];
                      Image=AddAction;
                      OnAction=VAR
                                 TmpContractConsObjWizardLine@1210190001 : TEMPORARY Record 11071698;
                               BEGIN
                                 IF PAGE.RUNMODAL(PAGE::"Select Standard Objects", TmpContractConsObjWizardLine) = ACTION::LookupOK THEN
                                   CreateLocationObjects(TmpContractConsObjWizardLine);
                               END;
                                }
      { 1100528620;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Edit Word Documents;
                                 NOR=Rediger Word-dokument;
                                 SVE=Redigera Word-dokument];
                      Promoted=Yes;
                      Image=Word;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Contact@1100528600 : Record 5050;
                               BEGIN
                                 TESTFIELD("Customer No.");
                                 IF Contact.GetContactByCustomer("Customer No.", Contact, TRUE) THEN
                                   EditDocuments(Contact."No.", '', FALSE, '');
                               END;
                                }
      { 1100528625;2 ;Action    ;
                      ShortCutKey=Ctrl+K;
                      CaptionML=[ENU=Completeness Check;
                                 NOR=Fullstendighetskontroll;
                                 SVE=Fullst„ndighetskontroll];
                      Image=CheckList;
                      OnAction=VAR
                                 CompletionCheckManagement@1100528600 : Codeunit 11012252;
                                 RecRef@1100528601 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 CompletionCheckManagement.ShowIncompleteFields(RecRef);
                               END;
                                }
      { 1100528318;1 ;ActionGroup;
                      CaptionML=[ENU=Document Portal (Dual);
                                 NOR=Dokumentportal (dobbel);
                                 SVE=Dokumentportal (dubbel)];
                      Image=Web }
      { 1100528317;2 ;Action    ;
                      AccessByPermission=TableData 11229823=R;
                      CaptionML=[ENU=Create Setup;
                                 NOR=Opprette innstillinger;
                                 SVE=Skapa inst„llningar];
                      Visible=false;
                      Image=JobListSetup;
                      OnAction=VAR
                                 DPTInterfaceServiceLoc@1100528300 : Codeunit 11012949;
                               BEGIN
                                 DPTInterfaceServiceLoc.CreateSubsiteAndPermissionSetup(Rec);
                               END;
                                }
      { 1100528316;2 ;Action    ;
                      AccessByPermission=TableData 11229823=R;
                      CaptionML=[ENU=Create Site;
                                 SVE=Skapa sida];
                      Visible=False;
                      Image=CreateForm;
                      OnAction=VAR
                                 DPTSetup@1100528300 : Record 11229823;
                                 DPTEventLog@1100528301 : Record 11229822;
                                 xRecID@1100525000 : RecordID;
                               BEGIN
                                 TESTFIELD("Generate Document Portal Site");
                                 TESTFIELD("Document Portal Site Generated", FALSE);
                                 DPTSetup.GET;
                                 DPTSetup.TESTFIELD("Use Location Portal", TRUE);
                                 DPTEventLog.AddEventLog(DPTEventLog.GetSyncPortalSiteText, DPTEventLog."Source Type"::ServiceLocation, "No.", RECORDID, xRecID);
                                 MESSAGE(Text000);
                               END;
                                }
      { 1100528314;2 ;Action    ;
                      AccessByPermission=TableData 11229823=R;
                      CaptionML=[ENU=Sync Site Content;
                                 SVE=Synka sidinneh†ll];
                      Visible=False;
                      Image=GetBinContent;
                      OnAction=VAR
                                 DPTSetup@1100528300 : Record 11229823;
                                 ServiceLocation@1100528301 : Record 11012801;
                               BEGIN
                                 DPTSetup.GET;
                                 IF (DPTSetup."Use Location Portal") THEN BEGIN
                                   ServiceLocation.SETRANGE("No.", "No.");
                                   REPORT.RUNMODAL(REPORT::"DPT Sync Doc Portal ServLoc", TRUE, FALSE, ServiceLocation);
                                 END;
                               END;
                                }
      { 1100525053;2 ;Action    ;
                      AccessByPermission=TableData 11229823=R;
                      CaptionML=[ENU=DeActivate Site;
                                 SVE=Inaktivera sida];
                      Visible=False;
                      Image=Web;
                      OnAction=VAR
                                 DPTSetup@1100525000 : Record 11229823;
                                 ServiceLocation@1100525001 : Record 11012801;
                               BEGIN
                                 TESTFIELD("Generate Document Portal Site");
                                 TESTFIELD("Document Portal Site Generated");
                                 DPTSetup.GET;
                                 IF (DPTSetup."Use Location Portal") THEN BEGIN
                                   ServiceLocation.SETRANGE("No.", "No.");
                                   REPORT.RUNMODAL(REPORT::"DPT Deactivate Serv Location", TRUE, FALSE, ServiceLocation);
                                 END;
                               END;
                                }
      { 1100525012;1 ;ActionGroup;
                      CaptionML=[ENU=Mail Documents;
                                 NOR=Send dokumenter;
                                 SVE=E-postdokument];
                      ActionContainerType=NewDocumentItems }
      { 1100525014;2 ;Action    ;
                      CaptionML=[ENU=Location;
                                 NOR=Plassering;
                                 SVE=Lagerst„lle];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Contact@1100525000 : Record 5050;
                               BEGIN
                                 TESTFIELD("Customer No.");
                                 IF Contact.GetContactByCustomer("Customer No.", Contact, TRUE) THEN
                                   EditDocuments(Contact."No.", '', TRUE, "E-Mail");
                               END;
                                }
      { 1100525041;1 ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut;
                                 SVE=Skriv &ut] }
      { 1100525037;2 ;Action    ;
                      CaptionML=[ENU=Service Location Reports;
                                 SVE=Serviceplatsrapport];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 DocumentPrint@1100528600 : Codeunit 229;
                               BEGIN
                                 DocumentPrint.PrintServLocation(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100525000;1;Group  ;
                CaptionML=[ENU=General;
                           NOR=Generell;
                           SVE=Allm„nt] }

    { 1100525001;2;Field  ;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               //mg.sn, 15-12-10: M24139
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                               //mg.sn, 15-12-10: M24139
                             END;
                              }

    { 1100525003;2;Field  ;
                SourceExpr=Description }

    { 1100525005;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE }

    { 1100525007;2;Field  ;
                SourceExpr="Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             CustomerNoOnAfterValidate;
                           END;
                            }

    { 1100525009;2;Field  ;
                SourceExpr="Customer Name" }

    { 1100527450;2;Field  ;
                SourceExpr=Name }

    { 1100409000;2;Field  ;
                CaptionML=[ENU=No. of Addresses;
                           NOR=Antall adresser;
                           SVE=Antal adresser];
                SourceExpr=NumOfAddresses;
                Visible=FALSE;
                Editable=false }

    { 1100528606;2;Field  ;
                SourceExpr="Address Code";
                Visible=FALSE }

    { 1100528610;2;Field  ;
                SourceExpr="Address Name";
                Importance=Additional;
                Visible=FALSE }

    { 1100525011;2;Field  ;
                SourceExpr=Address }

    { 1100525013;2;Field  ;
                SourceExpr="Address 2";
                Importance=Additional;
                Visible=FALSE }

    { 1100525015;2;Field  ;
                SourceExpr="Post Code" }

    { 1100525017;2;Field  ;
                SourceExpr=City }

    { 1100525036;2;Field  ;
                SourceExpr="Post Code Group";
                Visible=FALSE }

    { 1100525019;2;Field  ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 1100529400;2;Field  ;
                SourceExpr=Latitude;
                Importance=Additional;
                Visible=FALSE }

    { 1100529401;2;Field  ;
                SourceExpr=Longitude;
                Importance=Additional;
                Visible=FALSE }

    { 1210190010;2;Field  ;
                SourceExpr="Contact Name";
                OnLookup=BEGIN
                           CALCFIELDS("Contact No.");
                           ShowContact("Customer No.");
                         END;
                          }

    { 1100525021;2;Field  ;
                SourceExpr="Phone No." }

    { 1100525032;2;Field  ;
                SourceExpr="Phone No. 2";
                Visible=FALSE }

    { 1100525023;2;Field  ;
                SourceExpr="Mobile Phone No." }

    { 1210190012;2;Field  ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 1100525025;2;Field  ;
                SourceExpr="E-Mail" }

    { 1100525031;2;Field  ;
                SourceExpr="Search Name" }

    { 1100525033;2;Field  ;
                SourceExpr="Location Customer" }

    { 1100528622;2;Field  ;
                SourceExpr="Location Manager";
                Visible=FALSE }

    { 1100528624;2;Field  ;
                SourceExpr="Location Manager Name";
                Importance=Additional;
                Visible=FALSE }

    { 1100525040;2;Field  ;
                CaptionML=[ENU=Preferred Employee;
                           NOR=Foretrukket Ansatt;
                           SVE=F”rvald &anst„lld];
                SourceExpr=PreferredEmployeeNo;
                Visible=FALSE;
                Editable=FALSE;
                OnAssistEdit=VAR
                               lvPrefEmplRec@1100525000 : Record 11012843;
                             BEGIN
                               lvPrefEmplRec.AssistEditPreferredEmployee('', "No.", '', '', '');
                               CurrPage.UPDATE(TRUE);
                             END;
                              }

    { 1100525042;2;Field  ;
                CaptionML=[ENU=Name Preferred Employee;
                           NOR=Navn p† Foretrukket Ansatt;
                           SVE=Namn på förvald anställd];
                SourceExpr=PreferredEmployeeName;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528617;2;Field  ;
                CaptionML=[ENU=Subcontractor;
                           NOR=Underentrepren›r;
                           SVE=Underentrepren”r];
                SourceExpr=SubcontractorCode;
                Visible=FALSE;
                Editable=FALSE;
                OnAssistEdit=VAR
                               SubcontractorService@1100528601 : Record 11071789;
                             BEGIN
                               SubcontractorService.AssistEditSubcontractors('', "No.", '', '');
                               CurrPage.UPDATE(TRUE);
                             END;
                              }

    { 1100528618;2;Field  ;
                CaptionML=[ENU=Subcontractor Name;
                           NOR=Underentrepren›rens navn;
                           SVE=Underentrepren”rens namn];
                SourceExpr=SubcontractorName;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528803;2;Field  ;
                SourceExpr="Real Estate Unit Number";
                Visible=FALSE }

    { 1100525002;2;Field  ;
                SourceExpr="Building Code";
                Importance=Additional;
                Visible=FALSE }

    { 1100525004;2;Field  ;
                SourceExpr="Building Description";
                Importance=Additional;
                Visible=FALSE }

    { 1100525044;2;Field  ;
                SourceExpr="Customer Feature" }

    { 1100528623;2;Field  ;
                SourceExpr="Tenant No.";
                Visible=FALSE }

    { 1100525027;2;Field  ;
                SourceExpr="Territory Code";
                Visible=FALSE }

    { 1100525029;2;Field  ;
                SourceExpr=Type;
                Importance=Additional;
                Visible=FALSE }

    { 1100528621;2;Field  ;
                SourceExpr="Service Location Type";
                Visible=FALSE }

    { 1210190014;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1100526201;2;Field  ;
                SourceExpr="Complex Code";
                Importance=Additional;
                Visible=FALSE }

    { 1100528607;2;Field  ;
                SourceExpr="Travel Distance" }

    { 1100528611;2;Field  ;
                CaptionML=[ENU=Travel Distance Unit;
                           NOR=Reisedistanse for enhet;
                           SVE=Resstr„cka enhet];
                SourceExpr=TravelDistanceUnit;
                Editable=FALSE }

    { 1100528608;2;Field  ;
                SourceExpr="Travel Time" }

    { 1100528612;2;Field  ;
                CaptionML=[ENU=Travel Time Unit;
                           NOR=Reis foretid enhet;
                           SVE=Restid enhet];
                SourceExpr=TravelTimeUnit;
                Editable=FALSE }

    { 1100528609;2;Field  ;
                SourceExpr="Travel Cost Code" }

    { 1210190016;2;Field  ;
                SourceExpr=Watch;
                Importance=Additional;
                Visible=FALSE }

    { 1210190000;2;Field  ;
                SourceExpr="Remote Control";
                Importance=Additional;
                Visible=FALSE }

    { 1100528614;2;Field  ;
                SourceExpr=Blocked }

    { 1100409001;2;Field  ;
                SourceExpr=Deliver;
                Visible=FALSE }

    { 1100409002;2;Field  ;
                SourceExpr="Ship To Location";
                Visible=FALSE }

    { 1100527800;2;Field  ;
                SourceExpr="BAG Id";
                Visible=FALSE }

    { 1100527371;2;Field  ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 1100528602;1;Part   ;
                CaptionML=[ENU=Specifications;
                           NOR=Spesifikasjoner;
                           SVE=Specifikationer];
                SubPageLink=Service Location No.=FIELD(No.);
                PagePartID=Page11126458;
                Visible=FALSE;
                PartType=Page }

    { 1905289801;1;Group  ;
                CaptionML=[ENU=Data;
                           NOR=Data;
                           SVE=Data];
                GroupType=Group }

    { 1100525048;2;Field  ;
                CaptionML=[ENU=Starting Date Next Service Order;
                           NOR=Startdato for neste serviceordre;
                           SVE=Startdatum f”r n„sta serviceorder];
                SourceExpr=gvNextDate;
                Visible=FALSE;
                Editable=FALSE }

    { 1100525049;2;Field  ;
                CaptionML=[ENU=Next Service Order;
                           NOR=Neste serviceordre;
                           SVE=N„sta serviceorder];
                SourceExpr=gvNextOrderCde;
                Visible=FALSE;
                Editable=FALSE;
                OnAssistEdit=VAR
                               ServiceOrder@1100528600 : Record 11012823;
                             BEGIN
                               IF gvNextOrderCde = '' THEN
                                 EXIT;
                               IF ServiceOrder.GET(gvNextOrderCde) THEN
                                 PAGE.RUN(PAGE::"Service Order (General)", ServiceOrder);
                             END;
                              }

    { 1210190002;2;Field  ;
                SourceExpr="Creation Date";
                Importance=Additional }

    { 1210190004;2;Field  ;
                SourceExpr="Modified by";
                Importance=Additional }

    { 1210190006;2;Field  ;
                SourceExpr="Last Date Modified";
                Importance=Additional }

    { 1210190008;2;Field  ;
                SourceExpr="Last Time Modified";
                Importance=Additional;
                Editable=FALSE }

    { 1100525026;2;Field  ;
                SourceExpr="Reference Date (Item)";
                Visible=FALSE }

    { 1100525030;2;Field  ;
                SourceExpr="Purch Discount Term Group 1";
                Visible=FALSE }

    { 1100525028;2;Field  ;
                SourceExpr="Purch Discount Term Group 2";
                Visible=FALSE }

    { 1100525024;2;Field  ;
                SourceExpr="Sales Discount Term Group 1";
                Visible=FALSE }

    { 1100525022;2;Field  ;
                SourceExpr="Sales Discount Term Group 2";
                Visible=FALSE }

    { 1100528000;2;Field  ;
                SourceExpr="Service Location Folder";
                Importance=Additional;
                OnAssistEdit=BEGIN
                               AssistEditServLocFolder;
                             END;
                              }

    { 1100527400;2;Field  ;
                SourceExpr="Warranty Company";
                Importance=Additional }

    { 1100528726;2;Field  ;
                SourceExpr="Warranty Project No.";
                Importance=Additional }

    { 1100528627;2;Field  ;
                SourceExpr="Warranty Element No";
                Importance=Additional }

    { 1100528628;2;Field  ;
                SourceExpr="Warranty Expires On";
                Importance=Additional }

    { 1902804101;1;Group  ;
                CaptionML=[ENU=Settings;
                           NOR=Innstillinger;
                           SVE=Inst„llningar] }

    { 1100526203;2;Field  ;
                SourceExpr="Location Structure Format";
                Visible=false }

    { 1100528601;2;Field  ;
                SourceExpr="Maintenance Day";
                Visible=FALSE }

    { 1100528605;2;Field  ;
                SourceExpr="Starting Time Maint. Window";
                Visible=FALSE }

    { 1100528600;2;Field  ;
                SourceExpr="Ending Time Maint. Window";
                Visible=FALSE }

    { 1100528615;2;Field  ;
                SourceExpr="Postal Address App. Letter";
                Visible=FALSE }

    { 1100528616;2;Field  ;
                SourceExpr="Customer Address Code";
                Visible=FALSE }

    { 1210190024;2;Group  ;
                Name=4PSMobileLbl;
                CaptionML=[ENU=Field Service;
                           NOR=Feltservice;
                           SVE=F„ltservice];
                Visible="4PSMobileLblVisible";
                GroupType=Group }

    { 1210190022;3;Field  ;
                SourceExpr="Initial Minutes Working Hours";
                Visible=InitialMinutesWorkingHoursVisi }

    { 1210190020;3;Field  ;
                SourceExpr="Round Working Hours on Minutes";
                Visible=RoundWorkingHoursonMinutesVisi }

    { 1210190018;3;Field  ;
                SourceExpr="Round Travel Hours on Minutes";
                Visible=RoundTravelHoursonMinutesVisib }

    { 1100525010;2;Field  ;
                SourceExpr="Publish on Service Portal" }

    { 1100528300;1;Group  ;
                CaptionML=[ENU=Document Portal (Dual);
                           NOR=Dokumentportal (dobbel);
                           SVE=Dokumentportal (dubbel)];
                Visible=DPTVisible;
                GroupType=Group }

    { 1100528306;2;Field  ;
                SourceExpr="Document Portal Language" }

    { 1100528301;2;Field  ;
                SourceExpr="Generate Document Portal Site";
                Importance=Promoted }

    { 1100528302;2;Field  ;
                SourceExpr="Document Portal Site Generated";
                Importance=Promoted }

    { 1100528303;2;Field  ;
                SourceExpr="Document Portal URL" }

    { 1100528500;1;Group  ;
                CaptionML=ENU=Project Information;
                Editable=ProjectInformationEditable;
                GroupType=Group }

    { 1100528501;2;Field  ;
                SourceExpr="Supplying Company";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             SetEditable;
                           END;
                            }

    { 1100528502;2;Field  ;
                SourceExpr="Project No.";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             SetEditable;
                           END;

                OnLookup=BEGIN
                           LookupProjectNo;
                           SetEditable;
                         END;
                          }

    { 1100528503;2;Field  ;
                SourceExpr="Plot No.";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             SetEditable;
                           END;

                OnLookup=BEGIN
                           LookupPlotNo;
                           SetEditable;
                         END;
                          }

    { 1100527301;2;Field  ;
                SourceExpr="Project Description";
                Visible=FALSE;
                Editable=ProjectDescriptionEditable }

    { 1100529600;1;Group  ;
                CaptionML=ENU=Invoice Address;
                GroupType=Group }

    { 1100529601;2;Field  ;
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 1100529607;2;Field  ;
                SourceExpr="Alternative Bill-to Address";
                Visible=FALSE }

    { 1100529604;2;Field  ;
                SourceExpr="Bill-to Name";
                Visible=FALSE }

    { 1100529608;2;Field  ;
                SourceExpr="Bill-to Name 2";
                Importance=Additional;
                Visible=FALSE }

    { 1100529609;2;Field  ;
                SourceExpr="Bill-to Address";
                Visible=FALSE }

    { 1100529610;2;Field  ;
                SourceExpr="Bill-to Address 2";
                Importance=Additional;
                Visible=FALSE }

    { 1100529611;2;Field  ;
                SourceExpr="Bill-to Post Code";
                Visible=FALSE }

    { 1100529612;2;Field  ;
                SourceExpr="Bill-to City";
                Visible=FALSE }

    { 1100529605;2;Field  ;
                SourceExpr="Bill-to Contact No.";
                Importance=Additional;
                Visible=FALSE }

    { 1100529602;2;Field  ;
                SourceExpr="Bill-to Contact Person";
                Visible=FALSE }

    { 1100529606;2;Field  ;
                SourceExpr="Bill-to Contact Person Name";
                Importance=Additional;
                Visible=FALSE }

    { 1100529603;2;Field  ;
                SourceExpr="Bill-to Contact Name";
                Visible=FALSE }

    { 1100527350;1;Group  ;
                CaptionML=ENU=Vessel;
                GroupType=Group }

    { 1100527351;2;Field  ;
                SourceExpr="Vessel No.";
                Visible=FALSE }

    { 1100527352;2;Field  ;
                SourceExpr="Vessel Name";
                Visible=FALSE }

    { 1100527353;2;Field  ;
                SourceExpr="Vessel Start Date";
                Visible=FALSE }

    { 1100527354;2;Field  ;
                SourceExpr="Vessel Main Category";
                Visible=FALSE }

    { 1100527355;2;Field  ;
                SourceExpr="Vessel Category";
                Visible=FALSE }

    { 1100527356;2;Field  ;
                SourceExpr="Vessel Flag";
                Visible=FALSE }

    { 1100527357;2;Field  ;
                SourceExpr="Vessel MMSI";
                Visible=FALSE }

    { 1100527358;2;Field  ;
                SourceExpr="Vessel GRT";
                Visible=FALSE }

    { 1100527359;2;Field  ;
                SourceExpr="Vessel Call Sign";
                Visible=FALSE }

    { 1100527360;2;Field  ;
                SourceExpr="Vessel Classification";
                Visible=FALSE }

    { 1100527361;2;Field  ;
                SourceExpr="Vessel Reason Out of Use";
                Visible=FALSE }

    { 1100527362;2;Field  ;
                SourceExpr="Vessel Date Out of Use";
                Visible=FALSE }

    { 1100527363;2;Field  ;
                SourceExpr="Vessel Yard";
                Visible=FALSE }

    { 1100527364;2;Field  ;
                SourceExpr="Vessel Build in";
                Visible=FALSE }

    { 1100527365;2;Field  ;
                SourceExpr="Vessel Construction Date";
                Visible=FALSE }

    { 1100527366;2;Field  ;
                SourceExpr="Vessel Plot No.";
                Visible=FALSE }

    { 1100527368;2;Field  ;
                SourceExpr="Vessel Owner";
                Visible=FALSE }

    { 1100527367;2;Field  ;
                SourceExpr="Vessel Owner Name";
                Visible=FALSE }

    { 1100527369;2;Field  ;
                SourceExpr="Vessel Contract Owner";
                Visible=FALSE }

    { 1100527370;2;Field  ;
                SourceExpr="Vessel Manager";
                Visible=FALSE }

    { 1100530700;1;Group  ;
                CaptionML=ENU=Tenant;
                GroupType=Group }

    { 1100530701;2;Field  ;
                SourceExpr=Tenant;
                Visible=FALSE;
                OnValidate=BEGIN
                             SetContactInfoEditable;
                           END;
                            }

    { 1100530703;2;Field  ;
                SourceExpr="Tenant Name";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530704;2;Field  ;
                SourceExpr="Tenant Name 2";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530705;2;Field  ;
                ExtendedDatatype=Phone No.;
                SourceExpr="Tenant Phone";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530706;2;Field  ;
                ExtendedDatatype=Phone No.;
                SourceExpr="Tenant Phone 2";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530707;2;Field  ;
                ExtendedDatatype=Phone No.;
                SourceExpr="Tenant Mobile Phone";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530708;2;Field  ;
                ExtendedDatatype=Phone No.;
                SourceExpr="Tenant Mobile Phone 2";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530709;2;Field  ;
                ExtendedDatatype=E-Mail;
                SourceExpr="Tenant E-Mail";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530710;2;Field  ;
                ExtendedDatatype=E-Mail;
                SourceExpr="Tenant E-Mail 2";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530711;2;Field  ;
                ExtendedDatatype=Phone No.;
                SourceExpr="Tenant Phone Work";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100530702;2;Field  ;
                ExtendedDatatype=Phone No.;
                SourceExpr="Tenant Phone Work 2";
                Visible=FALSE;
                Editable=ContactInfoEditable }

    { 1100529900;0;Container;
                ContainerType=FactBoxArea }

    { 1100525090;1;Part   ;
                CaptionML=[ENU=Picture;
                           NOR=Bilde;
                           SVE=Bild];
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11126757;
                PartType=Page }

    { 1100529901;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100525020;1;Part   ;
                CaptionML=[ENU=Totals;
                           NOR=Totaler;
                           SVE=Totaler];
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130540;
                PartType=Page }

    { 1100528801;1;Part   ;
                Name=PurchaseLineServiceObjectFactbox;
                SubPageLink=Service Location No.=FIELD(No.);
                PagePartID=Page11229357;
                PartType=Page }

    { 1100528802;1;Part   ;
                SubPageLink=Supplying Company=FIELD(Supplying Company),
                            Project No.=FIELD(Project No.),
                            Plot No.=FIELD(Plot No.);
                PagePartID=Page11229398;
                Editable=FALSE;
                PartType=Page }

    { 1100527401;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11127077;
                PartType=Page }

    { 1100525018;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100525016;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      gvMaintenanceManagementCU@1100525002 : Codeunit 11012829;
      gvNextDate@1100525001 : Date;
      gvNextOrderCde@1100525000 : Code[20];
      SubcontractorCode@1100528600 : Code[20];
      SubcontractorName@1100528601 : Text[100];
      PreferredEmployeeNo@1100528602 : Code[20];
      PreferredEmployeeName@1100528603 : Text[100];
      DPA_IsHardFilter@1210190000 : Boolean;
      "4PSMobileLblVisible"@19001363 : Boolean INDATASET;
      InitialMinutesWorkingHoursVisi@19066743 : Boolean INDATASET;
      RoundWorkingHoursonMinutesVisi@19069498 : Boolean INDATASET;
      RoundTravelHoursonMinutesVisib@19017002 : Boolean INDATASET;
      ProjectInformationEditable@1100527650 : Boolean;
      BuildingCode@1100525003 : Code[20];
      NumOfAddresses@1100409000 : Text[30];
      Text000@1100529900 : TextConst 'ENU=Portal Site will be created in the background. This will take some time.';
      Text001@1100525004 : TextConst 'ENU=GPS Coordinates can''t be calculated with current address data.;SVE=GPS-koordinater kan inte ber„knas med den aktuella adressdatan';
      ProjectDescriptionEditable@1100527300 : Boolean INDATASET;
      DPTVisible@1100528300 : Boolean;
      ContactInfoEditable@1100530700 : Boolean;

    PROCEDURE ShowDocuments@1100525001();
    VAR
      RecRef@1100525002 : RecordRef;
      DocumentFilters@1100525003 : Codeunit 11012432;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, TRUE);
    END;

    LOCAL PROCEDURE CustomerNoOnAfterValidate@19016267();
    BEGIN
      CALCFIELDS("Customer Name");
      RefreshNumOfAddresses();
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      SubcontractorService@1100528600 : Record 11071789;
      PreferredEmployee@1100528800 : Record 11012843;
      RecRef@1100529900 : RecordRef;
    BEGIN
      xRec := Rec;
      SubcontractorCode := SubcontractorService.GetSubcontractorForDisplay('', "No.", '', '', SubcontractorName);
      PreferredEmployeeNo :=
        PreferredEmployee.GetPreferredEmployeeForDisplay('', "No.", '', '', '', '', '', 0D, PreferredEmployeeName);

      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");
    END;

    PROCEDURE SetVisible@1210190000();
    BEGIN
      "4PSMobileLblVisible" := IsFSAActive();
      InitialMinutesWorkingHoursVisi := "4PSMobileLblVisible";
      RoundWorkingHoursonMinutesVisi := "4PSMobileLblVisible";
      RoundTravelHoursonMinutesVisib := "4PSMobileLblVisible";
    END;

    PROCEDURE ShowTenderElementStructure@1100525000();
    VAR
      ServiceSetup@1100525003 : Record 11012800;
      CodingSystem@1100525002 : Record 11012088;
      TenderDocumentCodeFRM@1100525001 : Page 11125196;
      TenderCodeSystemNo@1100525000 : Code[20];
    BEGIN
      ServiceSetup.GET;
      IF ServiceSetup."Tender Code System 1" <> '' THEN
        IF CodingSystem.GET(ServiceSetup."Tender Code System 1") THEN
          CodingSystem.MARK(TRUE);
      IF ServiceSetup."Tender Code System 2" <> '' THEN
        IF CodingSystem.GET(ServiceSetup."Tender Code System 2") THEN
          CodingSystem.MARK(TRUE);
      CodingSystem.MARKEDONLY(TRUE);
      IF PAGE.RUNMODAL(0, CodingSystem) = ACTION::LookupOK THEN
        TenderCodeSystemNo := CodingSystem."Coding System";

      ServiceSetup.GET;
      TenderDocumentCodeFRM.SetDefaults("No.", TenderCodeSystemNo);
      TenderDocumentCodeFRM.RUN;
    END;

    PROCEDURE SetBuildingCode@1100528600(IBuildingCode@1100528600 : Code[20]);
    BEGIN
      BuildingCode := IBuildingCode;
    END;

    PROCEDURE RefreshNumOfAddresses@1100409000();
    VAR
      ShiptoAddress@1100409000 : Record 222;
    BEGIN
      NumOfAddresses := ShiptoAddress.CheckAvailableAddress("Customer No.", 2);
    END;

    LOCAL PROCEDURE GetProjectInfoAccess@1100527650() : Boolean;
    VAR
      UserSetup@1100527650 : Record 91;
    BEGIN
      UserSetup.GET(USERID);
      EXIT(UserSetup."Access Proj.Info. on Serv.Loc.");
    END;

    LOCAL PROCEDURE SetEditable@1100527300();
    VAR
      Job@1100527300 : Record 11072003;
      DPTSetup@1100528300 : Record 11229823;
      FPSLicenseManagement@1100528301 : Codeunit 11229289;
    BEGIN
      Job.CHANGECOMPANY("Supplying Company");
      ProjectDescriptionEditable := NOT Job.GET("Project No.");

      IF (FPSLicenseManagement.LicenseAndReadPermissionForTable(DPTSetup)) THEN
        IF (DPTSetup.GET) THEN
          DPTVisible := DPTSetup."Use Location Portal";
    END;

    LOCAL PROCEDURE SetContactInfoEditable@1100530701();
    BEGIN
      IF Tenant = '' THEN
        ContactInfoEditable := TRUE
      ELSE
        ContactInfoEditable := FALSE;
    END;

    BEGIN
    END.
  }
}

