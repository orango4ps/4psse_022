OBJECT Page 140 Posted Purchase Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,DCNL14.00.00.5.00.08,4PS14.00,NAVNO,EXF,4PSSE;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Purchase Credit Memo;
               NOR=Bokfõrt kjõpskreditnota;
               SVE=Bokfîrd inkîpskreditnota];
    InsertAllowed=No;
    SourceTable=Table124;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Cancel,Navigate,Print/Send,Credit Memo,Approval;
                                NOR=Ny,Prosess,Rapport,Annullere,Naviger,Skriv ut / send,Kreditnota;
                                SVE=Ny,Process,Rapport,Annullera,Navigera,Skriv ut/skicka,Kreditnota];
    OnInit=BEGIN
             //**4PS.sn
             "Ext. Document IDEditable" := TRUE;
             "Ext. Document IDVisible" := TRUE;
             "Interest DateVisible" := TRUE;
             //**4PS.en
           END;

    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
                 lvInterestCalcMgtCU@1210190002 : Codeunit 11012049;
                 GeneralLedgerSetup@1100285100 : Record 98;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
                 IsFoundationEnabled := ApplicationAreaMgmtFacade.IsFoundationEnabled;

                 ActivateFields;

                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 //**4PS.sn
                 IF NOT lvInterestCalcMgtCU.PermissionInterestGranule() THEN
                   "Interest DateVisible" := FALSE;

                 PurchSetup.GET;
                 IF PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Other THEN BEGIN
                   "Ext. Document IDEditable" := FALSE;
                   "Ext. Document IDVisible" := FALSE;
                 END;
                 //**4PS.en

                 //4PSSE.NO
                 GeneralLedgerSetup.GET;
                 NORlocalizationEnable := GeneralLedgerSetup."Norwegian Localization Active";
               END;

    OnAfterGetRecord=VAR
                       CancelledDocument@1000 : Record 1900;
                     BEGIN
                       PurchCorrectiveCrMemoExists := CancelledDocument.FindPurchCorrectiveCrMemo("No.");

                       //**4PS.sn
                       IF gFromReference THEN BEGIN
                         gFromReference := FALSE;
                         CurrPage.PurchCrMemoLines.PAGE.InitSelectionFromReference(gInvLineNo);
                       END;
                       //**4PS.en
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnModifyRecord=BEGIN
                     //**4PS.sn
                     CODEUNIT.RUN(CODEUNIT::"Purch. Cr. Memo Header-Edit",Rec);
                     EXIT(FALSE);
                     //**4PS.en
                   END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                           RecRef@1100527300 : RecordRef;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("No.","Posting Date");
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           //**4PS.sn
                           SetControlAppearance;
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Shortcut Dimension 1 Code");

                           FillDocumentViewerFactbox;
                           //**4PS.en
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Credit Memo;
                                 NOR=Kredi&tnota;
                                 SVE=&Kreditnota];
                      Image=CreditMemo }
      { 8       ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 401;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category7 }
      { 47      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 66;
                      RunPageLink=Document Type=CONST(Posted Credit Memo),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category7 }
      { 79      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera mÜtt, till exempel omrÜde, projekt eller avdelning, som du kan tilldela till fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 88      ;2   ;Action    ;
                      AccessByPermission=TableData 456=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Approvals;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ShowPostedApprovalEntries(RECORDID);
                               END;
                                }
      { 924     ;2   ;Action    ;
                      Name=DocAttach;
                      CaptionML=[ENU=Attachments;
                                 NOR=Vedlegg;
                                 SVE=Bilagor];
                      ToolTipML=[ENU=Add a file as an attachment. You can attach images as well as documents.;
                                 NOR=Legg til en fil som vedlegg. Du kan legge ved bilderˇog dokumenter.;
                                 SVE=LÑgg till en fil som en bilaga. Du kan bifoga bilder och dokument.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Image=Attach;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1000 : Page 1173;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 12013592;2   ;Separator  }
      { 12013593;2   ;Action    ;
                      Name=<Action1100285004>;
                      ShortCutKey=Ctrl+I;
                      CaptionML=[ENU=Show document;
                                 SVE=Visa dokument];
                      Image=Document;
                      OnAction=BEGIN
                                 // ExFlow
                                 ExFlow.ShowImagePostedDoc(3,"No.");
                               END;
                                }
      { 12013594;2   ;Action    ;
                      Name=<Action1100285005>;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=Attached Fil&es;
                                 SVE=&Bilagor];
                      Image=Documents;
                      OnAction=BEGIN
                                 // ExFlow
                                 ExFlow.ShowAttachmentPostedDoc(3, "No.");
                               END;
                                }
      { 1100485001;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+S;
                      CaptionML=[ENU=Scanned Document;
                                 SVE=Skannade dokument];
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 lvPurchSetupRec@1100485003 : Record 312;
                               BEGIN
                                 lvPurchSetupRec.GET;
                                 lvPurchSetupRec.ShowScannedDocument(3,"No.","Buy-from Vendor No.","Ext. Document ID");
                               END;
                                }
      { 1210190020;2 ;Action    ;
                      CaptionML=[ENU=&Documents;
                                 SVE=&Dokument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1210190001;2 ;Action    ;
                      CaptionML=[ENU=ICF Specifications;
                                 SVE=ICF-specifikationer];
                      Promoted=Yes;
                      Image=ElectronicDoc;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowICFInvoiceLines;
                               END;
                                }
      { 1100285104;2 ;Action    ;
                      CaptionML=[ENU=Show &Documents;
                                 SVE=Visa &dokument];
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                                 SourceCodeSetup@1000000001 : Record 242;
                                 PurchInvHeader@1000000000 : Record 122;
                                 PurchCredHeader@1100285300 : Record 124;
                                 DocumentFilter@1000000003 : Record 11012073;
                                 GlobalTempDocumentProperties@1000000002 : TEMPORARY Record 11012746;
                               BEGIN
                                 //RFC136
                                 //160324
                                 SourceCodeSetup.GET;
                                 CASE "Source Code" OF
                                   SourceCodeSetup.Purchases,'':
                                     BEGIN
                                       IF PurchInvHeader.GET("No.") THEN
                                         RecRef.GETTABLE(PurchInvHeader)
                                       ELSE
                                         IF PurchCredHeader.GET("No.") THEN
                                           RecRef.GETTABLE(PurchCredHeader)
                                         ELSE
                                         RecRef.GETTABLE(Rec);
                                     END;
                                   ELSE
                                     RecRef.GETTABLE(Rec);
                                 END;

                                 DocumentFilters.CreateTemporaryFilter(RecRef, DocumentFilter);
                                 COMMIT;

                                 DocumentFilters.ApplyDocumentFilter(DocumentFilter, GlobalTempDocumentProperties);
                                 GlobalTempDocumentProperties.SETRANGE("From Filter Form", FALSE);
                                 CASE GlobalTempDocumentProperties.COUNT OF
                                   0:
                                     CASE RecRef.NUMBER OF
                                      122: BEGIN PurchInvHeader.SETRECFILTER; PurchInvHeader.PrintRecords(TRUE); END;
                                      124: BEGIN PurchCredHeader.SETRECFILTER; PurchCredHeader.PrintRecords(TRUE,FALSE); END;
                                     END;
                                   1:  GlobalTempDocumentProperties.OpenDocument;
                                   ELSE
                                   PAGE.RUNMODAL(0, GlobalTempDocumentProperties);
                                 END;
                               END;
                                }
      { 1100528205;2 ;ActionGroup;
                      CaptionML=[ENU=&Approval;
                                 SVE=&GodkÑnnanden];
                      Image=BOMLedger }
      { 1100528204;3 ;Action    ;
                      CaptionML=[ENU=Approval Entries;
                                 SVE=GodkÑnnandetransaktioner];
                      RunObject=Page 658;
                      RunPageView=WHERE(Table ID=CONST(124));
                      RunPageLink=Document No.=FIELD(No.);
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExist;
                      Image=BOMLedger;
                      PromotedCategory=Category8 }
      { 1100528203;3 ;Action    ;
                      CaptionML=[ENU=Approval Comments;
                                 SVE=GodkÑnnandekommentarer];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExist;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalEntry@1100525000 : Record 454;
                                 ApprovalCommentLine@1100525001 : Record 455;
                               BEGIN
                                 //**4PS
                                 IF OpenApprovalEntriesExist THEN BEGIN
                                   //ApprovalManagement4PSConstr.FilterApprovalEntryOpen(3, "No.", ApprovalEntry, FALSE);//**4PS C049344.o
                                   ApprovalManagement4PSConstr.FilterApprovalEntryOpen(DATABASE::"Purch. Cr. Memo Hdr.", 3, "No.", ApprovalEntry, FALSE);//**4PS C049344.n
                                   ApprovalCommentLine.SETRANGE("Table ID", DATABASE::"Purch. Cr. Memo Hdr.");
                                   ApprovalCommentLine.SETRANGE("Record ID to Approve", RECORDID);
                                   ApprovalCommentLine."Workflow Step Instance ID" := ApprovalEntry."Workflow Step Instance ID";
                                   ApprovalManagement4PSConstr.DrillDownApprovalCommentsHdr(ApprovalEntry,ApprovalCommentLine);
                                 END;
                               END;
                                }
      { 1100528202;3 ;Action    ;
                      CaptionML=[ENU=Posted Approval Entries;
                                 SVE=Bokfîrda godkÑnnandetransaktioner];
                      RunObject=Page 659;
                      RunPageView=WHERE(Table ID=CONST(124));
                      RunPageLink=Document No.=FIELD(No.);
                      Promoted=Yes;
                      Image=BOMLedger;
                      PromotedCategory=Category8 }
      { 1100528201;3 ;Action    ;
                      CaptionML=[ENU=Posted Approval Comments;
                                 SVE=Bokfîrda godkÑnnandekommentarer];
                      RunObject=Page 661;
                      RunPageView=WHERE(Table ID=CONST(124));
                      RunPageLink=Document No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedCategory=Category8 }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 15      ;1   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverandõren i kjõpsdokumentet.;
                                 SVE=Visa eller redigera detaljerad information om leverantîren pÜ inkîpsdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Image=Vendor;
                      PromotedCategory=Category5 }
      { 48      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut;
                                 SVE=Skriv &ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargjõr for Ü skrive ut dokumentet. Det vises et rapportforespõrselsvindu for dokumentet der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Fîrbered utskrift av dokumentet. Ett rapportfînster om dokumentet îppnas dÑr det gÜr att ange vad du vill inkludera pÜ utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchCrMemoHeader);
                                 //PurchCrMemoHeader.PrintRecords(TRUE); //**4PS.o
                                 PurchCrMemoHeader.PrintRecords(TRUE,TRUE); //**4PS.n
                               END;
                                }
      { 49      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger;
                                 SVE=Anal&ysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppfõringer og dokumenter som finnes for dokumentnummeret og bokfõringsdatoen i den valgte oppfõringen eller dokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet fîr den valda transaktionen eller det valda dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Annullera] }
      { 24      ;2   ;Action    ;
                      Name=CancelCrMemo;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Annullera];
                      ToolTipML=[ENU=Create and post a purchase invoice that reverses this posted purchase credit memo. This posted purchase credit memo will be canceled.;
                                 NOR=Opprett og bokfõr en kjõpsfaktura som tilbakefõrer denne bokfõrte kjõpskreditnotaen. Denne bokfõrte kjõpskreditnotaen vil bli annullert.;
                                 SVE=Skapa och bokfîr en inkîpsfaktura som Üterfîr den hÑr bokfîrda inkîpskreditnotan. Den hÑr bokfîrda inkîpskreditnotan annulleras.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsFoundationEnabled;
                      Enabled=PurchCorrectiveCrMemoExists;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Cancel PstdPurchCrM (Yes/No)",Rec);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=ShowInvoice;
                      CaptionML=[ENU=Show Canceled/Corrective Invoice;
                                 NOR=Vis annullert/korrigerende faktura;
                                 SVE=Visa annullerad/korrigerande faktura];
                      ToolTipML=[ENU=Open the posted sales invoice that was created when you canceled the posted sales credit memo. If the posted sales credit memo is the result of a canceled sales invoice, then canceled invoice will open.;
                                 NOR=èpne den bokfõrte salgsfakturaen som ble opprettet da du kansellerte den bokfõrte salgskreditnotaen. Hvis den bokfõrte salgskreditnotaen er et resultat av den kansellerte salgsfakturaen, sÜ vil den kansellerte fakturaen bli Üpnet.;
                                 SVE=ôppna den bokfîrda fîrsÑljningsfakturan som skapades nÑr du annullerade den bokfîrda fîrsÑljningskreditnotan. Om den bokfîrda fîrsÑljningskreditnotan Ñr resultatet av en annullerad fîrsÑljningsfaktura, îppnas den annullerade fakturan.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsFoundationEnabled;
                      Enabled=Cancelled OR Corrective;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrInvoice;
                               END;
                                }
      { 1100528410;1 ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 SVE=GodkÑnnande] }
      { 1100528411;2 ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 SVE=GodkÑnn];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                                 ApprovalEntry@1100528200 : Record 454;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                                 //**4PS.sn
                                 IF NOT ApprovalsMgmt.FindOpenApprovalEntryForCurrUser(ApprovalEntry,RECORDID) THEN
                                   MARK(FALSE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 1100528408;2 ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 SVE=Avvisa];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528409;2 ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 SVE=Delegera];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 1100528406;2 ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 SVE=Kommentarer];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalEntry@1100525001 : Record 454;
                                 ApprovalCommentLine@1100525000 : Record 455;
                               BEGIN
                                 //**4PS
                                 IF OpenApprovalEntriesExist THEN BEGIN
                                   //ApprovalManagement4PSConstr.FilterApprovalEntryOpen(3, "No.", ApprovalEntry, FALSE);//**4PS C049344.o
                                   ApprovalManagement4PSConstr.FilterApprovalEntryOpen(DATABASE::"Purch. Cr. Memo Hdr.", 3, "No.", ApprovalEntry, FALSE);//**4PS C049344.n
                                   ApprovalCommentLine.SETRANGE("Table ID", DATABASE::"Purch. Cr. Memo Hdr.");
                                   ApprovalCommentLine.SETRANGE("Document No.", "No.");
                                   ApprovalCommentLine.SETRANGE("Record ID to Approve", RECORDID);
                                   ApprovalCommentLine."Workflow Step Instance ID" := ApprovalEntry."Workflow Step Instance ID";
                                   ApprovalManagement4PSConstr.DrillDownApprovalCommentsHdr(ApprovalEntry,ApprovalCommentLine);
                                 END;
                               END;
                                }
      { 1100525001;2 ;Action    ;
                      CaptionML=[ENU=&On Hold;
                                 SVE=S&toppad];
                      Promoted=Yes;
                      Visible=FALSE;
                      PromotedIsBig=Yes;
                      Image=Lock;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsBridge4PSConstruct@1100525000 : Codeunit 11125348;
                               BEGIN
                                 ApprovalsBridge4PSConstruct.OnHold(Rec);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100528407;1 ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 SVE=BegÑr godkÑnnande];
                      Image=Action }
      { 1100528404;2 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalManagement4PSConstr@1100528400 : Codeunit 11125349;
                                 ApprovalsBridge4PSConstruct@1100528401 : Codeunit 11125348;
                               BEGIN
                                 ApprovalManagement4PSConstr.CheckPostedPurchaseCreditMemoApprovalsWorkflowEnabled(Rec);
                                 ApprovalsBridge4PSConstruct.OnSendPostedPurchaseCreditMemoForApproval(Rec);
                               END;
                                }
      { 1100528405;2 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      Image=Cancel;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsBridge4PSConstruct@1100528400 : Codeunit 11125348;
                               BEGIN
                                 ApprovalsBridge4PSConstruct.OnCancelPostedPurchaseCreditMemoApprovalRequest(Rec);
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 11      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inngÜende dokument;
                                 SVE=Visa inkommande dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppfõringen eller dokumentet.;
                                 SVE=Visa alla poster med inkommande dokument och filbilagor som finns fîr transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inngÜende dokument;
                                 SVE=VÑlj inkommande dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppfõringen eller dokumentet.;
                                 SVE=VÑlj en inkommande dokumentpost och en filbilaga som du vill koppla till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("No.","Posting Date",RECORDID);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inngÜende dokument fra fil;
                                 SVE=Skapa inkommande dokument frÜn fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved Ü velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppfõringen eller dokumentet.;
                                 SVE=Skapa en post fîr inkommande dokument genom att vÑlja en fil att bifoga. Koppla sedan posten fîr det inkommande dokumentet till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("No.","Posting Date");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted credit memo number.;
                           NOR=Angir nummeret pÜ den bokfõrte kreditnotaen.;
                           SVE=Anger numret pÜ den bokfîrda kreditnotan.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 51  ;2   ;Field     ;
                CaptionML=[ENU=Vendor;
                           NOR=Leverandõr;
                           SVE=Leverantîr];
                ToolTipML=[ENU=Specifies the name of the vendor who shipped the items.;
                           NOR=Angir navnet pÜ leverandõren som leverte varene.;
                           SVE=Anger namnet pÜ leverantîren som levererade artiklarna.];
                ApplicationArea=#All;
                SourceExpr="Buy-from Vendor Name";
                TableRelation=Vendor.Name;
                Importance=Promoted;
                Editable=FALSE }

    { 1100485010;2;Field  ;
                SourceExpr="Related Purch. Order No.";
                Editable=FALSE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kjõp fra;
                           SVE=Kîp frÜn];
                GroupType=Group }

    { 53  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor who shipped the items.;
                           NOR=Angir adressen til leverandõren som leverte varene.;
                           SVE=Anger adressen till leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable=FALSE }

    { 55  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 57  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                Editable=FALSE }

    { 37  ;3   ;Group     ;
                Visible=IsBuyFromCountyVisible;
                GroupType=Group }

    { 25  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from County";
                Importance=Additional;
                Editable=FALSE }

    { 6   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 35  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the ship-to address.;
                           NOR=Angir lands- eller omrÜdekoden for lever til-adressen.;
                           SVE=Anger land eller region i leveransadressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Country/Region Code";
                Importance=Additional;
                Editable=FALSE }

    { 91  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the contact who you sent the purchase credit memo to.;
                           NOR=Angir nummeret til kontakten som du sendte kjõpskreditnotaen til.;
                           SVE=Anger numret fîr kontakten som du skickade inkîpskreditnotan till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 59  ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact at the vendor who shipped the items.;
                           NOR=Angir navnet pÜ kontaktpersonen hos den leverandõren som leverte varene.;
                           SVE=Anger namnet pÜ kontaktpersonen hos leverantîren som levererade artiklarna.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 1101200000;2;Field  ;
                SourceExpr="Subcontractor Credit Memo";
                Editable=FALSE }

    { 1100285105;2;Field  ;
                SourceExpr="Reference (Vendor)";
                Editable=false }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date the credit memo was posted.;
                           NOR=Angir datoen da kreditnotaen ble bokfõrt.;
                           SVE=Anger datumet nÑr kreditnotan bokfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the purchase document was created.;
                           NOR=Angir datoen da kjõpsdokumentet ble opprettet.;
                           SVE=Anger datumet nÑr inkîpsdokumentet skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the credit memo that the posted credit memo was created from.;
                           NOR=Angir nummeret pÜ kreditnotaen som den bokfõrte kreditnotaen ble opprettet fra.;
                           SVE=Anger numret pÜ kreditnotan frÜn vilken den bokfîrda kreditnotan skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pre-Assigned No.";
                Importance=Additional;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's number for this credit memo.;
                           NOR=Angir leverandõrnummeret for denne kreditnotaen.;
                           SVE=Anger leverantîrens nummer fîr den hÑr kreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Cr. Memo No.";
                Importance=Promoted;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order address of the related vendor.;
                           NOR=Angir bestillingsadressen for den relaterte leverandõren.;
                           SVE=Anger den relaterade leverantîrens orderadress.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Address Code";
                Editable=FALSE }

    { 1100528207;2;Field  ;
                SourceExpr="Approval Code" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is assigned to the vendor.;
                           NOR=Angir hvilken innkjõper som er knyttet til leverandõren.;
                           SVE=Anger vilken inkîpare som Ñr kopplad till leverantîren.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                Editable=FALSE }

    { 1210190002;2;Field  ;
                SourceExpr="On Hold";
                Editable=FALSE }

    { 1100528403;2;Field  ;
                CaptionML=[ENU=Approval by User;
                           SVE=GodkÑnnande av anvÑndare];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApprover(RECORDID,0);
                Editable=FALSE }

    { 1100528402;2;Field  ;
                CaptionML=[ENU=Approval by User Name;
                           SVE=GodkÑnnande av anvÑndarnamn];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApproverName(RECORDID,0);
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the responsibility center that serves the vendor on this purchase document.;
                           NOR=Angir koden for ansvarssenteret som betjener leverandõren pÜ dette kjõpsdokumentet.;
                           SVE=Anger koden fîr ansvarsenheten som ansvarar fîr leverantîren i det hÑr inkîpsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice that relates to this purchase credit memo has been either corrected or canceled.;
                           NOR=Angir om den bokfõrte kjõpsfakturaen som er knyttet til denne kjõpskreditnotaen, er blitt korrigert eller kansellert.;
                           SVE=Anger om den bokfîrda inkîpsfakturan som relaterar till den hÑr inkîpskreditnotan har rÑttats eller annullerats.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveInvoice;
                            END;
                             }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice has been either corrected or canceled by this purchase credit memo .;
                           NOR=Angir om den bokfõrte kjõpsfakturaen er blitt korrigert eller kansellert av denne kjõpskreditnotaen.;
                           SVE=Anger om den bokfîrda inkîpsfakturan har rÑttats eller annullerats av den hÑr inkîpskreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledInvoice;
                            END;
                             }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the document has been printed.;
                           NOR=Angir hvor mange ganger dokumentet har blitt skrevet ut.;
                           SVE=Anger hur mÜnga gÜnger dokumentet har skrivits ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed";
                Importance=Additional;
                Editable=FALSE }

    { 1100527301;2;Field  ;
                AccessByPermission=Codeunit 6085578=X;
                CaptionML=ENU=No. of Documents (DC);
                SourceExpr=DocMgt.GetNoOfDocForDoc(DATABASE::"Purchase Header",3,"No.",0);
                Visible=FALSE;
                OnDrillDown=BEGIN
                              DocMgt.LookupDocsForDoc(DATABASE::"Purchase Header", 3, "No.", 0)
                            END;
                             }

    { 1210190000;2;Field  ;
                SourceExpr="Approvement Initials";
                Editable=FALSE }

    { 1100528400;2;Field  ;
                SourceExpr="Job No.";
                Importance=Additional;
                Editable=FALSE }

    { 1100528401;2;Field  ;
                SourceExpr="Service Order No.";
                Importance=Additional;
                Editable=FALSE }

    { 12013587;2;Field    ;
                SourceExpr=Approve;
                Editable=False }

    { 44  ;1   ;Part      ;
                Name=PurchCrMemoLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page141 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer;
                           SVE=Fakturadetaljer];
                GroupType=Group }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code used to calculate the amounts on the credit memo.;
                           NOR=Angir valutakoden som er brukt til Ü beregne belõpene i kreditnotaen.;
                           SVE=Anger valutakoden som anvÑnds fîr att berÑkna beloppen pÜ kreditnotan.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=VAR
                               UpdateCurrencyFactor@1000 : Codeunit 325;
                             BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.SetAdditionalParameters(1, "Job No.", FALSE); //**4PS.n
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 UpdateCurrencyFactor.ModifyPostedPurchaseCreditMemo(Rec);
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Importance=Additional;
                Editable=FALSE;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Importance=Additional;
                Editable=FALSE;
                LookupPageID=Cost Object List }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location used when you posted the credit memo.;
                           NOR=Angir koden for lokasjonen som er brukt i bokfõringen av kreditnotaen.;
                           SVE=Anger koden fîr lagerstÑllet som anvÑndes nÑr du bokfîrde kreditnotan.];
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir typen bokfõrt dokument som dette dokumentet eller denne kladdelinjen blir utlignet til nÜr du bokfõrer, for eksempel for Ü registrere utbetaling.;
                           SVE=Anger typen fîr det bokfîrda dokument som den hÑr dokument- eller journalraden tillÑmpas pÜ nÑr du bokfîr, t.ex. fîr att registrera en betalning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. Type";
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir nummeret for det bokfõrte dokumentet som dette dokumentet eller denne kladdelinjen blir utlignet til nÜr du bokfõrer, for eksempel for Ü registrere utbetaling.;
                           SVE=Anger numret pÜ det bokfîrda dokument som den hÑr dokument- eller journalraden tillÑmpas pÜ nÑr du bokfîr, t.ex. fîr att registrera en betalning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. No.";
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling;
                           SVE=Leverans och betalning];
                GroupType=Group }

    { 19  ;2   ;Group     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til;
                           SVE=Leverans];
                GroupType=Group }

    { 34  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the company at the address to which the items in the purchase order were shipped.;
                           NOR=Angir navnet pÜ selskapet med adressen som varene i bestillingen ble levert til.;
                           SVE=Anger namnet pÜ fîretaget som finns pÜ adressen dit inkîpsorderns artiklar levererades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address that the items in the purchase order were shipped to.;
                           NOR=Angir adressen du vil at varene i bestillingen ble levert til.;
                           SVE=Anger adressen dit artiklarna pÜ inkîpsordern levererades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 43  ;3   ;Group     ;
                Visible=IsShipToCountyVisible;
                GroupType=Group }

    { 39  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 41  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the ship-to address.;
                           NOR=Angir lands- eller omrÜdekoden for lever til-adressen.;
                           SVE=Anger land eller region i leveransadressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person at the address that the items were shipped to.;
                           NOR=Angir navnet pÜ en kontaktperson pÜ adressen som varene ble levert til.;
                           SVE=Anger namnet pÜ en kontaktpersonen pÜ adressen som artiklarna levererades till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 17  ;2   ;Group     ;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til;
                           SVE=Betalas];
                GroupType=Group }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the vendor that you received the credit memo from.;
                           NOR=Angir navnet pÜ leverandõren som du har mottatt kreditnotaen fra.;
                           SVE=Anger namnet pÜ leverantîren som du mottog kreditnotan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor that you received the credit memo from.;
                           NOR=Angir adressen til leverandõren som du har mottatt kreditnotaen fra.;
                           SVE=Anger adressen till leverantîren som du mottog kreditnotan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor on the purchase document.;
                           NOR=Angir bostedet for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens ort i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional;
                Editable=FALSE }

    { 46  ;3   ;Group     ;
                Visible=IsPayToCountyVisible;
                GroupType=Group }

    { 50  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to County";
                Importance=Additional;
                Editable=FALSE }

    { 70  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 52  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the ship-to address.;
                           NOR=Angir lands- eller omrÜdekoden for lever til-adressen.;
                           SVE=Anger land eller region i leveransadressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Country/Region Code";
                Importance=Additional;
                Editable=FALSE }

    { 93  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the contact at the vendor who handles the credit memo.;
                           NOR=Angir nummeret til kontakten hos leverandõren som behandler kreditnotaen.;
                           SVE=Anger kontaktnumret till leverantîren som hanterar kreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 32  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person you should contact at the vendor who you received the credit memo from.;
                           NOR=Angir navnet pÜ kontaktperson hos leverandõren som du mottok kreditnotaen fra.;
                           SVE=Anger namnet pÜ kontaktpersonen hos leverantîren som du mottog kreditnotan frÜn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Editable=FALSE }

    { 1101200002;2;Field  ;
                SourceExpr="Your Reference";
                Editable=FALSE }

    { 1100525000;2;Field  ;
                SourceExpr="Reason Code";
                Editable=FALSE }

    { 1100525003;2;Field  ;
                SourceExpr="Ext. Document ID";
                Visible="Ext. Document IDVisible";
                Editable="Ext. Document IDEditable" }

    { 1210190004;2;Field  ;
                SourceExpr="Interest Date";
                Visible="Interest DateVisible";
                Editable=FALSE }

    { 1100285103;2;Field  ;
                SourceExpr=KID;
                Visible=NORlocalizationEnable }

    { 1100285102;2;Field  ;
                SourceExpr="Payment Reference" }

    { 1100285100;2;Field  ;
                SourceExpr="Export to Symbrio";
                Importance=Additional }

    { 1100285101;2;Field  ;
                SourceExpr="Export to Symbrio Type";
                Importance=Additional }

    { 1100485018;2;Field  ;
                SourceExpr="Company VAT Registration No.";
                Editable=FALSE }

    { 1100485016;2;Field  ;
                SourceExpr="VAT Registration No.";
                Editable=FALSE }

    { 1100485013;2;Field  ;
                SourceExpr="Country/Region of Origin";
                Editable=FALSE }

    { 1100485012;2;Field  ;
                SourceExpr="Country/Region of Destination";
                Editable=FALSE }

    { 1905403901;1;Group  ;
                CaptionML=[ENU=Subcontracting;
                           SVE=UE] }

    { 1070000;2;Field     ;
                ToolTipML=[ENU=Specifies whether the purchase credit memo was involved in an EU 3-party trade.;
                           SVE=Anger om inkîpskreditnotan ingick i en EU trepartshandel.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="EU 3-Party Trade";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Payment Agreement";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Actual Effective Date";
                Editable=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Actual End Date";
                Editable=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Number of Hours";
                Editable=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Avg. Wage Rate";
                Editable=FALSE }

    { 1000000010;2;Field  ;
                SourceExpr="Labor Amount";
                Editable=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="Contribution Percentage Labor";
                Editable=FALSE }

    { 1210190013;2;Field  ;
                SourceExpr="Contribution Percentage Total";
                Editable=FALSE }

    { 1100528200;2;Field  ;
                SourceExpr="Fixed B Amount per Hour";
                Editable=FALSE }

    { 1000000022;2;Field  ;
                SourceExpr="Pay To Tax Authority";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000014;2;Field  ;
                SourceExpr="Wage Charge (to B Account)";
                Editable=FALSE }

    { 1000000016;2;Field  ;
                SourceExpr="Wage Charge (to Tax Authority)";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000018;2;Field  ;
                SourceExpr="Nat.Ins.Contr.";
                Editable=FALSE }

    { 1100529601;2;Field  ;
                SourceExpr="Pay VAT Amt. on B-Acc. Vendor";
                Editable=FALSE }

    { 1000000020;2;Field  ;
                SourceExpr=Text;
                Editable=FALSE;
                MultiLine=Yes }

    { 1903447101;1;Group  ;
                CaptionML=[ENU=DMS;
                           SVE=DMS] }

    { 1210190015;2;Field  ;
                SourceExpr="DMS Status";
                Importance=Promoted }

    { 1210190017;2;Field  ;
                SourceExpr="DMS Status Text" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 33  ;1   ;Part      ;
                Name=Attached Documents;
                CaptionML=[ENU=Attachments;
                           NOR=Vedlegg;
                           SVE=Bilagor];
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(124),
                            No.=FIELD(No.);
                PagePartID=Page1174;
                PartType=Page }

    { 1100528206;1;Part   ;
                Name=CaptureUI;
                CaptionML=[ENU=DC Document;
                           SVE=DC Dokument];
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11126597;
                Visible=FALSE }

    { 3   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190003;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130208;
                PartType=Page }

    { 1100528414;1;Part   ;
                SubPageLink=Table ID=CONST(124),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100528413;1;Part   ;
                SubPageLink=Table ID=CONST(124),
                            Document No.=FIELD(No.);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1100528412;1;Part   ;
                Name=WorkflowStatus;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

    { 1100528500;1;Part   ;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page9104;
                Visible=FALSE;
                PartType=Page }

    { 1100528100;1;Part   ;
                Name=DocumentViewerDocument;
                CaptionML=ENU=Document Viewer Documents;
                PagePartID=Page11129746;
                Visible=FALSE;
                PartType=Page }

    { 1100528101;1;Part   ;
                Name=DocumentViewer;
                CaptionML=ENU=Document Viewer;
                SubPageLink=Source Type=FIELD(Source Type),
                            No.=FIELD(No.),
                            Description=FIELD(Description);
                PagePartID=Page11129745;
                ProviderID=1100528100;
                Visible=FALSE;
                PartType=Page }

  }
  CODE
  {
    VAR
      PurchCrMemoHeader@1000 : Record 124;
      ApplicationAreaMgmtFacade@1004 : Codeunit 9179;
      FormatAddress@1010 : Codeunit 365;
      ChangeExchangeRate@1001 : Page 511;
      HasIncomingDocument@1002 : Boolean;
      IsOfficeAddin@1003 : Boolean;
      IsFoundationEnabled@1005 : Boolean;
      PurchCorrectiveCrMemoExists@1006 : Boolean;
      IsBuyFromCountyVisible@1009 : Boolean;
      IsPayToCountyVisible@1008 : Boolean;
      IsShipToCountyVisible@1007 : Boolean;
      gFromReference@1210190000 : Boolean;
      gInvLineNo@1210190001 : Integer;
      PurchSetup@1100525000 : Record 312;
      DPA_IsHardFilter@1100000999 : Boolean;
      "Interest DateVisible"@19029017 : Boolean INDATASET;
      "Ext. Document IDVisible"@19068947 : Boolean INDATASET;
      "Ext. Document IDEditable"@19001168 : Boolean INDATASET;
      OpenApprovalEntriesExist@1100528402 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1100528401 : Boolean;
      ApprovalManagement4PSConstr@1100528400 : Codeunit 11125349;
      ShowWorkflowStatus@1100528403 : Boolean;
      DocMgt@1100527300 : Codeunit 6085578;
      "*** ExFlow ***"@12013589 : Integer;
      ExFlow@12013590 : Codeunit 12013601;
      NORlocalizationEnable@1100285100 : Boolean INDATASET;
      CanCancelApprovalForRecord@1100527301 : Boolean;

    LOCAL PROCEDURE ActivateFields@6();
    BEGIN
      IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
      IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
      IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
    END;

    PROCEDURE InitSelectionFromReference@1210190002(IInvLineNo@1210190000 : Integer);
    BEGIN
      //**4PS.n
      gFromReference := TRUE;
      gInvLineNo := IInvLineNo;
    END;

    PROCEDURE ShowICFInvoiceLines@1210190000();
    VAR
      ICFLineRec@1210190000 : Record 11012327;
    BEGIN
      //**4PS
      ICFLineRec.RESET;
      ICFLineRec.SETRANGE(Vendor, "Pay-to Vendor No.");
      ICFLineRec.SETRANGE("Invoice No.", "Pre-Assigned No.");
      IF ICFLineRec.FIND('-') THEN
        PAGE.RUNMODAL(PAGE::"ICF Invoices", ICFLineRec);
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1000 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID); //**4PS.n
    END;

    LOCAL PROCEDURE FillDocumentViewerFactbox@1100528100();
    VAR
      DocumentLinkManagement@1100528100 : Codeunit 11012401;
      DocumentProperties@1100528101 : Record 11012746;
      DocumentAttachmentMgt@1100528102 : Codeunit 6085602;
      TempDocument@1100528103 : Record 6085756;
      EmptyRecID@1100528104 : RecordID;
      DocumentViewerTempDoc@1100528105 : Record 11072460;
    BEGIN
      CurrPage.DocumentViewerDocument.PAGE.ResetPage;
      DocumentLinkManagement.GetDocuments(DocumentProperties, RECORDID.GETRECORD);
      DocumentProperties.MARKEDONLY(TRUE);
      CurrPage.DocumentViewerDocument.PAGE.SetExternal4PSDocuments(DocumentProperties);

      CASE PurchSetup."Scanning Application Purch.Inv" OF
        PurchSetup."Scanning Application Purch.Inv"::"Document Capture":
          BEGIN
            DocumentAttachmentMgt.CreateTempDocumentList(TempDocument, EmptyRecID, DATABASE::"Purch. Cr. Memo Hdr.", 0, "No.", 0, TRUE);
            CurrPage.DocumentViewerDocument.PAGE.SetDocumentCaptureDocuments(TempDocument);
            IF "Ext. Document ID" <> '' THEN BEGIN
              CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::DocumentCapture, "Ext. Document ID");
            END ELSE
              CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::DocumentCapture, '');
          END;
        PurchSetup."Scanning Application Purch.Inv"::Whitevision:
          BEGIN
            CurrPage.DocumentViewerDocument.PAGE.SetWhiteVisionDocumentUsingPurchCrMemoHdr(Rec);
            CurrPage.DocumentViewerDocument.PAGE.SetSelectedDocument(DocumentViewerTempDoc."Source Type"::WhiteVision, '');
          END;
      END;

      CurrPage.DocumentViewer.PAGE.SetEmailSubject("No.");
    END;

    BEGIN
    {
      <DC>
        Document Capture, removed by 4PS
      </DC>
      4PS 24-09-2009 PS, Approval removed
      4PS 30-03-18 DP01917 OLKOL: Action Approve changed
      --- ExFlow --->
      Field General : Approve
      Action        : Show Document (Code)
      Action        : Attached Files (Code)
      Globals
      <-- ExFlow ---
      160817 ITERO.DL RFC125 new fields, KID, "Payment Reference NO"
      160909 ITERO.DL RFC136 view attached documents (from Symbrio) if no doc then print report
    }
    END.
  }
}

