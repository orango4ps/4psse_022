OBJECT Page 11012149 Small Project
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Kleinprojekt;
               ENU=Small Project Card;
               NLD=Klusproject;
               NOR=Lite prosjekt-kort;
               SVE=Kort fîr mindre projekt];
    SourceTable=Table11072003;
    SourceTableView=WHERE(Small Project=CONST(Yes));
    PageType=Card;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             "Cost Component PlantEditable" := TRUE;
             "Plant No.Editable" := TRUE;
             "Plant TypeEditable" := TRUE;
             FunctionsBtnVisible := TRUE;
             ProjectBtnVisible := TRUE;
             BillToCustBmpVisible := TRUE;
             BillToCustInfoVisible := TRUE;
             "Plant LocationEditable" := TRUE;
             "Plant Job OrderEditable" := TRUE;
             SalaryAppLosaCobra := TRUE;
             "Main ProjectEditable" := TRUE;
             "% to B AccountEditable" := TRUE;
             "% LaborEditable" := TRUE;
           END;

    OnOpenPage=VAR
                 HumanResourcesSetup@1100525000 : Record 5218;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 SalaryAppLosaCobra := HumanResourcesSetup.SalaryApplicationIsLosaCobra;

                 IF gCreateFromPlantLoc THEN BEGIN
                   "Plant Job OrderEditable" := FALSE;
                   "Plant LocationEditable" := FALSE;
                 END;
               END;

    OnAfterGetRecord=VAR
                       lvAppRec@1210190000 : Record 11012081;
                     BEGIN
                       lvAppRec.SETRANGE("Project No.","No.");
                       IF lvAppRec.FINDFIRST THEN
                         AppPresBln := TRUE
                       ELSE
                         AppPresBln := FALSE;

                       FillActionByName();

                       CALCFIELDS("Urgency Description","Response Time",Prospect);

                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  "Small Project" := TRUE;
                  "Project Status" := "Project Status"::Production;
                  "Settlement Method" := "Settlement Method"::"Cost Plus";
                  OperText := '';
                  IF gCreateFromPlantLoc THEN
                    FillDefaultFromPlantLocation();
                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 58      ;1   ;ActionGroup;
                      Name=ProjectBtn;
                      CaptionML=[DEU=Kleinp&rojekt;
                                 ENU=Small &Project;
                                 NLD=Klusp&roject;
                                 NOR=Lite &prosjekt;
                                 SVE=Mindre &projekt];
                      Visible=ProjectBtnVisible }
      { 62      ;2   ;Action    ;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments;
                                 NLD=Op&merkingen;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Job),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 60      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[DEU=&Posten;
                                 ENU=Ledger E&ntries;
                                 NLD=Poste&n;
                                 NOR=&Transaksjoner;
                                 SVE=Tra&nsaktioner];
                      RunObject=Page 11072005;
                      RunPageView=SORTING(Job No.,Posting Date);
                      RunPageLink=Job No.=FIELD(No.);
                      Image=LedgerEntries }
      { 1100529900;2 ;ActionGroup;
                      CaptionML=[DEU=Projekttabellen;
                                 ENU=Project Tables;
                                 NLD=Project tabellen;
                                 NOR=Prosjekttabeller;
                                 SVE=Projekttabeller];
                      Image=ExecuteBatch }
      { 84      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions;
                                 NLD=Dimensies;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(11072003),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 1000000012;3 ;Action    ;
                      CaptionML=[DEU=Auftraggeber;
                                 ENU=Principals;
                                 NLD=Opdrachtgevers;
                                 NOR=oppdragsgiver;
                                 SVE=Uppdragsgivare];
                      Image=TeamSales;
                      OnAction=BEGIN
                                 ProjPrincipRec.RESET;
                                 ProjPrincipRec.SETRANGE("Project No.","No.");
                                 IF "Bill-to Customer No." <> '' THEN
                                   IF NOT ProjPrincipRec.GET("No.", "Bill-to Customer No.") THEN
                                     ProjPrincipRec.SETRANGE(Principal, "Bill-to Customer No.");
                                 PAGE.RUN(PAGE::"Project Principal",ProjPrincipRec);
                               END;
                                }
      { 1100485001;3 ;Action    ;
                      CaptionML=[DEU=&Projekt Instanzen;
                                 ENU=&Project Authorities;
                                 NLD=&Project instanties;
                                 NOR=&Prosjektledelse;
                                 SVE=&Projektmyndigheter];
                      RunObject=Page 11020231;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=IndustryGroups }
      { 1210190014;3 ;Action    ;
                      CaptionML=[DEU=Teilprojekte;
                                 ENU=Sub Projects;
                                 NLD=Dee&lprojecten;
                                 NOR=Underprosjekter;
                                 SVE=Underprojekt];
                      Image=Splitlines;
                      OnAction=VAR
                                 JobRec@1210190000 : Record 11072003;
                               BEGIN
                                 JobRec.SETRANGE("Single/Main/Sub Project", "Single/Main/Sub Project"::"Sub Project");
                                 JobRec.SETRANGE("Main Project", "No.");
                                 IF JobRec.FINDFIRST THEN
                                   PAGE.RUNMODAL(PAGE::"Job List", JobRec)
                                 ELSE
                                   MESSAGE(Text11012000);
                               END;
                                }
      { 1100485094;3 ;Action    ;
                      CaptionML=[DEU=&AktivitÑten;
                                 ENU=&Activities;
                                 NLD=&Activiteiten;
                                 NOR=&Aktiviteter;
                                 SVE=&Aktiviteter];
                      Image=JobTimeSheet;
                      OnAction=BEGIN
                                 ShowTodos;
                               END;
                                }
      { 1210190048;3 ;Action    ;
                      CaptionML=[DEU=Allgemeine Vereinbarungen;
                                 ENU=Common Agreements;
                                 NLD=Algemene afspraken;
                                 NOR=Felles avtaler;
                                 SVE=Gemensamma avtal];
                      RunObject=Page 11020311;
                      RunPageView=WHERE(Appointment Type=CONST(General));
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Agreement }
      { 1210190074;3 ;Action    ;
                      CaptionML=[DEU=ArbeitsgÑnge;
                                 ENU=Operations;
                                 NLD=Bewerkingen;
                                 NOR=Operasjoner;
                                 SVE=Operationer];
                      RunObject=Page 11012283;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Design }
      { 1100525017;3 ;Action    ;
                      CaptionML=[DEU=&Merkmale;
                                 ENU=&Features;
                                 NLD=&Kenmerken;
                                 NOR=&Funksjoner;
                                 SVE=&Funktioner];
                      Image=QualificationOverview;
                      OnAction=BEGIN
                                 ShowFeatures;
                               END;
                                }
      { 1100525005;3 ;Action    ;
                      CaptionML=[DEU=Wechselkurse;
                                 ENU=Exchange Rates;
                                 NLD=Wisselkoersen;
                                 NOR=Valutakurser;
                                 SVE=Byt avgifter];
                      RunObject=Page 11124939;
                      RunPageLink=Project Filter=FIELD(No.);
                      Image=AdjustExchangeRates }
      { 1210190007;2 ;Action    ;
                      CaptionML=[DEU=&Belege;
                                 ENU=Do&cuments;
                                 NLD=Do&cumenten;
                                 NOR=Do&kumenter;
                                 SVE=Do&kument];
                      Image=Documents;
                      OnAction=BEGIN
                                 OpenDocumentList;
                               END;
                                }
      { 1100527001;2 ;Action    ;
                      CaptionML=[DEU=ArbeitsauftrÑge;
                                 ENU=Work Orders;
                                 NLD=Werkorders;
                                 SVE=Arbetsordrar];
                      Image=HRSetup;
                      OnAction=VAR
                                 Proj@1100529000 : Record 11072003;
                               BEGIN
                                 Proj.ShowWorkOrders("No.", '');
                               END;
                                }
      { 1100529901;2 ;ActionGroup;
                      CaptionML=[DEU=Verkauf;
                                 ENU=Sales;
                                 NLD=Verkoop;
                                 NOR=Salg;
                                 SVE=FîrsÑljning];
                      Image=CashFlow }
      { 1000000008;3 ;Action    ;
                      CaptionML=[DEU=Rechnungen;
                                 ENU=Invoices;
                                 NLD=Facturen;
                                 NOR=Fakturaer;
                                 SVE=Fakturor];
                      Image=Invoice;
                      OnAction=VAR
                                 lSalesInvHeader@1210190002 : Record 112;
                                 lSalesInvLine@1210190001 : Record 113;
                               BEGIN
                                 //**4PS
                                 lSalesInvHeader.CLEARMARKS;
                                 lSalesInvLine.SETCURRENTKEY("Job No.","Project Invoice","Installment Invoice","Sell-to Customer No.");
                                 lSalesInvLine.SETRANGE("Job No.","No.");
                                 IF lSalesInvLine.FINDSET THEN
                                   REPEAT
                                     IF lSalesInvHeader.GET(lSalesInvLine."Document No.") THEN
                                       lSalesInvHeader.MARK(TRUE);
                                   UNTIL lSalesInvLine.NEXT = 0;

                                 lSalesInvHeader.MARKEDONLY(TRUE);

                                 PAGE.RUNMODAL(PAGE::"Posted Sales Invoices",lSalesInvHeader);
                               END;
                                }
      { 1000000004;3 ;Action    ;
                      CaptionML=[DEU=Gutschriften;
                                 ENU=Credit Memos;
                                 NLD=Creditnota's;
                                 NOR=Kreditnotaer;
                                 SVE=Kreditnotor];
                      Image=CreditMemo;
                      OnAction=VAR
                                 lSalesCrMemoHeader@1210190002 : Record 114;
                                 lSalesCrMemoLine@1210190001 : Record 115;
                               BEGIN
                                 //**4PS
                                 lSalesCrMemoHeader.CLEARMARKS;
                                 lSalesCrMemoLine.SETRANGE("Job No.","No.");
                                 IF lSalesCrMemoLine.FINDSET THEN
                                   REPEAT
                                     IF lSalesCrMemoHeader.GET(lSalesCrMemoLine."Document No.") THEN
                                       lSalesCrMemoHeader.MARK(TRUE);
                                   UNTIL lSalesCrMemoLine.NEXT = 0;

                                 lSalesCrMemoHeader.MARKEDONLY(TRUE);

                                 PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memos",lSalesCrMemoHeader);
                               END;
                                }
      { 1000000007;3 ;Action    ;
                      CaptionML=[DEU=RegieeintrÑge;
                                 ENU=&Cost Plus Entries;
                                 NLD=Regiem&utaties;
                                 NOR=&Rapporterte selvkoster;
                                 SVE=&Redovisade sjÑlvkostnader];
                      RunObject=Page 11012043;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ApplyEntries }
      { 1101200084;3 ;Action    ;
                      CaptionML=[DEU=Raten;
                                 ENU=&Installments;
                                 NLD=Termi&jnen;
                                 NOR=&Betalingsplaner;
                                 SVE=&Betalplaner];
                      RunObject=Page 11012025;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AmountByPeriod }
      { 1210190030;3 ;Action    ;
                      CaptionML=[DEU=Verrechnungsblatt;
                                 ENU=Settlement Sheet;
                                 NLD=Verrekenstaat;
                                 NOR=Oppgjõrsskjema;
                                 SVE=AvrÑkningsark];
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SettlRec@1210190000 : Record 11012021;
                                 CommRec@1210190001 : Record 11012020;
                               BEGIN
                                 //db, 04-10-04:
                                 TESTFIELD("Bill-to Customer No.");
                                 CommRec.RESET;
                                 CommRec.SETRANGE("Project No.", "No.");
                                 CommRec.SETRANGE(Principal, "Bill-to Customer No.");
                                 //IF NOT CommRec.FIND('+') THEN CommRec.INIT;  //* C-027523.o
                                 CommRec.FINDLAST;  //* C-027523.n  Must exist, otherwise it is not possible to insert settlements
                                                    //*             Normaly this will exist, because it is autom. inserted for a small project

                                 SettlRec.RESET;
                                 SettlRec.SETRANGE("Project No.", "No.");
                                 SettlRec.SETRANGE(Principal, "Bill-to Customer No.");
                                 SettlRec.SETRANGE("Commission No.", CommRec."No.");
                                 IF NOT SettlRec.FIND('+') THEN SettlRec.INIT;

                                 PAGE.RUNMODAL(PAGE::"Settlement Sheet", SettlRec);
                               END;
                                }
      { 1210190039;2 ;Action    ;
                      CaptionML=[DEU=Bestellungen;
                                 ENU=Purchase Orders;
                                 NLD=Inkooporders;
                                 NOR=Bestillinger;
                                 SVE=Inkîpsorder];
                      Image=Document;
                      OnAction=BEGIN
                                 ShowPurchaseOrdersForProject;  //db, 05-09-13
                               END;
                                }
      { 1100485107;2 ;ActionGroup;
                      CaptionML=[DEU=StÅckpreise;
                                 ENU=Unit Prices;
                                 NLD=Eenheidsprijzen;
                                 NOR=Enhetspriser;
                                 SVE=Enhetspriser];
                      Image=CostAccounting }
      { 1100485106;3 ;Action    ;
                      CaptionML=[DEU=Projekt StÅckpreise;
                                 ENU=Project Unit Prices;
                                 NLD=Project eenheidsprijzen;
                                 NOR=Prosjektenhetspriser;
                                 SVE=Projektenhetspriser];
                      RunObject=Page 11072519;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostCenter }
      { 1100485108;3 ;Action    ;
                      CaptionML=[DEU=Produktionsverantwortung;
                                 ENU=Production Motivation;
                                 NLD=Productieverantwoording;
                                 NOR=Produksjonsmotivasjon;
                                 SVE=Produktionsorsak];
                      Image=Production;
                      OnAction=VAR
                                 ProdMot@1210190000 : Record 11020425;
                               BEGIN
                                 ProdMot.RunUnitPriceProdMotList("No.", '', 0);  //* Level 0=Project
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101200085;1 ;ActionGroup;
                      Name=FunctionsBtn;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions;
                                 NLD=F&uncties;
                                 NOR=Fu&nksjon;
                                 SVE=Fu&nktion];
                      Visible=FunctionsBtnVisible }
      { 1100485092;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Kopieren Kleinprojekt;
                                 ENU=Copy Small Project;
                                 NLD=Kopiâren klusproject;
                                 NOR=Kopier lite prosjekt;
                                 SVE=Kopiera mindre projekt];
                      Image=Copy;
                      OnAction=BEGIN
                                 //**4PS
                                 CopyProject;
                               END;
                                }
      { 1210190015;2 ;Action    ;
                      CaptionML=[DEU=Beschwerde koppeln;
                                 ENU=Link Complaint;
                                 NLD=Klacht koppelen;
                                 NOR=Koble klage;
                                 SVE=LÑnka klagomÜl];
                      Image=Link;
                      OnAction=BEGIN
                                 //kzwerver, 110802, c, #26039
                                 Rec.LinkComplaint();
                               END;
                                }
      { 1210190016;2 ;Action    ;
                      CaptionML=[DEU=Beschwerde entkoppeln;
                                 ENU=Unlink Complaint;
                                 NLD=Klacht ontkoppelen;
                                 NOR=Fjern kobling til klage;
                                 SVE=Ta bort lÑnk till klagomÜl];
                      Image=UnLinkAccount;
                      OnAction=BEGIN
                                 //kzwerver, 110802, c, #26039
                                 Rec.UnlinkComplaint();
                               END;
                                }
      { 1100485018;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Zu erstellende ProjektregieeintrÑge drucken;
                                 ENU=Print Project Cost Plus Entries to Create;
                                 NLD=Aan te maken project regiemutaties afdrukken;
                                 NOR=Skriv ut rapporterte selvkoster for prosjekt som skal opprettes;
                                 SVE=Skriv ut redovisade sjÑlvkostnader fîr projekt som ska skapas];
                      Image=PrintChecklistReport;
                      OnAction=VAR
                                 Job@1100485004 : Record 11072003;
                                 JobLedgerEntry@1100485003 : Record 11072005;
                                 PostedHourLine@1100485002 : Record 11012085;
                                 HourAccountingLine@1100485001 : Record 11012039;
                                 ProjectCostPlustoCreate@1100525000 : Report 11012137;
                               BEGIN
                                 //**4PS
                                 Job.SETRANGE("No.", "No.");
                                 JobLedgerEntry.SETRANGE("Cost Plus Entry Created", FALSE);
                                 PostedHourLine.SETRANGE("Cost Plus Entry Created", FALSE);
                                 HourAccountingLine.SETRANGE("Cost Plus Entry Created", FALSE);

                                 ProjectCostPlustoCreate.SETTABLEVIEW(Job);
                                 ProjectCostPlustoCreate.SETTABLEVIEW(JobLedgerEntry);
                                 ProjectCostPlustoCreate.SETTABLEVIEW(PostedHourLine);
                                 ProjectCostPlustoCreate.SETTABLEVIEW(HourAccountingLine);
                                 ProjectCostPlustoCreate.SetDefault("No.");
                                 ProjectCostPlustoCreate.RUN;
                               END;
                                }
      { 1210190150;2 ;Action    ;
                      CaptionML=[DEU=Projektbelege;
                                 ENU=Project Documents;
                                 NLD=Projectdocumenten;
                                 NOR=Prosjektdokumenter;
                                 SVE=Projektdokument];
                      Image=Word;
                      OnAction=VAR
                                 Contact@1210190002 : Record 5050;
                                 DocumentTemplate@1210190000 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Bill-to Customer No.");
                                 IF Contact.GetContactByCustomer("Bill-to Customer No.", Contact, TRUE) THEN
                                   EditDocuments(STRSUBSTNO('%1', DocumentTemplate.Type::Job), Contact."No.", '', FALSE, '');
                               END;
                                }
      { 1000000014;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+A;
                      Ellipsis=Yes;
                      CaptionML=[DEU=RegieeintrÑge erstellen;
                                 ENU=Generate Cost Plus Entries;
                                 NLD=Regiemutaties aanmaken;
                                 NOR=Opprette selvkosttransaksjoner;
                                 SVE=Generera redovisade sjÑlvkostnader];
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lvProjRec@1210190005 : Record 11072003;
                                 lvProjLedgEntryRec@1210190002 : Record 11072005;
                                 lvPostedHourLineRec@1210190004 : Record 11012085;
                                 lvHourAccLineRec@1210190003 : Record 11012039;
                                 lvCreateCostPlusRpt@1210190001 : Report 11012013;
                               BEGIN
                                 lvProjRec.SETRANGE("No.", "No.");
                                 lvProjLedgEntryRec.SETRANGE("Cost Plus Entry Created", FALSE);
                                 lvPostedHourLineRec.SETRANGE("Cost Plus Entry Created", FALSE);
                                 lvHourAccLineRec.SETRANGE("Cost Plus Entry Created", FALSE);

                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvProjRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvProjLedgEntryRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvPostedHourLineRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvHourAccLineRec);
                                 lvCreateCostPlusRpt.SetDefault("No.");
                                 lvCreateCostPlusRpt.RUN;
                               END;
                                }
      { 1000000015;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Rechnungen erstellen;
                                 ENU=Create Invoices;
                                 NLD=Facturen aanmaken;
                                 NOR=Opprette fakturaer;
                                 SVE=Skapa fakturor];
                      Promoted=Yes;
                      Image=CreateJobSalesInvoice;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1210190001 : Record 11072003;
                               BEGIN
                                 Job := Rec;
                                 Job.SETRECFILTER;
                                 Job.CreateInvoicesFromProject(Job);
                               END;
                                }
      { 1100485902;2 ;Action    ;
                      CaptionML=[DEU=Erstellen &iMOS Arbeitsschein;
                                 ENU=Build &iMOS workticket;
                                 NLD=Aanmaken &iMOS werkbon;
                                 NOR=Bygg &iMOS-arbeidsblad;
                                 SVE=Bygg &iMOS-arbetsblad];
                      Visible=FALSE;
                      Image=Worksheet;
                      OnAction=VAR
                                 lvJobNoteHeadRec@1100485000 : Record 11020536;
                                 lvJobNoteLineRec@1100485003 : Record 11020537;
                                 lvJobNoteFrm@1100525000 : Page 11020533;
                               BEGIN
                                 IF NOT "Plant Job Order" THEN
                                   ERROR(Text11012003, FIELDCAPTION("Plant Job Order"));

                                 lvJobNoteHeadRec.INIT;
                                 lvJobNoteHeadRec.VALIDATE("Project No.", "No.");   //Gets Customer and bon-type too.
                                 lvJobNoteHeadRec.INSERT(TRUE);

                                 IF "Plant Type" <> '' THEN BEGIN
                                   lvJobNoteLineRec.INIT;
                                   lvJobNoteLineRec."Job Notice No." := lvJobNoteHeadRec."No.";
                                   lvJobNoteLineRec."Line No." := 10000;
                                   lvJobNoteLineRec."Line Type" := lvJobNoteLineRec."Line Type"::Plant;
                                   lvJobNoteLineRec.VALIDATE("Plant Type", "Plant Type");
                                   lvJobNoteLineRec.VALIDATE("Plant No.", "Plant No.");
                                   lvJobNoteLineRec.INSERT(TRUE);
                                 END;

                                 COMMIT;
                                 lvJobNoteFrm.SETRECORD(lvJobNoteHeadRec);
                                 lvJobNoteFrm.RUNMODAL;
                               END;
                                }
      { 1100485903;2 ;Action    ;
                      CaptionML=[DEU=öbersicht iMOS Arbeitsscheine;
                                 ENU=Overview iMOS wordtickets;
                                 NLD=Overzicht iMOS werkbonnen;
                                 NOR=Oversikt over iMOS-arbeidsblader;
                                 SVE=ôversikt îver iMOS-arbetsblad];
                      RunObject=Page 11020535;
                      RunPageLink=Project No.=FIELD(No.);
                      Visible=FALSE;
                      Image=Worksheet2 }
      { 1100485004;1 ;Action    ;
                      CaptionML=[DEU=Arbeitsschein;
                                 ENU=Work&sheet;
                                 NLD=Werk&bon;
                                 NOR=Kalkyle&ark;
                                 SVE=Kalkyl&blad];
                      Promoted=Yes;
                      Image=PrintDocument;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 //**4PS
                                 CurrPage.SETSELECTIONFILTER(ProjRec);
                                 PrintDoc.PrintProjWorksheet(ProjRec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[DEU=Allgemein;
                           ENU=General;
                           NLD=Algemeen;
                           NOR=Generell;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             NoOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1100528800;2;Field  ;
                SourceExpr="Description 2";
                Importance=Additional }

    { 1210190019;2;Field  ;
                SourceExpr="Settlement Method";
                Importance=Promoted;
                OnValidate=BEGIN
                             SettlementMethodOnAfterValidat;
                           END;
                            }

    { 1210190018;2;Field  ;
                SourceExpr="Contract Type";
                OnValidate=BEGIN
                             ContractTypeOnAfterValidate;
                           END;
                            }

    { 1101200004;2;Field  ;
                SourceExpr="Project Address Code";
                OnValidate=BEGIN
                             ProjectAddressCodeOnAfterValid;
                           END;

                OnLookup=VAR
                           AddressFrm@1210190001 : Page 301;
                           AddressRec@1210190000 : Record 222;
                         BEGIN
                           CLEAR(AddressFrm);
                           AddressFrm.LOOKUPMODE(TRUE);
                           AddressRec.RESET;
                           AddressRec.SETRANGE("Project Address", TRUE);
                           IF "Bill-to Customer No." <> '' THEN
                             AddressRec.SETRANGE("Customer No.","Bill-to Customer No.");
                           AddressFrm.SETTABLEVIEW(AddressRec);
                           IF AddressFrm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             AddressFrm.GETRECORD(AddressRec);
                             //"Project Address Code" := AddressRec.Code;
                             IF "Bill-to Customer No." = '' THEN BEGIN
                               "Project Address Code" := AddressRec.Code;
                               InsertProjectPrincipal(AddressRec."Customer No.");
                               VALIDATE("Bill-to Customer No.",AddressRec."Customer No.");
                             END ELSE BEGIN
                               VALIDATE("Project Address Code", AddressRec.Code);
                               //UpdateProjectAddress;
                             END;
                           END;
                           CurrPage.UPDATE;
                         END;
                          }

    { 32  ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Bill-to Customer No.";
                OnValidate=BEGIN
                             CALCFIELDS("Principal Name",Prospect);
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           COMMIT;
                           LookupProjectPrincipal; //DP00790-RFC41
                           CurrPage.UPDATE;
                         END;

                OnAssistEdit=BEGIN
                               CurrPage.SAVERECORD;
                               COMMIT;
                               AssistEditProjectPrincipal; //DP00790-RFC41
                               CurrPage.UPDATE;
                             END;
                              }

    { 1210190031;2;Field  ;
                SourceExpr="Principal Name";
                Importance=Additional;
                Editable=FALSE }

    { 1100485087;2;Field  ;
                SourceExpr="Principal Contact Person" }

    { 1100485085;2;Field  ;
                SourceExpr="Principal Contact Person Name";
                Importance=Additional }

    { 1210190051;2;Field  ;
                SourceExpr="Order No. Customer";
                OnValidate=BEGIN
                             OrderNoCustomerOnAfterValidate;
                           END;
                            }

    { 1100485002;2;Field  ;
                SourceExpr="Commision Date Principal";
                OnValidate=BEGIN
                             CommisionDatePrincipalC1100485;
                           END;
                            }

    { 1210190017;2;Field  ;
                SourceExpr=Name }

    { 45  ;2   ;Field     ;
                SourceExpr=Address;
                Editable=TRUE }

    { 47  ;2   ;Field     ;
                SourceExpr="Address 2";
                Importance=Additional;
                Editable=TRUE }

    { 55  ;2   ;Field     ;
                SourceExpr="Post Code";
                Editable=TRUE }

    { 49  ;2   ;Field     ;
                SourceExpr=City;
                Editable=TRUE }

    { 1210190008;2;Field  ;
                SourceExpr="Phone No." }

    { 1100485048;2;Field  ;
                SourceExpr="Mobile Phone No.";
                Importance=Additional }

    { 1100485050;2;Field  ;
                SourceExpr="Phone No. at Work";
                Importance=Additional }

    { 1100485063;2;Field  ;
                SourceExpr="Maximum Amount to Invoice";
                Importance=Additional }

    { 1100485058;2;Field  ;
                SourceExpr="Urgency Code";
                OnValidate=BEGIN
                             UrgencyCodeC1100485058OnAfterV;
                           END;
                            }

    { 1100485059;2;Field  ;
                SourceExpr="Urgency Description";
                Importance=Additional }

    { 1210190053;2;Field  ;
                SourceExpr="Internal/External Action";
                OnValidate=BEGIN
                             FillActionByName();
                           END;
                            }

    { 1210190055;2;Field  ;
                SourceExpr="Action by";
                OnValidate=BEGIN
                             ActionbyOnAfterValidate;
                           END;
                            }

    { 1210190056;2;Field  ;
                DrillDown=No;
                CaptionML=[DEU=Aktion pro Name;
                           ENU=Action By Name;
                           NLD=Actie door naam;
                           NOR=Handling etter navn;
                           SVE=ètgÑrd efter namn];
                SourceExpr=ActionByName;
                Importance=Additional;
                Editable=FALSE }

    { 1101200011;2;Field  ;
                SourceExpr=Type }

    { 1210190035;2;Field  ;
                SourceExpr="Small Project Status" }

    { 1100528900;2;Field  ;
                ToolTipML=[DEU=Gibt den zusÑtzlichen Namen fÅr das Projekt an. Das Feld wird fÅr SuchvorgÑnge verwendet.;
                           ENU=Specifies the additional name for the job. The field is used for searching purposes.;
                           NLD=Hiermee wordt de extra naam voor het project opgegeven. Het veld is bestemd voor zoekdoeleinden.;
                           NOR=Angir tilleggsnavnet for prosjektet. Dette feltet brukes til sõking.;
                           SVE=Anger det alternativa namnet pÜ projektet. FÑltet anvÑnds fîr sîkning.];
                ApplicationArea=#Jobs;
                SourceExpr="Search Description";
                Importance=Additional }

    { 1100525013;1;Part   ;
                CaptionML=[DEU=Arbeitsscheintext;
                           ENU=Worksheet Text;
                           NLD=Werkbontekst];
                SubPageLink=Table=CONST(Job),
                            Code=FIELD(No.),
                            Table Line No.=CONST(0);
                PagePartID=Page11020309;
                PartType=Page }

    { 1903705201;1;Group  ;
                CaptionML=[DEU=Personal;
                           ENU=Personnel;
                           NLD=Personen;
                           NOR=Personell;
                           SVE=Personal] }

    { 1210190107;2;Field  ;
                SourceExpr=Estimator;
                OnValidate=BEGIN
                             EstimatorOnAfterValidate;
                           END;
                            }

    { 1210190113;2;Field  ;
                SourceExpr="Name Estimator";
                Importance=Additional;
                Editable=FALSE }

    { 1100485071;2;Field  ;
                SourceExpr="Site Manager";
                Importance=Promoted;
                OnValidate=BEGIN
                             SiteManagerC1100485071OnAfterV;
                           END;
                            }

    { 1100485072;2;Field  ;
                SourceExpr="Name Site Manager";
                Importance=Additional;
                Editable=FALSE }

    { 1210190106;2;Field  ;
                SourceExpr="Project Manager";
                OnValidate=BEGIN
                             ProjectManagerOnAfterValidate;
                           END;
                            }

    { 1210190111;2;Field  ;
                SourceExpr="Name Project Manager";
                Importance=Additional;
                Editable=FALSE }

    { 1100485098;2;Field  ;
                SourceExpr="Project Engineer";
                OnValidate=BEGIN
                             ProjectEngineerOnAfterValidate;
                           END;
                            }

    { 1100485097;2;Field  ;
                SourceExpr="Name Project Engineer";
                Importance=Additional;
                Editable=FALSE }

    { 1210190108;2;Field  ;
                SourceExpr=Supervisor;
                Importance=Promoted }

    { 1210190112;2;Field  ;
                CaptionML=[DEU=Name Bauleiter;
                           ENU=Supervisor Name;
                           NLD=Naam Opzichter;
                           NOR=Arbeidslederens navn;
                           SVE=Arbetsledarens namn];
                SourceExpr=NameSupervisor;
                Importance=Additional;
                Editable=FALSE }

    { 1100525015;2;Field  ;
                SourceExpr=Buyercontact;
                OnValidate=BEGIN
                             CALCFIELDS("Name Buyer Contact");
                             CurrPage.SAVERECORD;
                           END;
                            }

    { 1100525014;2;Field  ;
                SourceExpr="Name Buyer Contact";
                Importance=Additional }

    { 1100525007;2;Field  ;
                SourceExpr="Purchaser Code" }

    { 1100525009;2;Field  ;
                SourceExpr="Name Purchaser";
                Importance=Additional;
                Editable=FALSE }

    { 1100525011;2;Field  ;
                SourceExpr=Expediter;
                Importance=Additional;
                OnValidate=BEGIN
                             ExpediterOnAfterValidate;
                           END;
                            }

    { 1100525012;2;Field  ;
                SourceExpr="Name Expediter";
                Importance=Additional;
                Editable=FALSE }

    { 1905223301;1;Group  ;
                CaptionML=[DEU=Daten;
                           ENU=Data;
                           NLD=Data;
                           NOR=Data;
                           SVE=Data] }

    { 14  ;2   ;Field     ;
                SourceExpr="Creation Date";
                Editable=FALSE }

    { 1210190073;2;Field  ;
                SourceExpr="Creation Time" }

    { 1210190037;2;Field  ;
                SourceExpr="Created by";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                SourceExpr="Last Date Modified";
                Editable=FALSE }

    { 1210190002;2;Field  ;
                SourceExpr="Modified by";
                Importance=Promoted }

    { 1101200036;2;Field  ;
                SourceExpr="Status Modification Date" }

    { 20  ;2   ;Field     ;
                CaptionML=[DEU=Startdatum (angefragt);
                           ENU=Starting Date (Requested);
                           NLD=Begindatum (gewenst)];
                SourceExpr="Starting Date";
                Importance=Additional }

    { 1100485006;2;Field  ;
                SourceExpr="Requested Starting Time";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                CaptionML=[DEU=Enddatum (angefragt);
                           ENU=Ending Date  (Requested);
                           NLD=Einddatum (gewenst)];
                SourceExpr="Ending Date";
                Importance=Additional }

    { 1100485009;2;Field  ;
                CaptionML=[DEU=Geplantes Startdatum;
                           ENU=Planned Starting Date;
                           NLD=Geplande begindatum;
                           NOR=Planlagt startdato;
                           SVE=Planerat startdatum];
                SourceExpr=Appointmentrec."Starting Date";
                Importance=Additional;
                Editable=FALSE }

    { 1100485010;2;Field  ;
                CaptionML=[DEU=Geplante Startzeit;
                           ENU=Planned Starting Time;
                           NLD=Geplande begintijd;
                           NOR=Planlagt starttid;
                           SVE=Planerad starttid];
                SourceExpr=Appointmentrec."Start Time";
                Importance=Additional;
                Editable=FALSE }

    { 1100485012;2;Field  ;
                CaptionML=[DEU=Geplantes Enddatum;
                           ENU=Planned Ending Date;
                           NLD=Geplande einddatum;
                           NOR=Planlagt sluttdato;
                           SVE=Planerat slutdatum];
                SourceExpr=Appointmentrec."Ending Date";
                Importance=Additional;
                Editable=FALSE }

    { 1100485013;2;Field  ;
                CaptionML=[DEU=Geplante Endzeit;
                           ENU=Planned Ending Time;
                           NLD=Geplande eindtijd;
                           NOR=Planlagte sluttid;
                           SVE=Planerad sluttid];
                SourceExpr=Appointmentrec."End Time";
                Importance=Additional;
                Editable=FALSE }

    { 1210190020;2;Field  ;
                SourceExpr="Technical Finished Date";
                Importance=Additional }

    { 1100485020;2;Field  ;
                SourceExpr="Posting Date Closing";
                Importance=Additional }

    { 1100525000;2;Field  ;
                SourceExpr=Blocked;
                Importance=Additional }

    { 1210190000;2;Field  ;
                SourceExpr="Archive Location Documents";
                Importance=Additional;
                OnAssistEdit=BEGIN
                               AssistEditProjFolder;
                             END;
                              }

    { 1100525010;2;Field  ;
                SourceExpr="Archive Location";
                Importance=Additional }

    { 1100485014;2;Field  ;
                SourceExpr="Finish report to Principal";
                Importance=Additional }

    { 1100485016;2;Field  ;
                SourceExpr="Last Invoice date";
                Importance=Additional }

    { 1905885101;1;Group  ;
                CaptionML=[DEU=Fakturierung;
                           ENU=Invoicing;
                           NLD=Facturering;
                           NOR=Fakturering;
                           SVE=Fakturering] }

    { 1210190022;2;Field  ;
                SourceExpr="Contract Amount" }

    { 1210190024;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1210190089;2;Field  ;
                SourceExpr="Calculate B Amounts based on";
                Editable="Calculate B Amounts based onED" }

    { 1210190025;2;Field  ;
                SourceExpr="% Labor";
                Editable="% LaborEditable" }

    { 1210190027;2;Field  ;
                SourceExpr="% to B Account";
                Editable="% to B AccountEditable" }

    { 1100485095;2;Field  ;
                SourceExpr="Print Manday Register" }

    { 1100485080;2;Field  ;
                SourceExpr="Invoice Contact Person" }

    { 1100485081;2;Field  ;
                DrillDown=No;
                SourceExpr="Invoice Contact Person Name";
                Importance=Additional }

    { 1100485101;2;Field  ;
                SourceExpr="Invoice Layout Code";
                Importance=Additional }

    { 1100485077;2;Field  ;
                SourceExpr=Text;
                MultiLine=Yes }

    { 1100485112;2;Field  ;
                SourceExpr="Price List";
                Importance=Additional }

    { 1100485113;2;Field  ;
                SourceExpr="Ref. Date Unit Price";
                Importance=Additional }

    { 1100525024;2;Field  ;
                SourceExpr="Internal Project";
                Importance=Additional }

    { 1100529000;2;Field  ;
                SourceExpr="Master Company";
                Importance=Additional }

    { 1100525020;2;Field  ;
                SourceExpr="Master Project";
                Importance=Additional }

    { 1100525019;2;Field  ;
                SourceExpr="Cost Object Inter Project Cost";
                Importance=Additional }

    { 1100525018;2;Field  ;
                SourceExpr="Cost Object Inter Project Rev";
                Importance=Additional }

    { 1100528500;2;Field  ;
                SourceExpr="Service Warranty Code" }

    { 1100485082;2;Field  ;
                CaptionML=[DEU=Kontakt;
                           ENU=Contact;
                           NLD=Niet Weggooien;
                           NOR=Kontaktperson;
                           SVE=Kontakt];
                SourceExpr=Prospect;
                CaptionClass=FORMAT ("Invoice Contact Person Name");
                Importance=Additional;
                Visible=FALSE }

    { 1907580001;1;Group  ;
                CaptionML=[DEU=Verschiedenes;
                           ENU=Miscelaneous;
                           NLD=Diversen;
                           NOR=ùvrig;
                           SVE=ôvrigt] }

    { 1101200000;2;Field  ;
                SourceExpr="Project Type";
                OnValidate=BEGIN
                             ProjectTypeOnAfterValidate;
                           END;
                            }

    { 1101200002;2;Field  ;
                SourceExpr="Project Status" }

    { 1101200009;2;Field  ;
                SourceExpr="Territory Code" }

    { 1100525016;2;Field  ;
                SourceExpr=Discipline }

    { 1101200013;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1101200021;2;Field  ;
                SourceExpr="Single/Main/Sub Project";
                OnValidate=BEGIN
                             SingleMainSubProjectOnAfterVal;
                           END;
                            }

    { 1101200023;2;Field  ;
                SourceExpr="Main Project";
                Editable="Main ProjectEditable" }

    { 1210190042;2;Field  ;
                SourceExpr="Regular Costs";
                Importance=Additional;
                OnValidate=BEGIN
                             RegularCostsOnAfterValidate;
                           END;
                            }

    { 1210190044;2;Field  ;
                SourceExpr="Recoverable Costs";
                Importance=Additional;
                OnValidate=BEGIN
                             RecoverableCostsOnAfterValidat;
                           END;
                            }

    { 1210190047;2;Field  ;
                CaptionML=[DEU=Taxierte Kosten;
                           ENU=Estmated Costs;
                           NLD=Ingeschatte kosten;
                           NOR=Kulkulerte koster;
                           SVE=Kalkylerade kostnader];
                SourceExpr="Recoverable Costs" + "Regular Costs";
                Importance=Additional;
                Editable=FALSE }

    { 1210190097;2;Field  ;
                CaptionML=[DEU=Summe vorkalk. ArbeitsgÑnge;
                           ENU=Total Fixed Rate Settlement Sheet;
                           NLD=Totaal voorcalc. bewerkingen;
                           NOR=Total fast sats, oppgjõrsskjema;
                           SVE=Total fast rÑnta, avrÑkningsark];
                SourceExpr=TotalOperation;
                Importance=Additional;
                Editable=FALSE }

    { 1210190084;2;Field  ;
                CaptionML=[DEU=Summe Verrechnungsblatt;
                           ENU=Total Settlement Sheet;
                           NLD=Totaal verrekenstaat;
                           NOR=Totaloppgjõrsskjema;
                           SVE=TotalavrÑkningsark];
                SourceExpr=TotalSettlDec;
                Importance=Additional;
                Editable=FALSE }

    { 1210190093;2;Field  ;
                SourceExpr="Open Amount (Hours)";
                Importance=Additional }

    { 1210190095;2;Field  ;
                SourceExpr="Actual Costs";
                Importance=Additional }

    { 1100485083;2;Field  ;
                SourceExpr="Disable Export Losa (COBRA)";
                Importance=Additional;
                Visible=SalaryAppLosaCobra }

    { 1100485086;2;Field  ;
                SourceExpr="Origin Complaint Company";
                Importance=Additional;
                Editable=FALSE }

    { 1100485090;2;Field  ;
                SourceExpr="Origin Complaint No.";
                Importance=Additional;
                Editable=FALSE;
                OnLookup=VAR
                           lvComplaintRec@1100485002 : Record 11012450;
                           lvComplaintListFrm@1100485003 : Page 11012468;
                         BEGIN
                           IF ("Origin Complaint Company" <> '') AND ("Origin Complaint Company" <> COMPANYNAME) THEN
                             lvComplaintListFrm.SetOtherCompany("Origin Complaint Company");
                           lvComplaintRec."No." := "Origin Complaint No.";
                           lvComplaintListFrm.SETRECORD(lvComplaintRec);
                           lvComplaintListFrm.RUNMODAL;
                         END;
                          }

    { 1100525008;2;Field  ;
                CaptionML=[DEU=Lead-Generierung;
                           ENU=Try-Out;
                           NLD=Traject;
                           NOR=Prospekt;
                           SVE=Anbud];
                SourceExpr=GetTryOut(1);
                Importance=Additional;
                Editable=FALSE;
                OnLookup=BEGIN
                           ShowTryOut(1);
                         END;
                          }

    { 1100525006;2;Field  ;
                CaptionML=[DEU=Angebotsgenerierung;
                           ENU=Try-Out Quote;
                           NLD=Trajectofferte;
                           NOR=Tilbudsforespõrsel;
                           SVE=AnbudsfîrfrÜgan];
                SourceExpr=GetTryOut(2);
                Importance=Additional;
                Editable=FALSE;
                OnLookup=BEGIN
                           ShowTryOut(2);
                         END;
                          }

    { 1100525003;2;Field  ;
                CaptionML=[DEU=Kalkulationsnr.;
                           ENU=Estimate No.;
                           NLD=Calculatienr.;
                           NOR=Kalkylenr;
                           SVE=Kalkylnr];
                SourceExpr=GetEstimate();
                Importance=Additional;
                Editable=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowEstimate;
                         END;
                          }

    { 1100525002;2;Field  ;
                SourceExpr="Created from Service Loc. No.";
                Importance=Additional;
                Editable=FALSE }

    { 1905446501;1;Group  ;
                CaptionML=[DEU=Komplexdaten;
                           ENU=Complex Data;
                           NLD=Complex gegevens;
                           NOR=Komplekse data;
                           SVE=Komplexa data] }

    { 1210190083;2;Field  ;
                SourceExpr="Estate Owner";
                OnValidate=BEGIN
                             EstateOwnerC1210190083OnAfterV;
                           END;
                            }

    { 1210190081;2;Field  ;
                SourceExpr="Estate Owner Name";
                Importance=Additional;
                Editable=FALSE }

    { 1210190072;2;Field  ;
                SourceExpr="Estate No." }

    { 1210190070;2;Field  ;
                SourceExpr=Building }

    { 1210190068;2;Field  ;
                SourceExpr=Floor }

    { 1210190066;2;Field  ;
                SourceExpr=Department }

    { 1210190064;2;Field  ;
                SourceExpr=Room }

    { 1210190034;2;Field  ;
                SourceExpr="Response Time";
                Importance=Additional }

    { 1210190033;2;Field  ;
                SourceExpr="Area Team";
                Importance=Additional }

    { 1210190032;2;Field  ;
                SourceExpr="Phone No. Area Team";
                Importance=Additional }

    { 1906747901;1;Group  ;
                CaptionML=[DEU=Werkzeug;
                           ENU=Plant;
                           NLD=Materieel;
                           NOR=Maskin;
                           SVE=Maskin] }

    { 1100485904;2;Field  ;
                SourceExpr="Plant Job Order";
                Editable="Plant Job OrderEditable";
                OnValidate=BEGIN
                             //**4PS
                             SetPlantJobOrderFieldsEditable();
                           END;
                            }

    { 1100485913;2;Field  ;
                SourceExpr="Plant Location";
                Editable="Plant LocationEditable" }

    { 1100485906;2;Field  ;
                SourceExpr="Plant Type";
                Editable="Plant TypeEditable" }

    { 1100485908;2;Field  ;
                SourceExpr="Plant No.";
                Editable="Plant No.Editable" }

    { 1100485910;2;Field  ;
                SourceExpr="Cost Component Plant";
                Editable="Cost Component PlantEditable" }

    { 1210190004;0;Container;
                ContainerType=FactBoxArea }

    { 1100529902;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190003;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130002;
                PartType=Page }

    { 1210190005;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130105;
                PartType=Page }

    { 1100525004;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100525001;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ProjPrincipRec@11012002 : Record 11012005;
      EmplRec@11012003 : Record 5200;
      VendorRec@1210190004 : Record 23;
      ProjRec@11012004 : Record 11072003;
      Appointmentrec@1100485003 : Record 11012081;
      gPlantLocRec@1100485023 : Record 11012554;
      PrintDoc@1100485000 : Codeunit 229;
      AppPresBln@1210190000 : Boolean;
      gCreateFromPlantLoc@1100485022 : Boolean;
      Text11012000@1210190003 : TextConst 'DEU=FÅr dieses Projekt wurden keine Teilprojekte festgelegt.;ENU=For this Project are no Sub Projects present.;NLD=Voor dit project zijn geen deelprojecten vastgelegd.;NOR=Det finnes ikke noe underprosjekt for dette prosjektet.;SVE=Det finns inga underprojekt fîr det hÑr projektet.';
      Text11012003@1100485021 : TextConst 'DEU=Kleinprojekt muss ''%1'' sein.;ENU=Small Project must be ''%1''.;NLD="Klusproject moet ''%1'' zijn. ";NOR=Lite prosjekt mÜ vëre ''%1''.;SVE=Mindre projekt mÜste vara ''%1''.';
      TotalOperation@1210190008 : Decimal;
      TotalSettlDec@1210190011 : Decimal;
      TotalCost@1100485004 : Decimal;
      ActionByName@1210190007 : Text[100];
      OperText@1210190005 : Text[50];
      DPA_IsHardFilter@1100000999 : Boolean;
      "% LaborEditable"@19078728 : Boolean INDATASET;
      "% to B AccountEditable"@19001286 : Boolean INDATASET;
      "Main ProjectEditable"@19070977 : Boolean INDATASET;
      SalaryAppLosaCobra@19015054 : Boolean INDATASET;
      "Plant Job OrderEditable"@19059329 : Boolean INDATASET;
      "Plant LocationEditable"@19020337 : Boolean INDATASET;
      BillToCustInfoVisible@19018081 : Boolean INDATASET;
      BillToCustBmpVisible@19021368 : Boolean INDATASET;
      ProjectBtnVisible@19034021 : Boolean INDATASET;
      FunctionsBtnVisible@19078569 : Boolean INDATASET;
      "Plant TypeEditable"@19005558 : Boolean INDATASET;
      "Plant No.Editable"@19002985 : Boolean INDATASET;
      "Cost Component PlantEditable"@19033688 : Boolean INDATASET;
      "Calculate B Amounts based onED"@1100525003 : Boolean INDATASET;

    PROCEDURE FillActionByName@1210190000();
    BEGIN
      ActionByName := '';
      IF ("Action by" = '') THEN
        EXIT;

      CASE "Internal/External Action" OF
        "Internal/External Action"::Internal:
          IF EmplRec.GET("Action by") THEN
            ActionByName := EmplRec."Full Name";
        "Internal/External Action"::External:
          IF VendorRec.GET("Action by") THEN
            ActionByName := VendorRec.Name;
      END;
    END;

    PROCEDURE UpdateInfoPanel@1100485000();
    BEGIN
      BillToCustInfoVisible := ("Bill-to Customer No." <> '');
      BillToCustBmpVisible := ("Bill-to Customer No." <> '');
    END;

    PROCEDURE DetermineExecutionDate@1100485001();
    BEGIN
      Appointmentrec.SETCURRENTKEY("Project No.","Appointment Type","Starting Date");
      Appointmentrec.SETRANGE("Project No.","No.");
      Appointmentrec.SETRANGE("Appointment Type",Appointmentrec."Appointment Type"::Execution);
      IF NOT Appointmentrec.FINDLAST THEN
        Appointmentrec.INIT;
    END;

    PROCEDURE SetSelectionCreateFromPlantLoc@1100485010(IPlantLocRec@1100485000 : Record 11012554);
    BEGIN
      gCreateFromPlantLoc := TRUE;
      gPlantLocRec := IPlantLocRec;
    END;

    LOCAL PROCEDURE FillDefaultFromPlantLocation@1100485011();
    VAR
      lvProjRec@1100485000 : Record 11072003;
      lvCustRec@1100485001 : Record 18;
    BEGIN
      "Plant Job Order" := TRUE;
      "Plant Location" := gPlantLocRec.Code;
      Description := gPlantLocRec.Description;
      //"Description 2" := gPlantLocRec."Description 2";  Field not on Small Project Form, so don't fill
      "Search Description" := gPlantLocRec."Search Name";
      "VAT Bus. Posting Group" := gPlantLocRec."VAT Bus. Posting Group";
      IF gPlantLocRec."Bill-to Customer No." <> '' THEN
        "Bill-to Customer No." := gPlantLocRec."Bill-to Customer No."
      ELSE BEGIN
        IF gPlantLocRec."Customer No." <> '' THEN
          "Bill-to Customer No." := gPlantLocRec."Customer No."
        ELSE BEGIN
          IF (gPlantLocRec."Project No." <> '') AND (gPlantLocRec."Company Name" = '') THEN BEGIN
            IF lvProjRec.GET(gPlantLocRec."Project No.") THEN BEGIN
              IF lvProjRec."Bill-to Customer No." <> '' THEN
                "Bill-to Customer No." := lvProjRec."Bill-to Customer No.";
            END;
          END;
        END;
      END;
      IF "Bill-to Customer No." <> '' THEN BEGIN
        IF lvCustRec.GET("Bill-to Customer No.") THEN BEGIN
          Name := lvCustRec.Name;
          IF "VAT Bus. Posting Group" = '' THEN
            "VAT Bus. Posting Group" := lvCustRec."VAT Bus. Posting Group";
          VALIDATE("Contract Type", lvCustRec."Project Contract Type");
          "Settlement Method" := lvCustRec."Project Settlement Method";
        END;
      END;
      Address := gPlantLocRec.Address;
      "Address 2" := gPlantLocRec."Address 2";
      City := gPlantLocRec.City;
      County := gPlantLocRec.County;
      "Post Code" := gPlantLocRec."Post Code";
      "Country/Region Code" := gPlantLocRec."Country/Region Code";
      "Territory Code" := gPlantLocRec."Territory Code";
      "Phone No." := gPlantLocRec."Phone No.";
      "Fax No." := gPlantLocRec."Fax No.";
    END;

    PROCEDURE SetPlantJobOrderFieldsEditable@1100485002();
    BEGIN
      "Plant LocationEditable" := ("Plant Job Order");
      "Plant TypeEditable" := ("Plant Job Order");
      "Plant No.Editable" := ("Plant Job Order");
      "Cost Component PlantEditable" := ("Plant Job Order");
    END;

    PROCEDURE OpenDocumentList@1100525000();
    VAR
      RecRef@1100525000 : RecordRef;
      DocumentFilters@1100525001 : Codeunit 11012432;
    BEGIN
      RecRef.GETTABLE(Rec);
      // ByCompany changed to FALSE, otherwise documents are not showed in the archive company
      DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, FALSE);
    END;

    PROCEDURE RemoveProjectAndFunctionButton@1210190001();
    BEGIN
      //mg, 10-05-11: C-028275
      ProjectBtnVisible := (FALSE);
      FunctionsBtnVisible := (FALSE);
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      IF gCreateFromPlantLoc AND ("Bill-to Customer No." <> '') THEN
        CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ProjectAddressCodeOnAfterValid@19042697();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OrderNoCustomerOnAfterValidate@19028010();
    VAR
      lvSettleRec@1100485000 : Record 11012021;
    BEGIN
      //**4PS01.sn
      //Update automatic generated Settlement Sheet with new order number
      IF lvSettleRec.GET("No.", "Bill-to Customer No.", '1', '1') THEN BEGIN
        IF (lvSettleRec."Order No. Customer" = xRec."Order No. Customer") OR
           (lvSettleRec."Order No. Customer" = '') THEN BEGIN
            //only update if not already overwritten with another number.
            lvSettleRec."Order No. Customer" := "Order No. Customer";
            lvSettleRec.MODIFY;
        END;
      END;
      //**4PS01.en
    END;

    LOCAL PROCEDURE ActionbyOnAfterValidate@19077937();
    BEGIN
      FillActionByName();
    END;

    LOCAL PROCEDURE SiteManagerC1210190105OnAfterV@19021044();
    BEGIN
      CALCFIELDS("Name Site Manager");
    END;

    LOCAL PROCEDURE CommisionDatePrincipalC1100485@19031206();
    VAR
      lvSettleRec@1100485000 : Record 11012021;
    BEGIN
      //**4PS02.sn
      //Update automatic generated Settlement Sheet with new order number
      IF lvSettleRec.GET("No.", "Bill-to Customer No.", '1', '1') THEN BEGIN
        IF (lvSettleRec."Commision Date Principal" = xRec."Commision Date Principal") OR
           (lvSettleRec."Commision Date Principal" = 0D) THEN BEGIN
            //only update if not already overwritten with another number.
            lvSettleRec."Commision Date Principal" := "Commision Date Principal";
            lvSettleRec.MODIFY;
        END;
      END;
      //**4PS02.en
    END;

    LOCAL PROCEDURE EstateOwnerC1100485053OnAfterV@19006846();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE UrgencyCodeC1100485058OnAfterV@19043651();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ContractTypeOnAfterValidate@19077313();
    BEGIN
      CurrPage.UPDATE(TRUE);
      IF "Contract Type" = "Contract Type"::Maincontracting THEN BEGIN
        "% Labor" := 0;
        "% to B Account" :=0;
      END;
    END;

    LOCAL PROCEDURE SettlementMethodOnAfterValidat@19029111();
    BEGIN
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ProjectManagerOnAfterValidate@19053768();
    BEGIN
      CALCFIELDS("Name Project Manager");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE EstimatorOnAfterValidate@19077849();
    BEGIN
      CALCFIELDS("Name Estimator");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE SiteManagerC1100485071OnAfterV@19010149();
    BEGIN
      CALCFIELDS("Name Site Manager");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE ProjectEngineerOnAfterValidate@19046031();
    BEGIN
      //**4PS
      CALCFIELDS("Name Project Engineer");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE RecoverableCostsOnAfterValidat@19001148();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE RegularCostsOnAfterValidate@19059904();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SingleMainSubProjectOnAfterVal@19021142();
    BEGIN
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ProjectTypeOnAfterValidate@19063423();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE UrgencyCodeC1210190058OnAfterV@19028422();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE EstateOwnerC1210190083OnAfterV@19046510();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      lvCostPlusRec@1210190000 : Record 11012019;
      lvProjOperRec@1210190001 : Record 11012094;
      RecRef@1100529900 : RecordRef;
    BEGIN
      xRec := Rec;
      SETRANGE("Project Filter", "No.");
      "% LaborEditable" := ("Contract Type" = "Contract Type"::Subcontracting);
      "% to B AccountEditable" := ("Contract Type" = "Contract Type"::Subcontracting);
      "Main ProjectEditable" := ("Single/Main/Sub Project" = "Single/Main/Sub Project"::"Sub Project");
      "Calculate B Amounts based onED" := (("Contract Type" = "Contract Type"::Subcontracting) AND
                                                       ("Settlement Method" = "Settlement Method"::"Cost Plus"));
      SetPlantJobOrderFieldsEditable();
      lvProjOperRec.CalculateOperationTotal("No.",TotalOperation, TotalCost);

      TotalSettlDec := 0;
      lvCostPlusRec.SETRANGE("Project No.","No.");
      IF lvCostPlusRec.FINDSET THEN BEGIN
        REPEAT
          TotalSettlDec := TotalSettlDec + (lvCostPlusRec.Quantity * lvCostPlusRec."Sales Price (LCY)");
        UNTIL lvCostPlusRec.NEXT = 0;
      END;
      DetermineExecutionDate;

      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(FALSE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");
    END;

    LOCAL PROCEDURE ExpediterOnAfterValidate@19017853();
    BEGIN
      //**4PS
      CALCFIELDS("Name Expediter");
    END;

    BEGIN
    END.
  }
}

