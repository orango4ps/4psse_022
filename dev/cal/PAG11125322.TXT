OBJECT Page 11125322 Estimate Card
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Estimate;
               NOR=Kalkyle;
               SVE=Kalkyl];
    SourceTable=Table11012151;
    SourceTableView=WHERE(RAW Estimate=CONST(No));
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Mail Documents,Calculation;
                                NOR=Ny,Behandle,Rapport,Send dokument;
                                SVE=Ny,Behandla,Rapport,Maila dokument];
    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 EstSetup.GET;
                 IF EstSetup."Rates Based On" = EstSetup."Rates Based On"::"Rate Group" THEN
                   RateEditable := TRUE
                 ELSE
                   RateEditable := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       SETRANGE("No.");
                       SurchargeEditable := ("Surcharge Method" <> "Surcharge Method"::Summary);  //DP02080
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02

                  EstSetup.GET;
                  SurchargeEditable := (EstSetup."Surcharge Method" <> EstSetup."Surcharge Method"::Summary);  //DP02080
                  CheckEstimateTemplate;  //DP02264
                END;

    OnInsertRecord=VAR
                     xRecRef@1100528900 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnAfterGetCurrRecord=VAR
                           RecRef@1100528900 : RecordRef;
                         BEGIN
                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");

                           TotalCost := "Labor Cost Amount" + "Material Cost Amount" + "Subcontracting Cost Amount" +
                             "Plant Cost Amount" + "Sundry Cost Amount";  //DP00381
                           TotalSales := "Labor Sales Amount" + "Material Sales Amount" + "Subcontracting Sales Amount" +
                             "Plant Sales Amount" + "Sundry Sales Amount";  //DP00381
                         END;

    ActionList=ACTIONS
    {
      { 1100528902;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100529055;1 ;ActionGroup;
                      CaptionML=[ENU=Amounts;
                                 NOR=Belõp;
                                 SVE=Belopp];
                      Image=Costs }
      { 1100528996;2 ;Action    ;
                      Name=&Rates;
                      CaptionML=[ENU=&Rates;
                                 NOR=&Avgifter;
                                 SVE=&Avgifter];
                      RunObject=Page 11012168;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Cost;
                      PromotedCategory=Category5 }
      { 1100528600;2 ;Action    ;
                      CaptionML=[ENU=Exchange Rates;
                                 NOR=Valutakurser;
                                 SVE=Byt avgifter];
                      RunObject=Page 11229324;
                      RunPageLink=Estimate Filter=FIELD(No.);
                      Image=AdjustExchangeRates }
      { 1100528903;2 ;Action    ;
                      Name=OfferAmounts;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Offer Amounts;
                                 NOR=Tilbudsbelõp;
                                 SVE=Anbudsbelopp];
                      RunObject=Page 11229778;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Promoted=Yes;
                      Image=ContractPayment;
                      PromotedCategory=Category5 }
      { 1100529054;2 ;Action    ;
                      Name=Target Amounts;
                      CaptionML=ENU=Target Amounts;
                      Image=ContractPayment;
                      OnAction=BEGIN
                                 ShowTargetAmount;  //db, 01-05-20
                               END;
                                }
      { 1100528907;2 ;Action    ;
                      CaptionML=[ENU=Product Discount;
                                 SVE=Produktrabatt];
                      RunObject=Page 11129870;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Image=LineDiscount }
      { 1100529017;2 ;Action    ;
                      Name=SalesPrices;
                      CaptionML=ENU=Sales Prices by Estimate;
                      Image=SalesPrices;
                      OnAction=BEGIN
                                 ActivateSalesPrices;  //DP02089
                               END;
                                }
      { 1100285101;2 ;Action    ;
                      Name=Summary (Cost);
                      CaptionML=[DEU=Zusammenfassung (Kosten);
                                 ENU=Summary (Cost);
                                 NLD=Staartblad (kosten);
                                 NOR=Sum (kost);
                                 SVE=Summa (kostnad)];
                      RunObject=Page 11012202;
                      RunPageLink=Estimate No.=FIELD(No.),
                                  Summary Type=CONST(Cost);
                      Promoted=Yes;
                      Image=Worksheet;
                      PromotedCategory=Category4 }
      { 1100285100;2 ;Action    ;
                      Name=Summary (Sales);
                      CaptionML=[DEU=Endblatt (Angebotsbetrag);
                                 ENU=Summary (Sales);
                                 NLD=Staartblad (verkoop);
                                 NOR=Sum (salg);
                                 SVE=Summa (fîrsÑljning)];
                      RunObject=Page 11012202;
                      RunPageLink=Estimate No.=FIELD(No.),
                                  Summary Type=CONST(Sales);
                      Promoted=Yes;
                      Image=Worksheet;
                      PromotedCategory=Category4 }
      { 1100529056;1 ;ActionGroup;
                      CaptionML=[ENU=Persons;
                                 NOR=Personer;
                                 SVE=Personer];
                      Image=ContactPerson }
      { 1100528998;2 ;Action    ;
                      Name=Principals;
                      CaptionML=[ENU=Principals;
                                 NOR=oppdragsgiver;
                                 SVE=Uppdragsgivare];
                      RunObject=Page 11012173;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Image=TeamSales }
      { 1100528997;2 ;Action    ;
                      Name=Responsible Persons;
                      CaptionML=[ENU=Responsible Persons;
                                 NOR=Ansvarlige personer;
                                 SVE=Ansvariga personer];
                      RunObject=Page 11012169;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Image=Users }
      { 1100529057;1 ;ActionGroup;
                      CaptionML=[ENU=Try-out;
                                 NOR=Prospekt;
                                 SVE=Anbud];
                      Image=Quote }
      { 1100529005;2 ;Action    ;
                      Name=Try-out;
                      CaptionML=[ENU=Try-out;
                                 NOR=Prospekt;
                                 SVE=Anbud];
                      Image=Document;
                      OnAction=BEGIN
                                 ShowTryOut(1);
                               END;
                                }
      { 1100529006;2 ;Action    ;
                      Name=Try-out &Quote;
                      CaptionML=[ENU=Try-out &Quote;
                                 NOR=T&ilbudsforespõrsel;
                                 SVE=A&nbudsfîrfrÜgan];
                      Image=Quote;
                      OnAction=BEGIN
                                 ShowTryOut(2);
                               END;
                                }
      { 1100525000;1 ;ActionGroup;
                      CaptionML=[ENU=Estimate;
                                 NOR=Kalkyle;
                                 SVE=Kalkyl];
                      Image=Calculate }
      { 1100528911;2 ;Action    ;
                      Name=Estimate Index;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Estimate Index;
                                 NOR=Kalkuler Index;
                                 SVE=Kalkylindex];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=BOMVersions;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 ShowIndex("No.",'','','',FALSE);  //DP00909
                               END;
                                }
      { 1100528512;2 ;Action    ;
                      Name=SubEstimate;
                      ShortCutKey=Shift+Ctrl+S;
                      CaptionML=ENU=Sub-Estimate;
                      Promoted=Yes;
                      Image=Split;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 EstimateManagementRTC@1100525000 : Codeunit 11130010;
                               BEGIN
                                 EstimateManagementRTC.EditViewSubEstimates("No.", '');  //C050280
                               END;
                                }
      { 1100529010;2 ;Action    ;
                      Name=Estimate Lines;
                      ShortCutKey=Ctrl+B;
                      CaptionML=[ENU=Estimate Lines;
                                 NOR=Kalkylerader;
                                 SVE=Kalkylrader];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Calculate;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 StartEstimateLines;  //DP00909
                               END;
                                }
      { 1100528401;2 ;Action    ;
                      Name=Estimate Recipes;
                      CaptionML=ENU=Estimate Recipes;
                      Image=List;
                      OnAction=VAR
                                 EstimateLine@1100528400 : Record 11072072;
                                 EstimateLineList@1100528401 : Page 11125325;
                               BEGIN
                                 EstimateLine.SETRANGE("Estimate No.", "No.");
                                 EstimateLine.SETFILTER("Recipe Group", STRSUBSTNO('<>%1', ''''''));
                                 EstimateLine.SETFILTER(Recipe, STRSUBSTNO('<>%1', ''''''));
                                 EstimateLineList.SETTABLEVIEW(EstimateLine);
                                 EstimateLineList.RUN;
                               END;
                                }
      { 1100529003;2 ;Action    ;
                      Name=Summaries;
                      CaptionML=[ENU=Summaries;
                                 NOR=Sammendrag;
                                 SVE=Sammandrag];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Worksheet;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CheckSummaryPresent;  //db, 25-05-10: M19426
                               END;
                                }
      { 1100528904;2 ;Action    ;
                      Name=Co&mments;
                      CaptionML=[ENU=Co&mments;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Estimate),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1100529502;1 ;ActionGroup;
                      CaptionML=[ENU=Other;
                                 NOR=ùvrige;
                                 SVE=ôvriga];
                      Image=Documents }
      { 1100529501;2 ;Action    ;
                      Name=PurchaseAction;
                      CaptionML=[ENU=Purchase Actions;
                                 NOR=Innkjõpshandlinger;
                                 SVE=InkîpsÜtgÑrder];
                      RunObject=Page 11072274;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Image=Document }
      { 1100529500;2 ;Action    ;
                      Name=ProvisionalWork;
                      CaptionML=[ENU=Provisional Work;
                                 NOR=Provisorisk arbeid;
                                 SVE=Provisoriskt arbete];
                      Image=ServiceItemWorksheet;
                      OnAction=VAR
                                 ProvWorkRec@1100485000 : Record 11012774;
                               BEGIN
                                 ProvWorkRec."No." := "No.";
                                 ProvWorkRec.SETRANGE("No.", "No.");
                                 IF NOT ProvWorkRec.FINDFIRST THEN BEGIN
                                   ProvWorkRec."No." := "No.";
                                   ProvWorkRec.Description := Description;
                                   ProvWorkRec."Job No." := "Project No.";
                                   ProvWorkRec."Contact No." := "Contact No.";
                                   ProvWorkRec.Estimator := Estimator;
                                   ProvWorkRec.INSERT;
                                   COMMIT;
                                 END;
                                 PAGE.RUNMODAL(PAGE::"Provisional Work Card", ProvWorkRec);
                               END;
                                }
      { 1100528999;2 ;Action    ;
                      Name=House &Models;
                      CaptionML=[ENU=House &Models;
                                 NOR=Hus&modeller;
                                 SVE=Hus&modeller];
                      RunObject=Page 11012251;
                      RunPageLink=Estimate No.=FIELD(No.);
                      Image=Warehouse }
      { 1100529004;2 ;Action    ;
                      Name=Graph;
                      CaptionML=[ENU=Graph;
                                 NOR=Graf;
                                 SVE=Diagram];
                      Image=AnalysisView;
                      OnAction=BEGIN
                                 CUGraph.Estimate(Rec);
                               END;
                                }
      { 1100529007;2 ;Action    ;
                      Name=Documents;
                      CaptionML=[ENU=&Documents;
                                 NOR=&Dokumenter;
                                 SVE=&Dokument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1100528901 : RecordRef;
                                 DocumentFilters@1100528900 : Codeunit 11012432;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1100529000;2 ;Action    ;
                      Name=To-dos;
                      CaptionML=[ENU=To-dos;
                                 NOR=Oppgaver;
                                 SVE=Uppgifter];
                      RunObject=Page 5096;
                      RunPageView=SORTING(Estimate No.,Date,Closed);
                      RunPageLink=Estimate No.=FIELD(No.),
                                  System To-do Type=CONST(Organizer);
                      Image=NewToDo }
      { 1100528301;1 ;ActionGroup;
                      CaptionML=ENU=SH;
                      Image=Alerts }
      { 1100528300;2 ;Action    ;
                      CaptionML=[ENU=Standard Workplans;
                                 SVE=Standardarbetsplaner];
                      Image=PlanningWorksheet;
                      OnAction=VAR
                                 SHWorkplan@1100528300 : Record 11126011;
                               BEGIN
                                 SHWorkplan.FILTERGROUP(9);
                                 SHWorkplan.SETRANGE("Source Type", SHWorkplan."Source Type"::Estimate);
                                 SHWorkplan.SETRANGE("Source Code", "No.");
                                 SHWorkplan.FILTERGROUP(9);
                                 PAGE.RUNMODAL(PAGE::"SH Standard Workplans", SHWorkplan);
                               END;
                                }
      { 1100529008;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100529039;1 ;ActionGroup;
                      CaptionML=ENU=Copy+Transfer;
                      Image=Copy }
      { 1100529036;2 ;Action    ;
                      Name=CopyEstimate;
                      CaptionML=[ENU=Copy Estimate;
                                 NOR=Kopier kalkyle;
                                 SVE=Kopiera kalkyl];
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 StartCopyEstimate(FALSE);  //C027531: db, 24-12-15
                               END;
                                }
      { 1100529038;2 ;Action    ;
                      Name=TransferEstimateToProject;
                      CaptionML=[ENU=Copy Estimate to Project Budget;
                                 NOR=Kopier kalkyle til prosjektbudsjett;
                                 SVE=Kopiera kalkyl till projektbudget];
                      RunObject=Page 11012187;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Process }
      { 1100529037;2 ;Action    ;
                      Name=TransferEstimateToService;
                      CaptionML=[ENU=Copy Estimate to Service;
                                 NOR=Kopier kalkyle til service;
                                 SVE=Kopiera kalkyl till service];
                      Image=Copy;
                      OnAction=VAR
                                 ServiceSetup@1100528600 : Record 11012800;
                                 FPSLicenseManagement@1100527400 : Codeunit 11229289;
                               BEGIN
                                 IF FPSLicenseManagement.LicenseAndReadPermissionForTable(ServiceSetup) THEN
                                   ServiceSetup.GET;

                                 PAGE.RUN(PAGE::"Transfer Estimate to Service", Rec);
                               END;
                                }
      { 1100529041;2 ;Action    ;
                      Name=GenerateSubEstimateByModel;
                      CaptionML=[ENU=Generate Sub-Estimate based on Model;
                                 NOR=Generer Delkalkyle basert pÜ Modell;
                                 SVE=Generera delkalkyl baserat pÜ modell];
                      Image=CreateRating;
                      OnAction=BEGIN
                                 StartCopySubEstimateByModel(FALSE);  //C027729: db, 24-12-15
                               END;
                                }
      { 1100525006;2 ;Action    ;
                      Name=GenerateSummaryBySubEstimate;
                      CaptionML=ENU=Generate Summary By Sub-Estimate;
                      Image=CreateRating;
                      OnAction=VAR
                                 CopySheet@1100525000 : Page 11012239;
                               BEGIN
                                 //db, 25-06-15: C024158
                                 CopySheet.SetSelectionSummarySubEstimate("No.", "Summary (Cost)");
                                 CopySheet.GenerateSummary;
                                 CopySheet.SetSelectionSummarySubEstimate("No.", "Summary (Sales)");
                                 CopySheet.GenerateSummary;
                               END;
                                }
      { 1100525010;2 ;Action    ;
                      Name=GeneratePlantNeed;
                      CaptionML=[ENU=Generate Plant Need;
                                 NOR=Generer maskinbehov;
                                 SVE=Generera Maskinsbehov];
                      Image=ResourcePlanning;
                      OnAction=VAR
                                 EstimatePlantMgt@1100525000 : Codeunit 11012232;
                               BEGIN
                                 EstimatePlantMgt.GeneratePlantNeed("No.");  //db, 17-05-16
                               END;
                                }
      { 1100529042;2 ;Action    ;
                      Name=Export CUF-XML budget;
                      CaptionML=[ENU=Export CUF-XML budget;
                                 NOR=Eksporter CUF-XML-budsjett;
                                 SVE=Exportera CUF-XML-budget];
                      RunObject=Page 11012393;
                      RunPageLink=No.=FIELD(No.);
                      Image=ExportFile }
      { 1100529035;1 ;ActionGroup;
                      CaptionML=[ENU=Update;
                                 NOR=Oppdater;
                                 SVE=Uppdatera];
                      Image=RefreshText }
      { 1100529034;2 ;Action    ;
                      CaptionML=[ENU=Update Norms and Prices;
                                 NOR=Oppdater normer og priser;
                                 SVE=Uppdatera normer och priser];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(1);
                               END;
                                }
      { 1100529033;2 ;Action    ;
                      CaptionML=[ENU=Adjust Prices with &Percentage;
                                 NOR=Juster priser med &prosent;
                                 SVE=Justera priser med &procent];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(2);
                               END;
                                }
      { 1100529032;2 ;Action    ;
                      CaptionML=[ENU=Update &Discount Percentage;
                                 NOR=Oppdater &Rabattprosent;
                                 SVE=Upp&datera rabattprocent];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(3);
                               END;
                                }
      { 1100529031;2 ;Action    ;
                      CaptionML=[ENU=Update From Selected Quote;
                                 NOR=Oppdater fra valgt tilbud;
                                 SVE=Uppdatera frÜn vald offert];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(4);
                               END;
                                }
      { 1100529030;2 ;Action    ;
                      CaptionML=[ENU=Update &Recipes;
                                 NOR=Oppdater &kvitteringer];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(6);  //db, 18-01-13: DP00258
                               END;
                                }
      { 1100528906;2 ;Action    ;
                      CaptionML=ENU=Update Sales From Cost;
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(7);  //db, 14-01-15: C020101
                               END;
                                }
      { 1100525017;2 ;Action    ;
                      Name=UpdateExchangeRate;
                      CaptionML=ENU=Update Currency Exchange Rate;
                      Image=CurrencyExchangeRates;
                      OnAction=BEGIN
                                 UpdateMgt.UpdateExchangeRate("No.");  //C054524
                               END;
                                }
      { 1100529029;1 ;ActionGroup;
                      CaptionML=[ENU=Substitute Collectively;
                                 NOR=Erstatt kollektivt;
                                 SVE=ErsÑtt kollektivt];
                      Image=RefreshText }
      { 1100529028;2 ;Action    ;
                      CaptionML=[ENU=Substitute &Rate collectively;
                                 NOR=Erstatt &Avgift kollektivt;
                                 SVE=ErsÑtt &avgift kollektivt];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(1);
                               END;
                                }
      { 1100529027;2 ;Action    ;
                      CaptionML=[ENU=Substitute &Norm Group collectively;
                                 NOR=Erstatt &Normgruppe kollektivt;
                                 SVE=ErsÑtt &normgrupp kollektivt];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(2);
                               END;
                                }
      { 1100529026;2 ;Action    ;
                      CaptionML=[ENU=Substitute &Condition collectively;
                                 NOR=Erstatt &betingelse kollektivt;
                                 SVE=ErsÑtt &villkor kollektivt];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(3);
                               END;
                                }
      { 1100529025;2 ;Action    ;
                      CaptionML=[ENU=Substitute Vendor collectively;
                                 NOR=Erstatt leverandõr kollektivt;
                                 SVE=ErsÑtt leverantîr kollektivt];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(4);
                               END;
                                }
      { 1100529024;2 ;Action    ;
                      CaptionML=[ENU=Substitute Discount Term Group collectively;
                                 NOR=Erstatt rabattvilkÜrsgruppe kollektivt;
                                 SVE=ErsÑtt rabattvillkorsgrupp kollektivt];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(5);
                               END;
                                }
      { 1100529023;2 ;Action    ;
                      CaptionML=[ENU=Substitute Item collectively;
                                 NOR=Erstatt artikkel kollektivt;
                                 SVE=ErsÑtt artikel kollektivt];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(6);
                               END;
                                }
      { 1100529022;2 ;Action    ;
                      CaptionML=[ENU=Substitute Recipe collectively;
                                 NOR=Erstatt mal kollektivt;
                                 SVE=ErsÑtt mall kollektivt];
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(7);
                               END;
                                }
      { 1100528603;2 ;Action    ;
                      CaptionML=ENU=Substitute Currency Code collectively;
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(8);
                               END;
                                }
      { 1100529002;2 ;Action    ;
                      CaptionML=ENU=Substitute Element collectively;
                      Image=RefreshText;
                      OnAction=BEGIN
                                 ActivateReplaceFunctions(9);  //DP01931
                               END;
                                }
      { 1100525014;1 ;ActionGroup;
                      CaptionML=[ENU=&Estimate;
                                 NOR=&Kalkyle;
                                 SVE=&Kalkyl] }
      { 1100529021;2 ;ActionGroup;
                      CaptionML=[ENU=Estimate;
                                 NOR=Kalkyle;
                                 SVE=Kalkyl];
                      Image=Calculate }
      { 1100529020;3 ;Action    ;
                      Name=CalculateEstimate;
                      ShortCutKey=F9;
                      CaptionML=[ENU=Calculate Estimate;
                                 NOR=Prosseser kalkyle;
                                 SVE=Processkalkyl];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CalculatePlan;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 UpdateMgt.UpdateTotals("No.", '', '', TRUE);
                               END;
                                }
      { 1100528916;3 ;Action    ;
                      Name=InitCostPrice;
                      CaptionML=ENU=Initialize Full Cost Price;
                      Promoted=Yes;
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 EstimateOfferAmount@1100528900 : Page 11229778;
                               BEGIN
                                 EstimateOfferAmount.CallReport(FALSE,FALSE,"No.",'');  //C054400
                               END;
                                }
      { 1100528915;3 ;Action    ;
                      Name=InitSalesPrice;
                      CaptionML=ENU=Initialize Full Sales Price;
                      Promoted=Yes;
                      Image=CalculateSalesTax;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 EstimateOfferAmount@1100528900 : Page 11229778;
                               BEGIN
                                 EstimateOfferAmount.CallReport(TRUE,FALSE,"No.",'');  //C054400
                               END;
                                }
      { 1100529014;3 ;Action    ;
                      Name=ActivateFullCostPrice;
                      CaptionML=[ENU=Full Cost Price (on/off);
                                 SVE=Snabbtilldela inkîpsÜtgÑrder];
                      Image=GetBinContent;
                      OnAction=BEGIN
                                 EstLineRec.ActivateCheckFullCostPrice;  //C057346
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100529044;3 ;Action    ;
                      Name=Delete Zero Lines;
                      CaptionML=[ENU=Delete Zero Lines;
                                 NOR=Fjerne Nullrader;
                                 SVE=Ta bort nollrader];
                      Image=CancelLine;
                      OnAction=BEGIN
                                 ActivateUpdateFunctions(5);
                               END;
                                }
      { 1100529045;3 ;Action    ;
                      Name=Edit Compressed Estimate;
                      CaptionML=[ENU=Edit Compressed Estimate;
                                 NOR=Rediger komprimert kalkyle;
                                 SVE=Redigera komprimerad kalkyl];
                      Image=Compress;
                      OnAction=BEGIN
                                 EstLineRec.SETRANGE("Estimate No.", "No.");
                                 REPORT.RUNMODAL(REPORT::"Select Estimate Lines", TRUE, FALSE, EstLineRec);
                               END;
                                }
      { 1100529043;3 ;Action    ;
                      Name=Calculate Removal Contribution;
                      CaptionML=[ENU=Calculate Removal Contribution;
                                 NOR=Beregn Fjerningsbidrag;
                                 SVE=BerÑkna borttagningsbidrag];
                      Image=CalculatePlanChange;
                      OnAction=BEGIN
                                 UpdateMgt.DetermineRemovalContribution(0, "No.", '', '', '', '', '');
                               END;
                                }
      { 1100528905;3 ;Action    ;
                      Name=Calculate Product Discount;
                      CaptionML=ENU=Calculate Product Discount;
                      Image=LineDiscount;
                      OnAction=VAR
                                 Estimate@1100528900 : Record 11012151;
                                 ProductDiscountMgt@1100528901 : Codeunit 11012308;
                               BEGIN
                                 Estimate.SETRANGE("No.", "No.");
                                 ProductDiscountMgt.CalculateDiscountEstimate(Estimate);  //DP01727
                               END;
                                }
      { 1100529019;3 ;Action    ;
                      CaptionML=[ENU=Reshuffle Estimate Lines;
                                 NOR=Stokk om kalkylerader;
                                 SVE=Blanda om kalkylrader];
                      Image=RefreshLines;
                      OnAction=BEGIN
                                 UpdateMgt.ReshuffleLines("No.");
                               END;
                                }
      { 1100529016;3 ;Action    ;
                      CaptionML=[ENU=Initialize Adjustment Factor;
                                 NOR=Initier Justeringsfaktor;
                                 SVE=Initiera justeringsfaktor];
                      Image=CalculateWarehouseAdjustment;
                      OnAction=BEGIN
                                 TESTFIELD(Fixed, FALSE);
                                 UpdateMgt.ResetAdjustmentFactor("No.", '', '', '', 0, TRUE, 0, 0, 0);  //DP00555
                               END;
                                }
      { 1100529015;3 ;Action    ;
                      CaptionML=[ENU=Round Item Quantity;
                                 NOR=Avrundet artikkelantall;
                                 SVE=Avrundat artikelantal];
                      Image=Components;
                      OnAction=VAR
                                 UpdateRep@1210190000 : Report 11229774;
                               BEGIN
                                 //X007
                                 UpdateRep.SetSelection("No.");
                                 EstLineRec.SETRANGE("Estimate No.", "No.");
                                 UpdateRep.SETTABLEVIEW(EstLineRec);
                                 UpdateRep.RUNMODAL;
                                 CLEAR(UpdateRep);
                                 CurrPage.UPDATE(FALSE);  //db, 21-03-14
                               END;
                                }
      { 1100529013;2 ;ActionGroup;
                      CaptionML=[ENU=Coding;
                                 NOR=Koding;
                                 SVE=Kodning];
                      Image=ItemTrackingLedger }
      { 1100529012;3 ;Action    ;
                      CaptionML=[ENU=Estimate Lines;
                                 NOR=Kalkylerader;
                                 SVE=Kalkylrader];
                      Image=AllLines;
                      OnAction=BEGIN
                                 CheckUncodedLines(1);
                               END;
                                }
      { 1100529011;3 ;Action    ;
                      CaptionML=[ENU=Recipe Lines;
                                 NOR=Malrader;
                                 SVE=Mallrader];
                      Image=GetLines;
                      OnAction=BEGIN
                                 CheckUncodedLines(2);
                               END;
                                }
      { 1100525015;1 ;ActionGroup;
                      CaptionML=[ENU=Other;
                                 NOR=ùvrige;
                                 SVE=ôvriga] }
      { 1100528303;2 ;ActionGroup;
                      CaptionML=ENU=SH;
                      Image=Alerts }
      { 1100528302;3 ;Action    ;
                      CaptionML=ENU=Generate Standard Workplan;
                      Image=PlanningWorksheet;
                      OnAction=VAR
                                 SHCopyManagement@1100528300 : Codeunit 11125987;
                               BEGIN
                                 SHCopyManagement.GenerateStandardWorkplanFromEstimate(Rec);
                               END;
                                }
      { 1100527004;2 ;ActionGroup;
                      CaptionML=[ENU=Mail Documents;
                                 NOR=Send dokumenter;
                                 SVE=E-postdokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Email }
      { 1100527002;3 ;Action    ;
                      CaptionML=[ENU=Contact;
                                 NOR=Kontakt;
                                 SVE=Kontakt];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Contact@1100527000 : Record 5050;
                               BEGIN
                                 TESTFIELD("Contact No.");
                                 IF Contact.GET("Contact No.") THEN
                                   EditDocuments(Contact."No.", '', TRUE, Contact."E-Mail");
                               END;
                                }
      { 1100527001;3 ;Action    ;
                      CaptionML=[ENU=Contact Person;
                                 NOR=Kontaktperson;
                                 SVE=Kontaktperson];
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Contact@1100527000 : Record 5050;
                               BEGIN
                                 TESTFIELD("Contact Person No.");
                                 IF Contact.GET("Contact Person No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail");
                                 END;
                               END;
                                }
      { 1100529009;3 ;Action    ;
                      Name=Estimate Documents;
                      CaptionML=[ENU=Estimate Documents;
                                 NOR=Rediger Word-dokument;
                                 SVE=Redigera Word-dokument];
                      Image=Word;
                      OnAction=BEGIN
                                 TESTFIELD("Contact No.");
                                 EditDocuments("Contact No.", "Contact Person No.", FALSE, '');
                               END;
                                }
      { 1100529050;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1100529049;1 ;Action    ;
                      CaptionML=ENU=Estimate Reports;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 SetFilterPrintDoc(0);
                               END;
                                }
      { 1100529048;1 ;Action    ;
                      CaptionML=[ENU=Sub-Estimate Reports;
                                 SVE=Delkalkyler, rapporter];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 SetFilterPrintDoc(1);
                               END;
                                }
      { 1100529047;1 ;Action    ;
                      CaptionML=ENU=Estimate &Part Reports;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 SetFilterPrintDoc(2);
                               END;
                                }
      { 1100529046;1 ;Action    ;
                      CaptionML=ENU=Estimate &Lines Reports;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 SetFilterPrintDoc(3);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1100528986;0;Container;
                ContainerType=ContentArea }

    { 1100528985;1;Group  ;
                CaptionML=[ENU=General;
                           NOR=Generell;
                           SVE=AllmÑnt] }

    { 1100528984;2;Field  ;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1100528983;2;Field  ;
                SourceExpr=Description }

    { 1100528982;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE }

    { 1100528970;2;Field  ;
                SourceExpr="Contact No.";
                Importance=Additional;
                OnValidate=BEGIN
                             EvaluateRelation;  //db, 15-01-09
                           END;
                            }

    { 1100528969;2;Field  ;
                SourceExpr="Contact Name";
                Editable=FALSE }

    { 1100528968;2;Field  ;
                SourceExpr="Contact Person No.";
                Importance=Additional;
                OnValidate=BEGIN
                             CALCFIELDS("Contact Person Name","Contact Person Gender");
                           END;
                            }

    { 1100528967;2;Field  ;
                SourceExpr="Contact Person Name";
                Editable=FALSE }

    { 1100528981;2;Field  ;
                SourceExpr=Address;
                Visible=FALSE;
                Editable=TRUE }

    { 1100528980;2;Field  ;
                SourceExpr="Post Code";
                Visible=FALSE;
                Editable=TRUE }

    { 1100528979;2;Field  ;
                SourceExpr=City;
                Visible=FALSE;
                Editable=TRUE }

    { 1100528978;2;Field  ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 1100528966;2;Field  ;
                SourceExpr="Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             EvaluateRelation;  //db, 15-01-09
                           END;
                            }

    { 1100528965;2;Field  ;
                SourceExpr="Customer Name";
                Importance=Promoted;
                Editable=FALSE }

    { 1100528974;2;Field  ;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                Visible=FALSE }

    { 1100528973;2;Field  ;
                SourceExpr="Purchaser Name";
                Importance=Additional;
                Visible=FALSE }

    { 1100528972;2;Field  ;
                SourceExpr="Consultancy Firm No.";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             CALCFIELDS("Consultancy Firm Name");
                           END;
                            }

    { 1100528971;2;Field  ;
                SourceExpr="Consultancy Firm Name";
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100527000;2;Field  ;
                SourceExpr="Contact Person Gender";
                Importance=Additional;
                Visible=FALSE }

    { 1100528964;2;Field  ;
                SourceExpr="Customer Disc. Group";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100528962;2;Field  ;
                SourceExpr="Order No. Customer" }

    { 1100528963;2;Field  ;
                SourceExpr="Tender No." }

    { 1100528961;2;Field  ;
                SourceExpr="Search Name";
                Visible=FALSE }

    { 1100528960;2;Field  ;
                SourceExpr="Territory Code";
                Importance=Additional;
                Visible=FALSE }

    { 1100528959;2;Field  ;
                SourceExpr=Type;
                Importance=Additional;
                Visible=FALSE }

    { 1100528958;2;Field  ;
                SourceExpr=Discipline;
                Importance=Additional }

    { 1100528957;2;Field  ;
                SourceExpr=Condition;
                Importance=Additional;
                Visible=FALSE }

    { 1100528956;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1100528976;2;Field  ;
                SourceExpr=Estimator;
                OnValidate=BEGIN
                             CALCFIELDS("Name Estimator");
                           END;
                            }

    { 1100528975;2;Field  ;
                SourceExpr="Name Estimator";
                Editable=FALSE }

    { 1100528955;2;Field  ;
                SourceExpr=Status }

    { 1100409007;2;Field  ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 1100528954;1;Group  ;
                CaptionML=[ENU=Data;
                           NOR=Data;
                           SVE=Data] }

    { 1100528953;2;Field  ;
                SourceExpr="Creation Date";
                Importance=Promoted;
                Visible=FALSE }

    { 1100529001;2;Field  ;
                SourceExpr="Created by";
                Visible=FALSE }

    { 1100528952;2;Field  ;
                SourceExpr="Last Date Modified";
                Importance=Additional }

    { 1100528951;2;Field  ;
                SourceExpr="Last Time Modified";
                Visible=FALSE }

    { 1100528950;2;Field  ;
                SourceExpr="Modified by" }

    { 1100529051;2;Field  ;
                SourceExpr="Last Date Recalculated" }

    { 1100529052;2;Field  ;
                SourceExpr="Last Time Recalculated" }

    { 1100528949;2;Field  ;
                SourceExpr="Starting Date" }

    { 1100528948;2;Field  ;
                SourceExpr="Ending Date" }

    { 1100409006;2;Field  ;
                SourceExpr="Register Date" }

    { 1100528946;2;Field  ;
                SourceExpr="Tender Date" }

    { 1100529900;2;Field  ;
                SourceExpr="Expected Est. Completion Date" }

    { 1100528944;2;Field  ;
                SourceExpr="Reference Date (Item)";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100528945;2;Field  ;
                SourceExpr="Reference Date (Rate)";
                Importance=Promoted;
                Editable=FALSE }

    { 1100529018;2;Field  ;
                SourceExpr="Reference Date (Sales Price)";
                OnValidate=BEGIN
                             //DP02089
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateSalesPrices;
                             END;
                           END;
                            }

    { 1100528943;2;Field  ;
                DrillDown=No;
                SourceExpr="Reference Date (Customer)";
                Importance=Additional;
                Visible=FALSE }

    { 1100528942;2;Field  ;
                DrillDown=No;
                SourceExpr="Reference Date (Company)";
                Importance=Additional;
                Visible=FALSE }

    { 1100528501;2;Field  ;
                SourceExpr="Open Budget Sent on";
                Importance=Additional }

    { 1100528503;1;Group  ;
                CaptionML=ENU=Setup }

    { 1100528908;2;Field  ;
                SourceExpr="Copy Part Lines" }

    { 1100529503;2;Field  ;
                SourceExpr="Apply SurchMat PriceZero Only";
                OnValidate=BEGIN
                             //db, 09-12-16
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100529504;2;Field  ;
                SourceExpr="Apply SalesPrice for SurchMat";
                Importance=Additional;
                OnValidate=BEGIN
                             //db, 09-12-16
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100525001;2;Field  ;
                SourceExpr="Apply Surcharge Recipe";
                Importance=Additional }

    { 1100528500;2;Field  ;
                SourceExpr="Apply Linked Recipe";
                Importance=Additional }

    { 1100528977;2;Field  ;
                SourceExpr="Apply Product Discount";
                Importance=Additional }

    { 1100528929;2;Field  ;
                SourceExpr="Estimate Based On";
                Importance=Additional }

    { 1100528991;2;Field  ;
                SourceExpr="Item Sales Price Based On";
                OnValidate=BEGIN
                             //db, 09-10-14: C018110
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100528511;2;Field  ;
                SourceExpr="Subcontracting in Hours" }

    { 1100525007;2;Field  ;
                SourceExpr="Plant Rates in Hours" }

    { 1100529400;2;Field  ;
                SourceExpr="Plant Company" }

    { 1100525008;2;Field  ;
                SourceExpr="Plant Location";
                Importance=Promoted;
                OnLookup=BEGIN
                           LookupPlantLocation;  //DP02115
                         END;
                          }

    { 1100525009;2;Field  ;
                SourceExpr="Kind of Plant Rate" }

    { 1100528502;1;Group  ;
                CaptionML=ENU=Price and Discount }

    { 1100528601;2;Field  ;
                SourceExpr="Currency Code";
                Importance=Additional;
                OnValidate=BEGIN
                             //DP00883
                             CurrPage.SAVERECORD;
                             SetCurrencySwitchForUpdateLines(xRec."Currency Code", TRUE);  //C054524
                             UpdateBudgetRate;
                           END;
                            }

    { 1100528602;2;Field  ;
                SourceExpr="Report Currency Code";
                Importance=Additional;
                Visible=FALSE }

    { 1100528941;2;Field  ;
                CaptionML=[ENU=Purchase Discount Term Group (Company);
                           NOR=Innkjõp, rabattvilkÜrsgruppe (selskap);
                           SVE=Inkîp, rabattvillkorsgrupp (fîretag)];
                SourceExpr=DiscountTermGroup0;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528940;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 0";
                Importance=Additional;
                Visible=FALSE }

    { 1100528939;2;Field  ;
                SourceExpr="Purch Discount Term Group 1";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100528938;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 1";
                Importance=Additional;
                Visible=FALSE }

    { 1100528937;2;Field  ;
                SourceExpr="Purch Discount Term Group 2";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100528936;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 2";
                Importance=Additional;
                Visible=FALSE }

    { 1100528935;2;Field  ;
                Name=DiscountTermGroup;
                CaptionML=[ENU=Sales Discount Term Group (Company);
                           NOR=Salg, rabattvilkÜrsgruppe (Selskap);
                           SVE=FîrsÑljning, rabattvillkorsgrupp (fîretag)];
                SourceExpr=DiscountTermGroup0;
                Importance=Additional;
                Visible=FALSE;
                Editable=FALSE }

    { 1100528934;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 0";
                Importance=Additional;
                Visible=FALSE }

    { 1100528933;2;Field  ;
                CaptionML=[ENU=Sales Discount Term Group (Customer);
                           NOR=Salg, rabattvilkÜrsgruppe (Kunde);
                           SVE=FîrsÑljning, rabattvillkorsgrupp (kund)];
                SourceExpr="Sales Discount Term Group 1";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100528932;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 1";
                Importance=Additional;
                Visible=FALSE }

    { 1100528931;2;Field  ;
                SourceExpr="Sales Discount Term Group 2";
                Importance=Additional;
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             IF CONFIRM(Text001) = TRUE THEN BEGIN
                               COMMIT;
                               ActivateUpdateFunctions(1);
                             END;
                           END;
                            }

    { 1100528930;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 2";
                Importance=Additional;
                Visible=FALSE }

    { 1100528947;2;Field  ;
                SourceExpr="Surcharge % Labor" }

    { 1100528987;2;Field  ;
                SourceExpr="Surcharge % Material" }

    { 1100528988;2;Field  ;
                SourceExpr="Surcharge % Subcontracting" }

    { 1100528989;2;Field  ;
                SourceExpr="Surcharge % Plant" }

    { 1100528990;2;Field  ;
                SourceExpr="Surcharge % Sundry" }

    { 1100529040;2;Field  ;
                SourceExpr="Surcharge Method";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100528510;2;Field  ;
                SourceExpr="Part (Surcharge)";
                Importance=Additional }

    { 1100528504;2;Field  ;
                SourceExpr="Percentage (GeneralCost)";
                Importance=Additional;
                Editable=SurchargeEditable }

    { 1100528506;2;Field  ;
                SourceExpr="Percentage (ExecutionCost)";
                Importance=Additional;
                Editable=SurchargeEditable }

    { 1100528505;2;Field  ;
                SourceExpr="Percentage (Profit/Risk)";
                Importance=Additional;
                Editable=SurchargeEditable }

    { 1100529053;2;Field  ;
                SourceExpr="Calculate Surcharge on";
                Importance=Additional;
                Editable=SurchargeEditable }

    { 1100528928;1;Group  ;
                CaptionML=[ENU=Other;
                           NOR=ùvrige;
                           SVE=ôvriga] }

    { 1100525002;2;Field  ;
                SourceExpr="Rate Group";
                Editable=RateEditable }

    { 1100528926;2;Field  ;
                SourceExpr="Rate Code";
                OnLookup=BEGIN
                           HandleLookupRateCode;  //db, 07-02-12: M32465
                         END;
                          }

    { 1100528925;2;Field  ;
                SourceExpr="Norm Group";
                Importance=Promoted }

    { 1100528927;2;Field  ;
                SourceExpr="Norm Group (Sales)";
                Importance=Additional }

    { 1100528924;2;Field  ;
                SourceExpr="Recipe Group";
                Importance=Promoted;
                OnLookup=BEGIN
                           LookupRecipeGroup;  //db, 07-02-14: C013041
                         END;
                          }

    { 1100528923;2;Field  ;
                SourceExpr="Part Group";
                Importance=Promoted }

    { 1100528922;2;Field  ;
                SourceExpr="Coding System";
                Importance=Additional;
                Visible=FALSE }

    { 1100528921;2;Field  ;
                SourceExpr=Code;
                Importance=Additional;
                Visible=FALSE }

    { 1100528507;2;Field  ;
                SourceExpr="Preferred Supplier";
                Visible=FALSE }

    { 1100528508;2;Field  ;
                SourceExpr="Name Vendor";
                Importance=Additional;
                Visible=FALSE }

    { 1100528509;2;Field  ;
                SourceExpr="Vendor (Trade Item)";
                Importance=Additional;
                Visible=FALSE }

    { 1100528914;2;Field  ;
                SourceExpr="Estimate Source";
                OnLookup=BEGIN
                           HandleLookupEstimate;  //db, 24-02-17
                         END;
                          }

    { 1100528913;2;Field  ;
                SourceExpr="Summary Source (Cost)" }

    { 1100528994;2;Field  ;
                SourceExpr="Summary Source (Sales)" }

    { 1100528995;2;Field  ;
                SourceExpr="Summary (Cost)" }

    { 1100528912;2;Field  ;
                SourceExpr="Summary (Sales)" }

    { 1100528920;2;Field  ;
                SourceExpr="Project No.";
                Importance=Additional }

    { 1100528919;2;Field  ;
                SourceExpr=Element;
                Importance=Additional }

    { 1100528992;2;Field  ;
                SourceExpr="Extension Contract";
                Importance=Additional }

    { 1100528993;2;Field  ;
                SourceExpr="Project Planning Activity Code";
                Visible=FALSE }

    { 1100525016;2;Field  ;
                SourceExpr="Service Order No.";
                Importance=Additional }

    { 1100528918;2;Field  ;
                SourceExpr="Service Contract No.";
                Importance=Additional;
                OnLookup=BEGIN
                           LookupServiceContract;  //db, 24-10-08
                         END;
                          }

    { 1100528917;2;Field  ;
                SourceExpr="Service Location No.";
                Importance=Additional;
                OnLookup=BEGIN
                           LookupServiceLocation;
                         END;
                          }

    { 1100525005;2;Field  ;
                SourceExpr="Offer Price Based On";
                Importance=Additional }

    { 1100525003;2;Field  ;
                SourceExpr="Margin % (Offer Price)";
                Importance=Additional }

    { 1100525004;2;Field  ;
                SourceExpr="Markup % (Offer Price)";
                Importance=Additional }

    { 1100528910;2;Field  ;
                SourceExpr=Finished }

    { 1100528909;2;Field  ;
                SourceExpr=Fixed;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                           END;
                            }

    { 1100528901;1;Group  ;
                CaptionML=[ENU=Text;
                           NOR=Tekst;
                           SVE=BenÑmning];
                GroupType=Group }

    { 1100528900;2;Field  ;
                SourceExpr=Text;
                Visible=FALSE;
                MultiLine=Yes }

    { 1100409005;0;Container;
                ContainerType=FactBoxArea }

    { 1100409004;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100409003;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130167;
                PartType=Page }

    { 1100409002;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11229319;
                PartType=Page }

    { 1100527902;1;Part   ;
                CaptionML=[ENU=Comments;
                           NOR=Kommentarer;
                           SVE=Kommentar];
                SubPageLink=Table Name=CONST(Estimate),
                            No.=FIELD(No.);
                PagePartID=Page11072482;
                Editable=FALSE;
                PartType=Page }

    { 1100409001;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100409000;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      EstSetup@1100528913 : Record 11012150;
      EstPartRec@1100528911 : Record 11072073;
      EstLineRec@1100528910 : Record 11072072;
      PrintDoc@1100528908 : Codeunit 229;
      CUGraph@1100528907 : Codeunit 11012019;
      UpdateMgt@1100528906 : Codeunit 11012229;
      RateEditable@1100528905 : Boolean INDATASET;
      DiscountTermGroup0@1100528903 : Code[10];
      DPA_IsHardFilter@1100528902 : Boolean;
      TotalCost@1100528901 : Decimal;
      TotalSales@1100528900 : Decimal;
      Text001@1100528914 : TextConst 'ENU=Do you want to actualize prices ?;NOR=Vil du aktualisere priser?;SVE=Vill du fîrverkliga priser?';
      SurchargeEditable@1100528904 : Boolean INDATASET;

    PROCEDURE CheckUncodedLines@1210190000(lvAction@1210190000 : Integer);
    VAR
      UpdateMgt@1100525000 : Codeunit 11012229;
    BEGIN
      TESTFIELD("No.");
      UpdateMgt.CheckUncodedLines(lvAction, "No.",TRUE);  //db, 01-11-13: DP00260 (14518)
    END;

    PROCEDURE SetfilterEstimate@1100485000(lvEst@1210190000 : Code[20]);
    BEGIN
      FILTERGROUP(2);
      SETRANGE("No.",lvEst);
      FILTERGROUP(0);
    END;

    PROCEDURE ActivateUpdateFunctions@1100485001(lvAction@1100485000 : Integer);
    VAR
      UpdateReport@1100485001 : Report 11012341;
    BEGIN
      UpdateReport.FillDefaults("No.", lvAction);
      EstLineRec.SETRANGE("Estimate No.", "No.");
      UpdateReport.SETTABLEVIEW(EstLineRec);
      UpdateReport.RUNMODAL;
      CLEAR(UpdateReport);
      CurrPage.UPDATE(FALSE);  //db, 21-03-14
    END;

    PROCEDURE ActivateReplaceFunctions@1100525000(lvAction@1100485000 : Integer);
    VAR
      ReplaceReport@1100485001 : Report 11012342;
    BEGIN
      ReplaceReport.FillDefaults("No.", lvAction);
      EstLineRec.SETRANGE("Estimate No.", "No.");
      ReplaceReport.SETTABLEVIEW(EstLineRec);
      ReplaceReport.RUNMODAL;
      CLEAR(ReplaceReport);
      CurrPage.UPDATE(FALSE);  //db, 21-03-14
    END;

    PROCEDURE SetFilterPrintDoc@1100485002(lvAction@1100485000 : Integer);
    VAR
      EstPartRec@1100485002 : Record 11072073;
      PrintDoc@1100485001 : Codeunit 229;
    BEGIN
      EstPartRec."Estimate No." := "No.";
      PrintDoc.PrintEstimateNEW(EstPartRec, lvAction);   //DP00381
    END;

    PROCEDURE EvaluateRelation@1100525002();
    BEGIN
      //db, 15-01-09
      CurrPage.SAVERECORD;
      CheckRateConditions;
      CurrPage.UPDATE(FALSE);  //db, 21-03-14
    END;

    PROCEDURE HandleLookupRateCode@1210190002();
    BEGIN
      //db, 07-02-12: M32465
      CurrPage.SAVERECORD;
      COMMIT;
      LookupRateCode;
      CurrPage.UPDATE;  //C039093
    END;

    PROCEDURE DrillDownCostType@1100528900(iType@1100528900 : Integer);
    BEGIN
      //DP00381
      EstLineRec.RESET;
      EstLineRec.SETRANGE("Estimate No.","No.");
      IF iType = 0 THEN
        EstLineRec.SETFILTER("Labor Cost Amount",'<>%1',0);
      IF iType = 1 THEN
        EstLineRec.SETFILTER("Material Cost Amount",'<>%1',0);
      IF iType = 2 THEN
        EstLineRec.SETFILTER("Subcontracting Cost Amount",'<>%1',0);
      IF iType = 3 THEN
        EstLineRec.SETFILTER("Plant Cost Amount",'<>%1',0);
      IF iType = 4 THEN
        EstLineRec.SETFILTER("Sundry Cost Amount",'<>%1',0);
      IF iType = 8 THEN
        EstLineRec.SETFILTER(Hours,'<>%1',0);
      IF iType = 9 THEN
        EstLineRec.SETFILTER("Cost Amount",'<>%1',0);

      IF iType = 10 THEN
        EstLineRec.SETFILTER("Labor Sales Amount",'<>%1',0);
      IF iType = 11 THEN
        EstLineRec.SETFILTER("Material Sales Amount",'<>%1',0);
      IF iType = 12 THEN
        EstLineRec.SETFILTER("Subcontracting Sales Amount",'<>%1',0);
      IF iType = 13 THEN
        EstLineRec.SETFILTER("Plant Sales Amount",'<>%1',0);
      IF iType = 14 THEN
        EstLineRec.SETFILTER("Sundry Sales Amount",'<>%1',0);
      IF iType = 18 THEN
        EstLineRec.SETFILTER("Hours (Sales)",'<>%1',0);
      IF iType = 19 THEN
        EstLineRec.SETFILTER("Sales Amount",'<>%1',0);

      PAGE.RUN(PAGE::"Estimate Line List", EstLineRec);
    END;

    LOCAL PROCEDURE HandleLookupEstimate@1100525004();
    VAR
      Estimate@1100525000 : Record 11012151;
    BEGIN
      //db, 24-02-17
      Estimate.SETRANGE("RAW Estimate", "RAW Estimate");
      IF PAGE.RUNMODAL(0, Estimate) = ACTION::LookupOK THEN
        "Estimate Source" := Estimate."No.";
    END;

    LOCAL PROCEDURE ActivateSalesPrices@1100528901();
    VAR
      SalesPricebyEstimate@1100528900 : Record 11229774;
    BEGIN
      //DP02089
      SalesPricebyEstimate.SETRANGE("Estimate No.", "No.");
      PAGE.RUNMODAL(0, SalesPricebyEstimate);
    END;

    LOCAL PROCEDURE CheckEstimateTemplate@1100528902();
    VAR
      EstimateTemplate@1100528900 : Record 11229776;
    BEGIN
      //DP02264
      IF ApplyEstimateTemplate(EstimateTemplate) THEN
        "Estimate Template Code" := EstimateTemplate.Code;
    END;

    BEGIN
    {
      200406 ORANGO.EE - Added buttons "Summary (Cost)" and "Summary (Cost)"
    }
    END.
  }
}

