OBJECT Table 5407 Prod. Order Component
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.04,4PS14.00;
  }
  PROPERTIES
  {
    Permissions=TableData 5407=rimd;
    DataCaptionFields=Status,Prod. Order No.;
    OnInsert=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);

               DPA_OnInsert; //**4PS.n
               ReserveProdOrderComp.VerifyQuantity(Rec,xRec);

               IF Status = Status::Released THEN
                 WhseProdRelease.ReleaseLine(Rec,xRec);
             END;

    OnModify=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);

               WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
               ReserveProdOrderComp.VerifyChange(Rec,xRec);
               IF Status = Status::Released THEN
                 WhseProdRelease.ReleaseLine(Rec,xRec);
             END;

    OnDelete=VAR
               ProdOrderLine@1000 : Record 5406;
               ProdOrderBOMComment@1001 : Record 5416;
               ItemLedgEntry@1004 : Record 32;
               ItemTrackingMgt@1002 : Codeunit 6500;
               NewQuantity@1003 : Decimal;
               IsHandled@1005 : Boolean;
             BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);
               IF Status = Status::Released THEN BEGIN
                 ItemLedgEntry.SETCURRENTKEY("Order Type","Order No.","Order Line No.","Entry Type","Prod. Order Comp. Line No.");
                 ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
                 ItemLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                 ItemLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
                 ItemLedgEntry.SETRANGE("Entry Type",ItemLedgEntry."Entry Type"::Consumption);
                 ItemLedgEntry.SETRANGE("Prod. Order Comp. Line No.","Line No.");
                 IF ItemLedgEntry.FINDFIRST THEN
                   ERROR(Text99000000,ItemLedgEntry."Item No.","Line No.");
               END;

               WhseValidateSourceLine.ProdComponentDelete(Rec);
               ReserveProdOrderComp.DeleteLine(Rec);

               CALCFIELDS("Reserved Qty. (Base)");
               TESTFIELD("Reserved Qty. (Base)",0);

               IF "Supplied-by Line No." > 0 THEN BEGIN
                 IsHandled := FALSE;
                 OnDeleteOnBeforeGetProdOrderLine(Rec,IsHandled);
                 IF NOT IsHandled THEN
                   IF ProdOrderLine.GET(Status,"Prod. Order No.","Supplied-by Line No.") THEN BEGIN
                     NewQuantity := ProdOrderLine.Quantity - "Expected Quantity";
                     IF (NewQuantity = 0) OR IsLineRequiredForSingleDemand(ProdOrderLine,"Prod. Order Line No.") THEN BEGIN
                       ProdOrderLine.SetCalledFromComponent(TRUE);
                       ProdOrderLine.DELETE(TRUE);
                     END ELSE BEGIN
                       ProdOrderLine.VALIDATE(Quantity,NewQuantity);
                       ProdOrderLine.MODIFY;
                       ProdOrderLine.UpdateProdOrderComp(ProdOrderLine."Qty. per Unit of Measure");
                     END;
                   END;
               END;

               ProdOrderBOMComment.SETRANGE(Status,Status);
               ProdOrderBOMComment.SETRANGE("Prod. Order No.","Prod. Order No.");
               ProdOrderBOMComment.SETRANGE("Prod. Order Line No.","Prod. Order Line No.");
               ProdOrderBOMComment.SETRANGE("Prod. Order BOM Line No.","Line No.");
               ProdOrderBOMComment.DELETEALL;

               WhseProdRelease.DeleteLine(Rec);

               ItemTrackingMgt.DeleteWhseItemTrkgLines(
                 DATABASE::"Prod. Order Component",Status,"Prod. Order No.",'',
                 "Prod. Order Line No.","Line No.","Location Code",TRUE);
             END;

    OnRename=BEGIN
               ERROR(Text99000001,TABLECAPTION);
             END;

    CaptionML=[ENU=Prod. Order Component;
               NOR=Prod.ordrekomponent];
    LookupPageID=Page5407;
    DrillDownPageID=Page5407;
  }
  FIELDS
  {
    { 1   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig;
                                                                    SVE=Simulerad,Planerad,Fast planerad,SlÑppt,FÑrdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 2   ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No. WHERE (Status=FIELD(Status));
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.;
                                                              SVE=Prod.ordernr] }
    { 3   ;   ;Prod. Order Line No.;Integer       ;TableRelation="Prod. Order Line"."Line No." WHERE (Status=FIELD(Status),
                                                                                                      Prod. Order No.=FIELD(Prod. Order No.));
                                                   CaptionML=[ENU=Prod. Order Line No.;
                                                              NOR=Prod.ordrelinjenr.;
                                                              SVE=Prod.orderradnr] }
    { 4   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.;
                                                              SVE=Radnr] }
    { 11  ;   ;Item No.            ;Code20        ;TableRelation=Item WHERE (Type=FILTER(Inventory|Non-Inventory));
                                                   OnValidate=BEGIN
                                                                IF xRec.FIND THEN BEGIN
                                                                  CALCFIELDS("Act. Consumption (Qty)");
                                                                  TESTFIELD("Act. Consumption (Qty)",0);
                                                                END;
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                TESTFIELD("Reserved Qty. (Base)",0);
                                                                TESTFIELD("Remaining Qty. (Base)","Expected Qty. (Base)");
                                                                IF "Item No." = '' THEN BEGIN
                                                                  CreateDim(
                                                                    DATABASE::Item,"Item No.",
                                                                    DATABASE::Location,"Location Code");  //**4PS.n
                                                                  EXIT;
                                                                END;

                                                                Item.GET("Item No.");
                                                                IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                  "Variant Code" := '';
                                                                  OnValidateItemNoOnBeforeGetDefaultBin(Rec,Item);
                                                                  GetDefaultBin;
                                                                  ClearCalcFormula;
                                                                  IF "Quantity per" <> 0 THEN
                                                                    VALIDATE("Quantity per");
                                                                END;
                                                                Description := Item.Description;
                                                                Item.TESTFIELD("Logistics on Component Level",FALSE);  //**4PS.n
                                                                Item.TESTFIELD("Base Unit of Measure");
                                                                VALIDATE("Unit of Measure Code",Item."Base Unit of Measure");
                                                                GetUpdateFromSKU;
                                                                CreateDim(
                                                                  DATABASE::Item,"Item No.",
                                                                  DATABASE::Location,"Location Code");  //**4PS.n

                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                                VALIDATE("Shortcut Dimension 2 Code", Item."Global Dimension 2 Code");  //**4PS.n
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.;
                                                              SVE=Artikelnr] }
    { 12  ;   ;Description         ;Text100       ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning];
                                                   Description=4PS: 30->50 }
    { 13  ;   ;Unit of Measure Code;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);

                                                                Item.GET("Item No.");
                                                                GetGLSetup;

                                                                "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");
                                                                "Quantity (Base)" := UOMMgt.CalcBaseQty(Quantity,"Qty. per Unit of Measure");

                                                                UpdateUnitCost;

                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode;
                                                              SVE=Enhetskod] }
    { 14  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall;
                                                              SVE=Antal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 15  ;   ;Position            ;Code10        ;CaptionML=[ENU=Position;
                                                              NOR=Posisjon;
                                                              SVE=Position] }
    { 16  ;   ;Position 2          ;Code10        ;CaptionML=[ENU=Position 2;
                                                              NOR=Posisjon 2;
                                                              SVE=Position 2] }
    { 17  ;   ;Position 3          ;Code10        ;CaptionML=[ENU=Position 3;
                                                              NOR=Posisjon 3;
                                                              SVE=Position 3] }
    { 18  ;   ;Lead-Time Offset    ;DateFormula   ;CaptionML=[ENU=Lead-Time Offset;
                                                              NOR=Forskyvning av leveringstid;
                                                              SVE=Ledtidsfîrskjutning] }
    { 19  ;   ;Routing Link Code   ;Code10        ;TableRelation="Routing Link";
                                                   OnValidate=VAR
                                                                ProdOrderLine@1000 : Record 5406;
                                                                ProdOrderRtngLine@1001 : Record 5409;
                                                              BEGIN
                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);

                                                                ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

                                                                "Due Date" := ProdOrderLine."Starting Date";
                                                                "Due Time" := ProdOrderLine."Starting Time";
                                                                IF "Routing Link Code" <> '' THEN BEGIN
                                                                  ProdOrderRtngLine.SETRANGE(Status,Status);
                                                                  ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
                                                                  IF ProdOrderRtngLine.FINDFIRST THEN BEGIN
                                                                    "Due Date" := ProdOrderRtngLine."Starting Date";
                                                                    "Due Time" := ProdOrderRtngLine."Starting Time";
                                                                  END;
                                                                END;
                                                                IF FORMAT("Lead-Time Offset") <> '' THEN BEGIN
                                                                  "Due Date" :=
                                                                    "Due Date" -
                                                                    (CALCDATE("Lead-Time Offset",WORKDATE) - WORKDATE);
                                                                  "Due Time" := 0T;
                                                                END;

                                                                OnValidateRoutingLinkCodeBeforeValidateDueDate(Rec,ProdOrderLine);
                                                                VALIDATE("Due Date");

                                                                IF "Routing Link Code" <> xRec."Routing Link Code" THEN
                                                                  UpdateBin(Rec,FIELDNO("Routing Link Code"),FIELDCAPTION("Routing Link Code"));
                                                              END;

                                                   CaptionML=[ENU=Routing Link Code;
                                                              NOR=Rutekoblingskode;
                                                              SVE=OperationsfîljdslÑnkkod] }
    { 20  ;   ;Scrap %             ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Scrap %;
                                                              NOR=Vrak-%;
                                                              SVE=Kassation %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 21  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=VAR
                                                                ItemVariant@1000 : Record 5401;
                                                              BEGIN
                                                                IF Item."No." <> "Item No." THEN
                                                                  Item.GET("Item No.");
                                                                IF "Variant Code" = '' THEN
                                                                  Description := Item.Description
                                                                ELSE BEGIN
                                                                  ItemVariant.GET("Item No.","Variant Code");
                                                                  Description := ItemVariant.Description;
                                                                END;
                                                                GetDefaultBin;
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                TESTFIELD("Reserved Qty. (Base)",0);
                                                                TESTFIELD("Remaining Qty. (Base)","Expected Qty. (Base)");
                                                                UpdateUnitCost;
                                                                VALIDATE("Expected Quantity");
                                                                GetUpdateFromSKU;
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode;
                                                              SVE=Variantkod] }
    { 25  ;   ;Expected Quantity   ;Decimal       ;OnValidate=BEGIN
                                                                IF Item.GET("Item No.") THEN
                                                                  IF Item."Rounding Precision" > 0 THEN BEGIN
                                                                    "Expected Quantity" := ROUND("Expected Quantity",Item."Rounding Precision",'>');
                                                                    OnAfterRoundExpectedQuantity(Rec);
                                                                  END;

                                                                "Expected Qty. (Base)" := ROUND("Expected Quantity" * "Qty. per Unit of Measure",UOMMgt.QtyRndPrecision);
                                                                IF (Status IN [Status::Released,Status::Finished]) AND
                                                                   (xRec."Item No." <> '') AND
                                                                   ("Line No." <> 0)
                                                                THEN
                                                                  CALCFIELDS("Act. Consumption (Qty)");

                                                                OnValidateExpectedQuantityOnAfterCalcActConsumptionQty(Rec,xRec);
                                                                "Remaining Quantity" := "Expected Quantity" - "Act. Consumption (Qty)" / "Qty. per Unit of Measure";
                                                                IF ("Remaining Quantity" * "Expected Quantity") <= 0 THEN
                                                                  "Remaining Quantity" := 0;
                                                                "Remaining Qty. (Base)" := ROUND("Remaining Quantity" * "Qty. per Unit of Measure",UOMMgt.QtyRndPrecision);
                                                                "Completely Picked" := "Qty. Picked" >= "Expected Quantity";

                                                                ReserveProdOrderComp.VerifyQuantity(Rec,xRec);

                                                                "Cost Amount" := ROUND("Expected Quantity" * "Unit Cost");
                                                                "Overhead Amount" :=
                                                                  ROUND(
                                                                    "Expected Quantity" *
                                                                    (("Direct Unit Cost" * "Indirect Cost %" / 100) + "Overhead Rate"));
                                                                "Direct Cost Amount" := ROUND("Expected Quantity" * "Direct Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Expected Quantity;
                                                              NOR=Forventet antall;
                                                              SVE=FîrvÑntat antal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 26  ;   ;Remaining Quantity  ;Decimal       ;CaptionML=[ENU=Remaining Quantity;
                                                              NOR=Restantall;
                                                              SVE=èterstÜende antal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 27  ;   ;Act. Consumption (Qty);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Item Ledger Entry".Quantity WHERE (Entry Type=CONST(Consumption),
                                                                                                        Order Type=CONST(Production),
                                                                                                        Order No.=FIELD(Prod. Order No.),
                                                                                                        Order Line No.=FIELD(Prod. Order Line No.),
                                                                                                        Prod. Order Comp. Line No.=FIELD(Line No.)));
                                                   AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Act. Consumption (Qty);
                                                              NOR=Fakt. forbruk (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 28  ;   ;Flushing Method     ;Option        ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                                PickWhseWorksheetLine@1001 : Record 7326;
                                                              BEGIN
                                                                IF ("Flushing Method" = "Flushing Method"::Backward) AND (Status = Status::Released) THEN BEGIN
                                                                  ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
                                                                  ItemLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                                                                  ItemLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
                                                                  ItemLedgEntry.SETRANGE("Entry Type",ItemLedgEntry."Entry Type"::Consumption);
                                                                  ItemLedgEntry.SETRANGE("Prod. Order Comp. Line No.","Line No.");
                                                                  IF "Line No." = 0 THEN
                                                                    ItemLedgEntry.SETRANGE("Item No.","Item No.");
                                                                  IF NOT ItemLedgEntry.ISEMPTY THEN
                                                                    ERROR(Text99000002,"Flushing Method",ItemLedgEntry.TABLECAPTION);
                                                                END;

                                                                IF ("Flushing Method" <> xRec."Flushing Method") AND
                                                                   (xRec."Flushing Method" IN
                                                                    [xRec."Flushing Method"::Manual,
                                                                     xRec."Flushing Method"::"Pick + Forward",
                                                                     xRec."Flushing Method"::"Pick + Backward"])
                                                                THEN BEGIN
                                                                  CALCFIELDS("Pick Qty.");
                                                                  IF "Pick Qty." <> 0 THEN
                                                                    ERROR(Text99000007,"Flushing Method","Item No.");

                                                                  IF "Qty. Picked" <> 0 THEN
                                                                    ERROR(Text99000008,"Flushing Method","Item No.");

                                                                  IF (xRec."Flushing Method" IN
                                                                      [xRec."Flushing Method"::Manual,
                                                                       xRec."Flushing Method"::"Pick + Forward",
                                                                       xRec."Flushing Method"::"Pick + Backward"]) AND
                                                                     ("Flushing Method" IN ["Flushing Method"::Forward,"Flushing Method"::Backward])
                                                                  THEN BEGIN
                                                                    PickWhseWorksheetLine.SETRANGE("Source Type",DATABASE::"Prod. Order Component");
                                                                    PickWhseWorksheetLine.SETRANGE("Source No.","Prod. Order No.");
                                                                    PickWhseWorksheetLine.SETRANGE("Source Line No.","Prod. Order Line No.");
                                                                    PickWhseWorksheetLine.SETRANGE("Source Subline No.","Line No.");
                                                                    IF NOT PickWhseWorksheetLine.ISEMPTY THEN
                                                                      ERROR(Text99000002,"Flushing Method",PickWhseWorksheetLine.TABLECAPTION);
                                                                  END;
                                                                END;

                                                                IF "Flushing Method" <> xRec."Flushing Method" THEN
                                                                  UpdateBin(Rec,FIELDNO("Flushing Method"),FIELDCAPTION("Flushing Method"));
                                                              END;

                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode;
                                                              SVE=Bokfîringsmetod];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward,Pick + Forward,Pick + Backward;
                                                                    NOR=Manuell,Fremover,Bakover,Plukk + Fremover,Plukk + Bakover;
                                                                    SVE=Manuell,FramÜt,BakÜt,Plockning + framÜt,Plockning + bakÜt];
                                                   OptionString=Manual,Forward,Backward,Pick + Forward,Pick + Backward }
    { 30  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                IF Item."No." <> "Item No." THEN
                                                                  Item.GET("Item No.");

                                                                // Location code in allowed only for inventoriable items
                                                                IF "Location Code" <> '' THEN
                                                                  Item.TESTFIELD(Type,Item.Type::Inventory);

                                                                UpdateUnitCost;
                                                                VALIDATE("Expected Quantity");

                                                                GetDefaultBin;
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                GetUpdateFromSKU;

                                                                //**4PS.sn
                                                                CreateDim(
                                                                  DATABASE::Item,"Item No.",
                                                                  DATABASE::Location,"Location Code");
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                                //**4PS.en
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode;
                                                              SVE=LagerstÑllekod] }
    { 31  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode;
                                                              SVE=GenvÑg dimension 1 kod];
                                                   CaptionClass='1,2,1' }
    { 32  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode;
                                                              SVE=GenvÑg dimension 2 kod];
                                                   CaptionClass='1,2,2' }
    { 33  ;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WMSManagement@1000 : Codeunit 7302;
                                                                WhseIntegrationMgt@1001 : Codeunit 7317;
                                                              BEGIN
                                                                IF "Bin Code" <> '' THEN BEGIN
                                                                  TESTFIELD("Location Code");
                                                                  WMSManagement.FindBin("Location Code","Bin Code",'');
                                                                  WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Prod. Order Component",
                                                                    FIELDCAPTION("Bin Code"),
                                                                    "Location Code",
                                                                    "Bin Code",0);
                                                                  CheckBin;
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              WMSManagement@1000 : Codeunit 7302;
                                                              BinCode@1001 : Code[20];
                                                              IsHandled@1002 : Boolean;
                                                            BEGIN
                                                              IsHandled := FALSE;
                                                              OnBeforeBinCodeOnLookup(Rec,IsHandled);
                                                              IF IsHandled THEN
                                                                EXIT;

                                                              IF Quantity > 0 THEN
                                                                BinCode := WMSManagement.BinContentLookUp("Location Code","Item No.","Variant Code",'',"Bin Code")
                                                              ELSE
                                                                BinCode := WMSManagement.BinLookUp("Location Code","Item No.","Variant Code",'');

                                                              IF BinCode <> '' THEN
                                                                VALIDATE("Bin Code",BinCode);
                                                            END;

                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode;
                                                              SVE=Lagerplatskod] }
    { 35  ;   ;Supplied-by Line No.;Integer       ;TableRelation="Prod. Order Line"."Line No." WHERE (Status=FIELD(Status),
                                                                                                      Prod. Order No.=FIELD(Prod. Order No.),
                                                                                                      Line No.=FIELD(Supplied-by Line No.));
                                                   CaptionML=[ENU=Supplied-by Line No.;
                                                              NOR=Forsynt av-linjenr.;
                                                              SVE=Fîrsîrjd av radnr] }
    { 36  ;   ;Planning Level Code ;Integer       ;CaptionML=[ENU=Planning Level Code;
                                                              NOR=Planl.nivÜ - kode;
                                                              SVE=PlaneringsnivÜkod];
                                                   Editable=No }
    { 37  ;   ;Item Low-Level Code ;Integer       ;CaptionML=[ENU=Item Low-Level Code;
                                                              NOR=Varens lavnivÜkode] }
    { 40  ;   ;Length              ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Length;
                                                              NOR=Lengde;
                                                              SVE=LÑngd];
                                                   DecimalPlaces=0:5 }
    { 41  ;   ;Width               ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Width;
                                                              NOR=Bredde;
                                                              SVE=Bredd];
                                                   DecimalPlaces=0:5 }
    { 42  ;   ;Weight              ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Weight;
                                                              NOR=Vekt;
                                                              SVE=Vikt];
                                                   DecimalPlaces=0:5 }
    { 43  ;   ;Depth               ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Depth;
                                                              NOR=Dybde;
                                                              SVE=Djup];
                                                   DecimalPlaces=0:5 }
    { 44  ;   ;Calculation Formula ;Option        ;OnValidate=BEGIN
                                                                CASE "Calculation Formula" OF
                                                                  "Calculation Formula"::" ":
                                                                    Quantity := "Quantity per";
                                                                  "Calculation Formula"::Length:
                                                                    Quantity := ROUND(Length * "Quantity per",UOMMgt.QtyRndPrecision);
                                                                  "Calculation Formula"::"Length * Width":
                                                                    Quantity := ROUND(Length * Width * "Quantity per",UOMMgt.QtyRndPrecision);
                                                                  "Calculation Formula"::"Length * Width * Depth":
                                                                    Quantity := ROUND(Length * Width * Depth * "Quantity per",UOMMgt.QtyRndPrecision);
                                                                  "Calculation Formula"::Weight:
                                                                    Quantity := ROUND(Weight * "Quantity per",UOMMgt.QtyRndPrecision);
                                                                END;
                                                                OnValidateCalculationFormulaOnAfterSetQuantity(Rec);
                                                                "Quantity (Base)" := Quantity * "Qty. per Unit of Measure";
                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);
                                                              END;

                                                   CaptionML=[ENU=Calculation Formula;
                                                              NOR=Beregningsformel;
                                                              SVE=BerÑkningsformel];
                                                   OptionCaptionML=[ENU=" ,Length,Length * Width,Length * Width * Depth,Weight";
                                                                    NOR=" ,Lengde,Lengde * Bredde,Lengde * bredde * Dybde,Vekt";
                                                                    SVE=" ,LÑngd,LÑngd * Bredd,LÑngd * Bredd * Djup,Vikt"];
                                                   OptionString=[ ,Length,Length * Width,Length * Width * Depth,Weight] }
    { 45  ;   ;Quantity per        ;Decimal       ;OnValidate=BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                TESTFIELD("Item No.");
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Quantity per;
                                                              NOR=Antall per;
                                                              SVE=Antal per];
                                                   DecimalPlaces=0:5 }
    { 50  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Item No.");

                                                                Item.GET("Item No.");
                                                                GetGLSetup;
                                                                IF Item."Costing Method" = Item."Costing Method"::Standard THEN BEGIN
                                                                  IF CurrFieldNo = FIELDNO("Unit Cost") THEN
                                                                    ERROR(
                                                                      Text99000003,
                                                                      FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                  UpdateUnitCost;
                                                                END;
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost;
                                                              SVE=Styckkostnad];
                                                   DecimalPlaces=2:5 }
    { 51  ;   ;Cost Amount         ;Decimal       ;CaptionML=[ENU=Cost Amount;
                                                              NOR=Kostbelõp;
                                                              SVE=Kostnadsbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 52  ;   ;Due Date            ;Date          ;OnValidate=VAR
                                                                CheckDateConflict@1000 : Codeunit 99000815;
                                                              BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                IF NOT Blocked THEN BEGIN
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    CheckDateConflict.ProdOrderComponentCheck(Rec,TRUE,TRUE)
                                                                  ELSE
                                                                    IF CheckDateConflict.ProdOrderComponentCheck(Rec,NOT WarningRaised,FALSE) THEN
                                                                      WarningRaised := TRUE;
                                                                END;
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato;
                                                              SVE=Fîrfallodatum] }
    { 53  ;   ;Due Time            ;Time          ;OnValidate=BEGIN
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Due Time;
                                                              NOR=Forfallstidsp.;
                                                              SVE=FÑrdigtid] }
    { 60  ;   ;Qty. per Unit of Measure;Decimal   ;CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet;
                                                              SVE=Antal per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 61  ;   ;Remaining Qty. (Base);Decimal      ;CaptionML=[ENU=Remaining Qty. (Base);
                                                              NOR=Restlager (ant.);
                                                              SVE=èterstÜende ant. (bas)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 62  ;   ;Quantity (Base)     ;Decimal       ;CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet);
                                                              SVE=Antal (bas)];
                                                   DecimalPlaces=0:5 }
    { 63  ;   ;Reserved Qty. (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Source ID=FIELD(Prod. Order No.),
                                                                                                                 Source Ref. No.=FIELD(Line No.),
                                                                                                                 Source Type=CONST(5407),
                                                                                                                 Source Subtype=FIELD(Status),
                                                                                                                 Source Batch Name=CONST(),
                                                                                                                 Source Prod. Order Line=FIELD(Prod. Order Line No.),
                                                                                                                 Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Qty. (Base);
                                                              NOR=Reservert antall (lagerenhet);
                                                              SVE=Reserverat antal (bas)];
                                                   DecimalPlaces=0:5;
                                                   Editable=Yes }
    { 71  ;   ;Reserved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry".Quantity WHERE (Source ID=FIELD(Prod. Order No.),
                                                                                                        Source Ref. No.=FIELD(Line No.),
                                                                                                        Source Type=CONST(5407),
                                                                                                        Source Subtype=FIELD(Status),
                                                                                                        Source Batch Name=CONST(),
                                                                                                        Source Prod. Order Line=FIELD(Prod. Order Line No.),
                                                                                                        Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Quantity;
                                                              NOR=Reservert antall;
                                                              SVE=Reserverat antal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 73  ;   ;Expected Qty. (Base);Decimal       ;OnValidate=BEGIN
                                                                IF Status <> Status::Simulated THEN BEGIN
                                                                  IF Status IN [Status::Released,Status::Finished] THEN
                                                                    CALCFIELDS("Act. Consumption (Qty)");
                                                                  OnValidateExpectedQtyBaseOnAfterCalcActConsumptionQty(Rec,xRec);
                                                                  "Remaining Quantity" := "Expected Quantity" - "Act. Consumption (Qty)";
                                                                  "Remaining Qty. (Base)" := ROUND("Remaining Quantity" * "Qty. per Unit of Measure",UOMMgt.QtyRndPrecision);
                                                                END;
                                                                "Cost Amount" := ROUND("Expected Quantity" * "Unit Cost");
                                                                "Overhead Amount" :=
                                                                  ROUND(
                                                                    "Expected Quantity" *
                                                                    (("Direct Unit Cost" * "Indirect Cost %" / 100) + "Overhead Rate"));
                                                                "Direct Cost Amount" := ROUND("Expected Quantity" * "Direct Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Expected Qty. (Base);
                                                              NOR=Forventet antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 76  ;   ;Due Date-Time       ;DateTime      ;OnValidate=BEGIN
                                                                "Due Date" := DT2DATE("Due Date-Time");
                                                                "Due Time" := DT2TIME("Due Date-Time");
                                                                VALIDATE("Due Date");
                                                              END;

                                                   CaptionML=[ENU=Due Date-Time;
                                                              NOR=Forfallsdato-tidsp.;
                                                              SVE=Fîrfallodatum tid] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnValidate=BEGIN
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID;
                                                              SVE=DimensionsuppsÑttnings-ID];
                                                   Editable=No }
    { 5702;   ;Substitution Available;Boolean     ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Item Substitution" WHERE (Type=CONST(Item),
                                                                                                Substitute Type=CONST(Item),
                                                                                                No.=FIELD(Item No.),
                                                                                                Variant Code=FIELD(Variant Code)));
                                                   CaptionML=[ENU=Substitution Available;
                                                              NOR=Erstatning mulig;
                                                              SVE=ErsÑttning tillgÑnglig];
                                                   Editable=No }
    { 5703;   ;Original Item No.   ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Original Item No.;
                                                              NOR=Opprinnelig varenr.;
                                                              SVE=Ursprungligt artikelnr];
                                                   Editable=No }
    { 5704;   ;Original Variant Code;Code10       ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Original Item No.));
                                                   CaptionML=[ENU=Original Variant Code;
                                                              NOR=Opprinnelig variantkode;
                                                              SVE=Ursprunglig variantkod];
                                                   Editable=No }
    { 5750;   ;Pick Qty.           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding" WHERE (Activity Type=FILTER(<>Put-away),
                                                                                                                       Source Type=CONST(5407),
                                                                                                                       Source Subtype=FIELD(Status),
                                                                                                                       Source No.=FIELD(Prod. Order No.),
                                                                                                                       Source Line No.=FIELD(Prod. Order Line No.),
                                                                                                                       Source Subline No.=FIELD(Line No.),
                                                                                                                       Unit of Measure Code=FIELD(Unit of Measure Code),
                                                                                                                       Action Type=FILTER(' '|Place),
                                                                                                                       Original Breakbulk=CONST(No),
                                                                                                                       Breakbulk No.=CONST(0)));
                                                   CaptionML=[ENU=Pick Qty.;
                                                              NOR=Plukkant.;
                                                              SVE=Plockningsant.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7300;   ;Qty. Picked         ;Decimal       ;OnValidate=BEGIN
                                                                "Qty. Picked (Base)" := UOMMgt.CalcBaseQty("Qty. Picked","Qty. per Unit of Measure");
                                                                "Completely Picked" := "Qty. Picked" >= "Expected Quantity";
                                                              END;

                                                   CaptionML=[ENU=Qty. Picked;
                                                              NOR=Plukket ant.;
                                                              SVE=Plockat antal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7301;   ;Qty. Picked (Base)  ;Decimal       ;CaptionML=[ENU=Qty. Picked (Base);
                                                              NOR=Plukket ant. (l.enh.);
                                                              SVE=Plockat ant. (bas)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7302;   ;Completely Picked   ;Boolean       ;CaptionML=[ENU=Completely Picked;
                                                              NOR=Ferdig plukket;
                                                              SVE=FÑrdigplockat];
                                                   Editable=No }
    { 7303;   ;Pick Qty. (Base)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding (Base)" WHERE (Activity Type=FILTER(<>Put-away),
                                                                                                                              Source Type=CONST(5407),
                                                                                                                              Source Subtype=FIELD(Status),
                                                                                                                              Source No.=FIELD(Prod. Order No.),
                                                                                                                              Source Line No.=FIELD(Prod. Order Line No.),
                                                                                                                              Source Subline No.=FIELD(Line No.),
                                                                                                                              Action Type=FILTER(' '|Place),
                                                                                                                              Original Breakbulk=CONST(No),
                                                                                                                              Breakbulk No.=CONST(0)));
                                                   CaptionML=[ENU=Pick Qty. (Base);
                                                              NOR=Plukkant. (l.enh.);
                                                              SVE=Plockningsant. (bas)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000754;;Direct Unit Cost   ;Decimal       ;CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost;
                                                              SVE=Inkîpspris];
                                                   DecimalPlaces=2:5 }
    { 99000755;;Indirect Cost %    ;Decimal       ;OnValidate=BEGIN
                                                                "Direct Unit Cost" :=
                                                                  ROUND(("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100));

                                                                VALIDATE("Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%;
                                                              SVE=Indirekt kostnad %];
                                                   DecimalPlaces=0:5 }
    { 99000756;;Overhead Rate      ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader;
                                                              SVE=Omkostnad];
                                                   DecimalPlaces=0:5 }
    { 99000757;;Direct Cost Amount ;Decimal       ;CaptionML=[ENU=Direct Cost Amount;
                                                              NOR=Kjõpspris/prod.kost - belõp;
                                                              SVE=Direkt kostnadsbelopp];
                                                   DecimalPlaces=2:2 }
    { 99000758;;Overhead Amount    ;Decimal       ;CaptionML=[ENU=Overhead Amount;
                                                              NOR=Belõp for indirekte kostnader;
                                                              SVE=Omkostnadsbelopp];
                                                   DecimalPlaces=2:2 }
  }
  KEYS
  {
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Line No.;
                                                   Clustered=Yes }
    {    ;Prod. Order No.,Prod. Order Line No.,Line No.,Status }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Due Date;
                                                   SumIndexFields=Expected Quantity,Cost Amount }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Item No.,Line No.;
                                                   MaintainSQLIndex=No }
    {    ;Status,Item No.,Variant Code,Location Code,Due Date;
                                                   SumIndexFields=Expected Quantity,Remaining Qty. (Base),Cost Amount,Overhead Amount }
    {    ;Item No.,Variant Code,Location Code,Shortcut Dimension 1 Code,Shortcut Dimension 2 Code,Due Date;
                                                   SumIndexFields=Expected Quantity,Remaining Qty. (Base),Cost Amount,Overhead Amount }
    {    ;Status,Prod. Order No.,Routing Link Code,Flushing Method }
    {    ;Status,Prod. Order No.,Location Code     }
    {    ;Item No.,Variant Code,Location Code,Status,Due Date;
                                                   SumIndexFields=Expected Qty. (Base),Remaining Qty. (Base),Cost Amount,Overhead Amount,Qty. Picked (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Item Low-Level Code;
                                                   MaintainSQLIndex=No }
    {    ;Supplied-by Line No.                     }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1028 : TextConst 'ENU=A finished production order component cannot be inserted, modified, or deleted.;NOR=Kan ikke sette inn, endre eller slette en ferdig produksjonsordrekomponent.';
      Text001@1015 : TextConst 'ENU=The changed %1 now points to bin %2. Do you want to update the bin on this line?;NOR=%1 som er endret, viser nÜ til hylle %2. Vil du oppdatere hyllen pÜ denne linjen?';
      Text99000000@1000 : TextConst 'ENU=You cannot delete item %1 in line %2 because at least one item ledger entry is associated with it.;NOR=Du kan ikke slette varen %1 i linje %2 fordi den har minst Çn varepost tilknyttet.';
      Text99000001@1001 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.;SVE=Du kan inte byta namn pÜ %1.';
      Text99000002@1002 : TextConst 'ENU=You cannot change flushing method to %1 when there is at least one record in table %2 associated with it.;NOR=Du kan ikke endre trekkmetode til %1 nÜr den har minst Çn post i tabell %2 tilknyttet.';
      Text99000003@1003 : TextConst 'ENU=You cannot change %1 when %2 is %3.;NOR=Du kan ikke endre %1 nÜr %2 er %3.;SVE=Du kan inte Ñndra %1 nÑr %2 Ñr %3.';
      Item@1005 : Record 27;
      ReservEntry@1007 : Record 337;
      GLSetup@1024 : Record 98;
      Location@1012 : Record 14;
      SKU@1025 : Record 5700;
      ReservMgt@1008 : Codeunit 99000845;
      ReservEngineMgt@1009 : Codeunit 99000831;
      ReserveProdOrderComp@1010 : Codeunit 99000838;
      UOMMgt@1011 : Codeunit 5402;
      DimMgt@1014 : Codeunit 408;
      WhseProdRelease@1016 : Codeunit 5774;
      WhseValidateSourceLine@1027 : Codeunit 5777;
      ItemSubstitutionMgt@1031 : Codeunit 5701;
      Reservation@1017 : Page 498;
      Blocked@1023 : Boolean;
      GLSetupRead@1022 : Boolean;
      Text99000007@1029 : TextConst 'ENU=You cannot change flushing method to %1 because a pick has already been created for production order component %2.;NOR=Du kan ikke endre trekkmetode til %1 fordi det allerede er opprettet et plukk for produksjonsordrekomponenten %2.';
      Text99000008@1030 : TextConst 'ENU=You cannot change flushing method to %1 because production order component %2 has already been picked.;NOR=Du kan ikke endre trekkmetode til %1 fordi produksjonsordrekomponenten %2 allerede er plukket.';
      Text99000009@1013 : TextConst 'ENU=Automatic reservation is not possible.\Do you want to reserve items manually?;NOR=Det er ikke mulig Ü reservere automatisk.\Vil du reservere varene manuelt?;SVE=Automatisk reservation Ñr inte mîjlig.\Vill du reservera artiklarna manuellt?';
      IgnoreErrors@1026 : Boolean;
      ErrorOccured@1032 : Boolean;
      WarningRaised@1004 : Boolean;
      DPA_Management@1100000999 : Codeunit 11012783;

    [External]
    PROCEDURE Caption@4() : Text[100];
    VAR
      ProdOrder@1000 : Record 5405;
      ProdOrderLine@1001 : Record 5406;
    BEGIN
      IF NOT ProdOrder.GET(Status,"Prod. Order No.") THEN
        EXIT('');

      IF NOT ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.") THEN
        CLEAR(ProdOrderLine);

      EXIT(
        STRSUBSTNO('%1 %2 %3',
          "Prod. Order No.",ProdOrder.Description,ProdOrderLine."Item No."));
    END;

    LOCAL PROCEDURE ProdOrderNeeds@1() : Decimal;
    VAR
      ProdOrderLine@1000 : Record 5406;
      ProdOrderRtngLine@1001 : Record 5409;
      NeededQty@1002 : Decimal;
    BEGIN
      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

      IF "Due Date" = 0D THEN BEGIN
        "Due Date" := ProdOrderLine."Starting Date";
        "Due Time" := ProdOrderLine."Starting Time";
        UpdateDatetime;
      END;

      ProdOrderRtngLine.RESET;
      ProdOrderRtngLine.SETRANGE(Status,Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
      IF "Routing Link Code" <> '' THEN
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
      IF ProdOrderRtngLine.FINDFIRST THEN
        NeededQty :=
          ProdOrderLine.Quantity * (1 + ProdOrderLine."Scrap %" / 100) *
          (1 + ProdOrderRtngLine."Scrap Factor % (Accumulated)") * (1 + "Scrap %" / 100) +
          ProdOrderRtngLine."Fixed Scrap Qty. (Accum.)"
      ELSE
        NeededQty :=
          ProdOrderLine.Quantity * (1 + ProdOrderLine."Scrap %" / 100) * (1 + "Scrap %" / 100);

      OnAfterProdOrderNeeds(Rec,ProdOrderLine,ProdOrderRtngLine,NeededQty);

      EXIT(NeededQty);
    END;

    [External]
    PROCEDURE GetNeededQty@3(CalcBasedOn@1000 : 'Actual Output,Expected Output';IncludePreviousPosting@1001 : Boolean) : Decimal;
    VAR
      ProdOrderLine@1002 : Record 5406;
      ProdOrderRtngLine@1003 : Record 5409;
      CapLedgEntry@1004 : Record 5832;
      CostCalcMgt@1006 : Codeunit 5836;
      OutputQtyBase@1005 : Decimal;
      CompQtyBase@1008 : Decimal;
      IsHandled@1007 : Boolean;
    BEGIN
      Item.GET("Item No.");
      IF Item."Rounding Precision" = 0 THEN
        Item."Rounding Precision" := UOMMgt.QtyRndPrecision;

      OnGetNeededQtyOnBeforeCalcBasedOn(Rec);
      IF CalcBasedOn = CalcBasedOn::"Actual Output" THEN BEGIN
        ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

        ProdOrderRtngLine.SETRANGE(Status,Status);
        ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
        ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
        ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
        IF NOT ProdOrderRtngLine.FINDFIRST OR ("Routing Link Code" = '') THEN BEGIN
          ProdOrderRtngLine.SETRANGE("Routing Link Code");
          ProdOrderRtngLine.SETFILTER("Next Operation No.",'%1','');
          IF NOT ProdOrderRtngLine.FINDFIRST THEN
            ProdOrderRtngLine."Operation No." := '';
          OnGetNeededQtyOnAfterLastOperationFound(Rec,ProdOrderRtngLine);
        END;
        IF Status IN [Status::Released,Status::Finished] THEN BEGIN
          CapLedgEntry.SETCURRENTKEY("Order Type","Order No.","Order Line No.");
          CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
          CapLedgEntry.SETRANGE("Order No.","Prod. Order No.");
          CapLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
          CapLedgEntry.SETRANGE("Operation No.",ProdOrderRtngLine."Operation No.");
          IF CapLedgEntry.FIND('-') THEN
            REPEAT
              IsHandled := FALSE;
              OnGetNeededQtyOnBeforeAddOutputQtyBase(CapLedgEntry,OutputQtyBase,IsHandled);
              IF NOT IsHandled THEN
                OutputQtyBase := OutputQtyBase + CapLedgEntry."Output Quantity" + CapLedgEntry."Scrap Quantity";
            UNTIL CapLedgEntry.NEXT = 0;
        END;

        CompQtyBase := CostCalcMgt.CalcActNeededQtyBase(ProdOrderLine,Rec,OutputQtyBase);
        OnGetNeededQtyAfterCalcCompQtyBase(Rec,CompQtyBase);

        IF IncludePreviousPosting THEN BEGIN
          IF Status IN [Status::Released,Status::Finished] THEN
            CALCFIELDS("Act. Consumption (Qty)");
          OnGetNeededQtyAfterCalcActConsumptionQty(Rec);
          EXIT(
            ROUND(
              (CompQtyBase - "Act. Consumption (Qty)") / "Qty. per Unit of Measure",
              Item."Rounding Precision",'>'));
        END;
        EXIT(ROUND(CompQtyBase / "Qty. per Unit of Measure",Item."Rounding Precision",'>'));
      END;
      OnGetNeededQtyOnAfterCalcBasedOn(Rec);
      EXIT(ROUND("Remaining Quantity",Item."Rounding Precision"));
    END;

    [External]
    PROCEDURE ShowReservation@8();
    BEGIN
      TESTFIELD("Item No.");
      CLEAR(Reservation);
      Reservation.SetProdOrderComponent(Rec);
      Reservation.RUNMODAL;
    END;

    [External]
    PROCEDURE ShowReservationEntries@21(Modal@1000 : Boolean);
    BEGIN
      TESTFIELD("Item No.");
      ReservEngineMgt.InitFilterAndSortingLookupFor(ReservEntry,TRUE);
      ReserveProdOrderComp.FilterReservFor(ReservEntry,Rec);
      IF Modal THEN
        PAGE.RUNMODAL(PAGE::"Reservation Entries",ReservEntry)
      ELSE
        PAGE.RUN(PAGE::"Reservation Entries",ReservEntry);
    END;

    [External]
    PROCEDURE CopyFromPlanningComp@40(PlanningComponent@1000 : Record 99000829);
    BEGIN
      "Line No." := PlanningComponent."Line No.";
      "Item No." := PlanningComponent."Item No.";
      Description := PlanningComponent.Description;
      "Unit of Measure Code" := PlanningComponent."Unit of Measure Code";
      "Quantity per" := PlanningComponent."Quantity per";
      Quantity := PlanningComponent.Quantity;
      Position := PlanningComponent.Position;
      "Position 2" := PlanningComponent."Position 2";
      "Position 3" := PlanningComponent."Position 3";
      "Lead-Time Offset" := PlanningComponent."Lead-Time Offset";
      "Routing Link Code" := PlanningComponent."Routing Link Code";
      "Scrap %" := PlanningComponent."Scrap %";
      "Variant Code" := PlanningComponent."Variant Code";
      "Flushing Method" := PlanningComponent."Flushing Method";
      "Location Code" := PlanningComponent."Location Code";
      IF  PlanningComponent."Bin Code" <> '' THEN
        "Bin Code" := PlanningComponent."Bin Code"
      ELSE
        GetDefaultBin;
      Length := PlanningComponent.Length;
      Width := PlanningComponent.Width;
      Weight := PlanningComponent.Weight;
      Depth := PlanningComponent.Depth;
      "Calculation Formula" := PlanningComponent."Calculation Formula";
      "Qty. per Unit of Measure" := PlanningComponent."Qty. per Unit of Measure";
      "Quantity (Base)" := PlanningComponent."Quantity (Base)";
      "Due Date" := PlanningComponent."Due Date";
      "Due Time" := PlanningComponent."Due Time";
      "Unit Cost" := PlanningComponent."Unit Cost";
      "Direct Unit Cost" := PlanningComponent."Direct Unit Cost";
      "Indirect Cost %" := PlanningComponent."Indirect Cost %";
      "Variant Code" := PlanningComponent."Variant Code";
      "Overhead Rate" := PlanningComponent."Overhead Rate";
      "Expected Quantity" := PlanningComponent."Expected Quantity";
      "Expected Qty. (Base)" := PlanningComponent."Expected Quantity (Base)";
      "Cost Amount" := PlanningComponent."Cost Amount";
      "Overhead Amount" := PlanningComponent."Overhead Amount";
      "Direct Cost Amount" := PlanningComponent."Direct Cost Amount";
      "Planning Level Code" := PlanningComponent."Planning Level Code";
      IF Status IN [Status::Released,Status::Finished] THEN
        CALCFIELDS("Act. Consumption (Qty)");
      "Remaining Quantity" := "Expected Quantity" - "Act. Consumption (Qty)";
      "Remaining Qty. (Base)" := ROUND("Remaining Quantity" * "Qty. per Unit of Measure",UOMMgt.QtyRndPrecision);
      "Shortcut Dimension 1 Code" := PlanningComponent."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := PlanningComponent."Shortcut Dimension 2 Code";
      "Dimension Set ID" := PlanningComponent."Dimension Set ID";

      OnAfterCopyFromPlanningComp(Rec,PlanningComponent);
    END;

    [External]
    PROCEDURE AdjustQtyToQtyPicked@25(VAR QtyToPost@1000 : Decimal);
    VAR
      AdjustedQty@1001 : Decimal;
      IsHandled@1002 : Boolean;
    BEGIN
      IsHandled := FALSE;
      OnBeforeAdjustQtyToQtyPicked(Rec,QtyToPost,IsHandled);
      IF IsHandled THEN
        EXIT;

      AdjustedQty :=
        "Qty. Picked" + WhseValidateSourceLine.CalcNextLevelProdOutput(Rec) -
        ("Expected Quantity" - "Remaining Quantity");

      IF QtyToPost > AdjustedQty THEN
        QtyToPost := AdjustedQty;
    END;

    [External]
    PROCEDURE BlockDynamicTracking@17(SetBlock@1000 : Boolean);
    BEGIN
      Blocked := SetBlock;
      ReserveProdOrderComp.Block(Blocked);
    END;

    [External]
    PROCEDURE CreateDim@5(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1100528251 : Integer;No2@1100528250 : Code[20]);
    VAR
      ProdOrderLine@1004 : Record 5406;
      TableID@1002 : ARRAY [10] OF Integer;
      No@1003 : ARRAY [10] OF Code[20];
    BEGIN
      TableID[1] := Type1;
      No[1] := No1;

      //**4PS.sn
      TableID[2] := Type2;
      No[2] := No2;
      //**4PS.en

      OnAfterCreateDimTableIDs(Rec,CurrFieldNo,TableID,No);

      //"Shortcut Dimension 1 Code" := ''; //**4PS.o Must be kept for Department Authorization
      "Shortcut Dimension 2 Code" := '';
      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");
      "Dimension Set ID" :=
        DimMgt.GetRecDefaultDimID(
          Rec,CurrFieldNo,TableID,No,'',
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",ProdOrderLine."Dimension Set ID",DATABASE::Item);
    END;

    [External]
    PROCEDURE IsInbound@22() : Boolean;
    BEGIN
      EXIT("Quantity (Base)" < 0);
    END;

    [External]
    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      ReserveProdOrderComp.CallItemTracking(Rec);
    END;

    [External]
    PROCEDURE ValidateShortcutDimCode@6(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      //**4PS.sn
      IF FieldNumber = 1 THEN
        DimMgt.CheckDepartmentAuthorization(DATABASE::"Prod. Order Component", ShortcutDimCode);
      //**4PS.en
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    [External]
    PROCEDURE LookupShortcutDimCode@7(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    [External]
    PROCEDURE ShowShortcutDimCode@9(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    LOCAL PROCEDURE GetUpdateFromSKU@10();
    VAR
      SKU@1000 : Record 5700;
      GetPlanningParameters@1001 : Codeunit 99000855;
    BEGIN
      GetPlanningParameters.AtSKU(SKU,"Item No.","Variant Code","Location Code");
      VALIDATE("Flushing Method",SKU."Flushing Method");
    END;

    [External]
    PROCEDURE UpdateDatetime@20();
    BEGIN
      IF ("Due Date" <> 0D) AND ("Due Time" <> 0T) THEN
        "Due Date-Time" := CREATEDATETIME("Due Date","Due Time")
      ELSE
        "Due Date-Time" := 0DT;

      OnAfterUpdateDateTime(Rec);
    END;

    LOCAL PROCEDURE GetGLSetup@11();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    [External]
    PROCEDURE RowID1@44() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(
        ItemTrackingMgt.ComposeRowID(DATABASE::"Prod. Order Component",Status,
          "Prod. Order No.",'',"Prod. Order Line No.","Line No."));
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    [External]
    PROCEDURE GetDefaultBin@50();
    VAR
      ProdOrderRtngLine@1000 : Record 5409;
    BEGIN
      IF (Quantity * xRec.Quantity > 0) AND
         ("Item No." = xRec."Item No.") AND
         ("Location Code" = xRec."Location Code") AND
         ("Variant Code" = xRec."Variant Code") AND
         ("Routing Link Code" = xRec."Routing Link Code")
      THEN
        EXIT;

      "Bin Code" := '';
      IF ("Location Code" <> '') AND ("Item No." <> '') THEN
        VALIDATE("Bin Code",GetDefaultConsumptionBin(ProdOrderRtngLine));
    END;

    [External]
    PROCEDURE GetDefaultConsumptionBin@15(VAR ProdOrderRtngLine@1000 : Record 5409) BinCode : Code[20];
    VAR
      ProdOrderLine@1001 : Record 5406;
      WMSManagement@1002 : Codeunit 7302;
    BEGIN
      OnBeforeGetDefaultConsumptionBin(Rec,ProdOrderRtngLine,BinCode);

      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");
      IF "Location Code" = ProdOrderLine."Location Code" THEN
        IF FindFirstRtngLine(ProdOrderRtngLine,ProdOrderLine) THEN
          BinCode := GetBinCodeFromRtngLine(ProdOrderRtngLine);

      OnGetDefaultConsumptionBinOnAfterGetBinCodeFromRtngLine(Rec,ProdOrderRtngLine,BinCode);
      IF BinCode <> '' THEN
        EXIT;

      BinCode := GetBinCodeFromLocation("Location Code");

      IF BinCode <> '' THEN
        EXIT;

      GetLocation("Location Code");
      IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
        WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code",BinCode);
    END;

    LOCAL PROCEDURE FindFirstRtngLine@16(VAR ProdOrderRtngLine@1000 : Record 5409;ProdOrderLine@1001 : Record 5406) : Boolean;
    BEGIN
      ProdOrderRtngLine.RESET;
      ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      ProdOrderRtngLine.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
      ProdOrderRtngLine.SETFILTER("No.",'<>%1',''); // empty No. implies blank bin codes - ignore these
      ProdOrderRtngLine.SETRANGE("Previous Operation No.",''); // first operation
      IF "Routing Link Code" <> '' THEN BEGIN
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
        ProdOrderRtngLine.SETRANGE("Previous Operation No.");
        IF ProdOrderRtngLine.COUNT = 0 THEN BEGIN // no routing line with Routing Link Code found- use 1st op
          ProdOrderRtngLine.SETRANGE("Routing Link Code");
          ProdOrderRtngLine.SETRANGE("Previous Operation No.",'');
        END;
      END;

      EXIT(ProdOrderRtngLine.FINDFIRST);
    END;

    LOCAL PROCEDURE GetBinCodeFromRtngLine@18(ProdOrderRtngLine@1000 : Record 5409) BinCode : Code[20];
    BEGIN
      CASE "Flushing Method" OF
        "Flushing Method"::Manual,
        "Flushing Method"::"Pick + Forward",
        "Flushing Method"::"Pick + Backward":
          BinCode := ProdOrderRtngLine."To-Production Bin Code";
        "Flushing Method"::Forward,
        "Flushing Method"::Backward:
          BinCode := ProdOrderRtngLine."Open Shop Floor Bin Code";
      END;
    END;

    LOCAL PROCEDURE GetBinCodeFromLocation@19(LocationCode@1000 : Code[10]) BinCode : Code[20];
    BEGIN
      GetLocation(LocationCode);
      CASE "Flushing Method" OF
        "Flushing Method"::Manual,
        "Flushing Method"::"Pick + Forward",
        "Flushing Method"::"Pick + Backward":
          BinCode := Location."To-Production Bin Code";
        "Flushing Method"::Forward,
        "Flushing Method"::Backward:
          BinCode := Location."Open Shop Floor Bin Code";
      END;
      OnAfterGetBinCodeFromLocation(Rec,Location,BinCode);
    END;

    LOCAL PROCEDURE UpdateBin@23(VAR ProdOrderComp@1000 : Record 5407;FieldNo@1001 : Integer;FieldCaption@1002 : Text[30]);
    VAR
      ProdOrderComp2@1003 : Record 5407;
      OverwriteBinCode@1004 : Boolean;
    BEGIN
      ProdOrderComp2 := ProdOrderComp;
      ProdOrderComp2.GetDefaultBin;
      IF ProdOrderComp."Bin Code" <> ProdOrderComp2."Bin Code" THEN
        IF CurrFieldNo = FieldNo THEN BEGIN
          IF CONFIRM(Text001,FALSE,FieldCaption,ProdOrderComp2."Bin Code") THEN
            OverwriteBinCode := TRUE;
        END ELSE
          OverwriteBinCode := TRUE;
      IF OverwriteBinCode THEN
        ProdOrderComp."Bin Code" := ProdOrderComp2."Bin Code";
    END;

    LOCAL PROCEDURE CheckBin@24();
    VAR
      BinContent@1000 : Record 7302;
      Bin@1001 : Record 7354;
    BEGIN
      IF "Bin Code" <> '' THEN BEGIN
        GetLocation("Location Code");
        IF NOT Location."Directed Put-away and Pick" THEN
          EXIT;

        IF BinContent.GET(
             "Location Code","Bin Code",
             "Item No.","Variant Code","Unit of Measure Code")
        THEN BEGIN
          IF NOT BinContent.CheckWhseClass(IgnoreErrors) THEN
            ErrorOccured := TRUE;
        END ELSE BEGIN
          Bin.GET("Location Code","Bin Code");
          IF NOT Bin.CheckWhseClass("Item No.",IgnoreErrors) THEN
            ErrorOccured := TRUE;
        END;
      END;
      IF ErrorOccured THEN
        "Bin Code" := '';
    END;

    [External]
    PROCEDURE AutoReserve@2();
    VAR
      Item@1001 : Record 27;
      FullAutoReservation@1000 : Boolean;
    BEGIN
      IF Status IN [Status::Simulated,Status::Finished] THEN
        EXIT;

      TESTFIELD("Item No.");
      Item.GET("Item No.");
      OnBeforeAutoReserve(Item,Rec);
      IF Item.Reserve <> Item.Reserve::Always THEN
        EXIT;

      IF "Remaining Qty. (Base)" <> 0 THEN BEGIN
        TESTFIELD("Due Date");
        ReservMgt.SetProdOrderComponent(Rec);
        ReservMgt.AutoReserve(FullAutoReservation,'',"Due Date","Remaining Quantity","Remaining Qty. (Base)");
        CALCFIELDS("Reserved Quantity","Reserved Qty. (Base)");
        FIND;
        IF NOT FullAutoReservation AND
           (CurrFieldNo <> 0)
        THEN
          IF CONFIRM(Text99000009,TRUE) THEN BEGIN
            COMMIT;
            ShowReservation;
            FIND;
          END;
      END;

      OnAfterAutoReserve(Item,Rec);
    END;

    [External]
    PROCEDURE ShowItemSub@30();
    BEGIN
      ItemSubstitutionMgt.GetCompSubst(Rec);
    END;

    LOCAL PROCEDURE GetSKU@5802() : Boolean;
    BEGIN
      IF (SKU."Location Code" = "Location Code") AND
         (SKU."Item No." = "Item No.") AND
         (SKU."Variant Code" = "Variant Code")
      THEN
        EXIT(TRUE);
      IF SKU.GET("Location Code","Item No.","Variant Code") THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE ClearCalcFormula@13();
    BEGIN
      "Calculation Formula" := "Calculation Formula"::" ";
      Length := 0;
      Width := 0;
      Weight := 0;
      Depth := 0;
    END;

    LOCAL PROCEDURE UpdateUnitCost@12();
    BEGIN
      IF GetSKU THEN
        "Unit Cost" := SKU."Unit Cost"
      ELSE
        "Unit Cost" := Item."Unit Cost";

      "Unit Cost" :=
        ROUND("Unit Cost" * "Qty. per Unit of Measure",
          GLSetup."Unit-Amount Rounding Precision");

      "Indirect Cost %" := ROUND(Item."Indirect Cost %",UOMMgt.QtyRndPrecision);

      "Overhead Rate" :=
        ROUND(Item."Overhead Rate" * "Qty. per Unit of Measure",
          GLSetup."Unit-Amount Rounding Precision");

      "Direct Unit Cost" :=
        ROUND(
          ("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100),
          GLSetup."Unit-Amount Rounding Precision");

      OnAfterUpdateUnitCost(Rec,GLSetup);
    END;

    [External]
    PROCEDURE FilterLinesWithItemToPlan@70(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean);
    BEGIN
      RESET;
      SETCURRENTKEY("Item No.","Variant Code","Location Code",Status,"Due Date");
      IF IncludeFirmPlanned THEN
        SETRANGE(Status,Status::Planned,Status::Released)
      ELSE
        SETFILTER(Status,'%1|%2',Status::Planned,Status::Released);
      SETRANGE("Item No.",Item."No.");
      SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
      SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
      SETFILTER("Due Date",Item.GETFILTER("Date Filter"));
      SETFILTER("Shortcut Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
      SETFILTER("Shortcut Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
      SETFILTER("Remaining Qty. (Base)",'<>0');
    END;

    [External]
    PROCEDURE FindLinesWithItemToPlan@68(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,IncludeFirmPlanned);
      EXIT(FIND('-'));
    END;

    [External]
    PROCEDURE LinesWithItemToPlanExist@67(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,IncludeFirmPlanned);
      EXIT(NOT ISEMPTY);
    END;

    [External]
    PROCEDURE ShowDimensions@69();
    BEGIN
      DimMgt.SetTableID(DATABASE::"Prod. Order Component"); //**4PS.n
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2 %3',Status,"Prod. Order No.","Prod. Order Line No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    [External]
    PROCEDURE SetIgnoreErrors@31();
    BEGIN
      IgnoreErrors := TRUE;
    END;

    [External]
    PROCEDURE HasErrorOccured@32() : Boolean;
    BEGIN
      EXIT(ErrorOccured);
    END;

    [External]
    PROCEDURE SetFilterByReleasedOrderNo@26(OrderNo@1000 : Code[20]);
    BEGIN
      RESET;
      SETCURRENTKEY(Status,"Prod. Order No.","Prod. Order Line No.","Item No.","Line No.");
      SETRANGE(Status,Status::Released);
      SETRANGE("Prod. Order No.",OrderNo);
    END;

    PROCEDURE SetFilterFromProdBOMLine@39(ProdBOMLine@1000 : Record 99000772);
    BEGIN
      SETRANGE("Item No.",ProdBOMLine."No.");
      SETRANGE("Variant Code",ProdBOMLine."Variant Code");
      SETRANGE("Routing Link Code",ProdBOMLine."Routing Link Code");
      SETRANGE(Position,ProdBOMLine.Position);
      SETRANGE("Position 2",ProdBOMLine."Position 2");
      SETRANGE("Position 3",ProdBOMLine."Position 3");
      SETRANGE(Length,ProdBOMLine.Length);
      SETRANGE(Width,ProdBOMLine.Width);
      SETRANGE(Weight,ProdBOMLine.Weight);
      SETRANGE(Depth,ProdBOMLine.Depth);
      SETRANGE("Unit of Measure Code",ProdBOMLine."Unit of Measure Code");
    END;

    LOCAL PROCEDURE IsLineRequiredForSingleDemand@27(ProdOrderLine@1001 : Record 5406;DemandLineNo@1002 : Integer) : Boolean;
    VAR
      ProdOrderComponent@1000 : Record 5407;
    BEGIN
      ProdOrderComponent.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderComponent.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderComponent.SETFILTER("Prod. Order Line No.",'<>%1',DemandLineNo);
      ProdOrderComponent.SETRANGE("Supplied-by Line No.",ProdOrderLine."Line No.");
      EXIT(ProdOrderComponent.ISEMPTY);
    END;

    [External]
    PROCEDURE TestItemFields@61(ItemNo@1000 : Code[20];VariantCode@1001 : Code[10];LocationCode@1002 : Code[10]);
    BEGIN
      TESTFIELD("Item No.",ItemNo);
      TESTFIELD("Variant Code",VariantCode);
      TESTFIELD("Location Code",LocationCode);
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterAutoReserve@33(VAR Item@1000 : Record 27;VAR ProdOrderComp@1001 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyFromPlanningComp@42(VAR ProdOrderComponent@1000 : Record 5407;PlanningComponent@1001 : Record 99000829);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCreateDimTableIDs@138(VAR ProdOrderComponent@1000 : Record 5407;CallingFieldNo@1001 : Integer;VAR TableID@1003 : ARRAY [10] OF Integer;VAR No@1002 : ARRAY [10] OF Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterGetBinCodeFromLocation@60(VAR ProdOrderComponent@1000 : Record 5407;Location@1002 : Record 14;VAR BinCode@1001 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateUnitCost@28(VAR ProdOrderComp@1000 : Record 5407;GeneralLedgerSetup@1001 : Record 98);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterProdOrderNeeds@29(ProdOrderComponent@1000 : Record 5407;ProdOrderLine@1001 : Record 5406;ProdOrderRoutingLine@1002 : Record 5409;VAR NeededQty@1003 : Decimal);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterRoundExpectedQuantity@41(VAR ProdOrderComponent@1000 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterUpdateDateTime@51(VAR ProdOrderComponent@1000 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeAdjustQtyToQtyPicked@52(VAR ProdOrderComponent@1000 : Record 5407;VAR QtyToPost@1001 : Decimal;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeAutoReserve@34(VAR Item@1000 : Record 27;VAR ProdOrderComp@1001 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeBinCodeOnLookup@49(VAR ProdOrderComponent@1000 : Record 5407;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeGetDefaultConsumptionBin@57(VAR ProdOrderComponent@1000 : Record 5407;VAR ProdOrderRoutingLine@1001 : Record 5409;VAR BinCode@1002 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnDeleteOnBeforeGetProdOrderLine@14(VAR ProdOrderComponent@1000 : Record 5407;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetDefaultConsumptionBinOnAfterGetBinCodeFromRtngLine@58(VAR ProdOrderComponent@1000 : Record 5407;VAR ProdOrderRoutingLine@1001 : Record 5409;VAR BinCode@1003 : Code[20]);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetNeededQtyAfterCalcCompQtyBase@37(VAR ProdOrderComp@1000 : Record 5407;VAR CompQtyBase@1001 : Decimal);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetNeededQtyAfterCalcActConsumptionQty@38(VAR ProdOrderComp@1000 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetNeededQtyOnAfterCalcBasedOn@54(VAR ProdOrderComponent@1000 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetNeededQtyOnAfterLastOperationFound@46(VAR ProdOrderComponent@1000 : Record 5407;VAR ProdOrderRoutingLine@1001 : Record 5409);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetNeededQtyOnBeforeAddOutputQtyBase@48(VAR CapacityLedgerEntry@1000 : Record 5832;VAR OutputQtyBase@1001 : Decimal;VAR IsHandled@1002 : Boolean);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetNeededQtyOnBeforeCalcBasedOn@55(VAR ProdOrderComponent@1000 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateCalculationFormulaOnAfterSetQuantity@43(VAR ProdOrderComponent@1000 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateExpectedQuantityOnAfterCalcActConsumptionQty@35(VAR ProdOrderComp@1000 : Record 5407;xProdOrderComp@1001 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateExpectedQtyBaseOnAfterCalcActConsumptionQty@36(VAR ProdOrderComp@1001 : Record 5407;xProdOrderComp@1000 : Record 5407);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateItemNoOnBeforeGetDefaultBin@45(VAR ProdOrderComponent@1000 : Record 5407;VAR Item@1001 : Record 27);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnValidateRoutingLinkCodeBeforeValidateDueDate@47(VAR ProdOrderComponent@1000 : Record 5407;VAR ProdOrderLine@1001 : Record 5406);
    BEGIN
    END;

    LOCAL PROCEDURE DPA_OnInsert@1100000991();
    BEGIN
      //**4PS
      IF NOT DPA_IsActive THEN
        EXIT;

      IF "Shortcut Dimension 1 Code" <> '' THEN
        VALIDATE("Shortcut Dimension 1 Code");
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
      FPSLicenseManagement@1100528500 : Codeunit 11229289;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(5407) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 5407');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Prod. Order Component", "Shortcut Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Shortcut Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Shortcut Dimension 1 Code");
    END;

    BEGIN
    END.
  }
}

