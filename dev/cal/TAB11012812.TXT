OBJECT Table 11012812 Service-Contract
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    Permissions=TableData 11012812=md,
                TableData 11012819=r;
    DataCaptionFields=No.,Description;
    OnInsert=VAR
               ServPortSetup@1100525000 : Record 11126065;
               ServiceSurchargeManagement@1100528600 : Codeunit 11012834;
             BEGIN
               ServSetup.GET;

               "Preclosure Result" := ServSetup."Preclosure Result";
               "Progress Preclosure Result" := ServSetup."Progress Preclosure Result";
               "Contract Prognosis Level 1" := ServSetup."Contract Prognosis Level 1";
               "Contract Prognosis Level 2" := ServSetup."Contract Prognosis Level 2";
               "Contract Prognosis based on" := ServSetup."Contract Prognosis based on";
               IF "VAT Prod. Posting Group" = '' THEN
                 "VAT Prod. Posting Group" := ServSetup."VAT Prod. Posting Group";
               "Use Bill-to as Sell-to (CP)" := ServSetup."Use Bill-to as Sell-to Custom."; //call 29646
               "Use Bill-to as Sell-to (Contr)" := ServSetup."Use Bill-to as Sell-to Custom.";
               IF ("Control Reference Date" = 0D) AND ("Number of Control Ref. Periods" = 0) THEN BEGIN
                 "Control Reference Date" := ServSetup."Control Reference Date";
                 "Number of Control Ref. Periods" := ServSetup."Number of Control Ref. Periods";
               END;

               IF "No." = '' THEN BEGIN
                 IF "No. Series" = '' THEN BEGIN
                   ServSetup.TESTFIELD("Service Contract Nos.");
                   "No. Series" := ServSetup."Service Contract Nos.";
                 END;
                 NoSeriesMgt.InitSeries("No. Series", xRec."No. Series", 0D, "No.", "No. Series");
                 IF "Service Type" = '' THEN
                   "Service Type" := DetermineServiceTypeSeries(ServSetup."Service Contract Nos.");
               END;

               TESTFIELD("No.");
               "Version Date" := TODAY;
               "Input by" := USERID;
               "Input Date" := TODAY;
               "Maintenance Planning based on" := ServSetup."Maintenance Planning based on";
               IF "Starting Date Maintenance" = 0D THEN BEGIN
                 IF "Renewal Date" <> 0D THEN
                   "Starting Date Maintenance" := "Renewal Date"
                 ELSE
                   "Starting Date Maintenance" := "Starting Date";
               END;
               //mg.sn, 06-06-12: M34063
               IF "Global Dimension 1 Code" <> '' THEN
                 VALIDATE("Global Dimension 1 Code");
               //mg.en, 06-06-12: M34063

               ServPortSetup.SETRANGE("Primary Key", '1');
               IF ServPortSetup.FINDFIRST THEN
                 IF ServPortSetup."Contract Publ. on Serv. Portal" THEN
                   VALIDATE("Publish on Service Portal", ServPortSetup."Contract Publ. on Serv. Portal");

               RefLimitRec.CopyReferenceToServiceContract("No.");
               MailRec.CopyToContract("No.", "Customer No.");  //db, 21-03-11

               ServiceSurchargeManagement.CopySurchargeLinesToSC(Rec);
               CopySCSourceTypeSetup;
               CopySCTemplateCategories;
               CopySCTemplateClusters;
               CopySCTemplateSalesDiscount;
               CopySCTemplateExtraCosts;
               CopySCTemplateSUPClusters;
               CheckAndResetInstallmBasedOn;

               CopySCBudgetCallsRelease;

               //**4PS Generated Code. Do Not Change.sn05
               DPA_OnInsert;
               //**4PS Generated Code.en05

               InitFSASettings;
             END;

    OnModify=BEGIN
               CheckAndResetInstallmBasedOn;
               CheckAndResetContractInstallm;

               "Modified by" := USERID;
               "Last Date Modified" := TODAY;
               IF "Internal Contract" THEN BEGIN  //db, 15-04-11
                 ServSetup.GET;
                 TESTFIELD("Customer No.", ServSetup."Customer Internal Charge");
               END;
             END;

    OnDelete=VAR
               CommLineRec@1100485000 : Record 97;
               ServTextRec@1100485003 : Record 11012882;
               RespRec@1100485002 : Record 11012808;
               ContactRec@1100485001 : Record 11012841;
               ServPrioRec@1100485004 : Record 11012880;
               ServDiscRec@1100485005 : Record 11012881;
               lServContEmplCostPriceRec@1100485009 : Record 11020322;
               lServTradeAssCostPriceRec@1100485008 : Record 11020323;
               lServCostObjCostPriceRec@1100485007 : Record 11020324;
               lServTradeWageCCostPriceRec@1100485006 : Record 11020325;
               ServContFeatureType@1210190000 : Record 11012753;
               ContractInstallment@1210190001 : Record 11071707;
               SCInstallmentAmountbyDate@1210190002 : Record 11071708;
               SubcontractorService@1210190003 : Record 11071789;
               ServiceContractCtrlPeriod@1210190004 : Record 11071746;
               SCCustSourceTypeSetup@1100528600 : Record 11071800;
               ContractObject@1210190005 : Record 11071702;
               ServiceSurchargeVersion@1100525000 : Record 11071783;
               ServiceCluster@1100525002 : Record 11071742;
               ServiceContractControlMsg@1100525003 : Record 11071956;
               ConsumptionRate@1100528800 : Record 11071970;
               ServiceCategory@1100528601 : Record 11071985;
               SCRevenueDivision@1100528602 : Record 11071986;
               SCBudgetVersion@1100528603 : Record 11071990;
               ServiceContractVATBreakdown@1100525004 : Record 11071995;
               ServSurvLocationObject@1100525005 : Record 11071813;
               AllObjWithCaption@1100529201 : Record 2000000058;
               SControlSourceType@1100528604 : Record 11072293;
               SControlSourceCostType@1100528605 : Record 11072295;
               ServiceContractAnalysis@1100528606 : Record 11072329;
               ServiceContractLocation@1100527400 : Record 11072554;
             BEGIN
               TESTFIELD(Status, Status::Expired);
               IF WIPEntriesExists THEN BEGIN
                 AllObjWithCaption.GET(AllObjWithCaption."Object Type"::Report, REPORT::"Close Open Entries Expired SC");
                 ERROR(Text121, AllObjWithCaption."Object Caption");
               END;

               VALIDATE(Status, Status::Expired);  //db, 19-09-06: includes check WIP

               MoveEntries.RemoveServContractEntries(Rec);

               ContrDiscRec.SETRANGE("Service Contract No.", "No.");
               ContrDiscRec.DELETEALL(TRUE);

               ContrDepRec.SETRANGE("Service Contract No.", "No.");
               ContrDepRec.DELETEALL(TRUE);

               ContrHourRec.SETRANGE("Service Contract No.", "No.");
               ContrHourRec.DELETEALL;

               CostCompRec.SETRANGE("Service Contract No.", "No.");
               CostCompRec.DELETEALL(TRUE);

               ServActRec.SETRANGE("Service Contract No.", "No.");
               ServActRec.DELETEALL(TRUE);

               TimeTableRec.SETRANGE(Code, "No.");
               TimeTableRec.DELETEALL(TRUE);

               ServPrioRec.SETRANGE("Service Contract No.", "No.");
               ServPrioRec.DELETEALL(TRUE);

               ServDiscRec.SETRANGE("Service Contract No.", "No.");
               ServDiscRec.DELETEALL(TRUE);

               RefLimitRec.SETRANGE("Service Contract No.", "No.");
               RefLimitRec.DELETEALL(TRUE);

               RespRec.SETRANGE("Service Contract No.", "No.");
               RespRec.DELETEALL;

               ContactRec.SETRANGE("Service Contract No.", "No.");
               ContactRec.DELETEALL;

               PrefEmplRec.SETRANGE("Service Contract No.", "No.");
               PrefEmplRec.DELETEALL(TRUE);

               CommLineRec.SETRANGE("Table Name",CommLineRec."Table Name"::"Service Contract");
               CommLineRec.SETRANGE("No.","No.");
               CommLineRec.DELETEALL;

               ServTextRec.SETRANGE("Table Name",ServTextRec."Table Name"::"Service Contract");
               ServTextRec.SETRANGE("No.","No.");
               ServTextRec.DELETEALL;

               CustSurchRec.RESET;
               CustSurchRec.SETRANGE("Record Type", CustSurchRec."Record Type"::ServContr);
               CustSurchRec.SETFILTER("Customer No.", '%1', '');
               CustSurchRec.SETRANGE(Code, "No.");
               CustSurchRec.DELETEALL;

               lServContEmplCostPriceRec.SETRANGE("Service Contract No.", "No.");
               lServContEmplCostPriceRec.DELETEALL;

               lServTradeAssCostPriceRec.SETRANGE("Service Contract No.", "No.");
               lServTradeAssCostPriceRec.DELETEALL;

               lServCostObjCostPriceRec.SETRANGE("Service Contract No.", "No.");
               lServCostObjCostPriceRec.DELETEALL;

               lServTradeWageCCostPriceRec.SETRANGE("Service Contract No.", "No.");
               lServTradeWageCCostPriceRec.DELETEALL;

               MailRec.SETRANGE("Service Contract No.", "No.");
               MailRec.DELETEALL(TRUE);  //db, 31-05-11

               ServContFeatureType.SETRANGE("Relation Type", ServContFeatureType."Relation Type"::ServiceContract);
               ServContFeatureType.SETRANGE(Code , "No.");
               ServContFeatureType.DELETEALL;

               ContractInstallment.SETRANGE("Service Contract No.","No.");
               ContractInstallment.DELETEALL(TRUE);

               ContractObject.SETRANGE("Service Contract No.", "No.");
               ContractObject.DELETEALL(TRUE);

               SCInstallmentAmountbyDate.SETRANGE(Type, SCInstallmentAmountbyDate.Type::"Service Contract");
               SCInstallmentAmountbyDate.SETRANGE("Service Contract No.", "No.");
               SCInstallmentAmountbyDate.DELETEALL(TRUE);

               SubcontractorService.SETRANGE("Service Contract No.", "No.");
               SubcontractorService.DELETEALL(TRUE);

               ServiceSurchargeVersion.SETRANGE(Type, ServiceSurchargeVersion.Type::Contract);
               ServiceSurchargeVersion.SETRANGE(Code, "No.");
               ServiceSurchargeVersion.DELETEALL(TRUE);

               ServiceContractCtrlPeriod.SETRANGE("Service Contract No.", "No.");
               ServiceContractCtrlPeriod.DELETEALL(TRUE);

               SCCustSourceTypeSetup.SETRANGE(Type, SCCustSourceTypeSetup.Type::Contract);
               SCCustSourceTypeSetup.SETRANGE(Code, "No.");
               SCCustSourceTypeSetup.DELETEALL(TRUE);

               ServiceCluster.SETRANGE(Type, ServiceCluster.Type::Contract);
               ServiceCluster.SETRANGE("Type Code", "No.");
               ServiceCluster.SETRANGE("Source Type", ServiceCluster."Source Type"::" ");
               ServiceCluster.DELETEALL(TRUE);

               ServiceContractControlMsg.SETRANGE("Service Contract No.", "No.");
               ServiceContractControlMsg.DELETEALL(TRUE);

               ConsumptionRate.SETRANGE("Service Contract", "No.");
               ConsumptionRate.DELETEALL(TRUE);

               SCRevenueDivision.SETRANGE("Service Contract No.", "No.");
               SCRevenueDivision.DELETEALL(TRUE);

               ServiceCategory.SETRANGE("Service Contract No.", "No.");
               ServiceCategory.DELETEALL(TRUE);

               SCBudgetVersion.SETRANGE("Service Contract No.", "No.");
               SCBudgetVersion.DELETEALL(TRUE);

               ServiceContractVATBreakdown.SETRANGE("Service Contract No.", "No.");
               ServiceContractVATBreakdown.DELETEALL(TRUE);

               ServSurvLocationObject.SETRANGE("Service Contract No.", "No.");
               ServSurvLocationObject.MODIFYALL("Service Contract No.", '', FALSE);

               SControlSourceType.SETRANGE("Service Contract No.", "No.");
               SControlSourceType.DELETEALL(TRUE);

               SControlSourceCostType.SETRANGE("Service Contract No.", "No.");
               SControlSourceCostType.DELETEALL(TRUE);

               ServiceContractAnalysis.SETRANGE("Service Contract No.", "No.");
               ServiceContractAnalysis.DELETEALL(TRUE);

               ServiceContractLocation.SETRANGE("Service Contract No.", "No.");
               ServiceContractLocation.DELETEALL(TRUE);

               DimMgt.DeleteDefaultDim(DATABASE::"Service-Contract", "No.");   //** 09-06-2010
             END;

    OnRename=BEGIN
               DimMgt.CopyDefaultDim(                                             //** 09-06-2010 sn
                 DATABASE::"Service-Contract", xRec."No.",
                 DATABASE::"Service-Contract", "No.");
               DimMgt.DeleteDefaultDim(DATABASE::"Service-Contract", xRec."No."); //** 09-06-2010 en
             END;

    CaptionML=[ENU=Service Contract;
               NOR=Servicekontrakt;
               SVE=Servicekontrakt];
    LookupPageID=Page11012825;
    DrillDownPageID=Page11012825;
  }
  FIELDS
  {
    { 10  ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  ServSetup.GET;
                                                                  NoSeriesMgt.TestManual(ServSetup."Service Contract Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.;
                                                              SVE=Nr] }
    { 20  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 30  ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2;
                                                              SVE=Beskrivning 2] }
    { 40  ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  IF (xRec.Status =  Status::Closed) OR (Status = Status::Closed) THEN
                                                                    ERROR(Text131, FIELDCAPTION(Status));
                                                                IF Status = Status::Expired THEN BEGIN
                                                                  CheckStatusExpired;
                                                                  Blocked := TRUE;
                                                                END;
                                                                IF Status IN [Status::Order, Status::"Invoicing Allowed"] THEN BEGIN
                                                                  TESTFIELD("Starting Date");
                                                                  TESTFIELD("Starting Date Control Period");
                                                                  TESTFIELD("Control Period Interval");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[ENU=Applied,Offered,Order,Invoicing Allowed,Expired,Closed;
                                                                    NOR=Anvendt,Tilbudt,Ordre,Fakturering Tillatt,Utg†tt;
                                                                    SVE=Till„mpad,Anbudsgiven,Order,Fakturering till†ten,Utg†ngen,St„ngd];
                                                   OptionString=Applied,Offered,Order,Invoicing Allowed,Expired,Closed }
    { 45  ;   ;Blocked             ;Boolean       ;OnValidate=BEGIN
                                                                IF Status = Status::Expired THEN
                                                                  ERROR(Text002);
                                                              END;

                                                   CaptionML=[ENU=Blocked;
                                                              NOR=Sperret;
                                                              SVE=Sp„rrad] }
    { 50  ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF ("No." = '') AND (xRec."Customer No." <> "Customer No.") THEN
                                                                  EXIT; //mg, 20-03-2014: T004481 Platform bug

                                                                IF "No." <> '' THEN BEGIN
                                                                  ServEntryRec.SETCURRENTKEY("Service Contract No.");
                                                                  ServEntryRec.SETRANGE("Service Contract No.", "No.");
                                                                  IF ServEntryRec.FINDFIRST THEN
                                                                    MESSAGE(Text007);
                                                                END;

                                                                IF "Customer No." <> '' THEN BEGIN
                                                                  CustRec.GET("Customer No.");
                                                                  CustRec.CheckCustomerStatus("Customer No.");
                                                                  "Contact Name" := CustRec.Contact;
                                                                  "Contact Person" := '';
                                                                  "Phone No.":= CustRec."Phone No.";
                                                                  "Phone No. 2" := CustRec."Phone No. 2";
                                                                  "Mobile Phone No." := CustRec."Mobile Phone No.";
                                                                  "Fax No." := CustRec."Fax No.";
                                                                  "E-Mail" := CustRec."E-Mail";
                                                                  "Payment Terms Code" := CustRec."Payment Terms Code";  //db, 18-04-14: C014687
                                                                  "Use Bill-to as Sell-to (CP)" := CustRec."Use Bill-to as Sell-to Custom.";
                                                                  "Use Bill-To Cust. for Pr. Book" := CustRec."Use Bill-To Cust. for Pr. Book";

                                                                  IF "Bill-to Customer No. (CP)" = '' THEN
                                                                    VALIDATE("Bill-to Customer No. (CP)", CustRec."Bill-to Customer No.")
                                                                  ELSE
                                                                    IF (CurrFieldNo = FIELDNO("Customer No.")) AND (CustRec."Bill-to Customer No." <> "Bill-to Customer No. (CP)") THEN
                                                                      IF CONFIRM(Text006,FALSE,FIELDCAPTION("Bill-to Customer No. (CP)")) THEN BEGIN
                                                                        VALIDATE("Bill-to Customer No. (CP)",CustRec."Bill-to Customer No.");
                                                                        "Alt. Bill-to Address (CP)" := '';
                                                                      END;

                                                                  IF "Bill-to Customer No. (Contr.)" = '' THEN
                                                                    VALIDATE("Bill-to Customer No. (Contr.)", CustRec."Bill-to Customer No.")
                                                                  ELSE
                                                                    IF (CurrFieldNo = FIELDNO("Customer No.")) AND (CustRec."Bill-to Customer No." <> "Bill-to Customer No. (Contr.)") THEN
                                                                      IF CONFIRM(Text006,FALSE,FIELDCAPTION("Bill-to Customer No. (Contr.)")) THEN BEGIN
                                                                        VALIDATE("Bill-to Customer No. (Contr.)",CustRec."Bill-to Customer No.");
                                                                        "Alt. Bill-to Address (Contr.)" := '';
                                                                      END;

                                                                  DeterminePriceBookFields;
                                                                END ELSE BEGIN
                                                                  "Contact Name" := '';
                                                                  "Phone No.":= '';
                                                                  "Phone No. 2" := '';
                                                                  "Mobile Phone No." := '';
                                                                  "Fax No." := '';
                                                                  "E-Mail" := '';
                                                                END;

                                                                IF "Customer No." <> xRec."Customer No." THEN BEGIN
                                                                  CALCFIELDS(
                                                                    Name,"Name 2",Address,"Address 2",
                                                                    "Post Code",City,County,"Country/Region Code",
                                                                    "Bill-to Name (Cost Plus)","Bill-to Name 2 (Cost Plus)","Bill-to Address (Cost Plus)","Bill-to Address 2 (Cost Plus)",
                                                                    "Bill-to Post Code (Cost Plus)","Bill-to City (Cost Plus)",
                                                                    "Bill-to Name (Contract)","Bill-to Name 2 (Contract)","Bill-to Address (Contract)","Bill-to Address 2 (Contract)",
                                                                    "Bill-to Post Code (Contract)","Bill-to City (Contract)");
                                                                  MailRec.CopyToContract("No.", "Customer No.");  //mg, 09-01-12: M32065
                                                                  CopyCustomerNotGlobalDims();  //*24651.n
                                                                END;

                                                                "Currency Code" := DetermineCurrencyCode;  // dp00116.n
                                                              END;

                                                   CaptionML=[ENU=Customer No.;
                                                              NOR=Kundenr.;
                                                              SVE=Kundnr] }
    { 60  ;   ;Name                ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Name;
                                                              NOR=Navn;
                                                              SVE=Namn];
                                                   Editable=No }
    { 65  ;   ;Name 2              ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Name 2" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Name 2;
                                                              NOR=Navn 2;
                                                              SVE=Namn 2];
                                                   Editable=No }
    { 70  ;   ;Address             ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Address WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress];
                                                   Editable=No }
    { 80  ;   ;Address 2           ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Address 2" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2;
                                                              SVE=Adress 2];
                                                   Editable=No }
    { 90  ;   ;Post Code           ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Post Code" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr;
                                                              SVE=Postnr];
                                                   Editable=No }
    { 95  ;   ;County              ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.County WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=County;
                                                              NOR=Delstat;
                                                              SVE=Delstat];
                                                   Editable=No }
    { 100 ;   ;City                ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.City WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=City;
                                                              NOR=Poststed;
                                                              SVE=Ort];
                                                   Editable=No }
    { 105 ;   ;Country/Region Code ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Country/Region Code" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode;
                                                              SVE=Lands-/regionkod];
                                                   Editable=No }
    { 110 ;   ;Contact Name        ;Text100       ;OnValidate=BEGIN
                                                                IF "Contact Name" = '' THEN
                                                                  "Contact Person" := '';
                                                              END;

                                                   CaptionML=[ENU=Contact Name;
                                                              NOR=Kontaktnavn;
                                                              SVE=Kontaktnamn] }
    { 120 ;   ;Your Reference      ;Text50        ;CaptionML=[ENU=Your Reference;
                                                              NOR=Deres referanse;
                                                              SVE=Er referens] }
    { 130 ;   ;Contract Manager    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Contract Manager;
                                                              NOR=Kontraktleder;
                                                              SVE=Kontrakthanterare] }
    { 131 ;   ;Contract Manager Name;Text50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Contract Manager)));
                                                   CaptionML=[ENU=Contract Manager Name;
                                                              NOR=Kontraktleders navn;
                                                              SVE=Kontraktschefsnamn];
                                                   Editable=No }
    { 140 ;   ;Bill-to Customer No. (CP);Code20   ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF "Bill-to Customer No. (CP)" <> xRec."Bill-to Customer No. (CP)" THEN BEGIN
                                                                  IF "Bill-to Customer No. (CP)" <> '' THEN BEGIN
                                                                    CustRec.GET("Bill-to Customer No. (CP)");
                                                                    CustRec.CheckCustomerStatus("Bill-to Customer No. (CP)");
                                                                  END;
                                                                  IF (CurrFieldNo <> FIELDNO("Customer No.")) AND "Invoicing via Collective List" THEN
                                                                    TESTFIELD("Bill-to Customer No. (Contr.)", "Bill-to Customer No. (CP)");
                                                                END;

                                                                IF "Customer No." <> '' THEN BEGIN
                                                                  CustRec.GET("Customer No.");
                                                                  IF CustRec."Bill-to Customer No." <> '' THEN
                                                                    IF "Bill-to Customer No. (CP)" = '' THEN
                                                                      "Bill-to Customer No. (CP)" := CustRec."Bill-to Customer No.";
                                                                END;
                                                                IF "Bill-to Customer No. (CP)" = '' THEN
                                                                  "Bill-to Customer No. (CP)" := "Customer No.";
                                                                IF CustRec.GET("Bill-to Customer No. (CP)") THEN BEGIN
                                                                  GetDefaultSalesSurcharges;
                                                                  VALIDATE("Sales Discount Term Group 1", CustRec."Sales Discount Term Group");
                                                                  IF "Bill-to Customer No. (CP)" <> xRec."Bill-to Customer No. (CP)" THEN BEGIN
                                                                    "Use Bill-To Cust. for Pr. Book" := CustRec."Use Bill-To Cust. for Pr. Book";
                                                                    IF "Use Bill-To Cust. for Pr. Book" THEN
                                                                      DeterminePriceBookFields;
                                                                  END;
                                                                END;
                                                                DetermineAlternativeBilltoAddress(FIELDNO("Bill-to Customer No. (CP)"));
                                                                CheckInvoiceAddress;
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No. (Cost Plus);
                                                              SVE=Faktureringskundnr (l”pande)] }
    { 150 ;   ;Bill-to Name (Cost Plus);Text100   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD("Bill-to Customer No. (CP)")));
                                                   CaptionML=[ENU=Bill-to Name  (Cost Plus);
                                                              SVE=Faktureringsnamn (l”pande)];
                                                   Editable=No }
    { 155 ;   ;Bill-to Name 2 (Cost Plus);Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Name 2" WHERE (No.=FIELD("Bill-to Customer No. (CP)")));
                                                   CaptionML=[ENU=Bill-to Name 2 (Cost Plus);
                                                              SVE=Faktureringsnamn 2 (l”pande)];
                                                   Editable=No }
    { 160 ;   ;Bill-to Address (Cost Plus);Text100;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Address WHERE (No.=FIELD("Bill-to Customer No. (CP)")));
                                                   CaptionML=[ENU=Bill-to Address (Cost Plus);
                                                              SVE=Faktureringsadress (l”pande)];
                                                   Editable=No }
    { 170 ;   ;Bill-to Address 2 (Cost Plus);Text50;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Address 2" WHERE (No.=FIELD("Bill-to Customer No. (CP)")));
                                                   CaptionML=[ENU=Bill-to Address 2 (Cost Plus);
                                                              SVE=Faktureringsadress 2 (l”pande)];
                                                   Editable=No }
    { 180 ;   ;Bill-to Post Code (Cost Plus);Code20;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Post Code" WHERE (No.=FIELD("Bill-to Customer No. (CP)")));
                                                   CaptionML=[ENU=Bill-to Post Code (Cost Plus);
                                                              SVE=Faktureras postnr (l”pande)];
                                                   Editable=No }
    { 190 ;   ;Bill-to City (Cost Plus);Text30    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.City WHERE (No.=FIELD("Bill-to Customer No. (CP)")));
                                                   CaptionML=[ENU=Bill-to City (Cost Plus);
                                                              SVE=Faktureras ort (l”pande)];
                                                   Editable=No }
    { 200 ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr-serie;
                                                              SVE=Nr-serie];
                                                   Editable=No }
    { 210 ;   ;Version Date        ;Date          ;CaptionML=[ENU=Version Date;
                                                              NOR=Versjonsdato;
                                                              SVE=Versionsdatum] }
    { 220 ;   ;Phone No.           ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Phone No.");
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              NOR=Telefonnr;
                                                              SVE=Telefonnr] }
    { 230 ;   ;Fax No.             ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Fax No.");
                                                              END;

                                                   CaptionML=[ENU=Fax No.;
                                                              NOR=Telefaxnr;
                                                              SVE=Telefaxnr] }
    { 240 ;   ;E-Mail              ;Text80        ;CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 250 ;   ;Contract Group      ;Code20        ;TableRelation="Service Contract Group".Code;
                                                   OnValidate=BEGIN
                                                                IF "Contract Group" <> xRec."Contract Group" THEN
                                                                  CopySCBudgetCallsRelease;
                                                              END;

                                                   CaptionML=[ENU=Contract Group;
                                                              NOR=Kontraktgruppe;
                                                              SVE=Kontraktsgrupp] }
    { 259 ;   ;Service Type (Other);Code20        ;TableRelation="Service Type";
                                                   OnValidate=BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("Service Type (Other)"));

                                                                ServSetup.GET;
                                                                IF ServSetup."Copy Additional Cost Setup" THEN BEGIN
                                                                   TESTFIELD("Service Type (Other)", "Service Type");
                                                                   VALIDATE("Department Code (Other)", "Global Dimension 1 Code");
                                                                END ELSE BEGIN
                                                                  IF ServTypeRec.GET("Service Type (Other)") THEN
                                                                    IF ServTypeRec."Department Code" <> '' THEN
                                                                      VALIDATE("Department Code (Other)", ServTypeRec."Department Code");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Service Type (Additional Cost);
                                                              NOR=Servicetype (Tilleggskost);
                                                              SVE=Servicetyp (extra kostnad)] }
    { 260 ;   ;Service Type        ;Code20        ;TableRelation="Service Type".Code;
                                                   OnValidate=BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("Service Type"));

                                                                ServSetup.GET;
                                                                IF ServSetup."Copy Additional Cost Setup" THEN
                                                                   VALIDATE("Service Type (Other)", "Service Type");
                                                                IF ServTypeRec.GET("Service Type") THEN
                                                                  IF ServTypeRec."Department Code" <> '' THEN
                                                                    VALIDATE("Global Dimension 1 Code", ServTypeRec."Department Code");
                                                              END;

                                                   CaptionML=[ENU=Service Type;
                                                              NOR=Servicetype;
                                                              SVE=Servicetyp] }
    { 270 ;   ;Offered Amount      ;Decimal       ;CaptionML=[ENU=Offered Amount;
                                                              NOR=Tilbudt bel›p;
                                                              SVE=Anbudsbelopp];
                                                   AutoFormatType=1 }
    { 280 ;   ;Offering Date       ;Date          ;OnValidate=BEGIN
                                                                IF "Offering Date" <> 0D THEN
                                                                  CheckStatus(1);
                                                                IF ("Offering Date" > "Accept before") AND ("Accept before" <> 0D) THEN
                                                                  MESSAGE(Text004a, FIELDCAPTION("Offering Date"), FIELDCAPTION("Accept before"));
                                                              END;

                                                   CaptionML=[ENU=Offering Date;
                                                              NOR=Tilbudsdato;
                                                              SVE=Anbudsdatum] }
    { 290 ;   ;Accept before       ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Offering Date");
                                                                IF ("Accept before" > "Order Date") AND ("Order Date" <> 0D) THEN
                                                                  MESSAGE(Text004a, FIELDCAPTION("Accept before"), FIELDCAPTION("Order Date"));
                                                              END;

                                                   CaptionML=[ENU=Accept before;
                                                              NOR=Aksepter f›r;
                                                              SVE=Acceptera f”re] }
    { 295 ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Accept before");
                                                                IF "Order Date" <> 0D THEN
                                                                  CheckStatus(2);
                                                              END;

                                                   CaptionML=[ENU=Order Date;
                                                              NOR=Bestillingsdato;
                                                              SVE=Orderdatum] }
    { 300 ;   ;Starting Date       ;Date          ;OnValidate=VAR
                                                                ServiceContractTemplate@1100528300 : Record 11071754;
                                                                YearNo@1100528301 : Integer;
                                                                Confirmed@1100529600 : Boolean;
                                                              BEGIN
                                                                IF "Starting Date Control Period" <> "Starting Date" THEN
                                                                  SkipCreateControlPeriod := TRUE;
                                                                IF "Ending Date" = xRec."Ending Date" THEN
                                                                  VALIDATE("Contract Duration");
                                                                IF ("Starting Date" > "Ending Date") AND ("Ending Date" <> 0D) THEN
                                                                  FIELDERROR("Starting Date",STRSUBSTNO(Text004,FIELDCAPTION("Ending Date")));
                                                                IF ("Starting Date Maintenance" = 0D) OR ("Starting Date Maintenance" = xRec."Starting Date") THEN
                                                                  "Starting Date Maintenance" := "Starting Date";
                                                                UpdateServPackage;

                                                                IF "Starting Date Control Period" <> "Starting Date" THEN BEGIN
                                                                  SkipCreateControlPeriod := FALSE;
                                                                  IF "Starting Date Control Period" = 0D THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    IF GUIALLOWED THEN
                                                                      Confirmed := CONFIRM(Text006, FALSE, FIELDCAPTION("Starting Date Control Period"));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF (ServiceContractTemplate.GET("Contract Template Code")) AND
                                                                       (ServiceContractTemplate."Start Date Cntrl Period on 1/1")
                                                                    THEN BEGIN
                                                                      YearNo := DATE2DMY("Starting Date", 3);
                                                                      VALIDATE("Starting Date Control Period", DMY2DATE(1, 1, YearNo));
                                                                    END ELSE
                                                                      VALIDATE("Starting Date Control Period", "Starting Date");
                                                                  END ELSE
                                                                    CreateControlPeriod;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato;
                                                              SVE=Startdatum] }
    { 310 ;   ;Contract Duration   ;DateFormula   ;OnValidate=BEGIN
                                                                TESTFIELD("Starting Date");
                                                                IF FORMAT("Contract Duration") = '' THEN
                                                                  CreateControlPeriod
                                                                ELSE
                                                                  IF "Renewal Date" = 0D THEN
                                                                    VALIDATE("Ending Date", CALCDATE("Contract Duration", "Starting Date") - 1)
                                                                  ELSE
                                                                    VALIDATE("Ending Date", CALCDATE("Contract Duration", "Renewal Date") - 1);
                                                              END;

                                                   CaptionML=[ENU=Contract Duration;
                                                              NOR=Kontraktperiode;
                                                              SVE=Kontraktperiod] }
    { 320 ;   ;Ending Date         ;Date          ;OnValidate=VAR
                                                                ServiceContractArrangement@1100528600 : Record 11071705;
                                                                SalesHeader@1100528601 : Record 36;
                                                              BEGIN
                                                                IF ("Renewal Date" = 0D) AND (CurrFieldNo = FIELDNO("Ending Date")) THEN  //db, 09-07-13: C006596
                                                                  VALIDATE("Starting Date");

                                                                IF "Ending Date" <> 0D THEN BEGIN
                                                                  ServiceContractArrangement.SETRANGE("Service Contract No.", "No.");
                                                                  ServiceContractArrangement.SETFILTER("Theoretical Maintenance Date", '>%1', "Ending Date");
                                                                  IF ServiceContractArrangement.FINDSET THEN BEGIN
                                                                    REPEAT
                                                                      ServiceContractArrangement.CALCFIELDS("Maintenance Proposal No.", "Service Order No.", Finished, "Service Order Status");
                                                                      IF (ServiceContractArrangement."Maintenance Proposal No." <> '') AND
                                                                         (ServiceContractArrangement."Service Order No." = '') THEN
                                                                        ERROR(Text104);
                                                                      IF (ServiceContractArrangement."Service Order No." <> '') AND NOT ServiceContractArrangement.Finished AND
                                                                         (ServiceContractArrangement."Service Order Status" < ServiceContractArrangement."Service Order Status"::Finished)
                                                                      THEN
                                                                        ERROR(Text105);
                                                                      IF (ServiceContractArrangement."Maintenance Proposal No." = '') AND (ServiceContractArrangement."Service Order No." = '') THEN
                                                                        ServiceContractArrangement.DELETE(TRUE);
                                                                    UNTIL ServiceContractArrangement.NEXT = 0;
                                                                  END;

                                                                  SalesHeader.SETRANGE("Document Type", SalesHeader."Document Type"::"Invoice Proposal");
                                                                  SalesHeader.SETRANGE("Service Invoice", TRUE);
                                                                  SalesHeader.SETRANGE("Service Contract No.", "No.");
                                                                  IF NOT SalesHeader.ISEMPTY THEN
                                                                    ERROR(Text106);
                                                                END;
                                                                UpdateEndingDateSCObjects;
                                                                IF "Invoice Type" = "Invoice Type"::Installments THEN
                                                                  UpdateEndingDateInstallments;

                                                                CreateControlPeriod;
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato;
                                                              SVE=Slutdatum] }
    { 330 ;   ;Termination Period  ;DateFormula   ;OnValidate=BEGIN
                                                                IF FORMAT("Termination Period") <> '' THEN BEGIN
                                                                  IF "Termination Date" <> 0D THEN
                                                                    VALIDATE("Expiring Date", CALCDATE("Termination Period", "Termination Date") - 1);
                                                                  IF ("Expiring Date" < "Ending Date") AND ("Termination Date" <> 0D) THEN
                                                                    "Expiring Date" := "Ending Date";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Termination Period;
                                                              NOR=Oppsigelsesperiode;
                                                              SVE=Upps„gningsperiod] }
    { 335 ;   ;Termination Date    ;Date          ;OnValidate=BEGIN
                                                                IF "Expiring Date" = xRec."Expiring Date" THEN
                                                                  VALIDATE("Termination Period");
                                                              END;

                                                   CaptionML=[ENU=Termination Date;
                                                              NOR=Avgangsdato;
                                                              SVE=Avg†ngsdatum] }
    { 340 ;   ;Expiring Date       ;Date          ;CaptionML=[ENU=Expiring Date;
                                                              NOR=Utl›psdato;
                                                              SVE=Utg†ngsdatum] }
    { 350 ;   ;Contract Amount OLD ;Decimal       ;CaptionML=ENU=Contract Amount OLD;
                                                   Description=OBSOLETE;
                                                   AutoFormatType=1 }
    { 370 ;   ;VAT Prod. Posting Group;Code20     ;TableRelation="VAT Product Posting Group";
                                                   OnValidate=BEGIN
                                                                CheckVATReverse(TRUE,FALSE);
                                                              END;

                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Moms produktbokf›ringsmal;
                                                              SVE=Moms produktbokf”ringsmall] }
    { 380 ;   ;Generate Installments;Boolean      ;CaptionML=[ENU=Generate Installments;
                                                              NOR=Generer avdrag;
                                                              SVE=Generera avbetalningar] }
    { 390 ;   ;Installment Scheme  ;Code10        ;TableRelation="Installment Scheme".Code WHERE (Type=CONST(Service Order));
                                                   CaptionML=[ENU=Installment Scheme;
                                                              NOR=Betalingsplan;
                                                              SVE=Betalplan] }
    { 400 ;   ;Installments Generated;Boolean     ;InitValue=No;
                                                   CaptionML=[ENU=Installments Generated;
                                                              NOR=Genererte avdrag;
                                                              SVE=Genererade avbetalningar] }
    { 410 ;   ;Generation Date     ;Date          ;CaptionML=[ENU=Generation Date;
                                                              NOR=Genereringsdato;
                                                              SVE=Genererandedatum];
                                                   Editable=No }
    { 420 ;   ;Modified by         ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserMgt@1210190001 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("Modified by");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Modified by;
                                                              NOR=Endret av;
                                                              SVE=Žndrad av];
                                                   Editable=No }
    { 430 ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Oppdateringsdato;
                                                              SVE=Uppdateringsdatum];
                                                   Editable=No }
    { 440 ;   ;Input by            ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Input by;
                                                              NOR=Input av;
                                                              SVE=Inmatat av];
                                                   Editable=No }
    { 450 ;   ;Input Date          ;Date          ;CaptionML=[ENU=Input Date;
                                                              NOR=Input Dato;
                                                              SVE=Inmatat den];
                                                   Editable=No }
    { 460 ;   ;Text                ;Text250       ;CaptionML=[ENU=Text;
                                                              NOR=Tekst;
                                                              SVE=Ben„mning] }
    { 470 ;   ;Surcharge % Labor   ;Decimal       ;CaptionML=[ENU=Surcharge % Labor;
                                                              NOR=Tilleggsgebyrsprosent, arbeidskraft;
                                                              SVE=Till„ggsavgiftsprocent, arbetskraft] }
    { 480 ;   ;Surcharge % Material;Decimal       ;CaptionML=[ENU=Surcharge % Material;
                                                              NOR=Tilleggsgebyrsprosent, Materiale;
                                                              SVE=Till„ggsavgiftsprocent, material] }
    { 490 ;   ;Surcharge % Subcontr.;Decimal      ;CaptionML=[ENU=Surcharge % Subcontracting;
                                                              NOR=Tilleggsgebyrsprosent, underentrepen›r;
                                                              SVE=Till„ggsavgiftsprocent, underentreprenad] }
    { 500 ;   ;Surcharge % Plant   ;Decimal       ;CaptionML=[ENU=Surcharge % Plant;
                                                              NOR=Tilleggsgebyrsprosent, maskin;
                                                              SVE=Till„ggsavgiftsprocent, maskin] }
    { 600 ;   ;Surcharge % Sundry  ;Decimal       ;CaptionML=[ENU=Surcharge % Sundry;
                                                              NOR=P†slagssatser, diverse;
                                                              SVE=Till„ggsavgiftsprocent, diverse] }
    { 610 ;   ;Renewal Date        ;Date          ;CaptionML=[ENU=Renewal Date;
                                                              NOR=Fornyelsesdato;
                                                              SVE=F”rnyelsedatum] }
    { 620 ;   ;Invoice Period      ;Option        ;OnValidate=BEGIN
                                                                IF "Invoice Period" <> "Invoice Period"::Forehand THEN
                                                                  CLEAR("Invoice Postpone Period");
                                                                IF xRec."Invoice Period" <> "Invoice Period" THEN
                                                                  MessageIfInstallmentsExists;
                                                              END;

                                                   CaptionML=[ENU=Invoice Period;
                                                              NOR=Fakturaperiode;
                                                              SVE=Fakturaperiod];
                                                   OptionCaptionML=[ENU=Forehand,Afterwards;
                                                                    NOR=P† f†rh†nd,Etterp†;
                                                                    SVE=F”rhand,Efter†t];
                                                   OptionString=Forehand,Afterwards }
    { 630 ;   ;Invoice Text Installments;Text250  ;CaptionML=[ENU=Invoice Text Installments;
                                                              NOR=Fakturatekst, avdrag;
                                                              SVE=Fakturatext, avbetalningar] }
    { 640 ;   ;Service Package Contract;Code10    ;TableRelation="Service Package" WHERE (Source Type=CONST(Contract));
                                                   OnValidate=BEGIN
                                                                AddContractDiscount("Service Package Contract");
                                                              END;

                                                   CaptionML=[ENU=Service Package Contract;
                                                              NOR=Servicepakke, Kontrakt;
                                                              SVE=Servicepaket, kontrakt] }
    { 641 ;   ;Service Package Call;Code10        ;TableRelation="Service Package" WHERE (Source Type=CONST(Call));
                                                   OnValidate=BEGIN
                                                                AddContractDiscount("Service Package Call");
                                                              END;

                                                   CaptionML=[ENU=Service Package Call;
                                                              NOR=Servicepakke, Samtale;
                                                              SVE=Servicepaket, samtal] }
    { 642 ;   ;Service Package Other;Code10       ;TableRelation="Service Package" WHERE (Source Type=CONST(Direct));
                                                   OnValidate=BEGIN
                                                                AddContractDiscount("Service Package Other");
                                                              END;

                                                   CaptionML=[ENU=Service Package Other;
                                                              NOR=Servicepakke, Annet;
                                                              SVE=Servicepaket, annat] }
    { 643 ;   ;Service Package Estimate;Code10    ;TableRelation="Service Package" WHERE (Source Type=CONST(Estimate));
                                                   OnValidate=BEGIN
                                                                AddContractDiscount("Service Package Estimate");
                                                              END;

                                                   CaptionML=[ENU=Service Package Estimate;
                                                              NOR=Servicepakke, Kalkyle;
                                                              SVE=Servicepaket, kalkyl] }
    { 649 ;   ;Service Package     ;Code10        ;TableRelation="Service Package" WHERE (Source Type=CONST(None));
                                                   OnValidate=VAR
                                                                ServPackRec@1100525000 : Record 11012806;
                                                              BEGIN
                                                                IF ServPackRec.GET("Service Package") THEN BEGIN
                                                                  VALIDATE("Service Package Call", ServPackRec."Service Package Call");
                                                                  VALIDATE("Service Package Contract", ServPackRec."Service Package Contract");
                                                                  VALIDATE("Service Package Other", ServPackRec."Service Package Direct");
                                                                  VALIDATE("Service Package Estimate", ServPackRec."Service Package Estimate");
                                                                END;
                                                                AddContractDiscount("Service Package");
                                                              END;

                                                   CaptionML=[ENU=Service Package;
                                                              NOR=Servicepakke;
                                                              SVE=Servicepaket] }
    { 650 ;   ;Alt. Bill-to Address (CP);Code10   ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD("Bill-to Customer No. (CP)"),
                                                                                               Billing Address=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                CheckInvoiceAddress;
                                                                CALCFIELDS("Derived from Cust. No. (CP)");
                                                              END;

                                                   CaptionML=ENU=Alternative Bill-to Address (CP) }
    { 655 ;   ;Derived from Cust. No. (CP);Code20 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address"."Derived from Customer No." WHERE (Customer No.=FIELD("Bill-to Customer No. (CP)"),
                                                                                                                           Code=FIELD("Alt. Bill-to Address (CP)")));
                                                   CaptionML=ENU=Derived from Customer No. (Cost Plus);
                                                   Editable=No }
    { 669 ;   ;Cost Component Filter;Code10       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Cost Component Filter;
                                                              NOR=Kostdel, filter;
                                                              SVE=Kostnadsdel, filter] }
    { 670 ;   ;Period Filter       ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Period Filter;
                                                              NOR=Periodefilter;
                                                              SVE=Periodfilter] }
    { 671 ;   ;Cumulative Filter   ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Cumulative Filter;
                                                              SVE=Kumulativt filter] }
    { 672 ;   ;Period Type Filter  ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Period Type Filter;
                                                              NOR=Periodetypefilter;
                                                              SVE=Periodtypfilter];
                                                   OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                                                    NOR=Dag,Uke,M†ned,Kvartal,r,bokf›ringsperiode;
                                                                    SVE=Dag,Vecka,M†nad,Kvartal,r,Bokf”ringsperiod];
                                                   OptionString=Day,Week,Month,Quarter,Year,Accounting Period }
    { 673 ;   ;Source Type Filter  ;Option        ;FieldClass=FlowFilter;
                                                   InitValue=Other;
                                                   CaptionML=[ENU=Source Type Filter;
                                                              NOR=Kildetypefilter;
                                                              SVE=Ursprungstypsfilter];
                                                   OptionCaptionML=[ENU=Call,Contract,Other,Estimate;
                                                                    NOR=Samtale,Kontrakt,Andre,Kalkyle;
                                                                    SVE=Samtal,Kontrakt,™vrigt,Kalkyl];
                                                   OptionString=Call,Contract,Other,Estimate }
    { 674 ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Dato filter;
                                                              SVE=Datumfilter] }
    { 675 ;   ;Prognosis Filter    ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Prognosis Filter;
                                                              NOR=Prognosefilter;
                                                              SVE=Prognosfilter] }
    { 676 ;   ;PrevPrognosisFilter ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=PrevPrognosisFilter;
                                                              NOR=PrevPrognosisFilter;
                                                              SVE=PrevPrognosisFilter] }
    { 678 ;   ;Budget Ovh. Surch. (Contract);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line"."Overhead Surcharge" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                           Index Date=FIELD(Period Filter),
                                                                                                                           Source Type=FIELD(Source Type Filter),
                                                                                                                           Cost Component=FIELD(Cost Component Filter),
                                                                                                                           Budget Type=CONST(Contract)));
                                                   CaptionML=[ENU=Budget Overhead Surcharge (Contract);
                                                              NOR=Budsjettert Overheadkost (Kontrakt);
                                                              SVE=Budgeterad overheadkostnad (kontrakt)];
                                                   Editable=No }
    { 679 ;   ;Budget Ovh. Surch. (ServOrder);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line"."Overhead Surcharge" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                           Index Date=FIELD(Period Filter),
                                                                                                                           Source Type=FIELD(Source Type Filter),
                                                                                                                           Cost Component=FIELD(Cost Component Filter),
                                                                                                                           Budget Type=CONST(Order)));
                                                   CaptionML=[ENU=Budget Overhead Surcharge (Service Order);
                                                              NOR=Budsjettert Overheadkost (Serviceordre);
                                                              SVE=Budgetoverheadskostnad (serviceorder)];
                                                   Editable=No }
    { 680 ;   ;Budget Amount (ServOrder);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Amount WHERE (Service Contract No.=FIELD(No.),
                                                                                                             Index Date=FIELD(Period Filter),
                                                                                                             Source Type=FIELD(Source Type Filter),
                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                             Budget Type=CONST(Order)));
                                                   CaptionML=[ENU=Budget Amount (Service Order);
                                                              NOR=Budsjettert bel›p (Serviceordre);
                                                              SVE=Budgetbelopp (serviceorder)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 681 ;   ;Budget Hours (ServOrder);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Hours WHERE (Service Contract No.=FIELD(No.),
                                                                                                            Index Date=FIELD(Period Filter),
                                                                                                            Source Type=FIELD(Source Type Filter),
                                                                                                            Cost Component=FIELD(Cost Component Filter),
                                                                                                            Budget Type=CONST(Order),
                                                                                                            Cost Type=CONST(Labor)));
                                                   CaptionML=[ENU=Budget Hours (Service Order);
                                                              NOR=Budsjetterte timer (Serviceordre);
                                                              SVE=Budgettimmar (serviceorder)];
                                                   Editable=No }
    { 683 ;   ;Budget Amount (Contract);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Amount WHERE (Service Contract No.=FIELD(No.),
                                                                                                             Index Date=FIELD(Period Filter),
                                                                                                             Source Type=FIELD(Source Type Filter),
                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                             Budget Type=CONST(Contract)));
                                                   CaptionML=[ENU=Budget Amount (Contract);
                                                              NOR=Budsjettert bel›p (Kontrakt);
                                                              SVE=Budgetbelopp (kontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 684 ;   ;Budget Hours (Contract);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Hours WHERE (Service Contract No.=FIELD(No.),
                                                                                                            Index Date=FIELD(Period Filter),
                                                                                                            Source Type=FIELD(Source Type Filter),
                                                                                                            Cost Component=FIELD(Cost Component Filter),
                                                                                                            Budget Type=CONST(Contract),
                                                                                                            Cost Type=CONST(Labor)));
                                                   CaptionML=[ENU=Budget Hours (Contract);
                                                              NOR=Budsjetterte timer (Kontrakt);
                                                              SVE=Budgettimmar (kontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 685 ;   ;Actual Costs (Additional);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                    Posting Date=FIELD(Period Filter),
                                                                                                                    Source Type=FIELD(Source Type Filter),
                                                                                                                    Cost Component=FIELD(Cost Component Filter),
                                                                                                                    Additional Cost=CONST(Yes),
                                                                                                                    Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Costs (Additional);
                                                              NOR=Faktiske Kostnader (Ekstra);
                                                              SVE=Verkliga kostnader (extra)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 686 ;   ;Actual Costs (Contract);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                    Posting Date=FIELD(Period Filter),
                                                                                                                    Source Type=FIELD(Source Type Filter),
                                                                                                                    Cost Component=FIELD(Cost Component Filter),
                                                                                                                    Additional Cost=CONST(No),
                                                                                                                    Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Costs (Contract);
                                                              NOR=Faktiske Kostnader (Kontrakt);
                                                              SVE=Verkliga kostnader (kontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 687 ;   ;Actual Hours (Additional);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry".Quantity WHERE (Service Contract No.=FIELD(No.),
                                                                                                          Posting Date=FIELD(Period Filter),
                                                                                                          Source Type=FIELD(Source Type Filter),
                                                                                                          Cost Component=FIELD(Cost Component Filter),
                                                                                                          Cost Type=CONST(Labor),
                                                                                                          Additional Cost=CONST(Yes),
                                                                                                          Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Hours (Additional);
                                                              NOR=Faktiske timer (Ekstra);
                                                              SVE=Verkliga timmar (extra)];
                                                   Editable=No }
    { 688 ;   ;Actual Hours (Contract);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry".Quantity WHERE (Service Contract No.=FIELD(No.),
                                                                                                          Posting Date=FIELD(Period Filter),
                                                                                                          Source Type=FIELD(Source Type Filter),
                                                                                                          Cost Component=FIELD(Cost Component Filter),
                                                                                                          Cost Type=CONST(Labor),
                                                                                                          Additional Cost=CONST(No),
                                                                                                          Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Hours (Contract);
                                                              NOR=Faktiske timer (Kontrakt);
                                                              SVE=Verkliga timmar (kontrakt)];
                                                   Editable=No }
    { 690 ;   ;Actual Costs        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                    Posting Date=FIELD(Period Filter),
                                                                                                                    Source Type=FIELD(Source Type Filter),
                                                                                                                    Cost Component=FIELD(Cost Component Filter),
                                                                                                                    Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Costs;
                                                              NOR=Faktiske koster;
                                                              SVE=Verkliga kostnader];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 691 ;   ;Actual Hours        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry".Quantity WHERE (Service Contract No.=FIELD(No.),
                                                                                                          Posting Date=FIELD(Period Filter),
                                                                                                          Source Type=FIELD(Source Type Filter),
                                                                                                          Cost Component=FIELD(Cost Component Filter),
                                                                                                          Cost Type=CONST(Labor),
                                                                                                          Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Hours;
                                                              NOR=Reelle timer;
                                                              SVE=Verkliga timmar];
                                                   Editable=No }
    { 692 ;   ;Revenues            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Revenue (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                       Posting Date=FIELD(Period Filter),
                                                                                                                       Source Type=FIELD(Source Type Filter),
                                                                                                                       Cost Component=FIELD(Cost Component Filter),
                                                                                                                       Revenue Present=CONST(Yes)));
                                                   CaptionML=[ENU=Revenues;
                                                              NOR=Inntekter;
                                                              SVE=Int„kter];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 693 ;   ;Revenues (Additional);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Revenue (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                       Posting Date=FIELD(Period Filter),
                                                                                                                       Source Type=FIELD(Source Type Filter),
                                                                                                                       Cost Component=FIELD(Cost Component Filter),
                                                                                                                       Additional Cost=CONST(Yes),
                                                                                                                       Revenue Present=CONST(Yes)));
                                                   CaptionML=[ENU=Revenues (Additional);
                                                              NOR=Inntekter (Ekstra);
                                                              SVE=Int„kter (extra)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 694 ;   ;Revenues (Contract) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Revenue (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                       Posting Date=FIELD(Period Filter),
                                                                                                                       Source Type=FIELD(Source Type Filter),
                                                                                                                       Cost Component=FIELD(Cost Component Filter),
                                                                                                                       Additional Cost=CONST(No),
                                                                                                                       Revenue Present=CONST(Yes)));
                                                   CaptionML=[ENU=Revenues (Contract);
                                                              NOR=Inntekter (Kontrakt);
                                                              SVE=Int„kter (kontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 695 ;   ;Open (Purchase)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Outstanding Amount" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                             Service Source Type=FIELD(Source Type Filter),
                                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                                             Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open (Purchase);
                                                              NOR=pne innkj›p;
                                                              SVE=™ppna ink”p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 696 ;   ;Received/Not Invoiced;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Amt. Rcd. Not Invoiced" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                                 Service Source Type=FIELD(Source Type Filter),
                                                                                                                                 Cost Component=FIELD(Cost Component Filter),
                                                                                                                                 Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Received/Not Invoiced;
                                                              NOR=Mottatt/ikke fakturert;
                                                              SVE=Mottaget/inte fakturerat];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 697 ;   ;Open Ovh. Surch. Firm (Purch.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Overhead Surcharge Firm" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                                  Service Source Type=FIELD(Source Type Filter),
                                                                                                                                  Cost Component=FIELD(Cost Component Filter),
                                                                                                                                  Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Ovh. Surch. Firm Commitments (Purchase);
                                                              NOR=pen overheadkost, faste Forpliktelser (Innkj›p);
                                                              SVE=™ppen overheadkostnad, fasta †taganden (ink”p)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 698 ;   ;Open Ovh. Surch. (Inventory);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Journal Surcharge"."Overhead Surcharge Service" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                                Posting Date=FIELD(Period Filter),
                                                                                                                                Service Source Type=FIELD(Source Type Filter),
                                                                                                                                Cost Component=FIELD(Cost Component Filter)));
                                                   CaptionML=[ENU=Open Ovh. Surch. (Inventory);
                                                              NOR=pen overheadkost (lager);
                                                              SVE=™ppen overheadkostnad (lager)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 699 ;   ;Open (Inventory)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Journal Line".Amount WHERE (Service Contract No.=FIELD(No.),
                                                                                                     Posting Date=FIELD(Period Filter),
                                                                                                     Service Source Type=FIELD(Source Type Filter),
                                                                                                     Cost Component=FIELD(Cost Component Filter)));
                                                   CaptionML=[ENU=Open (Inventory);
                                                              NOR=pne (lager);
                                                              SVE=™ppna (lager)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 700 ;   ;Mobile Phone No.    ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Mobile Phone No.");
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Mobile Phone No.;
                                                              NOR=Mobiltelefonnr;
                                                              SVE=Mobiltelefonnr] }
    { 710 ;   ;Phone No. 2         ;Text30        ;OnValidate=BEGIN
                                                                PhoneNumberFormatting.ValidatePhoneNumber("Country/Region Code", "Phone No. 2");
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No. 2;
                                                              NOR=Telefonnr. 2;
                                                              SVE=Telefonnr 2] }
    { 720 ;   ;Collect Cost Plus Entry;Boolean    ;CaptionML=[ENU=Collect Cost Plus Entry;
                                                              NOR=Samle inn selvkosttransaksjon;
                                                              SVE=Samla in redovisad självkostnad] }
    { 730 ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Service Contract),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar];
                                                   Editable=No }
    { 740 ;   ;Limit Budget Labor  ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Limit Budget Total", "Limit Budget Labor" + "Limit Budget Material");
                                                              END;

                                                   CaptionML=[ENU=Limit Budget Labor;
                                                              NOR=Budsjettgrense, arbeidskraft;
                                                              SVE=Budgetgr„ns, arbetskraft];
                                                   AutoFormatType=1 }
    { 741 ;   ;Limit Budget Hours  ;Decimal       ;CaptionML=[ENU=Limit Budget Hours;
                                                              NOR=Budsjettgrense, timer;
                                                              SVE=Budgetgr„ns, timmar];
                                                   DecimalPlaces=2:5 }
    { 742 ;   ;Limit Budget Material;Decimal      ;OnValidate=BEGIN
                                                                VALIDATE("Limit Budget Total", "Limit Budget Labor" + "Limit Budget Material");
                                                              END;

                                                   CaptionML=[ENU=Limit Budget Material;
                                                              NOR=Budsjettgrense, Materiale;
                                                              SVE=Budgetgr„ns, material];
                                                   AutoFormatType=1 }
    { 745 ;   ;Limit Budget Total  ;Decimal       ;OnValidate=BEGIN
                                                                IF ("Limit Budget Labor" <> 0) OR ("Limit Budget Material" <> 0) THEN
                                                                  TESTFIELD("Limit Budget Total", "Limit Budget Labor" + "Limit Budget Material");
                                                              END;

                                                   CaptionML=[ENU=Limit Budget Total;
                                                              NOR=Budsjettgrense, Totalt;
                                                              SVE=Budgetgr„ns, totalt];
                                                   AutoFormatType=1 }
    { 750 ;   ;Invoice Base Amount Labor;Decimal  ;OnValidate=BEGIN
                                                                VALIDATE("Invoice Base Amount Total", "Invoice Base Amount Labor" + "Invoice Base Amount Material");
                                                              END;

                                                   CaptionML=[ENU=Invoice Base Amount Labor;
                                                              NOR=Faktura, Grunnbel›p for arbeidskraft;
                                                              SVE=Faktura, basbelopp f”r arbetskraft];
                                                   AutoFormatType=1 }
    { 751 ;   ;Invoice Base Hours  ;Decimal       ;CaptionML=[ENU=Invoice Base Hours;
                                                              NOR=Faktura, Grunntimer;
                                                              SVE=Faktura, bastimmar];
                                                   DecimalPlaces=2:5 }
    { 752 ;   ;Invoice Base Amount Material;Decimal;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Invoice Base Amount Total", "Invoice Base Amount Labor" + "Invoice Base Amount Material");
                                                              END;

                                                   CaptionML=[ENU=Invoice Base Amount Material;
                                                              NOR=Faktura, Grunnbel›p for Materiale;
                                                              SVE=Faktura, basbelopp f”r material];
                                                   AutoFormatType=1 }
    { 755 ;   ;Invoice Base Amount Total;Decimal  ;OnValidate=BEGIN
                                                                IF ("Invoice Base Amount Labor" <> 0) OR ("Invoice Base Amount Material" <> 0) THEN
                                                                  TESTFIELD("Invoice Base Amount Total", "Invoice Base Amount Labor" + "Invoice Base Amount Material");
                                                              END;

                                                   CaptionML=[ENU=Invoice Base Amount Total;
                                                              NOR=Faktura, Totalt Grunnbel›p;
                                                              SVE=Faktura, totalt basbelopp];
                                                   AutoFormatType=1 }
    { 760 ;   ;Invoice Base Method ;Option        ;OnValidate=BEGIN
                                                                IF "Invoice Base Method" = "Invoice Base Method"::" " THEN BEGIN
                                                                  "Invoice Base Amount Labor" := 0;
                                                                  "Invoice Base Hours" := 0;
                                                                  "Invoice Base Amount Material" := 0;
                                                                  "Invoice Base Amount Total" := 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Invoice Base Method;
                                                              NOR=Faktura, Grunnmetode;
                                                              SVE=Faktura, basmetod];
                                                   OptionCaptionML=[ENU=" ,Total Service Order - Invoice Base Amount,Total Service Order if exceeding Invoice Base Amount";
                                                                    NOR=" ,Total Serviceordre Í Fakturagrunnbel›p,Total Serviceordre ved overskridelse av Fakturagrunnbel›p";
                                                                    SVE=" ,Total serviceorder Í fakturabasbelopp,Total serviceorder vid ”verskridande av fakturabasbelopp"];
                                                   OptionString=[ ,total-base,total>base] }
    { 769 ;   ;Department Code (Other);Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("Department Code (Other)"));

                                                                ServSetup.GET;
                                                                IF ServSetup."Copy Additional Cost Setup" THEN
                                                                   TESTFIELD("Department Code (Other)", "Global Dimension 1 Code");

                                                                ValidateShortcutDimCode(1,"Department Code (Other)", FALSE);  //db, 14-09-11: M28816
                                                              END;

                                                   CaptionML=[ENU=Department (Additional Cost);
                                                              NOR=Avdeling (Tilleggskoster);
                                                              SVE=Avdelning (till„ggskostnader)] }
    { 770 ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("Global Dimension 1 Code"));

                                                                ServSetup.GET;
                                                                IF ServSetup."Copy Additional Cost Setup" THEN
                                                                   VALIDATE("Department Code (Other)", "Global Dimension 1 Code");

                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code", TRUE);  //db, 14-09-11: M28816
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 kode;
                                                              SVE=Global dimension 1 kod];
                                                   CaptionClass='1,1,1' }
    { 780 ;   ;Open Amount (Hours) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line"."Amount (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                Service Source Type=FIELD(Source Type Filter),
                                                                                                                Cost Component=FIELD(Cost Component Filter),
                                                                                                                Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Amount (Hours);
                                                              NOR=pne bel›p (Timer);
                                                              SVE=™ppna belopp (timmar)];
                                                   Editable=No }
    { 790 ;   ;Open Hours          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line"."Total Line" WHERE (Service Contract No.=FIELD(No.),
                                                                                                              Service Source Type=FIELD(Source Type Filter),
                                                                                                              Cost Component=FIELD(Cost Component Filter),
                                                                                                              Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Hours;
                                                              NOR=pne timer;
                                                              SVE=™ppna timmar];
                                                   Editable=No }
    { 800 ;   ;Open Ovh. Surch. (Hours);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Surcharge"."Overhead Surcharge Service" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                                   Source Type=FIELD(Source Type Filter),
                                                                                                                                   Cost Component=FIELD(Cost Component Filter),
                                                                                                                                   Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Ovh. Surch. (Hours);
                                                              NOR=pen tilleggsgebyr for overhead (Timer);
                                                              SVE=™ppen overheadkostnad (timmar)];
                                                   Editable=No }
    { 805 ;   ;Open Ovh. Surch. Soft (Purch.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Overhead Surcharge Soft" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                                  Service Source Type=FIELD(Source Type Filter),
                                                                                                                                  Cost Component=FIELD(Cost Component Filter),
                                                                                                                                  Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Open Ovh. Surch. Soft Commitments (Purchase);
                                                              NOR=pen overheadkost, l›pende engasjementer (Innkj›p);
                                                              SVE=™ppen overheadkostnad, l”pande †taganden (ink”p)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 810 ;   ;Preferred Employee OBS;Code20      ;TableRelation="Resource (WOP)" WHERE (Type=CONST(Employee));
                                                   CaptionML=ENU=Preferred Employee OBSOLETE;
                                                   Description=OBSOLETE;
                                                   Editable=No }
    { 820 ;   ;% Labor             ;Decimal       ;OnValidate=BEGIN
                                                                CheckVATReverse(TRUE,FALSE);
                                                              END;

                                                   CaptionML=[ENU=% Labor;
                                                              NOR=% arbeidskraft;
                                                              SVE=Procent, arbetskraft];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   AutoFormatType=1 }
    { 830 ;   ;% to B Account      ;Decimal       ;OnValidate=BEGIN
                                                                CheckVATReverse(TRUE,FALSE);
                                                              END;

                                                   CaptionML=[ENU=% to B Account;
                                                              NOR=% til B-konto;
                                                              SVE=Procent till B-konto];
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 835 ;   ;Purchase            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                         Service Contract No.=FIELD(No.),
                                                                                                         Service Source Type=FIELD(Source Type Filter),
                                                                                                         Cost Component=FIELD(Cost Component Filter),
                                                                                                         Order Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Purchase;
                                                              NOR=Innkj›p;
                                                              SVE=Ink”p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 840 ;   ;Order Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order"."Order Amount (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                               Order Date=FIELD(Period Filter),
                                                                                                               Source Type=FIELD(Source Type Filter)));
                                                   CaptionML=[ENU=Service Order Amount;
                                                              NOR=Serviceordrebel›p;
                                                              SVE=Serviceorderbelopp];
                                                   Editable=No }
    { 850 ;   ;Closed Costs        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service-Ledger Entry"."Closed Costs" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                 Service Control Period Date=FIELD(Period Filter),
                                                                                                                 Source Type=FIELD(Source Type Filter),
                                                                                                                 Cost Component=FIELD(Cost Component Filter)));
                                                   CaptionML=[ENU=Closed Costs;
                                                              NOR=Opparbeidede koster;
                                                              SVE=Upparbetade kostnader];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 855 ;   ;Closed Costs incl. Period;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service-Ledger Entry"."Closed Costs" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                 Service Control Period Date=FIELD(Cumulative Filter),
                                                                                                                 Source Type=FIELD(Source Type Filter),
                                                                                                                 Cost Component=FIELD(Cost Component Filter)));
                                                   CaptionML=ENU=Closed Costs up to and including Period;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 860 ;   ;Closed Revenues     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Closed Revenues" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                   Service Control Period Date=FIELD(Period Filter),
                                                                                                                   Source Type=FIELD(Source Type Filter),
                                                                                                                   Cost Component=FIELD(Cost Component Filter)));
                                                   CaptionML=[ENU=Closed Revenues;
                                                              NOR=Opparbeidede inntekter;
                                                              SVE=Upparbetade int„kter];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 865 ;   ;Closed Revenues incl. Period;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Closed Revenues" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                   Service Control Period Date=FIELD(Cumulative Filter),
                                                                                                                   Source Type=FIELD(Source Type Filter),
                                                                                                                   Cost Component=FIELD(Cost Component Filter)));
                                                   CaptionML=ENU=Closed Revenues up to and including Period;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 880 ;   ;Received/Not Inv. Hours;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Order Control Line"."Hours Rcd. Not Invoiced" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                                  Service Source Type=FIELD(Source Type Filter),
                                                                                                                                  Cost Component=FIELD(Cost Component Filter),
                                                                                                                                  Cost Type=CONST(Labor)));
                                                   CaptionML=[ENU=Received/Not Inv. Hours;
                                                              NOR=Mottatte/ikke fakturerte timer;
                                                              SVE=Mottaget/inte fakt. Timmar];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 890 ;   ;Maintenance Planning based on;Option;
                                                   CaptionML=[ENU=Maintenance Planning based on;
                                                              NOR=Vedlikeholdsplanlegging basert p†;
                                                              SVE=Underh†llsplanering baserad p†];
                                                   OptionCaptionML=[ENU=Date,Cluster;
                                                                    NOR=Dato,Klynge;
                                                                    SVE=Datum,Kluster];
                                                   OptionString=Date,Cluster }
    { 930 ;   ;Allowed Costs       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Amount WHERE (Service Contract No.=FIELD(No.),
                                                                                                             Finished=CONST(Yes),
                                                                                                             Source Type=FIELD(Source Type Filter),
                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                             Index Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Allowed Costs;
                                                              NOR=Tillatte koster;
                                                              SVE=Till†tna kostnader];
                                                   Editable=No }
    { 931 ;   ;Allowed Costs (Ovh. Surch.);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line"."Overhead Surcharge" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                           Finished=CONST(Yes),
                                                                                                                           Source Type=FIELD(Source Type Filter),
                                                                                                                           Cost Component=FIELD(Cost Component Filter),
                                                                                                                           Index Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Allowed Costs (Overhead Surcharge);
                                                              NOR=Tillatte koster (Overheadkost);
                                                              SVE=Till†tna kostnader (overheadkostnad)];
                                                   Editable=No }
    { 932 ;   ;Allowed Hours       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Hours WHERE (Service Contract No.=FIELD(No.),
                                                                                                            Finished=CONST(Yes),
                                                                                                            Source Type=FIELD(Source Type Filter),
                                                                                                            Cost Component=FIELD(Cost Component Filter),
                                                                                                            Index Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Allowed Hours;
                                                              NOR=Tillatte timer;
                                                              SVE=Till†tna timmar];
                                                   Editable=No }
    { 940 ;   ;Collect Installment Invoice By;Option;
                                                   CaptionML=[ENU=Collect Installment Invoice By;
                                                              SVE=Samla in avbetalningsfaktura efter];
                                                   OptionCaptionML=[ENU=Contract,Customer;
                                                                    NOR=Kontrakt,Kunde;
                                                                    SVE=Kontrakt,Kund];
                                                   OptionString=Contract,Customer }
    { 950 ;   ;Cost Control Up to Date;Boolean    ;CaptionML=[ENU=Cost Control Up to Date;
                                                              NOR=Kostkontroll Oppdatert;
                                                              SVE=Kostnadskontroll uppdaterad] }
    { 960 ;   ;Fixed               ;Boolean       ;CaptionML=[ENU=Fixed;
                                                              NOR=Fast;
                                                              SVE=Fast] }
    { 970 ;   ;Preclosure Result   ;Option        ;InitValue=No;
                                                   CaptionML=[ENU=Preclosure Result;
                                                              NOR=Prelimin‘rt Regnskapsresultat;
                                                              SVE=Projektv„rdering];
                                                   OptionCaptionML=[ENU=No,Yes;
                                                                    NOR=Nei,Ja;
                                                                    SVE=Nej,Ja];
                                                   OptionString=No,Yes }
    { 980 ;   ;Actual Preclosure Result;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Actual Preclosure Result" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                            Source Type=FIELD(Source Type Filter),
                                                                                                                            Cost Component=FIELD(Cost Component Filter),
                                                                                                                            Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Actual Preclosure Result;
                                                              NOR=Reelle pr›veregnskapsresultater;
                                                              SVE=Periodiserat resultat];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 981 ;   ;Actual Preclosure Cost;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Actual Preclosure Cost" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                          Source Type=FIELD(Source Type Filter),
                                                                                                                          Cost Component=FIELD(Cost Component Filter),
                                                                                                                          Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Actual Preclosure Cost;
                                                              NOR=Faktisk Kostnad, Prelimin‘rt Regnskap;
                                                              SVE=Periodiserad kostnad];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 982 ;   ;Actual Preclosure Revenue;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Actual Preclosure Revenue" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                             Source Type=FIELD(Source Type Filter),
                                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                                             Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Actual Preclosure Revenue;
                                                              NOR=Faktiske Inntekter, Prelimin‘rt Regnskap;
                                                              SVE=Periodiserad int„kt];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 990 ;   ;Act. Preclosure Result Period;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Actual Preclosure Result" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                            Source Type=FIELD(Source Type Filter),
                                                                                                                            Cost Component=FIELD(Cost Component Filter),
                                                                                                                            Posting Date=FIELD(Period Filter)));
                                                   CaptionML=[ENU=Actual Preclosure Result Period;
                                                              NOR=Faktisk perioderesultat, Prelimin‘rt Regnskap;
                                                              SVE=Verklig period f”r provredovisningsresultat];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1000;   ;Contract Prognosis Level 1;Option  ;CaptionML=[ENU=Contract Prognosis (Level 1);
                                                              NOR=Kontraktsprognose (Niv† 1);
                                                              SVE=Kontraktsprognos (niv† 1)];
                                                   OptionCaptionML=[ENU=Source Type,Cost Component;
                                                                    NOR=Kildetype,Kostdel;
                                                                    SVE=Ursprungstyp,Kostnadsdel];
                                                   OptionString=SourceType,CostComponent;
                                                   Description=OBSOLETE? }
    { 1001;   ;Contract Prognosis Level 2;Option  ;CaptionML=[ENU=Contract Prognosis (Level 2);
                                                              NOR=Kontraktsprognose (Niv† 2);
                                                              SVE=Kontraktsprognos (niv† 2)];
                                                   OptionCaptionML=[ENU=Cost Object,Cost Type;
                                                                    NOR=Kostnadsobjekt,Kostnadstype;
                                                                    SVE=Kostnadsobjekt,Kostnadstyp];
                                                   OptionString=CostObject,CostType;
                                                   Description=OBSOLETE? }
    { 1010;   ;Contract Prognosis based on;Option ;CaptionML=[ENU=Contract Prognosis (Labor) based on;
                                                              NOR=Kontraktsprognose (Arbeidskraft) basert p†;
                                                              SVE=Kontraktsprognos (arbetskraft) baserad p†];
                                                   OptionCaptionML=[ENU=Available,Extrapolation,Allowed;
                                                                    NOR=Tilgjengelig,Ekstrapolering,Tillatt;
                                                                    SVE=Tillg„ngligt,Extrapolering,Till†tet];
                                                   OptionString=Available,Extrapolation,Allowed;
                                                   Description=OBSOLETE? }
    { 1020;   ;Budget Amount (ST Contract);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Amount WHERE (Service Contract No.=FIELD(No.),
                                                                                                             Index Date=FIELD(Period Filter),
                                                                                                             Source Type=CONST(Contract),
                                                                                                             Cost Component=FIELD(Cost Component Filter),
                                                                                                             Budget Type=CONST(Order)));
                                                   CaptionML=[ENU=Budget Amount (Source Type Contract);
                                                              NOR=Budsjettbel›p (Kildetype for Kontrakt);
                                                              SVE=Budgetbelopp (ursprungstypskontrakt)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1021;   ;Budget Ovh. Surch. (ST Contr);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line"."Overhead Surcharge" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                           Index Date=FIELD(Period Filter),
                                                                                                                           Source Type=CONST(Contract),
                                                                                                                           Cost Component=FIELD(Cost Component Filter),
                                                                                                                           Budget Type=CONST(Order)));
                                                   CaptionML=[ENU=Budget Overhead Surcharge (Source Type Contract);
                                                              NOR=Budsjett for overheadkost (kildetype for kontrakt);
                                                              SVE=Budgeterad overheadkostnad (ursprungstypskontrakt)];
                                                   Editable=No }
    { 1025;   ;Budget Hours (ST Contract);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Budget Line".Hours WHERE (Service Contract No.=FIELD(No.),
                                                                                                            Index Date=FIELD(Period Filter),
                                                                                                            Source Type=CONST(Contract),
                                                                                                            Cost Component=FIELD(Cost Component Filter),
                                                                                                            Budget Type=CONST(Order),
                                                                                                            Cost Type=CONST(Labor)));
                                                   CaptionML=[ENU=Budget Hours (Source Type Contract);
                                                              NOR=Budsjettimer (Kildetype for Kontrakt);
                                                              SVE=Budgettimmar (ursprungstypskontrakt)];
                                                   Editable=No }
    { 1040;   ;Reference Date (Item);Date         ;CaptionML=[ENU=Reference Date Item Prices;
                                                              NOR=Referansedato for artikkelpriser;
                                                              SVE=Referensdatum f”r artikelpriser] }
    { 1041;   ;Reference Date (Company);Date      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Inventory Setup"."Reference Date (Item)");
                                                   CaptionML=[ENU=Reference Date Item Prices (Company);
                                                              NOR=Referansedato for artikkelpriser (Selskap);
                                                              SVE=Referensdatum f”r artikelpriser (f”retag)];
                                                   Editable=No }
    { 1042;   ;Reference Date (Customer);Date     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Reference Date (Item)" WHERE (No.=FIELD("Bill-to Customer No. (CP)")));
                                                   CaptionML=[ENU=Reference Date Item Prices (Customer);
                                                              NOR=Referansedato for artikkelpriser (Kunde);
                                                              SVE=Referensdatum f”r artikelpriser (kund)];
                                                   Editable=No }
    { 1050;   ;Purch Discount Term Group 1;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Customer),
                                                                                                   Type=FILTER(Common|Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch Discount Term Group 1" = '' THEN BEGIN
                                                                  "Priority Purch Disc Term Grp 1" := '';
                                                                END ELSE BEGIN
                                                                  "Priority Purch Disc Term Grp 0" := '0';
                                                                  "Priority Purch Disc Term Grp 1" := '1';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Purchase Discount Term Group (Customer);
                                                              NOR=Innkj›p, Rabattvilk†rsgruppe (Kunde);
                                                              SVE=Ink”p, rabattvillkorsgrupp (kund)] }
    { 1051;   ;Purch Discount Term Group 2;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Job),
                                                                                                   Type=FILTER(Common|Purchase));
                                                   OnValidate=BEGIN
                                                                IF "Purch Discount Term Group 2" = '' THEN BEGIN
                                                                  "Priority Purch Disc Term Grp 2" := '';
                                                                END ELSE BEGIN
                                                                  "Priority Purch Disc Term Grp 0" := '0';
                                                                  "Priority Purch Disc Term Grp 2" := '2';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Purchase Discount Term Group (Job);
                                                              NOR=Innkj›p, Rabattvilk†rsgruppe (Jobb);
                                                              SVE=Ink”p, rabattvillkorsgrupp (jobb)] }
    { 1052;   ;Priority Purch Disc Term Grp 0;Code1;
                                                   CaptionML=[ENU=Priority Purchase Discount Term Group (Company);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Innkj›p (Selskap);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r ink”p (f”retag)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 1053;   ;Priority Purch Disc Term Grp 1;Code1;
                                                   CaptionML=[ENU=Priority Purchase Discount Term Group (Customer);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Innkj›p (Kunde);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r ink”p (kund)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 1054;   ;Priority Purch Disc Term Grp 2;Code1;
                                                   CaptionML=[ENU=Priority Purchase Discount Term Group (Job);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Innkj›p (Jobb);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r ink”p (jobb)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 1055;   ;Sales Discount Term Group 1;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Customer),
                                                                                                   Type=FILTER(Common|Sales));
                                                   OnValidate=BEGIN
                                                                IF "Sales Discount Term Group 1" = '' THEN BEGIN
                                                                  "Priority Sales Disc Term Grp 1" := '';
                                                                END ELSE BEGIN
                                                                  "Priority Sales Disc Term Grp 0" := '0';
                                                                  "Priority Sales Disc Term Grp 1" := '1';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Sales Discount Term Group (Customer);
                                                              NOR=Salg, rabattvilk†rsgruppe (Kunde);
                                                              SVE=F”rs„ljning, rabattvillkorsgrupp (kund)] }
    { 1056;   ;Sales Discount Term Group 2;Code20 ;TableRelation="Discount Term Group".Code WHERE (Level=CONST(Job),
                                                                                                   Type=FILTER(Common|Sales));
                                                   OnValidate=BEGIN
                                                                IF "Sales Discount Term Group 2" = '' THEN BEGIN
                                                                  "Priority Sales Disc Term Grp 2" := '';
                                                                END ELSE BEGIN
                                                                  "Priority Sales Disc Term Grp 0" := '0';
                                                                  "Priority Sales Disc Term Grp 2" := '2';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Sales Discount Term Group (Job);
                                                              NOR=Salg, Rabattvilk†rsgruppe (Jobb);
                                                              SVE=F”rs„ljning, rabattvillkorsgrupp (jobb)] }
    { 1057;   ;Priority Sales Disc Term Grp 0;Code1;
                                                   CaptionML=[ENU=Priority Sales Discount Term Group (Company);
                                                              NOR=Prioritert rabattvilk†rsgruppe for salg (selskap);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r f”rs„ljning (f”retag)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 1058;   ;Priority Sales Disc Term Grp 1;Code1;
                                                   CaptionML=[ENU=Priority Sales Discount Term Group (Customer);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Salg (Kunde);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r f”rs„ljning (kund)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 1059;   ;Priority Sales Disc Term Grp 2;Code1;
                                                   CaptionML=[ENU=Priority Sales Discount Term Group (Job);
                                                              NOR=Prioritert Rabattvilk†rsgruppe for Salg (Jobb);
                                                              SVE=Prioriterad rabattvillkorsgrupp f”r f”rs„ljning (jobb)];
                                                   SQL Data Type=Variant;
                                                   Numeric=Yes }
    { 1080;   ;Adviser             ;Code20        ;TableRelation=Contact;
                                                   OnValidate=BEGIN
                                                                IF CurrFieldNo > 0 THEN
                                                                  CALCFIELDS("Name Adviser");
                                                              END;

                                                   CaptionML=[ENU=Adviser;
                                                              NOR=R†dgiver;
                                                              SVE=Projekt”r] }
    { 1085;   ;Name Adviser        ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Adviser)));
                                                   CaptionML=[ENU=Name Adviser;
                                                              NOR=R†dgivers navn;
                                                              SVE=Projekt”rens namn];
                                                   Editable=No }
    { 1090;   ;Send Mail Status Update;Boolean    ;CaptionML=[ENU=Send Mail at Status update;
                                                              NOR=Send e-post ved statusoppdatering;
                                                              SVE=Skicka e-post vid statusuppdatering] }
    { 1095;   ;Send Mail/Save Work Sheet;Boolean  ;CaptionML=[ENU=Send Mail/Save Work Sheet;
                                                              NOR=Send e-post regneark;
                                                              SVE=Skicka e-postkalkylblad] }
    { 1100;   ;Transaction Mode Installments;Code20;
                                                   CaptionML=[ENU=Transaction Mode Installments;
                                                              NOR=Transaksjonsmodus Avdrag;
                                                              SVE=Transaktionsl„ge avbetalningar] }
    { 1110;   ;Starting Date Maintenance;Date     ;CaptionML=[ENU=Starting Date Maintenance;
                                                              NOR=Startdato, Vedlikehold;
                                                              SVE=Startdatum, underh†ll] }
    { 1115;   ;Starting Date Invoice;Date         ;OnValidate=BEGIN
                                                                IF "Starting Date Invoice" <> 0D THEN
                                                                  CheckStartDateInvoice;  //db, 05-12-11
                                                              END;

                                                   CaptionML=[ENU=Starting Date Invoice;
                                                              NOR=Startdato, Faktura;
                                                              SVE=Startdatum, faktura] }
    { 1120;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              NOR=Spr†kkode;
                                                              SVE=Spr†kkod] }
    { 1125;   ;Liquidity Prognosis ;Option        ;OnValidate=BEGIN
                                                                IF (("Starting Date" = 0D) OR ("Ending Date" = 0D)) AND
                                                                ("Liquidity Prognosis" <> "Liquidity Prognosis"::"Not") THEN
                                                                  ERROR(Text011);
                                                              END;

                                                   CaptionML=[ENU=Liquidity Prognosis;
                                                              NOR=Likviditetsprognose;
                                                              SVE=Likviditetsprognos];
                                                   OptionCaptionML=[ENU=Not,Equable Division,Specific Division,Installments;
                                                                    SVE=Inte,J„mn uppdelning,Specifik uppdelning,Avbetalningar];
                                                   OptionString=Not,Equable Division,Specific Division,Installments }
    { 1130;   ;Progress Preclosure Result;Option  ;CaptionML=[ENU=Progress Preclosure Result;
                                                              NOR=Fremdrift, Prelimin‘re Regnskapsresultater;
                                                              SVE=F”rlopp, provredovisningsresultat];
                                                   OptionCaptionML=[ENU=Contract Prognosis,Financial Period;
                                                                    NOR=Kontraktsprognose,Finansperiode;
                                                                    SVE=Kontraktsprognos,Finansperiod];
                                                   OptionString=Prognosis,FinPeriod }
    { 1135;   ;Contact Person      ;Code20        ;TableRelation=Contact.No. WHERE (Type=CONST(Person),
                                                                                    Company No.=FIELD(Contact No.),
                                                                                    Blocked=CONST(No));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Contact Person Name");
                                                                "Contact Name" := "Contact Person Name";
                                                              END;

                                                   CaptionML=[ENU=Contact Person;
                                                              NOR=Kontaktperson;
                                                              SVE=Kontaktperson] }
    { 1140;   ;Contact Person Name ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Person)));
                                                   CaptionML=[ENU=Contact Person Name;
                                                              NOR=Kontaktpersonens navn;
                                                              SVE=Kontaktpersonens namn];
                                                   Editable=No }
    { 1150;   ;Bill-to Contact Person (CP);Code20 ;TableRelation=Contact.No. WHERE (Company No.=FIELD("Bill-to Contact No. (CP)"),
                                                                                    Type=CONST(Person));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Bill-to Cont. Person Name (CP)");
                                                              END;

                                                   CaptionML=[ENU=Bill-to Contact Person (Cost Plus);
                                                              SVE=Faktura till kontaktperson (l”pande)] }
    { 1160;   ;Bill-to Cont. Person Name (CP);Text100;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD("Bill-to Contact Person (CP)")));
                                                   CaptionML=[ENU=Bill-to Contact Person Name (Cost Plus);
                                                              SVE=Faktura till kontaktperson, namn (l”pande)];
                                                   Editable=No }
    { 1170;   ;Contact No.         ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Contact Business Relation"."Contact No." WHERE (Link to Table=CONST(Customer),
                                                                                                                       No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Contact No.;
                                                              NOR=Kontaktnr;
                                                              SVE=Kontaktnr];
                                                   Editable=No }
    { 1180;   ;Bill-to Contact No. (CP);Code20    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Contact Business Relation"."Contact No." WHERE (Link to Table=CONST(Customer),
                                                                                                                       No.=FIELD("Bill-to Customer No. (CP)")));
                                                   CaptionML=[ENU=Bill-to Contact No. (Cost Plus);
                                                              SVE=Faktureringskontaktnr (l”pande)];
                                                   Editable=No }
    { 1190;   ;Internal Contract   ;Boolean       ;CaptionML=[ENU=Internal Contract;
                                                              NOR=Intern kontrakt;
                                                              SVE=Internt kontrakt] }
    { 1200;   ;Direct Debit Mandate ID;Code35     ;TableRelation="SEPA Direct Debit Mandate" WHERE (Customer No.=FIELD("Bill-to Customer No. (Contr.)"),
                                                                                                    Closed=CONST(No),
                                                                                                    Blocked=CONST(No),
                                                                                                    Mandate for Filter=CONST(ServiceContract),
                                                                                                    No. Mandate for Filter=FIELD(No.));
                                                   OnValidate=BEGIN
                                                                IF "Direct Debit Mandate ID" <> '' THEN
                                                                  TESTFIELD("Bill-to Customer No. (Contr.)");
                                                              END;

                                                   CaptionML=[ENU=Direct Debit Mandate ID;
                                                              NOR=ID for Direct Debit-belastningsfullmakt;
                                                              SVE=Medgivande-ID f”r autogiro] }
    { 1215;   ;Starting Date Control Period;Date  ;OnValidate=BEGIN
                                                                CreateControlPeriod;
                                                              END;

                                                   CaptionML=[ENU=Starting Date Control Period;
                                                              NOR=Startdato, Kontrollperiode;
                                                              SVE=Startdatum, kontrollperiod] }
    { 1220;   ;Budget Amount Objects;Decimal      ;CaptionML=[ENU=Budget Amount Objects;
                                                              NOR=Budsjettbel›p for Objekter;
                                                              SVE=Budgetbelopp f”r objekt];
                                                   Editable=No }
    { 1225;   ;Budget Hours Objects;Decimal       ;CaptionML=[ENU=Budget Hours Objects;
                                                              NOR=Budsjettimer, Objekter;
                                                              SVE=Budgettimmar, objekt];
                                                   Editable=No }
    { 1230;   ;Contract Amount Objects;Decimal    ;CaptionML=[ENU=Contract Amount Objects;
                                                              NOR=Kontraktsbel›psobjekter;
                                                              SVE=Kontraktsbeloppsobjekt];
                                                   Editable=No }
    { 1235;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                // dp00116.n
                                                                IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                  RecreateContractAmountsByDate;
                                                                  UpdateServiceSalesDiscount;
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod] }
    { 1240;   ;Invoice Type        ;Option        ;OnValidate=VAR
                                                                ContractInstallment@1100528600 : Record 11071707;
                                                              BEGIN
                                                                IF xRec."Invoice Type" <> "Invoice Type" THEN BEGIN
                                                                  CASE "Invoice Type" OF
                                                                    "Invoice Type"::Dynamic: BEGIN
                                                                      ContractInstallment.SETRANGE("Service Contract No.", "No.");
                                                                      IF NOT ContractInstallment.ISEMPTY THEN
                                                                        ERROR(Text100);
                                                                      IF "Contract Form" = "Contract Form"::"Location Contract" THEN
                                                                        FIELDERROR("Contract Form");
                                                                      CLEAR("Installments based on Progress");
                                                                      "Dynamic Invoice Type" := "Dynamic Invoice Type"::Days;
                                                                      CLEAR("Installment Type");
                                                                    END;
                                                                    "Invoice Type"::Installments: BEGIN
                                                                      CLEAR("Invoice Interval");
                                                                      CLEAR("Invoice Postpone Period");
                                                                      CLEAR("Dynamic Invoice Type");
                                                                      CLEAR("Inv. Periods Per Contr. Object");
                                                                      VALIDATE("Installment Type", "Installment Type"::Contract);
                                                                    END;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Invoice Type;
                                                              NOR=Fakturatype;
                                                              SVE=Fakturatyp];
                                                   OptionCaptionML=[ENU=Dynamic,Installments;
                                                                    NOR=Dynamisk,Avdrag;
                                                                    SVE=Dynamisk,Betalplaner];
                                                   OptionString=Dynamic,Installments }
    { 1241;   ;Installments based on Progress;Boolean;
                                                   CaptionML=[ENU=Installments based on Progress;
                                                              NOR=Avdrag basert p† Fremdrift;
                                                              SVE=Avbet. baserade p† f”rlopp] }
    { 1250;   ;Contract Limit      ;Option        ;OnValidate=BEGIN
                                                                IF (xRec."Contract Limit" <> "Contract Limit") AND ("Contract Limit" = "Contract Limit"::Unlimited) THEN BEGIN
                                                                  CLEAR("Contract Duration");
                                                                  "Ending Date" := 0D;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Contract Limit;
                                                              NOR=Kontraktgrense;
                                                              SVE=Kontraktgr„ns];
                                                   OptionCaptionML=[ENU=Limited,Unlimited;
                                                                    NOR=Begrenset,Ubegrenset;
                                                                    SVE=Begr„nsad,obegr„nsad];
                                                   OptionString=Limited,Unlimited }
    { 1260;   ;Service Contract Folder;Text250    ;CaptionML=[ENU=Service Contract Folder;
                                                              NOR=Servicekontraktmappe;
                                                              SVE=Servicekontraktmapp] }
    { 1270;   ;Available as Reference;Option      ;CaptionML=[ENU=Available as Reference;
                                                              NOR=Tilgjengelig som referanse;
                                                              SVE=Tillg„nglig som referens];
                                                   OptionCaptionML=[ENU=Always,On Request,Never;
                                                                    NOR=Alltid,Ved foresp›rsel,Aldri;
                                                                    SVE=Alltid,P† beg„ran,Aldrig];
                                                   OptionString=Always,On Request,Never }
    { 1280;   ;Invoice Interval    ;DateFormula   ;OnValidate=BEGIN
                                                                IF FORMAT("Invoice Interval") = '' THEN
                                                                  TESTFIELD("Invoicing via Collective List", FALSE)
                                                                ELSE BEGIN
                                                                  VALIDATE("Invoice Postpone Period");
                                                                  TESTFIELD("Dynamic Invoice Type", "Dynamic Invoice Type"::"Invoice Interval");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Invoice Interval;
                                                              NOR=Faktureringsintervall;
                                                              SVE=Faktureringsintervall] }
    { 1281;   ;Inv. Periods Per Contr. Object;Boolean;
                                                   CaptionML=ENU=Invoice Periods Per Contract Object }
    { 1290;   ;Invoiced Until      ;Date          ;CaptionML=[ENU=Invoiced Until;
                                                              NOR=Fakturert til;
                                                              SVE=Fakturerad till] }
    { 1300;   ;Last Invoiced Until ;Date          ;CaptionML=[ENU=Invoiced Until;
                                                              NOR=Fakturert til;
                                                              SVE=Fakturerad till];
                                                   Editable=No }
    { 1310;   ;Control Period Interval;DateFormula;OnValidate=BEGIN
                                                                CreateControlPeriod;
                                                              END;

                                                   CaptionML=[ENU=Control Period Interval;
                                                              NOR=Kontrollperiodeintervall;
                                                              SVE=Kontrollperiodsintervall] }
    { 1340;   ;Control Reference Date;Date        ;OnValidate=BEGIN
                                                                IF "Control Reference Date" <> 0D THEN BEGIN
                                                                  TESTFIELD("Number of Control Ref. Periods", 0);
                                                                  ServSetup.GET;
                                                                  ServSetup.TESTFIELD("Service Control Method", ServSetup."Service Control Method"::"Real-Time");
                                                                END;
                                                                CreateControlPeriod;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Control Reference Date }
    { 1350;   ;Number of Control Ref. Periods;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Number of Control Ref. Periods" > 0 THEN BEGIN
                                                                  TESTFIELD("Control Reference Date", 0D);
                                                                  ServSetup.GET;
                                                                  ServSetup.TESTFIELD("Service Control Method", ServSetup."Service Control Method"::"Real-Time");
                                                                END;
                                                                CreateControlPeriod;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Number of Control Reference Periods;
                                                   MinValue=0;
                                                   BlankZero=Yes }
    { 1400;   ;Use Bill-to as Sell-to (CP);Boolean;CaptionML=ENU=Use Bill-to Customer as Sell-to Customer on Sales Invoice (Cost Plus) }
    { 1410;   ;Contract Group Description;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Contract Group".Description WHERE (Code=FIELD(Contract Group)));
                                                   CaptionML=[ENU=Contract Group Description;
                                                              NOR=Beskrivelse av Kontraktgruppe;
                                                              SVE=Kontraktgruppsbeskrivning];
                                                   Editable=No }
    { 1420;   ;Contract Template Code;Code20      ;OnValidate=VAR
                                                                ServiceContractTemplate@1100528600 : Record 11071754;
                                                              BEGIN
                                                                IF "Contract Template Code" <> '' THEN BEGIN
                                                                  ServiceContractTemplate.GET("Contract Template Code");
                                                                  IF "Customer No." = '' THEN BEGIN
                                                                    IF ServiceContractTemplate."Price Book Type" = ServiceContractTemplate."Price Book Type"::Customer THEN
                                                                      IF ServiceContractTemplate."Price Book Code" <> '' THEN
                                                                        VALIDATE("Customer No.", ServiceContractTemplate."Price Book Code");
                                                                  END;
                                                                  TRANSFERFIELDS(ServiceContractTemplate);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Contract Template Code;
                                                              NOR=Kontraktmal, Kode;
                                                              SVE=Kontraktsmallskod] }
    { 1430;   ;Publish on Service Portal;Boolean  ;CaptionML=[ENU=Publish on Portal;
                                                              NOR=Publiser p† Serviceportal;
                                                              SVE=Publicera p† serviceportalen] }
    { 1440;   ;Invoicing via Collective List;Boolean;
                                                   OnValidate=BEGIN
                                                                IF "Invoicing via Collective List" THEN BEGIN
                                                                  IF "Invoice Type" = "Invoice Type"::Dynamic THEN
                                                                    TESTFIELD("Invoice Interval");
                                                                  CLEAR("Invoice Postpone Period");
                                                                  IF "Bill-to Customer No. (CP)" <> "Bill-to Customer No. (Contr.)" THEN
                                                                    ERROR(Text127, FIELDCAPTION("Bill-to Customer No. (CP)"), FIELDCAPTION("Bill-to Customer No. (Contr.)"));
                                                                END;
                                                                IF xRec."Invoicing via Collective List" <> "Invoicing via Collective List" THEN
                                                                  MessageIfInstallmentsExists;
                                                              END;

                                                   CaptionML=[ENU=Invoicing via Collective List;
                                                              NOR=Fakturering via samlingsfaktura;
                                                              SVE=Fakturering via samlingsfaktura] }
    { 1450;   ;Service Index Method;Code10        ;TableRelation="Service Index Method";
                                                   CaptionML=[ENU=Index Method;
                                                              NOR=Indeksmetode;
                                                              SVE=Index metod] }
    { 1460;   ;Plan Method         ;Option        ;CaptionML=[ENU=Plan Method;
                                                              NOR=Planlegg Metode;
                                                              SVE=Planmetod];
                                                   OptionCaptionML=[ENU=Theoretical Maintenance Date,Last Execution Date;
                                                                    NOR=Teoretisk Vedlikeholdsdato, Siste Gjennomf›ringsdato];
                                                   OptionString=Theoretical Maintenance Date,Last Execution Date }
    { 1470;   ;Contract Type       ;Code10        ;TableRelation="Contract Type";
                                                   CaptionML=[ENU=Contract Type;
                                                              NOR=Kontraktstype;
                                                              SVE=Kontraktstyp] }
    { 1480;   ;Invoice Postpone Period;DateFormula;OnValidate=BEGIN
                                                                IF FORMAT("Invoice Postpone Period") <> '' THEN BEGIN
                                                                  TESTFIELD("Invoicing via Collective List", FALSE);
                                                                  IF "Invoice Type" = "Invoice Type"::Dynamic THEN
                                                                    TESTFIELD("Invoice Interval");
                                                                  IF TODAY > CALCDATE("Invoice Postpone Period", TODAY) THEN
                                                                    FIELDERROR("Invoice Postpone Period", Text112);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Invoice Postpone Period;
                                                              NOR=Fakturer Utsatt periode] }
    { 1490;   ;Contract Form       ;Option        ;OnValidate=VAR
                                                                ContractObjectMaintenance@1100528600 : Record 11071692;
                                                                ContractInstallment@1100528601 : Record 11071707;
                                                                ContractObject@1100527400 : Record 11071702;
                                                                ServiceContractAnalysis@1100527401 : Record 11072329;
                                                              BEGIN
                                                                CASE "Contract Form" OF
                                                                  "Contract Form"::"Framework Contract":
                                                                    BEGIN
                                                                      ContractObjectMaintenance.SETRANGE("Service Contract No.", "No.");
                                                                      IF NOT ContractObjectMaintenance.ISEMPTY THEN
                                                                        ERROR(Text113, ContractObjectMaintenance.TABLECAPTION, FIELDCAPTION("Contract Form"));
                                                                      ContractInstallment.SETRANGE("Service Contract No.", "No.");
                                                                      IF NOT ContractInstallment.ISEMPTY THEN
                                                                        ERROR(Text113, ContractInstallment.TABLECAPTION, FIELDCAPTION("Contract Form"));
                                                                    END;
                                                                  "Contract Form"::"Location Contract":
                                                                    BEGIN
                                                                      ContractObject.SETRANGE("Service Contract No.", "No.");
                                                                      IF NOT ContractObject.ISEMPTY THEN
                                                                        ERROR(Text113, ContractObject.TABLECAPTION, FIELDCAPTION("Contract Form"));
                                                                      ServiceContractAnalysis.SETRANGE("Service Contract No.", "No.");
                                                                      IF NOT ServiceContractAnalysis.ISEMPTY THEN
                                                                        ERROR(Text113, ServiceContractAnalysis.TABLECAPTION, FIELDCAPTION("Contract Form"));
                                                                      IF "Invoice Type" <> "Invoice Type"::Installments THEN
                                                                        FIELDERROR("Invoice Type");
                                                                    END;
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Contract Form;
                                                              NOR=Kontraktsskjema];
                                                   OptionCaptionML=[ENU=" ,Framework Contract,Rental Contract,Location Contract";
                                                                    NOR=" ,Rammeverkskontrakt,Utleiekontrakt"];
                                                   OptionString=[ ,Framework Contract,Rental Contract,Location Contract] }
    { 1500;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Payment Terms Code;
                                                              NOR=Betalingsbet.kode;
                                                              SVE=Betalningsvillkorskod] }
    { 1510;   ;Invoice Period (Coll. List);DateFormula;
                                                   CaptionML=[ENU=Invoice Period (Collective List);
                                                              NOR=Fakturaperiode (samlingsfaktura);
                                                              SVE=Fakturaperiod (Samlingsfaktura)] }
    { 1520;   ;Min. Inv. Amount (Coll. List);Decimal;
                                                   CaptionML=[ENU=Minimal Invoice Amount (Collective List);
                                                              NOR=Minimalt Fakturabel›p (samlingsfaktura);
                                                              SVE=Minsta fakturabelopp (Samlingsfaktura)] }
    { 1530;   ;Use Contract Clusters;Boolean      ;OnValidate=VAR
                                                                ServiceCluster@1100528600 : Record 11071742;
                                                                ContractObjectMaintenance@1100528601 : Record 11071692;
                                                                ServiceContractArrangement@1100528602 : Record 11071705;
                                                                MaintenanceProposalLine@1100528603 : Record 11071696;
                                                              BEGIN
                                                                IF xRec."Use Contract Clusters" <> "Use Contract Clusters" THEN BEGIN
                                                                  IF NOT "Use Contract Clusters" THEN BEGIN
                                                                    ServiceCluster.SETRANGE(Type, ServiceCluster.Type::Contract);
                                                                    ServiceCluster.SETRANGE("Type Code", "No.");
                                                                    ServiceCluster.SETRANGE("Source Type", ServiceCluster."Source Type"::" ");
                                                                    IF NOT ServiceCluster.ISEMPTY THEN
                                                                      ERROR(Text114);
                                                                  END;
                                                                  ContractObjectMaintenance.SETRANGE("Service Contract No.", "No.");
                                                                  ContractObjectMaintenance.SETFILTER(Cluster, '<>%1', '');
                                                                  IF NOT ContractObjectMaintenance.ISEMPTY THEN
                                                                    ERROR(Text115, ContractObjectMaintenance.TABLECAPTION);
                                                                  ServiceContractArrangement.SETRANGE("Service Contract No.", "No.");
                                                                  ServiceContractArrangement.SETFILTER(Cluster, '<>%1', '');
                                                                  IF NOT ServiceContractArrangement.ISEMPTY THEN
                                                                    ERROR(Text115, ServiceContractArrangement.TABLECAPTION);
                                                                  MaintenanceProposalLine.SETRANGE("Service Contract No.", "No.");
                                                                  MaintenanceProposalLine.SETFILTER(Cluster, '<>%1', '');
                                                                  IF NOT MaintenanceProposalLine.ISEMPTY THEN
                                                                    ERROR(Text115, MaintenanceProposalLine.TABLECAPTION);
                                                                  Cluster := '';
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Use Contract Clusters }
    { 1540;   ;Cluster             ;Code20        ;TableRelation=IF (Use Contract Clusters=CONST(No)) "Service Cluster".Code WHERE (Type=CONST(" "),
                                                                                                                                    Source Type=CONST(" "))
                                                                                                                                    ELSE IF (Use Contract Clusters=CONST(Yes)) "Service Cluster".Code WHERE (Type=CONST(Contract),
                                                                                                                                                                                                             Source Type=CONST(" "));
                                                   OnValidate=VAR
                                                                ContractObjectMaintenance@1100528600 : Record 11071692;
                                                              BEGIN
                                                                ValidateServiceCluster;

                                                                ContractObjectMaintenance.SETRANGE("Service Contract No.", "No.");
                                                                IF NOT ContractObjectMaintenance.ISEMPTY THEN
                                                                  MESSAGE(Text116, FIELDCAPTION(Cluster));
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupServiceCluster;
                                                            END;

                                                   CaptionML=[ENU=Cluster;
                                                              NOR=Klynge;
                                                              SVE=Kluster] }
    { 1550;   ;Installment Type    ;Option        ;OnValidate=BEGIN
                                                                CASE "Installment Type" OF
                                                                  "Installment Type"::" ":
                                                                    TESTFIELD("Invoice Type", "Invoice Type"::Dynamic);
                                                                  "Installment Type"::Object:
                                                                    "Installments based on Progress" := FALSE;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Installment Type;
                                                              NOR=Betalingsplanstype;
                                                              SVE=Betalplanstyp];
                                                   OptionCaptionML=ENU=" ,Contract,Object,Consumption";
                                                   OptionString=[ ,Contract,Object,Consumption] }
    { 1560;   ;No. of Control Messages;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Contract Control Msg." WHERE (Service Contract No.=FIELD(No.)));
                                                   CaptionML=ENU=No. of Control Messages;
                                                   Editable=No }
    { 1570;   ;Control Build Date  ;Date          ;CaptionML=ENU=Control Build Date;
                                                   Editable=No }
    { 1580;   ;Control Build Time  ;Time          ;CaptionML=ENU=Control Build Time;
                                                   Editable=No }
    { 1590;   ;Dynamic Invoice Type;Option        ;OnValidate=VAR
                                                                ServiceSalesDiscount@1100528600 : Record 11072237;
                                                              BEGIN
                                                                IF "Dynamic Invoice Type" <> "Dynamic Invoice Type"::" " THEN
                                                                  TESTFIELD("Invoice Type", "Invoice Type"::Dynamic)
                                                                ELSE
                                                                  FIELDERROR("Dynamic Invoice Type");
                                                                IF "Dynamic Invoice Type" = "Dynamic Invoice Type"::Days THEN BEGIN
                                                                  ServiceSalesDiscount.SETRANGE(Type, ServiceSalesDiscount.Type::Contract);
                                                                  ServiceSalesDiscount.SETRANGE(Code, "No.");
                                                                  ServiceSalesDiscount.SETFILTER(Amount, '<>%1', 0);
                                                                  IF NOT ServiceSalesDiscount.ISEMPTY THEN
                                                                    ERROR(Text126);
                                                                  CLEAR("Invoice Interval");
                                                                  VALIDATE("Invoice Interval");
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Dynamic Invoice Type;
                                                   OptionCaptionML=ENU=" ,Days,Invoice Interval";
                                                   OptionString=[ ,Days,Invoice Interval] }
    { 1600;   ;OLD Always Allow Close Orders;Boolean;
                                                   OnValidate=BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("OLD Always Allow Close Orders"));
                                                              END;

                                                   CaptionML=ENU=OLD Always Allow Close Orders }
    { 1601;   ;Always Allow Cls Ord. (Maint.);Boolean;
                                                   OnValidate=BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("Always Allow Cls Ord. (Maint.)"));
                                                              END;

                                                   CaptionML=ENU=Always Allow Close Orders (Maint.) }
    { 1602;   ;Always Allow Cls Ord. (Call);Boolean;
                                                   OnValidate=BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("Always Allow Cls Ord. (Call)"));
                                                              END;

                                                   CaptionML=ENU=Always Allow Close Orders (Call) }
    { 1603;   ;Always Allow Cls Ord. (Ext.);Boolean;
                                                   OnValidate=BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("Always Allow Cls Ord. (Ext.)"));
                                                              END;

                                                   CaptionML=ENU=Always Allow Close Orders (Ext.) }
    { 1610;   ;Calc. Progress Perc. Progn/Res;Option;
                                                   OnValidate=VAR
                                                                ServiceCategory@1100528600 : Record 11071985;
                                                                ServiceSetup@1100528601 : Record 11012800;
                                                                ServicePrognosisManagement@1100528602 : Codeunit 11012884;
                                                              BEGIN
                                                                CheckServiceAuthorization(FIELDCAPTION("Calc. Progress Perc. Progn/Res"));
                                                                IF "Calc. Progress Perc. Progn/Res" IN ["Calc. Progress Perc. Progn/Res"::"Allowed Hours", "Calc. Progress Perc. Progn/Res"::"Allowed Cost"] THEN
                                                                  TESTFIELD("Budget Based on", "Budget Based on"::"Maintenance Scheme");
                                                                IF NOT ("Calc. Progress Perc. Progn/Res" IN ["Calc. Progress Perc. Progn/Res"::"Actual Cost", "Calc. Progress Perc. Progn/Res"::"Elapsed Time"]) THEN
                                                                  TESTFIELD("Result Calc. on Total Contract", FALSE);
                                                                ServiceSetup.GET;
                                                                ServiceCategory.SETRANGE("Service Contract No.", "No.");
                                                                IF NOT ServiceCategory.ISEMPTY AND (ServiceSetup."Service Control Method" = ServiceSetup."Service Control Method"::"Real-Time") THEN
                                                                  MESSAGE(Text129, "Calc. Progress Perc. Progn/Res");
                                                                IF "Calc. Progress Perc. Progn/Res" > "Calc. Progress Perc. Progn/Res"::"Elapsed Time" THEN
                                                                  ServiceSetup.TESTFIELD("Service Control Method", ServiceSetup."Service Control Method"::"Real-Time");
                                                                ServicePrognosisManagement.TestProgressMethodvsProgressMeasurement("No.", "Calc. Progress Perc. Progn/Res", "Level Progress Measurement");
                                                              END;

                                                   CaptionML=ENU=Calculation Progress Perc. Prognosis/Preclosure Result;
                                                   OptionCaptionML=ENU=Allowed Hours,,,Actual Cost,Elapsed Time,,Available Hours,,Allowed Cost,,Available Cost,,None;
                                                   OptionString=Allowed Hours,,,Actual Cost,Elapsed Time,,Available Hours,,Allowed Cost,,Available Cost,,None }
    { 1620;   ;Payment Method Code (Con.Inv.);Code10;
                                                   TableRelation="Payment Method";
                                                   CaptionML=ENU=Payment Method Code (Contract Invoicing) }
    { 1630;   ;Travel Cost Code    ;Code10        ;TableRelation="Travel Cost Code";
                                                   CaptionML=[ENU=Travel Cost Code;
                                                              NOR=Reisekostkode;
                                                              SVE=Resekostnadskod] }
    { 1640;   ;Budget Based on     ;Option        ;OnValidate=VAR
                                                                ServiceCategory@1100528600 : Record 11071985;
                                                                SCBudgetVersionCalls@1100528601 : Record 11071928;
                                                                SCBudgetCallsRelease@1100528602 : Record 11071699;
                                                                SCBudgetVersion@1100528603 : Record 11071990;
                                                                PercentageShareCallsbyDate@1100528605 : Record 11071815;
                                                                ServiceSetup@1100528606 : Record 11012800;
                                                              BEGIN
                                                                ServiceSetup.GET;
                                                                IF xRec."Budget Based on" <> "Budget Based on" THEN BEGIN
                                                                  CASE "Budget Based on" OF
                                                                    "Budget Based on"::"Maintenance Scheme":
                                                                      BEGIN
                                                                        ServiceCategory.SETRANGE("Service Contract No.", "No.");
                                                                        IF NOT ServiceCategory.ISEMPTY THEN
                                                                          FIELDERROR("Budget Based on", STRSUBSTNO(Text120, ServiceCategory.TABLECAPTION));
                                                                        TESTFIELD("Service Category (Call)", '');
                                                                        TESTFIELD("Service Category (Direct)", '');
                                                                        IF "Level Progress Measurement" = "Level Progress Measurement"::"Service Category" THEN
                                                                          FIELDERROR("Level Progress Measurement");
                                                                      END;
                                                                    "Budget Based on"::Category:
                                                                      BEGIN
                                                                        "Calc. Progress Perc. Progn/Res" := "Calc. Progress Perc. Progn/Res"::"Actual Cost";
                                                                        SCBudgetVersionCalls.SETRANGE("Service Contract No.", "No.");
                                                                        IF NOT SCBudgetVersionCalls.ISEMPTY THEN
                                                                          FIELDERROR("Budget Based on", STRSUBSTNO(Text120, SCBudgetVersionCalls.TABLECAPTION));

                                                                        SCBudgetCallsRelease.SETRANGE(Type, SCBudgetCallsRelease.Type::Contract);
                                                                        SCBudgetCallsRelease.SETRANGE(Code, "No.");
                                                                        IF NOT SCBudgetCallsRelease.ISEMPTY THEN
                                                                          FIELDERROR("Budget Based on", STRSUBSTNO(Text120, SCBudgetCallsRelease.TABLECAPTION));
                                                                      END;
                                                                    "Budget Based on"::"Category + Maintenance Scheme":
                                                                      BEGIN
                                                                        IF ServiceSetup."Service Control Method" = ServiceSetup."Service Control Method"::Snapshot THEN BEGIN
                                                                          SCBudgetVersion.SETRANGE("Service Contract No.", "No.");
                                                                          IF NOT SCBudgetVersion.ISEMPTY THEN
                                                                            FIELDERROR("Budget Based on", STRSUBSTNO(Text120, SCBudgetVersion.TABLECAPTION));
                                                                        END;
                                                                      END;
                                                                  END;

                                                                  IF "Budget Based on" IN ["Budget Based on"::Category, "Budget Based on"::"Category + Maintenance Scheme"] THEN BEGIN
                                                                    IF ServiceSetup."Service Control Method" = ServiceSetup."Service Control Method"::"Real-Time" THEN BEGIN
                                                                      PercentageShareCallsbyDate.SETRANGE("Service Contract No.", "No.");
                                                                      IF NOT PercentageShareCallsbyDate.ISEMPTY THEN
                                                                        FIELDERROR("Budget Based on", STRSUBSTNO(Text120, PercentageShareCallsbyDate.TABLECAPTION));
                                                                    END;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Budget Based on;
                                                              SVE=Budget baserat p†];
                                                   OptionCaptionML=ENU=Maintenance Scheme,Category,Category + Maintenance Scheme;
                                                   OptionString=Maintenance Scheme,Category,Category + Maintenance Scheme }
    { 1650;   ;Service Category (Call);Code10     ;TableRelation="Service Category".Code WHERE (Service Contract No.=FIELD(No.));
                                                   CaptionML=ENU=Service Category (Call) }
    { 1660;   ;Service Category (Direct);Code10   ;TableRelation="Service Category".Code WHERE (Service Contract No.=FIELD(No.));
                                                   CaptionML=ENU=Service Category (Direct) }
    { 1670;   ;No. of Batch Logs   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Inv. Proposal Batch Message" WHERE (Invoice Proposal Type=CONST(Service Contract),
                                                                                                          Source Code=FIELD(No.),
                                                                                                          Batch Finished=CONST(No)));
                                                   CaptionML=ENU=No. of Batch Logs;
                                                   Editable=No }
    { 1680;   ;Compress Dyn. Inv. Prop. Lines;Boolean;
                                                   CaptionML=ENU=Compress Dyn. Inv. Prop. Lines }
    { 1690;   ;Create Adv./Purch. Subc. Call;Option;
                                                   CaptionML=ENU=Create Advice/Purchase Order with Subcontracting (Call);
                                                   OptionCaptionML=ENU=User Setup,Yes,No;
                                                   OptionString=Setup,Yes,No }
    { 1691;   ;Create Adv./Purch. Subc. Con.;Option;
                                                   CaptionML=ENU=Create Advice/Purchase Order with Subcontracting (Contract);
                                                   OptionCaptionML=ENU=User Setup,Yes,No;
                                                   OptionString=Setup,Yes,No }
    { 1692;   ;Create Adv./Purch. Subc. Dir.;Option;
                                                   CaptionML=ENU=Create Advice/Purchase Order with Subcontracting (Direct);
                                                   OptionCaptionML=ENU=User Setup,Yes,No;
                                                   OptionString=Setup,Yes,No }
    { 1700;   ;Last Index Date     ;Date          ;CaptionML=[ENU=Last Index Date;
                                                              NOR=Siste indeksdato;
                                                              SVE=Senaste indexdatum] }
    { 1710;   ;Bill-to Customer No. (Contr.);Code20;
                                                   TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF "Bill-to Customer No. (Contr.)" <> xRec."Bill-to Customer No. (Contr.)" THEN BEGIN
                                                                  IF "Bill-to Customer No. (Contr.)" <> '' THEN BEGIN
                                                                    CustRec.GET("Bill-to Customer No. (Contr.)");
                                                                    CustRec.CheckCustomerStatus("Bill-to Customer No. (Contr.)");
                                                                  END;
                                                                  IF (CurrFieldNo <> FIELDNO("Customer No.")) AND "Invoicing via Collective List" THEN
                                                                    TESTFIELD("Bill-to Customer No. (CP)", "Bill-to Customer No. (Contr.)");
                                                                END;

                                                                IF "Customer No." <> '' THEN BEGIN
                                                                  CustRec.GET("Customer No.");
                                                                  IF CustRec."Bill-to Customer No." <> '' THEN
                                                                    IF "Bill-to Customer No. (Contr.)" = '' THEN
                                                                      "Bill-to Customer No. (Contr.)" := CustRec."Bill-to Customer No.";
                                                                END;
                                                                IF "Bill-to Customer No. (Contr.)" = '' THEN
                                                                  "Bill-to Customer No. (Contr.)" := "Customer No.";
                                                                IF CustRec.GET("Bill-to Customer No. (Contr.)") THEN BEGIN
                                                                  GetDefaultContractManager;
                                                                  GetDefaultInvoiceText;
                                                                  IF "Contract Form" <> "Contract Form"::"Rental Contract" THEN BEGIN
                                                                    IF CustRec."VAT Prod. Posting Group" <> '' THEN
                                                                      "VAT Prod. Posting Group" := CustRec."VAT Prod. Posting Group";
                                                                    CheckVATReverse(FALSE,FALSE);
                                                                  END;
                                                                END;
                                                                DetermineAlternativeBilltoAddress(FIELDNO("Bill-to Customer No. (Contr.)"));
                                                                CheckInvoiceAddress;
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No. (Contract);
                                                              SVE=Faktureringskundnr (kontrakt)] }
    { 1720;   ;Bill-to Name (Contract);Text100    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD("Bill-to Customer No. (Contr.)")));
                                                   CaptionML=[ENU=Bill-to Name (Contract);
                                                              SVE=Faktureringsnamn (kontrakt)];
                                                   Editable=No }
    { 1730;   ;Bill-to Name 2 (Contract);Text50   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Name 2" WHERE (No.=FIELD("Bill-to Customer No. (Contr.)")));
                                                   CaptionML=[ENU=Bill-to Name 2 (Contract);
                                                              SVE=Faktureringsnamn 2 (kontrakt)];
                                                   Editable=No }
    { 1740;   ;Bill-to Address (Contract);Text100 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Address WHERE (No.=FIELD("Bill-to Customer No. (Contr.)")));
                                                   CaptionML=[ENU=Bill-to Address (Contract);
                                                              SVE=Faktureringsadress (kontrakt)];
                                                   Editable=No }
    { 1750;   ;Bill-to Address 2 (Contract);Text50;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Address 2" WHERE (No.=FIELD("Bill-to Customer No. (Contr.)")));
                                                   CaptionML=[ENU=Bill-to Address 2 (Contract);
                                                              SVE=Faktureringsadress 2 (kontrakt)];
                                                   Editable=No }
    { 1760;   ;Bill-to Post Code (Contract);Code20;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Post Code" WHERE (No.=FIELD("Bill-to Customer No. (Contr.)")));
                                                   CaptionML=[ENU=Bill-to Post Code (Contract);
                                                              SVE=Faktureras postnr (kontrakt)];
                                                   Editable=No }
    { 1770;   ;Bill-to City (Contract);Text30     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.City WHERE (No.=FIELD("Bill-to Customer No. (Contr.)")));
                                                   CaptionML=[ENU=Bill-to City (Contract);
                                                              SVE=Faktureras ort (kontrakt)];
                                                   Editable=No }
    { 1780;   ;Alt. Bill-to Address (Contr.);Code10;
                                                   TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD("Bill-to Customer No. (Contr.)"),
                                                                                               Billing Address=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                CheckInvoiceAddress;
                                                                CALCFIELDS("Derived from Cust. No. (Contr)");
                                                              END;

                                                   CaptionML=ENU=Alternative Bill-to Address (Contract) }
    { 1790;   ;Derived from Cust. No. (Contr);Code20;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address"."Derived from Customer No." WHERE (Customer No.=FIELD("Bill-to Customer No. (Contr.)"),
                                                                                                                           Code=FIELD("Alt. Bill-to Address (Contr.)")));
                                                   CaptionML=ENU=Derived from Customer No. (Contract);
                                                   Editable=No }
    { 1800;   ;Use Bill-to as Sell-to (Contr);Boolean;
                                                   CaptionML=ENU=Use Bill-to Customer as Sell-to Customer on Sales Invoice (Contract) }
    { 1810;   ;Price Book Type     ;Option        ;OnValidate=VAR
                                                                ServicePriceBook@1100528601 : Record 11071768;
                                                                ServiceUnitPriceManagement@1100528600 : Codeunit 11012846;
                                                              BEGIN
                                                                CASE "Price Book Type" OF
                                                                  "Price Book Type"::None:
                                                                    VALIDATE("Price Book Code", '');
                                                                  "Price Book Type"::Customer:
                                                                    BEGIN
                                                                      ServicePriceBook.SETRANGE(Code, "Customer No.");
                                                                      IF NOT ServicePriceBook.ISEMPTY THEN BEGIN
                                                                        VALIDATE("Price Book Code", "Customer No.");
                                                                        "Price Book Index Date" :=
                                                                          ServiceUnitPriceManagement.GetLatestPriceBookIndexDate("Price Book Type", "Price Book Code");
                                                                        IF "Price Book Index Date" = 0D THEN
                                                                          "Price Book Code" := '';
                                                                      END;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Price Book Type;
                                                              SVE=Enhetspristyp];
                                                   OptionCaptionML=[ENU=None,Internal,Customer;
                                                                    NOR=Ingen,Intern,Kunde);
                                                                    SVE=Inget,Internt,Kund];
                                                   OptionString=None,Internal,Customer }
    { 1820;   ;Price Book Code     ;Code20        ;TableRelation="Service Price Book".Code WHERE (Type=FIELD(Price Book Type));
                                                   OnValidate=BEGIN
                                                                IF ("Price Book Code" = '') OR ("Price Book Code" <> xRec."Price Book Code") THEN BEGIN
                                                                  VALIDATE("Price Book Index Date", 0D);
                                                                  VALIDATE("Unit Price Set", '');
                                                                  VALIDATE("Unit Price Status", "Unit Price Status"::" ");
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              ServicePriceBook@1100528600 : Record 11071768;
                                                              ServicePriceBookList@1100528601 : Page 11125269;
                                                            BEGIN
                                                              ServicePriceBook.SETRANGE(Type, "Price Book Type");
                                                              ServicePriceBookList.LOOKUPMODE(TRUE);
                                                              ServicePriceBookList.SETTABLEVIEW(ServicePriceBook);
                                                              IF ServicePriceBookList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ServicePriceBookList.GETRECORD(ServicePriceBook);
                                                                "Price Book Code" := ServicePriceBook.Code;
                                                                "Price Book Index Date" := ServicePriceBook."Index Date";
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Price Book Code;
                                                              SVE=Enhetspriskod] }
    { 1830;   ;Price Book Index Date;Date         ;TableRelation="Service Price Book"."Index Date" WHERE (Code=FIELD(Price Book Code));
                                                   OnValidate=BEGIN
                                                                IF "Price Book Index Date" <> 0D THEN
                                                                  IF "Price Book Type" = "Price Book Type"::None THEN
                                                                    FIELDERROR("Price Book Index Date");
                                                              END;

                                                   CaptionML=[ENU=Price Book Index Date;
                                                              SVE=Indexdatum f”r enhetspris] }
    { 1840;   ;Unit Price Set      ;Code20        ;TableRelation="Service Unit Price Set".Code WHERE (Price Book Type=FIELD(Price Book Type),
                                                                                                      Price Book Code=FIELD(Price Book Code),
                                                                                                      Price Book Index Date=FIELD(Price Book Index Date));
                                                   CaptionML=[ENU=Unit Price Set;
                                                              SVE=A-pris grupp] }
    { 1850;   ;Unit Price Status   ;Option        ;OnValidate=BEGIN
                                                                IF "Unit Price Status" <> "Unit Price Status"::" " THEN
                                                                  IF "Price Book Type" = "Price Book Type"::None THEN
                                                                    FIELDERROR("Unit Price Status");
                                                              END;

                                                   CaptionML=[ENU=Unit Price Status;
                                                              NOR=Enhetspris, status;
                                                              SVE=Enhetsprisstatus];
                                                   OptionCaptionML=ENU=" ,Pre-Recording,Recording,Production Recording";
                                                   OptionString=[ ,Pre-Recording,Recording,Production Recording] }
    { 1860;   ;Revenues incl. Period;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Revenue (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                       Posting Date=FIELD(Cumulative Filter),
                                                                                                                       Source Type=FIELD(Source Type Filter),
                                                                                                                       Cost Component=FIELD(Cost Component Filter),
                                                                                                                       Revenue Present=CONST(Yes)));
                                                   CaptionML=ENU=Revenues up to and including Period;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1870;   ;Actual Costs incl. Period;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service-Ledger Entry"."Total Cost (LCY)" WHERE (Service Contract No.=FIELD(No.),
                                                                                                                    Posting Date=FIELD(Cumulative Filter),
                                                                                                                    Source Type=FIELD(Source Type Filter),
                                                                                                                    Cost Component=FIELD(Cost Component Filter),
                                                                                                                    Cost Present=CONST(Yes)));
                                                   CaptionML=[ENU=Actual Costs up to and including Period;
                                                              SVE=Verkliga kostnader fram till och med period];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 1880;   ;Level Progress Measurement;Option  ;OnValidate=VAR
                                                                ServiceCategory@1100528601 : Record 11071985;
                                                                ServicePrognosisManagement@1100528600 : Codeunit 11012884;
                                                              BEGIN
                                                                IF "Level Progress Measurement" = "Level Progress Measurement"::"Service Category" THEN
                                                                  IF NOT ("Budget Based on" IN ["Budget Based on"::Category, "Budget Based on"::"Category + Maintenance Scheme"]) THEN
                                                                    FIELDERROR("Budget Based on");
                                                                ServicePrognosisManagement.TestProgressMethodvsProgressMeasurement("No.", "Calc. Progress Perc. Progn/Res", "Level Progress Measurement");
                                                                IF "Budget Based on" IN ["Budget Based on"::Category, "Budget Based on"::"Category + Maintenance Scheme"] THEN BEGIN
                                                                  ServiceCategory.SETRANGE("Service Contract No.", "No.");
                                                                  IF ServiceCategory.FINDSET THEN
                                                                    REPEAT
                                                                      ServicePrognosisManagement.TestProgressMethodvsProgressMeasurement("No.", ServiceCategory."Calc. Progress Perc. Progn/Res", "Level Progress Measurement");
                                                                    UNTIL ServiceCategory.NEXT = 0;
                                                                END;
                                                                IF "Level Progress Measurement" <> "Level Progress Measurement"::"Service Category" THEN BEGIN
                                                                  ServiceCategory.SETRANGE("Service Contract No.", "No.");
                                                                  ServiceCategory.SETRANGE("Calc. Interim Results by Order", TRUE);
                                                                  IF ServiceCategory.FINDFIRST THEN
                                                                    ServiceCategory.TESTFIELD("Calc. Interim Results by Order", FALSE);
                                                                END;
                                                                IF "Level Progress Measurement" <> "Level Progress Measurement"::Period THEN
                                                                  TESTFIELD("Result Calc. on Total Contract", FALSE);
                                                              END;

                                                   CaptionML=ENU=Level Progress Measurement;
                                                   OptionCaptionML=ENU=Period,Service Category,Source Type;
                                                   OptionString=Period,Service Category,Source Type }
    { 1890;   ;Use Bill-To Cust. for Pr. Book;Boolean;
                                                   OnValidate=BEGIN
                                                                DeterminePriceBookFields;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Use bill-to Customer for Price Book }
    { 1900;   ;Initial Minutes Working Hours;Integer;
                                                   CaptionML=[ENU=Initial Minutes Working Hours;
                                                              NOR=Startminutter, Arbeidstimer;
                                                              SVE=Startminuter, arbetstimmar];
                                                   MinValue=0 }
    { 1910;   ;Round Working Hours on Minutes;Integer;
                                                   CaptionML=[ENU=Round Working Hours on Minutes;
                                                              NOR=Rund av Arbeidstimer p† Minutter;
                                                              SVE=Omg†ng, arbetstimmar minuter];
                                                   MinValue=0 }
    { 1920;   ;Round Travel Hours on Minutes;Integer;
                                                   CaptionML=[ENU=Round Travel Hours on Minutes;
                                                              NOR=Rund av Reisetimer p† Minutter;
                                                              SVE=Omg†ng, restimmar minuter];
                                                   MinValue=0 }
    { 1930;   ;Bill-to Contact Person (Contr);Code20;
                                                   TableRelation=Contact.No. WHERE (Company No.=FIELD("Bill-to Contact No. (CP)"),
                                                                                    Type=CONST(Person));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Bill-to Cont. Pers. Name (Ctr)");
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Bill-to Contact Person (Contract) }
    { 1940;   ;Bill-to Cont. Pers. Name (Ctr);Text100;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD("Bill-to Contact Person (Contr)")));
                                                   CaptionML=ENU=Bill-to Contact Person Name (Contract);
                                                   Editable=No }
    { 1950;   ;Rest of Contract    ;Boolean       ;OnValidate=BEGIN
                                                                IF "Rest of Contract" THEN BEGIN
                                                                  IF (FORMAT("Contract Duration") = '') AND ("Ending Date" = 0D) THEN
                                                                    ERROR(Text130, FIELDCAPTION("Contract Duration"), FIELDCAPTION("Ending Date"));
                                                                END ELSE
                                                                  TESTFIELD("Result Calc. on Total Contract", FALSE);
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Rest of Contract }
    { 1960;   ;Service Time Table Code;Code20     ;TableRelation="Service Time Table";
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Service Time Table Code }
    { 1970;   ;Result Calc. on Total Contract;Boolean;
                                                   OnValidate=VAR
                                                                ServiceContractCtrlPeriod@1100529600 : Record 11071746;
                                                              BEGIN
                                                                IF "Result Calc. on Total Contract" THEN BEGIN
                                                                  TESTFIELD("Contract Limit", "Contract Limit"::Limited);
                                                                  TESTFIELD("Level Progress Measurement", "Level Progress Measurement"::Period);
                                                                  TESTFIELD("Rest of Contract", TRUE);
                                                                  IF NOT ("Calc. Progress Perc. Progn/Res" IN ["Calc. Progress Perc. Progn/Res"::"Actual Cost", "Calc. Progress Perc. Progn/Res"::"Elapsed Time"]) THEN
                                                                    FIELDERROR("Calc. Progress Perc. Progn/Res");
                                                                  CheckWIP;
                                                                END ELSE BEGIN
                                                                  ServiceContractCtrlPeriod.SETRANGE("Service Contract No.", "No.");
                                                                  ServiceContractCtrlPeriod.SETFILTER("Date Finished", '<>%1', 0D);
                                                                  IF ServiceContractCtrlPeriod.FINDFIRST THEN
                                                                    ServiceContractCtrlPeriod.TESTFIELD("Date Finished", 0D);
                                                                END;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Result Calc. on Total Contract }
    { 1980;   ;Control Details     ;Option        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Control Details;
                                                   OptionCaptionML=ENU=Source Type,Cost Type/Cost Object;
                                                   OptionString=Source Type,Cost Type/Cost Object }
    { 11128900;;Retention %        ;Decimal       ;CaptionML=[ENU=Retention %;
                                                              NOR=Gjenv‘rende %;
                                                              SVE=Kvarst†ende procent];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PSNA }
    { 11128910;;Retention % 2      ;Decimal       ;CaptionML=[ENU=Retention % 2;
                                                              NOR=Gjenv‘rende % 2;
                                                              SVE=Kvarst†ende procent 2];
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Description=4PSNA }
    { 11128920;;Retention Payment Terms Code;Code10;
                                                   TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Retention Payment Terms Code;
                                                              NOR=Betalingsvilk†rskode for gjenv‘rende;
                                                              SVE=Kvarst†ende betalningsvillkorskod];
                                                   Description=4PSNA }
    { 11128930;;Retention Payment Terms Code 2;Code10;
                                                   TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Retention Payment Terms Code 2;
                                                              NOR=Betalingsvilk†rskode 2 for gjenv‘rende;
                                                              SVE=Kvarst†ende betalningsvillkorskod 2];
                                                   Description=4PSNA }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Customer No.                             }
    {    ;Global Dimension 1 Code                  }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ServSetup@1210190000 : Record 11012800;
      Text001@1100525002 : TextConst 'ENU=Copy Sales Surcharges from Customer ?;NOR=Kopier Salgstilleggsgebyrer fra Kunde?;SVE=Kopiera f”rs„ljningskostnader fr†n kund?';
      Text002@1100485019 : TextConst 'ENU=Contract Status is Expired;NOR=Kontraktstatus har Forfalt;SVE=Kontraktstatus har f”rfallit';
      Text003@1210190007 : TextConst 'ENU=Change Cntract Status to %1 ?;NOR=Endre kontraktstatus til %1?;SVE=Žndra kontraktstatus till %1?';
      ServTypeRec@1210190009 : Record 11012814;
      ContrDiscRec@1210190015 : Record 11012828;
      ServEntryRec@1210190021 : Record 11012819;
      ServActRec@1210190018 : Record 5080;
      PrefEmplRec@1100485001 : Record 11012843;
      TimeTableRec@1100485003 : Record 11012867;
      ContrDepRec@1100485004 : Record 11012809;
      ContrHourRec@1100485006 : Record 11012815;
      CustRec@1210190002 : Record 18;
      CustSurchRec@1100485018 : Record 11020367;
      NoSeriesMgt@1210190001 : Codeunit 396;
      Text003a@1210190025 : TextConst 'ENU=Block Contract ?;NOR=Blokker Kontrakt?;SVE=Sp„rra kontrakt?';
      Text004@1210190011 : TextConst 'ENU=must occur before %1;NOR=m† inntreffe f›r %1;SVE=m†ste intr„ffa f”re %1';
      Text004a@1100485020 : TextConst 'ENU=%1 should occur before %2;NOR=%1 skal inntreffe f›r %2;SVE=%1 ska intr„ffa f”re %2';
      Text004b@1210190013 : TextConst 'ENU=%1 not in period between %2 and %3.;NOR=%1 ikke i periode mellom %2 og %3.;SVE=%1 inte i period mellan %2 och %3.';
      Text006@1210190019 : TextConst 'ENU=Do you want to change %1?;NOR=Vil du endre %1?;SVE=Vill du „ndra %1?';
      Text007@1210190020 : TextConst 'ENU=Service Entry present.;NOR=Servicetransaksjon finnes.;SVE=Servicetransaktion finns.';
      MoveEntries@1100485007 : Codeunit 361;
      DimMgt@1100525004 : Codeunit 408;
      RefLimitRec@1100485002 : Record 11012856;
      MailRec@1210190003 : Record 11071711;
      CostCompRec@1100485009 : Record 11012859;
      Text011@1100525003 : TextConst 'ENU=Start Date and/or Ending Date of the contract has to be filled;NOR=Startdato og/eller sluttdato for kontrakten m† fylles ut;SVE=Startdatum och/eller slutdatum f”r kontraktet m†ste fyllas i';
      DPA_Management@1100000999 : Codeunit 11012783;
      Text999a@1210190012 : TextConst 'ENU=Change Data;NOR=Endre data;SVE=Ändra data';
      Text999b@1210190008 : TextConst 'ENU=Old;NOR=Gammel;SVE=Gammal';
      Text999c@1210190006 : TextConst 'ENU=New;NOR=Ny;SVE=Ny';
      Text100@1100528600 : TextConst 'ENU=Contract Installments present.;NOR=Kontraktavdrag finnes.;SVE=Kontraktavbetalningar finns.';
      Text104@1100528602 : TextConst 'ENU=There are unfinished Maintenance Proposal Lines present after Ending Date;NOR=Det finnes uferdige rader for Vedlikeholdsforslag etter Sluttdato;SVE=Det finns oavslutade rader f”r underh†llsf”rslag efter slutdatum';
      Text105@1100528605 : TextConst 'ENU=There are unfinished Service Orders present after Ending Date;NOR=Det finnes uferdige Serviceordre etter Sluttdato;SVE=Det finns oavslutade serviceordrar efter slutdatum';
      Text106@1100528606 : TextConst 'ENU=There are Invoice Proposals for this Contract present.;NOR=Det finnes Fakturaforslag for denne Kontrakten.;SVE=Det finns fakturaf”rslag f”r detta kontrakt.';
      Text108@1100528608 : TextConst 'ENU=Do you want to create a Service Contact using a Service Contract Template?;NOR=Vil du opprette en Servicekontrakt med en Servicekontraktsmal?;SVE=Vill du skapa ett servicekontrakt med en servicekontraktsmall?';
      Text109@1100528609 : TextConst 'ENU=Service-Contract Control Periods already exist, delete first?;NOR=Kontrollperioder for Servicekontrakt finnes allerede, fjerne disse f›rst?;SVE=Kontrollperioder f”r servicekontrakt finns redan, ta bort f”rst?';
      Text110@1100528800 : TextConst 'ENU=Do you want to change the Currency Code ?;NOR=Vil du endre Valutakoden?;SVE=Vill du „ndra valutakoden?';
      Text111@1100409000 : TextConst 'ENU=Surcharges already exist, overwrite?;NOR=Tilleggsgebyrer finnes allerede, Overskrive?';
      Text112@1100528610 : TextConst 'ENU=must be a positive value';
      Text113@1100528611 : TextConst 'ENU=%1 lines exist, changing %2 not allowed;NOR=%1 Rader finnes, endre %2 ikke tillatt';
      Text114@1100525005 : TextConst 'ENU=Contract contains Clusters';
      Text115@1100525001 : TextConst 'ENU=Clusters used in %1;SVE=Innan du kan anv„nda Online Map m†ste du fylla i f”nstret Online Map - inst„llning.\Se Konfiguration av Online Map i hj„lpen';
      Text116@1100525000 : TextConst 'ENU=You have changed %1 on the service contract header, but it has not been changed on the existing maintenance lines.';
      Text117@1100525007 : TextConst 'ENU=Service Object %1 is not part of Service Contract %2;NOR=Serviceobjekt %1 er ikke en del av Servicekontrakt %2;SVE=Serviceobjekt %1 „r inte en del av servicekontrakt %2';
      Text118@1100525006 : TextConst 'ENU=Service Object %1 is part of Service Contract %2 but is not active;NOR=Serviceobjekt %1 er del av Servicekontrakt %2, men er ikke aktiv;SVE=Serviceobjekt %1 „r en del av servicekontrakt %2 men „r inte aktivt';
      Text119@1100528601 : TextConst 'ENU=%1 can not be changed by user %2, because cost and/or revenues are registrated.;SVE=Kontraktsbelopp finns.';
      Text120@1100528603 : TextConst 'ENU=%1 lines exist;SVE=Vill du uppdatera raderna?';
      Text121@1100528604 : TextConst 'ENU=There are open WIP Service Entries present. Use ''%1'' and Close Service Orders to Close.';
      Text122@1100528613 : TextConst 'ENU=Status of Service Call %1 must be Closed;SVE=Status p† %1 m†ste vara St„ngd';
      Text123@1100528612 : TextConst 'ENU=Status of Service Order %1 must be Finished. Use ''%2'' to Close.;SVE=Status p† serviceorder %1 m†ste vara lika med st„ngd. Anv„nd ''%2'' f”r att st„nga.';
      Text124@1100528614 : TextConst 'ENU=Warnings exist, continue?';
      Text125@1100525008 : TextConst 'ENU=You must update the existing installments manually.';
      Text126@1100528615 : TextConst 'ENU=Service Sales Discount Lines exists with amounts which is not allowed with Dynamisch Invoicing by days.';
      Text127@1100528616 : TextConst 'ENU=%1 must be equal to %2';
      PhoneNumberFormatting@1100525009 : Codeunit 11012276;
      Text128@1100525010 : TextConst 'ENU=Unposted Invoice Proposal/Invoice or Credit Memo %1 present';
      Text129@1100528607 : TextConst 'ENU=You have changed %1 on the service contract header, but it has not been changed on the existing service categories.';
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
      CheckOtherServiceCategories@1100529900 : Boolean;
      Text130@1100529620 : TextConst 'ENU=%1 or %2 must be filled.';
      SkipCreateControlPeriod@1100529600 : Boolean;
      Text131@1100529601 : TextConst 'ENU=You cannot reset %1 manually.';

    PROCEDURE AssistEdit@2(OldServContr@11012000 : Record 11012812) : Boolean;
    VAR
      ServContr@1100525000 : Record 11012812;
    BEGIN
      WITH ServContr DO BEGIN
        ServContr := Rec;
        ServSetup.GET;
        ServSetup.TESTFIELD("Service Contract Nos.");
        IF NoSeriesMgt.SelectSeries(ServSetup."Service Contract Nos.",OldServContr."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          "Service Type" := DetermineServiceTypeSeries(ServSetup."Service Contract Nos.");
          Rec := ServContr;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20];SaveDefaultDim@1210190000 : Boolean);
    VAR
      DimMgt@1100525000 : Codeunit 408;
      DimValRec@1100525001 : Record 349;
    BEGIN
      //db, 19-08-09: M15896
      IF ShortcutDimCode = '' THEN EXIT;
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.GetDimValueRec(FieldNumber, ShortcutDimCode, DimValRec, TRUE,'');
      IF NOT DimMgt.CheckDimValue(DimValRec."Dimension Code",ShortcutDimCode) THEN
        ERROR(DimMgt.GetDimErr);
      IF SaveDefaultDim THEN  //db, 14-09-11: M28816
        DimMgt.SaveDefaultDim(DATABASE::"Service-Contract", "No.", FieldNumber, ShortcutDimCode); //mg, 17-05-11: M27041
    END;

    PROCEDURE DetermineServiceTypeSeries@4(iContractNos@1100526200 : Code[10]) : Code[20];
    VAR
      SeriesTypeRec@11012000 : Record 308;
      SeriesSeqRec@11012001 : Record 309;
      SeriesRelationRec@11012002 : Record 310;
    BEGIN
      ServSetup.GET;
      IF NOT SeriesTypeRec.GET(iContractNos) THEN EXIT('');   //db, 12-10-10

      // search No. Series derived from main series as set in service setup
      SeriesRelationRec.SETRANGE(Code, iContractNos);
      IF SeriesRelationRec.FINDSET THEN BEGIN
        REPEAT
          SeriesSeqRec.SETRANGE("Series Code", SeriesRelationRec."Series Code");
          SeriesSeqRec.SETRANGE("Last No. Used", "No.");
          IF SeriesSeqRec.FINDFIRST THEN BEGIN
            SeriesTypeRec.GET(SeriesRelationRec."Series Code");
            IF ServTypeRec.GET(SeriesTypeRec."Service Type") THEN BEGIN
              VALIDATE("Global Dimension 1 Code", ServTypeRec."Department Code");  //db, 14-09-11: M28816
              "Service Type" := SeriesTypeRec."Service Type";
            END;
            IF ServTypeRec.GET(SeriesTypeRec."Service Type (Other)") THEN BEGIN
              "Department Code (Other)" := ServTypeRec."Department Code";
              "Service Type (Other)" := SeriesTypeRec."Service Type (Other)";
            END;
            CheckAdditonalCostSetup;
            EXIT(SeriesTypeRec."Service Type");
          END;
        UNTIL SeriesRelationRec.NEXT = 0;
      END;

      // Search series defined in service setup
      SeriesSeqRec.SETRANGE("Series Code", iContractNos);
      SeriesSeqRec.SETRANGE("Last No. Used", "No.");
      IF SeriesSeqRec.FINDFIRST THEN BEGIN
        SeriesTypeRec.GET(iContractNos);
        IF ServTypeRec.GET(SeriesTypeRec."Service Type") THEN BEGIN
          VALIDATE("Global Dimension 1 Code", ServTypeRec."Department Code");  //db, 14-09-11: M28816
          "Service Type" := SeriesTypeRec."Service Type";
        END;
        IF ServTypeRec.GET(SeriesTypeRec."Service Type (Other)") THEN BEGIN
          "Department Code (Other)" := ServTypeRec."Department Code";
          "Service Type (Other)" := SeriesTypeRec."Service Type (Other)";
        END;
        CheckAdditonalCostSetup;
        EXIT(SeriesTypeRec."Service Type");
      END;

      // If nothing found, return initial value
      EXIT('');
    END;

    PROCEDURE DetServiceTypeSeriesSimple@1100485010() : Code[20];
    VAR
      SeriesTypeRec@11012000 : Record 308;
    BEGIN
      ServSetup.GET;
      IF NOT SeriesTypeRec.GET("No. Series") THEN EXIT('');
      IF ServTypeRec.GET(SeriesTypeRec."Service Type") THEN BEGIN
        VALIDATE("Global Dimension 1 Code", ServTypeRec."Department Code");  //db, 14-09-11: M28816
        "Service Type" := SeriesTypeRec."Service Type";
      END;
      IF ServTypeRec.GET(SeriesTypeRec."Service Type (Other)") THEN BEGIN
        "Department Code (Other)" := ServTypeRec."Department Code";
        "Service Type (Other)" := SeriesTypeRec."Service Type (Other)";
      END;
      CheckAdditonalCostSetup;

      EXIT(SeriesTypeRec."Service Type");
    END;

    PROCEDURE CheckStatus@1210190001(lvStatus@1210190000 : Integer);
    BEGIN
      IF Status < lvStatus THEN BEGIN
        IF (lvStatus = 1) OR (lvStatus = 2) THEN BEGIN  //1=offered, 2=order
          Status := lvStatus;
          IF CONFIRM(Text003, FALSE, Status) THEN
            VALIDATE(Status)
          ELSE
            Status := xRec.Status;
        END;
        IF lvStatus = 4 THEN BEGIN  //4=expired
          IF Blocked = FALSE THEN
            IF CONFIRM(Text003a, FALSE) THEN
              Blocked := TRUE;
        END;
      END;
    END;

    PROCEDURE CheckInvoiceAddress@1210190002();
    VAR
      AdrsRec@1210190000 : Record 222;
    BEGIN
      IF AdrsRec.GET("Bill-to Customer No. (CP)", "Alt. Bill-to Address (CP)") THEN BEGIN
        "Bill-to Name (Cost Plus)" := AdrsRec.Name;
        "Bill-to Name 2 (Cost Plus)" := AdrsRec."Name 2";
        "Bill-to Address (Cost Plus)" := AdrsRec.Address;
        "Bill-to Address 2 (Cost Plus)" := AdrsRec."Address 2";
        "Bill-to Post Code (Cost Plus)" := AdrsRec."Post Code";
        "Bill-to City (Cost Plus)" := AdrsRec.City;
      END ELSE BEGIN
        CALCFIELDS("Bill-to Name (Cost Plus)","Bill-to Name 2 (Cost Plus)","Bill-to Address (Cost Plus)","Bill-to Address 2 (Cost Plus)","Bill-to Post Code (Cost Plus)","Bill-to City (Cost Plus)");
      END;

      IF AdrsRec.GET("Bill-to Customer No. (Contr.)", "Alt. Bill-to Address (Contr.)") THEN BEGIN
        "Bill-to Name (Contract)" := AdrsRec.Name;
        "Bill-to Name 2 (Contract)" := AdrsRec."Name 2";
        "Bill-to Address (Contract)" := AdrsRec.Address;
        "Bill-to Address 2 (Contract)" := AdrsRec."Address 2";
        "Bill-to Post Code (Contract)" := AdrsRec."Post Code";
        "Bill-to City (Contract)" := AdrsRec.City;
      END ELSE BEGIN
        CALCFIELDS("Bill-to Name (Contract)", "Bill-to Name 2 (Contract)", "Bill-to Address (Contract)", "Bill-to Address 2 (Contract)",
          "Bill-to Post Code (Contract)", "Bill-to City (Contract)");
      END;
    END;

    PROCEDURE ShowContact@1210190004(lvCust@1210190001 : Code[20]);
    VAR
      CustRec@1210190000 : Record 18;
      ContRec@1210190006 : Record 5050;
      OldRec@1210190004 : Record 11012812;
      Txt1@1210190003 : Text[250];
      Txt2@1210190002 : Text[250];
    BEGIN
      OldRec := Rec;

      CustRec.ShowContactName(lvCust, ContRec);
      IF ContRec.Name <> '' THEN BEGIN
        VALIDATE("Contact Person", ContRec."No.");  //db, 25-05-11
        "Contact Name" := ContRec.Name;
        "Phone No." := ContRec."Phone No. Work";
        "Phone No. 2" := ContRec."Phone No. Work 2";
        IF "Phone No." = '' THEN
          "Phone No." := ContRec."Phone No.";
        IF "Phone No. 2" = '' THEN
          "Phone No. 2" := ContRec."Phone No. 2";
        "Mobile Phone No." := ContRec."Mobile Phone No.";
        "Fax No." := ContRec."Fax No.";
        "E-Mail" := ContRec."E-Mail";

        //M24165 sn
        IF ("No." <> '') THEN BEGIN
          IF ((OldRec."Contact Name" + OldRec."Phone No." + OldRec."Phone No. 2"  +
               OldRec."E-Mail" + OldRec."Mobile Phone No." ) <>
              ("Contact Name" + "Phone No." + "Phone No. 2"  +
               "E-Mail" + "Mobile Phone No." )) AND
             ((OldRec."Contact Name" + OldRec."Phone No." + OldRec."Phone No. 2" +
               OldRec."E-Mail" + OldRec."Mobile Phone No.") <> '') THEN
          BEGIN
            Txt1 := STRSUBSTNO('%1: \%2: \%3 \%4 \%5 \%6 \%7 \\',
              Text999a, Text999b,
              OldRec."Contact Name", OldRec."Phone No.", OldRec."Phone No. 2",
              OldRec."E-Mail", OldRec."Mobile Phone No.");
            Txt2 := STRSUBSTNO('%1: \%2 \%3 \%4 \%5 \%6 \\',
              Text999c,
              "Contact Name", "Phone No.", "Phone No. 2",
              "E-Mail", "Mobile Phone No.");

            IF CONFIRM(Txt1 + Txt2, TRUE) = FALSE THEN BEGIN
              "Phone No." := OldRec."Phone No.";
              "Phone No. 2" := OldRec."Phone No. 2";
              "Mobile Phone No." := OldRec."Mobile Phone No.";
              "Fax No." := OldRec."Fax No.";
              "E-Mail" := OldRec."E-Mail";
            END ELSE BEGIN
              OldRec."Phone No." := "Phone No.";
              OldRec."Phone No. 2" := "Phone No. 2";
              OldRec."Mobile Phone No." := "Mobile Phone No.";
              OldRec."Fax No." := "Fax No.";
              OldRec."E-Mail" := "E-Mail";
            END;
          END;
        END;
        //M24165 en
      END;
    END;

    PROCEDURE GetDefaultSalesSurcharges@1();
    VAR
      lvCustRec@1100485000 : Record 18;
      lvCustSurchRec@1100485002 : Record 11020367;
      lvCustSurchRec2@1100485003 : Record 11020367;
      lvSkipUpdate@1100525000 : Boolean;
    BEGIN
      IF lvCustRec.GET("Bill-to Customer No. (CP)") THEN BEGIN
        IF "Bill-to Customer No. (CP)" <> xRec."Bill-to Customer No. (CP)" THEN BEGIN
          lvSkipUpdate := FALSE;
          IF (CurrFieldNo <> 0) AND GUIALLOWED THEN BEGIN
            IF NOT CONFIRM(Text001,TRUE) THEN
              lvSkipUpdate := TRUE;
            IF NOT lvSkipUpdate THEN   //db, 22-03-10: M18366
              IF (CurrFieldNo <> 0) AND
                 (xRec."Bill-to Customer No. (CP)" = '') AND
                 (("Surcharge % Labor" <> 0) OR
                  ("Surcharge % Material" <> 0) OR
                  ("Surcharge % Subcontr." <> 0) OR
                  ("Surcharge % Plant" <> 0) OR
                  ("Surcharge % Sundry" <> 0))
              THEN
                lvSkipUpdate := NOT CONFIRM(Text111);
          END;
          IF NOT lvSkipUpdate THEN BEGIN
            "Surcharge % Labor" := lvCustRec."Surcharge % Labor";
            "Surcharge % Material" := lvCustRec."Surcharge % Material";
            "Surcharge % Subcontr." := lvCustRec."Surcharge % Subcontr.";
            "Surcharge % Plant" := lvCustRec."Surcharge % Plant";
            "Surcharge % Sundry" := lvCustRec."Surcharge % Sundry";

            lvCustSurchRec2.SETRANGE("Record Type", lvCustSurchRec2."Record Type"::ServContr);
            lvCustSurchRec2.SETRANGE(Code, "No.");
            lvCustSurchRec2.DELETEALL;

            lvCustSurchRec.SETRANGE("Record Type", lvCustSurchRec."Record Type"::Customer);
            lvCustSurchRec.SETRANGE("Customer No.", "Bill-to Customer No. (CP)");
            IF lvCustSurchRec.FINDSET(FALSE,FALSE) THEN BEGIN
              REPEAT
                lvCustSurchRec2 := lvCustSurchRec;
                lvCustSurchRec2."Record Type" := lvCustSurchRec2."Record Type"::ServContr;
                lvCustSurchRec2."Customer No." := '';
                lvCustSurchRec2.Code := "No.";
                lvCustSurchRec2.INSERT;
              UNTIL lvCustSurchRec.NEXT = 0;
            END;
          END;
        END;
      END;
    END;

    PROCEDURE GetDefaultContractManager@1100525009();
    VAR
      lvSkipUpdate@1100525000 : Boolean;
    BEGIN
      IF "Contract Manager" = '' THEN BEGIN
        "Contract Manager" := CustRec."Salesperson Code";
      END ELSE BEGIN
        IF ("Contract Manager" <> CustRec."Salesperson Code") AND
           (CustRec."Salesperson Code" <> '') THEN BEGIN
          lvSkipUpdate := FALSE;
          IF CurrFieldNo <> 0 THEN
            IF NOT CONFIRM(Text006,FALSE,FIELDCAPTION("Contract Manager")) THEN
              lvSkipUpdate := TRUE;
          IF NOT lvSkipUpdate THEN  //db, 22-03-10: M18366
            "Contract Manager" := CustRec."Salesperson Code";
        END;
      END;
    END;

    PROCEDURE GetDefaultInvoiceText@1100525010();
    VAR
      lvSkipUpdate@1100525000 : Boolean;
    BEGIN
      IF "Invoice Text Installments" = '' THEN BEGIN
        "Invoice Text Installments" := CustRec."Invoice Text Installments";
      END ELSE BEGIN
        IF ("Invoice Text Installments" <> CustRec."Invoice Text Installments") AND
           (CustRec."Invoice Text Installments" <> '') THEN BEGIN
          lvSkipUpdate := FALSE;
          IF CurrFieldNo <> 0 THEN
            IF NOT CONFIRM(Text006,FALSE,FIELDCAPTION("Invoice Text Installments")) THEN
              lvSkipUpdate := TRUE;
          IF NOT lvSkipUpdate THEN  //db, 22-03-10: M18366
            "Invoice Text Installments" := CustRec."Invoice Text Installments";
        END;
      END;
    END;

    PROCEDURE CheckWIP@1100485001();
    VAR
      ServiceLedgerEntry@1100485000 : Record 11012819;
      ServiceOrder@1100485001 : Record 11012823;
    BEGIN
      ServiceLedgerEntry.SETCURRENTKEY("Service Contract No.");
      ServiceLedgerEntry.SETRANGE("Service Contract No.", "No.");
      ServiceLedgerEntry.SETRANGE("Service Order No.", '');
      ServiceLedgerEntry.SETRANGE("Service Contract WIP processed", FALSE);
      IF ServiceLedgerEntry.FINDFIRST THEN
        ServiceLedgerEntry.TESTFIELD("Service Contract WIP processed", TRUE);

      ServiceLedgerEntry.RESET;
      ServiceLedgerEntry.SETCURRENTKEY("Service Order No.");
      //T006898.sn
      ServiceLedgerEntry.SETFILTER("Service Order No.", '<>%1', '');
      ServiceLedgerEntry.SETRANGE("Service Order WIP processed", FALSE);
      IF ServiceLedgerEntry.ISEMPTY THEN
        EXIT;
      //T006898.en
      ServiceOrder.SETCURRENTKEY("Service Contract No.");
      ServiceOrder.SETRANGE("Service Contract No.", "No.");
      IF ServiceOrder.FINDSET THEN BEGIN
        REPEAT
          ServiceLedgerEntry.SETRANGE("Service Order No.", ServiceOrder."No.");
          ServiceLedgerEntry.SETRANGE("Service Order WIP processed", FALSE);
          IF ServiceLedgerEntry.FINDFIRST THEN
            IF ServiceOrder.CheckServTypePosting THEN //T006898.n
              ServiceLedgerEntry.TESTFIELD("Service Order WIP processed", TRUE);
        UNTIL ServiceOrder.NEXT = 0;
      END;
    END;

    PROCEDURE WIPEntriesExists@1100528612() : Boolean;
    VAR
      ServiceLedgerEntry@1100528600 : Record 11012819;
      ServiceOrder@1100529400 : Record 11012823;
    BEGIN
      ServiceLedgerEntry.SETCURRENTKEY("Service Contract No.");
      ServiceLedgerEntry.SETRANGE("Service Contract No.", "No.");
      ServiceLedgerEntry.SETRANGE("Service Order No.", '');
      ServiceLedgerEntry.SETRANGE("Service Contract WIP processed", FALSE);
      IF NOT ServiceLedgerEntry.ISEMPTY THEN
        EXIT(TRUE);

      //T006898 several changes
      ServiceLedgerEntry.SETFILTER("Service Order No.", '<>%1', '');
      ServiceLedgerEntry.SETRANGE("Service Contract WIP processed");
      ServiceLedgerEntry.SETRANGE("Service Order WIP processed", FALSE);
      IF ServiceLedgerEntry.ISEMPTY THEN
        EXIT(FALSE);

      ServiceOrder.SETCURRENTKEY("Service Contract No.");
      ServiceOrder.SETRANGE("Service Contract No.", "No.");
      IF ServiceOrder.FINDSET THEN BEGIN
        REPEAT
          ServiceLedgerEntry.SETRANGE("Service Order No.", ServiceOrder."No.");
          ServiceLedgerEntry.SETRANGE("Service Order WIP processed", FALSE);
          IF ServiceLedgerEntry.FINDFIRST THEN
            IF ServiceOrder.CheckServTypePosting THEN //T006898.n
              EXIT(TRUE);
        UNTIL ServiceOrder.NEXT = 0;
      END;
    END;

    PROCEDURE CheckVATReverse@1100485003(lvFieldValidate@1100485002 : Boolean;lvFieldEntry@1100525000 : Boolean) : Boolean;
    VAR
      VATPostingSetup@1100485000 : Record 325;
      CustRec@1100485001 : Record 18;
    BEGIN
      IF NOT CustRec.GET("Bill-to Customer No. (Contr.)") THEN
        CustRec.INIT;
      IF NOT VATPostingSetup.GET(CustRec."VAT Bus. Posting Group","VAT Prod. Posting Group") THEN
        VATPostingSetup.INIT;
      IF VATPostingSetup."VAT Calculation Type" = VATPostingSetup."VAT Calculation Type"::"Reverse Charge VAT" THEN BEGIN
        IF lvFieldEntry = TRUE THEN EXIT(TRUE);
        IF lvFieldValidate = FALSE THEN BEGIN
          IF NOT CustRec.GET("Bill-to Customer No. (Contr.)") THEN CustRec.INIT;
          "% Labor" := CustRec."% Labor";
          "% to B Account" := CustRec."% to B Account";
        END;
      END ELSE BEGIN
        IF lvFieldEntry = TRUE THEN EXIT(FALSE);
        IF lvFieldValidate = TRUE THEN BEGIN
          TESTFIELD("% Labor", 0);
          TESTFIELD("% to B Account", 0);
        END ELSE BEGIN
          "% Labor" := 0;
          "% to B Account" := 0;
        END;
      END;
    END;

    PROCEDURE CheckAdditonalCostSetup@1100485006();
    BEGIN
      IF ServSetup."Copy Additional Cost Setup" THEN BEGIN
        "Department Code (Other)" := "Global Dimension 1 Code";
        "Service Type (Other)" := "Service Type";
      END;
    END;

    PROCEDURE UpdateServPackage@1100485007();
    VAR
      lvContrDiscRec@1100485000 : Record 11012828;
    BEGIN
      lvContrDiscRec.SETRANGE("Service Contract No.", "No.");
      IF lvContrDiscRec.FINDSET THEN BEGIN
        REPEAT
          IF (lvContrDiscRec."Starting Date Discount" = 0D) OR
             (lvContrDiscRec."Starting Date Discount" = xRec."Starting Date") THEN BEGIN
            lvContrDiscRec."Starting Date Discount" := "Starting Date";
            lvContrDiscRec.MODIFY;
          END;
        UNTIL lvContrDiscRec.NEXT = 0;
      END;
    END;

    PROCEDURE CheckServiceControlYear@1100485012(lvContract@1100485001 : Code[20];lvYear@1100485000 : Integer);
    VAR
      lvServContrRec@1100485002 : Record 11012812;
      lvText000@1100485003 : TextConst 'ENU=Service Control Year %1 not between Start Date (%2) and Ending Date (%3) of Service Contract (%4).;NOR=Servicekontroll†ret %1 ligger ikke mellom Startdato (%2) og Sluttdato (%3) i Servicekontrakten (%4).;SVE=Servicekontroll†ret %1 ligger inte mellan startdatum (%2) och slutdatum (%3) i servicekontraktet (%4).';
      lvStartYear@1100485004 : Integer;
      lvEndYear@1100485005 : Integer;
    BEGIN
      IF NOT lvServContrRec.GET(lvContract) THEN EXIT;

      IF lvServContrRec."Starting Date" <> 0D THEN
        lvStartYear := DATE2DMY(lvServContrRec."Starting Date",3);
      IF lvServContrRec."Ending Date" <> 0D THEN
        lvEndYear := DATE2DMY(lvServContrRec."Ending Date",3);
      IF (lvYear < lvStartYear) OR (lvYear > lvEndYear) THEN
        ERROR(lvText000, lvYear, lvServContrRec."Starting Date", lvServContrRec."Ending Date", lvContract);
    END;

    PROCEDURE CheckContractDiscipline@1100485013(lvServContr@1100485001 : Code[20];lvDisc@1100485002 : Code[20];lvTradeSpec@1100485003 : Code[20]);
    VAR
      lvContrDiscRec@1100485000 : Record 11012881;
    BEGIN
      WITH lvContrDiscRec DO BEGIN
        IF lvDisc <> '' THEN BEGIN
          IF NOT GET(lvServContr, lvDisc, '') THEN BEGIN
            INIT;
            "Service Contract No." := lvServContr;
            Discipline := lvDisc;
            INSERT;
          END;
        END;
        IF lvTradeSpec <> '' THEN BEGIN
          IF NOT GET(lvServContr, lvDisc, lvTradeSpec) THEN BEGIN
            INIT;
            "Service Contract No." := lvServContr;
            Discipline := lvDisc;
            "Trade Speciality" := lvTradeSpec;
            INSERT;
          END;
        END;
      END;
    END;

    PROCEDURE DisplayMap@1100525004();
    BEGIN
      CustRec.GET("Customer No.");
      CustRec.DisplayMap;
    END;

    PROCEDURE LookupServicePackage@1100525011(CalledBy@1100525001 : Integer);
    VAR
      ServPackFrm@1100525000 : Page 11012857;
      ServPackRec@1100525002 : Record 11012806;
      ServPackCode@1100525003 : Code[20];
    BEGIN
      //db, 17-03-10: T4627
      xRec := Rec; //mg, 21-06-11: M27287
      CASE CalledBy OF
        FIELDNO("Service Package Call"):
          BEGIN
            ServPackCode := "Service Package Call";
            ServPackRec.SETRANGE("Source Type", ServPackRec."Source Type"::Call);
          END;
        FIELDNO("Service Package Contract"):
          BEGIN
            ServPackCode := "Service Package Contract";
            ServPackRec.SETRANGE("Source Type", ServPackRec."Source Type"::Contract);
          END;
        FIELDNO("Service Package Other"):
          BEGIN
            ServPackCode := "Service Package Other";
            ServPackRec.SETRANGE("Source Type", ServPackRec."Source Type"::Direct);
          END;
        FIELDNO("Service Package Estimate"):
          BEGIN
            ServPackCode := "Service Package Estimate";
            ServPackRec.SETRANGE("Source Type", ServPackRec."Source Type"::Estimate);
          END;
        FIELDNO("Service Package"):
          BEGIN
            ServPackCode := "Service Package";
            ServPackRec.SETRANGE("Source Type", ServPackRec."Source Type"::None);
          END;
      END;
      ServPackFrm.SETTABLEVIEW(ServPackRec);
      IF ServPackRec.GET(ServPackCode) THEN
        ServPackFrm.SETRECORD(ServPackRec);
      ServPackFrm.SetSelection("No.");
      ServPackFrm.LOOKUPMODE(TRUE);
      IF ServPackFrm.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ServPackFrm.GETRECORD(ServPackRec);
        CASE CalledBy OF
           FIELDNO("Service Package Call"): VALIDATE("Service Package Call", ServPackRec.Code);
           FIELDNO("Service Package Contract"): VALIDATE("Service Package Contract", ServPackRec.Code);
           FIELDNO("Service Package Other"): VALIDATE("Service Package Other", ServPackRec.Code);
           FIELDNO("Service Package Estimate"): VALIDATE("Service Package Estimate", ServPackRec.Code);
           FIELDNO("Service Package"): VALIDATE("Service Package", ServPackRec.Code);
        END;
      END;
    END;

    PROCEDURE DPA_SetDefaultDpmtFromNoSeries@1100000995(xRecRef@1100525002 : RecordRef);
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      xRecRef.SETTABLE(xRec);
      DPA_Management.SetDepartmentCodeNoSeries(
        TABLENAME,
        "Global Dimension 1 Code",
        "No. Series",
        xRec."No. Series" );
    END;

    LOCAL PROCEDURE DPA_OnInsert@1100000991();
    VAR
      Dimension1Code@1100528400 : Code[20];
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      Dimension1Code :=
        DPA_Management.GetNoSeriesDepartmentCode(
          "No. Series",
          xRec."No. Series",
          DATABASE::"Service-Contract");
      IF Dimension1Code <> '' THEN
        "Global Dimension 1 Code" := Dimension1Code;

      IF "Global Dimension 1 Code" <> '' THEN
        VALIDATE("Global Dimension 1 Code");
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(11012812) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 11012812');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Service-Contract", "Global Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Global Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Global Dimension 1 Code");
    END;

    PROCEDURE GetTryOut@1210190005(iAction@1210190000 : Integer) Result : Text[30];
    VAR
      TryOutRelationRec@1210190001 : Record 11012761;
    BEGIN
      //db, 05-05-11
      IF FPSLicenseManagement.LicenseAndReadPermissionForTable(TryOutRelationRec) THEN
        Result := TryOutRelationRec.GetTryOut('', '', '', "No.", '', '', '', '', iAction);

      EXIT(Result);
    END;

    PROCEDURE ShowTryOut@1210190003(iAction@1210190000 : Integer);
    VAR
      TryOutRelationRec@1210190001 : Record 11012761;
    BEGIN
      //db, 05-05-11
      TryOutRelationRec.ShowTryOut('', '', '', "No.", '', '', '', '', iAction);
    END;

    PROCEDURE ShowFeatures@1210190007();
    VAR
      ContFeatureType@1100485000 : Record 11012753;
    BEGIN
      TESTFIELD("No.");
      ContFeatureType."Relation Type" := ContFeatureType."Relation Type"::ServiceContract;
      ContFeatureType.Code := "No.";
      ContFeatureType.SETRANGE("Relation Type", ContFeatureType."Relation Type"::ServiceContract);
      ContFeatureType.SETRANGE(Code, "No.");
      PAGE.RUNMODAL(PAGE::"Contact Feature Type", ContFeatureType);
    END;

    PROCEDURE UseServiceContractTemplate@1100528600();
    VAR
      ServiceContractTemplate@1100528600 : Record 11071754;
    BEGIN
      IF NOT ServiceContractTemplate.ISEMPTY THEN
        IF CONFIRM(Text108, TRUE) THEN
          IF PAGE.RUNMODAL(0, ServiceContractTemplate) = ACTION::LookupOK THEN
            VALIDATE("Contract Template Code", ServiceContractTemplate.Code);
    END;

    PROCEDURE CreateControlPeriod@1100528601();
    VAR
      ServiceContractCtrlPeriod@1100528600 : Record 11071746;
      ControlReferenceDate@1100529600 : Date;
    BEGIN
      IF SkipCreateControlPeriod THEN
        EXIT;
      ServiceContractCtrlPeriod.SETRANGE("Service Contract No.", "No.");
      IF ("Starting Date Control Period" = 0D) OR (FORMAT("Control Period Interval") = '') THEN
        IF ServiceContractCtrlPeriod.ISEMPTY THEN
          EXIT;

      IF NOT ServiceContractCtrlPeriod.ISEMPTY THEN
        IF CONFIRM(Text109, TRUE) THEN BEGIN
          ServiceContractCtrlPeriod.SETRANGE("Date Finished", 0D);
          ServiceContractCtrlPeriod.DELETEALL(TRUE)
        END ELSE
          EXIT;

      MODIFY;

      ControlReferenceDate := "Control Reference Date";
      IF ("Ending Date" <> 0D) AND ((ControlReferenceDate = 0D) OR (ControlReferenceDate > "Ending Date")) THEN
        ControlReferenceDate := "Ending Date";
      ServiceContractCtrlPeriod.UpdateControlPeriodsNumber("No.", WORKDATE, ControlReferenceDate);
    END;

    PROCEDURE CheckStartDateInvoice@1210190008();
    VAR
      InstallmentRec@1210190001 : Record 11012017;
      NumInst@1210190000 : Integer;
      DateFormulaDF@1210190002 : DateFormula;
      StartDate@1210190003 : Date;
      EndDate@1210190004 : Date;
    BEGIN
      //db, 05-12-11: M31340
      TESTFIELD("Installment Scheme");  //db, 18-01-12: M31878
      InstallmentRec.SETRANGE(Scheme, "Installment Scheme");
      NumInst := InstallmentRec.COUNT;

      CASE NumInst OF
        0 :DateFormulaDF := "Contract Duration";  //db, 18-01-12: M31878
        1 :EVALUATE(DateFormulaDF,'<+12M>');
        2 :EVALUATE(DateFormulaDF,'<+6M>');
        3 :EVALUATE(DateFormulaDF,'<+4M>');
        4 :EVALUATE(DateFormulaDF,'<+3M>');
        6 :EVALUATE(DateFormulaDF,'<+2M>');
        12:EVALUATE(DateFormulaDF,'<+1M>');
        NumInst:EVALUATE(DateFormulaDF,STRSUBSTNO('<+%1D>',ROUND(365/NumInst,1)));
      END;

      IF "Renewal Date" <> 0D THEN
        StartDate := "Renewal Date"
      ELSE
        StartDate := "Starting Date";
      EndDate := CALCDATE(DateFormulaDF, StartDate);
      IF ("Starting Date Invoice" < StartDate) OR  ("Starting Date Invoice" > EndDate) THEN
        ERROR(Text004b, FIELDCAPTION("Starting Date Invoice"), StartDate, EndDate);
    END;

    PROCEDURE CopySCSourceTypeSetup@1100528602();
    VAR
      FromSCCustSourceTypeSetup@1100528600 : Record 11071800;
      ToSCCustSourceTypeSetup@1100528601 : Record 11071800;
    BEGIN
      IF "Contract Template Code" = '' THEN
        EXIT;

      FromSCCustSourceTypeSetup.SETRANGE(Type, FromSCCustSourceTypeSetup.Type::"Contract Template");
      FromSCCustSourceTypeSetup.SETRANGE(Code, "Contract Template Code");
      IF FromSCCustSourceTypeSetup.FINDSET THEN
        REPEAT
          ToSCCustSourceTypeSetup := FromSCCustSourceTypeSetup;
          ToSCCustSourceTypeSetup.Type := ToSCCustSourceTypeSetup.Type::Contract;
          ToSCCustSourceTypeSetup.Code := "No.";
          ToSCCustSourceTypeSetup.INSERT(TRUE);
        UNTIL FromSCCustSourceTypeSetup.NEXT = 0;
    END;

    PROCEDURE EditDocuments@1100528702(ContactNo@1210190003 : Code[20];ContactPersonNo@1210190004 : Code[20];SendMail@1210190002 : Boolean;Recipient@1100528700 : Text[120]);
    VAR
      DocumentTemplate@1210190001 : Record 11012401;
      DocumentMailing@1210190000 : Codeunit 11012278;
      RecRef@1100525000 : RecordRef;
      DocumentLinkRIDs@1100525001 : ARRAY [5] OF RecordID;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentLinkRIDs[1] := RecRef.RECORDID;

      DocumentMailing.EditDocuments(
        STRSUBSTNO('%1', DocumentTemplate.Type::"Service Contract"), DocumentLinkRIDs,
        "Global Dimension 1 Code", ContactNo, ContactPersonNo, SendMail, Recipient);
    END;

    LOCAL PROCEDURE UpdateEndingDateSCObjects@1100528603();
    VAR
      ContractObject@1100528600 : Record 11071702;
    BEGIN
      ContractObject.SETRANGE("Service Contract No.", "No.");
      IF "Ending Date" > 0D THEN
        ContractObject.SETFILTER("Ending Date", '%1|%2|>%3', 0D, xRec."Ending Date", "Ending Date")
      ELSE
        ContractObject.SETFILTER("Ending Date", '%1|%2', 0D, xRec."Ending Date");
      IF ContractObject.FINDSET(TRUE) THEN BEGIN
        MODIFY;
        REPEAT
          ContractObject.VALIDATE("Ending Date", "Ending Date");
          ContractObject.MODIFY(TRUE);
        UNTIL ContractObject.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE UpdateEndingDateInstallments@1100525005();
    VAR
      ContractInstallment@1100525000 : Record 11071707;
    BEGIN
      ContractInstallment.SETRANGE("Service Contract No.", "No.");
      IF "Ending Date" > 0D THEN
        ContractInstallment.SETFILTER("Ending Date", '%1|%2|>%3', 0D, xRec."Ending Date", "Ending Date")
      ELSE
        ContractInstallment.SETFILTER("Ending Date", '%1|%2', 0D, xRec."Ending Date");
      IF ContractInstallment.FINDSET(TRUE) THEN BEGIN
        MODIFY;
        REPEAT
         ContractInstallment.VALIDATE("Ending Date", "Ending Date");
         ContractInstallment.MODIFY(TRUE);
        UNTIL ContractInstallment.NEXT = 0;
      END;
    END;

    PROCEDURE ShowSCInvoices@1210190009();
    VAR
      SalesInvoiceLine@1210190000 : Record 113;
      SalesInvoiceHeader@1210190001 : Record 112;
    BEGIN
      SalesInvoiceLine.SETCURRENTKEY("Service Contract No.", "Service Order No.");
      SalesInvoiceLine.SETRANGE("Service Contract No.", "No.");
      SalesInvoiceLine.SETFILTER("Service Order No.", '%1', '');
      IF SalesInvoiceLine.FINDSET THEN
        REPEAT
          IF SalesInvoiceHeader.GET(SalesInvoiceLine."Document No.") THEN
            SalesInvoiceHeader.MARK(TRUE);
        UNTIL SalesInvoiceLine.NEXT = 0;

      SalesInvoiceHeader.MARKEDONLY(TRUE);

      PAGE.RUNMODAL(PAGE::"Posted Sales Invoices", SalesInvoiceHeader);
    END;

    PROCEDURE ShowSCCreditMemos@1210190010();
    VAR
      SalesCrMemoLine@1210190000 : Record 115;
      SalesCrMemoHeader@1210190001 : Record 114;
    BEGIN
      SalesCrMemoLine.SETCURRENTKEY("Service Contract No.", "Service Order No.");
      SalesCrMemoLine.SETRANGE("Service Contract No.", "No.");
      SalesCrMemoLine.SETFILTER("Service Order No.", '%1', '');
      IF SalesCrMemoLine.FINDSET THEN
        REPEAT
          IF SalesCrMemoHeader.GET(SalesCrMemoLine."Document No.") THEN
            SalesCrMemoHeader.MARK(TRUE);
        UNTIL SalesCrMemoLine.NEXT = 0;

      SalesCrMemoHeader.MARKEDONLY(TRUE);

      PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memos", SalesCrMemoHeader);
    END;

    PROCEDURE ShowTodos@1100528700();
    VAR
      Todo@1100528700 : Record 5080;
    BEGIN
      Todo.SETRANGE("Service Contract No.", "No.");
      Todo.SETRANGE("System To-do Type", Todo."System To-do Type"::Organizer);
      PAGE.RUNMODAL(PAGE::"Task List", Todo);
    END;

    PROCEDURE DetermineCurrencyCode@1100528800() : Code[10];
    VAR
      Customer@1100485000 : Record 18;
    BEGIN
      // dp00116.n
      IF Customer.GET("Customer No.") THEN
        EXIT(Customer."Currency Code");
    END;

    PROCEDURE ContractAmountsExist@3() : Boolean;
    VAR
      ContractAmountsByDate@1100528800 : Record 11071708;
    BEGIN
      // dp00116.n
      ContractAmountsByDate.SETCURRENTKEY("Service Contract No.");
      ContractAmountsByDate.SETRANGE(ContractAmountsByDate."Service Contract No.","No.");
      EXIT(ContractAmountsByDate.FINDFIRST);
    END;

    PROCEDURE RecreateContractAmountsByDate@1100528801();
    VAR
      ContractAmountsByDate@1100528802 : Record 11071708;
      Confirmed@1100409000 : Boolean;
    BEGIN
      // dp00116.n
      IF ContractAmountsExist THEN BEGIN
        IF (NOT GUIALLOWED) THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            CONFIRM(Text110, FALSE);
        IF Confirmed THEN BEGIN
          ContractAmountsByDate.SETCURRENTKEY("Service Contract No.");
          ContractAmountsByDate.SETRANGE(ContractAmountsByDate."Service Contract No.","No.");
          IF ContractAmountsByDate.FINDSET THEN BEGIN
            REPEAT
              //ContractAmountsByDate.CALCFIELDS("Currency Code");
              ContractAmountsByDate.Amount := CalcContractAmountsFromLCY(ContractAmountsByDate."Amount (LCY)",
                ContractAmountsByDate."Index Date");
              ContractAmountsByDate.MODIFY;
            UNTIL ContractAmountsByDate.NEXT = 0;
          END;
        END;
      END;
    END;

    PROCEDURE CalcContractAmountsFromLCY@1100528802(ContractAmountLCY@1100528803 : Decimal;IndexDate@1100528804 : Date) ContractAmount : Decimal;
    VAR
      CurrencyDate@1100528802 : Date;
      CurrencyExchangeRate@1100528801 : Record 330;
      Currency2@1100528800 : Record 4;
    BEGIN
      // dp00116.n
      Currency2.InitRoundingPrecision;
      IF "Currency Code" <> '' THEN BEGIN
        CurrencyDate := IndexDate;
        ContractAmount :=
        ROUND(
          CurrencyExchangeRate.ExchangeAmtLCYToFCY(
            0, '', CurrencyDate, "Currency Code", ContractAmountLCY,
             CurrencyExchangeRate.ExchangeRate(0, '', CurrencyDate, "Currency Code",TRUE),TRUE),
             Currency2."Amount Rounding Precision");
      END ELSE BEGIN
        ContractAmount := ROUND(ContractAmountLCY,Currency2."Amount Rounding Precision");
      END;
    END;

    PROCEDURE CheckAndResetInstallmBasedOn@1100528300();
    BEGIN
      IF ("Invoice Period" <> "Invoice Period"::Afterwards) OR
         ("Invoice Type" <> "Invoice Type"::Installments)
      THEN
        "Installments based on Progress" := FALSE;
    END;

    PROCEDURE CheckAndResetContractInstallm@1100528301();
    VAR
      ContractInstallment@1100528300 : Record 11071707;
    BEGIN
      ContractInstallment.SETRANGE("Service Contract No.", "No.");
      IF (NOT ContractInstallment.FINDSET) THEN
        EXIT;

      REPEAT
        IF ("Installments based on Progress") THEN BEGIN
          CLEAR(ContractInstallment."Invoice Interval");
        END ELSE BEGIN
          ContractInstallment."Progress %" := 0;
          ContractInstallment."Invoice Directly" := FALSE;
        END;
        ContractInstallment.MODIFY(TRUE);
      UNTIL (ContractInstallment.NEXT = 0);
    END;

    PROCEDURE GetPercentageShareCalls@1100528619(IIndexDate@1100528600 : Date) : Decimal;
    VAR
      PercentageShareCallsbyDate@1100528601 : Record 11071815;
    BEGIN
      PercentageShareCallsbyDate.SETRANGE("Service Contract No.", "No.");
      PercentageShareCallsbyDate.SETFILTER("Index Date", '<=%1', IIndexDate);
      IF PercentageShareCallsbyDate.FINDLAST THEN
        EXIT(PercentageShareCallsbyDate."Percentage Share");
    END;

    PROCEDURE ShowPercentageShareCalls@1100528621();
    VAR
      PercentageShareCallsbyDate@1100528600 : Record 11071815;
    BEGIN
      PercentageShareCallsbyDate.SETRANGE("Service Contract No.", "No.");
      PAGE.RUNMODAL(0, PercentageShareCallsbyDate);
    END;

    PROCEDURE CopyCustomerNotGlobalDims@1100525006();
    VAR
      GLSetup@1210190002 : Record 98;
      DefDimCust@1210190000 : Record 352;
      DefDimServContr@1210190001 : Record 352;
    BEGIN
      //*24651.n
      IF "Customer No." = '' THEN
        EXIT;
      GLSetup.GET;

      DefDimCust.SETRANGE("Table ID", DATABASE::Customer);
      DefDimCust.SETRANGE("No.", "Customer No.");
      DefDimCust.SETFILTER("Dimension Code", '<>%1&<>%2', GLSetup."Global Dimension 1 Code", GLSetup."Global Dimension 2 Code");
      IF DefDimCust.FINDSET THEN BEGIN
        REPEAT
          IF NOT DefDimServContr.GET(DATABASE::"Service-Contract", "No.", DefDimCust."Dimension Code") THEN BEGIN
            DefDimServContr := DefDimCust;
            DefDimServContr."Table ID" := DATABASE::"Service-Contract";
            DefDimServContr."No." := "No.";
            DefDimServContr.INSERT;
          END ELSE BEGIN
            IF DefDimServContr."Dimension Value Code" <> DefDimCust."Dimension Value Code" THEN BEGIN
              DefDimServContr."Dimension Value Code" := DefDimCust."Dimension Value Code";
              DefDimServContr."Value Posting" := DefDimCust."Value Posting";
              DefDimServContr.MODIFY;
            END;
          END;
        UNTIL DefDimCust.NEXT = 0;
      END;
    END;

    PROCEDURE CopySCBudgetCallsRelease@1100409000();
    VAR
      SCBudgetCallsRelease@1100409000 : Record 11071699;
      ToSCBudgetCallsRelease@1100409001 : Record 11071699;
    BEGIN
      IF "Contract Group" = '' THEN
        EXIT;
      IF NOT ("Budget Based on" IN
        ["Budget Based on"::"Maintenance Scheme", "Budget Based on"::"Category + Maintenance Scheme"])
      THEN
        EXIT;
      ToSCBudgetCallsRelease.SETRANGE(Type, SCBudgetCallsRelease.Type::Contract);
      ToSCBudgetCallsRelease.SETRANGE(Code, "No.");
      ToSCBudgetCallsRelease.DELETEALL(TRUE);

      SCBudgetCallsRelease.SETRANGE(Type, SCBudgetCallsRelease.Type::"Contract Group");
      SCBudgetCallsRelease.SETRANGE(Code, "Contract Group");
      IF SCBudgetCallsRelease.FINDSET THEN
        REPEAT
          ToSCBudgetCallsRelease := SCBudgetCallsRelease;
          ToSCBudgetCallsRelease.Type := ToSCBudgetCallsRelease.Type::Contract;
          ToSCBudgetCallsRelease.Code := "No.";
          ToSCBudgetCallsRelease.INSERT(TRUE);
        UNTIL SCBudgetCallsRelease.NEXT = 0;
    END;

    PROCEDURE AddServicePackageDiscountToContract@1100527400(IServiceContractNo@1100527402 : Code[20];IServicePackage@1100527403 : Code[10]);
    VAR
      ServicePackage@1100527401 : Record 11012806;
    BEGIN
      IF IServicePackage <> '' THEN BEGIN
        IF NOT GET(IServiceContractNo) THEN
          INIT;
        IF ServicePackage.GET(IServicePackage) THEN BEGIN
          IF NOT ContractDiscountExists(ServicePackage.Code) THEN
            AddContractDiscount(ServicePackage.Code);
          IF (ServicePackage."Service Package Contract" <> '') THEN
            IF NOT ContractDiscountExists(ServicePackage."Service Package Contract") THEN
              AddContractDiscount(ServicePackage."Service Package Contract");
          IF (ServicePackage."Service Package Call" <> '') THEN
            IF NOT ContractDiscountExists(ServicePackage."Service Package Call") THEN
              AddContractDiscount(ServicePackage."Service Package Call");
          IF (ServicePackage."Service Package Direct" <> '') THEN
            IF NOT ContractDiscountExists(ServicePackage."Service Package Direct") THEN
              AddContractDiscount(ServicePackage."Service Package Direct");
          IF (ServicePackage."Service Package Estimate" <> '') THEN
            IF NOT ContractDiscountExists(ServicePackage."Service Package Estimate") THEN
              AddContractDiscount(ServicePackage."Service Package Estimate");
        END;
      END;
    END;

    PROCEDURE AddContractDiscount@1100409003(IServicePackage@1100409000 : Code[10]);
    VAR
      ServiceContractDiscountTerm@1100409002 : Record 11012828;
      ServiceContractDiscountTerm2@1100409001 : Record 11012828;
    BEGIN
      ServiceContractDiscountTerm.SETRANGE("Service Contract No.", '');
      ServiceContractDiscountTerm.SETRANGE("Service Package", IServicePackage);
      IF ServiceContractDiscountTerm.FINDSET THEN
        REPEAT
          ServiceContractDiscountTerm2.COPY(ServiceContractDiscountTerm);
          ServiceContractDiscountTerm2."Service Contract No." := "No.";
          ServiceContractDiscountTerm2."Starting Date Discount" := "Starting Date";
          IF ServiceContractDiscountTerm2.INSERT THEN;
        UNTIL ServiceContractDiscountTerm.NEXT = 0;
    END;

    PROCEDURE ContractDiscountExists@1100527401(IServicePackage@1100527400 : Code[10]) : Boolean;
    VAR
      ServiceContractDiscountTerm@1100527401 : Record 11012828;
    BEGIN
      ServiceContractDiscountTerm.SETRANGE("Service Contract No.", "No.");
      ServiceContractDiscountTerm.SETRANGE("Service Package", IServicePackage);
      EXIT(NOT ServiceContractDiscountTerm.ISEMPTY);
    END;

    PROCEDURE RemoveUnusedContractDiscountTerms@1100528604(IServiceObjectNo@1100528604 : Code[20];IServiceMaintAgreementLineNo@1100528607 : Integer;ICurrentServicePackageCode@1100528700 : Code[10];IServiceLocationNo@1100527402 : Code[20]);
    VAR
      ServiceContractDiscountTerm@1100528600 : Record 11012828;
      ServicePackage@1100528603 : Record 11012806;
      TmpServicePackage@1100528601 : TEMPORARY Record 11012806;
      ContractObject@1100528602 : Record 11071702;
      ServiceMaintAgreement@1100528606 : Record 11071973;
      ServiceContractLocation@1100527400 : Record 11072554;
      ServiceContractLocDetail@1100527401 : Record 11072556;
    BEGIN
      ContractObject.SETRANGE("Service Contract No.", "No.");
      ContractObject.SETFILTER("Service Object No.", '<>%1', IServiceObjectNo);
      IF ContractObject.FINDSET THEN
        REPEAT
          IF ServicePackage.GET(ContractObject."Service Package") THEN
            AddServicePackageToTempTable(ServicePackage.Code, TmpServicePackage);
        UNTIL ContractObject.NEXT = 0;

      ServiceMaintAgreement.SETRANGE(Type, ServiceMaintAgreement.Type::Contract);
      ServiceMaintAgreement.SETRANGE(Code, "No.");
      ServiceMaintAgreement.SETFILTER("Line No.", '<>%1', IServiceMaintAgreementLineNo);
      IF ServiceMaintAgreement.FINDSET THEN
        REPEAT
          IF ServicePackage.GET(ServiceMaintAgreement."Service Package") THEN
            AddServicePackageToTempTable(ServicePackage.Code, TmpServicePackage);
        UNTIL ServiceMaintAgreement.NEXT = 0;

      ServiceContractLocation.SETRANGE("Service Contract No.", "No.");
      ServiceContractLocation.SETFILTER("Service Location No.", '<>%1', IServiceLocationNo);
      IF ServiceContractLocation.FINDSET THEN
        REPEAT
          IF ServicePackage.GET(ServiceContractLocation."Service Package") THEN
            AddServicePackageToTempTable(ServicePackage.Code, TmpServicePackage);
        UNTIL ServiceContractLocation.NEXT = 0;

      ServiceContractLocDetail.SETRANGE("Service Contract No.", "No.");
      ServiceContractLocDetail.SETFILTER("Service Location No.", '<>%1', IServiceLocationNo);
      IF ServiceContractLocDetail.FINDSET THEN
        REPEAT
          IF ServicePackage.GET(ServiceContractLocDetail."Service Package") THEN
            AddServicePackageToTempTable(ServicePackage.Code, TmpServicePackage);
        UNTIL ServiceContractLocDetail.NEXT = 0;

      IF ICurrentServicePackageCode <> '' THEN
        AddServicePackageToTempTable(ICurrentServicePackageCode, TmpServicePackage);

      ServiceContractDiscountTerm.SETRANGE("Service Contract No.", "No.");
      IF ServiceContractDiscountTerm.FINDSET(TRUE, TRUE) THEN
        REPEAT
          IF NOT TmpServicePackage.GET(ServiceContractDiscountTerm."Service Package") THEN
            ServiceContractDiscountTerm.DELETE(TRUE);
        UNTIL ServiceContractDiscountTerm.NEXT = 0;
    END;

    LOCAL PROCEDURE AddServicePackageToTempTable@1100528701(ServicePackageCode@1100528700 : Code[10];VAR TmpServicePackage@1100528701 : TEMPORARY Record 11012806);
    VAR
      ServicePackage@1100528702 : Record 11012806;
    BEGIN
      IF NOT ServicePackage.GET(ServicePackageCode) THEN
        EXIT;

      IF NOT TmpServicePackage.GET(ServicePackage.Code) THEN BEGIN
        TmpServicePackage.Code := ServicePackage.Code;
        TmpServicePackage.INSERT;
      END;
      IF ServicePackage."Service Package Contract" <> '' THEN
        IF NOT TmpServicePackage.GET(ServicePackage."Service Package Contract") THEN BEGIN
          TmpServicePackage.Code := ServicePackage."Service Package Contract";
          TmpServicePackage.INSERT;
        END;
      IF ServicePackage."Service Package Call" <> '' THEN
        IF NOT TmpServicePackage.GET(ServicePackage."Service Package Call") THEN BEGIN
          TmpServicePackage.Code := ServicePackage."Service Package Call";
          TmpServicePackage.INSERT;
        END;
      IF ServicePackage."Service Package Direct" <> '' THEN
        IF NOT TmpServicePackage.GET(ServicePackage."Service Package Direct") THEN BEGIN
          TmpServicePackage.Code := ServicePackage."Service Package Direct";
          TmpServicePackage.INSERT;
        END;
      IF ServicePackage."Service Package Estimate" <> '' THEN
        IF NOT TmpServicePackage.GET(ServicePackage."Service Package Estimate") THEN BEGIN
          TmpServicePackage.Code := ServicePackage."Service Package Estimate";
          TmpServicePackage.INSERT;
        END;
    END;

    PROCEDURE ValidateServiceCluster@1100528606();
    VAR
      ServiceCluster@1100528600 : Record 11071742;
    BEGIN
      IF Cluster <> '' THEN BEGIN
        IF "Use Contract Clusters" THEN
          ServiceCluster.GET(ServiceCluster.Type::Contract, "No.", ServiceCluster."Source Type"::" ", Cluster)
        ELSE
          ServiceCluster.GET(ServiceCluster.Type::" ", '', ServiceCluster."Source Type"::" ", Cluster);
      END;
    END;

    PROCEDURE LookupServiceCluster@1100528605();
    VAR
      ServiceCluster@1100528601 : Record 11071742;
    BEGIN
      IF "Use Contract Clusters" THEN BEGIN
        ServiceCluster.SETRANGE(Type, ServiceCluster.Type::Contract);
        ServiceCluster.SETRANGE("Type Code", "No.");
        ServiceCluster.SETRANGE("Source Type", ServiceCluster."Source Type"::" ");
        IF Cluster <> '' THEN
          ServiceCluster.GET(ServiceCluster.Type::Contract, "No.", ServiceCluster."Source Type"::" ", Cluster);
      END ELSE BEGIN
        ServiceCluster.SETRANGE(Type, ServiceCluster.Type::" ");
        ServiceCluster.SETRANGE("Type Code", '');
        ServiceCluster.SETRANGE("Source Type", ServiceCluster."Source Type"::" ");
        IF Cluster <> '' THEN
          ServiceCluster.GET(ServiceCluster.Type::" ", '', ServiceCluster."Source Type"::" ", Cluster);
      END;
      IF PAGE.RUNMODAL(0, ServiceCluster) = ACTION::LookupOK THEN
        VALIDATE(Cluster, ServiceCluster.Code);
    END;

    PROCEDURE CheckObjectPartOfContract@1100525000(IServiceObjectNo@1210190001 : Code[20];IReferenceDate@1210190003 : Date);
    VAR
      ContractObject@1210190002 : Record 11071702;
    BEGIN
      IF IServiceObjectNo = '' THEN
        EXIT;

      IF NOT ContractObject.GET("No.", IServiceObjectNo) THEN
        ERROR(Text117, IServiceObjectNo, "No.");

      IF (ContractObject."Starting Date" > IReferenceDate) OR
        ((ContractObject."Ending Date" > 0D) AND (ContractObject."Ending Date" < IReferenceDate)) THEN
        ERROR(Text118, IServiceObjectNo, "No.");
    END;

    PROCEDURE TestObjectBelongtoContract@1100525007(IServiceObjectNo@1100525000 : Code[20];IReferenceDate@1100525002 : Date) : Boolean;
    VAR
      ContractObject@1100525001 : Record 11071702;
    BEGIN
      IF IServiceObjectNo = '' THEN
        EXIT;

      IF "No." <> '' THEN BEGIN
        IF NOT ContractObject.GET("No.", IServiceObjectNo) THEN
          ERROR(Text117, IServiceObjectNo, "No.");

        IF (ContractObject."Starting Date" > IReferenceDate) OR
          ((ContractObject."Ending Date" > 0D) AND (ContractObject."Ending Date" < IReferenceDate)) THEN
          ERROR(Text118, IServiceObjectNo, "No.");
      END;
    END;

    PROCEDURE GetTravelCostWithIndexDate@1100528608(IIndexDate@1100528601 : Date) : Decimal;
    VAR
      TravelCostRate@1100528600 : Record 11071802;
    BEGIN
      IF "Travel Cost Code" <> '' THEN BEGIN
        TravelCostRate.SETRANGE("Travel Cost Code", "Travel Cost Code");
        TravelCostRate.SETFILTER("Index Date", '<=%1', IIndexDate);
        IF TravelCostRate.FINDLAST THEN
          EXIT(TravelCostRate.Rate);
      END;
    END;

    PROCEDURE GetTravelCost@1100528607() : Decimal;
    BEGIN
      EXIT(GetTravelCostWithIndexDate(TODAY));
    END;

    PROCEDURE CheckServiceAuthorization@1100485028(FieldCap@1100485000 : Text[100]);
    VAR
      ServiceSetup@1100528600 : Record 11012800;
      UserSetup@1100528601 : Record 91;
    BEGIN
      IF "No." = '' THEN EXIT;
      IF CurrFieldNo = 0 THEN EXIT;

      ServiceSetup.GET;
      IF NOT ServiceSetup."Service Authorization" THEN
        EXIT;

      IF CheckCostsAndRevenuesZero THEN
        EXIT;

      //Check now if user is authorized for changes
      IF UserSetup.GET(USERID) THEN
        IF UserSetup."Service Authorization Active" THEN
          EXIT;

      ERROR(Text119, FieldCap, USERID);
    END;

    PROCEDURE CheckCostsAndRevenuesZero@1100485031() : Boolean;
    BEGIN
      CALCFIELDS(Revenues);
      IF Revenues <> 0  THEN
        EXIT(FALSE);
      CALCFIELDS("Actual Costs");
      EXIT("Actual Costs" = 0);
    END;

    PROCEDURE GetCategoryDivisionPercentage@1100528609(IServiceCategory@1100528601 : Code[10];ISeekDate@1100528603 : Date) : Decimal;
    VAR
      SCRevenueDivision@1100528602 : Record 11071986;
      SCRevenueDivisionLine@1100528600 : Record 11071987;
      ServiceCategory@1100528604 : Record 11071985;
    BEGIN
      IF IServiceCategory = '' THEN BEGIN
        IF CheckOtherServiceCategories THEN BEGIN
          ServiceCategory.SETRANGE("Service Contract No.", "No.");
          IF ServiceCategory.ISEMPTY THEN
            EXIT(100);
          EXIT(0);
        END;
        EXIT(100);
      END;

      SCRevenueDivision.SETRANGE("Service Contract No.", "No.");
      SCRevenueDivision.SETFILTER("Index Date", '<=%1', ISeekDate);
      IF NOT SCRevenueDivision.FINDLAST THEN BEGIN
        ServiceCategory.SETRANGE("Service Contract No.", "No.");
        IF ServiceCategory.ISEMPTY THEN
          EXIT(100)
        ELSE
          EXIT(100 / ServiceCategory.COUNT);
      END;
      SCRevenueDivisionLine.SETRANGE("Service Contract No.", SCRevenueDivision."Service Contract No.");
      SCRevenueDivisionLine.SETRANGE("Index Date", SCRevenueDivision."Index Date");
      SCRevenueDivisionLine.SETRANGE("Service Category", IServiceCategory);
      IF SCRevenueDivisionLine.FINDFIRST THEN
        EXIT(SCRevenueDivisionLine.Percentage);
    END;

    PROCEDURE GetCategoryDivisionPercentageShareCalls@1100528613(IServiceCategory@1100528601 : Code[10];ISeekDate@1100528600 : Date) : Decimal;
    VAR
      SCRevenueDivision@1100528604 : Record 11071986;
      SCRevenueDivisionLine@1100528603 : Record 11071987;
    BEGIN
      IF IServiceCategory = '' THEN
        EXIT(0);
      SCRevenueDivision.SETRANGE("Service Contract No.", "No.");
      SCRevenueDivision.SETFILTER("Index Date", '<=%1', ISeekDate);
      IF NOT SCRevenueDivision.FINDLAST THEN
        EXIT(0);
      SCRevenueDivisionLine.SETRANGE("Service Contract No.", SCRevenueDivision."Service Contract No.");
      SCRevenueDivisionLine.SETRANGE("Index Date", SCRevenueDivision."Index Date");
      SCRevenueDivisionLine.SETRANGE("Service Category", IServiceCategory);
      IF SCRevenueDivisionLine.FINDFIRST THEN
        EXIT(SCRevenueDivisionLine."Percentage Share Calls");
    END;

    PROCEDURE CopySCTemplateCategories@1100528610();
    VAR
      ServiceCategoryTemplate@1100528600 : Record 11071997;
      ServiceCategory@1100528601 : Record 11071985;
    BEGIN
      IF "Contract Template Code" = '' THEN
        EXIT;
      ServiceCategoryTemplate.SETRANGE("Service Contract Template Code", "Contract Template Code");
      IF ServiceCategoryTemplate.FINDSET THEN
        REPEAT
          ServiceCategory.INIT;
          ServiceCategory.SetNewServiceContract(Rec);
          ServiceCategory."Service Contract No." := "No.";
          ServiceCategory.Code := ServiceCategoryTemplate.Code;
          ServiceCategory.Description := ServiceCategoryTemplate.Description;
          ServiceCategory."Calc. Progress Perc. Progn/Res" := ServiceCategoryTemplate."Calc. Progress Perc. Progn/Res";
          IF ServiceCategory."Service Type" <> ServiceCategoryTemplate."Service Type" THEN
            ServiceCategory.VALIDATE("Service Type", ServiceCategoryTemplate."Service Type");
          IF ServiceCategory."Service Type (Other)" <> ServiceCategoryTemplate."Service Type (Other)" THEN
            ServiceCategory.VALIDATE("Service Type (Other)", ServiceCategoryTemplate."Service Type (Other)");
          ServiceCategory.VALIDATE("Rest of Contract", ServiceCategoryTemplate."Rest of Contract");
          ServiceCategory.VALIDATE("Calc. Interim Results by Order", ServiceCategoryTemplate."Calc. Interim Results by Order");
          ServiceCategory."Exclude SOs From Est. Result" := ServiceCategoryTemplate."Exclude SOs From Est. Result";
          ServiceCategory.INSERT(TRUE);
        UNTIL ServiceCategoryTemplate.NEXT = 0;
    END;

    LOCAL PROCEDURE CopySCTemplateClusters@1100528614();
    VAR
      TemplateServiceCluster@1100528600 : Record 11071742;
      ServiceCluster@1100528601 : Record 11071742;
    BEGIN
      IF "Contract Template Code" = '' THEN
        EXIT;
      TemplateServiceCluster.SETRANGE(Type, TemplateServiceCluster.Type::Template);
      TemplateServiceCluster.SETRANGE("Type Code", "Contract Template Code");
      TemplateServiceCluster.SETRANGE("Source Type", TemplateServiceCluster."Source Type"::" ");
      IF TemplateServiceCluster.FINDSET THEN
        REPEAT
          ServiceCluster := TemplateServiceCluster;
          ServiceCluster.Type := ServiceCluster.Type::Contract;
          ServiceCluster."Type Code" := "No.";
          ServiceCluster.INSERT(TRUE);
        UNTIL TemplateServiceCluster.NEXT = 0;
    END;

    LOCAL PROCEDURE CopySCTemplateSalesDiscount@1100525002();
    VAR
      ServiceSalesDiscSurch@1100528600 : Record 11072237;
      ToServiceSalesDiscSurch@1100528601 : Record 11072237;
    BEGIN
      IF "Contract Template Code" = '' THEN
        EXIT;
      ServiceSalesDiscSurch.SETRANGE(Type, ServiceSalesDiscSurch.Type::"Contract Template");
      ServiceSalesDiscSurch.SETRANGE(Code, "Contract Template Code");
      IF ServiceSalesDiscSurch.FINDSET THEN
        REPEAT
          ToServiceSalesDiscSurch := ServiceSalesDiscSurch;
          ToServiceSalesDiscSurch.Type := ToServiceSalesDiscSurch.Type::Contract;
          ToServiceSalesDiscSurch.Code := "No.";
          ToServiceSalesDiscSurch.INSERT(TRUE)
        UNTIL ServiceSalesDiscSurch.NEXT = 0;
    END;

    LOCAL PROCEDURE CopySCTemplateExtraCosts@1100528913();
    VAR
      ServiceExtraCost@1100528600 : Record 11020344;
      ToServiceExtraCost@1100528601 : Record 11020344;
    BEGIN
      IF "Contract Template Code" = '' THEN
        EXIT;
      ServiceExtraCost.SETRANGE("Entity Type", ServiceExtraCost."Entity Type"::"Contract Template");
      ServiceExtraCost.SETRANGE("Entity Code", "Contract Template Code");
      IF ServiceExtraCost.FINDSET THEN
        REPEAT
          ToServiceExtraCost := ServiceExtraCost;
          ToServiceExtraCost."Entity Type" := ToServiceExtraCost."Entity Type"::"Service Contract";
          ToServiceExtraCost."Entity Code" := "No.";
          ToServiceExtraCost.INSERT(TRUE);
        UNTIL ServiceExtraCost.NEXT = 0;
    END;

    LOCAL PROCEDURE CopySCTemplateSUPClusters@1100528615();
    VAR
      SUPClusterLine@1100528600 : Record 11072326;
      ToSUPClusterLine@1100528602 : Record 11072326;
      SUPClusterAppliance@1100528601 : Record 11072327;
      ToSUPClusterAppliance@1100528603 : Record 11072327;
    BEGIN
      IF "Contract Template Code" = '' THEN
        EXIT;
      SUPClusterLine.SETRANGE(Type, SUPClusterLine.Type::"Service Contract Template");
      SUPClusterLine.SETRANGE(Code, "Contract Template Code");
      IF SUPClusterLine.FINDSET THEN
        REPEAT
          ToSUPClusterLine := SUPClusterLine;
          ToSUPClusterLine.Type := ToSUPClusterLine.Type::"Service Contract";
          ToSUPClusterLine.Code := "No.";
          ToSUPClusterLine.INSERT(TRUE);
        UNTIL SUPClusterLine.NEXT = 0;
      SUPClusterAppliance.SETRANGE(Type, SUPClusterAppliance.Type::"Service Contract Template");
      SUPClusterAppliance.SETRANGE(Code, "Contract Template Code");
      IF SUPClusterAppliance.FINDSET THEN
        REPEAT
          ToSUPClusterAppliance := SUPClusterAppliance;
          ToSUPClusterAppliance.Type := ToSUPClusterAppliance.Type::"Service Contract";
          ToSUPClusterAppliance.Code := "No.";
          ToSUPClusterAppliance.INSERT(TRUE);
        UNTIL SUPClusterAppliance.NEXT = 0;
    END;

    PROCEDURE CheckStatusExpired@1100528611();
    VAR
      ServiceCall@1100528600 : Record 11012822;
      ServiceOrder@1100528601 : Record 11012823;
      TmpError@1100528602 : TEMPORARY Record 11012051;
      SalesLine@1100525000 : Record 37;
      TmpSalesHeader@1100525001 : TEMPORARY Record 36;
      LineNo@1100528603 : Integer;
      AllObjWithCaption@1100528604 : Record 2000000058;
    BEGIN
      IF WIPEntriesExists THEN BEGIN
        LineNo += 10000;
        TmpError."User ID" := USERID;
        TmpError."Source Type" := TmpError."Source Type"::"Finish Service-Project";
        TmpError."Line No." := LineNo;
        TmpError."Service Contract No." := "No.";
        AllObjWithCaption.GET(AllObjWithCaption."Object Type"::Report,REPORT::"Close Open Entries Expired SC");
        TmpError."Error message" := COPYSTR(STRSUBSTNO(Text121, AllObjWithCaption."Object Caption"), 1, MAXSTRLEN(TmpError."Error message"));
        TmpError.INSERT;
      END;

      ServiceCall.SETCURRENTKEY("Service Contract No.");
      ServiceCall.SETRANGE("Service Contract No.", "No.");
      ServiceCall.SETFILTER(Status, '<%1', ServiceCall.Status::Finished);
      IF ServiceCall.FINDFIRST THEN
        REPEAT
          LineNo += 10000;
          TmpError."User ID" := USERID;
          TmpError."Source Type" := TmpError."Source Type"::"Finish Service-Project";
          TmpError."Line No." := LineNo;
          TmpError."Error message" := STRSUBSTNO(Text122, ServiceCall."No.");
          TmpError.INSERT;
        UNTIL ServiceCall.NEXT = 0;

      ServiceOrder.SETCURRENTKEY("Service Contract No.");
      ServiceOrder.SETRANGE("Service Contract No.", "No.");
      ServiceOrder.SETFILTER(Status, '<%1', ServiceOrder.Status::Finished);
      IF ServiceOrder.FINDSET THEN
        REPEAT
          LineNo += 10000;
          TmpError."User ID" := USERID;
          TmpError."Source Type" := TmpError."Source Type"::"Finish Service-Project";
          TmpError."Line No." := LineNo;
          TmpError."Service Order No." := ServiceOrder."No.";
          AllObjWithCaption.GET(AllObjWithCaption."Object Type"::Report,REPORT::"Close Service Orders");
          TmpError."Error message" := STRSUBSTNO(Text123, ServiceOrder."No.", AllObjWithCaption."Object Caption");
          TmpError.INSERT;
        UNTIL ServiceOrder.NEXT = 0;

      SalesLine.SETCURRENTKEY("Document Type", "Service Invoice", "Service Contract No.");
      SalesLine.SETFILTER("Document Type", '%1|%2|%3',
        SalesLine."Document Type"::"Invoice Proposal", SalesLine."Document Type"::Invoice, SalesLine."Document Type"::"Credit Memo");
      SalesLine.SETRANGE("Service Invoice", TRUE);
      SalesLine.SETRANGE("Service Contract No.", "No.");
      IF SalesLine.FINDSET THEN
        REPEAT
          IF NOT TmpSalesHeader.GET(SalesLine."Document Type", SalesLine."Document No.") THEN BEGIN
            LineNo += 10000;
            TmpError."User ID" := USERID;
            TmpError."Source Type" := TmpError."Source Type"::"Finish Service-Project";
            TmpError."Line No." := LineNo;
            TmpError."Error message" := STRSUBSTNO(Text128, SalesLine."Document No.");
            TmpError.INSERT;

            TmpSalesHeader."Document Type" := SalesLine."Document Type";
            TmpSalesHeader."No." := SalesLine."No.";
            TmpSalesHeader.INSERT;
          END;
        UNTIL SalesLine.NEXT = 0;

      IF NOT TmpError.ISEMPTY THEN BEGIN
        COMMIT;
        PAGE.RUNMODAL(PAGE::Errors, TmpError);
        IF NOT CONFIRM(Text124) THEN
          ERROR('');
      END;
    END;

    LOCAL PROCEDURE MessageIfInstallmentsExists@1100525001();
    VAR
      ContractInstallment@1100525000 : Record 11071707;
    BEGIN
      IF NOT GUIALLOWED THEN
        EXIT;
      IF "Invoice Type" <> "Invoice Type"::Installments THEN
        EXIT;
      ContractInstallment.SETRANGE("Service Contract No.", "No.");
      IF NOT ContractInstallment.ISEMPTY THEN
        MESSAGE(Text125);
    END;

    LOCAL PROCEDURE UpdateServiceSalesDiscount@1100525003();
    VAR
      ServiceSalesDiscSurch@1100528600 : Record 11072237;
    BEGIN
      ServiceSalesDiscSurch.SETRANGE(Type, ServiceSalesDiscSurch.Type::Contract);
      ServiceSalesDiscSurch.SETRANGE(Code, "No.");
      IF ServiceSalesDiscSurch.FINDSET THEN
        REPEAT
          ServiceSalesDiscSurch.VALIDATE("Currency Code", "Currency Code");
          ServiceSalesDiscSurch.MODIFY(TRUE);
        UNTIL ServiceSalesDiscSurch.NEXT = 0;
    END;

    PROCEDURE IsAlwaysCloseOrdersAllowed@1100528803(ServiceContractNo@1100528800 : Code[20];ISourceType@1100528801 : 'Call,Contract,Direct,Estimate,,,Modification,Replacement') : Boolean;
    VAR
      ServiceContract@1100528802 : Record 11012812;
    BEGIN
      IF ServiceContract.GET(ServiceContractNo) THEN
        CASE ISourceType OF
          ISourceType::Call:
            EXIT(ServiceContract."Always Allow Cls Ord. (Call)");
          ISourceType::Direct:
            EXIT(ServiceContract."Always Allow Cls Ord. (Ext.)");
          ISourceType::Contract:
            EXIT(ServiceContract."Always Allow Cls Ord. (Maint.)");
        END;
    END;

    PROCEDURE AssistEditServContractFolder@1100528000();
    VAR
      FileMgt@1100525002 : Codeunit 419;
      ExplorerPath@1100525000 : Text[250];
      DocumentMgtSetup@1100525001 : Record 11071831;
      OperatingSystemMgt@1100528000 : Codeunit 11012364;
    BEGIN
      DocumentMgtSetup.GET;
      IF NOT DocumentMgtSetup."Use Citrix Client" THEN
        ExplorerPath := OperatingSystemMgt.ClientEnviron('SYSTEMROOT') + '\Explorer.exe'
      ELSE
        ExplorerPath := OperatingSystemMgt.ClientEnviron('SYSTEMROOT') + '\Pexplorer.exe';
      IF "Service Contract Folder" = '' THEN
        FileMgt.SelectDirectoryNameWithBackSlash("Service Contract Folder")
      ELSE BEGIN
        OperatingSystemMgt.ClientShell(
          STRSUBSTNO('"%1"', ExplorerPath),
          STRSUBSTNO('"%1"', "Service Contract Folder"),
          FALSE, FALSE);
      END;
    END;

    LOCAL PROCEDURE DetermineAlternativeBilltoAddress@1100528618(IFieldNo@1100528601 : Integer);
    VAR
      ShiptoAddress@1100528600 : Record 222;
      BilltoCustomerNo@1100528602 : Code[20];
    BEGIN
      CASE IFieldNo OF
        FIELDNO("Bill-to Customer No. (Contr.)"):
          BilltoCustomerNo := "Bill-to Customer No. (Contr.)";
        FIELDNO("Bill-to Customer No. (CP)"):
          BilltoCustomerNo := "Bill-to Customer No. (CP)";
      END;
      IF ShiptoAddress.GetAlternativeBilltoAddress(BilltoCustomerNo, ShiptoAddress.Code) THEN
        CASE IFieldNo OF
          FIELDNO("Bill-to Customer No. (Contr.)"):
            VALIDATE("Alt. Bill-to Address (Contr.)", ShiptoAddress.Code);
          FIELDNO("Bill-to Customer No. (CP)"):
            VALIDATE("Alt. Bill-to Address (CP)", ShiptoAddress.Code);
        END;
    END;

    LOCAL PROCEDURE InitFSASettings@1100528703();
    VAR
      MobileSetup@1100528700 : Record 11012676;
    BEGIN
      IF MobileSetup.GET THEN BEGIN
        "Initial Minutes Working Hours" := MobileSetup."Def. Init. Minutes Work. Hours";
        "Round Working Hours on Minutes" := MobileSetup."Def. Round Work. Hours on Min.";
        "Round Travel Hours on Minutes" := MobileSetup."Def. Round Trav. Hours on Min.";
      END;
    END;

    PROCEDURE IsFSAActive@1100525008() : Boolean;
    VAR
      JobsSetup@1100525000 : Record 315;
    BEGIN
      EXIT(JobsSetup.IsFSAActive);
    END;

    PROCEDURE SetCheckOtherServiceCategories@1100529900(NewSetCheckOtherServiceCategories@1100529900 : Boolean);
    BEGIN
      CheckOtherServiceCategories := NewSetCheckOtherServiceCategories;
    END;

    PROCEDURE GetServiceContractEndingDate@1100529600() : Date;
    BEGIN
      IF "Ending Date" <> 0D THEN
        EXIT("Ending Date");
      IF (FORMAT("Contract Duration") <> '') AND ("Starting Date" <> 0D) THEN
        IF "Renewal Date" = 0D THEN
          EXIT(CALCDATE("Contract Duration", "Starting Date") - 1)
        ELSE
          EXIT(CALCDATE("Contract Duration", "Renewal Date") - 1);
      EXIT(0D);
    END;

    PROCEDURE DeterminePriceBookFields@1100529601();
    VAR
      Customer@1100529601 : Record 18;
      CustomerNo@1100529600 : Code[20];
    BEGIN
      IF "Use Bill-To Cust. for Pr. Book" THEN
        CustomerNo := "Bill-to Customer No. (CP)";
      IF CustomerNo = '' THEN
        CustomerNo := "Customer No.";
      IF NOT Customer.GET(CustomerNo) THEN
        EXIT;
      IF (Customer."Price Book Type" = Customer."Price Book Type"::None) OR (Customer."Price Book Code" = '') THEN
        EXIT;
      "Price Book Type" := Customer."Price Book Type";
      "Price Book Code" := Customer."Price Book Code";
      "Price Book Index Date" := Customer."Price Book Index Date";
      "Unit Price Set" := Customer."Unit Price Set";
      "Unit Price Status" := Customer."Unit Price Status";
    END;

    BEGIN
    {
      4PS01 HBK 06-08-09: Field added "Language Code"
      28-03-2019: Test mg
    }
    END.
  }
}

