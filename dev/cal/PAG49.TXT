OBJECT Page 49 Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.03,4PS14.00,NAVDK,EXF;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Quote;
               NOR=Forespõrsel;
               SVE=Inkîpsoffert];
    SourceTable=Table38;
    PopulateAllFields=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Quote));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Request Approval,Print/Send,Quote,Release,Navigate;
                                NOR=Ny,Prosess,Rapport,Godkjenn,Be om godkjenning,Skriv ut / send,Tilbud,Frigi,Naviger;
                                SVE=Ny,Process,Rapport,GodkÑnn,BegÑr godkÑnnande,Skriv ut/skicka,Offert,SlÑpp,Navigera];
    OnInit=BEGIN
             ShowShippingOptionsWithLocation := ApplicationAreaMgmtFacade.IsLocationEnabled OR ApplicationAreaMgmtFacade.IsAllDisabled;

             //**4PS.sn
             PurchSetup.GET;
             PriceAgreementEditable := TRUE;

             StandardShippingOptionsVisible := FALSE;
             //**4PS.en
           END;

    OnOpenPage=VAR
                 EXApprovalSetup@1100285500 : Record 12013601;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;

                 ActivateFields;

                 SetDocNoVisible;

                 //**4PS.sn
                 PurchSetup.GET;
                 UpdateEditable;
                 //**4PS.en
                 //4PSSE
                 GLSetup.GET;
                 DKinfoEnable := GLSetup."Danish Localization Active";
                 //ExFlowVisible := EXApprovalSetup.READPERMISSION;
                 ExFlowVisible := EXApprovalSetup.GET;
               END;

    OnAfterGetRecord=BEGIN
                       CalculateCurrentShippingAndPayToOption;

                       //**4PS.sn
                       IF gFromReference THEN BEGIN
                         gFromReference := FALSE;
                         CurrPage.PurchLines.PAGE.InitSelectionFromReference(gQuoteLineNo);
                       END;

                       PurchaseHeaderExtension.GetPurchHeadExtension("Document Type", "No."); //kzwerver, 110929, n, #28914

                       UpdateEditable;
                       //**4PS.en
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02

                  "Responsibility Center" := UserMgt.GetPurchasesDefault;

                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetBuyFromVendorFromFilter;

                  CalculateCurrentShippingAndPayToOption;
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           SetControlAppearance;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.ApprovalFactBox.PAGE.UpdateApprovalEntriesFromSourceRecord(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           OnAfterGetCurrRec; //**4PS.n
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Quote;
                                 NOR=F&orespõrsel;
                                 SVE=O&ffert];
                      Image=Quote }
      { 61      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 PAGE.RUNMODAL(PAGE::"Purchase Statistics",Rec);
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverandõr;
                                 SVE=Leverantîr];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverandõren i kjõpsdokumentet.;
                                 SVE=Visa eller redigera detaljerad information om leverantîren pÜ inkîpsdokumentet.];
                      ApplicationArea=#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Enabled="Buy-from Vendor No." <> '';
                      Image=Vendor;
                      PromotedCategory=Category9 }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category7 }
      { 111     ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera dimensioner, till exempel omrÜde, projekt eller avdelning, som du kan tilldela fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Approvals;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 WorkflowsEntriesBuffer@1001 : Record 832;
                               BEGIN
                                 WorkflowsEntriesBuffer.RunWorkflowEntriesPage(RECORDID,DATABASE::"Purchase Header","Document Type","No.");
                               END;
                                }
      { 71      ;2   ;Action    ;
                      Name=DocAttach;
                      CaptionML=[ENU=Attachments;
                                 NOR=Vedlegg;
                                 SVE=Bilagor];
                      ToolTipML=[ENU=Add a file as an attachment. You can attach images as well as documents.;
                                 NOR=Legg til en fil som vedlegg. Du kan legge ved bilderˇog dokumenter.;
                                 SVE=LÑgg till en fil som en bilaga. Du kan bifoga bilder och dokument.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Image=Attach;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1001 : Page 1173;
                                 RecRef@1000 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 12013597;2   ;Separator  }
      { 12013598;2   ;Action    ;
                      ShortCutKey=Ctrl+I;
                      CaptionML=[ENU=Show document;
                                 SVE=Visa dokument];
                      Visible=ExFlowVisible;
                      Image=Document;
                      OnAction=BEGIN
                                 // ExFlow
                                 ExFlow.ShowImageDocument("Document Type","No.");
                               END;
                                }
      { 12013599;2   ;Action    ;
                      CaptionML=[ENU=Attached Fil&es;
                                 SVE=&Bilagor];
                      RunObject=Page 12013644;
                      RunPageView=SORTING(Document Type,Document No.,Attached);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Visible=ExFlowVisible;
                      Image=Documents }
      { 1210190003;2 ;Action    ;
                      CaptionML=[ENU=Document &Relations;
                                 SVE=Dokument&relationer];
                      RunObject=Page 11012413;
                      RunPageView=WHERE(Document Type=CONST(Purchase Quote));
                      RunPageLink=No.=FIELD(No.);
                      Image=Relationship }
      { 1210190012;2 ;Action    ;
                      CaptionML=[ENU=Purchace Text;
                                 SVE=Inkîpstext];
                      RunObject=Page 11012126;
                      RunPageLink=Line Type=CONST(Purchase Quote),
                                  No.=FIELD(No.);
                      Image=Text }
      { 1210190033;2 ;Action    ;
                      CaptionML=[ENU=Quote Comparison;
                                 SVE=OffertjÑmfîrelse];
                      RunObject=Page 11020205;
                      RunPageLink=Comparison Quote=FIELD(Comparison Quote),
                                  Type=CONST(Comparison Quote);
                      Image=Quote;
                      OnAction=BEGIN
                                 //**4PS
                               END;
                                }
      { 1100525003;2 ;Action    ;
                      CaptionML=[ENU=Phase List;
                                 SVE=Faslista];
                      RunObject=Page 11072630;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Image=List }
      { 1100485909;2 ;ActionGroup;
                      CaptionML=[ENU=Complaint Management;
                                 SVE=Incidenthantering];
                      Image=Reminder }
      { 1100485910;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create New Complaint;
                                 SVE=Skapa nytt klagomÜl];
                      Image=Reminder;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 lvComplMgtCU.CreateNewComplaintOnDocument(lvComplDocRec."Document Type"::"Q-P", "No.");
                               END;
                                }
      { 1100485911;3 ;Action    ;
                      CaptionML=[ENU=Open Complaints;
                                 SVE=ôppna klagomÜl];
                      Image=Reminder;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"Q-P", "No.", TRUE);
                               END;
                                }
      { 1100485912;3 ;Action    ;
                      CaptionML=[ENU=Complaints;
                                 SVE=KlagomÜl];
                      Image=Reminder;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 //**4PS
                                 lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"Q-P", "No.", FALSE);
                               END;
                                }
      { 1210190026;2 ;Action    ;
                      CaptionML=[ENU=&Documents;
                                 SVE=&Dokument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1100525006;1 ;ActionGroup;
                      CaptionML=[ENU=GS1 Loggings;
                                 SVE=GS1-loggningar] }
      { 1100525005;2 ;Action    ;
                      CaptionML=[ENU=GS1 Errors;
                                 SVE=GS1-fel];
                      RunObject=Page 11126141;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Image=ErrorFALedgerEntries }
      { 1100525004;2 ;Action    ;
                      CaptionML=[ENU=GS1 Changes;
                                 SVE=GS1-Ñndringar];
                      RunObject=Page 11126142;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Image=LedgerEntries }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning;
                                 SVE=GodkÑnnande] }
      { 21      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn;
                                 SVE=GodkÑnn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.;
                                 SVE=GodkÑnn de begÑrda fîrÑndringarna.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                                 //**4PS.sn
                                 MARK(FALSE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 18      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis;
                                 SVE=Avvisa];
                      ToolTipML=[ENU=Reject to approve the incoming document. Note that this is not related to approval workflows.;
                                 NOR=Avvis Ü godkjenne det innkommende dokumentet. Legg merke til at dette ikke er knyttet til arbeidsflyter for godkjenning.;
                                 SVE=Avvisa fîr att godkÑnna det inkommande dokumentet.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger;
                                 SVE=Delegera];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.;
                                 SVE=Delegera godkÑnnandet till en ersÑttare.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 15      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader;
                                 SVE=Kommentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 92      ;1   ;ActionGroup;
                      CaptionML=[ENU=Print;
                                 NOR=Skriv ut;
                                 SVE=Skriv ut] }
      { 70      ;2   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut;
                                 SVE=Skriv &ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargjõr for Ü skrive ut dokumentet. Det vises et rapportforespõrselsvindu for dokumentet der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Fîrbered utskrift av dokumentet. Ett rapportfînster om dokumentet îppnas dÑr det gÜr att ange vad du vill inkludera pÜ utskriften.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 LinesInstructionMgt@1000 : Codeunit 1320;
                               BEGIN
                                 IF ApplicationAreaMgmtFacade.IsFoundationEnabled THEN
                                   LinesInstructionMgt.PurchaseCheckAllLinesHaveQuantityAssigned(Rec);

                                 DocPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 93      ;2   ;Action    ;
                      Name=Send;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send;
                                 NOR=Send;
                                 SVE=Skicka];
                      ToolTipML=[ENU=Prepare to send the document according to the vendor's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.;
                                 NOR=Klargjõr for Ü sende dokumentet i henhold til leverandõrens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til Üpnes slik at du kan bekrefte eller velge en sendingsprofil.;
                                 SVE=Fîrbered att skicka dokumentet enligt leverantîrens utskicksprofil, t.ex. som bilaga till ett e-postmeddelande. Fînstret Skicka dokument till îppnas fîrst sÜ att det gÜr att bekrÑfta eller vÑlja en utskicksprofil.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=SendToMultiple;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 PurchaseHeader@1000 : Record 38;
                               BEGIN
                                 PurchaseHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(PurchaseHeader);
                                 PurchaseHeader.SendRecords;
                               END;
                                }
      { 1101200009;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Quote;
                                 SVE=Skriv ut offert];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 //**4PS
                                 DocPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 1101200010;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print &Thank You Letter;
                                 SVE=Skriv ut &tackbrev];
                      Promoted=Yes;
                      Visible=false;
                      Image=PrintReport;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 //**4PS
                                 DocPrint.PrintPurchQuoteThanksLetter(Rec);
                               END;
                                }
      { 1100485016;2 ;Action    ;
                      CaptionML=[ENU=Print Word Document;
                                 SVE=Skriv ut Word-dokument];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 Contact@1100528701 : Record 5050;
                                 DocumentTemplate@1100528702 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Vendor No.");
                                 IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN
                                   EditDocuments(
                                     "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Quote"),
                                     Contact."No.", "Buy-from Contact Person No.", FALSE, '', FALSE);
                               END;
                                }
      { 1100528500;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Email;
                                 SVE=E-post];
                      Promoted=Yes;
                      Image=Email;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ChangeStatus@1100528401 : 'None,Released,Closed';
                                 DirectPostOrder@1100528400 : 'According to Vendor,Not';
                               BEGIN
                                 //**4PS
                                 DocPrint.EmailPurchHeader(
                                   Rec, FALSE, ChangeStatus::None, DirectPostOrder::"Not", FALSE, FALSE);
                               END;
                                }
      { 1210190031;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send Quote Electronically (with options);
                                 SVE=Skicka offert elektroniskt (med alternativ)];
                      Promoted=Yes;
                      Image=ExportElectronicDocument;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 SendOrderElectronic(TRUE);
                               END;
                                }
      { 1100528700;2 ;Action    ;
                      CaptionML=[ENU=Send Quote Electronically;
                                 SVE=Skicka offert elektroniskt];
                      Promoted=Yes;
                      Image=ExportElectronicDocument;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 SendOrderElectronic(FALSE);
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi;
                                 SVE=SlÑpp];
                      Image=ReleaseDoc }
      { 148     ;2   ;Separator  }
      { 118     ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=Fri&gi;
                                 SVE=&SlÑpp];
                      ToolTipML=[ENU=Release the document to the next stage of processing. When a document is released, it will be included in all availability calculations from the expected receipt date of the items. You must reopen the document before you can make changes to it.;
                                 NOR=Frigi dokumentet til neste behandlingsfase. NÜr et dokument frigis, tas det med i alle tilgjengelighetsberegninger fra den forventede mottaksdatoen for varene. Du mÜ Üpne dokumentet pÜ nytt fõr du kan gjõre endringer i det.;
                                 SVE=SlÑpp dokumentet till nÑsta etapp i bearbetningen. NÑr ett dokument slÑpps, tas det med i alla dispositionsberÑkningar frÜn och med artiklarnas planerade inleveransdatum. Du mÜste îppna dokumentet igen innan du kan Ñndra i det.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 119     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=&èpne pÜ nytt;
                                 SVE=&ôppna igen];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed;
                                 NOR=èpne dokumentet pÜ nytt for Ü endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de mÜ Üpnes fõr de kan endres;
                                 SVE=ôppna dokumentet igen och Ñndra det efter att det har godkÑnts. GodkÑnda dokument har statusen SlÑppt och mÜste îppnas innan de kan Ñndras];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      Image=ReOpen;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 1100525009;2 ;Action    ;
                      Name=Close;
                      CaptionML=[ENU=Close;
                                 SVE=StÑng];
                      Image=Close;
                      OnAction=VAR
                                 ReleasePurchDoc@1210190001 : Codeunit 415;
                               BEGIN
                                 //**4PS
                                 IF Status = Status::"Pending Approval" THEN
                                   ERROR(Text11012005);
                                 ReleasePurchDoc.CloseQuote(Rec);
                               END;
                                }
      { 64      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner;
                                 SVE=Fu&nktion];
                      Image=Action }
      { 65      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 24=R;
                      CaptionML=[ENU=Calculate &Invoice Discount/Charge;
                                 NOR=&Beregn fakturarabatt;
                                 SVE=BerÑkna &fakturarabatt];
                      ToolTipML=[ENU=Calculate the invoice discount for the purchase quote.;
                                 NOR=Beregn fakturarabatten for forespõrselen.;
                                 SVE=BerÑkna fakturarabatten fîr inkîpsofferten.];
                      ApplicationArea=#Suite;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 1100485025;2 ;Action    ;
                      Name=RemovalContribution;
                      CaptionML=[ENU=Calculate Removal Contribution;
                                 SVE=BerÑkna borttagningsbidrag];
                      Image=Calculate;
                      OnAction=BEGIN
                                 //**4PS
                                 DetermineRemovalContribution;  //db, 14-12-05
                               END;
                                }
      { 144     ;2   ;Separator  }
      { 143     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get St&d. Vend. Purchase Codes;
                                 NOR=Hent st&d. kjõpskode for lev.;
                                 SVE=HÑmta st&d. lev.inkîpskoder];
                      ToolTipML=[ENU=View a list of the standard purchase lines that have been assigned to the vendor to be used for recurring purchases.;
                                 NOR=Vis en liste over standard kjõpslinjer som er tilordnet til leverandõren som skal brukes for gjentakende kjõp.;
                                 SVE=Visa en lista îver de standardinkîpsrader som har tilldelats leverantîren och som ska anvÑndas fîr Üterkommande inkîp.];
                      ApplicationArea=#Suite;
                      Image=VendorCode;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 146     ;2   ;Separator  }
      { 138     ;2   ;Action    ;
                      Name=Archive Document;
                      CaptionML=[ENU=Archi&ve Document;
                                 NOR=Arki&ver dokument;
                                 SVE=Arki&vera dokument];
                      ToolTipML=[ENU=Send the document to the archive, for example because it is too soon to delete it. Later, you delete or reprocess the archived document.;
                                 NOR=Send dokumentet til arkivet, for eksempel fordi det er for tidlige Ü slette det. Senere kan du slette eller behandle det arkiverte dokumentet pÜ nytt.;
                                 SVE=Skicka dokument till arkivet, om det till exempel Ñr fîr tidigt att ta bort det. Du kan ta bort eller bearbeta det arkiverade dokumentet vid ett senare tillfÑlle.];
                      ApplicationArea=#Suite;
                      Image=Archive;
                      OnAction=BEGIN
                                 ArchiveManagement.ArchivePurchDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 35      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 33      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inngÜende dokument;
                                 SVE=Visa inkommande dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document, for example for auditing purposes;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for posten eller dokumentet, for eksempel for revisjonsformÜl;
                                 SVE=Visa alla poster med inkommande dokument och filbilagor som finns fîr transaktionen eller dokumentet];
                      ApplicationArea=#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 31      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inngÜende dokument;
                                 SVE=VÑlj inkommande dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppfõringen eller dokumentet.;
                                 SVE=VÑlj en inkommande dokumentpost och en filbilaga som du vill koppla till transaktionen eller dokumentet.];
                      ApplicationArea=#Suite;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 29      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inngÜende dokument fra fil;
                                 SVE=Skapa inkommande dokument frÜn fil];
                      ToolTipML=[ENU=Create an incoming document from a file that you select from the disk. The file will be attached to the incoming document record.;
                                 NOR=Opprett et innkommende dokument fra en fil du velger fra disken. Filen blir lagt ved i posten for det innkommende dokumentet.;
                                 SVE=Skapa ett inkommande dokument frÜn en fil som du vÑljer pÜ disken. Filen bifogas posten fîr det inkommande dokumentet.];
                      ApplicationArea=#Suite;
                      Enabled=("Incoming Document Entry No." = 0) AND ("No." <> '');
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPurchaseDocument(Rec);
                               END;
                                }
      { 25      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 NOR=Fjern inngÜende dokument;
                                 SVE=Ta bort inkommande dokument];
                      ToolTipML=[ENU=Remove any incoming document records and file attachments.;
                                 NOR=Fjern eventuelle innkommende dokumentposter og filvedlegg.;
                                 SVE=Ta bort inkommande dokumentposter och filbilagor.];
                      ApplicationArea=#Suite;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IF IncomingDocument.GET("Incoming Document Entry No.") THEN
                                   IncomingDocument.RemoveLinkToRelatedRecord;
                                 "Incoming Document Entry No." := 0;
                                 MODIFY(TRUE);
                               END;
                                }
      { 1100529901;2 ;ActionGroup;
                      CaptionML=[ENU=Copy;
                                 SVE=Kopiera];
                      Image=Copy }
      { 66      ;3   ;Action    ;
                      Name=CopyDocument;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument;
                                 SVE=Kopiera dokument];
                      ToolTipML=[ENU=Copy document lines and header information from another sales document to this document. You can copy a posted sales invoice into a new sales invoice to quickly create a similar document.;
                                 NOR=Kopier dokumentlinjer og hodeopplysninger fra et annet salgsdokument til dette dokumentet. Du kan kopiere en bokfõrt salgsfaktura til en ny salgsfaktura for Ü opprette et lignende dokument raskt.;
                                 SVE=Kopiera dokumentrader och huvudinformation frÜn andra fîrsÑljningsdokument till det hÑr dokumentet. Du kan kopiera en bokfîrd fîrsÑljningsfaktura till en ny fîrsÑljningsfaktura om du snabbt vill skapa ett liknande dokument.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 1210190017;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create from Estimate Lines;
                                 SVE=Skapa frÜn kalkylrader];
                      Image=CreateLinesFromJob;
                      OnAction=BEGIN
                                 //**4PS
                                 SelectEstLineForQuote;  //db, 09-12-10: M18179
                               END;
                                }
      { 1210190021;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Quote to other Vendor;
                                 SVE=Kopiera offert till annan leverantîr];
                      Image=CopyDocument;
                      OnAction=VAR
                                 lvVendRec@1210190012 : Record 23;
                                 lvLinkedQuoteRec@1210190013 : Record 11020214;
                                 lvVendListFrm@1210190003 : Page 27;
                                 lvVendorFilter@1210190004 : Text[250];
                               BEGIN
                                 //**4PS
                                 IF ("No." = '') THEN
                                   EXIT;

                                 lvVendorFilter := '';
                                 IF "Buy-from Vendor No." <> '' THEN
                                   lvVendorFilter := '(<>' + "Buy-from Vendor No." + ')';
                                 IF "Comparison Quote" <> '' THEN BEGIN
                                   lvLinkedQuoteRec.SETRANGE("Comparison Quote", "Comparison Quote");
                                   IF lvLinkedQuoteRec.FIND('-') THEN BEGIN
                                     REPEAT
                                       lvLinkedQuoteRec.CALCFIELDS("Buy-from Vendor No.");
                                       IF (lvLinkedQuoteRec."Buy-from Vendor No." <> '') AND
                                          (lvLinkedQuoteRec."Buy-from Vendor No." <> "Buy-from Vendor No.") AND
                                          ((STRLEN(lvVendorFilter) + STRLEN(lvLinkedQuoteRec."Buy-from Vendor No.") + 5) <= MAXSTRLEN(lvVendorFilter))
                                       THEN BEGIN
                                         IF lvVendorFilter <> '' THEN
                                           lvVendorFilter := lvVendorFilter + '&';
                                         lvVendorFilter := lvVendorFilter + '(<>' + lvLinkedQuoteRec."Buy-from Vendor No." + ')';
                                       END;
                                     UNTIL lvLinkedQuoteRec.NEXT = 0;
                                   END;
                                 END;
                                 IF lvVendorFilter <> '' THEN
                                   lvVendRec.SETFILTER("No.", lvVendorFilter);
                                 lvVendListFrm.SETTABLEVIEW(lvVendRec);
                                 lvVendListFrm.InitSelectionCopyQuote("No.");
                                 lvVendListFrm.RUNMODAL;
                               END;
                                }
      { 1100485000;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Quote to other Contact;
                                 SVE=Kopiera offert till annan kontakt];
                      Image=CopyWorksheet;
                      OnAction=VAR
                                 lvContRec@1100485003 : Record 5050;
                                 lvLinkedQuoteRec@1100485002 : Record 11020214;
                                 lvContListFrm@1100485001 : Page 5052;
                                 lvContactFilter@1100485000 : Text[250];
                               BEGIN
                                 //**4PS
                                 IF ("No." = '') THEN
                                   EXIT;

                                 lvContactFilter := '';
                                 IF "Buy-from Contact No." <> '' THEN
                                   lvContactFilter := '(<>' + "Buy-from Contact No." + ')';
                                 IF "Comparison Quote" <> '' THEN BEGIN
                                   lvLinkedQuoteRec.SETRANGE("Comparison Quote", "Comparison Quote");
                                   IF lvLinkedQuoteRec.FIND('-') THEN BEGIN
                                     REPEAT
                                       lvLinkedQuoteRec.CALCFIELDS("Buy-from Contact No.");
                                       IF (lvLinkedQuoteRec."Buy-from Contact No." <> '') AND
                                          (lvLinkedQuoteRec."Buy-from Contact No." <> "Buy-from Contact No.") AND
                                          ((STRLEN(lvContactFilter) + STRLEN(lvLinkedQuoteRec."Buy-from Contact No.") + 5) <= MAXSTRLEN(lvContactFilter))
                                       THEN BEGIN
                                         IF lvContactFilter <> '' THEN
                                           lvContactFilter := lvContactFilter + '&';
                                         lvContactFilter := lvContactFilter + '(<>' + lvLinkedQuoteRec."Buy-from Contact No." + ')';
                                       END;
                                     UNTIL lvLinkedQuoteRec.NEXT = 0;
                                   END;
                                 END;
                                 IF lvContactFilter <> '' THEN
                                   lvContRec.SETFILTER("No.", lvContactFilter);
                                 lvContListFrm.SETTABLEVIEW(lvContRec);
                                 lvContListFrm.InitSelectionCopyQuote("No.");
                                 lvContListFrm.RUNMODAL;
                               END;
                                }
      { 1210190024;3 ;Action    ;
                      CaptionML=[ENU=Make &Blanket Contract;
                                 SVE=Skapa &avropskontrakt];
                      Image=BlanketOrder;
                      OnAction=VAR
                                 lvQuoteToPurchOrderYnCU@1100485001 : Codeunit 93;
                               BEGIN
                                 //**4PS
                                 lvQuoteToPurchOrderYnCU.SetAskForNoSerie();
                                 lvQuoteToPurchOrderYnCU.MoveQuoteToBlanketOrder(Rec);
                               END;
                                }
      { 1210190004;3 ;Action    ;
                      CaptionML=[ENU=Edit Word Documents;
                                 SVE=Redigera Word-dokument];
                      Promoted=Yes;
                      Image=Word;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 DocumentTemplate@1100525001 : Record 11012401;
                                 Contact@1100525002 : Record 5050;
                               BEGIN
                                 //**4PS
                                 IF "Buy-from Vendor No." <> '' THEN BEGIN
                                   IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Quote"),
                                       Contact."No.", "Buy-from Contact Person No.", FALSE, '', FALSE)
                                 END ELSE IF Contact.GET("Buy-from Contact No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Quote"),
                                       Contact."Company No.", Contact."No.", FALSE, '', FALSE)
                                   ELSE
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Quote"),
                                       Contact."No.", "Buy-from Contact Person No.", FALSE, '', FALSE);
                                 END;
                               END;
                                }
      { 1210190030;3 ;Action    ;
                      CaptionML=[ENU=&Reminders;
                                 SVE=&PÜminnelser];
                      RunObject=Page 11020225;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Image=Reminder }
      { 1100527450;2 ;Action    ;
                      Name=ChooseTradeName;
                      CaptionML=ENU=Choose Tradename;
                      Visible=FALSE;
                      Image=CompareContacts;
                      OnAction=BEGIN
                                 //**4PS
                                 ChooseTradeName;
                               END;
                                }
      { 39      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning;
                                 SVE=BegÑr godkÑnnande] }
      { 153     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforespõrsel;
                                 SVE=Skicka godk&ÑnnandebegÑran];
                      ToolTipML=[ENU=Request approval of the document.;
                                 NOR=Be om godkjenning av dokumentet.;
                                 SVE=BegÑr godkÑnnande av dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF  ApprovalsMgmt.CheckPurchaseApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 154     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforespõrsel;
                                 SVE=Annullera &godkÑnnandebegÑran];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforespõrselen.;
                                 SVE=Annullera godkÑnnandebegÑran.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                               END;
                                }
      { 1100525000;1 ;ActionGroup;
                      Name=Make order;
                      CaptionML=ENU=Make order;
                      Image=MakeOrder }
      { 69      ;2   ;Action    ;
                      Name=Make Order;
                      CaptionML=[ENU=Make &Order;
                                 NOR=Lag &bestilling;
                                 SVE=Skapa &order];
                      ToolTipML=[ENU=Convert the purchase quote to a purchase order.;
                                 NOR=Konverter forespõrselen til en bestilling.;
                                 SVE=Konvertera inkîpsofferten till en inkîpsorder.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MakeOrder;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                                 lvQuoteToPurchOrderYnCU@1210190000 : Codeunit 93;
                               BEGIN
                                 //**4PS.so
                                 //IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                 //  CODEUNIT.RUN(CODEUNIT::"Purch.-Quote to Order (Yes/No)",Rec);
                                 //**4PS.so
                                 //**4PS.sn
                                 CheckIfMakingOrderAllowedForQuoteStatus;
                                 lvQuoteToPurchOrderYnCU.SetAskForNoSerie();
                                 lvQuoteToPurchOrderYnCU.RUN(Rec);
                                 //**4PS.en
                               END;
                                }
      { 1100409000;1 ;ActionGroup;
                      CaptionML=ENU=Send Documents;
                      ActionContainerType=NewDocumentItems }
      { 1100485015;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Mail Documents;
                                 SVE=E-postdokument];
                      Promoted=No;
                      Image=Email;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 EmailDocs@1100485001 : Codeunit 11012408;
                               BEGIN
                                 EmailDocs.EmailDocuments(Rec); // **4PS.n
                               END;
                                }
      { 1100409001;2 ;Action    ;
                      CaptionML=[ENU=Mail Document to Buy-from Vendor;
                                 SVE=Inkîpsleverantîr];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=MailAttachment;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 Contact@1100409000 : Record 5050;
                                 Vendor@1100409001 : Record 23;
                                 DocumentTemplate@1100409002 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Vendor No.");
                                 IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN BEGIN
                                   Vendor.GET("Buy-from Vendor No.");
                                   EditDocuments(
                                     "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Quote"),
                                     Contact."No.", '', TRUE, Vendor."E-Mail", FALSE);
                                 END;
                               END;
                                }
      { 1100409002;2 ;Action    ;
                      CaptionML=[ENU=Mail Document to Buy-from Contact;
                                 SVE=Inkîpskontaktperson];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=MailAttachment;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 Contact@1100409000 : Record 5050;
                                 DocumentTemplate@1100409001 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Contact No.");
                                 IF Contact.GET("Buy-from Contact No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Quote"),
                                       Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail", FALSE)
                                    ELSE
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::"Purchase Quote"),
                                       Contact."No.", '', TRUE, Contact."E-Mail", FALSE);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                Lookup=No;
                ToolTipML=[ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NOR=Angir nummeret pÜ den aktuelle oppfõringen eller posten, i henhold til den angitte nummerserien.;
                           SVE=Anger numret fîr den berîrda transaktionen eller posten, enligt den angivna nummerserien.];
                ApplicationArea=#Suite;
                SourceExpr="No.";
                Importance=Promoted;
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                CaptionML=[ENU=Vendor No.;
                           NOR=Leverandõrnr.;
                           SVE=Leverantîrsnr];
                ToolTipML=[ENU=Specifies the number of the vendor who delivers the products.;
                           NOR=Angir nummeret pÜ leverandõren som leverer produktene.;
                           SVE=Anger numret pÜ leverantîren som levererar produkterna.];
                ApplicationArea=#Suite;
                NotBlank=Yes;
                SourceExpr="Buy-from Vendor No.";
                Importance=Additional;
                OnValidate=BEGIN
                             OnAfterValidateBuyFromVendorNo(Rec,xRec);
                             CurrPage.UPDATE;
                           END;
                            }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Vendor Name;
                           NOR=Leverandõrnavn;
                           SVE=Leverantîrsnamn];
                ToolTipML=[ENU=Specifies the name of the vendor who delivers the products.;
                           NOR=Angir navnet pÜ leverandõren som leverer produktene.;
                           SVE=Anger namnet pÜ leverantîren som levererar produkterna.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Vendor Name";
                Importance=Promoted;
                OnValidate=BEGIN
                             OnAfterValidateBuyFromVendorNo(Rec,xRec);

                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE }

    { 1100528501;2;Field  ;
                SourceExpr="Purchase Order Type" }

    { 43  ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kjõp fra;
                           SVE=Kîp frÜn];
                GroupType=Group }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor who delivered the items.;
                           NOR=Angir adressen til leverandõren som leverte varene.;
                           SVE=Anger adressen till leverantîren som levererade artiklarna.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                QuickEntry=FALSE }

    { 74  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies an additional part of the address of the vendor who delivered the items.;
                           NOR=Angir en supplerende adresse til leverandõren som leverte varene.;
                           SVE=Anger en ytterligare del av adressen till leverantîren, som levererade artiklarna.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                QuickEntry=FALSE }

    { 79  ;3   ;Group     ;
                Visible=IsBuyFromCountyVisible;
                GroupType=Group }

    { 75  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from County";
                Importance=Additional;
                QuickEntry=FALSE }

    { 77  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the post code of the vendor who delivered the items.;
                           NOR=Angir postnummeret for leverandõren som leverte varene.;
                           SVE=Anger postnumret fîr leverantîren som levererade artiklarna.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                QuickEntry=FALSE }

    { 76  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor who delivered the items.;
                           NOR=Angir poststedet til leverandõren som leverte varene.;
                           SVE=Anger orten fîr leverantîren som levererade artiklarna.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                QuickEntry=FALSE }

    { 78  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Country/Region Code";
                Importance=Additional;
                OnValidate=BEGIN
                             IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 139 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of contact person of the vendor who delivered the items.;
                           NOR=Angir nummeret for kontaktpersonen hos leverandõren som leverte varene.;
                           SVE=Anger numret pÜ kontaktpersonen hos leverantîren som levererade artiklarna.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the contact person at the vendor who delivered the items.;
                           NOR=Angir kontaktpersonen hos leverandõren som leverte varene.;
                           SVE=Anger kontaktpersonen hos leverantîren som levererade artiklarna.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Contact";
                Editable="Buy-from Vendor No." <> '';
                OnLookup=BEGIN
                           LookupContactPerson;  //**4PS.n
                         END;
                          }

    { 1100409003;2;Field  ;
                SourceExpr="E-Mail for Purch. Order" }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's order number.;
                           NOR=Angir leverandõrens ordrenummer.;
                           SVE=Anger leverantîrens ordernummer.];
                ApplicationArea=#Suite;
                SourceExpr="Vendor Order No.";
                Importance=Additional }

    { 1210190010;2;Field  ;
                SourceExpr="Amounts only" }

    { 1210190027;2;Field  ;
                SourceExpr="Reminder Terms Code";
                Importance=Additional }

    { 1100525001;2;Field  ;
                SourceExpr="Purchase Plan";
                Importance=Additional }

    { 1100525002;2;Field  ;
                CaptionML=[ENU=Purchase Plan Status;
                           SVE=Status upphandlingsplan];
                SourceExpr=PhasePlanMgt.ShowPlanStatus(Rec);
                Importance=Additional }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the related order was created.;
                           NOR=Angir datoen da den relaterte ordren ble opprettet.;
                           SVE=Anger datumet nÑr den relaterade ordern skapades.];
                ApplicationArea=#Suite;
                SourceExpr="Order Date";
                Importance=Standard }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the related document was created.;
                           NOR=Angir datoen da de relaterte dokumentet ble opprettet.;
                           SVE=Anger datumet nÑr det relaterade dokumentet skapades.];
                ApplicationArea=#Suite;
                SourceExpr="Document Date" }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that you want the vendor to deliver to the ship-to address. The value in the field is used to calculate the latest date you can order the items to have them delivered on the requested receipt date. If you do not need delivery on a specific date, you can leave the field blank.;
                           NOR=Angir datoen da du vil at leverandõren skal levere til lever til-adressen. Verdien i feltet brukes til Ü beregne nÜr du sist kan bestille varene for Ü fÜ dem levert pÜ õnsket mottaksdato. Hvis leveringen ikke trenger Ü skje pÜ en bestemt dato, lar du feltet vëre tomt.;
                           SVE=Anger datum som du vill att leverantîren ska leverera ordern till leveransadressen. VÑrdet i fÑltet anvÑnds vid berÑkning av det sista datum dÜ du kan bestÑlla artiklarna fîr att de ska levereras pÜ begÑrt inleveransdatum. Om du inte behîver leverera pÜ en viss dag fyller du inte i fÑltet.];
                ApplicationArea=#Suite;
                SourceExpr="Requested Receipt Date" }

    { 1210190008;2;Field  ;
                SourceExpr="Quote Receipt Date" }

    { 1210190015;2;Field  ;
                SourceExpr="Valid Until" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's shipment number.;
                           NOR=Angir leverandõrens fõlgeseddelnummer.;
                           SVE=Anger leverantîrens utleveransnummer.];
                ApplicationArea=#Suite;
                SourceExpr="Vendor Shipment No.";
                Importance=Additional }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is assigned to the vendor.;
                           NOR=Angir hvilken innkjõper som er knyttet til leverandõren.;
                           SVE=Anger vilken inkîpare som Ñr kopplad till leverantîren.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1100525007;2;Field  ;
                DrillDown=No;
                SourceExpr="Name Purchaser";
                Importance=Additional }

    { 1102601000;2;Field  ;
                ToolTipML=[ENU=Specifies the number of the campaign that the document is linked to.;
                           NOR=Angir nummeret pÜ kampanjen som dokumentet er knyttet til.;
                           SVE=Anger kampanjnumret som dokumentet Ñr lÑnkat till.];
                ApplicationArea=#Suite;
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 81  ;2   ;Field     ;
                CaptionML=[ENU=Alternate Vendor Address Code;
                           NOR=Alternativ adressekode for leverandõr;
                           SVE=Kod fîr alternativ leverantîrsadress];
                ToolTipML=[ENU="Specifies the code for an alternate address, which you can send the FRQ to is the primary address is not active. ";
                           NOR="Angir koden for en alternativ adresse, som du kan sende FRQ-en til hvis den primëre adressen ikke er aktiv. ";
                           SVE="Anger koden fîr en alternativ adress, som du kan skicka anbudsfîrfrÜgan till om den primÑra adressen inte Ñr aktiv. "];
                ApplicationArea=#Suite;
                SourceExpr="Order Address Code";
                Importance=Additional }

    { 1210190000;2;Field  ;
                SourceExpr="Job No." }

    { 1100485034;2;Field  ;
                SourceExpr="Service Order No.";
                Importance=Additional }

    { 1100528901;2;Field  ;
                SourceExpr="Purchase Requisition No.";
                Importance=Additional }

    { 1100528900;2;Field  ;
                SourceExpr="Requested Quote Receipt Date" }

    { 113 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the responsibility center, such as a distribution hub, that is associated with the involved user, company, customer, or vendor.;
                           NOR=Angir koden til ansvarssenteret, for eksempel en distribusjonshub, som er knyttet til den involverte brukeren, selskapet, kunden eller leverandõren.;
                           SVE=Anger koden fîr ansvarsenheten, till exempel ett distributionsnav, som associeras med anvÑndaren, fîretaget, kunden eller leverantîren i frÜga.];
                ApplicationArea=#Suite;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 1100528401;2;Field  ;
                CaptionML=[ENU=Approval by User;
                           SVE=GodkÑnnande av anvÑndare];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApprover(RECORDID,0) }

    { 1100528400;2;Field  ;
                CaptionML=[ENU=Approval by User Name;
                           SVE=GodkÑnnande av anvÑndarnamn];
                SourceExpr=ApprovalManagement4PSConstr.GetNextApproverName(RECORDID,0) }

    { 107 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the record is open, waiting to be approved, invoiced for prepayment, or released to the next stage of processing.;
                           NOR=Angir om posten er Üpen, om den venter pÜ godkjenning, om den er fakturert for forskudd eller om den er frigitt til neste fase i behandlingen.;
                           SVE=Anger om posten Ñr îppen, vÑntar pÜ att godkÑnnas, har fakturerats fîr fîrskottsbetalning eller har slÑppts till nÑsta steg i behandlingen.];
                ApplicationArea=#Suite;
                SourceExpr=Status;
                Importance=Standard }

    { 1100529401;2;Field  ;
                SourceExpr="Back-to-back" }

    { 12013587;2;Field    ;
                SourceExpr=Approve }

    { 12013588;2;Field    ;
                SourceExpr="Requisition No." }

    { 12013589;2;Field    ;
                CaptionML=[ENU=Approval Status;
                           SVE=GodkÑnnandestatus];
                SourceExpr=ExFlowStatusFromPO;
                Visible=ExFlowVisible;
                OnDrillDown=BEGIN
                              ExFlowStatusDrillDownFromPO;
                            END;
                             }

    { 12013590;2;Field    ;
                SourceExpr="Gross Invoice Amount ExFlow";
                Visible=ExFlowVisible }

    { 58  ;1   ;Part      ;
                Name=PurchLines;
                ApplicationArea=#Suite;
                Description=//**4PS: Enable/Ediitable: "Buy-from Vendor No." -> "Buy-from Vendor Name" <> '';
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page97;
                Enabled="Buy-from Vendor Name" <> '';
                Editable="Buy-from Vendor Name" <> '';
                PartType=Page;
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer;
                           SVE=Fakturadetaljer];
                GroupType=Group }

    { 1101200000;2;Field  ;
                SourceExpr="Your Reference" }

    { 1210190006;2;Field  ;
                SourceExpr="Price Agreement";
                Editable=PriceAgreementEditable }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                               ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                LookupPageID=Cost Object List;
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbelõpet.;
                           SVE=Anger en formel som berÑknar betalningsfîrfallodatumet, kassarabattsdatumet och kassarabattens belopp.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Standard }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the related purchase invoice must be paid.;
                           NOR=Angir nÜr den relaterte kjõpsfakturaen mÜ betales.;
                           SVE=Anger nÑr den relaterade inkîpsfakturan mÜste vara betald.];
                ApplicationArea=#Suite;
                SourceExpr="Due Date";
                Importance=Standard }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis betaling utfõres innen datoen i feltet Kont.rabattdato.;
                           SVE=Anger den procentuella kassarabatten som anvÑnds om betalningen gîrs senast det datum som anges i fÑltet Kassarabattsdatum.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Discount %";
                Importance=Additional }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                           NOR=Angir datoen da belõpet i posten mÜ vëre betalt for at det kan oppnÜs kontantrabatt.;
                           SVE=Anger datumet dÜ postbeloppet mÜste vara betalt fîr att orderns kassarabatt ska gÑlla.];
                ApplicationArea=#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the delivery conditions of the related shipment, such as free on board (FOB).;
                           NOR=Angir leveringsbetingelsene for den tilknyttede leveringen, for eksempel Fritt ombord (FOB).;
                           SVE=Anger leveransvillkoren fîr den relaterade utleveransen, till exempel fritt ombord.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code" }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment of the purchase invoice.;
                           NOR=Angir betalingen for kjõpsfakturaen.;
                           SVE=Anger betalningen av inkîpsfakturan.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Reference" }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor.;
                           NOR=Angir nummeret for leverandõren.;
                           SVE=Anger leverantîrens nummer.];
                ApplicationArea=#Suite;
                SourceExpr="Creditor No." }

    { 1060000;2;Field     ;
                ToolTipML=[ENU=Specifies the vendor's giro account.;
                           SVE=Anger leverantîrens gironr.];
                SourceExpr="Giro Acc. No.";
                Visible=DKinfoEnable }

    { 1100285001;2;Field  ;
                SourceExpr="Prices Including VAT" }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the related entry represents an unpaid invoice for which either a payment suggestion, a reminder, or a finance charge memo exists.;
                           NOR=Angir at den relaterte oppfõringen representerer en ubetalt faktura som det finnes et betalingsforslag, en purring eller en rentenota for.;
                           SVE=Anger att den relaterade transaktionen representerar en obetald faktura som det finns ett betalningsfîrslag, en betalningspÜminnelse eller en rÑntefaktura fîr.];
                ApplicationArea=#Suite;
                SourceExpr="On Hold";
                Importance=Additional }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling;
                           SVE=Leverans och betalning];
                GroupType=Group }

    { 1100485005;2;Field  ;
                SourceExpr="Ship-to Project" }

    { 1100485006;2;Field  ;
                SourceExpr=Deliver }

    { 1100485007;2;Field  ;
                SourceExpr="Ship-to Location";
                OnAssistEdit=BEGIN
                               //**4PS
                               OnAssistShipToLocation();
                             END;
                              }

    { 45  ;2   ;Group     ;
                CaptionML=SVE=Leverans;
                GroupType=Group }

    { 20  ;3   ;Group     ;
                GroupType=Group }

    { 53  ;4   ;Field     ;
                Name=ShippingOptionWithLocation;
                CaptionML=[ENU=Ship-to;
                           NOR=Forsendelsesadresse;
                           SVE=Leverans];
                ToolTipML=[ENU=Specifies the address that the products on the purchase document are shipped to. Default (Company Address): The same as the company address specified in the Company Information window. Location: One of the company's location addresses. Customer Address: Used in connection with drop shipment. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Angir adressen som produktene i kjõpsdokumentet skal sendes til. Standard (selskapsadresse): Det samme som selskapsadressen angitt i vinduet Selskapsopplysninger. Lokasjon: En av selskapets adresser. Kundeadresse: Brukes i forbindelse med direktelevering. Tilpasset adresse: En forsendelsesadresse du angir i feltene nedenfor.;
                           SVE=Anger den adress som produkterna i inkîpsdokumentet levereras till. StandardvÑrde (fîretagsadress): Samma som den fîretagsadress som anges i fîretagets informationsfînster. Plats: En av fîretagets lagerstÑlleadresser. Kundadress: AnvÑnd i samband med direktutleverans. Anpassad adress: Valfri leveransadress som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Company Address),Location,Customer Address,Custom Address;
                                 NOR=Standard (selskapsadresse),Lokasjon,Kundeadresse,Egendefinert adresse;
                                 SVE=Standard (fîretagets adress),Plats,Kundadress,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                Visible=StandardShippingOptionsVisible;
                HideValue=NOT ShowShippingOptionsWithLocation AND (ShipToOptions = ShipToOptions::Location);
                OnValidate=BEGIN
                             ValidateShippingOption;
                           END;
                            }

    { 49  ;4   ;Field     ;
                Name=ShippingOptionWithoutLocation;
                CaptionML=[ENU=Ship-to;
                           NOR=Forsendelsesadresse;
                           SVE=Leverans];
                ToolTipML=[ENU=Specifies the address that the products on the purchase document are shipped to. Default (Company Address): The same as the company address specified in the Company Information window. Customer Address: Used in connection with drop shipment. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Angir adressen som produktene i kjõpsdokumentet skal sendes til. Standard (selskapsadresse): Det samme som selskapsadressen angitt i Selskapsopplysninger-vinduet. Kundeadresse. Brukes i forbindelse med direktelevering. Tilpasset adresse: En forsendelsesadresse du angir i feltene under.;
                           SVE=Anger den adress som produkterna i inkîpsdokumentet levereras till. StandardvÑrde (fîretagsadress): Samma som den fîretagsadress som anges i fîretagets informationsfînster. Kundadress: AnvÑnd i samband med direktutleverans. Anpassad adress: Valfri leveransadress som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Company Address),,Customer Address,Custom Address;
                                 NOR=Standard (selskapsadresse),,Kundeadresse,Egendefinert adresse;
                                 SVE=Standard (fîretagets adress),,Kundadress,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                Visible=StandardShippingOptionsVisible;
                HideValue=ShowShippingOptionsWithLocation AND (ShipToOptions = ShipToOptions::Location);
                OnValidate=BEGIN
                             ValidateShippingOption
                           END;
                            }

    { 57  ;4   ;Group     ;
                GroupType=Group }

    { 55  ;5   ;Group     ;
                Visible=StandardShippingOptionsVisible;
                GroupType=Group }

    { 89  ;6   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the location where you want the items to be placed when they are received.;
                           NOR=Angir en kode for lokasjonen der du vil at de bestilte varene skal plasseres.;
                           SVE=Anger en kod fîr det lagerstÑlle dÑr du vill att artiklarna placeras nÑr de har inlevererats.];
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Importance=Standard;
                Visible=StandardShippingOptionsVisible }

    { 1100528503;5;Group  ;
                Visible=(Deliver  = Deliver::"Customer Address") OR (Deliver = Deliver::"Customer Ship-to Address");
                GroupType=Group }

    { 1100528502;6;Field  ;
                ToolTipML=[ENU=Specifies the code for another delivery address than the vendor's own address, which is entered by default.;
                           SVE=Anger koden fîr en annan leveransadress Ñn kundens egna adress, som anges som standard.];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to Code";
                Editable=("Sell-to Customer No." <> '') }

    { 40  ;6   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the customer that items on the purchase order were shipped to, as a drop shipment.;
                           NOR=Angir navnet pÜ kunden som varer i bestillingen ble levert til, som en direktelevering.;
                           SVE=Anger namnet pÜ kunden som artiklarna pÜ inkîpsordern utlevererades till, som en direktutleverans.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Importance=Promoted;
                Editable=Deliver = Deliver::"Custom Address" }

    { 1100485001;6;Field  ;
                CaptionML=[ENU=Name 2;
                           SVE=Namn 2];
                SourceExpr="Ship-to Name 2";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address" }

    { 42  ;6   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address that items on the purchase order were shipped to, as a drop shipment.;
                           NOR=Angir adressen som varer i bestillingen ble levert til, som en direktelevering.;
                           SVE=Anger adressen dit artiklarna pÜ inkîpsordern levererades, som en direktutleverans.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 44  ;6   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies an additional part of the address that items on the purchase order were shipped to, as a drop shipment.;
                           NOR=Angir en tilleggsdel for adressen som varer i bestillingen ble levert til, som en direktelevering.;
                           SVE=Anger ett tillÑgg till adressen dit artiklarna pÜ inkîpsordern levererades, som en direktutleverans.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 90  ;5   ;Group     ;
                Visible=IsShipToCountyVisible;
                GroupType=Group }

    { 86  ;6   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the county of the address that you want the items on the purchase document to be shipped to.;
                           NOR=Angir fylket i adressen som du vil at varene i kjõpsdokumentet skal leveres til.;
                           SVE=Anger lÑnet fîr den adress dit du vill att artiklarna pÜ inkîpsdokumentet ska levereras.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 94  ;5   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the post code that items on the purchase order were shipped to, as a drop shipment.;
                           NOR=Angir postnummeret som varer i bestillingen ble levert til, som en direktelevering.;
                           SVE=Anger postnumret dit artiklarna pÜ inkîpsordern levererades, som en direktutleverans.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 46  ;5   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city that items on the purchase order were shipped to, as a drop shipment.;
                           NOR=Angir poststedet som varer i bestillingen ble levert til, som en direktelevering.;
                           SVE=Anger orten dit artiklarna pÜ inkîpsordern levererades, som en direktutleverans.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address";
                QuickEntry=FALSE }

    { 88  ;5   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Importance=Additional;
                Editable=Deliver = Deliver::"Custom Address";
                OnValidate=BEGIN
                             IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 48  ;5   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the contact person at the customer that items on the purchase order were shipped to, as a drop shipment.;
                           NOR=Angir kontaktpersonen hos kunden som varer i bestillingen ble levert til, som en direktelevering.;
                           SVE=Anger kontaktpersonen hos kunden som artiklarna pÜ inkîpsordern utlevererades till, som en direktutleverans.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU="Specifies the date you expect the items to be available in your warehouse. If you leave the field blank, it will be calculated as follows: Planned Receipt Date + Safety Lead Time + Inbound Warehouse Handling Time = Expected Receipt Date.";
                           NOR="Angir datoen da du forventer at varene skal vëre tilgjengelige pÜ lager. Hvis du lar dette feltet vëre tomt, blir det beregnet pÜ fõlgende mÜte: Planlagt mottaksdato + Sikkerhetsleveringstid + InngÜende lagerhÜndteringstid = Forventet mottaksdato.";
                           SVE="Anger det datum dÜ du vÑntar dig att artiklarna ska vara tillgÑngliga i distributionslagret. Om du inte anger nÜgot berÑknas det sÜ hÑr: Planerat inleveransdatum + SÑkerhetsledtid + Ankommande distributionslagerhanteringstid = FîrvÑntat inleveransdatum."];
                ApplicationArea=#Suite;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how to make payment, such as with bank transfer, cash, or check.;
                           NOR=Angir hvordan du utfõrer en betaling, for eksempel med bankoverfõring, kontanter eller sjekk.;
                           SVE=Anger hur kunden betalar, t.ex. med bankîverfîring, kontanter eller check.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional }

    { 1210190013;2;Field  ;
                SourceExpr=Expediter }

    { 1100529400;2;Field  ;
                CaptionML=[ENU=Destination;
                           SVE=Destination];
                SourceExpr=PurchaseHeaderExtension.Destination;
                OnValidate=BEGIN
                             PurchaseHeaderExtensionUpdate;
                           END;
                            }

    { 1210190034;2;Field  ;
                SourceExpr="Lead Time Calculation" }

    { 51  ;2   ;Group     ;
                CaptionML=SVE=Betalas;
                GroupType=Group }

    { 60  ;3   ;Field     ;
                Name=PayToOptions;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til;
                           SVE=Betalas];
                ToolTipML=[ENU=Specifies the vendor that the purchase document will be paid to. Default (Vendor): The same as the vendor on the purchase document. Another Vendor: Any vendor that you specify in the fields below.;
                           NOR=Angir leverandõren som kjõpsdokumentet betales til. Standard (leverandõr): Det samme som leverandõren pÜ kjõpsdokumentet. En annen leverandõr: En leverandõr du angir i feltene nedenfor.;
                           SVE=Anger den leverantîr som inkîpsdokumentet utbetalas till. StandardvÑrde (Leverantîr): Samma som leverantîren pÜ inkîpsdokumentet. Annan leverantîr: Valfri leverantîr som du anger i fÑlten nedan.];
                OptionCaptionML=[ENU=Default (Vendor),Another Vendor,Custom Address;
                                 NOR=Standard (leverandõr),en annen leverandõr,kundeadresse;
                                 SVE=Standard (leverantîr),Annan leverantîr,Anpassad adress];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=PayToOptions;
                OnValidate=BEGIN
                             IF PayToOptions = PayToOptions::"Default (Vendor)" THEN
                               VALIDATE("Pay-to Vendor No.","Buy-from Vendor No.");
                           END;
                            }

    { 67  ;3   ;Group     ;
                Visible=NOT (PayToOptions = PayToOptions::"Default (Vendor)");
                GroupType=Group }

    { 22  ;4   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the vendor that you received the invoice from.;
                           NOR=Angir navnet pÜ leverandõren du har mottatt fakturaen fra.;
                           SVE=Anger namnet pÜ leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                Enabled=PayToOptions = PayToOptions::"Another Vendor";
                Editable=PayToOptions = PayToOptions::"Another Vendor";
                OnValidate=BEGIN
                             IF GETFILTER("Pay-to Vendor No.") = xRec."Pay-to Vendor No." THEN
                               IF "Pay-to Vendor No." <> xRec."Pay-to Vendor No." THEN
                                 SETRANGE("Pay-to Vendor No.");

                             CurrPage.UPDATE;
                           END;
                            }

    { 24  ;4   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the vendor that you received the invoice from.;
                           NOR=Angir adressen til leverandõren som du har mottatt fakturaen fra.;
                           SVE=Anger adressen till leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 26  ;4   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies an additional part of the address of the vendor that the invoice was received from.;
                           NOR=Angir en tilleggsdel for adressen til leverandõren du har mottatt fakturaen fra.;
                           SVE=Anger ett tillÑgg till adressen till leverantîren som fakturan mottogs frÜn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 84  ;4   ;Group     ;
                Visible=IsPayToCountyVisible;
                GroupType=Group }

    { 80  ;5   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the county of the vendor on the purchase document.;
                           NOR=Angir fylket for leverandõren pÜ kjõpsdokumentet.;
                           SVE=Anger leverantîrens lÑn i inkîpsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to County";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 82  ;4   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the post code of the vendor that you received the invoice from.;
                           NOR=Angir postnummeret for leverandõren som du har mottatt fakturaen fra.;
                           SVE=Anger postnumret fîr leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 28  ;4   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the vendor that you received the invoice from.;
                           NOR=Angir poststedet til leverandõren du har mottatt fakturaen fra.;
                           SVE=Anger orten fîr leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                QuickEntry=FALSE }

    { 83  ;4   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Country/Region Code";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                OnValidate=BEGIN
                             IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
                           END;

                QuickEntry=FALSE }

    { 141 ;4   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the customer associated with the purchase quote.;
                           NOR=Angir nummeret pÜ kunden som er knyttet til forespõrselen.;
                           SVE=Anger numret pÜ kunden som Ñr kopplad till inkîpsofferten.];
                ApplicationArea=#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.") }

    { 30  ;4   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the contact person at the vendor that you received the invoice from.;
                           NOR=Angir kontaktpersonen hos leverandõren som du har mottatt fakturaen fra.;
                           SVE=Anger kontaktpersonen hos leverantîren som du mottog fakturan av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Enabled=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.");
                Editable=(PayToOptions = PayToOptions::"Custom Address") OR ("Buy-from Vendor No." <> "Pay-to Vendor No.") }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel;
                           SVE=Utlandshandel] }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency of amounts on the purchase document.;
                           NOR=Angir valutaen til belõpene pÜ kjõpsdokumentet.;
                           SVE=Anger valutan fîr beloppen pÜ inkîpsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               ChangeExchangeRate.SetAdditionalParameters(1, "Job No.", FALSE); //**4PS.n
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 SaveInvoiceDiscountAmount;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1000001;2;Field     ;
                ToolTipML=[ENU=Select this field if the purchase order is involved in an EU 3-party trade.;
                           SVE=Markera det hÑr fÑltet om inkîpsordern ingÜr i en EU trepartshandel.];
                SourceExpr="EU 3-Party Trade" }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of transaction that the document represents, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transaksjonstypen som dokumentet representerer ved rapportering til INTRASTAT.;
                           SVE=Anger den transaktionstyp som dokumentet representerar fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Type";
                Importance=Promoted }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a specification of the document's transaction, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir en spesifikasjon for dokumentets transaksjon ved rapportering til INTRASTAT.;
                           SVE=Anger en specifikation av fîrsÑljningsdokumentets transaktion fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr="Transaction Specification";
                Importance=Additional }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transportmÜten ved rapportering til INTRASTAT.;
                           SVE=Anger transportsÑttet fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr="Transport Method";
                Importance=Additional }

    { 47  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the port of entry where the items pass into your country/region, for reporting to Intrastat.;
                           NOR=Angir koden for innfõrselsstedet der varene kommer inn i landet/omrÜdet, for rapportering til Intrastat.;
                           SVE=Anger koden fîr inskeppningshamnen dÑr artiklarna kommer till ditt land/din region, fîr rapportering till Intrastat.];
                ApplicationArea=#Suite;
                SourceExpr="Entry Point";
                Importance=Additional }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area of the customer or vendor, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir omrÜdet for kunden eller leverandõren ved rapportering til INTRASTAT.;
                           SVE=Anger omrÜdet i kundens eller leverantîrens adress fîr inrapportering till INTRASTAT.];
                ApplicationArea=#Suite;
                SourceExpr=Area;
                Importance=Additional }

    { 1100485032;2;Field  ;
                SourceExpr="Company VAT Registration No." }

    { 1100485030;2;Field  ;
                SourceExpr="VAT Registration No." }

    { 1100485027;2;Field  ;
                SourceExpr="Country of Origin" }

    { 1100485026;2;Field  ;
                SourceExpr="Country of Destination" }

    { 1903162601;1;Group  ;
                CaptionML=[ENU=ICK;
                           SVE=ICK] }

    { 1210190079;2;Field  ;
                SourceExpr="ICM Login Code" }

    { 1210190077;2;Field  ;
                SourceExpr="ICM Status";
                Importance=Promoted;
                Editable=ICMFieldsEditable }

    { 1210190075;2;Field  ;
                SourceExpr="ICM Procedure";
                Importance=Promoted;
                Editable=ICMFieldsEditable }

    { 1210190073;2;Field  ;
                SourceExpr="Reference (ICM)";
                Editable=ICMFieldsEditable }

    { 1210190071;2;Field  ;
                Name=PhoneICM;
                CaptionML=[ENU=Phone No. (ICM);
                           SVE=Telefonnr (ICM)];
                SourceExpr=[PhoneICM ];
                Editable=ICMFieldsEditable;
                OnValidate=BEGIN
                             PhoneICMOnAfterValidate;
                           END;
                            }

    { 1210190069;2;Field  ;
                Name=ShipmentInstruct1;
                CaptionML=[ENU=Shipment Instruction 1;
                           SVE=Utleveransinstruktion 1];
                SourceExpr=ShipmentInstruct1;
                Editable=ICMFieldsEditable;
                OnValidate=BEGIN
                             ShipmentInstruct1OnAfterValida;
                           END;
                            }

    { 1210190067;2;Field  ;
                Name=ShipmentInstruct2;
                CaptionML=[ENU=Shipment Instruction 2;
                           SVE=Utleveransinstruktion 2];
                SourceExpr=ShipmentInstruct2;
                Editable=ICMFieldsEditable;
                OnValidate=BEGIN
                             ShipmentInstruct2OnAfterValida;
                           END;
                            }

    { 1210190065;2;Field  ;
                SourceExpr="ICM File Created on" }

    { 1210190063;2;Field  ;
                SourceExpr="ICM File Sent" }

    { 1210190061;2;Field  ;
                SourceExpr="ICM Order Confirm. Received on" }

    { 1210190058;2;Field  ;
                SourceExpr="ICM Confirmations" }

    { 1210190057;2;Field  ;
                SourceExpr="ICM Errors" }

    { 1901254101;1;Group  ;
                CaptionML=[ENU=Status;
                           SVE=Status] }

    { 1210190047;2;Field  ;
                SourceExpr="Quote Status";
                Importance=Promoted;
                OnValidate=BEGIN
                             QuoteStatusOnAfterValidate;
                           END;
                            }

    { 1210190045;2;Field  ;
                SourceExpr="No. Printed";
                Importance=Promoted }

    { 1210190044;2;Field  ;
                SourceExpr="Write Off Letter Printed" }

    { 1210190043;2;Field  ;
                SourceExpr="No. of Archived Versions";
                Importance=Additional }

    { 1210190042;2;Field  ;
                SourceExpr="Vendors react before" }

    { 1210190041;2;Field  ;
                Lookup=Yes;
                SourceExpr="Comparison Quote";
                OnAssistEdit=BEGIN
                               //**4PS
                               IF ("Comparison Quote" = "No.") THEN
                                 EXIT;

                               IF ("Comparison Quote" = '') THEN BEGIN
                                 IF NOT CONFIRM(Text11012003, TRUE, "No.", FIELDCAPTION("Comparison Quote")) THEN
                                   EXIT;
                               END ELSE BEGIN
                                 IF NOT CONFIRM(Text11012004, FALSE, "No.", FIELDCAPTION("Comparison Quote"), "Comparison Quote") THEN
                                   EXIT;
                               END;

                               "Comparison Quote" := "No.";
                             END;
                              }

    { 1210190046;2;Field  ;
                SourceExpr="Document Confirmation Received" }

    { 1100529000;2;Field  ;
                SourceExpr="FSC Type Code" }

    { 1210190048;2;Field  ;
                SourceExpr="Modified by" }

    { 1210190037;2;Field  ;
                SourceExpr="Last Date Modified" }

    { 1210190036;2;Field  ;
                SourceExpr="E-Mail Sent by";
                Editable=FALSE }

    { 1210190032;2;Field  ;
                SourceExpr="E-Mail Sent on";
                Editable=FALSE }

    { 1100528403;2;Field  ;
                CaptionML=[ENU=GS1 Sent by;
                           SVE=GS1 skickades av];
                SourceExpr=PurchaseHeaderExtension."GS1 Sent by";
                Editable=FALSE }

    { 1100528402;2;Field  ;
                CaptionML=[ENU=GS1 Sent on;
                           SVE=GS1 skickades den];
                SourceExpr=PurchaseHeaderExtension."GS1 Sent on";
                Editable=FALSE }

    { 1210190091;2;Field  ;
                CaptionML=[ENU=GS1 Error Logs;
                           SVE=GS1-felloggar];
                SourceExpr=CheckIfGS1ErrorLogsExist;
                Editable=FALSE }

    { 150 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT specification of the involved customer or vendor to link transactions made for this record with the appropriate general ledger account according to the VAT posting setup.;
                           NOR=Angir mva-spesifikasjonen for den involverte kunden eller leverandõren for Ü koble transaksjoner som ble utfõrt for denne posten, med riktig finanskonto i henhold til det generelle mva-bokfõringsoppsettet.;
                           SVE=Anger momsspecifikationen fîr den berîrda kunden eller leverantîren i syfte att koppla transaktioner som skapas fîr posten till det lÑmpliga redovisningskontot enligt momsbokfîringsinstÑllningen.];
                ApplicationArea=#Suite;
                SourceExpr="VAT Bus. Posting Group" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 73  ;1   ;Part      ;
                Name=Attached Documents;
                CaptionML=[ENU=Attachments;
                           NOR=Vedlegg;
                           SVE=Bilagor];
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(38),
                            No.=FIELD(No.),
                            Document Type=FIELD(Document Type);
                PagePartID=Page1174;
                PartType=Page }

    { 13  ;1   ;Part      ;
                ApplicationArea=#Suite;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.),
                            Status=CONST(Open);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100529902;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190001;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page11130181;
                ProviderID=58;
                PartType=Page }

    { 1901138007;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9094;
                PartType=Page }

    { 1903435607;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                PartType=Page }

    { 1906949207;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 5   ;1   ;Part      ;
                ApplicationArea=#Suite;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9100;
                ProviderID=58;
                PartType=Page }

    { 1906354007;1;Part   ;
                Name=ApprovalFactBox;
                ApplicationArea=#Suite;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.),
                            Status=CONST(Open);
                PagePartID=Page9092;
                PartType=Page }

    { 27  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Suite;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 41  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#Suite;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CopyPurchDoc@1002 : Report 492;
      ApplicationAreaMgmtFacade@1016 : Codeunit 9179;
      DocPrint@1003 : Codeunit 229;
      UserMgt@1004 : Codeunit 5700;
      ArchiveManagement@1005 : Codeunit 5063;
      PurchCalcDiscByType@1006 : Codeunit 66;
      FormatAddress@1020 : Codeunit 365;
      ChangeExchangeRate@1001 : Page 511;
      ShipToOptions@1014 : 'Default (Company Address),Location,Custom Address';
      PayToOptions@1013 : 'Default (Vendor),Another Vendor,Custom Address';
      HasIncomingDocument@1008 : Boolean;
      DocNoVisible@1000 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1012 : Boolean;
      OpenApprovalEntriesExist@1011 : Boolean;
      ShowWorkflowStatus@1007 : Boolean;
      CanCancelApprovalForRecord@1009 : Boolean;
      ShowShippingOptionsWithLocation@1015 : Boolean;
      IsBuyFromCountyVisible@1017 : Boolean;
      IsPayToCountyVisible@1018 : Boolean;
      IsShipToCountyVisible@1019 : Boolean;
      PurchSetup@1100409000 : Record 312;
      PurchaseHeaderExtension@1100528400 : Record 11020398;
      Text11012002@1210190014 : TextConst 'ENU=Generate New Quote?;SVE=Generera ny offert?';
      Text11012003@1210190015 : TextConst 'ENU=Setup current Quote %1 as %2 ?;SVE=Vill du stÑlla in den aktuella offerten %1 som %2?';
      Text11012004@1210190009 : TextConst 'ENU=Current Quote %1 is linked to %2 %3. The current Quote wll be setup as %2, so the link will be disconnected.\ \Are you sure ?;SVE=Aktuell offert %1 Ñr lÑnkad till %2 %3. Aktuell offert kommer att stÑllas in som %2, vilket betyder att lÑnken tas bort.\ \ér du sÑker?';
      gFromReference@1210190011 : Boolean;
      gQuoteLineNo@1210190016 : Integer;
      PhasePlanMgt@1100525000 : Codeunit 11012242;
      DPA_IsHardFilter@1100000999 : Boolean;
      ShipmentInstruct1@1210190003 : Text[38];
      ShipmentInstruct2@1210190002 : Text[38];
      PhoneICM@1210190000 : Text[13];
      PriceAgreementEditable@19020391 : Boolean INDATASET;
      ICMFieldsEditable@1210190007 : Boolean INDATASET;
      ApprovalManagement4PSConstr@1100528401 : Codeunit 11125349;
      Text11012005@1100527450 : TextConst 'ENU=Purchase Quote with status ''Pending Approval'' cannot be closed';
      StandardShippingOptionsVisible@1100528500 : Boolean INDATASET;
      GLSetup@111285700 : Record 98;
      DKinfoEnable@11128570 : Boolean INDATASET;
      "**ExFlow"@12013591 : Integer;
      ExFlow@12013596 : Codeunit 12013601;
      ExFlowVisible@1100285500 : Boolean INDATASET;

    LOCAL PROCEDURE ActivateFields@3();
    BEGIN
      IsBuyFromCountyVisible := FormatAddress.UseCounty("Buy-from Country/Region Code");
      IsPayToCountyVisible := FormatAddress.UseCounty("Pay-to Country/Region Code");
      IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SaveInvoiceDiscountAmount@14();
    VAR
      DocumentTotals@1000 : Codeunit 57;
    BEGIN
      CurrPage.SAVERECORD;
      DocumentTotals.PurchaseRedistributeInvoiceDiscountAmountsOnDocument(Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.PurchaseDocumentNoIsVisible(DocType::Quote,"No.");
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
    END;

    LOCAL PROCEDURE ValidateShippingOption@8();
    BEGIN
      EXIT; //**4PS.n

      CASE ShipToOptions OF
        ShipToOptions::"Default (Company Address)",
        ShipToOptions::"Custom Address":
          VALIDATE("Location Code",'');
        ShipToOptions::Location:
          VALIDATE("Location Code");
      END;
    END;

    LOCAL PROCEDURE CalculateCurrentShippingAndPayToOption@36();
    BEGIN
      IF "Location Code" <> '' THEN
        ShipToOptions := ShipToOptions::Location
      ELSE
        IF ShipToAddressEqualsCompanyShipToAddress THEN
          ShipToOptions := ShipToOptions::"Default (Company Address)"
        ELSE
          ShipToOptions := ShipToOptions::"Custom Address";

      CASE TRUE OF
        ("Pay-to Vendor No." = "Buy-from Vendor No.") AND BuyFromAddressEqualsPayToAddress:
          PayToOptions := PayToOptions::"Default (Vendor)";
        ("Pay-to Vendor No." = "Buy-from Vendor No.") AND (NOT BuyFromAddressEqualsPayToAddress):
          PayToOptions := PayToOptions::"Custom Address";
        "Pay-to Vendor No." <> "Buy-from Vendor No.":
          PayToOptions := PayToOptions::"Another Vendor";
      END;

      OnAfterCalculateCurrentShippingAndPayToOption(ShipToOptions,PayToOptions,Rec);
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCalculateCurrentShippingAndPayToOption@4(VAR ShipToOptions@1001 : 'Default (Company Address),Location,Custom Address';VAR PayToOptions@1000 : 'Default (Vendor),Another Vendor,Custom Address';PurchaseHeader@1002 : Record 38);
    BEGIN
    END;

    PROCEDURE InitSelectionFromReference@1210190000(IQuoteLineNo@1210190013 : Integer);
    BEGIN
      //**4PS
      gFromReference := TRUE;
      gQuoteLineNo := IQuoteLineNo;
    END;

    PROCEDURE SelectEstLineForQuote@1100525000();
    VAR
      EstLineRecNEW@1100528907 : Record 11072072;
      RcpLineRecNEW@1100528905 : Record 11072075;
      lHeader@1100528904 : Code[20];
      CopyEstToPurchQuoteForm@1100528903 : Page 11012136;
      SelectEstForPurchQuoteNEW@1100528900 : Report 11229767;
    BEGIN
      //**4PS
      IF "No." <> '' THEN BEGIN
        IF CONFIRM(Text11012002) THEN
          lHeader := ''
        ELSE
          lHeader := "No.";
      END ELSE
        lHeader := '';

      CLEAR(SelectEstForPurchQuoteNEW);
      EstLineRecNEW.SETRANGE("Ask for Quote", TRUE);
      EstLineRecNEW.SETFILTER("Purchase Route Reference", '%1', '');
      SelectEstForPurchQuoteNEW.SETTABLEVIEW(EstLineRecNEW);

      RcpLineRecNEW.SETRANGE("Ask for Quote", TRUE);
      RcpLineRecNEW.SETFILTER("Purchase Route Reference", '%1', '');
      SelectEstForPurchQuoteNEW.SETTABLEVIEW(RcpLineRecNEW);
      SelectEstForPurchQuoteNEW.RUNMODAL;

      CopyEstToPurchQuoteForm.SetOrderNo(lHeader);
      CopyEstToPurchQuoteForm.StdDialogRunModal;
    END;

    LOCAL PROCEDURE ShipmentInstruct2OnAfterValida@19004685();
    BEGIN
      //**4PS
      HandleShipmentInstruction(1, ShipmentInstruct1, ShipmentInstruct2);
    END;

    LOCAL PROCEDURE ShipmentInstruct1OnAfterValida@19023030();
    BEGIN
      //**4PS
      HandleShipmentInstruction(1, ShipmentInstruct1, ShipmentInstruct2);
    END;

    LOCAL PROCEDURE PhoneICMOnAfterValidate@19008432();
    BEGIN
      //**4PS
      HandlePhoneICM(1, PhoneICM);
    END;

    LOCAL PROCEDURE QuoteStatusOnAfterValidate@19051277();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRec@19077479();
    VAR
      RecRef@1100528700 : RecordRef;
    BEGIN
      //**4PS
      HandlePhoneICM(0, PhoneICM);
      HandleShipmentInstruction(0, ShipmentInstruct1, ShipmentInstruct2);

      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Shortcut Dimension 1 Code");
    END;

    PROCEDURE UpdateEditable@1210190003();
    BEGIN
      //**4PS
      CALCFIELDS("ICM Login Code");
      ICMFieldsEditable := "ICM Login Code" <> '';
      PriceAgreementEditable := PurchSetup."Price Agreement" = PurchSetup."Price Agreement"::Order;
    END;

    LOCAL PROCEDURE PurchaseHeaderExtensionUpdate@1100529400();
    BEGIN
      //**4PS
      PurchaseHeaderExtension.UpdatePurchHeadExtension("Document Type", "No.");
    END;

    BEGIN
    {
      4PS 24-09-2009 PS, Approval removed
      4PS 20-09-16 UKR-C27159 VAKAT: BI032 checkbox Back-to-back - Added field
      4PS 30-03-18 DP01917 OLKOL: Action Approve changed
      --- ExFlow --->
      Field General : Approve
      Field General : Requisition No.
      Field General : Approval Status
      Field General : Gross Invoice Amount
      Action : Show document
      Action : Attached Files
      Globals
      Variables   :ExFlow
      190401 SICH Upgraded to 513
      <-- ExFlow ---
    }
    END.
  }
}

