OBJECT Page 11072063 Segment
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.01,4PS14.00 (5091);
  }
  PROPERTIES
  {
    CaptionML=[DEU=Segment;
               ENU=Segment;
               NLD=Segment;
               NOR=Segment;
               SVE=Segment];
    SourceTable=Table11072039;
    PopulateAllFields=Yes;
    PageType=ListPlus;
    PromotedActionCategoriesML=[DEU=Neu, Verarbeiten, Bericht, Filter;
                                ENU=New,Process,Report,Filter;
                                NLD=Nieuw,Proces,Lijst,Filteren;
                                NOR=Ny,Behandle,Rapport,Filter;
                                SVE=Ny,Behandla,Rapport,Filter];
    OnInit=BEGIN
             UnitDurationMinEnable := TRUE;
             UnitCostLCYEnable := TRUE;
             InitiatedByEnable := TRUE;
             InformationFlowEnable := TRUE;
             IgnoreContactCorresTypeEnable := TRUE;
             AttachmentEnable := TRUE;
             LanguageCodeDefaultEnable := TRUE;
             SubjectDefaultEnable := TRUE;
             CorrespondenceTypeDefaultEnabl := TRUE;
             CampaignResponseEnable := TRUE;
             CampaignTargetEnable := TRUE;

             //**4PS.sn
             "Optional Mergefield 1Enable" := TRUE;
             "Optional Mergefield 2Enable" := TRUE;
             "Optional Mergefield 3Enable" := TRUE;
             "Optional Mergefield 4Enable" := TRUE;
             "Optional Mergefield 5Enable" := TRUE;
             //**4PS.en
           END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("Attachment No.");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateEditable;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Segment;
                                 ENU=&Segment;
                                 NLD=&Segment;
                                 NOR=&Segment;
                                 SVE=S&egment];
                      Image=Segment }
      { 68      ;2   ;Action    ;
                      CaptionML=[DEU=Kriterien;
                                 ENU=Criteria;
                                 NLD=Criteria;
                                 NOR=Kriterium;
                                 SVE=Kriterium];
                      ToolTipML=[DEU=Zeigt eine Liste der Aktionen (HinzufÅgen oder Entfernen von Kontakten) an, die Sie zur Definition der Segmentkriterien durchgefÅhrt haben.;
                                 ENU=View a list of the actions that you have performed (adding or removing contacts) in order to define the segment criteria.;
                                 NLD=Een overzicht bekijken van de acties die u hebt uitgevoerd (toevoegen of verwijderen van contacten) om de segmentcriteria te definiºren.;
                                 NOR=Vis en oversikt over hvilke handlinger du har utfõrt (om du har tilfõyd eller fjernet kontakter) for Ü definere segmentkriteriene.;
                                 SVE=Visa en lista îver de ÜtgÑrder som du har utfîrt (tillÑgg eller borttagning av kontakter) fîr att definiera segmentkriterier.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 11072086;
                      RunPageLink=Segment No.=FIELD(No.);
                      Image=Filter }
      { 69      ;2   ;Action    ;
                      CaptionML=[DEU=Verkaufs&chancen;
                                 ENU=Oppo&rtunities;
                                 NLD=Oppo&rtunities;
                                 NOR=Forr&etningsmuligheter;
                                 SVE=AffÑrs&mîjligheter];
                      ToolTipML=[DEU=Zeigt die Verkaufschancen fÅr das Segment an, die von VerkÑufern bearbeitet werden. Verkaufschancen benîtigen einen Kontakt und kînnen mit Kampagnen verbunden werden.;
                                 ENU=View the sales opportunities that are handled by salespeople for the segment. Opportunities must involve a contact and can be linked to campaigns.;
                                 NLD=De verkoopopportunities weergeven die door verkopers voor het segment zijn afgehandeld. Opportunities moeten een contact omvatten en kunnen zijn gekoppeld aan campagnes.;
                                 NOR=Vis salgsmulighetene som hÜndteres av selgere for segmentet. Salgsmuligheter mÜ inkludere en kontakt, og mÜ kunne an knyttes til kampanjer.;
                                 SVE=Visa fîrsÑljningsmîjligheterna som hanteras av sÑljare fîr segmentet. Varje affÑrsmîjlighet mÜste vara knuten till en kontakt, och kan vara kopplad till kampanjer.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 11072071;
                      RunPageView=SORTING(Segment No.);
                      RunPageLink=Segment No.=FIELD(No.);
                      Image=OpportunityList }
      { 3       ;2   ;Action    ;
                      Name=Create opportunity;
                      CaptionML=[DEU=Verkaufschance erstellen;
                                 ENU=Create Opportunity;
                                 NLD=Opportunity maken];
                      ToolTipML=[DEU=Eine neue Verkaufschanenkarte erstellen.;
                                 ENU=Create a new opportunity card.;
                                 NLD=Een nieuwe opportunitykaart maken.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 11072072;
                      RunPageLink=Segment No.=FIELD(No.);
                      Image=NewOpportunity;
                      RunPageMode=Create }
      { 5       ;2   ;Action    ;
                      Name=Create opportunities;
                      CaptionML=[DEU=Verkaufschancen erstellen;
                                 ENU=Create opportunities;
                                 NLD=Opportunities maken;
                                 NOR=Opprett salgsmuligheter;
                                 SVE=Skapa affÑrsmîjligheter];
                      ToolTipML=[DEU=Eine neue Verkaufschanenkarte, die mit dem Segment verknÅpft is, erstellen.;
                                 ENU=Create a new opportunity card related to the segment.;
                                 NLD=Een nieuwe opportunitykaart maken die is gekoppeld aan het segment.];
                      ApplicationArea=#RelationshipMgmt;
                      OnAction=BEGIN
                                 CreateOpportunitiesForAllContacts;
                               END;
                                }
      { 27      ;2   ;Action    ;
                      CaptionML=[DEU=A&ufgaben;
                                 ENU=T&asks;
                                 NLD=T&aken;
                                 NOR=&Oppgaver;
                                 SVE=U&ppgifter];
                      ToolTipML=[DEU=Zeigt alle Marketingaufgaben in Bezug auf das Segment an.;
                                 ENU=View all marketing tasks that involve the segment.;
                                 NLD=Alle marketingtaken met betrekking tot het segment weergeven.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5096;
                      RunPageView=SORTING(Segment No.);
                      RunPageLink=Segment No.=FIELD(No.),
                                  System To-do Type=FILTER(Organizer|Salesperson Attendee);
                      Image=TaskList }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 25      ;1   ;Action    ;
                      Name=LogSegment;
                      CaptionML=[DEU=&Protokoll;
                                 ENU=&Log;
                                 NLD=&Logbestand;
                                 NOR=&Logg;
                                 SVE=&Logg];
                      ToolTipML=[DEU=Protokolliert Segmente und AktivitÑten, die Ihren Segmenten und LieferungsanhÑngen, die Sie gesendet haben, zugewiesen sind.;
                                 ENU=Log segments and interactions that are assigned to your segments and delivery attachments that you have sent.;
                                 NLD=Segmenten en interacties registreren die zijn toegewezen aan de segmenten en leveringsbijlagen die u hebt verzonden.;
                                 NOR=Logger segmenter og samhandlinger som er tilordnet dine segmenter og leveringsvedlegg som du har sendt.;
                                 SVE=Logga segment och interaktioner som kopplas till dina segment och leveransbilagor som du har skickat.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 LogSegment@1001 : Report 11072047;
                               BEGIN
                                 LogSegment.SetSegmentNo("No.");
                                 LogSegment.RUNMODAL;
                                 IF NOT GET("No.") THEN
                                   MESSAGE(Text011,"No.");
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions;
                                 NLD=F&uncties;
                                 NOR=Fu&nksjon;
                                 SVE=F&unktioner];
                      Image=Action }
      { 90      ;2   ;ActionGroup;
                      CaptionML=[DEU=Kontakte;
                                 ENU=Contacts;
                                 NLD=Contacten;
                                 NOR=Kontakter;
                                 SVE=Kontakter];
                      Image=CustomerContact }
      { 29      ;3   ;Action    ;
                      Name=AddContacts;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Kontakte hinzufÅgen;
                                 ENU=Add Contacts;
                                 NLD=Contacten toevoegen;
                                 NOR=Legg til kontakter;
                                 SVE=LÑgg till kontakter];
                      ToolTipML=[DEU=WÑhlt aus, welche Kontakte dem Segment hinzugefÅgt werden sollen.;
                                 ENU=Select which contacts to add to the segment.;
                                 NLD=Selecteren welke contacten moeten worden toegevoegd aan het segment.;
                                 NOR=Velg hvilke kontakter som skal legges til i segmentet.;
                                 SVE=VÑlj vilka kontakter som ska lÑggas till i segmentet.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=AddContacts;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SegHeader@1002 : Record 11072039;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Add Contacts",TRUE,FALSE,SegHeader);
                               END;
                                }
      { 30      ;3   ;Action    ;
                      Name=ReduceContacts;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Kontakte entfernen;
                                 ENU=Reduce Contacts;
                                 NLD=Contacten reduceren;
                                 NOR=Ta bort kontakter;
                                 SVE=Reducera kontakter];
                      ToolTipML=[DEU=WÑhlt aus, welche Kontakte aus dem Segment entfernt werden sollen.;
                                 ENU=Select which contacts to remove from your segment.;
                                 NLD=Selecteren welke contacten moeten worden verwijderd uit het segment.;
                                 NOR=Velg hvilke kontakter som skal fjernes fra segmentet.;
                                 SVE=VÑlj vilka kontakter som ska tas bort frÜn segmentet.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=RemoveContacts;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SegHeader@1002 : Record 11072039;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Remove Contacts - Reduce",TRUE,FALSE,SegHeader);
                               END;
                                }
      { 31      ;3   ;Action    ;
                      Name=RefineContacts;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Kontakte neu de&finieren;
                                 ENU=Re&fine Contacts;
                                 NLD=Contacten ver&fijnen;
                                 NOR=&Avgrens kontakter;
                                 SVE=&Fîrfina urval];
                      ToolTipML=[DEU=WÑhlt aus, welche Kontakte im Segment beibehalten werden sollen.;
                                 ENU=Select which contacts to keep in your segment.;
                                 NLD=Selecteren welke contacten in het segment moeten blijven.;
                                 NOR=Velg hvilke kontakter som skal beholdes i segmentet.;
                                 SVE=VÑlj vilka kontakter som du vill behÜlla i segmentet.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=ContactFilter;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SegHeader@1002 : Record 11072039;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Remove Contacts - Refine",TRUE,FALSE,SegHeader);
                               END;
                                }
      { 1100525000;2 ;ActionGroup;
                      CaptionML=[DEU=Filtern nach Kontaktmerkmal;
                                 ENU=Filter on Contact Feature;
                                 NLD=Filteren op relatiekenmerk;
                                 NOR=Filter pÜ kontaktfunksjon;
                                 SVE=Filtrera pÜ kontaktfunktion];
                      Image=CustomerContact }
      { 1210190002;3 ;Action    ;
                      CaptionML=[DEU=Filtern Merkmal (Mandant);
                                 ENU=Filter Feature (Company);
                                 NLD=Filteren kenmerk (bedrijf)];
                      Promoted=Yes;
                      Image=UseFilters;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 RelType@1210190000 : 'Company,Contact Person,Person';
                               BEGIN
                                 //**4PS
                                 FilterFeatures(RelType::Company);
                               END;
                                }
      { 1210190006;3 ;Action    ;
                      CaptionML=[DEU=Kopieren Ergebnisfilterung nach Merkmal (Betrieb);
                                 ENU=Copy result filter on company;
                                 NLD=Kopiâren resultaat filteren op kenmerk (bedrijf)];
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 RelType@1210190000 : 'Company,Contact Person,Person';
                               BEGIN
                                 //**4PS
                                 GenerateSegmentRelations(RelType::Company);
                               END;
                                }
      { 1210190003;3 ;Action    ;
                      CaptionML=[DEU=Filtermerkmal (Kontaktperson);
                                 ENU=Filter Feature (Contact person);
                                 NLD=Filteren kenmerk (contactpersoon)];
                      Promoted=Yes;
                      Image=UseFilters;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 RelType@1210190000 : 'Company,Contact Person,Person';
                               BEGIN
                                 //**4PS
                                 FilterFeatures(RelType::"Contact Person");
                               END;
                                }
      { 1210190007;3 ;Action    ;
                      CaptionML=[DEU=Ergebnisfilter nach Kontaktperson kopieren;
                                 ENU=Copy result filter on contact person;
                                 NLD=Kopiâren resultaat filteren op kenmerk (contactpersoon)];
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 RelType@1210190000 : 'Company,Contact Person,Person';
                               BEGIN
                                 //**4PS
                                 GenerateSegmentRelations(RelType::"Contact Person");
                               END;
                                }
      { 1100528700;3 ;Action    ;
                      CaptionML=[DEU=Filtermerkmal (Person);
                                 ENU=Filter Feature (Person);
                                 NLD=Filteren kenmerk (persoon)];
                      Promoted=Yes;
                      Image=UseFilters;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 RelType@1100528700 : 'Company,Contact Person,Person';
                               BEGIN
                                 //**4PS
                                 FilterFeatures(RelType::Person);
                               END;
                                }
      { 1100528701;3 ;Action    ;
                      CaptionML=[DEU=Kopieren Ergebnisfilterung nach Merkmal (Person);
                                 ENU=Copy result filter on person;
                                 NLD=Kopiâren resultaat filteren op kenmerk (persoon);
                                 NOR=Kopier resultatfilter pÜ person;
                                 SVE=Kopiera resultatfilter pÜ person];
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 RelType@1100528700 : 'Company,Contact Person,Person';
                               BEGIN
                                 //**4PS
                                 GenerateSegmentRelations(RelType::Person);
                               END;
                                }
      { 1210190000;3 ;Action    ;
                      CaptionML=[DEU=Ergebnisfilter kopieren (alle Arten);
                                 ENU=Copy result filter (all types);
                                 NLD=Kopiâren resultaat filteren op kenmerk (alle soorten);
                                 NOR=Kopier resultatfilter (alle typer)];
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 RelType@1210190001 : 'Company,Contact Person,Person';
                               BEGIN
                                 //**4PS
                                 GenerateSegmentRelations(RelType::Company);
                                 GenerateSegmentRelations(RelType::"Contact Person");
                                 GenerateSegmentRelations(RelType::Person);
                               END;
                                }
      { 28      ;2   ;ActionGroup;
                      CaptionML=[DEU=S&egment;
                                 ENU=S&egment;
                                 NLD=S&egment;
                                 NOR=S&egment;
                                 SVE=S&egment];
                      Image=Segment }
      { 33      ;3   ;Action    ;
                      CaptionML=[DEU=ZurÅck;
                                 ENU=Go Back;
                                 NLD=Ga terug;
                                 NOR=GÜ tilbake;
                                 SVE=GÜ tillbaka];
                      ToolTipML=[DEU=Einen Schritt zurÅck, z.B. wenn Sie unabsichtlich einem Segment Kontakte hinzugefÅgt haben.;
                                 ENU=Go one step back, for example if you have added contacts to a segment by mistake.;
                                 NLD=EÇn stap teruggaan, bijvoorbeeld als u contacten per ongeluk aan een segment hebt toegevoegd.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Undo;
                      OnAction=VAR
                                 SegmentHistoryMgt@1001 : Codeunit 11072024;
                               BEGIN
                                 CALCFIELDS("No. of Criteria Actions");
                                 IF "No. of Criteria Actions" > 0 THEN
                                   IF CONFIRM(Text012,FALSE) THEN
                                     SegmentHistoryMgt.GoBack("No.");
                               END;
                                }
      { 54      ;3   ;Separator ;
                      CaptionML=[ENU="";
                                 NLD=""] }
      { 56      ;3   ;Action    ;
                      Name=ReuseCriteria;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Kriterien wiederverwenden;
                                 ENU=Reuse Criteria;
                                 NLD=Criteria opnieuw gebruiken;
                                 NOR=Bruk kriterier igjen;
                                 SVE=èteranvÑnd kriterier];
                      ToolTipML=[DEU=Verwendet ein gespeichertes Segmentkriterium erneut.;
                                 ENU=Reuse a saved segment criteria.;
                                 NLD=Een opgeslagen segmentcriterium opnieuw gebruiken.;
                                 NOR=Bruk et lagret segmentkriterium pÜ nytt.;
                                 SVE=èteranvÑnd ett sparat segmentkriterium.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Reuse;
                      OnAction=BEGIN
                                 ReuseCriteria;
                               END;
                                }
      { 55      ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Segment wiederverwenden;
                                 ENU=Reuse Segment;
                                 NLD=Segment opnieuw gebruiken;
                                 NOR=Bruk segment igjen;
                                 SVE=èteranvÑnd segment];
                      ToolTipML=[DEU=Verwendet ein protokolliertes Segment erneut.;
                                 ENU=Reuse a logged segment.;
                                 NLD=Een geregistreerd segment opnieuw gebruiken.;
                                 NOR=Bruk et loggfõrt segment pÜ nytt.;
                                 SVE=èteranvÑnd ett loggat segment.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Reuse;
                      OnAction=BEGIN
                                 ReuseLogged(0);
                               END;
                                }
      { 50      ;3   ;Action    ;
                      Name=SaveCriteria;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Kriterien speichern;
                                 ENU=Save Criteria;
                                 NLD=Criteria opslaan;
                                 NOR=Lagre kriteriet;
                                 SVE=Spara kriteriet];
                      ToolTipML=[DEU=Speichert Segmentkriterien.;
                                 ENU=Save a segment criteria.;
                                 NLD=Een segmentcriterium opslaan.;
                                 NOR=Lagre et segmentkriterium.;
                                 SVE=Spara ett segmentkriterium.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Save;
                      OnAction=BEGIN
                                 SaveCriteria;
                               END;
                                }
      { 59      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 NLD=""] }
      { 60      ;2   ;ActionGroup;
                      CaptionML=[DEU=Dateianhang;
                                 ENU=Attachment;
                                 NLD=Bijlage;
                                 NOR=Vedlegg;
                                 SVE=Bilaga];
                      Image=Attachments }
      { 61      ;3   ;Action    ;
                      ShortCutKey=Return;
                      CaptionML=[DEU=ôffnen;
                                 ENU=Open;
                                 NLD=Openen;
                                 NOR=èpne;
                                 SVE=ôppen];
                      ToolTipML=[DEU=ôffnet die Karte fÅr den ausgewÑhlten Datensatz.;
                                 ENU=Open the card for the selected record.;
                                 NLD=De kaart voor de geselecteerde record openen.;
                                 NOR=èpne et vedlegg.;
                                 SVE=ôppna en bilaga.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Edit;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 OpenAttachment;
                               END;
                                }
      { 62      ;3   ;Action    ;
                      CaptionML=[DEU=Erstellen;
                                 ENU=Create;
                                 NLD=Maken;
                                 NOR=Opprett;
                                 SVE=Skapa];
                      ToolTipML=[DEU=Erstellt einen Dateianhang.;
                                 ENU=Create an attachment.;
                                 NLD=Een bijlage maken.;
                                 NOR=Opprett et vedlegg.;
                                 SVE=Skapa en bilaga.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=New;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 CreateAttachment;
                               END;
                                }
      { 63      ;3   ;Action    ;
                      CaptionML=[DEU=Importieren;
                                 ENU=Import;
                                 NLD=Importeren;
                                 NOR=Importer;
                                 SVE=Importera];
                      ToolTipML=[DEU=Importiert einen Dateianhang.;
                                 ENU=Import an attachment.;
                                 NLD=Een bijlage importeren.;
                                 NOR=Importer vedlegg.;
                                 SVE=Importera en bilaga.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Import;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 ImportAttachment;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      CaptionML=[DEU=Exportieren;
                                 ENU=Export;
                                 NLD=Exporteren;
                                 NOR=Eksport;
                                 SVE=Exportera];
                      ToolTipML=[DEU=Exportiert einen Dateianhang.;
                                 ENU=Export an attachment.;
                                 NLD=Een bijlage exporteren.;
                                 NOR=Eksporter et vedlegg.;
                                 SVE=Exportera en bilaga.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Export;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 ExportAttachment;
                               END;
                                }
      { 65      ;3   ;Action    ;
                      CaptionML=[DEU=Lîschen;
                                 ENU=Remove;
                                 NLD=Verwijderen;
                                 NOR=Fjern;
                                 SVE=Ta bort];
                      ToolTipML=[DEU=Entfernt einen Dateianhang.;
                                 ENU=Remove an attachment.;
                                 NLD=Een bijlage verwijderen.;
                                 NOR=Fjern et vedlegg.;
                                 SVE=Ta bort en bilaga.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Cancel;
                      OnAction=BEGIN
                                 TESTFIELD("Interaction Template Code");
                                 RemoveAttachment(FALSE);
                               END;
                                }
      { 34      ;2   ;Action    ;
                      Name=ExportContacts;
                      CaptionML=[DEU=Kontakte e&xportieren;
                                 ENU=E&xport Contacts;
                                 NLD=Contacten e&xporteren;
                                 NOR=E&ksporter fil;
                                 SVE=E&xportera fil];
                      ToolTipML=[DEU=Die Kontaktsegmentliste in eine Excel-Datei exportieren.;
                                 ENU=Export the segment contact list as an Excel file.;
                                 NLD=Het contactsegmentoverzicht exporteren als een Excel-bestand.;
                                 NOR=Eksporter segmentkontaktlisten som en tekstfil.;
                                 SVE=Exportera segmentkontaktlistan som en textfil.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=ExportFile;
                      OnAction=VAR
                                 SegLineLocal@1001 : Record 11072040;
                                 PermissionManager@1000 : Codeunit 9002;
                               BEGIN
                                 SegLineLocal.SETRANGE("Segment No.","No.");
                                 IF PermissionManager.SoftwareAsAService THEN
                                   SegLineLocal.ExportODataFields
                                 ELSE
                                   XMLPORT.RUN(XMLPORT::"Export Segment Contact",FALSE,FALSE,SegLineLocal);
                               END;
                                }
      { 35      ;2   ;Action    ;
                      CaptionML=[DEU=&Verteiler zuweisen;
                                 ENU=Apply &Mailing Group;
                                 NLD=&Mailinggroep toepassen;
                                 NOR=Bruk &mailgruppe;
                                 SVE=Koppla &utskicksgrupp];
                      ToolTipML=[DEU=Weist einen Verteiler einem Segment zu.;
                                 ENU=Assign a mailing group to a segment.;
                                 NLD=Een mailinggroep toewijzen aan een segment.;
                                 NOR=Tilordne en postgruppe til et segment.;
                                 SVE=Tilldela ett segment en utskicksgrupp.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=DistributionGroup;
                      OnAction=VAR
                                 SegHeader@1001 : Record 11072039;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Apply Mailing Group",TRUE,TRUE,SegHeader);
                               END;
                                }
      { 1100529600;2 ;Action    ;
                      Name=AddPlots;
                      CaptionML=[DEU=Baunummern hinzufÅgen;
                                 ENU=Add Plots;
                                 NLD=Bouwnummers toevoegen];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=AddAction;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SegmentHeader@1100529600 : Record 11072039;
                               BEGIN
                                 //**4PS
                                 SegmentHeader := Rec;
                                 SegmentHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Add Plots", TRUE, FALSE, SegmentHeader);
                               END;
                                }
      { 22      ;1   ;ActionGroup;
                      CaptionML=[DEU=D&rucken;
                                 ENU=&Print;
                                 NLD=&Afdrukken;
                                 NOR=Skriv &ut;
                                 SVE=Skriv &ut];
                      Image=Print }
      { 37      ;2   ;Action    ;
                      Name=CoverSheet;
                      CaptionML=[DEU=&DeckblÑtter drucken;
                                 ENU=Print Cover &Sheets;
                                 NLD=&Contactkaarten afdrukken;
                                 NOR=Skriv ut &omslagsark;
                                 SVE=Skriv ut &fîrsÑttsblad];
                      ToolTipML=[DEU=Zeigt DeckblÑtter, die an Ihren Kontakt gesendet werden.;
                                 ENU=View cover sheets to send to your contact.;
                                 NLD=Contactkaarten die u naar uw contact kunt verzenden, weergeven.;
                                 NOR=Vis fõlgebrev som skal sendes til kontakten.;
                                 SVE=Visa meddelanden som ska skickas till kontakten.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=PrintCover;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SegHeader@1001 : Record 11072039;
                                 ContactCoverSheet@1005 : Report 5085;
                               BEGIN
                                 SegHeader := Rec;
                                 SegHeader.SETRECFILTER;
                                 ContactCoverSheet.SetRunFromSegment;
                                 ContactCoverSheet.SETTABLEVIEW(SegHeader);
                                 ContactCoverSheet.RUNMODAL;
                               END;
                                }
      { 1210190005;2 ;Action    ;
                      CaptionML=[DEU=Berichte Beschriftungen;
                                 ENU=Labels Li&st;
                                 NLD=Lij&sten labels;
                                 NOR=Etikettl&iste;
                                 SVE=Etikettl&ista];
                      Image=Report;
                      OnAction=VAR
                                 PrintDoc@1210190000 : Codeunit 229;
                               BEGIN
                                 PrintDoc.PrintSegmentLabel(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[DEU=Allgemein;
                           ENU=General;
                           NLD=Algemeen;
                           NOR=Generell;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die Nummer des beteiligten Postens oder Datensatz entsprechend der festgelegten Nummernserie an.;
                           ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                           NLD=Hiermee wordt het nummer opgegeven van de betrokken post of record, volgens de opgegeven nummerreeks.;
                           NOR=Angir nummeret for segmentet.;
                           SVE=Anger numret pÜ segmentet.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die Beschreibung des Segments an.;
                           ENU=Specifies the description of the segment.;
                           NLD=Hiermee wordt de omschrijving van het segment opgegeven.;
                           NOR=Angir beskrivelsen av segmentet.;
                           SVE=Anger en beskrivning av segmentet.];
                ApplicationArea=#All;
                SourceExpr=Description;
                OnValidate=BEGIN
                             DescriptionOnAfterValidate;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt den Code des VerkÑufers an, der fÅr dieses Segment und/oder die AktivitÑt verantwortlich ist.;
                           ENU=Specifies the code of the salesperson responsible for this segment and/or interaction.;
                           NLD=Hiermee wordt de code opgegeven van de verkoper die verantwoordelijk is voor dit segment en/of de interactie.;
                           NOR=Angir koden for den selgeren som er ansvarlig for dette segmentet og/eller samhandlingen.;
                           SVE=Anger koden fîr den sÑljare som Ñr ansvarig fîr det hÑr segmentet och/eller den hÑr interaktionen.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=[DEU=Gibt das Datum an, an dem das Segment erstellt wurde.;
                           ENU=Specifies the date that the segment was created.;
                           NLD=Hiermee wordt de datum opgegeven waarop het segment is gemaakt.;
                           NOR=Angir datoen da segmentet ble opprettet.;
                           SVE=Anger det datum dÜ segmentet skapades.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Date;
                OnValidate=BEGIN
                             DateOnAfterValidate;
                           END;
                            }

    { 39  ;2   ;Field     ;
                DrillDown=No;
                ToolTipML=[DEU=Gibt die Anzahl der Zeilen im Segment an.;
                           ENU=Specifies the number of lines within the segment.;
                           NLD=Hiermee wordt het aantal regels in het segment opgegeven.;
                           NOR=Angir antall linjer i segmentet.;
                           SVE=Anger antalet rader i segmentet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="No. of Lines" }

    { 52  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die Anzahl der Aktionen an, die Sie beim éndern der Segmentkriterien unternommen haben, z. B. beim HinzufÅgen von Kontakten zum Segment oder beim Neudefinieren oder Entfernen des Segments.;
                           ENU=Specifies the number of actions you have taken when modifying the segmentation criteria, that is, when adding contacts to the segment, refining, or reducing it.;
                           NLD=Hiermee wordt het aantal acties opgegeven dat u hebt ondernomen bij het wijzigen van de segmentcriteria, dat wil zeggen wanneer u contacten toevoegt aan het segment, het segment verfijnt of vermindert.;
                           NOR=Angir hvor mange handlinger du har utfõrt nÜr du har endret segmenteringskriteriene, det vil si nÜr du har lagt til kontakter i segmentet eller fornyet eller redusert det.;
                           SVE=Anger hur mÜnga ÜtgÑrder som vidtogs nÑr du Ñndrade segmentkriterium (d.v.s. nÑr kontakter lades till i segmentet) fîr att fîrfina eller reducera segmentet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="No. of Criteria Actions" }

    { 21  ;1   ;Part      ;
                Name=SegLines;
                ApplicationArea=#RelationshipMgmt;
                SubPageLink=Segment No.=FIELD(No.);
                PagePartID=Page11072064;
                PartType=Page }

    { 1907335101;1;Group  ;
                CaptionML=[DEU=AktivitÑt;
                           ENU=Interaction;
                           NLD=Interactie;
                           NOR=Interaksjon;
                           SVE=Interaktion] }

    { 10  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt den AktivitÑtenvorlagencode der AktivitÑt mit dem Segment an.;
                           ENU=Specifies the interaction template code of the interaction involving the segment.;
                           NLD=Hiermee wordt de interactiesjablooncode opgegeven van de interactie met het segment.;
                           NOR=Angir koden for samhandlingsmalen for samhandlingen som omfatter segmentet.;
                           SVE=Anger interaktionsmallkoden fîr den interaktion som berîr segmentet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Interaction Template Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             InteractionTemplateCodeOnAfter;
                           END;
                            }

    { 70  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt den Sprachcode fÅr das Segment an.;
                           ENU=Specifies the language code for the segment.;
                           NLD=Hiermee wordt de taalcode opgegeven van het segment.;
                           NOR=Angir sprÜkkoden for segmentet.;
                           SVE=Anger segmentets sprÜkkod.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Language Code (Default)";
                Enabled=LanguageCodeDefaultEnable;
                OnValidate=BEGIN
                             LanguageCodeDefaultOnAfterVali;
                           END;
                            }

    { 74  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt den Betreff des Segments an. Der Text in diesem Feld wird als Betreff in E-Mails und in Word-Dokumenten verwendet.;
                           ENU=Specifies the subject of the segment. The text in the field is used as the subject in e-mails and in Word documents.;
                           NLD=Hiermee wordt het onderwerp van het segment opgegeven. De tekst in het veld wordt gebruikt als onderwerp in e-mailberichten en Word-documenten.;
                           NOR=Angir emnet i segmentet. Teksten i feltet brukes som emne i e-postmeldinger og Word-dokumenter.;
                           SVE=Anger rubriken fîr segmentet. Texten i fÑltet anvÑnds som rubrik fîr e-postmeddelanden och Word-dokument.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Subject (Default)";
                Importance=Promoted;
                Enabled=SubjectDefaultEnable;
                OnValidate=BEGIN
                             SubjectDefaultOnAfterValidate;
                           END;
                            }

    { 18  ;2   ;Field     ;
                Name=Attachment;
                AssistEdit=Yes;
                CaptionML=[DEU=Dateianhang;
                           ENU=Attachment;
                           NLD=Bijlage;
                           NOR=Vedlegg;
                           SVE=Bilaga];
                ToolTipML=[DEU=Gibt an, ob der verknÅpfte Anhang Åbernommen wurde oder eindeutig ist.;
                           ENU=Specifies if the linked attachment is inherited or unique.;
                           NLD=Hiermee wordt opgegeven of de gekoppelde bijlage overgenomen of uniek is.;
                           NOR=Angir om vedlegget som er knyttet til segmentlinjen, er arvet eller unikt.;
                           SVE=Anger om den lÑnkade bilagan Ñr Ñrvd eller unik.];
                ApplicationArea=#RelationshipMgmt;
                BlankZero=Yes;
                SourceExpr="Attachment No." > 0;
                Enabled=AttachmentEnable;
                OnAssistEdit=BEGIN
                               MaintainAttachment;
                               UpdateEditable;
                               CurrPage.SegLines.PAGE.UpdateForm;
                             END;
                              }

    { 72  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt an, dass die Korrespondenzart verwendet werden soll, die Sie im Feld "Korrespondenzart (Vorgabe)" ausgewÑhlt haben. Wenn sich hier kein HÑkchen befindet, wird die auf der Kontaktkarte gewÑhlte Korrespondenzart verwendet.;
                           ENU=Specifies that the correspondence type that you select in the Correspondence Type (Default) field should be used. If there is no check mark, the program uses the correspondence type selected on the Contact Card.;
                           NLD=Hiermee wordt opgegeven dat het soort correspondentie dat in het veld Correspondentietype (Standaard) is geselecteerd, moet worden gebruikt. Als er geen vinkje is, wordt het soort correspondentie gebruikt dat op de contactkaart is geselecteerd.;
                           NOR=Angir at korrespondansetypen du velger i feltet Korrespondansetype (standard), skal brukes. Hvis det ikke er en hake i boksen, bruker programmet korrespondansetypen som er valgt pÜ kontaktkortet.;
                           SVE=Anger att den korrespondenstyp som du har valt i fÑltet Motsvarande typ (standard) ska anvÑndas. Om fÑltet inte Ñr markerat, anvÑnds den korrespondenstyp som Ñr vald pÜ kontaktkortet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Ignore Contact Corres. Type";
                Enabled=IgnoreContactCorresTypeEnable;
                OnValidate=BEGIN
                             IgnoreContactCorresTypeOnAfter;
                           END;
                            }

    { 57  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die bevorzugte Korrespondenzart fÅr die AktivitÑt an. HINWEIS: Bei Verwendung des Webclients dÅrfen Sie nicht die Option "Brief" auswÑhlen, da der Druck Åber den Webclient nicht mîglich ist.;
                           ENU=Specifies the preferred type of correspondence for the interaction. NOTE: If you use the Web client, you must not select the Hard Copy option because printing is not possible from the web client.;
                           NLD=Hiermee wordt het soort correspondentie opgegeven dat de voorkeur heeft voor deze interactie. OPMERKING: als u de webclient gebruikt, moet u de optie Afdruk niet selecteren, omdat afdrukken niet mogelijk is vanuit de webclient.;
                           NOR=Angir korrespondansetypen for denne samhandlingen. Det er tre alternativer:;
                           SVE=Anger korrespondenstypen fîr interaktionen. Det finns tre alternativ:];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Correspondence Type (Default)";
                Enabled=CorrespondenceTypeDefaultEnabl;
                OnValidate=BEGIN
                             CorrespondenceTypeDefaultOnAft;
                           END;
                            }

    { 45  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die Richtung des Informationsflusses innerhalb der AktivitÑt an, die fÅr das Segment erstellt wurde. Es sind zwei Optionen verfÅgbar: "Eingehend" und "Ausgehend".;
                           ENU=Specifies the direction of the information that is part of the interaction created for the segment. There are two options: Inbound and Outbound.;
                           NLD=Hiermee wordt de richting opgegeven van de informatie die deel uitmaakt van de interactie die voor het segment is gemaakt. Er zijn twee opties: Inkomend en Uitgaand.;
                           NOR=Angir retningen for informasjonen som er en del av samhandlingen som er opprettet for segmentet. Du kan velge blant to alternativer: InngÜende eller UtgÜende.;
                           SVE=Anger riktningen fîr informationen som ingÜr i den interaktion som har skapats fîr segmentet. Det finns tvÜ alternativ: Ankommande och AvgÜende.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Information Flow";
                Importance=Additional;
                Enabled=InformationFlowEnable;
                OnValidate=BEGIN
                             InformationFlowOnAfterValidate;
                           END;
                            }

    { 47  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt an, ob die fÅr diese Segmentszeile erfasste AktivitÑt von Ihrem Unternehmen oder von einem Ihrer Kontakte veranlasst wurde. Die Option "Uns" gibt an, dass Ihr Unternehmen der Initiator war. Die Option "Kontakt" gibt an, dass ein Kontakt der Initiator war.;
                           ENU="Specifies whether the interaction recorded for this segment was initiated by your company or by one of your contacts. The Us option indicates that your company was the initiator; the Them option indicates that a contact was the initiator.";
                           NLD=Hiermee wordt opgegeven of de interactie die voor het segment is vastgelegd, is gestart door uw bedrijf of door een van uw contacten. De optie Wij geeft aan dat uw bedrijf de initiator was en de optie Zij geeft aan dat een contact de initiator was.;
                           NOR=Angir om samhandlingen som ble registrert for dette segmentet, ble startet av selskapet eller av en av kontaktene dine. Alternativet Oss angir at selskapet startet, mens alternativet De angir at en kontakt startet.;
                           SVE=Anger om den interaktion som har registrerats fîr segmentet startades av ditt fîretag eller av nÜgon av dina kontakter. Alternativet Oss anger att ditt fîretag initierade interaktionen, och alternativet Externt anger att interaktionen initierades av en kontakt.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Initiated By";
                Importance=Additional;
                Enabled=InitiatedByEnable;
                OnValidate=BEGIN
                             InitiatedByOnAfterValidate;
                           END;
                            }

    { 14  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die Kosten einer Einheit des Artikels oder der Ressource in der Zeile in der MandantenwÑhrung an.;
                           ENU=Specifies the cost, in LCY, of one unit of the item or resource on the line.;
                           NLD=Hiermee worden de kosten van ÇÇn eenheid van het artikel of de resource op de regel weergegeven in de lokale valuta.;
                           NOR=Angir enhetskosten for en enkelt samhandling som er opprettet for dette segmentet.;
                           SVE=Anger styckkostnaden fîr en enskild interaktion som har skapats fîr segmentet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Unit Cost (LCY)";
                Importance=Additional;
                Enabled=UnitCostLCYEnable;
                OnValidate=BEGIN
                             UnitCostLCYOnAfterValidate;
                           END;
                            }

    { 16  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die Dauer einer einzelnen AktivitÑt an, die fÅr dieses Segment erstellt wurde.;
                           ENU=Specifies the duration of a single interaction created for this segment.;
                           NLD=Hiermee wordt de duur van ≤≤n interactie opgegeven die voor dit segment is gemaakt.;
                           NOR=Angir varigheten for en enkelt samhandling som er opprettet for dette segmentet.;
                           SVE=Anger varaktigheten fîr en enskild interaktion som har skapats fîr segmentet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Unit Duration (Min.)";
                Importance=Additional;
                Enabled=UnitDurationMinEnable;
                OnValidate=BEGIN
                             UnitDurationMinOnAfterValidate;
                           END;
                            }

    { 66  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt an, dass das Microsoft Word-Dokument als Dateianhang in der E-Mail-Nachricht versendet werden soll.;
                           ENU=Specifies that the Microsoft Word document should be sent as an attachment in the e-mail message.;
                           NLD=Hiermee wordt opgegeven dat het Microsoft Word-document als bijlage moet worden verzonden in het e-mailbericht.;
                           NOR=Angir at Microsoft Word-dokumentet skal sendes som vedlegg i e-postmeldingen.;
                           SVE=Anger att Microsoft Word-dokumentet ska skickas som en bilaga i e-postmeddelandet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Send Word Docs. as Attmt.";
                OnValidate=BEGIN
                             SendWordDocsasAttmtOnAfterVali;
                           END;
                            }

    { 1900598201;1;Group  ;
                CaptionML=[DEU=Kampagne;
                           ENU=Campaign;
                           NLD=Campagne;
                           NOR=Kampanje;
                           SVE=Kampanj] }

    { 8   ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die Nummer der Kampagne an, fÅr die das Segment erstellt wurde.;
                           ENU=Specifies the number of the campaign for which the segment has been created.;
                           NLD=Hiermee wordt het nummer opgegeven van de campagne waarvoor het segment is gemaakt.;
                           NOR=Angir nummeret for kampanjen som segmentet er opprettet for.;
                           SVE=Anger numret pÜ kampanjen som segmentet skapats fîr.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             CampaignNoOnAfterValidate;
                           END;
                            }

    { 76  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt eine Beschreibung der Kampagne an, mit der das Segment verknÅpft ist. Die Beschreibung wird von der Kampagnenkarte Åbernommen.;
                           ENU=Specifies a description of the campaign to which the segment is related. The description is copied from the campaign card.;
                           NLD=Hiermee wordt een beschrijving opgegeven van de campagne waaraan het segment is gerelateerd. De omschrijving wordt gekopieerd van de campagnekaart.;
                           NOR=Angir en beskrivelse av kampanjen som er relatert til segmentet. Beskrivelsen blir kopiert fra kampanjekortet.;
                           SVE=Anger en beskrivning av kampanjen som segmentet Ñr relaterat till. Beskrivningen kopieras frÜn kampanjkortet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign Description";
                Editable=FALSE }

    { 41  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt an, dass das Segment Teil des Ziels der Kampagne ist, mit der es verknÅpft ist.;
                           ENU=Specifies that the segment is part of the target of the campaign to which it is linked.;
                           NLD=Hiermee wordt opgegeven dat het segment onderdeel is van het doel van de campagne waaraan het segment is gekoppeld.;
                           NOR=Angir at segmentet er en del av mÜlet for kampanjen som det er knyttet til.;
                           SVE=Anger att segmentet ingÜr i mÜlet fîr den kampanj som det Ñr kopplat till.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign Target";
                Enabled=CampaignTargetEnable;
                OnValidate=BEGIN
                             CampaignTargetOnAfterValidate;
                           END;
                            }

    { 43  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt an, dass die fÅr das Segment erstellte AktivitÑt die Reaktion auf eine Kampagne ist.;
                           ENU=Specifies that the interaction created for the segment is the response to a campaign.;
                           NLD=Hiermee wordt opgegeven dat de interactie die voor het segment is gemaakt, de reactie is op een campagne.;
                           NOR=Angir at samhandlingen som er opprettet for segmentet, er resultatet av en kampanje.;
                           SVE=Anger att den interaktion som har skapats fîr segmentet Ñr ett kampanjsvar.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Campaign Response";
                Enabled=CampaignResponseEnable;
                OnValidate=BEGIN
                             CampaignResponseOnAfterValidat;
                           END;
                            }

    { 1904954901;1;Group  ;
                CaptionML=[DEU=Seriendruckfelder;
                           ENU=Merge Fields;
                           NLD=Samenvoegvelden;
                           NOR=Koble felt;
                           SVE=Koppla fÑlt] }

    { 1210190008;2;Field  ;
                SourceExpr="Optional Mergefield 1";
                CaptionClass=GetCaptionClass(FIELDNO("Optional Mergefield 1"),1);
                Enabled="Optional Mergefield 1Enable";
                OnValidate=BEGIN
                             OptionalMergefield1OnAfterVali;
                           END;
                            }

    { 1210190010;2;Field  ;
                SourceExpr="Optional Mergefield 2";
                CaptionClass=GetCaptionClass(FIELDNO("Optional Mergefield 2"),2);
                Enabled="Optional Mergefield 2Enable";
                OnValidate=BEGIN
                             OptionalMergefield2OnAfterVali;
                           END;
                            }

    { 1210190012;2;Field  ;
                SourceExpr="Optional Mergefield 3";
                CaptionClass=GetCaptionClass(FIELDNO("Optional Mergefield 3"),3);
                Enabled="Optional Mergefield 3Enable";
                OnValidate=BEGIN
                             OptionalMergefield3OnAfterVali;
                           END;
                            }

    { 1210190014;2;Field  ;
                SourceExpr="Optional Mergefield 4";
                CaptionClass=GetCaptionClass(FIELDNO("Optional Mergefield 4"),4);
                Enabled="Optional Mergefield 4Enable";
                OnValidate=BEGIN
                             OptionalMergefield4OnAfterVali;
                           END;
                            }

    { 1210190016;2;Field  ;
                SourceExpr="Optional Mergefield 5";
                CaptionClass=GetCaptionClass(FIELDNO("Optional Mergefield 5"),5);
                Enabled="Optional Mergefield 5Enable";
                OnValidate=BEGIN
                             OptionalMergefield5OnAfterVali;
                           END;
                            }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text011@1011 : TextConst 'DEU=Segment %1 wurde protokolliert.;ENU=Segment %1 has been logged.;NLD=Segment %1 is geregistreerd.;NOR=Segment %1 er loggfõrt.;SVE=Segment %1 har loggats.';
      Text012@1013 : TextConst 'DEU=Dadurch wird die letzte Kriterienaktion rÅckgÑngig gemacht.\Mîchten Sie fortfahren?;ENU=This will undo the last criteria action.\Do you want to continue?;NLD=Hierdoor wordt de laatste criteria-actie ongedaan gemaakt.\Wilt u doorgaan?;NOR=Dette opphever den siste kriteriehandlingen.\Vil du fortsette?;SVE=Detta kommer att upphÑva senaste kriteriumÜtgÑrden.\Vill du fortsÑtta?';
      CampaignTargetEnable@19064124 : Boolean INDATASET;
      CampaignResponseEnable@19042996 : Boolean INDATASET;
      CorrespondenceTypeDefaultEnabl@19017412 : Boolean INDATASET;
      SubjectDefaultEnable@19030726 : Boolean INDATASET;
      LanguageCodeDefaultEnable@19053468 : Boolean INDATASET;
      AttachmentEnable@19033701 : Boolean INDATASET;
      IgnoreContactCorresTypeEnable@19029068 : Boolean INDATASET;
      InformationFlowEnable@19076079 : Boolean INDATASET;
      InitiatedByEnable@19020183 : Boolean INDATASET;
      UnitCostLCYEnable@19056514 : Boolean INDATASET;
      UnitDurationMinEnable@19041420 : Boolean INDATASET;
      CreateOppQst@1000 : TextConst 'DEU=Mîchten Sie eine Verkaufschance fÅr alle Kontakte im Segment erstellen?;ENU=Do you want to create an opportunity for all contacts in segment?;NLD=Wilt u een opportunity maken voor alle contactpersonen in het segment?;NOR=Vil du opprette en salgsmulighet for alle kontaktene i segmentet?;SVE=Vill du skapa en affÑrsmîjlighet fîr alla kontakter i segmentet?';
      "Optional Mergefield 1Enable"@1210190000 : Boolean INDATASET;
      "Optional Mergefield 2Enable"@1210190001 : Boolean INDATASET;
      "Optional Mergefield 3Enable"@1210190002 : Boolean INDATASET;
      "Optional Mergefield 4Enable"@1210190003 : Boolean INDATASET;
      "Optional Mergefield 5Enable"@1210190004 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateEditable@4();
    VAR
      SegInteractLanguage@1000 : Record 5104;
    BEGIN
      CampaignTargetEnable := "Campaign No." <> '';
      CampaignResponseEnable := "Campaign No." <> '';
      CorrespondenceTypeDefaultEnabl := "Ignore Contact Corres. Type" = TRUE;
      LanguageCodeDefaultEnable := "Interaction Template Code" <> '';
      SubjectDefaultEnable := SegInteractLanguage.GET("No.",0,"Language Code (Default)");
      AttachmentEnable := "Interaction Template Code" <> '';
      IgnoreContactCorresTypeEnable := "Interaction Template Code" <> '';
      InformationFlowEnable := "Interaction Template Code" <> '';
      InitiatedByEnable := "Interaction Template Code" <> '';
      UnitCostLCYEnable := "Interaction Template Code" <> '';
      UnitDurationMinEnable := "Interaction Template Code" <> '';
      LanguageCodeDefaultEnable := "Interaction Template Code" <> '';
      //**4PS.sn
      "Optional Mergefield 1Enable" := OptionalMergeFieldEditable(1);
      "Optional Mergefield 2Enable" := OptionalMergeFieldEditable(2);
      "Optional Mergefield 3Enable" := OptionalMergeFieldEditable(3);
      "Optional Mergefield 4Enable" := OptionalMergeFieldEditable(4);
      "Optional Mergefield 5Enable" := OptionalMergeFieldEditable(5);
      //**4PS.en
    END;

    LOCAL PROCEDURE DateOnAfterValidate@19027017();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE DescriptionOnAfterValidate@19030973();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE InteractionTemplateCodeOnAfter@19000597();
    BEGIN
      UpdateEditable;
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE InformationFlowOnAfterValidate@19041099();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE InitiatedByOnAfterValidate@19049832();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE UnitCostLCYOnAfterValidate@19001329();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE UnitDurationMinOnAfterValidate@19023271();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CorrespondenceTypeDefaultOnAft@19059490();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE SendWordDocsasAttmtOnAfterVali@19026152();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE LanguageCodeDefaultOnAfterVali@19033064();
    BEGIN
      UpdateEditable;
      CurrPage.SegLines.PAGE.UpdateForm;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE IgnoreContactCorresTypeOnAfter@19053741();
    BEGIN
      UpdateEditable;
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE SubjectDefaultOnAfterValidate@19032581();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CampaignResponseOnAfterValidat@19031993();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CampaignTargetOnAfterValidate@19073096();
    BEGIN
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CampaignNoOnAfterValidate@19036822();
    BEGIN
      IF "Campaign No." = '' THEN BEGIN
        "Campaign Target" := FALSE;
        "Campaign Response" := FALSE;
      END;

      CALCFIELDS("Campaign Description");
      CampaignTargetEnable := "Campaign No." <> '';
      CampaignResponseEnable := "Campaign No." <> '';
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE CreateOpportunitiesForAllContacts@1();
    BEGIN
      IF CONFIRM(CreateOppQst) THEN
        CreateOpportunities;
    END;

    LOCAL PROCEDURE OptionalMergefield1OnAfterVali@19017198();
    BEGIN
      //**4PS
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OptionalMergefield2OnAfterVali@19045663();
    BEGIN
      //**4PS
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OptionalMergefield3OnAfterVali@19005920();
    BEGIN
      //**4PS
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OptionalMergefield4OnAfterVali@19036193();
    BEGIN
      //**4PS
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OptionalMergefield5OnAfterVali@19060994();
    BEGIN
      //**4PS
      CurrPage.SegLines.PAGE.UpdateForm;
    END;

    PROCEDURE FilterFeatures@1210190001(RelType@1210190000 : 'Company,Contact Person,Person');
    VAR
      FeatureRec@1210190002 : Record 11012752;
      FeatureFrm@1210190001 : Page 11012757;
      ContRec@1210190003 : Record 5050;
    BEGIN
      //**4PS
      CASE RelType OF
        RelType::Company:
          BEGIN
            FeatureFrm.SetProspectFilter(ContRec);
            FeatureRec.SETRANGE(Companies, TRUE);
          END;
        RelType::"Contact Person":
          BEGIN
            FeatureFrm.SetContactFilter(ContRec);
            FeatureRec.SETRANGE(Contacts, TRUE);
          END;
        RelType::Person:
          BEGIN
            FeatureFrm.SetPersonFilter(ContRec);
            FeatureRec.SETRANGE(Persons, TRUE);
          END;
      END;
      FeatureFrm.SETTABLEVIEW(FeatureRec);
      FeatureFrm.RUNMODAL;
      CLEAR(FeatureFrm);
    END;

    PROCEDURE GenerateSegmentRelations@1210190000(RelType@1210190001 : 'Company,Contact Person,Person');
    VAR
      ContRec@1100485001 : Record 5050;
      HelpRec@1210190005 : Record 11012754;
      SegmLineRec@1210190004 : Record 11072040;
      lvSegmLineRec2@1100485000 : Record 11072040;
      LastLino@1210190000 : Integer;
    BEGIN
      //**4PS
      HelpRec.SETRANGE("User ID", USERID);
      CASE RelType OF
        RelType::Company: HelpRec.SETRANGE(Type, HelpRec.Type::Company);
        RelType::"Contact Person": HelpRec.SETRANGE(Type, HelpRec.Type::Contact);
        RelType::Person: HelpRec.SETRANGE(Type, HelpRec.Type::Person);
      END;
      IF HelpRec.FIND('-') THEN BEGIN
        SegmLineRec.SETRANGE("Segment No.", "No.");
        IF SegmLineRec.FIND('+') THEN
          LastLino := SegmLineRec."Line No."
        ELSE
          LastLino := 0;

        REPEAT
          IF ContRec.GET(HelpRec.Code) THEN BEGIN
            IF NOT ContRec."Exclude from Segment" AND NOT ContRec.Blocked THEN BEGIN
              lvSegmLineRec2.SETCURRENTKEY("Contact No.","Segment No.");
              lvSegmLineRec2.SETRANGE("Contact No.", HelpRec.Code);
              lvSegmLineRec2.SETRANGE("Segment No.", "No.");
              IF NOT lvSegmLineRec2.FIND('-') THEN BEGIN
                //Only add contact if not already in segment
                SegmLineRec.INIT;
                SegmLineRec."Segment No." := "No.";
                SegmLineRec."Line No." := LastLino + 10000;
                SegmLineRec.VALIDATE("Contact No.", HelpRec.Code);
                IF RelType = RelType::Company THEN
                  SegmLineRec."Contact Company No." := HelpRec.Code;
                IF RelType = RelType::"Contact Person" THEN
                  SegmLineRec."Contact Company No." := ContRec."Company No.";
                SegmLineRec.INSERT(TRUE);
                LastLino := SegmLineRec."Line No.";
              END;
            END;
          END;
        UNTIL HelpRec.NEXT = 0;
      END;
    END;

    BEGIN
    END.
  }
}

