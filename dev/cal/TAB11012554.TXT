OBJECT Table 11012554 Plant Location
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    DataCaptionFields=Code,Description;
    OnInsert=BEGIN
               PlantSetupRec.GET;
               IF (Code = '') AND (PlantSetupRec."Plant Location Nos." <> '') THEN
                 NoSeriesMgt.InitSeries(PlantSetupRec."Plant Location Nos.", xRec."No. Series", 0D, Code, "No. Series");
               TESTFIELD(Code);
               "Creation Date" := TODAY;
               NormalizePostCodeHouseNo;
               "Created by":= USERID;
               FillDefaultFromDepotPlantNeed;
             END;

    OnModify=BEGIN
               CheckPlantNoFilled();
               "Last Date Modified" := TODAY;
               "Modified by":= USERID;
               IF ("Ending Date" = 0D) AND (Status >= Status::"Technical Finished") THEN
                 "Ending Date" := TODAY;
               IF NOT Depot THEN BEGIN
                 IF "Location Code (Items)" <> '' THEN
                   "Location Code (Items)" := '';
               END;
               NormalizePostCodeHouseNo;
             END;

    OnDelete=VAR
               PlantInventory@1100528000 : Record 11012555;
               lvLocAddressRec@1100485000 : Record 11012590;
               lvLocContRec@1100485001 : Record 11012594;
               lvLocRentalRateRec@1100485004 : Record 11012583;
               lvRentDiscRec@1100485005 : Record 11012544;
               RentalQuantityDiscount@1100528800 : Record 11072669;
               DummyRec@1100485003 : Record 11012051;
               ReturnDepots@1100409000 : Record 11012668;
               PlantCostLine@1100409001 : Record 11012591;
               PlantCostLinePrice@1100409002 : Record 11072664;
             BEGIN
               IF Code = '' THEN
                 EXIT;

               PlantSetupRec.GET;

               IF PlantSetupRec."Finish and Archive Loc. Oblig." THEN BEGIN
                 IF Status < Status::Finished THEN
                   ERROR(Text012);
                 IF Status <> Status::Archived THEN
                   IF NOT CONFIRM(Text013,FALSE) THEN
                     ERROR(Text014);
               END;

               ErrorTxt := CheckFinished(COMPANYNAME, FALSE, DummyRec);
               IF ErrorTxt <> '' THEN
                 ERROR(ErrorTxt);
               //C021870.sn
               IF PlantSetupRec."Ignore Neg. Stock on Close Loc" THEN BEGIN
                 //If check not done in 'CheckFinished'. Delete not allowed if neg. invent on location, must be corrected first!!
                 //Otherwise diference between inventory and possession / Fixed Assets
                 PlantInventory.SETCURRENTKEY(Removed,Location);
                 PlantInventory.SETRANGE(Removed,FALSE);
                 PlantInventory.SETRANGE(Location,Code);
                 PlantInventory.SETRANGE(Sold,FALSE);
                 PlantInventory.SETFILTER(Quantity, '<%1', -0.000005);
                 IF PlantInventory.FINDFIRST THEN
                   ERROR(Text002b, TABLECAPTION, Code);
               END;
               //C021870.sn

               PlantNeedRec.SETRANGE(Location, Code);
               PlantNeedRec.DELETEALL(TRUE);

               PlantInvRec.SETCURRENTKEY(Location);
               PlantInvRec.SETRANGE(Location, Code);
               PlantInvRec.DELETEALL;

               lvLocAddressRec.SETRANGE(Location, Code);
               lvLocAddressRec.DELETEALL;

               lvLocContRec.SETRANGE(Location, Code);
               lvLocContRec.DELETEALL;

               lvLocRentalRateRec.SETRANGE(Location, Code);
               lvLocRentalRateRec.DELETEALL;

               lvRentDiscRec.SETRANGE(Location, Code);
               lvRentDiscRec.DELETEALL;

               RentalQuantityDiscount.SETRANGE(Location, Code);
               RentalQuantityDiscount.DELETEALL;

               PlantLocRateCodeRec.RESET;
               PlantLocRateCodeRec.SETRANGE(Location, Code);
               PlantLocRateCodeRec.DELETEALL;

               //DP00671.sn
               PlantCostLinePrice.SETRANGE("Cost Level", PlantCostLinePrice."Cost Level"::Location);
               PlantCostLinePrice.SETRANGE(Code, Code);
               PlantCostLinePrice.DELETEALL;

               PlantCostLine.SETRANGE("Cost Level", PlantCostLine."Cost Level"::Location);
               PlantCostLine.SETRANGE(Code, Code);
               PlantCostLine.DELETEALL;
               //DP00671.en

               //DP00152
               ReturnDepots.RESET;
               ReturnDepots.SETRANGE(Depot, Code);
               ReturnDepots.DELETEALL;

               //DP00183.sc
               DeleteDocumentLinks();
               DeleteCommentLines();
               //DP00183.ec

               PlantLedgerEntry.SETCURRENTKEY("Plant Location");
               PlantLedgerEntry.SETRANGE("Plant Location", Code);
               IF PlantLedgerEntry.FINDSET(TRUE, TRUE) THEN
                 REPEAT
                   PlantLedgerEntry2 := PlantLedgerEntry;
                   PlantLedgerEntry2."Plant Location" := '';
                   PlantLedgerEntry2.MODIFY;
                 UNTIL PlantLedgerEntry.NEXT = 0;
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
               MoveDocumentLinks(xRec, Rec, FALSE); //DP00183.n
             END;

    CaptionML=[ENU=Plant Location;
               NOR=Maskinplassering;
               SVE=Maskinutplacering];
    LookupPageID=Page11012558;
    DrillDownPageID=Page11012558;
  }
  FIELDS
  {
    { 10  ;   ;Code                ;Code20        ;AltSearchField=Search Name;
                                                   OnValidate=BEGIN
                                                                IF Code <> xRec.Code THEN BEGIN
                                                                  PlantSetupRec.GET;
                                                                  IF PlantSetupRec."Plant Location Nos." <> '' THEN
                                                                    NoSeriesMgt.TestManual(PlantSetupRec."Plant Location Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NOR=Kode;
                                                              SVE=Kod] }
    { 15  ;   ;Company Name        ;Text30        ;TableRelation=Company;
                                                   OnValidate=VAR
                                                                CompanyData@1100528500 : Record 11020674;
                                                              BEGIN
                                                                VALIDATE("Project No.");
                                                                VALIDATE("Service Order No.");
                                                                VALIDATE("Employee No.");
                                                                IF "Company Name" = COMPANYNAME THEN
                                                                  "Company Name" := '';
                                                                IF "Company Name" <> '' THEN BEGIN
                                                                  TESTFIELD("Plant Type", '');  //DP00815
                                                                  CompanyData.GET("Company Name");
                                                                  CompanyData.TESTFIELD("Customer No.");
                                                                  VALIDATE("Customer No.",CompanyData."Customer No.");
                                                                  "Project Address Code" := '';
                                                                  ClearCustomerPriceAndDiscGroup;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Company Name;
                                                              NOR=Navn p† selskap;
                                                              SVE=F”retagsnamn] }
    { 20  ;   ;Description         ;Text100       ;OnValidate=BEGIN
                                                                IF ("Search Name" = UPPERCASE(xRec.Description)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Description;
                                                              END;

                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning] }
    { 30  ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2;
                                                              SVE=Beskrivning 2] }
    { 40  ;   ;Search Name         ;Code100       ;CaptionML=[ENU=Search Name;
                                                              NOR=S›kenavn;
                                                              SVE=S”knamn] }
    { 50  ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF "Customer No." <> '' THEN
                                                                  TESTFIELD("Plant Type", '');  //DP00815
                                                                IF "Customer No." <> xRec."Customer No." THEN BEGIN
                                                                  PlantSetupRec.GET;
                                                                  IF "Customer No." = '' THEN BEGIN
                                                                    "VAT Bus. Posting Group" := '';
                                                                    IF PlantSetupRec."Def. Loc. Bus. P.Grp of Cust." THEN
                                                                      "Gen. Bus. Posting Group" := '';
                                                                  END ELSE BEGIN
                                                                    CustRec.GET("Customer No.");
                                                                    "VAT Bus. Posting Group" := CustRec."VAT Bus. Posting Group";
                                                                    IF PlantSetupRec."Def. Loc. Bus. P.Grp of Cust." THEN
                                                                      "Gen. Bus. Posting Group" := CustRec."Gen. Bus. Posting Group";
                                                                    ClearCustomerPriceAndDiscGroup;
                                                                    "Invoice Method" := CustRec."Plant Invoice Method"
                                                                  END;
                                                                  "Bill-to Customer No." := '';
                                                                  "Alternative Bill-to Address" := '';
                                                                  "Project Address Code" := '';
                                                                END;

                                                                IF ("Customer No." = '') OR ("Project No." <> '') OR ("Service Order No." <> '') OR ("Company Name" <> '') THEN
                                                                  "Project Address Code" := '';
                                                              END;

                                                   CaptionML=[ENU=Customer No.;
                                                              NOR=Kundenr;
                                                              SVE=Kundnr] }
    { 51  ;   ;Customer Name       ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Customer Name;
                                                              NOR=Kundnavn;
                                                              SVE=Kundens namn];
                                                   Editable=No }
    { 55  ;   ;Service Order No.   ;Code20        ;TableRelation=IF (Company Name=CONST()) "Service Order";
                                                   OnValidate=BEGIN
                                                                IF "Service Order No." = '' THEN BEGIN
                                                                  IF ("Project No." = '') THEN
                                                                    ClearCustomerPriceAndDiscGroup;
                                                                  EXIT;
                                                                END;
                                                                TESTFIELD("Project No.", '');
                                                                TESTFIELD("Try-out Quote No.", '');
                                                                TESTFIELD("Employee No.", '');
                                                                TESTFIELD("Plant Type", '');  //DP00815

                                                                CheckPlantMgtCompanySetup("Company Name");
                                                                IF "Company Name" = '' THEN
                                                                  ServOrderRec.CHANGECOMPANY(COMPANYNAME)
                                                                ELSE
                                                                  ServOrderRec.CHANGECOMPANY("Company Name");
                                                                ServOrderRec.GET("Service Order No.");
                                                                IF ServOrderRec."Plant Location" = Code THEN
                                                                  ServOrderRec.FIELDERROR("Plant Location");
                                                                CheckUsageInServiceOrders;
                                                                IF ("Company Name" = '') OR ("Company Name" = COMPANYNAME) THEN
                                                                  VALIDATE("Customer No.",'')
                                                                ELSE
                                                                  VALIDATE("Customer No.");

                                                                //mg.sn, 09-03-11: M25508
                                                                IF "Customer No." = '' THEN BEGIN
                                                                  PlantSetupRec.GET;
                                                                  VALIDATE("Gen. Bus. Posting Group", PlantSetupRec."Default Gen. Bus.Posting Group");
                                                                  "VAT Bus. Posting Group" := PlantSetupRec."Default VAT Bus.Posting Group";
                                                                END ELSE BEGIN
                                                                  IF ("Company Name" <> '') AND ("Company Name" <> COMPANYNAME) AND ("Gen. Bus. Posting Group" = '') THEN
                                                                    "Gen. Bus. Posting Group" := PlantSetupRec."Default Gen. Bus.Posting Group";
                                                                END;
                                                                //mg.en, 09-03-11: M25508

                                                                VALIDATE("VAT Bus. Posting Group");
                                                                TransferServOrderData;
                                                              END;

                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr] }
    { 58  ;   ;Plant Type          ;Code20        ;TableRelation="Plant Type";
                                                   OnValidate=BEGIN
                                                                //DP00815
                                                                IF "Plant Type" = '' THEN
                                                                  "Internal Charge Plant Entry as" := 0;
                                                                IF "Plant Type" <> '' THEN BEGIN
                                                                  PlantSetupRec.GET;
                                                                  PlantSetupRec.TESTFIELD("Cost Component Internal Charge");
                                                                  TESTFIELD("Company Name", '');
                                                                  TESTFIELD("Customer No.", '');
                                                                  TESTFIELD("Project No.", '');
                                                                  TESTFIELD("Try-out Quote No.", '');
                                                                  TESTFIELD("Service Order No.", '');
                                                                  TESTFIELD("Employee No.", '');
                                                                  IF "Internal Charge Plant Entry as" = 0 THEN BEGIN
                                                                    "Internal Charge Plant Entry as" := PlantSetupRec."Internal Charge Plant Entry as";
                                                                    IF "Internal Charge Plant Entry as" = 0 THEN
                                                                      "Internal Charge Plant Entry as" := "Internal Charge Plant Entry as"::Cost;
                                                                  END;
                                                                END;
                                                                IF "Plant Type" <> xRec."Plant Type" THEN
                                                                  "Plant No." := '';
                                                              END;

                                                   CaptionML=[ENU=Plant Type;
                                                              NOR=Maskintype;
                                                              SVE=Maskintyp] }
    { 59  ;   ;Plant No.           ;Code10        ;TableRelation="Plant Number".No. WHERE (Plant Type=FIELD(Plant Type));
                                                   CaptionML=[ENU=Plant No.;
                                                              NOR=Maskinnr.;
                                                              SVE=Maskinnr] }
    { 60  ;   ;Project No.         ;Code20        ;TableRelation=IF (Company Name=FILTER('')) Job;
                                                   OnValidate=BEGIN
                                                                IF "Project No." = '' THEN BEGIN
                                                                  "BB with Sales Rate (L to L.)" := FALSE;  //C022786
                                                                  IF ("Service Order No." = '') THEN
                                                                    ClearCustomerPriceAndDiscGroup;
                                                                  EXIT;
                                                                END;

                                                                TESTFIELD("Service Order No.", '');
                                                                TESTFIELD("Employee No.", '');
                                                                TESTFIELD("Plant Type", '');  //DP00815

                                                                CheckPlantMgtCompanySetup("Company Name");
                                                                IF "Company Name" = '' THEN
                                                                  ProjRec.CHANGECOMPANY(CURRENTCOMPANY)
                                                                ELSE
                                                                  ProjRec.CHANGECOMPANY("Company Name");
                                                                ProjRec.GET("Project No.");

                                                                IF ("Company Name" = '') OR ("Company Name" = CURRENTCOMPANY) THEN
                                                                  VALIDATE("Customer No.",'')
                                                                ELSE
                                                                  VALIDATE("Customer No.");

                                                                IF "Project No." = '' THEN
                                                                  VALIDATE(Element, '')
                                                                ELSE
                                                                  VALIDATE(Element);
                                                                IF (("Project No." = '') OR ("Project No." <> xRec."Project No.")) AND ("Extension Contract" <> '') THEN
                                                                  VALIDATE("Extension Contract", '');

                                                                //mg.sn, 09-03-11: M25508
                                                                PlantSetupRec.CHANGECOMPANY(CURRENTCOMPANY);
                                                                PlantSetupRec.GET;  //C022786.n
                                                                IF "Customer No." = '' THEN BEGIN
                                                                  //PlantSetupRec.GET;   //C022786.o
                                                                  VALIDATE("Gen. Bus. Posting Group", PlantSetupRec."Default Gen. Bus.Posting Group");
                                                                  "VAT Bus. Posting Group" := PlantSetupRec."Default VAT Bus.Posting Group";
                                                                END ELSE BEGIN
                                                                  IF ("Company Name" <> '') AND ("Company Name" <> COMPANYNAME) AND ("Gen. Bus. Posting Group" = '') THEN
                                                                    "Gen. Bus. Posting Group" := PlantSetupRec."Default Gen. Bus.Posting Group";
                                                                END;
                                                                //mg.en, 09-03-11: M25508

                                                                VALIDATE("VAT Bus. Posting Group");
                                                                IF ("Project No." <> '') AND (xRec."Project No." = '') THEN
                                                                  "BB with Sales Rate (L to L.)" := PlantSetupRec."BB with Sales Rate (L to L.)";  //C022786
                                                                TransferProjectData;
                                                              END;

                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 62  ;   ;Extension Contract  ;Code10        ;TableRelation=IF (Company Name=FILTER('')) "Extension Contract"."Contract No." WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=VAR
                                                                ExtensionContract@1210190000 : Record 11012004;
                                                              BEGIN
                                                                IF "Extension Contract" <> '' THEN BEGIN
                                                                  TESTFIELD("Project No.");
                                                                  IF "Company Name" <> '' THEN
                                                                    ExtensionContract.CHANGECOMPANY("Company Name");
                                                                  ExtensionContract.GET("Project No.","Extension Contract");
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              ExtensionContract@1100529000 : Record 11012004;
                                                            BEGIN
                                                              TESTFIELD("Project No.");
                                                              IF "Company Name" <> '' THEN
                                                                ExtensionContract.CHANGECOMPANY("Company Name");
                                                              ExtensionContract.SETRANGE("Project No.", "Project No.");
                                                              ExtensionContract."Project No." := "Project No.";
                                                              ExtensionContract."Contract No." := "Extension Contract";
                                                              IF PAGE.RUNMODAL(0, ExtensionContract) = ACTION::LookupOK THEN
                                                                VALIDATE("Extension Contract", ExtensionContract."Contract No.");
                                                            END;

                                                   CaptionML=[ENU=Extension Contract;
                                                              NOR=ETA;
                                                              SVE=ŽTA] }
    { 65  ;   ;Element             ;Code20        ;TableRelation=IF (Company Name=FILTER('')) "Project Element".Element WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=VAR
                                                                lvProjElementRec@1210190000 : Record 11012010;
                                                              BEGIN
                                                                IF Element = '' THEN
                                                                  EXIT;

                                                                TESTFIELD("Project No.");

                                                                ElementFormat.FormatElem(Element,2,"Company Name");

                                                                IF "Company Name" <> '' THEN
                                                                  lvProjElementRec.CHANGECOMPANY("Company Name");
                                                                lvProjElementRec.GET("Project No.", Element);
                                                              END;

                                                   OnLookup=VAR
                                                              lvProjElementRec@1210190000 : Record 11012010;
                                                            BEGIN
                                                              IF "Company Name" <> '' THEN
                                                                lvProjElementRec.CHANGECOMPANY("Company Name");
                                                              lvProjElementRec.SETRANGE("Project No.", "Project No.");
                                                              lvProjElementRec."Project No." := "Project No.";
                                                              lvProjElementRec.Element := Element;
                                                              IF PAGE.RUNMODAL(0,lvProjElementRec) = ACTION::LookupOK THEN
                                                                VALIDATE(Element,lvProjElementRec.Element);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 66  ;   ;Try-out Quote No.   ;Code20        ;TableRelation=IF (Company Name=FILTER('')) "Try-out Quote";
                                                   OnValidate=VAR
                                                                TryoutQuote@1100529000 : Record 11012758;
                                                              BEGIN
                                                                IF "Try-out Quote No." = '' THEN
                                                                  EXIT;
                                                                TESTFIELD("Service Order No.", '');
                                                                TESTFIELD("Employee No.", '');
                                                                TESTFIELD("Plant Type", '');

                                                                IF "Company Name" <> '' THEN
                                                                  TryoutQuote.CHANGECOMPANY("Company Name");
                                                                TryoutQuote.GET("Try-out Quote No.");

                                                                IF ("Try-out Quote No." <> xRec."Try-out Quote No.") AND ("Project No." = '') THEN
                                                                  TransferTryOutQuoteData(TryoutQuote);
                                                              END;

                                                   OnLookup=VAR
                                                              TryoutQuote@1100529000 : Record 11012758;
                                                            BEGIN
                                                              IF "Company Name" <> '' THEN
                                                                TryoutQuote.CHANGECOMPANY("Company Name");
                                                              TryoutQuote.Code := "Try-out Quote No.";
                                                              IF PAGE.RUNMODAL(0, TryoutQuote) = ACTION::LookupOK THEN
                                                                VALIDATE("Try-out Quote No.", TryoutQuote.Code);
                                                            END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Try-out Quote No.;
                                                              SVE=Anbudsf”rfr†gan] }
    { 67  ;   ;Project Address Code;Code10        ;TableRelation=IF (Company Name=CONST(),
                                                                     Project No.=CONST()) "Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                        Project Address=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                IF ("Project Address Code" <> '') THEN BEGIN
                                                                  TESTFIELD("Project No.", '');
                                                                  TESTFIELD("Service Order No.", '');
                                                                  TESTFIELD("Company Name", '');
                                                                END;

                                                                IF ("Project Address Code" <> '') AND
                                                                   ("Project Address Code" <> xRec."Project Address Code") AND
                                                                   (CurrFieldNo = FIELDNO("Project Address Code"))
                                                                THEN
                                                                  TransferCustJobAddress();
                                                              END;

                                                   CaptionML=[ENU=Project Address Code;
                                                              NOR=Prosjektets Adressekode;
                                                              SVE=Projektets adresskod] }
    { 68  ;   ;Employee No.        ;Code20        ;TableRelation=IF (Company Name=FILTER('')) Employee;
                                                   OnValidate=VAR
                                                                lvEmplRec@1100485000 : Record 5200;
                                                              BEGIN
                                                                IF "Employee No." = '' THEN BEGIN
                                                                  CALCFIELDS("Employee Location");
                                                                  EXIT;
                                                                END;

                                                                TESTFIELD("Project No.", '');
                                                                TESTFIELD("Try-out Quote No.", '');
                                                                TESTFIELD("Service Order No.", '');
                                                                IF "Company Name" = '' THEN
                                                                  TESTFIELD("Customer No.", '');
                                                                TESTFIELD("Plant Type", '');  //DP00815

                                                                IF "Company Name" <> '' THEN
                                                                  lvEmplRec.CHANGECOMPANY("Company Name");

                                                                lvEmplRec.GET("Employee No.");
                                                                CALCFIELDS("Employee Location");

                                                                //mg.sn, 09-03-11: M25508
                                                                IF ("Customer No." = '') AND ("Gen. Bus. Posting Group" = '') AND ("VAT Bus. Posting Group" = '') THEN BEGIN //C027382.c
                                                                  PlantSetupRec.GET;
                                                                  VALIDATE("Gen. Bus. Posting Group", PlantSetupRec."Default Gen. Bus.Posting Group");
                                                                  VALIDATE("VAT Bus. Posting Group", PlantSetupRec."Default VAT Bus.Posting Group");
                                                                END;
                                                                //mg.en, 09-03-11: M25508

                                                                TransferEmployeeData(lvEmplRec);
                                                              END;

                                                   CaptionML=[ENU=Employee No.;
                                                              NOR=Ansattnr;
                                                              SVE=Anst„llningsnr] }
    { 70  ;   ;Address             ;Text100       ;CaptionML=[ENU=Address;
                                                              NOR=Adresse;
                                                              SVE=Adress];
                                                   Editable=Yes }
    { 80  ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2;
                                                              SVE=Adress 2];
                                                   Editable=Yes }
    { 90  ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Sted;
                                                              SVE=Ort];
                                                   Editable=Yes }
    { 100 ;   ;Contact             ;Text100       ;OnLookup=BEGIN
                                                              LookupContact;
                                                            END;

                                                   CaptionML=[ENU=Contact;
                                                              NOR=Kontaktperson;
                                                              SVE=Kontakt];
                                                   Editable=Yes }
    { 110 ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              NOR=Delstat;
                                                              SVE=Delstat];
                                                   Editable=Yes }
    { 120 ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                NormalizePostCodeHouseNo;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr;
                                                              SVE=Postnr];
                                                   Editable=Yes }
    { 125 ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode;
                                                              SVE=Lands-/regionkod] }
    { 130 ;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              NOR=Telefonnr.;
                                                              SVE=Telefonnr] }
    { 135 ;   ;Mobile Phone No.    ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=ENU=Mobile Phone No. (Mobile) }
    { 140 ;   ;Fax No.             ;Text30        ;CaptionML=[ENU=Fax No.;
                                                              NOR=Telefaxnr;
                                                              SVE=Telefaxnr] }
    { 150 ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[ENU=Territory Code;
                                                              NOR=Distriktskode;
                                                              SVE=Distriktskod] }
    { 155 ;   ;Department Code     ;Code20        ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=VAR
                                                                PlantNeed@1100529000 : Record 11012579;
                                                              BEGIN
                                                                ValidateShortcutDimCode(1, "Department Code");
                                                                IF ("Department Code" <> '') AND ("Department Code" <> xRec."Department Code") THEN BEGIN
                                                                  PlantNeed.SETRANGE(Location, Code);
                                                                  IF PlantNeed.ISEMPTY THEN
                                                                    FillDefaultFromDepotPlantNeed;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Avdelingskode;
                                                              SVE=Mottagande avdelningskod];
                                                   CaptionClass='1,1,1' }
    { 160 ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr-serie;
                                                              SVE=Nr-serier];
                                                   Editable=No }
    { 170 ;   ;Depot               ;Boolean       ;OnValidate=BEGIN
                                                                IF Depot THEN BEGIN
                                                                  TESTFIELD("Rate Codes by Location", FALSE);
                                                                  "Damage Settlement" := FALSE;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Depot;
                                                              NOR=Depot;
                                                              SVE=Dep†] }
    { 175 ;   ;Employee Location   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Plant Location" WHERE (Code=FIELD(Code),
                                                                                             Employee No.=FILTER(<>'')));
                                                   CaptionML=[ENU=Employee Location;
                                                              NOR=Ansatt, lokasjon;
                                                              SVE=Anst„lld, plats];
                                                   Editable=No }
    { 180 ;   ;Blocked             ;Boolean       ;CaptionML=[ENU=Blocked;
                                                              NOR=Sperret;
                                                              SVE=Sp„rrad] }
    { 190 ;   ;Picture             ;BLOB          ;CaptionML=[ENU=Picture;
                                                              NOR=Bilde;
                                                              SVE=Bild];
                                                   SubType=Bitmap }
    { 200 ;   ;Starting Date       ;Date          ;CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato;
                                                              SVE=Startdatum] }
    { 210 ;   ;Ending Date         ;Date          ;CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato;
                                                              SVE=Slutdatum] }
    { 220 ;   ;Discount %          ;Decimal       ;OnValidate=BEGIN
                                                                //* Wordt niet meer gebruikt voor huurkorting. Alleen nog voor korting uren, v/t-verkoop en MO-artikelen, afh. mat.instellingen.
                                                                IF "Discount %" <> 0 THEN BEGIN
                                                                  PlantSetupRec.GET;
                                                                  IF (NOT PlantSetupRec."Discount Plant Hours") AND
                                                                     (NOT PlantSetupRec."Discount Sales/Buy Back") AND
                                                                     (NOT PlantSetupRec."Discount Items")
                                                                  THEN
                                                                    ERROR(Text016);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Discount %;
                                                              NOR=Rabatt-%;
                                                              SVE=Rabatt %];
                                                   DecimalPlaces=0:5;
                                                   MaxValue=100 }
    { 230 ;   ;Calendar            ;Option        ;OnValidate=BEGIN
                                                                TESTFIELD("Rate Type", "Rate Type"::Day);
                                                              END;

                                                   CaptionML=[ENU=Calendar;
                                                              NOR=Kalender;
                                                              SVE=Kalender];
                                                   OptionCaptionML=[ENU=Standard,Region,Both,None;
                                                                    NOR=Standard,Region,Begge,Ingen;
                                                                    SVE=Standard,Region,B†da,Inget];
                                                   OptionString=Standard,Region,Both,None }
    { 240 ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=VAR
                                                                lvText@1100525000 : Text[50];
                                                              BEGIN
                                                                //IF ("VAT Bus. Posting Group" <> '') AND ("Customer No." = '') THEN BEGIN
                                                                //* Testcall 4780: Customer is only empty if project or serviceorder filled and company is empty
                                                                //*                Must be no VAT if project or serviceorder filled (so also if in other company)
                                                                IF ("VAT Bus. Posting Group" <> '') AND (("Project No." <> '') OR ("Service Order No." <> '') OR ("Plant Type" <> '')) THEN BEGIN
                                                                  VATPostSetup.SETRANGE("VAT Bus. Posting Group", "VAT Bus. Posting Group");
                                                                  VATPostSetup.SETFILTER("VAT %",'<>0');
                                                                  IF VATPostSetup.FINDFIRST THEN BEGIN
                                                                    IF "Plant Type" <> '' THEN
                                                                      lvText := Text023  //DP00815
                                                                    ELSE BEGIN
                                                                      IF "Service Order No." = '' THEN
                                                                        lvText := ProjRec.TABLECAPTION
                                                                      ELSE
                                                                        lvText := ServOrderRec.TABLECAPTION;
                                                                    END;
                                                                    MESSAGE(
                                                                      Text000,
                                                                      FIELDCAPTION("VAT Bus. Posting Group"), "VAT Bus. Posting Group", lvText);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - firma;
                                                              SVE=Moms r”relsebokf”ringsmall] }
    { 250 ;   ;Distance            ;Decimal       ;CaptionML=[ENU=Distance (km);
                                                              NOR=Avstand;
                                                              SVE=Avst†nd];
                                                   DecimalPlaces=2:2;
                                                   MinValue=0 }
    { 260 ;   ;Gen. Bus. Posting Group;Code20     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokf›ringsgruppe - firma;
                                                              SVE=Gen. r”relsebokf”ringsmall] }
    { 265 ;   ;Rate Type           ;Option        ;OnValidate=BEGIN
                                                                IF "Rate Type" <> "Rate Type"::Day THEN BEGIN
                                                                  TESTFIELD(Calendar, Calendar::None);
                                                                  PlantSetupRec.GET;
                                                                  PlantSetupRec.TESTFIELD("Type Division of Rate Comp.", PlantSetupRec."Type Division of Rate Comp."::Proportional);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Rate Type;
                                                              NOR=Avgiftstype;
                                                              SVE=Avgiftstyp];
                                                   OptionCaptionML=[ENU=Day,Week,,Month;
                                                                    NOR=Dag,Uke,,M†ned;
                                                                    SVE=Dag,Vecka,,M†nad];
                                                   OptionString=Day,Week,,Month }
    { 270 ;   ;Invoice Method      ;Code10        ;TableRelation="Plant Invoice Method";
                                                   OnValidate=BEGIN
                                                                IF "Invoice Method" <> '' THEN BEGIN
                                                                  PlantSetupRec.GET;
                                                                  IF PlantSetupRec."Level One Loc. per Invoice" = PlantSetupRec."Level One Loc. per Invoice"::Setup THEN
                                                                    PlantSetupRec.TESTFIELD("One Location per Invoice");  //* Als op klantniveau, heeft geen zin om dit hier te testen
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Invoice Method;
                                                              NOR=Faktureringsmetode;
                                                              SVE=Faktureringsmetod] }
    { 275 ;   ;Invoice Copies      ;Integer       ;OnValidate=BEGIN
                                                                IF "Invoice Copies" <> 0 THEN BEGIN
                                                                  PlantSetupRec.GET;
                                                                  IF PlantSetupRec."Level One Loc. per Invoice" = PlantSetupRec."Level One Loc. per Invoice"::Setup THEN
                                                                    PlantSetupRec.TESTFIELD("One Location per Invoice");  //* Als op klantniveau, heeft geen zin om dit hier te testen
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Invoice Copies;
                                                              NOR=Antall fakturakopier;
                                                              SVE=Fakturakopior];
                                                   MinValue=0;
                                                   MaxValue=9 }
    { 280 ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF "Bill-to Customer No." <> '' THEN
                                                                  TESTFIELD("Customer No.");
                                                                IF "Bill-to Customer No." <> xRec."Bill-to Customer No." THEN
                                                                  "Alternative Bill-to Address" := '';
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              NOR=Faktura til-kundenr.;
                                                              SVE=Faktureringskundnr] }
    { 281 ;   ;Bill-to Customer Name;Text100      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to Customer Name;
                                                              NOR="Faktura til-kunde, navn ";
                                                              SVE=Namn p† faktureringskund];
                                                   Editable=No }
    { 285 ;   ;Alternative Bill-to Address;Code10 ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Bill-to Customer No.),
                                                                                               Billing Address=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                IF "Alternative Bill-to Address" <> '' THEN BEGIN
                                                                  TESTFIELD("Customer No.");
                                                                  TESTFIELD("Bill-to Customer No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Alternative Bill-to Address;
                                                              NOR=Alternativ Faktureringsadresse;
                                                              SVE=Alternativ faktureringsadress] }
    { 290 ;   ;Rate Codes by Location;Boolean     ;OnValidate=BEGIN
                                                                IF "Rate Codes by Location" THEN BEGIN
                                                                  PlantSetupRec.GET;
                                                                  PlantSetupRec.TESTFIELD("Rate Codes", TRUE);
                                                                  TESTFIELD(Depot, FALSE);
                                                                  InsertDefaultRateCodesByLoc();
                                                                END ELSE BEGIN
                                                                  PlantLocRateCodeRec.RESET;
                                                                  PlantLocRateCodeRec.SETRANGE(Location, Code);
                                                                  IF NOT PlantLocRateCodeRec.ISEMPTY THEN
                                                                    ERROR(Text022);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Rate Codes by Location;
                                                              NOR=Avgiftskoder etter lokasjon;
                                                              SVE=Avgiftskoder efter maskinplats] }
    { 300 ;   ;Creation Date       ;Date          ;CaptionML=[ENU=Creation Date;
                                                              NOR=Opprettelsesdato;
                                                              SVE=Uppl„ggningsdatum];
                                                   Editable=No }
    { 301 ;   ;Created by          ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Created by;
                                                              NOR=Opprettet av;
                                                              SVE=Skapades av];
                                                   Editable=No }
    { 310 ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den;
                                                              SVE=Uppdateringsdatum];
                                                   Editable=No }
    { 311 ;   ;Modified by         ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Modified by;
                                                              NOR=Endret av;
                                                              SVE=Žndrad av];
                                                   Editable=No }
    { 320 ;   ;Location Code (Items);Code10       ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                //* DP00183
                                                                IF "Location Code (Items)" <> '' THEN
                                                                  TESTFIELD(Depot, TRUE);
                                                              END;

                                                   CaptionML=[ENU=Location Code (Items);
                                                              NOR=Plasseringskode (Artikler);
                                                              SVE=Platskod (artiklar)];
                                                   Description=Default Location Code for Items on Depot }
    { 330 ;   ;From Depot (Plant Need);Code20     ;TableRelation="Plant Location" WHERE (Depot=CONST(Yes));
                                                   OnValidate=VAR
                                                                PlantNeed@1100529000 : Record 11012579;
                                                              BEGIN
                                                                IF "From Depot (Plant Need)" <> '' THEN BEGIN
                                                                  IF "From Depot (Plant Need)" <> xRec."From Depot (Plant Need)" THEN BEGIN
                                                                    PlantNeed.SETRANGE(Location, Code);
                                                                    PlantNeed.SETFILTER("From Depot", '%1|%2', xRec."From Depot (Plant Need)", '');
                                                                    PlantNeed.MODIFYALL("From Depot", "From Depot (Plant Need)");
                                                                  END;
                                                                END;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=From Depot (Plant Need);
                                                   Description=Default From Depot for Plant Need }
    { 350 ;   ;No. of Linked Estimates;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count(Estimate WHERE (Plant Location=FIELD(Code)));
                                                   CaptionML=[ENU=No. of Linked Estimates;
                                                              NOR=Antall koblede Kalkyler;
                                                              SVE=Antal l„nkade kalkyler];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 351 ;   ;Estimate No.        ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Estimate.No. WHERE (Plant Location=FIELD(Code)));
                                                   CaptionML=[ENU=Estimate No.;
                                                              NOR=Kalkylenr;
                                                              SVE=Kalkylnr];
                                                   Editable=No }
    { 352 ;   ;Estimate Company    ;Text30        ;TableRelation=Company;
                                                   OnValidate=BEGIN
                                                                IF "Estimate Company" = COMPANYNAME THEN
                                                                  "Estimate Company" := '';
                                                                IF "Estimate Company" <> xRec."Estimate Company" THEN BEGIN
                                                                  "Estimate No." := GetEstimateNo(xRec."Estimate Company", FALSE);
                                                                  IF "Estimate No." <> '' THEN
                                                                    FIELDERROR("Estimate Company", STRSUBSTNO(Text024, FIELDCAPTION("Estimate No."), ''));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Estimate Company;
                                                              SVE=Kalkylf”retag] }
    { 400 ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter;
                                                              SVE=Datumfilter] }
    { 405 ;   ;Relate to Filter    ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Relate to Filter;
                                                              NOR=Relater til filter;
                                                              SVE=Relatera till filter];
                                                   OptionCaptionML=[ENU=" ,Rental,Sales,Missing,Scrap,Buy Back,Hours,Transport,Sundry Costs,Plant Hours,Damage,Job Order,Load/Unload,Item,Item Buy-Back";
                                                                    NOR=" ,Leie,Salg,Mangler,Utrangeres,Tilbakekj›p,Timer,Transport,Diversekoster,Maskintimer,Skade,Jobbordre,Lasting/Avlasting,Artikkel,Artikkel Tilbakekj›p";
                                                                    SVE=" ,Uthyrning,F”rs„ljning,Saknas,Skrot,terk”p,Timmar,Transport,Diversekostnader,Maskintimmar,Skada,Arbetsorder,Lastning/avlastning,Artikel,Artikel†terk”p"];
                                                   OptionString=[ ,Rental,Sales,Missing,Scrap,Buy Back,Hours,Transport,Sundry Costs,Plant Hours,Damage,Job Order,Load/Unload,Item,ItemBuyBack];
                                                   Description=Options must be the same in the tables 37, 113, 115, 11012572, 11020501 !!!! But first option must be ' ' (space) io empty }
    { 410 ;   ;Revenues            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Plant Ledger Entry"."Total Price" WHERE (Plant Location=FIELD(Code),
                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                             Relate to=FIELD(Relate to Filter)));
                                                   CaptionML=[ENU=Revenues;
                                                              NOR=Inntekter;
                                                              SVE=Int„kter];
                                                   Editable=No }
    { 420 ;   ;Kind of Rate        ;Option        ;InitValue=Intern;
                                                   CaptionML=[ENU=Kind of Rate;
                                                              NOR=Satstype;
                                                              SVE=Avgiftstyp];
                                                   OptionCaptionML=[ENU=Intern,Extern;
                                                                    NOR=Internt,Eksternt;
                                                                    SVE=Internt,Externt];
                                                   OptionString=Intern,Extern }
    { 430 ;   ;Damage Settlement   ;Boolean       ;OnValidate=BEGIN
                                                                IF "Damage Settlement" THEN
                                                                  TESTFIELD(Depot, FALSE);
                                                              END;

                                                   CaptionML=[ENU=Damage Settlement;
                                                              NOR=Skadeoppgj›r;
                                                              SVE=Skadeavr„kning] }
    { 440 ;   ;Status              ;Option        ;OnValidate=VAR
                                                                lvProjRec@1100525000 : Record 11072003;
                                                                lvServOrderRec@1100525001 : Record 11012823;
                                                              BEGIN
                                                                IF Status = xRec.Status THEN
                                                                  EXIT;

                                                                CASE Status OF
                                                                  Status::Finished:
                                                                    IF xRec.Status <> Status::Archive THEN
                                                                      ERROR(Text007);
                                                                  Status::Archive:
                                                                    IF xRec.Status <> Status::Finished THEN
                                                                      ERROR(Text008);
                                                                  Status::Archived:
                                                                    ERROR(Text009);
                                                                END;

                                                                CASE xRec.Status OF
                                                                  xRec.Status::Archived:
                                                                    IF Status < xRec.Status THEN
                                                                      ERROR(Text011);
                                                                END;

                                                                IF (xRec.Status >= Status::Finished) AND (Status < Status::Finished) THEN BEGIN
                                                                  IF "Project No." <> '' THEN BEGIN
                                                                    IF "Company Name" <> '' THEN
                                                                      lvProjRec.CHANGECOMPANY("Company Name");
                                                                    lvProjRec.GET("Project No.");
                                                                    IF lvProjRec."Project Status" >= lvProjRec."Project Status"::Finished THEN BEGIN
                                                                      IF NOT CONFIRM(Text019, FALSE,
                                                                        lvProjRec.FIELDCAPTION("Project Status"), lvProjRec."Project Status", FIELDCAPTION("Project No."), "Project No.")
                                                                      THEN
                                                                        ERROR('');
                                                                    END;
                                                                  END;
                                                                  IF "Service Order No." <> '' THEN BEGIN
                                                                    IF "Company Name" <> '' THEN
                                                                      lvServOrderRec.CHANGECOMPANY("Company Name");
                                                                    lvServOrderRec.GET("Service Order No.");
                                                                    IF lvServOrderRec.Status = lvServOrderRec.Status::Finished THEN BEGIN
                                                                      IF NOT CONFIRM(Text019, FALSE,
                                                                        lvServOrderRec.FIELDCAPTION(Status), lvServOrderRec.Status, FIELDCAPTION("Service Order No."), "Service Order No.")
                                                                      THEN
                                                                        ERROR('');
                                                                    END;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NOR=Status;
                                                              SVE=Status];
                                                   OptionCaptionML=[ENU=Production,Technical Finished,Administrative Finished,Finished,Archive,Archived;
                                                                    NOR=Produksjon,Tekniskt Ferdig,Administrativt Ferdig,Ferdig,Arkiv,Arkivert;
                                                                    SVE=Produktion,Tekniskt f„rdig,Administrativt f„rdigt,F„rdigt,Arkiv,Arkiverad];
                                                   OptionString=Production,Technical Finished,Administrative Finished,Finished,Archive,Archived }
    { 450 ;   ;VAT Location Code   ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=VAT Location Code;
                                                              NOR=Mva. plasseringskode;
                                                              SVE=Moms maskinplats, kod] }
    { 460 ;   ;E-Mail              ;Text80        ;OnValidate=VAR
                                                                RecRef@1100529300 : RecordRef;
                                                                FldRef@1100529301 : FieldRef;
                                                                ContactDataValidation@1100529302 : Codeunit 11012275;
                                                              BEGIN
                                                                RecRef.GETTABLE(Rec);
                                                                FldRef := RecRef.FIELD(FIELDNO("E-Mail"));
                                                                ContactDataValidation.ValidateEmail(FldRef, "E-Mail");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email;
                                                              NOR=E-post;
                                                              SVE=E-post] }
    { 462 ;   ;E-Mail Status PO Modified;Text80   ;OnValidate=VAR
                                                                RecRef@1100529300 : RecordRef;
                                                                FldRef@1100529301 : FieldRef;
                                                                ContactDataValidation@1100529302 : Codeunit 11012275;
                                                              BEGIN
                                                                RecRef.GETTABLE(Rec);
                                                                FldRef := RecRef.FIELD(FIELDNO("E-Mail Status PO Modified"));
                                                                ContactDataValidation.ValidateEmail(FldRef, "E-Mail Status PO Modified");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=ENU=Email Status PO Modified;
                                                   Description=For Site Manager, only Released and Posted }
    { 470 ;   ;Contact Phone No.   ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Contact Phone No.;
                                                              NOR=Kontaktpersonens telefonnummer;
                                                              SVE=Kontaktens telefonnr] }
    { 480 ;   ;Travel Distance     ;Decimal       ;CaptionML=[ENU=Travel Distance;
                                                              NOR=Reiseavstand;
                                                              SVE=Resstr„cka];
                                                   MinValue=0 }
    { 490 ;   ;Travel Time         ;Decimal       ;CaptionML=[ENU=Travel Time;
                                                              NOR=Reisetid;
                                                              SVE=Restid];
                                                   MinValue=0 }
    { 500 ;   ;Travel Cost Code    ;Code10        ;TableRelation="Travel Cost Code";
                                                   CaptionML=[ENU=Travel Cost Code;
                                                              NOR=Reisekostkode;
                                                              SVE=Resekostnadskod] }
    { 510 ;   ;House No.           ;Code20        ;CaptionML=[ENU=House No.;
                                                              NOR=Husnr.;
                                                              SVE=Husnr] }
    { 520 ;   ;House No. Ext.      ;Code10        ;CaptionML=[ENU=House No. Extension;
                                                              NOR=Husnr ETA;
                                                              SVE=Husnr ÄTA] }
    { 530 ;   ;BB with Sales Rate (L to L.);Boolean;
                                                   OnValidate=BEGIN
                                                                //C022786
                                                                IF "BB with Sales Rate (L to L.)" AND ("Project No." = '') THEN
                                                                  TESTFIELD("BB with Sales Rate (L to L.)", FALSE);
                                                              END;

                                                   CaptionML=ENU=Buy Back with Sales Rate (L->L Proj. same Comp.);
                                                   Description=Only for 'Other tranfers' for locations with project in the same company }
    { 540 ;   ;Internal Charge Plant Entry as;Option;
                                                   OnValidate=BEGIN
                                                                //DP00815
                                                                IF "Internal Charge Plant Entry as" <> 0 THEN
                                                                  TESTFIELD("Plant Type")
                                                                ELSE BEGIN
                                                                  IF "Plant Type" <> '' THEN
                                                                    TESTFIELD("Internal Charge Plant Entry as");
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Internal Charge Plant Entry as;
                                                   OptionCaptionML=ENU=" ,Cost,Neg. Revenue";
                                                   OptionString=[ ,Cost,NegRevenue] }
    { 550 ;   ;Order No. Customer  ;Text50        ;CaptionML=[ENU=Order No. Customer;
                                                              NOR=Ordrenr, (Kunde);
                                                              SVE=Ordernr, (kund)] }
    { 560 ;   ;Customer Reference  ;Text50        ;CaptionML=[ENU=Customer Reference;
                                                              NOR=Kundreferanse;
                                                              SVE=Kundreferens] }
    { 600 ;   ;Reference Date for Prices;Date     ;OnValidate=BEGIN
                                                                "Reference Date for Discounts" := "Reference Date for Prices";
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Reference Date for Prices }
    { 610 ;   ;Reference Date for Discounts;Date  ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Reference Date for Discounts }
    { 620 ;   ;Customer Price Group (Rental);Code10;
                                                   TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                IF "Customer Price Group (Rental)" <> '' THEN
                                                                  CheckIfCustomerPriceAndDiscGroupCanBeFilled;
                                                              END;

                                                   CaptionML=ENU=Customer Price Group (Rental) }
    { 630 ;   ;Customer Disc. Group (Rental);Code20;
                                                   TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                IF "Customer Disc. Group (Rental)" <> '' THEN
                                                                  CheckIfCustomerPriceAndDiscGroupCanBeFilled;
                                                              END;

                                                   CaptionML=ENU=Customer Disc. Group (Rental) }
    { 640 ;   ;Image               ;Media         ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Image;
                                                              SVE=Bild] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Customer No.,Project No.,Service Order No. }
    {    ;Company Name,Project No.,Service Order No.,Employee No. }
    {    ;Post Code,House No.,House No. Ext.       }
    {    ;Search Name                              }
    {    ;Company Name,Try-out Quote No.           }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Code,Description,Search Name             }
  }
  CODE
  {
    VAR
      Text000@11012007 : TextConst 'ENU=Warning! Make sure that in GL Setup for ''%1'' ''%2'' no VAT will be posted on ''%3''.';
      Text001@11012008 : TextConst 'ENU=Copy %1 Data?;NOR=Kopier %1 Data?;SVE=Kopiera %1 data?';
      Text002@11012009 : TextConst 'ENU=%1 %2 still has plant in stock.;NOR=%1 %2 har fortsatt maskin p† lager.;SVE=%1 %2 har fortfarande Maskin i lager.';
      Text002b@1100529000 : TextConst 'ENU=%1 %2 still has negative plant stock.;NOR=%1 %2 har fortsatt negativ maskinbeholdning';
      Text002c@1100525009 : TextConst 'ENU=%1 %2 still has negative stock of sales/buyback plant.';
      Text002d@1100528000 : TextConst 'ENU=Warning:;NOR=Advarsel:;SVE=Varning:';
      Text002e@1100528001 : TextConst 'ENU=This must be corrected asap!';
      Text003@11012010 : TextConst 'ENU=%1 %2 has plant which is not completely invoiced.;NOR=%1 %2 har maskin som ikke er fullstendig fakturert.;SVE=%1 %2 har Maskin som inte har fakturerats helt.';
      Text004@11012011 : TextConst 'ENU=%1 %2 is not posted yet.;NOR=%1 %2 er enda ikke bokf›rt;SVE=%1 %2 „r „nnu inte bokf”rd.';
      Text005@11012012 : TextConst 'ENU=%1 %2 is not invoiced yet.;NOR=%1 %2 er enda ikke fakturert.;SVE=%1 %2 „r „nnu inte fakturerad.';
      Text006@11012013 : TextConst 'ENU=%1 %2 is not invoiced completely.;NOR=%1 %2 er ikke fullstendig fakturert.;SVE=%1 %2 „r inte helt fakturerad.';
      PlantSetupRec@11012000 : Record 11012550;
      ProjSetupRec@1100525003 : Record 315;
      PlantLocRec@11012001 : Record 11012554;
      PostCode@11012002 : Record 225;
      ProjRec@11012004 : Record 11072003;
      ServOrderRec@1100525002 : Record 11012823;
      CustRec@11012005 : Record 18;
      VATPostSetup@1210190000 : Record 325;
      PlantInvRec@1210190001 : Record 11012555;
      PlantNeedRec@1210190002 : Record 11012579;
      GenBusPostingGrp@1210190004 : Record 250;
      PlantLedgerEntry@1100485002 : Record 11012572;
      PlantLedgerEntry2@1100485007 : Record 11012572;
      PlantLocRateCodeRec@1100525006 : Record 11020551;
      NoSeriesMgt@1100529002 : Codeunit 396;
      ElementFormat@1210190003 : Codeunit 11012022;
      DimMgt@1100525008 : Codeunit 408;
      ErrorTxt@11012006 : Text[250];
      Text007@1100485025 : TextConst 'ENU=Status not allowed, will be set by Plant Location Closing session;NOR=Status er ikke tillatt, stilles inn av Stengnings›kten for maskinplassering;SVE=Status „r inte till†tet, st„lls in genom st„ngningssessionen f”r Maskinsplats';
      Text008@1100485001 : TextConst 'ENU=Status not allowed, close Plant Location first;NOR=Status er ikke tillatt, lukk maskinlokasjonf›rst;SVE=Status „r inte till†ten, st„ng Maskinsplats f”rst';
      Text009@1100485024 : TextConst 'ENU=Status not allowed, will be set by Plant Location Archiving session;NOR=Status er ikke tillatt, stilles inn av Arkiverings›kten for maskinplassering;SVE=Status „r inte till†tet, st„lls in genom arkiveringssessionen f”r Maskinsplats';
      Text011@1100485023 : TextConst 'ENU=Plant Location archived, turning back status not allowed;NOR=Maskinlokasjonen er arkivert, † endre status er ikke tillatt;SVE=Maskinutplaceringen „r arkiverad, att „ndra status „r inte till†tet';
      Text012@1100485005 : TextConst 'ENU=You cannot delete a Location if status is order.;NOR=Du kan ikke fjerne en lokasjon hvis status er ordre.;SVE=Du kan inte ta bort ett lagerst„lle om status „r order.';
      Text013@1100485004 : TextConst 'ENU=Location is not archived, do you want to continue ?;NOR=Plassering er ikke arkivert, vil du fortsette?;SVE=Lagerst„llet har inte arkiverats, vill du forts„tta?';
      Text014@1100485003 : TextConst 'ENU=Location not removed;NOR=Plassering er ikke fjernet;SVE=Lagerst„llet har inte tagits bort';
      Text015@1100485006 : TextConst 'ENU=%1 %2 has %3 %4.;NOR=%1 %2 har %3 %4.;SVE=%1 %2 har %3 %4.';
      Text016@1100485008 : TextConst 'ENU=Plant Seup voor use of discounts are all inactive.;NOR=Alle maskinoppsett for bruk av rabatter er inaktive.;SVE=Maskinupps„ttning f”r anv„ndning av rabatter „r alla inaktiva.';
      Text017@1100485009 : TextConst 'ENU=Copy Job Address Data?;NOR=Kopier jobbadressedata?;SVE=Kopiera jobbadressdata?';
      Text018@1100485012 : TextConst 'ENU=Copy Emplyee Data?;NOR=Kopier Ansatt-data?;SVE=Kopiera personaldata?';
      gPlantCompany@1100525000 : Text[30];
      Text019@1100525001 : TextConst 'ENU=Note: %1 is ''%2'', posting on %3 ''%4'' is not possible anymore. Are you sure?;NOR=Obs! %1 er ''%2'', bokf›ring p† %3 ''%4'' er ikke lenger mulig. Er du sikker?;SVE=Obs! %1 „r ''%2'', bokf”ring p† %3 ''%4'' „r inte l„ngre m”jligt. Žr du s„ker?';
      Text020@1100525004 : TextConst 'ENU=%1 ''%2'' is not setup as %3 in %4 of company ''%5''.;NOR=%1 ''%2'' er ikke stilt inn som %3 i %4 av selskap ''%5''.;SVE=%1 ''%2'' „r inte inst„llt som %3 i %4 av f”retag ''%5''.';
      Text021@1100525005 : TextConst 'ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.;NOR=F›r du kan bruke Online Map m† du fylle ut vinduet Online Map - Innstillinger.\Se Konfigurasjon av Online Map i Hjelp;SVE=Innan du kan anv„nda Online Map m†ste du fylla i f”nstret Online Map - inst„llning.\Se Konfiguration av Online Map i hj„lpen';
      Text022@1100525007 : TextConst 'ENU=Not allowed, rate codes by location present.;NOR=Ikke tillatt, det finnes satskoder etter lokasjon.;SVE=Inte till†tet, det finns avgiftskoder efter lagerst„lle.';
      DPA_Management@1100000999 : Codeunit 11012783;
      Text023@1100529001 : TextConst 'ENU=Plant - Internal Charge';
      Text024@1100529400 : TextConst 'ENU=modify not allowed, already linked to %1 ''%2''';
      Text025@1100527004 : TextConst 'ENU=Update a Plant Location of Project ''%1''. Projectstatus is ''%2'', are you sure?';
      Text026@1100527003 : TextConst 'ENU=Do you want to update a Plant Location of Project ''%1''?';
      Text027@1100527002 : TextConst 'ENU=Plant Location ''%1'' is updated in plant company ''%2''.';
      Text028@1100527001 : TextConst 'ENU=Plant Location ''%1'' is updated in %2 plant companies.';
      FPSLicenseManagement@1100527400 : Codeunit 11229289;
      Text029@1100528400 : TextConst 'ENU=%1 or %2 must be filled.';

    PROCEDURE InitRecord@1100485001();
    BEGIN
      IF CURRENTCOMPANY <> COMPANYNAME THEN
        PlantSetupRec.CHANGECOMPANY(CURRENTCOMPANY);
      PlantSetupRec.GET;
      "Rate Type" := PlantSetupRec."Rate Type";
      "Damage Settlement" := PlantSetupRec."Default Damage Settlement Loc.";
    END;

    PROCEDURE AssistEdit@2(OldPlantLocRec@11012000 : Record 11012554) : Boolean;
    BEGIN
      WITH PlantLocRec DO BEGIN
        PlantLocRec := Rec;
        PlantSetupRec.GET;
        IF PlantSetupRec."Plant Location Nos." <> '' THEN BEGIN
          IF NoSeriesMgt.SelectSeries(PlantSetupRec."Plant Location Nos.", OldPlantLocRec."No. Series", "No. Series") THEN BEGIN
            NoSeriesMgt.SetSeries(Code);
            Rec := PlantLocRec;
            EXIT(TRUE);
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    PROCEDURE TransferProjectData@1();
    VAR
      lvEmplRec@1100525000 : Record 5200;
    BEGIN
      IF Description <> '' THEN
        IF NOT CONFIRM(Text001, FALSE, ProjRec.TABLECAPTION) THEN
          EXIT;

      Description := ProjRec.Description;
      "Description 2" := ProjRec."Description 2";
      "Search Name" :=  ProjRec."Search Description";
      Address := ProjRec.Address;
      "Address 2" := ProjRec."Address 2";
      City := ProjRec.City;
      //Contact := ProjRec.SiteManagerName; // SiteManagerName is a function where EmplRec is read, must be in the project company
      IF ProjRec."Site Manager" <> '' THEN BEGIN
        IF "Company Name" <> '' THEN
          lvEmplRec.CHANGECOMPANY("Company Name");
        IF lvEmplRec.GET(ProjRec."Site Manager") THEN BEGIN
          Contact := COPYSTR(lvEmplRec."Full Name", 1 , MAXSTRLEN(Contact));
          //C023677.so
          //"Contact Phone No." := lvEmplRec."Phone No.";  //C009645
          //"E-Mail" := lvEmplRec."E-Mail";                //C009645
          //C023677.so
          //C023677.sn
          "Contact Phone No." :=
            COPYSTR(lvEmplRec."Company Mobile Phone No." + ' / ' + lvEmplRec."Company Phone No.", 1, MAXSTRLEN("Contact Phone No."));
          "E-Mail" := lvEmplRec."Company E-Mail";
          //C023677.en
        END;
      END;
      County := ProjRec.County;
      "Post Code" := ProjRec."Post Code";
      "Phone No." := ProjRec."Phone No.";
      "Fax No." := ProjRec."Fax No.";
      "Territory Code" := ProjRec."Territory Code";
      Image := ProjRec.Image;
      "Starting Date" := ProjRec."Starting Date";
      "Ending Date" := ProjRec."Ending Date";
      FillCustomerPriceAndDiscGroupWithDefaultValue(ProjRec."Bill-to Customer No.");
    END;

    PROCEDURE TransferTryOutQuoteData@1100529016(TryoutQuote@1100529000 : Record 11012758);
    VAR
      Contacts@1100525000 : Record 5050;
    BEGIN
      IF Description <> '' THEN
        IF NOT CONFIRM(Text001, FALSE, TryoutQuote.TABLECAPTION) THEN
          EXIT;

      Description := TryoutQuote.Description;
      "Description 2" := TryoutQuote."Description 2";
      "Search Name" :=  Description;
      Address := TryoutQuote.Address;
      "Address 2" := TryoutQuote."Address 2";
      City := TryoutQuote.City;
      "Post Code" := TryoutQuote."Post Code";
      County := TryoutQuote.County;
      IF TryoutQuote."Contact No." <> '' THEN BEGIN
        IF "Company Name" <> '' THEN
          Contacts.CHANGECOMPANY("Company Name");
        IF Contacts.GET(TryoutQuote."Contact No.") THEN BEGIN
          Contact := COPYSTR(Contacts.Name, 1 , MAXSTRLEN(Contact));
          "Contact Phone No." := COPYSTR(Contacts."Phone No." + ' / ' + Contacts."Mobile Phone No.", 1, MAXSTRLEN("Contact Phone No."));
          "E-Mail" := Contacts."E-Mail";
        END;
      END;
      "Phone No." := TryoutQuote."Phone No.";
      "Territory Code" := TryoutQuote."Territory Code";
      "Starting Date" := TryoutQuote."Expected Starting Date";
      "Ending Date" := TryoutQuote."Expected End Date";
      FillCustomerPriceAndDiscGroupWithDefaultValue(TryoutQuote."Bill-to Customer No.");
    END;

    PROCEDURE TransferServOrderData@1100525004();
    VAR
      Employee@1100529400 : Record 5200;
      SalespersonPurchaser@1100525000 : Record 13;
    BEGIN
      IF Description <> '' THEN
        IF NOT CONFIRM(Text001, FALSE, ServOrderRec.TABLECAPTION) THEN
          EXIT;

      Description := ServOrderRec.Description;
      "Search Name" := Description;
      Address := ServOrderRec.Address;
      "Address 2" := ServOrderRec."Address 2";
      City := ServOrderRec.City;
      "Post Code" := ServOrderRec."Post Code";
      County := ServOrderRec.County;
      "Country/Region Code" := ServOrderRec."Country/Region Code";
      Contact := ServOrderRec."Contact Name";
      "Phone No." := ServOrderRec."Phone No.";
      "Fax No." := ServOrderRec."Fax No.";
      IF ServOrderRec."Assigned to" <> '' THEN
        IF Employee.GET(ServOrderRec."Assigned to") THEN
          "E-Mail" := Employee."Company E-Mail";
      "Territory Code" := ServOrderRec."Territory Code";
      "Starting Date" := ServOrderRec."Starting Date";
      "Ending Date" := ServOrderRec."Ending Date";
      IF (ServOrderRec."Order Manager" <> '') AND (Contact = '') THEN
        IF SalespersonPurchaser.GET(ServOrderRec."Order Manager") THEN BEGIN
          "Contact Phone No." := SalespersonPurchaser."Phone No.";
          "E-Mail" := SalespersonPurchaser."E-Mail";
          Contact := SalespersonPurchaser.Name;
        END;
      FillCustomerPriceAndDiscGroupWithDefaultValue(ServOrderRec."Bill-to Customer No.");
    END;

    PROCEDURE CheckPlantPresent@8();
    BEGIN
    END;

    PROCEDURE CheckBlockFromOtherCompany@1100525002(IDocType@1100525002 : Option;IShipment@1100525001 : Boolean;ITransaction@1100525000 : Boolean;IPlantCompany@1100525003 : Text[30]);
    BEGIN
      gPlantCompany := IPlantCompany;
      CheckBlock(IDocType, IShipment, ITransaction);
    END;

    PROCEDURE CheckBlock@3(DocType@1210190002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';Shipment@1210190001 : Boolean;Transaction@1210190000 : Boolean);
    VAR
      lvProjRec@1100525002 : Record 11072003;
      lvProjElemRec@1100485000 : Record 11012010;
      lvServOrderRec@1100525003 : Record 11012823;
      lvCustRec@1100525000 : Record 18;
      ProjectSetup@1100529000 : Record 315;
      ExtraStepsLimitation@1100529001 : Integer;
      SaveDocType@1100529002 : Option;
      lvPlantCompany@1100525001 : Text[30];
    BEGIN
      IF gPlantCompany <> '' THEN BEGIN
        IF gPlantCompany <> COMPANYNAME THEN
          lvPlantCompany := gPlantCompany;
        gPlantCompany := '';
      END;

      TESTFIELD(Blocked,FALSE);

      SaveDocType := DocType;
      IF DocType = 101 THEN BEGIN  // 101 = Exit Order   //C029731
        DocType := DocType::Order;
        IF Status >= Status::"Administrative Finished" THEN
          ERROR(Text015,TABLECAPTION, Code, FIELDCAPTION(Status), Status);
      END ELSE BEGIN
        IF ((DocType <= DocType::Order) AND (Status >= Status::"Technical Finished")) OR
           ((DocType > DocType::Order) AND (Status >= Status::Finished)) THEN
          ERROR(Text015,TABLECAPTION, Code, FIELDCAPTION(Status), Status);
      END;

      IF "Project No." <> '' THEN BEGIN
        IF "Company Name" = '' THEN BEGIN
          IF lvPlantCompany <> '' THEN BEGIN
            lvProjRec.CHANGECOMPANY(lvPlantCompany);
            lvProjElemRec.CHANGECOMPANY(lvPlantCompany);
            ProjectSetup.CHANGECOMPANY(lvPlantCompany);
          END;
        END ELSE BEGIN
          lvProjRec.CHANGECOMPANY("Company Name");
          lvProjElemRec.CHANGECOMPANY("Company Name");
          ProjectSetup.CHANGECOMPANY("Company Name");
        END;
        ExtraStepsLimitation := 1;
        IF (DocType = DocType::Invoice) OR (SaveDocType = 101) THEN BEGIN  // 101 = Exit Order
          ProjectSetup.GET;
          IF ProjectSetup."Provisions at Closure" THEN
            ExtraStepsLimitation := -1;
        END;
        lvProjRec.GET("Project No.");
        lvProjRec.CheckProjectStatus(ExtraStepsLimitation);
        IF Element <> '' THEN BEGIN // Call 6564
          lvProjElemRec.GET("Project No.",Element);
          lvProjElemRec.CheckProjectElementBlocked;
        END;
      END;

      IF "Service Order No." <> '' THEN BEGIN
        IF "Company Name" = '' THEN BEGIN
          IF lvPlantCompany <> '' THEN
            lvServOrderRec.CHANGECOMPANY(lvPlantCompany);
        END ELSE BEGIN
          lvServOrderRec.CHANGECOMPANY("Company Name");
        END;
        lvServOrderRec.GET("Service Order No.");
        lvServOrderRec.CheckStatus(1);
      END;

      IF "Customer No." <> '' THEN BEGIN
        IF lvPlantCompany <> '' THEN
          lvCustRec.CHANGECOMPANY(lvPlantCompany);
        lvCustRec.GET("Customer No.");
        lvCustRec.CheckBlockedCustOnDocs(lvCustRec,DocType,Shipment,Transaction);
      END;
    END;

    PROCEDURE CheckFinished@4(Company@11012000 : Text[30];LogErrors@1100485002 : Boolean;VAR TmpErrorRec@1100485001 : TEMPORARY Record 11012051) ErrorTxt : Text[250];
    VAR
      lvPlantSetupRec@1100485003 : Record 11012550;
      lPlantOrderRec@11012001 : Record 11012556;
      lExitOrderRec@11012002 : Record 11012559;
      ReturnLossOrderRec@1100525000 : Record 11012655;
      lPlantRentalCorrRec@11012003 : Record 11012565;
      lInventRec@11012004 : Record 11012555;
      lvHoursRevLineRec@1210190000 : Record 11012574;
      lvTransOrderRec@1100485005 : Record 11020505;
      lvPostedTransOrderRec@1100485006 : Record 11020507;
      lvPostedTransCostLineRec@1100485007 : Record 11020508;
      RentalAgreement@1100529001 : Record 11229935;
      RentalAgrInvPeriod@1100529000 : Record 11229937;
      ExternalPlantRentInvoice@1100529004 : Record 11126149;
      ExtPlantRentInvoiceLine@1100529003 : Record 11126150;
      lvFound@1100485004 : Boolean;
      lvCheckInvoiced@1100485008 : Boolean;
      RentalAgreementErrorFound@1100529002 : Boolean;
      lvArgIdentification@1210190001 : Text[100];
      lvText000@1100485000 : TextConst 'ENU=" - Cost";NOR=" - Kostnad";SVE=" Kostnader"';
      MessTxt@1100525001 : Text[250];
    BEGIN
      IF Company = '' THEN
        Company := COMPANYNAME;

      lvPlantSetupRec.CHANGECOMPANY(Company);
      lvPlantSetupRec.GET;

      IF Depot OR ("Employee No." <> '') THEN
        lvCheckInvoiced := FALSE
      ELSE
        lvCheckInvoiced := TRUE;

      lInventRec.CHANGECOMPANY(Company);

      lInventRec.RESET;
      lInventRec.SETCURRENTKEY(Removed,Location);
      lInventRec.SETRANGE(Removed,FALSE);
      lInventRec.SETRANGE(Location,Code);
      lInventRec.SETRANGE(Sold,FALSE);
      lInventRec.SETFILTER(Quantity, '>%1', 0.000005);  //DP00241.c (16035)
      IF lInventRec.FINDFIRST THEN BEGIN
        ErrorTxt := STRSUBSTNO(Text002,TABLECAPTION,Code);
        IF LogErrors THEN
          AddError(ErrorTxt, TmpErrorRec)
        ELSE
          EXIT(ErrorTxt);
      END;
      //DP00241.sn (16035)
      lInventRec.SETFILTER(Quantity, '<%1', -0.000005);
      IF lInventRec.FINDFIRST THEN BEGIN
        IF NOT lvPlantSetupRec."Ignore Neg. Stock on Close Loc" THEN BEGIN  //C021870
          ErrorTxt := STRSUBSTNO(Text002b,TABLECAPTION,Code);
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END ELSE BEGIN  //C021870
          MessTxt := Text002d + ' ' + STRSUBSTNO(Text002b,TABLECAPTION,Code) + ' ' + Text002e;  // Only warning, do not use ErrorTxt
          IF LogErrors THEN
            AddError(MessTxt, TmpErrorRec)
        END;
      END;
      //DP00241.en
      //C004819.sn
      lInventRec.SETRANGE(Sold,TRUE);
      lInventRec.SETFILTER(Quantity, '<%1', -0.000005);
      IF lInventRec.FINDFIRST THEN BEGIN
        MessTxt := Text002d + ' ' + STRSUBSTNO(Text002c,TABLECAPTION,Code);  // Only warning, do not use ErrorTxt
        IF LogErrors THEN
          AddError(MessTxt, TmpErrorRec)
      END;
      //C004819.en

      IF lvCheckInvoiced THEN BEGIN
        lInventRec.RESET;
        lInventRec.SETCURRENTKEY("Completely Invoiced",Location);
        lInventRec.SETRANGE("Completely Invoiced",FALSE);
        lInventRec.SETRANGE(Location,Code);
        lInventRec.SETFILTER(Quantity,'>0');
        lInventRec.SETRANGE(Sold,FALSE);
        IF lInventRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text003,TABLECAPTION,Code);
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;
        lInventRec.SETRANGE("Completely Invoiced",TRUE);
        lInventRec.SETFILTER("Invoice Status",'%1|%2',lInventRec."Invoice Status"::Proposal,lInventRec."Invoice Status"::"Temporary");
        IF lInventRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text003,TABLECAPTION,Code);
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;
      END;

      lPlantOrderRec.CHANGECOMPANY(Company);

      //* Plant Order 'From Location' (Sales / BUY BACK)
      lPlantOrderRec.RESET;
      lPlantOrderRec.SETCURRENTKEY(Posted,"From Location Invoiced","From Location");
      lPlantOrderRec.SETRANGE(Posted,FALSE);
      lPlantOrderRec.SETRANGE("From Location",Code);
      IF lPlantOrderRec.FINDFIRST THEN BEGIN
        ErrorTxt := STRSUBSTNO(Text004,lPlantOrderRec.TABLECAPTION,lPlantOrderRec."No.");
        IF LogErrors THEN
          AddError(ErrorTxt, TmpErrorRec)
        ELSE
          EXIT(ErrorTxt);
      END;

      IF lvCheckInvoiced THEN BEGIN
        lPlantOrderRec.SETRANGE(Posted,TRUE);
        lPlantOrderRec.SETRANGE("From Location Invoiced",FALSE);
        lPlantOrderRec.SETFILTER(Type, '<>%1', lPlantOrderRec.Type::"Negative Inventory Correction");
        IF lPlantOrderRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text005,lPlantOrderRec.TABLECAPTION,lPlantOrderRec."No.");
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;

        lPlantOrderRec.SETRANGE("From Location Invoiced",TRUE);
        lPlantOrderRec.SETFILTER(
          "From Location Invoice Status",'%1|%2',
          lPlantOrderRec."From Location Invoice Status"::Proposal,
          lPlantOrderRec."From Location Invoice Status"::"Temporary");
        IF lPlantOrderRec.FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF OrderSalesBuyBackLinesPresent(lPlantOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text006,lPlantOrderRec.TABLECAPTION,lPlantOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
          UNTIL lPlantOrderRec.NEXT = 0;
      END;

      //* Plant Order 'To Location' (SALES / Buy Back)
      lPlantOrderRec.RESET;
      lPlantOrderRec.SETCURRENTKEY(Posted,"To Location Invoiced","To Location");
      lPlantOrderRec.SETRANGE(Posted,FALSE);
      lPlantOrderRec.SETRANGE("To Location",Code);
      IF lPlantOrderRec.FINDFIRST THEN BEGIN
        ErrorTxt := STRSUBSTNO(Text004,lPlantOrderRec.TABLECAPTION,lPlantOrderRec."No.");
        IF LogErrors THEN
          AddError(ErrorTxt, TmpErrorRec)
        ELSE
          EXIT(ErrorTxt);
      END;

      IF lvCheckInvoiced THEN BEGIN
        lPlantOrderRec.SETRANGE(Posted,TRUE);
        lPlantOrderRec.SETRANGE("To Location Invoiced",FALSE);
        lPlantOrderRec.SETFILTER(Type, '<>%1', lPlantOrderRec.Type::"Negative Inventory Correction");
        IF lPlantOrderRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text005,lPlantOrderRec.TABLECAPTION,lPlantOrderRec."No.");
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;

        lPlantOrderRec.SETRANGE("To Location Invoiced",TRUE);
        lPlantOrderRec.SETFILTER(
          "To Location Invoice Status",'%1|%2',
          lPlantOrderRec."To Location Invoice Status"::Proposal,
          lPlantOrderRec."To Location Invoice Status"::"Temporary");
        IF lPlantOrderRec.FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF OrderSalesBuyBackLinesPresent(lPlantOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text006,lPlantOrderRec.TABLECAPTION,lPlantOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
          UNTIL lPlantOrderRec.NEXT = 0;
      END;

      //* Plant Order 'From Location' (Cost)
      IF lvCheckInvoiced THEN BEGIN
        lPlantOrderRec.RESET;
        lPlantOrderRec.SETCURRENTKEY(Posted,"Order Cost Invoiced","From Location");
        lPlantOrderRec.SETRANGE(Posted,TRUE);
        lPlantOrderRec.SETRANGE("From Location",Code);
        lPlantOrderRec.SETRANGE(Type, lPlantOrderRec.Type::Removal);

        lPlantOrderRec.SETRANGE("Order Cost Invoiced",FALSE);
        IF lPlantOrderRec.FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF OrderCostLinesPresent(lPlantOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text005,lPlantOrderRec.TABLECAPTION+lvText000,lPlantOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
          UNTIL lPlantOrderRec.NEXT = 0;

        lPlantOrderRec.SETRANGE("Order Cost Invoiced",TRUE);
        lPlantOrderRec.SETFILTER("Order Cost Invoice Status",'%1|%2',
          lPlantOrderRec."Order Cost Invoice Status"::Proposal,lPlantOrderRec."Order Cost Invoice Status"::"Temporary");
        IF lPlantOrderRec.FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF OrderCostLinesPresent(lPlantOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text006,lPlantOrderRec.TABLECAPTION+lvText000,lPlantOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
          UNTIL lPlantOrderRec.NEXT = 0;
      END;

      //* Plant Order 'To Location' (Cost)
      IF lvCheckInvoiced THEN BEGIN
        lPlantOrderRec.RESET;
        lPlantOrderRec.SETRANGE(Posted,TRUE);
        lPlantOrderRec.SETCURRENTKEY(Posted,"Order Cost Invoiced","To Location");
        lPlantOrderRec.SETRANGE("To Location",Code);
        lPlantOrderRec.SETFILTER(Type, '%1|%2', lPlantOrderRec.Type::Arrival, lPlantOrderRec.Type::"Other Transfers");

        lPlantOrderRec.SETRANGE("Order Cost Invoiced",FALSE);
        IF lPlantOrderRec.FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF OrderCostLinesPresent(lPlantOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text005,lPlantOrderRec.TABLECAPTION+lvText000,lPlantOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
          UNTIL lPlantOrderRec.NEXT = 0;

        lPlantOrderRec.SETRANGE("Order Cost Invoiced",TRUE);
        lPlantOrderRec.SETFILTER("Order Cost Invoice Status",'%1|%2',
          lPlantOrderRec."Order Cost Invoice Status"::Proposal, lPlantOrderRec."Order Cost Invoice Status"::"Temporary");
        IF lPlantOrderRec.FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF OrderCostLinesPresent(lPlantOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text006,lPlantOrderRec.TABLECAPTION+lvText000,lPlantOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
          UNTIL lPlantOrderRec.NEXT = 0;
      END;

      lExitOrderRec.CHANGECOMPANY(Company);

      lExitOrderRec.RESET;
      lExitOrderRec.SETCURRENTKEY(Posted,Location,Invoiced);
      lExitOrderRec.SETRANGE(Posted,FALSE);
      lExitOrderRec.SETRANGE(Location,Code);
      IF lExitOrderRec.FINDFIRST THEN BEGIN
        ErrorTxt := STRSUBSTNO(Text004,lExitOrderRec.TABLECAPTION,lExitOrderRec."No.");
        IF LogErrors THEN
          AddError(ErrorTxt, TmpErrorRec)
        ELSE
          EXIT(ErrorTxt);
      END;

      IF lvCheckInvoiced THEN BEGIN
        lExitOrderRec.SETRANGE(Posted,TRUE);
        lExitOrderRec.SETRANGE(Invoiced,TRUE);
        lExitOrderRec.SETFILTER(
          "Invoice Status",'%1|%2',
          lExitOrderRec."Invoice Status"::Proposal,
          lExitOrderRec."Invoice Status"::"Temporary");
        IF lExitOrderRec.FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF ExitOrderLinesPresent(lExitOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text006,lExitOrderRec.TABLECAPTION,lExitOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
            IF ExitOrderCostLinesPresent(lExitOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text006,lExitOrderRec.TABLECAPTION,lExitOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
          UNTIL lExitOrderRec.NEXT = 0;
      END;

      ReturnLossOrderRec.CHANGECOMPANY(Company);

      ReturnLossOrderRec.RESET;
      ReturnLossOrderRec.SETCURRENTKEY(Posted,Location,Invoiced);
      ReturnLossOrderRec.SETRANGE(Posted,FALSE);
      ReturnLossOrderRec.SETRANGE(Location,Code);
      IF ReturnLossOrderRec.FINDFIRST THEN BEGIN
        ErrorTxt := STRSUBSTNO(Text004,ReturnLossOrderRec.TABLECAPTION,ReturnLossOrderRec."No.");
        IF LogErrors THEN
          AddError(ErrorTxt, TmpErrorRec)
        ELSE
          EXIT(ErrorTxt);
      END;

      IF lvCheckInvoiced THEN BEGIN
        ReturnLossOrderRec.SETRANGE(Posted,TRUE);
        ReturnLossOrderRec.SETRANGE(Invoiced,TRUE);
        ReturnLossOrderRec.SETFILTER(
          "Invoice Status",'%1|%2',
          ReturnLossOrderRec."Invoice Status"::Proposal,
          ReturnLossOrderRec."Invoice Status"::"Temporary");
        IF ReturnLossOrderRec.FINDSET(FALSE, FALSE) THEN
          REPEAT
            IF ReturnedLossOrderLinesPresent(ReturnLossOrderRec, Company) THEN BEGIN
              ErrorTxt := STRSUBSTNO(Text006,ReturnLossOrderRec.TABLECAPTION,ReturnLossOrderRec."No.");
              IF LogErrors THEN
                AddError(ErrorTxt, TmpErrorRec)
              ELSE
                EXIT(ErrorTxt);
            END;
          UNTIL ReturnLossOrderRec.NEXT = 0;
      END;

      lPlantRentalCorrRec.CHANGECOMPANY(Company);

      lPlantRentalCorrRec.RESET;
      lPlantRentalCorrRec.SETCURRENTKEY(Posted,"Debet Location Invoiced","Debit Location");
      lPlantRentalCorrRec.SETRANGE(Posted,FALSE);
      lPlantRentalCorrRec.SETRANGE("Debit Location",Code);
      IF lPlantRentalCorrRec.FINDFIRST THEN BEGIN
        ErrorTxt := STRSUBSTNO(Text004,lPlantRentalCorrRec.TABLECAPTION,lPlantRentalCorrRec."No.");
        IF LogErrors THEN
          AddError(ErrorTxt, TmpErrorRec)
        ELSE
          EXIT(ErrorTxt);
      END;

      IF lvCheckInvoiced THEN BEGIN
        lPlantRentalCorrRec.SETRANGE(Posted,TRUE);
        lPlantRentalCorrRec.SETRANGE("Debet Location Invoiced",FALSE);
        IF lPlantRentalCorrRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text005,lPlantRentalCorrRec.TABLECAPTION,lPlantRentalCorrRec."No.");
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;

        lPlantRentalCorrRec.SETRANGE("Debet Location Invoiced",TRUE);
        lPlantRentalCorrRec.SETFILTER(
          "Invoice Status Debit Location",'%1|%2',
          lPlantRentalCorrRec."Invoice Status Debit Location"::Proposal,
          lPlantRentalCorrRec."Invoice Status Debit Location"::"Temporary");
        IF lPlantRentalCorrRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text006,lPlantRentalCorrRec.TABLECAPTION,lPlantRentalCorrRec."No.");
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;
      END;

      lPlantRentalCorrRec.RESET;
      lPlantRentalCorrRec.SETCURRENTKEY(Posted,"Credit Location Invoiced","Credit Location");
      lPlantRentalCorrRec.SETRANGE(Posted,FALSE);
      lPlantRentalCorrRec.SETRANGE("Credit Location",Code);
      IF lPlantRentalCorrRec.FINDFIRST THEN BEGIN
        ErrorTxt := STRSUBSTNO(Text004,lPlantRentalCorrRec.TABLECAPTION,lPlantRentalCorrRec."No.");
        IF LogErrors THEN
          AddError(ErrorTxt, TmpErrorRec)
        ELSE
          EXIT(ErrorTxt);
      END;

      IF lvCheckInvoiced THEN BEGIN
        lPlantRentalCorrRec.SETRANGE(Posted,TRUE);
        lPlantRentalCorrRec.SETRANGE("Credit Location Invoiced",FALSE);
        IF lPlantRentalCorrRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text005,lPlantRentalCorrRec.TABLECAPTION,lPlantRentalCorrRec."No.");
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;

        lPlantRentalCorrRec.SETRANGE("Credit Location Invoiced",TRUE);
        lPlantRentalCorrRec.SETFILTER(
          "Invoice Status Credit Location",'%1|%2',
          lPlantRentalCorrRec."Invoice Status Credit Location"::Proposal,
          lPlantRentalCorrRec."Invoice Status Credit Location"::"Temporary");
        IF lPlantRentalCorrRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text006,lPlantRentalCorrRec.TABLECAPTION,lPlantRentalCorrRec."No.");
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;
      END;

      //Hours Revenues
      lvHoursRevLineRec.CHANGECOMPANY(Company);

      lvHoursRevLineRec.RESET;
      lvHoursRevLineRec.SETCURRENTKEY(Invoiced, Status, "Plant Location", Year, Week, "Plant Type", "Plant No.");
      lvHoursRevLineRec.SETRANGE(Status, lvHoursRevLineRec.Status::Open);
      lvHoursRevLineRec.SETRANGE("Plant Location", Code);
      IF lvHoursRevLineRec.FINDFIRST THEN BEGIN
        lvArgIdentification := STRSUBSTNO('%1', lvHoursRevLineRec.Year) + '-' + STRSUBSTNO('%1', lvHoursRevLineRec.Week) + ', ' +
                               lvHoursRevLineRec."Plant Type" + '-' + lvHoursRevLineRec."Plant No." + ', ' +
                               STRSUBSTNO('%1', lvHoursRevLineRec."Line No.");
        ErrorTxt := STRSUBSTNO(Text004, lvHoursRevLineRec.TABLECAPTION, lvArgIdentification);
        IF LogErrors THEN
          AddError(ErrorTxt, TmpErrorRec)
        ELSE
          EXIT(ErrorTxt);
      END;

      IF lvCheckInvoiced THEN BEGIN
        lvHoursRevLineRec.SETRANGE(Invoiced, FALSE);
        lvHoursRevLineRec.SETRANGE(Status, lvHoursRevLineRec.Status::Posted);
        //lvHoursRevLineRec.SETRANGE(Type, lvHoursRevLineRec.Type::Hours); //*C-019470.o
        lvHoursRevLineRec.SETFILTER(Type, '%1|%2',lvHoursRevLineRec.Type::Hours,lvHoursRevLineRec.Type::"Unmanned Hours"); //C-019470
        lvHoursRevLineRec.SETFILTER("Total Line", '<>%1', 0);
        lvHoursRevLineRec.SETRANGE(Amount);
        lvFound := lvHoursRevLineRec.FINDFIRST;
        IF NOT lvFound THEN BEGIN
          lvHoursRevLineRec.SETFILTER(Type, '%1|%2',lvHoursRevLineRec.Type::Expenses, lvHoursRevLineRec.Type::Cost);
          lvHoursRevLineRec.SETRANGE("Total Line");
          lvHoursRevLineRec.SETFILTER(Amount, '<>%1', 0);
          lvFound := lvHoursRevLineRec.FINDFIRST;
        END;
        IF lvFound THEN BEGIN
          lvArgIdentification := STRSUBSTNO('%1', lvHoursRevLineRec.Year) + '-' + STRSUBSTNO('%1', lvHoursRevLineRec.Week) + ', ' +
                                 lvHoursRevLineRec."Plant Type" + '-' + lvHoursRevLineRec."Plant No." + ', ' +
                                 STRSUBSTNO('%1', lvHoursRevLineRec."Line No.");
          ErrorTxt := STRSUBSTNO(Text005, lvHoursRevLineRec.TABLECAPTION, lvArgIdentification);
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;

        lvHoursRevLineRec.SETRANGE(Invoiced,TRUE);
        lvHoursRevLineRec.SETFILTER("Invoice Status",'%1|%2',
                                    lvHoursRevLineRec."Invoice Status"::Proposal,
                                    lvHoursRevLineRec."Invoice Status"::"Temporary");
        lvHoursRevLineRec.SETRANGE(Type);
        lvHoursRevLineRec.SETRANGE("Total Line");
        lvHoursRevLineRec.SETRANGE(Amount);
        IF lvHoursRevLineRec.FINDFIRST THEN BEGIN
          lvArgIdentification := STRSUBSTNO('%1', lvHoursRevLineRec.Year) + '-' + STRSUBSTNO('%1', lvHoursRevLineRec.Week) + ', ' +
                                 lvHoursRevLineRec."Plant Type" + '-' + lvHoursRevLineRec."Plant No." + ', ' +
                                 STRSUBSTNO('%1', lvHoursRevLineRec."Line No.");
          ErrorTxt := STRSUBSTNO(Text006, lvHoursRevLineRec.TABLECAPTION, lvArgIdentification);
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;
      END;

      IF lvPlantSetupRec."Transport Orders" THEN BEGIN
        lvTransOrderRec.CHANGECOMPANY(Company);
        lvPostedTransOrderRec.CHANGECOMPANY(Company);
        lvPostedTransCostLineRec.CHANGECOMPANY(Company);

        //* Transport Order 'From Location'
        lvTransOrderRec.RESET;
        lvTransOrderRec.SETCURRENTKEY("From Location");
        lvTransOrderRec.SETRANGE("From Location",Code);
        IF lvTransOrderRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text004,lvTransOrderRec.TABLECAPTION,lvTransOrderRec."No.");
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;

        //* Transport Order 'To Location'
        lvTransOrderRec.RESET;
        lvTransOrderRec.SETCURRENTKEY("To Location");
        lvTransOrderRec.SETRANGE("To Location",Code);
        IF lvTransOrderRec.FINDFIRST THEN BEGIN
          ErrorTxt := STRSUBSTNO(Text004,lvTransOrderRec.TABLECAPTION,lvTransOrderRec."No.");
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;

        IF lvCheckInvoiced THEN BEGIN
          //* Posted Transport Order 'From Location'
          lvPostedTransOrderRec.RESET;
          lvPostedTransOrderRec.SETCURRENTKEY("From Location Invoiced","From Location");
          lvPostedTransOrderRec.SETRANGE("From Location Invoiced",FALSE);
          lvPostedTransOrderRec.SETRANGE("From Location",Code);
          IF lvPostedTransOrderRec.FINDFIRST THEN BEGIN
            REPEAT
              lvPostedTransCostLineRec.RESET;
              lvPostedTransCostLineRec.SETRANGE("Transport Order No.", lvPostedTransOrderRec."No.");
              lvPostedTransCostLineRec.SETFILTER(Type, '<>%1', lvPostedTransCostLineRec.Type::Text);
              IF (lvPostedTransOrderRec."Perc. From Location" <> 0) THEN BEGIN
                lvPostedTransCostLineRec.SETRANGE("Invoice-to", lvPostedTransCostLineRec."Invoice-to"::" ");
                IF lvPostedTransCostLineRec.FINDFIRST THEN BEGIN
                  ErrorTxt := STRSUBSTNO(Text005,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No.");
                  IF LogErrors THEN
                    AddError(ErrorTxt, TmpErrorRec)
                  ELSE
                    EXIT(ErrorTxt);
                END;
              END;
              lvPostedTransCostLineRec.SETFILTER("Invoice-to", '%1|%2',
                lvPostedTransCostLineRec."Invoice-to"::Location, lvPostedTransCostLineRec."Invoice-to"::"From Location");
              IF lvPostedTransCostLineRec.FINDFIRST THEN BEGIN
                ErrorTxt := STRSUBSTNO(Text005,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No.");
                IF LogErrors THEN
                  AddError(ErrorTxt, TmpErrorRec)
                ELSE
                  EXIT(ErrorTxt);
              END;
            UNTIL lvPostedTransOrderRec.NEXT = 0;
          END;

          lvPostedTransOrderRec.SETRANGE("From Location Invoiced",TRUE);
          lvPostedTransOrderRec.SETFILTER("From Location Invoice No.", '<>%1', '');
          lvPostedTransOrderRec.SETFILTER(
            "From Location Invoice Status",'%1|%2',
            lvPostedTransOrderRec."From Location Invoice Status"::Proposal,
            lvPostedTransOrderRec."From Location Invoice Status"::"Temporary");
          IF lvPostedTransOrderRec.FINDFIRST THEN BEGIN
            ErrorTxt := STRSUBSTNO(Text006,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No.");
            IF LogErrors THEN
              AddError(ErrorTxt, TmpErrorRec)
            ELSE
              EXIT(ErrorTxt);
          END;

          //* Posted Transport Order 'To Location'
          lvPostedTransOrderRec.RESET;
          lvPostedTransOrderRec.SETCURRENTKEY("To Location Invoiced","To Location");
          lvPostedTransOrderRec.SETRANGE("To Location Invoiced",FALSE);
          lvPostedTransOrderRec.SETRANGE("To Location",Code);
          IF lvPostedTransOrderRec.FINDFIRST THEN BEGIN
            REPEAT
              lvPostedTransCostLineRec.RESET;
              lvPostedTransCostLineRec.SETRANGE("Transport Order No.", lvPostedTransOrderRec."No.");
              lvPostedTransCostLineRec.SETFILTER(Type, '<>%1', lvPostedTransCostLineRec.Type::Text);
              IF (lvPostedTransOrderRec."Perc. To Location" <> 0) THEN BEGIN
                lvPostedTransCostLineRec.SETRANGE("Invoice-to", lvPostedTransCostLineRec."Invoice-to"::" ");
                IF lvPostedTransCostLineRec.FINDFIRST THEN BEGIN
                  ErrorTxt := STRSUBSTNO(Text005,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No.");
                  IF LogErrors THEN
                    AddError(ErrorTxt, TmpErrorRec)
                  ELSE
                    EXIT(ErrorTxt);
                END;
              END;
              lvPostedTransCostLineRec.SETFILTER("Invoice-to", '%1|%2',
                lvPostedTransCostLineRec."Invoice-to"::Location, lvPostedTransCostLineRec."Invoice-to"::"To Location");
              IF lvPostedTransCostLineRec.FINDFIRST THEN BEGIN
                ErrorTxt := STRSUBSTNO(Text005,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No.");
                IF LogErrors THEN
                  AddError(ErrorTxt, TmpErrorRec)
                ELSE
                  EXIT(ErrorTxt);
              END;
            UNTIL lvPostedTransOrderRec.NEXT = 0;
          END;

          lvPostedTransOrderRec.SETRANGE("To Location Invoiced",TRUE);
          lvPostedTransOrderRec.SETFILTER("To Location Invoice No.", '<>%1', '');
          lvPostedTransOrderRec.SETFILTER(
            "To Location Invoice Status",'%1|%2',
            lvPostedTransOrderRec."To Location Invoice Status"::Proposal,
            lvPostedTransOrderRec."To Location Invoice Status"::"Temporary");
          IF lvPostedTransOrderRec.FINDFIRST THEN BEGIN
            ErrorTxt := STRSUBSTNO(Text006,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No.");
            IF LogErrors THEN
              AddError(ErrorTxt, TmpErrorRec)
            ELSE
              EXIT(ErrorTxt);
          END;
        END;
      END;

      IF lvCheckInvoiced THEN BEGIN
        RentalAgreementErrorFound := FALSE;
        RentalAgrInvPeriod.CHANGECOMPANY(Company);
        RentalAgrInvPeriod.RESET;
        RentalAgrInvPeriod.SETCURRENTKEY("Plant Location (Inv.)","Completely Invoiced");
        RentalAgrInvPeriod.SETRANGE("Plant Location (Inv.)",Code);
        RentalAgrInvPeriod.SETRANGE("Completely Invoiced",FALSE);
        IF RentalAgrInvPeriod.FINDFIRST THEN BEGIN
          RentalAgreementErrorFound := TRUE;
          ErrorTxt := STRSUBSTNO(Text006, RentalAgreement.TABLECAPTION,
            RentalAgrInvPeriod."Plant Type" +'-'+ RentalAgrInvPeriod."Plant No." +' '+ FORMAT(RentalAgrInvPeriod."Agreement No."));
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;
        RentalAgrInvPeriod.SETRANGE("Completely Invoiced",TRUE);
        RentalAgrInvPeriod.SETFILTER("Invoice Status",'%1|%2',
          RentalAgrInvPeriod."Invoice Status"::Proposal,RentalAgrInvPeriod."Invoice Status"::"Temporary");
        IF RentalAgrInvPeriod.FINDFIRST THEN BEGIN
          RentalAgreementErrorFound := TRUE;
          ErrorTxt := STRSUBSTNO(Text006, RentalAgreement.TABLECAPTION,
            RentalAgrInvPeriod."Plant Type" +'-'+ RentalAgrInvPeriod."Plant No." +' '+ FORMAT(RentalAgrInvPeriod."Agreement No."));
          IF LogErrors THEN
            AddError(ErrorTxt, TmpErrorRec)
          ELSE
            EXIT(ErrorTxt);
        END;
        IF NOT RentalAgreementErrorFound THEN BEGIN
          RentalAgreement.CHANGECOMPANY(Company);
          RentalAgreement.SETCURRENTKEY("Plant Location","Plant Type","Plant No.","Agreement No.");
          RentalAgreement.SETRANGE("Plant Location",Code);
          IF RentalAgreement.FINDSET THEN BEGIN
            REPEAT
              IF NOT RentalAgreement.RentalAgreementCompletelyInvoiced(Company) THEN BEGIN
                RentalAgreementErrorFound := TRUE;
                ErrorTxt := STRSUBSTNO(Text006, RentalAgreement.TABLECAPTION,
                  RentalAgreement."Plant Type" +'-'+ RentalAgreement."Plant No." +' '+ FORMAT(RentalAgreement."Agreement No."));
                IF LogErrors THEN
                  AddError(ErrorTxt, TmpErrorRec)
                ELSE
                  EXIT(ErrorTxt);
              END;
            UNTIL (RentalAgreement.NEXT = 0) OR RentalAgreementErrorFound;
          END;
        END;
      END;

      IF lvCheckInvoiced THEN BEGIN
        ExtPlantRentInvoiceLine.CHANGECOMPANY(Company);
        ExtPlantRentInvoiceLine.SETCURRENTKEY("Plant Location", "Invoiced (Sales)", "Vendor No.", "External Invoice No.", "Line No.");
        ExtPlantRentInvoiceLine.SETRANGE("Plant Location", Code);
        ExtPlantRentInvoiceLine.SETRANGE("Invoiced (Sales)", FALSE);
        IF ExtPlantRentInvoiceLine.FINDSET(FALSE, FALSE) THEN BEGIN
          REPEAT
            ErrorTxt := STRSUBSTNO(Text006, ExternalPlantRentInvoice.TABLECAPTION,
              ExtPlantRentInvoiceLine."Vendor No." +' '+ FORMAT(ExtPlantRentInvoiceLine."External Invoice No."));
            IF LogErrors THEN
              AddError(ErrorTxt, TmpErrorRec)
            ELSE
              EXIT(ErrorTxt);
            ExtPlantRentInvoiceLine.SETRANGE("Vendor No.", ExtPlantRentInvoiceLine."Vendor No.");
            ExtPlantRentInvoiceLine.SETRANGE("External Invoice No.", ExtPlantRentInvoiceLine."External Invoice No.");
            ExtPlantRentInvoiceLine.FINDLAST;  //Go to last line of the invoice, only one error per invoice
            ExtPlantRentInvoiceLine.SETRANGE("Vendor No.");
            ExtPlantRentInvoiceLine.SETRANGE("External Invoice No.");
          UNTIL ExtPlantRentInvoiceLine.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE CheckFinishedTransProjLevel@1100485005(IProjNo@1100485004 : Code[20]) : Text[250];
    VAR
      lvPlantSetupRec@1100485003 : Record 11012550;
      lvTransOrderRec@1100485000 : Record 11020505;
      lvPostedTransOrderRec@1100485002 : Record 11020507;
      lvPostedTransCostLineRec@1100485001 : Record 11020508;
    BEGIN
      //* Transportkosten kunnen ook direct voor een project zijn. Bij het afsluiten van een project (CU 11012046) moet getest
      //* worden of deze kosten al gefactureerd zijn.
      //* NB: Op dit moment kan op de transportorder geen bedrijf voor het project ingegeven worden, dus project en transportorder
      //* zitten in hetzelfde bedrijf. Daarom zit in deze functie geen 'CHANGECOMPANY'.

      lvPlantSetupRec.GET;

      IF lvPlantSetupRec."Transport Orders" THEN BEGIN

        //* Transport Order 'Project'
        lvTransOrderRec.RESET;
        lvTransOrderRec.SETCURRENTKEY("Project No.");
        lvTransOrderRec.SETRANGE("Project No.",IProjNo);
        IF lvTransOrderRec.FINDFIRST THEN
          EXIT(STRSUBSTNO(Text004,lvTransOrderRec.TABLECAPTION,lvTransOrderRec."No."));

        //* Posted Transport Order 'Project'
        lvPostedTransOrderRec.RESET;
        lvPostedTransOrderRec.SETCURRENTKEY("Project Invoiced","Project No.");
        lvPostedTransOrderRec.SETRANGE("Project Invoiced",FALSE);
        lvPostedTransOrderRec.SETRANGE("Project No.",IProjNo);
        IF lvPostedTransOrderRec.FINDFIRST THEN BEGIN
          REPEAT
            lvPostedTransCostLineRec.RESET;
            lvPostedTransCostLineRec.SETRANGE("Transport Order No.", lvPostedTransOrderRec."No.");
            lvPostedTransCostLineRec.SETFILTER(Type, '<>%1', lvPostedTransCostLineRec.Type::Text);
            IF (lvPostedTransOrderRec."Perc. Project" <> 0) THEN BEGIN
              lvPostedTransCostLineRec.SETRANGE("Invoice-to", lvPostedTransCostLineRec."Invoice-to"::" ");
              IF lvPostedTransCostLineRec.FINDFIRST THEN
                EXIT(STRSUBSTNO(Text005,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No."));
            END;
            lvPostedTransCostLineRec.SETRANGE("Invoice-to", lvPostedTransCostLineRec."Invoice-to"::Project);
            IF lvPostedTransCostLineRec.FINDFIRST THEN
              EXIT(STRSUBSTNO(Text005,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No."));
          UNTIL lvPostedTransOrderRec.NEXT = 0;
        END;

        lvPostedTransOrderRec.SETRANGE("Project Invoiced",TRUE);
        lvPostedTransOrderRec.SETFILTER("Project Invoice No.", '<>%1', '');
        lvPostedTransOrderRec.SETFILTER(
          "Project Invoice Status",'%1|%2',
          lvPostedTransOrderRec."Project Invoice Status"::Proposal,
          lvPostedTransOrderRec."Project Invoice Status"::"Temporary");
        IF lvPostedTransOrderRec.FINDFIRST THEN
          EXIT(STRSUBSTNO(Text006,lvPostedTransOrderRec.TABLECAPTION,lvPostedTransOrderRec."No."));
      END;
    END;

    PROCEDURE OrderSalesBuyBackLinesPresent@1100485009(lPlantOrderRec@1100485000 : Record 11012556;lCompany@1100525000 : Text[30]) : Boolean;
    VAR
      lPlantOrderLine@1100485001 : Record 11012557;
    BEGIN
      IF lCompany <> '' THEN
        lPlantOrderLine.CHANGECOMPANY(lCompany);

      lPlantOrderLine.SETRANGE("Plant Order No.", lPlantOrderRec."No.");
      lPlantOrderLine.SETFILTER(Type, '<>%1', lPlantOrderLine.Type::Text);
      lPlantOrderLine.SETFILTER(
        "Rental Type", '%1..%2', lPlantOrderLine."Rental Type"::Sales, lPlantOrderLine."Rental Type"::"Buy Back and Sales");
      EXIT(lPlantOrderLine.FINDFIRST);
    END;

    PROCEDURE OrderCostLinesPresent@1100485000(lPlantOrderRec@1100485000 : Record 11012556;lCompany@1100525000 : Text[30]) : Boolean;
    VAR
      lPlantOrderCostLine@1100485001 : Record 11012558;
    BEGIN
      IF lCompany <> '' THEN
        lPlantOrderCostLine.CHANGECOMPANY(lCompany);

      lPlantOrderCostLine.SETRANGE("Plant Order No.", lPlantOrderRec."No.");
      lPlantOrderCostLine.SETFILTER(Type, '<>%1', lPlantOrderCostLine.Type::Text);
      EXIT(lPlantOrderCostLine.FINDFIRST);
    END;

    PROCEDURE ExitOrderLinesPresent@1100485010(lExitOrderRec@1100485000 : Record 11012559;lCompany@1100525000 : Text[30]) : Boolean;
    VAR
      lExitOrderLine@1100485001 : Record 11012560;
    BEGIN
      IF lCompany <> '' THEN
        lExitOrderLine.CHANGECOMPANY(lCompany);

      lExitOrderLine.SETRANGE("Exit-order No.", lExitOrderRec."No.");
      lExitOrderLine.SETFILTER(Type, '<>%1', lExitOrderLine.Type::Text);
      EXIT(lExitOrderLine.FINDFIRST);
    END;

    PROCEDURE ExitOrderCostLinesPresent@1100485008(lExitOrderRec@1100485000 : Record 11012559;lCompany@1100525000 : Text[30]) : Boolean;
    VAR
      lExitOrderCostLine@1100485001 : Record 11012561;
    BEGIN
      IF lCompany <> '' THEN
        lExitOrderCostLine.CHANGECOMPANY(lCompany);

      lExitOrderCostLine.SETRANGE("Exit-order No.", lExitOrderRec."No.");
      lExitOrderCostLine.SETFILTER(Type, '<>%1', lExitOrderCostLine.Type::Text);
      EXIT(lExitOrderCostLine.FINDFIRST);
    END;

    PROCEDURE ReturnedLossOrderLinesPresent@1100525005(ReturnLossOrder@1100485000 : Record 11012655;Company@1100525000 : Text[30]) : Boolean;
    VAR
      ReturnLossOrderLine@1100485001 : Record 11012656;
    BEGIN
      IF Company <> '' THEN
        ReturnLossOrderLine.CHANGECOMPANY(Company);

      ReturnLossOrderLine.SETRANGE("Returned Loss Order No.", ReturnLossOrder."No.");
      ReturnLossOrderLine.SETFILTER(Type, '<>%1', ReturnLossOrderLine.Type::Text);
      EXIT(ReturnLossOrderLine.FINDFIRST);
    END;

    PROCEDURE AddError@7(lvMess@11012000 : Text[250];VAR TmpErrorRec@11012001 : TEMPORARY Record 11012051);
    BEGIN
      IF (TmpErrorRec."Plant Location Code" = Code) AND (TmpErrorRec."Error message" = lvMess) THEN
        EXIT;

      TmpErrorRec.INIT;
      TmpErrorRec."Line No." := TmpErrorRec."Line No." + 1;
      TmpErrorRec."Error message" := lvMess;
      TmpErrorRec."Plant Location Code" := Code;
      TmpErrorRec.INSERT;
    END;

    PROCEDURE CopyProjLocsToPlantLocAddress@1100485002(IPlantCompany@1100485001 : Text[50]) : Integer;
    VAR
      lvProjLocAddressRec@1100485000 : Record 11012011;
      lvPlantLocAddrRec@1100485002 : Record 11012590;
      lvIsPlantComp@1100485004 : Boolean;
      lvNew@1100485003 : Boolean;
      lvCounter@1100485005 : Integer;
    BEGIN
      IF "Project No." = '' THEN
        EXIT(0);

      IF (IPlantCompany <> '') AND (IPlantCompany <> COMPANYNAME) THEN
        lvPlantLocAddrRec.CHANGECOMPANY(IPlantCompany)
      ELSE
        lvIsPlantComp := TRUE;
      IF ("Company Name" <> '') AND ("Company Name" <> COMPANYNAME) THEN
        lvProjLocAddressRec.CHANGECOMPANY("Company Name");
      lvProjLocAddressRec.SETRANGE("Project No.", "Project No.");
      IF lvProjLocAddressRec.FINDSET(FALSE, FALSE) THEN BEGIN
        REPEAT
          IF NOT lvPlantLocAddrRec.GET(Code, lvProjLocAddressRec.Code) THEN BEGIN
            lvNew := TRUE;
            lvPlantLocAddrRec.INIT;
            lvPlantLocAddrRec.Location := Code;
            lvPlantLocAddrRec."Address Code" := lvProjLocAddressRec.Code;
          END;
          lvPlantLocAddrRec.Address := COPYSTR(lvProjLocAddressRec.Address, 1, MAXSTRLEN(lvPlantLocAddrRec.Address));
          lvPlantLocAddrRec."Address 2" := COPYSTR(lvProjLocAddressRec."Address 2", 1, MAXSTRLEN(lvPlantLocAddrRec."Address 2"));
          lvPlantLocAddrRec."Post Code" := COPYSTR(lvProjLocAddressRec."Post Code", 1, MAXSTRLEN(lvPlantLocAddrRec."Post Code"));
          lvPlantLocAddrRec.City := COPYSTR(lvProjLocAddressRec.City, 1, MAXSTRLEN(lvPlantLocAddrRec.City));
          lvPlantLocAddrRec.Contact := COPYSTR(lvProjLocAddressRec.Contact, 1, MAXSTRLEN(lvPlantLocAddrRec.Contact));
          lvPlantLocAddrRec."Phone No." := COPYSTR(lvProjLocAddressRec."Phone No.", 1, MAXSTRLEN(lvPlantLocAddrRec."Phone No."));
          IF lvNew THEN
            lvPlantLocAddrRec.INSERT(lvIsPlantComp)
          ELSE
            lvPlantLocAddrRec.MODIFY(lvIsPlantComp);
          lvCounter := lvCounter + 1;
        UNTIL lvProjLocAddressRec.NEXT = 0;
      END;

      EXIT(lvCounter);
    END;

    PROCEDURE GetNoOfCustJobAddressesTxt@1100485003() : Text[10];
    VAR
      lvNo@1100485000 : Integer;
    BEGIN
      lvNo := GetNoOfCustJobAddresses();
      IF lvNo = 0 THEN
        EXIT('')
      ELSE
        EXIT('[' + FORMAT(lvNo) + ']');
    END;

    PROCEDURE GetNoOfCustJobAddresses@1100485004() : Integer;
    VAR
      lvAddressRec@1100485000 : Record 222;
    BEGIN
      IF ("Customer No." = '') OR ("Project No." <> '') OR ("Service Order No." <> '') OR ("Company Name" <> '') THEN
        EXIT(0);

      lvAddressRec.SETRANGE("Customer No.", "Customer No.");
      lvAddressRec.SETRANGE("Project Address", TRUE);
      EXIT(lvAddressRec.COUNT);
    END;

    PROCEDURE TransferCustJobAddress@1100485006();
    VAR
      lvAddressRec@1100485000 : Record 222;
    BEGIN
      IF ("Customer No." = '') OR ("Project Address Code" = '') OR
         ("Project No." <> '') OR ("Service Order No." <> '') OR
         ("Company Name" <> '')
      THEN
        EXIT;

      IF NOT lvAddressRec.GET("Customer No.", "Project Address Code") THEN
        EXIT;

      IF Description <> '' THEN
        IF NOT CONFIRM(Text017) THEN
          EXIT;

      "Search Name" := '';
      VALIDATE(Description, lvAddressRec.Name);
      "Description 2" := lvAddressRec."Name 2";
      Address := lvAddressRec.Address;
      "Address 2" := lvAddressRec."Address 2";
      "Post Code" := lvAddressRec."Post Code";
      City := lvAddressRec.City;
      County := lvAddressRec.County;
      "Country/Region Code" := lvAddressRec."Country/Region Code";
      Contact := lvAddressRec.Contact;
      "Phone No." := lvAddressRec."Phone No.";
      "Fax No." := lvAddressRec."Fax No.";
      "E-Mail" := lvAddressRec."E-Mail";
      //DP00195 sn.
      "Travel Distance" := lvAddressRec."Travel Distance";
      "Travel Time" := lvAddressRec."Travel Time";
      "Travel Cost Code" := lvAddressRec."Travel Cost Code";
      //DP00195 en.
    END;

    PROCEDURE TransferEmployeeData@1100485007(IEmplRec@1100485000 : Record 5200);
    BEGIN
      IF Description <> '' THEN
        IF NOT CONFIRM(Text018) THEN
          EXIT;

      Description := COPYSTR(IEmplRec."Full Name",1,MAXSTRLEN(Description));
      "Search Name" :=  IEmplRec."Search Name";
      //C013440.so
      //Address := IEmplRec.Address;
      //"Address 2" := IEmplRec."Address 2";
      //"Post Code" := IEmplRec."Post Code";
      //C013440.eo
      City := IEmplRec.City;
      County := IEmplRec.County;
      "Country/Region Code" := IEmplRec."Country/Region Code";
      //C013440.so
      //"Phone No." := IEmplRec."Phone No.";
      //"Fax No." := IEmplRec."Fax No.";
      //"E-Mail" := IEmplRec."E-Mail";
      //C013440.eo
      //C013440.sn
      "Phone No." := COPYSTR(IEmplRec."Company Mobile Phone No." + ' / ' + IEmplRec."Company Phone No.", 1, MAXSTRLEN("Phone No."));
      "E-Mail" := IEmplRec."Company E-Mail";
      //C013440.en
      "Starting Date" := IEmplRec."Employment Date";
    END;

    PROCEDURE LookupEmployee@1100485011(IEditable@1100485001 : Boolean);
    VAR
      lvEmplRec@1100485000 : Record 5200;
    BEGIN
      IF "Company Name" <> '' THEN
        lvEmplRec.CHANGECOMPANY("Company Name");
      lvEmplRec.SETRANGE(Status, lvEmplRec.Status::Active);
      lvEmplRec."No." := "Employee No.";
      IF NOT IEditable THEN
        PAGE.RUNMODAL(0,lvEmplRec)
      ELSE BEGIN
        IF PAGE.RUNMODAL(0,lvEmplRec) = ACTION::LookupOK THEN
          VALIDATE("Employee No.",lvEmplRec."No.");
      END;
    END;

    PROCEDURE GetCustomerName@1100525000() : Text[100];
    VAR
      lvProjRec@1100525001 : Record 11072003;
      lvServOrderRec@1100525003 : Record 11012823;
      lvCustRec@1100525002 : Record 18;
      lvCustNo@1100525000 : Code[20];
    BEGIN
      IF ("Project No." = '') AND ("Service Order No." = '')  THEN
        lvCustNo := "Customer No."
      ELSE BEGIN
        IF "Company Name" <> '' THEN BEGIN
          IF "Project No." <> '' THEN
            lvProjRec.CHANGECOMPANY("Company Name")
          ELSE
            lvServOrderRec.CHANGECOMPANY("Company Name");
          lvCustRec.CHANGECOMPANY("Company Name");
        END;
        IF "Project No." <> '' THEN BEGIN
          IF lvProjRec.GET("Project No.") THEN
            lvCustNo := lvProjRec."Bill-to Customer No.";
        END ELSE BEGIN
          IF lvServOrderRec.GET("Service Order No.") THEN
            lvCustNo := lvServOrderRec."Customer No.";
        END;
      END;
      IF lvCustNo <> '' THEN BEGIN
        IF lvCustRec.GET(lvCustNo) THEN
          EXIT(lvCustRec.Name);
      END;

      EXIT('');
    END;

    PROCEDURE DisplayMap@1100525001();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FIND('-') THEN
        MapMgt.MakeSelection(DATABASE::"Plant Location",GETPOSITION)
      ELSE
        MESSAGE(Text021);
    END;

    PROCEDURE InsertDefaultRateCodesByLoc@1100525003();
    VAR
      PlantRateCodeRec@1100525001 : Record 11020502;
      PlantInventRec@1100525002 : Record 11012555;
      TmpPlantRateCodeRec@1100525000 : TEMPORARY Record 11020502;
    BEGIN
      IF (NOT "Rate Codes by Location") OR (Code = '') THEN
        EXIT;

      PlantRateCodeRec.SETRANGE("Copy to Location", TRUE);
      IF PlantRateCodeRec.FINDSET(FALSE,FALSE) THEN BEGIN
        REPEAT
          IF NOT PlantLocRateCodeRec.GET(Code, PlantRateCodeRec.Code) THEN BEGIN
            PlantLocRateCodeRec.INIT;
            PlantLocRateCodeRec.TRANSFERFIELDS(PlantRateCodeRec, FALSE);
            PlantLocRateCodeRec.Location := Code;
            PlantLocRateCodeRec."Rate Code" := PlantRateCodeRec.Code;
            PlantLocRateCodeRec.INSERT;
          END;
          TmpPlantRateCodeRec := PlantRateCodeRec;
          TmpPlantRateCodeRec.INSERT;
        UNTIL PlantRateCodeRec.NEXT = 0;
      END;

      //* Also insert rate codes if already plant is/was on location.
      //* Note: Only for inventory, not for other tables with records of 'Location' and 'Rate Code'.
      PlantInventRec.SETCURRENTKEY(Location);
      PlantInventRec.SETRANGE(Location, Code);
      PlantInventRec.SETFILTER("Rate Code", '<>%1', '');
      IF PlantInventRec.FINDSET(FALSE,FALSE) THEN BEGIN
        REPEAT
          IF NOT TmpPlantRateCodeRec.GET(PlantInventRec."Rate Code") THEN BEGIN
            IF NOT PlantRateCodeRec.GET(PlantInventRec."Rate Code") THEN BEGIN
              TmpPlantRateCodeRec.INIT;
              TmpPlantRateCodeRec.Code := PlantInventRec."Rate Code";
            END ELSE BEGIN
              IF NOT PlantLocRateCodeRec.GET(Code, PlantInventRec."Rate Code") THEN BEGIN
                PlantLocRateCodeRec.INIT;
                PlantLocRateCodeRec.TRANSFERFIELDS(PlantRateCodeRec, FALSE);
                PlantLocRateCodeRec.Location := Code;
                PlantLocRateCodeRec."Rate Code" := PlantRateCodeRec.Code;
                PlantLocRateCodeRec.INSERT;
              END;
              TmpPlantRateCodeRec := PlantRateCodeRec;
            END;
            TmpPlantRateCodeRec.INSERT;
          END;
        UNTIL PlantInventRec.NEXT = 0;
      END;
    END;

    PROCEDURE CheckPlantMgtCompanySetup@1100525007(ProjCompany@1100525001 : Text[30]);
    VAR
      PlantMgtCompRec@1100525000 : Record 11020586;
    BEGIN
      IF ProjCompany = '' THEN   //* Project or Service company
        ProjCompany := COMPANYNAME;
      PlantMgtCompRec.CHANGECOMPANY(ProjCompany);
      IF NOT PlantMgtCompRec.GET(COMPANYNAME) THEN  //COMPANYNAME is the plant company
        ERROR(Text020,
          PlantMgtCompRec.FIELDCAPTION("Plant Company"), COMPANYNAME,
          PlantMgtCompRec.TABLECAPTION, ProjSetupRec.TABLECAPTION, ProjCompany);
    END;

    PROCEDURE DrillDownRevenuesDetails@1210190001(Type@1210190001 : ',Revenue,Costs');
    VAR
      PlantLedgerEntry@1210190000 : Record 11012572;
    BEGIN
      PlantLedgerEntry.FILTERGROUP(2);
      PlantLedgerEntry.SETCURRENTKEY("Plant Location", "Posting Date", "Relate to");

      PlantLedgerEntry.SETRANGE("Plant Location", Code);
      COPYFILTER("Date Filter", PlantLedgerEntry."Posting Date");
      COPYFILTER("Relate to Filter", PlantLedgerEntry."Relate to");

      CASE Type OF
        Type::Revenue:
          PlantLedgerEntry.SETFILTER("Total Price", '<>%1', 0);  //* Only Revenues (15512)
      END;

      PlantLedgerEntry.FILTERGROUP(0);
      PAGE.RUNMODAL(0, PlantLedgerEntry);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(DepartmentAuthorizObject) THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(11012554) THEN BEGIN
        FIND;
        EXIT;
      END;


      DPA_SetFilters('Table 11012554');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Plant Location", "Department Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Department Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Department Code");
    END;

    PROCEDURE GetContact@1100528700(VAR Contact@1100528700 : Record 5050;GiveMessage@1100528703 : Boolean) : Boolean;
    VAR
      Job@1100528701 : Record 11072003;
      ServiceOrder@1100528702 : Record 11012823;
    BEGIN
      IF ("Project No." <> '') AND ("Company Name" = '') THEN BEGIN
        Job.GET("Project No.");
        EXIT(Contact.GetContactByCustomer(Job."Bill-to Customer No.", Contact, GiveMessage));
      END ELSE IF ("Service Order No." <> '') AND ("Company Name" = '') THEN BEGIN
        ServiceOrder.GET("Service Order No.");
        EXIT(Contact.GetContactByCustomer(ServiceOrder."Customer No.", Contact, GiveMessage));
      END ELSE IF "Customer No." <> '' THEN
        EXIT(Contact.GetContactByCustomer("Customer No.", Contact, GiveMessage));
    END;

    PROCEDURE EditDocuments@1100528702(ContactNo@1210190003 : Code[20];ContactPersonNo@1210190004 : Code[20];SendMail@1210190002 : Boolean;Recipient@1100528700 : Text[120]);
    VAR
      DocumentTemplate@1210190001 : Record 11012401;
      DocumentMailing@1210190000 : Codeunit 11012278;
      RecRef@1100525000 : RecordRef;
      DocumentLinkRIDs@1100525001 : ARRAY [5] OF RecordID;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentLinkRIDs[1] := RecRef.RECORDID;

      DocumentMailing.EditDocuments(
        STRSUBSTNO('%1', DocumentTemplate.Type::Plant), DocumentLinkRIDs,
        '', ContactNo, ContactPersonNo, SendMail, Recipient);
    END;

    PROCEDURE ShowDocuments@1100529007();
    VAR
      RecRef@1100525000 : RecordRef;
      DocumentFilters@1100525001 : Codeunit 11012432;
    BEGIN
      //DP00183
      TESTFIELD(Code);
      RecRef.GETTABLE(Rec);
      DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Department Code", FALSE, TRUE);
    END;

    PROCEDURE DeleteDocumentLinks@1100529006();
    VAR
      DocumentLinkMgt@1100525000 : Codeunit 11012401;
      RecRef@1100525001 : RecordRef;
    BEGIN
      //DP00183
      RecRef.GETTABLE(Rec);
      DocumentLinkMgt.DeleteDocumentLinksFromObject(RecRef);
    END;

    PROCEDURE MoveDocumentLinks@1100529005(SourceRec@1100529001 : Record 11012554;TargetRec@1100529000 : Record 11012554;CopyMode@1100529003 : Boolean);
    VAR
      DocumentLinkMgt@1100525000 : Codeunit 11012401;
      SourceRecRef@1100525001 : RecordRef;
      TargetRecRef@1100529002 : RecordRef;
    BEGIN
      //DP00183
      SourceRecRef.GETTABLE(SourceRec);
      TargetRecRef.GETTABLE(TargetRec);
      IF NOT CopyMode THEN
        DocumentLinkMgt.ReplaceDocLink(SourceRecRef, TargetRecRef)
      ELSE
        DocumentLinkMgt.CopyDocLinks(SourceRecRef, TargetRecRef);
    END;

    PROCEDURE CommentSheet@1100529004(EditableMode@1100529002 : Boolean);
    VAR
      PlantCommentLine@1100529000 : Record 11072666;
    BEGIN
      //DP00183
      TESTFIELD(Code);
      PlantCommentLine.EditCommentLines(DATABASE::"Plant Location", Code, '', 0, EditableMode);  //C005461.c
    END;

    PROCEDURE HasCommentLines@1100529002() : Boolean;
    VAR
      PlantCommentLine@1100529000 : Record 11072666;
    BEGIN
      //DP00183
      EXIT(PlantCommentLine.HasCommentLines(DATABASE::"Plant Location", Code, '', 0));  //C005461.c
    END;

    PROCEDURE DeleteCommentLines@1100529003();
    VAR
      PlantCommentLine@1100529000 : Record 11072666;
    BEGIN
      //DP00183
      PlantCommentLine.DeleteComments(DATABASE::"Plant Location", Code, '', 0);  //C005461.c
    END;

    PROCEDURE RefersToOtherCompany@1100525006() : Boolean;
    BEGIN
      EXIT(("Company Name" <> '') AND ("Company Name" <> COMPANYNAME));
    END;

    PROCEDURE TravelTimeUnit@1100529900() : Code[10];
    VAR
      ServSetup@1100525000 : Record 11012800;
      DimValRec@1100525002 : Record 349;
      DimMgt@1100525001 : Codeunit 408;
    BEGIN
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(ServSetup) THEN EXIT('');  //db, 26-06-14: C016159
      ServSetup.GET;
      DimMgt.GetDimValueRec(2,ServSetup."Cost Object Travel Time",DimValRec,FALSE,'');
      EXIT(DimValRec."Unit of Measure");
    END;

    PROCEDURE TravelDistanceUnit@1100525116() : Code[10];
    VAR
      ServSetup@1100525000 : Record 11012800;
      DimValRec@1100525002 : Record 349;
      DimMgt@1100525001 : Codeunit 408;
    BEGIN
      IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(ServSetup) THEN EXIT('');  //db, 26-06-14: C016159
      ServSetup.GET;
      DimMgt.GetDimValueRec(2,ServSetup."Cost Object Travel Distance",DimValRec,FALSE,'');
      EXIT(DimValRec."Unit of Measure");
    END;

    PROCEDURE GetTravelCostWithIndexDate@1100528600(IIndexDate@1100528601 : Date) : Decimal;
    VAR
      TravelCostRate@1100528600 : Record 11071802;
    BEGIN
      IF "Travel Cost Code" <> '' THEN BEGIN
        TravelCostRate.SETRANGE("Travel Cost Code", "Travel Cost Code");
        TravelCostRate.SETFILTER("Index Date", '<=%1', IIndexDate);
        IF TravelCostRate.FINDLAST THEN
          EXIT(TravelCostRate.Rate);
      END;
    END;

    PROCEDURE NormalizePostCodeHouseNo@1100526200();
    VAR
      ObjectImpWorkSheetMgt@1100526200 : Codeunit 11012839;
      PostCode@1100526201 : Code[20];
    BEGIN
      IF ObjectImpWorkSheetMgt.NormalizePostCode("Post Code", "Country/Region Code", PostCode) THEN
        "Post Code" := PostCode;
      "House No." := ObjectImpWorkSheetMgt.DetermineHouseNo(Address, "House No. Ext.");
    END;

    PROCEDURE GetNoOfEstimates@1100409000(EstimateCompany@1100529402 : Text;CheckPermission@1100529401 : Boolean) : Decimal;
    VAR
      EstSetup@1100409000 : Record 11012150;
      Estimate@1100529400 : Record 11012151;
    BEGIN
      "No. of Linked Estimates" := 0;
      IF EstimateCompany = '' THEN BEGIN
        IF CheckPermission THEN
          IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(EstSetup) THEN EXIT(0);  //db, 10-07-14: C016159
        CALCFIELDS("No. of Linked Estimates");
      END ELSE BEGIN
        IF CheckPermission THEN BEGIN
          IF NOT EstSetup.CHANGECOMPANY(EstimateCompany) THEN EXIT(0);
          IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(EstSetup) THEN EXIT(0);  //db, 10-07-14: C016159
        END;
        Estimate.CHANGECOMPANY(EstimateCompany);
        Estimate.SETCURRENTKEY("Plant Location");
        "No. of Linked Estimates" := Estimate.COUNT;
      END;
      EXIT("No. of Linked Estimates");
    END;

    PROCEDURE GetEstimateNo@1100529403(EstimateCompany@1100529402 : Text;CheckPermission@1100529401 : Boolean) : Code[20];
    VAR
      EstSetup@1100409000 : Record 11012150;
      Estimate@1100529400 : Record 11012151;
    BEGIN
      "Estimate No." := '';
      IF EstimateCompany = '' THEN BEGIN
        IF CheckPermission THEN
          IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(EstSetup) THEN EXIT('');  //db, 10-07-14: C016159
        CALCFIELDS("Estimate No.");
      END ELSE BEGIN
        IF CheckPermission THEN BEGIN
          IF NOT EstSetup.CHANGECOMPANY(EstimateCompany) THEN EXIT('');
          IF NOT FPSLicenseManagement.LicenseAndReadPermissionForTable(EstSetup) THEN EXIT('');  //db, 10-07-14: C016159
        END;
        Estimate.CHANGECOMPANY(EstimateCompany);
        Estimate.SETCURRENTKEY("Plant Location");
        IF Estimate.FINDFIRST THEN
          "Estimate No." := Estimate."No.";
      END;
      EXIT("Estimate No.");
    END;

    LOCAL PROCEDURE CheckPlantNoFilled@1100529000();
    VAR
      PlantType@1100529000 : Record 11012551;
    BEGIN
      //DP00815
      IF "Plant Type" = '' THEN
        EXIT;
      PlantType.GET("Plant Type");
      IF NOT PlantType.Bulk THEN
        TESTFIELD("Plant No.");
    END;

    PROCEDURE RunPostedSalesInvoices@1100529008();
    VAR
      SalesInvoiceHeader@1100525001 : Record 112;
      SalesInvoiceLine@1100525000 : Record 113;
    BEGIN
      TESTFIELD(Code);
      SalesInvoiceLine.SETCURRENTKEY("Plant Location", "Document No.");
      SalesInvoiceLine.SETRANGE("Plant Location", Code);
      IF SalesInvoiceLine.FINDSET THEN BEGIN
        REPEAT
          IF SalesInvoiceHeader.GET(SalesInvoiceLine."Document No.") THEN
            SalesInvoiceHeader.MARK(TRUE);
          //* Set pointer on last line of the invoice, so 'Next' will be another invoice
          SalesInvoiceLine.SETRANGE("Document No.", SalesInvoiceLine."Document No.");
          SalesInvoiceLine.FINDLAST;
          SalesInvoiceLine.SETRANGE("Document No.");  //* Reset filter on invoice
        UNTIL SalesInvoiceLine.NEXT = 0;
      END;
      SalesInvoiceHeader.MARKEDONLY(TRUE);
      PAGE.RUNMODAL(PAGE::"Posted Sales Invoices", SalesInvoiceHeader);
    END;

    PROCEDURE RunPostedSalesCreditMemos@1100529001();
    VAR
      SalesCrMemoHeader@1100525001 : Record 114;
      SalesCrMemoLine@1100525000 : Record 115;
    BEGIN
      TESTFIELD(Code);
      SalesCrMemoLine.SETCURRENTKEY("Plant Location", "Document No.");
      SalesCrMemoLine.SETRANGE("Plant Location", Code);
      IF SalesCrMemoLine.FINDSET THEN BEGIN
        REPEAT
          IF SalesCrMemoHeader.GET(SalesCrMemoLine."Document No.") THEN
            SalesCrMemoHeader.MARK(TRUE);
          //* Set pointer on last line of the invoice, so 'Next' will be another invoice
          SalesCrMemoLine.SETRANGE("Document No.", SalesCrMemoLine."Document No.");
          SalesCrMemoLine.FINDLAST;
          SalesCrMemoLine.SETRANGE("Document No.");  //* Reset filter on invoice
        UNTIL SalesCrMemoLine.NEXT = 0;
      END;
      SalesCrMemoHeader.MARKEDONLY(TRUE);
      PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memos", SalesCrMemoHeader);
    END;

    PROCEDURE RunPurchaseInvoices@1100529009(DocumentType@1100529000 : Option);
    VAR
      PurchaseHeader@1100525001 : Record 38;
      PurchaseLine@1100525000 : Record 39;
    BEGIN
      TESTFIELD(Code);
      PurchaseHeader.SETRANGE("Document Type", DocumentType);
      IF PurchaseHeader.FINDSET THEN BEGIN
        PurchaseLine.SETRANGE("Document Type", DocumentType);
        PurchaseLine.SETRANGE("Plant Location", Code);
        REPEAT
          PurchaseLine.SETRANGE("Document No.", PurchaseHeader."No.");
          IF NOT PurchaseLine.ISEMPTY THEN
            PurchaseHeader.MARK(TRUE);
        UNTIL PurchaseHeader.NEXT = 0;
      END;
      PurchaseHeader.MARKEDONLY(TRUE);
      CASE DocumentType OF
        PurchaseHeader."Document Type"::Invoice:
          PAGE.RUNMODAL(PAGE::"Purchase Invoices", PurchaseHeader);
        PurchaseHeader."Document Type"::"Credit Memo":
          PAGE.RUNMODAL(PAGE::"Purchase Credit Memos", PurchaseHeader);
      END;
    END;

    PROCEDURE RunPostedPurchaseInvoices@1100529011();
    VAR
      PurchInvoiceHeader@1100525001 : Record 122;
      PurchInvoiceLine@1100525000 : Record 123;
    BEGIN
      TESTFIELD(Code);
      PurchInvoiceLine.SETCURRENTKEY("Plant Location", "Document No.");
      PurchInvoiceLine.SETRANGE("Plant Location", Code);
      IF PurchInvoiceLine.FINDSET THEN BEGIN
        REPEAT
          IF PurchInvoiceHeader.GET(PurchInvoiceLine."Document No.") THEN
            PurchInvoiceHeader.MARK(TRUE);
          //* Set pointer on last line of the invoice, so 'Next' will be another invoice
          PurchInvoiceLine.SETRANGE("Document No.", PurchInvoiceLine."Document No.");
          PurchInvoiceLine.FINDLAST;
          PurchInvoiceLine.SETRANGE("Document No.");  //* Reset filter on invoice
        UNTIL PurchInvoiceLine.NEXT = 0;
      END;
      PurchInvoiceHeader.MARKEDONLY(TRUE);
      PAGE.RUNMODAL(PAGE::"Posted Purchase Invoices", PurchInvoiceHeader);
    END;

    PROCEDURE RunPostedPurchaseCreditMemos@1100529012();
    VAR
      PurchCrMemoHeader@1100525001 : Record 124;
      PurchCrMemoLine@1100525000 : Record 125;
    BEGIN
      TESTFIELD(Code);
      PurchCrMemoLine.SETCURRENTKEY("Plant Location", "Document No.");
      PurchCrMemoLine.SETRANGE("Plant Location", Code);
      IF PurchCrMemoLine.FINDSET THEN BEGIN
        REPEAT
          IF PurchCrMemoHeader.GET(PurchCrMemoLine."Document No.") THEN
            PurchCrMemoHeader.MARK(TRUE);
          //* Set pointer on last line of the invoice, so 'Next' will be another invoice
          PurchCrMemoLine.SETRANGE("Document No.", PurchCrMemoLine."Document No.");
          PurchCrMemoLine.FINDLAST;
          PurchCrMemoLine.SETRANGE("Document No.");  //* Reset filter on invoice
        UNTIL PurchCrMemoLine.NEXT = 0;
      END;
      PurchCrMemoHeader.MARKEDONLY(TRUE);
      PAGE.RUNMODAL(PAGE::"Posted Purchase Credit Memos", PurchCrMemoHeader);
    END;

    PROCEDURE CopyInfoFromProject@1100527002(ProjectNo@1100527000 : Code[20]);
    VAR
      Employee@1100527005 : Record 5200;
      DimensionValue@1100527006 : Record 349;
      Job@1100527001 : Record 11072003;
    BEGIN
      IF "Company Name" = '' THEN
        Job.CHANGECOMPANY(CURRENTCOMPANY)
      ELSE
        Job.CHANGECOMPANY("Company Name");
      IF NOT Job.GET(ProjectNo) THEN
        EXIT;

      "Project No." :=  Job."No.";
      Description :=  Job.Description;
      "Description 2" := Job."Description 2";
      "Search Name" := Job."Search Description";
      Address := Job.Address;
      "Address 2" := Job."Address 2";
      City := Job.City;
      County := Job.County;
      "Post Code" := Job."Post Code";
      "Country/Region Code" := Job."Country/Region Code";
      "Phone No." := Job."Phone No.";
      "Fax No." := Job."Fax No.";
      "Territory Code" := Job."Territory Code";
      "Starting Date" := Job."Starting Date";
      "Ending Date" := Job."Ending Date";

      IF Job."Site Manager" <> '' THEN BEGIN
        Contact := COPYSTR(Job.SiteManagerName, 1 , MAXSTRLEN(Contact));
        IF "Company Name" = '' THEN
          Employee.CHANGECOMPANY(CURRENTCOMPANY)
        ELSE
          Employee.CHANGECOMPANY("Company Name");
        IF Employee.GET(Job."Site Manager") THEN BEGIN
          "Contact Phone No." := COPYSTR(
            Employee."Company Mobile Phone No." + ' / ' + Employee."Company Phone No.", 1, MAXSTRLEN("Contact Phone No."));
          "E-Mail" := Employee."Company E-Mail";
        END;
      END;

      IF Job."Global Dimension 1 Code" <> '' THEN BEGIN
        IF CURRENTCOMPANY = COMPANYNAME THEN
          "Department Code" := Job."Global Dimension 1 Code"
        ELSE BEGIN
          DimensionValue.CHANGECOMPANY(CURRENTCOMPANY);
          DimensionValue.SETCURRENTKEY(Code, "Global Dimension No.");
          DimensionValue.SETRANGE(Code, Job."Global Dimension 1 Code");
          DimensionValue.SETRANGE("Global Dimension No.", 1);
          IF DimensionValue.FINDFIRST THEN
            "Department Code" := Job."Global Dimension 1 Code";
        END;
      END;
    END;

    PROCEDURE RunUpdateFromRelatedProject@1100527001();
    VAR
      Job@1100527001 : Record 11072003;
      PlantManagementCompany@1100525005 : Record 11020586;
      TempPlantManagementCompany@1100525002 : TEMPORARY Record 11020586;
      TempLinkedPlantLocation@1100527002 : TEMPORARY Record 11012657;
      PlantManagementCompanyList@1100525001 : Page 11124918;
      PlantCompanyFilter@1100527003 : Text;
      CopyProjLocAddresses@1100525009 : Boolean;
      NoOfPlantComps@1100525000 : Integer;
    BEGIN
      IF NOT Job.GET("Project No.") THEN
        EXIT;

      IF NOT Job.ConfirmPlantLocationChange(Text025, Text026) THEN
        EXIT;

      IF Job.ConfirmCopyProjectLocationAddr THEN
        CopyProjLocAddresses := TRUE;

      PlantManagementCompany."Plant Company" := PlantManagementCompany.GetPlantCompany(TRUE, NoOfPlantComps, '');
      IF NoOfPlantComps = 1 THEN
        UpdateFromRelatedProject(PlantManagementCompany."Plant Company", CopyProjLocAddresses)
      ELSE BEGIN
        TempLinkedPlantLocation.BuildLinkedPlantLocations("Project No.", TempLinkedPlantLocation."Link Type"::Project, TempLinkedPlantLocation);
        TempLinkedPlantLocation.SETRANGE("Plant Location", Code);
        IF TempLinkedPlantLocation.FINDSET THEN
          REPEAT
            PlantCompanyFilter += TempLinkedPlantLocation."Plant Company" + '|';
          UNTIL TempLinkedPlantLocation.NEXT = 0;
        IF PlantCompanyFilter <> '' THEN
          PlantCompanyFilter := COPYSTR(PlantCompanyFilter, 1, STRLEN(PlantCompanyFilter) - 1);

        PlantManagementCompany.RESET;
        PlantManagementCompany.FILTERGROUP(9);
        PlantManagementCompany.SETFILTER("Plant Company", PlantCompanyFilter);
        PlantManagementCompany.FILTERGROUP(0);
        PlantManagementCompanyList.SetMultiCreate;
        PlantManagementCompanyList.SETTABLEVIEW(PlantManagementCompany);
        PlantManagementCompanyList.LOOKUPMODE(TRUE);
        IF PlantManagementCompanyList.RUNMODAL = ACTION::LookupOK THEN BEGIN
          IF NOT PlantManagementCompanyList.GetMarkedRecords(TempPlantManagementCompany) THEN BEGIN
            PlantManagementCompanyList.GETRECORD(PlantManagementCompany);
            UpdateFromRelatedProject(PlantManagementCompany."Plant Company", CopyProjLocAddresses);
            NoOfPlantComps := 1;
          END ELSE BEGIN
            TempPlantManagementCompany.FINDSET;
            NoOfPlantComps := 0;
            REPEAT
              UpdateFromRelatedProject(TempPlantManagementCompany."Plant Company", CopyProjLocAddresses);
              NoOfPlantComps += 1;
              IF NoOfPlantComps = 1 THEN
                PlantManagementCompany."Plant Company" := TempPlantManagementCompany."Plant Company";
            UNTIL TempPlantManagementCompany. NEXT = 0;
          END;
        END ELSE
          NoOfPlantComps := 0;
      END;

      IF NoOfPlantComps = 1 THEN
        MESSAGE(Text027, Code, PlantManagementCompany."Plant Company")
      ELSE
        IF NoOfPlantComps > 1 THEN
          MESSAGE(Text028, Code, NoOfPlantComps);
    END;

    PROCEDURE UpdateFromRelatedProject@1100527000(PlantCompany@1100485010 : Text[30];CopyProjLocAddresses@1100525000 : Boolean);
    VAR
      PlantLocation@1100485001 : Record 11012554;
    BEGIN
      PlantLocation.CHANGECOMPANY(PlantCompany);
      PlantLocation.GET(Code);

      PlantLocation.CopyInfoFromProject("Project No.");
      PlantLocation.MODIFY;

      IF CopyProjLocAddresses THEN
        PlantLocation.CopyProjLocsToPlantLocAddress(PlantCompany);
    END;

    PROCEDURE GetNoOfRentalAgreements@1100529010() : Integer;
    VAR
      PlantRentalAgreement@1100525000 : Record 11229935;
    BEGIN
      IF Code = '' THEN
        EXIT(0);
      PlantRentalAgreement.SETCURRENTKEY("Plant Location", "Plant Type", "Plant No.");
      PlantRentalAgreement.SETRANGE("Plant Location", Code);
      EXIT(PlantRentalAgreement.COUNT);
    END;

    PROCEDURE ShowRentalAgreements@1100529013();
    VAR
      PlantRentalAgreements@1100525001 : Page 11229941;
    BEGIN
      TESTFIELD(Code);
      TESTFIELD(Depot, FALSE);
      PlantRentalAgreements.SetCalledFromPlantLocation(Code);
      PlantRentalAgreements.RUNMODAL;
    END;

    PROCEDURE LookupContact@1100529600();
    VAR
      PlantLocationContact@1100529600 : Record 11012594;
    BEGIN
      PlantLocationContact.SETRANGE(Location, Code);
      IF PlantLocationContact.ISEMPTY THEN
        EXIT;

      IF (Contact <> '') AND (STRLEN(Contact) <= MAXSTRLEN(PlantLocationContact."Contact No.")) THEN
        IF PlantLocationContact.GET(Code, Contact) THEN;
      IF PAGE.RUNMODAL(0, PlantLocationContact) = ACTION::LookupOK THEN
        PlantLocationContact.UpdatePlantLocationWithContactData(Rec);
    END;

    PROCEDURE GetPlantLocationCustomer@1100529601(PlantLocationCode@1100529600 : Code[20];VAR PlantLocationLoc@1100529601 : Record 11012554);
    BEGIN
      IF PlantLocationCode = '' THEN
        CLEAR(PlantLocationLoc)
      ELSE
        IF PlantLocationCode <> PlantLocationLoc.Code THEN BEGIN
          PlantLocationLoc.GET(PlantLocationCode);
          PlantLocationLoc.CALCFIELDS("Customer Name", "Bill-to Customer Name");
        END;
    END;

    PROCEDURE LookupPlantLocationCustomer@1100529602(CustomerNo@1100529600 : Code[20]);
    VAR
      CustomerLoc@1100529601 : Record 18;
    BEGIN
      CustomerLoc.SETRANGE("No.", CustomerNo);
      PAGE.RUN(0, CustomerLoc);
    END;

    LOCAL PROCEDURE CheckUsageInServiceOrders@1100529603();
    VAR
      Company@1100529600 : Record 2000000006;
      ServiceOrder@1100529601 : Record 11012823;
    BEGIN
      Company.FINDSET;
      REPEAT
        ServiceOrder.RESET;
        IF Company.Name = COMPANYNAME THEN BEGIN
          ServiceOrder.SETRANGE("Plant Location", Code);
          IF NOT ServiceOrder.ISEMPTY THEN
            TESTFIELD("Service Order No.", '');
        END ELSE BEGIN
          ServiceOrder.CHANGECOMPANY(Company.Name);
          ServiceOrder.SETRANGE("Plant Company", COMPANYNAME);
          ServiceOrder.SETRANGE("Plant Location", Code);
          IF NOT ServiceOrder.ISEMPTY THEN
            TESTFIELD("Service Order No.", '');
        END;
      UNTIL Company.NEXT = 0;
    END;

    LOCAL PROCEDURE FillCustomerPriceAndDiscGroupWithDefaultValue@1100528400(CustomerNo@1100528403 : Code[20]);
    VAR
      Customer@1100528402 : Record 18;
    BEGIN
      ClearCustomerPriceAndDiscGroup;
      IF (CustomerNo <> '') AND
         (("Company Name" = '') OR ("Company Name" = COMPANYNAME))
      THEN
        IF Customer.GET(CustomerNo) THEN BEGIN
          "Customer Price Group (Rental)" := Customer."Customer Price Group";
          "Customer Disc. Group (Rental)" := Customer."Customer Disc. Group";
        END;
    END;

    LOCAL PROCEDURE ClearCustomerPriceAndDiscGroup@1100528403();
    BEGIN
      "Customer Price Group (Rental)" := '';
      "Customer Disc. Group (Rental)" := '';
    END;

    LOCAL PROCEDURE CheckIfCustomerPriceAndDiscGroupCanBeFilled@1100528401();
    BEGIN
      TESTFIELD("Customer No.", '');
      IF ("Company Name" <> '') AND ("Company Name" <> COMPANYNAME) THEN
        FIELDERROR("Company Name");
      IF ("Service Order No." = '') AND ("Project No." = '') THEN
        ERROR(Text029, FIELDCAPTION("Service Order No."), FIELDCAPTION("Project No."));
    END;

    PROCEDURE SetFilterOnCompanyName@1100529605(LocCompanyName@1100529600 : Text[30];LocCurrCompanyName@1100529602 : Text[30]);
    BEGIN
      IF LocCompanyName = '' THEN
        IF LocCurrCompanyName = '' THEN
          LocCompanyName := COMPANYNAME
        ELSE
          LocCompanyName := LocCurrCompanyName;

      IF LocCompanyName = CURRENTCOMPANY THEN
        SETFILTER("Company Name", '%1|%2', LocCompanyName, '')
      ELSE
        SETRANGE("Company Name", LocCompanyName);
    END;

    PROCEDURE FillDefaultFromDepotPlantNeed@1100529014();
    VAR
      PlantSetup@1100529000 : Record 11012550;
      PlantLocation@1100529001 : Record 11012554;
      FromDepot@1100529003 : Code[20];
    BEGIN
      IF CURRENTCOMPANY <> COMPANYNAME THEN BEGIN
        PlantSetup.CHANGECOMPANY(CURRENTCOMPANY);
        PlantLocation.CHANGECOMPANY(CURRENTCOMPANY);
      END;
      IF NOT PlantSetup.GET THEN
        EXIT;
      FromDepot := PlantSetup.GetRentalDepotForDepartmentCode("Department Code");
      IF (FromDepot = '') OR (FromDepot = "From Depot (Plant Need)")  THEN
        EXIT;
      IF PlantLocation.GET(FromDepot) THEN BEGIN
        IF PlantLocation.Depot THEN BEGIN
          IF CURRENTCOMPANY <> COMPANYNAME THEN
            "From Depot (Plant Need)" := FromDepot
          ELSE
            VALIDATE("From Depot (Plant Need)", FromDepot);
        END;
      END;
    END;

    BEGIN
    END.
  }
}

