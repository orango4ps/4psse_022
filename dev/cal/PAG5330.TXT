OBJECT Page 5330 CRM Connection Setup
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00;
  }
  PROPERTIES
  {
    AccessByPermission=TableData 5330=IM;
    CaptionML=[ENU=Microsoft Dynamics 365 Connection Setup;
               NOR=Konfigurasjon for Microsoft Dynamics 365-tilkobling;
               SVE=Konfigurera anslutning fîr Microsoft Dynamics 365];
    ApplicationArea=#Suite;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5330;
    UsageCategory=Administration;
    PromotedActionCategoriesML=[ENU=New,Connection,Mapping,Synchronization,Encryption;
                                NOR=Ny,Tilkobling,Tilordning,Synkronisering,Kryptering;
                                SVE=Ny,Anslutning,Mappning,Synkronisering,Kryptering];
    ShowFilter=No;
    OnInit=VAR
             PermissionManager@1000 : Codeunit 9002;
             ApplicationAreaMgmtFacade@1001 : Codeunit 9179;
           BEGIN
             ApplicationAreaMgmtFacade.CheckAppAreaOnlyBasic;
             AssistedSetupAvailable :=
               AssistedSetup.GET(PAGE::"CRM Connection Setup Wizard") AND
               AssistedSetup.Visible;
             SoftwareAsAService := PermissionManager.SoftwareAsAService;
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1002 : Codeunit 5330;
               BEGIN
                 IF NOT GET THEN BEGIN
                   INIT;
                   InitializeDefaultProxyVersion;
                   INSERT;
                 END ELSE BEGIN
                   ConnectionString := GetConnectionString;
                   UnregisterConnection;
                   IF "Proxy Version" = 0 THEN BEGIN
                     InitializeDefaultProxyVersion;
                     MODIFY;
                   END;
                   IF "Is Enabled" THEN
                     RegisterUserConnection
                   ELSE
                     IF "Disable Reason" <> '' THEN
                       CRMIntegrationManagement.SendConnectionDisabledNotification("Disable Reason");
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       IF HasPassword THEN
                         CRMPassword := '*';
                       RefreshData;
                     END;

    OnQueryClosePage=BEGIN
                       IF NOT "Is Enabled" THEN
                         IF NOT CONFIRM(STRSUBSTNO(EnableServiceQst,CurrPage.CAPTION),TRUE) THEN
                           EXIT(FALSE);
                     END;

    ActionList=ACTIONS
    {
      { 4       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 35      ;1   ;Action    ;
                      Name=Assisted Setup;
                      CaptionML=[ENU=Assisted Setup;
                                 NOR=Assistert oppsett;
                                 SVE=Assisterad konfiguration];
                      ToolTipML=[ENU=Runs Dynamics 365 Connection Setup Wizard.;
                                 NOR=Kjõrer veiviseren Tilkoblingsoppsett for Dynamics 365.;
                                 SVE=Kîr guiden Konfigurera anslutning fîr Dynamics 365.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=AssistedSetupAvailable;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF AssistedSetupAvailable THEN BEGIN
                                   AssistedSetup.Run;
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=Test Connection;
                      CaptionML=[@@@=Test is a verb.;
                                 ENU=Test Connection;
                                 NOR=Test tilkobling;
                                 SVE=Testa anslutning];
                      ToolTipML=[ENU=Tests the connection to Dynamics 365 for Sales using the specified settings.;
                                 NOR=Tester tilkoblingen til Dynamics 365 for Sales ved hjelp av de angitte innstillingene.;
                                 SVE=Testa anslutningen till Dynamics 365 for Sales med de angivna instÑllningarna.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=ValidateEmailLoggingSetup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PerformTestConnection;
                               END;
                                }
      { 13      ;1   ;Action    ;
                      Name=ResetConfiguration;
                      CaptionML=[ENU=Use Default Synchronization Setup;
                                 NOR=Bruk standard synkroniseringsoppsett;
                                 SVE=AnvÑnd standardsynkroniseringskonfiguration];
                      ToolTipML=[ENU=Resets the integration table mappings and synchronization jobs to the default values for a connection with Dynamics 365 for Sales. All current mappings are deleted.;
                                 NOR=Tilbakestiller tilordningen for integreringstabellen og synkroniseringsjobbene til standardverdier for en tilkobling til Dynamics 365 for Sales. Alle gjeldende tilordninger blir slettet.;
                                 SVE=èterstÑller mappningar till tabell fîr integrering och synkroniseringsjobb till standardvÑrden fîr en anslutning med Dynamics 365 for Sales. Alla aktuella mappningar tas bort.];
                      ApplicationArea=#Suite;
                      Enabled="Is Enabled";
                      Image=ResetStatus;
                      OnAction=VAR
                                 CRMSetupDefaults@1000 : Codeunit 5334;
                               BEGIN
                                 IF CONFIRM(ResetIntegrationTableMappingConfirmQst,FALSE,CRMProductName.SHORT) THEN BEGIN
                                   CRMSetupDefaults.ResetConfiguration(Rec);
                                   MESSAGE(SetupSuccessfulMsg,CRMProductName.SHORT);
                                 END;
                                 RefreshDataFromCRM;
                               END;
                                }
      { 41      ;1   ;Action    ;
                      Name=CoupleUsers;
                      CaptionML=[ENU=Couple Salespersons;
                                 NOR=Koble selgere;
                                 SVE=Koppla sÑljare];
                      ToolTipML=[ENU=Open the list of users in Dynamics 365 for Sales for manual coupling to salespersons in Business Central.;
                                 NOR=èpne listen over brukere i Dynamics 365 for Sales for manuell kobling til selgerne i Business Central.;
                                 SVE=ôppna listan med anvÑndare i Dynamics 365 for Sales fîr manuell koppling till sÑljare i Business Central.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=CoupledUsers;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 CRMSystemuserList@1000 : Page 5340;
                               BEGIN
                                 CRMSystemuserList.Initialize(TRUE);
                                 CRMSystemuserList.RUN;
                               END;
                                }
      { 10      ;1   ;Action    ;
                      Name=StartInitialSynchAction;
                      CaptionML=[ENU=Run Full Synchronization;
                                 NOR=Kjõr full synkronisering;
                                 SVE=Kîr fullstÑndig synkronisering];
                      ToolTipML=[ENU=Start all the default integration jobs for synchronizing Business Central record types and Dynamics 365 for Sales entities, as defined on the Integration Table Mappings page.;
                                 NOR=Start alle standard integreringsprosjekter for synkronisering av Business Central-posttyper og Dynamics 365 for Sales-enheter, som definert pÜ siden Tilordninger for integreringstabell.;
                                 SVE=Starta alla standardintegreringsjobb fîr synkronisering av Business Central-posttyper och Dynamics 365 for Sales-enheter, enligt sidan Tabellmappningar.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled="Is Enabled For User";
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"CRM Full Synch. Review");
                               END;
                                }
      { 17      ;1   ;Action    ;
                      Name=Reset Web Client URL;
                      CaptionML=[ENU=Reset Web Client URL;
                                 NOR=Tilbakestill URL-adresse for webklient;
                                 SVE=èterstÑll webbklient-URL];
                      ToolTipML=[ENU=Undo your change and enter the default URL in the Business Central web Client URL field.;
                                 NOR=Angre endringen og oppgi standard URL-adresse i feltet URL-adresse for Business Central-klient.;
                                 SVE=èngra Ñndringen och ange standard-URL i fÑltet URL fîr Business Central-webbklient.];
                      ApplicationArea=#Suite;
                      Enabled=IsWebCliResetEnabled;
                      Image=ResetStatus;
                      OnAction=BEGIN
                                 PerformWebClientUrlReset;
                                 MESSAGE(WebClientUrlResetMsg,PRODUCTNAME.SHORT);
                               END;
                                }
      { 23      ;1   ;Action    ;
                      Name=SynchronizeNow;
                      CaptionML=[ENU=Synchronize Modified Records;
                                 NOR=Synkroniser endrede poster;
                                 SVE=Synkronisera Ñndrade poster];
                      ToolTipML=[ENU=Synchronize records that have been modified since the last time they were synchronized.;
                                 NOR=Synkroniser poster som har blitt endret siden forrige gang de ble synkronisert.;
                                 SVE=Synkronisera poster som har Ñndrats sedan den senaste synkroniseringen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled="Is Enabled For User";
                      PromotedIsBig=Yes;
                      Image=Refresh;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 IntegrationSynchJobList@1000 : Page 5338;
                               BEGIN
                                 IF NOT CONFIRM(SynchronizeModifiedQst) THEN
                                   EXIT;

                                 SynchronizeNow(FALSE);
                                 MESSAGE(SyncNowSuccessMsg,IntegrationSynchJobList.CAPTION);
                               END;
                                }
      { 9       ;1   ;Action    ;
                      Name=Generate Integration IDs;
                      CaptionML=[ENU=Generate Integration IDs;
                                 NOR=Generer integrerings-IDer;
                                 SVE=Generera integrerings-ID:n];
                      ToolTipML=[ENU=Create integration IDs for new records that were added while the connection was disabled, for example, after you re-enable a Dynamics 365 for Sales connection.;
                                 NOR=Opprett integrerings-ID-er for nye poster som ble lagt til mens tilkoblingen var deaktivert, for eksempel etter at du aktiverer en Dynamics 365 for Sales-tilkobling pÜ nytt.;
                                 SVE=Skapa integrations-ID:n fîr nya poster som har lagts till medan anslutningen var inaktiv, till exempel efter att en Dynamics 365 for Sales-anslutning har Üteraktiverats.];
                      ApplicationArea=#Suite;
                      Image=Reconcile;
                      OnAction=VAR
                                 IntegrationManagement@1000 : Codeunit 5150;
                               BEGIN
                                 IF CONFIRM(ConfirmGenerateIntegrationIdsQst,TRUE) THEN BEGIN
                                   IntegrationManagement.SetupIntegrationTables;
                                   MESSAGE(GenerateIntegrationIdsSuccessMsg);
                                 END;
                               END;
                                }
      { 14      ;    ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 19      ;1   ;Action    ;
                      Name=Integration Table Mappings;
                      CaptionML=[ENU=Integration Table Mappings;
                                 NOR=Tilordninger for integreringstabell;
                                 SVE=Tabellmappningar fîr integrering];
                      ToolTipML=[ENU=View entries that map integration tables to business data tables in Business Central. Integration tables are set up to act as interfaces for synchronizing data between an external database table, such as Dynamics 365 for Sales, and a corresponding business data table in Business Central.;
                                 NOR=Vis poster som tilordner integreringstabeller til forretningsdatatabeller i Business Central. Integreringstabeller blir satt opp for Ü fungere som grensesnitt for synkronisering av data mellom en ekstern databasetabell, for eksempel Dynamics 365 for Sales, og en tilhõrende forretningsdatatabell i Business Central.;
                                 SVE=Visa poster som mappar integrationstabeller till affÑrsdatatabeller i Business Central. Integrationstabeller fungerar som grÑnssnitt fîr synkronisering av data mellan en extern databastabell, till exempel Dynamics 365 for Sales, och en motsvarande affÑrsdatatabell i Business Central.];
                      ApplicationArea=#Suite;
                      RunObject=Page 5335;
                      Promoted=Yes;
                      Image=Relationship;
                      PromotedCategory=Report;
                      RunPageMode=Edit }
      { 12      ;1   ;Action    ;
                      Name=Synch. Job Queue Entries;
                      CaptionML=[ENU=Synch. Job Queue Entries;
                                 NOR=Synk. poster i jobbkõ;
                                 SVE=Synk. jobbkîtransaktioner];
                      ToolTipML=[ENU=View the job queue entries that manage the scheduled synchronization between Dynamics 365 for Sales and Business Central.;
                                 NOR=Vis prosjektkõposter som administrerer den planlagte synkroniseringen mellom Dynamics 365 for Sales og Business Central.;
                                 SVE=Visa jobbkîtransaktioner som hanterar den schemalagda synkroniseringen mellan Dynamics 365 for Sales och Business Central.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=JobListSetup;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 JobQueueEntry@1000 : Record 472;
                               BEGIN
                                 JobQueueEntry.FILTERGROUP := 2;
                                 JobQueueEntry.SETRANGE("Object Type to Run",JobQueueEntry."Object Type to Run"::Codeunit);
                                 JobQueueEntry.SETFILTER("Object ID to Run",GetJobQueueEntriesObjectIDToRunFilter);
                                 JobQueueEntry.FILTERGROUP := 0;

                                 PAGE.RUN(PAGE::"Job Queue Entries",JobQueueEntry);
                               END;
                                }
      { 29      ;1   ;Action    ;
                      Name=SkippedSynchRecords;
                      CaptionML=[ENU=Skipped Synch. Records;
                                 NOR=Hoppet over synkroniserte poster;
                                 SVE=Hoppade îver Synkronisera poster];
                      ToolTipML=[ENU=View the list of records that will be skipped for synchronization.;
                                 NOR=Vis listen over poster som blir hoppet over for synkronisering.;
                                 SVE=Visa listan med poster som hoppas îver vid synkronisering.];
                      ApplicationArea=#Suite;
                      RunObject=Page 5333;
                      Promoted=Yes;
                      Enabled="Is Enabled";
                      Image=NegativeLines;
                      PromotedCategory=Category4;
                      RunPageMode=View }
      { 6       ;1   ;Action    ;
                      Name=EncryptionManagement;
                      CaptionML=[ENU=Encryption Management;
                                 NOR=Krypteringsadministrasjon;
                                 SVE=Krypteringshantering];
                      ToolTipML=[ENU=Enable or disable data encryption. Data encryption helps make sure that unauthorized users cannot read business data.;
                                 NOR=Aktiver eller deaktiver datakryptering. Datakryptering sõrger for at uautoriserte brukere ikke kan lese forretningsdata.;
                                 SVE=Aktivera eller inaktivera datakryptering. Om du anvÑnder datakryptering kan obehîriga anvÑndare inte lÑsa fîretagets information.];
                      ApplicationArea=#Advanced;
                      RunObject=Page 9905;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EncryptionKeys;
                      PromotedCategory=Category5;
                      RunPageMode=View }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=NAVToCRM;
                CaptionML=[ENU=Connection from Dynamics 365 Business Central to Dynamics 365 for Sales;
                           NOR=Tilkobling fra Dynamics 365 Business Central til Dynamics 365 for Sales;
                           SVE=Anslutning frÜn Dynamics 365 Business Central till Dynamics 365 for Sales];
                GroupType=Group }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the URL of the Dynamics 365 for Sales server that hosts the Dynamics 365 for Sales solution that you want to connect to.;
                           NOR=Angir URL-adressen til Dynamics 365 for Sales-serveren som drifter Dynamics 365 for Sales-lõsningen du vil koble til.;
                           SVE=Anger URL:en till Dynamics 365 for Sales-servern som Ñr vÑrd fîr Dynamics 365 for Sales-lîsningen som du vill ansluta till.];
                ApplicationArea=#Suite;
                SourceExpr="Server Address";
                Editable=IsEditable;
                OnValidate=BEGIN
                             ConnectionString := GetConnectionString;
                           END;
                            }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the user name of a Dynamics 365 for Sales account.;
                           NOR=Angir brukernavnet for en konto for Dynamics 365 for Sales.;
                           SVE=Anger anvÑndarnamnet fîr ett Dynamics 365 for Sales-konto.];
                ApplicationArea=#Suite;
                SourceExpr="User Name";
                Editable=IsEditable;
                OnValidate=BEGIN
                             ConnectionString := GetConnectionString;
                           END;
                            }

    { 7   ;2   ;Field     ;
                Name=Password;
                ExtendedDatatype=Masked;
                ToolTipML=[ENU=Specifies the password of a Dynamics 365 for Sales user account.;
                           NOR=Angir passordet for en brukerkonto for Dynamics 365 for Sales.;
                           SVE=Anger lîsenordet fîr ett anvÑndarkonto i Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr=CRMPassword;
                Enabled=IsEditable;
                OnValidate=BEGIN
                             IF (CRMPassword <> '') AND (NOT ENCRYPTIONENABLED) THEN
                               IF CONFIRM(EncryptionIsNotActivatedQst) THEN
                                 PAGE.RUNMODAL(PAGE::"Data Encryption Management");
                             SetPassword(CRMPassword);
                           END;
                            }

    { 11  ;2   ;Field     ;
                CaptionML=[@@@=Name of tickbox which shows whether the connection is enabled or disabled;
                           ENU=Enabled;
                           NOR=Aktivert;
                           SVE=Aktiv];
                ToolTipML=[ENU=Specifies if the connection to Dynamics 365 for Sales is enabled.;
                           NOR=Angir om tilkoblingen til Dynamics 365 for Sales er aktivert.;
                           SVE=Anger om anslutningen till Dynamics 365 for Sales har aktiverats.];
                ApplicationArea=#Suite;
                SourceExpr="Is Enabled";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 22  ;2   ;Field     ;
                Name=ScheduledSynchJobsActive;
                CaptionML=[ENU=Active scheduled synchronization jobs;
                           NOR=Aktive planlagte synkroniseringsjobber;
                           SVE=Aktiva schemalagda synkroniseringsjobb];
                ToolTipML=[ENU=Specifies how many of the default integration synchronization job queue entries ready to automatically synchronize data between Dynamics 365 and Dynamics 365 for Sales.;
                           NOR=Angir hvor mange av prosjektkõoppfõringene for standard integreringssynkronisering som er klar til Ü synkronisere data automatisk mellom Dynamics 365 og Dynamics 365 for Sales.;
                           SVE=Anger hur mÜnga av de fîrvalda jobbkîtransaktionerna fîr integrationssynkronisering som Ñr redo fîr automatiskt synkronisering mellan Dynamics 365 och Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr=ScheduledSynchJobsRunning;
                Editable=false;
                StyleExpr=ScheduledSynchJobsRunningStyleExpr;
                OnDrillDown=VAR
                              ScheduledSynchJobsRunningMsg@1000 : Text;
                            BEGIN
                              IF TotalJobs = 0 THEN
                                ScheduledSynchJobsRunningMsg := JobQueueIsNotRunningMsg
                              ELSE
                                IF ActiveJobs = TotalJobs THEN
                                  ScheduledSynchJobsRunningMsg := AllScheduledJobsAreRunningMsg
                                ELSE
                                  ScheduledSynchJobsRunningMsg := STRSUBSTNO(PartialScheduledJobsAreRunningMsg,ActiveJobs,TotalJobs);
                              MESSAGE(ScheduledSynchJobsRunningMsg);
                            END;
                             }

    { 33  ;2   ;Field     ;
                Name=SDKVersion;
                AssistEdit=Yes;
                CaptionML=[ENU=Dynamics 365 SDK Version;
                           NOR=Dynamics 365 SDK-versjon;
                           SVE=SDK-version fîr Dynamics 365];
                ToolTipML=[ENU=Specifies the Microsoft Dynamics 365 (CRM) software development kit version that is used to connect to Dynamics 365 for Sales.;
                           NOR=Angir Microsoft Dynamics 365 (CRM) SDK-versjonen som brukes til Ü koble til Dynamics 365 for Sales.;
                           SVE=Anger den SDK-version fîr Microsoft Dynamics 365 (CRM) som anvÑnds fîr att ansluta till Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr="Proxy Version";
                Enabled=IsEditable;
                Editable=FALSE;
                OnAssistEdit=VAR
                               TempStack@1000 : TEMPORARY Record 9160;
                             BEGIN
                               IF PAGE.RUNMODAL(PAGE::"SDK Version List",TempStack) = ACTION::LookupOK THEN BEGIN
                                 VALIDATE("Proxy Version",TempStack.StackOrder);
                                 ConnectionString := GetConnectionString;
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 8   ;1   ;Group     ;
                Name=CRMToNAV;
                CaptionML=[ENU=Connection from Dynamics 365 for Sales to Dynamics 365 Business Central;
                           NOR=Tilkobling fra Dynamics 365 for Salesˇtil Dynamics 365 Business Central;
                           SVE=Anslutning frÜn Dynamics 365 for Sales till Dynamics 365 Business Central];
                Visible="Is Enabled";
                GroupType=Group }

    { 16  ;2   ;Field     ;
                Name=NAVURL;
                CaptionML=[ENU=Dynamics 365 Business Central Web Client URL;
                           NOR=URL-adresse for webklient for Dynamics 365 Business Central;
                           SVE=URL fîr Dynamics 365 Business Central Web Client];
                ToolTipML=[ENU=Specifies the URL to the Business Central web client. From records in Dynamics 365 for Sales, such as an account or product, users can open a corresponding (coupled) record in Business Central. Set this field to the URL of the Business Central web client instance to use.;
                           NOR="Angir URL-adressen for webklienten for Business Central. Fra poster i Dynamics 365 for Sales, for eksempel en konto eller et produkt, kan brukere Üpne en tilsvarende (koblet) post i Business Central. Sett dette feltet til URL-adressen for grensesnittet som skal brukes i webklienten for Business Central. ";
                           SVE=Anger URL:en till webbklienten fîr Business Central. FrÜn poster i Dynamics 365 for Sales, till exempel ett konto eller en produkt, kan anvÑndarna îppna en motsvarande (kopplad) post i Business Central. Ange det hÑr fÑltet till URL:en fîr den instans av webbklienten fîr Business Central som ska anvÑndas.];
                ApplicationArea=#Suite;
                SourceExpr="Dynamics NAV URL";
                Enabled="Is CRM Solution Installed" }

    { 28  ;2   ;Field     ;
                Name=ItemAvailabilityWebServEnabled;
                CaptionML=[ENU=Item Availability Web Service Enabled;
                           NOR=Webtjenesten Varetilgjengelighet er aktivert;
                           SVE=WebbtjÑnsten Artikeldisposition har aktiverats];
                ToolTipML=[ENU=Specifies that the Item Availability web service for Business Central is enabled.;
                           NOR=Angir at webtjenesten Varetilgjengelighet for BusinessˇCentral er aktivert.;
                           SVE=Anger att webbtjÑnsten Artikeldisposition fîr Business Central har aktiverats.];
                ApplicationArea=#Suite;
                SourceExpr=WebServiceEnabled;
                Editable=FALSE;
                StyleExpr=WebServiceEnabledStyleExpr;
                OnDrillDown=VAR
                              CRMIntegrationManagement@1000 : Codeunit 5330;
                            BEGIN
                              IF WebServiceEnabled THEN
                                CRMIntegrationManagement.UnPublishOnWebService(Rec)
                              ELSE
                                CRMIntegrationManagement.PublishWebService(Rec);
                              CurrPage.UPDATE(TRUE);
                            END;
                             }

    { 34  ;2   ;Field     ;
                ApplicationArea=#Suite }

    { 24  ;2   ;Field     ;
                Name=NAVODataURL;
                CaptionML=[ENU=Dynamics 365 Business Central OData Web Service URL;
                           NOR=URL-adresse for webtjenesten OData for Dynamics 365 Business Central;
                           SVE=URL fîr OData-webbtjÑnsten fîr Dynamics 365 Business Central];
                ToolTipML=[ENU=Specifies the URL of Business Central OData web services. From sales order records in Dynamics 365 for Sales, users can retrieve item availability information for items in Business Central that are coupled to sales order detail records in Dynamics 365 for Sales. Set this field to the URL of the Business Central OData web services to use.;
                           NOR=Angir URL-adressen for webtjenestene for OData for Business Central. Fra ordreposter i Dynamics 365 for Sales kan brukere hente informasjon om varetilgjengelighet for varer i Business Central som er koblet til poster for salgsordredetaljer i Dynamics 365 for Sales. Angi URL-adressen for webtjenestene for OData for Business Central som skal brukes, i dette feltet.;
                           SVE=Anger URL:en till OData-webbtjÑnster fîr Business Central. FrÜn fîrsÑljningsorderposter i Dynamics 365 for Sales kan anvÑndarna hÑmta artikeldispositionsinformation fîr Business Central-artiklar som Ñr kopplade till fîrsÑljningsorderinformationsposter i Dynamics 365 for Sales. Ange det hÑr fÑltet till URL:en fîr de OData-webbtjÑnster fîr Business Central som ska anvÑndas.];
                ApplicationArea=#Suite;
                SourceExpr="Dynamics NAV OData URL";
                Enabled="Is CRM Solution Installed" }

    { 31  ;2   ;Field     ;
                Name=NAVODataUsername;
                Lookup=Yes;
                CaptionML=[ENU=Dynamics 365 Business Central OData Web Service Username;
                           NOR=Brukernavnˇfor webtjenesten OData for Dynamics 365 Business Central;
                           SVE=AnvÑndarnamn fîr OData-webbtjÑnsten fîr Dynamics 365 Business Central];
                ToolTipML=[ENU=Specifies the user name to access Dynamics 365 OData web services.;
                           NOR=Angir brukernavnet for Ü fÜ tilgang til webtjenestene for Dynamics 365 OData.;
                           SVE=Anger anvÑndarnamnet som anvÑnds fîr att fÜ tillgÜng till OData-webbtjÑnster fîr Dynamics 365.];
                ApplicationArea=#Suite;
                SourceExpr="Dynamics NAV OData Username";
                Enabled="Is CRM Solution Installed";
                LookupPageID=Users }

    { 32  ;2   ;Field     ;
                Name=NAVODataAccesskey;
                CaptionML=[ENU=Dynamics 365 Business Central OData Web Service Accesskey;
                           NOR=Tilgangsnõkkelˇfor webtjenesten OData for Dynamics 365 Business Central;
                           SVE=ètkomstnyckel fîr OData-webbtjÑnsten fîr Dynamics 365 Business Central];
                ToolTipML=[ENU=Specifies the access key to access Dynamics 365 OData web services.;
                           NOR=Angir tilgangsnõkkelen for Ü fÜ tilgang til webtjenestene for Dynamics 365 OData.;
                           SVE=Anger Ütkomstnyckeln som anvÑnds fîr att fÜ tillgÜng till OData-webbtjÑnster fîr Dynamics 365.];
                ApplicationArea=#Suite;
                SourceExpr="Dynamics NAV OData Accesskey";
                Enabled="Is CRM Solution Installed";
                Editable=FALSE }

    { 20  ;1   ;Group     ;
                Name=CRMSettings;
                CaptionML=[ENU=Dynamics 365 for Sales Settings;
                           NOR=Innstillinger for Dynamics 365 for Sales;
                           SVE=Dynamics 365 for Sales-instÑllningar];
                Visible="Is Enabled";
                GroupType=Group }

    { 25  ;2   ;Field     ;
                CaptionML=[ENU=Version;
                           NOR=Versjon;
                           SVE=Version];
                ToolTipML=[ENU=Specifies the version of Dynamics 365 for Sales.;
                           NOR=Angir versjonen av Dynamics 365 for Sales.;
                           SVE=Anger versionen av Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr="CRM Version";
                Editable=FALSE;
                StyleExpr=CRMVersionStyleExpr;
                OnDrillDown=BEGIN
                              IF IsVersionValid THEN
                                MESSAGE(FavorableCRMVersionMsg,CRMProductName.SHORT)
                              ELSE
                                MESSAGE(UnfavorableCRMVersionMsg,PRODUCTNAME.SHORT,CRMProductName.SHORT);
                            END;
                             }

    { 15  ;2   ;Field     ;
                CaptionML=[ENU=Dynamics 365 Business Central Integration Solution Imported;
                           NOR=Lõsning for integrering av Dynamics 365 Business Central ble importert;
                           SVE=Integreringslîsning fîr Dynamics 365 Business Central har importerats];
                ToolTipML=[ENU=Specifies if the Integration Solution is installed and configured in Dynamics 365 for Sales. You cannot change this setting.;
                           NOR=Angir om integreringslõsningen er installert og konfigurert i Dynamics 365 for Sales. Du kan ikke endre denne innstillingen.;
                           SVE=Anger om integreringslîsningen Ñr installerad och konfigurerad i Dynamics 365 for Sales. Du kan inte Ñndra den hÑr instÑllningen.];
                ApplicationArea=#Suite;
                SourceExpr="Is CRM Solution Installed";
                Editable=FALSE;
                StyleExpr=CRMSolutionInstalledStyleExpr;
                OnDrillDown=BEGIN
                              IF "Is CRM Solution Installed" THEN
                                MESSAGE(FavorableCRMSolutionInstalledMsg,PRODUCTNAME.SHORT,CRMProductName.SHORT)
                              ELSE
                                MESSAGE(UnfavorableCRMSolutionInstalledMsg,PRODUCTNAME.SHORT);
                            END;
                             }

    { 21  ;2   ;Field     ;
                CaptionML=[ENU=Sales Order Integration Enabled;
                           NOR=Ordreintegrering er aktivert;
                           SVE=FîrsÑljningsorderintegrering har aktiverats];
                ToolTipML=[ENU=Specifies that it is possible for Dynamics 365 for Sales users to submit sales orders that can then be viewed and imported in Dynamics 365.;
                           NOR=Angir at det er mulig for Dynamics 365 for Sales-brukere Ü sende ordrer som senere kan vises og importeres i Dynamics 365.;
                           SVE=Anger att det Ñr mîjligt fîr Dynamics 365 for Sales-anvÑndare att skicka fîrsÑljningsorder som sedan kan visas och importeras i Dynamics 365.];
                ApplicationArea=#Suite;
                SourceExpr="Is S.Order Integration Enabled";
                OnValidate=BEGIN
                             SetAutoCreateSalesOrdersEditable;
                           END;
                            }

    { 40  ;2   ;Field     ;
                CaptionML=[ENU=Automatically Create Sales Orders;
                           NOR=Opprett ordrer automatisk;
                           SVE=Skapa fîrsÑljningsorder automatiskt];
                ToolTipML=[ENU=Specifies that sales orders will be created automatically from sales orders that are submitted in Dynamics 365 for Sales.;
                           NOR=Angir at ordrer opprettes automatisk fra ordrer som sendes i Dynamics 365 for Sales.;
                           SVE=Anger att fîrsÑljningsorder skapas automatiskt frÜn fîrsÑljningsorder som skickas i Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr="Auto Create Sales Orders";
                Editable=IsAutoCreateSalesOrdersEditable }

    { 43  ;2   ;Field     ;
                CaptionML=[ENU=Automatically Process Sales Quotes;
                           NOR=Behandle salgstilbud automatisk;
                           SVE=Bearbeta fîrsÑljningsofferter automatiskt];
                ToolTipML=[ENU=Specifies that sales quotes will be automatically processed on sales quotes creation/revision/winning submitted in Dynamics 365 for Sales quotes entities.;
                           NOR=Angir at salgstilbud behandles automatisk under oppretting/revisjon/inngÜelse av salgstilbud som ble sendt inn i tilbudsenheter i Dynamics 365 for Sales.;
                           SVE=Anger att fîrsÑljningsofferter ska bearbetas automatiskt fîr fîrsÑljningsofferter som skapas/Ñndras/vinns nÑr de skickas i Dynamics 365 for Sales-offertenheter.];
                ApplicationArea=#Suite;
                SourceExpr="Auto Process Sales Quotes" }

    { 26  ;1   ;Group     ;
                Name=AdvancedSettings;
                CaptionML=[ENU=Advanced Settings;
                           NOR=Avanserte innstillinger;
                           SVE=Avancerade instÑllningar];
                Visible="Is Enabled";
                GroupType=Group }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that Dynamics 365 users must have a matching user account in Dynamics 365 for Sales to have Dynamics 365 for Sales integration capabilities in the user interface.;
                           NOR=Angir at Dynamics 365-brukere mÜ ha en samsvarende brukerkonto i Dynamics 365 for Sales for Ü kunne ha integreringsegenskaper i Dynamics 365 for Sales i brukergrensesnittet.;
                           SVE=Anger att Dynamics 365-anvÑndare mÜste ha ett motsvarande anvÑndarkonto i Dynamics 365 for Sales fîr att fÜ tillgÜng till funktioner fîr Dynamics 365 for Sales-integration i anvÑndargrÑnssnittet.];
                ApplicationArea=#Suite;
                SourceExpr="Is User Mapping Required";
                OnValidate=BEGIN
                             UpdateIsEnabledState;
                             SetStyleExpr;
                           END;
                            }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Current Business Central User is Mapped to a Dynamics 365 for Sales User;
                           NOR=Gjeldende Business Central-bruker er tilordnet til en Dynamics 365 for Sales-bruker;
                           SVE=Nuvarande Business Central-anvÑndare mappas till en Dynamics 365 for Sales-anvÑndare];
                ToolTipML=[ENU=Specifies that the user account that you used to sign in with has a matching user account in Dynamics 365 for Sales.;
                           NOR=Angir at brukerkontoen du brukte til Ü logge pÜ med, har en samsvarende brukerkonto i Dynamics 365 for Sales.;
                           SVE=Anger att anvÑndarkontot som du anvÑnde fîr att logga in med har ett motsvarande anvÑndarkonto i Dynamics 365 for Sales.];
                ApplicationArea=#Suite;
                SourceExpr="Is User Mapped To CRM User";
                Visible="Is User Mapping Required";
                Editable=FALSE;
                StyleExpr=UserMappedToCRMUserStyleExpr;
                OnDrillDown=BEGIN
                              IF "Is User Mapped To CRM User" THEN
                                MESSAGE(CurrentuserIsMappedToCRMUserMsg,USERID,PRODUCTNAME.SHORT,CRMProductName.SHORT)
                              ELSE
                                MESSAGE(CurrentuserIsNotMappedToCRMUserMsg,USERID,PRODUCTNAME.SHORT,CRMProductName.SHORT);
                            END;
                             }

    { 42  ;2   ;Field     ;
                CaptionML=[ENU=Open Coupled Entities in Dynamics 365 Sales Hub;
                           NOR=èpne koblede enheter i Dynamics 365-salgshub;
                           SVE=ôppna kopplade enheter i fîrsÑljningshubben fîr Dynamics 365];
                ToolTipML=[ENU=Specifies that coupled Dynamics 365 for Sales entities should open in Sales Hub.;
                           NOR=Angir at koblede enheter i Dynamics 365 for Sales skal Üpnes i salgshuben.;
                           SVE=Anger att de kopplade Dynamics 365 for Sales-enheterna ska îppnas i fîrsÑljningshubben.];
                ApplicationArea=#Suite;
                SourceExpr="Use Newest UI" }

    { 30  ;2   ;Field     ;
                ApplicationArea=#Suite }

    { 36  ;1   ;Group     ;
                Name=AuthTypeDetails;
                CaptionML=[ENU=Authentication Type Details;
                           NOR=Detaljer for godkjenningstype;
                           SVE=Information om autentiseringstyp];
                Visible=NOT SoftwareAsAService;
                GroupType=Group }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the authentication type that will be used to authenticate with Dynamics 365 for Sales;
                           NOR=Angir godkjenningstypen som blir brukt til godkjenning med Dynamics 365 for Sales;
                           SVE=Anger autentiseringstypen som autentiserar med Dynamics 365 for Sales];
                ApplicationArea=#Advanced;
                SourceExpr="Authentication Type";
                Editable=NOT "Is Enabled";
                OnValidate=BEGIN
                             SetIsConnectionStringEditable;
                             ConnectionString := GetConnectionString;
                           END;
                            }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the domain name of your Dynamics 365 for Sales deployment.;
                           NOR=Angir domenenavnet for din distribusjon av Dynamics 365 for Sales.;
                           SVE=Anger Dynamics 365 for Sales-distributionens domÑnnamn.];
                ApplicationArea=#Advanced;
                SourceExpr=Domain }

    { 38  ;2   ;Field     ;
                Name=Connection String;
                CaptionML=[ENU=Connection String;
                           NOR=Tilkoblingsstreng;
                           SVE=AnslutningsstrÑng];
                ToolTipML=[ENU=Specifies the connection string that will be used to connect to Dynamics 365 for Sales;
                           NOR=Angir tilkoblingsstrengen som blir brukt til tilkobling til Dynamics 365 for Sales;
                           SVE=Anger anslutningsstrÑngen som anvÑnds vid anslutning till Dynamics 365 for Sales];
                ApplicationArea=#Advanced;
                SourceExpr=ConnectionString;
                Editable=IsConnectionStringEditable;
                OnValidate=BEGIN
                             SetConnectionString(ConnectionString);
                           END;
                            }

  }
  CODE
  {
    VAR
      AssistedSetup@1010 : Record 1803;
      CRMProductName@1017 : Codeunit 5344;
      CRMPassword@1000 : Text;
      ResetIntegrationTableMappingConfirmQst@1003 : TextConst '@@@="%1 = CRM product name";ENU=This will delete all existing integration table mappings and %1 synchronization jobs and install the default integration table mappings and jobs for %1 synchronization.\\Are you sure that you want to continue?;NOR=Dette sletter alle eksisterende tilordninger for integreringstabeller og %1-synkroniseringsjobber, og installerer standard tilordninger for integreringstabeller og jobber for %1-synkronisering.\\Er du sikker pÜ at du vil fortsette?;SVE=Detta tar bort alla befintliga integreringstabellmappningar och %1-synkroniseringsjobb och installerar standardvalda integreringstabellmappningar och jobb fîr synkronisering i %1.\\Vill du fortsÑtta?';
      ConfirmGenerateIntegrationIdsQst@1006 : TextConst 'ENU=You are about to add integration data to tables. This process may take several minutes. Do you want to continue?;NOR=Du er i ferd med Ü legge til integreringsdata i tabellene. Denne prosessen kan ta flere minutter. Vil du fortsette?;SVE=Du Ñr pÜ vÑg att lÑgga till integreringsdata i tabellerna. Det kan ta flera minuter. Vill du fortsÑtta?';
      GenerateIntegrationIdsSuccessMsg@1005 : TextConst 'ENU=The integration data has been added to the tables.;NOR=Integreringsdataene er lagt til i tabellene.;SVE=Integreringsdata har lagts till i tabellerna.';
      EncryptionIsNotActivatedQst@1016 : TextConst 'ENU=Data encryption is currently not enabled. We recommend that you encrypt data. \Do you want to open the Data Encryption Management window?;NOR=Datakryptering er for õyeblikket ikke aktivert. Det anbefales at du krypterer data. \Vil du Üpne vinduet Administrasjon av datakryptering?;SVE=Datakryptering har inte aktiverats. Vi rekommenderar att du krypterar data. \Vill du îppna fînstret Datakrypteringshantering?';
      WebClientUrlResetMsg@1014 : TextConst '@@@=%1 - product name;ENU=The %1 Web Client URL has been reset to the default value.;NOR=URL-adressen for %1-webklienten er tilbakestilt til standardverdien.;SVE=%1-webbklient-URL ÜterstÑllt till standardvÑrdet.';
      SyncNowSuccessMsg@1018 : TextConst '@@@="%1 = Page 5338 Caption";ENU=Synchronize Modified Records completed.\See the %1 window for details.;NOR=Synkronisering av endrede poster er fullfõrt.\Se %1-vinduet for Ü fÜ flere detaljer.;SVE=Synkronisera Ñndrade poster har utfîrts.\Se fînstret %1 fîr mer information.';
      UnfavorableCRMVersionMsg@1033 : TextConst '@@@="%1 - product name, %2 = CRM product name";ENU=This version of %2 might not work correctly with %1. We recommend you upgrade to a supported version.;NOR=Denne versjonen av %2 fungerer kanskje ikke med %1. Vi anbefaler at du oppgraderer til en versjon som stõttes.;SVE=Den hÑr versionen av %2 kanske inte fungerar korrekt med %1. Vi rekommenderar att du uppgraderar till en version med stîd.';
      FavorableCRMVersionMsg@1034 : TextConst '@@@="%1 = CRM product name";ENU=The version of %1 is valid.;NOR=Denne versjonen av %1 er gyldig.;SVE=Versionen av %1 Ñr giltig.';
      UnfavorableCRMSolutionInstalledMsg@1036 : TextConst '@@@=%1 - product name;ENU=The %1 Integration Solution was not detected.;NOR=Integreringslõsningen for %1 ble ikke gjenkjent.;SVE=Det gick inte att hitta integreringslîsningen fîr %1.';
      FavorableCRMSolutionInstalledMsg@1037 : TextConst '@@@="%1 - product name, %2 = CRM product name";ENU=The %1 Integration Solution is installed in %2.;NOR=Integreringslõsningen for %1 er installert i %2.;SVE=Integreringslîsningen fîr %1 Ñr installerad i %2.';
      SynchronizeModifiedQst@1038 : TextConst 'ENU=This will synchronize all modified records in all Integration Table Mappings.\\Do you want to continue?;NOR=Dette vil synkronisere alle endrede poster i alle tilordninger for integreringstabell.\\Vil du fortsette?;SVE=Detta synkroniserar alla Ñndrade poster i alla tabellmappningar fîr integrering.\\Vill du fortsÑtta?';
      ReadyScheduledSynchJobsTok@1049 : TextConst '@@@="%1 = Count of scheduled job queue entries in ready or in process state, %2 count of all scheduled jobs";ENU=%1 of %2;NOR=%1 av %2;SVE=%1 av %2';
      ScheduledSynchJobsRunning@1002 : Text;
      CurrentuserIsMappedToCRMUserMsg@1053 : TextConst '@@@="%1 = Current User ID, %2 - product name, %3 = CRM product name";ENU=%2 user (%1) is mapped to a %3 user.;NOR=%2-brukeren (%1) er tilordnet til en %3-bruker.;SVE=%2-anvÑndaren (%1) Ñr kopplad till en %3-anvÑndare.';
      CurrentuserIsNotMappedToCRMUserMsg@1054 : TextConst '@@@="%1 = Current User ID, %2 - product name, %3 = CRM product name";ENU=Because the %2 Users Must Map to %3 Users field is set, %3 integration is not enabled for %1.\\To enable %3 integration for %2 user %1, the authentication email must match the primary email of a %3 user.;NOR=Ettersom feltet %2-brukere mÜ samordne med %3-brukere er angitt, er %3-integrering ikke aktivert for %1.\\For at %3-integrering skal kunne aktiveres for %2-brukeren %1, mÜ e-postadressen for godkjenning samsvare med den primëre e-postadressen til en %3-bruker.;SVE=Eftersom fÑltet %2-anvÑndare mÜste mappa till %3-anvÑndare har stÑllts in, Ñr %3-integrering inte aktiverat fîr %1.\\.Om du vill aktivera %3-integrering fîr %2-anvÑndaren %1 mÜste e-postadressen fîr autentisering matcha den primÑra e-postadressen fîr en %3-anvÑndare.';
      EnableServiceQst@1057 : TextConst '@@@="%1 = This Page Caption (Microsoft Dynamics 365 Connection Setup)";ENU=The %1 is not enabled. Are you sure you want to exit?;NOR=%1 er ikke aktivert. Er du sikker pÜ at du vil avslutte?;SVE=%1 har inte aktiverats. Vill du avsluta?';
      PartialScheduledJobsAreRunningMsg@1046 : TextConst '@@@="%1 = Count of scheduled job queue entries in ready or in process state, %2 count of all scheduled jobs";ENU=An active job queue is available but only %1 of the %2 scheduled synchronization jobs are ready or in process.;NOR=En aktiv prosjektkõ er tilgjengelig, men bare %1 av %2 planlagte synkroniseringsjobber er klare eller pÜgÜr.;SVE=En aktiv jobbkî Ñr tillgÑnglig men bara %1 av %2 schemalagda synkroniseringsjobb Ñr klara eller under bearbetning.';
      JobQueueIsNotRunningMsg@1048 : TextConst 'ENU=There is no job queue started. Scheduled synchronization jobs require an active job queue to process jobs.\\Contact your administrator to get a job queue configured and started.;NOR=Det er ikke startet noen jobbkõ. Planlagte synkroniseringsjobber krever en aktiv jobbkõ for Ü behandle jobber.\\Kontakt administratoren for Ü fÜ konfigurert og startet en jobbkõ.;SVE=Ingen jobbkî har startat. Schemalagda synkroniseringsjobb krÑver en aktiv jobbkî fîr att bearbeta jobb.\\Kontakta administratîren om du vill konfigurera och starta en jobbkî.';
      AllScheduledJobsAreRunningMsg@1045 : TextConst 'ENU=An job queue is started and all scheduled synchronization jobs are ready or already processing.;NOR=En jobbkõ er startet, og alle planlagte synkroniseringsjobber er klare eller pÜgÜr allerede.;SVE=En jobbkî har startats och alla schemalagda synkroniseringsjobb Ñr klara eller bearbetas redan.';
      SetupSuccessfulMsg@1001 : TextConst '@@@="%1 = CRM product name";ENU=The default setup for %1 synchronization has completed successfully.;NOR=Standardoppsettet for %1-synkronisering er fullfõrt.;SVE=Standardkonfigurationen fîr %1-synkroniseringen har slutfîrts.';
      ScheduledSynchJobsRunningStyleExpr@1011 : Text;
      CRMSolutionInstalledStyleExpr@1012 : Text;
      CRMVersionStyleExpr@1013 : Text;
      UserMappedToCRMUserStyleExpr@1019 : Text;
      ConnectionString@1020 : Text;
      WebServiceEnabledStyleExpr@1024 : Text;
      ActiveJobs@1007 : Integer;
      TotalJobs@1004 : Integer;
      IsEditable@1008 : Boolean;
      IsWebCliResetEnabled@1009 : Boolean;
      AssistedSetupAvailable@1058 : Boolean;
      SoftwareAsAService@1015 : Boolean;
      IsConnectionStringEditable@1022 : Boolean;
      IsAutoCreateSalesOrdersEditable@1021 : Boolean;
      WebServiceEnabled@1023 : Boolean;

    LOCAL PROCEDURE RefreshData@19();
    BEGIN
      UpdateIsEnabledState;
      SetIsConnectionStringEditable;
      RefreshDataFromCRM;
      SetAutoCreateSalesOrdersEditable;
      RefreshSynchJobsData;
      UpdateEnableFlags;
      IF NOT WebServiceEnabled THEN
        CLEAR("Dynamics NAV OData URL");
      SetStyleExpr;
    END;

    LOCAL PROCEDURE RefreshSynchJobsData@20();
    BEGIN
      CountCRMJobQueueEntries(ActiveJobs,TotalJobs);
      ScheduledSynchJobsRunning := STRSUBSTNO(ReadyScheduledSynchJobsTok,ActiveJobs,TotalJobs);
      ScheduledSynchJobsRunningStyleExpr := GetRunningJobsStyleExpr;
    END;

    LOCAL PROCEDURE SetStyleExpr@9();
    BEGIN
      CRMSolutionInstalledStyleExpr := GetStyleExpr("Is CRM Solution Installed");
      CRMVersionStyleExpr := GetStyleExpr(IsVersionValid);
      UserMappedToCRMUserStyleExpr := GetStyleExpr("Is User Mapped To CRM User");
      WebServiceEnabledStyleExpr := GetStyleExpr(WebServiceEnabled);
    END;

    LOCAL PROCEDURE SetIsConnectionStringEditable@4();
    BEGIN
      IsConnectionStringEditable :=
        NOT "Is Enabled";
    END;

    LOCAL PROCEDURE SetAutoCreateSalesOrdersEditable@2();
    BEGIN
      IsAutoCreateSalesOrdersEditable := "Is S.Order Integration Enabled";
    END;

    LOCAL PROCEDURE GetRunningJobsStyleExpr@1() StyleExpr : Text;
    BEGIN
      IF ActiveJobs < TotalJobs THEN
        StyleExpr := 'Ambiguous'
      ELSE
        StyleExpr := GetStyleExpr((ActiveJobs = TotalJobs) AND (TotalJobs <> 0))
    END;

    LOCAL PROCEDURE GetStyleExpr@6(Favorable@1000 : Boolean) StyleExpr : Text;
    BEGIN
      IF Favorable THEN
        StyleExpr := 'Favorable'
      ELSE
        StyleExpr := 'Unfavorable'
    END;

    LOCAL PROCEDURE UpdateEnableFlags@3();
    VAR
      CRMIntegrationManagement@1000 : Codeunit 5330;
    BEGIN
      IsEditable := NOT "Is Enabled";
      IsWebCliResetEnabled := "Is CRM Solution Installed" AND "Is Enabled For User";
      WebServiceEnabled := CRMIntegrationManagement.IsItemAvailabilityWebServiceEnabled;
    END;

    LOCAL PROCEDURE InitializeDefaultProxyVersion@5();
    VAR
      CRMIntegrationManagement@1000 : Codeunit 5330;
    BEGIN
      VALIDATE("Proxy Version",CRMIntegrationManagement.GetLastProxyVersionItem);
    END;

    BEGIN
    {
      4PS PD(Metx) 20-12-2017 4PS-Xrm integration changes - added Authentication type options
    }
    END.
  }
}

