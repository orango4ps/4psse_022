OBJECT Table 11012472 Installment Motivation Line
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               SetCurrencyCode;  //DP00886
               UpdateLatestInstallMot(FALSE);
             END;

    OnModify=BEGIN
               UpdateLatestInstallMot(FALSE);
               GetLineTotal;  //DP00886
             END;

    OnDelete=BEGIN
               UpdateLatestInstallMot(TRUE);
             END;

    CaptionML=[ENU=Installment Motivation Line;
               NOR=Rad for Avdragsmotivasjon;
               SVE=Rad fîr avbetalningsmotivation];
  }
  FIELDS
  {
    { 10  ;   ;Project No.         ;Code20        ;TableRelation=Job.No.;
                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr];
                                                   NotBlank=Yes }
    { 20  ;   ;Principal           ;Code20        ;TableRelation="Project Principal".Principal WHERE (Project No.=FIELD(Project No.));
                                                   CaptionML=[ENU=Principal;
                                                              NOR=Oppdragsgiver;
                                                              SVE=Uppdragsgivare];
                                                   NotBlank=Yes }
    { 30  ;   ;Production Date     ;Date          ;TableRelation="Installment Motivation"."Production Date" WHERE (Project No.=FIELD(Project No.),
                                                                                                                   Principal=FIELD(Principal));
                                                   OnValidate=BEGIN
                                                                UpdatePrevProductionDateFilter("Production Date");
                                                              END;

                                                   CaptionML=[ENU=Production Date;
                                                              NOR=Produksjonsdato;
                                                              SVE=Produktionsdatum];
                                                   NotBlank=Yes }
    { 35  ;   ;Extension Contract  ;Code10        ;TableRelation="Extension Contract"."Contract No." WHERE (Project No.=FIELD(Project No.));
                                                   CaptionML=[ENU=Extension Contract;
                                                              NOR=ETA;
                                                              SVE=éTA];
                                                   Editable=No }
    { 37  ;   ;Revision Rule       ;Code20        ;TableRelation="Revision Rule";
                                                   CaptionML=[ENU=Revision Rule Code;
                                                              NOR=Revisjonsregelkode;
                                                              SVE=Revideringsregelkod];
                                                   Editable=No }
    { 45  ;   ;Tender Paragraph No.;Text20        ;TableRelation="Tender Paragraph by Principal".No. WHERE (Project No.=FIELD(Project No.),
                                                                                                            Principal=FIELD(Principal));
                                                   CaptionML=[ENU=Tender Paragraph;
                                                              NOR=Tilbudsavsnitt;
                                                              SVE=Anbudsstycke];
                                                   Editable=No }
    { 50  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse;
                                                              SVE=Beskrivning];
                                                   Editable=No }
    { 60  ;   ;Element Quantity    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal".Quantity WHERE (Project No.=FIELD(Project No.),
                                                                                                                      Principal=FIELD(Principal),
                                                                                                                      Contract No.=FIELD(Extension Contract),
                                                                                                                      No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Element Quantity;
                                                              NOR=Elementantall;
                                                              SVE=Elementantal];
                                                   Editable=No }
    { 70  ;   ;Unit                ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal"."Unit of Measure" WHERE (Project No.=FIELD(Project No.),
                                                                                                                               Principal=FIELD(Principal),
                                                                                                                               Contract No.=FIELD(Extension Contract),
                                                                                                                               No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Unit;
                                                              NOR=Unit;
                                                              SVE=Enhet];
                                                   Editable=No }
    { 75  ;   ;Settlement Type     ;Option        ;CaptionML=[ENU=Settlement Type;
                                                              NOR=Oppgjõrstype;
                                                              SVE=AvrÑkningstyp];
                                                   OptionCaptionML=[ENU=" ,Non Settling,Settling,Approved,Reduction,Open";
                                                                    NOR=" ,Ingen avregning,Avregning,Godkjenn,Reduksjon,èpen";
                                                                    SVE=" ,Ingen avrÑkning,AvrÑkning,GodkÑnd,Reduktion,ôppen"];
                                                   OptionString=[ ,Non Settling,Settling,Approved,Reduction,Open];
                                                   Editable=No }
    { 80  ;   ;Previous Production Date;Date      ;FieldClass=FlowField;
                                                   CalcFormula=Max("Installment Motivation Line"."Production Date" WHERE (Project No.=FIELD(Project No.),
                                                                                                                          Principal=FIELD(Principal),
                                                                                                                          Extension Contract=FIELD(Extension Contract),
                                                                                                                          Tender Paragraph No.=FIELD(Tender Paragraph No.),
                                                                                                                          Production Date=FIELD(UPPERLIMIT(FILTER(Prev. Production Date Filter)))));
                                                   CaptionML=[ENU=Previous Production Date;
                                                              NOR=Forrige Produksjonsdato;
                                                              SVE=FîregÜende produktionsdatum];
                                                   Editable=No }
    { 90  ;   ;Previous Production ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line".Production WHERE (Project No.=FIELD(Project No.),
                                                                                                                   Principal=FIELD(Principal),
                                                                                                                   Extension Contract=FIELD(Extension Contract),
                                                                                                                   Tender Paragraph No.=FIELD(Tender Paragraph No.),
                                                                                                                   Production Date=FIELD(FILTER(Prev. Production Date Filter))));
                                                   CaptionML=[ENU=Previous Production;
                                                              NOR=Forrige produksjon];
                                                   Editable=No }
    { 95  ;   ;Previous Production (Adjust);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production (Adjustment)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                  Principal=FIELD(Principal),
                                                                                                                                  Extension Contract=FIELD(Extension Contract),
                                                                                                                                  Tender Paragraph No.=FIELD(Tender Paragraph No.),
                                                                                                                                  Production Date=FIELD(FILTER(Prev. Production Date Filter))));
                                                   CaptionML=ENU=Previous Production (Adjustment);
                                                   Description=DP01489;
                                                   Editable=No }
    { 100 ;   ;Production          ;Decimal       ;OnValidate=BEGIN
                                                                //DP01489.sn
                                                                CALCFIELDS("Previous Production", "Previous Production (Adjust)");
                                                                "Production Cumulative" := "Previous Production" + Production + "Previous Production (Adjust)" + "Production (Adjustment)";
                                                                //DP01489.en

                                                                CheckProgress;
                                                                CalculateProgress;
                                                                UpdateLatestInstallMot(FALSE); //MC-028451
                                                              END;

                                                   CaptionML=[ENU=Production in Period;
                                                              NOR=Produksjon i periode;
                                                              SVE=Produktion i period] }
    { 110 ;   ;Production Value (LCY);Decimal     ;OnValidate=BEGIN
                                                                IF NOT SkipValidateFCY THEN
                                                                  "Production Value (FCY)" := ProjectCurrencyExchangeRate.ExchangeAmtLCYToFCY("Production Value (LCY)", FALSE, FALSE, "Currency Code", "Project No.", Principal, "Production Date");  //DP00886
                                                              END;

                                                   CaptionML=ENU=Production Value (LCY);
                                                   Description=DP00886: not filled for RAW;
                                                   Editable=Yes }
    { 111 ;   ;Production Value (FCY);Decimal     ;OnValidate=BEGIN
                                                                //DP00886
                                                                SetSkipValidateFCY(TRUE);
                                                                VALIDATE("Production Value (LCY)", ProjectCurrencyExchangeRate.ExchangeAmtFCYToLCY("Production Value (FCY)", FALSE, FALSE, "Currency Code", "Project No.", Principal, "Production Date"));
                                                              END;

                                                   CaptionML=[ENU=Production Value;
                                                              NOR=Produksjonsverdi;
                                                              SVE=ProduktionsvÑrde];
                                                   Description=DP00886;
                                                   Editable=Yes }
    { 120 ;   ;Total Production Value (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Production Date=FIELD(Production Date),
                                                                                                                                 Extension Contract=FIELD(Extension Contract)));
                                                   CaptionML=ENU=Total Production Value (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 121 ;   ;Total Production Value (FCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Production Date=FIELD(Production Date),
                                                                                                                                 Extension Contract=FIELD(Extension Contract)));
                                                   CaptionML=[ENU=Total Production Value;
                                                              NOR=Total Produksjonsverdi;
                                                              SVE=Totalt produktionsvÑrde];
                                                   Description=DP00886;
                                                   Editable=No }
    { 130 ;   ;Prev. Production Date Filter;Text30;CaptionML=[ENU=Previous Product Date Filter;
                                                              NOR=Forrige Produktdatofilter;
                                                              SVE=FîregÜende produktdatumfilter];
                                                   Editable=No }
    { 140 ;   ;Unit Price (LCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal"."Unit Price (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                Principal=FIELD(Principal),
                                                                                                                                Contract No.=FIELD(Extension Contract),
                                                                                                                                No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Unit Price (LCY);
                                                              NOR=Salgspris (NOK);
                                                              SVE=A-pris (BVA)];
                                                   Description=DP00886;
                                                   Editable=No }
    { 141 ;   ;Unit Price (FCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal"."Unit Price (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                Principal=FIELD(Principal),
                                                                                                                                Contract No.=FIELD(Extension Contract),
                                                                                                                                No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Unit Price;
                                                              NOR=Enhetspris;
                                                              SVE=A-pris];
                                                   Description=DP00886;
                                                   Editable=No }
    { 145 ;   ;Line Total (LCY)    ;Decimal       ;CaptionML=ENU=Line Total (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 146 ;   ;Line Total (FCY)    ;Decimal       ;CaptionML=[ENU=Line Total;
                                                              NOR=Rad, totalt;
                                                              SVE=Radtotal];
                                                   Description=DP00886;
                                                   Editable=No }
    { 150 ;   ;Number of Points/Percentage;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal"."Number of Points/Percentage" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                           Principal=FIELD(Principal),
                                                                                                                                           Contract No.=FIELD(Extension Contract),
                                                                                                                                           No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Number of Points/Percentage;
                                                              NOR=Antall poeng/prosent;
                                                              SVE=Antal poÑng/procent];
                                                   Editable=No }
    { 160 ;   ;Total Invoiced      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Job Ledger Entry"."Total Price (LCY)" WHERE (Project Invoice=CONST(Yes),
                                                                                                                  Installment Invoice=CONST(Yes),
                                                                                                                  Job No.=FIELD(Project No.),
                                                                                                                  Principal=FIELD(Principal),
                                                                                                                  Installment Motivation=FIELD(Production Date),
                                                                                                                  Advance Payment=CONST(No)));
                                                   CaptionML=[ENU=Total Invoiced;
                                                              NOR="Totalt fakturert ";
                                                              SVE=Totalt fakturerat];
                                                   Editable=No }
    { 170 ;   ;Total Installments  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Installment"."Installment Amount (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                           Principal=FIELD(Principal),
                                                                                                                           Installment Motivation Date=FIELD(Production Date),
                                                                                                                           Advance Payment=CONST(No)));
                                                   CaptionML=[ENU=Total Installments;
                                                              SVE=Totala avbetalningar];
                                                   Editable=No }
    { 180 ;   ;Total Invoiced Project;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Job Ledger Entry"."Total Price (LCY)" WHERE (Project Invoice=CONST(Yes),
                                                                                                                  Installment Invoice=CONST(Yes),
                                                                                                                  Job No.=FIELD(Project No.),
                                                                                                                  Principal=FIELD(Principal),
                                                                                                                  Advance Payment=CONST(No)));
                                                   CaptionML=[ENU=Total Invoiced Project;
                                                              NOR=Totalt fakturert prosjekt;
                                                              SVE=Totalt fakturerat projekt];
                                                   Editable=No }
    { 190 ;   ;Tot Installments Project (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Installment"."Installment Amount (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                           Principal=FIELD(Principal),
                                                                                                                           Extension Contract=FIELD(Extension Contract),
                                                                                                                           Plot No.=FILTER(''),
                                                                                                                           Option=FILTER(''),
                                                                                                                           VAT Prod. Posting Group=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                           Advance Payment=CONST(No)));
                                                   CaptionML=ENU=Total Installments Project (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 191 ;   ;Tot Installments Project (FCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Project Installment"."Installment Amount" WHERE (Project No.=FIELD(Project No.),
                                                                                                                     Principal=FIELD(Principal),
                                                                                                                     Extension Contract=FIELD(Extension Contract),
                                                                                                                     Plot No.=FILTER(''),
                                                                                                                     Option=FILTER(''),
                                                                                                                     VAT Prod. Posting Group=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                     Advance Payment=CONST(No)));
                                                   CaptionML=[ENU=Total Installments Project;
                                                              SVE=Totalt avbetalningsprojekt];
                                                   Description=DP00886;
                                                   Editable=No }
    { 195 ;   ;Prod. Value Paragraph (LCY);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Extension Contract=FIELD(Extension Contract),
                                                                                                                                 Tender Paragraph No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Total Production Value Paragraph (LCY);
                                                              NOR=Totalt Produksjonsverdiavsnitt;
                                                              SVE=Totalt produktionsvÑrdesstycke];
                                                   Description=DP00886;
                                                   Editable=No }
    { 196 ;   ;Prod. Value Paragraph (FCY);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Extension Contract=FIELD(Extension Contract),
                                                                                                                                 Tender Paragraph No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Total Production Value Paragraph;
                                                              NOR=Totalt Produksjonsverdiavsnitt;
                                                              SVE=Totalt produktionsvÑrdesstycke];
                                                   Description=DP00886;
                                                   Editable=No }
    { 200 ;   ;Prev. Total Prod Value (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Production Date=FIELD(FILTER(Prev. Production Date Filter)),
                                                                                                                                 Extension Contract=FIELD(Extension Contract)));
                                                   CaptionML=ENU=Previous Total Production Value (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 201 ;   ;Prev. Total Prod Value (FCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Production Date=FIELD(FILTER(Prev. Production Date Filter)),
                                                                                                                                 Extension Contract=FIELD(Extension Contract)));
                                                   CaptionML=[ENU=Previous Total Production Value;
                                                              NOR=Forrige Total Produksjonsverdi;
                                                              SVE=FîregÜende totalt produktionsvÑrde];
                                                   Description=DP00886;
                                                   Editable=No }
    { 205 ;   ;Prev. Production Value (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Production Date=FIELD(FILTER(Prev. Production Date Filter)),
                                                                                                                                 Extension Contract=FIELD(Extension Contract),
                                                                                                                                 Tender Paragraph No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=ENU=Previous Production Value Cumulative (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 206 ;   ;Prev. Production Value (FCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Production Date=FIELD(FILTER(Prev. Production Date Filter)),
                                                                                                                                 Extension Contract=FIELD(Extension Contract),
                                                                                                                                 Tender Paragraph No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Previous Production Value Cumulative;
                                                              NOR=Forrige Akkumulerte Produksjonsverdi;
                                                              SVE=Ackumulerat fîregÜende produktionsvÑrde];
                                                   Description=DP00886;
                                                   Editable=No }
    { 210 ;   ;Production Cumulative;Decimal      ;OnValidate=BEGIN
                                                                //DP01489.sn
                                                                CALCFIELDS("Previous Production", "Previous Production (Adjust)");
                                                                VALIDATE(Production,("Production Cumulative" - "Previous Production" + "Production (Adjustment)" + "Previous Production (Adjust)"));
                                                                //DP01489.en

                                                                CalculateProgress;
                                                                UpdateLatestInstallMot(FALSE); //MC-028451
                                                              END;

                                                   CaptionML=[ENU=Production Cumulative;
                                                              NOR=Akkumulert Produksjon;
                                                              SVE=ProductionCumulative] }
    { 220 ;   ;Revision            ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal".Revision WHERE (Project No.=FIELD(Project No.),
                                                                                                                      Principal=FIELD(Principal),
                                                                                                                      Contract No.=FIELD(Extension Contract),
                                                                                                                      No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Revision;
                                                              NOR=Revisjon;
                                                              SVE=Revidering];
                                                   Editable=No }
    { 240 ;   ;Revision Value (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Production Date=FIELD(Production Date),
                                                                                                                                 Revision Rule=FILTER(<>'')));
                                                   CaptionML=ENU=Revision Value (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 241 ;   ;Revision Value (FCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                 Principal=FIELD(Principal),
                                                                                                                                 Production Date=FIELD(Production Date),
                                                                                                                                 Revision Rule=FILTER(<>'')));
                                                   CaptionML=[ENU=Revision Value;
                                                              NOR=Revisjonsverdi;
                                                              SVE=RevideringsvÑrde];
                                                   Description=DP00886;
                                                   Editable=No }
    { 250 ;   ;Comment             ;Text80        ;CaptionML=[ENU=Comment;
                                                              NOR=Merknad;
                                                              SVE=Kommentar] }
    { 260 ;   ;Settlement Price (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal"."Settlement Price (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                      Principal=FIELD(Principal),
                                                                                                                                      Contract No.=FIELD(Extension Contract),
                                                                                                                                      No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=ENU=Settlement Price (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 261 ;   ;Settlement Price (FCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal"."Settlement Price (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                      Principal=FIELD(Principal),
                                                                                                                                      Contract No.=FIELD(Extension Contract),
                                                                                                                                      No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Settlement Price;
                                                              NOR=Oppgjõrspris;
                                                              SVE=AvrÑkningspris];
                                                   Description=DP00886;
                                                   Editable=No }
    { 270 ;   ;Layout              ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal".Layout WHERE (Project No.=FIELD(Project No.),
                                                                                                                    Principal=FIELD(Principal),
                                                                                                                    Contract No.=FIELD(Extension Contract),
                                                                                                                    No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Layout;
                                                              NOR=Utseende;
                                                              SVE=Layout];
                                                   OptionCaptionML=[ENU=Chapter,Paragraph,Sub-Paragraph,Sub-Sub-Paragraph,Detail;
                                                                    NOR=Kapittel,Avsnitt,Underavsnitt,Under-underavsnitt,Detaljer;
                                                                    SVE=Kapitel,Stycke,Understycke,Under-understycke,Detaljer];
                                                   OptionString=Chapter,Paragraph,Sub-Paragraph,Sub-Sub-Paragraph,Detail;
                                                   Editable=No }
    { 280 ;   ;Finished            ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal".Finished WHERE (Project No.=FIELD(Project No.),
                                                                                                                      Principal=FIELD(Principal),
                                                                                                                      Contract No.=FIELD(Extension Contract),
                                                                                                                      No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Finished;
                                                              NOR=Ferdig;
                                                              SVE=Avslutad];
                                                   Editable=No }
    { 290 ;   ;Settle Excess       ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal"."Settle Excess" WHERE (Project No.=FIELD(Project No.),
                                                                                                                             Principal=FIELD(Principal),
                                                                                                                             Contract No.=FIELD(Extension Contract),
                                                                                                                             No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Settle Under-/Overrun (RAW);
                                                              NOR=Fastsett Under-/Overstyring (RAW);
                                                              SVE=FaststÑlla under-/îverkîrning (RAW)];
                                                   Editable=No }
    { 300 ;   ;Production Value Cum. (LCY);Decimal;OnValidate=BEGIN
                                                                IF NOT SkipValidateFCY THEN
                                                                  "Production Value Cum. (FCY)" := ProjectCurrencyExchangeRate.ExchangeAmtLCYToFCY("Production Value Cum. (LCY)", FALSE, FALSE, "Currency Code", "Project No.", Principal, "Production Date");  //DP00886
                                                              END;

                                                   CaptionML=ENU=Production Value Cumulative (LCY);
                                                   Description=DP00886: filled for RAW;
                                                   Editable=No }
    { 301 ;   ;Production Value Cum. (FCY);Decimal;OnValidate=BEGIN
                                                                //DP00886
                                                                SetSkipValidateFCY(TRUE);
                                                                VALIDATE("Production Value Cum. (LCY)", ProjectCurrencyExchangeRate.ExchangeAmtFCYToLCY("Production Value Cum. (FCY)", FALSE, FALSE, "Currency Code", "Project No.", Principal , "Production Date"));
                                                              END;

                                                   CaptionML=[ENU=Production Value Cumulative;
                                                              NOR=Akkumulert produksjonsverdi;
                                                              SVE=Ackumulerat produktionsvÑrde];
                                                   Description=DP00886;
                                                   Editable=No }
    { 310 ;   ;Excess Prod. Value Cum. (LCY);Decimal;
                                                   OnValidate=BEGIN
                                                                IF NOT SkipValidateFCY THEN
                                                                  "Excess Prod. Value Cum. (FCY)" := ProjectCurrencyExchangeRate.ExchangeAmtLCYToFCY("Excess Prod. Value Cum. (LCY)", FALSE, FALSE, "Currency Code", "Project No.", Principal, "Production Date");  //DP00886
                                                              END;

                                                   CaptionML=ENU=Excess Production Value Cumulative (LCY);
                                                   Description=DP00886: filled for RAW;
                                                   Editable=No }
    { 311 ;   ;Excess Prod. Value Cum. (FCY);Decimal;
                                                   OnValidate=BEGIN
                                                                //DP00886
                                                                SetSkipValidateFCY(TRUE);
                                                                VALIDATE("Excess Prod. Value Cum. (LCY)", ProjectCurrencyExchangeRate.ExchangeAmtFCYToLCY("Excess Prod. Value Cum. (FCY)", FALSE, FALSE, "Currency Code", "Project No.", Principal, "Production Date"));
                                                              END;

                                                   CaptionML=[ENU=Excess Production Value Cumulative;
                                                              NOR=Akkumulert overflõdig produksjonsverdi;
                                                              SVE=Ackumulerat îverskjutande produktionsvÑrde];
                                                   Description=DP00886;
                                                   Editable=No }
    { 320 ;   ;Type                ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tender Paragraph by Principal".Type WHERE (Project No.=FIELD(Project No.),
                                                                                                                  Principal=FIELD(Principal),
                                                                                                                  Contract No.=FIELD(Extension Contract),
                                                                                                                  No.=FIELD(Tender Paragraph No.)));
                                                   CaptionML=[ENU=Type;
                                                              NOR=Radtype;
                                                              SVE=Radtyp];
                                                   OptionCaptionML=ENU=" ,Normal,Surcharge,Estimate,One-time Costs,Contributions,Extra-Contract,Execution Costs,Discount";
                                                   OptionString=[ ,Normal,Surcharge,Estimate,OneTime,Contributions,Extra-Contract,Execution,Discount];
                                                   Editable=No }
    { 330 ;   ;Total Prod. Value Cum. (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value Cum. (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                      Principal=FIELD(Principal),
                                                                                                                                      Production Date=FIELD(Production Date),
                                                                                                                                      Extension Contract=FIELD(Extension Contract)));
                                                   CaptionML=ENU=Total Production Value Cumulative (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 331 ;   ;Total Prod. Value Cum. (FCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Production Value Cum. (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                      Principal=FIELD(Principal),
                                                                                                                                      Production Date=FIELD(Production Date),
                                                                                                                                      Extension Contract=FIELD(Extension Contract)));
                                                   CaptionML=ENU=Total Production Value Cumulative;
                                                   Description=DP00886;
                                                   Editable=No }
    { 340 ;   ;Tot Excess ProdValue Cum (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Excess Prod. Value Cum. (LCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                        Principal=FIELD(Principal),
                                                                                                                                        Production Date=FIELD(Production Date),
                                                                                                                                        Extension Contract=FIELD(Extension Contract)));
                                                   CaptionML=ENU=Total Excess Production Value Cumulative (LCY);
                                                   Description=DP00886;
                                                   Editable=No }
    { 341 ;   ;Tot Excess ProdValue Cum (FCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Installment Motivation Line"."Excess Prod. Value Cum. (FCY)" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                        Principal=FIELD(Principal),
                                                                                                                                        Production Date=FIELD(Production Date),
                                                                                                                                        Extension Contract=FIELD(Extension Contract)));
                                                   CaptionML=ENU=Total Excess Production Value Cumulative;
                                                   Description=DP00886;
                                                   Editable=No }
    { 350 ;   ;VAT Prod. Posting Group Filter;Code20;
                                                   FieldClass=FlowFilter;
                                                   TableRelation="VAT Product Posting Group";
                                                   CaptionML=[ENU=VAT Prod. Posting Group Filter;
                                                              NOR=Filter for Produksjonsbokfõringsgruppe (Moms);
                                                              SVE=Momsprod. Bokfîringsmallfilter];
                                                   Editable=No }
    { 370 ;   ;Production (Adjustment);Decimal    ;OnValidate=BEGIN
                                                                VALIDATE(Production);  //DP01489
                                                              END;

                                                   CaptionML=ENU=Production (Adjustment);
                                                   Description=DP01489 }
    { 380 ;   ;Installment Motivation Period;Code10;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Installment Motivation"."Installment Motivation Period" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                      Principal=FIELD(Principal),
                                                                                                                                      Production Date=FIELD(Production Date)));
                                                   CaptionML=ENU=Installment Motivation Period;
                                                   Description=DP01485;
                                                   Editable=No }
    { 390 ;   ;Installment Overview Period;Code10 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Installment Motivation"."Installment Overview Period" WHERE (Project No.=FIELD(Project No.),
                                                                                                                                    Principal=FIELD(Principal),
                                                                                                                                    Production Date=FIELD(Production Date)));
                                                   CaptionML=ENU=Installment Overview Period;
                                                   Description=DP01485;
                                                   Editable=No }
    { 400 ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode;
                                                              SVE=Valutakod];
                                                   Description=DP00886;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Project No.,Principal,Production Date,Extension Contract,Revision Rule,Tender Paragraph No.;
                                                   SumIndexFields=Production Value (LCY),Production,Production Value Cum. (LCY),Excess Prod. Value Cum. (LCY);
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      PrinTenderElemRec@1210190000 : Record 11012470;
      ProjPrinRec@1210190001 : Record 11012005;
      Text001@1100485004 : TextConst 'ENU=Note: The total Production is greater than the Number of Points of the Tender Paragraph.;SVE=Obs! Den totala produktionen Ñr stîrre Ñn antalet poÑng i anbudsstycket';
      Text002@1100485003 : TextConst 'ENU=Note: The total Production of the Tender Paragraph is greater than 100 procent.;SVE=Obs! Den totala produktionen i anbudsstycket Ñr stîrre Ñn 100 procent';
      Text003@1100485001 : TextConst 'ENU=Note: The total Production is greater than the quantity on the Tender Paragraph.;SVE=Obs! Den totala produktionen Ñr stîrre Ñn antalet i anbudsstycket';
      Text011@1100485000 : TextConst 'ENU=Note: The total Production is more than 10 percent greater than the quantity on the Tender Paragraph, the Settlement Price can be revised.;SVE=Obs! Den totala produktionen Ñr 10 procent stîrre Ñn antalet i anbudsstycket, avrÑkningspriset kan revideras';
      Text012@1100485002 : TextConst 'ENU=Note: The total Production is more than 10 percent greater than the quantity on the Tender Paragraph, do you want to settle the overrun?;SVE=Obs! Den totala produktionen îverstiger uppgiften i anbudsstycket med 10 procent. Vill du korrigera skillnaden?';
      Text013@1210190002 : TextConst 'ENU=Adjust the cumulative of the following installment motivations?;NOR=Justere Akkumulert verdi for fõlgende Avdragsmotivasjoner?;SVE=Justera det ackumulerade vÑrdet fîr fîljande avbetalningsmotivationer?';
      ProjectCurrencyExchangeRate@1100525002 : Record 11020628;
      SkipValidateFCY@1100525000 : Boolean;

    PROCEDURE CheckProgress@1100485000();
    VAR
      lvProjRec@1100485000 : Record 11072003;
      lvSetSettleExcess@1100485001 : Boolean;
      lvTendElemRec@1100485002 : Record 11012470;
      PrevProduction@1100528900 : Decimal;
      CurrProduction@1100528901 : Decimal;
    BEGIN
      IF (Production = 0) THEN
        EXIT;

      //DP01489.sn
      CALCFIELDS("Previous Production", "Previous Production (Adjust)", "Settle Excess", "Element Quantity");
      PrevProduction := "Previous Production" + "Previous Production (Adjust)";
      CurrProduction := Production + "Production (Adjustment)";
      //DP01489.en

      lvSetSettleExcess := FALSE;
      lvProjRec.GET("Project No.");
      ProjPrinRec.GET("Project No.",Principal);
      CASE ProjPrinRec."Installm.Motivation Method" OF
        ProjPrinRec."Installm.Motivation Method"::Points:
          IF (("Number of Points/Percentage" >= 0) AND
               ((CurrProduction + PrevProduction) > "Number of Points/Percentage")) OR
             (("Number of Points/Percentage" < 0) AND
               ((CurrProduction + PrevProduction) < "Number of Points/Percentage")) THEN
            MESSAGE(Text001);
        ProjPrinRec."Installm.Motivation Method"::Percentages:
          IF ((CurrProduction + PrevProduction) > 100) THEN
            MESSAGE(Text002);
        ProjPrinRec."Installm.Motivation Method"::"Element Quantity":
          BEGIN
            IF (NOT lvProjRec.RAW) THEN BEGIN
              IF (Production <> 0) AND
                 ((("Element Quantity" >= 0) AND
                    ((CurrProduction + PrevProduction) > "Element Quantity")) OR
                 (("Element Quantity" < 0) AND
                    ((CurrProduction + PrevProduction) < "Element Quantity"))) THEN
                MESSAGE(Text003);
            END ELSE BEGIN
              IF((CurrProduction + PrevProduction) > (1.1 *  "Element Quantity")) THEN BEGIN
                //* For RAW check on 10% settlement.
                //* Note: For RAW only 'Element Quantity' never RAW in combination with points or percentages
                CASE "Settlement Type" OF
                  "Settlement Type"::"Non Settling":
                    BEGIN
                      IF (NOT "Settle Excess") THEN BEGIN
                        IF CONFIRM(Text012) THEN
                          lvSetSettleExcess := TRUE;
                      END;
                    END;
                  "Settlement Type"::Settling:
                    MESSAGE(Text011);
                  ELSE
                    MESSAGE(Text003);
                END;
              END;
            END;
          END;
      END;

      //* For RAW, non settling entries: can be settled as extra declaration
      IF lvProjRec.RAW AND lvSetSettleExcess THEN BEGIN
        lvTendElemRec.SETRANGE("Project No.","Project No.");
        lvTendElemRec.SETRANGE(Principal,Principal);
        lvTendElemRec.SETRANGE("Contract No.","Extension Contract");
        lvTendElemRec.SETRANGE("No.","Tender Paragraph No.");
        IF lvTendElemRec.FINDFIRST THEN BEGIN
          lvTendElemRec.VALIDATE("Settle Excess", TRUE);
          lvTendElemRec.MODIFY;
        END;
      END;
    END;

    PROCEDURE CalculateProgress@1100485001();
    VAR
      lvProjRec@1100485000 : Record 11072003;
      lvCURAW@1100485001 : Codeunit 11012164;
    BEGIN
      PrinTenderElemRec.SETRANGE("Project No.", "Project No.");
      PrinTenderElemRec.SETRANGE(Principal, Principal);
      PrinTenderElemRec.SETRANGE("Contract No.", "Extension Contract");
      PrinTenderElemRec.SETRANGE("No.", "Tender Paragraph No.");
      IF NOT PrinTenderElemRec.FINDFIRST THEN
        EXIT; //call 25966

      InitProductionValue;  //DP00886
      ProjPrinRec.GET("Project No.",Principal);
      lvProjRec.GET("Project No.");
      IF lvProjRec.RAW THEN BEGIN
        //* For RAW we calculate "Production Value Cumulative" and "Excess Prod. Value Cumulative"
        //* Note: For RAW only 'Element Quantity' never RAW in combination with points or percentages
        CALCFIELDS("Settlement Price (LCY)", "Unit Price (LCY)", "Settle Excess");
        lvCURAW.CalculateProduction(PrinTenderElemRec, Rec);
      END ELSE BEGIN
        //* For not-RAW we calculate "Production Value"
        CASE ProjPrinRec."Installm.Motivation Method" OF
          ProjPrinRec."Installm.Motivation Method"::Points:
            IF PrinTenderElemRec."Number of Points/Percentage" <> 0 THEN
              "Production Value (FCY)" := (Production / PrinTenderElemRec."Number of Points/Percentage") * PrinTenderElemRec."Total Amount (FCY)";
          ProjPrinRec."Installm.Motivation Method"::Percentages:
            "Production Value (FCY)" := (Production / 100) * PrinTenderElemRec."Total Amount (FCY)";
          ProjPrinRec."Installm.Motivation Method"::"Element Quantity":
              "Production Value (FCY)" := Production * PrinTenderElemRec."Unit Price (FCY)";
        END;
        VALIDATE("Production Value (FCY)", ROUND("Production Value (FCY)"));  //DP00886
      END;
    END;

    PROCEDURE UpdateLatestInstallMot@2(LineRemoved@11012000 : Boolean);
    VAR
      InstallMotLine1@1100485000 : Record 11012472;
      InstallMotLine2@1100485001 : Record 11012472;
      EditCumulative@1210190000 : Boolean;
    BEGIN
      IF LineRemoved THEN BEGIN
        InstallMotLine1.RESET;
        InstallMotLine1.SETCURRENTKEY("Project No.",Principal,"Production Date","Extension Contract","Revision Rule");
        InstallMotLine1.SETRANGE("Project No.","Project No.");
        InstallMotLine1.SETRANGE(Principal,Principal);
        InstallMotLine1.SETFILTER("Production Date",'<%1',"Production Date");
        InstallMotLine1.SETRANGE("Extension Contract","Extension Contract");
        InstallMotLine1.SETRANGE("Tender Paragraph No.","Tender Paragraph No.");
        IF NOT InstallMotLine1.FIND('+') THEN
          InstallMotLine1."Production Cumulative" := 0;
      END ELSE BEGIN
        InstallMotLine1."Production Cumulative" := "Production Cumulative";
      END;

      InstallMotLine2.RESET;
      InstallMotLine2.SETCURRENTKEY("Project No.",Principal,"Production Date","Extension Contract", "Revision Rule");
      InstallMotLine2.SETRANGE("Project No.","Project No.");
      InstallMotLine2.SETRANGE(Principal,Principal);
      InstallMotLine2.SETFILTER("Production Date",'>%1',"Production Date");
      InstallMotLine2.SETRANGE("Extension Contract","Extension Contract");
      InstallMotLine2.SETRANGE("Tender Paragraph No.","Tender Paragraph No.");
      IF InstallMotLine2.FIND('-') THEN BEGIN
        IF (CurrFieldNo = FIELDNO(Production)) OR
           (CurrFieldNo = FIELDNO("Production Cumulative")) THEN
        BEGIN
          EditCumulative := CONFIRM(Text013, FALSE);  //    //MC-028451 n//ask question
        END;

        IF NOT EditCumulative THEN BEGIN
          IF InstallMotLine2.Production <>
            (InstallMotLine2."Production Cumulative" - InstallMotLine1."Production Cumulative")
          THEN BEGIN
            InstallMotLine2.Production :=
              InstallMotLine2."Production Cumulative" - InstallMotLine1."Production Cumulative";
            InstallMotLine2.CalculateProgress(); //update Production Value (don't use the validate of Production because
                                                 // of FlowField doesn't include the currently editted record)
            InstallMotLine2.MODIFY;
          END;
        END ELSE BEGIN
          //MC-028451 sn
          REPEAT
            IF InstallMotLine2."Production Cumulative" <>
              (InstallMotLine2.Production  + InstallMotLine1."Production Cumulative") THEN
            BEGIN
              InstallMotLine2."Production Cumulative" :=
                InstallMotLine2.Production  + InstallMotLine1."Production Cumulative";

              InstallMotLine2.CalculateProgress(); //update Production Value (don't use the validate of Production because
                                                   // of FlowField doesn't include the currently editted record)
              InstallMotLine2.MODIFY;
            END;
            InstallMotLine1."Production Cumulative" := InstallMotLine2."Production Cumulative"
          UNTIL InstallMotLine2.NEXT = 0;
          //MC-028451 en
        END;
      END;
    END;

    PROCEDURE EditTenderElemText@1100485002();
    VAR
      TenderElemTextForm@1100485000 : Page 11012480;
      TenderElemTextRec@1100485001 : Record 11012475;
    BEGIN
      TenderElemTextRec.SETFILTER("Project No.", "Project No.");
      TenderElemTextRec.SETFILTER(Principal, Principal);
      IF "Extension Contract" = '' THEN
        TenderElemTextRec.SETFILTER("Contract No.", '=''''')
      ELSE
        TenderElemTextRec.SETFILTER("Contract No.", "Extension Contract");
      TenderElemTextRec.SETFILTER("Tender Paragraph", "Tender Paragraph No.");
      TenderElemTextForm.EDITABLE(FALSE);
      TenderElemTextForm.SETTABLEVIEW(TenderElemTextRec);
      TenderElemTextForm.RUNMODAL;
    END;

    PROCEDURE BufferAmountVAT@1100525001(VAR TempInstallment@1100525000 : TEMPORARY Record 11012018;ProjectNo@1100525004 : Code[20];CustomerNo@1100525005 : Code[20];ExtensionContract@1100525007 : Code[20];VATCode@1100525001 : Code[10];AmountLCY@1100525002 : Decimal;AmountFCY@1100525003 : Decimal);
    VAR
      ProjectPrincipal@1100525006 : Record 11012005;
    BEGIN
      //Store amount to be installed per VAT in a temp table
      //* Field TempInstallment."Percentage Contract Amount" is used for unrounded points. Note: TempInstallment.Points is an integer.
      //DP00886.sn
      ProjectPrincipal.GET(ProjectNo, CustomerNo);
      TempInstallment.SETRANGE("Project No.", ProjectNo);
      TempInstallment.SETRANGE(Principal, CustomerNo);
      TempInstallment.SETRANGE("Extension Contract", ExtensionContract);  //DP01485
      //DP00886.en
      TempInstallment.SETRANGE(TempInstallment."VAT Prod. Posting Group", VATCode);
      IF TempInstallment.FINDFIRST THEN BEGIN
        TempInstallment.SETRANGE(TempInstallment."VAT Prod. Posting Group");
        //DP00886.sn
        TempInstallment."Installment Amount (LCY)" += AmountLCY;
        TempInstallment."Installment Amount" += AmountFCY;
        //DP00886.en
        TempInstallment."Percentage Contract Amount" += Production;
        IF ProjectPrincipal."Installm.Motivation Method" = ProjectPrincipal."Installm.Motivation Method"::Points THEN  //C044067
          TempInstallment.Points := ROUND(TempInstallment."Percentage Contract Amount", 1);
        TempInstallment.MODIFY;
      END ELSE BEGIN
        //TempInstallment.SETRANGE("Extension Contract");  //DP01491Ö
        TempInstallment.SETRANGE(TempInstallment."VAT Prod. Posting Group");
        IF TempInstallment.FINDLAST THEN BEGIN
          TempInstallment."Installment No." := INCSTR(TempInstallment."Installment No.");
          //DP00886.sn
          TempInstallment."Installment Amount (LCY)" := AmountLCY;
          TempInstallment."Installment Amount" := AmountFCY;
          //DP00886.en
          TempInstallment."Percentage Contract Amount" := Production;
          IF ProjectPrincipal."Installm.Motivation Method" = ProjectPrincipal."Installm.Motivation Method"::Points THEN  //C044067
            TempInstallment.Points := ROUND(TempInstallment."Percentage Contract Amount", 1);
          TempInstallment."VAT Prod. Posting Group" := VATCode;
          TempInstallment.INSERT;
        END ELSE BEGIN
          TempInstallment."Project No." := ProjectNo;  //DP00886
          TempInstallment.Principal := CustomerNo;   //DP00886
          TempInstallment."Extension Contract" := ExtensionContract;  //DP01485
          TempInstallment."Installment No." := '1';
          //DP00886.sn
          TempInstallment."Currency Code" := ProjectPrincipal."Currency Code";
          TempInstallment."Installment Amount (LCY)" := AmountLCY;
          TempInstallment."Installment Amount" := AmountFCY;
          //DP00886.en
          TempInstallment."Percentage Contract Amount" := Production;
          IF ProjectPrincipal."Installm.Motivation Method" = ProjectPrincipal."Installm.Motivation Method"::Points THEN  //C044067
            TempInstallment.Points := ROUND(TempInstallment."Percentage Contract Amount", 1);
          TempInstallment."VAT Prod. Posting Group" := VATCode;
          TempInstallment.INSERT;
        END;
      END;
    END;

    PROCEDURE ProductionValueCumulative@1210190000() : Decimal;
    BEGIN
      CALCFIELDS("Prev. Production Value (LCY)");
      EXIT("Prev. Production Value (LCY)" + "Production Value (LCY)");
    END;

    PROCEDURE SetSkipValidateFCY@1100528603(ISkipValidateFCY@1100528600 : Boolean);
    BEGIN
      //DP00886
      SkipValidateFCY := ISkipValidateFCY;
    END;

    PROCEDURE SetCurrencyCode@1100525004();
    VAR
      ProjectPrincipal@1100525000 : Record 11012005;
      Job@1100525001 : Record 11072003;
    BEGIN
      //DP00886
      IF ProjectPrincipal.GET("Project No.", Principal) THEN BEGIN
        "Currency Code" := ProjectPrincipal."Currency Code";
      END ELSE BEGIN
        Job.GET("Project No.");
        "Currency Code" := Job."Currency Code";
      END;
    END;

    PROCEDURE GetLineTotal@1100525000();
    BEGIN
      //DP00886
      CALCFIELDS("Element Quantity", "Unit Price (LCY)", "Unit Price (FCY)");
      "Line Total (LCY)" := ROUND("Element Quantity" * "Unit Price (LCY)");
      "Line Total (FCY)" := ROUND("Element Quantity" * "Unit Price (FCY)");
    END;

    LOCAL PROCEDURE InitProductionValue@1100525002();
    BEGIN
      //DP00886
      "Production Value (LCY)" := 0;
      "Production Value (FCY)" := 0;
      "Production Value Cum. (LCY)" := 0;
      "Excess Prod. Value Cum. (LCY)" := 0;
      "Production Value Cum. (FCY)" := 0;
      "Excess Prod. Value Cum. (FCY)" := 0;
    END;

    PROCEDURE UpdatePrevProductionDateFilter@1100528700(ProductionDate@1100528700 : Date);
    BEGIN
      "Prev. Production Date Filter" := '<' + FORMAT(ProductionDate);
    END;

    LOCAL PROCEDURE SetFilterInstallment@1100528505(SelectExtension@1100528502 : Integer;CumTotal@1100528501 : Boolean;VAR ProjectInstallment@1100528503 : Record 11012018);
    BEGIN
      //C050712
      ProjectInstallment.SETRANGE("Project No.", "Project No.");
      ProjectInstallment.SETRANGE(Principal, Principal);
      ProjectInstallment.SETRANGE("Advance Payment", FALSE);
      IF (SelectExtension = 1) THEN
        ProjectInstallment.SETFILTER("Extension Contract", '<>%1', '');
      IF (SelectExtension = 2) THEN
        ProjectInstallment.SETFILTER("Extension Contract", '%1', '');
      IF (CumTotal = FALSE) THEN
        ProjectInstallment.SETRANGE("Installment Motivation Date", "Production Date");
    END;

    PROCEDURE CalcTotalInstallments@1100528500(SelectExtension@1100528503 : Integer;CumTotal@1100528500 : Boolean;HomeCurrency@1100528501 : Boolean) InstAmnt : Decimal;
    VAR
      ProjectInstallment@1100528502 : Record 11012018;
    BEGIN
      //C050712
      SetFilterInstallment(SelectExtension, CumTotal, ProjectInstallment);

      IF HomeCurrency THEN BEGIN
        ProjectInstallment.CALCSUMS("Installment Amount (LCY)");
        InstAmnt := ProjectInstallment."Installment Amount (LCY)";
      END ELSE BEGIN
        ProjectInstallment.CALCSUMS("Installment Amount");
        InstAmnt := ProjectInstallment."Installment Amount";
      END;

      EXIT(InstAmnt);
    END;

    PROCEDURE ShowTotalInstallments@1100528504(SelectExtension@1100528503 : Integer;CumTotal@1100528500 : Boolean);
    VAR
      ProjectInstallment@1100528502 : Record 11012018;
    BEGIN
      //C050712
      SetFilterInstallment(SelectExtension, CumTotal, ProjectInstallment);
      PAGE.RUNMODAL(0,ProjectInstallment);
    END;

    LOCAL PROCEDURE SetFilterInvoiced@1100528503(SelectExtension@1100528502 : Integer;CumTotal@1100528501 : Boolean;VAR JobLedgerEntry@1100528503 : Record 11072005);
    BEGIN
      //C050712
      JobLedgerEntry.SETCURRENTKEY("Job No.","Project Invoice","Installment Invoice",Principal);
      JobLedgerEntry.SETRANGE("Job No.", "Project No.");
      JobLedgerEntry.SETRANGE(Principal, Principal);
      JobLedgerEntry.SETRANGE("Project Invoice", TRUE);
      JobLedgerEntry.SETRANGE("Installment Invoice", TRUE);
      JobLedgerEntry.SETRANGE("Advance Payment", FALSE);
      IF (SelectExtension = 1) THEN
        JobLedgerEntry.SETFILTER("Extension Contract", '<>%1', '');
      IF (SelectExtension = 2) THEN
        JobLedgerEntry.SETFILTER("Extension Contract", '%1', '');
      IF (CumTotal = FALSE) THEN
        JobLedgerEntry.SETRANGE("Installment Motivation", "Production Date");
    END;

    PROCEDURE CalcTotalInvoiced@1100528501(SelectExtension@1100528503 : Integer;CumTotal@1100528500 : Boolean;HomeCurrency@1100528501 : Boolean) InvAmnt : Decimal;
    VAR
      JobLedgerEntry@1100528502 : Record 11072005;
    BEGIN
      //C050712
      SetFilterInvoiced(SelectExtension, CumTotal, JobLedgerEntry);

      IF HomeCurrency THEN BEGIN
        JobLedgerEntry.CALCSUMS("Total Price (LCY)");
        InvAmnt := -JobLedgerEntry."Total Price (LCY)";
      END ELSE BEGIN
        JobLedgerEntry.CALCSUMS("Total Price");
        InvAmnt := -JobLedgerEntry."Total Price";
      END;

      EXIT(InvAmnt);
    END;

    PROCEDURE ShowTotalInvoiced@1100528502(SelectExtension@1100528503 : Integer;CumTotal@1100528500 : Boolean);
    VAR
      JobLedgerEntry@1100528502 : Record 11072005;
    BEGIN
      //C050712
      SetFilterInvoiced(SelectExtension, CumTotal, JobLedgerEntry);
      PAGE.RUNMODAL(0,JobLedgerEntry);
    END;

    BEGIN
    END.
  }
}

