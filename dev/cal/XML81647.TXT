OBJECT XMLport 81647 Imtech Svefaktura SVE
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSSE;
  }
  PROPERTIES
  {
    Direction=Export;
    Encoding=UTF-8;
    DefaultNamespace=urn:sfti:documents:BasicInvoice:1:0;
    UseDefaultNamespace=No;
    OnPreXMLport=VAR
                   SESetup@1101285000 : Record 11128004;
                 BEGIN
                   CompanyInformation.GET;
                   SalesReceivablesSetup.GET;
                   IF FinChargeTerms.FINDFIRST THEN;
                   GenLedgSetup.GET;
                   IF Customer.GET("Sales Invoice Header"."Sell-to Customer No.") THEN;
                   IF SalespersonPurchaser.GET("Sales Invoice Header"."Salesperson Code") THEN;

                   // 150109 IME255 <<
                   IF Customer."Stripped E-Invoice" AND NOT GenLedgSetup."Norwegian Localization Active" THEN
                     StrippedView := TRUE;
                   // 150109 IME255 >>
                   IF Customer."Stripped E-Invoice" AND GenLedgSetup."Norwegian Localization Active" THEN
                     SetNoRounding;

                   //>>180315 RFC1004
                   //k”parens Oppdragsgiverreferanse ska ligga p† radniv† i invoiceLine/OrderLineReference/OrderReference/BuyersID
                   // f”r alla kunder i Norge
                   // EHFBuyersID := FALSE;
                   // IF GenLedgSetup."Norwegian Localization Active" THEN BEGIN
                   //  IF (NOT SESetup.GET(SESetup."Line type"::Setup,'XML81647','EHFREF')) THEN BEGIN
                   //    SESetup."Line type" := SESetup."Line type"::Setup;
                   //    SESetup.Code := 'XML81647';
                   //    SESetup."Code 2" := 'EHFREF';
                   //    SESetup.Description := 'Principal Ref. to BuyersID on lines (bool)';
                   //    IF NOT SESetup.INSERT THEN
                   //      CLEAR(SESetup);
                   //  END;
                   //  EHFBuyersID := SESetup."Value (bool)";
                   // END;
                   //<<RFC1004

                   //[NOGOV-T10-R037]-Document level amounts cannot have more than 2 decimals
                   Currency.InitRoundingPrecision;
                   IF "Sales Invoice Header"."Currency Code"<>'' THEN
                     IF Currency.GET("Sales Invoice Header"."Currency Code") THEN ;

                   //>>190111.3
                   custBuyersID := FALSE;
                   IF SESetup.GET(SESetup."Line type"::Setup,'SFBYERSID',Customer."No.") THEN
                     custBuyersID := SESetup."Value (bool)";

                   SESetup."Value (bool)" := FALSE;
                   SESetup."Value (txt)" := '';
                   custAvtalID := '';
                   IF SESetup.GET(SESetup."Line type"::Mapping,'SFAVTID',Customer."No.") THEN
                     IF SESetup."Value (txt)" <> '' THEN custAvtalID := SESetup."Value (txt)";
                   // IF SESetup."Value (bool)" AND ProjectPrincipal.GET("Sales Invoice Header"."Job No.", "Sales Invoice Header"."Bill-to Customer No.") THEN
                   //  IF ProjectPrincipal."Order No. Customer" <> '' THEN custAvtalID := ProjectPrincipal."Order No. Customer";
                   IF SESetup."Value (bool)" AND ("Sales Invoice Header"."Principal Reference"<>'') THEN
                     custAvtalID := "Sales Invoice Header"."Principal Reference";
                   //<<190111
                 END;

  }
  ELEMENTS
  {
    { [{68F678BE-FE37-44C9-BF8B-CD65A60689D2}];  ;Invoice             ;Element ;Table   ;
                                                  SourceTable=Table112;
                                                  Temporary=Yes;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Customer.GET("Sales Invoice Header"."Sell-to Customer No.");
                                                                             //IF TranspMethod.GET("Sales Invoice Header"."Transport Method");
                                                                           END;
                                                                            }

    { [{97D6FBA8-09D3-41AD-9474-93CA56ADDA58}];1 ;xmlns:cac           ;Attribute;Text   ;
                                                  VariableName=xmlnscac;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnscac := 'urn:sfti:CommonAggregateComponents:1:0';
                                                                               END;
                                                                                }

    { [{81743FAC-DAB6-4347-A4DF-B22534E9174A}];1 ;xmlns:cbc           ;Attribute;Text   ;
                                                  VariableName=xmlnscbc;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnscbc := 'urn:oasis:names:tc:ubl:CommonBasicComponents:1:0';
                                                                               END;
                                                                                }

    { [{413C7397-7962-4A10-898E-C270D483E367}];1 ;xmlns:ccts          ;Attribute;Text   ;
                                                  VariableName=xmlnsccts;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnsccts := 'urn:oasis:names:tc:ubl:CoreComponentParameters:1:0';
                                                                               END;
                                                                                }

    { [{AACCA429-E3B6-4E43-BEFF-118EB3468255}];1 ;xmlns:cur           ;Attribute;Text   ;
                                                  VariableName=xmlnscur;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnscur := 'urn:oasis:names:tc:ubl:codelist:CurrencyCode:1:0';
                                                                               END;
                                                                                }

    { [{297024B9-CFE3-41CA-BFD0-BEE9A41ED9F0}];1 ;xmlns:sdt           ;Attribute;Text   ;
                                                  VariableName=xmlnssdt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnssdt := 'urn:oasis:names:tc:ubl:SpecializedDatatypes:1:0';
                                                                               END;
                                                                                }

    { [{9CB92598-553E-434A-A665-6240DCE05A93}];1 ;xmlns:udt           ;Attribute;Text   ;
                                                  VariableName=xmlnsudt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnsudt := 'urn:oasis:names:tc:ubl:UnspecializedDatatypes:1:0';
                                                                               END;
                                                                                }

    { [{3E5F1CB4-A9D8-4C89-8978-676C7E8D7AE6}];1 ;xmlns:xsi           ;Attribute;Text   ;
                                                  VariableName=xmlnsxsi;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 xmlnsxsi := 'http://www.w3.org/2001/XMLSchema-instance';
                                                                               END;
                                                                                }

    { [{72194F09-AA8B-40FD-A63C-AF3E735C9553}];1 ;ID                  ;Element ;Text    ;
                                                  VariableName=InvoiceNo;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 GeneralLedgerSetup@1100285400 : Record 98;
                                                                               BEGIN
                                                                                 // 150506 ITERO.MH Norwegian localization <<
                                                                                 //GeneralLedgerSetup.GET();
                                                                                 //IF (GeneralLedgerSetup."Norwegian Localization Active") THEN
                                                                                    InvoiceNo := "Sales Invoice Header"."No.";
                                                                                 //ELSE BEGIN
                                                                                 // 150506 ITERO.MH Norwegian localization >>
                                                                                 //   IF SalesReceivablesSetup."External Doc. No. as Pmt. Ref" THEN
                                                                                 //      InvoiceNo := "Sales Invoice Header"."External Document No."
                                                                                 //   ELSE
                                                                                 //      InvoiceNo := "Sales Invoice Header"."No.";
                                                                                 //END;
                                                                                 SetFirstLineNo;
                                                                               END;
                                                                                }

    { [{9146A99D-B138-4087-961A-552A5A8D041F}];1 ;cbc:IssueDate       ;Element ;Text    ;
                                                  VariableName=IssueDate;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IssueDate := FORMAT(TODAY, 0, 9);
                                                                                 IssueDate := FORMAT("Sales Invoice Header"."Posting Date", 0, 9);
                                                                                 //140613
                                                                               END;
                                                                                }

    { [{EA018809-97EB-4408-9E83-E509C3EC807D}];1 ;InvoiceTypeCode     ;Element ;Text    ;
                                                  VariableName=InvoiceTypeCode;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF Credit THEN
                                                                                   InvoiceTypeCode := '381'
                                                                                 ELSE
                                                                                   InvoiceTypeCode := '380'
                                                                               END;
                                                                                }

    { [{545BA7E6-122E-440C-BC6A-60B97EF25A1F}];2 ;name                ;Attribute;Text   ;
                                                  VariableName=InvoiceTypeCode_name;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F416E95A-D169-4FDC-8937-8231714B2863}];2 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=InvoiceTypeCode_codeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8F83669B-B744-497D-9299-E7226C98C085}];2 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Invo_codeListAgencyID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{983B6FD0-258F-4059-AC95-1EFC3AC1A238}];2 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Invo_codeListAgencyName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DAA24273-30A3-4E90-B160-F9420D136855}];2 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Invo_codeListName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E2CBDC79-3131-46AC-8439-606A7D642203}];2 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Invo_codeListVersionID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B9C767EA-19C8-43AB-975D-899B504C4B8A}];2 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=InvoiceTypeCode_codeListURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{269FEE01-BE6E-4B0D-86C6-D07C651A2E1D}];2 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Invo_codeListSchemeURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{56E13B88-07F0-4279-8762-A0580453BB59}];2 ;languageID          ;Attribute;Text   ;
                                                  VariableName=InvoiceTypeCode_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{82BF1092-4E3A-4589-ABA3-3DCE994E1664}];1 ;cbc:Note            ;Element ;Text    ;
                                                  VariableName=Note;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 CR@1100285000 : Char;
                                                                                 LF@1100285001 : Char;
                                                                                 TextField@1100285002 : Text;
                                                                               BEGIN
                                                                                 //IF (CompanyInformation."Country/Region Code" = 'NO') THEN Note := txtInvoiceGeneralTextNO ELSE Note := txtInvoiceGeneralTextSE;
                                                                                 CR := 13;
                                                                                 LF := 10;

                                                                                 //Note := "Sales Invoice Header"."Invoice Text";

                                                                                 IF Credit THEN
                                                                                   SalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Credit Memo")
                                                                                 ELSE
                                                                                   SalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Invoice");
                                                                                 SalesReportTextLine.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                                 SalesReportTextLine.SETRANGE("Text Line Type", SalesReportTextLine."Text Line Type"::"Before Detail");
                                                                                 SalesReportTextLine.SETFILTER(Text, '<>%1', '');
                                                                                 SalesReportTextLine.SETRANGE("Document Line No.", FirstLineNo);
                                                                                 ExtraTextField := '';
                                                                                 IF SalesReportTextLine.FINDSET(FALSE) THEN REPEAT
                                                                                    TextField := SalesReportTextLine.Text;
                                                                                    //IF (COPYSTR(TextField, 1, 5) <> ' <div') THEN      // 160919 ITERO.AC IME484
                                                                                    IF CheckFirstLineOfProj(SalesReportTextLine) THEN    // 160919 ITERO.AC IME484
                                                                                       Note := Note + DeleteHTML(TextField) + FORMAT(CR) + FORMAT(LF);
                                                                                 //>> 160919 ITERO.AC IME484 Do not use ExtraTextField
                                                                                 //   ELSE
                                                                                 //      ExtraTextField := '* ' + DeleteHTML(TextField);
                                                                                 //<< 160919 ITERO.AC IME484
                                                                                 UNTIL SalesReportTextLine.NEXT = 0;
                                                                               END;
                                                                                }

    { [{016A95E6-B1AB-4CB8-B3C6-E6AD578426E1}];2 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Note_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6FFB9B79-1762-4CA3-A897-D45F4336DC0A}];2 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Note_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6C6B5DCF-730F-4E87-91CC-64B849B6FED8}];1 ;TaxPointDate        ;Element ;Table   ;
                                                  VariableName=int_TaxPointDate;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_TaxPointDate.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{87811FF3-F1E8-4D13-9F3B-28E89A70CF0F}];1 ;InvoiceCurrencyCode ;Element ;Text    ;
                                                  VariableName=InvoiceCurrencyCode;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   InvoiceCurrencyCode := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   InvoiceCurrencyCode := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{95A8C2D4-C906-479D-B430-84C2C83AB687}];1 ;TaxCurrencyCode     ;Element ;Table   ;
                                                  VariableName=int_TaxCurrCode;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_TaxCurrCode.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{DB4DF9D8-992B-49CD-BCC1-353B41367A7D}];1 ;LineItemCountNumeric;Element ;Text    ;
                                                  VariableName=LineItemCountNumeric;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 CustomerPostingGroup@1100285003 : Record 92;
                                                                                 Index@1100285000 : Integer;
                                                                                 ItemCount@1100285001 : Integer;
                                                                                 lvSalesReportTextLine@1100285002 : Record 11071912;
                                                                                 ReverseVAT@1100285500 : Boolean;
                                                                               BEGIN

                                                                                 Index := 1;

                                                                                 CustomerPostingGroup.GET("Sales Invoice Header"."Customer Posting Group"); // 160509 IME473 ITERO.MH

                                                                                 IF SalesInvoiceLineTEMP.FINDSET(FALSE) THEN REPEAT

                                                                                   IF (SalesInvoiceLineTEMP."Line No." = 10) AND (SalesInvoiceLineTEMP.Description = 'R„ntefaktura') THEN
                                                                                     FinChargeMemo := TRUE; // Trigger Fin. charge order

                                                                                   ReverseVAT := FALSE;
                                                                                   IF VATPostingSetup.GET(SalesInvoiceLineTEMP."VAT Bus. Posting Group", SalesInvoiceLineTEMP."VAT Prod. Posting Group") THEN BEGIN
                                                                                     IF (VATPostingSetup."VAT Calculation Type" = VATPostingSetup."VAT Calculation Type"::"Reverse Charge VAT") THEN BEGIN
                                                                                       ReverseVAT := TRUE;
                                                                                     END;
                                                                                   END;

                                                                                   Index := GetVATRateIndex(SalesInvoiceLineTEMP."VAT %", ReverseVAT, SalesInvoiceLineTEMP."VAT %"<>0);
                                                                                   VATRate[Index] := SalesInvoiceLineTEMP."VAT %";
                                                                                   VATRateExemption[Index] := ReverseVAT;
                                                                                   VATRateExistsOnLines[Index] := TRUE;  //[NONAT-T14-R030]-Tax category on line level MUST match provided tax categories on document level.

                                                                                   IF SalesInvoiceLineTEMP."VAT %" = VATRate[Index] THEN BEGIN
                                                                                      TaxableAmountVar[Index] += SalesInvoiceLineTEMP.Amount;
                                                                                   END;
                                                                                   // 160509 IME473 ITERO.MH  - found rounding based on posting group for invoice - added more in if-sentence:
                                                                                   IF (ABS(SalesInvoiceLineTEMP.Amount) < 1) AND (SalesInvoiceLineTEMP.Amount <> 0) AND (SalesInvoiceLineTEMP."VAT %" = 0)
                                                                                       AND (SalesInvoiceLineTEMP."System-Created Entry" = TRUE)
                                                                                       AND (SalesInvoiceLineTEMP.Type = SalesInvoiceLineTEMP.Type::"G/L Account")
                                                                                       AND (SalesInvoiceLineTEMP."No." = CustomerPostingGroup."Invoice Rounding Account") THEN BEGIN
                                                                                     RoundOffAmount := SalesInvoiceLineTEMP.Amount;
                                                                                     RoundOffVATRateIndex := Index;
                                                                                   END;

                                                                                 UNTIL SalesInvoiceLineTEMP.NEXT=0;

                                                                                 //OM ROT:
                                                                                 //140612 DJ
                                                                                 //(CustLedgerEntry."ROT AMount" * 0.8) detta „r ett radbelopp ex moms som vilken sales invoie line som helst med 25% moms
                                                                                 Index := GetVATRateIndex(0, FALSE,TRUE);
                                                                                 VATRate[Index] := 0;

                                                                                 //>> 171127 RFC240
                                                                                 //TaxableAmountVar[Index] -= CustLedgerEntry."Amount ROT";
                                                                                 TaxableAmountVar[Index] -= CustLedgerEntry."Amount ROT" + CustLedgerEntry."Amount RUT";
                                                                                 //<< RFC240


                                                                                 // ™resavrundning ska tas bort fr†n radsummering:
                                                                                 IF (RoundOffAmount <> 0) THEN
                                                                                   TaxableAmountVar[RoundOffVATRateIndex] -= RoundOffAmount;

                                                                                 IF StrippedView THEN
                                                                                   SalesInvoiceLineTEMP.SETFILTER(Amount, '<>0');


                                                                                 IF RoundOffAmount = 0 THEN
                                                                                   ItemCount := SalesInvoiceLineTEMP.COUNT
                                                                                 ELSE
                                                                                   ItemCount := SalesInvoiceLineTEMP.COUNT - 1;

                                                                                 //>> 160920 ITERO.AC IME484 Caluclate number of Footer lines (Added in separate Item Loop)
                                                                                 IF NOT StrippedView THEN BEGIN  // 160927 ITERO.AC Added check for stripped invoice
                                                                                   lvSalesReportTextLine.RESET();
                                                                                   lvSalesReportTextLine.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                                   lvSalesReportTextLine.SETRANGE("Text Line Type", SalesReportTextLine."Text Line Type"::Footer);
                                                                                   lvSalesReportTextLine.SETFILTER(Text, '<>%1', '');

                                                                                   ItemCount += lvSalesReportTextLine.COUNT;
                                                                                 END;                            // 160927 ITERO.AC Added check for stripped invoice
                                                                                 //<< 160920 ITERO.AC IME484

                                                                                 //Message('1Nu „r det %1', ItemCounT);

                                                                                 //>> 160919 ITERO.AC IME484 All lines for before detail and after detail (MARKED records) are now in SalesInvoiceLineTEMP

                                                                                 //IF (Credit) THEN lvSalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Credit Memo");
                                                                                 //IF (NOT Credit) THEN lvSalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Invoice");
                                                                                 //IF NOT (StrippedView) THEN BEGIN
                                                                                 //   lvSalesReportTextLine.RESET();
                                                                                 //   lvSalesReportTextLine.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                                 //   lvSalesReportTextLine.SETFILTER("Text Line Type", '%1|%2|%3',
                                                                                 //      SalesReportTextLine."Text Line Type"::"Before Detail",
                                                                                 //      SalesReportTextLine."Text Line Type"::"After Detail",
                                                                                 //      SalesReportTextLine."Text Line Type"::Footer);
                                                                                 //   lvSalesReportTextLine.SETFILTER(Text, '<>%1', '');
                                                                                 //
                                                                                 //   ItemCount += lvSalesReportTextLine.COUNT();
                                                                                 //   IF (InvoiceExtraLine) THEN ItemCount -= 1; // Skip "Avdrag" text line
                                                                                 //
                                                                                 //   //Message('2Nu „r det %1', ItemCounT);
                                                                                 //   lvSalesReportTextLine.RESET();
                                                                                 //   lvSalesReportTextLine.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                                 //   lvSalesReportTextLine.SETRANGE("Text Line Type", lvSalesReportTextLine."Text Line Type"::"Before Detail");
                                                                                 //   lvSalesReportTextLine.SETRANGE("Document Line No.", FirstLineNo);
                                                                                 //   lvSalesReportTextLine.SETFILTER(Text, '<>%1', '');
                                                                                 //   ItemCount -= lvSalesReportTextLine.COUNT;
                                                                                 //   IF (ExtraTextField <> '') AND (NOT NoRounding) THEN ItemCount += 1;
                                                                                 //   //Message('3Nu „r det %1', ItemCounT);
                                                                                 //
                                                                                 //   IF (NoRounding) THEN BEGIN
                                                                                 //      lvSalesReportTextLine.SETRANGE("Document Line No.");
                                                                                 //      lvSalesReportTextLine.SETRANGE("Text Line Type", SalesReportTextLine."Text Line Type"::Footer);
                                                                                 //      ItemCount -= lvSalesReportTextLine.COUNT;
                                                                                 //   END;
                                                                                 //END;
                                                                                 //<< 160919 ITERO.AC IME484
                                                                                 LineItemCountNumeric := FORMAT(ItemCount);
                                                                               END;
                                                                                }

    { [{287BC84D-2850-4ADA-8087-6637C641940C}];1 ;AdditionalDocumentReference;Element;Table;
                                                  VariableName=int_AdDocRef;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 lvSalesReportTextLine@1100285000 : Record 11071912;
                                                                               BEGIN
                                                                               END;

                                                  Export::OnPreXMLItem=VAR
                                                                         lvSalesInvoiceHeader@1100285500 : Record 112;
                                                                         lvSalesCrMemoHeader@1100285501 : Record 114;
                                                                         lvCount@1100285502 : Integer;
                                                                       BEGIN
                                                                         DocumentLink.RESET;
                                                                         IF Credit THEN
                                                                           BEGIN
                                                                             DocumentLink.SETRANGE("Table No.", DATABASE::"Sales Cr.Memo Header");
                                                                             lvSalesCrMemoHeader.GET("Sales Invoice Header"."No.");
                                                                             lvSalesCrMemoHeader.SETRECFILTER;
                                                                             RecRef.GETTABLE(lvSalesCrMemoHeader);
                                                                           END
                                                                         ELSE
                                                                           BEGIN
                                                                             DocumentLink.SETRANGE("Table No.", DATABASE::"Sales Invoice Header");
                                                                             IF NOT (lvSalesInvoiceHeader.GET("Sales Invoice Header"."No.")) THEN BEGIN
                                                                               int_AdDocRef.SETFILTER(Number, '1..-1');
                                                                               EXIT;
                                                                             END;
                                                                             lvSalesInvoiceHeader.SETRECFILTER;
                                                                             RecRef.GETTABLE(lvSalesInvoiceHeader);
                                                                           END;
                                                                         DocumentLink.SETRANGE("Record ID", RecRef.RECORDID);
                                                                         lvCount := 0;
                                                                         IF DocumentLink.FINDSET(FALSE) THEN REPEAT
                                                                           IF (DocumentProperties.GET(DocumentLink."Document No.")) AND (DocumentProperties.File <> '') THEN
                                                                             lvCount += 1;
                                                                         UNTIL DocumentLink.NEXT = 0;

                                                                         IF lvCount > 0 THEN BEGIN
                                                                           int_AdDocRef.SETFILTER(Number, '%1..%2', 1, lvCount);
                                                                           DocumentLink.FINDSET(FALSE);
                                                                         END ELSE
                                                                           int_AdDocRef.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{CC1246EA-4FE1-4673-90C2-5FB3E8714BC2}];2 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Addi_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 DocumentManagement@1100285101 : Codeunit 11012406;
                                                                                 FileMgt@1100285102 : Codeunit 419;
                                                                                 FileStorageType@1100285103 : ' ,File System on Premise,SharePoint Online,Azure File Storage,,,,,,,,PPT,DPTDUAL';
                                                                                 StorageURI@1100285104 : Text;
                                                                                 Dummy@1100285105 : Text;
                                                                                 ShortFileName@1100285106 : Text;
                                                                                 TargetStorageType@1100285107 : Option;
                                                                                 TargetStorageURI@1100285108 : Text;
                                                                                 ErrorMessage@1100285109 : Text;
                                                                               BEGIN
                                                                                 SalesReceivablesSetup.TESTFIELD("Export Path Svefaktura Attach.");

                                                                                 DocumentProperties.GET(DocumentLink."Document No.");

                                                                                 // IME 151103 RFC-001 ITERO.MH
                                                                                 IF DocumentProperties.File = '' THEN
                                                                                   currXMLport.SKIP;

                                                                                 // Move file to outgoing folder
                                                                                 // 151012 Added correction of filename: Deleted all non-english signs in filename.
                                                                                 Addi_ID := DELCHR(DocumentProperties.File, '=', DELCHR(DocumentProperties.File, '=', '01234567890.-_ abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'));
                                                                                 IF NOT DontMoveFiles THEN BEGIN //IME271
                                                                                   IF GUIALLOWED THEN
                                                                                     BEGIN
                                                                                     //    cuExternalDocumentMgmt.MoveCopyFile(
                                                                                     //      SalesReceivablesSetup."Export Path Svefaktura Attach." + '\', //TargetDocumentDirectory
                                                                                     //      '',  //TargetDocumentServiceDocumentSubdir
                                                                                     //      cuExternalDocumentMgmt.FolderName(DocumentProperties."Document Type",''), //SourceDocumentDirectory
                                                                                     //      DocumentProperties.File,  //SourceFileNameWithExtension
                                                                                     //      '',  //SourceDocumentProperties."Document Service URL"
                                                                                     //      TRUE,  //CopyBln
                                                                                     //      CorrectedFilename, //TargetFileNameWithExtension
                                                                                     //      TargetDocumentServiceURL  //TargetDocumentProperties."Document Service URL"
                                                                                     //      )
                                                                                     //

                                                                                       StorageURI := DocumentProperties.GetStorageURI;
                                                                                       FileMgt.SplitFileAbsPathName(StorageURI,Dummy,ShortFileName);

                                                                                       TargetStorageType := FileStorageType::"File System on Premise";
                                                                                       TargetStorageURI := SalesReceivablesSetup."Export Path Svefaktura Attach." + '\' + Addi_ID;

                                                                                       DocumentManagement.PrepareDocumentRegistration(
                                                                                         ShortFileName,DocumentProperties."Document Type",DocumentProperties."Creation Date",TargetStorageURI,TargetStorageType);
                                                                                       IF DocumentManagement.CopyStorageContent(DocumentProperties."Storage Type",TargetStorageType, StorageURI, TargetStorageURI,ErrorMessage) THEN
                                                                                         DocumentProperties.ValidateStorageURI(DocumentProperties."Storage Type",TargetStorageURI);
                                                                                     END

                                                                                   ELSE BEGIN
                                                                                     FILE.COPY(cuExternalDocumentMgmt.FolderName(DocumentProperties."Document Type",'') + DocumentProperties.File,
                                                                                       SalesReceivablesSetup."Export Path Svefaktura Attach." + '\' + Addi_ID);
                                                                                   END;
                                                                                 END;
                                                                                 IF (DocumentLink.NEXT = 0) THEN;
                                                                               END;
                                                                                }

    { [{88BBD47C-AA65-442B-99BF-DD701DCA292A}];3 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=ID_identificationSchemeID;
                                                  TextType=Text;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ID_identificationSchemeID := 'ATS';
                                                                               END;
                                                                                }

    { [{55B40886-A01E-49DD-821B-74D21AEAE3CB}];3 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN;
                                                  TextType=Text;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 identificationSchemeAgencyN := 'SFTI';
                                                                               END;
                                                                                }

    { [{5851DDF5-3E4C-4FF6-8376-35910375A9C5}];1 ;AdditionalDocumentReference;Element;Table;
                                                  VariableName=int_AdDocRef2;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=VAR
                                                                         lvSalesInvoiceHeader@1100285500 : Record 112;
                                                                         lvSalesCrMemoHeader@1100285501 : Record 114;
                                                                         lvCount@1100285502 : Integer;
                                                                       BEGIN
                                                                         //IF ("Sales Invoice Header"."Job No." <> '') THEN BEGIN
                                                                            int_AdDocRef2.SETFILTER(Number, '1');
                                                                         //END ELSE
                                                                         //   int_AdDocRef2.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{75ED10F1-9291-47CE-8C8E-78A5F0B66F47}];2 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Addi_ID2;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // 170424 RFC224 New use of ACD id element
                                                                                 // old code:
                                                                                 // //Addi_ID2 := "Sales Invoice Header"."Job No.";
                                                                                 //
                                                                                 // IF (DimensionValue.GET(GenLedgSetup."Global Dimension 1 Code", "Sales Invoice Header"."Shortcut Dimension 1 Code")) THEN
                                                                                 //    Addi_ID2 += DimensionValue.Code + ' ' + DimensionValue.Name
                                                                                 // ELSE Addi_ID2 := '-';
                                                                                 // new code:
                                                                                 Addi_ID2 := "Sales Invoice Header"."Job No.";
                                                                                 //IF (SalesInvoiceLineTEMP.FINDFIRST()) AND (SalesInvoiceLineTEMP."Extension Contract" <> '') THEN
                                                                                 //   IF (ExtensionContract.GET("Sales Invoice Header"."Job No.", SalesInvoiceLineTEMP."Extension Contract")) THEN
                                                                                 //      Addi_ID2 += '-' + ExtensionContract."Contract No.";
                                                                                 IF Addi_ID2 = '' THEN
                                                                                    Addi_ID2 := '-';
                                                                               END;
                                                                                }

    { [{35617190-AAB8-497F-8C69-BC8E999EA126}];3 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=ID_identificationSchemeID2;
                                                  TextType=Text;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ID_identificationSchemeID2 := 'ACD';
                                                                               END;
                                                                                }

    { [{9128AAC9-E857-4168-9187-C3383D817B2B}];3 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN02;
                                                  TextType=Text;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080
                                                                                 //AdditionalDocumentReference: N„r v„rdena CT, ACD, DQ eller ATS anv„nds ska identificationSchemeAgencyName vara = 'SFTI' [R-86]
                                                                                 identificationSchemeAgencyN02 := 'SFTI';
                                                                               END;
                                                                                }

    { [{DB76B5A2-7E2C-41B7-8892-4FD8399D5E41}];1 ;AdditionalDocumentReference;Element;Table;
                                                  VariableName=int_AdDocRefCT;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 lvSalesReportTextLine@1100285000 : Record 11071912;
                                                                               BEGIN
                                                                               END;

                                                  Export::OnPreXMLItem=VAR
                                                                         lvSalesInvoiceHeader@1100285500 : Record 112;
                                                                         lvSalesCrMemoHeader@1100285501 : Record 114;
                                                                         lvCount@1100285502 : Integer;
                                                                       BEGIN
                                                                         //190111, RFC1080.3
                                                                         int_AdDocRefCT.SETFILTER(Number, '1');
                                                                         IF custAvtalID = '' THEN
                                                                           int_AdDocRefCT.SETFILTER(Number, '1..-1');

                                                                         Addi_IDCT := custAvtalID;
                                                                         ID_identificationSchemeIDCT := 'CT';
                                                                         identificationSchemeAgencyCT := 'SFTI';
                                                                       END;
                                                                        }

    { [{3F76849A-0433-4EDC-AB28-870491CFC697}];2 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Addi_IDCT;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{BD2B5726-A62A-467B-AA59-B073D842894E}];3 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=ID_identificationSchemeIDCT;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{518D28C8-D1F5-4A11-867E-511C45CC751E}];3 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyCT;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{42EB45B8-9A9B-4385-89A5-DF4A3B1540C7}];1 ;cac:BuyerParty      ;Element ;Text    ;
                                                  VariableName=BuyerParty;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{1BBFDEA6-9DBF-4068-B0DE-BE7691FE4A17}];2 ;cac:Party           ;Element ;Text    ;
                                                  VariableName=Party;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{FCAABE66-DE49-441B-AF44-73DA5C2B8C66}];3 ;cac:PartyIdentification;Element;Text  ;
                                                  VariableName=PartyIdentification;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded }

    { [{5CDECD8F-6CC8-4F33-93FC-44D6D27A62C9}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=PartyIdentification_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PartyIdentification_ID := Customer."No.";
                                                                               END;
                                                                                }

    { [{3210278F-D76A-49F4-89CE-DE8508B2641E}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI1;
                                                  TextType=Text;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 identificationSchemeAgencyI1 := '';
                                                                               END;
                                                                                }

    { [{EB18464E-C20C-4464-BE38-8B4D4345277B}];3 ;cac:PartyIdentification;Element;Table ;
                                                  VariableName=int_GLN;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         // RFC189 170424 Added GLN No as possible buyers party id
                                                                         gGLNNo := GetGLNNoFromInvoiceAddress("Sales Invoice Header"."Bill-to Customer No.", "Sales Invoice Header"."Alternative Bill-to Address");
                                                                         IF gGLNNo <> '' THEN BEGIN
                                                                           PartyIdentification_IDGLN := gGLNNo;
                                                                           int_GLN.SETRANGE(Number, 1);
                                                                         END ELSE BEGIN
                                                                           int_GLN.SETRANGE(Number, 1, -1);
                                                                         END;
                                                                       END;
                                                                        }

    { [{12C394F2-D73B-49FE-97E0-76C096A9BD27}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=PartyIdentification_IDGLN;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{51915B0F-D606-4D0E-8196-6721180BB69F}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeGLN;
                                                  TextType=Text;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // RFC189 170424 If GLN No then schemeagencyid must be '9', else blank
                                                                                 identificationSchemeGLN := '9';
                                                                               END;
                                                                                }

    { [{4D8AC522-9817-4F27-A9C0-05B536F1C5CF}];3 ;cac:PartyName       ;Element ;Text    ;
                                                  VariableName=PartyName;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{16B9C4EC-023D-4FBA-BCB8-40F962BDCC8B}];4 ;cbc:Name            ;Element ;Text    ;
                                                  VariableName=Name;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Name := "Sales Invoice Header"."Bill-to Name";
                                                                               END;
                                                                                }

    { [{F7A1A3F1-3608-47A6-8DA3-50009B375EEF}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Name_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3CCF05EF-967E-4C42-98C8-7FB716B8110D}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Name_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6FE09C9F-3840-4799-9AE3-676B6805379A}];3 ;cac:Address         ;Element ;Text    ;
                                                  VariableName=Address;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{717E137A-1A67-4D21-A4CC-AFA83690E1EE}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Address_ID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080
                                                                                 IF Address_ID = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2ADB99DC-25AE-41F3-B79C-81434F28BDFF}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Addr_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{30B0BC3A-EB06-431F-B05A-102921BD14B2}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{38E24DD0-14AC-4BA6-B5D7-47CF9FCE8E44}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{844585E7-06BC-40FC-A068-825BD83A93CF}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Addr_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6797B9C2-118F-46FC-ACED-E2912EBCF66C}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7CFD1A99-4E0C-4B79-B051-9861A2B584F8}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Addr_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E797F54F-02FF-4515-8D6A-28F4DDEC4146}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6CA3DF49-1937-4CBE-875E-B13E22F425FE}];4 ;cbc:Postbox         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Sales Invoice Header::Bill-to Name 2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassField=BEGIN
                                                                              //RFC1080
                                                                              IF "Sales Invoice Header"."Bill-to Name 2" = '' THEN currXMLport.SKIP;
                                                                            END;
                                                                             }

    { [{C5EB2C3E-3FCC-4B5C-8937-C43022CB8254}];4 ;cbc:StreetName      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Sales Invoice Header::Bill-to Address;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassField=BEGIN
                                                                              //RFC1080
                                                                              IF "Sales Invoice Header"."Bill-to Address" = '' THEN currXMLport.SKIP;
                                                                            END;
                                                                             }

    { [{678827AE-9B61-4D85-9976-53C082AE7F6F}];4 ;cbc:Department      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Sales Invoice Header::Bill-to Address 2;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassField=BEGIN
                                                                              //RFC1080
                                                                              IF "Sales Invoice Header"."Bill-to Address 2" = '' THEN currXMLport.SKIP;
                                                                            END;
                                                                             }

    { [{C619155C-3289-4DB4-ABC0-2AD3C7337CE6}];4 ;cbc:CityName        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Sales Invoice Header::Bill-to City;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassField=BEGIN
                                                                              //RFC1080
                                                                              IF "Sales Invoice Header"."Bill-to City" = '' THEN currXMLport.SKIP;
                                                                            END;
                                                                             }

    { [{67505006-4616-4836-9C34-E03D58E33B8C}];4 ;cbc:PostalZone      ;Element ;Text    ;
                                                  VariableName=PostalZone;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PostalZone := CheckValidChrs("Sales Invoice Header"."Bill-to Post Code");
                                                                               END;
                                                                                }

    { [{AAD4C948-BA8E-400C-8C25-D90850E8FA6B}];4 ;cac:Country         ;Element ;Table   ;
                                                  VariableName=int_Country1;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         //>>RFC1169.5
                                                                         // IF Customer."Country/Region Code" = '' THEN
                                                                         IF (Customer."Country/Region Code" = '') AND (CompanyInformation."Country/Region Code" = '') THEN
                                                                         //<<RFC1169.5
                                                                           int_Country1.SETFILTER(Number, '1..-1')
                                                                         ELSE
                                                                           int_Country1.SETFILTER(Number, '1');
                                                                       END;
                                                                        }

    { [{7F6B5DF6-37F3-4483-9B11-9A55A5EA0802}];5 ;cac:IdentificationCode;Element;Text   ;
                                                  VariableName=IdentificationCode;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentificationCode := Customer."Country/Region Code";

                                                                                 //RFC1169.5
                                                                                 IF IdentificationCode = '' THEN IdentificationCode := CompanyInformation."Country/Region Code";
                                                                               END;
                                                                                }

    { [{2AF88B07-F71C-483E-A09A-42676A748756}];6 ;name                ;Attribute;Text   ;
                                                  VariableName=IdentificationCode_name;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{95CBD2C0-4366-46F8-A1FC-BCDA21467A7A}];6 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=Iden_codeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F837A51E-A998-4FBE-984C-56D774718079}];6 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Iden_codeListAgencyID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{54A9BBB6-1932-4FFF-A41D-B7FE5354142F}];6 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Iden_codeListAgencyName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{48019E8D-6120-4152-BD37-E10CD529F95C}];6 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Iden_codeListName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{28DBC99A-198E-4748-B715-84DC1000A7C3}];6 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Iden_codeListVersionID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5801C0A0-3779-4DF6-9134-7E6416DB700A}];6 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=Iden_codeListURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2BC76C26-88F8-4BEA-9284-C06E966D4E28}];6 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Iden_codeListSchemeURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{04DE6BB6-9881-4A7C-BA83-6A9BFEC5D95A}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Iden_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3C610DBB-51FC-4A59-909F-CB806529D331}];3 ;cac:PartyTaxScheme  ;Element ;Table   ;
                                                  VariableName=BuyerTax;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         BuyerTax.SETRANGE(Number, 1, 2);
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //RFC1080.1
                                                                             CASE BuyerTax.Number OF
                                                                               1: CompanyID := Customer."VAT Registration No.";
                                                                             //RFC1169
                                                                             //    Organisations- och momsregistreringsnummer skall skickas som en teckenstr„ng utan redigeringstecken (som blanka bindesstreck eller annat) [R-36]
                                                                             //  2: //CompanyID := Customer."COC Registration No.";
                                                                               2: CompanyID := DELCHR(Customer."COC Registration No.",'=',DELCHR(Customer."COC Registration No.",'=','0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'));
                                                                             //RFC1169
                                                                             END;

                                                                             IF CompanyID = '' THEN
                                                                               currXMLport.SKIP;
                                                                             //RFC1080
                                                                           END;
                                                                            }

    { [{61E6F733-8569-42FC-AE1E-5D141831573C}];4 ;cac:CompanyID       ;Element ;Text    ;
                                                  VariableName=CompanyID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080.1, moved to BuyerTax - Export::OnAfterGetRecord
                                                                                 // CASE BuyerTax.Number OF
                                                                                 //  1: CompanyID := Customer."VAT Registration No.";
                                                                                 //  2: CompanyID := Customer."COC Registration No.";
                                                                                 // END;
                                                                                 //RFC1080
                                                                               END;
                                                                                }

    { [{E9BBE266-3CAC-41AC-90A8-386F435D1B58}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Comp_identificationSchemeID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5B471082-CDE1-467E-8089-8B1828CEDA91}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{AFF8D255-7514-4C70-98CC-7606148C42F5}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{199BC119-6235-4692-914D-C27289D9CB94}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Comp_identificationSchemeUR;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{00050B56-1F47-4281-BAA6-D5962AFAF907}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{20120E6C-99C3-4161-A917-F91354A67063}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Comp_identificationSchemeNa;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{ACFF09CC-BA99-43DE-9B01-A88DDD908582}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=Comp_identificationSchemeDa;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A97197CE-1ADC-44C5-A0CD-26C9364AFEDB}];4 ;cbc:ExemptionReason ;Element ;Text    ;
                                                  VariableName=ExemptionReason;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF (BuyerTax.Number = 2) THEN BEGIN
                                                                                 //   IF (CompanyInformation."Country/Region Code" = 'NO') THEN ExemptionReason := TextNO ELSE ExemptionReason := TextSE;
                                                                                 //END;
                                                                                 //IF (BuyerTax.Number = 1) THEN
                                                                                 // 150507
                                                                                 ExemptionReason := '';
                                                                                 //RFC1080
                                                                                 IF ExemptionReason = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F4294BD0-03AE-442F-BFB1-2C996DCE82BF}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=ExemptionReason_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1A3C7E3B-683E-495A-B2F6-52499159722E}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Exem_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B0CDD2E0-3CC3-483D-B096-4F925DCB6D97}];4 ;cac:RegistrationAddress;Element;Text  ;
                                                  VariableName=RegistrationAddress;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080.2
                                                                                 IF BuyerTax.Number <> 2 THEN
                                                                                   currXMLport.SKIP;
                                                                                 //RFC1080
                                                                               END;
                                                                                }

    { [{BBA0458A-33A3-4309-B778-4B27D35FD73A}];5 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=RegistrationAddress_ID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CASE BuyerTax.Number OF
                                                                                   1: RegistrationAddress_ID := Customer."VAT Registration No.";
                                                                                   2: RegistrationAddress_ID := Customer."COC Registration No.";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{A5C37E37-8BC1-4DA4-9096-D138FA20946E}];6 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Regi_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E2DBE95D-88D4-4138-B5F5-855058D7A976}];6 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{99C5ACEE-5D01-4C93-99CF-3371FE07B1D4}];6 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{11BCD1F0-30D1-4ED8-9DCF-58EFBAA9B9C9}];6 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Regi_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C494EF39-CFBA-433A-9E14-ED3FBE77D81B}];6 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3105E5BD-068D-43B6-B34F-7B0AB8DAF7B7}];6 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Regi_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{75D9F82E-53E8-4E1F-BF5A-E10A2564E5A9}];6 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{75D07560-A460-4713-A762-3192E7D96FD5}];5 ;cbc:StreetName      ;Element ;Text    ;
                                                  VariableName=Regi_StreetName;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Regi_StreetName := Customer.Address;
                                                                                 //140603
                                                                                 //RFC1080
                                                                                 IF Regi_StreetName = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{9FDD3B78-9054-4D12-AACE-BF9A4550F05F}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Regi_StreetName_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{75933C17-EBD4-43B6-8C1D-B4CAA695EBA3}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_StreetName_languageLoc;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4DBE0C10-E759-4E1E-A0EF-2B3EC85AAC6A}];5 ;cbc:Department      ;Element ;Text    ;
                                                  VariableName=Regi_Department;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080
                                                                                 IF Regi_Department = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{E8D1AB8A-2D43-466B-9E8B-7428F4FE69A9}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Regi_Department_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2C79D9F2-E877-4331-919E-EFA6A6CB347B}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_Department_languageLoc;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B39050FE-6120-41D4-94B7-91D16A3B5D54}];5 ;cbc:CityName        ;Element ;Text    ;
                                                  VariableName=Regi_CityName;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Regi_CityName := Customer.City;
                                                                                 //140603
                                                                                 //RFC1080
                                                                                 IF Regi_CityName = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{B48BD954-EBEE-405F-8F1A-03D114BF8A98}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Regi_CityName_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C459E028-8274-47D7-8DB1-4A562C942EB9}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_CityName_languageLocal;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5B9731D7-233C-48D8-AE73-EE760E32E76B}];5 ;cbc:PostalZone      ;Element ;Text    ;
                                                  VariableName=Regi_PostalZone;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Regi_PostalZone := CheckValidChrs(Customer."Post Code");
                                                                                 //140603
                                                                               END;
                                                                                }

    { [{9EF55648-CF08-4914-A344-C41C7F88998B}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Regi_PostalZone_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{261A67E9-D1AF-437E-B22C-5AB02474B852}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_PostalZone_languageLoc;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{46F09C4C-2F33-4204-9D1B-A2388AB24E55}];5 ;cac:Country         ;Element ;Table   ;
                                                  VariableName=RegistrationAddress_Country;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         //>>RFC1169.5
                                                                         // IF Customer."Country/Region Code" = '' THEN
                                                                         IF (Customer."Country/Region Code" = '') AND (CompanyInformation."Country/Region Code"='') THEN
                                                                         //<<RFC1169.5
                                                                           RegistrationAddress_Country.SETFILTER(Number, '1..-1')
                                                                         ELSE
                                                                           RegistrationAddress_Country.SETFILTER(Number, '1');
                                                                       END;
                                                                        }

    { [{772C7535-2F45-4E03-BF76-92675B18FF47}];6 ;cac:IdentificationCode;Element;Text   ;
                                                  VariableName=Country_IdentificationCode;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Country_IdentificationCode := Customer."Country/Region Code";

                                                                                 //RFC1169.5
                                                                                 IF Country_IdentificationCode = '' THEN Country_IdentificationCode := CompanyInformation."Country/Region Code";
                                                                               END;
                                                                                }

    { [{BD02D345-07D2-4458-9DCE-5208A0DC76CE}];7 ;name                ;Attribute;Text   ;
                                                  VariableName=Coun_IdentificationCode_nam;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{96921CC8-31F9-4A67-92AF-F52ED6FC4E6C}];7 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=Country_Iden_codeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{149E2DF4-87A5-4E0D-8033-517D9411F6DE}];7 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Coun_Iden_codeListAgencyID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2636F5AA-A94B-4697-82AD-74BEA20E977E}];7 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Coun_Iden_codeListAgencyNam;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{FAB44C83-C7B0-47FC-82EE-8698C9E5B0F3}];7 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Country_Iden_codeListName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{10090813-3009-489C-9971-7FC891DDB5EF}];7 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Coun_Iden_codeListVersionID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{720DE0EC-91FB-48DA-A1ED-34188785515F}];7 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=Country_Iden_codeListURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DB3C0CD5-EE14-4B33-952B-884F063262C6}];7 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Coun_Iden_codeListSchemeURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F757F9B9-FBFE-4D44-8FF6-E381C9DDED17}];7 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Country_Iden_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{CFA004EA-5757-4326-8A00-F201C2B04BEA}];4 ;cac:TaxScheme       ;Element ;Text    ;
                                                  VariableName=TaxScheme;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{724BA8B9-FD75-4DEA-AE58-8F13A1C3C9DF}];5 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=TaxScheme_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CASE BuyerTax.Number OF
                                                                                   1: TaxScheme_ID := 'VAT';
                                                                                   2: TaxScheme_ID := 'SWT';
                                                                                 END;
                                                                               END;
                                                                                }

    { [{7D41103C-87EF-4297-ACF0-8317FBEBF4AD}];6 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=TaxS_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{24EC0E31-6206-453A-8654-6F616BAD5993}];6 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1A52A3F2-4386-4775-B8A1-732C15E87D34}];6 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{16C8D562-2CB3-4E7C-BCC8-960A25C5E844}];6 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{47925891-9802-48A8-BD39-DE44C875450E}];6 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4495C158-E744-4F28-85E0-31B3D0B329ED}];6 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{AF6A1DEA-1DB2-4A49-9DC9-6B02EF932036}];6 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5462BA20-69F2-4E52-B503-19A55EB0FBC2}];3 ;cac:Contact         ;Element ;Text    ;
                                                  VariableName=Contact;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ShiptoAddress@1100285100 : Record 222;
                                                                               BEGIN
                                                                                 //Contact := "Sales Invoice Header"."Your Reference";
                                                                                 Contact_Name := "Sales Invoice Header"."Sell-to Contact";
                                                                                 Telephone := "Sales Invoice Header"."Sell-to Contact Phone No.";
                                                                                 IF "Sales Invoice Header"."Alternative Bill-to Address" = '' THEN
                                                                                   ElectronicMail := Customer."E-Mail (Invoices)"
                                                                                 ELSE BEGIN
                                                                                   IF ShiptoAddress.GET("Sales Invoice Header"."Bill-to Customer No.",
                                                                                                       "Sales Invoice Header"."Alternative Bill-to Address") THEN BEGIN
                                                                                     ElectronicMail := ShiptoAddress."E-Mail (Invoices)";
                                                                                   END;
                                                                                 END;

                                                                                 //>>190109, RFC-1162
                                                                                 // IF NOT EHFBuyersID THEN
                                                                                 BEGIN
                                                                                   ElectronicMail := '';
                                                                                   IF ShiptoAddress.GET("Sales Invoice Header"."Bill-to Customer No.",
                                                                                                       "Sales Invoice Header"."Alternative Bill-to Address") THEN
                                                                                     ElectronicMail := ShiptoAddress."E-Mail (Invoices)";
                                                                                   IF ElectronicMail = '' THEN
                                                                                     ElectronicMail := Customer."E-Mail (Invoices)";
                                                                                   IF ElectronicMail = '' THEN
                                                                                     ElectronicMail := "Sales Invoice Header"."E-Mail (Invoices)";
                                                                                 END;
                                                                                 //<<190109

                                                                                 IF (Contact_Name='') AND (Telephone='') AND (ElectronicMail='') THEN currXMLport.SKIP;

                                                                                 IF Contact_Name = '' THEN
                                                                                   Contact_Name := '-';
                                                                                 IF Telephone = '' THEN
                                                                                   Telephone := '-';
                                                                               END;
                                                                                }

    { [{B6F5FFAD-2BF9-4859-8DF7-9062801EFF52}];4 ;cbc:Name            ;Element ;Text    ;
                                                  VariableName=Contact_Name;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ProjectPrincipal@1100285101 : Record 11012005;
                                                                               BEGIN
                                                                                 //RFC1080, moved to Contact - Export::OnBeforePassVariable
                                                                                 // //>> 160308 ITERO.AC RFC110 Use Contact Name from Sales Invoice Header instead of Project Principal Contact Name
                                                                                 // Contact_Name := "Sales Invoice Header"."Sell-to Contact";
                                                                                 // // Contact_Name := '';
                                                                                 // // IF (ProjectPrincipal.GET("Sales Invoice Header"."Job No.", "Sales Invoice Header"."Bill-to Customer No.")) THEN BEGIN
                                                                                 // //    ProjectPrincipal.CALCFIELDS("Contact Person Name");
                                                                                 // //    Contact_Name := ProjectPrincipal."Contact Person Name";
                                                                                 // // END;
                                                                                 // //<< 160308 ITERO.AC RFC110
                                                                                 // IF Contact_Name = '' THEN
                                                                                 //  Contact_Name := '-';
                                                                                 // //140613
                                                                               END;
                                                                                }

    { [{D6AB5070-2540-4025-91F8-66BDA059563E}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Contact_Name_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C46708DD-791A-4020-AADA-A177D9159931}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Cont_Name_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6EA52BA1-783F-4F4C-8F36-73CF7726FE93}];4 ;cbc:Telephone       ;Element ;Text    ;
                                                  VariableName=Telephone;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080, moved to Contact - Export::OnBeforePassVariable
                                                                                 // Telephone := "Sales Invoice Header"."Sell-to Contact Phone No.";
                                                                                 // IF Telephone = '' THEN
                                                                                 //  Telephone := '-';
                                                                                 // //140613
                                                                               END;
                                                                                }

    { [{448F9E5D-3087-448A-9101-B72D09E12C08}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Telephone_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F61B79DD-311A-4E15-9C5E-FD2F071AD2A0}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Telephone_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{192AFC00-97B1-4DB7-9DC6-9D7BA0A28744}];4 ;cbc:ElectronicMail  ;Element ;Text    ;
                                                  VariableName=ElectronicMail;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 ShiptoAddress@1100285100 : Record 222;
                                                                               BEGIN
                                                                                 //RFC1080, moved to Contact - Export::OnBeforePassVariable
                                                                                 // //>> ITERO.FH 171102 RFC248
                                                                                 // IF "Sales Invoice Header"."Alternative Bill-to Address" = '' THEN
                                                                                 //  ElectronicMail := Customer."E-Mail (Invoices)"
                                                                                 // ELSE BEGIN
                                                                                 //  IF ShiptoAddress.GET("Sales Invoice Header"."Bill-to Customer No.",
                                                                                 //                      "Sales Invoice Header"."Alternative Bill-to Address") THEN BEGIN
                                                                                 //    ElectronicMail := ShiptoAddress."E-Mail (Invoices)";
                                                                                 //  END;
                                                                                 // END;
                                                                                 // // "Sales Invoice Header"."Alternative Bill-to Address"
                                                                                 // // ElectronicMail := "Sales Invoice Header"."Sell-to Contact E-Mail";
                                                                                 // ////140613
                                                                                 // //<< 171102 RFC248
                                                                               END;
                                                                                }

    { [{D15FBFC6-B0F9-4FF6-8F41-31606633CD81}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=ElectronicMail_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5EAF9255-91DC-4543-A4B1-56B1ADB682AE}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Elec_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F5E613FE-BB66-43B7-9615-68238878688D}];1 ;cac:SellerParty     ;Element ;Text    ;
                                                  VariableName=SellerParty;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{44BBC0C8-AB77-4A9C-B0C0-651C6C8F3EAA}];2 ;cac:Party           ;Element ;Text    ;
                                                  VariableName=SellerParty_Party;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{25913DFD-D45F-4D93-9FF8-7CFC93F69A5B}];3 ;cac:PartyIdentification;Element;Text  ;
                                                  VariableName=Party_PartyIdentification;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded }

    { [{CE6BBF80-127F-4B69-8357-7FBF5253EEAD}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Part_PartyIdentification_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Part_PartyIdentification_ID := CompanyInformation."Registration No.";
                                                                               END;
                                                                                }

    { [{51C16FB6-7BB9-4C39-8C1A-8DBA995AAC3F}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Part_ID_identificationSchem3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1D6A1E3B-6F4F-41C9-B273-615B21E2EF81}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI6;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2761A642-21E9-4583-AA6C-1E097C1E134F}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion6;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9BC385D5-3F00-41EC-9507-0C025B9F1331}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Part_ID_identificationSchem4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{06A4EAB3-C5DB-45B8-9CB7-4631DB901095}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN6;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{ABC61D9A-AF14-4023-AB46-E6133799301A}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Part_ID_identificationSchem5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5690C232-169B-4D01-95A2-58B967E59AE3}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{516735C6-C593-4D87-B5C5-6E9997AC911F}];3 ;cac:PartyName       ;Element ;Text    ;
                                                  VariableName=Party_PartyName;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{7C91F7EB-5D29-4698-B2E5-295BC67B34B2}];4 ;cbc:Name            ;Element ;Text    ;
                                                  VariableName=PartyName_Name;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PartyName_Name := CompanyInformation.Name;
                                                                               END;
                                                                                }

    { [{3D409EC8-591C-4A21-9541-E64F327F9ED1}];3 ;cac:Address         ;Element ;Text    ;
                                                  VariableName=Party_Address;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{AF0BB554-0072-4268-8809-4B094912CE99}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Party_Address_ID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080
                                                                                 IF Party_Address_ID = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{8DF71D6F-38C3-4698-96EA-ABB0DA08E3E5}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Addr_ID_identificationSchem3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DC72B0B2-2B0E-4446-9D5F-9EFF357DB097}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI7;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{446252D1-B6FC-434B-A9F6-A51892C71331}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion7;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{97DBF47C-231E-4445-A643-34F0854D45D4}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Addr_ID_identificationSchem4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9DB5FD89-ECC5-45DC-A2DB-D48C34409418}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN7;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{12D7BDE5-B38D-4CBF-98C3-C06EF167DDF3}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Addr_ID_identificationSchem5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{04094E01-19B5-45C0-A99F-D955B1E43B02}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData6;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7CC791E2-5956-4862-AA68-84585806801D}];4 ;cbc:StreetName      ;Element ;Text    ;
                                                  VariableName=Address_StreetName;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Address_StreetName := CompanyInformation.Address;
                                                                               END;
                                                                                }

    { [{AC1E555E-39A0-41ED-99A3-F01F4F874E4B}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Addr_StreetName_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4AA00051-C46E-4B1A-A711-9840F09D4717}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Addr_StreetName_languageLoc;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{FA0A6757-CF1E-4DCF-97FB-48105E6BFB5D}];4 ;cbc:CityName        ;Element ;Text    ;
                                                  VariableName=Address_CityName;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Address_CityName := CompanyInformation.City;
                                                                               END;
                                                                                }

    { [{C6C51907-6FEF-461F-B2E9-E539D06D726D}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Address_CityName_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{0939528F-9983-4E39-8C12-C4D83055EBDE}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Addr_CityName_languageLocal;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{EDFD1ACC-F6E7-4D08-8F4C-43325058AAE2}];4 ;cbc:PostalZone      ;Element ;Text    ;
                                                  VariableName=Address_PostalZone;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Address_PostalZone := CheckValidChrs(CompanyInformation."Post Code");
                                                                                 //140613
                                                                               END;
                                                                                }

    { [{A6F1CE46-6541-43C7-B849-0B5F6CABC946}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Addr_PostalZone_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DB245D8E-68F2-4B89-80C9-28DC0F8A80D8}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Addr_PostalZone_languageLoc;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C21821DF-4FFA-458B-A369-708550184C4A}];4 ;cac:Country         ;Element ;Table   ;
                                                  VariableName=Address_Country;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF CompanyInformation."Country/Region Code" = '' THEN
                                                                           Address_Country.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{4437043C-DF01-432C-97D3-4A59655CE6D7}];5 ;cac:IdentificationCode;Element;Text   ;
                                                  VariableName=Addr_Country_Identification;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Addr_Country_Identification := CompanyInformation."Country/Region Code";
                                                                               END;
                                                                                }

    { [{AEEFB055-A534-40F0-828A-04F7A37E2531}];6 ;name                ;Attribute;Text   ;
                                                  VariableName=Coun_IdentificationCode_nam1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{95962561-5F3D-419A-8E32-471233363F2E}];6 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=Addr_Country_Iden_codeListI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A29BB338-B95A-4479-933F-144A469720CE}];6 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Addr_Coun_Iden_codeListAgen;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{35FF35D3-84E9-494C-B0B8-85BEA9780709}];6 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Coun_Iden_codeListAgencyNam1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{284627AA-DEE3-4F11-A7F8-4439F0DABC68}];6 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Addr_Country_Iden_codeListN;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F71862A5-A5A2-46D7-B2CE-F54CC43A6356}];6 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Addr_Coun_Iden_codeListVers;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{0CBA4D0D-3C67-40D1-A27F-D1664D8C69D0}];6 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=Addr_Country_Iden_codeListU;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A306BC34-F308-4DC1-8573-BCF42CAC3CCD}];6 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Addr_Coun_Iden_codeListSche;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A73DDCB6-CF69-4A5F-8D09-B63206D48F31}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Addr_Country_Iden_languageI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{AEA4C3CD-2CB1-45A6-AE1E-E9D04413487D}];3 ;cac:PartyTaxScheme  ;Element ;Table   ;
                                                  VariableName=int_ParTaxScheme;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_ParTaxScheme.SETFILTER(Number, '1..2'); // 2ggr
                                                                       END;
                                                                        }

    { [{456DA74F-F188-416C-8CC2-05288ED3B098}];4 ;cbc:RegistrationName;Element ;Text    ;
                                                  VariableName=Part_RegistrationName;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080
                                                                                 IF Part_RegistrationName = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{E406C061-2B07-41BA-9323-3BF4C76E7680}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Part_RegistrationName_langu;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{588232B2-74F5-475B-B1DE-A057E6A5A4EE}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Part_Regi_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DBB9A194-91EF-48D1-80DD-FB6BCA5BBAA6}];4 ;cac:CompanyID       ;Element ;Text    ;
                                                  VariableName=PartyTaxScheme_CompanyID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CASE int_ParTaxScheme.Number OF
                                                                                   1: PartyTaxScheme_CompanyID := CompanyInformation."VAT Registration No.";
                                                                                   2: PartyTaxScheme_CompanyID := CompanyInformation."Registration No.";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{B7B932C7-073F-46DC-BA6D-6F06748B23C1}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Part_Comp_identificationSch;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A7AF1C2F-ACA6-4E71-A730-DE79398FCBDB}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI8;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1227DBB7-E5C8-4C69-A494-627AA8EFFA89}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion8;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{006E937A-AD2B-4F5F-B246-3A8B8FD8DAAA}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Comp_identificationSchemeUR1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{75A705EA-5ED4-43A7-8AD4-9657CD174B0B}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN8;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{88BC5ECC-D30E-4412-8BAC-451B3940C802}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Comp_identificationSchemeNa1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4980C3AF-3A11-47D1-AF58-8A2C74C2E118}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=Comp_identificationSchemeDa1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9FF31493-4ACC-47E1-91EA-6F4F5DBA0C5C}];4 ;cbc:ExemptionReason ;Element ;Text    ;
                                                  VariableName=Part_ExemptionReason;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Part_ExemptionReason := '';
                                                                                 IF int_ParTaxScheme.Number = 2 THEN
                                                                                   IF CompanyInformation."Country/Region Code" = 'NO' THEN
                                                                                     Part_ExemptionReason := TextNO
                                                                                   ELSE
                                                                                     Part_ExemptionReason := TextSE;

                                                                                 //RFC1080
                                                                                 IF Part_ExemptionReason = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{76711B9E-9A61-4092-BEF9-B5E5AD1FE5AA}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Part_ExemptionReason_langua;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{321FB8DD-C9AD-4862-886B-DB3923215DD9}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Part_Exem_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A4062192-86D0-4776-B82F-9371FD1F49F0}];4 ;cac:RegistrationAddress;Element;Text  ;
                                                  VariableName=Part_RegistrationAddress;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //Part_RegistrationAddress := CompanyInformation."Registered Office";

                                                                                 //RFC1080.2
                                                                                 //endast SWT
                                                                                 IF int_ParTaxScheme.Number <> 2 THEN
                                                                                   currXMLport.SKIP;
                                                                                 //RFC1080
                                                                               END;
                                                                                }

    { [{1F1E30D0-25BB-4217-9246-A68342FCC40A}];5 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Part_RegistrationAddress_ID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Part_RegistrationAddress_ID := CompanyInformation."Registration No.";
                                                                               END;
                                                                                }

    { [{6AA070BF-1B91-4612-BC24-1A9B6EFAF0EC}];6 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Regi_ID_identificationSchem3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{057A664F-63FC-4486-BB2A-76299007EF82}];6 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI9;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B4D06808-F486-475A-A819-3B449C30A965}];6 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion9;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{545AEF7B-B283-48A8-A6C9-7CD4499AA725}];6 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Regi_ID_identificationSchem4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{250A9F04-501A-4F3A-9F1C-34BC7536946C}];6 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN9;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{358CDB53-7E30-497B-834B-215DD9F1CC02}];6 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Regi_ID_identificationSchem5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E369D3A3-B114-47E1-A18C-2948016BA90A}];6 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData7;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3B6ABD84-679D-4810-BF71-12C3DB3F5787}];5 ;cbc:Postbox         ;Element ;Text    ;
                                                  VariableName=Part_RegistrationAddress_Po;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Part_RegistrationAddress_Po := CompanyInformation."Postal Address";
                                                                                 //140313
                                                                               END;
                                                                                }

    { [{5CE08362-57D1-49BC-9361-0F93C6CE2064}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Part_Regi_Postbox_languageI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9397E230-D639-4A2B-A42C-0CB943B45562}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_Postbox_languageLocale1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{346E58CF-87AE-4B42-BA45-CD1DC3F421A5}];5 ;cbc:StreetName      ;Element ;Text    ;
                                                  VariableName=Part_Regi_StreetName;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Part_Regi_StreetName := CompanyInformation.Address;
                                                                                 //140613
                                                                               END;
                                                                                }

    { [{37A1B610-4E89-4B0C-90A2-671BFC1F7DA9}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Part_Regi_StreetName_langua;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2A9B2704-4B21-4B35-87AE-B13C61339CD5}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_StreetName_languageLoc1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{044851DF-E2BD-46DA-9959-43FA0E8FC37D}];5 ;cbc:Department      ;Element ;Text    ;
                                                  VariableName=Part_Regi_Department;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080
                                                                                 IF Part_Regi_Department = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{A3BA30F4-E0B2-462A-B8FD-353800088A6F}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Part_Regi_Department_langua;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{54CCCA93-05A4-44DF-A1BF-6CE19583BD12}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_Department_languageLoc1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5432CDA4-C220-48C9-81A0-A7D203F12C3C}];5 ;cbc:CityName        ;Element ;Text    ;
                                                  VariableName=Part_Regi_CityName;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Part_Regi_CityName := CompanyInformation."Registered Office";
                                                                               END;
                                                                                }

    { [{CE9EABD6-F0E8-4504-8851-485C454A4B77}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Part_Regi_CityName_language;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{CA86DE8F-D64C-496A-9278-DBD33EC2ED11}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_CityName_languageLocal1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{0AE6F60C-746B-474B-B18D-8A0181D8AE95}];5 ;cbc:PostalZone      ;Element ;Text    ;
                                                  VariableName=Part_Regi_PostalZone;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Part_Regi_PostalZone := CheckValidChrs(CompanyInformation."Post Code");
                                                                                 //140613
                                                                               END;
                                                                                }

    { [{A0381DF9-98A3-4DF4-8EF5-3A45BB93BE98}];6 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Part_Regi_PostalZone_langua;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{75D8F7F1-F2E9-4282-949C-C4D2678E41A4}];6 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Regi_PostalZone_languageLoc1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8BBC771A-60F6-4D96-9F0A-5EF54DBD7B63}];5 ;cac:Country         ;Element ;Table   ;
                                                  VariableName=Part_RegistrationAddress_Co;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF (CompanyInformation."Country/Region Code" = '') THEN
                                                                           Part_RegistrationAddress_Co.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{6C514826-7912-4838-A8D0-BB6BEB3C374E}];6 ;cac:IdentificationCode;Element;Text   ;
                                                  VariableName=Regi_Country_Identification;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Regi_Country_Identification := CompanyInformation."Country/Region Code";
                                                                               END;
                                                                                }

    { [{B6E434BC-0D94-4E30-9CDE-0304AD2AA0BD}];7 ;name                ;Attribute;Text   ;
                                                  VariableName=Coun_IdentificationCode_nam2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9177143B-A3A5-407B-943E-C95ABD6B9D70}];7 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=Regi_Country_Iden_codeListI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8761E792-679B-4102-AC06-1BF8D6688F18}];7 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Regi_Coun_Iden_codeListAgen;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{47078171-2FEA-40E6-B3DC-1A5F518F825A}];7 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Coun_Iden_codeListAgencyNam2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D628AF5E-62E5-40E8-B4EF-D855EEBE0813}];7 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Regi_Country_Iden_codeListN;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C4DDAA37-ED27-484D-A687-3CD9AB39890F}];7 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Regi_Coun_Iden_codeListVers;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1E7CCEF2-F124-4274-9F6A-D8F617CEA9A7}];7 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=Regi_Country_Iden_codeListU;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{831FD92E-020F-4CC8-8098-254F980E4A90}];7 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Regi_Coun_Iden_codeListSche;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{15D2CFA8-D8AE-4A27-91AE-904F419E53AC}];7 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Regi_Country_Iden_languageI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9BFF2D29-6B92-49BB-8EE1-B2EE6ABDAF73}];4 ;cac:TaxScheme       ;Element ;Text    ;
                                                  VariableName=PartyTaxScheme_TaxScheme;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{6CA51325-3AB2-49A9-9471-D4C2853A6498}];5 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=PartyTaxScheme_TaxScheme_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CASE int_ParTaxScheme.Number OF
                                                                                   1:PartyTaxScheme_TaxScheme_ID := 'VAT';
                                                                                   2:PartyTaxScheme_TaxScheme_ID := 'SWT';
                                                                                 END;
                                                                               END;
                                                                                }

    { [{CD7270D0-5F5F-433A-849E-EBE17C53AFE7}];6 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=TaxS_ID_identificationSchem3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B9778C06-DDEF-4D2E-9B05-8AD0078842DC}];6 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI10;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{430BD635-E540-495B-B46F-C9E8CFAAE3C5}];6 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion10;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D36E13A0-93EA-49E4-9BDA-99BA7C876B49}];6 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{14829C1A-9FA2-4BAF-8C1B-2AA6DCFDEBE6}];6 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN10;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{590FEB86-6506-4041-B003-FD2C9C40BD75}];6 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{CB30C339-860E-46D0-AB0A-ABE3818D1BD5}];6 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData8;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{61EDF96C-B3B2-48EA-A8FE-5FD946721DF3}];3 ;cac:Contact         ;Element ;Text    ;
                                                  VariableName=Party_Contact;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{86F288D4-0E67-4B42-B74E-9801F16451AC}];4 ;cbc:Name            ;Element ;Text    ;
                                                  VariableName=Party_Contact_Name;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 Employee@1100285100 : Record 5200;
                                                                                 Contact@1100285101 : Record 5050;
                                                                               BEGIN
                                                                                 // 170424 RFC224 moved reference of Extension contract and Project No. to ACD reference
                                                                                 // Commented old code:
                                                                                 // // 150212
                                                                                 // Party_Contact_Name := "Sales Invoice Header"."Job No.";
                                                                                 // IF (SalesInvoiceLineTEMP.FINDFIRST()) AND (SalesInvoiceLineTEMP."Extension Contract" <> '') THEN
                                                                                 //    IF (ExtensionContract.GET("Sales Invoice Header"."Job No.", SalesInvoiceLineTEMP."Extension Contract")) THEN
                                                                                 //       Party_Contact_Name += ' ' + ExtensionContract."Contract No.";
                                                                                 //
                                                                                 // IF (Job.GET("Sales Invoice Header"."Job No.")) THEN BEGIN
                                                                                 //    Job.CALCFIELDS("Name Project Manager");
                                                                                 //    Party_Contact_Name += ' ' + Job."Name Project Manager";
                                                                                 // END ELSE BEGIN
                                                                                 //    Party_Contact_Name := "Sales Invoice Header"."No." + ' ' + "Sales Invoice Header"."Sell-to Contact";
                                                                                 // END;

                                                                                 // new code RFC224:
                                                                                 IF Job.GET("Sales Invoice Header"."Job No.") THEN BEGIN
                                                                                   IF Employee.GET(Job."Project Manager") THEN
                                                                                     Party_Contact_Name := Employee."Full Name" + ' ' + Employee."Phone No.";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{1600311A-2A6A-4384-AB13-B8A68EC73E20}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Part_Contact_Name_languageI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6B80A087-3BB1-4562-BAFF-827F22807051}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Part_Cont_Name_languageLoca;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C7F2EBB1-A147-47D2-9FA9-35A0F9496425}];4 ;cbc:Telephone       ;Element ;Text    ;
                                                  VariableName=Contact_Telephone;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Contact_Telephone := CompanyInformation."Phone No.";
                                                                               END;
                                                                                }

    { [{4DE509A3-94F1-45CB-8501-02560BF206DA}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Cont_Telephone_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{606314F3-0969-495A-99DA-894475647CF7}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Cont_Telephone_languageLoca;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1094F86F-787F-4E74-89FC-82C5A109A4A0}];4 ;cbc:ElectronicMail  ;Element ;Text    ;
                                                  VariableName=Contact_ElectronicMail;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Contact_ElectronicMail := CompanyInformation."E-Mail";
                                                                               END;
                                                                                }

    { [{2FEBFF7E-7E8C-4D6F-8CC2-F9C350A0D2C3}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Cont_ElectronicMail_languag;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{30C6B08B-0251-482A-A76C-0289646469AE}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Cont_Elec_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{0C7A7587-8B04-4CC8-872F-9CAD76FA339D}];1 ;cac:Delivery        ;Element ;Table   ;
                                                  VariableName=int_Delivery;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         // 150108
                                                                         //IF ("Sales Invoice Header"."Shipment Date" = 0D) THEN
                                                                         //   int_Delivery.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{B26B5F5A-52D3-4B0F-B224-450050D3FA62}];2 ;cbc:ActualDeliveryDateTime;Element;Text;
                                                  VariableName=DelivertDateTime;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // *** ITERO.MH 150428 ***
                                                                                 IF "Sales Invoice Header"."Shipment Date" <> 0D THEN
                                                                                   DelivertDateTime := FORMAT("Sales Invoice Header"."Shipment Date", 0, 9) + 'T00:00:00'
                                                                                 ELSE
                                                                                   DelivertDateTime := FORMAT("Sales Invoice Header"."Document Date", 0, 9) + 'T00:00:00';
                                                                                 // *** ITERO.MH 150428 ***
                                                                               END;
                                                                                }

    { [{91FDA525-9E0B-4C74-BD8F-B2E9547AB47F}];2 ;cac:DeliveryAddress ;Element ;Text    ;
                                                  VariableName=DeliveryAddress;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF "Sales Invoice Header"."Ship-to Address" <> "Sales Invoice Header"."Bill-to Address" THEN
                                                                                   //DeliveryAddress := "Sales Invoice Header"."Ship-to Address"
                                                                               END;
                                                                                }

    { [{B0D65873-A8A5-4F50-B1BD-AAD9AB470F42}];3 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=DeliveryAddress_ID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryAddress_ID := Customer."No.";
                                                                               END;
                                                                                }

    { [{6F54E7C0-7D2C-4D49-BD6D-637804BCD9A6}];4 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Deli_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B88DC758-D79D-4B64-95CE-1DEA5E9701CD}];4 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI11;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{93F8B7F2-ABB2-4ABA-9834-97A31BD1AF47}];4 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion11;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4CB6D277-BF84-4ABD-A5C9-1AD5E704BBAF}];4 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Deli_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E3CDF09D-4D55-4523-95CD-74A8D6ADA4AA}];4 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN11;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{0F8F6CF2-7328-4BB9-B840-32BEDFE49D62}];4 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Deli_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B4BB9CF7-E4A9-4153-9387-842B6BD2F26A}];4 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData9;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F03CB6BA-9874-4091-9B73-93F68B0A574B}];3 ;cbc:Postbox         ;Element ;Text    ;
                                                  VariableName=DeliveryPostbox;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF "Sales Invoice Header"."Ship-to Address" <> '' THEN
                                                                                 //   DeliveryPostbox := "Sales Invoice Header"."Ship-to Name 2";
                                                                                 DeliveryPostbox := '';
                                                                                 //IF ("Sales Invoice Header"."Job No." <> '') THEN
                                                                                 //   IF (Job.GET("Sales Invoice Header"."Job No.")) THEN
                                                                                 //      DeliveryPostbox := Job."Name 2";

                                                                                 //RFC1080
                                                                                 IF DeliveryPostbox = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{A6D5B508-27FB-4F54-8BE9-5EBFADA07D59}];3 ;cbc:StreetName      ;Element ;Text    ;
                                                  VariableName=DeliveryStreetname;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // 150108 ITERO.MH Changed to use Project address if no shipment address is found.
                                                                                 //IF "Sales Invoice Header"."Ship-to Address" <> '' THEN
                                                                                 //   DeliveryStreetname := "Sales Invoice Header"."Ship-to Address 2";
                                                                                 DeliveryStreetname := '';
                                                                                 IF "Sales Invoice Header"."Job No." <> '' THEN
                                                                                   IF Job.GET("Sales Invoice Header"."Job No.") THEN
                                                                                     DeliveryStreetname := Job."Address 2";

                                                                                 //RFC1080
                                                                                 IF DeliveryStreetname = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{85454B26-A468-4D70-A00B-30B7B45BC5FC}];3 ;cbc:Department      ;Element ;Text    ;
                                                  VariableName=DelieryDepartment;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF "Sales Invoice Header"."Ship-to Address" <> '' THEN
                                                                                 //   DelieryDepartment := "Sales Invoice Header"."Ship-to Address";
                                                                                 DelieryDepartment := '';
                                                                                 IF "Sales Invoice Header"."Job No." <> '' THEN
                                                                                   IF Job.GET("Sales Invoice Header"."Job No.") THEN
                                                                                     DelieryDepartment := Job.Address;

                                                                                 //RFC1080
                                                                                 IF DelieryDepartment = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{233F0A47-39A4-4F85-B6CB-382915F3539C}];3 ;cbc:CityName        ;Element ;Text    ;
                                                  VariableName=DeliveryAddress_CityName;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF "Sales Invoice Header"."Ship-to Address" <> "Sales Invoice Header"."Bill-to Address" THEN
                                                                                 //DeliveryAddress_CityName := "Sales Invoice Header"."Ship-to City";
                                                                                 // 150108
                                                                                 DeliveryAddress_CityName := '';
                                                                                 IF "Sales Invoice Header"."Job No." <> '' THEN
                                                                                   IF Job.GET("Sales Invoice Header"."Job No.") THEN
                                                                                     DeliveryAddress_CityName := Job.City;

                                                                                 //RFC1080
                                                                                 IF DeliveryAddress_CityName = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{1F0C5BB4-DF43-467E-A4E9-7927BE62ED43}];3 ;cbc:PostalZone      ;Element ;Text    ;
                                                  VariableName=Deli_PostalZone;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //Deli_PostalZone := CheckValidChrs("Sales Invoice Header"."Ship-to Post Code");
                                                                                 IF "Sales Invoice Header"."Job No." <> '' THEN
                                                                                   IF Job.GET("Sales Invoice Header"."Job No.") THEN
                                                                                     Deli_PostalZone := CheckValidChrs(Job."Post Code");
                                                                                 //140613

                                                                                 //RFC1080
                                                                                 IF Deli_PostalZone = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F87E4D25-AF75-4A5A-B8D9-FD2ED1C26304}];3 ;cac:Country         ;Element ;Table   ;
                                                  VariableName=DeliveryAddress_Country;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         //>>RFC1080.5
                                                                         Deli_Country_Identification := Customer."Country/Region Code";
                                                                         // IF ("Sales Invoice Header"."Job No." <> '') AND (NOT EHFBuyersID) AND Job.GET("Sales Invoice Header"."Job No.") THEN
                                                                         IF ("Sales Invoice Header"."Job No." <> '') AND Job.GET("Sales Invoice Header"."Job No.") THEN
                                                                           Deli_Country_Identification := Job."Country/Region Code";

                                                                         //RFC1169.5
                                                                         IF Deli_Country_Identification = '' THEN Deli_Country_Identification := CompanyInformation."Country/Region Code";

                                                                         // IF Customer."Country/Region Code" = '' THEN
                                                                         IF Deli_Country_Identification = '' THEN
                                                                         //<<RFC1080
                                                                           DeliveryAddress_Country.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{520ED4DB-C80F-4B9D-963D-E2FBD15F5F91}];4 ;cac:IdentificationCode;Element;Text   ;
                                                  VariableName=Deli_Country_Identification;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080.5, moved to DeliveryAddress_Country - Export::OnPreXMLItem
                                                                                 // Deli_Country_Identification := Customer."Country/Region Code";
                                                                                 //RFC1080
                                                                               END;
                                                                                }

    { [{754C39B9-A708-4478-B2CC-B6556C0F21D7}];5 ;name                ;Attribute;Text   ;
                                                  VariableName=Coun_IdentificationCode_nam3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{AEDE9EC9-9724-4387-A253-F02667C6A661}];5 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=Deli_Country_Iden_codeListI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3BDDEC3C-820C-4590-B183-3812CD75C23C}];5 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Deli_Coun_Iden_codeListAgen;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7A3700A9-9C0B-4DEB-A7F4-13FB21246321}];5 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Coun_Iden_codeListAgencyNam3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{35054746-0216-48B5-8CDB-B2EA53379EA3}];5 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Deli_Country_Iden_codeListN;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4524D347-6B59-4156-B817-80C59224B9D2}];5 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Deli_Coun_Iden_codeListVers;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1E41B92B-FEF9-46EA-8921-042E62283818}];5 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=Deli_Country_Iden_codeListU;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7F82F77D-1451-49A1-9BC1-33F7282550A5}];5 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Deli_Coun_Iden_codeListSche;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4A26FFEA-2656-457D-B864-A7DE4FD881D3}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Deli_Country_Iden_languageI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{46E08695-5732-41A3-8A25-97FF408889A1}];1 ;cac:PaymentMeans    ;Element ;Table   ;
                                                  VariableName=int_PaymentMeans;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF CompanyInformation."Country/Region Code" = 'NO' THEN
                                                                           int_PaymentMeans.SETFILTER(Number, '3..4')
                                                                         ELSE
                                                                           int_PaymentMeans.SETFILTER(Number, '1..3');
                                                                       END;
                                                                        }

    { [{D1328A3A-0A78-4E13-8961-3823CAB04B4D}];2 ;cac:PaymentMeansTypeCode;Element;Text ;
                                                  VariableName=PaymentMeansTypeCode;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 PaymentMeansTypeCode := '1';
                                                                               END;
                                                                                }

    { [{B4950545-62AC-420B-8814-B7D7F8605D1D}];3 ;name                ;Attribute;Text   ;
                                                  VariableName=PaymentMeansTypeCode_name;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4AA3226A-1005-4B1A-AD43-898BC5A301BB}];3 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=Paym_codeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{13BBE7AD-DD0C-445F-A8CA-0C03FB4E5C4B}];3 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Paym_codeListAgencyID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{56419EC1-343B-4FB6-A726-27AC5098A680}];3 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Paym_codeListAgencyName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{38B86A1E-A172-44BE-A43F-62A37243324C}];3 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Paym_codeListName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{140C5DCC-07AE-420F-85AE-7D646EC32A35}];3 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Paym_codeListVersionID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1FE618E4-5713-469E-B2BE-330C221F3AC1}];3 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=Paym_codeListURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{78B70E13-7E0E-4A38-9E99-C13A3D694936}];3 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Paym_codeListSchemeURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D49074BB-D2B5-4969-8004-9EDB9C1874E6}];3 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Paym_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6A849E58-BAE7-443A-A58A-69A6F4D867C0}];2 ;cbc:DuePaymentDate  ;Element ;Text    ;
                                                  VariableName=DuePaymentDate;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DuePaymentDate := FORMAT("Sales Invoice Header"."Due Date", 0, 9);
                                                                               END;
                                                                                }

    { [{B140F228-4BF1-4DBB-A314-819C234AFDD0}];2 ;cac:PayeeFinancialAccount;Element;Text;
                                                  VariableName=PayeeFinancialAccount>;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded }

    { [{CBA0AE64-EA8A-4C6F-B0A0-9A6859A7D47A}];3 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=PayeeFinancialAccount_ID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CASE int_PaymentMeans.Number OF
                                                                                   1: PayeeFinancialAccount_ID := CheckValidChrs(CompanyInformation."Giro No.");
                                                                                   2: PayeeFinancialAccount_ID := CheckValidChrs(CompanyInformation."Plus Giro No.");
                                                                                   3: PayeeFinancialAccount_ID := CheckValidChrs(CompanyInformation.IBAN);
                                                                                   4: PayeeFinancialAccount_ID := CheckValidChrs(CompanyInformation."Bank Account No.");
                                                                                 END;
                                                                               END;
                                                                                }

    { [{09B3187C-60E1-462E-B145-BDA822F0C6DE}];4 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Paye_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9C0DCBCE-F14F-47B4-A15D-41DDBDD76B3D}];4 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI12;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B6015427-62BF-4551-9860-201BA30C9EFF}];4 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion12;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A697EF59-7965-478F-A1F2-06A0FDDBCC76}];4 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Paye_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{96E4E793-5044-4F7B-BE3E-1608CE3328E0}];4 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN12;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1444AA08-E7B8-49A4-99FB-EED218B0FFA6}];4 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Paye_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF int_PaymentMeans.Number = 3 THEN
                                                                                   Paye_ID_identificationSchem2 := 'IBAN'
                                                                                 ELSE
                                                                                   Paye_ID_identificationSchem2 := '';
                                                                               END;
                                                                                }

    { [{684BA848-788A-487A-B734-808CF88F1A52}];4 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData10;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{184A6C96-D6E7-4075-8FFB-7B9AA5C87430}];3 ;cac:FinancialInstitutionBranch;Element;Text;
                                                  VariableName=FinancialInstitutionBranch;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{6F3B761A-B208-4FD7-9D03-91A7D2261CEA}];4 ;cac:FinancialInstitution;Element;Text ;
                                                  VariableName=FinancialInstitution;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{D4BD4B39-1A04-4303-A5FF-1CB2351DCA81}];5 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=FinancialInstitution_ID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CASE int_PaymentMeans.Number OF
                                                                                   1: FinancialInstitution_ID := 'BGABSESS';
                                                                                   2: FinancialInstitution_ID := 'PGSISESS';
                                                                                   3: FinancialInstitution_ID := CompanyInformation."SWIFT Code";
                                                                                   4: FinancialInstitution_ID := CompanyInformation."SWIFT Code";
                                                                                 END;
                                                                               END;
                                                                                }

    { [{2ED113B6-C081-4DFE-8D5F-E8043E6190B3}];6 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Fina_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{108E4D69-D566-4601-8531-B8FFAD297B98}];6 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI13;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A073B879-0343-4DB1-8B24-09F35FC7C2C2}];6 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion13;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{ABD464A0-6EDA-470B-8E0A-A71395A492C3}];6 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Fina_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E65423B7-3792-4280-A3B1-BCB1EB5FA6C5}];6 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN13;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{57BFA22F-77DF-46F2-8E3F-A8B09B1079DB}];6 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Fina_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{648E692D-210C-49BD-B5AA-D93A8A8B0A22}];6 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData11;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{BA5A25EA-7BC2-4E82-95F7-6AEEA243CD56}];3 ;cac:PaymentInstructionID;Element;Text ;
                                                  VariableName=PaymentInstructionID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF SalesReceivablesSetup."External Doc. No. as Pmt. Ref" THEN
                                                                                   PaymentInstructionID := "Sales Invoice Header"."External Document No."
                                                                                 ELSE
                                                                                   PaymentInstructionID := "Sales Invoice Header"."No.";
                                                                               END;
                                                                                }

    { [{760F6346-A89E-4E1D-AAD0-6B31EF005079}];2 ;cac:PayeePartyName  ;Element ;Text    ;
                                                  VariableName=PayeePartyName;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //RFC1080
                                                                                 IF (int_PaymentMeans.Number < 3) OR (CompanyInformation."Bank Name"='') THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{37AD4CB2-9A9B-4E16-9264-ACE025923AE9}];3 ;cbc:Name            ;Element ;Text    ;
                                                  VariableName=PayeePartyName_Name;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF int_PaymentMeans.Number = 3 THEN
                                                                                   PayeePartyName_Name := CompanyInformation."Bank Name";
                                                                               END;
                                                                                }

    { [{64351404-6DEF-4B2F-88AD-57126D83AF49}];4 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Paye_Name_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A81F45E0-BD60-4139-9B8B-7CD9AD6E5A92}];4 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Paye_Name_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A75D995A-616A-4E09-A053-A1BF452E14AD}];1 ;cac:PaymentTerms    ;Element ;Table   ;
                                                  VariableName=int_PaymentTerms;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF Credit OR ("Sales Invoice Header"."Payment Terms Code" = '') THEN
                                                                           int_PaymentTerms.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{38831DBC-0F95-425C-BD19-B7328E9AB975}];2 ;cbc:Note            ;Element ;Text    ;
                                                  VariableName=PaymentTerms_Note;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 FinanceChargeTerms@1100285100 : Record 5;
                                                                               BEGIN
                                                                                 PayTerms.GET("Sales Invoice Header"."Payment Terms Code");
                                                                                 PaymentTerms_Note := PayTerms.Description;
                                                                               END;
                                                                                }

    { [{5C621C8C-D2D3-447B-BA47-7A3790960CC0}];3 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Paym_Note_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C8061C08-DB7A-4981-9EE2-9407D07D9A16}];3 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Paym_Note_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2646C67F-3FFE-43B0-A4AF-23C3BC3CC124}];2 ;cbc:PenaltySurchargePercent;Element;Text;
                                                  VariableName=Paym_PenaltySurchargePercent;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // IME510 ITERO.MH 170424 - element and code added
                                                                                 IF FinChargeTerms.GET(Customer."Fin. Charge Terms Code") THEN
                                                                                   Paym_PenaltySurchargePercent := FORMAT(FinChargeTerms."Interest Rate", 0, 9)
                                                                                 ELSE
                                                                                   Paym_PenaltySurchargePercent := '0';
                                                                               END;
                                                                                }

    { [{509848C5-425C-4D40-9B5E-7E4EEB6CF8FC}];1 ;AllowanceCharge     ;Element ;Table   ;
                                                  VariableName=Int_AllowanceCharge;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF NOT "Sales Invoice Header"."ROT/RUT Reduction" THEN
                                                                           Int_AllowanceCharge.SETFILTER(Number, '1..-1')
                                                                         ELSE
                                                                           Int_AllowanceCharge.SETFILTER(Number, '1');
                                                                       END;
                                                                        }

    { [{A4DB9111-CCE5-4DFE-8840-6E84EBC97006}];2 ;cbc:ChargeIndicator ;Element ;Text    ;
                                                  VariableName=ChargeIndicator;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF NOT "Sales Invoice Header"."ROT/RUT Reduction" THEN
                                                                                   ChargeIndicator := 'true'
                                                                                 ELSE
                                                                                   ChargeIndicator := 'false';
                                                                               END;
                                                                                }

    { [{CAAF1858-095B-469A-B2A0-8FA05CF46CA1}];2 ;cac:ReasonCode      ;Element ;Text    ;
                                                  VariableName=ReasonCode;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ReasonCode := 'ZZZ';
                                                                               END;
                                                                                }

    { [{8588AA34-437B-4586-928E-37B4E69387DE}];3 ;name                ;Attribute;Text   ;
                                                  VariableName=ReasonCode_name;
                                                  TextType=Text;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //>>171127 RFC240
                                                                                 ReasonCode_name := 'Rot/Rut-avdrag';
                                                                                 //<<RFC240
                                                                               END;
                                                                                }

    { [{D1A45A70-1A05-4CD5-A684-66159594697D}];3 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=ReasonCode_codeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C0B1C5D8-9B35-468E-80E8-ABE26B09927F}];3 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=ReasonCode_codeListAgencyID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{574F0DCA-96AC-4CE7-B88E-CC1467848A60}];3 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Reas_codeListAgencyName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{02C91D4F-8092-40A9-ACE3-619B2CC3EE0E}];3 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=ReasonCode_codeListName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{0686874C-A479-4A16-B425-54FAFEE45C55}];3 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Reas_codeListVersionID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9E6F819F-5665-4694-82AF-7842F40D4524}];3 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=ReasonCode_codeListURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8957B041-317B-4098-B2E1-72620C876DEB}];3 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Reas_codeListSchemeURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{ACF39CD6-5A49-4ACF-8E63-8909FDD314C6}];3 ;languageID          ;Attribute;Text   ;
                                                  VariableName=ReasonCode_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5BC74B5B-2BF2-41DE-982D-8A58C3DE5D59}];2 ;cbc:MultiplierFactorNumeric;Element;Table;
                                                  VariableName=int_MultiplierFactorNum;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_MultiplierFactorNum.SETFILTER(Number, '1..-1');
                                                                         //ing†r ej i "BAS"
                                                                       END;
                                                                        }

    { [{E4F0A976-4AE0-4DB6-89B2-CD9E998A8FCC}];2 ;cbc:Amount          ;Element ;Text    ;
                                                  VariableName=Amount;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 Index@1100285000 : Integer;
                                                                               BEGIN
                                                                                 IF Credit THEN BEGIN
                                                                                   CustLedgerEntry.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                                   CustLedgerEntry.SETRANGE("Document Type", CustLedgerEntry."Document Type"::"Credit Memo");
                                                                                 END ELSE BEGIN
                                                                                   CustLedgerEntry.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                                   CustLedgerEntry.SETRANGE("Document Type", CustLedgerEntry."Document Type"::Invoice);
                                                                                 END;
                                                                                 IF CustLedgerEntry.FINDSET THEN BEGIN

                                                                                   //>> 171127 RFC240
                                                                                   //Amount := FORMAT(CustLedgerEntry."Amount ROT", 0, 9);
                                                                                   Amount := FORMAT((CustLedgerEntry."Amount ROT" + CustLedgerEntry."Amount RUT") , 0, 9);
                                                                                   //<< RFC240

                                                                                   // Saves as 0% VAT
                                                                                   Index := GetVATRateIndex(0, FALSE,TRUE);

                                                                                   VATRate[Index] := 0;

                                                                                   //>> 171127 RFC240
                                                                                   //TaxableAmountVar[Index] -= CustLedgerEntry."Amount ROT";
                                                                                   TaxableAmountVar[Index] -= CustLedgerEntry."Amount ROT" + CustLedgerEntry."Amount RUT";
                                                                                   //<< RFC240

                                                                                 END;

                                                                                 //Krav 8 i ML. Vid ber„kning av merv„rdesskatt skall avgifts/rabattbeloppet tas med i beskattningsunderlaget f”r den aktuella skattesatsen
                                                                               END;
                                                                                }

    { [{018E2135-3F85-4AFE-9D09-E8FDB54ABB18}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Amount_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN

                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Amount_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Amount_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{9D2C7ABE-363B-462F-A170-6701F4ADF08F}];3 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9C52BB56-2873-4C97-8608-54B098782B8E}];2 ;cac:TaxCategory     ;Element ;Text    ;
                                                  VariableName=TaxCategory;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Unbounded }

    { [{BB1083C5-EC65-40DB-B1E8-91F46917F3ED}];3 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=TaxCategory_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 TaxCategory_ID := 'E'; // ROT is EXEMPTION
                                                                               END;
                                                                                }

    { [{71BF36EF-CB86-4936-8BFF-05D65C79E095}];4 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=TaxC_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A246B5E3-0F9B-49B4-B994-F308E35C27FC}];4 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI14;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C9E0E89F-9BF0-468A-A2E0-EE99F6F4D1C1}];4 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion14;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4AA856B7-F85D-4B1F-9633-8C798E65A736}];4 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=TaxC_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5D90FEA5-043B-4FF8-880C-5B995649039E}];4 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN14;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{91A0D1DE-BB1F-4E2D-848E-9BE036BE28C1}];4 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=TaxC_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2904D487-CE5C-4726-A2AB-7628043421F4}];4 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData12;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1832C500-6999-446C-8F04-F094708B1A96}];3 ;cbc:Percent         ;Element ;Text    ;
                                                  VariableName=Percent;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //Percent := FORMAT("Sales Invoice Line"."VAT %", 0, 9);
                                                                                 Percent := '0';
                                                                                 //140612 DJ
                                                                                 //Krav 9 i ML: Merv„rdesskattesats uttryckt i procent. Undantag fr†n merv„rdesskatt anges med procentsats 0 (noll).
                                                                               END;
                                                                                }

    { [{A34C0858-E409-472A-BF08-4D6E5666FF2C}];3 ;cbc:ExemptionReason ;Element ;Text    ;
                                                  VariableName=TaxCategory_ExemptionReason;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 TaxCategory_ExemptionReason := 'ROT-avdrag';
                                                                                 //>> 171127 RFC240
                                                                                 IF CustLedgerEntry."Amount RUT" <> 0 THEN
                                                                                   TaxCategory_ExemptionReason := 'RUT-avdrag';
                                                                                 //<< RFC240
                                                                               END;
                                                                                }

    { [{10A8B2CF-344C-4337-814B-CDFD7E24DF45}];4 ;languageID          ;Attribute;Text   ;
                                                  VariableName=TaxC_ExemptionReason_langua;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1DB1CE88-82E1-4F91-B6B3-848467E9DF6D}];4 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=TaxC_Exem_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{833B9918-69BB-4A8E-A14B-089AA3E4DB9F}];3 ;cac:TaxScheme       ;Element ;Text    ;
                                                  VariableName=TaxCategory_TaxScheme;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{B02B1B99-8F4E-4390-8F51-AC8BED005BC1}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=TaxCategory_TaxScheme_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 TaxCategory_TaxScheme_ID := 'VAT';
                                                                               END;
                                                                                }

    { [{3E753F5D-DA72-403F-9848-B4534FFF5181}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=TaxS_ID_identificationSchem6;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B9511E03-9429-4A70-962A-5399AE23C148}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI15;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{05104468-354B-4864-8B0C-878EFDA5B79D}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion15;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D36337AF-3BBA-4C75-B5A0-D4D21E49E567}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem7;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6546C49F-F243-4125-9E4A-BF94B33B494A}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN15;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{86A8DB12-AB4A-4F30-A487-974E0F08B430}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem8;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{693930BF-6F04-4028-A182-0B79AD2D2D7C}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData13;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9595F37E-92CB-44D1-B536-C1D1FA08500F}];2 ;cac:AllowanceChargeBaseAmount;Element;Text;
                                                  VariableName=AllowanceChargeBaseAmount;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //AllowanceChargeBaseAmount := FORMAT((CustLedgerEntry."Amount ROT" * 2), 0, 9);

                                                                                 //>> 171127 RFC240
                                                                                 //AllowanceChargeBaseAmount := FORMAT(CustLedgerEntry."Amount ROT", 0, 9);
                                                                                 AllowanceChargeBaseAmount := FORMAT((CustLedgerEntry."Amount ROT" + CustLedgerEntry."Amount RUT"), 0, 9);
                                                                                 //<< RFC240

                                                                                 //ROT avdrag, l„gges som vanlig rabatt
                                                                               END;
                                                                                }

    { [{B1BEB086-AAB0-4DBA-BAFC-D8476C5E7A66}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Allo_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Allo_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Allo_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{88847BFF-6514-41FE-B1C6-8DAC85B339AE}];3 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{BD905BC4-568C-491E-9A69-797E051C0E7E}];1 ;cac:ExchangeRate    ;Element ;Table   ;
                                                  VariableName=int_ExchangeRate;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_ExchangeRate.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{7ED1A3F3-3E58-4DC8-B63A-478799683B81}];2 ;cac:SourceCurrencyCode;Element;Text   ;
                                                  VariableName=SourceCurrencyCode;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{C4D42250-6A54-46AD-9F87-5EFFAF484C8B}];3 ;name                ;Attribute;Text   ;
                                                  VariableName=SourceCurrencyCode_name;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{48E69F0E-F4F4-4B6F-98E8-C53925799E5C}];3 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=Sour_codeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B4121E26-CE0C-4756-9CD2-50410E1E90AB}];3 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Sour_codeListAgencyID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8A7E966F-113A-4BF5-834E-13818EAEEB3F}];3 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Sour_codeListAgencyName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4E671408-148F-48B4-A6A7-E44CE6856338}];3 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Sour_codeListName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D948C533-13F8-45ED-8840-FA267EEC32A3}];3 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Sour_codeListVersionID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7B987C1F-5B1B-4DDA-9FD2-C7682AF8D03F}];3 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=Sour_codeListURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{68C3378F-4CB8-447F-A1E6-A816BDDC8541}];3 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Sour_codeListSchemeURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5CC61004-1AA4-4371-B656-D24569B7C248}];3 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Sour_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B538011E-D194-4F28-B145-093770AFD9F4}];2 ;cbc:SourceCurrencyBaseRate;Element;Text;
                                                  VariableName=SourceCurrencyBaseRate;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{DE3EAFDC-DB85-48BD-956B-DAC4D05C9AB4}];2 ;cac:TargetCurrencyCode;Element;Text   ;
                                                  VariableName=TargetCurrencyCode;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{D02B1F9C-49C9-4537-AEB6-249C915543FE}];3 ;name                ;Attribute;Text   ;
                                                  VariableName=TargetCurrencyCode_name;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{EF9B1C6B-CC4E-437B-90E7-72D5ABC8B491}];3 ;codeListID          ;Attribute;Text   ;
                                                  VariableName=Targ_codeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D878075C-3C66-4681-AE6F-5C736EBE2D0D}];3 ;codeListAgencyID    ;Attribute;Text   ;
                                                  VariableName=Targ_codeListAgencyID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F95D64B4-2E23-4CBA-AF87-8823AFC7C8B6}];3 ;codeListAgencyName  ;Attribute;Text   ;
                                                  VariableName=Targ_codeListAgencyName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{68BDD6A4-54F3-40FE-AA9A-7120095F7F2F}];3 ;codeListName        ;Attribute;Text   ;
                                                  VariableName=Targ_codeListName;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1EEBB198-9436-469F-A17D-6EE24789AD1C}];3 ;codeListVersionID   ;Attribute;Text   ;
                                                  VariableName=Targ_codeListVersionID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{17E3E710-47A5-4705-A547-5C69D85CDE35}];3 ;codeListURI         ;Attribute;Text   ;
                                                  VariableName=Targ_codeListURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{BECE307A-7737-4DEF-B0BD-B26DAFDD84D6}];3 ;codeListSchemeURI   ;Attribute;Text   ;
                                                  VariableName=Targ_codeListSchemeURI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4FE992B8-73ED-41C8-AFCB-CD0BB9BC322A}];3 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Targ_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9F447245-C87B-40FE-8A8C-2349692C5002}];2 ;cbc:TargetUnitBaseRate;Element;Text   ;
                                                  VariableName=TargetUnitBaseRate;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{6F78FA06-8C56-4109-9C23-B789825E6C1F}];2 ;cbc:CalculationRate ;Element ;Text    ;
                                                  VariableName=CalculationRate;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{B9174B23-D569-4035-8F50-622697A37ADD}];2 ;cbc:Date            ;Element ;Text    ;
                                                  VariableName=Date;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{6D6CC944-C0F6-4D1C-A87A-91317139E888}];1 ;cac:TaxTotal        ;Element ;Text    ;
                                                  VariableName=TaxTotal;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded }

    { [{FD10F7A4-BA67-42C5-BA99-71AB285CA372}];2 ;cbc:TotalTaxAmount  ;Element ;Text    ;
                                                  VariableName=TotalTaxAmount;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 TotTaxAmnt@1100285500 : Decimal;
                                                                                 i@1100285501 : Integer;
                                                                                 GLSetup@1000000000 : Record 98;
                                                                               BEGIN
                                                                                 GenLedgSetup.GET;
                                                                                 TotTaxAmnt := 0;
                                                                                 i := 1;
                                                                                 REPEAT
                                                                                   //>>190624 TotTaxAmnt += TaxableAmountVar[i] * VATRate[i]/100;
                                                                                   TotTaxAmnt += ROUND((TaxableAmountVar[i] * VATRate[i]/100), GenLedgSetup."Amount Rounding Precision", '='); //<<190624
                                                                                   i := i + 1;
                                                                                 UNTIL (i > 9);
                                                                                 //FORMAT(TaxableAmount100 + (TaxableAmount25 * 0.25) + (TaxableAmount12 * 0.12) + (TaxableAmount6 * 0.06), 0, 9);

                                                                                 //>>190624 TotalTaxAmount := FORMAT(ROUND(TotTaxAmnt, GenLedgSetup."Amount Rounding Precision", '='), 0, 9);
                                                                                 TotalTaxAmount := FORMAT(TotTaxAmnt, 0, 9); //<<190624
                                                                               END;
                                                                                }

    { [{2F8DB71E-98DA-4348-8C2E-177D1BD7C4C3}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Tota_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Tota_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Tota_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{92B04718-816A-4052-9FF0-E60E9A02B8A2}];3 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{27D6E420-89E7-4B05-B0CF-FB6CD524037F}];2 ;cac:TaxSubTotal     ;Element ;Table   ;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         Integer.SETFILTER(Number, '1..10');
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             // IF (NOT EHFBuyersID) AND (TaxableAmountVar[Integer.Number] = 0) THEN
                                                                             IF (TaxableAmountVar[Integer.Number] = 0) THEN
                                                                             // IF TaxableAmountVar[Integer.Number] = 0 THEN
                                                                               currXMLport.SKIP;

                                                                             //[NONAT-T14-R030]-Tax category on line level MUST match provided tax categories on document level.
                                                                             // IF EHFBuyersID AND (NOT VATRateExistsOnLines[Integer.Number]) THEN
                                                                             //  currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{06513F8A-269C-4F62-85CB-41FE954D5F86}];3 ;cbc:TaxableAmount   ;Element ;Text    ;
                                                  VariableName=TaxableAmount;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 TotTaxAmnt@1100285500 : Decimal;
                                                                               BEGIN

                                                                                 TaxableAmount := FORMAT(TaxableAmountVar[Integer.Number], 0, 9);
                                                                               END;
                                                                                }

    { [{F7D04DEF-FC9D-4BFA-8291-DC72B49FFE83}];4 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Taxa_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Taxa_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Taxa_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{8569DE50-94D8-47B6-823A-CF0F898A4C71}];4 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3164C825-5B11-4F37-897B-ECC50079E419}];3 ;cbc:TaxAmount       ;Element ;Text    ;
                                                  VariableName=TaxAmount;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 TaxAmnt@1100285500 : Decimal;
                                                                                 GLSetup@1000000000 : Record 98;
                                                                               BEGIN
                                                                                 // T„nk p† att VATRATE har procentsats i heltal, ex 25% = 25, m†ste g”ras om till 0.25
                                                                                 GenLedgSetup.GET;
                                                                                 TaxAmount := FORMAT(ROUND(TaxableAmountVar[Integer.Number] * VATRate[Integer.Number]/100, GenLedgSetup."Amount Rounding Precision", '='), 0, 9);
                                                                               END;
                                                                                }

    { [{25B44434-743E-412B-8C6D-7009BB757F41}];4 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=TaxAmount_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   TaxAmount_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   TaxAmount_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{4D5BEA6B-66E2-45D7-A726-A20794A74C85}];4 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F15B07EC-FECF-4567-9A78-FB4A86756C92}];3 ;cac:TaxCategory     ;Element ;Text    ;
                                                  VariableName=TaxSubTotal_TaxCategory;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{CEF0AE71-98C8-4072-B46E-43E62A66289C}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=TaxSubTotal_TaxCategory_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //TaxSubTotal_TaxCategory_ID := "Sales Invoice Line"."VAT Identifier";
                                                                                 IF VATRateExemption[Integer.Number] THEN
                                                                                   TaxSubTotal_TaxCategory_ID := 'E'
                                                                                 ELSE
                                                                                 //>>181004
                                                                                   IF VATRate[Integer.Number] = 0 THEN
                                                                                 //  IF (VATRate[Integer.Number] = 0) AND (NOT EHFBuyersID) THEN
                                                                                 //<<181004
                                                                                     TaxSubTotal_TaxCategory_ID := 'E'
                                                                                   ELSE
                                                                                     TaxSubTotal_TaxCategory_ID := 'S';
                                                                               END;
                                                                                }

    { [{39517D09-FA70-43D9-B225-C25BB88168AB}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=TaxC_ID_identificationSchem3;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1C878A8A-6483-4EF8-B8E4-8E4CAF5930EC}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI16;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{62F7592A-9B05-4C65-A3AA-B4CE50894F26}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion16;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4A9AED12-95B4-4CF4-BABD-EB8D06EA4F99}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=TaxC_ID_identificationSchem4;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{CEA9A9A3-6AEA-4730-9F73-6CAA8078BE7C}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN16;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B4F347AA-55A0-4734-8229-F38FE11AC0DB}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=TaxC_ID_identificationSchem5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3CDD10FC-CB93-4E73-B3E0-E98EFDDEA0EB}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData14;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{13195F32-9402-4171-A7A9-D940A0934FCE}];4 ;cbc:Percent         ;Element ;Text    ;
                                                  VariableName=TaxCategory_Percent;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 TaxCategory_Percent := FORMAT(VATRate[Integer.Number], 0, 9);
                                                                               END;
                                                                                }

    { [{D196B79C-78FD-4E23-8BC5-30ADF7087B41}];4 ;cbc:ExemptionReason ;Element ;Text    ;
                                                  VariableName=TaxS_TaxCategory_ExemptionR;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF VATRateExemption[Integer.Number] THEN
                                                                                   TaxS_TaxCategory_ExemptionR := txtReverseChargeVAT
                                                                                 ELSE
                                                                                   IF TaxCategory_Percent = '0' THEN
                                                                                     TaxS_TaxCategory_ExemptionR := txtNoVAT
                                                                                   ELSE
                                                                                     TaxS_TaxCategory_ExemptionR := '';

                                                                                 //RFC1080
                                                                                 IF TaxS_TaxCategory_ExemptionR = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{190B194A-F950-41B2-BE1D-3ED237FD9689}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=TaxC_ExemptionReason_langua1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9959AF0D-1551-4408-9BB3-451E09C713F0}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=TaxS_TaxC_Exem_languageLoca;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{125C1A5B-C835-4103-AC61-0E262C284313}];4 ;cac:TaxScheme       ;Element ;Text    ;
                                                  VariableName=TaxS_TaxCategory_TaxScheme;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{60CA8693-B203-4DA7-9836-73F6AF642EB7}];5 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=TaxS_TaxCategory_TaxScheme_;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 TaxS_TaxCategory_TaxScheme_ := 'VAT';
                                                                               END;
                                                                                }

    { [{0A35C474-7D2A-48A8-A3E8-9D2650E944C3}];6 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=TaxS_ID_identificationSchem9;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2830CE4F-C9BA-4479-8E19-DB14DA8C58AB}];6 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI17;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2F139EEB-A6F3-4215-9604-A9EC6D160157}];6 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion17;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C7F18F4F-5FE5-4CE6-BDEB-AE0CA1568D3D}];6 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem10;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{51C51A90-51F5-4389-B353-79AEE8E9BFB5}];6 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN17;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F190596D-A73D-4442-A830-602E6D8BBDEB}];6 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem11;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3BB67AB8-1695-4670-9B93-75AA2DD22669}];6 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData15;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{749CDA56-F06B-4893-91F0-B40C40F51FC9}];3 ;cac:TaxCurrencyTaxAmount;Element;Table;
                                                  VariableName=int_TaxCurrTaxAmnt;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_TaxCurrTaxAmnt.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{29344063-8D66-47ED-997C-47067CF5D135}];4 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=TaxC_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   TaxC_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   TaxC_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{6548CFCA-A2CB-419C-8F44-CC48E15BB735}];4 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi5;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6CB63D10-1A3E-4A4E-9474-8924DEAE5AC4}];3 ;cac:InitialInvoiceTaxAmount;Element;Table;
                                                  VariableName=int_InitialInvTaxAmnt;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_InitialInvTaxAmnt.SETFILTER(Number, '1..-1');
                                                                         //Only used for credit memo
                                                                       END;
                                                                        }

    { [{C988DD83-B8C2-473F-B570-5A57F4439ACB}];4 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Init_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Init_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Init_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{94508793-B1F3-430B-90EA-FD5903CD6E20}];4 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi6;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{935C66B3-4AD3-4E74-970F-D137701CDCE8}];1 ;cac:LegalTotal      ;Element ;Text    ;
                                                  VariableName=LegalTotal;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{22B4EE83-21B7-4E30-8282-5EA57DB58B9A}];2 ;cbc:LineExtensionTotalAmount;Element;Text;
                                                  VariableName=LineExtensionTotalAmount;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 LineExtensionAmnt@1100285500 : Decimal;
                                                                               BEGIN
                                                                                 LineExtensionAmnt := 0;
                                                                                 //IF SalesInvoiceLineTEMP.FINDFIRST THEN REPEAT
                                                                                 IF SalesInvoiceLineTEMP.FINDSET(FALSE) THEN REPEAT
                                                                                   LineExtensionAmnt += SalesInvoiceLineTEMP."Line Amount";
                                                                                 UNTIL SalesInvoiceLineTEMP.NEXT = 0;

                                                                                 LineExtensionTotalAmount := FORMAT(LineExtensionAmnt - RoundOffAmount, 0, 9);
                                                                               END;
                                                                                }

    { [{61B669D5-8E8E-4D8F-A45E-3BD79F3D1B8E}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Line_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Line_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Line_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{670BD505-F0A9-492F-AD1C-66A8C8AE5781}];3 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi7;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E860A6F8-2EB1-4774-8109-10F776A280FE}];2 ;cbc:TaxExclusiveTotalAmount;Element;Text;
                                                  VariableName=TaxExclusiveTotalAmount;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 TaxExclTotAmount@1100285500 : Decimal;
                                                                               BEGIN
                                                                                 TaxExclTotAmount := 0;
                                                                                 IF SalesInvoiceLineTEMP.FINDSET(FALSE) THEN REPEAT
                                                                                   //DJ
                                                                                   TaxExclTotAmount += SalesInvoiceLineTEMP."Line Amount";
                                                                                   //TaxExclTotAmount := TaxExclTotAmount - SalesInvoiceLineTEMP."Inv. Discount Amount";
                                                                                   TaxExclTotAmount := TaxExclTotAmount - SalesInvoiceLineTEMP."Inv. Discount Amount";
                                                                                 UNTIL SalesInvoiceLineTEMP.NEXT = 0;

                                                                                 //>> 171127 RFC240
                                                                                 //TaxExclTotAmount -= CustLedgerEntry."Amount ROT";
                                                                                 TaxExclTotAmount -= CustLedgerEntry."Amount ROT" + CustLedgerEntry."Amount RUT"; // Remove ROT
                                                                                 //<< RFC240

                                                                                 TaxExclTotAmount -= RoundOffAmount; // Remove RoundOfAmount

                                                                                 //140612 DJ

                                                                                 TaxExclusiveTotalAmount := FORMAT((TaxExclTotAmount), 0, 9); //140604 lagt till avdrag av rot minus moms
                                                                               END;
                                                                                }

    { [{10D64341-F2E5-4A28-B56D-DF3E2D6A4D8B}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=TaxE_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   TaxE_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   TaxE_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{F2ED39AC-817E-4BBF-A3DC-700289BA2738}];3 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi8;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8A9CB9CF-9610-4613-9411-C00C14468BC5}];2 ;cbc:TaxInclusiveTotalAmount;Element;Text;
                                                  VariableName=TaxInclusiveTotalAmount;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 TaxInclTotAmount@1100285500 : Decimal;
                                                                               BEGIN
                                                                                 TaxInclTotAmount := 0;
                                                                                 IF SalesInvoiceLineTEMP.FINDSET(FALSE) THEN REPEAT
                                                                                   TaxInclTotAmount += SalesInvoiceLineTEMP."Amount Including VAT";
                                                                                 UNTIL SalesInvoiceLineTEMP.NEXT = 0;

                                                                                 //140612 DJ
                                                                                 //TaxInclusiveTotalAmount := FORMAT(TaxInclTotAmount, 0, 9);

                                                                                 //>> 171127 RFC240
                                                                                 //TaxInclusiveTotalAmount := FORMAT(TaxInclTotAmount - CustLedgerEntry."Amount ROT", 0, 9);
                                                                                 TaxInclusiveTotalAmount := FORMAT(TaxInclTotAmount - (CustLedgerEntry."Amount ROT" + CustLedgerEntry."Amount RUT"), 0, 9);
                                                                                 //<< RFC240

                                                                                 //[NOGOV-T10-R037]-Document level amounts cannot have more than 2 decimals
                                                                                 // IF EHFBuyersID THEN
                                                                                 //  TaxInclusiveTotalAmount := FORMAT(ROUND(TaxInclTotAmount - (CustLedgerEntry."Amount ROT" + CustLedgerEntry."Amount RUT"),Currency."Amount Rounding Precision",'='), 0, 9);
                                                                               END;
                                                                                }

    { [{D780889D-D4A5-4170-B944-9F28E1391740}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=TaxI_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   TaxI_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   TaxI_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{7D61EDC8-74D2-4A1C-B422-A9E7D684132F}];3 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi9;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{34F83ECC-8352-4290-A41A-BDD0466FA071}];2 ;cac:RoundOffAmount  ;Element ;Text    ;
                                                  VariableName=StrRoundOffAmount;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 StrRoundOffAmount := FORMAT(RoundOffAmount, 0, 9);
                                                                               END;
                                                                                }

    { [{0FA1EEBF-654E-4FF3-A7B2-83ACB67A038F}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Roun_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Roun_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Roun_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{311F7984-F359-4358-9B5B-F0A0AB94151D}];3 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi10;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{51F6BCCE-F83D-4935-AA2D-1C537D593C33}];1 ;cac:InvoiceLine     ;Element ;Table   ;
                                                  VariableName=int_Before;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_Before.SETFILTER(Number, '1..-1');
                                                                         //IF NOT (StrippedView) AND (ExtraTextField <> '') AND NOT (NoRounding) THEN int_Before.SETRANGE(Number, 1);  // 160919 ITERO.AC IME484 do not use ExtraTextField
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //IF (SalesReportTextLineFooter.Text = "Sales Invoice Header"."Invoice Text") THEN currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{40A23C30-69CC-4EAD-B7D7-15143A4A19F6}];2 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=before_id;
                                                  DataType=Integer;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 before_id := '1';
                                                                               END;
                                                                                }

    { [{EF910C04-E0BA-4EE0-94E2-894CB2DBE1CA}];2 ;cbc:LineExtensionAmount;Element;Text  ;
                                                  VariableName=LineAmountbefore;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 LineAmountbefore := '0';
                                                                               END;
                                                                                }

    { [{C1B8AB30-F997-4EE4-932A-21796477D56D}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=before_Line_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   before_Line_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   before_Line_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{D47A83B6-04BF-4995-8CF7-82F6BCC5B73F}];2 ;cac:Item            ;Element ;Text    ;
                                                  VariableName=beforeItem;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{83A0B6AB-4AC6-4A9A-96B0-829DA5FED1C2}];3 ;cbc:Description     ;Element ;Text    ;
                                                  VariableName=BeforeDescription;
                                                  DataType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BeforeDescription := ExtraTextField;
                                                                               END;
                                                                                }

    { [{D05F5803-3A71-4162-948B-BC82E8D88F99}];1 ;cac:InvoiceLine     ;Element ;Table   ;
                                                  VariableName=InvoiceLine;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  LinkTable=Sales Invoice Header;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF (SalesInvoiceLineTEMP.COUNT = 0) THEN InvoiceLine.SETFILTER(Number, '1..-1')
                                                                         ELSE BEGIN
                                                                           CurrentLineNo := 0;
                                                                           CASE "Sales Invoice Header"."Invoice Layout Code" OF
                                                                             '0','1': SalesInvoiceLineTEMP.SETCURRENTKEY("Document No.","Cost Type Cost Plus Line");
                                                                             '2': SalesInvoiceLineTEMP.SETCURRENTKEY("Document No.","Line No.");
                                                                             '3': SalesInvoiceLineTEMP.SETCURRENTKEY("Job No.","Extension Contract");
                                                                             '4': SalesInvoiceLineTEMP.SETCURRENTKEY("Job No.", Element);//RFC1153
                                                                             ELSE SalesInvoiceLineTEMP.SETCURRENTKEY("Document No.","Line No.");
                                                                           END;
                                                                           SalesInvoiceLineTEMP.FINDSET(FALSE);
                                                                         END;

                                                                         {
                                                                         Kostnadstyp (Normal)
                                                                         "Invoice Layout Code = 0
                                                                         "Sorterad efter "Cost Type Cost Plus Line" om "Cost Object Cost Plus Line" har ett v„rde f”r raden, annars sortera p† radnummer. (B„ttre f”rklaing finns i rapport 81666 Generic Sales Document Imtech, se variabel "TypeSorting")
                                                                         Ej grupperad (sorterad efter kostnadstyp)
                                                                         "Invoice Layout Code = 1
                                                                         Enligt avr„kningsark
                                                                         "Invoice Layout Code = 2
                                                                         "Sorterad efter radnummer
                                                                         Ej grupperad (sorterad efter ŽTA nr)
                                                                         "Invoice Layout Code = 3
                                                                         "Sorterad efter ŽTA (Extension contract)
                                                                         "Invoice Layout Code = 4
                                                                         "Sorterad efter Element
                                                                         }

                                                                         NewLine := FALSE;
                                                                         LineChange := FALSE;
                                                                         SalesLines := FALSE;
                                                                         ReportLinesBefore := FALSE;
                                                                         ReportLinesAfter := FALSE;
                                                                         ReachedLineEnd := FALSE;
                                                                         LineCount2 := 0;
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             // This loop is controlled by Integer and loops by SalesInvoiceLineTEMP COMBINED with SalesREportTextLine
                                                                             // For each line in SalesInvoiceLine, it checks if there are "Before detail" posts in SalesReportTextLine. If so it loops through them and prints them out (Obsolete comment)
                                                                             // For each line afer SalesInvoiceLine, it check if there are "After Detail" pots in SalesReportTextLine. If so loops through them and prints them out. (Obsolete comment)
                                                                             // All three posts will create InvoiceLine-elements. To check what kind of line to print the current booleans are used:
                                                                             //  * ReportLinesBefore - If detailtextlines before is "current record" (Obsolete comment, logic has been moved)
                                                                             //  * ReportLinesAfter - If detailtextlines after is "current record" (Obsolete comment, logic has been moved)
                                                                             //  * SalesLines - If no detailtext is "current record", insted the real InvoiceLine is current record.
                                                                             // Only ONE of these booleans will be TRUE for each OnAfterGetRecord in the element InvoiceLine
                                                                             //
                                                                             // Variable CurrentLineNo will always show which Lineno the InvoiceLine element is on, indifferent of SalesInvoiceLineTEMP
                                                                             //
                                                                             // Two other booleans are used:
                                                                             //  * NewLine - TRUE if the line is NEW and hos not been printed out
                                                                             //  * LineChange - TRUE if the line is just changed but no AfterDetail is printed out
                                                                             LineCount2 += 1;
                                                                             IF InvoiceLine.Number > 1000 THEN
                                                                               currXMLport.BREAK;

                                                                             IF CurrentLineNo = 0 THEN BEGIN
                                                                               // ********* FIRST ROW!
                                                                               CurrentLineNo := SalesInvoiceLineTEMP."Line No.";
                                                                               NewLine := TRUE;
                                                                             END ELSE BEGIN
                                                                               // ********** SECOND ROW or more.
                                                                               IF SalesLines THEN BEGIN  // IF NOT TRUE you should not move in SalesInvoiceLineTEMP!
                                                                                 IF SalesInvoiceLineTEMP.NEXT = 0 THEN
                                                                                    ReachedLineEnd := TRUE;
                                                                                 LineChange := TRUE;
                                                                               END;
                                                                             END;

                                                                             IF LineChange THEN BEGIN
                                                                               ReportLinesBefore := FALSE;
                                                                               ReportLinesAfter := FALSE;
                                                                               SalesLines := FALSE;
                                                                               CurrentLineNo := SalesInvoiceLineTEMP."Line No.";
                                                                               NewLine := TRUE;
                                                                               IF ReachedLineEnd THEN BEGIN
                                                                                 InvoiceLine.SETRECFILTER;
                                                                                 currXMLport.SKIP; // Cancels out the InvoiceLine loop when lines are finished
                                                                               END;
                                                                             END;

                                                                             //>> 160919 ITERO.AC IME484 Logic for Gropy Headers/Footers is moved to Code Unit 81647
                                                                             //IF (LineChange) THEN BEGIN
                                                                             //   IF (Credit) THEN SalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Credit Memo");
                                                                             //   IF (NOT Credit) THEN SalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Invoice");
                                                                             //   SalesReportTextLine.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                             //   SalesReportTextLine.SETRANGE("Text Line Type", SalesReportTextLine."Text Line Type"::"After Detail");
                                                                             //   SalesReportTextLine.SETFILTER(Text, '<>%1', '');
                                                                             //   SalesReportTextLine.SETRANGE("Document Line No.", CurrentLineNo);
                                                                             //   IF (SalesReportTextLine.FINDSET(FALSE)) THEN BEGIN
                                                                             //      ReportLinesBefore := FALSE;
                                                                             //      ReportLinesAfter := TRUE;
                                                                             //      SalesLines := FALSE;
                                                                             //   END ELSE BEGIN
                                                                             //      ReportLinesBefore := FALSE;
                                                                             //      ReportLinesAfter := FALSE;
                                                                             //      SalesLines := FALSE;
                                                                             //      CurrentLineNo := SalesInvoiceLineTEMP."Line No.";
                                                                             //      NewLine := TRUE;
                                                                             //      IF (ReachedLineEnd) THEN BEGIN
                                                                             //         InvoiceLine.SETRECFILTER;
                                                                             //         currXMLport.SKIP; // Cancels out the InvoiceLine loop when lines are finished
                                                                             //      END;
                                                                             //   END;
                                                                             //   LineChange := FALSE;
                                                                             //END ELSE IF (ReportLinesAfter) THEN BEGIN
                                                                             //   IF (SalesReportTextLine.NEXT = 0) THEN BEGIN
                                                                             //      ReportLinesBefore := FALSE;
                                                                             //      ReportLinesAfter := FALSE;
                                                                             //      SalesLines := FALSE;
                                                                             //      IF NOT (ReachedLineEnd) THEN BEGIN
                                                                             //         NewLine := TRUE;
                                                                             //         CurrentLineNo := SalesInvoiceLineTEMP."Line No.";
                                                                             //      END ELSE BEGIN
                                                                             //         InvoiceLine.SETRECFILTER;
                                                                             //         currXMLport.SKIP; // Cancels out the InvoiceLine loop when lines are finished
                                                                             //      END;
                                                                             //   END;
                                                                             //END;

                                                                             IF (NOT NewLine) AND ReportLinesAfter AND (CurrentLineNo = LineNoWithData) AND InvoiceExtraLine THEN BEGIN
                                                                               InvoiceExtraLine := FALSE;
                                                                               currXMLport.SKIP;
                                                                             END;
                                                                             //>> 160919 ITERO.AC IME484 Moved some code here to avoid infinite loop, and avoid counting Group Footers (exists as MARKED invoice lines)
                                                                             IF NewLine THEN BEGIN
                                                                               ReportLinesBefore := FALSE;
                                                                               ReportLinesAfter := FALSE;
                                                                               SalesLines := TRUE;
                                                                               NewLine := FALSE;
                                                                             END
                                                                             ELSE
                                                                               IF ReportLinesBefore THEN BEGIN
                                                                                 IF SalesReportTextLine.NEXT = 0 THEN BEGIN
                                                                                   ReportLinesBefore := FALSE;
                                                                                   ReportLinesAfter := FALSE;
                                                                                   SalesLines := TRUE;
                                                                                 END;
                                                                               END;

                                                                             //IF (NewLine) THEN BEGIN
                                                                             //   IF (Credit) THEN SalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Credit Memo");
                                                                             //   IF (NOT Credit) THEN SalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Invoice");
                                                                             //   SalesReportTextLine.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                             //   SalesReportTextLine.SETRANGE("Text Line Type", SalesReportTextLine."Text Line Type"::"Before Detail");
                                                                             //   SalesReportTextLine.SETFILTER(Text, '<>%1', '');
                                                                             //   SalesReportTextLine.SETRANGE("Document Line No.", CurrentLineNo);
                                                                             //   IF (SalesReportTextLine.FINDSET(FALSE) AND (SalesReportTextLine."Document Line No." <> FirstLineNo)) THEN BEGIN
                                                                             //      ReportLinesBefore := TRUE;
                                                                             //      ReportLinesAfter := FALSE;
                                                                             //      SalesLines := FALSE;
                                                                             //   END ELSE BEGIN
                                                                             //      ReportLinesBefore := FALSE;
                                                                             //      ReportLinesAfter := FALSE;
                                                                             //      SalesLines := TRUE;
                                                                             //   END;
                                                                             //   //IF (SalesReportTextLine = FirstLineNO) THEN BEGIN
                                                                             //
                                                                             //   //END;
                                                                             //   NewLine := FALSE;
                                                                             //END ELSE IF (ReportLinesBefore) THEN BEGIN
                                                                             //   IF (SalesReportTextLine.NEXT = 0) THEN BEGIN
                                                                             //      ReportLinesBefore := FALSE;
                                                                             //      ReportLinesAfter := FALSE;
                                                                             //      SalesLines := TRUE;
                                                                             //   END;
                                                                             //END;
                                                                             //<< 160919 ITERO.AC IME484

                                                                             // ************************************ onAfterGetCurrentRecord ************************************
                                                                             IF StrippedView AND (NOT SalesLines) THEN
                                                                               currXMLport.SKIP; // Skips additional lines

                                                                             IF SalesLines AND (RoundOffAmount = SalesInvoiceLineTEMP.Amount) AND (RoundOffAmount <> 0) THEN
                                                                               currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{7645E074-4365-4F7D-A0D5-A5A51FA3817E}];2 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=InvoiceLine_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF SalesLines THEN
                                                                                   InvoiceLine_ID := FORMAT(SalesInvoiceLineTEMP."Line No.", 0, 9);
                                                                                 IF ReportLinesBefore OR ReportLinesAfter THEN
                                                                                   InvoiceLine_ID := FORMAT(SalesReportTextLine."Line No.", 0, 9);
                                                                               END;
                                                                                }

    { [{0CA6FEBF-0797-4E3E-9D2F-F834E5698F5C}];2 ;cbc:InvoicedQuantity;Element ;Text    ;
                                                  VariableName=InvoicedQuantity;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //>> 160919 ITERO.AC IME484 Do not export this tag for Group Header and Group Footers
                                                                                 IF SalesInvoiceLineTEMP.MARK AND (NOT NoRounding ) THEN // 161014 ITERO.AC IME484 bugfix Norwegian EFH invoices must have Quantity
                                                                                   currXMLport.SKIP;
                                                                                 //<< 160919 ITERO.AC IME484

                                                                                 IF SalesLines THEN BEGIN
                                                                                   InvoicedQuantity := FORMAT(SalesInvoiceLineTEMP.Quantity, 0, 9);
                                                                                   IF (SalesInvoiceLineTEMP.Quantity > 0) AND (SalesInvoiceLineTEMP.Amount < 0) THEN
                                                                                     InvoicedQuantity := FORMAT(-SalesInvoiceLineTEMP.Quantity, 0, 9);
                                                                                 END;
                                                                                 IF ReportLinesBefore OR ReportLinesAfter THEN
                                                                                   InvoicedQuantity := '0';
                                                                               END;
                                                                                }

    { [{A4029E37-89C5-4287-AC39-F255B01BCCF1}];3 ;quantityUnitCode    ;Attribute;Text   ;
                                                  VariableName=Invo_quantityUnitCode;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 UnitOfMeasure@1100285000 : Record 204;
                                                                               BEGIN
                                                                                 IF SalesLines THEN BEGIN
                                                                                   //>> 161014 ITERO.AC IME484 bugfix No Unit code for header/footer lines
                                                                                   IF SalesInvoiceLineTEMP.MARK THEN BEGIN
                                                                                     Invo_quantityUnitCode := ' ';
                                                                                   END
                                                                                   ELSE
                                                                                     BEGIN
                                                                                       Invo_quantityUnitCode := SalesInvoiceLineTEMP."Unit of Measure Code";
                                                                                       //IF (UnitOfMeasure.GET(Invo_quantityUnitCode)) THEN Invo_quantityUnitCode := UnitOfMeasure.Description;

                                                                                 //RFC1169.2
                                                                                       IF UnitOfMeasure.GET(Invo_quantityUnitCode) THEN
                                                                                         IF UnitOfMeasure."International Standard Code"<>'' THEN
                                                                                           Invo_quantityUnitCode := UnitOfMeasure."International Standard Code";
                                                                                 //RFC1169

                                                                                     END;
                                                                                 END
                                                                                 ELSE BEGIN
                                                                                   //<< 161014 ITERO.AC IME484 bugfix
                                                                                   Invo_quantityUnitCode := ' ';
                                                                                 END;

                                                                                 //181001
                                                                                 //[OP-T10-R006]-Unit code MUST be coded according to the UN/ECE Recommendation 20
                                                                                 // IF EHFBuyersID AND (Invo_quantityUnitCode <> ' ') AND (Invo_quantityUnitCode <> '') THEN
                                                                                 //  IF UnitOfMeasure.GET(Invo_quantityUnitCode) THEN
                                                                                 //    IF UnitOfMeasure."International Standard Code"<>'' THEN
                                                                                 //      Invo_quantityUnitCode := UnitOfMeasure."International Standard Code";

                                                                                 IF Invo_quantityUnitCode = '' THEN
                                                                                   Invo_quantityUnitCode := ' ';
                                                                               END;
                                                                                }

    { [{4B578DAF-5C66-442A-AC7B-71788D87A13A}];3 ;quantityUnitCodeListID;Attribute;Text ;
                                                  VariableName=Invo_quantityUnitCodeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{483BDB70-83D3-4921-A438-7975A73D5C8E}];3 ;quantityUnitCodeListAgencyID;Attribute;Text;
                                                  VariableName=quantityUnitCodeListAgencyI;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{67C7E038-9683-4EEE-9E42-8726E3B70C30}];3 ;quantityUnitCodeListAgencyName;Attribute;Text;
                                                  VariableName=quantityUnitCodeListAgencyN;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7BEB91A8-CF2B-4795-B853-36ABE560D1DC}];2 ;cbc:LineExtensionAmount;Element;Text  ;
                                                  VariableName=LineExtensionAmount;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF SalesLines THEN BEGIN
                                                                                   IF NoRounding THEN BEGIN
                                                                                     //>> 161014 ITERO.AC IME484 Bugfix  Just write a plain "0" for header lines in Norwegian EFH invoices
                                                                                     IF SalesInvoiceLineTEMP.MARK THEN BEGIN
                                                                                       LineExtensionAmount := '0';
                                                                                     END ELSE BEGIN
                                                                                       LineExtensionAmount := FORMAT(SalesInvoiceLineTEMP.Amount, 0, 9);
                                                                                     END;
                                                                                     //<< 161014 ITERO.AC IME484 Bugfix
                                                                                   END ELSE BEGIN
                                                                                     LineExtensionAmount := FORMAT(ROUND(SalesInvoiceLineTEMP.Amount, 0.01, '='), 0, 9);
                                                                                   END;
                                                                                 END ELSE BEGIN
                                                                                    LineExtensionAmount := '0';
                                                                                 END;
                                                                               END;
                                                                                }

    { [{A8F545DD-5812-4CF7-B9D2-ED3470E6AF64}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Invo_Line_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Invo_Line_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Invo_Line_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{E8C1613E-1DE6-4A05-9B6E-20EA9B1854CB}];3 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi11;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{EE23CCC2-515E-4BE1-B6E6-E37890BFB41D}];2 ;cbc:Note            ;Element ;Text    ;
                                                  VariableName=LineNote;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //>> 161014 ITERO.AC IME484 Bugfix
                                                                                 //>> 160919 ITERO.AC IME484 Do not export this tag for Group Header and Group Footers
                                                                                 //IF SalesInvoiceLineTEMP.MARK THEN
                                                                                 //  currXMLport.SKIP;
                                                                                 //<< 160919 ITERO.AC IME484

                                                                                 IF SalesInvoiceLineTEMP.MARK AND (NOT NoRounding) THEN
                                                                                   currXMLport.SKIP;
                                                                                 //<< 161014 ITERO.AC IME484

                                                                                 LineNote := '';
                                                                                 IF NOT SalesInvoiceLineTEMP.MARK THEN BEGIN   // 161014 ITERO.AC IME484 Bugfix
                                                                                   IF SalesLines THEN BEGIN
                                                                                     IF ShowDiscount THEN BEGIN
                                                                                       IF SalesInvoiceLineTEMP."Line Discount %" <> 0 THEN
                                                                                         LineNote := '[percent:-' + FORMAT(ABS(ROUND(SalesInvoiceLineTEMP."Line Discount %", 0.01, '='))) + ']'
                                                                                       ELSE
                                                                                         IF SalesInvoiceLineTEMP."Surcharge %" <> 0 THEN
                                                                                           LineNote := '[percent:' + FORMAT(ABS(ROUND(SalesInvoiceLineTEMP."Surcharge %", 0.01, '='))) + ']';
                                                                                     END;
                                                                                   END;
                                                                                 END;                                          // 161014 ITERO.AC IME484 Bugfix

                                                                                 IF LineNote = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{15F7BBEA-8D7A-4C19-80C9-EF7A4932CF12}];2 ;cac:OrderLineReference;Element;Table  ;
                                                  VariableName=int_OrderLineRef;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF StrippedView THEN BEGIN
                                                                           IF "Sales Invoice Header"."Principal Reference" = '' THEN
                                                                             int_OrderLineRef.SETFILTER(Number, '1..-1')
                                                                           ELSE
                                                                             int_OrderLineRef.SETFILTER(Number, '1');
                                                                         //>> 161020 ITERO.AC IME494 Send Order Line Reference in Norwegian EFH Invoices
                                                                         //>> 161112 ITERO.AC Remove RFC494
                                                                         END ELSE BEGIN
                                                                         //  IF NoRounding THEN BEGIN
                                                                         //    IF ("Sales Invoice Header"."Principal Reference" = '') THEN
                                                                         //      int_OrderLineRef.SETFILTER(Number, '1..-1')
                                                                         //    ELSE
                                                                         //      int_OrderLineRef.SETFILTER(Number, '1');
                                                                         //  END ELSE BEGIN
                                                                             int_OrderLineRef.SETFILTER(Number, '1..-1');
                                                                         //>>190111,RCF1080.3
                                                                             IF custBuyersID THEN
                                                                               int_OrderLineRef.SETFILTER(Number, '1');
                                                                         //<<190111
                                                                         //  END;
                                                                         //<< 161112 ITERO.AC Remove RFC494
                                                                         END;
                                                                         //<< 161020 ITERO.AC IME494

                                                                         //>>180315 RFC1004
                                                                         // IF EHFBuyersID THEN BEGIN
                                                                         //  int_OrderLineRef.SETFILTER(Number, '1');
                                                                         //  IF ("Sales Invoice Header"."Principal Reference" = '') THEN
                                                                         //    int_OrderLineRef.SETFILTER(Number, '1..-1')
                                                                         // END;
                                                                         //<<RFC1004
                                                                       END;
                                                                        }

    { [{B0123066-660A-4CD8-89F9-7D291DCA6D97}];3 ;cac:OrderReference  ;Element ;Text    ;
                                                  VariableName=OrderReference;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{B1C03495-6E91-43BE-A85F-EBEC724B3923}];4 ;cac:BuyersID        ;Element ;Text    ;
                                                  VariableName=BuyersID;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyersID := "Sales Invoice Header"."Principal Reference";
                                                                                 IF custBuyersID THEN
                                                                                   BuyersID := "Sales Invoice Header"."Order No. Customer";

                                                                                 //>>180315 RFC1004
                                                                                 // IF EHFBuyersID THEN BEGIN
                                                                                 //  BuyersID := "Sales Invoice Header"."Order No. Customer";
                                                                                 //  IF "Sales Invoice Header"."Job No." <> '' THEN
                                                                                 //    BuyersID := "Sales Invoice Header"."Principal Reference"
                                                                                 //  ELSE
                                                                                 //    BuyersID := "Sales Invoice Header"."Your Reference";
                                                                                 //  IF StrippedView AND ("Sales Invoice Header"."Principal Reference" <> '') THEN
                                                                                 //    BuyersID := "Sales Invoice Header"."Bill-to Contact";
                                                                                 // END;
                                                                                 //<<RFC1004
                                                                               END;
                                                                                }

    { [{81798CA8-E653-4977-8440-D66624587FFF}];2 ;cac:DespatchLineReference;Element;Table;
                                                  VariableName=DespatchLineReference;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         DespatchLineReference.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{D9F724F2-716E-4E2F-A47C-EF8E6AC50E56}];3 ;cac:LineID          ;Element ;Text    ;
                                                  VariableName=LineID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{C5DD96C8-E696-43A6-B049-AC5540EED5BB}];4 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Line_identificationSchemeID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B6663CBD-207D-492B-8E18-61A1A5C7F449}];4 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI20;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{ED9FF56E-5959-4A96-BF8B-D005D19EBC9E}];4 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion20;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D6B79148-05D4-4A1D-8A18-4FF5C11370F2}];4 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Line_identificationSchemeUR;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{67E8660B-6D91-4FE1-B5E8-061CDC44AE5E}];4 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN20;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{24C5D950-FA50-438B-9099-9FF9939E17FD}];4 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Line_identificationSchemeNa;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6ADC6B3E-8EB2-4009-948D-F93FC2129A46}];4 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=Line_identificationSchemeDa;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{65A17EB1-121D-4164-8D75-C8BC9493E002}];3 ;cac:DocumentReference;Element;Text    ;
                                                  VariableName=DocumentReference;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{8AD8A3A8-E782-4BFA-9C5E-9D2FBBB54740}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=DocumentReference_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{96B85784-E07B-4CDE-A1F2-15CE04009E4C}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Docu_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{BCBEC17D-9F53-464C-9CCB-485552E2100D}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI21;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6EC01536-9BD0-40EB-A179-1434BC406519}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion21;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8F181210-C22F-4391-BA94-6907D9D22C95}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Docu_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{429C0B55-1109-4F0F-AA54-912743B07D9A}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN21;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2DB3EB56-E20F-43B6-BCE5-3582D75BD7AF}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Docu_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E7A8D64E-07B9-4861-9F63-63C364E59F37}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData16;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{6B8458C9-46DE-4CC4-B3F7-FC0BD7EC3571}];2 ;cac:Delivery        ;Element ;Table   ;
                                                  VariableName=InvoiceLine_Delivery;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         InvoiceLine_Delivery.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{BDBC8D79-51F5-45EA-ABC2-995384355EA1}];3 ;cbc:ActualDeliveryDateTime;Element;Text;
                                                  VariableName=Deli_ActualDeliveryDateTime;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Deli_ActualDeliveryDateTime := FORMAT(CREATEDATETIME("Sales Invoice Header"."Shipment Date", 0T),0,9);
                                                                               END;
                                                                                }

    { [{70B3D8C7-98FB-418E-B698-BC4253D22EBE}];2 ;cac:AllowanceCharge ;Element ;Table   ;
                                                  VariableName=InvoiceLine_AllowanceCharge;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         gAllowanceChargeOnLine := 0;
                                                                         InvoiceLine_AllowanceCharge.SETFILTER(Number, '1..-1');
                                                                         IF SalesLines AND ShowDiscount THEN
                                                                           InvoiceLine_AllowanceCharge.SETFILTER(Number, '1');
                                                                       END;

                                                  Export::OnAfterGetRecord=VAR
                                                                             varDec@1000000000 : Decimal;
                                                                           BEGIN
                                                                             //>> 160919 ITERO.AC IME484 Do not export this tag for Group Header and Group Footers
                                                                             IF SalesInvoiceLineTEMP.MARK THEN
                                                                               currXMLport.SKIP;
                                                                             //<< 160919 ITERO.AC IME484

                                                                             Allo_ChargeIndicator := 'false';
                                                                             IF SalesInvoiceLineTEMP."Line Discount %" <> 0 THEN BEGIN
                                                                               Allo_ChargeIndicator := 'false';
                                                                               IF SalesInvoiceLineTEMP.Amount < 0 THEN
                                                                                 Allo_ChargeIndicator := 'true'
                                                                             END
                                                                             ELSE
                                                                               IF SalesInvoiceLineTEMP."Surcharge %" <> 0 THEN BEGIN
                                                                                 Allo_ChargeIndicator := 'true';
                                                                                 IF SalesInvoiceLineTEMP.Amount < 0 THEN
                                                                                   Allo_ChargeIndicator := 'false'
                                                                               END;
                                                                             //Villkor h„r

                                                                             AllowanceCharge_Amount := '0';
                                                                             gAllowanceChargeOnLine := 0;
                                                                             IF SalesInvoiceLineTEMP."Line Discount %" <> 0 THEN
                                                                               gAllowanceChargeOnLine := ABS(SalesInvoiceLineTEMP."Line Discount %" / 100 * SalesInvoiceLineTEMP."Unit Price" * SalesInvoiceLineTEMP.Quantity)
                                                                             ELSE IF SalesInvoiceLineTEMP."Surcharge %" <> 0 THEN
                                                                               //IF SalesInvoiceLineTEMP."Surcharge Amount" > 0 THEN //190521
                                                                               IF SalesInvoiceLineTEMP."Surcharge Amount" <> 0 THEN //190521
                                                                                 gAllowanceChargeOnLine := ABS(SalesInvoiceLineTEMP.Amount - ((SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount") * SalesInvoiceLineTEMP.Quantity))
                                                                               ELSE
                                                                                 gAllowanceChargeOnLine := ABS(SalesInvoiceLineTEMP.Amount - (SalesInvoiceLineTEMP."Unit Price" * SalesInvoiceLineTEMP.Quantity));

                                                                             IF NOT NoRounding THEN
                                                                               gAllowanceChargeOnLine := ROUND(gAllowanceChargeOnLine, 0.01, '=');
                                                                             AllowanceCharge_Amount := FORMAT(gAllowanceChargeOnLine, 0, 9);
                                                                             IF Allo_ChargeIndicator = 'false' THEN
                                                                               gAllowanceChargeOnLine := -gAllowanceChargeOnLine;

                                                                             IF gAllowanceChargeOnLine = 0 THEN
                                                                               currXMLport.SKIP;

                                                                             IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                               Allo_Amount_amountCurrencyI := "Sales Invoice Header"."Currency Code"
                                                                             ELSE
                                                                               Allo_Amount_amountCurrencyI := GenLedgSetup."LCY Code";
                                                                             Allo_Allo_amountCurrencyID := Allo_Amount_amountCurrencyI;

                                                                             IF SalesInvoiceLineTEMP."Line Discount %" <> 0 THEN
                                                                               varDec := SalesInvoiceLineTEMP.Amount - gAllowanceChargeOnLine
                                                                             ELSE
                                                                               varDec:= (SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount") * SalesInvoiceLineTEMP.Quantity;

                                                                             IF NoRounding THEN
                                                                               Allo_AllowanceChargeBaseAmo := FORMAT(varDec, 0, 9)
                                                                             ELSE
                                                                               Allo_AllowanceChargeBaseAmo := FORMAT(ROUND(varDec , 0.01, '='), 0, 9);
                                                                           END;
                                                                            }

    { [{88DB732E-73C5-4DBA-9290-D87D690B9F30}];3 ;cbc:ChargeIndicator ;Element ;Text    ;
                                                  VariableName=Allo_ChargeIndicator;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //190312 moved to InvoiceLine_AllowanceCharge - Export::OnAfterGetRecord()
                                                                                 // Allo_ChargeIndicator := 'false';
                                                                                 // IF SalesInvoiceLineTEMP."Line Discount %" <> 0 THEN BEGIN
                                                                                 //  Allo_ChargeIndicator := 'false';
                                                                                 //  IF SalesInvoiceLineTEMP.Amount < 0 THEN
                                                                                 //    Allo_ChargeIndicator := 'true'
                                                                                 // END
                                                                                 // ELSE
                                                                                 //  IF SalesInvoiceLineTEMP."Surcharge %" <> 0 THEN BEGIN
                                                                                 //    Allo_ChargeIndicator := 'true';
                                                                                 //    IF SalesInvoiceLineTEMP.Amount < 0 THEN
                                                                                 //      Allo_ChargeIndicator := 'false'
                                                                                 //  END;
                                                                                 // //Villkor h„r
                                                                                 //
                                                                                 // //181001, [NONAT-T10-R026]
                                                                                 // IF EHFBuyersID THEN BEGIN
                                                                                 //  Allo_ChargeIndicator := 'false';
                                                                                 //  IF SalesInvoiceLineTEMP."Surcharge %" <> 0 THEN
                                                                                 //    Allo_ChargeIndicator := 'true';
                                                                                 // END;
                                                                               END;
                                                                                }

    { [{B143F3E2-AFE4-41D5-87AC-4B543343CE99}];3 ;cbc:Amount          ;Element ;Text    ;
                                                  VariableName=AllowanceCharge_Amount;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 varDec@1100285100 : Decimal;
                                                                               BEGIN
                                                                                 //190312 moved to InvoiceLine_AllowanceCharge - Export::OnAfterGetRecord()
                                                                                 // AllowanceCharge_Amount := '0';
                                                                                 // gAllowanceChargeOnLine := 0;
                                                                                 // IF SalesInvoiceLineTEMP."Line Discount %" <> 0 THEN
                                                                                 //  gAllowanceChargeOnLine := ABS(SalesInvoiceLineTEMP."Line Discount %" / 100 * SalesInvoiceLineTEMP."Unit Price" * SalesInvoiceLineTEMP.Quantity)
                                                                                 // ELSE IF SalesInvoiceLineTEMP."Surcharge %" <> 0 THEN
                                                                                 //  IF SalesInvoiceLineTEMP."Surcharge Amount" > 0 THEN
                                                                                 //    gAllowanceChargeOnLine := ABS(SalesInvoiceLineTEMP.Amount - ((SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount") * SalesInvoiceLineTEMP.Quantity))
                                                                                 //  ELSE
                                                                                 //    gAllowanceChargeOnLine := ABS(SalesInvoiceLineTEMP.Amount - (SalesInvoiceLineTEMP."Unit Price" * SalesInvoiceLineTEMP.Quantity));
                                                                                 //
                                                                                 // IF NOT NoRounding THEN
                                                                                 //  gAllowanceChargeOnLine := ROUND(gAllowanceChargeOnLine, 0.01, '=');
                                                                                 // AllowanceCharge_Amount := FORMAT(gAllowanceChargeOnLine, 0, 9);
                                                                                 // IF Allo_ChargeIndicator = 'false' THEN
                                                                                 //  gAllowanceChargeOnLine := -gAllowanceChargeOnLine;
                                                                                 //
                                                                                 // //181024 [NONAT-T10-R026]-Invoice line amount MUST be equal to the price amount multiplied by the quantity plus charges minus allowances at line level.
                                                                                 // IF EHFBuyersID AND (SalesInvoiceLineTEMP.Quantity < 0) THEN BEGIN
                                                                                 //  varDec := -gAllowanceChargeOnLine ;
                                                                                 //  AllowanceCharge_Amount := FORMAT(varDec, 0, 9);
                                                                                 // END;
                                                                               END;
                                                                                }

    { [{6602E586-51FE-4F59-A68E-C9D3C9B28B9E}];4 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Allo_Amount_amountCurrencyI;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //190312 moved to InvoiceLine_AllowanceCharge - Export::OnAfterGetRecord()
                                                                                 // IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                 //  Allo_Amount_amountCurrencyI := "Sales Invoice Header"."Currency Code"
                                                                                 // ELSE
                                                                                 //  Allo_Amount_amountCurrencyI := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{2C827112-CBD4-4D09-9699-CC451D2EAC44}];4 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi12;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{91B38026-A318-4F45-9905-DB2544691DD1}];3 ;cac:AllowanceChargeBaseAmount;Element;Text;
                                                  VariableName=Allo_AllowanceChargeBaseAmo;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //190312 moved to InvoiceLine_AllowanceCharge - Export::OnAfterGetRecord()
                                                                                 // IF NoRounding THEN
                                                                                 //  Allo_AllowanceChargeBaseAmo := FORMAT((SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount") * SalesInvoiceLineTEMP.Quantity, 0, 9)
                                                                                 // ELSE
                                                                                 //  Allo_AllowanceChargeBaseAmo := FORMAT(ROUND((SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount") * SalesInvoiceLineTEMP.Quantity , 0.01, '='), 0, 9);
                                                                               END;
                                                                                }

    { [{322FD5A9-A2D2-429A-B7CA-1A707C2B1C6A}];4 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Allo_Allo_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //190312 moved to InvoiceLine_AllowanceCharge - Export::OnAfterGetRecord()
                                                                                 // IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                 //  Allo_Allo_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 // ELSE
                                                                                 //  Allo_Allo_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{6C13E5E1-D6A7-4F75-A66C-A608845539C2}];4 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi13;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4453450C-CD9B-4E39-AAE8-0C9038EB2FB6}];2 ;cac:Item            ;Element ;Text    ;
                                                  VariableName=Item;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{882790CB-52ED-472D-BF1D-FA9672CD4B21}];3 ;cbc:Description     ;Element ;Text    ;
                                                  VariableName=Description;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 WageDesc@1100285000 : Text;
                                                                                 ProjectCostPlusEntry@1100285001 : Record 11012019;
                                                                               BEGIN
                                                                                 IF SalesLines THEN BEGIN
                                                                                   Description := '';
                                                                                   //IF (SalesInvoiceLineTEMP.Amount = 0) THEN Description := '* ';
                                                                                   Description += SalesInvoiceLineTEMP.Description + SalesInvoiceLineTEMP."Description 2";    // 161014 ITERO.AC IME484 Bugfix if text exceeds 50 chars
                                                                                   WageDesc := '';
                                                                                   IF ProjectCostPlusEntry.GET(SalesInvoiceLineTEMP."Job No.", SalesInvoiceLineTEMP."Sell-to Customer No.", SalesInvoiceLineTEMP."Commission No.", SalesInvoiceLineTEMP."Settl.Sheet No.", SalesInvoiceLineTEMP."Cost Plus Line No.") THEN BEGIN
                                                                                     ProjectCostPlusEntry.CALCFIELDS("Cost Type");
                                                                                     IF ProjectCostPlusEntry."Cost Type"=ProjectCostPlusEntry."Cost Type"::Labor THEN BEGIN
                                                                                       IF ProjectCostPlusEntry."Wage Component"<>'' THEN BEGIN
                                                                                         ProjectCostPlusEntry.CALCFIELDS("Description Wage Component");
                                                                                         WageDesc := '-' + ProjectCostPlusEntry."Description Wage Component";
                                                                                       END;
                                                                                     END;
                                                                                   END;
                                                                                   Description += WageDesc;

                                                                                   //IF (ShowDiscount) THEN BEGIN
                                                                                   //   IF (SalesInvoiceLineTEMP."Line Discount %" <> 0) THEN Description += ' (' + FORMAT(SalesInvoiceLineTEMP."Line Discount %") + '% rabatt)';
                                                                                   //END;
                                                                                   IF FinChargeMemo THEN BEGIN

                                                                                   END;
                                                                                 END ELSE BEGIN
                                                                                   IF ReportLinesBefore THEN
                                                                                     Description := '* ' + DeleteHTML(SalesReportTextLine.Text);
                                                                                   IF ReportLinesAfter THEN
                                                                                     Description := '** ' + DeleteHTML(SalesReportTextLine.Text);
                                                                                 END;
                                                                               END;
                                                                                }

    { [{4E1B1981-CEF0-4F83-8745-23AEEE02FE34}];4 ;languageID          ;Attribute;Text   ;
                                                  VariableName=Description_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{65E07E10-03B0-4DE4-8ACE-EFF12580BC92}];4 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Desc_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9DF56C01-B64F-4697-9458-80FEF30D4EDC}];3 ;cac:BuyersItemIdentification;Element;Table;
                                                  VariableName=int_BuyerItemId;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_BuyerItemId.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{E1138702-9EC5-4CD7-8225-09D02F6F8BA7}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=BuyersItemIdentification_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{C3CC0313-C88F-403A-8C13-9B630EA297D3}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Buye_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{273E9FA5-7BE8-41B3-95B6-A881A8CB4937}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI22;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D4E52246-1FDA-4984-B8BA-555302E4F31D}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion22;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{86D5C56A-D072-4A75-9DCE-7B2E4B82B892}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Buye_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{893AB3FD-09FF-436F-8860-06BD34367630}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN22;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DECDD827-2941-49F2-8CDC-0A384218A0D5}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Buye_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{CC76EBC9-C5BB-40CE-9526-C24E407EC0EB}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData17;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2637ADC8-D962-4531-965E-3F03948DCB08}];3 ;cac:SellersItemIdentification;Element;Table;
                                                  VariableName=int_SellersItemId;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_SellersItemId.SETFILTER(Number, '1..-1');
                                                                         IF SalesLines AND (SalesInvoiceLineTEMP."Trade Item" <> '') AND (NOT HideItems) THEN
                                                                           int_SellersItemId.RESET;
                                                                       END;
                                                                        }

    { [{F4D169D1-D359-489C-861B-34457523D765}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Sell_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Sell_ID := SalesInvoiceLineTEMP."Trade Item";
                                                                               END;
                                                                                }

    { [{47374BCF-1E18-447E-A70A-F5615DCA1DF9}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Sell_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C7610E6B-631E-4DC0-9E09-3290AEA71C19}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI23;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DD5E1CFE-76FE-44B3-9030-C4914143BFCA}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion23;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E0F0D6BD-EBC8-4202-942B-73F2498647B0}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Sell_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{3F80D9D5-FDAD-4E48-8941-797C66D8B3BA}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN23;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{ADC00155-119F-4823-8092-166A8D113681}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Sell_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DF462F5B-C8B1-4927-ADE8-5D496FF02A24}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData18;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9145A5D8-F93E-467C-928B-F8C29FC55378}];3 ;cac:StandardItemIdentification;Element;Table;
                                                  VariableName=int_StandardItemId;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_StandardItemId.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{F5263385-4296-4F5A-B1D2-67E327393267}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Stan_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{5E704AE8-093B-4763-B40A-1B7926859E4B}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Stan_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D770428A-8BDF-456C-AC4A-4CE8755B427F}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI24;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C3921A3F-92FB-4F7C-9583-D19EE279B41C}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion24;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{F8371C07-8680-48EB-92FC-132F13702B26}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Stan_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{260F566D-B55E-47D6-91F9-A9BFDF7895B5}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN24;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DBA1AC54-2864-4A28-B5F6-12371C414053}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Stan_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{352D3A22-BCB3-4A44-BB79-377B33E9C424}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData19;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{BA202978-BDD9-48EB-B325-8523A34E5D29}];3 ;cac:TaxCategory     ;Element ;Table   ;
                                                  VariableName=int_TaxCategoryLine;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF SalesLines THEN
                                                                           int_TaxCategoryLine.SETRANGE(Number, 1)
                                                                         ELSE
                                                                           int_TaxCategoryLine.SETFILTER(Number, '1..-1');

                                                                         //>>181023, [NONAT-T14-R030]
                                                                         // IF EHFBuyersID AND (SalesInvoiceLineTEMP."No." = '') THEN
                                                                         //  int_TaxCategoryLine.SETFILTER(Number, '1..-1');
                                                                         //<<181023
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //>> 160919 ITERO.AC IME484 Do not export this tag for Group Header and Group Footers
                                                                             IF SalesInvoiceLineTEMP.MARK THEN
                                                                               currXMLport.SKIP;
                                                                             //<< 160919 ITERO.AC IME484
                                                                           END;
                                                                            }

    { [{56676443-0BF8-4D01-9FEB-DCFB99DBFA13}];4 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Item_TaxCategory_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF SalesLines THEN BEGIN
                                                                                   Item_TaxCategory_ID := 'S';
                                                                                   Item_TaxCategory_ExemptionR := '';
                                                                                   IF (SalesInvoiceLineTEMP."VAT Calculation Type" <> SalesInvoiceLineTEMP."VAT Calculation Type"::"Normal VAT") THEN BEGIN
                                                                                     Item_TaxCategory_ID := 'E';
                                                                                     Item_TaxCategory_ExemptionR := txtReverseChargeVAT
                                                                                   END
                                                                                   ELSE
                                                                                 //>>181004
                                                                                     IF SalesInvoiceLineTEMP."VAT %" = 0 THEN BEGIN
                                                                                 //    IF (SalesInvoiceLineTEMP."VAT %" = 0) AND (NOT EHFBuyersID) THEN BEGIN
                                                                                 //<<181004
                                                                                       Item_TaxCategory_ID := 'E';
                                                                                       Item_TaxCategory_ExemptionR := txtNoVAT;
                                                                                     END;
                                                                                 END;
                                                                               END;
                                                                                }

    { [{01EE58C0-E52B-4A8D-82E5-0303F2F4BEA8}];5 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=TaxC_ID_identificationSchem6;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{9FBA535B-5A53-412E-AC28-58CDA2E9D70C}];5 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI25;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2951DE6C-A528-4905-AA3C-D89B3C1F9682}];5 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion25;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C7320EDD-D35B-47B6-A45B-48BE42A4A6C1}];5 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=TaxC_ID_identificationSchem7;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{67B5F0D1-CB8D-41A7-85B6-17C144FD0608}];5 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN25;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1A0335A8-A36A-403B-A08A-40627EB018C4}];5 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=TaxC_ID_identificationSchem8;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{D50DA53E-68F3-46D6-AE6C-BF3B0AC520F2}];5 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData20;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{EF704D61-B86A-4233-9F1A-3778156F266B}];4 ;cbc:Percent         ;Element ;Text    ;
                                                  VariableName=Item_TaxCategory_Percent;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Item_TaxCategory_Percent := FORMAT(SalesInvoiceLineTEMP."VAT %", 0, 9);
                                                                               END;
                                                                                }

    { [{22A802B5-73CC-4ACE-A5B6-9F9B63029029}];4 ;cbc:ExemptionReason ;Element ;Text    ;
                                                  VariableName=Item_TaxCategory_ExemptionR;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF Item_TaxCategory_ExemptionR = '' THEN currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{FB4E7A36-76DA-46A5-BC1E-83856A6C3F08}];5 ;languageID          ;Attribute;Text   ;
                                                  VariableName=TaxC_ExemptionReason_langua2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4A2B880E-0327-46C2-A732-50EE654354C9}];5 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Item_TaxC_Exem_languageLoca;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7FD156B9-29C2-454A-A787-A63632E4D5FD}];4 ;cac:TaxScheme       ;Element ;Text    ;
                                                  VariableName=Item_TaxCategory_TaxScheme;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{8785BD20-1FFE-48D1-9F43-72E9645EEA96}];5 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Item_TaxCategory_TaxScheme_;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Item_TaxCategory_TaxScheme_ := 'VAT';
                                                                               END;
                                                                                }

    { [{4B2C0105-CB73-4F26-8E4E-E414C3C5370B}];6 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=TaxS_ID_identificationSchem12;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{47CF565A-2B8D-4378-A2B2-C68534A0E9D2}];6 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI26;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{976F8F4D-5553-446A-B1F7-AE725A213B21}];6 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion26;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{FD9168A8-981D-49B0-A500-439C34AEC243}];6 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem13;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{FC5D944E-C10C-4248-AFA4-4CC0D1C1176B}];6 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN26;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{ED177A5F-3797-499D-82BC-0EAC65316632}];6 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=TaxS_ID_identificationSchem14;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C394BA1F-6AB4-4B6A-913E-9E225CFDA954}];6 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData21;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{2B909DA5-86A4-4241-8C7C-207F20785A74}];3 ;cac:BasePrice       ;Element ;Table   ;
                                                  VariableName=int_BasePrice;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF SalesLines THEN
                                                                           int_BasePrice.SETFILTER(Number, '1')
                                                                         ELSE
                                                                           int_BasePrice.SETFILTER(Number, '1..-1');

                                                                         //>>181023, [NONAT-T14-R030]
                                                                         // IF EHFBuyersID AND (SalesInvoiceLineTEMP."No." = '') THEN
                                                                         //  int_BasePrice.SETFILTER(Number, '1..-1');
                                                                         //<<181023
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //>> 160919 ITERO.AC IME484 Do not export this tag for Group Header and Group Footers
                                                                             IF SalesInvoiceLineTEMP.MARK THEN
                                                                               currXMLport.SKIP;
                                                                             //<< 160919 ITERO.AC IME484
                                                                           END;
                                                                            }

    { [{721F82F2-6472-4847-9864-07075D6F7846}];4 ;cbc:PriceAmount     ;Element ;Text    ;
                                                  VariableName=PriceAmount;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 DivQuantity@1100285100 : Decimal;
                                                                                 PriceDec@1100285101 : Decimal;
                                                                                 lvPrecision@1000000000 : Decimal;
                                                                               BEGIN
                                                                                 IF SalesLines THEN BEGIN
                                                                                   //IF (NoRounding) THEN BEGIN
                                                                                     DivQuantity := SalesInvoiceLineTEMP.Quantity;
                                                                                     IF DivQuantity = 0 THEN
                                                                                       DivQuantity := 1;
                                                                                 //RFC1169.3
                                                                                   //Krav 8 i ML. Enhetspris skall kunna hanteras med upp till 4 decimaler
                                                                                   lvPrecision := GetPrecisionForEFHInvoice(DivQuantity, SalesInvoiceLineTEMP.Amount, gAllowanceChargeOnLine,4);

                                                                                     PriceDec := ABS((SalesInvoiceLineTEMP.Amount - gAllowanceChargeOnLine) / DivQuantity);
                                                                                     IF PriceDec = 0 THEN BEGIN // There was no Total amount
                                                                                       IF NOT ShowDiscount THEN
                                                                                 //RFC1169.3
                                                                                 //          PriceDec := ROUND(SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Line Discount %" / 100 * SalesInvoiceLineTEMP."Unit Price", 0.01, '=');
                                                                                           PriceDec := ROUND(SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Line Discount %" / 100 * SalesInvoiceLineTEMP."Unit Price", lvPrecision, '=');
                                                                                       IF ShowDiscount THEN BEGIN
                                                                                           IF (SalesInvoiceLineTEMP."Surcharge Amount" > 0) THEN
                                                                                 //RFC1169.3
                                                                                 //            PriceDec := ROUND(SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount", 0.01, '=')
                                                                                             PriceDec := ROUND(SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount", lvPrecision, '=')
                                                                                           ELSE
                                                                                 //RFC1169.3
                                                                                 //            PriceDec := ROUND(SalesInvoiceLineTEMP."Unit Price", 0.01, '=');
                                                                                             PriceDec := ROUND(SalesInvoiceLineTEMP."Unit Price", lvPrecision, '=');
                                                                                       END;
                                                                                     END;
                                                                                     //ABS(SalesInvoiceLineTEMP.Amount - ((SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount"
                                                                                     //>> 161016 ITERO.AC IME490 Get sufficient precision for Norwegian EFH Invoices
                                                                                     IF NoRounding THEN BEGIN
                                                                                       // PriceDec := ROUND(PriceDec, 0.00001, '=')
                                                                                 //RFC1169.3
                                                                                 //      lvPrecision := GetPrecisionForEFHInvoice(DivQuantity, SalesInvoiceLineTEMP.Amount, gAllowanceChargeOnLine);
                                                                                       lvPrecision := GetPrecisionForEFHInvoice(DivQuantity, SalesInvoiceLineTEMP.Amount, gAllowanceChargeOnLine,20);
                                                                                       PriceDec := ROUND(PriceDec, lvPrecision, '=');
                                                                                     END ELSE BEGIN
                                                                                 //RFC1169.3
                                                                                 //      PriceDec := ROUND(PriceDec, 0.01, '=');
                                                                                       PriceDec := ROUND(PriceDec, lvPrecision, '=');
                                                                                     END;
                                                                                     //<< 161016 ITERO.AC IME490
                                                                                     PriceAmount := FORMAT(ABS(PriceDec), 0, 9);
                                                                                     //IF NOT (ShowDiscount) THEN BEGIN
                                                                                     //   PriceAmount := FORMAT(PriceDec, 0, 9);
                                                                                     //END ELSE BEGIN
                                                                                     //   IF (SalesInvoiceLineTEMP."Surcharge Amount" > 0) THEN
                                                                                     //      PriceAmount := FORMAT(SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount", 0, 9)
                                                                                     //   ELSE
                                                                                     //      PriceAmount := FORMAT(SalesInvoiceLineTEMP."Unit Price", 0, 9)
                                                                                     //END;
                                                                                   //END ELSE BEGIN
                                                                                   //   IF NOT (ShowDiscount) THEN
                                                                                   //      PriceAmount := FORMAT(ROUND(SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Line Discount %" / 100 * SalesInvoiceLineTEMP."Unit Price", 0.01, '='), 0, 9);
                                                                                   //   IF (ShowDiscount) THEN BEGIN
                                                                                   //      IF (SalesInvoiceLineTEMP."Surcharge Amount" > 0) THEN
                                                                                   //         PriceAmount := FORMAT(ROUND(SalesInvoiceLineTEMP."Unit Price" - SalesInvoiceLineTEMP."Surcharge Amount", 0.01, '='), 0, 9)
                                                                                   //      ELSE
                                                                                   //         PriceAmount := FORMAT(ROUND(SalesInvoiceLineTEMP."Unit Price", 0.01, '='), 0, 9)
                                                                                   //   END;
                                                                                   //END;
                                                                                 END ELSE BEGIN
                                                                                   PriceAmount := '0';
                                                                                 END;
                                                                               END;
                                                                                }

    { [{3BA5682D-4418-4964-916F-533247C530B5}];5 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Pric_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Pric_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Pric_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{8F45278C-4851-45D9-9CCA-2A9BD67CEEA4}];5 ;amountCurrencyCodeListVersionID;Attribute;Text;
                                                  VariableName=amountCurrencyCodeListVersi14;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{0115D3D2-2410-489E-AAC6-E6E193156140}];4 ;cbc:BaseQuantity    ;Element ;Table   ;
                                                  VariableName=int_BaseQty;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_BaseQty.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{EB6C4231-80F0-4F8C-8B6F-FC94028A4D2F}];5 ;quantityUnitCode    ;Attribute;Text   ;
                                                  VariableName=Base_quantityUnitCode;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 UnitOfMeasure@1100285000 : Record 204;
                                                                               BEGIN
                                                                                 IF SalesLines THEN BEGIN
                                                                                    Base_quantityUnitCode := SalesInvoiceLineTEMP."Unit of Measure";
                                                                                    IF UnitOfMeasure.GET(Invo_quantityUnitCode) THEN
                                                                                      Base_quantityUnitCode := UnitOfMeasure.Description;
                                                                                 END
                                                                                 ELSE
                                                                                   Base_quantityUnitCode := '-';
                                                                                 IF Base_quantityUnitCode = '' THEN
                                                                                   Base_quantityUnitCode := '-';
                                                                               END;
                                                                                }

    { [{60A11E8F-B8A8-43E3-9544-30B28F565848}];5 ;quantityUnitCodeListID;Attribute;Text ;
                                                  VariableName=Base_quantityUnitCodeListID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{A522A16D-FE61-4477-9261-8E9870968627}];5 ;quantityUnitCodeListAgencyID;Attribute;Text;
                                                  VariableName=quantityUnitCodeListAgencyI1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8529E46A-D3E7-4C6F-9703-39B974CA294C}];5 ;quantityUnitCodeListAgencyName;Attribute;Text;
                                                  VariableName=quantityUnitCodeListAgencyN1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{B1AA37EF-1FCF-4F56-B5DC-DDF1134BECB6}];1 ;cac:InvoiceLine     ;Element ;Table   ;
                                                  VariableName=SalesReportTextLineFooter;
                                                  SourceTable=Table11071912;
                                                  SourceTableView=SORTING(Field10,Field20,Field30,Field40,Field60);
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF Credit THEN
                                                                           SalesReportTextLineFooter.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Credit Memo")
                                                                         ELSE
                                                                           SalesReportTextLineFooter.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Invoice");
                                                                         SalesReportTextLineFooter.SETRANGE("Document No.", "Sales Invoice Header"."No.");
                                                                         SalesReportTextLineFooter.SETRANGE("Text Line Type", SalesReportTextLine."Text Line Type"::Footer);
                                                                         SalesReportTextLineFooter.SETFILTER(Text, '<>%1', '');
                                                                         //>> 160927 ITERO.AC IME484 Footer lines should be exported in Norwegian EFH invoices
                                                                         //IF (StrippedView) OR (NoRounding) THEN SalesReportTextLineFooter.SETFILTER(Text, '-o-');
                                                                         IF StrippedView THEN
                                                                           SalesReportTextLineFooter.SETFILTER(Text, '-o-');
                                                                         //<< 160927 ITERO.AC IME484
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //IF (SalesReportTextLineFooter.Text = "Sales Invoice Header"."Invoice Text") THEN currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{B9146561-38A5-4320-89D0-3AD182039F84}];2 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=SalesReportTextLineFooter_ID;
                                                  DataType=Integer;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // 160920 ITERO.AC IME484 Get Unique Line No for new footer lines
                                                                                 SalesReportTextLineFooter_ID := FORMAT(SalesReportTextLineFooter."Line No." + MaxLineNo);
                                                                               END;
                                                                                }

    { [{FD923503-F41B-458D-AF19-E730719FF3D8}];2 ;cbc:InvoicedQuantity;Element ;Text    ;
                                                  VariableName=InvoicedQuantityFot;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // 161014 ITERO.AC IME484 New XML Element InvoiceQuantity (for Footer Lines)
                                                                                 // For Norwegian EFH Invices Quantity seems to be mandatory
                                                                                 IF NOT NoRounding THEN
                                                                                   currXMLport.SKIP
                                                                                 ELSE
                                                                                   InvoicedQuantityFot := '0';
                                                                               END;
                                                                                }

    { [{6D2C79F8-49A8-4D23-8B5D-63DF2607B738}];3 ;quantityUnitCode    ;Attribute;Text   ;
                                                  VariableName=Invo_quantityUnitCodeFot;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=VAR
                                                                                 UnitOfMeasure@1100285000 : Record 204;
                                                                               BEGIN
                                                                                 // 161014 ITERO.AC IME484 New Attribute for the new XML Element InvoiceQuantity (for Footer Lines)
                                                                                 Invo_quantityUnitCodeFot := ' ';
                                                                               END;
                                                                                }

    { [{F2BB032F-CE0F-4FC5-A748-C08DC7B0584B}];3 ;quantityUnitCodeListID;Attribute;Text ;
                                                  VariableName=Invo_quantityUnitCodeListIDFot;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{97D91A9A-030D-4638-AC89-578014E783AC}];3 ;quantityUnitCodeListAgencyID;Attribute;Text;
                                                  VariableName=quantityUnitCodeListAgencyIFot;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{38E9E310-807F-47E0-9EC2-9E896D63C678}];3 ;quantityUnitCodeListAgencyName;Attribute;Text;
                                                  VariableName=quantityUnitCodeListAgencyNFot;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{4AC8C1E8-D88C-49EF-B88B-9E05951EE211}];2 ;cbc:LineExtensionAmount;Element;Text  ;
                                                  VariableName=LineExtensionAmountFooter;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 LineExtensionAmountFooter := '0';
                                                                               END;
                                                                                }

    { [{4AD51046-DDDB-4EA0-BDB2-4776F028AA5F}];3 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Footer_Line_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Footer_Line_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Footer_Line_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{A685304A-2D53-46A8-8881-90F604F0BDC9}];2 ;cbc:Note            ;Element ;Text    ;
                                                  VariableName=LineNoteFooter;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // 161014 ITERO.AC IME484 New XML Element InvoiceQuantity (for Footer Lines)
                                                                                 // Added to make Norwegian EFH Invoices exactly like before IME484
                                                                                 IF NOT NoRounding THEN
                                                                                   currXMLport.SKIP
                                                                                 ELSE
                                                                                   LineNoteFooter := '';
                                                                               END;
                                                                                }

    { [{205E4CF5-9F24-4402-B3EF-2611E6EE4D96}];2 ;cac:Item            ;Element ;Text    ;
                                                  VariableName=SalesReportTextFooterItem;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{975526FC-A1A8-47A8-8F29-1782C685D1A5}];3 ;cbc:Description     ;Element ;Text    ;
                                                  VariableName=SalesReportTextLineFooterDesc;
                                                  DataType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SalesReportTextLineFooterDesc := DeleteHTML(SalesReportTextLineFooter.Text);
                                                                               END;
                                                                                }

    { [{A995698A-774C-4199-AD3E-73E70E783FD3}];3 ;cac:BasePrice       ;Element ;Table   ;
                                                  VariableName=int_BasePriceFooter;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_BasePriceFooter.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{D65290DF-A26C-42CB-90DC-F7B1896F402F}];4 ;cbc:PriceAmount     ;Element ;Text    ;
                                                  VariableName=BasePriceAmountFooter;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BasePriceAmountFooter := '0';
                                                                               END;
                                                                                }

    { [{09D0E448-25F9-4048-9327-D2C347DF325E}];5 ;amountCurrencyID    ;Attribute;Text   ;
                                                  VariableName=Footer_amountCurrencyID;
                                                  TextType=Text;
                                                  Occurrence=Required;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Currency Code" <> '' THEN
                                                                                   Footer_amountCurrencyID := "Sales Invoice Header"."Currency Code"
                                                                                 ELSE
                                                                                   Footer_amountCurrencyID := GenLedgSetup."LCY Code";
                                                                               END;
                                                                                }

    { [{6F86A8C2-08DB-4263-8E77-87449D9713CA}];1 ;RequisitionistDocumentReference;Element;Table;
                                                  VariableName=RequisitionistDocumentRefer;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Once;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         //IF (StrippedView) THEN BEGIN
                                                                         //   IF ("Sales Invoice Header"."Order No. Customer" = '') THEN
                                                                         //      RequisitionistDocumentRefer.SETFILTER(Number, '1')
                                                                         //   ELSE
                                                                         //      RequisitionistDocumentRefer.SETFILTER(Number, '1..2');
                                                                         //END ELSE
                                                                         RequisitionistDocumentRefer.SETFILTER(Number, '1..2');

                                                                         //>>180315 RFC1004
                                                                         // IF EHFBuyersID THEN
                                                                         //  RequisitionistDocumentRefer.SETFILTER(Number, '1')
                                                                       END;
                                                                        }

    { [{74C56B58-BF3F-4579-A0D3-A3178CF03AA3}];2 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Requ_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CASE RequisitionistDocumentRefer.Number OF
                                                                                   1: BEGIN // Kundens ordernr!
                                                                                       //   IF (ProjectPrincipal.GET("Sales Invoice Header"."Bill-to Customer No.")) THEN
                                                                                       //      Requ_ID := ProjectPrincipal."Principal Reference"
                                                                                       //   ELSE BEGIN
                                                                                       //      Customer.GET("Sales Invoice Header"."Bill-to Customer No.");
                                                                                       //      Requ_ID := Customer.Name;
                                                                                       //   END;

                                                                                       //END ELSE BEGIN
                                                                                         //IF (StrippedView) THEN
                                                                                         //   Requ_ID := "Sales Invoice Header"."Principal Reference"
                                                                                         //ELSE
                                                                                              Requ_ID := "Sales Invoice Header"."Order No. Customer";
                                                                                       //  IF (Requ_ID = '') THEN Requ_ID := '-';
                                                                                     END;
                                                                                   2: BEGIN // Uppdragsgivarreferens
                                                                                       //IF (StrippedView) THEN
                                                                                       //    Requ_ID := "Sales Invoice Header"."Order No. Customer"
                                                                                       //ELSE BEGIN
                                                                                          IF "Sales Invoice Header"."Job No." <> '' THEN
                                                                                             Requ_ID := "Sales Invoice Header"."Principal Reference"
                                                                                          ELSE
                                                                                             Requ_ID := "Sales Invoice Header"."Your Reference";
                                                                                          // 150525 Added "Bill-to Contact" if "Stripped View":
                                                                                          IF StrippedView AND ("Sales Invoice Header"."Principal Reference" <> '') THEN
                                                                                            Requ_ID := "Sales Invoice Header"."Bill-to Contact";
                                                                                     //     IF (Requ_ID = '') THEN Requ_ID := '-';
                                                                                       //END;
                                                                                     END;
                                                                                 END;
                                                                                 IF Requ_ID = '' THEN
                                                                                   Requ_ID := '-';
                                                                               END;
                                                                                }

    { [{25B57508-157D-454B-ADB4-39D81141292D}];3 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Requ_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{ED65E203-AEC4-4B25-BA2A-B315C20D470A}];3 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI27;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{8D2780B9-5982-4230-9EA1-8945CD8F301A}];3 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion27;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{29F1E992-329E-4F2E-A654-29B85CFA0332}];3 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Requ_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{700780B1-94B3-4EA8-9141-58542DED208A}];3 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN27;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{CE1D67A3-FDCC-41DC-B4BD-E94EB4F0AAEF}];3 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Requ_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1ACDFB53-33C9-43BD-8FFB-24CFC274E6D3}];3 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData22;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{EF20AADB-9600-41B9-BE13-9A41A440105A}];1 ;InitialInvoiceDocumentReference;Element;Table;
                                                  VariableName=InitialInvoiceDocumentRefer;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Unbounded;
                                                  Export::OnPreXMLItem=VAR
                                                                         SalesInvoiceHeader@1100285100 : Record 112;
                                                                       BEGIN
                                                                         InitialInvoiceDocumentRefer.SETFILTER(Number, '1..-1');

                                                                         //>>190110,RFC1080.4
                                                                         IF StrippedView AND ("Sales Invoice Header"."Applies-to Doc. No." <> '') THEN
                                                                           InitialInvoiceDocumentRefer.SETFILTER(Number, '1');

                                                                         Init_ID := "Sales Invoice Header"."Applies-to Doc. No.";
                                                                         IF ("Sales Invoice Header"."Electronic Invoicing" = "Sales Invoice Header"."Electronic Invoicing"::"Svefaktura (XML)") AND SalesReceivablesSetup."External Doc. No. as Pmt. Ref" THEN BEGIN
                                                                           Init_ID := '';
                                                                           CASE "Sales Invoice Header"."Applies-to Doc. Type" OF
                                                                             "Sales Invoice Header"."Applies-to Doc. Type"::Invoice:
                                                                               IF SalesInvoiceHeader.GET("Sales Invoice Header"."Applies-to Doc. No.") THEN
                                                                                 Init_ID := SalesInvoiceHeader."External Document No.";
                                                                           END;
                                                                         END;
                                                                         IF Init_ID = '' THEN
                                                                           InitialInvoiceDocumentRefer.SETFILTER(Number, '1..-1');
                                                                         //<<190110
                                                                       END;
                                                                        }

    { [{818883FB-5212-4BE8-A8F4-E137F2E25F2B}];2 ;cac:ID              ;Element ;Text    ;
                                                  VariableName=Init_ID;
                                                  TextType=Text;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{BD1A4CD5-E65B-4160-A0C5-46EB2DBE1583}];3 ;identificationSchemeID;Attribute;Text ;
                                                  VariableName=Init_ID_identificationSchem;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{146E06AE-B386-43CD-BB8B-23B294B4590A}];3 ;identificationSchemeAgencyID;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyI28;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7D126B03-B11A-4A9F-871C-BD6BBC72148B}];3 ;identificationSchemeVersionID;Attribute;Text;
                                                  VariableName=identificationSchemeVersion28;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{1D7581D2-569F-4581-995C-1C5D8DC5A1E2}];3 ;identificationSchemeURI;Attribute;Text;
                                                  VariableName=Init_ID_identificationSchem1;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{C44BC198-DC4A-439A-9AFF-4A56B06DB240}];3 ;identificationSchemeAgencyName;Attribute;Text;
                                                  VariableName=identificationSchemeAgencyN28;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{7DEBDD55-1912-4519-A682-70722F472A5C}];3 ;identificationSchemeName;Attribute;Text;
                                                  VariableName=Init_ID_identificationSchem2;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{E3050DBB-1B74-4B01-A9D0-FC651471DA49}];3 ;identificationSchemeDataURI;Attribute;Text;
                                                  VariableName=ID_identificationSchemeData23;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{06C29FA9-D96D-40AE-8349-173EB9F2D553}];1 ;cac:DeliveryTerms   ;Element ;Table   ;
                                                  VariableName=DeliveryTerms;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         DeliveryTerms.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{5EB0F95B-6F7E-4C41-9D8E-904FA38CD6AB}];2 ;cbc:SpecialTerms    ;Element ;Text    ;
                                                  VariableName=SpecialTerms;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SpecialTerms := TranspMethod.Description;
                                                                               END;
                                                                                }

    { [{9D89D20D-D938-430C-9149-4E497003637E}];3 ;languageID          ;Attribute;Text   ;
                                                  VariableName=SpecialTerms_languageID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{5004983B-F37E-49D6-BB81-1DA9FDDE5B82}];3 ;languageLocaleID    ;Attribute;Text   ;
                                                  VariableName=Spec_languageLocaleID;
                                                  TextType=Text;
                                                  Occurrence=Optional }

    { [{DCBA30CC-7E12-4CFC-9B87-4723DF4F78CC}];1 ;InvoicingPeriod     ;Element ;Table   ;
                                                  VariableName=int_InvoicingPeriod;
                                                  SourceTable=Table2000000026;
                                                  SourceTableView=SORTING(Field1);
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         int_InvoicingPeriod.SETFILTER(Number, '1..-1');
                                                                       END;
                                                                        }

    { [{49DF71B3-19C3-4638-8A98-20292F2AB595}];2 ;cbc:StartDateTime   ;Element ;Text    ;
                                                  VariableName=StartDateTime;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{EB74B6BF-2A69-4CA3-B906-9F737ACA2616}];2 ;cbc:EndDateTime     ;Element ;Text    ;
                                                  VariableName=EndDateTime;
                                                  TextType=Text;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SalesInvoiceLineTEMP@1100285500 : TEMPORARY Record 113;
      TextSE@1100285501 : TextConst 'ENU=Godk„nd f”r F-skatt;SVE=Godk„nd f”r F-skatt';
      CompanyInformation@1100285502 : Record 79;
      Customer@1100285503 : Record 18;
      PayTerms@1100285504 : Record 3;
      FinChargeTerms@1100285505 : Record 5;
      TranspMethod@1100285511 : Record 259;
      Credit@1100285513 : Boolean;
      TaxableAmountVar@1100285514 : ARRAY [10] OF Decimal;
      VATRate@1100285515 : ARRAY [10] OF Decimal;
      VATRateExemption@1100285507 : ARRAY [10] OF Boolean;
      VATRateExistsOnLines@1100285103 : ARRAY [10] OF Boolean;
      CustLedgerEntry@1100285516 : Record 21;
      SalespersonPurchaser@1100285517 : Record 13;
      DocumentLink@1100285518 : Record 11012747;
      DocumentProperties@1100285520 : Record 11012746;
      RecID@1100285519 : RecordID;
      RecRef@1100285521 : RecordRef;
      cuExternalDocumentMgmt@1100285522 : Codeunit 11012403;
      AttachmentFile@1100285523 : Text;
      SalesReceivablesSetup@1100285524 : Record 311;
      DimensionValue@1100285000 : Record 349;
      Job@1100285001 : Record 11072003;
      ProjectPrincipal@1100285002 : Record 11012005;
      RoundOffAmount@1100285003 : Decimal;
      RoundOffVATRateIndex@1100285525 : Integer;
      VATPostingSetup@1100285006 : Record 325;
      TextNO@1100285004 : TextConst 'ENU=Companyregistred;NOR=Foretaksregisteret;SVE=Foretaksregisteret';
      txtReverseChargeVAT@1100285007 : TextConst 'ENU=Reversed charge;SVE=Omv„nd betalningsskyldighet';
      CurrentLineNo@1100285008 : Integer;
      SalesReportTextLine@1100285009 : Record 11071912;
      ReportLinesBefore@1100285010 : Boolean;
      ReportLinesAfter@1100285011 : Boolean;
      SalesLines@1100285013 : Boolean;
      NewLine@1100285012 : Boolean;
      LineChange@1100285014 : Boolean;
      ReachedLineEnd@1100285015 : Boolean;
      LineCount2@1100285016 : Integer;
      txtNoVAT@1100285025 : TextConst 'ENU=Amount without VAT;NOR=Bel›p uten moms;SVE=Belopp utan moms';
      txtInvoiceGeneralTextSE@1000000000 : TextConst 'ENU=After due date rate is issued according to law. Any complaints against this invoice should be received to us no later than 8 days after Invoice date in order to be approved by us.;NOR=Eventuell reklamasjon p† denne faktura m† skje skriftlig innen 8 dager. Oppf›lging av denne fakturaen er overlatt til IKAS Kredittsystemer. Ved for sen betaling p†l›per gebyr og renter fra forfall.;SVE=Fr†n f”rfallodatum debiteras dr”jsm†lsr„nta enligt g„llande lag. Ev. anm„rkningar mot denna faktura m†ste vara oss tillhanda senast 8 dagar efter fakturadatum f”r att kunna godk„nnas av oss.';
      ShowDiscount@1100285017 : Boolean;
      FinChargeMemo@1100285018 : Boolean;
      GenLedgSetup@1100285508 : Record 98;
      StrippedView@1100285509 : Boolean;
      ExtensionContractNo@1100285510 : Code[30];
      ExtensionContract@1100285512 : Record 11012004;
      DontMoveFiles@1100285526 : Boolean;
      txtInvoiceGeneralTextNO@1100285005 : TextConst 'ENU=Any complaints against this invoice should be received to us no later than 8 days.;NOR=Eventuell reklamasjon p† denne faktura m† skje skriftlig innen 8 dager. Oppf›lging av denne fakturaen er overlatt til IKAS Kredittsystemer. Ved for sen betaling p†l›per gebyr og renter fra forfall.;SVE=Eventuell reklamasjon p† denne faktura m† skje skriftlig innen 8 dager. Oppf›lging av denne fakturaen er overlatt til IKAS Kredittsystemer. Ved for sen betaling p†l›per gebyr og renter fra forfall.';
      InvoiceExtraLine@1100285019 : Boolean;
      LineNoWithData@1100285020 : Integer;
      SkipLine@1100285021 : Integer;
      HideItems@1100285022 : Boolean;
      FirstLineNo@1100285023 : Integer;
      ExtraTextField@1100285024 : Text;
      NoRounding@1100285026 : Boolean;
      DeliveryAddressFromProject@1100285027 : Boolean;
      txtInvoiceAmount@1100285028 : TextConst 'ENU=Removed cotained amount;NOR=Fradrag innest†ende bel›p;SVE=Avdrag inneh†llet belopp';
      gAllowanceChargeOnLine@1100285100 : Decimal;
      MaxLineNo@1000000001 : Integer;
      gGLNNo@1100285101 : Code[50];
      Currency@1100285102 : Record 4;
      custBuyersID@1100285104 : Boolean;
      custAvtalID@1100285105 : Text;

    PROCEDURE CheckValidChrs@1100285024(textIn@1100285000 : Text[250]) textout : Text[250];
    VAR
      chk001@1100285500 : TextConst 'SVE="-/\ "';
    BEGIN

      textout := DELCHR(textIn,'=' ,chk001 + ' ');
    END;

    PROCEDURE SetCredit@1100285500();
    BEGIN
      Credit := TRUE;
    END;

    PROCEDURE SetDiscount@1100285000();
    BEGIN
      ShowDiscount := TRUE;
    END;

    PROCEDURE SetSalesInvoice@1100285501(VAR SalesInvoiceHeader@1100285500 : Record 112;VAR SalesInvoiceLine@1100285501 : Record 113);
    VAR
      ProjectInstallment@1100285000 : Record 11012018;
      MinusAmount@1100285001 : Decimal;
      SalesReportTextValueMgt@1100285002 : Codeunit 11012371;
      VATPostingSetup@1100285003 : Record 325;
      lvGenericSalesHeaderRec@1000000000 : Record 11071888;
      lvProjectInstallmentSum@1000000001 : Decimal;
      lvOriginalWasCredit@1000000002 : Boolean;
    BEGIN
      "Sales Invoice Header" := SalesInvoiceHeader;
      //>>140602
      MaxLineNo := SalesInvoiceLine."Line No.";
      MinusAmount := 0;

      //>> 160920 ITERO.AC IME484 Use Generic Sales Header in order to get Installment Withdrawal Amount (Same logic as in Invoice Printout)
      lvGenericSalesHeaderRec.INIT;
      lvGenericSalesHeaderRec.TRANSFERFIELDS(SalesInvoiceHeader);
      IF Credit THEN
        lvGenericSalesHeaderRec."Document Type" := lvGenericSalesHeaderRec."Document Type"::"Posted Credit Memo"
      ELSE
        lvGenericSalesHeaderRec."Document Type" := lvGenericSalesHeaderRec."Document Type"::"Posted Invoice";
      MinusAmount :=0-lvGenericSalesHeaderRec.GetInstallmentAmount(); // 160921 ITERO.AC IME484 Bugfix, reverse sign +/-

      //>> 170830 ITERO.FH IME511
      // //>> 160922 ITERO.AC IME484 New loop to determine if original invocie was credit or debit (Used if ProjectInstallment.GET returns TRUE)
      // lvProjectInstallmentSum := 0;
      // IF (SalesInvoiceLine.FINDSET(FALSE)) THEN REPEAT
      //  //>> 160927 ITERO.AC IME484 Performance tuning
      // //IF SalesInvoiceLine."Line Amount" <> 0 THEN BEGIN
      //  IF (SalesInvoiceLine."Line Amount" <> 0) AND (SalesInvoiceLine."Installment No." <> '') THEN BEGIN
      //  //<< 160927 ITERO.AC IME484
      //    IF ProjectInstallment.GET(SalesInvoiceLine."Job No.",SalesInvoiceLine."Sell-to Customer No.",SalesInvoiceLine."Plot No.",SalesInvoiceLine."Installment No.") THEN BEGIN
      //      lvProjectInstallmentSum += ProjectInstallment."Installment Amount";
      //    END
      //  END;
      // UNTIL SalesInvoiceLine.NEXT = 0;
      // IF lvProjectInstallmentSum < 0 THEN
      //  lvOriginalWasCredit := TRUE;
      // //<< 160922 ITERO.AC IME484
      //<< 170830 ITERO.FH IME511

      InvoiceExtraLine := FALSE;
      IF SalesInvoiceLine.FINDSET(FALSE) THEN REPEAT
        SalesInvoiceLineTEMP := SalesInvoiceLine;
        //>> 160927 ITERO.AC IME484 Performance tuning
      //IF SalesInvoiceLineTEMP."Line Amount" <> 0 THEN BEGIN   // 160919 ITERO.AC IME484 Do not compare zero lines with project installments
        IF (SalesInvoiceLineTEMP."Line Amount" <> 0) AND (SalesInvoiceLine."Installment No." <> '') THEN BEGIN
        //<< 160927 ITERO.AC IME484
          IF ProjectInstallment.GET(SalesInvoiceLine."Job No.",SalesInvoiceLine."Sell-to Customer No.",SalesInvoiceLine."Plot No.",SalesInvoiceLine."Installment No.") THEN BEGIN
            //MinusAmount += SalesInvoiceLine.Amount - ProjectInstallment."Installment Amount"; //160920 ITERO.AC IME484 Use Generic Sales Header in order to get Installment Withdrawal Amount (above)
            //>> 160920 ITERO.AC IME484 Bugfix if Credit the Intallment Amount is negative !!!
            // "Applies-to Doc. No." is blank when Credit Memo is created fr†n Installment Plan
            //>> 160922 ITERO.AC IME484 removed check ..AND "Applies-to Doc. No." = '' Use lvOriginalWasCredit instead
            // IF (Credit) AND (SalesInvoiceHeader."Applies-to Doc. No." = '') THEN BEGIN
            //<< 160922 ITERO.AC IME484

      //      //>> 170830 ITERO.FH IME511
      //      IF (lvOriginalWasCredit) THEN BEGIN
      //        SalesInvoiceLineTEMP."Unit Price" := 0 - ProjectInstallment."Installment Amount";
      //        SalesInvoiceLineTEMP."Line Amount" := 0 - ProjectInstallment."Installment Amount";
      //        SalesInvoiceLineTEMP.Amount := 0 - ProjectInstallment."Installment Amount";
      //      END ELSE BEGIN
      //        SalesInvoiceLineTEMP."Unit Price" := ProjectInstallment."Installment Amount";
      //        SalesInvoiceLineTEMP."Line Amount" := ProjectInstallment."Installment Amount";
      //        SalesInvoiceLineTEMP.Amount := ProjectInstallment."Installment Amount";
      //      END;
      //      //<< 160920 ITERO.AC IME484
            IF NOT Credit THEN BEGIN
              SalesInvoiceLineTEMP."Unit Price" := SalesInvoiceLine."Line Amount" + SalesInvoiceLine."Withheld Amount";
              SalesInvoiceLineTEMP."Line Amount" := SalesInvoiceLine."Line Amount" + SalesInvoiceLine."Withheld Amount";
              SalesInvoiceLineTEMP.Amount := SalesInvoiceLine."Line Amount" + SalesInvoiceLine."Withheld Amount";
            END ELSE BEGIN
              SalesInvoiceLineTEMP."Unit Price" := SalesInvoiceLine."Line Amount" + (-1* SalesInvoiceLine."Withheld Amount");
              SalesInvoiceLineTEMP."Line Amount" := SalesInvoiceLine."Line Amount" + (-1*SalesInvoiceLine."Withheld Amount");
              SalesInvoiceLineTEMP.Amount := SalesInvoiceLine."Line Amount" + (-1*SalesInvoiceLine."Withheld Amount");
            END;
            //>> 170830 ITERO.FH IME511

            // IME461 ITERO.MH 160504 - find VAT posting for extra invoice line <<

            //VATPostingSetup.GET(SalesInvoiceHeader."VAT Bus. Posting Group", ProjectInstallment."VAT Prod. Posting Group");  //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            VATPostingSetup.GET(SalesInvoiceHeader."VAT Bus. Posting Group", SalesInvoiceLine."VAT Prod. Posting Group");  //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

            SalesInvoiceLineTEMP."VAT Bus. Posting Group" := VATPostingSetup."VAT Bus. Posting Group";

            //SalesInvoiceLineTEMP."VAT Prod. Posting Group" := ProjectInstallment."VAT Prod. Posting Group"; //XXXXXXXXXXXXXXXXXXXXXXX
            SalesInvoiceLineTEMP."VAT Prod. Posting Group" := SalesInvoiceLine."VAT Prod. Posting Group"; //XXXXXXXXXXXXXXXXXXXXXXX

            SalesInvoiceLineTEMP."VAT Calculation Type" := VATPostingSetup."VAT Calculation Type";
            // IME461A ITERO.MH 160622 Reverse VAT 25% problem <<
            IF VATPostingSetup."VAT Calculation Type" <> VATPostingSetup."VAT Calculation Type"::"Reverse Charge VAT" THEN
              SalesInvoiceLineTEMP."VAT %" := VATPostingSetup."VAT %"
            ELSE
              SalesInvoiceLineTEMP."VAT %" := 0;
            // IME461A ITERO.MH 160622 Reverse VAT 25% problem >>
            // IME461 ITERO.MH 160504 >>
            //>> 160920 ITERO.AC IME484 Bugfix if Credit the Intallment Amount is negative !!!
            // "Applies-to Doc. No." is blank when Credit Memo is created fr†n Installment Plan
            //>> 160922 ITERO.AC IME484 removed check ..AND "Applies-to Doc. No." = '' Use lvOriginalWasCredit instead
        //     IF (Credit) AND (SalesInvoiceHeader."Applies-to Doc. No." = '') THEN BEGIN

            //>> 170830 ITERO.FH IME511
      //      IF (lvOriginalWasCredit) THEN BEGIN
      //      //<< 160922 ITERO.AC IME484
      //        SalesInvoiceLineTEMP."Amount Including VAT" := (0 - ProjectInstallment."Installment Amount" * (1 + SalesInvoiceLineTEMP."VAT %"/100)); // 160527 IME-470, changed to SIL-TEMP
      //      END ELSE BEGIN
      //        SalesInvoiceLineTEMP."Amount Including VAT" := (ProjectInstallment."Installment Amount" * (1 + SalesInvoiceLineTEMP."VAT %"/100));
      //      END;
      //    //<< 160920 ITERO.AC IME484
            IF NOT Credit THEN BEGIN
              SalesInvoiceLineTEMP."Amount Including VAT" := ((SalesInvoiceLine."Line Amount" + SalesInvoiceLine."Withheld Amount") * (1 + SalesInvoiceLineTEMP."VAT %"/100));
            END ELSE BEGIN
              SalesInvoiceLineTEMP."Amount Including VAT" := ((SalesInvoiceLine."Line Amount" + (-1*SalesInvoiceLine."Withheld Amount")) * (1 + SalesInvoiceLineTEMP."VAT %"/100));
            END;
            //<< 170830 ITERO.FH IME511

            LineNoWithData := SalesInvoiceLine."Line No.";
          END;
        END;                                                    // 160919 ITERO.AC IME484
        SalesInvoiceLineTEMP.MARK(SalesInvoiceLine.MARK);       // 160919 ITERO.AC IME484 Marked Invoice Lines are use for group headers and group footers
        SalesInvoiceLineTEMP.INSERT;
      UNTIL SalesInvoiceLine.NEXT = 0;

      //>>#22737
      //Error message: F”rs„ljningsfakturarad finns inte. Identifikationsf„lt och v„rden: Dokumentnr='19016950',Radnr='0'
      // IF MinusAmount <> 0 THEN BEGIN
      IF (MinusAmount <> 0) AND (LineNoWithData<>0) THEN BEGIN
      //<<
         SalesInvoiceLine.GET(SalesInvoiceHeader."No.", LineNoWithData);
         SalesInvoiceLineTEMP.COPY(SalesInvoiceLine);
         SalesInvoiceLineTEMP."Line No." := LineNoWithData + 1;
         SalesInvoiceLineTEMP.Description := txtInvoiceAmount; //
         SalesInvoiceLineTEMP."Unit Price" := ABS(MinusAmount);
         SalesInvoiceLineTEMP.Quantity := -SalesInvoiceLineTEMP.Quantity;
         SalesInvoiceLineTEMP."Line Amount" := MinusAmount;
         SalesInvoiceLineTEMP.Amount := MinusAmount;
         // IME461 ITERO.MH 160504 - use VAT posting for extra invoice line <<
         SalesInvoiceLineTEMP."VAT Bus. Posting Group" := VATPostingSetup."VAT Bus. Posting Group";
         //SalesInvoiceLineTEMP."VAT Prod. Posting Group" := Projinst."VAT Prod. Posting Group";  //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
         SalesInvoiceLineTEMP."VAT Prod. Posting Group" := SalesInvoiceLine."VAT Prod. Posting Group";  //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
         SalesInvoiceLineTEMP."VAT Calculation Type" := VATPostingSetup."VAT Calculation Type";
         // IME461A ITERO.MH 160622 Reverse VAT 25% problem <<
         IF VATPostingSetup."VAT Calculation Type" <> VATPostingSetup."VAT Calculation Type"::"Reverse Charge VAT" THEN
            SalesInvoiceLineTEMP."VAT %" := VATPostingSetup."VAT %"
         ELSE
            SalesInvoiceLineTEMP."VAT %" := 0;
         // IME461A ITERO.MH 160622 Reverse VAT 25% problem >>
         // IME461 ITERO.MH 160504 >>
         SalesInvoiceLineTEMP."Amount Including VAT" := (MinusAmount * (1 + SalesInvoiceLineTEMP."VAT %"/100));  // 160527 IME-470, changed to SIL-TEMP
         SalesInvoiceLineTEMP.INSERT;
         InvoiceExtraLine := TRUE;
      END;
    END;

    PROCEDURE SetDontMoveFiles@1100285502();
    BEGIN
      DontMoveFiles := TRUE; //IME271
    END;

    PROCEDURE SetNoRounding@1100285005();
    BEGIN
      NoRounding := TRUE;
    END;

    PROCEDURE GetVATRateIndex@1100285504(pVATRate@1100285500 : Decimal;pReverse@1100285502 : Boolean;notZeroVat@1100285100 : Boolean) Index : Integer;
    VAR
      i@1100285501 : Integer;
    BEGIN
      i := 1;

      //[NONAT-T14-R030]-Tax category on line level MUST match provided tax categories on document level.
      // IF EHFBuyersID AND notZeroVat THEN i := 2;

      IF TaxableAmountVar[i] <> 0 THEN
        REPEAT
          IF (VATRate[i] = pVATRate) AND (VATRateExemption[i] = pReverse) THEN
            EXIT(i);
          i := i + 1;
        UNTIL (TaxableAmountVar[i] = 0) OR (i > 10);
      EXIT(i);
    END;

    PROCEDURE DeleteHTML@1100285018(IncomingHTML@1100285000 : Text) : Text;
    VAR
      StartPos@1100285001 : Integer;
      EndPos@1100285002 : Integer;
      Maxtry@1100285100 : Integer;
    BEGIN
      Maxtry := 0;
      IF STRPOS(IncomingHTML, '<') <> 0 THEN
        REPEAT
          Maxtry += 1;
          StartPos := STRPOS(IncomingHTML, '<');
          EndPos := STRPOS(IncomingHTML, '>');
          IF (StartPos > 1) THEN
            IncomingHTML := COPYSTR(IncomingHTML, 1, StartPos - 1) + COPYSTR(IncomingHTML, EndPos + 1)
          ELSE IF (StartPos = 1) THEN
            IncomingHTML := COPYSTR(IncomingHTML, EndPos + 1);
        UNTIL (STRPOS(IncomingHTML, '<') = 0) OR (EndPos = 0) OR (Maxtry > 250);

      IncomingHTML := CONVERTSTR(IncomingHTML, ';', ' ');

      EXIT(IncomingHTML);
    END;

    PROCEDURE MergeTwoText@1100285001(Text1@1100285000 : Text;Text2@1100285001 : Text) Return : Text;
    BEGIN
      IF (Text1 <> '') THEN
        Return := Text1;
      IF (Text2 <> '') AND (Return <> '') THEN
        Return := Text1 + ' ' + Text2;
      IF (Text2 <> '') AND (Return = '') THEN
        Return := Text2;
    END;

    PROCEDURE SetHideItemNo@1100285002();
    BEGIN
      HideItems := TRUE;
    END;

    PROCEDURE SetFirstLineNo@1100285006();
    VAR
      ExitLoop@1100285000 : Boolean;
    BEGIN
      CASE "Sales Invoice Header"."Invoice Layout Code" OF
        '0', '1': SalesInvoiceLineTEMP.SETCURRENTKEY("Document No.","Cost Type Cost Plus Line");
        '2': SalesInvoiceLineTEMP.SETCURRENTKEY("Document No.","Line No.");
        '3': SalesInvoiceLineTEMP.SETCURRENTKEY("Job No.","Extension Contract");
        '4': SalesInvoiceLineTEMP.SETCURRENTKEY("Job No.", Element);//RFC1153
        ELSE SalesInvoiceLineTEMP.SETCURRENTKEY("Document No.","Line No.");
      END;

      IF Credit THEN
        SalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Credit Memo")
      ELSE
        SalesReportTextLine.SETRANGE("Document Type", SalesReportTextLine."Document Type"::"Posted Invoice");
      SalesReportTextLine.SETRANGE("Document No.", "Sales Invoice Header"."No.");
      SalesReportTextLine.SETRANGE("Text Line Type", SalesReportTextLine."Text Line Type"::"Before Detail");
      SalesReportTextLine.SETFILTER(Text, '<>%1', '');

      SalesReportTextLine.SETRANGE(Text, "Sales Invoice Header"."Invoice Text");
      IF SalesReportTextLine.FINDFIRST() THEN BEGIN
        FirstLineNo := SalesReportTextLine."Document Line No.";
        EXIT;
      END;

      ExitLoop := FALSE;
      IF SalesInvoiceLineTEMP.FINDSET(FALSE) THEN REPEAT
        SalesReportTextLine.SETRANGE("Document Line No.", SalesInvoiceLineTEMP."Line No.");
        IF NOT SalesReportTextLine.ISEMPTY THEN BEGIN
          FirstLineNo := SalesInvoiceLineTEMP."Line No.";
          ExitLoop := TRUE;
        END;
      UNTIL (SalesInvoiceLineTEMP.NEXT = 0) OR ExitLoop;
    END;

    LOCAL PROCEDURE CheckFirstLineOfProj@1000000018(VAR pSalesReportTextLineRec@1000000000 : Record 11071912) : Boolean;
    VAR
      lvSalesReportTextCondRec@1000000001 : Record 11071891;
    BEGIN
      // 160919 ITERO.AC IME484 New help function
      // Used to determine if a Sales Report Text Line Should be a part of the Invoice Header Text or not
      // Group Headers as FirstLineOfType or FirstLineOfExtensionContract will result in FALSE
      //Document Type,Text Line Type,Text Line No.,Line No.
      lvSalesReportTextCondRec.SETRANGE("Document Type", pSalesReportTextLineRec."Document Type");
      lvSalesReportTextCondRec.SETRANGE("Text Line Type", pSalesReportTextLineRec."Text Line Type");
      lvSalesReportTextCondRec.SETRANGE("Text Line No.", pSalesReportTextLineRec."Line No.");
      lvSalesReportTextCondRec.SETFILTER("Function Name", 'FirstLineOfProj|FirstLineOfServiceContract|FirstLineOfServiceOrder|FirstLineOfRentalUnit');
      IF lvSalesReportTextCondRec.FINDSET(FALSE) THEN BEGIN
        lvSalesReportTextCondRec.SETFILTER("Function Name", 'ELEMENTINVOICE|EXTENSIONINVOICE|EXTENSIONINVOICE2');  // 161024 ITERO.AC IME484-2 Adjustment. Extension contract texts is handled as invoice lines //RFC1153
        IF lvSalesReportTextCondRec.FINDSET(FALSE) THEN
          EXIT(FALSE)
        ELSE
          EXIT(TRUE);
      END ELSE BEGIN
        // For backwards compability Older invoices could refer to non-existing Text Line Numbers, use "old logic"
        IF (COPYSTR(DELCHR(pSalesReportTextLineRec.Text, '<', ' '), 1, 4) <> '<div') THEN BEGIN
          //>> 161024 ITERO.AC IME484-2 Adjustment. Extension contract texts is handled as invoice lines
          lvSalesReportTextCondRec.SETFILTER("Function Name", 'ELEMENTINVOICE|EXTENSIONINVOICE|EXTENSIONINVOICE2'); //RFC1153
          IF lvSalesReportTextCondRec.FINDSET(FALSE) THEN
            EXIT(FALSE)
          ELSE
            EXIT(TRUE);
          //<< 161024 ITERO.AC IME484-2
        END ELSE BEGIN
          EXIT(FALSE);
        END;
      END;
    END;

    PROCEDURE GetPrecisionForEFHInvoice@1000000001(pQuantity@1000000000 : Decimal;pAmount@1000000001 : Decimal;pAllowanceCharge@1000000002 : Decimal;pMaxDecimals@1100285100 : Integer) : Decimal;
    VAR
      lvRetPrecision@1000000003 : Decimal;
      lvNetAmount@1000000006 : Decimal;
      lvTheoreticalAmount@1000000008 : Decimal;
      lvCheckAmount@1000000004 : Decimal;
      lvCheckUnitPrice@1000000005 : Decimal;
      lvIterationCount@1000000007 : Integer;
    BEGIN
      // 161016 ITERO.AC IME490 New function used to calculate precision needed for Norwegian EFH Invoices
      // Based on current Quantity and current Amount a sufficient number of decimals (used in Unit Price) has to be calculated
      // InExchange validates Quantity * Unit price and compares with line amount, no differences seems to be allowed
      // Depending of current parameters, a value between 0.01 and 0.00000000000000000001 will be be returned

      lvIterationCount := 2;   // Start value
      lvRetPrecision := 0.01;  // Standard precision with 2 decimals
      //RFC1169.3
      IF lvIterationCount <= 0 THEN lvIterationCount := 20;

      // Amount calculated by InExchange for validation
      lvNetAmount := pAmount - pAllowanceCharge;

      // Amount calculated by InExchange in their validation to compare with Quantity * Unit price
      lvTheoreticalAmount := pQuantity * (lvNetAmount / pQuantity);

      //RFC1169.3
      // WHILE lvIterationCount < 20 DO BEGIN   // We must set limit somewhere this will result in 20 decimals as a maximum
      WHILE lvIterationCount < pMaxDecimals DO BEGIN   // We must set limit somewhere this will result in 20 decimals as a maximum
        lvIterationCount += 1;
        // Rounded Unit Price
        lvCheckUnitPrice := ROUND(lvNetAmount / pQuantity, lvRetPrecision, '=');
        // Amount calculated with Rounded Unit price
        lvCheckAmount := pQuantity * lvCheckUnitPrice;
        IF lvCheckAmount = lvTheoreticalAmount THEN
          lvIterationCount := 100
        ELSE
          lvRetPrecision := lvRetPrecision / 10;
      END;

      EXIT(lvRetPrecision);
    END;

    LOCAL PROCEDURE GetGLNNoFromInvoiceAddress@1100285105(BillToCustNo@1100285103 : Code[50];AlternativeInvoiceAddress@1100285100 : Code[50]) : Code[50];
    VAR
      Job@1100285101 : Record 11072003;
      ShiptoAddress@1100285102 : Record 222;
    BEGIN
      IF AlternativeInvoiceAddress = '' THEN
         EXIT('');
      IF ShiptoAddress.GET(BillToCustNo, AlternativeInvoiceAddress) THEN
         EXIT(ShiptoAddress.GLN);
    END;

    BEGIN
    {
      140506 ITERO.DJ ENH021
      140909 ITERO.MH ENH042 Added functionality for Finance Charge Memo export

      140506 ITERO.DJ ENH021
      140909 ITERO.MH ENH042 Added functionality for Finance Charge Memo export
      141001 ITERO.MH Major changes, involves: * Addition of Reverse VAT text
                                               * Deletion of Sales Invoice Line and instead replaced it with SalesInvoiceLineTEMP everywhere
                                               * Dynamic <cac:InvoiceLine> element which picks data from Sales Report Text Line too (addition of generic text)
                                               * Addition of a new InvoiceLine-element based on Sales Report Text Line footer-data
                                               * Changed DocumentReference to Order No. Customer
      141015 ITERO.MH ENH021 Minor changes from testing:
                                               * Changed reference no. in file
                                               * Added possibility to have Reversed Charge VAT
                                               * Added Invoice Text in Note
      141210 ITERO.MH ENH021 Minor change: Norwegian layout if company region/code is NO
      150109 ITERO.MH IME255 Added code to handle stripped invoice
      150122 ITERO.MH IME271 Added function and code for not moving files
      150218 ITERO.MH ENH021 Strict divide between SE and NO - moved fields arounde elements
      150506 ITERO.MH Added ID of Invoice to be Invoice No. if Norwegian Localization is active
      150507 ITERO.MH Changed Text of BuyersParty Tax scheme and added text on SellesParty Tax Scheme
      150512 ITERO.MH Changed Reference for Stripped View
      150520 ITERO.MH Changed back Reference for Stripped View after response from Skanska
      150924 ITERO.MH Imtech-specific product
      151020 ITERO.MH Critical VAT fix
      151103 ITERO.MH RFC-001 Added control for blank attachments - skip attachment-element then.
      151118 ITERO.MH RFC-001 * DocumentProperties-fix to not export blank file attachments
                              * Solved critical discount/charge calculation
                              * Changed what table and field to export for certain xml-elements
                              * Added max try on all loops
      160225 ITERO.DL IME424x repace 'findfirst then repeat' (causes locking) with 'findset(false) then repeat'
      160308 ITERO.AC RFC110 Use Contact Name from Sales Invoice Header instead of Project Principal Contact Name
      160504 ITERO.MH IME461 Added VAT info on temp-lines when called from Installment
      160509 ITERO.MH IME473 Added rounding-amount check based on posting setup
      160527 ITERO.MH IME470 Changed variable in installment due to 0-vat problem
      160622 ITERO.MH IME461A Fixed wrong VAT percentage on Reverese Charge installment lines
      160919 ITERO.AC IME484 Changes:
                              * Don't compare zero lines with project installments
                              * Moved logic for hidden invoice lines to Code Unit 81647
                              * Moved logic for Group Header/Footer to Code Unit 81647
                              * Changed logic for line count calculation
                                An Invoice Line is MARKED=TRUE if it is as Group Header/Footer
      160920 ITERO.AC IME484 Changes:
                              * Bugfixes regarding installment/Withheld Amount.
                              * Created unique Line Numbers for footer text lines.
                              * Bugfix in Line Count calculation
                              * Bugfix regarding negative amounts in Project Installments
      160921 ITERO.AC IME484  * Bugfix, reverse sign +/- (Result of GetInstallmentAmount())
      160922 ITERO.AC IME484  * Removed check (Credit) AND "Applies-to Doc. No." = ''
                                Check if original invoice was debit or credit based on inluded project installments
      160927 ITERO.AC IME484  * Performance tuning
                              * Added check for stripped invoice when counting footer lines
                              * Footer lines are now exported in Norwegian EFH invoices (Stripped invoices)
      161014 ITERO.AC IME484  * Problems with Norwegian EFH invoices. Quantity 0 (zero) without unit seems to be mandatory for Header/Footer Lines
      161016 ITERO.AC IME490  * Added function to calculate a sufficient number of decimals for Unit Price in Norwegian EFH Invoices
      161020 ITERO.AC IME494  * Added InvoiceLine/OrderLineReference/OrderReference/BuyersID in Norwegian EFH Invoices
      161024 ITERO.AC IME484-2  Adjustment in CheckFirstLineOfProj. Extension contract texts are now handled as invoice lines
      161112 ITERO.AC IME494  * REMOVE this IME Cause: Norway had not understood the consequeces, they do not want IME494 anymore. Decided on phone meeting with Assemblin 161111
      170424 ITERO.MH IME510 Added "PenaltySurchargePercent" element under PaymentTerms xml element and collected percentage value from customer -> finance charge terms
                      RFC189 Added GLN code from Addresslist on Project
                      RFC224 New mapping of Project No./Exension contract and Contact Person - added phone on Contact person and moved project to ACD-reference
      170830 ITERO.FH IME511 Changes in func SetSalesInvoice. No longer necessery to use Project Installments to calculate witheld amount.
      171102 ITERO.FH RFC248 Tag BuyerParty/Party/Contact/ElectronicMail now get e-mail from table " Ship to Address" or Customer
      171127 ITERO.FH RFC240 Changes so RUT is included in file
      180315 ORANGO.DL RFC1004 re-enable IME494 by extra setup
                       code-cleanup

        [NOGOV-T10-R037]-Document level amounts cannot have more than 2 decimals
        [NONAT-T14-R030]-Tax category on line level MUST match provided tax categories on document level.
      181001 ORANGO.DL RFC1141
        [OP-T10-R006]-Unit code MUST be coded according to the UN/ECE Recommendation 20
        [NONAT-T14-R030]-Tax category on line level MUST match provided tax categories on document level.
      181023 ORANGO.DL RFC1141
        [NONAT-T14-R030]-Tax category on line level MUST match provided tax categories on document level.
      181024 ORANGO.DL RFC1141
        [NONAT-T10-R026]-Invoice line amount MUST be equal to the price amount multiplied by the quantity plus charges minus allowances at line level.

      190108 ORANGO.DL RFC1080
          don't print tags if empty
            cac:ID, (Address_ID)
            cbc:Postbox, (Sales Invoice Header::Bill-to Name 2, DeliveryPostbox)
            cbc:StreetName, (Sales Invoice Header::Bill-to Address, Regi_StreetName, DeliveryStreetname)
            cbc:Department, (Sales Invoice Header::Bill-to Address 2, Regi_Department, Part_Regi_Department, DelieryDepartment)
            cbc:CityName, (Sales Invoice Header::Bill-to City, Regi_CityName, DeliveryAddress_CityName)
            cbc:PostalZone , (Deli_PostalZone)
            cac:PartyTaxScheme, (BuyerTax), if missing ID
            cbc:ExemptionReason, (ExemptionReason, Part_ExemptionReason)
            cac:RegistrationAddress, (RegistrationAddress, Part_RegistrationAddress), if not SWT
            cac:Contact, if all is empty
            cac:ID, (Party_Address_ID)
            cbc:RegistrationName, (Part_RegistrationName)
            cac:PayeePartyName
          1.PartyTaxScheme skickas trots att ID saknas
          2.Dubbla sektioner med RegistrationAddress
          4.PEAB efterfr†gar h„nvisning till ursprungsfakturan p† en kreditnota
          5.Leveranslandskod DeliCuntryID kommer fr†n kunden „ndra till Projektets landskod


      190109 ORANGO.DL RFC1162 [InExchange] altered ElectronicMail if not EHF
      190109 ORANGO.DL RFC1169
          2. Enheterna p† radniv† i f„ltet "<cbc:InvoicedQuantity quantityUnitCode" beh”ver „ndras till n†gon av de som anges h„r: http://docs.peppol.eu/poacc/billing/3.0/bis/#_unit_of_measure F”r att inte fakturor skall stoppas f”r v„ldigt m†nga kunder
          3. Ber„kningar p† radniv† m†ste st„mma, allts† antal * …-pris. P† faktura 10302228 klagade validatorn p† denna raden:
             D„r 13.98*10 b”r blivit 139.8 ist„llet f”r 139,76. Jag misst„nker att det gjorts en avrundning p†  -priset innan filen skapades som orsakat detta.
          4. Texten "F-skattebevis finns" i <cac:PartyTaxScheme> m†ste „ndras till "Godk„nd f”r F-skatt"
                „ndrat TextConst:TextSE
          5. Landskod m†ste finnas med i adresserna (detta l”ser vi dock redan †t er i dagsl„get med ett script som l„gger p† detta, s† det beh”ver vi inte t„nka p†).
      190111 ORANGO.DL RFC1080
          3.F”r att kunna skicka SVE-faktura till Stockholm Stad beh”vs Avtalsnummer l„ggas till i filen
      190221 ORANGO.DL RFC1080 adjustments after tests
      190312 ORANGO.DL RFC1169 after tests, remove EHF-stuff after split of XMLPorts
      190521 ORANGO.FH RFC1163 Changes in function "InvoiceLine_AllowanceCharge"
      190529 ORANGO.FH RFC1153 Added functionality to handle "Invoice Layout Code" = 4, Element
      190624 ORANGO.FH #24534 Changes so every VAT line is rounded off individualy instead of rounded off after all lines is added together
    }
    END.
  }
}

