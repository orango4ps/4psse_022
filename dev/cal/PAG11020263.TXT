OBJECT Page 11020263 Projects by Responsible Person
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=Projekte pro Verantwortlicher;
               ENU=Projects by Responsible Person;
               NLD=Projecten per verantwoordelijke;
               NOR=Prosjekt etter ansvarlig person;
               SVE=Projekt efter ansvarig person];
    SourceTable=Table11072003;
    PageType=List;
    UsageCategory=Lists;
    OnInit=BEGIN
             BuyerManagementEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 IF UserSetup.GET(USERID) THEN
                   UserSetup.TESTFIELD("Employee No.")
                 ELSE
                   ERROR(STRSUBSTNO(Text000, UserSetup.TABLECAPTION, USERID));

                 JobsSetup.GET;
                 RespPersonRec.SETCURRENTKEY("Employee No.");
                 RespPersonRec.SETRANGE("Employee No.",UserSetup."Employee No.");
                 //RespPersonRec.SETRANGE(Responsibility,JobsSetup."Responsibility Site Manager"); //T003307: No limit to Site Manager anymore.
                 IF RespPersonRec.FINDSET THEN
                   REPEAT
                     IF NOT TempProjectRec.GET(RespPersonRec."Project No.") THEN BEGIN
                       ProjRec.GET(RespPersonRec."Project No.");
                       TempProjectRec := ProjRec;
                       TempProjectRec.INSERT;
                     END;
                   UNTIL RespPersonRec.NEXT = 0;

                 EnableControls; //mg, 15-12-10: M24552

                 SETFILTER("Project Status", '%1|%2|%3|%4|%5', "Project Status"::Estimation, "Project Status"::Preparation,
                   "Project Status"::Production, "Project Status"::"Technical Finished", "Project Status"::"Administrative Finished");
               END;

    OnFindRecord=BEGIN
                   TempProjectRec.COPY(Rec);
                   IF NOT TempProjectRec.FIND(Which) THEN
                     EXIT(FALSE);
                   Rec := TempProjectRec;
                   EXIT(TRUE);
                 END;

    OnNextRecord=VAR
                   CurrentSteps@1100485000 : Integer;
                 BEGIN
                   TempProjectRec.COPY(Rec);
                   CurrentSteps := TempProjectRec.NEXT(Steps);
                   IF CurrentSteps <> 0 THEN BEGIN
                     Rec := TempProjectRec;
                   END;
                   EXIT(CurrentSteps);
                 END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02

                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100485058;1 ;ActionGroup;
                      CaptionML=[DEU=Stunden;
                                 ENU=&Hours;
                                 NLD=&Uren;
                                 NOR=&Timer;
                                 SVE=&Timmar] }
      { 1100485061;2 ;Action    ;
                      AccessByPermission=Page 11020241=X;
                      CaptionML=[DEU=Stundenerfassung Projekt;
                                 ENU=Hours Accounting Project;
                                 NLD=Urenverantwoording project;
                                 NOR=Timerapporteringsprosjekt;
                                 SVE=Tidrapporteringsprojekt];
                      Image=CalculateWIP;
                      OnAction=VAR
                                 HourAccProjFrm@1100485000 : Page 11020241;
                               BEGIN
                                 HourAccProjFrm.Setfilter("No.");
                                 HourAccProjFrm.RUN;
                               END;
                                }
      { 1100525004;2 ;Action    ;
                      AccessByPermission=Page 11072217=X;
                      CaptionML=[DEU=Stundenerfassung BaufÅhrer pro Projekt;
                                 ENU=Site Management Hour Accounting by Project;
                                 NLD=Urenverant&woording uitvoerder per project;
                                 NOR=Timerapportering for prosjektledelse etter prosjekt;
                                 SVE=Tidrapportering fîr byggledning efter projekt];
                      Image=CalculateWIP;
                      OnAction=BEGIN
                                 TESTFIELD("No.");
                                 RunSiteMgtProjlHours("No.");
                               END;
                                }
      { 1100525003;1 ;ActionGroup;
                      CaptionML=[DEU=S@ales in Bau;
                                 ENU=S@les in Construct;
                                 NLD=S@les in bouw (SiB);
                                 NOR=S@les inn Construct;
                                 SVE=S@les in Construct] }
      { 1100525009;2 ;Action    ;
                      AccessByPermission=Page 11072653=X;
                      CaptionML=[DEU=Frachtbrief;
                                 ENU=Dispatch Note;
                                 NLD=Pakbon;
                                 NOR=Fõlgeseddel;
                                 SVE=Leveransbesked];
                      Image=Bins;
                      OnAction=BEGIN
                                 RunSiB("No.", 1);  //DP00065
                               END;
                                }
      { 1100525010;2 ;Action    ;
                      AccessByPermission=Page 11072665=X;
                      CaptionML=[DEU=Akzeptierter Packzettel;
                                 ENU=Approved Dispatch Note;
                                 NLD=Goedgekeurde pakbon;
                                 NOR=Godkjent fõlgeseddel;
                                 SVE=GodkÑnt leveransbesked];
                      Image=Approve;
                      OnAction=BEGIN
                                 RunSiB("No.", 2);  //DP00065
                               END;
                                }
      { 1100525012;2 ;Action    ;
                      AccessByPermission=Page 11072656=X;
                      CaptionML=[DEU=Rechnung;
                                 ENU=Invoice;
                                 NLD=Factuur;
                                 NOR=Faktura;
                                 SVE=Fakturadetaljer];
                      Image=Invoice;
                      OnAction=BEGIN
                                 RunSiB("No.", 3);  //DP00065
                               END;
                                }
      { 1100525014;2 ;Action    ;
                      AccessByPermission=Page 11072656=X;
                      CaptionML=[DEU=Akzeptierte Rechnung;
                                 ENU=Approved Invoice;
                                 NLD=Goedgekeurde factuur;
                                 NOR=Godkjent faktura;
                                 SVE=GodkÑnd faktura];
                      Image=Confirm;
                      OnAction=BEGIN
                                 RunSiB("No.", 4);  //DP00065
                               END;
                                }
      { 1100485036;1 ;ActionGroup;
                      CaptionML=[DEU=&Einkauf;
                                 ENU=&Purchase;
                                 NLD=&Inkoop;
                                 NOR=&Innkjõp;
                                 SVE=&Inkîp] }
      { 1100525111;2 ;Action    ;
                      AccessByPermission=Page 11012102=X;
                      CaptionML=[DEU=VorschlagsauftrÑge;
                                 ENU=Advice Orders;
                                 NLD=Adviesorders;
                                 NOR=Bestillingsunderlag;
                                 SVE=BestÑllningsunderlag];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 RunProjectAdviceOrders;
                               END;
                                }
      { 1100485039;2 ;Action    ;
                      AccessByPermission=Page 11012034=X;
                      CaptionML=[DEU=Einkaufsmarkierungen;
                                 ENU=Purchase Actions;
                                 NLD=Inkoopacties;
                                 NOR=Innkjõpshandlinger;
                                 SVE=InkîpsÜtgÑrder];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 RunProjectPurchaseActions;
                               END;
                                }
      { 1100525120;2 ;Action    ;
                      AccessByPermission=Page 11012071=X;
                      CaptionML=[DEU=Bestellungen;
                                 ENU=Purchase Orders;
                                 NLD=Inkooporders;
                                 NOR=Bestillinger;
                                 SVE=Inkîpsorder];
                      Image=Document;
                      OnAction=BEGIN
                                 ShowPurchaseOrdersForProject;
                               END;
                                }
      { 1100525113;2 ;Action    ;
                      AccessByPermission=Page 53=X;
                      CaptionML=[DEU=Einkaufsanfragen;
                                 ENU=Purchase Quotes;
                                 NLD=Inkoopoffertes;
                                 NOR=Innkjõpstilbud;
                                 SVE=Inkîpsofferter];
                      Image=Quote;
                      OnAction=BEGIN
                                 ShowPurchaseQuotesForProject;
                               END;
                                }
      { 1100485040;2 ;Action    ;
                      AccessByPermission=Page 11130137=X;
                      CaptionML=[DEU=Lieferungen;
                                 ENU=Receipts;
                                 NLD=Ontvangsten;
                                 NOR=Mottak;
                                 SVE=Inleveranser];
                      Image=PostedReceipts;
                      OnAction=BEGIN
                                 RunPurchaseOrdersToReceive;
                               END;
                                }
      { 1100525001;2 ;Action    ;
                      AccessByPermission=Page 11072651=X;
                      CaptionML=[DEU=Packzettel (SiB);
                                 ENU=Dispatch Note (SiB);
                                 NLD=Pakbon (SiB);
                                 NOR=Fõlgeseddel (SiB);
                                 SVE=Leveransbesked (SiB)];
                      Image=Bins;
                      OnAction=BEGIN
                                 RunDispatchNoteForm();
                               END;
                                }
      { 1100525016;1 ;ActionGroup;
                      CaptionML=[DEU=Werkzeug;
                                 ENU=Plant;
                                 NLD=Materieel;
                                 NOR=Maskin;
                                 SVE=Maskin] }
      { 1100525027;2 ;Action    ;
                      AccessByPermission=Page 11012559=X;
                      CaptionML=[DEU=Aktueller Werkzeugbestand;
                                 ENU=Current Plant Inventory;
                                 NLD=Huidige materieelvoorraad;
                                 NOR=Aktuelt maskinlager;
                                 SVE=Aktuellt Maskinslager];
                      Image=ResourcePlanning;
                      OnAction=VAR
                                 PlantInventory@1100409004 : Record 11012555;
                                 PlantMgtComp@1100409003 : Record 11020586;
                                 PlantInventoryPage@1100409002 : Page 11012559;
                                 PlantCompany@1100409001 : Text[30];
                                 PlantLocationFilter@1100409000 : Text[250];
                               BEGIN
                                 TESTFIELD("No.");
                                 IF NOT PlantMgtComp.PlantLocationFilterOfProject("No.", PlantLocationFilter, PlantCompany) THEN
                                   EXIT;
                                 PlantInventory.FILTERGROUP(9);
                                 PlantInventory.SETFILTER(Location, PlantLocationFilter);
                                 PlantInventory.FILTERGROUP(0);
                                 PlantInventoryPage.SETTABLEVIEW(PlantInventory);
                                 PlantInventoryPage.SetCompany(PlantCompany);
                                 PlantInventoryPage.RUNMODAL;
                               END;
                                }
      { 1100525025;2 ;Action    ;
                      AccessByPermission=Page 11012560=X;
                      CaptionML=[DEU=Werkzeuglagerungverlauf;
                                 ENU=Plant Inventory Course;
                                 NLD=Materieelvoorraadverloop;
                                 NOR=Maskinlagerkurs;
                                 SVE=Maskinlagerkurs];
                      Image=ResourcePlanning;
                      OnAction=VAR
                                 PlantInventory@1100409004 : Record 11012555;
                                 PlantMgtComp@1100409003 : Record 11020586;
                                 PlantInventHistPage@1100409002 : Page 11012560;
                                 PlantCompany@1100409001 : Text[30];
                                 PlantLocationFilter@1100409000 : Text[250];
                               BEGIN
                                 TESTFIELD("No.");
                                 IF NOT PlantMgtComp.PlantLocationFilterOfProject("No.", PlantLocationFilter, PlantCompany) THEN
                                   EXIT;
                                 PlantInventory.FILTERGROUP(9);
                                 PlantInventory.SETFILTER(Location, PlantLocationFilter);
                                 PlantInventory.FILTERGROUP(0);
                                 PlantInventHistPage.SETTABLEVIEW(PlantInventory);
                                 PlantInventHistPage.SetCompany(PlantCompany);
                                 PlantInventHistPage.RUNMODAL;
                               END;
                                }
      { 1100525028;2 ;Action    ;
                      AccessByPermission=Page 11125533=X;
                      ShortCutKey=Return;
                      CaptionML=[DEU=Werkzeuganfrage (BaufÅhrerformular);
                                 ENU=Plant Request (Site Manager Form);
                                 NLD=Materieelaanvraag (uitvoerdersscherm);
                                 NOR=Maskinforespõrsel (prosjektlederskjema);
                                 SVE=MaskinbegÑran (byggledarformulÑr)];
                      Visible=PlantRequestSMFEnable;
                      Enabled=PlantRequestSMFEnable;
                      PromotedIsBig=Yes;
                      Image=NewResource;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 RunOtherFormsCU@1100409000 : Codeunit 11125525;
                               BEGIN
                                 TESTFIELD("No.");
                                 RunOtherFormsCU.RunPlantRequestByProject("No.");
                               END;
                                }
      { 1100525127;1 ;ActionGroup;
                      CaptionML=[DEU=&Verkauf;
                                 ENU=&Sales;
                                 NLD=&Verkoop;
                                 NOR=&Salg;
                                 SVE=&FîrsÑljning] }
      { 1100525218;2 ;Action    ;
                      AccessByPermission=Page 11012025=X;
                      CaptionML=[DEU=Raten;
                                 ENU=&Installments;
                                 NLD=Termijnen;
                                 NOR=&Betalingsplaner;
                                 SVE=&Betalplaner];
                      Image=AmountByPeriod;
                      OnAction=VAR
                                 ProjectInstallment@1100525000 : Record 11012018;
                                 ProjectInstallForm@1100525001 : Page 11012025;
                               BEGIN
                                 //mg, 10-05-11: C-028275
                                 ProjectInstallment.FILTERGROUP(4);
                                 ProjectInstallment.SETRANGE("Project No.", "No.");
                                 ProjectInstallment.FILTERGROUP(0);
                                 //ProjectInstallment.SETRANGE("Project No.", "No."); //call 30955.n  //*32118.o

                                 //PAGE.RUN(PAGE::"Project Installments", ProjectInstallment);  //*32118.o
                                 //*32118.sn
                                 ProjectInstallForm.SETTABLEVIEW(ProjectInstallment);
                                 ProjectInstallForm.SetProjectFilterGroup(4);
                                 ProjectInstallForm.RUN;
                                 //*32118.en
                               END;
                                }
      { 1100525219;2 ;Action    ;
                      AccessByPermission=Page 11012043=X;
                      CaptionML=[DEU=RegieeintrÑge;
                                 ENU=&Cost Plus Entries;
                                 NLD=Regiemutaties;
                                 NOR=&Rapporterte selvkoster;
                                 SVE=&Redovisade sjÑlvkostnader];
                      Image=AdjustEntries;
                      OnAction=VAR
                                 ProjectCostPlusEntry@1100525000 : Record 11012019;
                               BEGIN
                                 //mg, 10-05-11: C-028275
                                 ProjectCostPlusEntry.FILTERGROUP(4);
                                 ProjectCostPlusEntry.SETRANGE("Project No.", "No.");
                                 ProjectCostPlusEntry.FILTERGROUP(0);
                                 ProjectCostPlusEntry.SETRANGE("Project No.", "No."); //call 30955
                                 PAGE.RUN(PAGE::"Project Cost Plus Entries", ProjectCostPlusEntry);
                               END;
                                }
      { 1100525130;2 ;Action    ;
                      AccessByPermission=Page 11012047=X;
                      CaptionML=[DEU=Verrechnungsblatt;
                                 ENU=Settlement Sheet;
                                 NLD=Verrekenstaat;
                                 NOR=Oppgjõrsskjema;
                                 SVE=AvrÑkningsark];
                      Image=ApplyEntries;
                      OnAction=VAR
                                 ProjectInfoPaneMgt@1100525001 : Codeunit 11012066;
                               BEGIN
                                 ProjectInfoPaneMgt.LookUpSettlementSheetsWithFilt(Rec, TRUE); //mg.c, 10-05-11: C-028275
                               END;
                                }
      { 1100525129;2 ;Action    ;
                      AccessByPermission=Report 11012013=X;
                      CaptionML=[DEU=RegieeintrÑge erstellen;
                                 ENU=Create Cost Plus;
                                 NLD=Regiemutaties aanmaken;
                                 NOR=Opprette selvkost;
                                 SVE=Skapa sjÑlvkostnad];
                      Image=SelectEntries;
                      OnAction=VAR
                                 lvProjRec@1100525000 : Record 11072003;
                                 lvProjLedgEntryRec@1100525004 : Record 11072005;
                                 lvPostedHourLineRec@1100525003 : Record 11012085;
                                 lvHourAccLineRec@1100525002 : Record 11012039;
                                 lvCreateCostPlusRpt@1100525001 : Report 11012013;
                               BEGIN
                                 //**4PS
                                 lvProjRec.SETRANGE("No.", "No.");
                                 lvProjLedgEntryRec.SETRANGE("Cost Plus Entry Created", FALSE);
                                 lvPostedHourLineRec.SETRANGE("Cost Plus Entry Created", FALSE);
                                 lvHourAccLineRec.SETRANGE("Cost Plus Entry Created", FALSE);

                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvProjRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvProjLedgEntryRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvPostedHourLineRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvHourAccLineRec);
                                 lvCreateCostPlusRpt.SetDefault("No.");
                                 lvCreateCostPlusRpt.RUN;
                               END;
                                }
      { 1100525220;2 ;Action    ;
                      AccessByPermission=Page 143=X;
                      CaptionML=[DEU=Rechnungen;
                                 ENU=In&voices;
                                 NLD=Facturen;
                                 NOR=Fa&kturaer;
                                 SVE=Fa&kturor];
                      Image=Invoice;
                      OnAction=VAR
                                 lSalesInvHeader@1210190002 : Record 112;
                                 TmpSalesInvHeader@1100525001 : TEMPORARY Record 112;
                                 lSalesInvLine@1210190001 : Record 113;
                               BEGIN
                                 lSalesInvLine.SETCURRENTKEY("Job No.","Project Invoice","Installment Invoice","Sell-to Customer No.");
                                 lSalesInvLine.SETRANGE("Job No.","No.");
                                 IF lSalesInvLine.FINDSET THEN
                                   REPEAT
                                     IF lSalesInvHeader.GET(lSalesInvLine."Document No.") THEN BEGIN
                                       IF NOT TmpSalesInvHeader.GET(lSalesInvLine."Document No.") THEN BEGIN
                                         TmpSalesInvHeader := lSalesInvHeader;
                                         TmpSalesInvHeader.INSERT;
                                       END;
                                     END;
                                   UNTIL lSalesInvLine.NEXT = 0;
                                 PAGE.RUN(PAGE::"Posted Sales Invoices", TmpSalesInvHeader);
                               END;
                                }
      { 1100525221;2 ;Action    ;
                      AccessByPermission=Page 144=X;
                      CaptionML=[DEU=Gutschriften;
                                 ENU=Credit &Memos;
                                 NLD=Creditnota's;
                                 NOR=Kredit&notaer;
                                 SVE=Kredit&notor];
                      Image=CreditMemo;
                      OnAction=VAR
                                 lSalesCrMemoHeader@1210190015 : Record 114;
                                 lSalesCrMemoLine@1210190021 : Record 115;
                               BEGIN
                                 //**4PS
                                 lSalesCrMemoHeader.CLEARMARKS;
                                 lSalesCrMemoLine.SETRANGE("Job No.","No.");
                                 IF lSalesCrMemoLine.FINDSET THEN
                                   REPEAT
                                     IF lSalesCrMemoHeader.GET(lSalesCrMemoLine."Document No.") THEN
                                       lSalesCrMemoHeader.MARK(TRUE);
                                   UNTIL lSalesCrMemoLine.NEXT = 0;

                                 lSalesCrMemoHeader.MARKEDONLY(TRUE);

                                 PAGE.RUN(PAGE::"Posted Sales Credit Memos",lSalesCrMemoHeader);
                               END;
                                }
      { 1100485033;1 ;ActionGroup;
                      CaptionML=[DEU=&öberwachung;
                                 ENU=&Control;
                                 NLD=&Bewaking;
                                 NOR=&Kontroll;
                                 SVE=&Kontroll] }
      { 1100525122;2 ;Action    ;
                      AccessByPermission=Page 11072005=X;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[DEU=&Posten;
                                 ENU=Ledger E&ntries;
                                 NLD=Poste&n;
                                 NOR=&Transaksjoner;
                                 SVE=Tra&nsaktioner];
                      Image=GLRegisters;
                      OnAction=BEGIN
                                 RunJobLedgerEntries;
                               END;
                                }
      { 1100525017;2 ;Action    ;
                      AccessByPermission=Page 11124895=X;
                      CaptionML=[DEU=Schnappschuss;
                                 ENU=Snapshot;
                                 NLD=Snapshot;
                                 NOR=Snapshot;
                                 SVE=Snapshot];
                      OnAction=VAR
                                 ControlProjectSnapshot@1100525000 : Record 11020609;
                               BEGIN
                                 ControlProjectSnapshot.FILTERGROUP(9);
                                 ControlProjectSnapshot.SETRANGE("Project No.", "No.");
                                 ControlProjectSnapshot.FILTERGROUP(0);
                                 ControlProjectSnapshot.SETCURRENTKEY("Project No.");
                                 PAGE.RUN(0, ControlProjectSnapshot);
                               END;
                                }
      { 1100525121;2 ;Action    ;
                      AccessByPermission=Page 11012092=X;
                      CaptionML=[DEU=ProjektÅberwachung;
                                 ENU=Project Control;
                                 NLD=Projectbewaking;
                                 NOR=Prosjektkontroll;
                                 SVE=Projektkontroll];
                      Image=PayrollStatistics;
                      OnAction=BEGIN
                                 RunProjectControl;
                               END;
                                }
      { 1100485034;2 ;Action    ;
                      CaptionML=[DEU=Status;
                                 ENU=Progress;
                                 NLD=Productiestand;
                                 NOR=Fremdrift;
                                 SVE=Fîrlopp];
                      Image=EditLines;
                      OnAction=BEGIN
                                 RunProgress;
                               END;
                                }
      { 1100525007;2 ;Action    ;
                      AccessByPermission=Page 11072436=X;
                      CaptionML=[DEU=Projektaufnahme;
                                 ENU=Project recording;
                                 NLD=Projectopname;
                                 NOR=Prosjektregistrering;
                                 SVE=Projektregistrering];
                      Image=GeneralPostingSetup;
                      OnAction=BEGIN
                                 ShowProjectRecording;
                               END;
                                }
      { 1100485035;2 ;Action    ;
                      AccessByPermission=Page 11012087=X;
                      CaptionML=[DEU=Prognose;
                                 ENU=Prognosis;
                                 NLD=Prognose;
                                 NOR=Prognose;
                                 SVE=Prognos];
                      Image=CalculateRemainingUsage;
                      OnAction=BEGIN
                                 LaunchPrognosisList;
                               END;
                                }
      { 1100528800;2 ;Action    ;
                      AccessByPermission=TableData 11012034=I;
                      CaptionML=[DEU=Prognosen zu aktuellen Projekten erstellen;
                                 ENU=Generate Prognosis current Projects;
                                 NLD=Genereer prognoses lopende projecten;
                                 NOR=Generer prognose pÜgÜende prosjekt;
                                 SVE=Generera prognos pÜgÜende projekt];
                      Image=CreateDocument;
                      OnAction=BEGIN
                                 // dp00029.n
                                 ProcessPrognosis;
                               END;
                                }
      { 1100525029;1 ;ActionGroup;
                      CaptionML=[DEU=QualitÑt, Umwelt- und Arbeitsschutz;
                                 ENU=QA;
                                 NLD=K&AM;
                                 NOR=Kvalitetssikring;
                                 SVE=KvalitetssÑkring];
                      Image=Alerts }
      { 1100525021;2 ;Action    ;
                      CaptionML=[DEU=Abweichungen;
                                 ENU=Deviations;
                                 NLD=Afwijkingen;
                                 NOR=Avvik;
                                 SVE=Avvikelser];
                      RunObject=Page 11125987;
                      RunPageLink=Source Type=CONST(Project),
                                  Source No.=FIELD(No.);
                      Image=CalculateDepreciation }
      { 1100525020;2 ;Action    ;
                      CaptionML=[DEU=UnfÑlle;
                                 ENU=Accidents;
                                 NLD=Ongevallen;
                                 NOR=Ulykker;
                                 SVE=Olycksfall];
                      RunObject=Page 11126006;
                      RunPageLink=Source Type=CONST(Project),
                                  Source No.=FIELD(No.);
                      Image=Alerts }
      { 1100525018;2 ;Action    ;
                      CaptionML=[DEU=&Beschwerderegistrierung;
                                 ENU=Complaint Management;
                                 NLD=K&lachtenbeheer;
                                 NOR=KlagehÜndtering;
                                 SVE=Incidenthantering];
                      RunObject=Page 11012468;
                      RunPageView=SORTING(Project No.)
                                  ORDER(Ascending);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=EditReminder }
      { 1100525128;1 ;ActionGroup;
                      Name=BuyerManagement;
                      CaptionML=[DEU=&KÑuferverwaltung;
                                 ENU=&Buyer management;
                                 NLD=&Koperbeheer;
                                 NOR=&KjõperhÜndtering;
                                 SVE=&Kîparhantering];
                      Enabled=BuyerManagementEnable }
      { 1100525022;2 ;Action    ;
                      AccessByPermission=Page 11012523=X;
                      CaptionML=[DEU=Projekt KÑuferverwaltung;
                                 ENU=Project Buyer Management;
                                 NLD=&Koperbeheer;
                                 NOR=ProsjektkjõperhÜndtering;
                                 SVE=Projektkîparhantering];
                      Image=CustomerList;
                      OnAction=BEGIN
                                 RunBuyerManagement;
                               END;
                                }
      { 1100525192;2 ;ActionGroup;
                      CaptionML=[DEU=Sonderleistungsoptions&gruppen;
                                 ENU=Option &Groups;
                                 NLD=Meerwerkoptie&groepen;
                                 NOR=Alternativ&grupper;
                                 SVE=Alternativ&grupper];
                      Image=CustomerGroup }
      { 1100525193;3 ;Action    ;
                      AccessByPermission=Page 11012543=X;
                      CaptionML=[DEU=Hauptgruppen;
                                 ENU=Main Groups;
                                 NLD=Hoofdgroepen;
                                 NOR=Hovedgrupper;
                                 SVE=Huvudgrupper];
                      Image=CustomerGroup;
                      OnAction=BEGIN
                                 RunProjectOptionMainGroups;
                               END;
                                }
      { 1100525194;3 ;Action    ;
                      AccessByPermission=Page 11012518=X;
                      CaptionML=[DEU=Gruppen;
                                 ENU=Groups;
                                 NLD=Groepen;
                                 NOR=Grupper;
                                 SVE=Grupper];
                      Image=CustomerGroup;
                      OnAction=BEGIN
                                 RunProjectOptionGroups;
                               END;
                                }
      { 1100525195;3 ;Action    ;
                      AccessByPermission=Page 11012542=X;
                      CaptionML=[DEU=Untergruppen;
                                 ENU=Sub Groups;
                                 NLD=Subgroepen;
                                 NOR=Undergrupper;
                                 SVE=Undergrupper];
                      Image=CustomerGroup;
                      OnAction=BEGIN
                                 RunProjectOptionSubGroups;
                               END;
                                }
      { 1100525196;2 ;Action    ;
                      AccessByPermission=Page 11012501=X;
                      CaptionML=[DEU=&Wohnungsmodelle;
                                 ENU=House Types;
                                 NLD=&Woningmodellen;
                                 NOR=Hustyper;
                                 SVE=Hustyper];
                      Image=ApplyTemplate;
                      OnAction=BEGIN
                                 RunProjectHouseModels;
                               END;
                                }
      { 1100525197;2 ;Action    ;
                      AccessByPermission=Page 11012506=X;
                      CaptionML=[DEU=&Baunummer;
                                 ENU=Plots;
                                 NLD=&Bouwnummers;
                                 NOR=Tegningnr;
                                 SVE=Ritningar];
                      Image=AddToHome;
                      OnAction=BEGIN
                                 RunProjectPlots;
                               END;
                                }
      { 1100525198;2 ;Action    ;
                      AccessByPermission=Page 11012546=X;
                      CaptionML=[DEU=&Sonderleistungsangebote;
                                 ENU=Option &Quotes;
                                 NLD=&Meerwerkoffertes;
                                 NOR=Alternativ&tilbud;
                                 SVE=Alternativ&offerter];
                      Image=Quote;
                      OnAction=BEGIN
                                 RunProjectOptionQuotes;
                               END;
                                }
      { 1100525199;2 ;Action    ;
                      AccessByPermission=Page 11012510=X;
                      CaptionML=[DEU=Optionsbudget;
                                 ENU=Option Budget;
                                 NLD=&Optiebegroting;
                                 NOR=Alternativt budsjett;
                                 SVE=Alternativbudget];
                      Image=Job;
                      OnAction=BEGIN
                                 OptionBudget();
                               END;
                                }
      { 1100525023;2 ;Action    ;
                      AccessByPermission=Page 11012524=X;
                      CaptionML=[DEU=Optionskreuzliste;
                                 ENU=Option Cross List;
                                 NLD=Optie-kruisjeslijst;
                                 NOR=Alternativ-avkrysningsliste;
                                 SVE=Alternativkorslista];
                      Image=CheckList;
                      OnAction=BEGIN
                                 RunProjectOptionCrossList;
                               END;
                                }
      { 1100525200;2 ;Action    ;
                      AccessByPermission=Page 11012528=X;
                      CaptionML=[DEU=LIEFERUNG;
                                 ENU=Delivery;
                                 NLD=O&plevering;
                                 NOR=Leveranse;
                                 SVE=LEVERANS];
                      Image=ChangeTo;
                      OnAction=BEGIN
                                 RunProjectPlotDelivery;
                               END;
                                }
      { 1100485022;1 ;ActionGroup;
                      CaptionML=[DEU=Projekte&inteilung;
                                 ENU=&Job Setup;
                                 NLD=&Projectindeling;
                                 NOR=&Jobbinnstillinger;
                                 SVE=&JobbinstÑllningar] }
      { 1100525123;2 ;Action    ;
                      AccessByPermission=Page 11072004=X;
                      CaptionML=[DEU=Teilprojekte;
                                 ENU=Sub Projects;
                                 NLD=Deelprojecten;
                                 NOR=Underprosjekter;
                                 SVE=Underprojekt];
                      Image=Splitlines;
                      OnAction=BEGIN
                                 RunSubProjects;
                               END;
                                }
      { 1100525124;2 ;Action    ;
                      AccessByPermission=Page 11012028=X;
                      CaptionML=[DEU=Elemente;
                                 ENU=Elements;
                                 NLD=&Elementen;
                                 NOR=Elementer;
                                 SVE=Element];
                      Image=BOMVersions;
                      OnAction=BEGIN
                                 RunProjectElements;
                               END;
                                }
      { 1100485025;2 ;Action    ;
                      AccessByPermission=Page 11012003=X;
                      CaptionML=[DEU=Budget;
                                 ENU=Project Budget;
                                 NLD=Werkbegroting;
                                 NOR=Prosjektbudsjett;
                                 SVE=Projektbudget];
                      Image=LedgerBudget;
                      OnAction=VAR
                                 ProjBudgetFrm@1100485000 : Page 11012003;
                               BEGIN
                                 ProjBudgetFrm.Setfilter("No.");
                                 ProjBudgetFrm.RUN;
                               END;
                                }
      { 1100525112;2 ;Action    ;
                      AccessByPermission=Page 11012012=X;
                      CaptionML=[DEU=Budgetkorrekturen;
                                 ENU=Budget &Adjustments;
                                 NLD=Werkbegrotingcorrectie&s;
                                 NOR=Budsjett&justeringer;
                                 SVE=Budget&justeringar];
                      Image=Balance;
                      OnAction=BEGIN
                                 RunBudgetAdjustments;
                               END;
                                }
      { 1100485032;2 ;Action    ;
                      AccessByPermission=Page 11012007=X;
                      CaptionML=[DEU=Budgetstruktur;
                                 ENU=Work Breakdown Structure;
                                 NLD=Werkbegrotingstructuur;
                                 NOR=Arbeidsinndelingsstruktur;
                                 SVE=Arbetsuppdelningsstruktur];
                      Image=BOM;
                      OnAction=VAR
                                 WorkBreakdownFrm@1100485000 : Page 11012007;
                               BEGIN
                                 WorkBreakdownFrm.Setfilter("No.");
                                 WorkBreakdownFrm.RUN;
                               END;
                                }
      { 1100485028;2 ;Action    ;
                      AccessByPermission=Page 11012014=X;
                      CaptionML=[DEU=Erweiterungen;
                                 ENU=Extensions;
                                 NLD=Meerwerkcontracten;
                                 NOR=ETA;
                                 SVE=éTA];
                      Image=TransferFunds;
                      OnAction=BEGIN
                                 RunProjectExtensions;
                               END;
                                }
      { 1100525125;2 ;Action    ;
                      AccessByPermission=Page 11012016=X;
                      CaptionML=[DEU=Auftraggeber;
                                 ENU=Principals;
                                 NLD=Opdrachtgevers;
                                 NOR=oppdragsgiver;
                                 SVE=Uppdragsgivare];
                      Image=TeamSales;
                      OnAction=VAR
                                 ProjPrincipRec@1100525000 : Record 11012005;
                               BEGIN
                                 ProjPrincipRec.RESET;
                                 ProjPrincipRec.FILTERGROUP(4);
                                 ProjPrincipRec.SETRANGE("Project No.","No.");
                                 ProjPrincipRec.FILTERGROUP(0);
                                 ProjPrincipRec.SETRANGE("Project No.","No.");
                                 IF "Bill-to Customer No." <> '' THEN
                                   IF NOT ProjPrincipRec.GET("No.", "Bill-to Customer No.") THEN
                                     ProjPrincipRec.SETRANGE(Principal, "Bill-to Customer No.");
                                 PAGE.RUN(PAGE::"Project Principal List",ProjPrincipRec);
                               END;
                                }
      { 1100525126;1 ;ActionGroup;
                      CaptionML=[DEU=&Projekttabellen;
                                 ENU=P&roject tables;
                                 NLD=&Projecttabellen;
                                 NOR=P&rosjekttabeller;
                                 SVE=P&rojekttabeller] }
      { 1100525138;2 ;Action    ;
                      AccessByPermission=Page 124=X;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments;
                                 NLD=&Opmerkingen;
                                 NOR=Ko&mmentarer;
                                 SVE=Ko&mmentarer];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 RunProjectComments;
                               END;
                                }
      { 1100525139;2 ;Action    ;
                      AccessByPermission=Page 11012017=X;
                      CaptionML=[DEU=Verantwortliche;
                                 ENU=&Responsible Persons;
                                 NLD=Verant&woordelijken;
                                 NOR=&Ansvarlige personer;
                                 SVE=&Ansvariga personer];
                      Image=Users;
                      OnAction=BEGIN
                                 RunProjectResponsiblePersons;
                               END;
                                }
      { 1100525140;2 ;Action    ;
                      AccessByPermission=Page 11020231=X;
                      CaptionML=[DEU=Projekt&instanzen;
                                 ENU=Project &Authorities;
                                 NLD=Project&instanties;
                                 NOR=Prosjekt&myndigheter;
                                 SVE=Projekt&myndigheter];
                      Image=ContactPerson;
                      OnAction=BEGIN
                                 RunProjectAuthorities;
                               END;
                                }
      { 1100525141;2 ;Action    ;
                      AccessByPermission=Page 11012020=X;
                      CaptionML=[DEU=Projektstandorte;
                                 ENU=Project &Locations;
                                 NLD=Projectl&ocaties;
                                 NOR=Prosjekt&Plasseringer;
                                 SVE=Projekt&stÑllen];
                      Image=Job;
                      OnAction=BEGIN
                                 RunProjectLocations;
                               END;
                                }
      { 1100525142;2 ;Action    ;
                      AccessByPermission=Page 11072043=X;
                      CaptionML=[DEU=Projekt bevorzugte Lagerorte;
                                 ENU=Job Preferred &Locations;
                                 NLD=Projectvoorkeurs&vestigingen;
                                 NOR=Foretrukne &Plasseringer for jobb;
                                 SVE=Fîrvalda &lagerstÑllen fîr jobb];
                      Image=Company;
                      OnAction=BEGIN
                                 RunProjectPreferenceLocations;
                               END;
                                }
      { 1100525143;2 ;Action    ;
                      AccessByPermission=Page 11012128=X;
                      CaptionML=[DEU=ProjektkostentrÑger;
                                 ENU=Project Cost &Objects;
                                 NLD=Projectkosten&dragers;
                                 NOR=Prosjektkost&objekter;
                                 SVE=Projektkostnads&objekt];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 RunProjectCostObjects;
                               END;
                                }
      { 1100525144;2 ;Action    ;
                      AccessByPermission=Page 11020264=X;
                      CaptionML=[DEU=Projektbudgettarife;
                                 ENU=Project &Budget Rates;
                                 NLD=Project&begrotingstarieven;
                                 NOR=Prosjektets &Budsjettsatser;
                                 SVE=Projektets &budgetavgifter];
                      Image=LedgerBudget;
                      OnAction=BEGIN
                                 RunProjectBudgetRates;
                               END;
                                }
      { 1100525145;2 ;Action    ;
                      AccessByPermission=Page 11020346=X;
                      CaptionML=[DEU=Projektbauplanpara&grafen;
                                 ENU=Project &Tender Paragraphs;
                                 NLD=Projectbestekspara&grafen;
                                 NOR=Prosjekt&Tilbudsavsnitt;
                                 SVE=Projekt&anbudsstycken];
                      Image=BOMVersions;
                      OnAction=BEGIN
                                 RunProjectTenderParagraphs;
                               END;
                                }
      { 1100525161;2 ;Action    ;
                      AccessByPermission=Page 11012754=X;
                      CaptionML=[DEU=&Merkmale;
                                 ENU=&Features;
                                 NLD=&Kenmerken;
                                 NOR=&Funksjoner;
                                 SVE=&Funktioner];
                      Image=BulletList;
                      OnAction=BEGIN
                                 ShowFeatures;
                               END;
                                }
      { 1100525019;2 ;Action    ;
                      CaptionML=[DEU=Belege;
                                 ENU=Doc&uments;
                                 NLD=Doc&umenten;
                                 NOR=Dok&ument;
                                 SVE=Dok&ument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1100525000 : RecordRef;
                                 DocumentFilters@1100525001 : Codeunit 11012432;
                               BEGIN
                                 //mg.sn, 08-12-10: C-027183
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, TRUE);
                                 //mg.en, 08-12-10: C-027183
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100525005;1 ;Action    ;
                      AccessByPermission=Page 11072003=X;
                      ShortCutKey=Return;
                      CaptionML=[DEU=Arbeitsschein;
                                 ENU=Job Card;
                                 NLD=Projectkaart;
                                 NOR=Prosjektkort;
                                 SVE=Projektkort];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Job;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OpenCardWithRestrictions;
                                 UpdateTempProject; //mg, 18-07-11: M23254
                               END;
                                }
      { 1100525008;1 ;Action    ;
                      AccessByPermission=Page 11072634=X;
                      CaptionML=[DEU=&Seiten;
                                 ENU=&Pages;
                                 NLD=&Pagina's;
                                 NOR=&Sider];
                      Promoted=Yes;
                      Image=AddAction;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PageList@1100525000 : Record 11020589;
                               BEGIN
                                 WITH PageList DO
                                   ShowList(FIELDNO("Job Pages"));
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100485000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1100485001;2;Field  ;
                SourceExpr="No." }

    { 1100485003;2;Field  ;
                SourceExpr=Description }

    { 1100485009;2;Field  ;
                SourceExpr=Address;
                Visible=FALSE }

    { 1100485011;2;Field  ;
                SourceExpr="Address 2";
                Visible=FALSE }

    { 1100485013;2;Field  ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 1100485015;2;Field  ;
                SourceExpr=City;
                Visible=FALSE }

    { 1100525011;2;Field  ;
                SourceExpr="Name Project Manager" }

    { 1100525013;2;Field  ;
                SourceExpr="Name Project Engineer" }

    { 1100525015;2;Field  ;
                SourceExpr="Name Site Manager" }

    { 1100485017;2;Field  ;
                SourceExpr="Phone No.";
                Visible=FALSE }

    { 1100485029;2;Field  ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 1100485044;2;Field  ;
                SourceExpr="Bill-to Customer No." }

    { 1100485042;2;Field  ;
                SourceExpr="Principal Name" }

    { 1100525000;2;Field  ;
                SourceExpr="Project Administrator" }

    { 1100525006;2;Field  ;
                SourceExpr="Name Project Administrator" }

    { 1100485046;2;Field  ;
                SourceExpr="Project Type" }

    { 1100485048;2;Field  ;
                SourceExpr=Type }

    { 1100485052;2;Field  ;
                SourceExpr="Search Description" }

    { 1100485050;2;Field  ;
                SourceExpr="Project Status" }

    { 1100485054;2;Field  ;
                SourceExpr="Small Project Status";
                Visible=FALSE }

    { 1100485056;2;Field  ;
                SourceExpr="Small Project";
                Visible=FALSE }

    { 1100485005;2;Field  ;
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 1100485007;2;Field  ;
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 1100525002;2;Field  ;
                CaptionML=[DEU=Anzahl Packzettel (SiB);
                           ENU=No. of Dispatch Notes (SiB);
                           NLD=Aantal pakbonnen (SiB);
                           NOR=Antall fõlgesedler (SiB);
                           SVE=Antal leveransbesked (SiB)];
                BlankZero=Yes;
                SourceExpr=NoOfDispatchNotes();
                Visible=FALSE;
                OnDrillDown=BEGIN
                              RunDispatchNoteForm();
                            END;
                             }

    { 1100525024;2;Field  ;
                SourceExpr="Contract Amount";
                Visible=FALSE }

    { 1100525026;2;Field  ;
                SourceExpr="Invoiced Price";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      Text000@1100485001 : TextConst 'DEU=Tragen Sie %1 fÅr Inlogcode %2 ein.;ENU=Enter %1 voor login code %2;NLD=Voer %1 voor inlogcode %2;NOR=Angi %1 for innloggingskode %2;SVE=Ange %1 fîr inloggningskod %2';
      UserSetup@1100485002 : Record 91;
      RespPersonRec@1100485004 : Record 11012040;
      ProjRec@1100485003 : Record 11072003;
      TempProjectRec@1100485000 : TEMPORARY Record 11072003;
      JobsSetup@1100409000 : Record 315;
      ProjectInfoPaneMgt@1100525007 : Codeunit 11012066;
      PrognosisManagement@1100528818 : Codeunit 11020217;
      BuyerManagementEnable@19020635 : Boolean INDATASET;
      PlantRequestSMFEnable@1100409001 : Boolean INDATASET;
      DPA_IsHardFilter@1100000999 : Boolean;
      AutomaticGeneratePrognosis@1100528816 : Report 11012668;
      CostTypes@1100528814 : 'Cost,Revenue,Both';
      PrognosisDate@1100528812 : Date;
      CopyPrognosisAmounts@1100529200 : 'No,CopyEndResult,CopyPrognosisTotal';
      FPSLicenseManagement@1100528500 : Codeunit 11229289;

    PROCEDURE RunDispatchNoteForm@1100525000();
    VAR
      lvDispatchNoteFrm@1100528600 : Page 11072651;
    BEGIN
      lvDispatchNoteFrm.SetProjectFromRespPerson("No.");
      lvDispatchNoteFrm.RUN;
    END;

    PROCEDURE NoOfDispatchNotes@1100525001() : Integer;
    VAR
      lvDispatchNoteRec@1100525000 : Record 11072651;
    BEGIN
      IF FPSLicenseManagement.LicenseAndReadPermissionForTable(lvDispatchNoteRec) THEN BEGIN
        lvDispatchNoteRec.SETRANGE(Approved, FALSE);
        lvDispatchNoteRec.SETRANGE("Project No.", "No.");
        EXIT(lvDispatchNoteRec.COUNT);
      END;
      EXIT(0);
    END;

    PROCEDURE RunSiteMgtProjlHours@1100525002(IProjectNo@1100525004 : Code[20]);
    VAR
      lvSiteMgtProjObjRec@1100525005 : Record 11012359;
      lvSiteMgtProjHrsHeadRec@1100525001 : Record 11012362;
      lvSiteMgtProjHrsAccFrm@1100525000 : Page 11072217;
      lvText001@1100525006 : TextConst 'DEU=Projekt ''%1'' von Mandant ''%2'' ist  noch nicht in ''%3'' erstellt worden. Es ist nicht mîglich, die Stunden fÅr dieses Projekt einzugeben.;ENU="Project ''%1'' of Company ''%2'' is not created in ''%3'', it is not possible to enter hours for this project. ";NLD="Project ''%1'' van bedrijf ''%2'' is niet aangemaakt in ''%3'', het is niet mogelijk om uren voor dit project in te voeren. ";NOR=Prosjektet ''%1'' for bedriften ''%2'' er ikke opprettet i ''%3''. Kan ikke angi timer for dette prosjektet.;SVE="Projektet ''%1'' fîr fîretaget ''%2'' har inte skapats i ''%3''. Det gÜr inte att ange timmar fîr det hÑr projektet. "';
    BEGIN
      IF NOT lvSiteMgtProjObjRec.GET(COMPANYNAME, lvSiteMgtProjObjRec.Type::Project, IProjectNo) THEN
        ERROR(lvText001, IProjectNo, COMPANYNAME, lvSiteMgtProjObjRec.TABLECAPTION);

      lvSiteMgtProjHrsHeadRec.SETCURRENTKEY("Receiving Company", "Project No.", Year, Week);
      lvSiteMgtProjHrsHeadRec.FILTERGROUP(4);
      lvSiteMgtProjHrsHeadRec.SETRANGE("Receiving Company", COMPANYNAME);
      lvSiteMgtProjHrsHeadRec.SETRANGE("Project No.", IProjectNo);
      lvSiteMgtProjHrsHeadRec.FILTERGROUP(0);
      lvSiteMgtProjHrsAccFrm.SETTABLEVIEW(lvSiteMgtProjHrsHeadRec);
      lvSiteMgtProjHrsAccFrm.SetOnlyForCurrentProject();
      lvSiteMgtProjHrsAccFrm.RUN;
    END;

    PROCEDURE OptionBudget@1210190006();
    VAR
      lvOptionRec@1210190000 : Record 11012502;
    BEGIN
      lvOptionRec.FILTERGROUP(9);
      lvOptionRec.SETRANGE("Project No.", "No.");
      lvOptionRec.FILTERGROUP(0);
      lvOptionRec.SETRANGE("Plot No.", '');

      PAGE.RUN(PAGE::"Project Option List", lvOptionRec);
    END;

    PROCEDURE ShowProjectRecording@1100525004();
    VAR
      ProjectRecordingList@1100525000 : Page 11072436;
      ProjectRecording@1100525001 : Record 11072020;
    BEGIN
      ProjectRecording.RESET;
      ProjectRecording.FILTERGROUP(2);
      ProjectRecording.SETRANGE("Project Manager", UserSetup."Employee No.");
      ProjectRecording.FILTERGROUP(0);
      CLEAR(ProjectRecordingList);
      ProjectRecordingList.SETTABLEVIEW(ProjectRecording);
      ProjectRecordingList.RUN;
    END;

    PROCEDURE EnableControls@1100525006();
    VAR
      PlantRequestSMF@1100409000 : Record 11125529;
      PlantRequest@1100409001 : Record 11020520;
    BEGIN
      IF "No." = '' THEN
        BuyerManagementEnable := FALSE
      ELSE
        BuyerManagementEnable := "Housebuilding Project";
      PlantRequestSMFEnable := (FPSLicenseManagement.LicenseAndReadPermissionForTable(PlantRequestSMF) AND
                                FPSLicenseManagement.LicenseAndReadPermissionForTable(PlantRequest));
    END;

    PROCEDURE UpdateTempProject@1210190000();
    VAR
      Job@1210190000 : Record 11072003;
    BEGIN
      //mg, 18-07-11: M23254
      IF TempProjectRec."No." <> '' THEN
        IF Job.GET(TempProjectRec."No.") THEN BEGIN
          TempProjectRec := Job;
          TempProjectRec.MODIFY;
        END;
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      EnableControls; //mg, 08-12-10: C-027184
    END;

    PROCEDURE ProcessPrognosis@1100528800();
    VAR
      Prognosis@1100525000 : Record 11012034;
      TempProject@1100525002 : TEMPORARY Record 11072003;
      Project@1100525001 : Record 11072003;
    BEGIN
      // dp00029.n
      CLEAR(AutomaticGeneratePrognosis);
      AutomaticGeneratePrognosis.RUNMODAL;
      AutomaticGeneratePrognosis.GetPrognosisDate(PrognosisDate);

      JobsSetup.GET;
      RespPersonRec.SETCURRENTKEY("Employee No.");
      RespPersonRec.SETRANGE("Employee No.",UserSetup."Employee No.");
      RespPersonRec.SETFILTER(Responsibility,'%1|%2',JobsSetup."Responsibility Site Manager",JobsSetup."Responsibility Project Manager");
      IF RespPersonRec.FINDSET THEN
        REPEAT
          IF NOT TempProject.GET(RespPersonRec."Project No.") THEN BEGIN
            Project.GET(RespPersonRec."Project No.");
            TempProject := Project;
            TempProject.INSERT;
          END;
        UNTIL RespPersonRec.NEXT = 0;
      IF TempProject.FINDSET THEN
        REPEAT
          IF NOT Prognosis.GET(TempProject."No.", PrognosisDate) THEN BEGIN
            Prognosis.INIT;
            Prognosis."Project No." := TempProject."No.";
            Prognosis.VALIDATE("Prognosis Date",PrognosisDate);
            Prognosis.INSERT(TRUE);
          END;

          Prognosis.SetupDetailedPrognosisOptions;

          ProjRec.GET(TempProject."No.");
          IF (NOT Prognosis.Fixed) AND (ProjRec."Project Status" < ProjRec."Project Status"::Finished) THEN BEGIN

            PrognosisManagement.CreatePrognosis(Prognosis, CostTypes::Both);

            IF Prognosis."Copy Prev. Cost Prognosis" THEN
              PrognosisManagement.CopyPrevPrognosis(Prognosis, CopyPrognosisAmounts::No, CostTypes::Cost);
            IF Prognosis."Copy Prev. Progn. End Result" THEN
              PrognosisManagement.CopyPrevPrognosis(Prognosis, CopyPrognosisAmounts::CopyEndResult, CostTypes::Cost);
            IF Prognosis."Copy Prev. Progn. Total Cost" THEN
              PrognosisManagement.CopyPrevPrognosis(Prognosis, CopyPrognosisAmounts::CopyPrognosisTotal, CostTypes::Cost);
            IF Prognosis."Copy Prev. Revenue Prognosis" THEN
              PrognosisManagement.CopyPrevPrognosis(Prognosis, CopyPrognosisAmounts::No, CostTypes::Revenue);
            IF Prognosis."Copy Prev. Progn. Tot. Revenue" THEN
              PrognosisManagement.CopyPrevPrognosis(Prognosis, CopyPrognosisAmounts::CopyPrognosisTotal, CostTypes::Revenue);
            IF Prognosis."Copy Comments Prev. Prognosis" THEN
              Prognosis.CopyPreviousComments;

            IF Prognosis."Fill Progn. with Avail. Cost" THEN
              PrognosisManagement.FillPrognosisWithAvailable(Prognosis);
            IF Prognosis."Fill Progn. with extr. Costs" THEN
              PrognosisManagement.FillPrognosisWithXtraPolCost(Prognosis);

            IF Prognosis."Fill Prognosis Revenues" THEN
              PrognosisManagement.FillPrognRevenues(Prognosis);
            IF Prognosis."Calculate Surcharges" THEN BEGIN
              IF "Prognosis Level" = "Prognosis Level"::Detailed THEN BEGIN
                Prognosis."Ovh. Surcharges Calculated" := TRUE;
                Prognosis."Altered After Calculation" := FALSE;
                Prognosis.MODIFY;

                PrognosisManagement.RemoveSurcharges(Prognosis);
                PrognosisManagement.CalculateSurcharges(Prognosis);
              END;
            END;
            //C012556
            IF Prognosis."Calculate Risc Coverage" THEN
              IF "Prognosis Level" = "Prognosis Level"::Detailed THEN
                PrognosisManagement.CalculateRiscCoverage(Prognosis);
            //
          END;
        UNTIL TempProject.NEXT = 0;
    END;

    LOCAL PROCEDURE RunSiB@1100528900(IProjectNo@1100528900 : Code[20];IAction@1100528901 : Integer);
    VAR
      lvDispatchNoteRec@1100528902 : Record 11072651;
      lvInvoiceRec@1100528903 : Record 11072653;
    BEGIN
      //DP00065
      IF (IAction = 1) OR (IAction = 2) THEN BEGIN
        lvDispatchNoteRec.FILTERGROUP(9);
        lvDispatchNoteRec.SETRANGE("Project No.", IProjectNo);
        lvDispatchNoteRec.SETRANGE(Approved, (IAction=2));
        lvDispatchNoteRec.FILTERGROUP(0);
        IF (IAction = 1) THEN
          PAGE.RUNMODAL(PAGE::"Dispatch Note List (SiB)", lvDispatchNoteRec)
        ELSE
          PAGE.RUNMODAL(PAGE::"Approved Disp Note List (SiB)", lvDispatchNoteRec);
      END;

      IF (IAction = 3) OR (IAction = 4) THEN BEGIN
        lvInvoiceRec.FILTERGROUP(9);
        lvInvoiceRec.CALCFIELDS("Project No.");
        lvInvoiceRec.SETRANGE("Project No.", IProjectNo);
        lvInvoiceRec.SETRANGE(Approved, (IAction=4));
        lvInvoiceRec.FILTERGROUP(0);
        PAGE.RUNMODAL(PAGE::"Invoice List (SiB)", lvInvoiceRec)
      END
    END;

    LOCAL PROCEDURE RunProjectAdviceOrders@1100529206();
    VAR
      AdviceOrderLine@1100529201 : Record 11012055;
      AdviceOrdersbyProject@1100529200 : Page 11012102;
    BEGIN
      AdviceOrderLine.FILTERGROUP(9);
      AdviceOrderLine.SETRANGE("Record Type",AdviceOrderLine."Record Type"::Project);
      AdviceOrderLine.SETRANGE("Project No.","No.");
      AdviceOrderLine.FILTERGROUP(0);
      AdviceOrderLine.SETRANGE(Processed,FALSE);
      AdviceOrdersbyProject.SETTABLEVIEW(AdviceOrderLine);
      AdviceOrdersbyProject.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectPurchaseActions@1100529201();
    VAR
      ProjectPurchaseAction@1100529201 : Record 11012026;
      ProjectPurchaseActionList@1100529200 : Page 11012034;
    BEGIN
      ProjectPurchaseAction.FILTERGROUP(9);
      ProjectPurchaseAction.SETRANGE("Project No.","No.");
      ProjectPurchaseAction.FILTERGROUP(0);
      ProjectPurchaseAction.SETRANGE("Project No.","No.");
      ProjectPurchaseActionList.SETTABLEVIEW(ProjectPurchaseAction);
      ProjectPurchaseActionList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunBudgetAdjustments@1100529214();
    VAR
      BudgetAdjustment@1100529201 : Record 11012003;
      BudgetAdjustmentList@1100529200 : Page 11012012;
    BEGIN
      BudgetAdjustment.FILTERGROUP(4);
      BudgetAdjustment.SETRANGE("Project No.","No.");
      BudgetAdjustment.FILTERGROUP(0);
      BudgetAdjustmentList.SETTABLEVIEW(BudgetAdjustment);
      BudgetAdjustmentList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunPurchaseOrdersToReceive@1100529222();
    VAR
      PurchaseHeader@1100529201 : Record 38;
      PurchaseOrdertoReceive@1100529200 : Page 11130137;
    BEGIN
      PurchaseHeader.FILTERGROUP(9);
      PurchaseHeader.SETRANGE("Document Type",PurchaseHeader."Document Type"::Order);
      PurchaseHeader.SETRANGE("Job No.","No.");
      PurchaseHeader.FILTERGROUP(0);
      PurchaseOrdertoReceive.SETTABLEVIEW(PurchaseHeader);
      PurchaseOrdertoReceive.RUNMODAL;
    END;

    LOCAL PROCEDURE RunJobLedgerEntries@1100529234();
    VAR
      JobLedgerEntry@1100529201 : Record 11072005;
      JobLedgerEntries@1100529200 : Page 11072005;
    BEGIN
      JobLedgerEntry.FILTERGROUP(9);
      JobLedgerEntry.SETRANGE("Job No.","No.");
      JobLedgerEntry.FILTERGROUP(0);
      JobLedgerEntries.SETTABLEVIEW(JobLedgerEntry);
      JobLedgerEntries.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectControl@1100529242();
    VAR
      Job@1100529201 : Record 11072003;
      ProjectControl@1100529200 : Page 11012092;
    BEGIN
      Job.FILTERGROUP(9);
      Job.SETRANGE("No.","No.");
      Job.FILTERGROUP(0);
      ProjectControl.SETTABLEVIEW(Job);
      ProjectControl.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProgress@1100529252();
    VAR
      ProgressLevel@1100529201 : Record 11012036;
      ProgressList@1100529200 : Page 11012079;
    BEGIN
      ProgressLevel.FILTERGROUP(4);
      ProgressLevel.SETRANGE("Project No.","No.");
      ProgressLevel.FILTERGROUP(0);
      ProgressList.SETTABLEVIEW(ProgressLevel);
      ProgressList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunBuyerManagement@1100529200();
    VAR
      Job@1100529201 : Record 11072003;
      ProjectBuyerManagement@1100529200 : Page 11012523;
    BEGIN
      Job.FILTERGROUP(9);
      Job.SETRANGE("No.","No.");
      Job.FILTERGROUP(0);
      ProjectBuyerManagement.SETTABLEVIEW(Job);
      ProjectBuyerManagement.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectOptionMainGroups@1100529213();
    VAR
      OptionMainGroup@1100529201 : Record 11012509;
      ProjectOptionMainGroupList@1100529200 : Page 11012543;
    BEGIN
      OptionMainGroup.FILTERGROUP(9);
      OptionMainGroup.SETRANGE("Project No.","No.");
      OptionMainGroup.SETFILTER("Plot No.", '%1', '');
      OptionMainGroup.FILTERGROUP(0);
      ProjectOptionMainGroupList.SETTABLEVIEW(OptionMainGroup);
      ProjectOptionMainGroupList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectOptionGroups@1100529223();
    VAR
      OptionGroup@1100529201 : Record 11012504;
      ProjectOptionGroups@1100529200 : Page 11012518;
    BEGIN
      OptionGroup.FILTERGROUP(9);
      OptionGroup.SETRANGE("Project No.","No.");
      OptionGroup.SETFILTER("Plot No.", '%1', '');
      OptionGroup.FILTERGROUP(0);
      ProjectOptionGroups.SETTABLEVIEW(OptionGroup);
      ProjectOptionGroups.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectOptionSubGroups@1100529232();
    VAR
      OptionSubGroup@1100529201 : Record 11012505;
      ProjectOptionSubGroups@1100529200 : Page 11012542;
    BEGIN
      OptionSubGroup.FILTERGROUP(9);
      OptionSubGroup.SETRANGE("Project No.","No.");
      OptionSubGroup.SETFILTER("Plot No.", '%1', '');
      OptionSubGroup.FILTERGROUP(0);
      ProjectOptionSubGroups.SETTABLEVIEW(OptionSubGroup);
      ProjectOptionSubGroups.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectHouseModels@1100529263();
    VAR
      HouseModel@1100529201 : Record 11012501;
      HouseModelsbyProjectList@1100529200 : Page 11012501;
    BEGIN
      HouseModel.FILTERGROUP(9);
      HouseModel.SETRANGE("Project No.","No.");
      HouseModel.FILTERGROUP(0);
      HouseModel.SETRANGE("Project No.","No.");
      HouseModelsbyProjectList.SETTABLEVIEW(HouseModel);
      HouseModelsbyProjectList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectPlots@1100529274();
    VAR
      Plot@1100529201 : Record 11012500;
      PlotNumberList@1100529200 : Page 11012506;
    BEGIN
      Plot.FILTERGROUP(4);
      Plot.SETRANGE("Project No.","No.");
      Plot.FILTERGROUP(0);
      PlotNumberList.SETTABLEVIEW(Plot);
      PlotNumberList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectOptionQuotes@1100529298();
    VAR
      OptionQuoteHeader@1100529201 : Record 11012513;
      OptionQuoteList@1100529200 : Page 11012546;
    BEGIN
      OptionQuoteHeader.FILTERGROUP(4);
      OptionQuoteHeader.SETRANGE("Project No.","No.");
      OptionQuoteHeader.FILTERGROUP(0);
      OptionQuoteList.SETTABLEVIEW(OptionQuoteHeader);
      OptionQuoteList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectOptionCrossList@1100529307();
    VAR
      OptionCrossList@1100529201 : Record 11012515;
      CrossListofOptions@1100529200 : Page 11012524;
    BEGIN
      OptionCrossList.FILTERGROUP(4);
      OptionCrossList.SETRANGE("Project No.","No.");
      OptionCrossList.FILTERGROUP(0);
      CrossListofOptions.SETTABLEVIEW(OptionCrossList);
      CrossListofOptions.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectPlotDelivery@1100529335();
    VAR
      Delivery@1100529201 : Record 11012507;
      DeliveriesbyPlotNo@1100529200 : Page 11012528;
    BEGIN
      Delivery.FILTERGROUP(9);
      Delivery.SETRANGE("Project No.","No.");
      Delivery.SETRANGE("Plot No.",'');
      Delivery.FILTERGROUP(0);
      DeliveriesbyPlotNo.SETTABLEVIEW(Delivery);
      DeliveriesbyPlotNo.RUNMODAL;
    END;

    LOCAL PROCEDURE RunSubProjects@1100529346();
    VAR
      Job@1100529201 : Record 11072003;
      JobList@1100529200 : Page 11072004;
    BEGIN
      Job.FILTERGROUP(9);
      Job.SETRANGE("Single/Main/Sub Project", "Single/Main/Sub Project"::"Sub Project");
      Job.SETRANGE("Main Project", "No.");
      Job.FILTERGROUP(0);
      JobList.SETTABLEVIEW(Job);
      JobList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectElements@1100529366();
    VAR
      ProjectElement@1100529201 : Record 11012010;
      ProjectElements@1100529200 : Page 11012028;
    BEGIN
      ProjectElement.FILTERGROUP(9);
      ProjectElement.SETRANGE("Project No.","No.");
      ProjectElement.FILTERGROUP(0);
      ProjectElements.SETTABLEVIEW(ProjectElement);
      ProjectElements.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectExtensions@1100529384();
    VAR
      ExtensionContract@1100529201 : Record 11012004;
      ExtensionList@1100529200 : Page 11012014;
    BEGIN
      ExtensionContract.FILTERGROUP(4);  //C039687: filtergroup 9->4 (due to default project for new contract)
      ExtensionContract.SETRANGE("Project No.","No.");
      ExtensionContract.FILTERGROUP(0);
      ExtensionList.SETTABLEVIEW(ExtensionContract);
      ExtensionList.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectComments@1100529406();
    VAR
      CommentLine@1100529201 : Record 97;
      CommentSheet@1100529200 : Page 124;
    BEGIN
      CommentLine.FILTERGROUP(9);
      CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Job);
      CommentLine.SETRANGE("No.","No.");
      CommentLine.FILTERGROUP(0);
      CommentSheet.SETTABLEVIEW(CommentLine);
      CommentSheet.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectResponsiblePersons@1100529416();
    VAR
      ProjectResponsiblePerson@1100529201 : Record 11012040;
      ProjectResponsiblePersons@1100529200 : Page 11012017;
    BEGIN
      ProjectResponsiblePerson.FILTERGROUP(9);
      ProjectResponsiblePerson.SETRANGE("Project No.","No.");
      ProjectResponsiblePerson.FILTERGROUP(0);
      ProjectResponsiblePersons.SETTABLEVIEW(ProjectResponsiblePerson);
      ProjectResponsiblePersons.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectAuthorities@1100529424();
    VAR
      ProjectAuthority@1100529201 : Record 11020216;
      ProjectAuthorities@1100529200 : Page 11020231;
    BEGIN
      ProjectAuthority.FILTERGROUP(9);
      ProjectAuthority.SETRANGE("Project No.","No.");
      ProjectAuthority.FILTERGROUP(0);
      ProjectAuthorities.SETTABLEVIEW(ProjectAuthority);
      ProjectAuthorities.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectLocations@1100529432();
    VAR
      ProjectLocation@1100529201 : Record 11012011;
      ProjectLocations@1100529200 : Page 11012020;
    BEGIN
      ProjectLocation.FILTERGROUP(9);
      ProjectLocation.SETRANGE("Project No.","No.");
      ProjectLocation.FILTERGROUP(0);
      ProjectLocations.SETTABLEVIEW(ProjectLocation);
      ProjectLocations.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectPreferenceLocations@1100529452();
    VAR
      PreferenceLocation@1100529201 : Record 11020353;
      PreferenceLocations@1100529200 : Page 11072043;
    BEGIN
      PreferenceLocation.FILTERGROUP(9);
      PreferenceLocation.SETCURRENTKEY(Priority);
      PreferenceLocation.SETRANGE(Type,PreferenceLocation.Type::Job);
      PreferenceLocation.SETRANGE("No.","No.");
      PreferenceLocation.FILTERGROUP(0);
      PreferenceLocations.SETTABLEVIEW(PreferenceLocation);
      PreferenceLocations.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectCostObjects@1100529471();
    VAR
      ProjectCostObject@1100529201 : Record 11012065;
      ProjectCostObjects@1100529200 : Page 11012128;
    BEGIN
      ProjectCostObject.FILTERGROUP(9);
      ProjectCostObject.SETRANGE("Project No.","No.");
      ProjectCostObject.FILTERGROUP(0);
      ProjectCostObjects.SETTABLEVIEW(ProjectCostObject);
      ProjectCostObjects.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectBudgetRates@1100529489();
    VAR
      ProjectBudgetRate@1100529201 : Record 11020231;
      ProjectBudgetRates@1100529200 : Page 11020264;
    BEGIN
      ProjectBudgetRate.FILTERGROUP(9);
      ProjectBudgetRate.SETRANGE("Project No.","No.");
      ProjectBudgetRate.FILTERGROUP(0);
      ProjectBudgetRates.SETTABLEVIEW(ProjectBudgetRate);
      ProjectBudgetRates.RUNMODAL;
    END;

    LOCAL PROCEDURE RunProjectTenderParagraphs@1100529500();
    VAR
      TenderParagraph@1100529201 : Record 11012072;
      ProjectTenderParagraphList@1100529200 : Page 11020346;
    BEGIN
      TenderParagraph.FILTERGROUP(9);
      TenderParagraph.SETRANGE(Type,TenderParagraph.Type::Job);
      TenderParagraph.SETRANGE("Purchase Action",'');
      TenderParagraph.SETRANGE("Document No.",'');
      TenderParagraph.SETRANGE("No.","No.");
      TenderParagraph.FILTERGROUP(0);
      ProjectTenderParagraphList.SETTABLEVIEW(TenderParagraph);
      ProjectTenderParagraphList.RUNMODAL;
    END;

    BEGIN
    {
      4PS 24-02-17 UKR-C30065 TTA: Function ProcessPrognosis modified
    }
    END.
  }
}

