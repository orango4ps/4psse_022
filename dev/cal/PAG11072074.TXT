OBJECT Page 11072074 Create Opportunity
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00 (5126);
  }
  PROPERTIES
  {
    CaptionML=[DEU=Verkaufschance erstellen;
               ENU=Create Opportunity;
               NLD=Opportunity maken;
               NOR=Opprett salgsmulighet;
               SVE=Skapa affÑrsmîjlighet];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5092;
    DataCaptionExpr=Caption;
    PageType=Card;
    OnInit=BEGIN
             SalespersonCodeEditable := TRUE;
             WizardCampaignDescriptionEdita := TRUE;
             WizardContactNameEditable := TRUE;
           END;

    OnOpenPage=BEGIN
                 IsOnMobile := ClientTypeManagement.GetCurrentClientType = CLIENTTYPE::Phone;
               END;

    OnAfterGetRecord=BEGIN
                       WizardContactNameOnFormat(FORMAT("Wizard Contact Name"));
                     END;

    OnQueryClosePage=BEGIN
                       IF CloseAction IN [ACTION::OK,ACTION::LookupOK] THEN
                         FinishPage;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 10      ;1   ;Action    ;
                      Name=FinishWizard;
                      CaptionML=[DEU=B&eenden;
                                 ENU=&Finish;
                                 NLD=Voltooie&n;
                                 NOR=&Fullfõr;
                                 SVE=&Slutfîr];
                      ToolTipML=[DEU=Beendet die Erstellung der Verkaufschance.;
                                 ENU=Finish creating the opportunity.;
                                 NLD=Het maken van de opportunity voltooien.;
                                 NOR=Fullfõr oppretting av salgsmuligheten.;
                                 SVE=Slutfîr att skapa affÑrsmîjligheten.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Visible=IsOnMobile;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=BEGIN
                                 FinishPage;
                                 CurrPage.CLOSE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=General;
                CaptionML=[DEU=Allgemein;
                           ENU=General;
                           NLD=Algemeen;
                           NOR=Generell;
                           SVE=AllmÑnt];
                GroupType=Group }

    { 23  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die Beschreibung der Verkaufschance an.;
                           ENU=Specifies the description of the opportunity.;
                           NLD=Hiermee wordt de omschrijving van de opportunity opgegeven.;
                           NOR=Angir beskrivelsen av salgsmuligheten.;
                           SVE=Anger en beskrivning av affÑrsmîjligheten.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Description }

    { 12  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt das Datum an, an dem die Verkaufschance erstellt wurde.;
                           ENU=Specifies the date that the opportunity was created.;
                           NLD=Hiermee wordt de datum opgegeven waarop de opportunity is gemaakt.;
                           NOR=Angir datoen da salgsmuligheten ble opprettet.;
                           SVE=Anger det datum dÜ affÑrsmîjligheten skapades.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Creation Date" }

    { 20  ;2   ;Field     ;
                ToolTipML=[DEU=Gibt die PrioritÑt der Verkaufschance an. Es sind drei Optionen verfÅgbar:;
                           ENU=Specifies the priority of the opportunity. There are three options:;
                           NLD=Hiermee wordt de prioriteit opgegeven van de opportunity. Er zijn drie opties:;
                           NOR=Angir prioriteten for salgsmuligheten. Det er tre alternativer:;
                           SVE=Anger affÑrsmîjlighetens prioritet. Det finns tre alternativ:];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=Priority }

    { 7   ;2   ;Field     ;
                Lookup=No;
                CaptionML=[DEU=Kontakt;
                           ENU=Contact;
                           NLD=Contactpersoon;
                           NOR=Kontakt;
                           SVE=Kontaktperson];
                ToolTipML=[DEU=Gibt den Kontakt an, der an dieser Verkaufschance beteiligt ist.;
                           ENU=Specifies the contact who is involved in this opportunity.;
                           NLD=Hiermee wordt de contactpersoon opgegeven die betrokken is bij deze opportunity.;
                           NOR=Angir kontakten som er involvert i denne salgsmuligheten.;
                           SVE=Anger kontakten som Ñr involverad i denna affÑrsmîjlighet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Wizard Contact Name";
                TableRelation=Contact;
                Editable=WizardContactNameEditable;
                OnAssistEdit=VAR
                               Cont@1102601001 : Record 5050;
                             BEGIN
                               IF (GETFILTER("Contact No.") = '') AND (GETFILTER("Contact Company No.") = '') THEN
                                 IF (Cont."No." = '') AND ("Segment Description" = '') THEN BEGIN
                                   IF Cont.GET("Contact No.") THEN ;
                                   IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                     VALIDATE("Contact No.",Cont."No.");
                                     "Wizard Contact Name" := Cont.Name;
                                   END;
                                 END;
                             END;
                              }

    { 4   ;2   ;Field     ;
                CaptionML=[DEU=VerkÑufer;
                           ENU=Salesperson;
                           NLD=Verkoper;
                           NOR=Salesperson;
                           SVE=SÑljare];
                ToolTipML=[DEU=Gibt den VerkÑufer an, der fÅr die Verkaufschance verantwortlich ist.;
                           ENU=Specifies the salesperson who is responsible for the opportunity.;
                           NLD=Hiermee wordt de verkoper opgegeven die verantwoordelijk is voor de opportunity.;
                           NOR=Angir selgeren som er ansvarlig for salgsmuligheten.;
                           SVE=Anger den sÑljare som ansvarar fîr affÑrsmîjligheten.];
                ApplicationArea=#Suite,#RelationshipMgmt;
                SourceExpr="Salesperson Code";
                Editable=SalespersonCodeEditable }

    { 2   ;2   ;Field     ;
                CaptionML=[DEU=Verkaufsprozess;
                           ENU=Sales Cycle;
                           NLD=Verkoopcyclus;
                           NOR=Salgssyklus;
                           SVE=FîrsÑljningscykel];
                ToolTipML=[DEU=Gibt an, welcher Verkaufsprozess zum Verarbeiten dieser Verkaufschance verwendet wird.;
                           ENU=Specifies which sales cycle will be used to process this opportunity;
                           NLD=Hiermee wordt opgegeven welke verkoopcyclus wordt gebruikt om deze opportunity te verwerken;
                           NOR=Angir hvilken salgssyklus som vil bli brukt til behandling av denne salgsmuligheten;
                           SVE=Anger den fîrsÑljningscykel som anvÑnds fîr att behandla denna affÑrsmîjlighet];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Sales Cycle Code" }

    { 5   ;2   ;Field     ;
                Lookup=No;
                CaptionML=[DEU=Kampagne;
                           ENU=Campaign;
                           NLD=Campagne;
                           NOR=Kampanje;
                           SVE=Kampanj];
                ToolTipML=[DEU=Gibt die Kampagne an, die mit die Verkaufschance verbunden ist. Die Beschreibung wird von der Kampagnenkarte Åbernommen.;
                           ENU=Specifies the campaign that the opportunity is related to. The description is copied from the campaign card.;
                           NLD=Hiermee wordt de campagne opgegeven waaraan de opportunity gerelateerd is. De beschrijving wordt gekopieerd van de campagnekaart.;
                           NOR=Angir kampanjen som salgsmuligheten er relatert til. Beskrivelsen blir kopiert fra kampanjekortet.;
                           SVE=Anger den kampanj som affÑrsmîjligheten Ñr relaterad till. Beskrivningen kopieras frÜn kampanjkortet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Wizard Campaign Description";
                TableRelation=Campaign;
                Importance=Additional;
                Editable=WizardCampaignDescriptionEdita;
                OnAssistEdit=VAR
                               Campaign@1102601001 : Record 11072034;
                             BEGIN
                               IF GETFILTER("Campaign No.") = '' THEN
                                 IF PAGE.RUNMODAL(0,Campaign) = ACTION::LookupOK THEN BEGIN
                                   VALIDATE("Campaign No.",Campaign."No.");
                                   "Wizard Campaign Description" := Campaign.Description;
                                 END;
                             END;
                              }

    { 3   ;2   ;Field     ;
                Lookup=No;
                CaptionML=[DEU=Segment;
                           ENU=Segment;
                           NLD=Segment;
                           NOR=Segment;
                           SVE=Segment];
                ToolTipML=[DEU=Gibt eine Beschreibung des Segments fÅr die Verkaufschance an. Die Beschreibung wird von der Segmentkarte Åbernommen.;
                           ENU=Specifies a description of the segment that is related to the opportunity. The description is copied from the segment card.;
                           NLD=Hiermee wordt een omschrijving opgegeven van het segment dat is gerelateerd aan de opportunity. De omschrijving wordt gekopieerd van de segmentkaart.;
                           NOR=Angir en beskrivelse av segmentet som er relatert til salgsmuligheten. Beskrivelsen blir kopiert fra segmentkortet.;
                           SVE=Anger en beskrivning av segmentet som Ñr relaterat till affÑrsmîjligheten. Beskrivningen kopieras frÜn segmentkortet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Segment Description";
                TableRelation="Segment Header";
                Importance=Additional;
                Editable=FALSE;
                OnAssistEdit=VAR
                               SegmentHeader@1102601000 : Record 11072039;
                             BEGIN
                               IF SegHeader."No." = '' THEN
                                 IF PAGE.RUNMODAL(0,SegmentHeader) = ACTION::LookupOK THEN BEGIN
                                   VALIDATE("Segment No.",SegmentHeader."No.");
                                   "Segment Description" := SegmentHeader.Description;
                                 END;
                             END;
                              }

    { 34  ;1   ;Group     ;
                Name=Estimates;
                CaptionML=[DEU=SchÑtzungen;
                           ENU=Estimates;
                           NLD=Schattingen;
                           NOR=Kalkyler;
                           SVE=Kalkyler];
                GroupType=Group }

    { 37  ;2   ;Field     ;
                CaptionML=[DEU=Erste Stufe aktivieren.;
                           ENU=Activate the First Stage.;
                           NLD=Eerste stap activeren.;
                           NOR=Aktiver fõrste steg.;
                           SVE=Aktivera fîrsta steget.];
                ToolTipML=[DEU=Gibt an, ob die Verkaufschance aktiviert werden soll. Wenn Sie das KontrollkÑstchen aktivieren, kînnen Sie die Åbrigen Felder auf dieser Seite ausfÅllen. Im Fenster "Verkaufschancenkarte" wird der Status auf "In Bearbeitung" gesetzt.;
                           ENU=Specifies if the opportunity is to be activated. If you select the check box, then you can fill out the remainder of the fields on this page. In the Opportunity Card window, the status is set to In Progress.;
                           NLD=Hiermee wordt opgegeven of de opportunity moet worden geactiveerd. Als u het selectievakje inschakelt, kunt u de overige velden op deze pagina invullen. In het venster Opportunity wordt de status ingesteld op Wordt uitgevoerd.;
                           NOR=Angir om salgsmuligheten skal aktiveres. Hvis du merker av for dette, kan du fylle ut resten av feltene pÜ denne siden. I vinduet Salgsmulighetskort blir statusen satt til I arbeid.;
                           SVE=Anger om affÑrsmîjligheten ska aktiveras. Om du markerar kryssrutan kan du fylla i resten av fÑlten pÜ denna sida. I fînstret AffÑrsmîjlighetskort anges statusen som PÜgÜr.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Activate First Stage";
                OnValidate=BEGIN
                             IF NOT "Activate First Stage" THEN BEGIN
                               "Wizard Estimated Value (LCY)" := 0;
                               "Wizard Chances of Success %" := 0;
                               "Wizard Estimated Closing Date" := 0D;
                             END;
                           END;
                            }

    { 25  ;2   ;Field     ;
                CaptionML=[DEU=Erwarteter Verkaufswert (MW);
                           ENU=Estimated Sales Value (LCY);
                           NLD=Geschatte verkoopwaarde (LV);
                           NOR=AnslÜtt salgsverdi (NOK);
                           SVE=Uppskattat fîrsÑljningsvÑrde (BVA)];
                ToolTipML=[DEU=Gibt den Wert im Assistenten fÅr die Verkaufschance an. Sie kînnen in diesem Feld einen erwarteten Wert der Verkaufschance in der LandeswÑhrung angeben.;
                           ENU=Specifies the value in the wizard for the opportunity. You can specify an estimated value of the opportunity in local currency in this field.;
                           NLD=Hiermee wordt de waarde in de wizard voor de opportunity opgegeven. U kunt een geschatte waarde van de opportunity in lokale valuta opgeven in dit veld.;
                           NOR=Angir verdien i veiviseren for salgsmuligheten. Du kan angi en anslÜtt verdi for salgsmuligheten i lokal valuta i dette feltet.;
                           SVE=Anger vÑrdet i guiden fîr affÑrsmîjligheten. Du kan ange ett uppskattat vÑrde fîr affÑrsmîjligheten i lokal valuta i det hÑr fÑltet.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Wizard Estimated Value (LCY)";
                Enabled="Activate First Stage" }

    { 27  ;2   ;Field     ;
                CaptionML=[DEU=Erfolgschancen %;
                           ENU=Chances of Success (%);
                           NLD=Slagingskans (%);
                           NOR=Salgsutsikts-%;
                           SVE=Hemmaˇ(%)];
                ToolTipML=[DEU=Gibt den Wert im Assistenten fÅr die Verkaufschance an. Sie kînnen in diesem Feld einen erwarteten Prozentsatz der Fertigung angeben.;
                           ENU=Specifies the value in the wizard for the opportunity. You can specify a percentage completion estimate in this field.;
                           NLD=Hiermee wordt de waarde in de wizard voor de opportunity opgegeven. U kunt een geschat voltooiingspercentage opgeven in dit veld.;
                           NOR=Angir verdien i veiviseren for salgsmuligheten. Du kan angi et prosentfullfõringsanslag i dette feltet.;
                           SVE=Anger vÑrdet i guiden fîr affÑrsmîjligheten. Du kan ange ett uppskattat vÑrde fîr procent fÑrdigstÑllt i det hÑr fÑltet.];
                ApplicationArea=#RelationshipMgmt;
                DecimalPlaces=0:0;
                SourceExpr="Wizard Chances of Success %";
                MaxValue=100;
                Enabled="Activate First Stage" }

    { 31  ;2   ;Field     ;
                CaptionML=[DEU=Erwartetes Abschlussdatum;
                           ENU=Estimated Closing Date;
                           NLD=Geschatte ultimodatum;
                           NOR=AnslÜtt avslutningsdato;
                           SVE=Troligt avslutsdatum];
                ToolTipML=[DEU=Gibt ein Abschlussdatum fÅr die Verkaufschance aus dem Assistenten an.;
                           ENU=Specifies a closing date for the opportunity from the wizard.;
                           NLD=Hiermee wordt een sluitingsdatum opgegeven voor de opportunity uit de wizard.;
                           NOR=Angir en avslutningsdato for salgsmuligheten fra veiviseren.;
                           SVE=Anger ett avslutsdatum fîr affÑrsmîjligheten frÜn guiden.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Wizard Estimated Closing Date";
                Enabled="Activate First Stage" }

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=(Mehrere);ENU=(Multiple);NLD=(Meerdere);NOR=(Flere);SVE=(Flera)';
      Text001@1001 : TextConst 'DEU=unbenannt;ENU=untitled;NLD=naamloos;NOR=uten navn;SVE=namnlîs';
      Cont@1003 : Record 5050;
      SalesPurchPerson@1004 : Record 13;
      Campaign@1005 : Record 11072034;
      SegHeader@1006 : Record 11072039;
      ClientTypeManagement@1007 : Codeunit 4030;
      WizardContactNameEditable@19024232 : Boolean INDATASET;
      SalespersonCodeEditable@19071610 : Boolean INDATASET;
      WizardCampaignDescriptionEdita@19073396 : Boolean INDATASET;
      IsOnMobile@1002 : Boolean;

    LOCAL PROCEDURE Caption@1() : Text[260];
    VAR
      CaptionStr@1000 : Text[260];
    BEGIN
      IF Cont.GET(GETFILTER("Contact Company No.")) THEN
        CaptionStr := COPYSTR(Cont."No." + ' ' + Cont.Name,1,MAXSTRLEN(CaptionStr));
      IF Cont.GET(GETFILTER("Contact No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Cont."No." + ' ' + Cont.Name,1,MAXSTRLEN(CaptionStr));
      IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + SalesPurchPerson.Code + ' ' + SalesPurchPerson.Name,1,MAXSTRLEN(CaptionStr));
      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Campaign."No." + ' ' + Campaign.Description,1,MAXSTRLEN(CaptionStr));
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + SegHeader."No." + ' ' + SegHeader.Description,1,MAXSTRLEN(CaptionStr));
      IF CaptionStr = '' THEN
        CaptionStr := Text001;

      EXIT(CaptionStr);
    END;

    LOCAL PROCEDURE WizardContactNameOnFormat@19031225(Text@19070643 : Text[1024]);
    BEGIN
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        Text := Text000;
    END;

    LOCAL PROCEDURE FinishPage@4();
    BEGIN
      CheckStatus;
      FinishWizard;
    END;

    BEGIN
    END.
  }
}

