OBJECT Report 11012460 Tender Application To Excel
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Einkaufsangebotsanfrage in Excel;
               ENU=Tender Application To Excel;
               NLD=Inkoopofferte-aanvraag naar Excel;
               SVE=Anbudsprogram till Excel];
    ProcessingOnly=Yes;
    OnPreReport=VAR
                  DotNetManagement@1100528700 : Codeunit 11012374;
                BEGIN
                  ProvisionalWorkSetup.GET;
                  ProvisionalWorkSetup.TESTFIELD("Path of Excel Files");

                  gIntFeatureHeaderRow := ProvisionalWorkSetup."Start Row Features";
                  gIntStartFeatureColumn := ColumnCharsToNumber(ProvisionalWorkSetup."Start Column Features");
                  gIntMaxFeatureColumns := ProvisionalWorkSetup."Max No. of Columns";

                  gIntTypeDescrColumn := ColumnCharsToNumber(ProvisionalWorkSetup."Start Column Numbers");
                  gIntStartTypeRow := ProvisionalWorkSetup."Start Row Descriptions";
                  gIntDateColumn := ColumnCharsToNumber(ProvisionalWorkSetup."Date Column");

                  gIntLastFeatureColumns := ColumnCharsToNumber(ProvisionalWorkSetup."Last Column");

                  DotNetManagement.GetTypeMissing(TypeMissing);
                END;

  }
  DATASET
  {
    { 3231;    ;DataItem;                    ;
               DataItemTable=Table11012774;
               OnAfterGetRecord=VAR
                                  XlRange@1100528700 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range" RUNONCLIENT;
                                BEGIN
                                  OpenBook(ProvisionalWorkSetup."Excel Template File", ProvisionalWorkSetup."Sheet Name General");
                                  WriteCell(7, 10, Description);
                                  WriteCell(7, 11, "No.");
                                  WriteCell(7, 12, FORMAT("Version Date"));

                                  gIntColNo := gIntStartFeatureColumn;

                                  IF gIntMaxFeatureColumns = 0 THEN BEGIN

                                    gvColumnSlack := 2; // 2 kolommen bestaan al.
                                    ProvisionalWorkSpecDtlsRec.SETRANGE("Provisional Work No.", "No.");
                                    ProvisionalWorkFeatureRec.SETRANGE("Provisional Work No.", "No.");
                                    IF ProvisionalWorkFeatureRec.FINDSET THEN BEGIN
                                      REPEAT

                                        gvColumnSlack := gvColumnSlack - 1;

                                        IF gvColumnSlack < 0 THEN BEGIN

                                          SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Design Distr.");
                                          XlRange := XlWrkSht.Columns.Item(gIntColNo);
                                          XlRange.Select;
                                          gVarDummy := XlRange.Copy(TypeMissing);
                                          XlRange.Insert(TypeMissing, TypeMissing);
                                          XlApp.CutCopyMode := 0;
                                          CLEAR(XlRange);

                                          SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Design List");
                                          XlRange := XlWrkSht.Columns.Item(gIntColNo);
                                          XlRange.Select;
                                          gVarDummy := XlRange.Copy(TypeMissing);
                                          XlRange.Insert(TypeMissing, TypeMissing);
                                          XlApp.CutCopyMode := 0;
                                          CLEAR(XlRange);

                                          SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Plan Distr.");
                                          XlRange := XlWrkSht.Columns.Item(gIntColNo);
                                          XlRange.Select;
                                          gVarDummy := XlRange.Copy(TypeMissing);
                                          XlRange.Insert(TypeMissing, TypeMissing);
                                          XlApp.CutCopyMode := 0;
                                          CLEAR(XlRange);

                                          SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Plan List");
                                          XlRange := XlWrkSht.Columns.Item(gIntColNo);
                                          XlRange.Select;
                                          gVarDummy := XlRange.Copy(TypeMissing);
                                          XlRange.Insert(TypeMissing, TypeMissing);
                                          XlApp.CutCopyMode := 0;
                                          CLEAR(XlRange);

                                          SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Note Distr.");
                                          XlRange := XlWrkSht.Columns.Item(gIntColNo);
                                          XlRange.Select;
                                          gVarDummy := XlRange.Copy(TypeMissing);
                                          XlRange.Insert(TypeMissing, TypeMissing);
                                          XlApp.CutCopyMode := 0;
                                          CLEAR(XlRange);

                                          SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Note List");
                                          XlRange := XlWrkSht.Columns.Item(gIntColNo);
                                          XlRange.Select;
                                          gVarDummy := XlRange.Copy(TypeMissing);
                                          XlRange.Insert(TypeMissing, TypeMissing);
                                          XlApp.CutCopyMode := 0;
                                          CLEAR(XlRange);

                                        END;

                                        gIntMaxFeatureColumns += 1;

                                      UNTIL ProvisionalWorkFeatureRec.NEXT = 0;

                                      gIntLastFeatureColumns := gIntMaxFeatureColumns + gIntStartFeatureColumn - 1;

                                    END;
                                  END;


                                  SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Design Distr.");
                                  gIntColNo := gIntStartFeatureColumn;

                                  ProvisionalWorkSpecDtlsRec.SETRANGE("Provisional Work No.", "No.");
                                  ProvisionalWorkFeatureRec.SETRANGE("Provisional Work No.", "No.");
                                  IF ProvisionalWorkFeatureRec.FINDSET THEN
                                    REPEAT
                                      WriteCell(gIntColNo, gIntFeatureHeaderRow, ProvisionalWorkFeatureRec.Feature);
                                      WriteCell(gIntColNo, gIntFeatureHeaderRow + 1, ProvisionalWorkFeatureRec."Feature Description");
                                      gIntColNo += 1;
                                    UNTIL (ProvisionalWorkFeatureRec.NEXT = 0) OR (gIntColNo = (gIntStartFeatureColumn + gIntMaxFeatureColumns));
                                END;

               OnPostDataItem=BEGIN
                                XlWrkBk.Save();
                                GiveUserControl();
                              END;

               ReqFilterFields=No. }

    { 3336;1   ;DataItem;Tender Appl. Spec. Design;
               DataItemTable=Table11012775;
               DataItemTableView=SORTING(Provisional Work No.,Specification Type,Code,Line No.)
                                 WHERE(Specification Type=CONST(Design));
               OnPreDataItem=BEGIN
                               gIntRowNo := gIntStartTypeRow;
                               gvRowCount := "Tender Appl. Spec. Design".COUNT;
                             END;

               OnAfterGetRecord=VAR
                                  XlRange@1100528700 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range" RUNONCLIENT;
                                BEGIN

                                  IF gIntRowNo < gIntStartTypeRow + gvRowCount - 2 THEN BEGIN

                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Design Distr.");
                                    XlRange := XlWrkSht.Rows.Item(gIntRowNo);
                                    XlRange.Select;
                                    gVarDummy := XlRange.Copy(TypeMissing);
                                    XlRange.Insert(TypeMissing, TypeMissing);
                                    XlApp.CutCopyMode := 0;
                                    CLEAR(XlRange);
                                    FormatCells(Level);

                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Design List");
                                    XlRange := XlWrkSht.Rows.Item(gIntRowNo);
                                    XlRange.Select;
                                    gVarDummy := XlRange.Copy(TypeMissing);
                                    XlRange.Insert(TypeMissing, TypeMissing);
                                    XlApp.CutCopyMode := 0;
                                    CLEAR(XlRange);
                                    FormatCells(Level);

                                  END ELSE BEGIN

                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Design Distr.");
                                    FormatCells(Level);
                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Design List");
                                    FormatCells(Level);

                                  END;

                                  SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Design Distr.");

                                  gIntColNo := gIntTypeDescrColumn;
                                  WriteCell(gIntColNo, gIntRowNo, "No."); //n
                                  WriteCell(gIntColNo+1, gIntRowNo, Description);
                                  WriteCell(gIntColNo+2, gIntRowNo, "Design Format");
                                  WriteCell(gIntColNo+3, gIntRowNo, FORMAT("Revision Date"));
                                  WriteCell(gIntColNo+4, gIntRowNo, "Revision No.");
                                  WriteCell(gIntDateColumn, gIntRowNo, FORMAT(Date));

                                  ProvisionalWorkSpecDtlsRec.SETRANGE(Type, "Specification Type");
                                  ProvisionalWorkSpecDtlsRec.SETRANGE("Line No.", "Line No.");
                                  WriteContactCount();

                                  gIntRowNo += 1;
                                END;

               DataItemLink=Provisional Work No.=FIELD(No.) }

    { 2141;1   ;DataItem;Tender Appl. Spec. Plan;
               DataItemTable=Table11012775;
               DataItemTableView=SORTING(Provisional Work No.,Specification Type,Code,Line No.)
                                 WHERE(Specification Type=CONST(Plan));
               OnPreDataItem=BEGIN
                               gIntRowNo := gIntStartTypeRow;
                               gvRowCount := "Tender Appl. Spec. Plan".COUNT;
                             END;

               OnAfterGetRecord=VAR
                                  XlRange@1100528700 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range" RUNONCLIENT;
                                BEGIN
                                  IF gIntRowNo < gIntStartTypeRow + gvRowCount - 2 THEN BEGIN

                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Plan Distr.");
                                    XlRange := XlWrkSht.Rows.Item(gIntRowNo);
                                    XlRange.Select;
                                    gVarDummy := XlRange.Copy(TypeMissing);
                                    XlRange.Insert(TypeMissing, TypeMissing);
                                    XlApp.CutCopyMode := 0;
                                    CLEAR(XlRange);
                                    FormatCells(Level);

                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Plan List");
                                    XlRange := XlWrkSht.Rows.Item(gIntRowNo);
                                    XlRange.Select;
                                    gVarDummy := XlRange.Copy(TypeMissing);
                                    XlRange.Insert(TypeMissing, TypeMissing);
                                    XlApp.CutCopyMode := 0;
                                    CLEAR(XlRange);
                                    FormatCells(Level);

                                  END ELSE BEGIN

                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Plan Distr.");
                                    FormatCells(Level);
                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Plan List");
                                    FormatCells(Level);

                                  END;

                                  SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Plan Distr.");

                                  gIntColNo := gIntTypeDescrColumn;
                                  WriteCell(gIntColNo, gIntRowNo, "No."); //n
                                  WriteCell(gIntColNo+1, gIntRowNo, Description);
                                  WriteCell(gIntColNo+2, gIntRowNo, Pages);//n
                                  WriteCell(gIntColNo+3, gIntRowNo, FORMAT("Revision Date"));//n
                                  WriteCell(gIntColNo+4, gIntRowNo, "Revision No.");//n

                                  ProvisionalWorkSpecDtlsRec.SETRANGE(Type, "Specification Type");
                                  ProvisionalWorkSpecDtlsRec.SETRANGE("Line No.", "Line No.");
                                  WriteContactCount();

                                  gIntRowNo += 1;
                                END;

               DataItemLink=Provisional Work No.=FIELD(No.) }

    { 7581;1   ;DataItem;Tender Appl. Spec. Note;
               DataItemTable=Table11012775;
               DataItemTableView=SORTING(Provisional Work No.,Specification Type,Code,Line No.)
                                 WHERE(Specification Type=CONST(Note));
               OnPreDataItem=BEGIN
                               gIntRowNo := gIntStartTypeRow;
                               gvRowCount := "Tender Appl. Spec. Note".COUNT;
                             END;

               OnAfterGetRecord=VAR
                                  XlRange@1100528700 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range" RUNONCLIENT;
                                BEGIN
                                  IF gIntRowNo < gIntStartTypeRow + gvRowCount - 2 THEN BEGIN
                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Note Distr.");
                                    XlRange := XlWrkSht.Rows.Item(gIntRowNo);
                                    XlRange.Select;
                                    gVarDummy := XlRange.Copy(TypeMissing);
                                    XlRange.Insert(TypeMissing, TypeMissing);
                                    XlApp.CutCopyMode := 0;
                                    CLEAR(XlRange);
                                    FormatCells(Level);

                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Note List");
                                    XlRange := XlWrkSht.Rows.Item(gIntRowNo);
                                    XlRange.Select;
                                    gVarDummy := XlRange.Copy(TypeMissing);
                                    XlRange.Insert(TypeMissing, TypeMissing);
                                    XlApp.CutCopyMode := 0;
                                    CLEAR(XlRange);
                                    FormatCells(Level);
                                  END ELSE BEGIN
                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Note Distr.");
                                    FormatCells(Level);
                                    SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Note List");
                                    FormatCells(Level);
                                  END;

                                  SelectWorkSheet(ProvisionalWorkSetup."Sheet Name Note Distr.");

                                  gIntColNo := gIntTypeDescrColumn;
                                  WriteCell(gIntColNo, gIntRowNo, "No."); //n
                                  WriteCell(gIntColNo+1, gIntRowNo, Description);
                                  WriteCell(gIntDateColumn, gIntRowNo, FORMAT(Date));

                                  ProvisionalWorkSpecDtlsRec.SETRANGE(Type, "Specification Type");
                                  ProvisionalWorkSpecDtlsRec.SETRANGE("Line No.", "Line No.");
                                  WriteContactCount();

                                  gIntRowNo += 1;
                                END;

               DataItemLink=Provisional Work No.=FIELD(No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ProvisionalWorkSetup@1100485002 : Record 11012784;
      ProvisionalWorkFeatureRec@1100485000 : Record 11012777;
      ProvisionalWorkSpecDtlsRec@1100485001 : Record 11012776;
      XlApp@1100528702 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ApplicationClass" RUNONCLIENT;
      XlWrkBk@1100528701 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook" RUNONCLIENT;
      XlWrkSht@1100528700 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Worksheet" RUNONCLIENT;
      TypeMissing@1100528705 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Object" RUNONCLIENT;
      FileMgt@1100525500 : Codeunit 419;
      ExcelEnumeration@1100528703 : Codeunit 11012375;
      ExcelAutomation@1100528704 : Codeunit 11012402;
      gIntRowNo@1100485011 : Integer;
      gIntColNo@1100485010 : Integer;
      Text000@1100485021 : TextConst 'DEU=Excel wurde nicht gefunden.;ENU=Excel not found.;NLD=Kan Excel niet vinden.;NOR=Finner ikke Excel.;SVE=Excel finns inte.';
      Text001@1100485020 : TextConst 'DEU=Sie mssen einen Dateinamen angeben.;ENU=You must enter a file name.;NLD=U moet een bestandsnaam opgeven.;NOR=Du m† angi et filnavn.;SVE=Du m†ste ange ett filnamn.';
      Text002@1100485019 : TextConst 'DEU=Sie mssen einen Exceltabellennamen angeben.;ENU=You must enter an Excel worksheet name.;NLD=U moet een Excel-werkbladnaam opgeven.;NOR=Du m† angi et navn p† et Excel-ark.;SVE=Du m†ste ange ett kalkylbladsnamn i Excel.';
      Text003@1100485018 : TextConst 'DEU=Die Datei %1 ist nicht vorhanden.;ENU=The file %1 does not exist.;NLD=Het bestand %1 bestaat niet.;NOR=Filen %1 eksisterer ikke.;SVE=Filen %1 finns inte.';
      Text004@1100485003 : TextConst 'DEU=Die Exceltabelle %1 ist nicht vorhanden.;ENU=The Excel worksheet %1 does not exist.;NLD=Het Excel-werkblad %1 bestaat niet.;NOR=Excel-arket %1 eksisterer ikke.;SVE=Excel-kalkylbladet %1 finns inte.';
      gIntStartFeatureColumn@1100485009 : Integer;
      gIntMaxFeatureColumns@1100485022 : Integer;
      gIntFeatureHeaderRow@1100485023 : Integer;
      gIntLastFeatureColumns@1100525003 : Integer;
      gIntTypeDescrColumn@1100485024 : Integer;
      gIntStartTypeRow@1100485025 : Integer;
      gIntDateColumn@1100485014 : Integer;
      gVarDummy@1100485026 : Variant;
      Text005@1100485015 : TextConst 'DEU=Die Datei %1 ist bereits ge”ffnet.;ENU=File %1 is already open.;NLD=Het bestand %1 is al geopend.;NOR=Filen %1 er allerede †pen.;SVE=Filen %1 har redan ”ppnats.';
      Text006@1100485008 : TextConst 'DEU=Die Datei %1 ist bereits vorhanden. M”chten Sie diese berschreiben?;ENU=File %1 already exists, overwrite?;NLD=Het bestand %1 bestaal al, overschrijven?;NOR=Filen %1 finnes allerede, vil du skrive over?;SVE=Filen %1 finns redan. Vill du skriva ”ver den?';
      gvColumnSlack@1100525000 : Integer;
      gvRowCount@1100525002 : Integer;

    PROCEDURE WriteContactCount@1100485044() : Integer;
    BEGIN
      gIntColNo := gIntStartFeatureColumn;
      IF ProvisionalWorkFeatureRec.FINDSET THEN
        REPEAT
          ProvisionalWorkSpecDtlsRec.SETRANGE("Feature Group", ProvisionalWorkFeatureRec."Feature Group");
          ProvisionalWorkSpecDtlsRec.SETRANGE(Feature, ProvisionalWorkFeatureRec.Feature);
          IF ProvisionalWorkSpecDtlsRec.FINDFIRST THEN
            IF ProvisionalWorkSpecDtlsRec.Checked THEN BEGIN
              ProvisionalWorkFeatureRec.CALCFIELDS("No. of Selected Vendors");
              WriteCell(gIntColNo, gIntRowNo, STRSUBSTNO('%1', ProvisionalWorkFeatureRec."No. of Selected Vendors"));
            END;
          gIntColNo += 1;
        UNTIL (ProvisionalWorkFeatureRec.NEXT = 0) OR (gIntColNo = (gIntStartFeatureColumn + gIntMaxFeatureColumns));
    END;

    PROCEDURE OpenBook@1100485000(FileName@1000 : Text[250];SheetName@1001 : Text[250]);
    VAR
      XlHelper@1100528700 : DotNet "'Microsoft.Dynamics.Nav.Integration.Office, Version=14.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Integration.Office.Excel.ExcelHelper" RUNONCLIENT;
      i@1002 : Integer;
      EndOfLoop@1003 : Integer;
      Found@1004 : Boolean;
      Path@1100525000 : Text[250];
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      IF SheetName = '' THEN
        ERROR(Text002);

      IF NOT FileMgt.ClientFileExists(FileName) THEN
        ERROR(Text003, FileName);

      IF ISNULL(XlApp) THEN
        XlApp := XlApp.ApplicationClass;
      IF ISNULL(XlApp) THEN
        ERROR(Text000);

      IF COPYSTR(ProvisionalWorkSetup."Path of Excel Files", STRLEN(ProvisionalWorkSetup."Path of Excel Files"), 1) <> '\' THEN
        ProvisionalWorkSetup."Path of Excel Files" := ProvisionalWorkSetup."Path of Excel Files" + '\';

      IF XlApp.Workbooks.Count > 0 THEN
        FOR i := 1 TO XlApp.Workbooks.Count DO BEGIN
          IF XlApp.Workbooks.Item(i).Name = "Provisional Work"."No." + '.xls' THEN
            ERROR(Text005, ProvisionalWorkSetup."Path of Excel Files" + "Provisional Work"."No." + '.xls');
        END;

      XlWrkBk := XlHelper.CallOpen(XlApp, FileName);
      i := 1;
      EndOfLoop := XlWrkBk.Worksheets.Count;
      WHILE (i <= EndOfLoop) AND (NOT Found) DO BEGIN
        XlWrkSht := XlWrkBk.Worksheets.Item(i);
        IF SheetName = XlWrkSht.Name THEN
          Found := TRUE;
        i := i + 1;
      END;
      IF Found THEN
        XlWrkSht := XlWrkBk.Worksheets.Item(SheetName)
      ELSE BEGIN
        XlWrkBk.Close(FALSE, '', FALSE);
        XlHelper.CallQuit(XlApp);
        CLEAR(XlApp);
        ERROR(Text004, SheetName);
      END;

      IF FileMgt.ClientFileExists(
        ProvisionalWorkSetup."Path of Excel Files" + "Provisional Work"."No." + '.xls')
      THEN BEGIN
        IF CONFIRM(Text006, TRUE, (ProvisionalWorkSetup."Path of Excel Files" + "Provisional Work"."No." + '.xls')) THEN BEGIN
          Path := (ProvisionalWorkSetup."Path of Excel Files" + "Provisional Work"."No." + '.xls');
          FileMgt.DeleteClientFile4PS(Path, TRUE);
          XlWrkBk.SaveAs(
            ProvisionalWorkSetup."Path of Excel Files" + "Provisional Work"."No." + '.xls',
            ExcelEnumeration.XlFileFormat_xlWorkbookDefault,
            TypeMissing, TypeMissing, FALSE, FALSE, ExcelEnumeration.XlSaveAsAccessMode_xlNoChange, TypeMissing, TypeMissing, TypeMissing, TypeMissing, TypeMissing);
        END ELSE
          XlWrkBk.SaveAs(
            ProvisionalWorkSetup."Path of Excel Files" + "Provisional Work"."No." + '-2' + '.xls',
            ExcelEnumeration.XlFileFormat_xlWorkbookDefault,
            TypeMissing, TypeMissing, FALSE, FALSE, ExcelEnumeration.XlSaveAsAccessMode_xlNoChange, TypeMissing, TypeMissing, TypeMissing, TypeMissing, TypeMissing);
      END ELSE
        XlWrkBk.SaveAs(
          ProvisionalWorkSetup."Path of Excel Files" + "Provisional Work"."No." + '.xls',
          ExcelEnumeration.XlFileFormat_xlWorkbookDefault,
          TypeMissing, TypeMissing, FALSE, FALSE, ExcelEnumeration.XlSaveAsAccessMode_xlNoChange, TypeMissing, TypeMissing, TypeMissing, TypeMissing, TypeMissing);
    END;

    PROCEDURE SelectWorkSheet@1100485013(iVarSheet@1100485000 : Variant);
    VAR
      lIntSheetNo@1100485001 : Integer;
      lTxtSheetName@1100485002 : Text[30];
    BEGIN
      CASE TRUE OF
        iVarSheet.ISTEXT, iVarSheet.ISCODE:
          BEGIN
            lTxtSheetName := iVarSheet;
            XlWrkSht := XlWrkBk.Worksheets.Item(lTxtSheetName);
          END;
        iVarSheet.ISINTEGER:
          BEGIN
            lIntSheetNo := iVarSheet;
            XlWrkSht := XlWrkBk.Worksheets.Item(lIntSheetNo);
          END;
        ELSE
          ERROR('Sheet %1 not found', FORMAT(iVarSheet));
      END;
      XlWrkSht.Activate();
    END;

    PROCEDURE GiveUserControl@3();
    BEGIN
      SelectWorkSheet(2);
      XlWrkSht.Range('A1', 'A1').Select;

      XlApp.Visible := TRUE;
      XlApp.UserControl := TRUE;
      CLEAR(XlApp);
    END;

    PROCEDURE WriteCell@4(Col@11012000 : Integer;Row@11012001 : Integer;Contents@11012002 : Text[250]);
    VAR
      ExcelBuffer@1100528700 : Record 370;
      XlRange@1100528701 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range" RUNONCLIENT;
      RangeName@11012003 : Text[30];
      Cell1@1100528702 : Text[30];
      Cell2@1100528703 : Text[30];
    BEGIN
      RangeName := ExcelBuffer.RC2Range(Row, Col, 0, 0);
      ExcelAutomation.GetCellsFromRangeName(RangeName, Cell1, Cell2);

      XlRange := XlWrkSht.Range(Cell1, Cell2);
      XlRange.Value(ExcelEnumeration.XlRangeValueDataType_xlRangeValueDefault, Contents);
    END;

    PROCEDURE FormatCells@1100485002(iIntLevel@1100485000 : Integer);
    VAR
      XlRange@1100528700 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range" RUNONCLIENT;
    BEGIN
      IF iIntLevel = 0 THEN BEGIN
        XlRange := XlWrkSht.Range(
          STRSUBSTNO('%1%2', ProvisionalWorkSetup."Start Column Numbers", gIntRowNo),
          STRSUBSTNO('%1%2', ColumnNumberToChars(gIntLastFeatureColumns), gIntRowNo));
        XlRange.Interior.Color := 14803425;
        XlRange.Font.Bold := TRUE;
      END;
    END;

    LOCAL PROCEDURE ColumnNumberToChars@5(No@11012001 : Integer) Hortext@11012000 : Text[10];
    VAR
      NoText@11012005 : Text[10];
      TempExcelBuff@1100485000 : TEMPORARY Record 370;
    BEGIN
      TempExcelBuff.RESET;
      TempExcelBuff.VALIDATE("Column No.",No);
      NoText := TempExcelBuff.xlColID;
      EXIT(NoText);
    END;

    PROCEDURE ColumnCharsToNumber@1100485001(iChars@1100485000 : Text[30]) RetValue : Integer;
    VAR
      i@1100485001 : Integer;
      ABC@1100485003 : TextConst 'DEU=ABCDEFGHIJKLMNOPQRSTUVWXYZŽ™š;ENU=ABCDEFGHIJKLMNOPQRSTUVWXYZ;NLD=ABCDEFGHIJKLMNOPQRSTUVWXYZ;NOR=ABCDEFGHIJKLMNOPQRSTUVWXYZ;SVE=ABCDEFGHIJKLMNOPQRSTUVWXYZŽ™';
    BEGIN
      FOR i := 1 TO STRLEN(iChars) DO
        RetValue := RetValue + STRPOS(ABC, FORMAT(iChars[i])) * POWER(26, STRLEN(iChars) - i);
    END;

    EVENT XlApp@1100528702::AppEvents_Event_NewWorkbook@424(Wb@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook");
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetSelectionChange@425(Sh@1100525001 : Variant;Target@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range");
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetBeforeDoubleClick@426(Sh@1100525002 : Variant;Target@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range";VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetBeforeRightClick@427(Sh@1100525002 : Variant;Target@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range";VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetActivate@428(Sh@1100525000 : Variant);
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetDeactivate@429(Sh@1100525000 : Variant);
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetCalculate@430(Sh@1100525000 : Variant);
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetChange@431(Sh@1100525001 : Variant;Target@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookOpen@432(Wb@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookActivate@433(Wb@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookDeactivate@434(Wb@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookBeforeClose@435(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookBeforeSave@436(Wb@1100525002 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";SaveAsUI@1100525001 : Boolean;VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookBeforePrint@437(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookNewSheet@438(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Sh@1100525000 : Variant);
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookAddinInstall@439(Wb@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookAddinUninstall@440(Wb@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook");
    BEGIN
    END;

    EVENT XlApp@1100528702::WindowResize@441(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Wn@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Window");
    BEGIN
    END;

    EVENT XlApp@1100528702::WindowActivate@442(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Wn@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Window");
    BEGIN
    END;

    EVENT XlApp@1100528702::WindowDeactivate@443(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Wn@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Window");
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetFollowHyperlink@444(Sh@1100525001 : Variant;Target@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Hyperlink");
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetPivotTableUpdate@445(Sh@1100525001 : Variant;Target@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.PivotTable");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookPivotTableCloseConnection@446(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Target@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.PivotTable");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookPivotTableOpenConnection@447(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Target@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.PivotTable");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookSync@448(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";SyncEventType@1100525000 : DotNet "'office, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Core.MsoSyncEventType");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookBeforeXmlImport@449(Wb@1100525004 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Map@1100525003 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.XmlMap";Url@1100525002 : Text;IsRefresh@1100525001 : Boolean;VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookAfterXmlImport@450(Wb@1100525003 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Map@1100525002 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.XmlMap";IsRefresh@1100525001 : Boolean;Result@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.XlXmlImportResult");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookBeforeXmlExport@451(Wb@1100525003 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Map@1100525002 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.XmlMap";Url@1100525001 : Text;VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookAfterXmlExport@452(Wb@1100525003 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Map@1100525002 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.XmlMap";Url@1100525001 : Text;Result@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.XlXmlExportResult");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookRowsetComplete@453(Wb@1100525003 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Description@1100525002 : Text;Sheet@1100525001 : Text;Success@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::AfterCalculate@454();
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetPivotTableAfterValueChange@455(Sh@1100525002 : Variant;TargetPivotTable@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.PivotTable";TargetRange@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Range");
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetPivotTableBeforeAllocateChanges@456(Sh@1100525004 : Variant;TargetPivotTable@1100525003 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.PivotTable";ValueChangeStart@1100525002 : Integer;ValueChangeEnd@1100525001 : Integer;VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetPivotTableBeforeCommitChanges@457(Sh@1100525004 : Variant;TargetPivotTable@1100525003 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.PivotTable";ValueChangeStart@1100525002 : Integer;ValueChangeEnd@1100525001 : Integer;VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetPivotTableBeforeDiscardChanges@458(Sh@1100525003 : Variant;TargetPivotTable@1100525002 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.PivotTable";ValueChangeStart@1100525001 : Integer;ValueChangeEnd@1100525000 : Integer);
    BEGIN
    END;

    EVENT XlApp@1100528702::ProtectedViewWindowOpen@459(Pvw@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ProtectedViewWindow");
    BEGIN
    END;

    EVENT XlApp@1100528702::ProtectedViewWindowBeforeEdit@460(Pvw@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ProtectedViewWindow";VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::ProtectedViewWindowBeforeClose@461(Pvw@1100525002 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ProtectedViewWindow";Reason@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.XlProtectedViewCloseReason";VAR Cancel@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::ProtectedViewWindowResize@462(Pvw@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ProtectedViewWindow");
    BEGIN
    END;

    EVENT XlApp@1100528702::ProtectedViewWindowActivate@463(Pvw@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ProtectedViewWindow");
    BEGIN
    END;

    EVENT XlApp@1100528702::ProtectedViewWindowDeactivate@464(Pvw@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ProtectedViewWindow");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookAfterSave@465(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Success@1100525000 : Boolean);
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookNewChart@466(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Ch@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Chart");
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetLensGalleryRenderComplete@467(Sh@1100525000 : Variant);
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetTableUpdate@468(Sh@1100525001 : Variant;Target@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.TableObject");
    BEGIN
    END;

    EVENT XlApp@1100528702::WorkbookModelChange@469(Wb@1100525001 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook";Changes@1100525000 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ModelChanges");
    BEGIN
    END;

    EVENT XlApp@1100528702::SheetBeforeDelete@470(Sh@1100525000 : Variant);
    BEGIN
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

