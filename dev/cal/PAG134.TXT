OBJECT Page 134 Posted Sales Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW114.00,4PS14.00,NAVDK.NO;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Sales Credit Memo;
               NOR=Bokfõrt salgskreditnota;
               SVE=Bokfîrd fîrsÑljningskreditnota];
    InsertAllowed=No;
    SourceTable=Table114;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Credit Memo,Cancel,Navigate,Print/Send;
                                NOR=Ny,Prosess,Rapport,Kreditnota,Annullere,Navigere,Skriv ut / send;
                                SVE=Ny,Process,Rapport,Kreditnota,Annullera,Navigera,Skriv ut/skicka];
    OnInit=BEGIN
             //**4PS.sn
             "Interest DateVisible" := TRUE;
             NewDocumentReportingVisible := FALSE; //DP01288
             //**4PS.en
           END;

    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
                 lvInterestCalcMgtCU@1210190000 : Codeunit 11012049;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 SetSecurityFilterOnRespCenter;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
                 IsFoundationEnabled := ApplicationAreaMgmtFacade.IsFoundationEnabled;

                 ActivateFields;

                 //**4PS.sn
                 IF NOT lvInterestCalcMgtCU.PermissionInterestGranule() THEN
                   "Interest DateVisible" := (FALSE);
                 //**4PS.en

                 //4PSSE
                 GLSetup.GET;
                 DKinfoEnable := GLSetup."Danish Localization Active";
                 NORlocalizationEnable := GLSetup."Norwegian Localization Active";
               END;

    OnAfterGetRecord=VAR
                       CancelledDocument@1000 : Record 1900;
                     BEGIN
                       DocExchStatusStyle := GetDocExchStatusStyle;
                       SalesCorrectiveCrMemoExists := CancelledDocument.FindSalesCorrectiveCrMemo("No.");
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnModifyRecord=BEGIN
                     //**4PS.sn
                     CODEUNIT.RUN(CODEUNIT::"Sales Cr.Memo Header-Edit", Rec);
                     EXIT(FALSE);
                     //**4PS.en
                   END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                           RecRef@1100527300 : RecordRef;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("No.","Posting Date");
                           DocExchStatusStyle := GetDocExchStatusStyle;
                           DocExchStatusVisible := DocExchangeStatusIsSent;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);

                           //**4PS.sn
                           RecRef.GETTABLE(Rec);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
                           CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Shortcut Dimension 1 Code");
                           //**4PS.en
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 NOR=Kredi&tnota;
                                 SVE=&Kreditnota];
                      Image=CreditMemo }
      { 9       ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk;
                                 SVE=Statistik];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfõrte poster, for posten.;
                                 SVE=Visa statistisk information fîr posten, till exempel vÑrdet pÜ bokfîrda transaktioner.];
                      ApplicationArea=#Suite;
                      RunObject=Page 398;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category4 }
      { 49      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader;
                                 SVE=Ko&mmentarer];
                      ToolTipML=[ENU=View or add comments for the record.;
                                 NOR=Vis eller legg til kommentarer for posten.;
                                 SVE=Visa eller lÑgg till kommentarer till posten.];
                      ApplicationArea=#Comments;
                      RunObject=Page 67;
                      RunPageLink=Document Type=CONST(Posted Credit Memo),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category4 }
      { 77      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner;
                                 SVE=Dimensioner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrÜde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjõpsdokumenter for Ü distribuere kostnader og analysere transaksjonshistorikk.;
                                 SVE=Visa eller redigera mÜtt, till exempel omrÜde, projekt eller avdelning, som du kan tilldela till fîrsÑljnings- och inkîpsdokument fîr att fîrdela kostnader och analysera transaktionshistorik.];
                      ApplicationArea=#Dimensions;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1210190015;2 ;Action    ;
                      CaptionML=[ENU=&Documents;
                                 SVE=&Dokument];
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 1210190014;2 ;Action    ;
                      CaptionML=[ENU=Document &Relations;
                                 SVE=Dokument&relationer];
                      RunObject=Page 11012413;
                      RunPageView=SORTING(Document Type,No.,Related Document No.)
                                  WHERE(Document Type=CONST(Posted Sales Cr.Memo));
                      RunPageLink=No.=FIELD(No.);
                      Image=Relationship }
      { 92      ;2   ;Action    ;
                      AccessByPermission=TableData 456=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger;
                                 SVE=GodkÑnnanden];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter pÜ Ü bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nÜr den ble sendt og nÜr den forfaller til godkjenning.;
                                 SVE=Visa en lista med poster som vÑntar pÜ att godkÑnnas. Du kan t.ex. se vem som begÑrde att posten skulle godkÑnnas, nÑr den skickades och nÑr den mÜste godkÑnnas.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Approvals;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ShowPostedApprovalEntries(RECORDID);
                               END;
                                }
      { 1901458458;2 ;Action    ;
                      Name=DocAttach;
                      CaptionML=[ENU=Attachments;
                                 NOR=Vedlegg;
                                 SVE=Bilagor];
                      ToolTipML=[ENU=Add a file as an attachment. You can attach images as well as documents.;
                                 NOR=Legg til en fil som vedlegg. Du kan legge ved bilderˇog dokumenter.;
                                 SVE=LÑgg till en fil som en bilaga. Du kan bifoga bilder och dokument.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Image=Attach;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1000 : Page 1173;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 1100485911;2 ;ActionGroup;
                      CaptionML=[ENU=Complaint Management;
                                 SVE=Incidenthantering];
                      Image=ReminderTerms }
      { 1100485912;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create New Complaint;
                                 SVE=Skapa nytt klagomÜl];
                      Image=ReminderTerms;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 TESTFIELD("No.");
                                 lvComplMgtCU.CreateNewComplaintOnDocument(lvComplDocRec."Document Type"::"PM-S", "No.");
                               END;
                                }
      { 1100485913;3 ;Action    ;
                      CaptionML=[ENU=Open Complaints;
                                 SVE=ôppna klagomÜl];
                      Image=Reminder;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"PM-S", "No.", TRUE);
                               END;
                                }
      { 1100485914;3 ;Action    ;
                      CaptionML=[ENU=Complaints;
                                 SVE=KlagomÜl];
                      Image=ReminderTerms;
                      OnAction=VAR
                                 lvComplDocRec@1100485001 : Record 11012457;
                                 lvComplMgtCU@1100485000 : Codeunit 11012418;
                               BEGIN
                                 lvComplMgtCU.ShowComplaintOnDocument(lvComplDocRec."Document Type"::"PM-S", "No.", FALSE);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100525001;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 SVE=Fu&nktioner] }
      { 1060000 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Electronic Credit Memo DK;
                      ToolTipML=[ENU=Create an electronic version of the current document.;
                                 SVE=Skapa en elektronisk version av detta dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=DKinfoEnable;
                      Image=ElectronicDoc;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesCrMemoHeader := Rec;
                                 SalesCrMemoHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Create DK Elec. Credit Memos", TRUE, FALSE, SalesCrMemoHeader);
                               END;
                                }
      { 1080021 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create NO Electronic Credit Memo;
                                 SVE=Skapa NO elektronisk kreditnot];
                      Visible=NORlocalizationEnable;
                      Image=CreateDocument;
                      OnAction=BEGIN
                                 SalesCrMemoHeader := Rec;
                                 SalesCrMemoHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Create NO Elec. Credit Memos", TRUE, FALSE, SalesCrMemoHeader);
                               END;
                                }
      { 1100528203;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send Credit Memo Electronically (with options);
                                 SVE=Skicka elektronisk faktura (med alternativ)];
                      Image=Export;
                      OnAction=BEGIN
                                 //**4PS DP00141
                                 CurrPage.UPDATE(TRUE);
                                 SendCreditMemoElectronic(TRUE,FALSE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 1100528201;2 ;Action    ;
                      CaptionML=[ENU=Send Credit Memo Electronically;
                                 SVE=Skicka elektronisk faktura];
                      Promoted=Yes;
                      Image=ElectronicDoc;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS DP00141
                                 CurrPage.UPDATE(TRUE);
                                 SendCreditMemoElectronic(FALSE,FALSE);
                                 CurrPage.UPDATE(FALSE);
                                 //**4PS.en
                               END;
                                }
      { 1100528701;2 ;Action    ;
                      CaptionML=[ENU=Edit Word Documents;
                                 SVE=Redigera Word-dokument];
                      Image=Word;
                      OnAction=VAR
                                 Contact@1100528700 : Record 5050;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Sell-to Customer No.");
                                 IF Contact.GetContactByCustomer("Sell-to Customer No.", Contact, TRUE) THEN
                                   EditDocuments(Contact."No.", '', FALSE, '');
                               END;
                                }
      { 1080020 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Electronic Credit Memo;
                                 NOR=Opprett elektronisk kreditnota;
                                 SVE=Skapa elektronisk kreditnot];
                      ToolTipML=NOR=Opprett ett eller flere XML-dokumenter som du kan sende til kunden. Du kan kjõre kjõrselen for flere kreditnotaer, eller du kan kjõre den for Çn kreditnota. Bilagsnummeret brukes som filnavn. Filene lagres pÜ lokasjonen som er angitt i vinduet Salgsoppsett.;
                      ApplicationArea=#Basic,#Suite;
                      Visible=NORlocalizationEnable;
                      Image=CreateDocument;
                      OnAction=BEGIN
                                 SalesCrMemoHeader := Rec;
                                 SalesCrMemoHeader.SETRECFILTER;
                                 REPORT.RUNMODAL(REPORT::"Create NO Elec. Credit Memos", TRUE, FALSE, SalesCrMemoHeader);
                               END;
                                }
      { 3       ;1   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Customer;
                                 NOR=Kunde;
                                 SVE=Kund];
                      ToolTipML=[ENU=View or edit detailed information about the customer.;
                                 NOR=Vis eller rediger detaljert informasjon om kunden.;
                                 SVE=Visa eller redigera detaljerad information om kunden.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Sell-to Customer No.);
                      Promoted=Yes;
                      Image=Customer;
                      PromotedCategory=Category6 }
      { 8       ;1   ;Action    ;
                      Name=SendCustom;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send;
                                 NOR=Send;
                                 SVE=Skicka];
                      ToolTipML=[ENU=Prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.;
                                 NOR=Klargjõr for Ü sende dokumentet i henhold til kundens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til Üpnes slik at du kan bekrefte eller velge en sendingsprofil.;
                                 SVE=Fîrbered att skicka dokumentet enligt kundens utskicksprofil, t.ex. som bilaga till ett e-postmeddelande. Fînstret Skicka dokument till îppnas fîrst sÜ att det gÜr att bekrÑfta eller vÑlja en utskicksprofil.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NewDocumentReportingVisible;
                      PromotedIsBig=Yes;
                      Image=SendToMultiple;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 SalesCrMemoHeader@1000 : Record 114;
                               BEGIN
                                 SalesCrMemoHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);
                                 SalesCrMemoHeader.SendRecords;
                               END;
                                }
      { 50      ;1   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut;
                                 SVE=Skriv &ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargjõr for Ü skrive ut dokumentet. Det vises et rapportforespõrselsvindu for dokumentet der du kan angi hva som skal inkluderes pÜ utskriften.;
                                 SVE=Fîrbered utskrift av dokumentet. Ett rapportfînster om dokumentet îppnas dÑr det gÜr att ange vad du vill inkludera pÜ utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 SalesCrMemoHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);
                                 SalesCrMemoHeader.PrintRecords(TRUE);
                               END;
                                }
      { 1100529600;1 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Incl. Attachment(s);
                                 SVE=Skriv ut inkl. bilagor];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 PrintCrMemoIncludingAttachments(FALSE);
                               END;
                                }
      { 11      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send by &Email;
                                 NOR=Send via &e-post;
                                 SVE=Skicka med &e-post];
                      ToolTipML=[ENU=Send the sales credit memo document as a PDF file attached to an email.;
                                 NOR=Send salgskreditnotadokumentet som en PDF-fil vedlagt i en e-postmelding.;
                                 SVE=Skicka fîrsÑljningskreditnotan som en PDF-fil bifogad i ett e-postmeddelande.];
                      ApplicationArea=#All;
                      Image=Email;
                      OnAction=BEGIN
                                 SalesCrMemoHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);
                                 SalesCrMemoHeader.EmailRecords(TRUE);
                               END;
                                }
      { 51      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger;
                                 SVE=Anal&ysera];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppfõringer og dokumenter som finnes for dokumentnummeret og bokfõringsdatoen i den valgte oppfõringen eller dokumentet.;
                                 SVE=Sîk efter alla transaktioner och dokument som existerar fîr dokumentnumret och bokfîringsdatumet fîr den valda transaktionen eller det valda dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 15      ;1   ;Action    ;
                      Name=ActivityLog;
                      CaptionML=[ENU=Activity Log;
                                 NOR=Aktivitetslogg;
                                 SVE=Aktivitetslogg];
                      ToolTipML=[ENU=View the status and any errors if the document was sent as an electronic document or OCR file through the document exchange service.;
                                 NOR=Vis statusen og eventuelle feilmeldinger hvis dokumentet ble sendt som et elektronisk dokument eller OCR-fil via dokumentutvekslingstjenesten.;
                                 SVE=Visa status och eventuella fel om dokumentet skickades som ett elektroniskt dokument eller som OCR-fil med dokumentutbytestjÑnsten.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Log;
                      OnAction=BEGIN
                                 ShowActivityLog;
                               END;
                                }
      { 39      ;1   ;ActionGroup;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Annullera] }
      { 35      ;2   ;Action    ;
                      Name=CancelCrMemo;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller;
                                 SVE=Annullera];
                      ToolTipML=[ENU=Create and post a sales invoice that reverses this posted sales credit memo. This posted sales credit memo will be canceled.;
                                 NOR=Opprett og bokfõr en salgsfaktura som tilbakefõrer denne bokfõrte salgskreditnotaen. Denne bokfõrte salgskreditnotaen vil bli annullert.;
                                 SVE=Skapa och bokfîr en fîrsÑljningsfaktura som Üterfîr den hÑr bokfîrda fîrsÑljningskreditnotan. Den bokfîrda fîrsÑljningskreditnotan gÜr inte att annullera.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsFoundationEnabled;
                      Enabled=SalesCorrectiveCrMemoExists;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Cancel PstdSalesCrM (Yes/No)",Rec);
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=ShowInvoice;
                      CaptionML=[ENU=Show Canceled/Corrective Invoice;
                                 NOR=Vis annullert/korrigerende faktura;
                                 SVE=Visa annullerad/korrigerande faktura];
                      ToolTipML=[ENU=Open the posted sales invoice that was created when you canceled the posted sales credit memo. If the posted sales credit memo is the result of a canceled sales invoice, then canceled invoice will open.;
                                 NOR=èpne den bokfõrte salgsfakturaen som ble opprettet da du kansellerte den bokfõrte salgskreditnotaen. Hvis den bokfõrte salgskreditnotaen er et resultat av den kansellerte salgsfakturaen, sÜ vil den kansellerte fakturaen bli Üpnet.;
                                 SVE=ôppna den bokfîrda fîrsÑljningsfakturan som skapades nÑr du annullerade den bokfîrda fîrsÑljningskreditnotan. Om den bokfîrda fîrsÑljningskreditnotan Ñr resultatet av en annullerad fîrsÑljningsfaktura, îppnas den annullerade fakturan.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsFoundationEnabled;
                      Enabled=Cancelled OR Corrective;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Category5;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrInvoice;
                               END;
                                }
      { 21      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=InngÜende dokument;
                                 SVE=Inkommande dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 23      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inngÜende dokument;
                                 SVE=Visa inkommande dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppfõringen eller dokumentet.;
                                 SVE=Visa alla poster med inkommande dokument och filbilagor som finns fîr transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inngÜende dokument;
                                 SVE=VÑlj inkommande dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppfõringen eller dokumentet.;
                                 SVE=VÑlj en post fîr inkommande dokument och en filbilaga som du vill koppla till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("No.","Posting Date",RECORDID);
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inngÜende dokument fra fil;
                                 SVE=Skapa inkommande dokument frÜn fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved Ü velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppfõringen eller dokumentet.;
                                 SVE=Skapa en post fîr inkommande dokument genom att vÑlja en fil att bifoga. Koppla sedan posten om det inkommande dokumentet till transaktionen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("No.","Posting Date");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt;
                           SVE=AllmÑnt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted credit memo number.;
                           NOR=Angir nummeret pÜ den bokfõrte kreditnotaen.;
                           SVE=Anger numret pÜ den bokfîrda kreditnotan.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 53  ;2   ;Field     ;
                CaptionML=[ENU=Customer;
                           NOR=Kunde;
                           SVE=Kund];
                ToolTipML=[ENU=Specifies the name of the customer that you shipped the items on the credit memo to.;
                           NOR=Angir navnet pÜ kunden som varene i kreditnotaen er levert til.;
                           SVE=Anger namnet pÜ kunden som du levererade kreditnotans artiklar till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name";
                TableRelation=Customer.Name;
                Editable=FALSE;
                ShowMandatory=TRUE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Sell-to;
                           NOR=Salg til;
                           SVE=Kund];
                GroupType=Group }

    { 55  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the customer that the items on the credit memo were sent to.;
                           NOR=Angir adressen til kunden som varene i kreditnotaen ble sendt til.;
                           SVE=Anger adressen till kunden som kreditnotans artiklar levererades till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 57  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 59  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the customer on the sales document.;
                           NOR=Angir bostedet for kunden pÜ salgsdokumentet.;
                           SVE=Anger kundens ort pÜ fîrsÑljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to City";
                Importance=Additional;
                Editable=FALSE }

    { 45  ;3   ;Group     ;
                Visible=IsSellToCountyVisible;
                GroupType=Group }

    { 32  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to County";
                Importance=Additional;
                Editable=FALSE }

    { 6   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 43  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           NOR=Lands-/omrÜdekode;
                           SVE=Lands-/regionkod];
                ToolTipML=[ENU=Specifies the country or region of the address.;
                           NOR=Angir landet eller omrÜdet i adressen.;
                           SVE=Anger adressens land eller region.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Country/Region Code";
                Importance=Additional;
                Editable=FALSE }

    { 95  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the contact at the customer who handles the credit memo.;
                           NOR=Angir nummeret til kontakten hos kunden som behandler kreditnotaen.;
                           SVE=Anger kontaktnumret till kunden som hanterar kreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 1210190005;2;Field  ;
                SourceExpr="Sell-to Customer Name 2";
                Importance=Additional;
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact when you communicate with the customer who you shipped the items on the credit memo to.;
                           NOR=Angir navnet pÜ personen du kontakter nÜr du kommuniserer med kunden som varene i kreditnotaen er sendt til.;
                           SVE=Anger namnet pÜ kontaktpersonen hos kunden nÑr du meddelar kunden som du levererade artiklarna pÜ kreditnotan till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact";
                Editable=FALSE }

    { 1060006;2;Field     ;
                ToolTipML=ENU="Specifies the telephone number of the contact person at the customer. ";
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact Phone No.";
                Visible=DKinfoEnable;
                Editable=FALSE }

    { 1060002;2;Field     ;
                ToolTipML=ENU="Specifies the fax number of the contact person at the customer. ";
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact Fax No.";
                Visible=DKinfoEnable;
                Editable=FALSE }

    { 1060009;2;Field     ;
                ToolTipML=[ENU="Specifies the email address of the contact person at the customer. ";
                           SVE=Anger den ursprungliga fakturan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact E-Mail";
                Visible=DKinfoEnable;
                Editable=FALSE }

    { 1060004;2;Field     ;
                ToolTipML=ENU="Specifies the role of the contact person at the customer. ";
                SourceExpr="Sell-to Contact Role";
                Visible=DKinfoEnable;
                Editable=FALSE }

    { 1100485016;2;Field  ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Your Reference";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the credit memo was posted.;
                           NOR=Angir datoen da kreditnotaen ble bokfõrt.;
                           SVE=Anger datumet dÜ kreditnotan bokfîrdes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which you created the sales document.;
                           NOR=Angir datoen da du opprettet salgsdokumentet.;
                           SVE=Anger datumet dÜ du skapade fîrsÑljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                Editable=FALSE }

    { 20  ;2   ;Group     ;
                Visible=DocExchStatusVisible;
                GroupType=Group }

    { 25  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the document if you are using a document exchange service to send it as an electronic document. The status values are reported by the document exchange service.;
                           NOR=Angir statusen for dokumentet hvis du bruker en dokumentutvekslingstjeneste til Ü sende den som et elektronisk dokument. Statusverdiene rapporteres av dokumentutvekslingstjenesten.;
                           SVE=Anger dokumentets status om du anvÑnder en dokumentutbytestjÑnst till att skicka det som ett elektroniskt dokument. StatusvÑrdena rapporteras av dokumentutbytestjÑnsten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Exchange Status";
                Editable=FALSE;
                StyleExpr=DocExchStatusStyle;
                OnDrillDown=VAR
                              DocExchServDocStatus@1000 : Codeunit 1420;
                            BEGIN
                              DocExchServDocStatus.DocExchStatusDrillDown(Rec);
                            END;
                             }

    { 65  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the credit memo that the posted credit memo was created from.;
                           NOR=Angir nummeret pÜ kreditnotaen som den bokfõrte kreditnotaen ble opprettet fra.;
                           SVE=Anger numret pÜ kreditnotan frÜn vilken den bokfîrda kreditnotan skapades.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pre-Assigned No.";
                Importance=Additional;
                Editable=FALSE }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the external document number that is entered on the sales header that this line was posted from.;
                           NOR=Angir det eksterne dokumentnummeret som er angitt i salgshodet som denne linjen ble bokfõrt fra.;
                           SVE=Anger det externa dokumentnumret i fîrsÑljningshuvudet som den hÑr raden bokfîrdes frÜn.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Importance=Promoted;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which salesperson is associated with the credit memo.;
                           NOR=Angir hvilken selger som er knyttet til kreditnotaen.;
                           SVE=Anger vilken sÑljare som Ñr knuten till kreditnotan.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Importance=Additional;
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the responsibility center that serves the customer on this sales document.;
                           NOR=Angir koden for ansvarssenteret som betjener kunden pÜ dette salgsdokumentet.;
                           SVE=Anger koden fîr ansvarsenheten som ansvarar fîr kunden i det hÑr fîrsÑljningsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice that relates to this sales credit memo has been either corrected or canceled.;
                           NOR=Angir om den bokfõrte salgsfakturaen som er knyttet til denne salgskreditnotaen, er blitt korrigert eller kansellert.;
                           SVE=Anger om den bokfîrda fîrsÑljningsfakturan relaterad till den hÑr fîrsÑljningskreditnotan har korrigerats eller avbrutits.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveInvoice;
                            END;
                             }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice has been either corrected or canceled by this sales credit memo.;
                           NOR=Angir om den bokfõrte salgsfakturaen har blitt korrigert eller kansellert av denne salgskreditnotaen.;
                           SVE=Anger om den bokfîrda fîrsÑljningsfakturan har rÑttats eller annullerats med den hÑr fîrsÑljningskreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledInvoice;
                            END;
                             }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the document has been printed.;
                           NOR=Angir hvor mange ganger dokumentet har blitt skrevet ut.;
                           SVE=Anger hur mÜnga gÜnger dokumentet har skrivits ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed";
                Importance=Additional;
                Editable=FALSE }

    { 63  ;2   ;Group     ;
                CaptionML=[ENU=Work Description;
                           NOR=Arbeidsbeskrivelse;
                           SVE=Arbetsbeskrivning];
                GroupType=Group }

    { 62  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the products or services being offered.;
                           NOR=Angir produktene eller tjenestene som tilbys.;
                           SVE=Anger erbjudna produkter eller tjÑnster.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetWorkDescription;
                Importance=Additional;
                Editable=FALSE;
                MultiLine=Yes;
                ShowCaption=No }

    { 1101200000;2;Field  ;
                SourceExpr="Job No.";
                Editable=FALSE }

    { 1100485030;2;Field  ;
                SourceExpr="Reason Code";
                Editable=FALSE }

    { 1100528000;2;Field  ;
                SourceExpr="Return Order No." }

    { 46  ;1   ;Part      ;
                Name=SalesCrMemoLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page135 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer;
                           SVE=Fakturadetaljer];
                GroupType=Group }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code of the credit memo.;
                           NOR=Angir valutakoden for kreditnotaen.;
                           SVE=Anger kreditnotans valutakod.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=VAR
                               UpdateCurrencyFactor@1000 : Codeunit 325;
                             BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.SetAdditionalParameters(1, "Job No.", TRUE); //**4PS.n
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 UpdateCurrencyFactor.ModifyPostedSalesCreditMemo(Rec);
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 1, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 1, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Importance=Additional;
                Editable=FALSE;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                           NOR=Angir koden til Snarveisdimensjon 2, som er Çn av to globale dimensjonskoder som du har definert i vinduet Finansoppsett.;
                           SVE=Anger koden fîr GenvÑg dimension 2, som Ñr en av tvÜ globala dimensionskoder som du stÑller in i fînstret RedovisningsinstÑllningar.];
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Importance=Additional;
                Editable=FALSE;
                LookupPageID=Cost Object List }

    { 1100525002;2;Field  ;
                SourceExpr="Invoice Layout Code" }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir typen bokfõrt dokument som dette dokumentet eller denne kladdelinjen blir utlignet til nÜr du bokfõrer, for eksempel for Ü registrere utbetaling.;
                           SVE=Anger typen fîr det bokfîrda dokument som den hÑr dokument- eller journalraden tillÑmpas pÜ nÑr du bokfîr, t.ex. fîr att registrera en betalning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. Type";
                Importance=Promoted;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir nummeret for det bokfõrte dokumentet som dette dokumentet eller denne kladdelinjen blir utlignet til nÜr du bokfõrer, for eksempel for Ü registrere utbetaling.;
                           SVE=Anger numret pÜ det bokfîrda dokument som den hÑr dokument- eller journalraden tillÑmpas pÜ nÑr du bokfîr, t.ex. fîr att registrera en betalning.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. No.";
                Importance=Promoted;
                Editable=FALSE }

    { 282 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's method of payment. The program has copied the code from the Payment Method Code field on the sales header.;
                           NOR=Angir kundens betalingsmÜte. Programmet har overfõrt koden fra feltet BetalingsmÜte - kode i salgshodet.;
                           SVE=Anger kundens betalningssÑtt. Programmet kopierade koden frÜn fÑltet BetalningssÑtt i fîrsÑljningshuvudet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Editable=FALSE }

    { 1100528702;2;Field  ;
                SourceExpr="E-Mail (Invoices)" }

    { 1100528703;2;Field  ;
                SourceExpr="Electronic Invoicing" }

    { 1100528700;2;Field  ;
                SourceExpr="Combine E-Mail Attachments" }

    { 1210190012;2;Field  ;
                SourceExpr="Interest Date";
                Importance=Additional;
                Visible="Interest DateVisible";
                Editable=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice was part of an EU 3-party trade transaction.;
                           NOR=Angir om fakturaen er en del av en trekanthandel.;
                           SVE=Anger om fakturan ingick i en EU-trepartshandel.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="EU 3-Party Trade";
                Editable=FALSE }

    { 111280001;2;Field   ;
                SourceExpr="Inserted By";
                Editable=False }

    { 111280000;2;Field   ;
                SourceExpr="User ID";
                Editable=False }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Billing;
                           NOR=Levering og fakturering;
                           SVE=Leverans och fakturering];
                GroupType=Group }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location where the credit memo was registered.;
                           NOR=Angir hvilken lokasjon kreditnotaen er registrert pÜ.;
                           SVE=Anger lagerstÑllet dÑr kreditnotan registrerades.];
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable=FALSE }

    { 1100528705;2;Field  ;
                SourceExpr="E-Mail Sent by" }

    { 1100528704;2;Field  ;
                SourceExpr="E-Mail Sent on" }

    { 5   ;2   ;Group     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til;
                           SVE=Leverans];
                GroupType=Group }

    { 34  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the customer that the items were shipped to.;
                           NOR=Angir navnet pÜ kunden som varene ble levert til.;
                           SVE=Anger namnet pÜ kunden som artiklarna levererades till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 1210190009;3;Field  ;
                SourceExpr="Ship-to Name 2";
                Importance=Additional;
                Editable=FALSE }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address that the items were shipped to.;
                           NOR=Angir adressen som varene ble levert til.;
                           SVE=Anger adressen som artiklarna levererades till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Importance=Promoted;
                Editable=FALSE }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the customer on the sales document.;
                           NOR=Angir bostedet for kunden pÜ salgsdokumentet.;
                           SVE=Anger kundens ort pÜ fîrsÑljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 48  ;3   ;Group     ;
                Visible=IsShipToCountyVisible;
                GroupType=Group }

    { 52  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 54  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the address.;
                           NOR=Angir landet eller omrÜdet i adressen.;
                           SVE=Anger adressens land eller region.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person you regularly contact at the customer to whom the items were shipped.;
                           NOR=Angir navnet pÜ kontaktpersonen hos kunden som varene er sendt til.;
                           SVE=Anger namnet pÜ den vanliga kontaktpersonen hos kunden som artiklarna levererades till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 27  ;2   ;Group     ;
                CaptionML=[ENU=Bill-to;
                           NOR=Faktura til;
                           SVE=Faktureras];
                GroupType=Group }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn;
                           SVE=Namn];
                ToolTipML=[ENU=Specifies the name of the customer that the credit memo was sent to.;
                           NOR=Angir navnet pÜ kunden som kreditnotaen ble sendt til.;
                           SVE=Anger namnet pÜ kunden som kreditnotan skickades till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 1210190007;3;Field  ;
                SourceExpr="Bill-to Name 2";
                Importance=Additional;
                Editable=FALSE }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse;
                           SVE=Adress];
                ToolTipML=[ENU=Specifies the address of the customer that the credit memo was sent to.;
                           NOR=Angir adressen til kunden som kreditnotaen ble sendt til.;
                           SVE=Anger adressen till kunden som kreditnotan skickades till.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2;
                           SVE=Adress 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.;
                           SVE=Anger ytterligare adressuppgifter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted;
                           SVE=Ort];
                ToolTipML=[ENU=Specifies the city of the customer on the sales document.;
                           NOR=Angir bostedet for kunden pÜ salgsdokumentet.;
                           SVE=Anger kundens ort pÜ fîrsÑljningsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to City";
                Importance=Additional;
                Editable=FALSE }

    { 60  ;3   ;Group     ;
                Visible=IsBillToCountyVisible;
                GroupType=Group }

    { 56  ;4   ;Field     ;
                CaptionML=[ENU=County;
                           NOR=Fylke/delstat;
                           SVE=LÑn];
                ToolTipML=[ENU=Specifies the state, province or county as a part of the address.;
                           NOR=Angir delstat, omrÜde eller fylke som en del av adressen.;
                           SVE=Anger delstat, region eller lÑn som del av adressen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to County";
                Importance=Additional;
                Editable=FALSE }

    { 70  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.;
                           SVE=Postnr];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.;
                           SVE=Anger postnumret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 58  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omrÜde;
                           SVE=Land/region];
                ToolTipML=[ENU=Specifies the country or region of the address.;
                           NOR=Angir landet eller omrÜdet i adressen.;
                           SVE=Anger adressens land eller region.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Country/Region Code";
                Importance=Additional;
                Editable=FALSE }

    { 97  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.;
                           SVE=Kontaktnr];
                ToolTipML=[ENU=Specifies the number of the contact at the customer who handles the credit memo.;
                           NOR=Angir nummeret til kontakten hos kunden som behandler kreditnotaen.;
                           SVE=Anger kontaktnumret till kunden som hanterar kreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt;
                           SVE=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person you regularly contact when you communicate with the customer to whom the credit memo was sent.;
                           NOR=Angir navnet pÜ personen du vanligvis kontakter nÜr du kommuniserer med kunden som kreditnotaen er sendt til.;
                           SVE=Anger namnet pÜ kontaktpersonen hos kunden till vilken du skickade kreditnotan.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact";
                Editable=FALSE }

    { 1100525000;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           SVE=Utlandshandel] }

    { 1210190001;2;Field  ;
                SourceExpr="VAT Registration No.";
                Editable=FALSE }

    { 1060011;2;Field     ;
                ToolTipML=ENU=Specifies the EAN location number for the customer, based on the EAN No. field in the relevant sales return order or sales credit memo.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="EAN No.";
                Visible=DKinfoEnable;
                Editable=FALSE }

    { 1060013;2;Field     ;
                ToolTipML=ENU="Specifies the account code of the customer who you will send the credit memo to. ";
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Code DK";
                Visible=DKinfoEnable;
                Editable=FALSE }

    { 1060001;2;Field     ;
                ToolTipML=ENU=Specifies the profile that this customer requires for electronic documents.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OIOUBL Profile Code";
                Visible=DKinfoEnable;
                Editable=FALSE }

    { 1080006;2;Field     ;
                ToolTipML=[ENU=Specifies the global location number for the customer.;
                           NOR=Angir det globale lokasjonsnummeret for kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GLN;
                Visible=NORlocalizationEnable;
                Editable=FALSE }

    { 1080013;2;Field     ;
                ToolTipML=[ENU=Specifies the account code of the customer who you will send the credit memo to.;
                           NOR=Angir kontokoden for kunden du skal sende kreditnotaen til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Code NO";
                Visible=NORlocalizationEnable;
                Editable=FALSE }

    { 1080012;2;Field     ;
                ToolTipML=[ENU=Specifies whether the customer is part of the EHF system and requires an electronic sales credit memo.;
                           NOR=Angir om kunden er en del av EHF-systemet og krever en elektronisk salgskreditnota.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Invoice";
                Visible=NORlocalizationEnable;
                Editable=FALSE }

    { 1080018;2;Field     ;
                ToolTipML=[ENU=Specifies whether an electronic sales credit memo has been created and copied to the location specified in Sales & Receivables Setup window.;
                           NOR=Angir om en elektronisk salgskreditnota har blitt opprettet og kopiert til lokasjonen som er angitt i vinduet Salgsoppsett.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Invoice Created";
                Visible=NORlocalizationEnable;
                Editable=FALSE }

    { 1100485035;2;Field  ;
                SourceExpr="Company VAT Registration No." }

    { 1100485033;2;Field  ;
                SourceExpr="Country/Region of Origin" }

    { 1100485029;2;Field  ;
                SourceExpr="Country/Region of Destination" }

    { 1904865501;1;Group  ;
                CaptionML=[ENU=Credit Memo Text;
                           SVE=Kreditnotatext] }

    { 1000000000;2;Field  ;
                SourceExpr="Credit Memo Text";
                Editable=FALSE;
                MultiLine=Yes }

    { 1100485018;2;Field  ;
                SourceExpr="Principal Reference";
                Importance=Promoted;
                Editable=FALSE }

    { 1100485020;2;Field  ;
                SourceExpr="Order No. Customer";
                Importance=Promoted;
                Editable=FALSE }

    { 1100528401;2;Field  ;
                SourceExpr="Commision Date Customer";
                Editable=FALSE }

    { 1902686201;1;Group  ;
                CaptionML=[ENU=WKA;
                           SVE=WKA] }

    { 1100485008;2;Field  ;
                SourceExpr="Specific WKA Percentages";
                Editable=FALSE;
                OnValidate=BEGIN
                             SpecificWKAPercentagesOnAfterV;
                           END;
                            }

    { 1100485006;2;Field  ;
                SourceExpr="% Labor";
                Importance=Promoted;
                Editable=FALSE }

    { 1100485004;2;Field  ;
                SourceExpr="% to B Account";
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1100485012;2;Field  ;
                SourceExpr="WKA Period";
                Editable=FALSE }

    { 1100485001;2;Field  ;
                SourceExpr="Labor Amount (Subcontracting)";
                Editable=FALSE }

    { 1100485000;2;Field  ;
                SourceExpr="Blocked Amount (Subcontracting";
                Editable=FALSE }

    { 1100485010;2;Field  ;
                SourceExpr="Calculate B Amounts based on";
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 41  ;1   ;Part      ;
                Name=Attached Documents;
                CaptionML=[ENU=Attachments;
                           NOR=Vedlegg;
                           SVE=Bilagor];
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(114),
                            No.=FIELD(No.);
                PagePartID=Page1174;
                PartType=Page }

    { 13  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190006;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130206;
                PartType=Page }

    { 1900383207;1;Part   ;
                ApplicationArea=#RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#Notes;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesCrMemoHeader@1000 : Record 114;
      ApplicationAreaMgmtFacade@1006 : Codeunit 9179;
      FormatAddress@1012 : Codeunit 365;
      ChangeExchangeRate@1001 : Page 511;
      HasIncomingDocument@1002 : Boolean;
      DocExchStatusStyle@1003 : Text;
      DocExchStatusVisible@1004 : Boolean;
      IsOfficeAddin@1005 : Boolean;
      IsFoundationEnabled@1007 : Boolean;
      SalesCorrectiveCrMemoExists@1008 : Boolean;
      IsBillToCountyVisible@1011 : Boolean;
      IsSellToCountyVisible@1010 : Boolean;
      IsShipToCountyVisible@1009 : Boolean;
      DPA_IsHardFilter@1100000999 : Boolean;
      "Interest DateVisible"@19029017 : Boolean INDATASET;
      NewDocumentReportingVisible@1100528400 : Boolean INDATASET;
      GLSetup@1101285000 : Record 98;
      DKinfoEnable@1101285001 : Boolean INDATASET;
      NORlocalizationEnable@1101285002 : Boolean INDATASET;

    LOCAL PROCEDURE ActivateFields@11();
    BEGIN
      IsBillToCountyVisible := FormatAddress.UseCounty("Bill-to Country/Region Code");
      IsSellToCountyVisible := FormatAddress.UseCounty("Sell-to Country/Region Code");
      IsShipToCountyVisible := FormatAddress.UseCounty("Ship-to Country/Region Code");
    END;

    LOCAL PROCEDURE SpecificWKAPercentagesOnAfterV@19002606();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
    END;

    BEGIN
    {
      4PS 24-09-2009 PS, Approval removed
    }
    END.
  }
}

