OBJECT Table 11128270 Prognosis Line CC
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSSE,SEEV.CC.I005,4PS-001;
  }
  PROPERTIES
  {
    Permissions=TableData 11072003=rm;
    OnInsert=BEGIN
               //>> 151022 ITERO.SB RFC-010
               IF PrognosisRec.GET("Project No.", "Prognosis Date") THEN
                 PrognosisRec.CheckProjectPreclosure();
               //<<

               ProjRec.GET("Project No.");
               "Main Project No." := ProjRec."Main Project";
               UpdateCostControlStatus(UpdateAction::Insert);
             END;

    OnModify=VAR
               CostComponent@1100285500 : Record 11012012;
             BEGIN
               //>> 151022 ITERO.SB RFC-010
               IF PrognosisRec.GET("Project No.", "Prognosis Date") THEN
                 PrognosisRec.CheckProjectPreclosure();
               //<<
               //>>ENH-011
               IF ("Cost Component Code" <> '') AND ("Cost Component Code" <> xRec."Cost Component Code") THEN BEGIN
                 IF CostComponent.GET("Cost Component Code") THEN
                   "Cost Type" := CostComponent."Cost Type"-1;
               END;
               //<<ENH-011

               UpdateCostControlStatus(UpdateAction::Modify);
               PrognosisRec.UpdateLogBook("Project No.", "Prognosis Date"); //mg, 10-12-10: M24403
             END;

    OnDelete=VAR
               PrognosisLineSpec@1210190000 : Record 11020687;
             BEGIN
               //db.sn, 04-01-11: M24105
               IF PrognosisRec.GET("Project No.", "Prognosis Date") THEN BEGIN
                 PrognosisRec.TESTFIELD(Fixed,FALSE);
               //db.en, 04-01-11: M24105
                 //>> 151022 ITERO.SB RFC-010
                 PrognosisRec.CheckProjectPreclosure();
                 //<<
               END;
               UpdateCostControlStatus(UpdateAction::Delete);
               PrognosisRec.UpdateLogBook("Project No.", "Prognosis Date"); //mg, 10-12-10: M24403

               { ***
               //DP00042.sn
               PrognosisLineSpec.SETRANGE("Project No.", "Project No.");
               PrognosisLineSpec.SETRANGE("Prognosis Date", "Prognosis Date");
               IF Element = '' THEN  //db, 15-11-11
                 PrognosisLineSpec.SETFILTER(Element, '%1', '')
               ELSE
                 PrognosisLineSpec.SETRANGE(Element, Element);
               PrognosisLineSpec.SETRANGE("Cost Type", "Cost Type");
               PrognosisLineSpec.SETRANGE("Cost Object", "Cost Object");
               PrognosisLineSpec.DELETEALL;
               //DP00042.en
               *** }
             END;

    CaptionML=[ENU=Prognosis Line (Cost Component);
               NOR=Prognoserad (kostnadskomponent);
               SVE=Prognosrad (kostnadskomponent)];
  }
  FIELDS
  {
    { 10  ;   ;Project No.         ;Code20        ;TableRelation=Job.No.;
                                                   CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr;
                                                              SVE=Projektnr] }
    { 20  ;   ;Prognosis Date      ;Date          ;OnValidate=VAR
                                                                lPrognosisRec@1100525000 : Record 11012034;
                                                              BEGIN
                                                                PrevPrognDateFilter := '<'+FORMAT("Prognosis Date");
                                                                //**Call 19910 Exact filter for previous prognosis wanted.
                                                                IF lPrognosisRec.GET("Project No.", "Prognosis Date") THEN BEGIN
                                                                  lPrognosisRec.RESET;
                                                                  lPrognosisRec.SETRANGE("Project No.", "Project No.");
                                                                  lPrognosisRec.SETFILTER("Prognosis Date", '<%1', "Prognosis Date");
                                                                  IF lPrognosisRec.FINDLAST THEN BEGIN
                                                                    PrevPrognDateFilter := FORMAT(lPrognosisRec."Prognosis Date");
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Date;
                                                              NOR=Prognosedato;
                                                              SVE=Prognosdatum] }
    { 30  ;   ;Cost Type           ;Option        ;CaptionML=[ENU=Cost Type;
                                                              NOR=Kostnadstype;
                                                              SVE=Kostnadstyp];
                                                   OptionCaptionML=[ENU=Labor,Material,Subcontracting,Plant,Sundry,Revenue;
                                                                    NOR=Arbeidskraft,Materiale,Underentrepen›r,Maskin,Diverse,Inntekt;
                                                                    SVE=Arbetskraft,Material,Underentreprenad,Maskin,Diverse,Int„kt];
                                                   OptionString=Labor,Material,Subcontracting,Plant,Sundry,Revenue;
                                                   Editable=No }
    { 40  ;   ;Cost Component Code ;Code20        ;TableRelation="Cost Component";
                                                   OnValidate=VAR
                                                                CostComponent@1100285500 : Record 11012012;
                                                              BEGIN
                                                                CALCFIELDS("Cost Component Description");

                                                                //>>ENH-011
                                                                IF ("Cost Component Code" <> '') AND ("Cost Component Code" <> xRec."Cost Component Code") THEN BEGIN
                                                                  IF CostComponent.GET("Cost Component Code") THEN
                                                                    "Cost Type" := CostComponent."Cost Type"-1;
                                                                END;
                                                                //<<ENH-011
                                                              END;

                                                   CaptionML=[ENU=Cost Component Code;
                                                              NOR=Kostnadskomponentkode;
                                                              SVE=Kostnadskomponentkod] }
    { 41  ;   ;Cost Component Description;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Cost Component".Description WHERE (Code=FIELD(Cost Component Code)));
                                                   CaptionML=[ENU=Cost Component Description;
                                                              NOR=Kostnadskomponent, Beskrivelse;
                                                              SVE=Kostnadsdel, beskrivning];
                                                   Editable=No }
    { 50  ;   ;Quantity            ;Decimal       ;OnValidate=BEGIN
                                                                CheckSurchargesCalculated;
                                                                CalculateAmount;
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall;
                                                              SVE=Antal];
                                                   DecimalPlaces=0:5 }
    { 55  ;   ;Prognosis Hours     ;Decimal       ;OnValidate=BEGIN
                                                                //>>ENH-011
                                                                IF ("Cost Type" = "Cost Type"::Labor) AND ("Actual Hours"<>0) THEN
                                                                  "Prognosis Costs" := "Prognosis Hours" * ("Actual Costs"/"Actual Hours");
                                                                VALIDATE("Prognosis Costs");  //ENH-011
                                                                //<<ENH-011
                                                              END;

                                                   CaptionML=[ENU=Prognosis Hours;
                                                              NOR="Timer ";
                                                              SVE=Prognostimmar] }
    { 60  ;   ;Price               ;Decimal       ;OnValidate=BEGIN
                                                                CheckSurchargesCalculated;
                                                                CalculateAmount;
                                                              END;

                                                   CaptionML=[ENU=Price;
                                                              NOR=Pris;
                                                              SVE=Pris];
                                                   AutoFormatType=2 }
    { 70  ;   ;Amount incl. Surcharge;Decimal     ;OnValidate=VAR
                                                                lvRate@1100525000 : Decimal;
                                                              BEGIN
                                                                CalculateRateOrQuantity;
                                                                CalculatePrognosisFields;

                                                                "Prognosis Costs" := "Amount incl. Surcharge" - "Ovh. Surcharge" - "Overhead Surch. Progn. Costs";
                                                              END;

                                                   CaptionML=[ENU=Amount incl. Ovh. Surcharge;
                                                              NOR=Bel›p inkludert overheadkost;
                                                              SVE=Belopp inkl. overheadkostnad];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 73  ;   ;Prognosis Costs     ;Decimal       ;OnValidate=BEGIN
                                                                CheckSurchargesCalculated;
                                                                VALIDATE("Amount incl. Surcharge", "Prognosis Costs" + "Ovh. Surcharge" + "Overhead Surch. Progn. Costs");

                                                                //>>4PSSE, DL 131001
                                                                IF Quantity <>0 THEN
                                                                  Price := "Prognosis Costs" / Quantity;
                                                                //<<4PSSE

                                                                //>>ENH-011
                                                                //IF ("Cost Type" = "Cost Type"::Labor) AND ("Actual Hours"<>0) AND ("Actual Costs"<>0) THEN
                                                                //  "Prognosis Hours" := "Prognosis Costs" / ("Actual Costs"/"Actual Hours");
                                                                //<<ENH-011
                                                              END;

                                                   CaptionML=[ENU=Prognosis Costs;
                                                              NOR=Kostprognose;
                                                              SVE=Prognos †terst†ende kostnader];
                                                   AutoFormatType=1 }
    { 75  ;   ;Ovh. Surcharge      ;Decimal       ;CaptionML=[ENU=Ovh. Surch. prognosis;
                                                              NOR=Overhead Kostprognose;
                                                              SVE=Overheadkostnadsprognos];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 80  ;No ;Element             ;Code20        ;TableRelation="Project Element".Element WHERE (Project No.=FIELD(Project No.));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Element;
                                                              NOR=Element;
                                                              SVE=Element] }
    { 81  ;   ;Level               ;Integer       ;CaptionML=[ENU=Level;
                                                              NOR=Niv†;
                                                              SVE=Niv†];
                                                   Editable=No }
    { 82  ;   ;Chapter             ;Code20        ;CaptionML=[ENU=Chapter;
                                                              NOR=Kapittel;
                                                              SVE=Kapitel];
                                                   Editable=No }
    { 83  ;   ;Paragraph           ;Code20        ;CaptionML=[ENU=Paragraph;
                                                              NOR=Avsnitt;
                                                              SVE=Stycke];
                                                   Editable=No }
    { 84  ;   ;Revenue             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Dimension Value" WHERE (Cost Type=CONST(Revenue),
                                                                                              Cost Component=FIELD(Cost Component Code)));
                                                   CaptionML=[ENU=Revenue;
                                                              NOR=Inntekter;
                                                              SVE=Int„kter];
                                                   Description=IMSE-005;
                                                   Editable=No }
    { 85  ;No ;Element Description ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Project Element".Description WHERE (Project No.=FIELD(Project No.),
                                                                                                           Element=FIELD(Element)));
                                                   CaptionML=[ENU=Element Description;
                                                              NOR=Elementbeskrivelse;
                                                              SVE=Elementbeskrivning];
                                                   Editable=No }
    { 90  ;   ;Unit Cost Object    ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Unit Cost Object;
                                                              NOR=Enhet for kostnadsobjekt;
                                                              SVE=Enhet f”r kostnadsobjekt] }
    { 100 ;   ;Unit of Measure     ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Unit of Measure;
                                                              NOR=M†leenhet;
                                                              SVE=Enhet] }
    { 110 ;   ;Rate Code           ;Code10        ;TableRelation="Budget Rate".Code WHERE (Project Filter=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                CheckSurchargesCalculated;
                                                                Rate := 0;
                                                                IF NOT RateRec.ProjectRate("Project No.", "Rate Code", "Prognosis Date", Rate) THEN BEGIN
                                                                  IF RateRec.StandardRate("Rate Code", "Prognosis Date", Rate) THEN;
                                                                END;
                                                                CalculateAmount;
                                                              END;

                                                   CaptionML=[ENU=Rate Code;
                                                              NOR=Avgiftskode;
                                                              SVE=Avgiftskod] }
    { 120 ;   ;Rate                ;Decimal       ;OnValidate=BEGIN
                                                                CheckSurchargesCalculated;
                                                                CalculateAmount;
                                                              END;

                                                   CaptionML=[ENU=Rate;
                                                              NOR=Avgift;
                                                              SVE=Avgift];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 130 ;   ;PrevPrognDateFilter ;Text30        ;CaptionML=[ENU=PrevPrognDateFilter;
                                                              NOR=PrevPrognDateFilter;
                                                              SVE=PrevPrognDateFilter];
                                                   Editable=No }
    { 140 ;   ;Previous Date       ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Max("Prognosis Line CC"."Prognosis Date" WHERE (Project No.=FIELD(Project No.),
                                                                                                               Cost Component Code=FIELD(Cost Component Code),
                                                                                                               Prognosis Date=FIELD(UPPERLIMIT(FILTER(PrevPrognDateFilter)))));
                                                   CaptionML=[ENU=Previous Date;
                                                              NOR=Forrige dato;
                                                              SVE=F”reg†ende datum];
                                                   Editable=No }
    { 150 ;   ;Previous Prognosis  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Prognosis Line CC"."Amount incl. Surcharge" WHERE (Project No.=FIELD(Project No.),
                                                                                                                          Prognosis Date=FIELD(Previous Date),
                                                                                                                          Cost Component Code=FIELD(Cost Component Code)));
                                                   CaptionML=[ENU=Previous Prognosis;
                                                              NOR=Forrige prognose;
                                                              SVE=F”reg†ende prognos];
                                                   Editable=No }
    { 155 ;   ;Fix Prognosis Line  ;Boolean       ;CaptionML=[ENU=Fix Prognosis Line;
                                                              NOR=Handlingsprognoserad;
                                                              SVE=tg„rdsprognosrad];
                                                   Editable=No }
    { 160 ;   ;Budget Amount       ;Decimal       ;CaptionML=[ENU=Budget Amount;
                                                              NOR=Budsjettbel›p;
                                                              SVE=Budgetbelopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 165 ;   ;Budget Surcharge Amount;Decimal    ;CaptionML=[ENU=Budget Overhead Surcharge Amount;
                                                              NOR=Budsjett overheadskost, bel›p;
                                                              SVE=Budgetoverheadskostnad, belopp];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 170 ;   ;Budget Hours        ;Decimal       ;CaptionML=[ENU=Budget Hours;
                                                              NOR=Budsjett (Timer);
                                                              SVE=Budget (timmar)];
                                                   Editable=No }
    { 180 ;   ;Actual Costs        ;Decimal       ;CaptionML=[ENU=Actual Costs;
                                                              NOR=Faktiske kostnader;
                                                              SVE=Verkliga kostnader];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 190 ;   ;Actual Hours        ;Decimal       ;CaptionML=[ENU=Actual Hours;
                                                              NOR=Reelle timer;
                                                              SVE=Verkliga timmar];
                                                   Editable=No }
    { 200 ;   ;Open (Purchase)     ;Decimal       ;CaptionML=[ENU=Open (Purchase);
                                                              NOR=pne innkj›p;
                                                              SVE=™ppna ink”p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 210 ;   ;Received/Not Invoiced;Decimal      ;CaptionML=[ENU=Received/Not Invoiced;
                                                              NOR=Mottatt/ikke fakturert;
                                                              SVE=Mottaget/inte fakturerat];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 211 ;   ;Open Ovh. Surch. (Purchase);Decimal;CaptionML=[ENU=Open Ovh. Surch. (Purchase);
                                                              NOR=pne Overheadkost (innkj›p);
                                                              SVE=™ppen overheadkostnad (ink”p)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 215 ;   ;Open Amount (Hours) ;Decimal       ;CaptionML=[ENU=Open Amount (Hours);
                                                              NOR=pne bel›p (Timer);
                                                              SVE=™ppna belopp (timmar)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 216 ;   ;Open Hours          ;Decimal       ;CaptionML=[ENU=Open Hours;
                                                              NOR=pne timer;
                                                              SVE=™ppna timmar];
                                                   Editable=No }
    { 217 ;   ;Open Ovh. Surch. (Hours);Decimal   ;CaptionML=[ENU=Open Ovh. Surch. (Hours);
                                                              NOR=pen tilleggsgebyr for overhead (Timer);
                                                              SVE=™ppen overheadkostnad (timmar)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 218 ;   ;Open (Inventory)    ;Decimal       ;CaptionML=[ENU=Open (Inventory);
                                                              NOR=pne (lager);
                                                              SVE=™ppna (lager)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 219 ;   ;Open Ovh. Surch. (Inventory);Decimal;
                                                   CaptionML=[ENU=Open Ovh. Surch. (Inventory);
                                                              NOR=pen overheadkost (lager);
                                                              SVE=™ppen overheadkostnad (lager)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 220 ;   ;Allowed Costs       ;Decimal       ;CaptionML=[ENU=Allowed Costs;
                                                              NOR=Tillatte koster;
                                                              SVE=Till†tna kostnader];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 230 ;   ;Allowed Hours       ;Decimal       ;CaptionML=[ENU=Allowed Hours;
                                                              NOR=Tillatte timer;
                                                              SVE=Till†tna timmar];
                                                   Editable=No }
    { 240 ;   ;Prognosis End Result;Decimal       ;OnValidate=BEGIN
                                                                CheckSurchargesCalculated;
                                                                "Amount incl. Surcharge" := "Budget Amount" - "Total Cost" - "Prognosis End Result";
                                                                "Prognosis Costs" := "Amount incl. Surcharge" - "Ovh. Surcharge" - "Overhead Surch. Progn. Costs";
                                                                //>>4PS-001
                                                                //"Prognosis Total Cost" := "Amount incl. Surcharge" + "Total Cost";
                                                                "Prognosis Total Cost" := "Total Cost" + "Prognosis Costs" + "Overhead Surch. Progn. Costs";
                                                                //<<4PS-001
                                                                CalculateRateOrQuantity;
                                                              END;

                                                   CaptionML=[ENU=Prognosis End Result;
                                                              NOR=Forventet Sluttresultat;
                                                              SVE=F”rv„ntat slutresultat];
                                                   AutoFormatType=1 }
    { 250 ;   ;Comment             ;Text100       ;CaptionML=[ENU=Comment;
                                                              NOR=Kommentar;
                                                              SVE=Kommentar] }
    { 260 ;   ;Total Cost          ;Decimal       ;CaptionML=[ENU=Total Cost;
                                                              NOR=Total kost;
                                                              SVE=Total kostnad];
                                                   AutoFormatType=1 }
    { 265 ;   ;Total Cost (Excl. Risc Cov.);Decimal;
                                                   CaptionML=[ENU=Total Cost (Excl. Risc Cov.);
                                                              NOR=Totalkost (ekskludert Riskdekning);
                                                              SVE=Totalkostnad (exkl. riskt„ckn.)];
                                                   AutoFormatType=1 }
    { 270 ;   ;Total Hours         ;Decimal       ;CaptionML=[ENU=Total Hours;
                                                              NOR=Timer totalt;
                                                              SVE=Timmar totalt];
                                                   Editable=No }
    { 280 ;   ;General Total Budget Hours;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Budget Hours" WHERE (Project No.=FIELD(Project No.),
                                                                                                             Prognosis Date=FIELD(Prognosis Date),
                                                                                                             Cost Type=FILTER(Labor)));
                                                   CaptionML=[ENU=General Total Budget Hours Labor;
                                                              NOR=Generelle totale budsjetttimer for arbeidskraft;
                                                              SVE=Allm„nna totala budgettimmar f”r arbetskraft];
                                                   Description=Add 17 nov 2011;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 290 ;   ;General Total Hours ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Total Hours" WHERE (Project No.=FIELD(Project No.),
                                                                                                            Prognosis Date=FIELD(Prognosis Date),
                                                                                                            Cost Type=FILTER(Labor)));
                                                   CaptionML=[ENU=General Total Hours Labor;
                                                              NOR=Generelle totale timer for arbeidskraft;
                                                              SVE=Allm„nna totala timmar f”r arbetskraft];
                                                   Description=Add 17 nov 2011;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 295 ;   ;General Total Quantity;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC".Quantity WHERE (Project No.=FIELD(Project No.),
                                                                                                       Prognosis Date=FIELD(Prognosis Date),
                                                                                                       Cost Type=FILTER(Labor)));
                                                   CaptionML=[ENU=General Total Quantity Labor;
                                                              NOR=Generelt totalt antall for arbeidskraft;
                                                              SVE=Allm„nt totalt antal f”r arbetskraft];
                                                   Description=Add 17 nov 2011;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 300 ;   ;Total Progn. End Result Labor;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Prognosis End Result" WHERE (Project No.=FIELD(Project No.),
                                                                                                                     Prognosis Date=FIELD(Prognosis Date),
                                                                                                                     Cost Type=FILTER(Labor)));
                                                   CaptionML=[ENU=Total Prognosis End Result Labor;
                                                              NOR=Sluttresultat for totalprognose, arbeidskraft;
                                                              SVE=Slutresultat f”r totalprognos, arbetskraft];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 310 ;   ;Total Progn. End Result Mat.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Prognosis End Result" WHERE (Project No.=FIELD(Project No.),
                                                                                                                     Prognosis Date=FIELD(Prognosis Date),
                                                                                                                     Cost Type=FILTER(Material)));
                                                   CaptionML=[ENU=Total Prognosis End Result Material;
                                                              NOR=Sluttresultat for totalprognose, Materiale;
                                                              SVE=Slutresultat f”r totalprognos, material];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 320 ;   ;Total Progn. End Result Subc.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Prognosis End Result" WHERE (Project No.=FIELD(Project No.),
                                                                                                                     Prognosis Date=FIELD(Prognosis Date),
                                                                                                                     Cost Type=FILTER(Subcontracting)));
                                                   CaptionML=[ENU=Total Prognosis End Result Subcontracting;
                                                              NOR=Sluttresultat for totalprognose, underentrepen›r;
                                                              SVE=Slutresultat f”r totalprognos, Underentreprenad];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 330 ;   ;Total Progn. End Result Plant;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Prognosis End Result" WHERE (Project No.=FIELD(Project No.),
                                                                                                                     Prognosis Date=FIELD(Prognosis Date),
                                                                                                                     Cost Type=FILTER(Plant)));
                                                   CaptionML=[ENU=Total Prognosis End Result Plant;
                                                              NOR=Sluttresultat for totalprognose, maskin;
                                                              SVE=Slutresultat f”r totalprognos, Maskin];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 340 ;   ;Total Progn. End Result Sundry;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Prognosis End Result" WHERE (Project No.=FIELD(Project No.),
                                                                                                                     Prognosis Date=FIELD(Prognosis Date),
                                                                                                                     Cost Type=FILTER(Sundry)));
                                                   CaptionML=[ENU=Total Prognosis End Result Sundry;
                                                              NOR=Sluttresultat for totalprognose, diverse;
                                                              SVE=Slutresultat f”r totalprognos, diverse];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 350 ;   ;Total Prognosis End Result;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Prognosis End Result" WHERE (Project No.=FIELD(Project No.),
                                                                                                                     Prognosis Date=FIELD(Prognosis Date)));
                                                   CaptionML=[ENU=Total Prognosis End Result;
                                                              NOR=Sluttresultat for totalprognose;
                                                              SVE=Slutresultat f”r totalprognos];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 360 ;   ;Total Prognosis Labor;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Amount incl. Surcharge" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Prognosis Date=FIELD(Prognosis Date),
                                                                                                                       Cost Type=FILTER(Labor)));
                                                   CaptionML=[ENU=Total Prognosis Labor;
                                                              NOR=Totalprognose for arbeidskraft;
                                                              SVE=Totalprognos f”r arbetskraft];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 370 ;   ;Total Prognosis Material;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Amount incl. Surcharge" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Prognosis Date=FIELD(Prognosis Date),
                                                                                                                       Cost Type=FILTER(Material)));
                                                   CaptionML=[ENU=Total Prognosis Material;
                                                              NOR=Totalprognose for Materiale;
                                                              SVE=Totalprognos f”r material];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 380 ;   ;Total Prognosis Subcontracting;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Amount incl. Surcharge" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Prognosis Date=FIELD(Prognosis Date),
                                                                                                                       Cost Type=FILTER(Subcontracting)));
                                                   CaptionML=[ENU=Total Prognosis Subcontracting;
                                                              NOR=Totalprognose for underentrepen›r;
                                                              SVE=Totalprognos f”r Underentreprenad];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 390 ;   ;Total Prognosis Plant;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Amount incl. Surcharge" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Prognosis Date=FIELD(Prognosis Date),
                                                                                                                       Cost Type=FILTER(Plant)));
                                                   CaptionML=[ENU=Total Prognosis Plant;
                                                              NOR=Totalprognose for maskin;
                                                              SVE=Totalprognos f”r Maskin];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 400 ;   ;Total Prognosis Sundry;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Amount incl. Surcharge" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Prognosis Date=FIELD(Prognosis Date),
                                                                                                                       Cost Type=FILTER(Sundry)));
                                                   CaptionML=[ENU=Total Prognosis Sundry;
                                                              NOR=Totalprognose for diverse;
                                                              SVE=Totalprognos f”r diverse];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 410 ;   ;Total Prognosis     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Amount incl. Surcharge" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Prognosis Date=FIELD(Prognosis Date)));
                                                   CaptionML=[ENU=Total Prognosis;
                                                              NOR=Totalprognose;
                                                              SVE=Totalprognos];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 430 ;   ;Main Project No.    ;Code20        ;TableRelation=Job;
                                                   CaptionML=[ENU=Main Project No.;
                                                              NOR=Hovedprosjektnr.;
                                                              SVE=Huvudprojektnr] }
    { 440 ;   ;Prev Prognosis End Result;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Prognosis Line CC"."Prognosis End Result" WHERE (Project No.=FIELD(Project No.),
                                                                                                                        Prognosis Date=FIELD(Previous Date),
                                                                                                                        Cost Component Code=FIELD(Cost Component Code)));
                                                   CaptionML=[ENU=Prev Prognosis End Result;
                                                              NOR=Forrige prognose for Sluttresultat;
                                                              SVE=F”reg†ende prognos f”r slutresultat];
                                                   Editable=No }
    { 450 ;   ;Prognosis Total Cost;Decimal       ;OnValidate=BEGIN
                                                                CheckSurchargesCalculated;
                                                                // jhoek.begin
                                                                "Prognosis End Result" := "Budget Amount" - "Prognosis Total Cost";
                                                                "Amount incl. Surcharge" := "Prognosis Total Cost" - "Total Cost";
                                                                CalculateRateOrQuantity;
                                                                // jhoek.end
                                                                "Prognosis Costs" := "Amount incl. Surcharge" - "Ovh. Surcharge" - "Overhead Surch. Progn. Costs";

                                                                //>>4PSSE, DL 131001
                                                                IF Quantity <>0 THEN
                                                                  Price := "Prognosis Costs" / Quantity;
                                                                //<<4PSSE

                                                                //>>ENH-011
                                                                IF ("Cost Type" = "Cost Type"::Labor) AND ("Actual Hours"<>0) AND ("Actual Costs"<>0) THEN
                                                                  "Prognosis Hours" := "Prognosis Costs" / ("Actual Costs"/"Actual Hours");
                                                                //<<ENH-011
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Cost;
                                                              NOR=Prognose for totale kostnader;
                                                              SVE=Prognos totala kostnader];
                                                   AutoFormatType=1 }
    { 455 ;   ;Prognosis Total Hours;Decimal      ;OnValidate=BEGIN
                                                                // 15532.n
                                                                VALIDATE(Quantity,"Prognosis Total Hours" - "Total Hours");
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Hours;
                                                              NOR=Prognose for timer totalt;
                                                              SVE=Prognos f”r timmar totalt];
                                                   Description=Add 17 nov 2011 }
    { 460 ;   ;Prognosis End Result Hours;Decimal ;CaptionML=[ENU=Prognosis End Result Hours;
                                                              NOR=Prognose for sluttresultat, timer;
                                                              SVE=Prognos f”r slutresultat, timmar];
                                                   Editable=No }
    { 470 ;   ;Result Hours        ;Decimal       ;CaptionML=[ENU=Result Hours;
                                                              NOR=Resultattimer;
                                                              SVE=Resultattimmar];
                                                   Editable=No }
    { 480 ;   ;Estimated Purchase Result;Decimal  ;CaptionML=[ENU=Estimated Purchase Result;
                                                              NOR=Kalkulert Innkj›psresultat;
                                                              SVE=Kalkylerat ink”psresultat];
                                                   Editable=No }
    { 500 ;   ;Amount Revenue      ;Decimal       ;CaptionML=[ENU=Amount Revenue;
                                                              NOR=Inntektsbel›p;
                                                              SVE=Int„ktsbelopp];
                                                   AutoFormatType=1 }
    { 510 ;   ;Prognosis Revenue   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prognosis Line CC"."Amount incl. Surcharge" WHERE (Project No.=FIELD(Project No.),
                                                                                                                       Prognosis Date=FIELD(Prognosis Date),
                                                                                                                       Cost Type=FILTER(Revenue)));
                                                   CaptionML=[ENU=Prognosis Revenue;
                                                              NOR=Prognostiserte inntekter;
                                                              SVE=Prognos int„kter];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 520 ;   ;Risc Coverage       ;Decimal       ;OnValidate=BEGIN
                                                                CheckSurchargesCalculated;
                                                                "Total Cost" := "Total Cost (Excl. Risc Cov.)" + "Risc Coverage";
                                                                VALIDATE("Amount incl. Surcharge");
                                                              END;

                                                   CaptionML=[ENU=Risc Coverage;
                                                              NOR=Riskdekning;
                                                              SVE=Riskt„ckning];
                                                   AutoFormatType=1 }
    { 530 ;   ;Invoiced            ;Decimal       ;CaptionML=[ENU=Invoiced;
                                                              NOR=Fakturert;
                                                              SVE=Fakturerat];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 540 ;   ;Total Risc Coverage Amount;Decimal ;CaptionML=[ENU=Total Risc Coverage Amount;
                                                              NOR=Totalt Riskdekningsbel›p;
                                                              SVE=Totalt riskt„ckningsbelopp];
                                                   Editable=No }
    { 545 ;   ;Total Release Risc Coverage;Decimal;CaptionML=[ENU=Total Release Risc Coverage;
                                                              NOR="Totalt, frigi Riskdekning ";
                                                              SVE=Total sl„ppning f”r riskt„ckning];
                                                   Editable=No }
    { 600 ;   ;Available           ;Decimal       ;CaptionML=[ENU=Available;
                                                              NOR=Disponibelt;
                                                              SVE=Disponibelt] }
    { 601 ;   ;Available Hours     ;Decimal       ;CaptionML=[ENU=Available Hours;
                                                              NOR=Tilgjengelige timer;
                                                              SVE=Tillg„ngliga timmar] }
    { 700 ;   ;Actual Revenues     ;Decimal       ;CaptionML=[ENU=Actual Revenues;
                                                              NOR=Faktiske inntekter;
                                                              SVE=Int„kter];
                                                   Description=IMSE-005;
                                                   Editable=No }
    { 701 ;   ;Open Revenues       ;Decimal       ;CaptionML=[ENU=Open Revenues;
                                                              NOR=pne inntekter;
                                                              SVE=™ppna int„kter];
                                                   Description=IMSE-005;
                                                   Editable=No }
    { 702 ;   ;Expected Revenues Installments;Decimal;
                                                   CaptionML=[ENU=Expected Revenues Installments;
                                                              NOR=Forventede inntekter (avdrag);
                                                              SVE=terst†ende int„kter avbetalningar];
                                                   Description=IMSE-005;
                                                   Editable=No }
    { 703 ;   ;Expected Revenues Cost Plus;Decimal;CaptionML=[ENU=Expected Revenues Cost Plus;
                                                              NOR=Forventede inntekter (selvkost);
                                                              SVE=terst†ende int„kter l”pande];
                                                   Description=IMSE-005;
                                                   Editable=No }
    { 704 ;   ;Prognosis Amount Revenue;Decimal   ;OnValidate=BEGIN
                                                                //Call no 4PS-001
                                                                //"Prognosis Total Revenues" := "Total Revenues" +"Prognosis Amount Revenue";
                                                                "Prognosis Total Revenues" := "Actual Revenues" + "Open Revenues" + "Prognosis Amount Revenue";
                                                              END;

                                                   CaptionML=[ENU=Prognosis Revenue;
                                                              NOR=Prognostiserte inntekter;
                                                              SVE=Prognostiserade int„kter];
                                                   Description=IMSE-005 }
    { 705 ;   ;Total Revenues      ;Decimal       ;CaptionML=[ENU=Total Revenues;
                                                              NOR=Totale inntekter;
                                                              SVE=Summa int„kter];
                                                   Description=IMSE-005;
                                                   Editable=No }
    { 706 ;   ;Prognosis Total Revenues;Decimal   ;CaptionML=[ENU=Prognosis Total Revenues;
                                                              NOR=Prognose totalinntekter;
                                                              SVE=Prognos totala int„kter];
                                                   Description=IMSE-005;
                                                   Editable=No }
    { 707 ;   ;Open Overhead Surcharge;Decimal    ;CaptionML=[ENU=Open Overhead Surcharge;
                                                              NOR=pne Overheadtillegsgebyr;
                                                              SVE=™ppna overhead kostnader];
                                                   Description=4PS-001;
                                                   Editable=No }
    { 708 ;   ;Overhead Surch. Progn. Costs;Decimal;
                                                   CaptionML=[ENU=Overhead Surch. Progn. Costs;
                                                              NOR=Overheadkostnader, Kostnadsprognose;
                                                              SVE=Prognos overhead omkostnader];
                                                   Description=4PS-001;
                                                   Editable=No }
    { 709 ;   ;Total Production Hours;Decimal     ;CaptionML=SVE=Totala produktionstimmar;
                                                   Description=RFC-1049 }
    { 710 ;   ;Prognosis Hours (clerk);Decimal    ;DataClassification=ToBeClassified;
                                                   CaptionML=SVE=Prognostimmar (tj„nsteman);
                                                   Description=RFC-1049 }
  }
  KEYS
  {
    {    ;Project No.,Prognosis Date,Cost Component Code;
                                                   SumIndexFields=Amount incl. Surcharge,Risc Coverage,Prognosis Total Cost,Prognosis End Result,Budget Amount,Total Cost,Amount Revenue,Quantity,Budget Hours,Total Hours,Prognosis Costs,Prognosis Total Revenues,Prognosis Amount Revenue;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
    {    ;Prognosis Date                          ;MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
    {    ;Project No.,Prognosis Date,Chapter,Paragraph;
                                                   SumIndexFields=Amount incl. Surcharge,Quantity;
                                                   MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
    {    ;Main Project No.                        ;SumIndexFields=Amount incl. Surcharge,Quantity,Amount Revenue,Prognosis Total Cost,Prognosis Costs }
    {    ;Main Project No.,Project No.,Cost Component Code,Prognosis Date;
                                                   SumIndexFields=Amount incl. Surcharge,Risc Coverage,Prognosis Total Cost,Prognosis Costs }
    {    ;Project No.,Prognosis Date,Cost Type,Cost Component Code;
                                                   SumIndexFields=Amount incl. Surcharge,Risc Coverage,Prognosis Total Cost,Prognosis End Result,Budget Amount,Total Cost,Amount Revenue,Quantity,Budget Hours,Total Hours,Prognosis Costs,Prognosis Total Revenues,Prognosis Amount Revenue }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ProjElemRec@1210190003 : Record 11012010;
      ElemRec@1100525000 : Record 11012060;
      RateRec@11012000 : Record 11012000;
      ProjRec@1100485000 : Record 11072003;
      PrognosisRec@1100525006 : Record 11012034;
      DimValRec@1100525002 : Record 349;
      ProjSetup@1100528800 : Record 315;
      ElementFormat@1100525001 : Codeunit 11012022;
      DimMgt@1100525003 : Codeunit 408;
      UpdateAction@1100525004 : 'Insert,Modify,Delete';
      PrognosisManagement@1100285000 : Codeunit 11020217;

    PROCEDURE CalculateAmount@1();
    BEGIN
      VALIDATE("Prognosis Costs", Quantity * Price);
      Rate := 0;
    END;

    PROCEDURE CalculateRateOrQuantity@2();
    BEGIN
      { ***
      // dp00029.sn
      ProjSetup.GET;
      IF ProjSetup."Recalc Rate or Hours Prognosis" = ProjSetup."Recalc Rate or Hours Prognosis"::Rate THEN BEGIN
      // dp00029.en
        //M20040 sn
        IF "Cost Type" = "Cost Type"::Labor THEN BEGIN
          //In case of Labor Quantity is NOT recalculated. In Stead Rate is Calculated.
          IF Quantity <> 0 THEN
            Rate := ROUND(Amount / Quantity, 0.00001);
          Price := 0;
        END ELSE BEGIN
          IF Quantity <> 0 THEN
            Price := Amount / Quantity;
          IF Price <> 0 THEN
            Quantity := Amount / Price;
          Rate := 0;
        END;
        //M20040 en
      // dp00029.sn
      END ELSE BEGIN
        IF "Cost Type" = "Cost Type"::Labor THEN BEGIN
          IF Rate <> 0 THEN
            Quantity := "Amount incl. Surcharge" / Rate;
          Price := 0;
        END ELSE BEGIN
          IF Price <> 0 THEN
            Quantity := "Amount incl. Surcharge" / Price;
          Rate := 0;
        END;
      END;
      // dp00029.en
      *** }
    END;

    PROCEDURE UpdateCostControlStatus@10(lUpdateAction@1100485002 : 'Insert,Modify,Delete');
    BEGIN
      IF (lUpdateAction IN [lUpdateAction::Insert,lUpdateAction::Delete]) OR
      ((lUpdateAction = lUpdateAction::Modify)  AND ("Cost Component Code" <> xRec."Cost Component Code")) THEN
        IF ProjRec.GET("Project No.") THEN
          IF ProjRec."Cost Control Up to Date" THEN BEGIN
            ProjRec."Cost Control Up to Date" := FALSE;
            ProjRec.MODIFY(FALSE);
          END;
    END;

    PROCEDURE CalculatePrognosisFields@1100525000();
    BEGIN
      //>>4PS-001
      CalculateOpenFields;
      //<< 4PS-001

      "Prognosis End Result" := "Budget Amount" - "Total Cost" - "Amount incl. Surcharge";
      "Prognosis End Result Hours" := "Budget Hours" - "Total Hours" - Quantity;
      //"Prognosis Total Cost" := "Amount incl. Surcharge" + "Total Cost";                              //20060810-JE //20090119 PS
      "Prognosis Total Cost" := "Total Cost" + "Prognosis Costs" + "Overhead Surch. Progn. Costs";  //4PS-001
      "Prognosis Total Hours" := "Total Hours" + Quantity;  // 15532.n
      "Prognosis Total Hours" := "Total Hours" + "Prognosis Hours"; //ENH-011
    END;

    PROCEDURE CalculateOpenFields@1100285000();
    VAR
      HourAccountingLine@1100285001 : Record 11012039;
      ItemJournalLine@1100285000 : Record 83;
    BEGIN
      //4PS-001
      //"Open Amount (Hours)" := ("Hour Accounting Line"."Amount (LCY)" WHERE (Main Project No.=FIELD(Main Project No.),Project No.=FIELD(Project Filter),Cost Component=FIELD(Cost Component),
          //Posting Date=FIELD(Cumulation Filter));
      //>>IME426
      //HourAccountingLine.SETRANGE("Main Project No.","Main Project No.");
      //HourAccountingLine.SETRANGE("Project No.","Project No.");
      ProjRec.GET("Project No.");
      IF ProjRec."Single/Main/Sub Project" = ProjRec."Single/Main/Sub Project"::"Main Project" THEN
        HourAccountingLine.SETRANGE("Main Project No.","Main Project No.")
      ELSE
        HourAccountingLine.SETRANGE("Project No.","Project No.");
      //<<IME426
      HourAccountingLine.SETRANGE("Cost Component", "Cost Component Code");
      HourAccountingLine.SETRANGE("Posting Date",0D,"Prognosis Date");
      HourAccountingLine.SETFILTER("Component Type",'<>%1',HourAccountingLine."Component Type"::"Expense hours");  //IME155
      HourAccountingLine.CALCSUMS("Amount (LCY)");
      "Open Amount (Hours)" := HourAccountingLine."Amount (LCY)";

      //"Open (Inventory)" := Sum("Item Journal Line".Amount WHERE (Main Project No.=FIELD(Main Project No.),Job No.=FIELD(Project Filter),
          //Posting Date=FIELD(Cumulation Filter),Cost Component=FIELD(Cost Component)))
      //>>IME426
      //ItemJournalLine.SETRANGE("Main Project No.","Main Project No.");
      //ItemJournalLine.SETRANGE("Job No.", "Project No.");
      IF ProjRec."Single/Main/Sub Project" = ProjRec."Single/Main/Sub Project"::"Main Project" THEN
        ItemJournalLine.SETRANGE("Main Project No.","Main Project No.")
      ELSE
        ItemJournalLine.SETRANGE("Job No.", "Project No.");
      //<<IME426
      ItemJournalLine.SETRANGE("Posting Date",0D,"Prognosis Date");
      ItemJournalLine.SETRANGE("Cost Component", "Cost Component Code");
      ItemJournalLine.CALCSUMS(Amount);
      "Open (Inventory)" := ItemJournalLine.Amount;

      "Open Overhead Surcharge" := "Open Ovh. Surch. (Inventory)" + "Open Ovh. Surch. (Hours)" + "Open Ovh. Surch. (Purchase)";

      "Total Cost" := "Open Amount (Hours)" + "Open (Inventory)" + "Open (Purchase)" + "Open Overhead Surcharge" + "Actual Costs";
    END;

    PROCEDURE CheckSurchargesCalculated@1100525001() : Boolean;
    VAR
      lvPrognosis@1100525000 : Record 11012034;
    BEGIN
      lvPrognosis.INIT;
      lvPrognosis.SETRANGE("Project No.", "Project No.");
      lvPrognosis.SETRANGE("Prognosis Date", "Prognosis Date");
      IF lvPrognosis.FINDFIRST THEN BEGIN
        IF lvPrognosis."Ovh. Surcharges Calculated" THEN
          IF NOT lvPrognosis."Altered After Calculation" THEN BEGIN
            lvPrognosis."Altered After Calculation" := TRUE;  //M21759
            lvPrognosis.MODIFY;                               //M21759
          END;
      END;
    END;

    PROCEDURE UpdatePrognosisSpecification@11136551(OldQuantity@11136550 : Decimal;NewQuantity@11136552 : Decimal;OldPrice@11136553 : Decimal;NewPrice@11136554 : Decimal);
    VAR
      PrognosisLineSpec@11136551 : Record 11020687;
      PrognosisLineSpec2@11136555 : Record 11020687;
    BEGIN
      { ***
      //DP00042
      IF (NewPrice <> OldPrice) THEN BEGIN
        PrognosisLineSpec.SETRANGE("Project No.", "Project No.");
        PrognosisLineSpec.SETRANGE("Prognosis Date", "Prognosis Date");
        IF Element = '' THEN  //db, 15-11-11
          PrognosisLineSpec.SETFILTER(Element, '%1', '')
        ELSE
          PrognosisLineSpec.SETRANGE(Element, Element);
        PrognosisLineSpec.SETRANGE("Cost Type", "Cost Type");
        PrognosisLineSpec.SETRANGE("Cost Object", "Cost Object");

        IF PrognosisLineSpec.FINDSET THEN
          REPEAT
            PrognosisLineSpec2 := PrognosisLineSpec;
            PrognosisLineSpec2.Price := NewPrice;
            PrognosisLineSpec2.UpdateAmount;
            PrognosisLineSpec2.MODIFY;
          UNTIL PrognosisLineSpec.NEXT = 0;
      END;

      IF (NewQuantity <> OldQuantity) THEN BEGIN
        CALCFIELDS("Cost Object Description");

        PrognosisLineSpec."Project No." := "Project No.";
        PrognosisLineSpec."Prognosis Date" := "Prognosis Date";
        PrognosisLineSpec."Cost Type" := "Cost Type";
        PrognosisLineSpec.Element := Element;
        PrognosisLineSpec."Cost Object" := "Cost Object";
        PrognosisLineSpec.Description := "Cost Object Description";
        PrognosisLineSpec.Quantity := NewQuantity - OldQuantity;
        PrognosisLineSpec.Price := NewPrice;
        PrognosisLineSpec.UpdateAmount;
        PrognosisLineSpec."Reference No." := CREATEGUID;
        PrognosisLineSpec."Line No." := PrognosisLineSpec.FindNextLineNo;
        PrognosisLineSpec.INSERT;
      END;
      *** }
    END;

    PROCEDURE AmountOnDrillDown@11136550();
    VAR
      PrognosisLineSpec@11136550 : Record 11020687;
    BEGIN
      { ***
      //DP00042
      MODIFY(TRUE);
      COMMIT;

      PrognosisLineSpec.SETRANGE("Project No.", "Project No.");
      PrognosisLineSpec.SETRANGE("Prognosis Date", "Prognosis Date");
      IF Element = '' THEN  //db, 15-11-11
        PrognosisLineSpec.SETFILTER(Element, '%1', '')
      ELSE
        PrognosisLineSpec.SETRANGE(Element, Element);
      PrognosisLineSpec.SETRANGE("Cost Type", "Cost Type");
      PrognosisLineSpec.SETRANGE("Cost Object", "Cost Object");

      FORM.RUNMODAL(0, PrognosisLineSpec);

      *** }
    END;

    BEGIN
    {
      -SE EVRY-
      LAHE 121213 Copy of "Prognosis Line"
      LAHE 130528 Revenue

      4PSSE, added SumIndexFields in key "Main Project No." for "Amount"
             added sumindex on 'Overhead Surch. Progn. Costs' in PK

      4PSSE,  140130, ENH-011#2, populate Cost type
      4PSSE,  140128, ENH-011#5, rename field
      140815  ITERO.DL IME155 exclude "Component Type"::'expense hours' from "Open Amount (Hours)", "Open Ovh. Surch. (Hours)", "Open Hours"
      151022  ITERO.SB RFC-010 Added function/setup to check if prognosis is used in project preclosure
      160115  ITERO.DL IME426 prognosis and projectcontrol don't give same info
      180514 ORANGO.FH RFC-1049 Added field "Total Production Hours"
    }
    END.
  }
}

