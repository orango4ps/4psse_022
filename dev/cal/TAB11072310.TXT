OBJECT Table 11072310 Service Prognosis Line
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS14.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               DetermineValues;
             END;

    OnDelete=VAR
               ServicePrognosisByCostType@1100529600 : Record 11072553;
             BEGIN
               ServicePrognosisByCostType.SETRANGE("Prognosis Date", "Prognosis Date");
               ServicePrognosisByCostType.SETRANGE("Prognosis Seq. No.", "Prognosis Seq. No.");
               ServicePrognosisByCostType.SETRANGE("Prognosis Line No.", "Line No.");
               ServicePrognosisByCostType.DELETEALL;
             END;

    CaptionML=ENU=Service Prognosis Line;
  }
  FIELDS
  {
    { 10  ;   ;Prognosis Date      ;Date          ;TableRelation="Service Prognosis"."Prognosis Date";
                                                   CaptionML=[ENU=Prognosis Date;
                                                              NOR=Prognosedato;
                                                              SVE=Prognosdatum];
                                                   NotBlank=Yes }
    { 12  ;   ;Prognosis Seq. No.  ;Integer       ;TableRelation="Service Prognosis"."Seq. No." WHERE (Prognosis Date=FIELD(Prognosis Date));
                                                   CaptionML=ENU=Prognosis Seq. No.;
                                                   NotBlank=Yes }
    { 15  ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.;
                                                              SVE=Radnr] }
    { 20  ;   ;Service Contract No.;Code20        ;TableRelation=Service-Contract;
                                                   OnValidate=VAR
                                                                ServiceContract@1100528600 : Record 11012812;
                                                              BEGIN
                                                                IF "Service Contract No." <> '' THEN
                                                                  IF ServiceContract.GET("Service Contract No.") THEN BEGIN
                                                                    VALIDATE("Contract Manager", ServiceContract."Contract Manager");
                                                                    VALIDATE("Customer No.", ServiceContract."Customer No.");
                                                                    VALIDATE("Contract Group", ServiceContract."Contract Group");
                                                                    "Level Progress Measurement" := ServiceContract."Level Progress Measurement";
                                                                    "Result Calc. on Total Contract" := ServiceContract."Result Calc. on Total Contract";
                                                                    "Global Dimension 1 Code" := ServiceContract."Global Dimension 1 Code";
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Service Contract No.;
                                                              NOR=Servicekontraktnr;
                                                              SVE=Servicekontraktnr];
                                                   Editable=No }
    { 25  ;   ;Service Contract Description;Text50;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Service-Contract.Description WHERE (No.=FIELD(Service Contract No.)));
                                                   CaptionML=[ENU=Service Contract Description;
                                                              NOR=Servicekontraktsbeskrivelse;
                                                              SVE=Servicekontraktsbeskrivning];
                                                   Editable=No }
    { 30  ;   ;Control Period Code ;Code10        ;TableRelation=IF (Service Contract No.=FILTER(<>'')) "Service-Contract Ctrl. Period".Code WHERE (Service Contract No.=FIELD(Service Contract No.))
                                                                 ELSE IF (Service Contract No.=CONST('')) "Service Control Period".Code;
                                                   OnValidate=VAR
                                                                ServiceControlPeriod@1100528601 : Record 11071755;
                                                                ServiceContractCtrlPeriod@1100528600 : Record 11071746;
                                                              BEGIN
                                                                IF "Service Contract No." = '' THEN BEGIN
                                                                  IF ServiceControlPeriod.GET("Control Period Code") THEN BEGIN
                                                                    "Starting Date" := ServiceControlPeriod."Starting Date";
                                                                    "Ending Date" := ServiceControlPeriod."Ending Date";
                                                                    "Control Period Finished" := ServiceControlPeriod."Date Finished" <> 0D;
                                                                  END;
                                                                END ELSE BEGIN
                                                                  IF ServiceContractCtrlPeriod.GET("Service Contract No.", "Control Period Code") THEN BEGIN
                                                                    "Starting Date" := ServiceContractCtrlPeriod."Starting Date";
                                                                    "Ending Date" := ServiceContractCtrlPeriod."Ending Date";
                                                                    "Control Period Finished" := ServiceContractCtrlPeriod."Date Finished" <> 0D;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Control Period Code;
                                                              NOR=Kontrollperiodekode;
                                                              SVE=Kontrollperiodskod];
                                                   Editable=No }
    { 40  ;   ;Starting Date       ;Date          ;CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato;
                                                              SVE=Startdatum];
                                                   Editable=No }
    { 50  ;   ;Ending Date         ;Date          ;CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato;
                                                              SVE=Slutdatum];
                                                   Editable=No }
    { 60  ;   ;Source Type         ;Option        ;CaptionML=[ENU=Source Type;
                                                              NOR=Kildetype;
                                                              SVE=Ursprungstyp];
                                                   OptionCaptionML=[ENU=Call,Contract,Direct,Estimate,,,Modification,Replacement;
                                                                    NOR=Samtale,Kontrakt,Direkte,Kalkyle,,,Endring,Erstatning;
                                                                    SVE=Samtal,Kontrakt,Direkt,Kalkyl,,,éndring,ErsÑttning];
                                                   OptionString=Call,Contract,Direct,Estimate,,,Modification,Replacement;
                                                   Editable=No }
    { 70  ;   ;Service Order No.   ;Code20        ;TableRelation="Service Order";
                                                   OnValidate=VAR
                                                                ServiceOrder@1100528600 : Record 11012823;
                                                              BEGIN
                                                                IF "Service Contract No." = '' THEN
                                                                  IF ServiceOrder.GET("Service Order No.") THEN BEGIN
                                                                    VALIDATE("Customer No.", ServiceOrder."Customer No.");
                                                                    "Global Dimension 1 Code" := ServiceOrder."Global Dimension 1 Code";
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Service Order No.;
                                                              NOR=Serviceordrenr.;
                                                              SVE=Serviceordernr];
                                                   Editable=No }
    { 75  ;   ;Line Type           ;Option        ;CaptionML=[ENU=Line Type;
                                                              NOR=Radtype;
                                                              SVE=Radtyp];
                                                   OptionCaptionML=ENU=,Period,Service Category,Source Type,Service Order;
                                                   OptionString=,Period,Service Category,Source Type,Service Order;
                                                   Description=Keep this in sync with T11072311F90 }
    { 80  ;   ;Indentation         ;Integer       ;CaptionML=ENU=Ident Value;
                                                   Editable=No }
    { 100 ;   ;Total Budget Revenue;Decimal       ;CaptionML=ENU=Total Budget Revenue;
                                                   Editable=No }
    { 120 ;   ;Paid Amount         ;Decimal       ;CaptionML=ENU=Paid Amount;
                                                   Editable=No }
    { 130 ;   ;Closed Revenue      ;Decimal       ;FieldClass=Normal;
                                                   CaptionML=ENU=Closed Revenue;
                                                   Editable=No }
    { 140 ;   ;Contract Financing Balance;Decimal ;CaptionML=ENU=Contract Financing Balance;
                                                   Editable=No }
    { 170 ;   ;Revenue Amount      ;Decimal       ;CaptionML=ENU=Revenue Amount;
                                                   Editable=No }
    { 180 ;   ;Service Order Description;Text50   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Order".Description WHERE (No.=FIELD(Service Order No.)));
                                                   CaptionML=[ENU=Service Order Description;
                                                              SVE=Serviceorder beskrivning];
                                                   Editable=No }
    { 190 ;   ;SO Description OLD  ;Text50        ;CaptionML=[ENU=Service Order Description;
                                                              NOR=Serviceordre Beskrivelse;
                                                              SVE=Serviceorder beskrivning];
                                                   Editable=No }
    { 200 ;   ;Service Order Status;Option        ;CaptionML=[ENU=Service Order Status;
                                                              NOR=Serviceordrestatus;
                                                              SVE=Serviceorderstatus];
                                                   OptionCaptionML=[ENU=Open,,In Process,Technical Finished,Administrative Finished,Finished,Cancelled;
                                                                    NOR=èpne,,Under behandling,Teknisk ferdig,Administrativt ferdig,Ferdig,Avbrutt;
                                                                    SVE=ôppna,,Under behandling,Tekniskt fÑrdig,Administrativt fÑrdig,FÑrdig,Avbrutet];
                                                   OptionString=Open,,In Process,Technical Finished,Administrative Finished,Finished,Cancelled;
                                                   Editable=No }
    { 210 ;   ;Actual Cost         ;Decimal       ;CaptionML=[ENU=Actual Cost;
                                                              NOR=Faktisk kost;
                                                              SVE=Faktisk kostnad];
                                                   Editable=No }
    { 215 ;   ;Actual Cost (Additional);Decimal   ;CaptionML=[ENU=Actual Cost (Additional);
                                                              SVE=Verkliga kostnader (extra)];
                                                   Editable=No }
    { 230 ;   ;Open (Purchase)     ;Decimal       ;CaptionML=[ENU=Open (Purchase);
                                                              NOR=èpne innkjõp;
                                                              SVE=ôppna inkîp];
                                                   Editable=No }
    { 240 ;   ;Total Cost          ;Decimal       ;OnValidate=BEGIN
                                                                Available := "Budget Cost" - "Total Cost";
                                                              END;

                                                   CaptionML=[ENU=Total Cost;
                                                              NOR=Total kost;
                                                              SVE=Totalkostnad];
                                                   Editable=No }
    { 250 ;   ;Result              ;Decimal       ;CaptionML=[ENU=Result;
                                                              NOR=Resultat;
                                                              SVE=Resultat];
                                                   Editable=No }
    { 260 ;   ;Budget Cost         ;Decimal       ;OnValidate=BEGIN
                                                                Available := "Budget Cost" - "Total Cost";
                                                              END;

                                                   CaptionML=[ENU=Budget Cost;
                                                              NOR=Budsjett Kostnad;
                                                              SVE=Budgeterad kostnad];
                                                   Editable=No }
    { 270 ;   ;Deviation From Budget;Decimal      ;OnValidate=BEGIN
                                                                CheckManualChange;
                                                                "Budget Costs Incl. Deviation" := "Budget Cost" + "Deviation From Budget";
                                                                DetermineCalcPrognosisTotalCost;
                                                                DeterminePrognosisTotalContractCost;
                                                                DeterminePrognosisFinancialResult;
                                                                UpdateUpperLevelPrognosisAmounts("Line Type", FIELDNO("Deviation From Budget"));
                                                                IF "Progress Method" = "Progress Method"::"Actual Cost" THEN
                                                                  DetermineProgressPercentage;
                                                              END;

                                                   CaptionML=ENU=Deviation From Budget }
    { 280 ;   ;Low. Level Dev. From Budget;Decimal;CaptionML=ENU=Lower Level Deviation From Budget;
                                                   Editable=No }
    { 290 ;   ;Budget Costs Incl. Deviation;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Budget Costs Including Deviation;
                                                   Editable=No }
    { 330 ;   ;Service Category    ;Code10        ;OnValidate=VAR
                                                                ServiceCategory@1100529660 : Record 11071985;
                                                              BEGIN
                                                                IF "Service Category" = '' THEN
                                                                  "Calc. Interim Results by Order" := FALSE
                                                                ELSE BEGIN
                                                                  ServiceCategory.GET("Service Contract No.", "Service Category");
                                                                  "Calc. Interim Results by Order" := ServiceCategory."Calc. Interim Results by Order";
                                                                  "Exclude SOs From Est. Result" := ServiceCategory."Exclude SOs From Est. Result";
                                                                END;
                                                                IF "Calc. Interim Results by Order" THEN
                                                                  "Level Progress Measurement" := "Level Progress Measurement"::"Service Order";
                                                              END;

                                                   CaptionML=[ENU=Service Category;
                                                              SVE=Servicekategori] }
    { 340 ;   ;Prognosis Total Cost;Decimal       ;OnValidate=BEGIN
                                                                CheckManualChange;
                                                                DeterminePrognosisFinancialResult;
                                                                DeterminePrognosisTotalContractCost;
                                                                UpdateUpperLevelPrognosisAmounts("Line Type", FIELDNO("Prognosis Total Cost"));
                                                                IF "Progress Method" = "Progress Method"::"Actual Cost" THEN
                                                                  DetermineProgressPercentage;
                                                              END;

                                                   CaptionML=[ENU=Prognosis Total Cost;
                                                              NOR=Prognose for totale kostnader;
                                                              SVE=Prognos totala kostnader] }
    { 350 ;   ;Prognosis Total Revenue (SC);Decimal;
                                                   OnValidate=BEGIN
                                                                CheckManualChange;
                                                                IF ("Line Type" = "Line Type"::"Service Order") AND (("Service Order No." <> '') OR "Total Service Order Level") AND ("Prognosis Total Revenue (SC)" <> 0) THEN
                                                                  ERROR(Text003, FIELDCAPTION("Prognosis Total Revenue (SC)"), "Line Type");
                                                                DeterminePrognosisFinancialResult;
                                                                DeterminePrognosisTotalContractRevenueSC;
                                                                UpdateUpperLevelPrognosisAmounts("Line Type", FIELDNO("Prognosis Total Revenue (SC)"));
                                                              END;

                                                   CaptionML=ENU=Prognosis Total Revenue (Contract) }
    { 355 ;   ;Prognosis Total Revenue (SO);Decimal;
                                                   OnValidate=BEGIN
                                                                CheckManualChange;
                                                                IF (("Line Type" = "Line Type"::"Service Order") AND (("Service Order No." <> '') OR "Total Service Order Level")) OR ("Line Type" <> "Line Type"::"Service Order") THEN BEGIN
                                                                  DeterminePrognosisFinancialResult;
                                                                  DeterminePrognosisTotalContractRevenueSO;
                                                                  UpdateUpperLevelPrognosisAmounts("Line Type", FIELDNO("Prognosis Total Revenue (SO)"))
                                                                END ELSE
                                                                  IF "Prognosis Total Revenue (SO)" <> 0 THEN
                                                                    ERROR(Text003, FIELDCAPTION("Prognosis Total Revenue (SO)"), "Line Type");
                                                              END;

                                                   CaptionML=ENU=Prognosis Total Revenue (Order) }
    { 360 ;   ;Calc. Prognosis Total Cost;Decimal ;CaptionML=[ENU=Calculated Prognosis Total Cost;
                                                              NOR=Kalkulert prognose, totalkostnad;
                                                              SVE=BerÑknad prognos fîr totalkostnader];
                                                   Editable=No }
    { 370 ;   ;Calc. Progn. Total Rev. (SC);Decimal;
                                                   CaptionML=ENU=Calculated Prognosis Total Revenue (Contract);
                                                   Editable=No }
    { 375 ;   ;Calc. Progn. Total Rev. (SO);Decimal;
                                                   CaptionML=ENU=Calculated Prognose Total Revenue (Order);
                                                   Editable=No }
    { 380 ;   ;Lower Level Progn. Total Cost;Decimal;
                                                   CaptionML=ENU=Lower Level Prognosis Total Cost;
                                                   Editable=No }
    { 390 ;   ;Low. Level Progn. Tot.Rev.(SC);Decimal;
                                                   CaptionML=ENU=Lower Level Prognosis Total Revenue (Contract);
                                                   Editable=No }
    { 400 ;   ;Low. Level Progn. Tot.Rev.(SO);Decimal;
                                                   CaptionML=ENU=Lower Level Prognosis Total Revenue (Order);
                                                   Editable=No }
    { 410 ;   ;Prognosis Total Contract Cost;Decimal;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Rest of Contract");
                                                                CheckManualChange;
                                                                "Prognosis Total Cost" := "Prognosis Total Contract Cost" - TotalPrognosisTotalCostRevenue(FIELDNO("Prognosis Total Cost"));
                                                                UpdateUpperLevelPrognosisAmounts("Line Type", FIELDNO("Prognosis Total Contract Cost"));
                                                                IF "Progress Method" = "Progress Method"::"Actual Cost" THEN
                                                                  DetermineProgressPercentage;
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Prognosis Total Contract Cost }
    { 420 ;   ;Prognosis Total Contr. Rev. SC;Decimal;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Rest of Contract");
                                                                CheckManualChange;
                                                                IF ("Line Type" = "Line Type"::"Service Order") AND (("Service Order No." <> '') OR "Total Service Order Level") AND ("Prognosis Total Contr. Rev. SC" <> 0) THEN
                                                                  ERROR(Text003, FIELDCAPTION("Prognosis Total Contr. Rev. SC"), "Line Type");
                                                                "Prognosis Total Revenue (SC)" := "Prognosis Total Contr. Rev. SC" - TotalPrognosisTotalCostRevenue(FIELDNO("Prognosis Total Revenue (SC)"));
                                                                DeterminePrognosisFinancialResult;
                                                                UpdateUpperLevelPrognosisAmounts("Line Type", FIELDNO("Prognosis Total Contr. Rev. SC"));
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Prognosis Total Contract Revenue (Contract) }
    { 430 ;   ;Prognosis Total Contr. Rev. SO;Decimal;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Rest of Contract");
                                                                CheckManualChange;
                                                                IF (("Line Type" = "Line Type"::"Service Order") AND (("Service Order No." <> '') OR "Total Service Order Level")) OR ("Line Type" <> "Line Type"::"Service Order") THEN BEGIN
                                                                  "Prognosis Total Revenue (SO)" := "Prognosis Total Contr. Rev. SO" - TotalPrognosisTotalCostRevenue(FIELDNO("Prognosis Total Revenue (SO)"));
                                                                  DeterminePrognosisFinancialResult;
                                                                  UpdateUpperLevelPrognosisAmounts("Line Type", FIELDNO("Prognosis Total Contr. Rev. SO"));
                                                                END ELSE
                                                                  IF "Prognosis Total Contr. Rev. SO" <> 0 THEN
                                                                    ERROR(Text003, FIELDCAPTION("Prognosis Total Contr. Rev. SO"), "Line Type");
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Prognosis Total Contract Revenue (Order) }
    { 440 ;   ;Low. Lv. Pr. Total Contr. Cost;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Lower Level Prognosis Total Contract Cost;
                                                   Editable=No }
    { 450 ;   ;Low. L. Pr. Tot Contr. Rev. SC;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Lower Level Prognosis Total Contract Revenue (Contract);
                                                   Editable=No }
    { 460 ;   ;Low. L. Pr. Tot Contr. Rev. SO;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Lower Level Prognosis Total Contract Revenue (Order);
                                                   Editable=No }
    { 500 ;   ;Contract Manager    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Contract Manager;
                                                              NOR=Kontraktleder;
                                                              SVE=Kontrakthanterare];
                                                   Editable=No }
    { 505 ;   ;Contract Manager Name;Text50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Contract Manager)));
                                                   CaptionML=[ENU=Contract Manager Name;
                                                              NOR=Kontraktleders navn;
                                                              SVE=Kontraktschefsnamn];
                                                   Editable=No }
    { 510 ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Customer No.;
                                                              NOR=Kundenr;
                                                              SVE=Kundnr];
                                                   Editable=No }
    { 515 ;   ;Customer Name       ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Customer Name;
                                                              NOR=Kundnavn;
                                                              SVE=Kundens namn];
                                                   Editable=No }
    { 520 ;   ;Contract Group      ;Code20        ;TableRelation="Service Contract Group";
                                                   CaptionML=[ENU=Contract Group;
                                                              NOR=Kontraktgruppe;
                                                              SVE=Kontraktsgrupp];
                                                   Editable=No }
    { 525 ;   ;Contract Group Description;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Contract Group".Description WHERE (Code=FIELD(Contract Group)));
                                                   CaptionML=[ENU=Contract Group Description;
                                                              NOR=Beskrivelse av Kontraktgruppe;
                                                              SVE=Kontraktgruppsbeskrivning];
                                                   Editable=No }
    { 530 ;   ;Open Ovh. Surch. Soft (Purch.);Decimal;
                                                   CaptionML=[ENU=Open Ovh. Surch. Soft Commitments (Purchase);
                                                              NOR=èpen overheadkost, lõpende engasjementer (Innkjõp);
                                                              SVE=ôppen overheadkostnad, lîpande Ütaganden (inkîp)];
                                                   Editable=No }
    { 540 ;   ;Received/Not Invoiced;Decimal      ;CaptionML=[ENU=Received/Not Invoiced;
                                                              NOR=Mottatt/ikke fakturert;
                                                              SVE=Mottaget/inte fakturerat];
                                                   Editable=No }
    { 550 ;   ;Open Ovh. Surch. Firm (Purch.);Decimal;
                                                   CaptionML=[ENU=Open Ovh. Surch. Firm Commitments (Purchase);
                                                              NOR=èpen overheadkost, faste Forpliktelser (Innkjõp);
                                                              SVE=ôppen overheadkostnad, fasta Ütaganden (inkîp)];
                                                   Editable=No }
    { 560 ;   ;Open (Inventory)    ;Decimal       ;CaptionML=[ENU=Open (Inventory);
                                                              NOR=èpne (lager);
                                                              SVE=ôppna (lager)];
                                                   Editable=No }
    { 570 ;   ;Open Ovh. Surch. (Inventory);Decimal;
                                                   CaptionML=[ENU=Open Ovh. Surch. (Inventory);
                                                              NOR=èpen overheadkost (lager);
                                                              SVE=ôppen overheadkostnad (lager)];
                                                   Editable=No }
    { 580 ;   ;Open Amount (Hours) ;Decimal       ;CaptionML=[ENU=Open Amount (Hours);
                                                              NOR=èpne belõp (Timer);
                                                              SVE=ôppna belopp (timmar)];
                                                   Editable=No }
    { 590 ;   ;Open Ovh. Surch. (Hours);Decimal   ;CaptionML=[ENU=Open Ovh. Surch. (Hours);
                                                              NOR=èpen tilleggsgebyr for overhead (Timer);
                                                              SVE=ôppen overheadkostnad (timmar)];
                                                   Editable=No }
    { 600 ;   ;Total Cost (Additional);Decimal    ;CaptionML=ENU=Total Cost (Additional);
                                                   Editable=No }
    { 610 ;   ;Available           ;Decimal       ;CaptionML=[ENU=Available;
                                                              NOR=Disponibelt;
                                                              SVE=Disponibelt];
                                                   Editable=No }
    { 620 ;   ;Budget Hours        ;Decimal       ;CaptionML=[ENU=Budget Hours;
                                                              NOR=Budsjett (Timer);
                                                              SVE=Budget (timmar)];
                                                   Editable=No }
    { 630 ;   ;Actual Hours        ;Decimal       ;CaptionML=[ENU=Actual Hours;
                                                              NOR=Reelle timer;
                                                              SVE=Verkliga timmar];
                                                   Editable=No }
    { 635 ;   ;Actual Hours (Additional);Decimal  ;CaptionML=[ENU=Actual Hours (Additional);
                                                              NOR=Faktiske timer (Ekstra);
                                                              SVE=Verkliga timmar (extra)];
                                                   Editable=No }
    { 640 ;   ;Open Hours          ;Decimal       ;CaptionML=[ENU=Open Hours;
                                                              NOR=èpne timer;
                                                              SVE=ôppna timmar];
                                                   Editable=No }
    { 650 ;   ;Total Hours         ;Decimal       ;CaptionML=[ENU=Total Hours;
                                                              NOR=Timer totalt;
                                                              SVE=Timmar totalt];
                                                   Editable=No }
    { 660 ;   ;Total Hours (Additional);Decimal   ;CaptionML=ENU=Total Hours (Additional);
                                                   Editable=No }
    { 670 ;   ;Allowed Hours       ;Decimal       ;CaptionML=[ENU=Allowed Hours;
                                                              NOR=Tillatte timer;
                                                              SVE=TillÜtna timmar];
                                                   Editable=No }
    { 680 ;   ;Result Hours        ;Decimal       ;CaptionML=[ENU=Result Hours;
                                                              NOR=Resultattimer;
                                                              SVE=Resultattimmar];
                                                   Editable=No }
    { 690 ;   ;Budget Revenue (Contract);Decimal  ;CaptionML=ENU=Budget Revenue (Contract);
                                                   Editable=No }
    { 700 ;   ;Budget Revenue (Order);Decimal     ;CaptionML=ENU=Budget Revenue (Order);
                                                   Editable=No }
    { 710 ;   ;Revenue Amount (Additional);Decimal;CaptionML=ENU=Revenue Amount (Additional);
                                                   Editable=No }
    { 720 ;   ;Allowed Cost        ;Decimal       ;CaptionML=[ENU=Allowed Cost;
                                                              SVE=TillÜten];
                                                   Editable=No }
    { 730 ;   ;Original Budget Hours;Decimal      ;CaptionML=[ENU=Original Budget Hours;
                                                              NOR=Opprinnelige budsjetttimer;
                                                              SVE=Ursprungliga budgettimmar];
                                                   Editable=No }
    { 735 ;   ;Original Budget Cost;Decimal       ;CaptionML=ENU=Original Budget Cost;
                                                   Editable=No }
    { 740 ;   ;Contract Amount     ;Decimal       ;CaptionML=[ENU=Contract Amount;
                                                              NOR=Kontraktsbelõp;
                                                              SVE=Kontraktsbelopp];
                                                   Editable=No }
    { 750 ;   ;Progress Method     ;Option        ;CaptionML=[ENU=Progress Method;
                                                              NOR=Fremdriftsmetode;
                                                              SVE=Fîrloppsmetod];
                                                   OptionCaptionML=ENU=Allowed Hours,,,Actual Cost,Elapsed Time,,Available Hours,,Allowed Cost,,Available Cost,,None;
                                                   OptionString=Allowed Hours,,,Actual Cost,Elapsed Time,,Available Hours,,Allowed Cost,,Available Cost,,None;
                                                   Editable=No }
    { 760 ;   ;Calculated Cum. Progress %;Decimal ;CaptionML=ENU=Calculated Cum. Progress %;
                                                   Editable=No }
    { 770 ;   ;Cumulative Progress %;Decimal      ;OnValidate=BEGIN
                                                                IF "Cumulative Progress %" <> 0 THEN BEGIN
                                                                  TESTFIELD("Service Contract No.");
                                                                  TESTFIELD("Level Progress Measurement", "Line Type" - 1);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Cumulative Progress %;
                                                              NOR=Akkumulert Fremdrift %;
                                                              SVE=Ackumulerad fîrloppsprocent];
                                                   MaxValue=100 }
    { 780 ;   ;Prognosis Financial Result;Decimal ;CaptionML=[ENU=Prognosis Financial Result;
                                                              NOR=Resultatprognose, finans;
                                                              SVE=Prognos finansiellt resultat];
                                                   Editable=No }
    { 790 ;   ;Zero Line           ;Boolean       ;CaptionML=[ENU=Zero Line;
                                                              SVE=Nollrad];
                                                   Editable=No }
    { 800 ;   ;Rest of Contract    ;Boolean       ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Rest of Contract;
                                                   Editable=No }
    { 801 ;   ;Rest of Contract Editable;Boolean  ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Rest of Contract Editable }
    { 810 ;   ;Total Service Order Level;Boolean  ;CaptionML=ENU=Total Service Order Level;
                                                   Editable=No }
    { 820 ;   ;Precalc. Result vs Budget;Decimal  ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Pre-calculation Result vs Budget;
                                                   Editable=No }
    { 830 ;   ;Calc. Interim Results by Order;Boolean;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Calculate Interim Results by Order;
                                                   Editable=No }
    { 840 ;   ;Level Progress Measurement;Option  ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Level Progress Measurement;
                                                   OptionCaptionML=ENU=Period,Service Category,Source Type,Service Order;
                                                   OptionString=Period,Service Category,Source Type,Service Order;
                                                   Editable=No }
    { 850 ;   ;Total Cost (WIP) on Bal. Sheet;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Total Cost (WIP) on Balance Sheet;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 860 ;   ;Total Rev. (WIP) on Bal. Sheet;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Total Revenue (WIP) on Balance Sheet;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 870 ;   ;Total Cost (WIP) on P&L;Decimal    ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Total Cost (WIP) on P&L;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 880 ;   ;Total Revenue (WIP) on P&L;Decimal ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Total Revenue (WIP) on P&L;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 890 ;   ;Posted Preclosure Result;Decimal   ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Posted Preclosure Result;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 900 ;   ;Posted Provision Loss;Decimal      ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Posted Provision Loss;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 910 ;   ;Result Calc. on Total Contract;Boolean;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Result Calc. on Total Contract;
                                                   Editable=No }
    { 920 ;   ;Control Period Finished;Boolean    ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Control Period Finished;
                                                   Editable=No }
    { 930 ;   ;Closed Cost         ;Decimal       ;DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Closed Cost;
                                                              SVE=Upparbetad kostnad];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 940 ;   ;Contr. Fin. Bal. Without Clos.;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Contract Financing Balance Without Closing Entries;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 950 ;   ;Precalc. Res. Incl. Deviation;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Precalc. Result Including Deviation;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 960 ;   ;Exclude SOs From Est. Result;Boolean;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Exclude Service Orders From Estimated Result;
                                                   Editable=No }
    { 970 ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              SVE=Global dimension 1 kod];
                                                   Editable=No;
                                                   CaptionClass='1,1,1' }
  }
  KEYS
  {
    {    ;Prognosis Date,Prognosis Seq. No.,Line No.;
                                                   Clustered=Yes }
    {    ;Service Contract No.                     }
    {    ;Service Order No.                        }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1100528602 : TextConst 'ENU=Period;NOR=Periode;SVE=Period';
      Text002@1100528601 : TextConst 'ENU=Amounts Source Type Level';
      Text003@1100528604 : TextConst 'ENU=%1 cannot be filled out at level %2';
      Text004@1100528605 : TextConst 'ENU=Drill down only available on Service Order level';
      Text005@1100528606 : TextConst 'ENU=Contract;NOR=Contract;SVE="Kontrakt     "';
      DontUpdatePrognosisValueViaLowerLevelValue@1100528607 : Boolean;
      Text006@1100528608 : TextConst 'ENU=Progress: \Phase 1: @1@@@@@\Phase 2: @2@@@@@';
      Text007@1100529600 : TextConst 'ENU=You cannot change this value, because detailed prognosis level is used!';
      TotalBudgetRevenueContract@1100528600 : Decimal;

    LOCAL PROCEDURE DetermineIndentation@1100528606();
    VAR
      Indentations@1100529780 : ',Period,Service Category,Source Type,Service Order';
    BEGIN
      CASE "Line Type" OF
        "Line Type"::Period:
          Indentation := Indentations::Period;
        "Line Type"::"Service Category":
          Indentation := Indentations::"Service Category";
        "Line Type"::"Source Type":
          Indentation := Indentations::"Source Type";
        "Line Type"::"Service Order":
          Indentation := Indentations::"Service Order";
      END;
    END;

    PROCEDURE DetermineValues@1100528603();
    VAR
      ServiceContract@1100528606 : Record 11012812;
      SCBudgetCallsRelease@1100528604 : Record 11071699;
      ServiceOrder@1100528602 : Record 11012823;
      ServiceCategory@1100529600 : Record 11071985;
      SCControlbyPeriodMgt@1100528603 : Codeunit 11012885;
      Factor@1100528601 : Decimal;
      ReleasePercentage@1100528600 : Decimal;
      PostingDateFilter@1100528607 : Text;
    BEGIN
      IF NOT ServiceContract.GET("Service Contract No.") THEN
        ServiceContract.INIT;
      DetermineIndentation;
      DetermineProgressMethod;
      IF "Total Service Order Level" THEN BEGIN
        DeterminePrognosisTotalContractCost;
        DeterminePrognosisTotalContractRevenueSO;
        EXIT;
      END;
      PostingDateFilter := STRSUBSTNO('..%1', "Prognosis Date");
      CASE "Line Type" OF
        "Line Type"::Period:
          BEGIN
            ServiceCategory.SETFILTER("Service Contract No.", '<>%1&%2', '', "Service Contract No.");
            IF ServiceCategory.FINDFIRST THEN BEGIN
              "Exclude SOs From Est. Result" := ServiceCategory."Exclude SOs From Est. Result";
              ServiceCategory.SETRANGE("Exclude SOs From Est. Result", NOT ServiceCategory."Exclude SOs From Est. Result");
              IF NOT ServiceCategory.ISEMPTY THEN
                "Exclude SOs From Est. Result" := TRUE;
            END;
          END;
        "Line Type"::"Service Category":;
        "Line Type"::"Source Type":;
        "Line Type"::"Service Order":
          BEGIN
            IF "Service Order No." <> '' THEN BEGIN
              ServiceOrder.GET("Service Order No.");
              VALIDATE("Budget Cost", SCControlbyPeriodMgt.GetSOBudget("Service Order No.", 0));
              "Actual Cost" := SCControlbyPeriodMgt.GetSOActualCost("Service Order No.", 0, PostingDateFilter);
              "Actual Cost (Additional)" := SCControlbyPeriodMgt.GetSOActualCost("Service Order No.", 2, PostingDateFilter);

              "Open (Purchase)" := SCControlbyPeriodMgt.GetSOOpenPurchase("Service Order No.", 0, PostingDateFilter);
              "Open Ovh. Surch. Soft (Purch.)" := SCControlbyPeriodMgt.GetOpenPurchaseSurcharge("Service Order No.", 0, PostingDateFilter);
              "Received/Not Invoiced" := SCControlbyPeriodMgt.GetSOReceivedNotInvoiced("Service Order No.", 0, PostingDateFilter);
              "Open Ovh. Surch. Firm (Purch.)" := SCControlbyPeriodMgt.GetSOReceivedNotInvoicedSurcharge("Service Order No.", 0, PostingDateFilter);
              "Open (Inventory)" := SCControlbyPeriodMgt.GetSOOpenInventoryAmount("Service Order No.", 0, PostingDateFilter);
              "Open Ovh. Surch. (Inventory)" := SCControlbyPeriodMgt.GetSOOpenInventorySurchargeAmount("Service Order No.", 0, PostingDateFilter);
              "Open Amount (Hours)" := SCControlbyPeriodMgt.GetSOOpenHoursAmount("Service Order No.", 0, PostingDateFilter);
              "Open Ovh. Surch. (Hours)" := SCControlbyPeriodMgt.GetSOOpenHoursAmountSurcharge("Service Order No.", 0, PostingDateFilter);
              VALIDATE("Total Cost",
                "Actual Cost" + "Open (Purchase)" + "Open Ovh. Surch. Soft (Purch.)" + "Received/Not Invoiced" +
                "Open Ovh. Surch. Firm (Purch.)" + "Open (Inventory)" + "Open Ovh. Surch. (Inventory)" +
                "Open Amount (Hours)" + "Open Ovh. Surch. (Hours)");
              "Total Cost (Additional)" :=
                "Actual Cost (Additional)" +
                SCControlbyPeriodMgt.GetSOOpenPurchase("Service Order No.", 2, PostingDateFilter) +
                SCControlbyPeriodMgt.GetOpenPurchaseSurcharge("Service Order No.", 2, PostingDateFilter) +
                SCControlbyPeriodMgt.GetSOReceivedNotInvoiced("Service Order No.", 2, PostingDateFilter) +
                SCControlbyPeriodMgt.GetSOReceivedNotInvoicedSurcharge("Service Order No.", 2, PostingDateFilter) +
                SCControlbyPeriodMgt.GetSOOpenInventoryAmount("Service Order No.", 2, PostingDateFilter) +
                SCControlbyPeriodMgt.GetSOOpenInventorySurchargeAmount("Service Order No.", 2, PostingDateFilter) +
                SCControlbyPeriodMgt.GetSOOpenHoursAmount("Service Order No.", 2, PostingDateFilter) +
                SCControlbyPeriodMgt.GetSOOpenHoursAmountSurcharge("Service Order No.", 2, PostingDateFilter);

              "Budget Hours" := SCControlbyPeriodMgt.GetSOBudgetHours("Service Order No.", 0);
              "Actual Hours" := SCControlbyPeriodMgt.GetSOActualHours("Service Order No.", 0, PostingDateFilter);
              "Actual Hours (Additional)" := SCControlbyPeriodMgt.GetSOActualHours("Service Order No.", 2, PostingDateFilter);
              "Open Hours" := SCControlbyPeriodMgt.GetSOOpenHours("Service Order No.", 0, PostingDateFilter);
              "Total Hours" := "Actual Hours" + "Open Hours";
              "Total Hours (Additional)" :=
                "Actual Hours (Additional)" +
                SCControlbyPeriodMgt.GetSOOpenHours("Service Order No.", 2, PostingDateFilter);
              "Allowed Hours" := SCControlbyPeriodMgt.GetSOAllowedHours("Service Order No.", 0);
              "Result Hours" := "Allowed Hours" - "Total Hours";
              "Budget Revenue (Order)" := SCControlbyPeriodMgt.GetSOBudgetRevenue("Service Order No.", 0, PostingDateFilter);
              "Total Budget Revenue" := "Budget Revenue (Order)";
              IF (ServiceContract."Budget Based on" = ServiceContract."Budget Based on"::Category) OR
                 (("Source Type" <> "Source Type"::Contract) AND (ServiceContract."Budget Based on" = ServiceContract."Budget Based on"::"Category + Maintenance Scheme"))
              THEN
                ConsumeServiceCategoryBudget;

              "Revenue Amount" := SCControlbyPeriodMgt.GetSORevenue("Service Order No.", 0, PostingDateFilter);
              "Revenue Amount (Additional)" := SCControlbyPeriodMgt.GetSORevenue("Service Order No.", 2, PostingDateFilter);
              "Contract Financing Balance" := "Revenue Amount" - "Actual Cost";

              "Allowed Cost" := SCControlbyPeriodMgt.GetSOAllowedCost("Service Order No.", 0);
              Result := "Allowed Cost" - "Total Cost";
              SCControlbyPeriodMgt.GetTotalCostBalanceSheetOrPL("Service Contract No.", "Service Category", "Service Order No.", "Source Type",
                "Starting Date", "Ending Date", PostingDateFilter, "Total Cost (WIP) on Bal. Sheet", "Total Rev. (WIP) on Bal. Sheet", "Total Cost (WIP) on P&L", "Total Revenue (WIP) on P&L");

              "Service Order Status" := SCControlbyPeriodMgt.GetSOStatus("Service Order No.");
              "Closed Revenue" := SCControlbyPeriodMgt.GetSOClosedRevenue("Service Order No.", 0, PostingDateFilter);
              "Closed Cost" := SCControlbyPeriodMgt.GetSOClosedCost("Service Order No.", 0, PostingDateFilter);

              "Budget Costs Incl. Deviation" := "Budget Cost" + "Deviation From Budget";
              DetermineCalcPrognosisTotalCost;
              IF "Service Order Status" IN ["Service Order Status"::"Administrative Finished", "Service Order Status"::Finished] THEN
                "Calc. Progn. Total Rev. (SO)" := "Revenue Amount"
              ELSE
                "Calc. Progn. Total Rev. (SO)" := "Total Budget Revenue";
              "Prognosis Total Revenue (SO)" := "Calc. Progn. Total Rev. (SO)";
              DeterminePrognosisTotalContractCost;
              DeterminePrognosisTotalContractRevenueSO;
            END ELSE
              IF "Calc. Interim Results by Order" THEN
                "Zero Line" := TRUE
              ELSE BEGIN
                IF ServiceContract."Control Details" = ServiceContract."Control Details"::"Cost Type/Cost Object" THEN
                  SCControlbyPeriodMgt.SetCalculateCostTypeAmounts(TRUE, FALSE);
                "Budget Cost" :=
                  SCControlbyPeriodMgt.GetMaintenanceBudgetAndRevenue(
                    "Service Contract No.", "Control Period Code", "Starting Date", "Ending Date", "Service Category", "Source Type", "Line Type",
                    PostingDateFilter, "Revenue Amount", "Budget Hours", "Budget Revenue (Order)");
                "Original Budget Hours" := "Budget Hours";
                "Original Budget Cost" := "Budget Cost";
                Available := "Budget Cost";
                SCControlbyPeriodMgt.GetTotalCostBalanceSheetOrPL("Service Contract No.", "Service Category", "Service Order No.", "Source Type",
                  "Starting Date", "Ending Date", PostingDateFilter, "Total Cost (WIP) on Bal. Sheet", "Total Rev. (WIP) on Bal. Sheet", "Total Cost (WIP) on P&L", "Total Revenue (WIP) on P&L");
                IF "Source Type" IN ["Source Type"::Call, "Source Type"::Contract] THEN BEGIN
                  IF NOT ServiceContract.GET("Service Contract No.") THEN
                    ServiceContract.INIT;
                  IF "Service Category" <> '' THEN
                    Factor := ServiceContract.GetCategoryDivisionPercentageShareCalls("Service Category", "Ending Date") / 100
                  ELSE
                    Factor := ServiceContract.GetPercentageShareCalls("Ending Date") / 100;
                  IF "Source Type" = "Source Type"::Contract THEN
                    Factor := 1 - Factor;
                  IF Factor <> 0 THEN BEGIN
                    "Budget Revenue (Contract)" :=
                       GetBudgetRevenueContract(ServiceContract) * Factor;
                    "Paid Amount" :=
                      SCControlbyPeriodMgt.GetPaidAmount(
                        0, "Service Contract No.", "Starting Date", "Ending Date", "Service Category", '', 0, PostingDateFilter) * Factor;
                    "Closed Revenue" :=
                      SCControlbyPeriodMgt.GetSCClosedRevenue(
                        "Service Contract No.", "Starting Date", "Ending Date", "Service Category", 0, PostingDateFilter) * Factor;
                    "Closed Cost" :=
                      SCControlbyPeriodMgt.GetSCClosedCost(
                        "Service Contract No.", "Starting Date", "Ending Date", "Service Category", 0, PostingDateFilter) * Factor;
                  END;
                  IF "Source Type" = "Source Type"::Call THEN BEGIN
                    ReleasePercentage := SCBudgetCallsRelease.CalcTotalReleasePerc("Service Contract No.", "Starting Date", "Prognosis Date", "Ending Date");
                    "Allowed Cost" := "Budget Cost" * ReleasePercentage / 100;
                    "Allowed Hours" := "Budget Hours" * ReleasePercentage / 100;
                    SCControlbyPeriodMgt.UpdateTmpServicePrognosisByCostType(1, ReleasePercentage, TRUE);
                  END;
                END;
                RoundAmounts;
                "Total Budget Revenue" := "Budget Revenue (Order)" + "Budget Revenue (Contract)";
                "Contract Financing Balance" := "Revenue Amount";
                "Budget Costs Incl. Deviation" := "Budget Cost" + "Deviation From Budget";
                "Calc. Prognosis Total Cost" := "Budget Costs Incl. Deviation";
                "Calc. Progn. Total Rev. (SC)" := "Budget Revenue (Contract)";
                "Calc. Progn. Total Rev. (SO)" := "Budget Revenue (Order)";
                "Prognosis Total Cost" := "Calc. Prognosis Total Cost";
                "Prognosis Total Revenue (SC)" := "Calc. Progn. Total Rev. (SC)";
                "Prognosis Total Revenue (SO)" := "Calc. Progn. Total Rev. (SO)";
                SCControlbyPeriodMgt.GetCompressedTmpServicePrognosisByCostType(Rec);
                DeterminePrognosisTotalContractCost;
                DeterminePrognosisTotalContractRevenueSC;
              END;
              "Zero Line" := DetermineZeroLine;
            END;
      END;
      IF NOT "Exclude SOs From Est. Result" THEN BEGIN
        "Precalc. Result vs Budget" := "Total Budget Revenue" - "Budget Cost";
        "Precalc. Res. Incl. Deviation" := "Total Budget Revenue" - "Budget Cost" - "Deviation From Budget";
      END;
      "Contract Amount" := SCControlbyPeriodMgt.GetSCAmount("Service Contract No.", "Starting Date", "Ending Date");
      "Contr. Fin. Bal. Without Clos." := "Contract Financing Balance" - ("Closed Revenue" - "Closed Cost");
      DeterminePrognosisFinancialResult;
      SCControlbyPeriodMgt.GetPreclosureResultValues("Service Contract No.", "Control Period Code", "Service Category", "Service Order No.",
        "Global Dimension 1 Code", "Line Type", "Source Type", "Posted Preclosure Result", "Posted Provision Loss");
      IF "Line Type" = "Line Type"::"Service Order" THEN
        DetermineProgressPercentage;
    END;

    PROCEDURE DetermineTotals@1100528608();
    VAR
      ServiceContract@1100528602 : Record 11012812;
      ServicePrognosisLine@1100528601 : Record 11072310;
      LowerLevelLineType@1100528600 : Option;
    BEGIN
      IF NOT ServiceContract.GET("Service Contract No.") THEN
        ServiceContract.INIT;
      CASE "Line Type" OF
        "Line Type"::Period:
          IF ServiceContract."Budget Based on" = ServiceContract."Budget Based on"::"Maintenance Scheme" THEN
            LowerLevelLineType := "Line Type"::"Source Type"
          ELSE
            LowerLevelLineType := "Line Type"::"Service Category";
        "Line Type"::"Service Category":
          LowerLevelLineType := "Line Type"::"Source Type";
        "Line Type"::"Source Type":
          LowerLevelLineType := "Line Type"::"Service Order";
      END;
      ServicePrognosisLine.SETRANGE("Prognosis Date", "Prognosis Date");
      ServicePrognosisLine.SETRANGE("Prognosis Seq. No.", "Prognosis Seq. No.");
      ServicePrognosisLine.SETRANGE("Service Contract No.", "Service Contract No.");
      IF "Service Contract No." = '' THEN
        ServicePrognosisLine.SETRANGE("Global Dimension 1 Code", "Global Dimension 1 Code");
      ServicePrognosisLine.SETRANGE("Control Period Code", "Control Period Code");
      IF "Line Type" IN ["Line Type"::"Service Category", "Line Type"::"Source Type"] THEN
        ServicePrognosisLine.SETRANGE("Service Category", "Service Category");
      IF "Line Type" IN ["Line Type"::"Source Type"] THEN
        ServicePrognosisLine.SETRANGE("Source Type", "Source Type");
      ServicePrognosisLine.SETRANGE("Line Type", LowerLevelLineType);
      ServicePrognosisLine.CALCSUMS(
        "Budget Cost", "Actual Cost", "Open (Purchase)", "Open Ovh. Surch. Soft (Purch.)", "Received/Not Invoiced",
        "Open Ovh. Surch. Firm (Purch.)", "Open (Inventory)", "Open Ovh. Surch. (Inventory)", "Open Amount (Hours)",
        "Open Ovh. Surch. (Hours)", "Total Cost", "Total Cost (Additional)", Available, "Budget Hours", "Actual Hours",
        "Open Hours", "Total Hours", "Total Hours (Additional)", "Allowed Hours", "Result Hours");
      ServicePrognosisLine.CALCSUMS("Original Budget Hours", "Original Budget Cost", "Precalc. Result vs Budget",
        "Closed Cost", "Closed Revenue", "Contr. Fin. Bal. Without Clos.");
      ServicePrognosisLine.CALCSUMS(
        "Budget Revenue (Contract)", "Budget Revenue (Order)", "Total Budget Revenue", "Revenue Amount", "Revenue Amount (Additional)",
        "Contract Financing Balance", "Allowed Cost", Result, "Precalc. Res. Incl. Deviation");
      ServicePrognosisLine.CALCSUMS("Calc. Prognosis Total Cost", "Calc. Progn. Total Rev. (SC)", "Calc. Progn. Total Rev. (SO)",
        "Prognosis Total Cost", "Prognosis Total Revenue (SC)", "Prognosis Total Revenue (SO)");
      ServicePrognosisLine.CALCSUMS("Actual Cost (Additional)", "Actual Hours (Additional)",
        "Total Cost (WIP) on Bal. Sheet", "Total Rev. (WIP) on Bal. Sheet", "Total Cost (WIP) on P&L", "Total Revenue (WIP) on P&L");
      IF "Rest of Contract" THEN
        ServicePrognosisLine.CALCSUMS("Prognosis Total Contract Cost", "Prognosis Total Contr. Rev. SC", "Prognosis Total Contr. Rev. SO");

      "Budget Cost" := ServicePrognosisLine."Budget Cost";
      "Original Budget Cost" := ServicePrognosisLine."Original Budget Cost";
      "Actual Cost" := ServicePrognosisLine."Actual Cost";
      "Actual Cost (Additional)" := ServicePrognosisLine."Actual Cost (Additional)";
      "Open (Purchase)" := ServicePrognosisLine."Open (Purchase)";
      "Open Ovh. Surch. Soft (Purch.)" := ServicePrognosisLine."Open Ovh. Surch. Soft (Purch.)";
      "Received/Not Invoiced" := ServicePrognosisLine."Received/Not Invoiced";
      "Open Ovh. Surch. Firm (Purch.)" := ServicePrognosisLine."Open Ovh. Surch. Firm (Purch.)";
      "Open (Inventory)" := ServicePrognosisLine."Open (Inventory)";
      "Open Ovh. Surch. (Inventory)" := ServicePrognosisLine."Open Ovh. Surch. (Inventory)";
      "Open Amount (Hours)" := ServicePrognosisLine."Open Amount (Hours)";
      "Open Ovh. Surch. (Hours)" := ServicePrognosisLine."Open Ovh. Surch. (Hours)";
      "Total Cost" := ServicePrognosisLine."Total Cost";
      "Total Cost (Additional)" := ServicePrognosisLine."Total Cost (Additional)";
      Available := ServicePrognosisLine.Available;

      "Budget Hours" := ServicePrognosisLine."Budget Hours";
      "Original Budget Hours" := ServicePrognosisLine."Original Budget Hours";
      "Actual Hours" := ServicePrognosisLine."Actual Hours";
      "Actual Hours (Additional)" := ServicePrognosisLine."Actual Hours (Additional)";
      "Open Hours" := ServicePrognosisLine."Open Hours";
      "Total Hours" := ServicePrognosisLine."Total Hours";
      "Total Hours (Additional)" := ServicePrognosisLine."Total Hours (Additional)";
      "Allowed Hours" := ServicePrognosisLine."Allowed Hours";
      "Result Hours" := ServicePrognosisLine."Result Hours";

      "Budget Revenue (Contract)" := ServicePrognosisLine."Budget Revenue (Contract)";
      "Budget Revenue (Order)" := ServicePrognosisLine."Budget Revenue (Order)";
      "Total Budget Revenue" := ServicePrognosisLine."Total Budget Revenue";
      "Revenue Amount" := ServicePrognosisLine."Revenue Amount";
      "Revenue Amount (Additional)" := ServicePrognosisLine."Revenue Amount (Additional)";
      "Contract Financing Balance" := ServicePrognosisLine."Contract Financing Balance";
      "Allowed Cost" := ServicePrognosisLine."Allowed Cost";
      Result := ServicePrognosisLine.Result;

      "Total Cost (WIP) on Bal. Sheet" := ServicePrognosisLine."Total Cost (WIP) on Bal. Sheet";
      "Total Rev. (WIP) on Bal. Sheet" := ServicePrognosisLine."Total Rev. (WIP) on Bal. Sheet";
      "Total Cost (WIP) on P&L" := ServicePrognosisLine."Total Cost (WIP) on P&L";
      "Total Revenue (WIP) on P&L" := ServicePrognosisLine."Total Revenue (WIP) on P&L";

      "Prognosis Total Cost" := ServicePrognosisLine."Prognosis Total Cost";
      "Prognosis Total Revenue (SC)" := ServicePrognosisLine."Prognosis Total Revenue (SC)";
      "Prognosis Total Revenue (SO)" := ServicePrognosisLine."Prognosis Total Revenue (SO)";
      "Calc. Prognosis Total Cost" := ServicePrognosisLine."Calc. Prognosis Total Cost";
      "Calc. Progn. Total Rev. (SC)" := ServicePrognosisLine."Calc. Progn. Total Rev. (SC)";
      "Calc. Progn. Total Rev. (SO)" := ServicePrognosisLine."Calc. Progn. Total Rev. (SO)";
      "Lower Level Progn. Total Cost" := ServicePrognosisLine."Prognosis Total Cost";
      "Low. Level Progn. Tot.Rev.(SC)" := ServicePrognosisLine."Prognosis Total Revenue (SC)";
      "Low. Level Progn. Tot.Rev.(SO)" := ServicePrognosisLine."Prognosis Total Revenue (SO)";
      IF "Rest of Contract" THEN BEGIN
        "Prognosis Total Contract Cost" := ServicePrognosisLine."Prognosis Total Contract Cost";
        "Prognosis Total Contr. Rev. SC" := ServicePrognosisLine."Prognosis Total Contr. Rev. SC";
        "Prognosis Total Contr. Rev. SO" := ServicePrognosisLine."Prognosis Total Contr. Rev. SO";
        "Low. Lv. Pr. Total Contr. Cost" := ServicePrognosisLine."Prognosis Total Contract Cost";
        "Low. L. Pr. Tot Contr. Rev. SC" := ServicePrognosisLine."Prognosis Total Contr. Rev. SC";
        "Low. L. Pr. Tot Contr. Rev. SO" := ServicePrognosisLine."Prognosis Total Contr. Rev. SO";
      END;
      IF (NOT "Exclude SOs From Est. Result") OR ("Line Type" = "Line Type"::Period) THEN BEGIN
        "Precalc. Result vs Budget" := ServicePrognosisLine."Precalc. Result vs Budget";
        "Precalc. Res. Incl. Deviation" := ServicePrognosisLine."Precalc. Res. Incl. Deviation";
      END;
      DeterminePrognosisFinancialResult;
      DetermineProgressPercentage;

      "Paid Amount" := ServicePrognosisLine."Paid Amount";
      "Closed Revenue" := ServicePrognosisLine."Closed Revenue";
      "Closed Cost" := ServicePrognosisLine."Closed Cost";
      "Contr. Fin. Bal. Without Clos." := ServicePrognosisLine."Contr. Fin. Bal. Without Clos.";

      ServicePrognosisLine.SETRANGE("Zero Line", FALSE);
      "Zero Line" := DetermineZeroLine AND ServicePrognosisLine.ISEMPTY;
    END;

    LOCAL PROCEDURE DetermineProgressMethod@1100528618();
    VAR
      ServiceContract@1100528600 : Record 11012812;
      ServiceCategory@1100528602 : Record 11071985;
      ServicePrognosisManagement@1100528601 : Codeunit 11012884;
    BEGIN
      IF "Service Contract No." <> '' THEN BEGIN
        ServiceContract.GET("Service Contract No.");
        IF ("Service Category" = '') OR ServiceContract."Result Calc. on Total Contract" THEN BEGIN
          ServicePrognosisManagement.TestProgressMethodvsProgressMeasurement("Service Contract No.", ServiceContract."Calc. Progress Perc. Progn/Res", ServiceContract."Level Progress Measurement");
          "Progress Method" := ServiceContract."Calc. Progress Perc. Progn/Res";
        END ELSE BEGIN
          ServiceCategory.GET("Service Contract No.", "Service Category");
          ServicePrognosisManagement.TestProgressMethodvsProgressMeasurement("Service Contract No.", ServiceCategory."Calc. Progress Perc. Progn/Res", ServiceContract."Level Progress Measurement");
          "Progress Method" := ServiceCategory."Calc. Progress Perc. Progn/Res";
        END;
      END ELSE
        "Progress Method" := "Progress Method"::None;
    END;

    PROCEDURE DetermineProgressPercentage@1100528623();
    VAR
      Date@1100528600 : Record 2000000007;
      NoOfDaysPast@1100528601 : Integer;
    BEGIN
      IF "Service Contract No." = '' THEN BEGIN
        "Calculated Cum. Progress %" := 100;
        "Cumulative Progress %" := "Calculated Cum. Progress %";
        EXIT;
      END;
      "Calculated Cum. Progress %" := 0;
      "Cumulative Progress %" := 0;
      IF "Level Progress Measurement" + 1 = "Line Type" THEN BEGIN
        CASE "Progress Method" OF
          "Progress Method"::"Allowed Hours":
            CASE "Source Type" OF
              "Source Type"::Call,
              "Source Type"::Contract:
                IF "Budget Hours" <> 0 THEN
                  "Calculated Cum. Progress %" := "Allowed Hours" / "Budget Hours" * 100;
              "Source Type"::Direct:
                "Calculated Cum. Progress %" := 100;
            END;
          "Progress Method"::"Allowed Cost":
            CASE "Source Type" OF
              "Source Type"::Call,
              "Source Type"::Contract:
                IF "Budget Cost" <> 0 THEN
                  "Calculated Cum. Progress %" := "Allowed Cost" / "Budget Cost" * 100;
              "Source Type"::Direct:
                "Calculated Cum. Progress %" := 100;
            END;
          "Progress Method"::"Actual Cost":
            IF "Prognosis Total Cost" <> 0 THEN
              "Calculated Cum. Progress %" := "Actual Cost" / "Prognosis Total Cost" * 100;
          "Progress Method"::"Elapsed Time":
            BEGIN
              Date.SETRANGE("Period Type", Date."Period Type"::Date);
              IF "Prognosis Date" > "Ending Date" THEN
                Date.SETRANGE("Period Start", "Starting Date", "Ending Date")
              ELSE
                Date.SETRANGE("Period Start", "Starting Date", "Prognosis Date");
              NoOfDaysPast := Date.COUNT;
              Date.SETRANGE("Period Start", "Starting Date", "Ending Date");
              IF NOT Date.ISEMPTY THEN
                "Calculated Cum. Progress %" := NoOfDaysPast / Date.COUNT * 100;
            END;
          "Progress Method"::"Available Hours":
            CASE "Source Type" OF
              "Source Type"::Call,
              "Source Type"::Contract:
                IF "Budget Hours" <> 0 THEN
                  "Calculated Cum. Progress %" := ("Actual Hours" - "Actual Hours (Additional)") / "Budget Hours" * 100;
              "Source Type"::Direct:
                "Calculated Cum. Progress %" := 100;
            END;
          "Progress Method"::"Available Cost":
            CASE "Source Type" OF
              "Source Type"::Call,
              "Source Type"::Contract:
                IF "Budget Cost" <> 0 THEN
                  "Calculated Cum. Progress %" := ("Actual Cost" - "Actual Cost (Additional)") / "Budget Cost" * 100;
              "Source Type"::Direct:
                "Calculated Cum. Progress %" := 100;
            END;
          "Progress Method"::None:
            "Cumulative Progress %" := 0;
        END;
        IF "Calculated Cum. Progress %" > 100 THEN
          "Calculated Cum. Progress %" := 100;
        IF "Calculated Cum. Progress %" < 0 THEN
          "Calculated Cum. Progress %" := 0;
        "Cumulative Progress %" := "Calculated Cum. Progress %";
      END;
    END;

    PROCEDURE GetLineLevelDescription@1100528600() LevelDescription : Text;
    VAR
      CaptionManagement@1100529600 : Codeunit 42;
    BEGIN
      CASE "Line Type" OF
        "Line Type"::Period:
          BEGIN
            IF "Service Contract No." <> '' THEN
              LevelDescription := STRSUBSTNO('%1: %2, ', Text005, "Service Contract No.")
            ELSE
              IF "Global Dimension 1 Code" <> '' THEN
                LevelDescription := STRSUBSTNO('%1: %2, ', CaptionManagement.CaptionClassTranslate(GLOBALLANGUAGE, '1,1,1'), "Global Dimension 1 Code");
            IF "Rest of Contract" THEN
              LevelDescription += STRSUBSTNO('%1: %2 - %3', FIELDCAPTION("Rest of Contract"), "Starting Date", "Ending Date")
            ELSE
              LevelDescription += STRSUBSTNO('%1: %2 - %3', Text001, "Starting Date", "Ending Date");
          END;
        "Line Type"::"Service Category":
          LevelDescription := STRSUBSTNO('%1: %2', FIELDCAPTION("Service Category"), "Service Category");
        "Line Type"::"Source Type":
          LevelDescription := STRSUBSTNO('%1: %2', FIELDCAPTION("Source Type"), "Source Type");
        "Line Type"::"Service Order":
            IF "Service Order No." <> '' THEN
              LevelDescription := STRSUBSTNO('%1: %2', FIELDCAPTION("Service Order No."), "Service Order No.")
            ELSE
              IF "Total Service Order Level" THEN
                LevelDescription := FIELDCAPTION("Total Service Order Level")
              ELSE
                LevelDescription := Text002;
      END;
    END;

    PROCEDURE RefreshValues@1100528621(VAR IServicePrognosisLine@1100528600 : Record 11072310);
    VAR
      MarkedServicePrognosisLine@1100528601 : Record 11072310;
      ProgressDialog@1100528602 : Dialog;
      TotalNoOfLines@1100528603 : Integer;
      NoOfLinesProcessed@1100528604 : Integer;
    BEGIN
      IF IServicePrognosisLine.FINDSET THEN
        REPEAT
          MarkedServicePrognosisLine.SETRANGE("Prognosis Date", IServicePrognosisLine."Prognosis Date");
          MarkedServicePrognosisLine.SETRANGE("Prognosis Seq. No.", IServicePrognosisLine."Prognosis Seq. No.");
          MarkedServicePrognosisLine.SETRANGE("Service Contract No.", IServicePrognosisLine."Service Contract No.");
          MarkedServicePrognosisLine.SETRANGE("Global Dimension 1 Code", IServicePrognosisLine."Global Dimension 1 Code");
          IF MarkedServicePrognosisLine.FINDSET THEN
            REPEAT
              MarkedServicePrognosisLine.MARK(TRUE);
            UNTIL MarkedServicePrognosisLine.NEXT = 0;
        UNTIL IServicePrognosisLine.NEXT = 0;
      MarkedServicePrognosisLine.SETRANGE("Prognosis Date");
      MarkedServicePrognosisLine.SETRANGE("Prognosis Seq. No.");
      MarkedServicePrognosisLine.SETRANGE("Service Contract No.");
      MarkedServicePrognosisLine.SETRANGE("Global Dimension 1 Code");
      MarkedServicePrognosisLine.MARKEDONLY(TRUE);
      IF MarkedServicePrognosisLine.FINDSET THEN BEGIN
        IF GUIALLOWED THEN
          ProgressDialog.OPEN(Text006);
        TotalNoOfLines := MarkedServicePrognosisLine.COUNT;
        REPEAT
          MarkedServicePrognosisLine.DetermineValues;
          MarkedServicePrognosisLine.MODIFY(TRUE);
          NoOfLinesProcessed += 1;
          IF GUIALLOWED THEN
            ProgressDialog.UPDATE(1, ROUND(NoOfLinesProcessed / TotalNoOfLines * 10000, 1));
        UNTIL MarkedServicePrognosisLine.NEXT = 0;
      END;
      MarkedServicePrognosisLine.SETRANGE("Line Type", MarkedServicePrognosisLine."Line Type"::Period);
      IF MarkedServicePrognosisLine.FINDSET THEN BEGIN
        TotalNoOfLines := MarkedServicePrognosisLine.COUNT;
        NoOfLinesProcessed := 0;
        REPEAT
          MarkedServicePrognosisLine.DetermineTotals;
          NoOfLinesProcessed += 1;
          IF GUIALLOWED THEN
            ProgressDialog.UPDATE(2, ROUND(NoOfLinesProcessed / TotalNoOfLines * 10000, 1));
        UNTIL MarkedServicePrognosisLine.NEXT = 0;
      END;
      IF GUIALLOWED THEN
        ProgressDialog.CLOSE;
    END;

    LOCAL PROCEDURE "----"@1100528602();
    BEGIN
    END;

    PROCEDURE ShowCard@1100528601();
    VAR
      ServiceOrder@1100528601 : Record 11012823;
    BEGIN
      IF CanDrillDownOnServiceOrder THEN BEGIN
        ServiceOrder.GET("Service Order No.");
        ServiceOrder.ActivateServOrderCard;
      END;
    END;

    PROCEDURE CanDrillDownOnServiceOrder@1100528604() : Boolean;
    BEGIN
      IF ("Line Type" = "Line Type"::"Service Order") AND ("Service Order No." <> '') THEN
        EXIT(TRUE)
      ELSE
        MESSAGE(Text004);
    END;

    LOCAL PROCEDURE "-----"@1100528607();
    BEGIN
    END;

    PROCEDURE UpdateUpperLevelPrognosisAmounts@1100528611(OLineType@1100528604 : Option;UpdateFieldNo@1100529601 : Integer);
    VAR
      ServiceContract@1100528603 : Record 11012812;
      ServicePrognosisLine@1100528601 : Record 11072310;
      UpperServicePrognosisLine@1100528600 : Record 11072310;
      UpperLevelLineType@1100528602 : Option;
      PrecalcResultIncludingDeviation@1100529600 : Decimal;
      RecalcVCResult@1100529602 : Boolean;
    BEGIN
      IF OLineType = "Line Type"::Period THEN
        EXIT;
      IF NOT ServiceContract.GET("Service Contract No.") THEN
        ServiceContract.INIT;
      UpperLevelLineType := OLineType -1;
      UpperServicePrognosisLine.SETRANGE("Prognosis Date", "Prognosis Date");
      UpperServicePrognosisLine.SETRANGE("Prognosis Seq. No.", "Prognosis Seq. No.");
      UpperServicePrognosisLine.SETRANGE("Service Contract No.", "Service Contract No.");
      IF "Service Contract No." = '' THEN
        UpperServicePrognosisLine.SETRANGE("Global Dimension 1 Code", "Global Dimension 1 Code");
      UpperServicePrognosisLine.SETRANGE("Control Period Code", "Control Period Code");
      UpperServicePrognosisLine.SETRANGE("Line Type", UpperLevelLineType);
      CASE OLineType OF
        "Line Type"::"Source Type":
          IF ServiceContract."Budget Based on" IN [ServiceContract."Budget Based on"::Category, ServiceContract."Budget Based on"::"Category + Maintenance Scheme"] THEN
            UpperServicePrognosisLine.SETRANGE("Service Category", "Service Category")
          ELSE BEGIN
            UpperLevelLineType := UpperLevelLineType - 1; // skip category level
            UpperServicePrognosisLine.SETRANGE("Line Type", UpperLevelLineType);
          END;
        "Line Type"::"Service Order":
          BEGIN
            UpperServicePrognosisLine.SETRANGE("Service Category", "Service Category");
            UpperServicePrognosisLine.SETRANGE("Source Type", "Source Type");
          END;
      END;
      IF NOT UpperServicePrognosisLine.FINDFIRST THEN
        EXIT;

      ServicePrognosisLine.SETRANGE("Prognosis Date", UpperServicePrognosisLine."Prognosis Date");
      ServicePrognosisLine.SETRANGE("Prognosis Seq. No.", UpperServicePrognosisLine."Prognosis Seq. No.");
      IF OLineType = "Line Type" THEN
        ServicePrognosisLine.SETFILTER("Line No.", '<>%1', "Line No.");
      ServicePrognosisLine.SETRANGE("Service Contract No.", UpperServicePrognosisLine."Service Contract No.");
      IF UpperServicePrognosisLine."Service Contract No." = '' THEN
        ServicePrognosisLine.SETRANGE("Global Dimension 1 Code", UpperServicePrognosisLine."Global Dimension 1 Code");
      ServicePrognosisLine.SETRANGE("Control Period Code", UpperServicePrognosisLine."Control Period Code");
      CASE OLineType OF
        "Line Type"::"Source Type":
          IF ServiceContract."Budget Based on" IN [ServiceContract."Budget Based on"::Category, ServiceContract."Budget Based on"::"Category + Maintenance Scheme"] THEN
            ServicePrognosisLine.SETRANGE("Service Category", "Service Category");
        "Line Type"::"Service Order":
          BEGIN
            ServicePrognosisLine.SETRANGE("Service Category", "Service Category");
            ServicePrognosisLine.SETRANGE("Source Type", "Source Type");
          END;
      END;
      ServicePrognosisLine.SETRANGE("Line Type", OLineType);
      ServicePrognosisLine.CALCSUMS("Prognosis Total Cost", "Prognosis Total Revenue (SC)", "Prognosis Total Revenue (SO)", "Deviation From Budget", "Budget Costs Incl. Deviation");
      IF "Rest of Contract" THEN
        ServicePrognosisLine.CALCSUMS("Prognosis Total Contract Cost", "Prognosis Total Contr. Rev. SC", "Prognosis Total Contr. Rev. SO");

      RecalcVCResult := (UpdateFieldNo = FIELDNO("Deviation From Budget")) AND UpperServicePrognosisLine."Exclude SOs From Est. Result" AND (UpperServicePrognosisLine."Line Type" = UpperServicePrognosisLine."Line Type"::Period);
      IF RecalcVCResult THEN BEGIN
        ServicePrognosisLine.CALCSUMS("Precalc. Res. Incl. Deviation");
        PrecalcResultIncludingDeviation := ServicePrognosisLine."Precalc. Res. Incl. Deviation";
      END;

      UpperServicePrognosisLine."Lower Level Progn. Total Cost" := ServicePrognosisLine."Prognosis Total Cost";
      UpperServicePrognosisLine."Low. Level Dev. From Budget" := ServicePrognosisLine."Deviation From Budget";
      UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)" := ServicePrognosisLine."Prognosis Total Revenue (SC)";
      UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)" := ServicePrognosisLine."Prognosis Total Revenue (SO)";
      IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
        UpperServicePrognosisLine."Low. Lv. Pr. Total Contr. Cost" := ServicePrognosisLine."Prognosis Total Contract Cost";
        UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SC" := ServicePrognosisLine."Prognosis Total Contr. Rev. SC";
        UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SO" := ServicePrognosisLine."Prognosis Total Contr. Rev. SO";
      END;
      IF OLineType = "Line Type" THEN BEGIN
        UpperServicePrognosisLine."Lower Level Progn. Total Cost" += "Prognosis Total Cost";
        UpperServicePrognosisLine."Low. Level Dev. From Budget" += "Deviation From Budget";
        UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)" += "Prognosis Total Revenue (SC)";
        UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)" += "Prognosis Total Revenue (SO)";
        IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
          UpperServicePrognosisLine."Low. Lv. Pr. Total Contr. Cost" += "Prognosis Total Contract Cost";
          UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SC" += "Prognosis Total Contr. Rev. SC";
          UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SO" += "Prognosis Total Contr. Rev. SO";
        END;
        IF RecalcVCResult THEN
          PrecalcResultIncludingDeviation += "Precalc. Res. Incl. Deviation";
      END;

      IF NOT DontUpdatePrognosisValueViaLowerLevelValue THEN BEGIN
        CheckPrognosisOnCostTypeLevel(UpperServicePrognosisLine);

        CASE UpdateFieldNo OF
          FIELDNO("Deviation From Budget"):
            BEGIN
              UpperServicePrognosisLine."Deviation From Budget" := UpperServicePrognosisLine."Low. Level Dev. From Budget";
              UpperServicePrognosisLine."Budget Costs Incl. Deviation" := ServicePrognosisLine."Budget Costs Incl. Deviation";
              IF OLineType = "Line Type" THEN
                UpperServicePrognosisLine."Budget Costs Incl. Deviation" += "Budget Costs Incl. Deviation";
              UpperServicePrognosisLine.DetermineCalcPrognosisTotalCost;
              UpperServicePrognosisLine."Prognosis Total Revenue (SC)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)";
              UpperServicePrognosisLine."Prognosis Total Revenue (SO)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)";
              IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
                UpperServicePrognosisLine.DeterminePrognosisTotalContractCost;
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SC" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SC";
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SO" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SO";
              END;
            END;
          FIELDNO("Prognosis Total Cost"):
            BEGIN
              UpperServicePrognosisLine."Prognosis Total Cost" := UpperServicePrognosisLine."Lower Level Progn. Total Cost";
              UpperServicePrognosisLine."Prognosis Total Revenue (SC)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)";
              UpperServicePrognosisLine."Prognosis Total Revenue (SO)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)";
              IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
                UpperServicePrognosisLine.DeterminePrognosisTotalContractCost;
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SC" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SC";
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SO" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SO";
              END;
            END;
          FIELDNO("Prognosis Total Contract Cost"):
            BEGIN
              IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
                UpperServicePrognosisLine."Prognosis Total Contract Cost" := UpperServicePrognosisLine."Low. Lv. Pr. Total Contr. Cost";
                UpperServicePrognosisLine."Prognosis Total Cost" := UpperServicePrognosisLine."Prognosis Total Contract Cost" -
                  UpperServicePrognosisLine.TotalPrognosisTotalCostRevenue(UpperServicePrognosisLine.FIELDNO("Prognosis Total Cost"));
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SC" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SC";
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SO" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SO";
              END ELSE
                UpperServicePrognosisLine."Prognosis Total Cost" := UpperServicePrognosisLine."Lower Level Progn. Total Cost";
              UpperServicePrognosisLine."Prognosis Total Revenue (SC)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)";
              UpperServicePrognosisLine."Prognosis Total Revenue (SO)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)";
            END;
          FIELDNO("Prognosis Total Revenue (SC)"):
            BEGIN
              UpperServicePrognosisLine."Prognosis Total Cost" := UpperServicePrognosisLine."Lower Level Progn. Total Cost";
              UpperServicePrognosisLine."Prognosis Total Revenue (SC)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)";
              UpperServicePrognosisLine."Prognosis Total Revenue (SO)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)";
              IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
                UpperServicePrognosisLine."Prognosis Total Contract Cost" := UpperServicePrognosisLine."Low. Lv. Pr. Total Contr. Cost";
                UpperServicePrognosisLine.DeterminePrognosisTotalContractRevenueSC;
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SO" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SO";
              END;
            END;
          FIELDNO("Prognosis Total Revenue (SO)"):
            BEGIN
              UpperServicePrognosisLine."Prognosis Total Cost" := UpperServicePrognosisLine."Lower Level Progn. Total Cost";
              UpperServicePrognosisLine."Prognosis Total Revenue (SC)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)";
              UpperServicePrognosisLine."Prognosis Total Revenue (SO)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)";
              IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
                UpperServicePrognosisLine."Prognosis Total Contract Cost" := UpperServicePrognosisLine."Low. Lv. Pr. Total Contr. Cost";
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SC" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SC";
                UpperServicePrognosisLine.DeterminePrognosisTotalContractRevenueSO;
              END;
            END;
          FIELDNO("Prognosis Total Contr. Rev. SC"):
            BEGIN
              UpperServicePrognosisLine."Prognosis Total Cost" := UpperServicePrognosisLine."Lower Level Progn. Total Cost";
              UpperServicePrognosisLine."Prognosis Total Revenue (SO)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)";
              IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
                UpperServicePrognosisLine."Prognosis Total Contract Cost" := UpperServicePrognosisLine."Low. Lv. Pr. Total Contr. Cost";
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SC" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SC";
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SO" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SO";
                UpperServicePrognosisLine."Prognosis Total Revenue (SC)" := UpperServicePrognosisLine."Prognosis Total Contr. Rev. SC" -
                  UpperServicePrognosisLine.TotalPrognosisTotalCostRevenue(UpperServicePrognosisLine.FIELDNO("Prognosis Total Revenue (SC)"));
              END ELSE
                UpperServicePrognosisLine."Prognosis Total Revenue (SC)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)";
            END;
          FIELDNO("Prognosis Total Contr. Rev. SO"):
            BEGIN
              UpperServicePrognosisLine."Prognosis Total Cost" := UpperServicePrognosisLine."Lower Level Progn. Total Cost";
              UpperServicePrognosisLine."Prognosis Total Revenue (SC)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SC)";
              IF UpperServicePrognosisLine."Rest of Contract" THEN BEGIN
                UpperServicePrognosisLine."Prognosis Total Contract Cost" := UpperServicePrognosisLine."Low. Lv. Pr. Total Contr. Cost";
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SC" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SC";
                UpperServicePrognosisLine."Prognosis Total Contr. Rev. SO" := UpperServicePrognosisLine."Low. L. Pr. Tot Contr. Rev. SO";
                UpperServicePrognosisLine."Prognosis Total Revenue (SO)" := UpperServicePrognosisLine."Prognosis Total Contr. Rev. SO" -
                  UpperServicePrognosisLine.TotalPrognosisTotalCostRevenue(UpperServicePrognosisLine.FIELDNO("Prognosis Total Revenue (SO)"));
              END ELSE
                UpperServicePrognosisLine."Prognosis Total Revenue (SO)" := UpperServicePrognosisLine."Low. Level Progn. Tot.Rev.(SO)";
            END;
        END;
        UpperServicePrognosisLine.DeterminePrognosisFinancialResult;
        IF UpperServicePrognosisLine."Progress Method" = UpperServicePrognosisLine."Progress Method"::"Actual Cost" THEN
          UpperServicePrognosisLine.DetermineProgressPercentage;
      END;
      IF RecalcVCResult THEN
        UpperServicePrognosisLine."Precalc. Res. Incl. Deviation" := PrecalcResultIncludingDeviation;
      UpperServicePrognosisLine.MODIFY;

      IF UpperLevelLineType > "Line Type"::Period THEN
        UpdateUpperLevelPrognosisAmounts(UpperLevelLineType, UpdateFieldNo);
    END;

    PROCEDURE CopyCalculatedPrognosis@1100528612();
    BEGIN
      CheckPrognosisOnCostTypeLevel(Rec);
      CopyCalculatedPrognosisLowerLevels(Rec);
      FIND('=');
      VALIDATE("Prognosis Total Cost", "Calc. Prognosis Total Cost");
      VALIDATE("Prognosis Total Revenue (SC)", "Calc. Progn. Total Rev. (SC)");
      VALIDATE("Prognosis Total Revenue (SO)", "Calc. Progn. Total Rev. (SO)");
    END;

    PROCEDURE CopyCalculatedPrognosisLowerLevels@1100528614(IServicePrognosisLine@1100528603 : Record 11072310);
    VAR
      ServiceContract@1100528602 : Record 11012812;
      ServicePrognosisLine@1100528600 : Record 11072310;
      LowerLevelLineType@1100528601 : Option;
    BEGIN
      IF NOT ServiceContract.GET("Service Contract No.") THEN
        ServiceContract.INIT;
      ServicePrognosisLine.SETRANGE("Prognosis Date", IServicePrognosisLine."Prognosis Date");
      ServicePrognosisLine.SETRANGE("Service Contract No.", IServicePrognosisLine."Service Contract No.");
      IF IServicePrognosisLine."Service Contract No." = '' THEN
        ServicePrognosisLine.SETRANGE("Global Dimension 1 Code", IServicePrognosisLine."Global Dimension 1 Code");
      ServicePrognosisLine.SETRANGE("Control Period Code", IServicePrognosisLine."Control Period Code");
      LowerLevelLineType := IServicePrognosisLine."Line Type" +1;
      IF IServicePrognosisLine."Line Type" = IServicePrognosisLine."Line Type"::Period THEN
        IF ServiceContract."Budget Based on" = ServiceContract."Budget Based on"::"Maintenance Scheme" THEN
          LowerLevelLineType := LowerLevelLineType +1;
      CASE IServicePrognosisLine."Line Type" OF
        IServicePrognosisLine."Line Type"::"Service Category":
          ServicePrognosisLine.SETRANGE("Service Category", IServicePrognosisLine."Service Category");
        IServicePrognosisLine."Line Type"::"Source Type":
          BEGIN
            ServicePrognosisLine.SETRANGE("Service Category", IServicePrognosisLine."Service Category");
            ServicePrognosisLine.SETRANGE("Source Type", IServicePrognosisLine."Source Type");
          END;
      END;
      ServicePrognosisLine.SETRANGE("Line Type", LowerLevelLineType);
      IF ServicePrognosisLine.FINDSET THEN
        REPEAT
          IF ServicePrognosisLine."Line Type" < ServicePrognosisLine."Line Type"::"Service Order" THEN
            CopyCalculatedPrognosisLowerLevels(ServicePrognosisLine);
          ServicePrognosisLine.SetDontUpdatePrognosisValueViaLowerLevelValue(DontUpdatePrognosisValueViaLowerLevelValue);
          ServicePrognosisLine.CopyCalculatedPrognosis;
          ServicePrognosisLine.MODIFY(TRUE);
        UNTIL ServicePrognosisLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ConsumeServiceCategoryBudget@1100528605();
    VAR
      ServicePrognosisLine@1100528600 : Record 11072310;
    BEGIN
      IF "Service Contract No." = '' THEN
        EXIT;
      IF "Service Category" = '' THEN
        EXIT;
      IF "Line Type" <> "Line Type"::"Service Order" THEN
        EXIT;
      ServicePrognosisLine.SETRANGE("Prognosis Date", "Prognosis Date");
      ServicePrognosisLine.SETRANGE("Prognosis Seq. No.", "Prognosis Seq. No.");
      ServicePrognosisLine.SETRANGE("Service Contract No.", "Service Contract No.");
      ServicePrognosisLine.SETRANGE("Control Period Code", "Control Period Code");
      ServicePrognosisLine.SETRANGE("Service Category", "Service Category");
      ServicePrognosisLine.SETRANGE("Source Type", "Source Type");
      ServicePrognosisLine.SETRANGE("Line Type", ServicePrognosisLine."Line Type"::"Service Order");
      ServicePrognosisLine.SETRANGE("Service Order No.", '');
      IF ServicePrognosisLine.FINDFIRST THEN BEGIN
        ServicePrognosisLine.VALIDATE("Budget Cost", ServicePrognosisLine."Budget Cost" - "Budget Cost");
        ServicePrognosisLine.VALIDATE("Budget Hours", ServicePrognosisLine."Budget Hours" - "Budget Hours");
        ServicePrognosisLine.VALIDATE("Budget Revenue (Order)", ServicePrognosisLine."Budget Revenue (Order)"- "Budget Revenue (Order)");
        IF ServicePrognosisLine."Budget Cost" < 0 THEN
          ServicePrognosisLine.VALIDATE("Budget Cost", 0);
        IF ServicePrognosisLine."Budget Hours" < 0 THEN
          ServicePrognosisLine.VALIDATE("Budget Hours", 0);
        IF ServicePrognosisLine."Budget Revenue (Order)" < 0 THEN
          ServicePrognosisLine.VALIDATE("Budget Revenue (Order)", 0);
        ServicePrognosisLine."Calc. Prognosis Total Cost" := ServicePrognosisLine."Budget Cost";
        ServicePrognosisLine."Prognosis Total Cost" := ServicePrognosisLine."Calc. Prognosis Total Cost";
        ServicePrognosisLine."Total Budget Revenue" := ServicePrognosisLine."Budget Revenue (Order)" + ServicePrognosisLine."Budget Revenue (Contract)";
        ServicePrognosisLine."Calc. Progn. Total Rev. (SO)" := ServicePrognosisLine."Budget Revenue (Order)";
        ServicePrognosisLine."Prognosis Total Revenue (SO)" := ServicePrognosisLine."Calc. Progn. Total Rev. (SO)";
        ServicePrognosisLine."Deviation From Budget" := 0;
        ServicePrognosisLine."Budget Costs Incl. Deviation" := ServicePrognosisLine."Budget Cost";
        IF NOT ServicePrognosisLine."Exclude SOs From Est. Result" THEN
          ServicePrognosisLine."Precalc. Res. Incl. Deviation" := ServicePrognosisLine."Total Budget Revenue" - ServicePrognosisLine."Budget Cost";
        ServicePrognosisLine.DeterminePrognosisFinancialResult;
        ServicePrognosisLine.DeterminePrognosisTotalContractCost;
        ServicePrognosisLine."Zero Line" := ServicePrognosisLine.DetermineZeroLine;
        ServicePrognosisLine.MODIFY;
      END;
    END;

    PROCEDURE CopyPreviousPrognosis@1100528610();
    VAR
      PreviousServicePrognosisLine@1100528600 : Record 11072310;
    BEGIN
      CopyPreviousPrognosisLowerLevels(Rec);
      PreviousServicePrognosisLine.SETRANGE("Service Contract No.", "Service Contract No.");
      IF "Service Contract No." = '' THEN
        PreviousServicePrognosisLine.SETRANGE("Global Dimension 1 Code", "Global Dimension 1 Code");
      PreviousServicePrognosisLine.SETRANGE("Control Period Code", "Control Period Code");
      PreviousServicePrognosisLine.SETRANGE("Service Category", "Service Category");
      PreviousServicePrognosisLine.SETRANGE("Source Type", "Source Type");
      PreviousServicePrognosisLine.SETRANGE("Service Order No.", "Service Order No.");
      PreviousServicePrognosisLine.SETRANGE("Line Type", "Line Type");
      PreviousServicePrognosisLine.SETFILTER("Prognosis Date", '<%1', "Prognosis Date");
      IF PreviousServicePrognosisLine.FINDLAST THEN BEGIN
        UpdatePrevServicePrognosisByCostType(Rec, PreviousServicePrognosisLine);
        FIND('=');
        VALIDATE("Deviation From Budget", PreviousServicePrognosisLine."Deviation From Budget");
        VALIDATE("Prognosis Total Cost", PreviousServicePrognosisLine."Prognosis Total Cost");
        VALIDATE("Prognosis Total Revenue (SC)", PreviousServicePrognosisLine."Prognosis Total Revenue (SC)");
        VALIDATE("Prognosis Total Revenue (SO)", PreviousServicePrognosisLine."Prognosis Total Revenue (SO)");
        MODIFY(TRUE);
      END;
    END;

    PROCEDURE CopyPreviousPrognosisLowerLevels@1100528609(IServicePrognosisLine@1100528603 : Record 11072310);
    VAR
      ServiceContract@1100528602 : Record 11012812;
      ServicePrognosisLine@1100528600 : Record 11072310;
      LowerLevelLineType@1100528601 : Option;
    BEGIN
      IF NOT ServiceContract.GET("Service Contract No.") THEN
        ServiceContract.INIT;
      ServicePrognosisLine.SETRANGE("Prognosis Date", IServicePrognosisLine."Prognosis Date");
      ServicePrognosisLine.SETRANGE("Service Contract No.", IServicePrognosisLine."Service Contract No.");
      IF IServicePrognosisLine."Service Contract No." = '' THEN
        ServicePrognosisLine.SETRANGE("Global Dimension 1 Code", IServicePrognosisLine."Global Dimension 1 Code");
      ServicePrognosisLine.SETRANGE("Control Period Code", IServicePrognosisLine."Control Period Code");
      LowerLevelLineType := IServicePrognosisLine."Line Type" +1;
      IF IServicePrognosisLine."Line Type" = IServicePrognosisLine."Line Type"::Period THEN
        IF ServiceContract."Budget Based on" = ServiceContract."Budget Based on"::"Maintenance Scheme" THEN
          LowerLevelLineType := LowerLevelLineType +1;
      CASE IServicePrognosisLine."Line Type" OF
        IServicePrognosisLine."Line Type"::"Service Category":
          ServicePrognosisLine.SETRANGE("Service Category", IServicePrognosisLine."Service Category");
        IServicePrognosisLine."Line Type"::"Source Type":
          BEGIN
            ServicePrognosisLine.SETRANGE("Service Category", IServicePrognosisLine."Service Category");
            ServicePrognosisLine.SETRANGE("Source Type", IServicePrognosisLine."Source Type");
          END;
        IServicePrognosisLine."Line Type"::"Service Order":
          ServicePrognosisLine.SETRANGE("Service Order No.", IServicePrognosisLine."Service Order No.");
      END;
      ServicePrognosisLine.SETRANGE("Line Type", LowerLevelLineType);
      IF ServicePrognosisLine.FINDSET THEN
        REPEAT
          IF ServicePrognosisLine."Line Type" < ServicePrognosisLine."Line Type"::"Service Order" THEN
            CopyPreviousPrognosisLowerLevels(ServicePrognosisLine);
          ServicePrognosisLine.SetDontUpdatePrognosisValueViaLowerLevelValue(DontUpdatePrognosisValueViaLowerLevelValue);
          ServicePrognosisLine.CopyPreviousPrognosis();
          ServicePrognosisLine.MODIFY(TRUE);
        UNTIL ServicePrognosisLine.NEXT = 0;
    END;

    LOCAL PROCEDURE UpdatePrevServicePrognosisByCostType@1100529603(ServicePrognosisLine@1100529601 : Record 11072310;PreviousServicePrognosisLine@1100529600 : Record 11072310);
    VAR
      ServicePrognosisByCostType@1100529602 : Record 11072553;
      PreviousServicePrognosisByCostType@1100529603 : Record 11072553;
    BEGIN
      ServicePrognosisByCostType.SETRANGE("Prognosis Date", ServicePrognosisLine."Prognosis Date");
      ServicePrognosisByCostType.SETRANGE("Prognosis Seq. No.", ServicePrognosisLine."Prognosis Seq. No.");
      ServicePrognosisByCostType.SETRANGE("Prognosis Line No.", ServicePrognosisLine."Line No.");
      IF ServicePrognosisByCostType.ISEMPTY THEN
        EXIT;

      PreviousServicePrognosisByCostType.SETRANGE("Prognosis Date", PreviousServicePrognosisLine."Prognosis Date");
      PreviousServicePrognosisByCostType.SETRANGE("Prognosis Seq. No.", PreviousServicePrognosisLine."Prognosis Seq. No.");
      PreviousServicePrognosisByCostType.SETRANGE("Prognosis Line No.", PreviousServicePrognosisLine."Line No.");
      IF PreviousServicePrognosisByCostType.ISEMPTY THEN
        EXIT;

      CopyPrevServicePrognosisByCostType(ServicePrognosisByCostType, PreviousServicePrognosisByCostType, FALSE);

      ServicePrognosisByCostType.RESET;
      ServicePrognosisByCostType.SetSkipUpdateUpperLevelPrognosis(TRUE);
      ServicePrognosisByCostType.SETRANGE("Prognosis Date", ServicePrognosisLine."Prognosis Date");
      ServicePrognosisByCostType.SETRANGE("Prognosis Seq. No.", ServicePrognosisLine."Prognosis Seq. No.");
      ServicePrognosisByCostType.SETRANGE("Prognosis Line No.", ServicePrognosisLine."Line No.");
      ServicePrognosisByCostType.SETFILTER("Cost Object", '<>%1', '');
      IF ServicePrognosisByCostType.FINDSET THEN
        REPEAT
          ServicePrognosisByCostType.UpdateUpperLevelPrognosisAmounts(ServicePrognosisByCostType.FIELDNO("Deviation from Budget (Amount)"));
        UNTIL ServicePrognosisByCostType.NEXT = 0;
    END;

    PROCEDURE CopyPrevServicePrognosisByCostType@1100529610(VAR ServicePrognosisByCostType@1100529609 : Record 11072553;VAR PrevServicePrognosisByCostType@1100529606 : Record 11072553;SetAdditionalFilters@1100529601 : Boolean);
    VAR
      ServicePrognosisLine@1100529600 : Record 11072310;
    BEGIN
      IF PrevServicePrognosisByCostType.ISEMPTY THEN
        EXIT;

      PrevServicePrognosisByCostType.FINDSET;
      REPEAT
        ServicePrognosisByCostType.SETRANGE("Cost Type", PrevServicePrognosisByCostType."Cost Type");
        ServicePrognosisByCostType.SETRANGE("Cost Object", PrevServicePrognosisByCostType."Cost Object");

        IF SetAdditionalFilters THEN BEGIN
          CASE PrevServicePrognosisByCostType."Line Type" OF
            PrevServicePrognosisByCostType."Line Type"::"Source Type":
              BEGIN
                ServicePrognosisByCostType.SETRANGE("Source Type", PrevServicePrognosisByCostType."Source Type");
                ServicePrognosisByCostType.SETRANGE("Service Category", PrevServicePrognosisByCostType."Service Category");
              END;
            PrevServicePrognosisByCostType."Line Type"::"Service Category":
              ServicePrognosisByCostType.SETRANGE("Service Category", PrevServicePrognosisByCostType."Service Category");
          END;
          ServicePrognosisByCostType.SETRANGE("Control Period Code", PrevServicePrognosisByCostType."Control Period Code");
        END;

        IF ServicePrognosisByCostType.FINDLAST THEN BEGIN
          IF (ServicePrognosisByCostType."Prognosis Total Cost" <> PrevServicePrognosisByCostType."Prognosis Total Cost") OR
             (ServicePrognosisByCostType."Rate Code" <> PrevServicePrognosisByCostType."Rate Code") OR
             (ServicePrognosisByCostType.Rate <> PrevServicePrognosisByCostType.Rate) OR
             (ServicePrognosisByCostType.Comment <> '') OR
             (PrevServicePrognosisByCostType."Deviation from Budget (Amount)" <> 0)
          THEN BEGIN
            IF PrevServicePrognosisByCostType."Cost Type" = PrevServicePrognosisByCostType."Cost Type"::Labor THEN BEGIN
              ServicePrognosisByCostType."Rate Code" := PrevServicePrognosisByCostType."Rate Code";
              ServicePrognosisByCostType.Rate := PrevServicePrognosisByCostType.Rate;
            END;
            IF PrevServicePrognosisByCostType."Deviation from Budget (Amount)" <> 0 THEN BEGIN
              ServicePrognosisByCostType."Deviation from Budget (Amount)" := PrevServicePrognosisByCostType."Deviation from Budget (Amount)";
              ServicePrognosisByCostType."Budget Costs Incl. Deviation" := ServicePrognosisByCostType."Budget Cost" + ServicePrognosisByCostType."Deviation from Budget (Amount)";
              ServicePrognosisByCostType.DetermineDeviationFromBudgetHours;
              ServicePrognosisByCostType.DetermineCalcPrognosisTotalCost;
            END;
            ServicePrognosisByCostType."Prognosis Total Cost" := PrevServicePrognosisByCostType."Prognosis Total Cost";
            ServicePrognosisByCostType.DeterminePrognosisTotalContractCost;
            ServicePrognosisByCostType.Comment := PrevServicePrognosisByCostType.Comment;
            ServicePrognosisByCostType.MODIFY;
          END;
        END ELSE
          IF PrevServicePrognosisByCostType."Cost Object" <> '' THEN BEGIN
            ServicePrognosisByCostType.SETRANGE("Cost Object", '');
            IF ServicePrognosisByCostType.FINDLAST THEN
              IF ServicePrognosisLine.GET(ServicePrognosisByCostType."Prognosis Date", ServicePrognosisByCostType."Prognosis Seq. No.", ServicePrognosisByCostType."Prognosis Line No.") THEN BEGIN
                ServicePrognosisByCostType.INIT;
                ServicePrognosisByCostType."Prognosis Date" := ServicePrognosisLine."Prognosis Date";
                ServicePrognosisByCostType."Prognosis Seq. No." := ServicePrognosisLine."Prognosis Seq. No.";
                ServicePrognosisByCostType."Prognosis Line No." := ServicePrognosisLine."Line No.";
                ServicePrognosisByCostType."Cost Type" := PrevServicePrognosisByCostType."Cost Type";
                ServicePrognosisByCostType."Cost Object" := PrevServicePrognosisByCostType."Cost Object";
                ServicePrognosisByCostType.INSERT(TRUE);
                ServicePrognosisByCostType."Service Category" := ServicePrognosisLine."Service Category";
                ServicePrognosisByCostType."Service Contract No." := ServicePrognosisLine."Service Contract No.";
                ServicePrognosisByCostType."Control Period Code" := ServicePrognosisLine."Control Period Code";
                ServicePrognosisByCostType."Starting Date" := ServicePrognosisLine."Starting Date";
                ServicePrognosisByCostType."Ending Date" := ServicePrognosisLine."Ending Date";
                ServicePrognosisByCostType."Line Type" := ServicePrognosisLine."Line Type";
                ServicePrognosisByCostType."Source Type" := ServicePrognosisLine."Source Type";
                ServicePrognosisByCostType."Rest of Contract" := ServicePrognosisLine."Rest of Contract";
                ServicePrognosisByCostType."Upper Level Prognosis Line No." := ServicePrognosisLine.GetUpperLevelLineNo;
                IF PrevServicePrognosisByCostType."Cost Type" = PrevServicePrognosisByCostType."Cost Type"::Labor THEN BEGIN
                  ServicePrognosisByCostType."Rate Code" := PrevServicePrognosisByCostType."Rate Code";
                  ServicePrognosisByCostType.Rate := PrevServicePrognosisByCostType.Rate;
                END;
                IF PrevServicePrognosisByCostType."Deviation from Budget (Amount)" <> 0 THEN BEGIN
                  ServicePrognosisByCostType."Deviation from Budget (Amount)" := PrevServicePrognosisByCostType."Deviation from Budget (Amount)";
                  ServicePrognosisByCostType."Budget Costs Incl. Deviation" := ServicePrognosisByCostType."Budget Cost" + ServicePrognosisByCostType."Deviation from Budget (Amount)";
                  ServicePrognosisByCostType.DetermineDeviationFromBudgetHours;
                  ServicePrognosisByCostType.DetermineCalcPrognosisTotalCost;
                END;
                ServicePrognosisByCostType."Prognosis Total Cost" := PrevServicePrognosisByCostType."Prognosis Total Cost";
                ServicePrognosisByCostType.Comment := PrevServicePrognosisByCostType.Comment;
                ServicePrognosisByCostType.MODIFY;
              END;
          END;
      UNTIL PrevServicePrognosisByCostType.NEXT = 0;
    END;

    PROCEDURE SetDontUpdatePrognosisValueViaLowerLevelValue@1100528613(IDontUpdatePrognosisValueViaLowerLevelValue@1100528600 : Boolean);
    BEGIN
      DontUpdatePrognosisValueViaLowerLevelValue := IDontUpdatePrognosisValueViaLowerLevelValue;
    END;

    PROCEDURE DeterminePrognosisRevenueSO@1100528615(IFactor@1100528600 : Decimal;OverwriteValue@1100529600 : Boolean) : Boolean;
    BEGIN
      DeterminePrognosisRevenueSOLowerLevels(Rec, IFactor, OverwriteValue);
      IF "Line Type" <> "Line Type"::"Service Order" THEN
        EXIT;
      IF "Prognosis Total Revenue (SO)" <> 0 THEN
        IF NOT OverwriteValue THEN
          EXIT;
      VALIDATE("Prognosis Total Revenue (SO)", "Total Cost (Additional)" * IFactor);
      EXIT(TRUE);
    END;

    PROCEDURE DeterminePrognosisRevenueSOLowerLevels@1100528620(IServicePrognosisLine@1100528603 : Record 11072310;IFactor@1100528604 : Decimal;OverwriteValue@1100529600 : Boolean);
    VAR
      ServiceContract@1100528602 : Record 11012812;
      ServicePrognosisLine@1100528600 : Record 11072310;
      LowerLevelLineType@1100528601 : Option;
    BEGIN
      IF NOT ServiceContract.GET("Service Contract No.") THEN
        ServiceContract.INIT;
      ServicePrognosisLine.SETRANGE("Prognosis Date", IServicePrognosisLine."Prognosis Date");
      ServicePrognosisLine.SETRANGE("Service Contract No.", IServicePrognosisLine."Service Contract No.");
      IF IServicePrognosisLine."Service Contract No." = '' THEN
        ServicePrognosisLine.SETRANGE("Global Dimension 1 Code", IServicePrognosisLine."Global Dimension 1 Code");
      ServicePrognosisLine.SETRANGE("Control Period Code", IServicePrognosisLine."Control Period Code");
      LowerLevelLineType := IServicePrognosisLine."Line Type" +1;
      IF IServicePrognosisLine."Line Type" = IServicePrognosisLine."Line Type"::Period THEN
        IF ServiceContract."Budget Based on" = ServiceContract."Budget Based on"::"Maintenance Scheme" THEN
          LowerLevelLineType := LowerLevelLineType +1;
      CASE IServicePrognosisLine."Line Type" OF
        IServicePrognosisLine."Line Type"::"Service Category":
          ServicePrognosisLine.SETRANGE("Service Category", IServicePrognosisLine."Service Category");
        IServicePrognosisLine."Line Type"::"Source Type":
          BEGIN
            ServicePrognosisLine.SETRANGE("Service Category", IServicePrognosisLine."Service Category");
            ServicePrognosisLine.SETRANGE("Source Type", IServicePrognosisLine."Source Type");
          END;
      END;
      ServicePrognosisLine.SETRANGE("Line Type", LowerLevelLineType);
      IF ServicePrognosisLine.FINDSET THEN
        REPEAT
          IF ServicePrognosisLine."Line Type" < ServicePrognosisLine."Line Type"::"Service Order" THEN
            DeterminePrognosisRevenueSOLowerLevels(ServicePrognosisLine, IFactor, OverwriteValue);
          IF ServicePrognosisLine.DeterminePrognosisRevenueSO(IFactor, OverwriteValue) THEN
            ServicePrognosisLine.MODIFY(TRUE);
        UNTIL ServicePrognosisLine.NEXT = 0;
    END;

    PROCEDURE RemoveServiceContractLines@1100528619(VAR IServicePrognosisLine@1100528600 : Record 11072310);
    VAR
      MarkedServicePrognosisLine@1100528601 : Record 11072310;
    BEGIN
      IF IServicePrognosisLine.FINDSET THEN
        REPEAT
          MarkedServicePrognosisLine.SETRANGE("Prognosis Date", IServicePrognosisLine."Prognosis Date");
          MarkedServicePrognosisLine.SETRANGE("Prognosis Seq. No.", IServicePrognosisLine."Prognosis Seq. No.");
          MarkedServicePrognosisLine.SETRANGE("Service Contract No.", IServicePrognosisLine."Service Contract No.");
          MarkedServicePrognosisLine.SETRANGE("Global Dimension 1 Code", IServicePrognosisLine."Global Dimension 1 Code");
          IF MarkedServicePrognosisLine.FINDSET THEN
            REPEAT
              MarkedServicePrognosisLine.MARK(TRUE);
            UNTIL MarkedServicePrognosisLine.NEXT = 0;
        UNTIL IServicePrognosisLine.NEXT = 0;
      MarkedServicePrognosisLine.SETRANGE("Prognosis Date");
      MarkedServicePrognosisLine.SETRANGE("Prognosis Seq. No.");
      MarkedServicePrognosisLine.SETRANGE("Service Contract No.");
      MarkedServicePrognosisLine.SETRANGE("Global Dimension 1 Code");
      MarkedServicePrognosisLine.MARKEDONLY(TRUE);
      MarkedServicePrognosisLine.DELETEALL(TRUE);
    END;

    PROCEDURE DeterminePrognosisFinancialResult@1100528622();
    BEGIN
      "Prognosis Financial Result" := "Prognosis Total Revenue (SC)" + "Prognosis Total Revenue (SO)" - "Prognosis Total Cost";
    END;

    PROCEDURE DetermineZeroLine@1100529600() : Boolean;
    BEGIN
      IF ("Total Budget Revenue" = 0) AND ("Paid Amount" = 0) AND ("Closed Revenue" = 0) AND ("Contract Financing Balance" = 0) AND ("Revenue Amount" = 0) AND
         ("Actual Cost" = 0) AND ("Actual Cost (Additional)" = 0) AND ("Open (Purchase)" = 0) AND ("Total Cost" = 0) AND (Result = 0) AND
         ("Budget Cost" = 0) AND ("Deviation From Budget" = 0) AND ("Prognosis Total Cost" = 0) AND ("Prognosis Total Revenue (SC)" = 0) AND ("Prognosis Total Revenue (SO)" = 0) AND
         ("Calc. Prognosis Total Cost" = 0) AND ("Calc. Progn. Total Rev. (SC)" = 0) AND ("Calc. Progn. Total Rev. (SO)" = 0) AND ("Open Ovh. Surch. Soft (Purch.)" = 0) AND ("Received/Not Invoiced" = 0) AND
         ("Open Ovh. Surch. Firm (Purch.)" = 0) AND ("Open (Inventory)" = 0) AND ("Open Ovh. Surch. (Inventory)" = 0) AND ("Open Amount (Hours)" = 0) AND ("Open Ovh. Surch. (Hours)" = 0) AND
         ("Total Cost (Additional)" = 0) AND (Available = 0) AND ("Budget Hours" = 0) AND ("Actual Hours" = 0) AND ("Actual Hours (Additional)" = 0) AND
         ("Open Hours" = 0) AND ("Total Hours" = 0) AND ("Total Hours (Additional)" = 0) AND ("Allowed Hours" = 0) AND ("Result Hours" = 0) AND
         ("Budget Revenue (Contract)" = 0) AND ("Budget Revenue (Order)" = 0) AND ("Revenue Amount (Additional)" = 0) AND ("Allowed Cost" = 0) AND
         ("Original Budget Hours" = 0) AND ("Original Budget Cost" = 0) AND ("Prognosis Financial Result" = 0) AND ("Contr. Fin. Bal. Without Clos." = 0)
      THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    PROCEDURE DetermineCalcPrognosisTotalCost@1100529606();
    BEGIN
      IF NOT "Exclude SOs From Est. Result" THEN
        "Precalc. Res. Incl. Deviation" := "Total Budget Revenue" - "Budget Cost" - "Deviation From Budget";
      IF ("Total Cost" > "Budget Costs Incl. Deviation") OR
         ("Service Order Status" IN ["Service Order Status"::"Administrative Finished", "Service Order Status"::Finished])
      THEN
        "Calc. Prognosis Total Cost" := "Total Cost"
      ELSE
        "Calc. Prognosis Total Cost" := "Budget Costs Incl. Deviation";
      "Prognosis Total Cost" := "Calc. Prognosis Total Cost";
    END;

    PROCEDURE CheckPrognosisOnCostTypeLevel@1100529607(ServicePrognosisLine@1100529600 : Record 11072310);
    VAR
      ServicePrognosisByCostType@1100529601 : Record 11072553;
    BEGIN
      IF ServicePrognosisLine."Line Type" = ServicePrognosisLine."Line Type"::"Service Order" THEN
        EXIT;

      ServicePrognosisByCostType.SETRANGE("Prognosis Date", ServicePrognosisLine."Prognosis Date");
      ServicePrognosisByCostType.SETRANGE("Prognosis Seq. No.", ServicePrognosisLine."Prognosis Seq. No.");
      ServicePrognosisByCostType.SETRANGE("Prognosis Line No.", ServicePrognosisLine."Line No.");
      IF ServicePrognosisByCostType.ISEMPTY THEN
        EXIT;
      ServicePrognosisByCostType.FINDSET;
      REPEAT
        IF (ServicePrognosisByCostType."Prognosis Total Cost" <> ServicePrognosisByCostType."Calc. Prognosis Total Cost") OR
           (ServicePrognosisByCostType."Deviation from Budget (Amount)" <> 0)
        THEN
          ERROR(Text007);
      UNTIL ServicePrognosisByCostType.NEXT = 0;
    END;

    PROCEDURE GetUpperLevelLineNo@1100529601() : Integer;
    VAR
      ServiceContract@1100529600 : Record 11012812;
      UpperServicePrognosisLine@1100529601 : Record 11072310;
    BEGIN
      IF ("Line Type" IN ["Line Type"::"Service Order", "Line Type"::Period]) THEN
        EXIT(0);

      UpperServicePrognosisLine.SETRANGE("Prognosis Date", "Prognosis Date");
      UpperServicePrognosisLine.SETRANGE("Prognosis Seq. No.", "Prognosis Seq. No.");
      UpperServicePrognosisLine.SETRANGE("Service Contract No.", "Service Contract No.");
      UpperServicePrognosisLine.SETRANGE("Control Period Code", "Control Period Code");
      UpperServicePrognosisLine.SETRANGE("Line Type", "Line Type" - 1);
      IF "Line Type" = "Line Type"::"Source Type" THEN BEGIN
        IF NOT ServiceContract.GET("Service Contract No.") THEN
          ServiceContract.INIT;
        IF ServiceContract."Budget Based on" IN [ServiceContract."Budget Based on"::Category, ServiceContract."Budget Based on"::"Category + Maintenance Scheme"] THEN
          UpperServicePrognosisLine.SETRANGE("Service Category", "Service Category")
        ELSE
          UpperServicePrognosisLine.SETRANGE("Line Type", "Line Type"::Period);
      END;
      IF NOT UpperServicePrognosisLine.FINDFIRST THEN
        EXIT(0);
      EXIT(UpperServicePrognosisLine."Line No.");
    END;

    PROCEDURE DeterminePrognosisTotalContractCost@1100529631();
    BEGIN
      IF NOT "Rest of Contract" THEN
        EXIT;
      "Prognosis Total Contract Cost" := "Prognosis Total Cost" + TotalPrognosisTotalCostRevenue(FIELDNO("Prognosis Total Cost"));
    END;

    PROCEDURE DeterminePrognosisTotalContractRevenueSC@1100529633();
    BEGIN
      IF NOT "Rest of Contract" THEN
        EXIT;
      "Prognosis Total Contr. Rev. SC" := "Prognosis Total Revenue (SC)" + TotalPrognosisTotalCostRevenue(FIELDNO("Prognosis Total Revenue (SC)"));
    END;

    PROCEDURE DeterminePrognosisTotalContractRevenueSO@1100529635();
    BEGIN
      IF NOT "Rest of Contract" THEN
        EXIT;
      "Prognosis Total Contr. Rev. SO" := "Prognosis Total Revenue (SO)" + TotalPrognosisTotalCostRevenue(FIELDNO("Prognosis Total Revenue (SO)"));
    END;

    PROCEDURE TotalPrognosisTotalCostRevenue@1100529623(CalcFieldNo@1100529621 : Integer) : Decimal;
    VAR
      LocServicePrognosisLine@1100529620 : Record 11072310;
    BEGIN
      IF NOT "Rest of Contract" THEN
        EXIT(0);

      LocServicePrognosisLine.SETRANGE("Prognosis Date", "Prognosis Date");
      LocServicePrognosisLine.SETRANGE("Prognosis Seq. No.", "Prognosis Seq. No.");
      LocServicePrognosisLine.SETRANGE("Service Contract No.", "Service Contract No.");
      LocServicePrognosisLine.SETRANGE("Service Category", "Service Category");
      IF "Total Service Order Level" THEN
        LocServicePrognosisLine.SETFILTER("Service Order No.", '<>%1', '')
      ELSE
        LocServicePrognosisLine.SETRANGE("Service Order No.", "Service Order No.");
      LocServicePrognosisLine.SETRANGE("Source Type", "Source Type");
      LocServicePrognosisLine.SETRANGE("Line Type", "Line Type");
      LocServicePrognosisLine.SETRANGE("Rest of Contract", FALSE);
      IF LocServicePrognosisLine.ISEMPTY THEN
        EXIT(0);

      CASE CalcFieldNo OF
        FIELDNO("Prognosis Total Cost"):
          BEGIN
            LocServicePrognosisLine.CALCSUMS("Prognosis Total Cost");
            EXIT(LocServicePrognosisLine."Prognosis Total Cost");
          END;
        FIELDNO("Prognosis Total Revenue (SC)"):
          BEGIN
            LocServicePrognosisLine.CALCSUMS("Prognosis Total Revenue (SC)");
            EXIT(LocServicePrognosisLine."Prognosis Total Revenue (SC)");
          END;
        FIELDNO("Prognosis Total Revenue (SO)"):
          BEGIN
            LocServicePrognosisLine.CALCSUMS("Prognosis Total Revenue (SO)");
            EXIT(LocServicePrognosisLine."Prognosis Total Revenue (SO)");
          END;
      END;
    END;

    PROCEDURE UpdatePrognosisTotalContractCostRevenue@1100529620(UpdateFieldNo@1100529621 : Integer);
    VAR
      LocServicePrognosisLine@1100529620 : Record 11072310;
    BEGIN
      IF "Rest of Contract" THEN
        EXIT;

      LocServicePrognosisLine.SETRANGE("Prognosis Date", "Prognosis Date");
      LocServicePrognosisLine.SETRANGE("Prognosis Seq. No.", "Prognosis Seq. No.");
      LocServicePrognosisLine.SETRANGE("Service Contract No.", "Service Contract No.");
      LocServicePrognosisLine.SETRANGE("Service Category", "Service Category");
      LocServicePrognosisLine.SETFILTER("Service Order No.", '=%1', '');
      LocServicePrognosisLine.SETRANGE("Source Type", "Source Type");
      LocServicePrognosisLine.SETRANGE("Line Type", "Line Type");
      LocServicePrognosisLine.SETRANGE("Rest of Contract", TRUE);
      IF LocServicePrognosisLine.ISEMPTY THEN
        EXIT;

      LocServicePrognosisLine.FINDLAST;
      CASE UpdateFieldNo OF
        FIELDNO("Prognosis Total Contract Cost"):
          LocServicePrognosisLine.DeterminePrognosisTotalContractCost;
        FIELDNO("Prognosis Total Contr. Rev. SC"):
          LocServicePrognosisLine.DeterminePrognosisTotalContractRevenueSC;
        FIELDNO("Prognosis Total Contr. Rev. SO"):
          LocServicePrognosisLine.DeterminePrognosisTotalContractRevenueSO;
      END;
      LocServicePrognosisLine.MODIFY;
      LocServicePrognosisLine.UpdateUpperLevelPrognosisAmounts("Line Type", UpdateFieldNo);
    END;

    LOCAL PROCEDURE CheckManualChange@1100529625();
    VAR
      ServiceControlPeriod@1100529601 : Record 11071755;
      ServiceContractCtrlPeriod@1100529600 : Record 11071746;
    BEGIN
      IF CurrFieldNo <> 0 THEN BEGIN
        IF "Control Period Finished" THEN
          IF "Service Contract No." = '' THEN BEGIN
            IF ServiceControlPeriod.GET("Control Period Code") THEN
              ServiceControlPeriod.TESTFIELD("Date Finished", 0D);
          END ELSE
            IF ServiceContractCtrlPeriod.GET("Service Contract No.", "Control Period Code") THEN
              ServiceContractCtrlPeriod.TESTFIELD("Date Finished", 0D);

        IF "Line Type" < "Line Type"::"Service Order" THEN
          TESTFIELD("Calc. Interim Results by Order", FALSE);
        CheckPrognosisOnCostTypeLevel(Rec);
        IF "Rest of Contract" THEN
          TESTFIELD("Rest of Contract Editable", TRUE);
      END;
    END;

    LOCAL PROCEDURE GetBudgetRevenueContract@1100528500(ServiceContract@1100528500 : Record 11012812) BudgetRevenueContract : Decimal;
    VAR
      SCControlbyPeriodMgt@1100528501 : Codeunit 11012885;
      DivisionPercentage@1100528502 : Decimal;
    BEGIN
      IF "Service Category" <> '' THEN
        BudgetRevenueContract :=
          SCControlbyPeriodMgt.GetSCBudgetRevenue(
            "Service Contract No.", "Starting Date", "Ending Date", "Service Category");

      ServiceContract.SetCheckOtherServiceCategories(TRUE);
      DivisionPercentage := ServiceContract.GetCategoryDivisionPercentage("Service Category", "Starting Date");
      BudgetRevenueContract += TotalBudgetRevenueContract * DivisionPercentage / 100;
    END;

    PROCEDURE SetTotalBudgetRevenueContract@1100528502(NewTotalBudgetRevenueContract@1100528500 : Decimal);
    BEGIN
      TotalBudgetRevenueContract := NewTotalBudgetRevenueContract;
    END;

    LOCAL PROCEDURE RoundAmounts@1100529602();
    VAR
      GLSetup@1100529600 : Record 98;
    BEGIN
      IF DetermineZeroLine THEN
        EXIT;

      GLSetup.GET;
      "Budget Cost" := ROUND("Budget Cost", GLSetup."Amount Rounding Precision");
      "Revenue Amount" := ROUND("Revenue Amount", GLSetup."Amount Rounding Precision");
      "Budget Hours" := ROUND("Budget Hours", GLSetup."Amount Rounding Precision");
      "Budget Revenue (Order)" := ROUND("Budget Revenue (Order)", GLSetup."Amount Rounding Precision");
      "Original Budget Hours" := ROUND("Original Budget Hours", GLSetup."Amount Rounding Precision");
      "Original Budget Cost" := ROUND("Original Budget Cost", GLSetup."Amount Rounding Precision");
      Available := ROUND(Available, GLSetup."Amount Rounding Precision");
      "Budget Revenue (Contract)" :=  ROUND("Budget Revenue (Contract)", GLSetup."Amount Rounding Precision");
      "Paid Amount" := ROUND("Paid Amount", GLSetup."Amount Rounding Precision");
      "Closed Revenue" := ROUND("Closed Revenue", GLSetup."Amount Rounding Precision");
      "Closed Cost" := ROUND("Closed Cost", GLSetup."Amount Rounding Precision");
      "Allowed Cost" := ROUND("Allowed Cost", GLSetup."Amount Rounding Precision");
      "Allowed Hours" := ROUND("Allowed Hours", GLSetup."Amount Rounding Precision");
      "Contract Financing Balance" := ROUND("Contract Financing Balance", GLSetup."Amount Rounding Precision");
    END;

    BEGIN
    END.
  }
}

